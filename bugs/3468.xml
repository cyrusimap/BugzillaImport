<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>3468</bug_id>
          
          <creation_ts>2011-05-22 09:28 EDT</creation_ts>
          <short_desc>Set PAM_RHOST in saslauthd&apos;s auth_pam</short_desc>
          <delta_ts>2016-10-25 09:15:40 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus SASL</product>
          <component>SASL</component>
          <version>2.1.x</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>NEW</bug_status>
          
          
          
          
          
          <priority>P3</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Lorenzo M. Catucci">lorenzo@sancho.ccd.uniroma2.it</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          <cc>cepheid@3phase.com</cc>
    
    <cc>kgc@corp.sonic.net</cc>
          <qa_contact name="The Cyrus Bugzilla List">cyrus-bugzilla@lists.andrew.cmu.edu</qa_contact>

      

      

      
          <long_desc isprivate="0">
            <who name="Lorenzo M. Catucci">lorenzo@sancho.ccd.uniroma2.it</who>
            <bug_when>2011-05-22 09:28:08 EDT</bug_when>
            <thetext>Please find a patch I&apos;ve just written (and very lightly tested) to let
saslauthd know the SASL_IPREMOTEPORT and in turn set the PAM_RHOST item
within the  pam context.

I&apos;m attaching two versions of my changes, since there were some conflicts
between the work I&apos;ve done for 2.1.23 and the upstream changes applied to the upcoming 2.1.24 version.

I&apos;d be grateful about any comment - review - test which could help with
upstreaming my patch.

The changes to ipc_doors.c are untested, since I don&apos;t have a working
account on a solaris system.

From what I&apos;ve seen on google, there is at least a couple of people
interested in these changes, since the have been repeatedly requested, both
on sasl mailing list and on RedHat&apos;s bugzilla:

http://lists.andrew.cmu.edu/pipermail/cyrus-sasl/2011-March/002218.html
	&quot;saslauthd/PAM IP logging on failure&quot;   - 2011-03-26

https://bugzilla.redhat.com/show_bug.cgi?id=683797
	&quot;saslauthd using pam does not log rhost (remote host) IP/hostname
         or requested login in /var/log/secure&quot; - 2011-03-10

http://lists.andrew.cmu.edu/pipermail/cyrus-sasl/2010-July/002108.html
	&quot;PAM authentication - Remote host&quot;      - 2010-07-13

http://lists.andrew.cmu.edu/pipermail/cyrus-sasl/2010-May/002085.html
	&quot;remote client ip&quot;                      - 2010-05-24

While the changes are really limited, I&apos;m hereby expressely authorize redistribution and use under the original file&apos;s licence.

In detail:

 1. lib/checkpw.c: 4 clause bsd-like licence  *cmu 
 2. saslauthd/auth_dce.{c,h}: 2 clause bsd-like licence - *md
 3. saslauthd/auth_getpwent.{c,h}: 2 clause bsd-like licence - *md
 4. saslauthd/auth_httpform.{c,h}: 2 clause bsd-like licence - *pe
 5. saslauthd/auth_krb4.{c,h}: 2 clause bsd-like licence - *md
 6. saslauthd/auth_krb5.{c,h}: 2 clause bsd-like licence - *md
 7. saslauthd/auth_ldap.{c,h}: 2 clause bsd-like licence - *ib
 8. saslauthd/auth_pam.{c,h}: 2 clause bsd-like licence - *fk
 9. saslauthd/auth_rimap.{c,h}: 2 clause bsd-like licence - *md
10. saslauthd/auth_sasldb.{c,h}: 2 clause bsd-like licence - *md
11. saslauthd/auth_shadow.{c,h}: 2 clause bsd-like licence - *md
12. saslauthd/auth_sia.{c,h}: 2 clause bsd-like licence - *md
13. saslauthd/ipc_doors.c: 2 clause bsd-like licence - *md
14. saslauthd/ipc_unix.c: 2 clause bsd-like licence - *md
15. saslauthd/mechanisms.h: 2 clause bsd-like licence - *md
16: saslauthd/saslauthd-main.{c,h}: 2 clause bsd-like licence - *md

*cmu - Carnegie Mellon University.
*md  - Messaging Direct Ltd.
*pe  - Pyx Engineering AG
*ib  - Igor Brezac
*fk  - Fabian Knittel

As for the copyright, I would be equally satisfied, at sasl project&apos;s representative&apos;s sole option, either if it would be assigned to the respective file&apos;s copyright owner, or if a statement was added in each of the modified .c files declaring my own copyright on the changed portions.

Thank you very much for reading this far... yours

                   lorenzo m. catucci</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Lorenzo M. Catucci">lorenzo@sancho.ccd.uniroma2.it</who>
            <bug_when>2011-05-22 09:29:09 EDT</bug_when>
            <thetext>Created an attachment (id=1390)
Enable PAM_RHOST on cyrus-sasl 2.1.23</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Lorenzo M. Catucci">lorenzo@sancho.ccd.uniroma2.it</who>
            <bug_when>2011-05-22 09:29:51 EDT</bug_when>
            <thetext>Created an attachment (id=1391)
Enable PAM_RHOST on upcoming cyrus-sasl 2.1.24</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Lorenzo M. Catucci">lorenzo@sancho.ccd.uniroma2.it</who>
            <bug_when>2011-05-22 12:04:10 EDT</bug_when>
            <thetext>Just for the records: most of the recorded changes are simply a global
API change.

The only places where there is a significant change are the following
files:

  * lib/checkpw.c
  * saslauthd/auth_pam.c
  * saslauthd/ipc_doors.c
  * saslauthd/ipc_unix.c

The changes in saslauthd/saslauthd-main.c are really minor.

As could be seen from the diffstat:

 lib/checkpw.c              |   25 +++++++++++++++++++++----
 saslauthd/auth_dce.c       |    6 ++++--
 saslauthd/auth_dce.h       |    2 +-
 saslauthd/auth_getpwent.c  |    3 ++-
 saslauthd/auth_getpwent.h  |    2 +-
 saslauthd/auth_httpform.c  |    3 ++-
 saslauthd/auth_httpform.h  |    2 +-
 saslauthd/auth_krb4.c      |    6 ++++--
 saslauthd/auth_krb4.h      |    2 +-
 saslauthd/auth_krb5.c      |    9 ++++++---
 saslauthd/auth_krb5.h      |    2 +-
 saslauthd/auth_ldap.c      |    6 ++++--
 saslauthd/auth_ldap.h      |    2 +-
 saslauthd/auth_pam.c       |   14 ++++++++++++--
 saslauthd/auth_pam.h       |    2 +-
 saslauthd/auth_rimap.c     |    3 ++-
 saslauthd/auth_rimap.h     |    2 +-
 saslauthd/auth_sasldb.c    |    5 +++--
 saslauthd/auth_sasldb.h    |    2 +-
 saslauthd/auth_shadow.c    |    6 ++++--
 saslauthd/auth_shadow.h    |    2 +-
 saslauthd/auth_sia.c       |    6 ++++--
 saslauthd/auth_sia.h       |    2 +-
 saslauthd/ipc_doors.c      |   19 ++++++++++++++++++-
 saslauthd/ipc_unix.c       |   21 +++++++++++++++++++--
 saslauthd/mechanisms.h     |    4 ++--
 saslauthd/saslauthd-main.c |   16 ++++++++--------
 saslauthd/saslauthd-main.h |    3 ++-
 28 files changed, 128 insertions(+), 49 deletions(-)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Amir Caspi">cepheid@3phase.com</who>
            <bug_when>2011-05-28 05:59:51 EDT</bug_when>
            <thetext>Lorenzo has confirmed on the mailing list that the 2.1.23 patch applies cleanly to 2.1.22 as well.  It would be greatly appreciated if these patches could be rolled into the respective versions... in particular. 2.1.22 is still being used by RHEL, so backporting these changes to 2.1.22 would be greatly beneficial as well.  RHEL is likely to incorporate these changes only if they are first accepted here, upstream.

Thanks.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Lorenzo M. Catucci">lorenzo@sancho.ccd.uniroma2.it</who>
            <bug_when>2011-08-09 12:45:18 EDT</bug_when>
            <thetext>Created an attachment (id=1409)
Corrected version of the 2.1.24 patch</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Amir Caspi">cepheid@3phase.com</who>
            <bug_when>2011-10-29 03:47:53 EDT</bug_when>
            <thetext>Just wondering if there is an ETA on incorporating this patch into saslauthd... and, particularly, in backporting it to v2.1.22 for inclusion in RHEL/CentOS.

For the record, I&apos;ve opened downstream bugs at RHEL and CentOS:
https://bugzilla.redhat.com/show_bug.cgi?id=683797
http://bugs.centos.org/view.php?id=4760

So far, unfortunately, no motion on either.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Kelsey Cummings">kgc@corp.sonic.net</who>
            <bug_when>2013-12-05 18:52:31 EDT</bug_when>
            <thetext>Just a bump, this would be a good feature for support and is currently blocking us from having centralized user/ip auth logs where the authentication is passing through cyrus sasl.  Was there something wrong with these patches that they weren&apos;t pulled in?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Amir Caspi">cepheid@3phase.com</who>
            <bug_when>2013-12-05 19:48:05 EDT</bug_when>
            <thetext>(In reply to comment #7)
&gt; Was there something wrong with these patches that they weren&apos;t pulled in?

Per the linked RedHat bug (see above), RHEL devs said the patch, as currently implemented, broke compatibility with certain clients.  See comments 10-12 and 16 in the linked bug.  See also comment 20 there.

RHEL won&apos;t implement this fix until it complies with whatever they&apos;re claiming is broken.  They&apos;ve already closed the bug as a WONTFIX.  I think the only way to get them to reopen this and backport any changes would be if the patch addresses their concerns.  It looks like the only way to do that is to modify saslauthd so that it won&apos;t block when it doesn&apos;t receive the rhost (per comment 16 in the linked bug), or to implement some other means of encoding the rhost in the existing 4 atoms being sent (see comment 17).</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Lorenzo M. Catucci">lorenzo@sancho.ccd.uniroma2.it</who>
            <bug_when>2016-10-25 09:15:40 EDT</bug_when>
            <thetext>I&apos;ve just rebased the patches to github&apos;s master and submitted as

    https://github.com/cyrusimap/cyrus-sasl/pull/6

As from this updated request, I&apos;ve adapted testsaslauthd to the changed protocol ABI, which should solve the problems seen by RH developers.

Thank you.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1390</attachid>
            <date>2011-05-22 09:29 EDT</date>
            <desc>Enable PAM_RHOST on cyrus-sasl 2.1.23</desc>
            <filename>saslauthd_pam_rhost_2.1.23.diff</filename>
            <type>text/plain</type>
            <size>29259</size>
            <attacher>lorenzo@sancho.ccd.uniroma2.it</attacher>
            
              <data encoding="base64">IyEgL2Jpbi9zaCAvdXNyL3NoYXJlL2RwYXRjaC9kcGF0Y2gtcnVuCiMjIDAwMjRfc2FzbGF1dGhk
X3BhbV9yaG9zdC5kcGF0Y2ggYnkgIDxyb290QG1haWxiZTAwLnVuaXJvbWEyLml0PgojIwojIyBB
bGwgbGluZXMgYmVnaW5uaW5nIHdpdGggYCMjIERQOicgYXJlIGEgZGVzY3JpcHRpb24gb2YgdGhl
IHBhdGNoLgojIyBEUDogTm8gZGVzY3JpcHRpb24uCgpARFBBVENIQApkaWZmIC11ck5hZCAnLS1l
eGNsdWRlPUNWUycgJy0tZXhjbHVkZT0uc3ZuJyAnLS1leGNsdWRlPS5naXQnICctLWV4Y2x1ZGU9
LmFyY2gnICctLWV4Y2x1ZGU9LmhnJyAnLS1leGNsdWRlPV9kYXJjcycgJy0tZXhjbHVkZT0uYnpy
JyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L2xpYi9jaGVja3B3LmMgY3lydXMtc2FzbDItMi4x
LjIzLmRmc2cxL2xpYi9jaGVja3B3LmMKLS0tIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMX4vbGli
L2NoZWNrcHcuYwkyMDA5LTA0LTI4IDE3OjA5OjE1LjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMt
c2FzbDItMi4xLjIzLmRmc2cxL2xpYi9jaGVja3B3LmMJMjAxMS0wNS0yMiAxMTowOTozNS4wMDAw
MDAwMDAgKzAyMDAKQEAgLTU1Myw2ICs1NTMsOCBAQAogICAgIGNoYXIgcHdwYXRoW3NpemVvZihz
cnZhZGRyLnN1bl9wYXRoKV07CiAgICAgY29uc3QgY2hhciAqcCA9IE5VTEw7CiAgICAgY2hhciAq
ZnJlZW1lID0gTlVMTDsKKyAgICBjaGFyICpmcmVlbWV0b28gPSBOVUxMOworICAgIGNvbnN0IGNo
YXIgKmNsaWVudF9hZGRyID0gTlVMTDsKICNpZmRlZiBVU0VfRE9PUlMKICAgICBkb29yX2FyZ190
IGFyZzsKICNlbmRpZgpAQCAtNTg0LDIwICs1ODYsMjcgQEAKIAl1c2VyX3JlYWxtID0gcnRtcCAr
IDE7CiAgICAgfQogCisgICAgaWYgKHNhc2xfZ2V0cHJvcChjb25uLCBTQVNMX0lQUkVNT1RFUE9S
VCwgKGNvbnN0IHZvaWQgKiopICYgY2xpZW50X2FkZHIpID09IFNBU0xfT0spIHsKKyAgICAgICAg
aWYoX3Nhc2xfc3RyZHVwKGNsaWVudF9hZGRyLCAmZnJlZW1ldG9vLCBOVUxMKSAhPSBTQVNMX09L
KQorICAgICAgICAgICAgZ290byBmYWlsOworICAgICAgICBjbGllbnRfYWRkciA9IGZyZWVtZXRv
bzsKKyAgICB9CisKICAgICAvKgogICAgICAqIGJ1aWxkIHJlcXVlc3Qgb2YgdGhlIGZvcm06CiAg
ICAgICoKLSAgICAgKiBjb3VudCBhdXRoaWQgY291bnQgcGFzc3dvcmQgY291bnQgc2VydmljZSBj
b3VudCByZWFsbQorICAgICAqIGNvdW50IGF1dGhpZCBjb3VudCBwYXNzd29yZCBjb3VudCBzZXJ2
aWNlIGNvdW50IHJlYWxtIGNvdW50IGNsaWVudAogICAgICAqLwogICAgIHsKLSAJdW5zaWduZWQg
c2hvcnQgdV9sZW4sIHBfbGVuLCBzX2xlbiwgcl9sZW47CisgCXVuc2lnbmVkIHNob3J0IHVfbGVu
LCBwX2xlbiwgc19sZW4sIHJfbGVuLCBjX2xlbjsKICAKICAJdV9sZW4gPSAoc3RybGVuKHVzZXJp
ZCkpOwogIAlwX2xlbiA9IChzdHJsZW4ocGFzc3dkKSk7CiAJc19sZW4gPSAoc3RybGVuKHNlcnZp
Y2UpKTsKIAlyX2xlbiA9ICgodXNlcl9yZWFsbSA/IHN0cmxlbih1c2VyX3JlYWxtKSA6IDApKTsK
KwljX2xlbiA9ICgoY2xpZW50X2FkZHIgPyBzdHJsZW4oY2xpZW50X2FkZHIpOiAwKSk7CiAKLQlp
ZiAodV9sZW4gKyBwX2xlbiArIHNfbGVuICsgcl9sZW4gKyAzMCA+ICh1bnNpZ25lZCBzaG9ydCkg
c2l6ZW9mKHF1ZXJ5KSkgeworCWlmICh1X2xlbiArIHBfbGVuICsgc19sZW4gKyByX2xlbiArIGNf
bGVuICsgMzAgPiAodW5zaWduZWQgc2hvcnQpIHNpemVvZihxdWVyeSkpIHsKIAkgICAgLyogcmVx
dWVzdCBqdXN0IHRvbyBkYW1uIGJpZyAqLwogICAgICAgICAgICAgc2FzbF9zZXRlcnJvcihjb25u
LCAwLCAic2FzbGF1dGhkIHJlcXVlc3QgdG9vIGxhcmdlIik7CiAJICAgIGdvdG8gZmFpbDsKQEAg
LTYwNyw2ICs2MTYsNyBAQAogCXBfbGVuID0gaHRvbnMocF9sZW4pOwogCXNfbGVuID0gaHRvbnMo
c19sZW4pOwogCXJfbGVuID0gaHRvbnMocl9sZW4pOworCWNfbGVuID0gaHRvbnMoY19sZW4pOwog
CiAJbWVtY3B5KHF1ZXJ5X2VuZCwgJnVfbGVuLCBzaXplb2YodW5zaWduZWQgc2hvcnQpKTsKIAlx
dWVyeV9lbmQgKz0gc2l6ZW9mKHVuc2lnbmVkIHNob3J0KTsKQEAgLTYyMyw2ICs2MzMsMTEgQEAK
IAltZW1jcHkocXVlcnlfZW5kLCAmcl9sZW4sIHNpemVvZih1bnNpZ25lZCBzaG9ydCkpOwogCXF1
ZXJ5X2VuZCArPSBzaXplb2YodW5zaWduZWQgc2hvcnQpOwogCWlmICh1c2VyX3JlYWxtKSB3aGls
ZSAoKnVzZXJfcmVhbG0pICpxdWVyeV9lbmQrKyA9ICp1c2VyX3JlYWxtKys7CisKKwltZW1jcHko
cXVlcnlfZW5kLCAmY19sZW4sIHNpemVvZih1bnNpZ25lZCBzaG9ydCkpOworCXF1ZXJ5X2VuZCAr
PSBzaXplb2YodW5zaWduZWQgc2hvcnQpOworCWlmKGNsaWVudF9hZGRyKSB3aGlsZSAoKmNsaWVu
dF9hZGRyKSAqcXVlcnlfZW5kKysgPSAqY2xpZW50X2FkZHIrKzsKKwogICAgIH0KIAogI2lmZGVm
IFVTRV9ET09SUwpAQCAtNzIzLDcgKzczOCw4IEBACiAgICAgY2xvc2Uocyk7CiAjZW5kaWYgLyog
VVNFX0RPT1JTICovCiAgIAotICAgIGlmKGZyZWVtZSkgZnJlZShmcmVlbWUpOworICAgIGlmIChm
cmVlbWUpIGZyZWUoZnJlZW1lKTsKKyAgICBpZiAoZnJlZW1ldG9vKSBmcmVlKGZyZWVtZXRvbyk7
CiAKICAgICBpZiAoIXN0cm5jbXAocmVzcG9uc2UsICJPSyIsIDIpKSB7CiAJcmV0dXJuIFNBU0xf
T0s7CkBAIC03MzQsNiArNzUwLDcgQEAKIAogIGZhaWw6CiAgICAgaWYgKGZyZWVtZSkgZnJlZShm
cmVlbWUpOworICAgIGlmIChmcmVlbWV0b28pIGZyZWUoZnJlZW1ldG9vKTsKICAgICByZXR1cm4g
U0FTTF9GQUlMOwogfQogCmRpZmYgLXVyTmFkICctLWV4Y2x1ZGU9Q1ZTJyAnLS1leGNsdWRlPS5z
dm4nICctLWV4Y2x1ZGU9LmdpdCcgJy0tZXhjbHVkZT0uYXJjaCcgJy0tZXhjbHVkZT0uaGcnICct
LWV4Y2x1ZGU9X2RhcmNzJyAnLS1leGNsdWRlPS5ienInIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNn
MX4vc2FzbGF1dGhkL2F1dGhfZGNlLmMgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxL3Nhc2xhdXRo
ZC9hdXRoX2RjZS5jCi0tLSBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9hdXRo
X2RjZS5jCTIwMDEtMTItMDQgMDM6MDY6NTQuMDAwMDAwMDAwICswMTAwCisrKyBjeXJ1cy1zYXNs
Mi0yLjEuMjMuZGZzZzEvc2FzbGF1dGhkL2F1dGhfZGNlLmMJMjAxMS0wNS0yMiAxMTowOTozNS4w
MDAwMDAwMDAgKzAyMDAKQEAgLTU2LDcgKzU2LDggQEAKICAgY29uc3QgY2hhciAqbG9naW4sCQkJ
LyogSTogcGxhaW50ZXh0IGF1dGhlbnRpY2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQs
CQkJLyogSTogcGxhaW50ZXh0IHBhc3N3b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UgX19h
dHRyaWJ1dGVfXygodW51c2VkKSksCi0gIGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0cmlidXRlX18o
KHVudXNlZCkpCisgIGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAor
ICBjb25zdCBjaGFyICpyZW1vdGUKICAgLyogRU5EIFBBUkFNRVRFUlMgKi8KICAgKQogewpAQCAt
MTA0LDcgKzEwNSw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2luIF9fYXR0cmlidXRlX18oKHVudXNl
ZCkpLAogICBjb25zdCBjaGFyICpwYXNzd29yZCBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICAg
Y29uc3QgY2hhciAqc2VydmljZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKLSAgY29uc3QgY2hh
ciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSkKKyAgY29uc3QgY2hhciAqcmVhbG0gX19h
dHRyaWJ1dGVfXygodW51c2VkKSksCisgIGNvbnN0IGNoYXIgKnJlbW90ZSBfX2F0dHJpYnV0ZV9f
KCh1bnVzZWQpKQogICApCiB7CiAgICAgIHJldHVybiBOVUxMOwpkaWZmIC11ck5hZCAnLS1leGNs
dWRlPUNWUycgJy0tZXhjbHVkZT0uc3ZuJyAnLS1leGNsdWRlPS5naXQnICctLWV4Y2x1ZGU9LmFy
Y2gnICctLWV4Y2x1ZGU9LmhnJyAnLS1leGNsdWRlPV9kYXJjcycgJy0tZXhjbHVkZT0uYnpyJyBj
eXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9hdXRoX2RjZS5oIGN5cnVzLXNhc2wy
LTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9kY2UuaAotLS0gY3lydXMtc2FzbDItMi4xLjIz
LmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9kY2UuaAkyMDAxLTEyLTA0IDAzOjA2OjU0LjAwMDAwMDAw
MCArMDEwMAorKysgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxL3Nhc2xhdXRoZC9hdXRoX2RjZS5o
CTIwMTEtMDUtMjIgMTE6MDk6MzUuMDAwMDAwMDAwICswMjAwCkBAIC0yNiw0ICsyNiw0IEBACiAg
KiBFTkQgQ09QWVJJR0hUCiAgKi8KIAotY2hhciAqYXV0aF9kY2UoY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKK2NoYXIgKmF1dGhfZGNlKGNv
bnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29u
c3QgY2hhciAqKTsKZGlmZiAtdXJOYWQgJy0tZXhjbHVkZT1DVlMnICctLWV4Y2x1ZGU9LnN2bicg
Jy0tZXhjbHVkZT0uZ2l0JyAnLS1leGNsdWRlPS5hcmNoJyAnLS1leGNsdWRlPS5oZycgJy0tZXhj
bHVkZT1fZGFyY3MnICctLWV4Y2x1ZGU9LmJ6cicgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9z
YXNsYXV0aGQvYXV0aF9nZXRwd2VudC5jIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0
aGQvYXV0aF9nZXRwd2VudC5jCi0tLSBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRo
ZC9hdXRoX2dldHB3ZW50LmMJMjAwOS0wNC0yOCAxNzowOToxOC4wMDAwMDAwMDAgKzAyMDAKKysr
IGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9nZXRwd2VudC5jCTIwMTEt
MDUtMjIgMTE6MDk6MzUuMDAwMDAwMDAwICswMjAwCkBAIC02NCw3ICs2NCw4IEBACiAgIGNvbnN0
IGNoYXIgKmxvZ2luLAkJCS8qIEk6IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAgIGNvbnN0
IGNoYXIgKnBhc3N3b3JkLAkJCS8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBjb25zdCBj
aGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFs
bSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0
ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAv
KiBJOiByZW1vdGUgaG9zdCBhZGRyZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkK
IHsKZGlmZiAtdXJOYWQgJy0tZXhjbHVkZT1DVlMnICctLWV4Y2x1ZGU9LnN2bicgJy0tZXhjbHVk
ZT0uZ2l0JyAnLS1leGNsdWRlPS5hcmNoJyAnLS1leGNsdWRlPS5oZycgJy0tZXhjbHVkZT1fZGFy
Y3MnICctLWV4Y2x1ZGU9LmJ6cicgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQv
YXV0aF9nZXRwd2VudC5oIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9n
ZXRwd2VudC5oCi0tLSBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9hdXRoX2dl
dHB3ZW50LmgJMjAwMS0xMi0wNCAwMzowNjo1NC4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNh
c2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9nZXRwd2VudC5oCTIwMTEtMDUtMjIgMTE6
MDk6MzUuMDAwMDAwMDAwICswMjAwCkBAIC0yNSw0ICsyNSw0IEBACiAgKiBEQU1BR0UuCiAgKiBF
TkQgQ09QWVJJR0hUICovCiAKLWNoYXIgKmF1dGhfZ2V0cHdlbnQoY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKK2NoYXIgKmF1dGhfZ2V0cHdl
bnQoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAq
LCBjb25zdCBjaGFyICopOwpkaWZmIC11ck5hZCAnLS1leGNsdWRlPUNWUycgJy0tZXhjbHVkZT0u
c3ZuJyAnLS1leGNsdWRlPS5naXQnICctLWV4Y2x1ZGU9LmFyY2gnICctLWV4Y2x1ZGU9LmhnJyAn
LS1leGNsdWRlPV9kYXJjcycgJy0tZXhjbHVkZT0uYnpyJyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZz
ZzF+L3Nhc2xhdXRoZC9hdXRoX2h0dHBmb3JtLmMgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxL3Nh
c2xhdXRoZC9hdXRoX2h0dHBmb3JtLmMKLS0tIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMX4vc2Fz
bGF1dGhkL2F1dGhfaHR0cGZvcm0uYwkyMDA2LTA0LTE5IDIxOjUxOjA0LjAwMDAwMDAwMCArMDIw
MAorKysgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxL3Nhc2xhdXRoZC9hdXRoX2h0dHBmb3JtLmMJ
MjAxMS0wNS0yMiAxMTowOTozNS4wMDAwMDAwMDAgKzAyMDAKQEAgLTQ2Myw3ICs0NjMsOCBAQAog
ICBjb25zdCBjaGFyICp1c2VyLAkJCS8qIEk6IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAg
IGNvbnN0IGNoYXIgKnBhc3N3b3JkLAkJCS8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBj
b25zdCBjaGFyICpzZXJ2aWNlLAotICBjb25zdCBjaGFyICpyZWFsbQorICBjb25zdCBjaGFyICpy
ZWFsbSwKKyAgY29uc3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1v
dGUgaG9zdCBhZGRyZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKZGlmZiAt
dXJOYWQgJy0tZXhjbHVkZT1DVlMnICctLWV4Y2x1ZGU9LnN2bicgJy0tZXhjbHVkZT0uZ2l0JyAn
LS1leGNsdWRlPS5hcmNoJyAnLS1leGNsdWRlPS5oZycgJy0tZXhjbHVkZT1fZGFyY3MnICctLWV4
Y2x1ZGU9LmJ6cicgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9odHRw
Zm9ybS5oIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9odHRwZm9ybS5o
Ci0tLSBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9hdXRoX2h0dHBmb3JtLmgJ
MjAwNi0wMy0xMyAyMToxNzowOS4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wyLTIuMS4y
My5kZnNnMS9zYXNsYXV0aGQvYXV0aF9odHRwZm9ybS5oCTIwMTEtMDUtMjIgMTE6MDk6MzUuMDAw
MDAwMDAwICswMjAwCkBAIC0yNSw1ICsyNSw1IEBACiAgKiBEQU1BR0UuCiAgKiBFTkQgQ09QWVJJ
R0hUICovCiAKLWNoYXIgKmF1dGhfaHR0cGZvcm0oY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICos
IGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKK2NoYXIgKmF1dGhfaHR0cGZvcm0oY29uc3Qg
Y2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBj
aGFyICopOwogaW50IGF1dGhfaHR0cGZvcm1faW5pdCh2b2lkKTsKZGlmZiAtdXJOYWQgJy0tZXhj
bHVkZT1DVlMnICctLWV4Y2x1ZGU9LnN2bicgJy0tZXhjbHVkZT0uZ2l0JyAnLS1leGNsdWRlPS5h
cmNoJyAnLS1leGNsdWRlPS5oZycgJy0tZXhjbHVkZT1fZGFyY3MnICctLWV4Y2x1ZGU9LmJ6cicg
Y3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9rcmI0LmMgY3lydXMtc2Fz
bDItMi4xLjIzLmRmc2cxL3Nhc2xhdXRoZC9hdXRoX2tyYjQuYwotLS0gY3lydXMtc2FzbDItMi4x
LjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9rcmI0LmMJMjAwNS0wMi0wMSAxMzoyNjozNC4wMDAw
MDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9r
cmI0LmMJMjAxMS0wNS0yMiAxMTowOTozNS4wMDAwMDAwMDAgKzAyMDAKQEAgLTE3MSw3ICsxNzEs
OCBAQAogICBjb25zdCBjaGFyICpsb2dpbiwJCQkvKiBJOiBwbGFpbnRleHQgYXV0aGVudGljYXRv
ciAqLwogICBjb25zdCBjaGFyICpwYXNzd29yZCwJCQkvKiBJOiBwbGFpbnRleHQgcGFzc3dvcmQg
Ki8KICAgY29uc3QgY2hhciAqc2VydmljZSwKLSAgY29uc3QgY2hhciAqcmVhbG1faW4KKyAgY29u
c3QgY2hhciAqcmVhbG1faW4sCisgIGNvbnN0IGNoYXIgKnJlbW90ZSAgICAgICAgICAgICAgICAg
ICAgLyogSTogcmVtb3RlIGhvc3QgYWRkcmVzcyAqLwogICAvKiBFTkQgUEFSQU1FVEVSUyAqLwog
ICApCiB7CkBAIC0yODIsNyArMjgzLDggQEAKICAgY29uc3QgY2hhciAqbG9naW4gX19hdHRyaWJ1
dGVfXygodW51c2VkKSksCiAgIGNvbnN0IGNoYXIgKnBhc3N3b3JkIF9fYXR0cmlidXRlX18oKHVu
dXNlZCkpLAogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAot
ICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFy
ICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlIF9f
YXR0cmlidXRlX18oKHVudXNlZCkpCiAgICkKIHsKICAgICByZXR1cm4gTlVMTDsKZGlmZiAtdXJO
YWQgJy0tZXhjbHVkZT1DVlMnICctLWV4Y2x1ZGU9LnN2bicgJy0tZXhjbHVkZT0uZ2l0JyAnLS1l
eGNsdWRlPS5hcmNoJyAnLS1leGNsdWRlPS5oZycgJy0tZXhjbHVkZT1fZGFyY3MnICctLWV4Y2x1
ZGU9LmJ6cicgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9rcmI0Lmgg
Y3lydXMtc2FzbDItMi4xLjIzLmRmc2cxL3Nhc2xhdXRoZC9hdXRoX2tyYjQuaAotLS0gY3lydXMt
c2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9rcmI0LmgJMjAwMS0xMi0wNCAwMzow
Njo1NC4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0
aGQvYXV0aF9rcmI0LmgJMjAxMS0wNS0yMiAxMTowOTozNS4wMDAwMDAwMDAgKzAyMDAKQEAgLTI1
LDUgKzI1LDUgQEAKICAqIERBTUFHRS4KICAqIEVORCBDT1BZUklHSFQgKi8KIAotY2hhciAqYXV0
aF9rcmI0KGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKik7CitjaGFyICphdXRoX2tyYjQoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0
IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOwogaW50IGF1dGhfa3JiNF9pbml0
KHZvaWQpOwpkaWZmIC11ck5hZCAnLS1leGNsdWRlPUNWUycgJy0tZXhjbHVkZT0uc3ZuJyAnLS1l
eGNsdWRlPS5naXQnICctLWV4Y2x1ZGU9LmFyY2gnICctLWV4Y2x1ZGU9LmhnJyAnLS1leGNsdWRl
PV9kYXJjcycgJy0tZXhjbHVkZT0uYnpyJyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xh
dXRoZC9hdXRoX2tyYjUuYyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzEvc2FzbGF1dGhkL2F1dGhf
a3JiNS5jCi0tLSBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9hdXRoX2tyYjUu
YwkyMDA5LTA0LTI4IDE3OjA5OjE4LjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbDItMi4x
LjIzLmRmc2cxL3Nhc2xhdXRoZC9hdXRoX2tyYjUuYwkyMDExLTA1LTIyIDExOjA5OjM1LjAwMDAw
MDAwMCArMDIwMApAQCAtMTcyLDcgKzE3Miw4IEBACiAgIGNvbnN0IGNoYXIgKnVzZXIsCQkJLyog
STogcGxhaW50ZXh0IGF1dGhlbnRpY2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQsCQkJ
LyogSTogcGxhaW50ZXh0IHBhc3N3b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsICAgICAg
ICAgICAgICAgICAgLyogSTogc2VydmljZSBhdXRoZW50aWNhdGluZyB0byAqLwotICBjb25zdCBj
aGFyICpyZWFsbSAgICAgICAgICAgICAgICAgICAgIC8qIEk6IHVzZXIncyByZWFsbSAqLworICBj
b25zdCBjaGFyICpyZWFsbSwgICAgICAgICAgICAgICAgICAgIC8qIEk6IHVzZXIncyByZWFsbSAq
LworICBjb25zdCBjaGFyICpyZW1vdGUgICAgICAgICAgICAgICAgICAgIC8qIEk6IHJlbW90ZSBo
b3N0IGFkZHJlc3MgKi8KICAgLyogRU5EIFBBUkFNRVRFUlMgKi8KICAgKQogewpAQCAtMzQwLDcg
KzM0MSw4IEBACiAgIGNvbnN0IGNoYXIgKnVzZXIsCQkJLyogSTogcGxhaW50ZXh0IGF1dGhlbnRp
Y2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQsCQkJLyogSTogcGxhaW50ZXh0IHBhc3N3
b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsCQkJLyogSTogc2VydmljZSBhdXRoZW50aWNh
dGluZyB0byAqLwotICBjb25zdCBjaGFyICpyZWFsbQkJCS8qIEk6IHVzZXIncyByZWFsbSAqLwor
ICBjb25zdCBjaGFyICpyZWFsbSwJCQkvKiBJOiB1c2VyJ3MgcmVhbG0gKi8KKyAgY29uc3QgY2hh
ciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUgaG9zdCBhZGRyZXNzICov
CiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKQEAgLTQ0OCw3ICs0NTAsOCBAQAogICBj
b25zdCBjaGFyICpsb2dpbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICAgY29uc3QgY2hhciAq
cGFzc3dvcmQgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2Ug
X19hdHRyaWJ1dGVfXygodW51c2VkKSksCi0gIGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0cmlidXRl
X18oKHVudXNlZCkpCisgIGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0cmlidXRlX18oKHVudXNlZCkp
LAorICBjb25zdCBjaGFyICpyZW1vdGUgX19hdHRyaWJ1dGVfXygodW51c2VkKSkKICAgKQogewog
ICAgIHJldHVybiBOVUxMOwpkaWZmIC11ck5hZCAnLS1leGNsdWRlPUNWUycgJy0tZXhjbHVkZT0u
c3ZuJyAnLS1leGNsdWRlPS5naXQnICctLWV4Y2x1ZGU9LmFyY2gnICctLWV4Y2x1ZGU9LmhnJyAn
LS1leGNsdWRlPV9kYXJjcycgJy0tZXhjbHVkZT0uYnpyJyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZz
ZzF+L3Nhc2xhdXRoZC9hdXRoX2tyYjUuaCBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzEvc2FzbGF1
dGhkL2F1dGhfa3JiNS5oCi0tLSBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9h
dXRoX2tyYjUuaAkyMDAyLTA0LTI1IDIwOjMxOjM4LjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMt
c2FzbDItMi4xLjIzLmRmc2cxL3Nhc2xhdXRoZC9hdXRoX2tyYjUuaAkyMDExLTA1LTIyIDExOjA5
OjM1LjAwMDAwMDAwMCArMDIwMApAQCAtMjUsNSArMjUsNSBAQAogICogREFNQUdFLgogICogRU5E
IENPUFlSSUdIVCAqLwogCi1jaGFyICphdXRoX2tyYjUoY29uc3QgY2hhciAqLCBjb25zdCBjaGFy
ICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKK2NoYXIgKmF1dGhfa3JiNShjb25zdCBj
aGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKik7CiBpbnQgYXV0aF9rcmI1X2luaXQodm9pZCk7CmRpZmYgLXVyTmFkICctLWV4Y2x1ZGU9
Q1ZTJyAnLS1leGNsdWRlPS5zdm4nICctLWV4Y2x1ZGU9LmdpdCcgJy0tZXhjbHVkZT0uYXJjaCcg
Jy0tZXhjbHVkZT0uaGcnICctLWV4Y2x1ZGU9X2RhcmNzJyAnLS1leGNsdWRlPS5ienInIGN5cnVz
LXNhc2wyLTIuMS4yMy5kZnNnMX4vc2FzbGF1dGhkL2F1dGhfbGRhcC5jIGN5cnVzLXNhc2wyLTIu
MS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9sZGFwLmMKLS0tIGN5cnVzLXNhc2wyLTIuMS4yMy5k
ZnNnMX4vc2FzbGF1dGhkL2F1dGhfbGRhcC5jCTIwMDQtMTItMDggMTM6MTI6MjcuMDAwMDAwMDAw
ICswMTAwCisrKyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzEvc2FzbGF1dGhkL2F1dGhfbGRhcC5j
CTIwMTEtMDUtMjIgMTE6MDk6MzUuMDAwMDAwMDAwICswMjAwCkBAIC02MCw3ICs2MCw4IEBACiAg
IGNvbnN0IGNoYXIgKmxvZ2luLAkJCS8qIEk6IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAg
IGNvbnN0IGNoYXIgKnBhc3N3b3JkLAkJCS8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBj
b25zdCBjaGFyICpzZXJ2aWNlLAotICBjb25zdCBjaGFyICpyZWFsbQorICBjb25zdCBjaGFyICpy
ZWFsbSwKKyAgY29uc3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1v
dGUgaG9zdCBhZGRyZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKQEAgLTEx
Niw3ICsxMTcsOCBAQAogICBjb25zdCBjaGFyICpsb2dpbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQp
KSwKICAgY29uc3QgY2hhciAqcGFzc3dvcmQgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgIGNv
bnN0IGNoYXIgKnNlcnZpY2UgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCi0gIGNvbnN0IGNoYXIg
KnJlYWxtIF9fYXR0cmlidXRlX18oKHVudXNlZCkpCisgIGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0
cmlidXRlX18oKHVudXNlZCkpLAorICBjb25zdCBjaGFyICpyZW1vdGUgX19hdHRyaWJ1dGVfXygo
dW51c2VkKSkKICAgKQogewogICAgICByZXR1cm4gTlVMTDsKZGlmZiAtdXJOYWQgJy0tZXhjbHVk
ZT1DVlMnICctLWV4Y2x1ZGU9LnN2bicgJy0tZXhjbHVkZT0uZ2l0JyAnLS1leGNsdWRlPS5hcmNo
JyAnLS1leGNsdWRlPS5oZycgJy0tZXhjbHVkZT1fZGFyY3MnICctLWV4Y2x1ZGU9LmJ6cicgY3ly
dXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9sZGFwLmggY3lydXMtc2FzbDIt
Mi4xLjIzLmRmc2cxL3Nhc2xhdXRoZC9hdXRoX2xkYXAuaAotLS0gY3lydXMtc2FzbDItMi4xLjIz
LmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9sZGFwLmgJMjAwMi0wNi0xOSAxOTozNToyOS4wMDAwMDAw
MDAgKzAyMDAKKysrIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9sZGFw
LmgJMjAxMS0wNS0yMiAxMTowOTozNS4wMDAwMDAwMDAgKzAyMDAKQEAgLTI1LDUgKzI1LDUgQEAK
ICAqIERBTUFHRS4KICAqIEVORCBDT1BZUklHSFQgKi8KIAotY2hhciAqYXV0aF9sZGFwKGNvbnN0
IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CitjaGFy
ICphdXRoX2xkYXAoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29u
c3QgY2hhciAqLCBjb25zdCBjaGFyICopOwogaW50IGF1dGhfbGRhcF9pbml0KHZvaWQpOwpkaWZm
IC11ck5hZCAnLS1leGNsdWRlPUNWUycgJy0tZXhjbHVkZT0uc3ZuJyAnLS1leGNsdWRlPS5naXQn
ICctLWV4Y2x1ZGU9LmFyY2gnICctLWV4Y2x1ZGU9LmhnJyAnLS1leGNsdWRlPV9kYXJjcycgJy0t
ZXhjbHVkZT0uYnpyJyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9hdXRoX3Bh
bS5jIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9wYW0uYwotLS0gY3ly
dXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9wYW0uYwkyMDA1LTA1LTE1IDA4
OjQzOjE5LjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxL3Nhc2xh
dXRoZC9hdXRoX3BhbS5jCTIwMTEtMDUtMjIgMTE6MDk6MzUuMDAwMDAwMDAwICswMjAwCkBAIC0x
ODYsNyArMTg2LDggQEAKICAgY29uc3QgY2hhciAqbG9naW4sCQkJLyogSTogcGxhaW50ZXh0IGF1
dGhlbnRpY2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQsCQkJLyogSTogcGxhaW50ZXh0
IHBhc3N3b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsCQkJLyogSTogc2VydmljZSBuYW1l
ICovCi0gIGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0cmlidXRlX18oKHVudXNlZCkpCisgIGNvbnN0
IGNoYXIgKnJlYWxtIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAorICBjb25zdCBjaGFyICpyZW1v
dGUgICAgICAgICAgICAgICAgICAgIC8qIEk6IHJlbW90ZSBob3N0IGFkZHJlc3MgKi8KICAgLyog
RU5EIFBBUkFNRVRFUlMgKi8KICAgKQogewpAQCAtMjEzLDYgKzIxNCwxNCBAQAogCiAgICAgbXlf
YXBwZGF0YS5wYW1oID0gcGFtaDsKIAorICAgIGNoYXIgKiByZW1vdGVfaG9zdCA9IHN0cmR1cChy
ZW1vdGUpOworICAgIGlmIChyZW1vdGVfaG9zdCkgeworCWNoYXIgKiBzZW1pY29sID0gc3RyY2hy
KHJlbW90ZV9ob3N0LCAnOycpOworCWlmIChzZW1pY29sKSAqIHNlbWljb2wgPSBOVUxMOyAvKiB0
cnVuY2F0ZSByZW1vdGVfaG9zdCBhdCB0aGUgJzsnIHBvcnQgc2VwYXJhdG9yICovCisJcGFtX3Nl
dF9pdGVtKHBhbWgsIFBBTV9SSE9TVCwgcmVtb3RlX2hvc3QpOworCWZyZWUgKHJlbW90ZV9ob3N0
KTsKKyAgICB9CisKICAgICByYyA9IHBhbV9hdXRoZW50aWNhdGUocGFtaCwgUEFNX1NJTEVOVCk7
CiAgICAgaWYgKHJjICE9IFBBTV9TVUNDRVNTKSB7CiAJc3lzbG9nKExPR19ERUJVRywgIkRFQlVH
OiBhdXRoX3BhbTogcGFtX2F1dGhlbnRpY2F0ZSBmYWlsZWQ6ICVzIiwKQEAgLTI0Miw3ICsyNTEs
OCBAQAogICBjb25zdCBjaGFyICpsb2dpbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICAgY29u
c3QgY2hhciAqcGFzc3dvcmQgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgIGNvbnN0IGNoYXIg
KnNlcnZpY2UgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCi0gIGNvbnN0IGNoYXIgKnJlYWxtIF9f
YXR0cmlidXRlX18oKHVudXNlZCkpCisgIGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0cmlidXRlX18o
KHVudXNlZCkpLAorICBjb25zdCBjaGFyICpyZW1vdGUgX19hdHRyaWJ1dGVfXygodW51c2VkKSkK
ICAgKQogewogICAgIHJldHVybiBOVUxMOwpkaWZmIC11ck5hZCAnLS1leGNsdWRlPUNWUycgJy0t
ZXhjbHVkZT0uc3ZuJyAnLS1leGNsdWRlPS5naXQnICctLWV4Y2x1ZGU9LmFyY2gnICctLWV4Y2x1
ZGU9LmhnJyAnLS1leGNsdWRlPV9kYXJjcycgJy0tZXhjbHVkZT0uYnpyJyBjeXJ1cy1zYXNsMi0y
LjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9hdXRoX3BhbS5oIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNn
MS9zYXNsYXV0aGQvYXV0aF9wYW0uaAotLS0gY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNs
YXV0aGQvYXV0aF9wYW0uaAkyMDAxLTEyLTA0IDAzOjA2OjU0LjAwMDAwMDAwMCArMDEwMAorKysg
Y3lydXMtc2FzbDItMi4xLjIzLmRmc2cxL3Nhc2xhdXRoZC9hdXRoX3BhbS5oCTIwMTEtMDUtMjIg
MTE6MDk6MzUuMDAwMDAwMDAwICswMjAwCkBAIC0zMiw0ICszMiw0IEBACiAgKiBEQU1BR0UuCiAg
KiBFTkQgQ09QWVJJR0hUICovCiAKLWNoYXIgKmF1dGhfcGFtKGNvbnN0IGNoYXIgKiwgY29uc3Qg
Y2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CitjaGFyICphdXRoX3BhbShjb25z
dCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0
IGNoYXIgKik7CmRpZmYgLXVyTmFkICctLWV4Y2x1ZGU9Q1ZTJyAnLS1leGNsdWRlPS5zdm4nICct
LWV4Y2x1ZGU9LmdpdCcgJy0tZXhjbHVkZT0uYXJjaCcgJy0tZXhjbHVkZT0uaGcnICctLWV4Y2x1
ZGU9X2RhcmNzJyAnLS1leGNsdWRlPS5ienInIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMX4vc2Fz
bGF1dGhkL2F1dGhfcmltYXAuYyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzEvc2FzbGF1dGhkL2F1
dGhfcmltYXAuYwotLS0gY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9y
aW1hcC5jCTIwMTEtMDUtMjIgMTE6MDk6MDEuMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1zYXNs
Mi0yLjEuMjMuZGZzZzEvc2FzbGF1dGhkL2F1dGhfcmltYXAuYwkyMDExLTA1LTIyIDExOjA5OjM1
LjAwMDAwMDAwMCArMDIwMApAQCAtMjk4LDcgKzI5OCw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2lu
LAkJCS8qIEk6IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAgIGNvbnN0IGNoYXIgKnBhc3N3
b3JkLAkJCS8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBjb25zdCBjaGFyICpzZXJ2aWNl
IF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0
ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQp
KSwKKyAgY29uc3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUg
aG9zdCBhZGRyZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKZGlmZiAtdXJO
YWQgJy0tZXhjbHVkZT1DVlMnICctLWV4Y2x1ZGU9LnN2bicgJy0tZXhjbHVkZT0uZ2l0JyAnLS1l
eGNsdWRlPS5hcmNoJyAnLS1leGNsdWRlPS5oZycgJy0tZXhjbHVkZT1fZGFyY3MnICctLWV4Y2x1
ZGU9LmJ6cicgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9yaW1hcC5o
IGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9yaW1hcC5oCi0tLSBjeXJ1
cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9hdXRoX3JpbWFwLmgJMjAwMS0xMi0wNCAw
MzowNjo1NC4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNs
YXV0aGQvYXV0aF9yaW1hcC5oCTIwMTEtMDUtMjIgMTE6MDk6MzUuMDAwMDAwMDAwICswMjAwCkBA
IC0yNSw1ICsyNSw1IEBACiAgKiBEQU1BR0UuCiAgKiBFTkQgQ09QWVJJR0hUICovCiAKLWNoYXIg
KmF1dGhfcmltYXAoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29u
c3QgY2hhciAqKTsKK2NoYXIgKmF1dGhfcmltYXAoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICos
IGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOwogaW50IGF1dGhfcmlt
YXBfaW5pdCh2b2lkKTsKZGlmZiAtdXJOYWQgJy0tZXhjbHVkZT1DVlMnICctLWV4Y2x1ZGU9LnN2
bicgJy0tZXhjbHVkZT0uZ2l0JyAnLS1leGNsdWRlPS5hcmNoJyAnLS1leGNsdWRlPS5oZycgJy0t
ZXhjbHVkZT1fZGFyY3MnICctLWV4Y2x1ZGU9LmJ6cicgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cx
fi9zYXNsYXV0aGQvYXV0aF9zYXNsZGIuYyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzEvc2FzbGF1
dGhkL2F1dGhfc2FzbGRiLmMKLS0tIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMX4vc2FzbGF1dGhk
L2F1dGhfc2FzbGRiLmMJMjAxMS0wNS0yMiAxMTowOTowMS4wMDAwMDAwMDAgKzAyMDAKKysrIGN5
cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9zYXNsZGIuYwkyMDExLTA1LTIy
IDExOjA5OjM1LjAwMDAwMDAwMCArMDIwMApAQCAtMTE4LDEzICsxMTgsMTQgQEAKICAgY29uc3Qg
Y2hhciAqbG9naW4sCQkJLyogSTogcGxhaW50ZXh0IGF1dGhlbnRpY2F0b3IgKi8KICAgY29uc3Qg
Y2hhciAqcGFzc3dvcmQsCQkJLyogSTogcGxhaW50ZXh0IHBhc3N3b3JkICovCiAgIGNvbnN0IGNo
YXIgKnNlcnZpY2UgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCi0gIGNvbnN0IGNoYXIgKnJlYWxt
CisgIGNvbnN0IGNoYXIgKnJlYWxtLAogI2Vsc2UKICAgY29uc3QgY2hhciAqbG9naW4gX19hdHRy
aWJ1dGVfXygodW51c2VkKSksLyogSTogcGxhaW50ZXh0IGF1dGhlbnRpY2F0b3IgKi8KICAgY29u
c3QgY2hhciAqcGFzc3dvcmQgX19hdHRyaWJ1dGVfXygodW51c2VkKSksICAvKiBJOiBwbGFpbnRl
eHQgcGFzc3dvcmQgKi8KICAgY29uc3QgY2hhciAqc2VydmljZSBfX2F0dHJpYnV0ZV9fKCh1bnVz
ZWQpKSwKLSAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSkKKyAgY29u
c3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAjZW5kaWYKKyAgY29uc3Qg
Y2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUgaG9zdCBhZGRyZXNz
ICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKZGlmZiAtdXJOYWQgJy0tZXhjbHVk
ZT1DVlMnICctLWV4Y2x1ZGU9LnN2bicgJy0tZXhjbHVkZT0uZ2l0JyAnLS1leGNsdWRlPS5hcmNo
JyAnLS1leGNsdWRlPS5oZycgJy0tZXhjbHVkZT1fZGFyY3MnICctLWV4Y2x1ZGU9LmJ6cicgY3ly
dXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9zYXNsZGIuaCBjeXJ1cy1zYXNs
Mi0yLjEuMjMuZGZzZzEvc2FzbGF1dGhkL2F1dGhfc2FzbGRiLmgKLS0tIGN5cnVzLXNhc2wyLTIu
MS4yMy5kZnNnMX4vc2FzbGF1dGhkL2F1dGhfc2FzbGRiLmgJMjAwMS0xMi0wNCAwMzowNjo1NS4w
MDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0
aF9zYXNsZGIuaAkyMDExLTA1LTIyIDExOjA5OjM1LjAwMDAwMDAwMCArMDIwMApAQCAtMjUsNCAr
MjUsNCBAQAogICogREFNQUdFLgogICogRU5EIENPUFlSSUdIVCAqLwogCi1jaGFyICphdXRoX3Nh
c2xkYihjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFy
ICopOworY2hhciAqYXV0aF9zYXNsZGIoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0
IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOwpkaWZmIC11ck5hZCAnLS1leGNs
dWRlPUNWUycgJy0tZXhjbHVkZT0uc3ZuJyAnLS1leGNsdWRlPS5naXQnICctLWV4Y2x1ZGU9LmFy
Y2gnICctLWV4Y2x1ZGU9LmhnJyAnLS1leGNsdWRlPV9kYXJjcycgJy0tZXhjbHVkZT0uYnpyJyBj
eXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9hdXRoX3NoYWRvdy5jIGN5cnVzLXNh
c2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9zaGFkb3cuYwotLS0gY3lydXMtc2FzbDIt
Mi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9zaGFkb3cuYwkyMDExLTA1LTIyIDExOjA5OjAx
LjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxL3Nhc2xhdXRoZC9h
dXRoX3NoYWRvdy5jCTIwMTEtMDUtMjIgMTE6MDk6MzUuMDAwMDAwMDAwICswMjAwCkBAIC04Miw3
ICs4Miw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2luLAkJCS8qIEk6IHBsYWludGV4dCBhdXRoZW50
aWNhdG9yICovCiAgIGNvbnN0IGNoYXIgKnBhc3N3b3JkLAkJCS8qIEk6IHBsYWludGV4dCBwYXNz
d29yZCAqLwogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAot
ICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFy
ICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlICAg
ICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUgaG9zdCBhZGRyZXNzICovCiAgIC8qIEVORCBQ
QVJBTUVURVJTICovCiAgICkKIHsKQEAgLTI3Niw3ICsyNzcsOCBAQAogICBjb25zdCBjaGFyICps
b2dpbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICAgY29uc3QgY2hhciAqcGFzc3dkIF9fYXR0
cmlidXRlX18oKHVudXNlZCkpLAogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18o
KHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQor
ICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hh
ciAqcmVtb3RlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpCiAgICkKIHsKICAgICByZXR1cm4gTlVM
TDsKZGlmZiAtdXJOYWQgJy0tZXhjbHVkZT1DVlMnICctLWV4Y2x1ZGU9LnN2bicgJy0tZXhjbHVk
ZT0uZ2l0JyAnLS1leGNsdWRlPS5hcmNoJyAnLS1leGNsdWRlPS5oZycgJy0tZXhjbHVkZT1fZGFy
Y3MnICctLWV4Y2x1ZGU9LmJ6cicgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQv
YXV0aF9zaGFkb3cuaCBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzEvc2FzbGF1dGhkL2F1dGhfc2hh
ZG93LmgKLS0tIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMX4vc2FzbGF1dGhkL2F1dGhfc2hhZG93
LmgJMjAwMS0xMi0wNCAwMzowNjo1NS4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wyLTIu
MS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9zaGFkb3cuaAkyMDExLTA1LTIyIDExOjA5OjM1LjAw
MDAwMDAwMCArMDIwMApAQCAtMjUsNCArMjUsNCBAQAogICogREFNQUdFLgogICogRU5EIENPUFlS
SUdIVCAqLwogCi1jaGFyICphdXRoX3NoYWRvdyhjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwg
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOworY2hhciAqYXV0aF9zaGFkb3coY29uc3QgY2hh
ciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFy
ICopOwpkaWZmIC11ck5hZCAnLS1leGNsdWRlPUNWUycgJy0tZXhjbHVkZT0uc3ZuJyAnLS1leGNs
dWRlPS5naXQnICctLWV4Y2x1ZGU9LmFyY2gnICctLWV4Y2x1ZGU9LmhnJyAnLS1leGNsdWRlPV9k
YXJjcycgJy0tZXhjbHVkZT0uYnpyJyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRo
ZC9hdXRoX3NpYS5jIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9zaWEu
YwotLS0gY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvYXV0aF9zaWEuYwkyMDAx
LTEyLTA0IDAzOjA2OjU1LjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMtc2FzbDItMi4xLjIzLmRm
c2cxL3Nhc2xhdXRoZC9hdXRoX3NpYS5jCTIwMTEtMDUtMjIgMTE6MDk6MzUuMDAwMDAwMDAwICsw
MjAwCkBAIC01Niw3ICs1Niw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2luLAkJCS8qIEk6IHBsYWlu
dGV4dCBhdXRoZW50aWNhdG9yICovCiAgIGNvbnN0IGNoYXIgKnBhc3N3b3JkLAkJCS8qIEk6IHBs
YWludGV4dCBwYXNzd29yZCAqLwogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18o
KHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQor
ICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hh
ciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUgaG9zdCBhZGRyZXNzICov
CiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKQEAgLTg0LDcgKzg1LDggQEAKICAgY29u
c3QgY2hhciAqbG9naW4gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgIGNvbnN0IGNoYXIgKnBh
c3N3b3JkIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9f
YXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9f
KCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwK
KyAgY29uc3QgY2hhciAqcmVtb3RlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpCiAgICkKIHsKICAg
ICByZXR1cm4gTlVMTDsKZGlmZiAtdXJOYWQgJy0tZXhjbHVkZT1DVlMnICctLWV4Y2x1ZGU9LnN2
bicgJy0tZXhjbHVkZT0uZ2l0JyAnLS1leGNsdWRlPS5hcmNoJyAnLS1leGNsdWRlPS5oZycgJy0t
ZXhjbHVkZT1fZGFyY3MnICctLWV4Y2x1ZGU9LmJ6cicgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cx
fi9zYXNsYXV0aGQvYXV0aF9zaWEuaCBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzEvc2FzbGF1dGhk
L2F1dGhfc2lhLmgKLS0tIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMX4vc2FzbGF1dGhkL2F1dGhf
c2lhLmgJMjAwMS0xMi0wNCAwMzowNjo1NS4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wy
LTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvYXV0aF9zaWEuaAkyMDExLTA1LTIyIDExOjA5OjM1LjAw
MDAwMDAwMCArMDIwMApAQCAtMjUsNCArMjUsNCBAQAogICogREFNQUdFLgogICogRU5EIENPUFlS
SUdIVCAqLwogCi1jaGFyICphdXRoX3NpYShjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29u
c3QgY2hhciAqLCBjb25zdCBjaGFyICopOworY2hhciAqYXV0aF9zaWEoY29uc3QgY2hhciAqLCBj
b25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOwpk
aWZmIC11ck5hZCAnLS1leGNsdWRlPUNWUycgJy0tZXhjbHVkZT0uc3ZuJyAnLS1leGNsdWRlPS5n
aXQnICctLWV4Y2x1ZGU9LmFyY2gnICctLWV4Y2x1ZGU9LmhnJyAnLS1leGNsdWRlPV9kYXJjcycg
Jy0tZXhjbHVkZT0uYnpyJyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9pcGNf
ZG9vcnMuYyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzEvc2FzbGF1dGhkL2lwY19kb29ycy5jCi0t
LSBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9pcGNfZG9vcnMuYwkyMDA0LTA0
LTI3IDE4OjAxOjUwLjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cx
L3Nhc2xhdXRoZC9pcGNfZG9vcnMuYwkyMDExLTA1LTIyIDExOjA5OjM1LjAwMDAwMDAwMCArMDIw
MApAQCAtMjE4LDYgKzIxOCw3IEBACiAJY2hhcgkJCXBhc3N3b3JkW01BWF9SRVFfTEVOICsgMV07
IC8qIHBhc3N3b3JkIGZvciBhdXRoZW50aWNhdGlvbiAgICAgICAgICAgICovCiAJY2hhcgkJCXNl
cnZpY2VbTUFYX1JFUV9MRU4gKyAxXTsgIC8qIHNlcnZpY2UgbmFtZSBmb3IgYXV0aGVudGljYXRp
b24gICAgICAgICovCiAJY2hhcgkJCXJlYWxtW01BWF9SRVFfTEVOICsgMV07ICAgIC8qIHVzZXIg
cmVhbG0gZm9yIGF1dGhlbnRpY2F0aW9uICAgICAgICAgICovCisJY2hhcgkJCWNsaWVudF9hZGRy
W01BWF9SRVFfTEVOICsgMV07ICAvKiBjbGllbnQgYWRkcmVzcyBhbmQgcG9ydCAgICAgICAgICAg
ICovCiAKIAogCS8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKgpAQCAtMjk0LDYgKzI5NSwyMiBAQAogCW1lbWNweShyZWFsbSwgZGF0
YSwgY291bnQpOwogCXJlYWxtW2NvdW50XSA9ICdcMCc7CiAKKwkvKiBjbGllbnRfYWRkciAqLwor
CW1lbWNweSgmY291bnQsIGRhdGEsIHNpemVvZih1bnNpZ25lZCBzaG9ydCkpOworCisJY291bnQg
PSBudG9ocyhjb3VudCk7CisJZGF0YSArPSBzaXplb2YodW5zaWduZWQgc2hvcnQpOworCisJaWYg
KGNvdW50ID4gTUFYX1JFUV9MRU4gfHwgZGF0YSArIGNvdW50ID4gZGF0YWVuZCkgeworCQlsb2dn
ZXIoTF9FUlIsIExfRlVOQywgImNsaWVudF9hZGRyIGV4Y2VlZHMgTUFYX1JFUV9MRU46ICVkIiwK
KwkJICAgICAgIE1BWF9SRVFfTEVOKTsKKwkJc2VuZF9ubygiIik7CisJCXJldHVybjsKKwl9CQor
CisJbWVtY3B5KGNsaWVudF9hZGRyLCBkYXRhLCBjb3VudCk7CisJY2xpZW50X2FkZHJbY291bnRd
ID0gJ1wwJzsKKwogCS8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKgogIAkgKiBXZSBkb24ndCBhbGxvdyBOVUxMIHBhc3N3b3JkcyBv
ciBsb2dpbiBuYW1lcwogCSAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKi8KQEAgLTMxMiw3ICszMjksNyBAQAogCS8qKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKgogCSAq
IEdldCB0aGUgbWVjaGFuaXNtIHJlc3BvbnNlIGZyb20gZG9fYXV0aCgpIGFuZCBzZW5kIGl0IGJh
Y2suCiAJICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqLwotCXJlc3BvbnNlID0gZG9fYXV0aChsb2dpbiwgcGFzc3dvcmQsIHNlcnZp
Y2UsIHJlYWxtKTsKKwlyZXNwb25zZSA9IGRvX2F1dGgobG9naW4sIHBhc3N3b3JkLCBzZXJ2aWNl
LCByZWFsbSwgY2xpZW50X2FkZHIpOwogCiAJbWVtc2V0KHBhc3N3b3JkLCAwLCBzdHJsZW4ocGFz
c3dvcmQpKTsKIApkaWZmIC11ck5hZCAnLS1leGNsdWRlPUNWUycgJy0tZXhjbHVkZT0uc3ZuJyAn
LS1leGNsdWRlPS5naXQnICctLWV4Y2x1ZGU9LmFyY2gnICctLWV4Y2x1ZGU9LmhnJyAnLS1leGNs
dWRlPV9kYXJjcycgJy0tZXhjbHVkZT0uYnpyJyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzF+L3Nh
c2xhdXRoZC9pcGNfdW5peC5jIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvaXBj
X3VuaXguYwotLS0gY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvaXBjX3VuaXgu
YwkyMDAzLTEwLTMwIDIwOjA2OjQyLjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMtc2FzbDItMi4x
LjIzLmRmc2cxL3Nhc2xhdXRoZC9pcGNfdW5peC5jCTIwMTEtMDUtMjIgMTE6MDk6MzUuMDAwMDAw
MDAwICswMjAwCkBAIC0zMjksNiArMzI5LDcgQEAKIAljaGFyCQkJcGFzc3dvcmRbTUFYX1JFUV9M
RU4gKyAxXTsgLyogcGFzc3dvcmQgZm9yIGF1dGhlbnRpY2F0aW9uICAgICAgICAgICAgKi8KIAlj
aGFyCQkJc2VydmljZVtNQVhfUkVRX0xFTiArIDFdOyAgLyogc2VydmljZSBuYW1lIGZvciBhdXRo
ZW50aWNhdGlvbiAgICAgICAgKi8KIAljaGFyCQkJcmVhbG1bTUFYX1JFUV9MRU4gKyAxXTsgICAg
LyogdXNlciByZWFsbSBmb3IgYXV0aGVudGljYXRpb24gICAgICAgICAgKi8KKwljaGFyCQkJY2xp
ZW50X2FkZHJbTUFYX1JFUV9MRU4gKyAxXTsgIC8qIGNsaWVudCBhZGRyZXNzIGFuZCBwb3J0ICAg
ICAgICAgICAgKi8KIAogCiAJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqCkBAIC0zOTksMTIgKzQwMCwyOCBAQAogCQlzZW5kX25v
KGNvbm5fZmQsICIiKTsKIAkJcmV0dXJuOwogCX0JCi0KIAlpZiAocnhfcmVjKGNvbm5fZmQsICh2
b2lkICopcmVhbG0sIChzaXplX3QpY291bnQpICE9IChzc2l6ZV90KWNvdW50KSAKIAkJcmV0dXJu
OwogCiAJcmVhbG1bY291bnRdID0gJ1wwJzsKIAorCS8qIGNsaWVudF9hZGRyICovCisJaWYgKHJ4
X3JlYyhjb25uX2ZkLCAodm9pZCAqKSZjb3VudCwgKHNpemVfdClzaXplb2YoY291bnQpKSAhPSAo
c3NpemVfdClzaXplb2YoY291bnQpKQorCQlyZXR1cm47CisKKwljb3VudCA9IG50b2hzKGNvdW50
KTsKKworCWlmIChjb3VudCA+IE1BWF9SRVFfTEVOKSB7CisJCWxvZ2dlcihMX0VSUiwgTF9GVU5D
LCAiY2xpZW50IGFkZHJlc3MgZXhjZWVkZWQgTUFYX1JFUV9MRU46ICVkIiwgTUFYX1JFUV9MRU4p
OworCQlzZW5kX25vKGNvbm5fZmQsICIiKTsKKwkJcmV0dXJuOworCX0KKworCWlmIChyeF9yZWMo
Y29ubl9mZCwgKHZvaWQgKikmY2xpZW50X2FkZHIsIChzaXplX3QpY291bnQpICE9IChzc2l6ZV90
KWNvdW50KQorCQlyZXR1cm47CisKKwljbGllbnRfYWRkcltjb3VudF0gPSAnXDAnOworCiAJLyoq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqCiAgCSAqIFdlIGRvbid0IGFsbG93IE5VTEwgcGFzc3dvcmRzIG9yIGxvZ2luIG5hbWVzCiAJ
ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqLwpAQCAtNDIzLDcgKzQ0MCw3IEBACiAJLyoqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAJICogR2V0IHRoZSBtZWNoYW5p
c20gcmVzcG9uc2UgZnJvbSBkb19hdXRoKCkgYW5kIHNlbmQgaXQgYmFjay4KIAkgKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi0J
cmVzcG9uc2UgPSBkb19hdXRoKGxvZ2luLCBwYXNzd29yZCwgc2VydmljZSwgcmVhbG0pOworCXJl
c3BvbnNlID0gZG9fYXV0aChsb2dpbiwgcGFzc3dvcmQsIHNlcnZpY2UsIHJlYWxtLCBjbGllbnRf
YWRkcik7CiAKIAltZW1zZXQocGFzc3dvcmQsIDAsIHN0cmxlbihwYXNzd29yZCkpOwogCmRpZmYg
LXVyTmFkICctLWV4Y2x1ZGU9Q1ZTJyAnLS1leGNsdWRlPS5zdm4nICctLWV4Y2x1ZGU9LmdpdCcg
Jy0tZXhjbHVkZT0uYXJjaCcgJy0tZXhjbHVkZT0uaGcnICctLWV4Y2x1ZGU9X2RhcmNzJyAnLS1l
eGNsdWRlPS5ienInIGN5cnVzLXNhc2wyLTIuMS4yMy5kZnNnMX4vc2FzbGF1dGhkL21lY2hhbmlz
bXMuaCBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzEvc2FzbGF1dGhkL21lY2hhbmlzbXMuaAotLS0g
Y3lydXMtc2FzbDItMi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvbWVjaGFuaXNtcy5oCTIwMDYtMDMt
MTMgMjE6MTc6MDkuMDAwMDAwMDAwICswMTAwCisrKyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzEv
c2FzbGF1dGhkL21lY2hhbmlzbXMuaAkyMDExLTA1LTIyIDExOjA5OjM1LjAwMDAwMDAwMCArMDIw
MApAQCAtNDAsOCArNDAsOCBAQAogICAgIGNoYXIgKm5hbWU7CQkJCS8qIG5hbWUgb2YgdGhlIG1l
Y2hhbmlzbSAqLwogICAgIGludCAoKmluaXRpYWxpemUpKHZvaWQpOwkJLyogaW5pdGlhbGl6YXRp
b24gZnVuY3Rpb24gKi8KICAgICBjaGFyICooKmF1dGhlbnRpY2F0ZSkoY29uc3QgY2hhciAqLCBj
b25zdCBjaGFyICosCi0JCQkgIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsgLyogYXV0aGVu
dGljYXRpb24KLQkJCQkJCQkgIGZ1bmN0aW9uICovCisJCQkgIGNvbnN0IGNoYXIgKiwgY29uc3Qg
Y2hhciAqLAorCQkJICBjb25zdCBjaGFyICopOyAvKiBhdXRoZW50aWNhdGlvbiBmdW5jdGlvbiAq
LwogfSBhdXRobWVjaF90OwogCiBleHRlcm4gYXV0aG1lY2hfdCBtZWNoYW5pc21zW107CQkvKiBh
cnJheSBvZiBzdXBwb3J0ZWQgYXV0aCBtZWNocyAqLwpkaWZmIC11ck5hZCAnLS1leGNsdWRlPUNW
UycgJy0tZXhjbHVkZT0uc3ZuJyAnLS1leGNsdWRlPS5naXQnICctLWV4Y2x1ZGU9LmFyY2gnICct
LWV4Y2x1ZGU9LmhnJyAnLS1leGNsdWRlPV9kYXJjcycgJy0tZXhjbHVkZT0uYnpyJyBjeXJ1cy1z
YXNsMi0yLjEuMjMuZGZzZzF+L3Nhc2xhdXRoZC9zYXNsYXV0aGQtbWFpbi5jIGN5cnVzLXNhc2wy
LTIuMS4yMy5kZnNnMS9zYXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uYwotLS0gY3lydXMtc2FzbDIt
Mi4xLjIzLmRmc2cxfi9zYXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uYwkyMDExLTA1LTIyIDExOjA5
OjAxLjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbDItMi4xLjIzLmRmc2cxL3Nhc2xhdXRo
ZC9zYXNsYXV0aGQtbWFpbi5jCTIwMTEtMDUtMjIgMTE6MDk6MzUuMDAwMDAwMDAwICswMjAwCkBA
IC0zNjcsNyArMzY3LDcgQEAKICAqIHJldHVybiBhIHBvaW50ZXIgdG8gYSBzdHJpbmcgdG8gc2Vu
ZCBiYWNrIHRvIHRoZSBjbGllbnQuCiAgKiBUaGUgY2FsbGVyIGlzIHJlc3BvbnNpYmxlIGZvciBm
cmVlaW5nIHRoZSBwb2ludGVyLiAKICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KLWNoYXIgKmRvX2F1dGgoY29uc3QgY2hhciAq
X2xvZ2luLCBjb25zdCBjaGFyICpwYXNzd29yZCwgY29uc3QgY2hhciAqc2VydmljZSwgY29uc3Qg
Y2hhciAqcmVhbG0pIHsKK2NoYXIgKmRvX2F1dGgoY29uc3QgY2hhciAqX2xvZ2luLCBjb25zdCBj
aGFyICpwYXNzd29yZCwgY29uc3QgY2hhciAqc2VydmljZSwgY29uc3QgY2hhciAqcmVhbG0sIGNv
bnN0IGNoYXIgKnJlbW90ZSkgewogCiAJc3RydWN0IGNhY2hlX3Jlc3VsdAlsa3VwX3Jlc3VsdDsK
IAljaGFyCQkJKnJlc3BvbnNlOwpAQCAtMzk2LDcgKzM5Niw3IEBACiAJCXJlc3BvbnNlID0gc3Ry
ZHVwKCJPSyIpOwogCQljYWNoZWQgPSAxOwogCX0gZWxzZSB7Ci0JCXJlc3BvbnNlID0gYXV0aF9t
ZWNoLT5hdXRoZW50aWNhdGUobG9naW4sIHBhc3N3b3JkLCBzZXJ2aWNlLCByZWFsbSk7CisJCXJl
c3BvbnNlID0gYXV0aF9tZWNoLT5hdXRoZW50aWNhdGUobG9naW4sIHBhc3N3b3JkLCBzZXJ2aWNl
LCByZWFsbSwgcmVtb3RlKTsKIAogCQlpZiAocmVzcG9uc2UgPT0gTlVMTCkgewogCQkJbG9nZ2Vy
KExfRVJSLCBMX0ZVTkMsICJpbnRlcm5hbCBtZWNoYW5pc20gZmFpbHVyZTogJXMiLCBhdXRoX21l
Y2gtPm5hbWUpOwpAQCAtNDA5LDE4ICs0MDksMTggQEAKIAogCQlpZiAoZmxhZ3MgJiBWRVJCT1NF
KSB7CiAJCQlpZiAoY2FjaGVkKSAKLQkJCQlsb2dnZXIoTF9ERUJVRywgTF9GVU5DLCAiYXV0aCBz
dWNjZXNzIChjYWNoZWQpOiBbdXNlcj0lc10gW3NlcnZpY2U9JXNdIFtyZWFsbT0lc10iLCBcCi0J
CQkJCWxvZ2luLCBzZXJ2aWNlLCByZWFsbSk7CisJCQkJbG9nZ2VyKExfREVCVUcsIExfRlVOQywg
ImF1dGggc3VjY2VzcyAoY2FjaGVkKTogW3VzZXI9JXNdIFtzZXJ2aWNlPSVzXSBbcmVhbG09JXNd
IFtyZW1vdGU9JXNdIiwgXAorCQkJCQlsb2dpbiwgc2VydmljZSwgcmVhbG0sIHJlbW90ZSk7CiAJ
CQllbHNlCi0JCQkJbG9nZ2VyKExfREVCVUcsIExfRlVOQywgImF1dGggc3VjY2VzczogW3VzZXI9
JXNdIFtzZXJ2aWNlPSVzXSBbcmVhbG09JXNdIFttZWNoPSVzXSIsIFwKLQkJCQkJbG9naW4sIHNl
cnZpY2UsIHJlYWxtLCBhdXRoX21lY2gtPm5hbWUpOworCQkJCWxvZ2dlcihMX0RFQlVHLCBMX0ZV
TkMsICJhdXRoIHN1Y2Nlc3M6IFt1c2VyPSVzXSBbc2VydmljZT0lc10gW3JlYWxtPSVzXSBbcmVt
b3RlPSVzXSBbbWVjaD0lc10iLCBcCisJCQkJCWxvZ2luLCBzZXJ2aWNlLCByZWFsbSwgcmVtb3Rl
LCBhdXRoX21lY2gtPm5hbWUpOwogCQl9CiAJCXJldHVybiByZXNwb25zZTsKIAl9CiAKIAlpZiAo
c3RybmNtcChyZXNwb25zZSwgIk5PIiwgMikgPT0gMCkgewotCQlsb2dnZXIoTF9JTkZPLCBMX0ZV
TkMsICJhdXRoIGZhaWx1cmU6IFt1c2VyPSVzXSBbc2VydmljZT0lc10gW3JlYWxtPSVzXSBbbWVj
aD0lc10gW3JlYXNvbj0lc10iLCBcCi0JCQlsb2dpbiwgc2VydmljZSwgcmVhbG0sIGF1dGhfbWVj
aC0+bmFtZSwKKwkJbG9nZ2VyKExfSU5GTywgTF9GVU5DLCAiYXV0aCBmYWlsdXJlOiBbdXNlcj0l
c10gW3NlcnZpY2U9JXNdIFtyZWFsbT0lc10gW3JlbW90ZT0lc10gW21lY2g9JXNdIFtyZWFzb249
JXNdIiwgXAorCQkJbG9naW4sIHNlcnZpY2UsIHJlYWxtLCByZW1vdGUsIGF1dGhfbWVjaC0+bmFt
ZSwKIAkJICAgICAgICBzdHJsZW4ocmVzcG9uc2UpID49IDQgPyByZXNwb25zZSszIDogIlVua25v
d24iKTsKIAogCQlyZXR1cm4gcmVzcG9uc2U7CmRpZmYgLXVyTmFkICctLWV4Y2x1ZGU9Q1ZTJyAn
LS1leGNsdWRlPS5zdm4nICctLWV4Y2x1ZGU9LmdpdCcgJy0tZXhjbHVkZT0uYXJjaCcgJy0tZXhj
bHVkZT0uaGcnICctLWV4Y2x1ZGU9X2RhcmNzJyAnLS1leGNsdWRlPS5ienInIGN5cnVzLXNhc2wy
LTIuMS4yMy5kZnNnMX4vc2FzbGF1dGhkL3Nhc2xhdXRoZC1tYWluLmggY3lydXMtc2FzbDItMi4x
LjIzLmRmc2cxL3Nhc2xhdXRoZC9zYXNsYXV0aGQtbWFpbi5oCi0tLSBjeXJ1cy1zYXNsMi0yLjEu
MjMuZGZzZzF+L3Nhc2xhdXRoZC9zYXNsYXV0aGQtbWFpbi5oCTIwMDMtMDUtMTYgMDA6MjE6NDEu
MDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1zYXNsMi0yLjEuMjMuZGZzZzEvc2FzbGF1dGhkL3Nh
c2xhdXRoZC1tYWluLmgJMjAxMS0wNS0yMiAxMTowOTozNS4wMDAwMDAwMDAgKzAyMDAKQEAgLTg4
LDcgKzg4LDggQEAKIAogLyogc2FzbGF1dGhkLW1haW4uYyAqLwogZXh0ZXJuIGNoYXIJKmRvX2F1
dGgoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosCi0JCQkgY29uc3QgY2hhciAqLCBjb25zdCBj
aGFyICopOworCQkJIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLAorCQkJIGNvbnN0IGNoYXIg
Kik7CiBleHRlcm4gdm9pZAlzZXRfYXV0aF9tZWNoKGNvbnN0IGNoYXIgKik7CiBleHRlcm4gdm9p
ZAlzZXRfbWF4X3Byb2NzKGNvbnN0IGNoYXIgKik7CiBleHRlcm4gdm9pZAlzZXRfbWVjaF9vcHRp
b24oY29uc3QgY2hhciAqKTsK
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1391</attachid>
            <date>2011-05-22 09:29 EDT</date>
            <desc>Enable PAM_RHOST on upcoming cyrus-sasl 2.1.24</desc>
            <filename>saslauthd_pam_rhost_2.1.24rc1.diff</filename>
            <type>text/plain</type>
            <size>25389</size>
            <attacher>lorenzo@sancho.ccd.uniroma2.it</attacher>
            
              <data encoding="base64">ZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9saWIvY2hlY2twdy5jIGN5cnVzLXNhc2wt
Mi4xLjI0L2xpYi9jaGVja3B3LmMKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvbGliL2NoZWNr
cHcuYwkyMDA5LTA4LTEzIDE0OjM2OjQyLjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbC0y
LjEuMjQvbGliL2NoZWNrcHcuYwkyMDExLTA1LTIyIDEyOjM5OjA1LjAwMDAwMDAwMCArMDIwMApA
QCAtNjU0LDYgKzY1NCw4IEBACiAgICAgY2hhciBwd3BhdGhbc2l6ZW9mKHNydmFkZHIuc3VuX3Bh
dGgpXTsKICAgICBjb25zdCBjaGFyICpwID0gTlVMTDsKICAgICBjaGFyICpmcmVlbWUgPSBOVUxM
OworICAgIGNoYXIgKmZyZWVtZXRvbyA9IE5VTEw7CisgICAgY29uc3QgY2hhciAqY2xpZW50X2Fk
ZHIgPSBOVUxMOwogI2lmZGVmIFVTRV9ET09SUwogICAgIGRvb3JfYXJnX3QgYXJnOwogI2VuZGlm
CkBAIC02ODUsMTMgKzY4NywxOSBAQAogCXVzZXJfcmVhbG0gPSBydG1wICsgMTsKICAgICB9CiAK
KyAgICBpZiAoc2FzbF9nZXRwcm9wKGNvbm4sIFNBU0xfSVBSRU1PVEVQT1JULCAoY29uc3Qgdm9p
ZCAqKikgJiBjbGllbnRfYWRkcikgPT0gU0FTTF9PSykgeworCWlmKF9zYXNsX3N0cmR1cChjbGll
bnRfYWRkciwgJmZyZWVtZXRvbywgTlVMTCkgIT0gU0FTTF9PSykKKwkgICAgZ290byBmYWlsOwor
CWNsaWVudF9hZGRyID0gZnJlZW1ldG9vOworICAgIH0KKwogICAgIC8qCiAgICAgICogYnVpbGQg
cmVxdWVzdCBvZiB0aGUgZm9ybToKICAgICAgKgotICAgICAqIGNvdW50IGF1dGhpZCBjb3VudCBw
YXNzd29yZCBjb3VudCBzZXJ2aWNlIGNvdW50IHJlYWxtCisgICAgICogY291bnQgYXV0aGlkIGNv
dW50IHBhc3N3b3JkIGNvdW50IHNlcnZpY2UgY291bnQgcmVhbG0gY2xpZW50CiAgICAgICovCiAg
ICAgewotIAl1bnNpZ25lZCBzaG9ydCBtYXhfbGVuLCByZXFfbGVuLCB1X2xlbiwgcF9sZW4sIHNf
bGVuLCByX2xlbjsKKyAJdW5zaWduZWQgc2hvcnQgbWF4X2xlbiwgcmVxX2xlbiwgdV9sZW4sIHBf
bGVuLCBzX2xlbiwgcl9sZW4sIGNfbGVuOwogIAogCW1heF9sZW4gPSAodW5zaWduZWQgc2hvcnQp
IHNpemVvZihxdWVyeSk7CiAKQEAgLTY5OSw3ICs3MDcsOCBAQAogCWlmICgoc3RybGVuKHVzZXJp
ZCkgPiBVU0hSVF9NQVgpIHx8CiAJICAgIChzdHJsZW4ocGFzc3dkKSA+IFVTSFJUX01BWCkgfHwK
IAkgICAgKHN0cmxlbihzZXJ2aWNlKSA+IFVTSFJUX01BWCkgfHwKLQkgICAgKHVzZXJfcmVhbG0g
JiYgKHN0cmxlbih1c2VyX3JlYWxtKSA+IFVTSFJUX01BWCkpKSB7CisJICAgICh1c2VyX3JlYWxt
ICYmIChzdHJsZW4odXNlcl9yZWFsbSkgPiBVU0hSVF9NQVgpKQorCSAgICAoY2xpZW50X2FkZHIg
JiYgKHN0cmxlbihjbGllbnRfYWRkcikgPiBVU0hSVF9NQVgpKSkgewogCSAgICBnb3RvIHRvb2Jp
ZzsKIAl9CiAKQEAgLTcwNyw2ICs3MTYsNyBAQAogIAlwX2xlbiA9IChzdHJsZW4ocGFzc3dkKSk7
CiAJc19sZW4gPSAoc3RybGVuKHNlcnZpY2UpKTsKIAlyX2xlbiA9ICgodXNlcl9yZWFsbSA/IHN0
cmxlbih1c2VyX3JlYWxtKSA6IDApKTsKKwljX2xlbiA9ICgoY2xpZW50X2FkZHIgPyBzdHJsZW4o
Y2xpZW50X2FkZHIpOiAwKSk7CiAKIAkvKiBwcmV2ZW50IGJ1ZmZlciBvdmVyZmxvdyAqLwogCXJl
cV9sZW4gPSAzMDsKQEAgLTcxNywxMSArNzI3LDE0IEBACiAJaWYgKG1heF9sZW4gLSByZXFfbGVu
IDwgc19sZW4pIGdvdG8gdG9vYmlnOwogCXJlcV9sZW4gKz0gc19sZW47CiAJaWYgKG1heF9sZW4g
LSByZXFfbGVuIDwgcl9sZW4pIGdvdG8gdG9vYmlnOworCXJlcV9sZW4gKz0gcl9sZW47CisJaWYg
KG1heF9sZW4gLSByZXFfbGVuIDwgY19sZW4pIGdvdG8gdG9vYmlnOwogCiAJdV9sZW4gPSBodG9u
cyh1X2xlbik7CiAJcF9sZW4gPSBodG9ucyhwX2xlbik7CiAJc19sZW4gPSBodG9ucyhzX2xlbik7
CiAJcl9sZW4gPSBodG9ucyhyX2xlbik7CisJY19sZW4gPSBodG9ucyhjX2xlbik7CiAKIAltZW1j
cHkocXVlcnlfZW5kLCAmdV9sZW4sIHNpemVvZih1bnNpZ25lZCBzaG9ydCkpOwogCXF1ZXJ5X2Vu
ZCArPSBzaXplb2YodW5zaWduZWQgc2hvcnQpOwpAQCAtNzM4LDYgKzc1MSwxMCBAQAogCW1lbWNw
eShxdWVyeV9lbmQsICZyX2xlbiwgc2l6ZW9mKHVuc2lnbmVkIHNob3J0KSk7CiAJcXVlcnlfZW5k
ICs9IHNpemVvZih1bnNpZ25lZCBzaG9ydCk7CiAJaWYgKHVzZXJfcmVhbG0pIHdoaWxlICgqdXNl
cl9yZWFsbSkgKnF1ZXJ5X2VuZCsrID0gKnVzZXJfcmVhbG0rKzsKKworCW1lbWNweShxdWVyeV9l
bmQsICZjX2xlbiwgc2l6ZW9mKHVuc2lnbmVkIHNob3J0KSk7CisJcXVlcnlfZW5kICs9IHNpemVv
Zih1bnNpZ25lZCBzaG9ydCk7CisJaWYoY2xpZW50X2FkZHIpIHdoaWxlICgqY2xpZW50X2FkZHIp
ICpxdWVyeV9lbmQrKyA9ICpjbGllbnRfYWRkcisrOwogICAgIH0KIAogI2lmZGVmIFVTRV9ET09S
UwpAQCAtODM4LDcgKzg1NSw4IEBACiAgICAgY2xvc2Uocyk7CiAjZW5kaWYgLyogVVNFX0RPT1JT
ICovCiAgIAotICAgIGlmKGZyZWVtZSkgZnJlZShmcmVlbWUpOworICAgIGlmIChmcmVlbWUpIGZy
ZWUoZnJlZW1lKTsKKyAgICBpZiAoZnJlZW1ldG9vKSBmcmVlKGZyZWVtZXRvbyk7CiAKICAgICBp
ZiAoIXN0cm5jbXAocmVzcG9uc2UsICJPSyIsIDIpKSB7CiAJcmV0dXJuIFNBU0xfT0s7CkBAIC04
NTMsNiArODcxLDcgQEAKIAogIGZhaWw6CiAgICAgaWYgKGZyZWVtZSkgZnJlZShmcmVlbWUpOwor
ICAgIGlmIChmcmVlbWV0b28pIGZyZWUoZnJlZW1ldG9vKTsKICAgICByZXR1cm4gU0FTTF9GQUlM
OwogfQogCmRpZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfZGNl
LmMgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfZGNlLmMKLS0tIGN5cnVzLXNhc2wt
Mi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfZGNlLmMJMjAwMS0xMi0wNCAwMzowNjo1NC4wMDAw
MDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2RjZS5jCTIw
MTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAwCkBAIC01Niw3ICs1Niw4IEBACiAgIGNv
bnN0IGNoYXIgKmxvZ2luLAkJCS8qIEk6IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAgIGNv
bnN0IGNoYXIgKnBhc3N3b3JkLAkJCS8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBjb25z
dCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpy
ZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJp
YnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlCiAgIC8qIEVORCBQQVJBTUVU
RVJTICovCiAgICkKIHsKQEAgLTEwNCw3ICsxMDUsOCBAQAogICBjb25zdCBjaGFyICpsb2dpbiBf
X2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICAgY29uc3QgY2hhciAqcGFzc3dvcmQgX19hdHRyaWJ1
dGVfXygodW51c2VkKSksCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UgX19hdHRyaWJ1dGVfXygodW51
c2VkKSksCi0gIGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0cmlidXRlX18oKHVudXNlZCkpCisgIGNv
bnN0IGNoYXIgKnJlYWxtIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAorICBjb25zdCBjaGFyICpy
ZW1vdGUgX19hdHRyaWJ1dGVfXygodW51c2VkKSkKICAgKQogewogICAgICByZXR1cm4gTlVMTDsK
ZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9kY2UuaCBjeXJ1
cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9kY2UuaAotLS0gY3lydXMtc2FzbC0yLjEuMjQu
b3JpZy9zYXNsYXV0aGQvYXV0aF9kY2UuaAkyMDAxLTEyLTA0IDAzOjA2OjU0LjAwMDAwMDAwMCAr
MDEwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfZGNlLmgJMjAxMS0wNS0y
MiAxMjoyNDo0Ny4wMDAwMDAwMDAgKzAyMDAKQEAgLTI2LDQgKzI2LDQgQEAKICAqIEVORCBDT1BZ
UklHSFQKICAqLwogCi1jaGFyICphdXRoX2RjZShjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwg
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOworY2hhciAqYXV0aF9kY2UoY29uc3QgY2hhciAq
LCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICop
OwpkaWZmIC1ydSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX2dldHB3ZW50
LmMgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfZ2V0cHdlbnQuYwotLS0gY3lydXMt
c2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9nZXRwd2VudC5jCTIwMDktMDUtMDcgMTc6
MjE6MTUuMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0
aF9nZXRwd2VudC5jCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAwCkBAIC02Nyw3
ICs2Nyw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2luLAkJCS8qIEk6IHBsYWludGV4dCBhdXRoZW50
aWNhdG9yICovCiAgIGNvbnN0IGNoYXIgKnBhc3N3b3JkLAkJCS8qIEk6IHBsYWludGV4dCBwYXNz
d29yZCAqLwogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAot
ICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFy
ICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlICAg
ICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUgaG9zdCBhZGRyZXNzICovCiAgIC8qIEVORCBQ
QVJBTUVURVJTICovCiAgICkKIHsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNs
YXV0aGQvYXV0aF9nZXRwd2VudC5oIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2dl
dHB3ZW50LmgKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfZ2V0cHdl
bnQuaAkyMDAxLTEyLTA0IDAzOjA2OjU0LjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMtc2FzbC0y
LjEuMjQvc2FzbGF1dGhkL2F1dGhfZ2V0cHdlbnQuaAkyMDExLTA1LTIyIDEyOjI0OjQ3LjAwMDAw
MDAwMCArMDIwMApAQCAtMjUsNCArMjUsNCBAQAogICogREFNQUdFLgogICogRU5EIENPUFlSSUdI
VCAqLwogCi1jaGFyICphdXRoX2dldHB3ZW50KGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBj
b25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CitjaGFyICphdXRoX2dldHB3ZW50KGNvbnN0IGNo
YXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hh
ciAqKTsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9odHRw
Zm9ybS5jIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2h0dHBmb3JtLmMKLS0tIGN5
cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfaHR0cGZvcm0uYwkyMDA2LTA0LTE5
IDIxOjUxOjA0LjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhk
L2F1dGhfaHR0cGZvcm0uYwkyMDExLTA1LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApAQCAt
NDYzLDcgKzQ2Myw4IEBACiAgIGNvbnN0IGNoYXIgKnVzZXIsCQkJLyogSTogcGxhaW50ZXh0IGF1
dGhlbnRpY2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQsCQkJLyogSTogcGxhaW50ZXh0
IHBhc3N3b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsCi0gIGNvbnN0IGNoYXIgKnJlYWxt
CisgIGNvbnN0IGNoYXIgKnJlYWxtLAorICBjb25zdCBjaGFyICpyZW1vdGUgICAgICAgICAgICAg
ICAgICAgIC8qIEk6IHJlbW90ZSBob3N0IGFkZHJlc3MgKi8KICAgLyogRU5EIFBBUkFNRVRFUlMg
Ki8KICAgKQogewpkaWZmIC1ydSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRo
X2h0dHBmb3JtLmggY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfaHR0cGZvcm0uaAot
LS0gY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9odHRwZm9ybS5oCTIwMDYt
MDMtMTMgMjE6MTc6MDkuMDAwMDAwMDAwICswMTAwCisrKyBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNs
YXV0aGQvYXV0aF9odHRwZm9ybS5oCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAw
CkBAIC0yNSw1ICsyNSw1IEBACiAgKiBEQU1BR0UuCiAgKiBFTkQgQ09QWVJJR0hUICovCiAKLWNo
YXIgKmF1dGhfaHR0cGZvcm0oY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIg
KiwgY29uc3QgY2hhciAqKTsKK2NoYXIgKmF1dGhfaHR0cGZvcm0oY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOwogaW50
IGF1dGhfaHR0cGZvcm1faW5pdCh2b2lkKTsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3Jp
Zy9zYXNsYXV0aGQvYXV0aF9rcmI0LmMgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhf
a3JiNC5jCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX2tyYjQuYwky
MDA1LTAyLTAxIDEzOjI2OjM0LjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMtc2FzbC0yLjEuMjQv
c2FzbGF1dGhkL2F1dGhfa3JiNC5jCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAw
CkBAIC0xNzEsNyArMTcxLDggQEAKICAgY29uc3QgY2hhciAqbG9naW4sCQkJLyogSTogcGxhaW50
ZXh0IGF1dGhlbnRpY2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQsCQkJLyogSTogcGxh
aW50ZXh0IHBhc3N3b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsCi0gIGNvbnN0IGNoYXIg
KnJlYWxtX2luCisgIGNvbnN0IGNoYXIgKnJlYWxtX2luLAorICBjb25zdCBjaGFyICpyZW1vdGUg
ICAgICAgICAgICAgICAgICAgIC8qIEk6IHJlbW90ZSBob3N0IGFkZHJlc3MgKi8KICAgLyogRU5E
IFBBUkFNRVRFUlMgKi8KICAgKQogewpAQCAtMjgyLDcgKzI4Myw4IEBACiAgIGNvbnN0IGNoYXIg
KmxvZ2luIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAogICBjb25zdCBjaGFyICpwYXNzd29yZCBf
X2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICAgY29uc3QgY2hhciAqc2VydmljZSBfX2F0dHJpYnV0
ZV9fKCh1bnVzZWQpKSwKLSAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2Vk
KSkKKyAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisgIGNvbnN0
IGNoYXIgKnJlbW90ZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQogICApCiB7CiAgICAgcmV0dXJu
IE5VTEw7CmRpZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfa3Ji
NC5oIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2tyYjQuaAotLS0gY3lydXMtc2Fz
bC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9rcmI0LmgJMjAwMS0xMi0wNCAwMzowNjo1NC4w
MDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2tyYjQu
aAkyMDExLTA1LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApAQCAtMjUsNSArMjUsNSBAQAog
ICogREFNQUdFLgogICogRU5EIENPUFlSSUdIVCAqLwogCi1jaGFyICphdXRoX2tyYjQoY29uc3Qg
Y2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKK2NoYXIg
KmF1dGhfa3JiNChjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICosIGNvbnN0IGNoYXIgKik7CiBpbnQgYXV0aF9rcmI0X2luaXQodm9pZCk7CmRpZmYg
LXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfa3JiNS5jIGN5cnVzLXNh
c2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2tyYjUuYwotLS0gY3lydXMtc2FzbC0yLjEuMjQub3Jp
Zy9zYXNsYXV0aGQvYXV0aF9rcmI1LmMJMjAwOS0wNS0wNyAxNzoyMToxNS4wMDAwMDAwMDAgKzAy
MDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2tyYjUuYwkyMDExLTA1LTIy
IDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApAQCAtMTcyLDcgKzE3Miw4IEBACiAgIGNvbnN0IGNo
YXIgKnVzZXIsCQkJLyogSTogcGxhaW50ZXh0IGF1dGhlbnRpY2F0b3IgKi8KICAgY29uc3QgY2hh
ciAqcGFzc3dvcmQsCQkJLyogSTogcGxhaW50ZXh0IHBhc3N3b3JkICovCiAgIGNvbnN0IGNoYXIg
KnNlcnZpY2UsICAgICAgICAgICAgICAgICAgLyogSTogc2VydmljZSBhdXRoZW50aWNhdGluZyB0
byAqLwotICBjb25zdCBjaGFyICpyZWFsbSAgICAgICAgICAgICAgICAgICAgIC8qIEk6IHVzZXIn
cyByZWFsbSAqLworICBjb25zdCBjaGFyICpyZWFsbSwgICAgICAgICAgICAgICAgICAgIC8qIEk6
IHVzZXIncyByZWFsbSAqLworICBjb25zdCBjaGFyICpyZW1vdGUgICAgICAgICAgICAgICAgICAg
IC8qIEk6IHJlbW90ZSBob3N0IGFkZHJlc3MgKi8KICAgLyogRU5EIFBBUkFNRVRFUlMgKi8KICAg
KQogewpAQCAtMzU2LDcgKzM1Nyw4IEBACiAgIGNvbnN0IGNoYXIgKnVzZXIsCQkJLyogSTogcGxh
aW50ZXh0IGF1dGhlbnRpY2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQsCQkJLyogSTog
cGxhaW50ZXh0IHBhc3N3b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsCQkJLyogSTogc2Vy
dmljZSBhdXRoZW50aWNhdGluZyB0byAqLwotICBjb25zdCBjaGFyICpyZWFsbQkJCS8qIEk6IHVz
ZXIncyByZWFsbSAqLworICBjb25zdCBjaGFyICpyZWFsbSwJCQkvKiBJOiB1c2VyJ3MgcmVhbG0g
Ki8KKyAgY29uc3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUg
aG9zdCBhZGRyZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKQEAgLTQ2NCw3
ICs0NjYsOCBAQAogICBjb25zdCBjaGFyICpsb2dpbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwK
ICAgY29uc3QgY2hhciAqcGFzc3dvcmQgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgIGNvbnN0
IGNoYXIgKnNlcnZpY2UgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCi0gIGNvbnN0IGNoYXIgKnJl
YWxtIF9fYXR0cmlidXRlX18oKHVudXNlZCkpCisgIGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0cmli
dXRlX18oKHVudXNlZCkpLAorICBjb25zdCBjaGFyICpyZW1vdGUgX19hdHRyaWJ1dGVfXygodW51
c2VkKSkKICAgKQogewogICAgIHJldHVybiBOVUxMOwpkaWZmIC1ydSBjeXJ1cy1zYXNsLTIuMS4y
NC5vcmlnL3Nhc2xhdXRoZC9hdXRoX2tyYjUuaCBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQv
YXV0aF9rcmI1LmgKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfa3Ji
NS5oCTIwMDItMDQtMjUgMjA6MzE6MzguMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1zYXNsLTIu
MS4yNC9zYXNsYXV0aGQvYXV0aF9rcmI1LmgJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAwMDAg
KzAyMDAKQEAgLTI1LDUgKzI1LDUgQEAKICAqIERBTUFHRS4KICAqIEVORCBDT1BZUklHSFQgKi8K
IAotY2hhciAqYXV0aF9rcmI1KGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFy
ICosIGNvbnN0IGNoYXIgKik7CitjaGFyICphdXRoX2tyYjUoY29uc3QgY2hhciAqLCBjb25zdCBj
aGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOwogaW50IGF1
dGhfa3JiNV9pbml0KHZvaWQpOwpkaWZmIC1ydSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xh
dXRoZC9hdXRoX2xkYXAuYyBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9sZGFwLmMK
LS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfbGRhcC5jCTIwMDQtMTIt
MDggMTM6MTI6MjcuMDAwMDAwMDAwICswMTAwCisrKyBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0
aGQvYXV0aF9sZGFwLmMJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAwMDAgKzAyMDAKQEAgLTYw
LDcgKzYwLDggQEAKICAgY29uc3QgY2hhciAqbG9naW4sCQkJLyogSTogcGxhaW50ZXh0IGF1dGhl
bnRpY2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQsCQkJLyogSTogcGxhaW50ZXh0IHBh
c3N3b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsCi0gIGNvbnN0IGNoYXIgKnJlYWxtCisg
IGNvbnN0IGNoYXIgKnJlYWxtLAorICBjb25zdCBjaGFyICpyZW1vdGUgICAgICAgICAgICAgICAg
ICAgIC8qIEk6IHJlbW90ZSBob3N0IGFkZHJlc3MgKi8KICAgLyogRU5EIFBBUkFNRVRFUlMgKi8K
ICAgKQogewpAQCAtMTE2LDcgKzExNyw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2luIF9fYXR0cmli
dXRlX18oKHVudXNlZCkpLAogICBjb25zdCBjaGFyICpwYXNzd29yZCBfX2F0dHJpYnV0ZV9fKCh1
bnVzZWQpKSwKICAgY29uc3QgY2hhciAqc2VydmljZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwK
LSAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSkKKyAgY29uc3QgY2hh
ciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisgIGNvbnN0IGNoYXIgKnJlbW90ZSBf
X2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQogICApCiB7CiAgICAgIHJldHVybiBOVUxMOwpkaWZmIC1y
dSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX2xkYXAuaCBjeXJ1cy1zYXNs
LTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9sZGFwLmgKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcv
c2FzbGF1dGhkL2F1dGhfbGRhcC5oCTIwMDItMDYtMTkgMTk6MzU6MjkuMDAwMDAwMDAwICswMjAw
CisrKyBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9sZGFwLmgJMjAxMS0wNS0yMiAx
MjoyNDo0Ny4wMDAwMDAwMDAgKzAyMDAKQEAgLTI1LDUgKzI1LDUgQEAKICAqIERBTUFHRS4KICAq
IEVORCBDT1BZUklHSFQgKi8KIAotY2hhciAqYXV0aF9sZGFwKGNvbnN0IGNoYXIgKiwgY29uc3Qg
Y2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CitjaGFyICphdXRoX2xkYXAoY29u
c3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICopOwogaW50IGF1dGhfbGRhcF9pbml0KHZvaWQpOwpkaWZmIC1ydSBjeXJ1cy1zYXNs
LTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX3BhbS5jIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xh
dXRoZC9hdXRoX3BhbS5jCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRo
X3BhbS5jCTIwMDUtMDUtMTUgMDg6NDM6MTkuMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1zYXNs
LTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9wYW0uYwkyMDExLTA1LTIyIDEyOjI0OjQ3LjAwMDAwMDAw
MCArMDIwMApAQCAtMTg2LDcgKzE4Niw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2luLAkJCS8qIEk6
IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAgIGNvbnN0IGNoYXIgKnBhc3N3b3JkLAkJCS8q
IEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBjb25zdCBjaGFyICpzZXJ2aWNlLAkJCS8qIEk6
IHNlcnZpY2UgbmFtZSAqLwotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVz
ZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29u
c3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUgaG9zdCBhZGRy
ZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKQEAgLTIxMyw2ICsyMTQsMTQg
QEAKIAogICAgIG15X2FwcGRhdGEucGFtaCA9IHBhbWg7CiAKKyAgICBjaGFyICogcmVtb3RlX2hv
c3QgPSBzdHJkdXAocmVtb3RlKTsKKyAgICBpZiAocmVtb3RlX2hvc3QpIHsKKwljaGFyICogc2Vt
aWNvbCA9IHN0cmNocihyZW1vdGVfaG9zdCwgJzsnKTsKKwlpZiAoc2VtaWNvbCkgKiBzZW1pY29s
ID0gTlVMTDsgLyogdHJ1bmNhdGUgcmVtb3RlX2hvc3QgYXQgdGhlICc7JyBwb3J0IHNlcGFyYXRv
ciAqLworCXBhbV9zZXRfaXRlbShwYW1oLCBQQU1fUkhPU1QsIHJlbW90ZV9ob3N0KTsKKwlmcmVl
IChyZW1vdGVfaG9zdCk7CisgICAgfQorCiAgICAgcmMgPSBwYW1fYXV0aGVudGljYXRlKHBhbWgs
IFBBTV9TSUxFTlQpOwogICAgIGlmIChyYyAhPSBQQU1fU1VDQ0VTUykgewogCXN5c2xvZyhMT0df
REVCVUcsICJERUJVRzogYXV0aF9wYW06IHBhbV9hdXRoZW50aWNhdGUgZmFpbGVkOiAlcyIsCkBA
IC0yNDIsNyArMjUxLDggQEAKICAgY29uc3QgY2hhciAqbG9naW4gX19hdHRyaWJ1dGVfXygodW51
c2VkKSksCiAgIGNvbnN0IGNoYXIgKnBhc3N3b3JkIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAog
ICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBj
aGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBf
X2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlIF9fYXR0cmlidXRl
X18oKHVudXNlZCkpCiAgICkKIHsKICAgICByZXR1cm4gTlVMTDsKZGlmZiAtcnUgY3lydXMtc2Fz
bC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9wYW0uaCBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNs
YXV0aGQvYXV0aF9wYW0uaAotLS0gY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0
aF9wYW0uaAkyMDAxLTEyLTA0IDAzOjA2OjU0LjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMtc2Fz
bC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfcGFtLmgJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAw
MDAgKzAyMDAKQEAgLTMyLDQgKzMyLDQgQEAKICAqIERBTUFHRS4KICAqIEVORCBDT1BZUklHSFQg
Ki8KIAotY2hhciAqYXV0aF9wYW0oY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKiwgY29uc3QgY2hhciAqKTsKK2NoYXIgKmF1dGhfcGFtKGNvbnN0IGNoYXIgKiwgY29uc3Qg
Y2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKZGlmZiAt
cnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9yaW1hcC5jIGN5cnVzLXNh
c2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3JpbWFwLmMKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9y
aWcvc2FzbGF1dGhkL2F1dGhfcmltYXAuYwkyMDA5LTA1LTA3IDE3OjIxOjE1LjAwMDAwMDAwMCAr
MDIwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfcmltYXAuYwkyMDExLTA1
LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApAQCAtMjk4LDcgKzI5OCw4IEBACiAgIGNvbnN0
IGNoYXIgKmxvZ2luLAkJCS8qIEk6IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAgIGNvbnN0
IGNoYXIgKnBhc3N3b3JkLAkJCS8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBjb25zdCBj
aGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFs
bSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0
ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAv
KiBJOiByZW1vdGUgaG9zdCBhZGRyZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkK
IHsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9yaW1hcC5o
IGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3JpbWFwLmgKLS0tIGN5cnVzLXNhc2wt
Mi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfcmltYXAuaAkyMDAxLTEyLTA0IDAzOjA2OjU0LjAw
MDAwMDAwMCArMDEwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfcmltYXAu
aAkyMDExLTA1LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApAQCAtMjUsNSArMjUsNSBAQAog
ICogREFNQUdFLgogICogRU5EIENPUFlSSUdIVCAqLwogCi1jaGFyICphdXRoX3JpbWFwKGNvbnN0
IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CitjaGFy
ICphdXRoX3JpbWFwKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNv
bnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKIGludCBhdXRoX3JpbWFwX2luaXQodm9pZCk7CmRp
ZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfc2FzbGRiLmMgY3ly
dXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfc2FzbGRiLmMKLS0tIGN5cnVzLXNhc2wtMi4x
LjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfc2FzbGRiLmMJMjAwOS0wNS0wNyAxNzoyMToxNi4wMDAw
MDAwMDAgKzAyMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3Nhc2xkYi5j
CTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAwCkBAIC0xMTgsMTMgKzExOCwxNCBA
QAogICBjb25zdCBjaGFyICpsb2dpbiwJCQkvKiBJOiBwbGFpbnRleHQgYXV0aGVudGljYXRvciAq
LwogICBjb25zdCBjaGFyICpwYXNzd29yZCwJCQkvKiBJOiBwbGFpbnRleHQgcGFzc3dvcmQgKi8K
ICAgY29uc3QgY2hhciAqc2VydmljZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKLSAgY29uc3Qg
Y2hhciAqcmVhbG0KKyAgY29uc3QgY2hhciAqcmVhbG0sCiAjZWxzZQogICBjb25zdCBjaGFyICps
b2dpbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwvKiBJOiBwbGFpbnRleHQgYXV0aGVudGljYXRv
ciAqLwogICBjb25zdCBjaGFyICpwYXNzd29yZCBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwgIC8q
IEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0cmli
dXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVz
ZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICNlbmRp
ZgorICBjb25zdCBjaGFyICpyZW1vdGUgICAgICAgICAgICAgICAgICAgIC8qIEk6IHJlbW90ZSBo
b3N0IGFkZHJlc3MgKi8KICAgLyogRU5EIFBBUkFNRVRFUlMgKi8KICAgKQogewpkaWZmIC1ydSBj
eXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX3Nhc2xkYi5oIGN5cnVzLXNhc2wt
Mi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3Nhc2xkYi5oCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmln
L3Nhc2xhdXRoZC9hdXRoX3Nhc2xkYi5oCTIwMDEtMTItMDQgMDM6MDY6NTUuMDAwMDAwMDAwICsw
MTAwCisrKyBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9zYXNsZGIuaAkyMDExLTA1
LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApAQCAtMjUsNCArMjUsNCBAQAogICogREFNQUdF
LgogICogRU5EIENPUFlSSUdIVCAqLwogCi1jaGFyICphdXRoX3Nhc2xkYihjb25zdCBjaGFyICos
IGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOworY2hhciAqYXV0aF9z
YXNsZGIoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hh
ciAqLCBjb25zdCBjaGFyICopOwpkaWZmIC1ydSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xh
dXRoZC9hdXRoX3NoYWRvdy5jIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3NoYWRv
dy5jCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX3NoYWRvdy5jCTIw
MDktMDgtMTQgMTc6NDE6MzYuMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1zYXNsLTIuMS4yNC9z
YXNsYXV0aGQvYXV0aF9zaGFkb3cuYwkyMDExLTA1LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIw
MApAQCAtODYsNyArODYsOCBAQAogICBjb25zdCBjaGFyICpsb2dpbiwJCQkvKiBJOiBwbGFpbnRl
eHQgYXV0aGVudGljYXRvciAqLwogICBjb25zdCBjaGFyICpwYXNzd29yZCwJCQkvKiBJOiBwbGFp
bnRleHQgcGFzc3dvcmQgKi8KICAgY29uc3QgY2hhciAqc2VydmljZSBfX2F0dHJpYnV0ZV9fKCh1
bnVzZWQpKSwKLSAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSkKKyAg
Y29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisgIGNvbnN0IGNoYXIg
KnJlbW90ZSAgICAgICAgICAgICAgICAgICAgLyogSTogcmVtb3RlIGhvc3QgYWRkcmVzcyAqLwog
ICAvKiBFTkQgUEFSQU1FVEVSUyAqLwogICApCiB7CkBAIC0yODAsNyArMjgxLDggQEAKICAgY29u
c3QgY2hhciAqbG9naW4gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgIGNvbnN0IGNoYXIgKnBh
c3N3ZCBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICAgY29uc3QgY2hhciAqc2VydmljZSBfX2F0
dHJpYnV0ZV9fKCh1bnVzZWQpKSwKLSAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygo
dW51c2VkKSkKKyAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisg
IGNvbnN0IGNoYXIgKnJlbW90ZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQogICApCiB7CiAgICAg
cmV0dXJuIE5VTEw7CmRpZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1
dGhfc2hhZG93LmggY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfc2hhZG93LmgKLS0t
IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfc2hhZG93LmgJMjAwMS0xMi0w
NCAwMzowNjo1NS4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRo
ZC9hdXRoX3NoYWRvdy5oCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAwCkBAIC0y
NSw0ICsyNSw0IEBACiAgKiBEQU1BR0UuCiAgKiBFTkQgQ09QWVJJR0hUICovCiAKLWNoYXIgKmF1
dGhfc2hhZG93KGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0
IGNoYXIgKik7CitjaGFyICphdXRoX3NoYWRvdyhjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwg
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CmRpZmYgLXJ1IGN5cnVz
LXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfc2lhLmMgY3lydXMtc2FzbC0yLjEuMjQv
c2FzbGF1dGhkL2F1dGhfc2lhLmMKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhk
L2F1dGhfc2lhLmMJMjAwMS0xMi0wNCAwMzowNjo1NS4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVz
LXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3NpYS5jCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAw
MDAwMDAwICswMjAwCkBAIC01Niw3ICs1Niw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2luLAkJCS8q
IEk6IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAgIGNvbnN0IGNoYXIgKnBhc3N3b3JkLAkJ
CS8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0
cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1
bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAg
Y29uc3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUgaG9zdCBh
ZGRyZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKQEAgLTg0LDcgKzg1LDgg
QEAKICAgY29uc3QgY2hhciAqbG9naW4gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgIGNvbnN0
IGNoYXIgKnBhc3N3b3JkIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAogICBjb25zdCBjaGFyICpz
ZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0
dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1
bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpCiAg
ICkKIHsKICAgICByZXR1cm4gTlVMTDsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9z
YXNsYXV0aGQvYXV0aF9zaWEuaCBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9zaWEu
aAotLS0gY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9zaWEuaAkyMDAxLTEy
LTA0IDAzOjA2OjU1LjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1
dGhkL2F1dGhfc2lhLmgJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAwMDAgKzAyMDAKQEAgLTI1
LDQgKzI1LDQgQEAKICAqIERBTUFHRS4KICAqIEVORCBDT1BZUklHSFQgKi8KIAotY2hhciAqYXV0
aF9zaWEoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hh
ciAqKTsKK2NoYXIgKmF1dGhfc2lhKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBj
aGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKZGlmZiAtcnUgY3lydXMtc2FzbC0y
LjEuMjQub3JpZy9zYXNsYXV0aGQvaXBjX2Rvb3JzLmMgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1
dGhkL2lwY19kb29ycy5jCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9pcGNf
ZG9vcnMuYwkyMDA0LTA0LTI3IDE4OjAxOjUwLjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2Fz
bC0yLjEuMjQvc2FzbGF1dGhkL2lwY19kb29ycy5jCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAw
MDAwICswMjAwCkBAIC0yMTgsNiArMjE4LDcgQEAKIAljaGFyCQkJcGFzc3dvcmRbTUFYX1JFUV9M
RU4gKyAxXTsgLyogcGFzc3dvcmQgZm9yIGF1dGhlbnRpY2F0aW9uICAgICAgICAgICAgKi8KIAlj
aGFyCQkJc2VydmljZVtNQVhfUkVRX0xFTiArIDFdOyAgLyogc2VydmljZSBuYW1lIGZvciBhdXRo
ZW50aWNhdGlvbiAgICAgICAgKi8KIAljaGFyCQkJcmVhbG1bTUFYX1JFUV9MRU4gKyAxXTsgICAg
LyogdXNlciByZWFsbSBmb3IgYXV0aGVudGljYXRpb24gICAgICAgICAgKi8KKwljaGFyCQkJY2xp
ZW50X2FkZHJbTUFYX1JFUV9MRU4gKyAxXTsgIC8qIGNsaWVudCBhZGRyZXNzIGFuZCBwb3J0ICAg
ICAgICAgICAgKi8KIAogCiAJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqCkBAIC0yOTQsNiArMjk1LDIyIEBACiAJbWVtY3B5KHJl
YWxtLCBkYXRhLCBjb3VudCk7CiAJcmVhbG1bY291bnRdID0gJ1wwJzsKIAorCS8qIGNsaWVudF9h
ZGRyICovCisJbWVtY3B5KCZjb3VudCwgZGF0YSwgc2l6ZW9mKHVuc2lnbmVkIHNob3J0KSk7CisK
Kwljb3VudCA9IG50b2hzKGNvdW50KTsKKwlkYXRhICs9IHNpemVvZih1bnNpZ25lZCBzaG9ydCk7
CisKKwlpZiAoY291bnQgPiBNQVhfUkVRX0xFTiB8fCBkYXRhICsgY291bnQgPiBkYXRhZW5kKSB7
CisJCWxvZ2dlcihMX0VSUiwgTF9GVU5DLCAiY2xpZW50X2FkZHIgZXhjZWVkcyBNQVhfUkVRX0xF
TjogJWQiLAorCQkgICAgICAgTUFYX1JFUV9MRU4pOworCQlzZW5kX25vKCIiKTsKKwkJcmV0dXJu
OworCX0JCisKKwltZW1jcHkoY2xpZW50X2FkZHIsIGRhdGEsIGNvdW50KTsKKwljbGllbnRfYWRk
cltjb3VudF0gPSAnXDAnOworCiAJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgCSAqIFdlIGRvbid0IGFsbG93IE5VTEwgcGFz
c3dvcmRzIG9yIGxvZ2luIG5hbWVzCiAJICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwpAQCAtMzEyLDcgKzMyOSw3IEBACiAJLyoq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqCiAJICogR2V0IHRoZSBtZWNoYW5pc20gcmVzcG9uc2UgZnJvbSBkb19hdXRoKCkgYW5kIHNl
bmQgaXQgYmFjay4KIAkgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKiovCi0JcmVzcG9uc2UgPSBkb19hdXRoKGxvZ2luLCBwYXNzd29y
ZCwgc2VydmljZSwgcmVhbG0pOworCXJlc3BvbnNlID0gZG9fYXV0aChsb2dpbiwgcGFzc3dvcmQs
IHNlcnZpY2UsIHJlYWxtLCBjbGllbnRfYWRkcik7CiAKIAltZW1zZXQocGFzc3dvcmQsIDAsIHN0
cmxlbihwYXNzd29yZCkpOwogCmRpZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1
dGhkL2lwY191bml4LmMgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2lwY191bml4LmMKLS0t
IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2lwY191bml4LmMJMjAwMy0xMC0zMCAy
MDowNjo0Mi4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9p
cGNfdW5peC5jCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAwCkBAIC0zMjksNiAr
MzI5LDcgQEAKIAljaGFyCQkJcGFzc3dvcmRbTUFYX1JFUV9MRU4gKyAxXTsgLyogcGFzc3dvcmQg
Zm9yIGF1dGhlbnRpY2F0aW9uICAgICAgICAgICAgKi8KIAljaGFyCQkJc2VydmljZVtNQVhfUkVR
X0xFTiArIDFdOyAgLyogc2VydmljZSBuYW1lIGZvciBhdXRoZW50aWNhdGlvbiAgICAgICAgKi8K
IAljaGFyCQkJcmVhbG1bTUFYX1JFUV9MRU4gKyAxXTsgICAgLyogdXNlciByZWFsbSBmb3IgYXV0
aGVudGljYXRpb24gICAgICAgICAgKi8KKwljaGFyCQkJY2xpZW50X2FkZHJbTUFYX1JFUV9MRU4g
KyAxXTsgIC8qIGNsaWVudCBhZGRyZXNzIGFuZCBwb3J0ICAgICAgICAgICAgKi8KIAogCiAJLyoq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqCkBAIC0zOTksMTIgKzQwMCwyOCBAQAogCQlzZW5kX25vKGNvbm5fZmQsICIiKTsKIAkJcmV0
dXJuOwogCX0JCi0KIAlpZiAocnhfcmVjKGNvbm5fZmQsICh2b2lkICopcmVhbG0sIChzaXplX3Qp
Y291bnQpICE9IChzc2l6ZV90KWNvdW50KSAKIAkJcmV0dXJuOwogCiAJcmVhbG1bY291bnRdID0g
J1wwJzsKIAorCS8qIGNsaWVudF9hZGRyICovCisJaWYgKHJ4X3JlYyhjb25uX2ZkLCAodm9pZCAq
KSZjb3VudCwgKHNpemVfdClzaXplb2YoY291bnQpKSAhPSAoc3NpemVfdClzaXplb2YoY291bnQp
KQorCQlyZXR1cm47CisKKwljb3VudCA9IG50b2hzKGNvdW50KTsKKworCWlmIChjb3VudCA+IE1B
WF9SRVFfTEVOKSB7CisJCWxvZ2dlcihMX0VSUiwgTF9GVU5DLCAiY2xpZW50IGFkZHJlc3MgZXhj
ZWVkZWQgTUFYX1JFUV9MRU46ICVkIiwgTUFYX1JFUV9MRU4pOworCQlzZW5kX25vKGNvbm5fZmQs
ICIiKTsKKwkJcmV0dXJuOworCX0KKworCWlmIChyeF9yZWMoY29ubl9mZCwgKHZvaWQgKikmY2xp
ZW50X2FkZHIsIChzaXplX3QpY291bnQpICE9IChzc2l6ZV90KWNvdW50KQorCQlyZXR1cm47CisK
KwljbGllbnRfYWRkcltjb3VudF0gPSAnXDAnOworCiAJLyoqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgCSAqIFdlIGRvbid0IGFs
bG93IE5VTEwgcGFzc3dvcmRzIG9yIGxvZ2luIG5hbWVzCiAJICoqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwpAQCAtNDIzLDcgKzQ0
MCw3IEBACiAJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqCiAJICogR2V0IHRoZSBtZWNoYW5pc20gcmVzcG9uc2UgZnJvbSBkb19h
dXRoKCkgYW5kIHNlbmQgaXQgYmFjay4KIAkgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi0JcmVzcG9uc2UgPSBkb19hdXRoKGxv
Z2luLCBwYXNzd29yZCwgc2VydmljZSwgcmVhbG0pOworCXJlc3BvbnNlID0gZG9fYXV0aChsb2dp
biwgcGFzc3dvcmQsIHNlcnZpY2UsIHJlYWxtLCBjbGllbnRfYWRkcik7CiAKIAltZW1zZXQocGFz
c3dvcmQsIDAsIHN0cmxlbihwYXNzd29yZCkpOwogCmRpZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0
Lm9yaWcvc2FzbGF1dGhkL21lY2hhbmlzbXMuaCBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQv
bWVjaGFuaXNtcy5oCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9tZWNoYW5p
c21zLmgJMjAwNi0wMy0xMyAyMToxNzowOS4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wt
Mi4xLjI0L3Nhc2xhdXRoZC9tZWNoYW5pc21zLmgJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAw
MDAgKzAyMDAKQEAgLTQwLDggKzQwLDggQEAKICAgICBjaGFyICpuYW1lOwkJCQkvKiBuYW1lIG9m
IHRoZSBtZWNoYW5pc20gKi8KICAgICBpbnQgKCppbml0aWFsaXplKSh2b2lkKTsJCS8qIGluaXRp
YWxpemF0aW9uIGZ1bmN0aW9uICovCiAgICAgY2hhciAqKCphdXRoZW50aWNhdGUpKGNvbnN0IGNo
YXIgKiwgY29uc3QgY2hhciAqLAotCQkJICBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7IC8q
IGF1dGhlbnRpY2F0aW9uCi0JCQkJCQkJICBmdW5jdGlvbiAqLworCQkJICBjb25zdCBjaGFyICos
IGNvbnN0IGNoYXIgKiwKKwkJCSAgY29uc3QgY2hhciAqKTsgLyogYXV0aGVudGljYXRpb24gZnVu
Y3Rpb24gKi8KIH0gYXV0aG1lY2hfdDsKIAogZXh0ZXJuIGF1dGhtZWNoX3QgbWVjaGFuaXNtc1td
OwkJLyogYXJyYXkgb2Ygc3VwcG9ydGVkIGF1dGggbWVjaHMgKi8KZGlmZiAtcnUgY3lydXMtc2Fz
bC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uYyBjeXJ1cy1zYXNsLTIuMS4y
NC9zYXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uYwotLS0gY3lydXMtc2FzbC0yLjEuMjQub3JpZy9z
YXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uYwkyMDA5LTA1LTA3IDE3OjIxOjE2LjAwMDAwMDAwMCAr
MDIwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL3Nhc2xhdXRoZC1tYWluLmMJMjAx
MS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAwMDAgKzAyMDAKQEAgLTM3OCw3ICszNzgsNyBAQAogICog
cmV0dXJuIGEgcG9pbnRlciB0byBhIHN0cmluZyB0byBzZW5kIGJhY2sgdG8gdGhlIGNsaWVudC4K
ICAqIFRoZSBjYWxsZXIgaXMgcmVzcG9uc2libGUgZm9yIGZyZWVpbmcgdGhlIHBvaW50ZXIuIAog
ICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqLwotY2hhciAqZG9fYXV0aChjb25zdCBjaGFyICpfbG9naW4sIGNvbnN0IGNoYXIgKnBh
c3N3b3JkLCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFsbSkgeworY2hhciAq
ZG9fYXV0aChjb25zdCBjaGFyICpfbG9naW4sIGNvbnN0IGNoYXIgKnBhc3N3b3JkLCBjb25zdCBj
aGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqcmVtb3RlKSB7CiAK
IAlzdHJ1Y3QgY2FjaGVfcmVzdWx0CWxrdXBfcmVzdWx0OwogCWNoYXIJCQkqcmVzcG9uc2U7CkBA
IC00MDcsNyArNDA3LDcgQEAKIAkJcmVzcG9uc2UgPSBzdHJkdXAoIk9LIik7CiAJCWNhY2hlZCA9
IDE7CiAJfSBlbHNlIHsKLQkJcmVzcG9uc2UgPSBhdXRoX21lY2gtPmF1dGhlbnRpY2F0ZShsb2dp
biwgcGFzc3dvcmQsIHNlcnZpY2UsIHJlYWxtKTsKKwkJcmVzcG9uc2UgPSBhdXRoX21lY2gtPmF1
dGhlbnRpY2F0ZShsb2dpbiwgcGFzc3dvcmQsIHNlcnZpY2UsIHJlYWxtLCByZW1vdGUpOwogCiAJ
CWlmIChyZXNwb25zZSA9PSBOVUxMKSB7CiAJCQlsb2dnZXIoTF9FUlIsIExfRlVOQywgImludGVy
bmFsIG1lY2hhbmlzbSBmYWlsdXJlOiAlcyIsIGF1dGhfbWVjaC0+bmFtZSk7CkBAIC00MjAsMTgg
KzQyMCwxOCBAQAogCiAJCWlmIChmbGFncyAmIFZFUkJPU0UpIHsKIAkJCWlmIChjYWNoZWQpIAot
CQkJCWxvZ2dlcihMX0RFQlVHLCBMX0ZVTkMsICJhdXRoIHN1Y2Nlc3MgKGNhY2hlZCk6IFt1c2Vy
PSVzXSBbc2VydmljZT0lc10gW3JlYWxtPSVzXSIsIFwKLQkJCQkJbG9naW4sIHNlcnZpY2UsIHJl
YWxtKTsKKwkJCQlsb2dnZXIoTF9ERUJVRywgTF9GVU5DLCAiYXV0aCBzdWNjZXNzIChjYWNoZWQp
OiBbdXNlcj0lc10gW3NlcnZpY2U9JXNdIFtyZWFsbT0lc10gW3JlbW90ZT0lc10iLCBcCisJCQkJ
CWxvZ2luLCBzZXJ2aWNlLCByZWFsbSwgcmVtb3RlKTsKIAkJCWVsc2UKLQkJCQlsb2dnZXIoTF9E
RUJVRywgTF9GVU5DLCAiYXV0aCBzdWNjZXNzOiBbdXNlcj0lc10gW3NlcnZpY2U9JXNdIFtyZWFs
bT0lc10gW21lY2g9JXNdIiwgXAotCQkJCQlsb2dpbiwgc2VydmljZSwgcmVhbG0sIGF1dGhfbWVj
aC0+bmFtZSk7CisJCQkJbG9nZ2VyKExfREVCVUcsIExfRlVOQywgImF1dGggc3VjY2VzczogW3Vz
ZXI9JXNdIFtzZXJ2aWNlPSVzXSBbcmVhbG09JXNdIFtyZW1vdGU9JXNdIFttZWNoPSVzXSIsIFwK
KwkJCQkJbG9naW4sIHNlcnZpY2UsIHJlYWxtLCByZW1vdGUsIGF1dGhfbWVjaC0+bmFtZSk7CiAJ
CX0KIAkJcmV0dXJuIHJlc3BvbnNlOwogCX0KIAogCWlmIChzdHJuY21wKHJlc3BvbnNlLCAiTk8i
LCAyKSA9PSAwKSB7Ci0JCWxvZ2dlcihMX0lORk8sIExfRlVOQywgImF1dGggZmFpbHVyZTogW3Vz
ZXI9JXNdIFtzZXJ2aWNlPSVzXSBbcmVhbG09JXNdIFttZWNoPSVzXSBbcmVhc29uPSVzXSIsIFwK
LQkJCWxvZ2luLCBzZXJ2aWNlLCByZWFsbSwgYXV0aF9tZWNoLT5uYW1lLAorCQlsb2dnZXIoTF9J
TkZPLCBMX0ZVTkMsICJhdXRoIGZhaWx1cmU6IFt1c2VyPSVzXSBbc2VydmljZT0lc10gW3JlYWxt
PSVzXSBbcmVtb3RlPSVzXSBbbWVjaD0lc10gW3JlYXNvbj0lc10iLCBcCisJCQlsb2dpbiwgc2Vy
dmljZSwgcmVhbG0sIHJlbW90ZSwgYXV0aF9tZWNoLT5uYW1lLAogCQkgICAgICAgIHN0cmxlbihy
ZXNwb25zZSkgPj0gNCA/IHJlc3BvbnNlKzMgOiAiVW5rbm93biIpOwogCiAJCXJldHVybiByZXNw
b25zZTsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvc2FzbGF1dGhk
LW1haW4uaCBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uaAotLS0g
Y3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uaAkyMDAzLTA1
LTE2IDAwOjIxOjQxLjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1
dGhkL3Nhc2xhdXRoZC1tYWluLmgJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAwMDAgKzAyMDAK
QEAgLTg4LDcgKzg4LDggQEAKIAogLyogc2FzbGF1dGhkLW1haW4uYyAqLwogZXh0ZXJuIGNoYXIJ
KmRvX2F1dGgoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosCi0JCQkgY29uc3QgY2hhciAqLCBj
b25zdCBjaGFyICopOworCQkJIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLAorCQkJIGNvbnN0
IGNoYXIgKik7CiBleHRlcm4gdm9pZAlzZXRfYXV0aF9tZWNoKGNvbnN0IGNoYXIgKik7CiBleHRl
cm4gdm9pZAlzZXRfbWF4X3Byb2NzKGNvbnN0IGNoYXIgKik7CiBleHRlcm4gdm9pZAlzZXRfbWVj
aF9vcHRpb24oY29uc3QgY2hhciAqKTsK
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1409</attachid>
            <date>2011-08-09 12:45 EDT</date>
            <desc>Corrected version of the 2.1.24 patch</desc>
            <filename>saslauthd_pam_rhost_2.1.24rc1.diff</filename>
            <type>text/plain</type>
            <size>25392</size>
            <attacher>lorenzo@sancho.ccd.uniroma2.it</attacher>
            
              <data encoding="base64">ZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9saWIvY2hlY2twdy5jIGN5cnVzLXNhc2wt
Mi4xLjI0L2xpYi9jaGVja3B3LmMKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvbGliL2NoZWNr
cHcuYwkyMDA5LTA4LTEzIDE0OjM2OjQyLjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbC0y
LjEuMjQvbGliL2NoZWNrcHcuYwkyMDExLTA1LTIyIDEyOjM5OjA1LjAwMDAwMDAwMCArMDIwMApA
QCAtNjU0LDYgKzY1NCw4IEBACiAgICAgY2hhciBwd3BhdGhbc2l6ZW9mKHNydmFkZHIuc3VuX3Bh
dGgpXTsKICAgICBjb25zdCBjaGFyICpwID0gTlVMTDsKICAgICBjaGFyICpmcmVlbWUgPSBOVUxM
OworICAgIGNoYXIgKmZyZWVtZXRvbyA9IE5VTEw7CisgICAgY29uc3QgY2hhciAqY2xpZW50X2Fk
ZHIgPSBOVUxMOwogI2lmZGVmIFVTRV9ET09SUwogICAgIGRvb3JfYXJnX3QgYXJnOwogI2VuZGlm
CkBAIC02ODUsMTMgKzY4NywxOSBAQAogCXVzZXJfcmVhbG0gPSBydG1wICsgMTsKICAgICB9CiAK
KyAgICBpZiAoc2FzbF9nZXRwcm9wKGNvbm4sIFNBU0xfSVBSRU1PVEVQT1JULCAoY29uc3Qgdm9p
ZCAqKikgJiBjbGllbnRfYWRkcikgPT0gU0FTTF9PSykgeworCWlmKF9zYXNsX3N0cmR1cChjbGll
bnRfYWRkciwgJmZyZWVtZXRvbywgTlVMTCkgIT0gU0FTTF9PSykKKwkgICAgZ290byBmYWlsOwor
CWNsaWVudF9hZGRyID0gZnJlZW1ldG9vOworICAgIH0KKwogICAgIC8qCiAgICAgICogYnVpbGQg
cmVxdWVzdCBvZiB0aGUgZm9ybToKICAgICAgKgotICAgICAqIGNvdW50IGF1dGhpZCBjb3VudCBw
YXNzd29yZCBjb3VudCBzZXJ2aWNlIGNvdW50IHJlYWxtCisgICAgICogY291bnQgYXV0aGlkIGNv
dW50IHBhc3N3b3JkIGNvdW50IHNlcnZpY2UgY291bnQgcmVhbG0gY2xpZW50CiAgICAgICovCiAg
ICAgewotIAl1bnNpZ25lZCBzaG9ydCBtYXhfbGVuLCByZXFfbGVuLCB1X2xlbiwgcF9sZW4sIHNf
bGVuLCByX2xlbjsKKyAJdW5zaWduZWQgc2hvcnQgbWF4X2xlbiwgcmVxX2xlbiwgdV9sZW4sIHBf
bGVuLCBzX2xlbiwgcl9sZW4sIGNfbGVuOwogIAogCW1heF9sZW4gPSAodW5zaWduZWQgc2hvcnQp
IHNpemVvZihxdWVyeSk7CiAKQEAgLTY5OSw3ICs3MDcsOCBAQAogCWlmICgoc3RybGVuKHVzZXJp
ZCkgPiBVU0hSVF9NQVgpIHx8CiAJICAgIChzdHJsZW4ocGFzc3dkKSA+IFVTSFJUX01BWCkgfHwK
IAkgICAgKHN0cmxlbihzZXJ2aWNlKSA+IFVTSFJUX01BWCkgfHwKLQkgICAgKHVzZXJfcmVhbG0g
JiYgKHN0cmxlbih1c2VyX3JlYWxtKSA+IFVTSFJUX01BWCkpKSB7CisJICAgICh1c2VyX3JlYWxt
ICYmIChzdHJsZW4odXNlcl9yZWFsbSkgPiBVU0hSVF9NQVgpKSB8fAorCSAgICAoY2xpZW50X2Fk
ZHIgJiYgKHN0cmxlbihjbGllbnRfYWRkcikgPiBVU0hSVF9NQVgpKSkgewogCSAgICBnb3RvIHRv
b2JpZzsKIAl9CiAKQEAgLTcwNyw2ICs3MTYsNyBAQAogIAlwX2xlbiA9IChzdHJsZW4ocGFzc3dk
KSk7CiAJc19sZW4gPSAoc3RybGVuKHNlcnZpY2UpKTsKIAlyX2xlbiA9ICgodXNlcl9yZWFsbSA/
IHN0cmxlbih1c2VyX3JlYWxtKSA6IDApKTsKKwljX2xlbiA9ICgoY2xpZW50X2FkZHIgPyBzdHJs
ZW4oY2xpZW50X2FkZHIpOiAwKSk7CiAKIAkvKiBwcmV2ZW50IGJ1ZmZlciBvdmVyZmxvdyAqLwog
CXJlcV9sZW4gPSAzMDsKQEAgLTcxNywxMSArNzI3LDE0IEBACiAJaWYgKG1heF9sZW4gLSByZXFf
bGVuIDwgc19sZW4pIGdvdG8gdG9vYmlnOwogCXJlcV9sZW4gKz0gc19sZW47CiAJaWYgKG1heF9s
ZW4gLSByZXFfbGVuIDwgcl9sZW4pIGdvdG8gdG9vYmlnOworCXJlcV9sZW4gKz0gcl9sZW47CisJ
aWYgKG1heF9sZW4gLSByZXFfbGVuIDwgY19sZW4pIGdvdG8gdG9vYmlnOwogCiAJdV9sZW4gPSBo
dG9ucyh1X2xlbik7CiAJcF9sZW4gPSBodG9ucyhwX2xlbik7CiAJc19sZW4gPSBodG9ucyhzX2xl
bik7CiAJcl9sZW4gPSBodG9ucyhyX2xlbik7CisJY19sZW4gPSBodG9ucyhjX2xlbik7CiAKIAlt
ZW1jcHkocXVlcnlfZW5kLCAmdV9sZW4sIHNpemVvZih1bnNpZ25lZCBzaG9ydCkpOwogCXF1ZXJ5
X2VuZCArPSBzaXplb2YodW5zaWduZWQgc2hvcnQpOwpAQCAtNzM4LDYgKzc1MSwxMCBAQAogCW1l
bWNweShxdWVyeV9lbmQsICZyX2xlbiwgc2l6ZW9mKHVuc2lnbmVkIHNob3J0KSk7CiAJcXVlcnlf
ZW5kICs9IHNpemVvZih1bnNpZ25lZCBzaG9ydCk7CiAJaWYgKHVzZXJfcmVhbG0pIHdoaWxlICgq
dXNlcl9yZWFsbSkgKnF1ZXJ5X2VuZCsrID0gKnVzZXJfcmVhbG0rKzsKKworCW1lbWNweShxdWVy
eV9lbmQsICZjX2xlbiwgc2l6ZW9mKHVuc2lnbmVkIHNob3J0KSk7CisJcXVlcnlfZW5kICs9IHNp
emVvZih1bnNpZ25lZCBzaG9ydCk7CisJaWYoY2xpZW50X2FkZHIpIHdoaWxlICgqY2xpZW50X2Fk
ZHIpICpxdWVyeV9lbmQrKyA9ICpjbGllbnRfYWRkcisrOwogICAgIH0KIAogI2lmZGVmIFVTRV9E
T09SUwpAQCAtODM4LDcgKzg1NSw4IEBACiAgICAgY2xvc2Uocyk7CiAjZW5kaWYgLyogVVNFX0RP
T1JTICovCiAgIAotICAgIGlmKGZyZWVtZSkgZnJlZShmcmVlbWUpOworICAgIGlmIChmcmVlbWUp
IGZyZWUoZnJlZW1lKTsKKyAgICBpZiAoZnJlZW1ldG9vKSBmcmVlKGZyZWVtZXRvbyk7CiAKICAg
ICBpZiAoIXN0cm5jbXAocmVzcG9uc2UsICJPSyIsIDIpKSB7CiAJcmV0dXJuIFNBU0xfT0s7CkBA
IC04NTMsNiArODcxLDcgQEAKIAogIGZhaWw6CiAgICAgaWYgKGZyZWVtZSkgZnJlZShmcmVlbWUp
OworICAgIGlmIChmcmVlbWV0b28pIGZyZWUoZnJlZW1ldG9vKTsKICAgICByZXR1cm4gU0FTTF9G
QUlMOwogfQogCmRpZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhf
ZGNlLmMgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfZGNlLmMKLS0tIGN5cnVzLXNh
c2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfZGNlLmMJMjAwMS0xMi0wNCAwMzowNjo1NC4w
MDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2RjZS5j
CTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAwCkBAIC01Niw3ICs1Niw4IEBACiAg
IGNvbnN0IGNoYXIgKmxvZ2luLAkJCS8qIEk6IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAg
IGNvbnN0IGNoYXIgKnBhc3N3b3JkLAkJCS8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBj
b25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFy
ICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0
dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlCiAgIC8qIEVORCBQQVJB
TUVURVJTICovCiAgICkKIHsKQEAgLTEwNCw3ICsxMDUsOCBAQAogICBjb25zdCBjaGFyICpsb2dp
biBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICAgY29uc3QgY2hhciAqcGFzc3dvcmQgX19hdHRy
aWJ1dGVfXygodW51c2VkKSksCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UgX19hdHRyaWJ1dGVfXygo
dW51c2VkKSksCi0gIGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0cmlidXRlX18oKHVudXNlZCkpCisg
IGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAorICBjb25zdCBjaGFy
ICpyZW1vdGUgX19hdHRyaWJ1dGVfXygodW51c2VkKSkKICAgKQogewogICAgICByZXR1cm4gTlVM
TDsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9kY2UuaCBj
eXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9kY2UuaAotLS0gY3lydXMtc2FzbC0yLjEu
MjQub3JpZy9zYXNsYXV0aGQvYXV0aF9kY2UuaAkyMDAxLTEyLTA0IDAzOjA2OjU0LjAwMDAwMDAw
MCArMDEwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfZGNlLmgJMjAxMS0w
NS0yMiAxMjoyNDo0Ny4wMDAwMDAwMDAgKzAyMDAKQEAgLTI2LDQgKzI2LDQgQEAKICAqIEVORCBD
T1BZUklHSFQKICAqLwogCi1jaGFyICphdXRoX2RjZShjb25zdCBjaGFyICosIGNvbnN0IGNoYXIg
KiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOworY2hhciAqYXV0aF9kY2UoY29uc3QgY2hh
ciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFy
ICopOwpkaWZmIC1ydSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX2dldHB3
ZW50LmMgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfZ2V0cHdlbnQuYwotLS0gY3ly
dXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9nZXRwd2VudC5jCTIwMDktMDUtMDcg
MTc6MjE6MTUuMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQv
YXV0aF9nZXRwd2VudC5jCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAwCkBAIC02
Nyw3ICs2Nyw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2luLAkJCS8qIEk6IHBsYWludGV4dCBhdXRo
ZW50aWNhdG9yICovCiAgIGNvbnN0IGNoYXIgKnBhc3N3b3JkLAkJCS8qIEk6IHBsYWludGV4dCBw
YXNzd29yZCAqLwogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkp
LAotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBj
aGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3Rl
ICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUgaG9zdCBhZGRyZXNzICovCiAgIC8qIEVO
RCBQQVJBTUVURVJTICovCiAgICkKIHsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9z
YXNsYXV0aGQvYXV0aF9nZXRwd2VudC5oIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRo
X2dldHB3ZW50LmgKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfZ2V0
cHdlbnQuaAkyMDAxLTEyLTA0IDAzOjA2OjU0LjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMtc2Fz
bC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfZ2V0cHdlbnQuaAkyMDExLTA1LTIyIDEyOjI0OjQ3LjAw
MDAwMDAwMCArMDIwMApAQCAtMjUsNCArMjUsNCBAQAogICogREFNQUdFLgogICogRU5EIENPUFlS
SUdIVCAqLwogCi1jaGFyICphdXRoX2dldHB3ZW50KGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAq
LCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CitjaGFyICphdXRoX2dldHB3ZW50KGNvbnN0
IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3Qg
Y2hhciAqKTsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9o
dHRwZm9ybS5jIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2h0dHBmb3JtLmMKLS0t
IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfaHR0cGZvcm0uYwkyMDA2LTA0
LTE5IDIxOjUxOjA0LjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1
dGhkL2F1dGhfaHR0cGZvcm0uYwkyMDExLTA1LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApA
QCAtNDYzLDcgKzQ2Myw4IEBACiAgIGNvbnN0IGNoYXIgKnVzZXIsCQkJLyogSTogcGxhaW50ZXh0
IGF1dGhlbnRpY2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQsCQkJLyogSTogcGxhaW50
ZXh0IHBhc3N3b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsCi0gIGNvbnN0IGNoYXIgKnJl
YWxtCisgIGNvbnN0IGNoYXIgKnJlYWxtLAorICBjb25zdCBjaGFyICpyZW1vdGUgICAgICAgICAg
ICAgICAgICAgIC8qIEk6IHJlbW90ZSBob3N0IGFkZHJlc3MgKi8KICAgLyogRU5EIFBBUkFNRVRF
UlMgKi8KICAgKQogewpkaWZmIC1ydSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9h
dXRoX2h0dHBmb3JtLmggY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfaHR0cGZvcm0u
aAotLS0gY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9odHRwZm9ybS5oCTIw
MDYtMDMtMTMgMjE6MTc6MDkuMDAwMDAwMDAwICswMTAwCisrKyBjeXJ1cy1zYXNsLTIuMS4yNC9z
YXNsYXV0aGQvYXV0aF9odHRwZm9ybS5oCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICsw
MjAwCkBAIC0yNSw1ICsyNSw1IEBACiAgKiBEQU1BR0UuCiAgKiBFTkQgQ09QWVJJR0hUICovCiAK
LWNoYXIgKmF1dGhfaHR0cGZvcm0oY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKiwgY29uc3QgY2hhciAqKTsKK2NoYXIgKmF1dGhfaHR0cGZvcm0oY29uc3QgY2hhciAqLCBj
b25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOwog
aW50IGF1dGhfaHR0cGZvcm1faW5pdCh2b2lkKTsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQu
b3JpZy9zYXNsYXV0aGQvYXV0aF9rcmI0LmMgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1
dGhfa3JiNC5jCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX2tyYjQu
YwkyMDA1LTAyLTAxIDEzOjI2OjM0LjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMtc2FzbC0yLjEu
MjQvc2FzbGF1dGhkL2F1dGhfa3JiNC5jCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICsw
MjAwCkBAIC0xNzEsNyArMTcxLDggQEAKICAgY29uc3QgY2hhciAqbG9naW4sCQkJLyogSTogcGxh
aW50ZXh0IGF1dGhlbnRpY2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQsCQkJLyogSTog
cGxhaW50ZXh0IHBhc3N3b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsCi0gIGNvbnN0IGNo
YXIgKnJlYWxtX2luCisgIGNvbnN0IGNoYXIgKnJlYWxtX2luLAorICBjb25zdCBjaGFyICpyZW1v
dGUgICAgICAgICAgICAgICAgICAgIC8qIEk6IHJlbW90ZSBob3N0IGFkZHJlc3MgKi8KICAgLyog
RU5EIFBBUkFNRVRFUlMgKi8KICAgKQogewpAQCAtMjgyLDcgKzI4Myw4IEBACiAgIGNvbnN0IGNo
YXIgKmxvZ2luIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAogICBjb25zdCBjaGFyICpwYXNzd29y
ZCBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICAgY29uc3QgY2hhciAqc2VydmljZSBfX2F0dHJp
YnV0ZV9fKCh1bnVzZWQpKSwKLSAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51
c2VkKSkKKyAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisgIGNv
bnN0IGNoYXIgKnJlbW90ZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQogICApCiB7CiAgICAgcmV0
dXJuIE5VTEw7CmRpZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhf
a3JiNC5oIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2tyYjQuaAotLS0gY3lydXMt
c2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9rcmI0LmgJMjAwMS0xMi0wNCAwMzowNjo1
NC4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2ty
YjQuaAkyMDExLTA1LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApAQCAtMjUsNSArMjUsNSBA
QAogICogREFNQUdFLgogICogRU5EIENPUFlSSUdIVCAqLwogCi1jaGFyICphdXRoX2tyYjQoY29u
c3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKK2No
YXIgKmF1dGhfa3JiNChjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBj
b25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CiBpbnQgYXV0aF9rcmI0X2luaXQodm9pZCk7CmRp
ZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfa3JiNS5jIGN5cnVz
LXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2tyYjUuYwotLS0gY3lydXMtc2FzbC0yLjEuMjQu
b3JpZy9zYXNsYXV0aGQvYXV0aF9rcmI1LmMJMjAwOS0wNS0wNyAxNzoyMToxNS4wMDAwMDAwMDAg
KzAyMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX2tyYjUuYwkyMDExLTA1
LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApAQCAtMTcyLDcgKzE3Miw4IEBACiAgIGNvbnN0
IGNoYXIgKnVzZXIsCQkJLyogSTogcGxhaW50ZXh0IGF1dGhlbnRpY2F0b3IgKi8KICAgY29uc3Qg
Y2hhciAqcGFzc3dvcmQsCQkJLyogSTogcGxhaW50ZXh0IHBhc3N3b3JkICovCiAgIGNvbnN0IGNo
YXIgKnNlcnZpY2UsICAgICAgICAgICAgICAgICAgLyogSTogc2VydmljZSBhdXRoZW50aWNhdGlu
ZyB0byAqLwotICBjb25zdCBjaGFyICpyZWFsbSAgICAgICAgICAgICAgICAgICAgIC8qIEk6IHVz
ZXIncyByZWFsbSAqLworICBjb25zdCBjaGFyICpyZWFsbSwgICAgICAgICAgICAgICAgICAgIC8q
IEk6IHVzZXIncyByZWFsbSAqLworICBjb25zdCBjaGFyICpyZW1vdGUgICAgICAgICAgICAgICAg
ICAgIC8qIEk6IHJlbW90ZSBob3N0IGFkZHJlc3MgKi8KICAgLyogRU5EIFBBUkFNRVRFUlMgKi8K
ICAgKQogewpAQCAtMzU2LDcgKzM1Nyw4IEBACiAgIGNvbnN0IGNoYXIgKnVzZXIsCQkJLyogSTog
cGxhaW50ZXh0IGF1dGhlbnRpY2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQsCQkJLyog
STogcGxhaW50ZXh0IHBhc3N3b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsCQkJLyogSTog
c2VydmljZSBhdXRoZW50aWNhdGluZyB0byAqLwotICBjb25zdCBjaGFyICpyZWFsbQkJCS8qIEk6
IHVzZXIncyByZWFsbSAqLworICBjb25zdCBjaGFyICpyZWFsbSwJCQkvKiBJOiB1c2VyJ3MgcmVh
bG0gKi8KKyAgY29uc3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1v
dGUgaG9zdCBhZGRyZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKQEAgLTQ2
NCw3ICs0NjYsOCBAQAogICBjb25zdCBjaGFyICpsb2dpbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQp
KSwKICAgY29uc3QgY2hhciAqcGFzc3dvcmQgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgIGNv
bnN0IGNoYXIgKnNlcnZpY2UgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCi0gIGNvbnN0IGNoYXIg
KnJlYWxtIF9fYXR0cmlidXRlX18oKHVudXNlZCkpCisgIGNvbnN0IGNoYXIgKnJlYWxtIF9fYXR0
cmlidXRlX18oKHVudXNlZCkpLAorICBjb25zdCBjaGFyICpyZW1vdGUgX19hdHRyaWJ1dGVfXygo
dW51c2VkKSkKICAgKQogewogICAgIHJldHVybiBOVUxMOwpkaWZmIC1ydSBjeXJ1cy1zYXNsLTIu
MS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX2tyYjUuaCBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0
aGQvYXV0aF9rcmI1LmgKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhf
a3JiNS5oCTIwMDItMDQtMjUgMjA6MzE6MzguMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1zYXNs
LTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9rcmI1LmgJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAw
MDAgKzAyMDAKQEAgLTI1LDUgKzI1LDUgQEAKICAqIERBTUFHRS4KICAqIEVORCBDT1BZUklHSFQg
Ki8KIAotY2hhciAqYXV0aF9rcmI1KGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBj
aGFyICosIGNvbnN0IGNoYXIgKik7CitjaGFyICphdXRoX2tyYjUoY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOwogaW50
IGF1dGhfa3JiNV9pbml0KHZvaWQpOwpkaWZmIC1ydSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nh
c2xhdXRoZC9hdXRoX2xkYXAuYyBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9sZGFw
LmMKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfbGRhcC5jCTIwMDQt
MTItMDggMTM6MTI6MjcuMDAwMDAwMDAwICswMTAwCisrKyBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNs
YXV0aGQvYXV0aF9sZGFwLmMJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAwMDAgKzAyMDAKQEAg
LTYwLDcgKzYwLDggQEAKICAgY29uc3QgY2hhciAqbG9naW4sCQkJLyogSTogcGxhaW50ZXh0IGF1
dGhlbnRpY2F0b3IgKi8KICAgY29uc3QgY2hhciAqcGFzc3dvcmQsCQkJLyogSTogcGxhaW50ZXh0
IHBhc3N3b3JkICovCiAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsCi0gIGNvbnN0IGNoYXIgKnJlYWxt
CisgIGNvbnN0IGNoYXIgKnJlYWxtLAorICBjb25zdCBjaGFyICpyZW1vdGUgICAgICAgICAgICAg
ICAgICAgIC8qIEk6IHJlbW90ZSBob3N0IGFkZHJlc3MgKi8KICAgLyogRU5EIFBBUkFNRVRFUlMg
Ki8KICAgKQogewpAQCAtMTE2LDcgKzExNyw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2luIF9fYXR0
cmlidXRlX18oKHVudXNlZCkpLAogICBjb25zdCBjaGFyICpwYXNzd29yZCBfX2F0dHJpYnV0ZV9f
KCh1bnVzZWQpKSwKICAgY29uc3QgY2hhciAqc2VydmljZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQp
KSwKLSAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSkKKyAgY29uc3Qg
Y2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisgIGNvbnN0IGNoYXIgKnJlbW90
ZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQogICApCiB7CiAgICAgIHJldHVybiBOVUxMOwpkaWZm
IC1ydSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX2xkYXAuaCBjeXJ1cy1z
YXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9sZGFwLmgKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9y
aWcvc2FzbGF1dGhkL2F1dGhfbGRhcC5oCTIwMDItMDYtMTkgMTk6MzU6MjkuMDAwMDAwMDAwICsw
MjAwCisrKyBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9sZGFwLmgJMjAxMS0wNS0y
MiAxMjoyNDo0Ny4wMDAwMDAwMDAgKzAyMDAKQEAgLTI1LDUgKzI1LDUgQEAKICAqIERBTUFHRS4K
ICAqIEVORCBDT1BZUklHSFQgKi8KIAotY2hhciAqYXV0aF9sZGFwKGNvbnN0IGNoYXIgKiwgY29u
c3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CitjaGFyICphdXRoX2xkYXAo
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBj
b25zdCBjaGFyICopOwogaW50IGF1dGhfbGRhcF9pbml0KHZvaWQpOwpkaWZmIC1ydSBjeXJ1cy1z
YXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX3BhbS5jIGN5cnVzLXNhc2wtMi4xLjI0L3Nh
c2xhdXRoZC9hdXRoX3BhbS5jCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9h
dXRoX3BhbS5jCTIwMDUtMDUtMTUgMDg6NDM6MTkuMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1z
YXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9wYW0uYwkyMDExLTA1LTIyIDEyOjI0OjQ3LjAwMDAw
MDAwMCArMDIwMApAQCAtMTg2LDcgKzE4Niw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2luLAkJCS8q
IEk6IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAgIGNvbnN0IGNoYXIgKnBhc3N3b3JkLAkJ
CS8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBjb25zdCBjaGFyICpzZXJ2aWNlLAkJCS8q
IEk6IHNlcnZpY2UgbmFtZSAqLwotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1
bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAg
Y29uc3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUgaG9zdCBh
ZGRyZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKQEAgLTIxMyw2ICsyMTQs
MTQgQEAKIAogICAgIG15X2FwcGRhdGEucGFtaCA9IHBhbWg7CiAKKyAgICBjaGFyICogcmVtb3Rl
X2hvc3QgPSBzdHJkdXAocmVtb3RlKTsKKyAgICBpZiAocmVtb3RlX2hvc3QpIHsKKwljaGFyICog
c2VtaWNvbCA9IHN0cmNocihyZW1vdGVfaG9zdCwgJzsnKTsKKwlpZiAoc2VtaWNvbCkgKiBzZW1p
Y29sID0gTlVMTDsgLyogdHJ1bmNhdGUgcmVtb3RlX2hvc3QgYXQgdGhlICc7JyBwb3J0IHNlcGFy
YXRvciAqLworCXBhbV9zZXRfaXRlbShwYW1oLCBQQU1fUkhPU1QsIHJlbW90ZV9ob3N0KTsKKwlm
cmVlIChyZW1vdGVfaG9zdCk7CisgICAgfQorCiAgICAgcmMgPSBwYW1fYXV0aGVudGljYXRlKHBh
bWgsIFBBTV9TSUxFTlQpOwogICAgIGlmIChyYyAhPSBQQU1fU1VDQ0VTUykgewogCXN5c2xvZyhM
T0dfREVCVUcsICJERUJVRzogYXV0aF9wYW06IHBhbV9hdXRoZW50aWNhdGUgZmFpbGVkOiAlcyIs
CkBAIC0yNDIsNyArMjUxLDggQEAKICAgY29uc3QgY2hhciAqbG9naW4gX19hdHRyaWJ1dGVfXygo
dW51c2VkKSksCiAgIGNvbnN0IGNoYXIgKnBhc3N3b3JkIF9fYXR0cmlidXRlX18oKHVudXNlZCkp
LAogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25z
dCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFs
bSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlIF9fYXR0cmli
dXRlX18oKHVudXNlZCkpCiAgICkKIHsKICAgICByZXR1cm4gTlVMTDsKZGlmZiAtcnUgY3lydXMt
c2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9wYW0uaCBjeXJ1cy1zYXNsLTIuMS4yNC9z
YXNsYXV0aGQvYXV0aF9wYW0uaAotLS0gY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQv
YXV0aF9wYW0uaAkyMDAxLTEyLTA0IDAzOjA2OjU0LjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMt
c2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfcGFtLmgJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAw
MDAwMDAgKzAyMDAKQEAgLTMyLDQgKzMyLDQgQEAKICAqIERBTUFHRS4KICAqIEVORCBDT1BZUklH
SFQgKi8KIAotY2hhciAqYXV0aF9wYW0oY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0
IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKK2NoYXIgKmF1dGhfcGFtKGNvbnN0IGNoYXIgKiwgY29u
c3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKZGlm
ZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9yaW1hcC5jIGN5cnVz
LXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3JpbWFwLmMKLS0tIGN5cnVzLXNhc2wtMi4xLjI0
Lm9yaWcvc2FzbGF1dGhkL2F1dGhfcmltYXAuYwkyMDA5LTA1LTA3IDE3OjIxOjE1LjAwMDAwMDAw
MCArMDIwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfcmltYXAuYwkyMDEx
LTA1LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApAQCAtMjk4LDcgKzI5OCw4IEBACiAgIGNv
bnN0IGNoYXIgKmxvZ2luLAkJCS8qIEk6IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAgIGNv
bnN0IGNoYXIgKnBhc3N3b3JkLAkJCS8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBjb25z
dCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpy
ZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJp
YnV0ZV9fKCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAg
ICAvKiBJOiByZW1vdGUgaG9zdCBhZGRyZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAg
ICkKIHsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9yaW1h
cC5oIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3JpbWFwLmgKLS0tIGN5cnVzLXNh
c2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfcmltYXAuaAkyMDAxLTEyLTA0IDAzOjA2OjU0
LjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfcmlt
YXAuaAkyMDExLTA1LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApAQCAtMjUsNSArMjUsNSBA
QAogICogREFNQUdFLgogICogRU5EIENPUFlSSUdIVCAqLwogCi1jaGFyICphdXRoX3JpbWFwKGNv
bnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7Citj
aGFyICphdXRoX3JpbWFwKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICos
IGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKIGludCBhdXRoX3JpbWFwX2luaXQodm9pZCk7
CmRpZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfc2FzbGRiLmMg
Y3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfc2FzbGRiLmMKLS0tIGN5cnVzLXNhc2wt
Mi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfc2FzbGRiLmMJMjAwOS0wNS0wNyAxNzoyMToxNi4w
MDAwMDAwMDAgKzAyMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3Nhc2xk
Yi5jCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAwCkBAIC0xMTgsMTMgKzExOCwx
NCBAQAogICBjb25zdCBjaGFyICpsb2dpbiwJCQkvKiBJOiBwbGFpbnRleHQgYXV0aGVudGljYXRv
ciAqLwogICBjb25zdCBjaGFyICpwYXNzd29yZCwJCQkvKiBJOiBwbGFpbnRleHQgcGFzc3dvcmQg
Ki8KICAgY29uc3QgY2hhciAqc2VydmljZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKLSAgY29u
c3QgY2hhciAqcmVhbG0KKyAgY29uc3QgY2hhciAqcmVhbG0sCiAjZWxzZQogICBjb25zdCBjaGFy
ICpsb2dpbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwvKiBJOiBwbGFpbnRleHQgYXV0aGVudGlj
YXRvciAqLwogICBjb25zdCBjaGFyICpwYXNzd29yZCBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwg
IC8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0
cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1
bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICNl
bmRpZgorICBjb25zdCBjaGFyICpyZW1vdGUgICAgICAgICAgICAgICAgICAgIC8qIEk6IHJlbW90
ZSBob3N0IGFkZHJlc3MgKi8KICAgLyogRU5EIFBBUkFNRVRFUlMgKi8KICAgKQogewpkaWZmIC1y
dSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX3Nhc2xkYi5oIGN5cnVzLXNh
c2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3Nhc2xkYi5oCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5v
cmlnL3Nhc2xhdXRoZC9hdXRoX3Nhc2xkYi5oCTIwMDEtMTItMDQgMDM6MDY6NTUuMDAwMDAwMDAw
ICswMTAwCisrKyBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9zYXNsZGIuaAkyMDEx
LTA1LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCArMDIwMApAQCAtMjUsNCArMjUsNCBAQAogICogREFN
QUdFLgogICogRU5EIENPUFlSSUdIVCAqLwogCi1jaGFyICphdXRoX3Nhc2xkYihjb25zdCBjaGFy
ICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOworY2hhciAqYXV0
aF9zYXNsZGIoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3Qg
Y2hhciAqLCBjb25zdCBjaGFyICopOwpkaWZmIC1ydSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nh
c2xhdXRoZC9hdXRoX3NoYWRvdy5jIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3No
YWRvdy5jCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9hdXRoX3NoYWRvdy5j
CTIwMDktMDgtMTQgMTc6NDE6MzYuMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1zYXNsLTIuMS4y
NC9zYXNsYXV0aGQvYXV0aF9zaGFkb3cuYwkyMDExLTA1LTIyIDEyOjI0OjQ3LjAwMDAwMDAwMCAr
MDIwMApAQCAtODYsNyArODYsOCBAQAogICBjb25zdCBjaGFyICpsb2dpbiwJCQkvKiBJOiBwbGFp
bnRleHQgYXV0aGVudGljYXRvciAqLwogICBjb25zdCBjaGFyICpwYXNzd29yZCwJCQkvKiBJOiBw
bGFpbnRleHQgcGFzc3dvcmQgKi8KICAgY29uc3QgY2hhciAqc2VydmljZSBfX2F0dHJpYnV0ZV9f
KCh1bnVzZWQpKSwKLSAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSkK
KyAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisgIGNvbnN0IGNo
YXIgKnJlbW90ZSAgICAgICAgICAgICAgICAgICAgLyogSTogcmVtb3RlIGhvc3QgYWRkcmVzcyAq
LwogICAvKiBFTkQgUEFSQU1FVEVSUyAqLwogICApCiB7CkBAIC0yODAsNyArMjgxLDggQEAKICAg
Y29uc3QgY2hhciAqbG9naW4gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgIGNvbnN0IGNoYXIg
KnBhc3N3ZCBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICAgY29uc3QgY2hhciAqc2VydmljZSBf
X2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKLSAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVf
XygodW51c2VkKSkKKyAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVfXygodW51c2VkKSks
CisgIGNvbnN0IGNoYXIgKnJlbW90ZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQogICApCiB7CiAg
ICAgcmV0dXJuIE5VTEw7CmRpZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhk
L2F1dGhfc2hhZG93LmggY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2F1dGhfc2hhZG93LmgK
LS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfc2hhZG93LmgJMjAwMS0x
Mi0wNCAwMzowNjo1NS4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xh
dXRoZC9hdXRoX3NoYWRvdy5oCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAwCkBA
IC0yNSw0ICsyNSw0IEBACiAgKiBEQU1BR0UuCiAgKiBFTkQgQ09QWVJJR0hUICovCiAKLWNoYXIg
KmF1dGhfc2hhZG93KGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNv
bnN0IGNoYXIgKik7CitjaGFyICphdXRoX3NoYWRvdyhjb25zdCBjaGFyICosIGNvbnN0IGNoYXIg
KiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CmRpZmYgLXJ1IGN5
cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2F1dGhfc2lhLmMgY3lydXMtc2FzbC0yLjEu
MjQvc2FzbGF1dGhkL2F1dGhfc2lhLmMKLS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1
dGhkL2F1dGhfc2lhLmMJMjAwMS0xMi0wNCAwMzowNjo1NS4wMDAwMDAwMDAgKzAxMDAKKysrIGN5
cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRoZC9hdXRoX3NpYS5jCTIwMTEtMDUtMjIgMTI6MjQ6NDcu
MDAwMDAwMDAwICswMjAwCkBAIC01Niw3ICs1Niw4IEBACiAgIGNvbnN0IGNoYXIgKmxvZ2luLAkJ
CS8qIEk6IHBsYWludGV4dCBhdXRoZW50aWNhdG9yICovCiAgIGNvbnN0IGNoYXIgKnBhc3N3b3Jk
LAkJCS8qIEk6IHBsYWludGV4dCBwYXNzd29yZCAqLwogICBjb25zdCBjaGFyICpzZXJ2aWNlIF9f
YXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9f
KCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwK
KyAgY29uc3QgY2hhciAqcmVtb3RlICAgICAgICAgICAgICAgICAgICAvKiBJOiByZW1vdGUgaG9z
dCBhZGRyZXNzICovCiAgIC8qIEVORCBQQVJBTUVURVJTICovCiAgICkKIHsKQEAgLTg0LDcgKzg1
LDggQEAKICAgY29uc3QgY2hhciAqbG9naW4gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgIGNv
bnN0IGNoYXIgKnBhc3N3b3JkIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAogICBjb25zdCBjaGFy
ICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAotICBjb25zdCBjaGFyICpyZWFsbSBf
X2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQorICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9f
KCh1bnVzZWQpKSwKKyAgY29uc3QgY2hhciAqcmVtb3RlIF9fYXR0cmlidXRlX18oKHVudXNlZCkp
CiAgICkKIHsKICAgICByZXR1cm4gTlVMTDsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3Jp
Zy9zYXNsYXV0aGQvYXV0aF9zaWEuaCBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvYXV0aF9z
aWEuaAotLS0gY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvYXV0aF9zaWEuaAkyMDAx
LTEyLTA0IDAzOjA2OjU1LjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2Fz
bGF1dGhkL2F1dGhfc2lhLmgJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAwMDAgKzAyMDAKQEAg
LTI1LDQgKzI1LDQgQEAKICAqIERBTUFHRS4KICAqIEVORCBDT1BZUklHSFQgKi8KIAotY2hhciAq
YXV0aF9zaWEoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3Qg
Y2hhciAqKTsKK2NoYXIgKmF1dGhfc2lhKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKZGlmZiAtcnUgY3lydXMtc2Fz
bC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvaXBjX2Rvb3JzLmMgY3lydXMtc2FzbC0yLjEuMjQvc2Fz
bGF1dGhkL2lwY19kb29ycy5jCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9p
cGNfZG9vcnMuYwkyMDA0LTA0LTI3IDE4OjAxOjUwLjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMt
c2FzbC0yLjEuMjQvc2FzbGF1dGhkL2lwY19kb29ycy5jCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAw
MDAwMDAwICswMjAwCkBAIC0yMTgsNiArMjE4LDcgQEAKIAljaGFyCQkJcGFzc3dvcmRbTUFYX1JF
UV9MRU4gKyAxXTsgLyogcGFzc3dvcmQgZm9yIGF1dGhlbnRpY2F0aW9uICAgICAgICAgICAgKi8K
IAljaGFyCQkJc2VydmljZVtNQVhfUkVRX0xFTiArIDFdOyAgLyogc2VydmljZSBuYW1lIGZvciBh
dXRoZW50aWNhdGlvbiAgICAgICAgKi8KIAljaGFyCQkJcmVhbG1bTUFYX1JFUV9MRU4gKyAxXTsg
ICAgLyogdXNlciByZWFsbSBmb3IgYXV0aGVudGljYXRpb24gICAgICAgICAgKi8KKwljaGFyCQkJ
Y2xpZW50X2FkZHJbTUFYX1JFUV9MRU4gKyAxXTsgIC8qIGNsaWVudCBhZGRyZXNzIGFuZCBwb3J0
ICAgICAgICAgICAgKi8KIAogCiAJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqCkBAIC0yOTQsNiArMjk1LDIyIEBACiAJbWVtY3B5
KHJlYWxtLCBkYXRhLCBjb3VudCk7CiAJcmVhbG1bY291bnRdID0gJ1wwJzsKIAorCS8qIGNsaWVu
dF9hZGRyICovCisJbWVtY3B5KCZjb3VudCwgZGF0YSwgc2l6ZW9mKHVuc2lnbmVkIHNob3J0KSk7
CisKKwljb3VudCA9IG50b2hzKGNvdW50KTsKKwlkYXRhICs9IHNpemVvZih1bnNpZ25lZCBzaG9y
dCk7CisKKwlpZiAoY291bnQgPiBNQVhfUkVRX0xFTiB8fCBkYXRhICsgY291bnQgPiBkYXRhZW5k
KSB7CisJCWxvZ2dlcihMX0VSUiwgTF9GVU5DLCAiY2xpZW50X2FkZHIgZXhjZWVkcyBNQVhfUkVR
X0xFTjogJWQiLAorCQkgICAgICAgTUFYX1JFUV9MRU4pOworCQlzZW5kX25vKCIiKTsKKwkJcmV0
dXJuOworCX0JCisKKwltZW1jcHkoY2xpZW50X2FkZHIsIGRhdGEsIGNvdW50KTsKKwljbGllbnRf
YWRkcltjb3VudF0gPSAnXDAnOworCiAJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgCSAqIFdlIGRvbid0IGFsbG93IE5VTEwg
cGFzc3dvcmRzIG9yIGxvZ2luIG5hbWVzCiAJICoqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwpAQCAtMzEyLDcgKzMyOSw3IEBACiAJ
LyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqCiAJICogR2V0IHRoZSBtZWNoYW5pc20gcmVzcG9uc2UgZnJvbSBkb19hdXRoKCkgYW5k
IHNlbmQgaXQgYmFjay4KIAkgKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKiovCi0JcmVzcG9uc2UgPSBkb19hdXRoKGxvZ2luLCBwYXNz
d29yZCwgc2VydmljZSwgcmVhbG0pOworCXJlc3BvbnNlID0gZG9fYXV0aChsb2dpbiwgcGFzc3dv
cmQsIHNlcnZpY2UsIHJlYWxtLCBjbGllbnRfYWRkcik7CiAKIAltZW1zZXQocGFzc3dvcmQsIDAs
IHN0cmxlbihwYXNzd29yZCkpOwogCmRpZmYgLXJ1IGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2Fz
bGF1dGhkL2lwY191bml4LmMgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL2lwY191bml4LmMK
LS0tIGN5cnVzLXNhc2wtMi4xLjI0Lm9yaWcvc2FzbGF1dGhkL2lwY191bml4LmMJMjAwMy0xMC0z
MCAyMDowNjo0Mi4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L3Nhc2xhdXRo
ZC9pcGNfdW5peC5jCTIwMTEtMDUtMjIgMTI6MjQ6NDcuMDAwMDAwMDAwICswMjAwCkBAIC0zMjks
NiArMzI5LDcgQEAKIAljaGFyCQkJcGFzc3dvcmRbTUFYX1JFUV9MRU4gKyAxXTsgLyogcGFzc3dv
cmQgZm9yIGF1dGhlbnRpY2F0aW9uICAgICAgICAgICAgKi8KIAljaGFyCQkJc2VydmljZVtNQVhf
UkVRX0xFTiArIDFdOyAgLyogc2VydmljZSBuYW1lIGZvciBhdXRoZW50aWNhdGlvbiAgICAgICAg
Ki8KIAljaGFyCQkJcmVhbG1bTUFYX1JFUV9MRU4gKyAxXTsgICAgLyogdXNlciByZWFsbSBmb3Ig
YXV0aGVudGljYXRpb24gICAgICAgICAgKi8KKwljaGFyCQkJY2xpZW50X2FkZHJbTUFYX1JFUV9M
RU4gKyAxXTsgIC8qIGNsaWVudCBhZGRyZXNzIGFuZCBwb3J0ICAgICAgICAgICAgKi8KIAogCiAJ
LyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqCkBAIC0zOTksMTIgKzQwMCwyOCBAQAogCQlzZW5kX25vKGNvbm5fZmQsICIiKTsKIAkJ
cmV0dXJuOwogCX0JCi0KIAlpZiAocnhfcmVjKGNvbm5fZmQsICh2b2lkICopcmVhbG0sIChzaXpl
X3QpY291bnQpICE9IChzc2l6ZV90KWNvdW50KSAKIAkJcmV0dXJuOwogCiAJcmVhbG1bY291bnRd
ID0gJ1wwJzsKIAorCS8qIGNsaWVudF9hZGRyICovCisJaWYgKHJ4X3JlYyhjb25uX2ZkLCAodm9p
ZCAqKSZjb3VudCwgKHNpemVfdClzaXplb2YoY291bnQpKSAhPSAoc3NpemVfdClzaXplb2YoY291
bnQpKQorCQlyZXR1cm47CisKKwljb3VudCA9IG50b2hzKGNvdW50KTsKKworCWlmIChjb3VudCA+
IE1BWF9SRVFfTEVOKSB7CisJCWxvZ2dlcihMX0VSUiwgTF9GVU5DLCAiY2xpZW50IGFkZHJlc3Mg
ZXhjZWVkZWQgTUFYX1JFUV9MRU46ICVkIiwgTUFYX1JFUV9MRU4pOworCQlzZW5kX25vKGNvbm5f
ZmQsICIiKTsKKwkJcmV0dXJuOworCX0KKworCWlmIChyeF9yZWMoY29ubl9mZCwgKHZvaWQgKikm
Y2xpZW50X2FkZHIsIChzaXplX3QpY291bnQpICE9IChzc2l6ZV90KWNvdW50KQorCQlyZXR1cm47
CisKKwljbGllbnRfYWRkcltjb3VudF0gPSAnXDAnOworCiAJLyoqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqCiAgCSAqIFdlIGRvbid0
IGFsbG93IE5VTEwgcGFzc3dvcmRzIG9yIGxvZ2luIG5hbWVzCiAJICoqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwpAQCAtNDIzLDcg
KzQ0MCw3IEBACiAJLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqCiAJICogR2V0IHRoZSBtZWNoYW5pc20gcmVzcG9uc2UgZnJvbSBk
b19hdXRoKCkgYW5kIHNlbmQgaXQgYmFjay4KIAkgKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKiovCi0JcmVzcG9uc2UgPSBkb19hdXRo
KGxvZ2luLCBwYXNzd29yZCwgc2VydmljZSwgcmVhbG0pOworCXJlc3BvbnNlID0gZG9fYXV0aChs
b2dpbiwgcGFzc3dvcmQsIHNlcnZpY2UsIHJlYWxtLCBjbGllbnRfYWRkcik7CiAKIAltZW1zZXQo
cGFzc3dvcmQsIDAsIHN0cmxlbihwYXNzd29yZCkpOwogCmRpZmYgLXJ1IGN5cnVzLXNhc2wtMi4x
LjI0Lm9yaWcvc2FzbGF1dGhkL21lY2hhbmlzbXMuaCBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0
aGQvbWVjaGFuaXNtcy5oCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5vcmlnL3Nhc2xhdXRoZC9tZWNo
YW5pc21zLmgJMjAwNi0wMy0xMyAyMToxNzowOS4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLXNh
c2wtMi4xLjI0L3Nhc2xhdXRoZC9tZWNoYW5pc21zLmgJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAw
MDAwMDAgKzAyMDAKQEAgLTQwLDggKzQwLDggQEAKICAgICBjaGFyICpuYW1lOwkJCQkvKiBuYW1l
IG9mIHRoZSBtZWNoYW5pc20gKi8KICAgICBpbnQgKCppbml0aWFsaXplKSh2b2lkKTsJCS8qIGlu
aXRpYWxpemF0aW9uIGZ1bmN0aW9uICovCiAgICAgY2hhciAqKCphdXRoZW50aWNhdGUpKGNvbnN0
IGNoYXIgKiwgY29uc3QgY2hhciAqLAotCQkJICBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7
IC8qIGF1dGhlbnRpY2F0aW9uCi0JCQkJCQkJICBmdW5jdGlvbiAqLworCQkJICBjb25zdCBjaGFy
ICosIGNvbnN0IGNoYXIgKiwKKwkJCSAgY29uc3QgY2hhciAqKTsgLyogYXV0aGVudGljYXRpb24g
ZnVuY3Rpb24gKi8KIH0gYXV0aG1lY2hfdDsKIAogZXh0ZXJuIGF1dGhtZWNoX3QgbWVjaGFuaXNt
c1tdOwkJLyogYXJyYXkgb2Ygc3VwcG9ydGVkIGF1dGggbWVjaHMgKi8KZGlmZiAtcnUgY3lydXMt
c2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uYyBjeXJ1cy1zYXNsLTIu
MS4yNC9zYXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uYwotLS0gY3lydXMtc2FzbC0yLjEuMjQub3Jp
Zy9zYXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uYwkyMDA5LTA1LTA3IDE3OjIxOjE2LjAwMDAwMDAw
MCArMDIwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2FzbGF1dGhkL3Nhc2xhdXRoZC1tYWluLmMJ
MjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAwMDAgKzAyMDAKQEAgLTM3OCw3ICszNzgsNyBAQAog
ICogcmV0dXJuIGEgcG9pbnRlciB0byBhIHN0cmluZyB0byBzZW5kIGJhY2sgdG8gdGhlIGNsaWVu
dC4KICAqIFRoZSBjYWxsZXIgaXMgcmVzcG9uc2libGUgZm9yIGZyZWVpbmcgdGhlIHBvaW50ZXIu
IAogICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqLwotY2hhciAqZG9fYXV0aChjb25zdCBjaGFyICpfbG9naW4sIGNvbnN0IGNoYXIg
KnBhc3N3b3JkLCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFsbSkgeworY2hh
ciAqZG9fYXV0aChjb25zdCBjaGFyICpfbG9naW4sIGNvbnN0IGNoYXIgKnBhc3N3b3JkLCBjb25z
dCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqcmVtb3RlKSB7
CiAKIAlzdHJ1Y3QgY2FjaGVfcmVzdWx0CWxrdXBfcmVzdWx0OwogCWNoYXIJCQkqcmVzcG9uc2U7
CkBAIC00MDcsNyArNDA3LDcgQEAKIAkJcmVzcG9uc2UgPSBzdHJkdXAoIk9LIik7CiAJCWNhY2hl
ZCA9IDE7CiAJfSBlbHNlIHsKLQkJcmVzcG9uc2UgPSBhdXRoX21lY2gtPmF1dGhlbnRpY2F0ZShs
b2dpbiwgcGFzc3dvcmQsIHNlcnZpY2UsIHJlYWxtKTsKKwkJcmVzcG9uc2UgPSBhdXRoX21lY2gt
PmF1dGhlbnRpY2F0ZShsb2dpbiwgcGFzc3dvcmQsIHNlcnZpY2UsIHJlYWxtLCByZW1vdGUpOwog
CiAJCWlmIChyZXNwb25zZSA9PSBOVUxMKSB7CiAJCQlsb2dnZXIoTF9FUlIsIExfRlVOQywgImlu
dGVybmFsIG1lY2hhbmlzbSBmYWlsdXJlOiAlcyIsIGF1dGhfbWVjaC0+bmFtZSk7CkBAIC00MjAs
MTggKzQyMCwxOCBAQAogCiAJCWlmIChmbGFncyAmIFZFUkJPU0UpIHsKIAkJCWlmIChjYWNoZWQp
IAotCQkJCWxvZ2dlcihMX0RFQlVHLCBMX0ZVTkMsICJhdXRoIHN1Y2Nlc3MgKGNhY2hlZCk6IFt1
c2VyPSVzXSBbc2VydmljZT0lc10gW3JlYWxtPSVzXSIsIFwKLQkJCQkJbG9naW4sIHNlcnZpY2Us
IHJlYWxtKTsKKwkJCQlsb2dnZXIoTF9ERUJVRywgTF9GVU5DLCAiYXV0aCBzdWNjZXNzIChjYWNo
ZWQpOiBbdXNlcj0lc10gW3NlcnZpY2U9JXNdIFtyZWFsbT0lc10gW3JlbW90ZT0lc10iLCBcCisJ
CQkJCWxvZ2luLCBzZXJ2aWNlLCByZWFsbSwgcmVtb3RlKTsKIAkJCWVsc2UKLQkJCQlsb2dnZXIo
TF9ERUJVRywgTF9GVU5DLCAiYXV0aCBzdWNjZXNzOiBbdXNlcj0lc10gW3NlcnZpY2U9JXNdIFty
ZWFsbT0lc10gW21lY2g9JXNdIiwgXAotCQkJCQlsb2dpbiwgc2VydmljZSwgcmVhbG0sIGF1dGhf
bWVjaC0+bmFtZSk7CisJCQkJbG9nZ2VyKExfREVCVUcsIExfRlVOQywgImF1dGggc3VjY2Vzczog
W3VzZXI9JXNdIFtzZXJ2aWNlPSVzXSBbcmVhbG09JXNdIFtyZW1vdGU9JXNdIFttZWNoPSVzXSIs
IFwKKwkJCQkJbG9naW4sIHNlcnZpY2UsIHJlYWxtLCByZW1vdGUsIGF1dGhfbWVjaC0+bmFtZSk7
CiAJCX0KIAkJcmV0dXJuIHJlc3BvbnNlOwogCX0KIAogCWlmIChzdHJuY21wKHJlc3BvbnNlLCAi
Tk8iLCAyKSA9PSAwKSB7Ci0JCWxvZ2dlcihMX0lORk8sIExfRlVOQywgImF1dGggZmFpbHVyZTog
W3VzZXI9JXNdIFtzZXJ2aWNlPSVzXSBbcmVhbG09JXNdIFttZWNoPSVzXSBbcmVhc29uPSVzXSIs
IFwKLQkJCWxvZ2luLCBzZXJ2aWNlLCByZWFsbSwgYXV0aF9tZWNoLT5uYW1lLAorCQlsb2dnZXIo
TF9JTkZPLCBMX0ZVTkMsICJhdXRoIGZhaWx1cmU6IFt1c2VyPSVzXSBbc2VydmljZT0lc10gW3Jl
YWxtPSVzXSBbcmVtb3RlPSVzXSBbbWVjaD0lc10gW3JlYXNvbj0lc10iLCBcCisJCQlsb2dpbiwg
c2VydmljZSwgcmVhbG0sIHJlbW90ZSwgYXV0aF9tZWNoLT5uYW1lLAogCQkgICAgICAgIHN0cmxl
bihyZXNwb25zZSkgPj0gNCA/IHJlc3BvbnNlKzMgOiAiVW5rbm93biIpOwogCiAJCXJldHVybiBy
ZXNwb25zZTsKZGlmZiAtcnUgY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvc2FzbGF1
dGhkLW1haW4uaCBjeXJ1cy1zYXNsLTIuMS4yNC9zYXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uaAot
LS0gY3lydXMtc2FzbC0yLjEuMjQub3JpZy9zYXNsYXV0aGQvc2FzbGF1dGhkLW1haW4uaAkyMDAz
LTA1LTE2IDAwOjIxOjQxLjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbC0yLjEuMjQvc2Fz
bGF1dGhkL3Nhc2xhdXRoZC1tYWluLmgJMjAxMS0wNS0yMiAxMjoyNDo0Ny4wMDAwMDAwMDAgKzAy
MDAKQEAgLTg4LDcgKzg4LDggQEAKIAogLyogc2FzbGF1dGhkLW1haW4uYyAqLwogZXh0ZXJuIGNo
YXIJKmRvX2F1dGgoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosCi0JCQkgY29uc3QgY2hhciAq
LCBjb25zdCBjaGFyICopOworCQkJIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLAorCQkJIGNv
bnN0IGNoYXIgKik7CiBleHRlcm4gdm9pZAlzZXRfYXV0aF9tZWNoKGNvbnN0IGNoYXIgKik7CiBl
eHRlcm4gdm9pZAlzZXRfbWF4X3Byb2NzKGNvbnN0IGNoYXIgKik7CiBleHRlcm4gdm9pZAlzZXRf
bWVjaF9vcHRpb24oY29uc3QgY2hhciAqKTsK
</data>        

          </attachment>
      

    </bug>

</bugzilla>