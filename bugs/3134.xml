<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>3134</bug_id>
          
          <creation_ts>2009-01-19 18:29 EDT</creation_ts>
          <short_desc>It is not SASL&apos;s place to enforce security by obscurity!</short_desc>
          <delta_ts>2012-06-06 12:55:14 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus SASL</product>
          <component>saslauthd</component>
          <version>2.1.x</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          <priority>P4</priority>
          <bug_severity>bug</bug_severity>
          <target_milestone>2.1-next</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Greg A. Woods">woods-bugzilla.andrew.cmu.edu@planix.ca</reporter>
          <assigned_to name="Alexey Melnikov">Alexey.Melnikov@isode.com</assigned_to>
          <cc>Alexey.Melnikov@isode.com</cc>
          <qa_contact name="The Cyrus Bugzilla List">cyrus-bugzilla@lists.andrew.cmu.edu</qa_contact>

      

      

      
          <long_desc isprivate="0">
            <who name="Greg A. Woods">woods-bugzilla.andrew.cmu.edu@planix.ca</who>
            <bug_when>2009-01-19 18:29:06 EDT</bug_when>
            <thetext>Created an attachment (id=1053)
Correctly return errors and all status from auth_getpwent()

The auth_getpwent module must not hide whether or not an account exists.

This is the repsonsibility of the caller, not the authentication agent.

Failure to properly return errors from getpwnam() is also a major cause of debugging nightmares.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Greg A. Woods">woods-bugzilla.andrew.cmu.edu@planix.ca</who>
            <bug_when>2009-01-19 19:40:50 EDT</bug_when>
            <thetext>Created an attachment (id=1055)
patch against CVS

This one is against CVS, and also fixes auth_shadow and also provides the necessary autoconf goo, plus a minor doc tweak

note this has been tested on both NetBSD-4.x and SunOS 5.10 too!
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Alexey Melnikov">Alexey.Melnikov@isode.com</who>
            <bug_when>2012-06-06 12:54:37 EDT</bug_when>
            <thetext>Fixed by e3c3d1c0f597a9792e288cf799646183b477e8d2 post 2.1.25.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1053</attachid>
            <date>2009-01-19 18:29 EDT</date>
            <desc>Correctly return errors and all status from auth_getpwent()</desc>
            <filename>auth_getpwent.c-patch</filename>
            <type>text/plain</type>
            <size>1203</size>
            <attacher>woods-bugzilla.andrew.cmu.edu@planix.ca</attacher>
            
              <data encoding="base64">SW5kZXg6IHNhc2xhdXRoZC9hdXRoX2dldHB3ZW50LmMKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2
cy9taXNjL2N5cnVzLXNhc2wvc2FzbGF1dGhkL2F1dGhfZ2V0cHdlbnQuYyx2CnJldHJpZXZpbmcg
cmV2aXNpb24gMS4xLjEuMgpkaWZmIC11IC1yMS4xLjEuMiBhdXRoX2dldHB3ZW50LmMKLS0tIHNh
c2xhdXRoZC9hdXRoX2dldHB3ZW50LmMJMjAgSnVsIDIwMDggMjA6NDQ6NDggLTAwMDAJMS4xLjEu
MgorKysgc2FzbGF1dGhkL2F1dGhfZ2V0cHdlbnQuYwkxOCBKYW4gMjAwOSAxNjo1ODo0MiAtMDAw
MApAQCAtNDAsNiArNDAsNyBAQAogI2luY2x1ZGUgPHVuaXN0ZC5oPgogI2luY2x1ZGUgPHN0cmlu
Zy5oPgogI2luY2x1ZGUgPHB3ZC5oPgorI2luY2x1ZGUgPGVycm5vLmg+CiAKICMgaWZkZWYgV0lU
SF9ERVMKICMgIGlmZGVmIFdJVEhfU1NMX0RFUwpAQCAtNzAsMTcgKzcxLDI5IEBACiB7CiAgICAg
LyogVkFSSUFCTEVTICovCiAgICAgc3RydWN0IHBhc3N3ZCAqcHc7CQkJLyogcG9pbnRlciB0byBw
YXNzd2QgZmlsZSBlbnRyeSAqLworICAgIGludCBlcnJudW07CiAgICAgLyogRU5EIFZBUklBQkxF
UyAqLwogICAKKyAgICBlcnJubyA9IDA7CiAgICAgcHcgPSBnZXRwd25hbShsb2dpbik7CisgICAg
ZXJybnVtID0gZXJybm87CiAgICAgZW5kcHdlbnQoKTsKIAogICAgIGlmIChwdyA9PSBOVUxMKSB7
Ci0JUkVUVVJOKCJOTyIpOworCWlmIChlcnJudW0gIT0gMCkgeworCSAgICBjaGFyICplcnJzdHI7
CisKKwkgICAgaWYgKGFzcHJpbnRmKCZlcnJzdHIsICJOTyBVc2VybmFtZSBsb29rdXAgZmFpbHVy
ZTogJXMiLCBzdHJlcnJvcihlcnJubykpID09IC0xKSB7CisJCVJFVFVSTigiTk8gVXNlcm5hbWUg
bG9va3VwIGZhaWx1cmU6IHVua25vd24gZXJyb3IgKEVOT01FTSkiKTsKKwkgICAgfQorCSAgICBy
ZXR1cm4gZXJyc3RyOworCX0gZWxzZSB7CisJICAgIFJFVFVSTigiTk8gSW52YWxpZCB1c2VybmFt
ZSIpOworCX0KICAgICB9CiAKICAgICBpZiAoc3RyY21wKHB3LT5wd19wYXNzd2QsIChjb25zdCBj
aGFyICopY3J5cHQocGFzc3dvcmQsIHB3LT5wd19wYXNzd2QpKSkgewotCVJFVFVSTigiTk8iKTsK
KwlSRVRVUk4oIk5PIEluY29ycmVjdCBwYXNzd29yZCIpOwogICAgIH0KIAogICAgIFJFVFVSTigi
T0siKTsK
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1055</attachid>
            <date>2009-01-19 19:40 EDT</date>
            <desc>patch against CVS</desc>
            <filename>auth_getpw.patch</filename>
            <type>text/plain</type>
            <size>10759</size>
            <attacher>woods-bugzilla.andrew.cmu.edu@planix.ca</attacher>
            
              <data encoding="base64">SW5kZXg6IHNhc2xhdXRoZC91dGlscy5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3Nh
c2wvc2FzbGF1dGhkL3V0aWxzLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNApkaWZmIC11IC1y
MS40IHV0aWxzLmMKLS0tIHNhc2xhdXRoZC91dGlscy5jCTkgU2VwIDIwMDMgMTU6Mzg6MTUgLTAw
MDAJMS40CisrKyBzYXNsYXV0aGQvdXRpbHMuYwkyMCBKYW4gMjAwOSAwMDozNDo1OCAtMDAwMApA
QCAtMjI3LDYgKzIyNyw1MSBAQAogCX0KIH0KIAorI2lmbmRlZiBIQVZFX0FTUFJJTlRGCisKKyMg
aW5jbHVkZSA8c3RkYXJnLmg+CisKKy8qCisgKiBhc3ByaW50ZiAtLSB3b3JrIGFyb3VuZCBsYW1l
IHN5c3RlbXMgdGhhdCBoYXZlbid0IGFkZGVkIHRoZWlyIG93biB5ZXQKKyAqCisgKiBYWFggcmVs
aWVzIG9uIGEgdmFsaWQgd29ya2luZyAoU3VTdjMpIHZzbnByaW50ZigpLCBPSyBvbiBTdW5PUy01
LjEwIEJVVCBOT1QgQkVGT1JFIQorICovCitpbnQKK2FzcHJpbnRmKGNoYXIgKipzdHIsCisJIGNv
bnN0IGNoYXIgKmZtdCwKKwkgLi4uKQoreworICAgICAgICB2YV9saXN0IGFwOworCWNoYXIgKm5l
d3N0cjsKKwlzaXplX3QgbGVuOworCWludCByZXQ7CisKKwkqc3RyID0gTlVMTDsKKworCXZhX3N0
YXJ0KGFwLCBmbXQpOworCXJldCA9IHZzbnByaW50ZigoY2hhciAqKSBOVUxMLCAoc2l6ZV90KSAw
LCBmbXQsIGFwKTsKKwl2YV9lbmQoYXApOworCWlmIChyZXQgPCAwKSB7CisJCXJldHVybiByZXQ7
CisJfQorCWxlbiA9IChzaXplX3QpIHJldCArIDE7CQkvKiBhbGxvdyBmb3IgbnVsICovCisJaWYg
KChuZXdzdHIgPSBtYWxsb2MobGVuKSkgPT0gTlVMTCkgeworCQlyZXR1cm4gKC0xKTsKKwl9CisJ
dmFfc3RhcnQoYXAsIGZtdCk7CisJcmV0ID0gdnNucHJpbnRmKG5ld3N0ciwgbGVuLCBmbXQsIGFw
KTsKKwl2YV9lbmQoYXApOworCWlmIChyZXQgPj0gMCAmJiAoc2l6ZV90KSByZXQgPCBsZW4pIHsg
LyogWFhYIChyZXQgPT0gbGVuLTEpICovCisJCSpzdHIgPSBuZXdzdHI7CisJfSBlbHNlIHsKKwkJ
ZnJlZShuZXdzdHIpOworCQlyZXR1cm4gcmV0OworCX0KKworCXJldHVybiByZXQ7Cit9CisjZW5k
aWYgLyogSEFWRV9BU1BSSU5URiAqLworCiAjaWZuZGVmIEhBVkVfU1RSTENQWQogLyogc3RybGNw
eSAtLSBjb3B5IHN0cmluZyBzbWFydGx5LgogICoKSW5kZXg6IHNhc2xhdXRoZC9zYXNsYXV0aGQu
bWRvYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9zYXNsL3Nhc2xhdXRoZC9zYXNsYXV0
aGQubWRvYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xOApkaWZmIC11IC1yMS4xOCBzYXNsYXV0
aGQubWRvYwotLS0gc2FzbGF1dGhkL3Nhc2xhdXRoZC5tZG9jCTI1IE1hciAyMDA0IDE4OjI0OjI2
IC0wMDAwCTEuMTgKKysrIHNhc2xhdXRoZC9zYXNsYXV0aGQubWRvYwkyMCBKYW4gMjAwOSAwMDoz
NDo1OCAtMDAwMApAQCAtMTAsNyArMTAsNyBAQAogLlwiIG1hbnBhZ2UgaW4gc2FzbGF1dGhkLjgg
d2hlbmV2ZXIgeW91IGNoYW5nZSB0aGlzIHNvdXJjZQogLlwiIHZlcnNpb24uIE9ubHkgdGhlIHBy
ZS1mb3JtYXR0ZWQgbWFucGFnZSBpcyBpbnN0YWxsZWQuCiAuXCIKLS5EZCAxMCAyNCAyMDAyCisu
RGQgMTIgMTIgMjAwNQogLkR0IFNBU0xBVVRIRCA4CiAuT3MgIkNNVS1TQVNMIgogLlNoIE5BTUUK
QEAgLTk4LDggKzk4LDEzIEBACiBEaXNhYmxlIHRoZSB1c2Ugb2YgYSBsb2NrIGZpbGUgZm9yIGNv
bnRyb2xsaW5nIGFjY2VzcyB0byBhY2NlcHQoKS4KIC5JdCBGbCByCiBDb21iaW5lIHRoZSByZWFs
bSB3aXRoIHRoZSBsb2dpbiAod2l0aCBhbiAnQCcgc2lnbiBpbiBiZXR3ZWVuKS4gIGUuZy4KLWxv
Z2luOiAiZm9vIiByZWFsbTogImJhciIgd2lsbCBnZXQgcGFzc2VkIGFzIGxvZ2luOiAiZm9vQGJh
ciIuICBOb3RlIHRoYXQKLXRoZSByZWFsbSB3aWxsIHN0aWxsIGJlIHBhc3NlZCwgd2hpY2ggbWF5
IGxlYWQgdG8gdW5leHBlY3RlZCBiZWhhdmlvci4KK2xvZ2luOiAiZm9vIiByZWFsbTogImJhciIg
d2lsbCBnZXQgcGFzc2VkIGFzIGxvZ2luOiAiZm9vQGJhciIuICBOb3RlCit0aGF0IHRoZSByZWFs
bSB3aWxsIHN0aWxsIGJlIHBhc3NlZCwgd2hpY2ggbWF5IGxlYWQgdG8gdW5leHBlY3RlZAorYmVo
YXZpb3IgZm9yIGF1dGhlbnRpY2F0aW9uIG1lY2hhbmlzbXMgdGhhdCBtYWtlIHVzZSBvZiB0aGUg
cmVhbG0sCitob3dldmVyIGZvciBtZWNoYW5pc21zIHdoaWNoIGRvbid0LCBzdWNoIGFzCisuQXIg
Z2V0cHdlbnQgLAordGhpcyBpcyB0aGUgb25seSB3YXkgdG8gYXV0aGVudGljYXRlIGRvbWFpbi1z
cGVjaWZpYyB1c2VycyBzaGFyaW5nIHRoZQorc2FtZSB1c2VyaWQuCiAuSXQgRmwgdgogUHJpbnQg
dGhlIHZlcnNpb24gbnVtYmVyIGFuZCBhdmFpbGFibGUgYXV0aGVudGljYXRpb24KIG1lY2hhbmlz
bXMgb24gc3RhbmRhcmQgZXJyb3IsIHRoZW4gZXhpdC4KQEAgLTExOSw3ICsxMjQsNyBAQAogLlFx
IGF1dGhlbnRpY2F0aW9uIG1lY2hhbmlzbXMgLAogZGVwZW5kZW50IHVwb24gdGhlIGZhY2lsaXRp
ZXMgcHJvdmlkZWQgYnkgdGhlIHVuZGVybHlpbmcgb3BlcmF0aW5nIHN5c3RlbS4KIFRoZSBtZWNo
YW5pc20gaXMgc2VsZWN0ZWQgYnkgdGhlCi0uRmwgYWhvCisuRmwgYQogZmxhZyBmcm9tIHRoZSBm
b2xsb3dpbmcgbGlzdCBvZiBjaG9pY2VzOgogLkJsIC10YWcgLXdpZHRoICJrZXJiZXJvczQiCiAu
SXQgTGkgZGNlCkluZGV4OiBzYXNsYXV0aGQvY29uZmlndXJlLmluCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZp
bGU6IC9jdnMvc3JjL3Nhc2wvc2FzbGF1dGhkL2NvbmZpZ3VyZS5pbix2CnJldHJpZXZpbmcgcmV2
aXNpb24gMS42MgpkaWZmIC11IC1yMS42MiBjb25maWd1cmUuaW4KLS0tIHNhc2xhdXRoZC9jb25m
aWd1cmUuaW4JMTkgQXByIDIwMDYgMjA6MjQ6MjIgLTAwMDAJMS42MgorKysgc2FzbGF1dGhkL2Nv
bmZpZ3VyZS5pbgkyMCBKYW4gMjAwOSAwMDozNDo1OSAtMDAwMApAQCAtNzcsNyArNzcsNyBAQAog
ICBBQ19ERUZJTkUoQVVUSF9TQVNMREIsW10sW0luY2x1ZGUgU0FTTGRiIFN1cHBvcnRdKQogICBT
QVNMX0RCX1BBVEhfQ0hFQ0soKQogICBTQVNMX0RCX0NIRUNLKCkKLSAgU0FTTF9EQl9MSUI9IiRT
QVNMX0RCX0xJQiAuLi9zYXNsZGIvLmxpYnMvbGlic2FzbGRiLmFsIgorICBTQVNMX0RCX0xJQj0i
JFNBU0xfREJfTElCIC4uL3Nhc2xkYi8ubGlicy9saWJzYXNsZGIubGEiCiBmaQogCiBBQ19BUkdf
RU5BQkxFKGh0dHBmb3JtLCBbICAtLWVuYWJsZS1odHRwZm9ybSAgICAgICBlbmFibGUgSFRUUCBm
b3JtIGF1dGhlbnRpY2F0aW9uIFtbbm9dXSBdLApAQCAtMTk1LDggKzE5NSw5IEBACiBkbmwgQ2hl
Y2tzIGZvciBsaWJyYXJ5IGZ1bmN0aW9ucy4KIEFDX1RZUEVfU0lHTkFMCiBBQ19DSEVDS19GVU5D
UyhnZXRob3N0bmFtZSBta2RpciBzb2NrZXQgc3RyZHVwKQorZG5sIE9ubHkgbG9vayBmb3Igb25l
IG9yIHRoZSBvdGhlcgogQUNfQ0hFQ0tfRlVOQ1MoZ2V0c3BuYW0gZ2V0dXNlcnB3LCBicmVhaykK
LUFDX0NIRUNLX0ZVTkNTKHN0cmxjYXQgc3RybGNweSkKK0FDX0NIRUNLX0ZVTkNTKGFzcHJpbnRm
IHN0cmxjYXQgc3RybGNweSkKIAogaWYgdGVzdCAkYWNfY3ZfZnVuY19nZXRzcG5hbSA9IHllczsg
dGhlbgogCUFDX01TR19DSEVDS0lORyhpZiBnZXRwd25hbV9yL2dldHNwbmFtX3IgdGFrZSA1IGFy
Z3VtZW50cykKSW5kZXg6IHNhc2xhdXRoZC9hdXRoX3NoYWRvdy5jCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZp
bGU6IC9jdnMvc3JjL3Nhc2wvc2FzbGF1dGhkL2F1dGhfc2hhZG93LmMsdgpyZXRyaWV2aW5nIHJl
dmlzaW9uIDEuOQpkaWZmIC11IC1yMS45IGF1dGhfc2hhZG93LmMKLS0tIHNhc2xhdXRoZC9hdXRo
X3NoYWRvdy5jCTQgSnVsIDIwMDYgMTA6Mzk6MDQgLTAwMDAJMS45CisrKyBzYXNsYXV0aGQvYXV0
aF9zaGFkb3cuYwkyMCBKYW4gMjAwOSAwMDozNDo1OSAtMDAwMApAQCAtNDQsNiArNDQsNyBAQAog
IyBpbmNsdWRlIDxzeXMvdHlwZXMuaD4KICMgaW5jbHVkZSA8dGltZS5oPgogIyBpbmNsdWRlIDxw
d2QuaD4KKyMgaW5jbHVkZSA8ZXJybm8uaD4KICMgaW5jbHVkZSA8c3lzbG9nLmg+CiAKICNpZmRl
ZiBIQVZFX0NSWVBUX0gKQEAgLTYwLDcgKzYxLDggQEAKICMgIGVuZGlmIC8qIFdJVEhfU1NMX0RF
UyAqLwogIyBlbmRpZiAvKiBXSVRIX0RFUyAqLwogCi0jZW5kaWYgLyogISBIQVZFX0dFVFNQTkFN
ICovCisjIGVuZGlmIC8qICEgSEFWRV9HRVRTUE5BTSAqLworCiAjIGlmZGVmIEhBVkVfR0VUVVNF
UlBXCiAjICBpbmNsdWRlIDx1c2VycHcuaD4KICMgIGluY2x1ZGUgPHVzZXJzZWMuaD4KQEAgLTEw
OSw2ICsxMTEsNyBAQAogICAgIGNoYXIgKmNwdzsJCQkJLyogcG9pbnRlciB0byBjcnlwdCgpIHJl
c3VsdCAqLwogICAgIHN0cnVjdCBwYXNzd2QJKnB3OwkJLyogcmV0dXJuIGZyb20gZ2V0cHduYW1f
cigpICovCiAgICAgc3RydWN0IHNwd2QgICAJKnNwOwkJLyogcmV0dXJuIGZyb20gZ2V0c3BuYW1f
cigpICovCisgICAgaW50IGVycm51bTsKICMgIGlmZGVmIF9SRUVOVFJBTlQKICAgICBzdHJ1Y3Qg
cGFzc3dkIHB3YnVmOwogICAgIGNoYXIgcHdkYXRhW1BXQlVGU1pdOwkJLyogcHdidWYgaW5kaXJl
Y3QgZGF0YSBnb2VzIGluIGhlcmUgKi8KQEAgLTEyMSwxMSArMTI0LDEwIEBACiAjICBkZWZpbmUg
UkVUVVJOKHgpIHJldHVybiBzdHJkdXAoeCkKIAogICAgIC8qCi0gICAgICogIk1hZ2ljIiBwYXNz
d29yZCBmaWVsZCBlbnRyaWVzIGZvciBTdW5PUy4KKyAgICAgKiAiTWFnaWMiIHBhc3N3b3JkIGZp
ZWxkIGVudHJpZXMgZm9yIFN1bk9TL1N5c1YKICAgICAgKgotICAgICAqICpMSyogaXMgaGludGVk
IGF0IGluIHRoZSBzaGFkb3coNCkgbWFuIHBhZ2UsIGJ1dCB0aGUKLSAgICAgKiBvbmx5IGRlZmlu
aXRpb24gZm9yIGl0ICh0aGF0IEkgY291bGQgZmluZCkgaXMgaW4gdGhlIHBhc3NtZ210KDFNKQot
ICAgICAqIG1hbiBwYWdlLgorICAgICAqICIqTEsqIiBpcyBkZWZpbmVkIGF0IGluIHRoZSBzaGFk
b3coNCkgbWFuIHBhZ2UsIGJ1dCBvZiBjb3Vyc2UgYW55IHN0cmluZworICAgICAqIGluc2VydGVk
IGluIGZyb250IG9mIHRoZSBwYXNzd29yZCB3aWxsIHByZXZlbnQgdGhlIHN0cmluZ3MgZnJvbSBt
YXRjaGluZwogICAgICAqCiAgICAgICogKk5QKiBpcyBkb2N1bWVudGVkIGluIGdldHNwbmFtKDMp
IGFuZCBpbmRpY2F0ZXMgdGhlIGNhbGxlciBoYWQKICAgICAgKiBpbnN1ZmZpY2llbnQgcGVybWlz
c2lvbiB0byByZWFkIHRoZSBzaGFkb3cgcGFzc3dvcmQgZGF0YWJhc2UKQEAgLTE0NCwxMiArMTQ2
LDI3IEBACiAjICBlbHNlCiAgICAgcHcgPSBnZXRwd25hbShsb2dpbik7CiAjICBlbmRpZiAvKiBf
UkVFTlRSQU5UICovCisgICAgZXJybnVtID0gZXJybm87CiAgICAgZW5kcHdlbnQoKTsKKwogICAg
IGlmIChwdyA9PSBOVUxMKSB7Ci0JaWYgKGZsYWdzICYgVkVSQk9TRSkgewotCSAgICBzeXNsb2co
TE9HX0RFQlVHLCAiREVCVUc6IGF1dGhfc2hhZG93OiBnZXRwd25hbSglcykgcmV0dXJuZWQgTlVM
TCIsIGxvZ2luKTsKKwlpZiAoZXJybnVtICE9IDApIHsKKwkgICAgY2hhciAqZXJyc3RyOworCisJ
ICAgIGlmIChmbGFncyAmIFZFUkJPU0UpIHsKKwkJc3lzbG9nKExPR19ERUJVRywgIkRFQlVHOiBh
dXRoX3NoYWRvdzogZ2V0cHduYW0oJXMpIGZhaWx1cmU6ICVtIiwgbG9naW4pOworCSAgICB9CisJ
ICAgIGlmIChhc3ByaW50ZigmZXJyc3RyLCAiTk8gVXNlcm5hbWUgbG9va3VwIGZhaWx1cmU6ICVz
Iiwgc3RyZXJyb3IoZXJybm8pKSA9PSAtMSkgeworCQkvKiBYWFggdGhlIGhpZGRlbiBzdHJkdXAo
KSB3aWxsIGxpa2VseSBmYWlsIGFuZCByZXR1cm4gTlVMTCBoZXJlLi4uLiAqLworCQlSRVRVUk4o
Ik5PIFVzZXJuYW1lIGxvb2t1cCBmYWlsdXJlOiB1bmtub3duIGVycm9yIChFTk9NRU0gZm9ybWF0
dGluZyBzdHJlcnJvcigpKSIpOworCSAgICB9CisJICAgIHJldHVybiBlcnJzdHI7CisJfSBlbHNl
IHsKKwkgICAgaWYgKGZsYWdzICYgVkVSQk9TRSkgeworCQlzeXNsb2coTE9HX0RFQlVHLCAiREVC
VUc6IGF1dGhfc2hhZG93OiBnZXRwd25hbSglcyk6IGludmFsaWQgdXNlcm5hbWUiLCBsb2dpbik7
CisJICAgIH0KKwkgICAgUkVUVVJOKCJOTyBJbnZhbGlkIHVzZXJuYW1lIik7CiAJfQotCVJFVFVS
TigiTk8iKTsKICAgICB9CiAKICAgICB0b2RheSA9IChsb25nKXRpbWUoTlVMTCkvKDI0TCo2MCo2
MCk7CkBAIC0xNjMsMTMgKzE4MCwyNyBAQAogIyAgZWxzZQogICAgIHNwID0gZ2V0c3BuYW0obG9n
aW4pOwogIyAgZW5kaWYgLyogX1JFRU5UUkFOVCAqLworICAgIGVycm51bSA9IGVycm5vOwogICAg
IGVuZHNwZW50KCk7CiAKICAgICBpZiAoc3AgPT0gTlVMTCkgewotCWlmIChmbGFncyAmIFZFUkJP
U0UpIHsKLQkgICAgc3lzbG9nKExPR19ERUJVRywgIkRFQlVHOiBhdXRoX3NoYWRvdzogZ2V0c3Bu
YW0oJXMpIHJldHVybmVkIE5VTEwiLCBsb2dpbik7CisJaWYgKGVycm51bSAhPSAwKSB7CisJICAg
IGNoYXIgKmVycnN0cjsKKworCSAgICBpZiAoZmxhZ3MgJiBWRVJCT1NFKSB7CisJCXN5c2xvZyhM
T0dfREVCVUcsICJERUJVRzogYXV0aF9zaGFkb3c6IGdldHNwbmFtKCVzKSBmYWlsdXJlOiAlbSIs
IGxvZ2luKTsKKwkgICAgfQorCSAgICBpZiAoYXNwcmludGYoJmVycnN0ciwgIk5PIFVzZXJuYW1l
IHNoYWRvdyBsb29rdXAgZmFpbHVyZTogJXMiLCBzdHJlcnJvcihlcnJubykpID09IC0xKSB7CisJ
CS8qIFhYWCB0aGUgaGlkZGVuIHN0cmR1cCgpIHdpbGwgbGlrZWx5IGZhaWwgYW5kIHJldHVybiBO
VUxMIGhlcmUuLi4uICovCisJCVJFVFVSTigiTk8gVXNlcm5hbWUgc2hhZG93IGxvb2t1cCBmYWls
dXJlOiB1bmtub3duIGVycm9yIChFTk9NRU0gZm9ybWF0dGluZyBzdHJlcnJvcigpKSIpOworCSAg
ICB9CisJICAgIHJldHVybiBlcnJzdHI7CisJfSBlbHNlIHsKKwkgICAgaWYgKGZsYWdzICYgVkVS
Qk9TRSkgeworCQlzeXNsb2coTE9HX0RFQlVHLCAiREVCVUc6IGF1dGhfc2hhZG93OiBnZXRzcG5h
bSglcyk6IGludmFsaWQgc2hhZG93IHVzZXJuYW1lIiwgbG9naW4pOworCSAgICB9CisJICAgIFJF
VFVSTigiTk8gSW52YWxpZCBzaGFkb3cgdXNlcm5hbWUiKTsKIAl9Ci0JUkVUVVJOKCJOTyIpOwog
ICAgIH0KIAogICAgIGlmICghc3RyY21wKHNwLT5zcF9wd2RwLCBTSEFET1dfUFdfRVBFUk0pKSB7
CkBAIC0xNzksMjAgKzIxMCwxOSBAQAogCVJFVFVSTigiTk8gSW5zdWZmaWNpZW50IHBlcm1pc3Np
b24gdG8gYWNjZXNzIE5JUyBhdXRoZW50aWNhdGlvbiBkYXRhYmFzZSAoc2FzbGF1dGhkKSIpOwog
ICAgIH0KIAotICAgIC8qCi0gICAgICogTm90ZTogbm8gY2hlY2sgZm9yIFNIQURPV19QV19MT0NL
RUQuIFJldHVybmluZyBhICJsb2NrZWQiIG5vdGlmaWNhdGlvbgotICAgICAqIHdvdWxkIGFsbG93
IGxvZ2luLWlkIG5hbWVzcGFjZSBwcm9iZXMsIGFuZCB2aW9sYXRlcyBvdXIgcG9saWN5IG9mCi0g
ICAgICogbm90IHJldHVybmluZyBhbnkgaW5mb3JtYXRpb24gYWJvdXQgYSBsb2dpbiB1bnRpbCB3
ZSBoYXZlIHZhbGlkYXRlZAotICAgICAqIHRoZSBwYXNzd29yZC4KLSAgICAgKi8KICAgICBjcHcg
PSBzdHJkdXAoKGNvbnN0IGNoYXIgKiljcnlwdChwYXNzd29yZCwgc3AtPnNwX3B3ZHApKTsKICAg
ICBpZiAoc3RyY21wKHNwLT5zcF9wd2RwLCBjcHcpKSB7CiAJaWYgKGZsYWdzICYgVkVSQk9TRSkg
eworCSAgICAvKgorCSAgICAgKiBUaGlzIF9zaG91bGRfIHJldmVhbCB0aGUgU0hBRE9XX1BXX0xP
Q0tFRCBwcmVmaXggdG8gYW4KKwkgICAgICogYWRtaW5pc3RyYXRvciB0cnlpbmcgdG8gZGVidWcg
dGhlIHNpdHVhdGlvbiwgdGhvdWdoIG1heWJlIHdlCisJICAgICAqIHNob3VsZCBkbyB0aGUgY2hl
Y2sgaGVyZSBhbmQgYmUgbGVzcyBvYnR1c2UgYWJvdXQgaXQuLi4uCisJICAgICAqLwogCSAgICBz
eXNsb2coTE9HX0RFQlVHLCAiREVCVUc6IGF1dGhfc2hhZG93OiBwdyBtaXNtYXRjaDogJyVzJyAh
PSAnJXMnIiwKIAkJICAgc3AtPnNwX3B3ZHAsIGNwdyk7CiAJfQogCWZyZWUoY3B3KTsKLQlSRVRV
Uk4oIk5PIik7CisJUkVUVVJOKCJOTyBJbmNvcnJlY3QgcGFzc3dvcmQiKTsKICAgICB9CiAgICAg
ZnJlZShjcHcpOwogCkBAIC0yNTAsMTAgKzI4MCwxMCBAQAogICAKICAgICBpZiAodXB3ID09IDAp
IHsKIAlpZiAoZmxhZ3MgJiBWRVJCT1NFKSB7Ci0JICAgIHN5c2xvZyhMT0dfREVCVUcsICJhdXRo
X3NoYWRvdzogZ2V0dXNlcnB3KCVzKSA9PSAwIiwKKwkgICAgc3lzbG9nKExPR19ERUJVRywgImF1
dGhfc2hhZG93OiBnZXR1c2VycHcoJXMpIGZhaWxlZDogJW0iLAogCQkgICBsb2dpbik7CiAJfQot
CVJFVFVSTigiTk8iKTsKKwlSRVRVUk4oIk5PIEludmFsaWQgdXNlcm5hbWUiKTsKICAgICB9CiAg
IAogICAgIGlmIChzdHJjbXAodXB3LT51cHdfcGFzc3dkLCBjcnlwdChwYXNzd29yZCwgdXB3LT51
cHdfcGFzc3dkKSkgIT0gMCkgewpAQCAtMjYxLDcgKzI5MSw3IEBACiAJICAgIHN5c2xvZyhMT0df
REVCVUcsICJhdXRoX3NoYWRvdzogcHcgbWlzbWF0Y2g6ICVzICE9ICVzIiwKIAkJICAgcGFzc3dv
cmQsIHVwdy0+dXB3X3Bhc3N3ZCk7CiAJfQotCVJFVFVSTigiTk8iKTsKKwlSRVRVUk4oIk5PIElu
Y29ycmVjdCBwYXNzd29yZCIpOwogICAgIH0KIAogICAgIFJFVFVSTigiT0siKTsKSW5kZXg6IHNh
c2xhdXRoZC9hdXRoX2dldHB3ZW50LmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc2Fz
bC9zYXNsYXV0aGQvYXV0aF9nZXRwd2VudC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjgKZGlm
ZiAtdSAtcjEuOCBhdXRoX2dldHB3ZW50LmMKLS0tIHNhc2xhdXRoZC9hdXRoX2dldHB3ZW50LmMJ
MTkgTWF5IDIwMDYgMTk6MzI6MjIgLTAwMDAJMS44CisrKyBzYXNsYXV0aGQvYXV0aF9nZXRwd2Vu
dC5jCTIwIEphbiAyMDA5IDAwOjM0OjU5IC0wMDAwCkBAIC00MCw2ICs0MCw4IEBACiAjaW5jbHVk
ZSA8dW5pc3RkLmg+CiAjaW5jbHVkZSA8c3RyaW5nLmg+CiAjaW5jbHVkZSA8cHdkLmg+CisjaW5j
bHVkZSA8ZXJybm8uaD4KKyNpbmNsdWRlIDxzeXNsb2cuaD4KIAogI2lmZGVmIEhBVkVfQ1JZUFRf
SAogI2luY2x1ZGUgPGNyeXB0Lmg+CkBAIC01Miw2ICs1NCw4IEBACiAjICAgaW5jbHVkZSA8ZGVz
Lmg+CiAjICBlbmRpZiAvKiBXSVRIX1NTTF9ERVMgKi8KICMgZW5kaWYgLyogV0lUSF9ERVMgKi8K
KworIyBpbmNsdWRlICJnbG9iYWxzLmgiCiAvKiBFTkQgUFVCTElDIERFUEVOREVOQ0lFUyAqLwog
CiAjZGVmaW5lIFJFVFVSTih4KSByZXR1cm4gc3RyZHVwKHgpCkBAIC03MCwxOSArNzQsNDQgQEAK
IHsKICAgICAvKiBWQVJJQUJMRVMgKi8KICAgICBzdHJ1Y3QgcGFzc3dkICpwdzsJCQkvKiBwb2lu
dGVyIHRvIHBhc3N3ZCBmaWxlIGVudHJ5ICovCisgICAgaW50IGVycm51bTsKICAgICAvKiBFTkQg
VkFSSUFCTEVTICovCiAgIAorICAgIGVycm5vID0gMDsKICAgICBwdyA9IGdldHB3bmFtKGxvZ2lu
KTsKKyAgICBlcnJudW0gPSBlcnJubzsKICAgICBlbmRwd2VudCgpOwogCiAgICAgaWYgKHB3ID09
IE5VTEwpIHsKLQlSRVRVUk4oIk5PIik7CisJaWYgKGVycm51bSAhPSAwKSB7CisJICAgIGNoYXIg
KmVycnN0cjsKKworCSAgICBpZiAoZmxhZ3MgJiBWRVJCT1NFKSB7CisJCXN5c2xvZyhMT0dfREVC
VUcsICJERUJVRzogYXV0aF9nZXRwd2VudDogZ2V0cHduYW0oJXMpIGZhaWx1cmU6ICVtIiwgbG9n
aW4pOworCSAgICB9CisJICAgIGlmIChhc3ByaW50ZigmZXJyc3RyLCAiTk8gVXNlcm5hbWUgbG9v
a3VwIGZhaWx1cmU6ICVzIiwgc3RyZXJyb3IoZXJybm8pKSA9PSAtMSkgeworCQkvKiBYWFggdGhl
IGhpZGRlbiBzdHJkdXAoKSB3aWxsIGxpa2VseSBmYWlsIGFuZCByZXR1cm4gTlVMTCBoZXJlLi4u
LiAqLworCQlSRVRVUk4oIk5PIFVzZXJuYW1lIGxvb2t1cCBmYWlsdXJlOiB1bmtub3duIGVycm9y
IChFTk9NRU0gZm9ybWF0dGluZyBzdHJlcnJvcigpKSIpOworCSAgICB9CisJICAgIHJldHVybiBl
cnJzdHI7CisJfSBlbHNlIHsKKwkgICAgaWYgKGZsYWdzICYgVkVSQk9TRSkgeworCQlzeXNsb2co
TE9HX0RFQlVHLCAiREVCVUc6IGF1dGhfZ2V0cHdlbnQ6IGdldHB3bmFtKCVzKTogaW52YWxpZCB1
c2VybmFtZSIsIGxvZ2luKTsKKwkgICAgfQorCSAgICBSRVRVUk4oIk5PIEludmFsaWQgdXNlcm5h
bWUiKTsKKwl9CiAgICAgfQogCiAgICAgaWYgKHN0cmNtcChwdy0+cHdfcGFzc3dkLCAoY29uc3Qg
Y2hhciAqKWNyeXB0KHBhc3N3b3JkLCBwdy0+cHdfcGFzc3dkKSkpIHsKLQlSRVRVUk4oIk5PIik7
CisJaWYgKGZsYWdzICYgVkVSQk9TRSkgeworCSAgICBzeXNsb2coTE9HX0RFQlVHLCAiREVCVUc6
IGF1dGhfZ2V0cHdlbnQ6ICVzOiBpbnZhbGlkIHBhc3N3b3JkIiwgbG9naW4pOworCX0KKwlSRVRV
Uk4oIk5PIEluY29ycmVjdCBwYXNzd29yZCIpOwogICAgIH0KIAorICAgIGlmIChmbGFncyAmIFZF
UkJPU0UpIHsKKwlzeXNsb2coTE9HX0RFQlVHLCAiREVCVUc6IGF1dGhfZ2V0cHdlbnQ6IE9LOiAl
cyIsIGxvZ2luKTsKKyAgICB9CiAgICAgUkVUVVJOKCJPSyIpOwogfQogCg==
</data>        

          </attachment>
      

    </bug>

</bugzilla>