<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>3223</bug_id>
          
          <creation_ts>2010-05-20 12:32 EDT</creation_ts>
          <short_desc>lmtpd can segfault with a slack overflow</short_desc>
          <delta_ts>2011-06-28 05:56:42 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>IMAP</component>
          <version>2.3.x</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>RESOLVED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          <priority>P5</priority>
          <bug_severity>bug</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Brian Awood">bawood@umich.edu</reporter>
          <assigned_to name="Bron Gondwana">brong@fastmail.fm</assigned_to>
          <cc>brong@fastmail.fm</cc>
    
    <cc>wes@umich.edu</cc>
          

      

      

      
          <long_desc isprivate="0">
            <who name="Brian Awood">bawood@umich.edu</who>
            <bug_when>2010-05-20 12:32:40 EDT</bug_when>
            <thetext>Created an attachment (id=1275)
patch to limit the mime boundaries processed

If lmptd attempts to deliver a message with large number of embedded mime boundaries if can overflow the stack.  We&apos;ve seen these types of messages generated by messages that were stuck in a bad bounce loop, but I suppose they could be crafted maliciously</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Bron Gondwana">brong@fastmail.fm</who>
            <bug_when>2011-05-11 02:07:24 EDT</bug_when>
            <thetext>This one looks good too - though I think the config name could do with some tweaking to be more clear - maybe max_mime_nesting_depth?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Brian Awood">bawood@umich.edu</who>
            <bug_when>2011-05-11 09:02:51 EDT</bug_when>
            <thetext>That is a clearer name.  I also wonder if the log message should be tweaked as well?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Bron Gondwana">brong@fastmail.fm</who>
            <bug_when>2011-06-28 05:56:42 EDT</bug_when>
            <thetext>Applied with some changes to the lib/imapoptions text.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1275</attachid>
            <date>2010-05-20 12:32 EDT</date>
            <desc>patch to limit the mime boundaries processed</desc>
            <filename>0001-Limit-the-multipart-mime-boundaries-that-are-parsed.patch</filename>
            <type>text/plain</type>
            <size>2647</size>
            <attacher>bawood@umich.edu</attacher>
            
              <data encoding="base64">RnJvbSAwYmJhYjQ2MmZiOTljYjBiMjUzNTUwMGYyMDQ1NzlmZWI1MGUwMGEyIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBCcmlhbiBBd29vZCA8YmF3b29kQHVtaWNoLmVkdT4KRGF0ZTog
TW9uLCA5IE5vdiAyMDA5IDE2OjUzOjQ0IC0wNTAwClN1YmplY3Q6IFtQQVRDSF0gTGltaXQgdGhl
IG11bHRpcGFydCBtaW1lIGJvdW5kYXJpZXMgdGhhdCBhcmUgcGFyc2VkCgpPY2Nhc2lvbmFseSwg
YWx0aG91Z2ggcmFyZWx5LCBhIG1lc3NhZ2UgKHVzdWFsbHkgYSBib3VuY2UKaW4gYSBsb29wKSB3
aWxsIGNvbWUgYWxvbmcgYW5kIGNhdXNlIGxtdHBkIHRvIG92ZXJmbG93IHRoZQpzdGFjayBhbmQg
Y3Jhc2guICBTaW5jZSBzZXZlcmFsIGZ1bmN0aW9ucyBpbiBtZXNzYWdlLmMKYXJlIHJlY3Vyc2l2
ZSwgdGhpcyBwYXRjaCBwcmV2ZW50cyByZWN1cnNpbmcgcGFzdCB0aGUKbGltaXQuICBJdCBzZXRz
IGEgZGVmYXVsdCBvZiAxMDAwLCB3aGljaCB3aWxsIGJlIG1vcmUKdGhhbiBlbm91Z2ggZm9yIGFu
eSBsZWdpdGltYXRlIG1haWwsIGluIHJlYWxpdHkgMTAwIG9yCmxlc3Mgc2hvdWxkIGJlIHBsZW50
eS4KLS0tCiBpbWFwL21lc3NhZ2UuYyAgfCAgICA5ICsrKysrKysrLQogbGliL2ltYXBvcHRpb25z
IHwgICAgNSArKysrKwogMiBmaWxlcyBjaGFuZ2VkLCAxMyBpbnNlcnRpb25zKCspLCAxIGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2ltYXAvbWVzc2FnZS5jIGIvaW1hcC9tZXNzYWdlLmMKaW5k
ZXggMzc0ZGY1Ni4uYTg2ZDEyOCAxMDA2NDQKLS0tIGEvaW1hcC9tZXNzYWdlLmMKKysrIGIvaW1h
cC9tZXNzYWdlLmMKQEAgLTE3MDQsNiArMTcwNCw3IEBAIHN0cnVjdCBib3VuZGFyeSAqYm91bmRh
cmllczsKICAgICBzdHJ1Y3QgcGFyYW0gKmJvdW5kYXJ5OwogICAgIGNoYXIgKmRlZmF1bHRDb250
ZW50VHlwZSA9IERFRkFVTFRfQ09OVEVOVF9UWVBFOwogICAgIGludCBpLCBkZXB0aDsKKyAgICBp
bnQgbGltaXQgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfQk9VTkRBUllfTElNSVQpOwogCiAgICAg
bWVtc2V0KCZwcmVhbWJsZSwgMCwgc2l6ZW9mKHN0cnVjdCBib2R5KSk7CiAgICAgbWVtc2V0KCZl
cGlsb2d1ZSwgMCwgc2l6ZW9mKHN0cnVjdCBib2R5KSk7CkBAIC0xNzM4LDcgKzE3MzksOCBAQCBz
dHJ1Y3QgYm91bmRhcnkgKmJvdW5kYXJpZXM7CiAgICAgbWVzc2FnZV9wYXJzZV9jb250ZW50KG1z
ZywgZm9ybWF0LCAmcHJlYW1ibGUsIGJvdW5kYXJpZXMpOwogCiAgICAgLyogUGFyc2UgdGhlIGNv
bXBvbmVudCBib2R5LXBhcnRzICovCi0gICAgd2hpbGUgKGJvdW5kYXJpZXMtPmNvdW50ID09IGRl
cHRoKSB7CisgICAgd2hpbGUgKGJvdW5kYXJpZXMtPmNvdW50ID09IGRlcHRoICYmCisJICAgIChs
aW1pdCA9PSAwID8gMSA6IGJvdW5kYXJpZXMtPmNvdW50IDwgbGltaXQpKSB7CiAJYm9keS0+c3Vi
cGFydCA9IChzdHJ1Y3QgYm9keSAqKXhyZWFsbG9jKChjaGFyICopYm9keS0+c3VicGFydCwKIAkJ
CQkgKGJvZHktPm51bXBhcnRzKzEpKnNpemVvZihzdHJ1Y3QgYm9keSkpOwogCW1lc3NhZ2VfcGFy
c2VfYm9keShtc2csIGZvcm1hdCwgJmJvZHktPnN1YnBhcnRbYm9keS0+bnVtcGFydHMrK10sCkBA
IC0xNzk5LDYgKzE4MDEsMTEgQEAgc3RydWN0IGJvdW5kYXJ5ICpib3VuZGFyaWVzOwogICAgICAq
LwogICAgIGJvZHktPmJvdW5kYXJ5X3NpemUgKz0gZXBpbG9ndWUuYm91bmRhcnlfc2l6ZTsKICAg
ICBib2R5LT5ib3VuZGFyeV9saW5lcyArPSBlcGlsb2d1ZS5ib3VuZGFyeV9saW5lczsKKworICAg
IC8qIGNoZWNrIGlmIHdlJ3ZlIGhpdCBhIGxpbWl0IGFuZCBmbGFnIGl0ICovCisgICAgaWYgKGxp
bWl0ICYmIGRlcHRoID09IGxpbWl0KSB7CisJc3lzbG9nKExPR19FUlIsICJFUlJPUjogbWltZSBi
b3VuZGFyeSBsaW1pdCAlaSBleGNlZWRlZCwgbm90IHBhcnNpbmcgYW55bW9yZSIsIGxpbWl0KTsK
KyAgICB9CiB9CiAKIC8qCmRpZmYgLS1naXQgYS9saWIvaW1hcG9wdGlvbnMgYi9saWIvaW1hcG9w
dGlvbnMKaW5kZXggMDQ2YjBlNi4uNWQ5MzgzMSAxMDA2NDQKLS0tIGEvbGliL2ltYXBvcHRpb25z
CisrKyBiL2xpYi9pbWFwb3B0aW9ucwpAQCAtMjMyLDYgKzIzMiwxMSBAQCBCbGFuayBsaW5lcyBh
bmQgbGluZXMgYmVnaW5uaW5nIHdpdGggYGAjJycgYXJlIGlnbm9yZWQuCiAvKiBNYXhpbXVtIG51
bWJlciBvZiB0cmFuc2FjdGlvbnMgdG8gYmUgc3VwcG9ydGVkIGluIHRoZSBiZXJrZWxleQogICAg
ZW52aXJvbm1lbnQuICovCiAKK3sgImJvdW5kYXJ5X2xpbWl0IiwgMTAwMCwgSU5UIH0KKy8qIG1l
c3NhZ2VfcGFyc2VfYm9keSBpcyBjYWxsZWQgcmVjdXJzaXZlbHkgZm9yIGVtYmVkZGVkIG11bHRp
LXBhcnQKKyAgIG1pbWUgbWVzc2FnZXMuICBNZXNzYWdlcyB3aXRoIGEgbGFyZ2UgbnVtYmVyIG9m
IGVtYmVkZGVkIG1pbWUKKyAgIGJvdW5kYXJpZXMgY2FuIGVuZCB1cCBjYXVzaW5nIHN0YWNrIG92
ZXJmbG93cy4gKi8KKwogeyAiY2xpZW50X3RpbWVvdXQiLCAxMCwgSU5UIH0KIC8qIE51bWJlciBv
ZiBzZWNvbmRzIHRvIHdhaXQgYmVmb3JlIHJldHVybmluZyBhIHRpbWVvdXQgZmFpbHVyZSB3aGVu
CiAgICBwZXJmb3JtaW5nIGEgY2xpZW50IGNvbm5lY3Rpb24gKGUuZy4sIGluIGEgbXVyZGVyIGVu
dmlyb25tZW50KSAqLwotLSAKMS43LjEKCg==
</data>        

          </attachment>
      

    </bug>

</bugzilla>