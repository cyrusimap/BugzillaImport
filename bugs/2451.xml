<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>2451</bug_id>
          
          <creation_ts>2004-06-23 16:28 EDT</creation_ts>
          <short_desc>sieve body: cache decoded body parts</short_desc>
          <delta_ts>2010-10-25 18:46:35 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>Sieve</component>
          <version>2.3.x</version>
          <rep_platform>Other</rep_platform>
          <op_sys>other</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          <priority>P2</priority>
          <bug_severity>bug</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ken Murchison">ken@oceana.com</reporter>
          <assigned_to name="Rob Siemborski">rjs3@andrew.cmu.edu</assigned_to>
          
          <qa_contact name="The Cyrus Bugzilla List">cyrus-bugzilla@lists.andrew.cmu.edu</qa_contact>

      

      

      
          <long_desc isprivate="0">
            <who name="Ken Murchison">ken@oceana.com</who>
            <bug_when>2004-06-23 16:28:48 EDT</bug_when>
            <thetext>We should cache decoded body parts in case we need them more than once.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">ken@oceana.com</who>
            <bug_when>2004-06-28 10:01:57 EDT</bug_when>
            <thetext>Created an attachment (id=288)
cache decoded body parts

Proposed (working) patch.  Anything wrong with this?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">ken@oceana.com</who>
            <bug_when>2004-06-28 14:45:20 EDT</bug_when>
            <thetext>Patch committed.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>288</attachid>
            <date>2004-06-28 10:01 EDT</date>
            <desc>cache decoded body parts</desc>
            <filename>sieve_body_cache.patch</filename>
            <type>text/plain</type>
            <size>9024</size>
            <attacher>ken@oceana.com</attacher>
            
              <data encoding="base64">SW5kZXg6IGltYXAvbWVzc2FnZS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5
c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvbWVzc2FnZS5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAx
Ljk3LjIuNApkaWZmIC11IC1yMS45Ny4yLjQgbWVzc2FnZS5jCi0tLSBpbWFwL21lc3NhZ2UuYwky
MyBKdW4gMjAwNCAyMDoxNToxNSAtMDAwMAkxLjk3LjIuNAorKysgaW1hcC9tZXNzYWdlLmMJMjUg
SnVuIDIwMDQgMTg6MjU6NTEgLTAwMDAKQEAgLTM3NCwxMiArMzc0LDE0IEBACiAgICAgcmV0dXJu
IDA7CiB9CiAKLXN0YXRpYyB2b2lkIG1lc3NhZ2VfZmluZF9wYXJ0KHN0cnVjdCBib2R5ICpib2R5
LCBjb25zdCBjaGFyICoqY29udGVudF90eXBlcywKK3N0YXRpYyB2b2lkIG1lc3NhZ2VfZmluZF9w
YXJ0KHN0cnVjdCBib2R5ICpib2R5LCBjb25zdCBjaGFyICpzZWN0aW9uLAorCQkJICAgICAgY29u
c3QgY2hhciAqKmNvbnRlbnRfdHlwZXMsCiAJCQkgICAgICBjb25zdCBjaGFyICptc2dfYmFzZSwg
dW5zaWduZWQgbG9uZyBtc2dfbGVuLAogCQkJICAgICAgc3RydWN0IGJvZHlwYXJ0ICoqKnBhcnRz
LCBpbnQgKm4pCiB7CiAgICAgaW50IG1hdGNoOwogICAgIGNvbnN0IGNoYXIgKip0eXBlOworICAg
IGNoYXIgbmV4dHNlY3Rpb25bMTI4XTsKIAogICAgIGZvciAobWF0Y2ggPSAwLCB0eXBlID0gY29u
dGVudF90eXBlczsgIW1hdGNoICYmICp0eXBlOyB0eXBlKyspIHsKIAljb25zdCBjaGFyICpzdWJ0
eXBlID0gc3RyY2hyKCp0eXBlLCAnLycpOwpAQCAtNDAyLDYgKzQwNCw3IEBACiAJLyogZ3JvdyB0
aGUgYXJyYXkgYW5kIGFkZCB0aGUgbmV3IHBhcnQgKi8KIAkqcGFydHMgPSB4cmVhbGxvYygqcGFy
dHMsICgqbisyKSpzaXplb2Yoc3RydWN0IGJvZHlwYXJ0ICopKTsKIAkoKnBhcnRzKVsqbl0gPSB4
bWFsbG9jKHNpemVvZihzdHJ1Y3QgYm9keXBhcnQpKTsKKwlzdHJsY3B5KCgqcGFydHMpWypuXS0+
c2VjdGlvbiwgc2VjdGlvbiwgc2l6ZW9mKCgqcGFydHMpWypuXS0+c2VjdGlvbikpOwogCSgqcGFy
dHMpWypuXS0+Y29udGVudCA9IG1zZ19iYXNlICsgYm9keS0+Y29udGVudF9vZmZzZXQ7CiAJKCpw
YXJ0cylbKm5dLT5lbmNvZGluZyA9IGJvZHktPmVuY29kaW5nOwogCSgqcGFydHMpWypuXS0+c2l6
ZSA9IGJvZHktPmNvbnRlbnRfc2l6ZTsKQEAgLTQxMSwxMyArNDE0LDE1IEBACiAJaW50IGk7CiAK
IAlmb3IgKGkgPSAwOyBpIDwgYm9keS0+bnVtcGFydHM7IGkrKykgewotCSAgICBtZXNzYWdlX2Zp
bmRfcGFydCgmYm9keS0+c3VicGFydFtpXSwgY29udGVudF90eXBlcywKKwkgICAgc25wcmludGYo
bmV4dHNlY3Rpb24sIHNpemVvZihuZXh0c2VjdGlvbiksICIlcy4lZCIsIHNlY3Rpb24sIGkrMSk7
CisJICAgIG1lc3NhZ2VfZmluZF9wYXJ0KCZib2R5LT5zdWJwYXJ0W2ldLCBuZXh0c2VjdGlvbiwg
Y29udGVudF90eXBlcywKIAkJCSAgICAgIG1zZ19iYXNlLCBtc2dfbGVuLCBwYXJ0cywgbik7CiAJ
fQogICAgIH0KICAgICBlbHNlIGlmICghc3RyY21wKGJvZHktPnR5cGUsICJNRVNTQUdFIikgJiYK
IAkgICAgICFzdHJjbXAoYm9keS0+c3VidHlwZSwgIlJGQzgyMiIpKSB7Ci0JbWVzc2FnZV9maW5k
X3BhcnQoYm9keS0+c3VicGFydCwgY29udGVudF90eXBlcywKKwlzbnByaW50ZihuZXh0c2VjdGlv
biwgc2l6ZW9mKG5leHRzZWN0aW9uKSwgIiVzLjEiLCBzZWN0aW9uKTsKKwltZXNzYWdlX2ZpbmRf
cGFydChib2R5LT5zdWJwYXJ0LCBuZXh0c2VjdGlvbiwgY29udGVudF90eXBlcywKIAkJCSAgbXNn
X2Jhc2UsIG1zZ19sZW4sIHBhcnRzLCBuKTsKICAgICB9CiB9CkBAIC00MzUsNyArNDQwLDggQEAK
ICAgICBpbnQgbiA9IDA7ICAvKiBydW5uaW5nIGNvdW50IG9mIHRoZSBudW1iZXIgb2YgbWF0Y2hp
bmcgcGFydHMgKi8KIAogICAgICpwYXJ0cyA9IE5VTEw7Ci0gICAgbWVzc2FnZV9maW5kX3BhcnQo
bXNnLT5ib2R5LCBjb250ZW50X3R5cGVzLCBtc2ctPmJhc2UsIG1zZy0+bGVuLCBwYXJ0cywgJm4p
OworICAgIG1lc3NhZ2VfZmluZF9wYXJ0KG1zZy0+Ym9keSwgIjEiLCBjb250ZW50X3R5cGVzLAor
CQkgICAgICBtc2ctPmJhc2UsIG1zZy0+bGVuLCBwYXJ0cywgJm4pOwogfQogCiAvKgpJbmRleDog
aW1hcC9tZXNzYWdlLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2
cy9zcmMvY3lydXMvaW1hcC9tZXNzYWdlLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNi40LjMK
ZGlmZiAtdSAtcjEuNi40LjMgbWVzc2FnZS5oCi0tLSBpbWFwL21lc3NhZ2UuaAkyMyBKdW4gMjAw
NCAyMDoxNToxNiAtMDAwMAkxLjYuNC4zCisrKyBpbWFwL21lc3NhZ2UuaAkyNSBKdW4gMjAwNCAx
ODoyNTo1MSAtMDAwMApAQCAtNzcsNiArNzcsNyBAQAogfTsKIAogc3RydWN0IGJvZHlwYXJ0IHsK
KyAgICBjaGFyIHNlY3Rpb25bMTI4XTsKICAgICBjb25zdCBjaGFyICpjb250ZW50OwogICAgIGNv
bnN0IGNoYXIgKmVuY29kaW5nOwogICAgIHVuc2lnbmVkIGxvbmcgc2l6ZTsKSW5kZXg6IHNpZXZl
L2JjX2V2YWwuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3Ny
Yy9zaWV2ZS9iY19ldmFsLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMi4yLjMKZGlmZiAtdSAt
cjEuMi4yLjMgYmNfZXZhbC5jCi0tLSBzaWV2ZS9iY19ldmFsLmMJMjUgSnVuIDIwMDQgMTU6MDg6
MDcgLTAwMDAJMS4yLjIuMworKysgc2lldmUvYmNfZXZhbC5jCTI1IEp1biAyMDA0IDE4OjI1OjUz
IC0wMDAwCkBAIC0zNSw2ICszNSw3IEBACiAjaW5jbHVkZSAiYnl0ZWNvZGUuaCIKIAogI2luY2x1
ZGUgImNoYXJzZXQuaCIKKyNpbmNsdWRlICJoYXNoLmgiCiAjaW5jbHVkZSAieG1hbGxvYy5oIgog
CiAjaW5jbHVkZSA8c3RyaW5nLmg+CkBAIC0yOTEsNyArMjkyLDggQEAKIH0KIAogLyogRXZhbHVh
dGUgYSBieXRlY29kZSB0ZXN0ICovCi1pbnQgZXZhbF9iY190ZXN0KHNpZXZlX2ludGVycF90ICpp
bnRlcnAsIHZvaWQqIG0sCitpbnQgZXZhbF9iY190ZXN0KHNpZXZlX2ludGVycF90ICppbnRlcnAs
CisJCSBzdHJ1Y3QgaGFzaF90YWJsZSAqYm9keV9jYWNoZSwgdm9pZCogbSwKIAkJIGJ5dGVjb2Rl
X2lucHV0X3QgKiBiYywgaW50ICogaXApCiB7CiAgICAgaW50IHJlcz0wOyAKQEAgLTMxNCw3ICsz
MTYsNyBAQAogCiAgICAgY2FzZSBCQ19OT1Q6LyoyKi8KIAlpKz0xOwotCXJlcyA9IGV2YWxfYmNf
dGVzdChpbnRlcnAsbSwgYmMsICZpKTsKKwlyZXMgPSBldmFsX2JjX3Rlc3QoaW50ZXJwLCBib2R5
X2NhY2hlLCBtLCBiYywgJmkpOwogCWlmKHJlcyA+PSAwKSByZXMgPSAhcmVzOyAvKiBPbmx5IGlu
dmVydCBpbiBub24tZXJyb3IgY2FzZSAqLwogCWJyZWFrOwogCkBAIC0zNzMsNyArMzc1LDcgQEAK
IAkgKiBpbiB0aGUgcmlnaHQgcGxhY2UgKi8KIAlmb3IgKHg9MDsgeDxsaXN0X2xlbiAmJiAhcmVz
OyB4KyspIHsgCiAJICAgIGludCB0bXA7Ci0JICAgIHRtcCA9IGV2YWxfYmNfdGVzdChpbnRlcnAs
bSxiYywmaSk7CisJICAgIHRtcCA9IGV2YWxfYmNfdGVzdChpbnRlcnAsYm9keV9jYWNoZSxtLGJj
LCZpKTsKIAkgICAgaWYodG1wIDwgMCkgewogCQlyZXMgPSB0bXA7CiAJCWJyZWFrOwpAQCAtMzkz
LDcgKzM5NSw3IEBACiAJLyogcmV0dXJuIDEgdW5sZXNzIHlvdSBmaW5kIG9uZSB0aGF0IGlzbid0
IHRydWUsIHRoZW4gcmV0dXJuIDAgKi8KIAlmb3IgKHg9MDsgeDxsaXN0X2xlbiAmJiByZXM7IHgr
KykgewogCSAgICBpbnQgdG1wOwotCSAgICB0bXAgPSBldmFsX2JjX3Rlc3QoaW50ZXJwLG0sYmMs
JmkpOworCSAgICB0bXAgPSBldmFsX2JjX3Rlc3QoaW50ZXJwLGJvZHlfY2FjaGUsbSxiYywmaSk7
CiAJICAgIGlmKHRtcCA8IDApIHsKIAkJcmVzID0gdG1wOwogCQlicmVhazsKQEAgLTcwNCw4ICs3
MDYsNiBAQAogICAgIHsKIAlzaWV2ZV9ib2R5cGFydF90ICoqIHZhbDsKIAljb25zdCBjaGFyICoq
Y29udGVudF90eXBlcyA9IE5VTEw7Ci0JY2hhciAqZGVjYnVmID0gTlVMTDsKLQlpbnQgYWxsb2Nl
ZCA9IDA7CiAKIAlpbnQgdHlwZXNpPWkrNjsvKiB0aGUgaSB2YWx1ZSBmb3IgdGhlIGJlZ2luaW5n
IG9mIHRoZSBjb250ZW50LXR5cGVzICovCiAgCWludCBkYXRhaT0obnRvaGwoYmNbdHlwZXNpKzFd
LnZhbHVlKS80KTsKQEAgLTc2MiwxNCArNzYyLDEwIEBACiAJICAgIGlmIChtYXRjaCA9PSBCX0NP
VU5UKSB7CiAJCWNvdW50Kys7CiAJICAgIH0gZWxzZSB7Ci0JCWNvbnN0IGNoYXIgKmNvbnRlbnQ7
Ci0JCWludCBzaXplOworCQljb25zdCBjaGFyICpjb250ZW50ID0gdmFsW3ldLT5jb250ZW50Owor
CQlpbnQgc2l6ZSA9IHZhbFt5XS0+c2l6ZTsKIAotCQlpZiAodHJhbnNmb3JtID09IEJfUkFXKSB7
Ci0JCSAgICBjb250ZW50ID0gdmFsW3ldLT5jb250ZW50OwotCQkgICAgc2l6ZSA9IHZhbFt5XS0+
c2l6ZTsKLQkJfQotCQllbHNlIHsKKwkJaWYgKHRyYW5zZm9ybSAhPSBCX1JBVykgewogCQkgICAg
aW50IGVuY29kaW5nOwogCiAJCSAgICAvKiBYWFggY3VycmVudGx5IHVua25vd24gZW5jb2Rpbmdz
IGFyZSBwcm9jZXNzZWQgYXMgcmF3ICovCkBAIC03ODIsMTIgKzc3OCwyMiBAQAogCQkgICAgZWxz
ZQogCQkJZW5jb2RpbmcgPSBFTkNPRElOR19OT05FOwogCi0JCSAgICBjb250ZW50ID0gY2hhcnNl
dF9kZWNvZGVfbWltZWJvZHkodmFsW3ldLT5jb250ZW50LAotCQkJCQkJICAgICAgdmFsW3ldLT5z
aXplLCBlbmNvZGluZywKLQkJCQkJCSAgICAgICZkZWNidWYsIGFsbG9jZWQsICZzaXplKTsKLQkJ
ICAgIGlmIChjb250ZW50ICE9IHZhbFt5XS0+Y29udGVudCAmJiB2YWxbeV0tPnNpemUgPiBhbGxv
Y2VkKSB7Ci0JCQkvKiAocmUpYWxsb2NlZCBkZWNidWYsIHNvIGFkanVzdCBhbGxvY2VkICovCi0J
CQlhbGxvY2VkID0gdmFsW3ldLT5zaXplOworCQkgICAgaWYgKGVuY29kaW5nICE9IEVOQ09ESU5H
X05PTkUpIHsKKwkJCWNvbnRlbnQgPSBoYXNoX2xvb2t1cCh2YWxbeV0tPnNlY3Rpb24sIGJvZHlf
Y2FjaGUpOworCQkJaWYgKGNvbnRlbnQpIHsKKwkJCSAgICAvKiBhbHJlYWR5IGRlY29kZWQgdGhp
cyBwYXJ0ICovCisJCQkgICAgc2l6ZSA9IHN0cmxlbihjb250ZW50KTsKKwkJCX0KKwkJCWVsc2Ug
eworCQkJICAgIC8qIGRlY29kZSB0aGlzIHBhcnQgYW5kIGFkZCBpdCB0byB0aGUgY2FjaGUgKi8K
KwkJCSAgICBjaGFyICpkZWNidWYgPSBOVUxMOworCQkJICAgIGNvbnRlbnQgPSBjaGFyc2V0X2Rl
Y29kZV9taW1lYm9keSh2YWxbeV0tPmNvbnRlbnQsCisJCQkJCQkJICAgICAgdmFsW3ldLT5zaXpl
LAorCQkJCQkJCSAgICAgIGVuY29kaW5nLCAmZGVjYnVmLAorCQkJCQkJCSAgICAgIDAsICZzaXpl
KTsKKwkJCSAgICBoYXNoX2luc2VydCh2YWxbeV0tPnNlY3Rpb24sICh2b2lkICopIGNvbnRlbnQs
CisJCQkJCWJvZHlfY2FjaGUpOworCQkJfQogCQkgICAgfQogCiAJCSAgICBpZiAodHJhbnNmb3Jt
ID09IEJfQklOQVJZKSB7CkBAIC04MzQsOSArODQwLDYgQEAKIAkvKiBmcmVlIHRoZSBib2R5cGFy
dCBhcnJheSAqLwogCWlmICh2YWwpIGZyZWUodmFsKTsKIAotCS8qIGZyZWUgdGhlIGRlY29kZSBi
dWZmZXIgKi8KLQlpZiAoZGVjYnVmKSBmcmVlKGRlY2J1Zik7Ci0gICAgIAogCWlmICAobWF0Y2gg
PT0gQl9DT1VOVCkKIAl7CiAJICAgIHNwcmludGYoc2NvdW50LCAiJXUiLCBjb3VudCk7CkBAIC04
NzQsMTAgKzg3Nyw5IEBACiAKIC8qIFRoZSBlbnRyeXBvaW50IGZvciBieXRlY29kZSBldmFsdWF0
aW9uICovCiBpbnQgc2lldmVfZXZhbF9iYyhzaWV2ZV9pbnRlcnBfdCAqaSwgY29uc3Qgdm9pZCAq
YmNfaW4sIHVuc2lnbmVkIGludCBiY19sZW4sCi0JCSAgdm9pZCAqbSwgc2lldmVfaW1hcGZsYWdz
X3QgKiBpbWFwZmxhZ3MsCi0JCSAgYWN0aW9uX2xpc3RfdCAqYWN0aW9ucywKLQkJICBub3RpZnlf
bGlzdF90ICpub3RpZnlfbGlzdCwKLQkJICBjb25zdCBjaGFyICoqZXJybXNnKSAKKwkJICBzdHJ1
Y3QgaGFzaF90YWJsZSAqYm9keV9jYWNoZSwgdm9pZCAqbSwKKwkJICBzaWV2ZV9pbWFwZmxhZ3Nf
dCAqIGltYXBmbGFncywgYWN0aW9uX2xpc3RfdCAqYWN0aW9ucywKKwkJICBub3RpZnlfbGlzdF90
ICpub3RpZnlfbGlzdCwgY29uc3QgY2hhciAqKmVycm1zZykgCiB7CiAgICAgY29uc3QgY2hhciAq
ZGF0YTsKICAgICB1bnNpZ25lZCBpbnQgaXAgPSAwLCBpcF9tYXggPSAoYmNfbGVuL3NpemVvZihi
eXRlY29kZV9pbnB1dF90KSk7CkBAIC05ODgsNyArOTkwLDcgQEAKIAkgICAgaW50IHJlc3VsdDsK
IAkgICAKIAkgICAgaXArPTI7Ci0JICAgIHJlc3VsdD1ldmFsX2JjX3Rlc3QoaSwgbSwgYmMsICZp
cCk7CisJICAgIHJlc3VsdD1ldmFsX2JjX3Rlc3QoaSwgYm9keV9jYWNoZSwgbSwgYmMsICZpcCk7
CiAJICAgIAogCSAgICBpZiAocmVzdWx0PDApIHsKIAkJKmVycm1zZyA9ICJJbnZhbGlkIHRlc3Qi
OwpJbmRleDogc2lldmUvc2NyaXB0LmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcv
c3lzdGVtL2N2cy9zcmMvc2lldmUvc2NyaXB0LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNTku
Mi40CmRpZmYgLXUgLXIxLjU5LjIuNCBzY3JpcHQuYwotLS0gc2lldmUvc2NyaXB0LmMJMjMgSnVu
IDIwMDQgMjA6MTU6MTggLTAwMDAJMS41OS4yLjQKKysrIHNpZXZlL3NjcmlwdC5jCTI1IEp1biAy
MDA0IDE4OjI1OjUzIC0wMDAwCkBAIC0zOCw2ICszOCw3IEBACiAjaW5jbHVkZSA8dW5pc3RkLmg+
CiAjaW5jbHVkZSA8YXNzZXJ0Lmg+CiAKKyNpbmNsdWRlICJoYXNoLmgiCiAjaW5jbHVkZSAieG1h
bGxvYy5oIgogCiAjaW5jbHVkZSAibWQ1Z2xvYmFsLmgiCkBAIC04MTEsMTAgKzgxMiw5IEBACiAK
IC8qIGV4ZWN1dGUgc29tZSBieXRlY29kZSAqLwogaW50IHNpZXZlX2V2YWxfYmMoc2lldmVfaW50
ZXJwX3QgKmksIGNvbnN0IHZvaWQgKmJjX2luLCB1bnNpZ25lZCBpbnQgYmNfbGVuLAotCQkgIHZv
aWQgKm0sIHNpZXZlX2ltYXBmbGFnc190ICogaW1hcGZsYWdzLAotCQkgIGFjdGlvbl9saXN0X3Qg
KmFjdGlvbnMsCi0JCSAgbm90aWZ5X2xpc3RfdCAqbm90aWZ5X2xpc3QsCi0JCSAgY29uc3QgY2hh
ciAqKmVycm1zZyk7CisJCSAgc3RydWN0IGhhc2hfdGFibGUgKmJvZHlfY2FjaGUsIHZvaWQgKm0s
CisJCSAgc2lldmVfaW1hcGZsYWdzX3QgKiBpbWFwZmxhZ3MsIGFjdGlvbl9saXN0X3QgKmFjdGlv
bnMsCisJCSAgbm90aWZ5X2xpc3RfdCAqbm90aWZ5X2xpc3QsIGNvbnN0IGNoYXIgKiplcnJtc2cp
OwogCiBpbnQgc2lldmVfZXhlY3V0ZV9ieXRlY29kZShzaWV2ZV9ieXRlY29kZV90ICpiYywgc2ll
dmVfaW50ZXJwX3QgKmludGVycCwKIAkJCSAgIHZvaWQgKnNjcmlwdF9jb250ZXh0LCB2b2lkICpt
ZXNzYWdlX2NvbnRleHQpIApAQCAtODI3LDYgKzgyNyw3IEBACiAgICAgY2hhciBhY3Rpb25zX3N0
cmluZ1tBQ1RJT05TX1NUUklOR19MRU5dID0gIiI7CiAgICAgY29uc3QgY2hhciAqZXJybXNnID0g
TlVMTDsKICAgICBzaWV2ZV9pbWFwZmxhZ3NfdCBpbWFwZmxhZ3M7CisgICAgc3RydWN0IGhhc2hf
dGFibGUgYm9keV9jYWNoZTsKICAgICAKICAgICBpZiAoIWludGVycCkgcmV0dXJuIFNJRVZFX0ZB
SUw7CiAKQEAgLTg1NSw5ICs4NTYsMTcgQEAKIAkJCSAgICAgIGFjdGlvbnMsIG5vdGlmeV9saXN0
LCBsYXN0YWN0aW9uLCAwLAogCQkJICAgICAgYWN0aW9uc19zdHJpbmcsIGVycm1zZyk7CiAgICAg
fQorCisgICAgLyogYnVpbGQgYSBoYXNoIHRhYmxlIHRvIGNhY2hlIGRlY29kZWQgYm9keSBwYXJ0
cyAqLworICAgIGNvbnN0cnVjdF9oYXNoX3RhYmxlKCZib2R5X2NhY2hlLCAxMCwgMSk7CiAgICAg
Ci0gICAgaWYgKHNpZXZlX2V2YWxfYmMoaW50ZXJwLCBiYy0+ZGF0YSwgYmMtPmxlbiwgbWVzc2Fn
ZV9jb250ZXh0LCAKLQkJICAgICAgJmltYXBmbGFncywgYWN0aW9ucywgbm90aWZ5X2xpc3QsICZl
cnJtc2cpIDwgMCkKKyAgICByZXQgPSBzaWV2ZV9ldmFsX2JjKGludGVycCwgYmMtPmRhdGEsIGJj
LT5sZW4sCisJCQkmYm9keV9jYWNoZSwgbWVzc2FnZV9jb250ZXh0LAorCQkJJmltYXBmbGFncywg
YWN0aW9ucywgbm90aWZ5X2xpc3QsICZlcnJtc2cpOworCisgICAgZnJlZV9oYXNoX3RhYmxlKCZi
b2R5X2NhY2hlLCBmcmVlKTsKKworICAgIGlmIChyZXQgPCAwKQogICAgIHsKIAlyZXQgPSBTSUVW
RV9SVU5fRVJST1I7CiAJcmV0dXJuIGRvX3NpZXZlX2Vycm9yKHJldCwgaW50ZXJwLCBzY3JpcHRf
Y29udGV4dCwKSW5kZXg6IHNpZXZlL3NpZXZlX2ludGVyZmFjZS5oCj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZp
bGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL3NpZXZlX2ludGVyZmFjZS5oLHYK
cmV0cmlldmluZyByZXZpc2lvbiAxLjE5LjIuMgpkaWZmIC11IC1yMS4xOS4yLjIgc2lldmVfaW50
ZXJmYWNlLmgKLS0tIHNpZXZlL3NpZXZlX2ludGVyZmFjZS5oCTIzIEp1biAyMDA0IDIwOjE1OjE5
IC0wMDAwCTEuMTkuMi4yCisrKyBzaWV2ZS9zaWV2ZV9pbnRlcmZhY2UuaAkyNSBKdW4gMjAwNCAx
ODoyNTo1MyAtMDAwMApAQCAtNTMsNyArNTMsOSBAQAogCQkJICAgICAgIGNvbnN0IGNoYXIgKmZp
ZWxkLAogCQkJICAgICAgIGNvbnN0IGNoYXIgKioqY29udGVudHMpOwogCisvKiBNVVNUIGtlZXAg
dGhpcyBzdHJ1Y3Qgc3luYydkIHdpdGggYm9keXBhcnQgaW4gaW1hcC9tZXNzYWdlLmggKi8KIHR5
cGVkZWYgc3RydWN0IHNpZXZlX2JvZHlwYXJ0IHsKKyAgICBjaGFyIHNlY3Rpb25bMTI4XTsKICAg
ICBjb25zdCBjaGFyICpjb250ZW50OwogICAgIGNvbnN0IGNoYXIgKmVuY29kaW5nOwogICAgIHVu
c2lnbmVkIGxvbmcgc2l6ZTsK
</data>        

          </attachment>
      

    </bug>

</bugzilla>