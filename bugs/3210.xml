<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>3210</bug_id>
          
          <creation_ts>2010-05-02 00:34 EDT</creation_ts>
          <short_desc>Password Modify ExOp support for ldapdb</short_desc>
          <delta_ts>2010-05-02 00:34:35 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus SASL</product>
          <component>plugins</component>
          <version>2.1.x</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>NEW</bug_status>
          
          
          
          
          
          <priority>P5</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dan White">dwhite@olp.net</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          
          

      

      

      
          <long_desc isprivate="0">
            <who name="Dan White">dwhite@olp.net</who>
            <bug_when>2010-05-02 00:34:35 EDT</bug_when>
            <thetext>Created an attachment (id=1265)
New feature for password modify exop support for ldapdb

Attached is a patch which adds Password Modify ExOp (RFC3062) support for the ldapdb_auprop_store function.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1265</attachid>
            <date>2010-05-02 00:34 EDT</date>
            <desc>New feature for password modify exop support for ldapdb</desc>
            <filename>ldapdb-exop.diff</filename>
            <type>text/plain</type>
            <size>5267</size>
            <attacher>dwhite@olp.net</attacher>
            
              <data encoding="base64">ZGlmZiAtcnVOIGN5cnVzLXNhc2wtMi4xLjI0LnByZXBhdGNoZWQvZG9jL29wdGlvbnMuaHRtbCBj
eXJ1cy1zYXNsLTIuMS4yNC9kb2Mvb3B0aW9ucy5odG1sCi0tLSBjeXJ1cy1zYXNsLTIuMS4yNC5w
cmVwYXRjaGVkL2RvYy9vcHRpb25zLmh0bWwJMjAwOS0wNS0wNyAxNToyMToxNC4wMDAwMDAwMDAg
KzAwMDAKKysrIGN5cnVzLXNhc2wtMi4xLjI0L2RvYy9vcHRpb25zLmh0bWwJMjAxMC0wNS0wMiAw
Mzo1NDoxNC4wMDAwMDAwMDAgKzAwMDAKQEAgLTkxLDYgKzkxLDE0IEBACiA8VEQ+bm9uZTwvVEQ+
CiA8L1RSPgogPFRSPgorPFREPmxkYXBkYl9wYXNzd29yZF9tZXRob2Q8L1REPjxURD5MREFQREIg
cGx1Z2luPC9URD4KKzxURD5TcGVjaWZpZXMgdGhlIG1ldGhvZCB1c2VkIHdoZW4gbGRhcGRiIGlz
IHRhc2tlZCB3aXRoIHN0b3JpbmcgdGhlCit1c2VyUGFzc3dvcmQgYXR0cmlidXRlLiAgSWYgJ2V4
b3AnIGlzIHNwZWNpZmllZCwgdGhlIHZhbHVlIHdpbGwgYmUgc3RvcmVkIHVzaW5nCithbiBMREFQ
IFBhc3N3b3JkIE1vZGlmeSBFeHRlbmRlZCBPcGVyYXRpb24uIGlmICdjbGVhcicgaXMgc3BlY2lm
aWVkLCB3aGljaCBpcwordGhlIGRlZmF1bHQsIHRoZSB2YWx1ZSB3aWxsIGJlIHdyaXR0ZW4gYXMg
cGFzc2VkIHRvIGxkYXBkYi48L1REPgorPFREPmNsZWFyPC9URD4KKzwvVFI+Cis8VFI+CiA8VEQ+
bG9nX2xldmVsPC9URD48VEQ+U0FTTCBMaWJyYXJ5PC9URD4KIDxURD48Yj5OdW1lcmljPC9iPiBM
b2dnaW5nIExldmVsIChzZWUgPFRUPlNBU0xfTE9HXyo8L1RUPiBpbiA8dHQ+c2FzbC5oPC90dD4K
IGZvciB2YWx1ZXMgYW5kIGRlc2NyaXB0aW9uczwvVEQ+CmRpZmYgLXJ1TiBjeXJ1cy1zYXNsLTIu
MS4yNC5wcmVwYXRjaGVkL3BsdWdpbnMvbGRhcGRiLmMgY3lydXMtc2FzbC0yLjEuMjQvcGx1Z2lu
cy9sZGFwZGIuYwotLS0gY3lydXMtc2FzbC0yLjEuMjQucHJlcGF0Y2hlZC9wbHVnaW5zL2xkYXBk
Yi5jCTIwMTAtMDUtMDIgMDM6NDU6MDEuMDAwMDAwMDAwICswMDAwCisrKyBjeXJ1cy1zYXNsLTIu
MS4yNC9wbHVnaW5zL2xkYXBkYi5jCTIwMTAtMDUtMDIgMDQ6MDU6NTMuMDAwMDAwMDAwICswMDAw
CkBAIC0xLDYgKzEsNyBAQAogLyogJE9wZW5MREFQOiBwa2cvbGRhcC9jb250cmliL2xkYXBzYXNs
L2xkYXBkYi5jLHYgMS4xLjIuNyAyMDAzLzExLzI5IDIyOjEwOjAzIGh5YyBFeHAgJCAqLwogLyog
U0FTTCBMREFQIGF1eHByb3ArY2Fub251c2VyIGltcGxlbWVudGF0aW9uCiAgKiBDb3B5cmlnaHQg
KEMpIDIwMDItMjAwNyBIb3dhcmQgQ2h1LCBBbGwgcmlnaHRzIHJlc2VydmVkLiA8aHljQHN5bWFz
LmNvbT4KKyAqIFBhc3N3b3JkIE1vZGlmeSBFeE9wIChSRkMzMDYyKSBzdXBwb3J0IGFkZGVkIGJ5
IERhbiBXaGl0ZSA8ZHdoaXRlQG9scC5uZXQ+CiAgKgogICogUmVkaXN0cmlidXRpb24gYW5kIHVz
ZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0CiAgKiBtb2RpZmlj
YXRpb24sIGFyZSBwZXJtaXR0ZWQgb25seSBhcyBhdXRob3JpemVkIGJ5IHRoZSBPcGVuTERBUApA
QCAtMjQsNiArMjUsOSBAQAogCiAjaW5jbHVkZSA8bGRhcC5oPgogCisjZGVmaW5lIFBBU1NXT1JE
X0NMRUFSCQkwCisjZGVmaW5lIFBBU1NXT1JEX0VYT1AJCTEKKwogc3RhdGljIGNoYXIgbGRhcGRi
W10gPSAibGRhcGRiIjsKIAogdHlwZWRlZiBzdHJ1Y3QgbGRhcGN0eCB7CkBAIC0zNCw2ICszOCw3
IEBACiAJc3RydWN0IGJlcnZhbCBtZWNoOwkvKiBTQVNMIG1lY2ggKi8KIAlpbnQgdXNlX3RsczsJ
CS8qIElzc3VlIFN0YXJ0VExTIHJlcXVlc3Q/ICovCiAJc3RydWN0IGJlcnZhbCBjYW5vbjsJLyog
VXNlIGF0dHIgaW4gdXNlciBlbnRyeSBmb3IgY2Fub25pY2FsIG5hbWUgKi8KKwlpbnQgcGFzc3dv
cmRfbWV0aG9kOwkvKiBNZXRob2QgdG8gdXNlIHdoZW4gc3RvcmluZyB1c2VyUGFzc3dvcmQgKi8K
IH0gbGRhcGN0eDsKIAogc3RhdGljIGxkYXBjdHggbGRhcGRiX2N0eDsKQEAgLTI3Niw3ICsyODEs
MTAgQEAKICAgICBsZGFwY3R4ICpjdHggPSBnbG9iX2NvbnRleHQ7CiAgICAgY29ubnBhcm0gY3A7
CiAgICAgY29uc3Qgc3RydWN0IHByb3B2YWwgKnByOwotICAgIGludCBpLCBuOworICAgIGludCBp
LCBqLCBuOworICAgIGludCByZXQ7CisgICAgaW50IHBhc3N3b3JkX2luZGV4OworICAgIHN0cnVj
dCBiZXJ2YWwgbG5ld3B3LCBsbmV3cGFzc3dvcmQ7CiAgICAgTERBUE1vZCAqKm1vZHM7CiAKICAg
ICAvKiBqdXN0IGNoZWNraW5nIGlmIHdlIGFyZSBlbmFibGVkICovCkBAIC0yODcsMzYgKzI5NSw2
MyBAQAogICAgIHByID0gc3BhcmFtcy0+dXRpbHMtPnByb3BfZ2V0KHByY3R4KTsKICAgICBpZiAo
IXByKSByZXR1cm4gU0FTTF9CQURQQVJBTTsKIAotICAgIGZvciAobj0wOyBwcltuXS5uYW1lOyBu
KyspOworICAgIHBhc3N3b3JkX2luZGV4ID0gLTE7CisgICAgZm9yIChuPTA7IHByW25dLm5hbWU7
IG4rKykgeworCWlmIChjdHgtPnBhc3N3b3JkX21ldGhvZAorCSAgICAmJiAhc3RyY2FzZWNtcCgo
Y2hhciAqKXByW25dLm5hbWUsICJ1c2VycGFzc3dvcmRcMCIpKQorCSAgICBwYXNzd29yZF9pbmRl
eCA9IG47CisgICAgfQogICAgIGlmICghbikgcmV0dXJuIFNBU0xfQkFEUEFSQU07CiAKLSAgICBt
b2RzID0gc3BhcmFtcy0+dXRpbHMtPm1hbGxvYygobisxKSAqIHNpemVvZihMREFQTW9kKikgKyBu
ICogc2l6ZW9mKExEQVBNb2QpKTsKLSAgICBpZiAoIW1vZHMpIHJldHVybiBTQVNMX05PTUVNOwor
ICAgIHJldCA9IGxkYXBkYl9jb25uZWN0KGN0eCwgc3BhcmFtcywgdXNlciwgdWxlbiwgJmNwKTsK
KyAgICBpZiAoIHJldCApIGdvdG8gZG9uZTsKIAotICAgIGlmKChpPWxkYXBkYl9jb25uZWN0KGN0
eCwgc3BhcmFtcywgdXNlciwgdWxlbiwgJmNwKSkgPT0gMCkgeworICAgIGlmIChwYXNzd29yZF9p
bmRleCA9PSAtMSB8fCBuID4gMSkgeworCW1vZHMgPSBzcGFyYW1zLT51dGlscy0+bWFsbG9jKChu
KzEpICogc2l6ZW9mKExEQVBNb2QqKSArIG4gKiBzaXplb2YoTERBUE1vZCkpOworCWlmICghbW9k
cykgeworCSAgICByZXQgPSBTQVNMX05PTUVNOworCSAgICBnb3RvIGRvbmU7CisJfQogCi0JZm9y
IChpPTA7IGk8bjsgaSsrKSB7Ci0JICAgIG1vZHNbaV0gPSAoTERBUE1vZCAqKSgoY2hhciAqKSht
b2RzK24rMSkgKyBpICogc2l6ZW9mKExEQVBNb2QpKTsKLQkgICAgbW9kc1tpXS0+bW9kX29wID0g
TERBUF9NT0RfUkVQTEFDRTsKLQkgICAgbW9kc1tpXS0+bW9kX3R5cGUgPSAoY2hhciAqKXByW2ld
Lm5hbWU7Ci0JICAgIG1vZHNbaV0tPm1vZF92YWx1ZXMgPSAoY2hhciAqKilwcltpXS52YWx1ZXM7
CisJZm9yIChpPTAsIGo9MDsgaTxuOyBpKyspIHsKKwkgICAgaWYgKGkgPT0gcGFzc3dvcmRfaW5k
ZXgpIGNvbnRpbnVlOworCSAgICBtb2RzW2pdID0gKExEQVBNb2QgKikoKGNoYXIgKikobW9kcytu
KzEpICsgaiAqIHNpemVvZihMREFQTW9kKSk7CisJICAgIG1vZHNbal0tPm1vZF9vcCA9IExEQVBf
TU9EX1JFUExBQ0U7CisJICAgIG1vZHNbal0tPm1vZF90eXBlID0gKGNoYXIgKilwcltpXS5uYW1l
OworCSAgICBtb2RzW2pdLT5tb2RfdmFsdWVzID0gKGNoYXIgKiopcHJbaV0udmFsdWVzOworCSAg
ICBqKys7CiAJfQotCW1vZHNbaV0gPSBOVUxMOworCW1vZHNbal0gPSBOVUxMOwogCi0JaSA9IGxk
YXBfbW9kaWZ5X2V4dF9zKGNwLmxkLCBjcC5kbi0+YnZfdmFsKzMsIG1vZHMsIGNwLmN0cmwsIE5V
TEwpOworCXJldCA9IGxkYXBfbW9kaWZ5X2V4dF9zKGNwLmxkLCBjcC5kbi0+YnZfdmFsKzMsIG1v
ZHMsIGNwLmN0cmwsIE5VTEwpOwogCWJlcl9idmZyZWUoY3AuZG4pOworCisJc3BhcmFtcy0+dXRp
bHMtPmZyZWUobW9kcyk7CiAgICAgfQogCi0gICAgc3BhcmFtcy0+dXRpbHMtPmZyZWUobW9kcyk7
CisgICAgaWYgKCFyZXQgJiYgcGFzc3dvcmRfaW5kZXggIT0gLTEgJiYgY3R4LT5wYXNzd29yZF9t
ZXRob2QgPT0gUEFTU1dPUkRfRVhPUCkgeworCWxuZXdwdy5idl9sZW4gPSBzdHJsZW4oIChjaGFy
ICopcHJbcGFzc3dvcmRfaW5kZXhdLnZhbHVlc1swXSk7CisJbG5ld3B3LmJ2X3ZhbCA9IHNwYXJh
bXMtPnV0aWxzLT5tYWxsb2MobG5ld3B3LmJ2X2xlbik7CisJaWYgKCFsbmV3cHcuYnZfdmFsKSB7
CisJICAgIHJldCA9IFNBU0xfTk9NRU07CisJICAgIGdvdG8gZG9uZTsKKwl9CisJbG5ld3B3LmJ2
X3ZhbCA9IHN0cmR1cCggKGNoYXIgKilwcltwYXNzd29yZF9pbmRleF0udmFsdWVzWzBdKTsKKwly
ZXQgPSBsZGFwX3Bhc3N3ZF9zKGNwLmxkLCBOVUxMLCBOVUxMLCAmbG5ld3B3LAorCQkJICAgJmxu
ZXdwYXNzd29yZCwgY3AuY3RybCwgTlVMTCk7CisJc3BhcmFtcy0+dXRpbHMtPmZyZWUobG5ld3B3
LmJ2X3ZhbCk7CisJc3BhcmFtcy0+dXRpbHMtPmZyZWUobG5ld3Bhc3N3b3JkLmJ2X3ZhbCk7Cisg
ICAgfQogCi0gICAgaWYgKGkpIHsKKyBkb25lOgorICAgIGlmKGNwLmxkKSBsZGFwX3VuYmluZF9l
eHQoY3AubGQsIE5VTEwsIE5VTEwpOworICAgIGlmIChyZXQpIHsKICAgICAJc3BhcmFtcy0+dXRp
bHMtPnNldGVycm9yKHNwYXJhbXMtPnV0aWxzLT5jb25uLCAwLAotCSAgICBsZGFwX2VycjJzdHJp
bmcoaSkpOwotCWlmIChpID09IExEQVBfTk9fTUVNT1JZKSBpID0gU0FTTF9OT01FTTsKLQllbHNl
IGkgPSBTQVNMX0ZBSUw7CisJICAgIGxkYXBfZXJyMnN0cmluZyhyZXQpKTsKKwlpZiAocmV0ID09
IExEQVBfTk9fTUVNT1JZKSByZXQgPSBTQVNMX05PTUVNOworCWVsc2UgcmV0ID0gU0FTTF9GQUlM
OwogICAgIH0KLSAgICBpZihjcC5sZCkgbGRhcF91bmJpbmRfZXh0KGNwLmxkLCBOVUxMLCBOVUxM
KTsKLSAgICByZXR1cm4gaTsKKyAgICByZXR1cm4gcmV0OwogfQogCiBzdGF0aWMgaW50CkBAIC00
OTIsNiArNTI3LDEzIEBACiAgICAgdXRpbHMtPmdldG9wdCh1dGlscy0+Z2V0b3B0X2NvbnRleHQs
IGxkYXBkYiwgImxkYXBkYl9jYW5vbl9hdHRyIiwKIAkoY29uc3QgY2hhciAqKikmcC0+Y2Fub24u
YnZfdmFsLCAmbGVuKTsKICAgICBwLT5jYW5vbi5idl9sZW4gPSBsZW47CisgICAgcC0+cGFzc3dv
cmRfbWV0aG9kID0gUEFTU1dPUkRfQ0xFQVI7CisgICAgdXRpbHMtPmdldG9wdCh1dGlscy0+Z2V0
b3B0X2NvbnRleHQsIGxkYXBkYiwgImxkYXBkYl9wYXNzd29yZF9tZXRob2QiLAorCSZzLCBOVUxM
KTsKKyAgICBpZihzKQorICAgIHsKKwlpZiAoIXN0cmNhc2VjbXAocywgImV4b3AiKSkgcC0+cGFz
c3dvcmRfbWV0aG9kID0gUEFTU1dPUkRfRVhPUDsKKyAgICB9CiAgICAgcC0+aW5pdGVkID0gMTsK
IAogICAgIHJldHVybiBTQVNMX09LOwo=
</data>        

          </attachment>
      

    </bug>

</bugzilla>