<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>2793</bug_id>
          
          <creation_ts>2006-02-08 07:49 EDT</creation_ts>
          <short_desc>deliver dumps core with sig11</short_desc>
          <delta_ts>2010-10-25 18:46:37 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>LMTP</component>
          <version>2.3.x</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>DUPLICATE</resolution>
          <dup_id>2786</dup_id>
          
          
          
          <priority>P2</priority>
          <bug_severity>bug</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Nicolas KOWALSKI">Nicolas.Kowalski@imag.fr</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          
          <qa_contact name="The Cyrus Bugzilla List">cyrus-bugzilla@lists.andrew.cmu.edu</qa_contact>

      

      

      
          <long_desc isprivate="0">
            <who name="Nicolas KOWALSKI">Nicolas.Kowalski@imag.fr</who>
            <bug_when>2006-02-08 07:49:59 EDT</bug_when>
            <thetext>Hello,

On a Debian sarge system, I compiled, installed and configured Cyrus-imapd-
2.3.1. All databases are configured for skiplist, flat or quotalegacy in 
imapd.conf.

./configure --disable-sieve --disable-murder
make
make install

Then I configured all the necessary directories, and checked the permissions 
(user=cyrus, group=mail), as described in the documentation. The master server 
starts without problem.

However, when attempting to use deliver, it terminates with signal 11:

cyrus@corbeau:~$ /usr/cyrus/bin/deliver -q -r cyrus@localhost -m user/kowalski 
&lt; msg
Segmentation fault (core dumped)


I ran gdb, and got the following:

cyrus@corbeau:~$ gdb /usr/cyrus/bin/deliver core
GNU gdb 6.3-debian
Copyright 2004 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type &quot;show copying&quot; to see the conditions.
There is absolutely no warranty for GDB.  Type &quot;show warranty&quot; for details.
This GDB was configured as &quot;i386-linux&quot;...Using host libthread_db 
library &quot;/lib/tls/libthread_db.so.1&quot;.

Core was generated by `/usr/cyrus/bin/deliver -q -r cyrus@localhost -m 
user/kowalski&apos;.
Program terminated with signal 11, Segmentation fault.

warning: current_sos: Can&apos;t read pathname for load map: Input/output error

Reading symbols from /usr/lib/libsasl2.so.2...done.
Loaded symbols for /usr/lib/libsasl2.so.2
Reading symbols from /usr/lib/libgssapi_krb5.so.2...done.
Loaded symbols for /usr/lib/libgssapi_krb5.so.2
Reading symbols from /usr/lib/libkrb5.so.3...done.
Loaded symbols for /usr/lib/libkrb5.so.3
Reading symbols from /usr/lib/libk5crypto.so.3...done.
Loaded symbols for /usr/lib/libk5crypto.so.3
Reading symbols from /lib/libcom_err.so.2...done.
Loaded symbols for /lib/libcom_err.so.2
Reading symbols from /lib/tls/libresolv.so.2...done.
Loaded symbols for /lib/tls/libresolv.so.2
Reading symbols from /usr/lib/i686/cmov/libssl.so.0.9.7...done.
Loaded symbols for /usr/lib/i686/cmov/libssl.so.0.9.7
Reading symbols from /usr/lib/i686/cmov/libcrypto.so.0.9.7...done.
Loaded symbols for /usr/lib/i686/cmov/libcrypto.so.0.9.7
Reading symbols from /usr/lib/libdb3.so.3...done.
Loaded symbols for /usr/lib/libdb3.so.3
Reading symbols from /lib/tls/libc.so.6...done.
Loaded symbols for /lib/tls/libc.so.6
Reading symbols from /lib/tls/libdl.so.2...done.
Loaded symbols for /lib/tls/libdl.so.2
Reading symbols from /lib/ld-linux.so.2...done.
Loaded symbols for /lib/ld-linux.so.2
#0  0x0805037e in backend_connect (ret=0x8112b60,
    server=0x8112af8 &quot;/var/run/cyrus/socket/lmtp&quot;, prot=0x80fe090,
    userid=0x3 &lt;Address 0x3 out of bounds&gt;, cb=0x3, auth_status=0x3) at 
backend.c:345
345                 if (bind(sock, res1-&gt;ai_addr, res1-&gt;ai_addrlen) &lt; 0) {

(gdb) bt
#0  0x0805037e in backend_connect (ret=0x8112b60,
    server=0x8112af8 &quot;/var/run/cyrus/socket/lmtp&quot;, prot=0x80fe090,
    userid=0x3 &lt;Address 0x3 out of bounds&gt;, cb=0x3, auth_status=0x3) at 
backend.c:345
#1  0x0804bdd5 in deliver_msg (return_path=0x3 &lt;Address 0x3 out of bounds&gt;,
    authuser=0x3 &lt;Address 0x3 out of bounds&gt;, ignorequota=1, users=0xbfa894ac,
    numusers=0, mailbox=0xbfa89f06 &quot;user/kowalski&quot;) at deliver.c:315
#2  0x0804bb4b in main (argc=0, argv=0xbfa89494) at deliver.c:252


Using the &quot;deliver&quot; binary from my current 2.2.12 installation works without 
any problem...

Thanks,
Nicolas</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">murch@andrew.cmu.edu</who>
            <bug_when>2006-02-08 08:32:40 EDT</bug_when>
            <thetext>This is the same as bug #2786, which is fixed in CVS.

*** This bug has been marked as a duplicate of 2786 ***</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Nicolas KOWALSKI">Nicolas.Kowalski@imag.fr</who>
            <bug_when>2006-02-08 09:00:40 EDT</bug_when>
            <thetext>Thanks for your response, and sorry for the duplicate.

Just for the record, applying the given patch 
(https://bugzilla.andrew.cmu.edu/attachment.cgi?id=414&amp;action=view) resolved 
the problem for me too.

Best regards,
Nicolas.
</thetext>
          </long_desc>
      
      

    </bug>

</bugzilla>