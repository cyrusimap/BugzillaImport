<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>3489</bug_id>
          
          <creation_ts>2011-07-08 08:27 EDT</creation_ts>
          <short_desc>2.4.10 and quota problem</short_desc>
          <delta_ts>2011-08-03 10:57:52 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>IMAP</component>
          <version>2.4.10</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          <priority>P3</priority>
          <bug_severity>bug</bug_severity>
          <target_milestone>2.4.11</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Eero Hänninen">fax@nohik.ee</reporter>
          <assigned_to name="Bron Gondwana">brong@fastmail.fm</assigned_to>
          <cc>vanmeeuwen@kolabsys.com</cc>
          <qa_contact name="The Cyrus Bugzilla List">cyrus-bugzilla@lists.andrew.cmu.edu</qa_contact>

      

      

      
          <long_desc isprivate="0">
            <who name="Eero Hänninen">fax@nohik.ee</who>
            <bug_when>2011-07-08 08:27:10 EDT</bug_when>
            <thetext>Just routine mailbox checks after upgrade to cyrus-imap 2.4.10 I discovered, that some mailboxes doesn&apos;t have quotaroot, and its not possible to set.
I run manually quota -f and re-set quota, but nothing is changed. I noticed that quota -f outputs some other user quota too (in our system elvisp and elvispiia are different users).
Telnet sessions outputs are before and after quota -f same.

Ok some technical details and outputs:
OS: Debian Squeeze Linux 6.0.2 64bit
Cyrus package: manually self compiled 2.4.10
Nothing related in logs (should I run it in debug mode?)

Quota related imap.conf entries:
autocreatequota: 10000
quota_db: quotalegacy
lmtp_over_quota_perm_failure: 1

quota -f output:
cyrus@mh17 ~# /usr/lib64/cyrus/bin/quota -f user.elvisp
user.elvisp: quota root (none) --&gt;
user.elvisp.Kaitse Liit: quota root (none) --&gt;
user.elvisp.Kool: quota root (none) --&gt;
user.elvisp.Mustandid: quota root (none) --&gt;
user.elvisp.Praht: quota root (none) --&gt;
user.elvisp.Prygikast: quota root (none) --&gt;
user.elvisp.Saadetud: quota root (none) --&gt;
user.elvisp.Sait: quota root (none) --&gt;
   Quota   % Used     Used Root
   10000       81     8173
   10000        1      109 user.elvispiia

cyrus@mh17 ~# telnet mh17 143
Trying 10.0.0.117...
Connected to mh17.
Escape character is &apos;^]&apos;.
* OK [CAPABILITY IMAP4rev1 LITERAL+ ID ENABLE AUTH=PLAIN SASL-IR] mh17 Cyrus IMAP v2.4.10-Debian-2.4.10-1 server ready
1 login **** ******
1 OK [CAPABILITY IMAP4rev1 LITERAL+ ID ENABLE ACL RIGHTS=kxte QUOTA MAILBOX-REFERRALS NAMESPACE UIDPLUS NO_ATOMIC_RENAME UNSELECT CHILDREN MULTIAPPEND BINARY CATENATE CONDSTORE ESEARCH SORT SORT=MODSEQ SORT=DISPLAY THREAD=ORDEREDSUBJECT THREAD=REFERENCES ANNOTATEMORE LIST-EXTENDED WITHIN QRESYNC SCAN XLIST URLAUTH URLAUTH=BINARY LOGINDISABLED COMPRESS=DEFLATE IDLE] User logged in SESSIONID=&lt;cyrus-13750-1310109428-1&gt;
2 GETQUOTA user.elvisp
* QUOTA user.elvisp (STORAGE 8173 10000)
2 OK Completed
3 GETQUOTAROOT user.elvisp
* QUOTAROOT user.elvisp
3 OK Completed
4 SETQUOTA user.elvisp (STORAGE 10000)
4 OK Completed
5 GETQUOTAROOT user.elvisp
* QUOTAROOT user.elvisp
5 OK Completed
6 GETQUOTA user.elvisp
* QUOTA user.elvisp (STORAGE 8173 10000)
6 OK Completed</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Bron Gondwana">brong@fastmail.fm</who>
            <bug_when>2011-07-11 10:14:45 EDT</bug_when>
            <thetext>I have pushed a fix to git which I believe solves this bug.  Can you please test it and let me know.

Thanks,

Bron.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Eero Hänninen">fax@nohik.ee</who>
            <bug_when>2011-07-12 06:29:43 EDT</bug_when>
            <thetext>Tested and seems work now, thanks!</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Jeroen van Meeuwen (Kolab Systems)">vanmeeuwen@kolabsys.com</who>
            <bug_when>2011-08-03 10:57:52 EDT</bug_when>
            <thetext>Targetted for 2.4.11</thetext>
          </long_desc>
      
      

    </bug>

</bugzilla>