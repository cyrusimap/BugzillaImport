<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>227</bug_id>
          
          <creation_ts>2000-08-22 23:15 EDT</creation_ts>
          <short_desc>imapconf.c -- efficiency?</short_desc>
          <delta_ts>2010-10-18 12:42:48 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>IMAP</component>
          <version>2.0.x</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          <priority>P5</priority>
          <bug_severity>bug</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Larry Greenfield">leg+cyrus@andrew.cmu.edu</reporter>
          <assigned_to name="Rob Siemborski">rjs3@andrew.cmu.edu</assigned_to>
          
          

      

      

      
          <long_desc isprivate="0">
            <who name="Larry Greenfield">leg+cyrus@andrew.cmu.edu</who>
            <bug_when>2000-08-22 23:15:08 EDT</bug_when>
            <thetext>currently, imapconf.c does a linear search using strcmp() for everything
looked up.  does this hurt efficiency?  can we do better?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Larry Greenfield">leg+cyrus@andrew.cmu.edu</who>
            <bug_when>2000-10-18 12:31:36 EDT</bug_when>
            <thetext>mass-accepting bugs</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-13 17:03:48 EDT</bug_when>
            <thetext>I committed an improvement to the hash table code.  I expect that converting the
current config code to use the hash table code instead of a linear lookup will
not be hard.
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Larry Greenfield">leg+cyrus@andrew.cmu.edu</who>
            <bug_when>2002-06-14 12:53:31 EDT</bug_when>
            <thetext>so i still have code to do a totally different config interface (where the
imapd.conf manpage is generated from the same source that generates part of the
code).  It&apos;s on my notebook; I really should commit it on a branch so that we
don&apos;t just lose it.

As long as we don&apos;t increase the memory usage significantly with the hash table
I&apos;m all for committing that as a short-term fix.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-14 12:58:38 EDT</bug_when>
            <thetext>I&apos;d love to finish up the work on that (I was about to start designing something
new that sounds similar to what you have code for anyway, since I&apos;ve never
actually seen that code ;)

Keeping in mind that we have ~80 config options that could possibly be defined,
What is &quot;significantly&quot;?  I was envisioning about 160-200 buckets (800 bytes for
the table itself), but that may be high, plus the fact that each node is 4 byte
larger due to the next pointer.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Larry Greenfield">leg+cyrus@andrew.cmu.edu</who>
            <bug_when>2002-06-14 13:08:29 EDT</bug_when>
            <thetext>i don&apos;t know what significantly is.  anything like than 1k is probably
insignificant.

i&apos;ll attach a current diff. (it will show conflicts because i did a &quot;cvs update&quot;
right before i left)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-14 13:09:16 EDT</bug_when>
            <thetext>okay.  I&apos;ll get something working and either commit it or post it back as a diff
depending on how I feel (and how soon you are doing the 2.1.5 pull)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Larry Greenfield">leg+cyrus@andrew.cmu.edu</who>
            <bug_when>2002-06-14 13:09:18 EDT</bug_when>
            <thetext>Created an attachment (id=44)
preliminary ideas for advanced configuration system
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-14 13:14:20 EDT</bug_when>
            <thetext>yeah, this looks pretty close to what I was going to do ;)

hrm, a lot of code has change since you pulled this....</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Larry Greenfield">leg+cyrus@andrew.cmu.edu</who>
            <bug_when>2002-06-14 13:29:35 EDT</bug_when>
            <thetext>yeah, and i was developing it on a windows system so i&apos;m not sure whether i ever
built it. let me know if you have any questions.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-18 20:27:37 EDT</bug_when>
            <thetext>*** Bug 226 has been marked as a duplicate of this bug. ***</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-18 20:29:01 EDT</bug_when>
            <thetext>Created an attachment (id=46)
closer to working patch
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-18 20:30:34 EDT</bug_when>
            <thetext>just added an attachment that should be a complete transition of the current CVS
HEAD to the new system.

I&apos;ll be testing it some tomorrow and then I&apos;ll probably commit to a branch.

I suspect this might be a good candidate for the first new feature of a 2.2
series, because it does impose rigid semantics on the configuration system, and
this has some annoying breaks from the past.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-18 20:37:05 EDT</bug_when>
            <thetext>another thing we should do -- some sort of catagorization of the imap options,
since paging through ~90 options (Even alphabetical!) takes forever.

I envision atleast two other ways of sorting:

murder related / generic
sort by application + generic (for application-specific ones)

I don&apos;t see a reason why there couldn&apos;t also be a config2html script that took
care of this.
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-18 20:58:00 EDT</bug_when>
            <thetext>Created an attachment (id=47)
Same as previous, except with the added files this time.
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-20 13:55:50 EDT</bug_when>
            <thetext>Created an attachment (id=48)
Current patch.
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-20 15:28:52 EDT</bug_when>
            <thetext>committed all changes thus far to a cyrus-new-config branch.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-07-16 11:37:31 EDT</bug_when>
            <thetext>since this has been incorporated into 2.2, I&apos;m closing the bug.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>44</attachid>
            <date>2002-06-14 13:09 EDT</date>
            <desc>preliminary ideas for advanced configuration system</desc>
            <filename>diffs</filename>
            <type>text/plain</type>
            <size>140430</size>
            <attacher>leg+cyrus@andrew.cmu.edu</attacher>
            
              <data encoding="base64">PyBkaWZmcw0KPyBvdXQuYw0KPyBvdXQuaA0KPyBUSE9VR0hUUw0KPyBsaWIvY3lydXNkYl9za2lw
dHdvLmMNCkluZGV4OiBjb25maWd1cmUuaW4NCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvYWZzL2Fu
ZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2NvbmZpZ3VyZS5pbix2DQpyZXRyaWV2
aW5nIHJldmlzaW9uIDEuMjMxDQpkaWZmIC11IC1yMS4yMzEgY29uZmlndXJlLmluDQotLS0gY29u
ZmlndXJlLmluCTIwMDIvMDUvMjYgMDA6NTk6NDQJMS4yMzENCisrKyBjb25maWd1cmUuaW4JMjAw
Mi8wNi8xNCAxNzowNTowNA0KQEAgLTIzOCw2ICsyMzgsOSBAQA0KIEFDX0NIRUNLX0hFQURFUlMo
c3lzL3Jlc291cmNlLmgpDQogQUNfQ0hFQ0tfRlVOQ1Moc2V0cmxpbWl0KQ0KIA0KK2RubCBmb3Ig
ZGV0YWNoaW5nIHRlcm1pbmFsDQorQUNfQ0hFQ0tfRlVOQ1MoZGFlbW9uIHNldHNpZCkNCisNCiBB
Q19FR1JFUF9IRUFERVIoc29ja2xlbl90LCBzeXMvc29ja2V0LmgsIEFDX0RFRklORShIQVZFX1NP
Q0tMRU5fVCkpDQogQUNfRUdSRVBfSEVBREVSKHJsaW1fdCwgc3lzL3Jlc291cmNlLmgsIEFDX0RF
RklORShIQVZFX1JMSU1fVCkpDQogDQpJbmRleDogZG9jL2luc3RhbGwtcGVyZi5odG1sDQo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09DQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1
cy9kb2MvaW5zdGFsbC1wZXJmLmh0bWwsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjUNCmRpZmYg
LXUgLXIxLjUgaW5zdGFsbC1wZXJmLmh0bWwNCi0tLSBpbnN0YWxsLXBlcmYuaHRtbAkyMDAyLzAy
LzEzIDE3OjEwOjEzCTEuNQ0KKysrIGluc3RhbGwtcGVyZi5odG1sCTIwMDIvMDYvMTQgMTc6MDU6
MDQNCkBAIC00NCw2ICs0NCw3IEBADQogDQogPHA+V2UgcnVuIHdpdGggaXQgZW5hYmxlZCBhbmQg
aXQgZG9lc24ndCBzaWduaWZpY2FudGx5IGltcGFjdCBvdXINCiBwZXJmb3JtYW5jZS48L3A+DQor
DQogPC9saT4NCiANCiA8bGk+PHR0PjxiPi92YXIvc3Bvb2wvbXF1ZXVlPC9iPjwvdHQ+IC0gU2Vu
ZG1haWwgY2FuIGJlIHByZXR0eQ0KQEAgLTY0LDYgKzY1LDE1IEBADQogc2VlIHRoZSBMaXN0ZW4g
cXVldWUgZHJvcCBjb3VudGVyIGluY3JlYXNpbmcgcXVpY2tseS4gRm9yIGV4YW1wbGUsDQogdW5k
ZXIgU29sYXJpcywgbG9vayBhdCB0aGUgdmFyaWFibGUgdGNwTGlzdGVuRHJvcCAoZnJvbSA8dHQ+
bmV0c3RhdA0KIC1zUCB0Y3A8L3R0PikuPC9saT4NCisNCis8bGk+PGI+RGF0YWJhc2UgcmVjb3Zl
cnkuPC9iPiBJZiByZXN0YXJ0aW5nIHRoZSBzZXJ2ZXIgdGFrZXMgYSBsb25nDQordGltZSBkdWUg
dG8gdGhlIDx0dD5jeXJ1c2RiPC90dD4gZGF0YWJhc2UgcmVjb3ZlcnkgcHJvY2VkdXJlICh0aGlz
IGlzDQordXN1YWxseSB0cnVlIGlmIHlvdSBoYXZlIGEgbGFyZ2UgbnVtYmVyIG9mIGRlbGl2ZXJp
ZXMpIHlvdSBzaG91bGQgbG9vaw0KK2ludG8gc2hvcnRlbmluZyB0aGUgaW50ZXJ2YWwgYmV0d2Vl
biBjaGVja3BvaW50cywgY29udHJvbGxlZCBieSB0aGUNCis8dHQ+Y3lydXNkYjwvdHQ+IGV2ZW50
IGluIDx0dD4vZXRjL2N5cnVzLmNvbmY8L3R0Pi4gIFdlIHJ1bg0KK2NoZWNrcG9pbnRzIGV2ZXJ5
IDEwIG1pbnV0ZXM7IHRoZSBjdXJyZW50IHN1Z2dlc3RlZCBpbnN0YWxsIGludGVydmFsDQoraXMg
MzAgbWludXRlcy4NCis8L2xpPg0KIDwvdWw+DQogDQogPHA+SW4gZ2VuZXJhbCwgdGhlcmUncyBu
byBtYWdpYyBidWxsZXQgZm9yIHBlcmZvcm1hbmNlLiBJdCBkZXBlbmRzDQpJbmRleDogaW1hcC9h
Y2FwbWJveC5jDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0
ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL2FjYXBtYm94LmMsdg0KcmV0cmlldmluZyByZXZpc2lvbiAx
LjMxDQpkaWZmIC11IC1yMS4zMSBhY2FwbWJveC5jDQotLS0gYWNhcG1ib3guYwkyMDAyLzA1LzI1
IDE5OjU3OjQzCTEuMzENCisrKyBhY2FwbWJveC5jCTIwMDIvMDYvMTQgMTc6MDU6MDQNCkBAIC0x
MDUsOSArMTA1LDkgQEANCiAJc3RyY2F0KHBvc3RhZGRyLCAiQCIpOw0KIAlzdHJjYXQocG9zdGFk
ZHIsIHNlcnZlcik7DQogICAgIH0gZWxzZSB7DQotCWNvbnN0IGNoYXIgKnBvc3RzcGVjID0gY29u
ZmlnX2dldHN0cmluZygicG9zdHNwZWMiLCBOVUxMKTsNCi0JY29uc3QgY2hhciAqQkIgPSBjb25m
aWdfZ2V0c3RyaW5nKCJwb3N0dXNlciIsICJiYiIpOw0KLQ0KKwljb25zdCBjaGFyICpwb3N0c3Bl
YyA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QT1NUU1BFQyk7DQorCWNvbnN0IGNoYXIgKkJC
ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1BPU1RVU0VSKTsNCisgICAgIA0KIAlpZiAocG9z
dHNwZWMpIHsNCiAJICAgIHNucHJpbnRmKHBvc3RhZGRyLCBzaXplb2YocG9zdGFkZHIpLCBwb3N0
c3BlYywgbmFtZSk7DQogCX0gZWxzZSB7DQpAQCAtMTc2LDcgKzE3Niw3IEBADQogICAgIGNvbnN0
IGNoYXIgKmF1dGhwcm9nOw0KICAgICBzYXNsX2NhbGxiYWNrX3QgKmNiOw0KICAgICANCi0gICAg
YWNhcHNlcnZlciA9IGNvbmZpZ19nZXRzdHJpbmcoImFjYXBfc2VydmVyIiwgTlVMTCk7DQorICAg
IGFjYXBzZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQUNBUF9TRVJWRVIpOw0KICAg
ICBpZiAoIWFjYXBzZXJ2ZXIpIHJldHVybiBOVUxMOw0KIA0KICAgICBpZiAoY2FjaGVkX2Nvbm4p
IHsNCkBAIC0xOTcsMjEgKzE5NywyMSBAQA0KICAgICBjYWNoZWRfY29ubiA9IChhY2FwbWJveF9o
YW5kbGVfdCAqKSB4bWFsbG9jKHNpemVvZihhY2FwbWJveF9oYW5kbGVfdCkpOw0KICAgICBjYWNo
ZWRfY29ubi0+Y29ubiA9IE5VTEw7DQogICAgIA0KLSAgICB1c2VyID0gY29uZmlnX2dldHN0cmlu
ZygiYWNhcF91c2VybmFtZSIsIE5VTEwpOw0KKyAgICB1c2VyID0gY29uZmlnX2dldHN0cmluZyhJ
TUFQT1BUX0FDQVBfVVNFUk5BTUUpOw0KICAgICBpZiAodXNlciA9PSBOVUxMKSB7DQogCXN5c2xv
ZyhMT0dfRVJSLCAidW5hYmxlIHRvIGZpbmQgb3B0aW9uIGFjYXBfdXNlcm5hbWUiKTsNCiAJcmV0
dXJuIGNhY2hlZF9jb25uOw0KICAgICB9DQogDQotICAgIGF1dGhwcm9nID0gY29uZmlnX2dldHN0
cmluZygiYWNhcF9nZXRhdXRoIiwgTlVMTCk7DQorICAgIGF1dGhwcm9nID0gY29uZmlnX2dldHN0
cmluZyhJTUFQT1BUX0FDQVBfR0VUQVVUSCk7DQogICAgIGlmIChhdXRocHJvZykgew0KIAlzeXN0
ZW0oYXV0aHByb2cpOw0KICAgICB9DQogDQogICAgIGNiID0gbXlzYXNsX2NhbGxiYWNrcyh1c2Vy
LA0KLQkJCSAgY29uZmlnX2dldHN0cmluZygiYWNhcF9hdXRobmFtZSIsIHVzZXIpLA0KLQkJCSAg
Y29uZmlnX2dldHN0cmluZygiYWNhcF9yZWFsbSIsIE5VTEwpLA0KLQkJCSAgY29uZmlnX2dldHN0
cmluZygiYWNhcF9wYXNzd29yZCIsIE5VTEwpKTsNCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1B
UE9QVF9BQ0FQX0FVVEhOQU1FKSwNCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9BQ0FQ
X1JFQUxNKSwNCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9BQ0FQX1BBU1NXT1JEKSk7
DQogICAgIHNucHJpbnRmKHN0ciwgc2l6ZW9mKHN0ciksICJhY2FwOi8vJXNAJXMvIiwgdXNlciwg
YWNhcHNlcnZlcik7DQogICAgIHIgPSBhY2FwX2Nvbm5fY29ubmVjdChzdHIsIGNiLCAmKGNhY2hl
ZF9jb25uLT5jb25uKSk7DQogICAgIGZyZWVfY2FsbGJhY2tzKGNiKTsNCkluZGV4OiBpbWFwL2Nv
bGxlY3RuZXdzLmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5
c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvY29sbGVjdG5ld3MuYyx2DQpyZXRyaWV2aW5nIHJldmlz
aW9uIDEuMjYNCmRpZmYgLXUgLXIxLjI2IGNvbGxlY3RuZXdzLmMNCi0tLSBjb2xsZWN0bmV3cy5j
CTIwMDEvMDIvMjIgMTk6Mjc6MTYJMS4yNg0KKysrIGNvbGxlY3RuZXdzLmMJMjAwMi8wNi8xNCAx
NzowNTowNA0KQEAgLTEwMCwxMCArMTAwLDEwIEBADQogDQogICAgIGlmIChnZXRldWlkKCkgPT0g
MCkgZmF0YWwoIm11c3QgcnVuIGFzIHRoZSBDeXJ1cyB1c2VyIiwgRUNfVVNBR0UpOw0KIA0KLSAg
ICBuZXdzcHJlZml4ID0gY29uZmlnX2dldHN0cmluZygibmV3c3ByZWZpeCIsIDApOw0KKyAgICBu
ZXdzcHJlZml4ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX05FV1NQUkVGSVgpOw0KICAgICBp
ZiAobmV3c3ByZWZpeCkgbmV3c3ByZWZpeGxlbiA9IHN0cmxlbihuZXdzcHJlZml4KTsNCiAgICAg
DQotICAgIGlmICghY29uZmlnX2dldHN0cmluZygicGFydGl0aW9uLW5ld3MiLCAwKSkgew0KKyAg
ICBpZiAoIWNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QQVJUSVRJT05ORVdTKSkgew0KIAlmYXRh
bCgicGFydGl0aW9uLW5ld3Mgb3B0aW9uIG5vdCBzcGVjaWZpZWQgaW4gY29uZmlndXJhdGlvbiBm
aWxlIiwNCiAJICAgICAgRUNfQ09ORklHKTsNCiAgICAgfQ0KSW5kZXg6IGltYXAvY29uZmlnLmMN
Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0NClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3Jj
L2N5cnVzL2ltYXAvY29uZmlnLmMsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjUwDQpkaWZmIC11
IC1yMS41MCBjb25maWcuYw0KLS0tIGNvbmZpZy5jCTIwMDIvMDUvMjUgMTk6NTc6NDMJMS41MA0K
KysrIGNvbmZpZy5jCTIwMDIvMDYvMTQgMTc6MDU6MDQNCkBAIC0xLDQgKzEsNCBAQA0KLS8qIGNv
bmZpZy5jIC0tIENvbmZpZ3VyYXRpb24gcm91dGluZXMNCisvKiBjb25maWcuYyAtLSBjb21tb24g
aW5pdGlhbGl6YXRpb24gJiBjb25maWd1cmF0aW9uDQogICogQ29weXJpZ2h0IChjKSAxOTk4LTIw
MDAgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkuICBBbGwgcmlnaHRzIHJlc2VydmVkLg0KICAq
DQogICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywg
d2l0aCBvciB3aXRob3V0DQpAQCAtNzcsMTUgKzc3LDIxIEBADQogc3RhdGljIHN0cnVjdCBjb25m
aWdsaXN0ICpjb25maWdsaXN0Ow0KIHN0YXRpYyBpbnQgbmNvbmZpZ2xpc3Q7DQogDQotDQogLyog
dmFyaWFibGVzIGFjY2Vzc2libGUgdG8gdGhlIGV4dGVybmFsIHdvcmxkICovDQogY29uc3QgY2hh
ciAqY29uZmlnX2ZpbGVuYW1lOyAgICAgLyogZmlsZW5hbWUgb2YgY29uZmlndXJhdGlvbiBmaWxl
ICovDQogDQorPDw8PDw8PCBjb25maWcuYw0KK2NvbnN0IGNoYXIgKmNvbmZpZ19kaXI7CQkgLyog
aWUgL3Zhci9pbWFwICovDQorY29uc3QgY2hhciAqY29uZmlnX2RlZnBhcnRpdGlvbjsgLyogL3Zh
ci9zcG9vbC9pbWFwICovDQorY29uc3QgY2hhciAqY29uZmlnX3NlcnZlcm5hbWU7CSAvKiBnZXRo
b3N0bmFtZSgpICovDQoraW50IGNvbmZpZ19oYXNoaW1hcHNwb29sOwkgLyogZiAqLw0KKz09PT09
PT0NCiBjb25zdCBjaGFyICpjb25maWdfZGlyOwkJICAgICAgICAgICAvKiBpZSAvdmFyL2ltYXAg
Ki8NCiBjb25zdCBjaGFyICpjb25maWdfZGVmcGFydGl0aW9uOyAgICAgICAgICAgLyogL3Zhci9z
cG9vbC9pbWFwICovDQogY29uc3QgY2hhciAqY29uZmlnX25ld3NzcG9vbDsJICAgICAgICAgICAv
KiAvdmFyL3Nwb29sL25ld3MgKi8NCiBjb25zdCBjaGFyICpjb25maWdfc2VydmVybmFtZTsJICAg
ICAgICAgICAvKiBnZXRob3N0bmFtZSgpICovDQogY29uc3QgY2hhciAqY29uZmlnX211cGRhdGVf
c2VydmVyID0gTlVMTDsgIC8qIE5VTEwgKi8NCis+Pj4+Pj4+IDEuNTANCiANCiBpbnQgY29uZmln
X2hhc2hpbWFwc3Bvb2w7CSAgICAgICAgICAgLyogZiAqLw0KIA0KQEAgLTEwNiwxNCArMTEyLDE1
IEBADQogICAgIGNvbmZpZ19yZWFkKGFsdF9jb25maWcpOw0KIA0KICAgICAvKiBMb29rIHVwIGNv
bmZpZ2RpcmVjdG9yeSBjb25maWcgb3B0aW9uICovDQotICAgIGNvbmZpZ19kaXIgPSBjb25maWdf
Z2V0c3RyaW5nKCJjb25maWdkaXJlY3RvcnkiLCAoY2hhciAqKTApOw0KKyAgICBjb25maWdfZGly
ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0NPTkZJR0RJUkVDVE9SWSk7DQogICAgIGlmICgh
Y29uZmlnX2Rpcikgew0KIAlmYXRhbCgiY29uZmlnZGlyZWN0b3J5IG9wdGlvbiBub3Qgc3BlY2lm
aWVkIGluIGNvbmZpZ3VyYXRpb24gZmlsZSIsDQogCSAgICAgIEVDX0NPTkZJRyk7DQogICAgIH0N
CiANCiAgICAgLyogTG9vayB1cCBkZWZhdWx0IHBhcnRpdGlvbiAqLw0KLSAgICBjb25maWdfZGVm
cGFydGl0aW9uID0gY29uZmlnX2dldHN0cmluZygiZGVmYXVsdHBhcnRpdGlvbiIsICJkZWZhdWx0
Iik7DQorICAgIGNvbmZpZ19kZWZwYXJ0aXRpb24gPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRf
REVGQVVMVFBBUlRJVElPTik7DQorICAgIC8qIGNoZWNrIGRlZmF1bHRwYXJ0aXRpb24gZm9yIHJl
YXNvbmFibGUtbmVzcyAqLw0KICAgICBmb3IgKHAgPSAoY2hhciAqKWNvbmZpZ19kZWZwYXJ0aXRp
b247ICpwOyBwKyspIHsNCiAJaWYgKCFpc2FsbnVtKCh1bnNpZ25lZCBjaGFyKSAqcCkpDQogCSAg
ZmF0YWwoImRlZmF1bHRwYXJ0aXRpb24gb3B0aW9uIGNvbnRhaW5zIG5vbi1hbHBoYW51bWVyaWMg
Y2hhcmFjdGVyIiwNCkBAIC0xMjcsMjEgKzEzNCwxOCBAQA0KICAgICB9DQogDQogICAgIC8qIExv
b2sgdXAgdW1hc2sgKi8NCi0gICAgdmFsID0gY29uZmlnX2dldHN0cmluZygidW1hc2siLCAiMDc3
Iik7DQorICAgIHZhbCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9VTUFTSyk7DQogICAgIHdo
aWxlICgqdmFsKSB7DQogCWlmICgqdmFsID49ICcwJyAmJiAqdmFsIDw9ICc3JykgdW1hc2t2YWwg
PSB1bWFza3ZhbCo4ICsgKnZhbCAtICcwJzsNCiAJdmFsKys7DQogICAgIH0NCiAgICAgdW1hc2so
dW1hc2t2YWwpOw0KIA0KLSAgICAvKiBMb29rIHVwIG5ld3Mgc3Bvb2wgKi8NCi0gICAgY29uZmln
X25ld3NzcG9vbCA9IGNvbmZpZ19nZXRzdHJpbmcoIm5ld3NzcG9vbCIsIDApOw0KLQ0KICAgICAv
KiBsb29rIHVwIG1haWxib3ggaGFzaGluZyAqLw0KLSAgICBjb25maWdfaGFzaGltYXBzcG9vbCA9
IGNvbmZpZ19nZXRzd2l0Y2goImhhc2hpbWFwc3Bvb2wiLCAwKTsNCisgICAgY29uZmlnX2hhc2hp
bWFwc3Bvb2wgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfSEFTSElNQVBTUE9PTCk7DQogDQog
ICAgIC8qIGxvb2sgdXAgdGhlIGhvc3RuYW1lIHdlIHNob3VsZCBwcmVzZW50IHRvIHRoZSB1c2Vy
ICovDQotICAgIGNvbmZpZ19zZXJ2ZXJuYW1lID0gY29uZmlnX2dldHN0cmluZygic2VydmVybmFt
ZSIsIDApOw0KKyAgICBjb25maWdfc2VydmVybmFtZSA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9Q
VF9TRVJWRVJOQU1FKTsNCiAgICAgaWYgKCFjb25maWdfc2VydmVybmFtZSkgew0KIAljb25maWdf
c2VydmVybmFtZSA9IHhtYWxsb2Moc2l6ZW9mKGNoYXIpICogMjU2KTsNCiAJZ2V0aG9zdG5hbWUo
KGNoYXIgKikgY29uZmlnX3NlcnZlcm5hbWUsIDI1Nik7DQpAQCAtMTUyLDYgKzE1Niw4IEBADQog
ICAgIHJldHVybiAwOw0KIH0NCiANCis8PDw8PDw8IGNvbmZpZy5jDQorPT09PT09PQ0KIGludCBj
b25maWdfY2hhbmdlaWRlbnQoY29uc3QgY2hhciAqaWRlbnQpDQogew0KICAgICBjbG9zZWxvZygp
Ow0KQEAgLTI5Nyw2ICszMDMsNyBAQA0KICAgICB9DQogfQ0KIA0KKz4+Pj4+Pj4gMS40Nw0KIC8q
IHRoaXMgaXMgYSB3cmFwcGVyIHRvIGNhbGwgdGhlIGN5cnVzIGNvbmZpZ3VyYXRpb24gZnJvbSBT
QVNMICovDQogaW50IG15c2FzbF9jb25maWcodm9pZCAqY29udGV4dCBfX2F0dHJpYnV0ZV9fKCh1
bnVzZWQpKSwgDQogCQkgIGNvbnN0IGNoYXIgKnBsdWdpbl9uYW1lLA0KQEAgLTMwOSw3ICszMTYs
NyBAQA0KIA0KICAgICBpZiAoIXN0cmNtcChvcHRpb24sICJzcnZ0YWIiKSkgeyANCiAJLyogd2Ug
ZG9uJ3QgdHJhbnNmb3JtIHNydnRhYiEgKi8NCi0JKnJlc3VsdCA9IGNvbmZpZ19nZXRzdHJpbmco
b3B0aW9uLCBOVUxMKTsNCisJKnJlc3VsdCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9TUlZU
QUIpOw0KICAgICB9IGVsc2Ugew0KIAkqcmVzdWx0ID0gTlVMTDsNCiANCkBAIC0zMTksMTQgKzMy
NiwxNCBAQA0KIAkgICAgc3RybGNhdChvcHQsIHBsdWdpbl9uYW1lLCBzbCk7DQogCSAgICBzdHJs
Y2F0KG9wdCwgIl8iLCBzbCk7DQogCSAgICBzdHJsY2F0KG9wdCwgb3B0aW9uLCBzbCk7DQotCSAg
ICAqcmVzdWx0ID0gY29uZmlnX2dldHN0cmluZyhvcHQsIE5VTEwpOw0KKwkgICAgKnJlc3VsdCA9
IGNvbmZpZ19nZXRvdmVyZmxvd3N0cmluZyhvcHQpOw0KIAl9DQogDQogCWlmICgqcmVzdWx0ID09
IE5VTEwpIHsNCiAJICAgIC8qIHRyeSB3aXRob3V0IHRoZSBwbHVnaW4gbmFtZSAqLw0KIAkgICAg
c3RybGNweShvcHQsICJzYXNsXyIsIHNsKTsNCiAJICAgIHN0cmxjYXQob3B0LCBvcHRpb24sIHNs
KTsNCi0JICAgICpyZXN1bHQgPSBjb25maWdfZ2V0c3RyaW5nKG9wdCwgTlVMTCk7DQorCSAgICAq
cmVzdWx0ID0gY29uZmlnX2dldG92ZXJmbG93c3RyaW5nKG9wdCk7DQogCX0NCiAgICAgfQ0KIA0K
QEAgLTM0NSwxNSArMzUyLDIwIEBADQogew0KICAgICBzdGF0aWMgc2FzbF9zZWN1cml0eV9wcm9w
ZXJ0aWVzX3QgcmV0Ow0KIA0KKzw8PDw8PDwgY29uZmlnLmMNCisgICAgcmV0Lm1heGJ1ZnNpemUg
PSA0MDAwOw0KKyAgICByZXQubWluX3NzZiA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9TQVNMX01J
TklNVU1fTEFZRVIpOw0KKz09PT09PT0NCiAgICAgcmV0Lm1heGJ1ZnNpemUgPSBQUk9UX0JVRlNJ
WkU7DQogICAgIHJldC5taW5fc3NmID0gY29uZmlnX2dldGludCgic2FzbF9taW5pbXVtX2xheWVy
IiwgMCk7CQ0KKz4+Pj4+Pj4gMS41MA0KIAkJCQkvKiBtaW5pbXVtIGFsbG93YWJsZSBzZWN1cml0
eSBzdHJlbmd0aCAqLw0KLSAgICByZXQubWF4X3NzZiA9IGNvbmZpZ19nZXRpbnQoInNhc2xfbWF4
aW11bV9sYXllciIsIDI1Nik7DQorICAgIHJldC5tYXhfc3NmID0gY29uZmlnX2dldGludChJTUFQ
T1BUX1NBU0xfTUFYSU1VTV9MQVlFUik7DQogCQkJCS8qIG1heGltdW0gYWxsb3dhYmxlIHNlY3Vy
aXR5IHN0cmVuZ3RoICovDQogDQogICAgIHJldC5zZWN1cml0eV9mbGFncyA9IGZsYWdzOw0KICAg
ICAvKiByZXQuc2VjdXJpdHlfZmxhZ3MgfD0gU0FTTF9TRUNfTk9QTEFJTlRFWFQ7ICovDQotICAg
IGlmICghY29uZmlnX2dldHN3aXRjaCgiYWxsb3dhbm9ueW1vdXNsb2dpbiIsIDApKSB7DQorICAg
IGlmICghY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XQU5PTllNT1VTTE9HSU4pKSB7DQog
CXJldC5zZWN1cml0eV9mbGFncyB8PSBTQVNMX1NFQ19OT0FOT05ZTU9VUzsNCiAgICAgfQ0KICAg
ICByZXQucHJvcGVydHlfbmFtZXMgPSBOVUxMOw0KQEAgLTM2MiwxMiArMzc0LDE2IEBADQogICAg
IHJldHVybiAmcmV0Ow0KIH0NCiANCi0vKiB0cnVlIGlmICdhdXRoc3RhdGUnIGlzIGluICd2YWwn
ICovDQotc3RhdGljIGludCBpc2Eoc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhzdGF0ZSwgY29uc3Qg
Y2hhciAqb3B0KQ0KKy8qIHRydWUgaWYgJ2F1dGhzdGF0ZScgaXMgaW4gJ29wdCcgb3IgJ3NlcnZp
Y2Vfb3B0JyAqLw0KK2ludCBjb25maWdfYXV0aGlzYShzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aHN0
YXRlLCBlbnVtIGltYXBvcHQgb3B0KQ0KIHsNCiAgICAgY2hhciBidWZbMTAyNF07DQotICAgIGNv
bnN0IGNoYXIgKnZhbCA9IGNvbmZpZ19nZXRzdHJpbmcob3B0LCAiIik7DQorICAgIGNvbnN0IGNo
YXIgKnZhbCA9IGNvbmZpZ19nZXRzdHJpbmcob3B0KTsNCiANCisgICAgaWYgKCF2YWwpIHsNCisJ
Lyogbm8gc3VjaCBvcHRpb24gKi8NCisJcmV0dXJuIDA7DQorICAgIH0NCiAgICAgd2hpbGUgKCp2
YWwpIHsNCiAJY2hhciAqcDsNCiAJDQpAQCAtMzgxLDM0ICszOTcsNiBAQA0KIAl2YWwgPSBwOw0K
IAl3aGlsZSAoKnZhbCAmJiBpc3NwYWNlKChpbnQpICp2YWwpKSB2YWwrKzsNCiAgICAgfQ0KLSAg
ICByZXR1cm4gMDsNCi19DQotDQotLyogDQotICogY2hlY2sgJ3NlcnZpY2VfY2xhc3MnIGFuZCAn
Y2xhc3MnDQotICovDQotaW50IGF1dGhpc2Eoc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhzdGF0ZSwg
DQotCSAgICBjb25zdCBjaGFyICpzZXJ2aWNlLCANCi0JICAgIGNvbnN0IGNoYXIgKmNsYXNzKQ0K
LXsNCi0gICAgY2hhciBidWZbNTEyXTsNCi0NCi0gICAgaWYgKCFhdXRoc3RhdGUpIHsNCi0JLyog
bm90IGF1dGhlbnRpY2F0ZWQ/ICovDQotCXJldHVybiAwOw0KLSAgICB9DQotDQotICAgIC8qICdj
bGFzcycgKi8NCi0gICAgaWYgKGlzYShhdXRoc3RhdGUsIGNsYXNzKSkgew0KLQlyZXR1cm4gMTsN
Ci0gICAgfQ0KLQ0KLSAgICAvKiAnc2VydmljZV9jbGFzcycgKi8NCi0gICAgc25wcmludGYoYnVm
LCBzaXplb2YoYnVmKSwgIiVzXyVzIiwgc2VydmljZSwgY2xhc3MpOw0KLSAgICBpZiAoaXNhKGF1
dGhzdGF0ZSwgYnVmKSkgew0KLQlyZXR1cm4gMTsNCi0gICAgfQ0KLSAgICANCiAgICAgcmV0dXJu
IDA7DQogfQ0KIA0KSW5kZXg6IGltYXAvZGVsaXZlci5jDQo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTog
L2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL2RlbGl2ZXIuYyx2
DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTY0DQpkaWZmIC11IC1yMS4xNjQgZGVsaXZlci5jDQot
LS0gZGVsaXZlci5jCTIwMDIvMDUvMjUgMTk6NTc6NDQJMS4xNjQNCisrKyBkZWxpdmVyLmMJMjAw
Mi8wNi8xNCAxNzowNTowNA0KQEAgLTI2MSw3ICsyNjEsNyBAQA0KIA0KICAgICBjb25maWdfaW5p
dChhbHRfY29uZmlnLCAiZGVsaXZlciIpOw0KIA0KLSAgICBzb2NrYWRkciA9IGNvbmZpZ19nZXRz
dHJpbmcoImxtdHBzb2NrZXQiLCBOVUxMKTsNCisgICAgc29ja2FkZHIgPSBjb25maWdfZ2V0c3Ry
aW5nKElNQVBPUFRfTE1UUFNPQ0tFVCk7DQogICAgIGlmICghc29ja2FkZHIpIHsJDQogCXN0cmNw
eShidWYsIGNvbmZpZ19kaXIpOw0KIAlzdHJjYXQoYnVmLCAiL3NvY2tldC9sbXRwIik7DQpAQCAt
MzQ0LDcgKzM0NCw3IEBADQogICAgIGlmIChtYWlsYm94KSBtbCA9IHN0cmxlbihtYWlsYm94KTsN
CiAgICAgaWYgKG51bXVzZXJzID09IDApIHsNCiAJLyoganVzdCBkZWxpdmVyIHRvIG1haWxib3gg
J21haWxib3gnICovDQotCWNvbnN0IGNoYXIgKkJCID0gY29uZmlnX2dldHN0cmluZygicG9zdHVz
ZXIiLCAiIik7DQorCWNvbnN0IGNoYXIgKkJCID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1BP
U1RVU0VSKTsNCiAJdHhuLT5yY3B0WzBdLmFkZHIgPSAoY2hhciAqKSB4bWFsbG9jKG1sICsgc3Ry
bGVuKEJCKSArIDIpOyAvKiBsZWFrcyEgKi8NCiAJc3ByaW50Zih0eG4tPnJjcHRbMF0uYWRkciwg
IiVzKyVzIiwgQkIsIG1haWxib3gpOw0KICAgICB9IGVsc2Ugew0KSW5kZXg6IGltYXAvaWRsZV9p
ZGxlZC5jDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0v
Y3ZzL3NyYy9jeXJ1cy9pbWFwL2lkbGVfaWRsZWQuYyx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEu
OQ0KZGlmZiAtdSAtcjEuOSBpZGxlX2lkbGVkLmMNCi0tLSBpZGxlX2lkbGVkLmMJMjAwMi8wMS8x
OCAyMjo1ODo0NwkxLjkNCisrKyBpZGxlX2lkbGVkLmMJMjAwMi8wNi8xNCAxNzowNTowNA0KQEAg
LTk2LDcgKzk2LDcgQEANCiAgICAgICogTk9URTogaWYgdXNlZCwgYSBwZXJpb2Qgb2YgemVybyBk
aXNhYmxlcyBJRExFDQogICAgICAqLw0KICAgICBpZiAoaWRsZV9wZXJpb2QgPT0gLTEpIHsNCi0g
ICAgICBpZGxlX3BlcmlvZCA9IGNvbmZpZ19nZXRpbnQoImltYXBpZGxlcG9sbCIsIDYwKTsNCisg
ICAgICBpZGxlX3BlcmlvZCA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9JTUFQSURMRVBPTEwpOw0K
ICAgICAgIGlmIChpZGxlX3BlcmlvZCA8IDApIGlkbGVfcGVyaW9kID0gMDsNCiAgICAgfQ0KIA0K
QEAgLTEwOCw3ICsxMDgsNyBAQA0KICAgICBtYWlsYm94X3NldF91cGRhdGVub3RpZmllcihpZGxl
X25vdGlmeSk7DQogDQogICAgIGlkbGVfcmVtb3RlLnN1bl9mYW1pbHkgPSBBRl9VTklYOw0KLSAg
ICBpZGxlX3NvY2sgPSBjb25maWdfZ2V0c3RyaW5nKCJpZGxlc29ja2V0IiwgTlVMTCk7DQorICAg
IGlkbGVfc29jayA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9JRExFU09DS0VUKTsNCiAgICAg
aWYgKGlkbGVfc29jaykgewkNCiAJc3RyY3B5KGlkbGVfcmVtb3RlLnN1bl9wYXRoLCBpZGxlX3Nv
Y2spOw0KICAgICB9DQpJbmRleDogaW1hcC9pZGxlX3BvbGwuYw0KPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZp
bGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9pZGxlX3Bv
bGwuYyx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNQ0KZGlmZiAtdSAtcjEuNSBpZGxlX3BvbGwu
Yw0KLS0tIGlkbGVfcG9sbC5jCTIwMDEvMTEvMTkgMjE6MzI6NDQJMS41DQorKysgaWRsZV9wb2xs
LmMJMjAwMi8wNi8xNCAxNzowNTowNQ0KQEAgLTY1LDcgKzY1LDcgQEANCiB7DQogICAgIC8qIGdl
dCBwb2xsaW5nIHBlcmlvZCAqLw0KICAgICBpZiAoaWRsZV9wZXJpb2QgPT0gLTEpIHsNCi0gICAg
ICBpZGxlX3BlcmlvZCA9IGNvbmZpZ19nZXRpbnQoImltYXBpZGxlcG9sbCIsIDYwKTsNCisgICAg
ICBpZGxlX3BlcmlvZCA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9JTUFQSURMRVBPTEwpOw0KICAg
ICAgIGlmIChpZGxlX3BlcmlvZCA8IDApIGlkbGVfcGVyaW9kID0gMDsNCiAgICAgfQ0KIA0KSW5k
ZXg6IGltYXAvaWRsZWQuYw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5l
ZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9pZGxlZC5jLHYNCnJldHJpZXZpbmcgcmV2aXNp
b24gMS45DQpkaWZmIC11IC1yMS45IGlkbGVkLmMNCi0tLSBpZGxlZC5jCTIwMDIvMDIvMTkgMTg6
NTA6MTEJMS45DQorKysgaWRsZWQuYwkyMDAyLzA2LzE0IDE3OjA1OjA1DQpAQCAtMjg3LDcgKzI4
Nyw3IEBADQogICAgIHNwcmludGYoc2h1dGRvd25maWxlbmFtZSwgIiVzL21zZy9zaHV0ZG93biIs
IGNvbmZpZ19kaXIpOw0KIA0KICAgICAvKiBTZXQgaW5hY3Rpdml0eSB0aW1lciAoY29udmVydCBm
cm9tIG1pbnV0ZXMgdG8gc2Vjb25kcykgKi8NCi0gICAgaWRsZV90aW1lb3V0ID0gY29uZmlnX2dl
dGludCgidGltZW91dCIsIDMwKTsNCisgICAgaWRsZV90aW1lb3V0ID0gY29uZmlnX2dldGludChJ
TUFQT1BUX1RJTUVPVVQpOw0KICAgICBpZiAoaWRsZV90aW1lb3V0IDwgMzApIGlkbGVfdGltZW91
dCA9IDMwOw0KICAgICBpZGxlX3RpbWVvdXQgKj0gNjA7DQogDQpAQCAtMzExLDcgKzMxMSw3IEBA
DQogDQogICAgIC8qIGJpbmQgaXQgdG8gYSBsb2NhbCBmaWxlICovDQogICAgIGxvY2FsLnN1bl9m
YW1pbHkgPSBBRl9VTklYOw0KLSAgICBpZGxlX3NvY2sgPSBjb25maWdfZ2V0c3RyaW5nKCJpZGxl
c29ja2V0IiwgTlVMTCk7DQorICAgIGlkbGVfc29jayA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9Q
VF9JRExFU09DS0VUKTsNCiAgICAgaWYgKGlkbGVfc29jaykgewkNCiAJc3RyY3B5KGxvY2FsLnN1
bl9wYXRoLCBpZGxlX3NvY2spOw0KICAgICB9DQpJbmRleDogaW1hcC9pbWFwY29uZi5oDQo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09DQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1
cy9pbWFwL2ltYXBjb25mLmgsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjE1DQpkaWZmIC11IC1y
MS4xNSBpbWFwY29uZi5oDQotLS0gaW1hcGNvbmYuaAkyMDAyLzA0LzA1IDE4OjUxOjU0CTEuMTUN
CisrKyBpbWFwY29uZi5oCTIwMDIvMDYvMTQgMTc6MDU6MDUNCkBAIC00NCwxNiArNDQsMjEgQEAN
CiAjZGVmaW5lIElOQ0xVREVEX0lNQVBDT05GX0gNCiANCiAjaW5jbHVkZSA8c2FzbC9zYXNsLmg+
DQorI2luY2x1ZGUgImltYXBvcHQuaCINCiAjaW5jbHVkZSAiYXV0aC5oIg0KIA0KLWV4dGVybiBp
bnQgY29uZmlnX2luaXQoY29uc3QgY2hhciAqYWx0X2NvbmZpZywgY29uc3QgY2hhciAqaWRlbnQp
Ow0KLWV4dGVybiBjb25zdCBjaGFyICpjb25maWdfZ2V0c3RyaW5nKGNvbnN0IGNoYXIgKmtleSwg
Y29uc3QgY2hhciAqZGVmKTsNCi1leHRlcm4gaW50IGNvbmZpZ19nZXRpbnQoY29uc3QgY2hhciAq
a2V5LCBpbnQgZGVmKTsNCi1leHRlcm4gaW50IGNvbmZpZ19nZXRzd2l0Y2goY29uc3QgY2hhciAq
a2V5LCBpbnQgZGVmKTsNCisvKiBpbWFwIGNvbmZpZ3VyYXRpb24gZnVuY3Rpb25zIChjb25maWcu
YykgKi8NCitleHRlcm4gaW50IGNvbmZpZ19yZWFkKGNvbnN0IGNoYXIgKmFsdF9jb25maWcsIGNv
bnN0IGNoYXIgKnNlcnZpY2VuYW1lKTsNCisNCisvKiB0aGVzZSB3aWxsIGFzc2VydCgpIGlmIHRo
ZXkncmUgY2FsbGVkIG9uIHRoZSB3cm9uZyB0eXBlIG9mDQorICAgb3B0aW9uIChpbWFwb3B0LmMp
ICovDQorZXh0ZXJuIGNvbnN0IGNoYXIgKmNvbmZpZ19nZXRzdHJpbmcoZW51bSBpbWFwb3B0IG9w
dCk7DQorZXh0ZXJuIGludCBjb25maWdfZ2V0aW50KGVudW0gaW1hcG9wdCBvcHQpOw0KK2V4dGVy
biBpbnQgY29uZmlnX2dldHN3aXRjaChlbnVtIGltYXBvcHQgb3B0KTsNCiBleHRlcm4gY29uc3Qg
Y2hhciAqY29uZmlnX3BhcnRpdGlvbmRpcihjb25zdCBjaGFyICpwYXJ0aXRpb24pOw0KLWV4dGVy
biBpbnQgY29uZmlnX2NoYW5nZWlkZW50KGNvbnN0IGNoYXIgKmlkZW50KTsNCitleHRlcm4gY29u
c3QgY2hhciAqY29uZmlnX2dldG92ZXJmbG93c3RyaW5nKGNvbnN0IGNoYXIgKmtleSk7DQogDQot
Lyogc2FzbCBjb25maWd1cmF0aW9uICovDQorLyogc2FzbCBjb25maWd1cmF0aW9uIChjb25maWcu
YykgKi8NCiBleHRlcm4gaW50IG15c2FzbF9jb25maWcodm9pZCAqY29udGV4dCwNCiAJCQkgY29u
c3QgY2hhciAqcGx1Z2luX25hbWUsDQogCQkJIGNvbnN0IGNoYXIgKm9wdGlvbiwNCkBAIC04Niwy
NCArOTEsMjggQEANCiAjZW5kaWYNCiANCiAvKiBjaGVjayBpZiBgYXV0aHN0YXRlJyBpcyBhIHZh
bGlkIG1lbWJlciBvZiBjbGFzcyAqLw0KLWV4dGVybiBpbnQgYXV0aGlzYShzdHJ1Y3QgYXV0aF9z
dGF0ZSAqYXV0aHN0YXRlLCANCi0JCSAgIGNvbnN0IGNoYXIgKnNlcnZpY2UsIGNvbnN0IGNoYXIg
KmNsYXNzKTsNCitleHRlcm4gaW50IGNvbmZpZ19hdXRoaXNhKHN0cnVjdCBhdXRoX3N0YXRlICph
dXRoc3RhdGUsIA0KKwkJCSAgZW51bSBpbWFwb3B0IG9wdCk7DQogDQogLyogVmFsdWVzIG9mIG1h
bmRhdG9yeSBvcHRpb25zICovDQogZXh0ZXJuIGNvbnN0IGNoYXIgKmNvbmZpZ19maWxlbmFtZTsN
CiANCiBleHRlcm4gY29uc3QgY2hhciAqY29uZmlnX2RpcjsNCiBleHRlcm4gY29uc3QgY2hhciAq
Y29uZmlnX2RlZnBhcnRpdGlvbjsNCi1leHRlcm4gY29uc3QgY2hhciAqY29uZmlnX25ld3NzcG9v
bDsNCi0NCiBleHRlcm4gY29uc3QgY2hhciAqY29uZmlnX3NlcnZlcm5hbWU7DQorPDw8PDw8PCBp
bWFwY29uZi5oDQorPT09PT09PQ0KIGV4dGVybiBjb25zdCBjaGFyICpjb25maWdfbXVwZGF0ZV9z
ZXJ2ZXI7DQogDQorPj4+Pj4+PiAxLjE1DQogZXh0ZXJuIGludCBjb25maWdfaGFzaGltYXBzcG9v
bDsNCiANCi12b2lkIGNvbmZpZ19zY2FucGFydGl0aW9uKCB2b2lkICgqcHJvYykoKSApOw0KKy8q
IHNpZ25hbCBoYW5kbGluZyAoc2lnbmFscy5jKSAqLw0KIA0KKzw8PDw8PDwgaW1hcGNvbmYuaA0K
Kz09PT09PT0NCiAvKiBzaWduYWwgaGFuZGxpbmcgKHNpZ25hbHMuYykgKi8NCis+Pj4+Pj4+IDEu
MTQNCiB0eXBlZGVmIHZvaWQgc2h1dGRvd25mbihpbnQpOw0KIA0KIHZvaWQgc2lnbmFsc19hZGRf
aGFuZGxlcnModm9pZCk7DQpJbmRleDogaW1hcC9pbWFwZC5jDQo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmls
ZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL2ltYXBkLmMs
dg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjM5Nw0KZGlmZiAtdSAtcjEuMzk3IGltYXBkLmMNCi0t
LSBpbWFwZC5jCTIwMDIvMDYvMDcgMDI6MDU6MzIJMS4zOTcNCisrKyBpbWFwZC5jCTIwMDIvMDYv
MTQgMTc6MDU6MDcNCkBAIC0yOTQsNyArMjk0LDcgQEANCiAgICAgLyogY2hlY2sgaWYgcmVtb3Rl
IHJlYWxtICovDQogICAgIGlmICgocmVhbG0gPSBzdHJjaHIoYXV0aF9pZGVudGl0eSwgJ0AnKSkh
PU5VTEwpIHsNCiAJcmVhbG0rKzsNCi0JdmFsID0gY29uZmlnX2dldHN0cmluZygibG9naW5yZWFs
bXMiLCAiIik7DQorCXZhbCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9MT0dJTlJFQUxNUyk7
DQogCXdoaWxlICgqdmFsKSB7DQogCSAgICBpZiAoIXN0cm5jYXNlY21wKHZhbCwgcmVhbG0sIHN0
cmxlbihyZWFsbSkpICYmDQogCQkoIXZhbFtzdHJsZW4ocmVhbG0pXSB8fCBpc3NwYWNlKChpbnQp
IHZhbFtzdHJsZW4ocmVhbG0pXSkpKSB7DQpAQCAtMzE0LDE2ICszMTQsMjUgQEANCiAgICAgaW1h
cGRfYXV0aHN0YXRlID0gYXV0aF9uZXdzdGF0ZShhdXRoX2lkZW50aXR5LCBOVUxMKTsNCiANCiAg
ICAgLyogb2ssIGlzIGF1dGhfaWRlbnRpdHkgYW4gYWRtaW4/ICovDQotICAgIGltYXBkX3VzZXJp
c2FkbWluID0gYXV0aGlzYShpbWFwZF9hdXRoc3RhdGUsICJpbWFwIiwgImFkbWlucyIpOw0KKyAg
ICBpbWFwZF91c2VyaXNhZG1pbiA9IGNvbmZpZ19hdXRoaXNhKGltYXBkX2F1dGhzdGF0ZSwgSU1B
UE9QVF9BRE1JTlMpOw0KIA0KICAgICBpZiAoYWxlbiAhPSBybGVuIHx8IHN0cm5jbXAoYXV0aF9p
ZGVudGl0eSwgcmVxdWVzdGVkX3VzZXIsIGFsZW4pKSB7DQogCS8qIHdlIHdhbnQgdG8gYXV0aGVu
dGljYXRlIGFzIGEgZGlmZmVyZW50IHVzZXI7IHdlJ2xsIGFsbG93IHRoaXMNCiAJICAgaWYgd2Un
cmUgYW4gYWRtaW4gb3IgaWYgd2UndmUgYWxsb3dlZCBBQ0wgcHJveHkgbG9naW5zICovDQotCWlu
dCB1c2VfYWNsID0gY29uZmlnX2dldHN3aXRjaCgibG9naW51c2VhY2wiLCAwKTsNCisJaW50IHVz
ZV9hY2wgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfTE9HSU5VU0VBQ0wpOw0KIA0KIAlpZiAo
aW1hcGRfdXNlcmlzYWRtaW4gfHwNCis8PDw8PDw8IGltYXBkLmMNCis8PDw8PDw8IGltYXBkLmMN
CisJICAgICh1c2VfYWNsICYmIGFjbF9vayhyZXF1ZXN0ZWRfdXNlciwgYXV0aF9pZGVudGl0eSkp
IHx8DQorCSAgICBjb25maWdfYXV0aGlzYShpbWFwZF9hdXRoc3RhdGUsIElNQVBPUFRfUFJPWFlT
RVJWRVJTKSkgew0KKz09PT09PT0NCisJICAgICh1c2VfYWNsICYmIGFjbF9vayhyZXF1ZXN0ZWRf
dXNlciwgYXV0aF9pZGVudGl0eSwgaW1hcGRfYXV0aHN0YXRlKSkgfHwNCis9PT09PT09DQogCSAg
ICAodXNlX2FjbCAmJiBhY2xfb2socmVxdWVzdGVkX3VzZXIsIGltYXBkX2F1dGhzdGF0ZSkpIHx8
DQorPj4+Pj4+PiAxLjM1NA0KIAkgICAgYXV0aGlzYShpbWFwZF9hdXRoc3RhdGUsICJpbWFwIiwg
InByb3h5c2VydmVycyIpKSB7DQorPj4+Pj4+PiAxLjM0NA0KIAkgICAgLyogcHJveHkgb2shICov
DQogDQogCSAgICBpbWFwZF91c2VyaXNhZG1pbiA9IDA7CS8qIG5vIGxvbmdlciBhZG1pbiAqLw0K
QEAgLTUwMSw4ICs1MTAsNiBAQA0KICAgICBpbnQgcjsNCiAgICAgaW50IG9wdDsNCiANCi0gICAg
Y29uZmlnX2NoYW5nZWlkZW50KCJpbWFwZCIpOw0KLSAgICANCiAgICAgaWYgKGdldGV1aWQoKSA9
PSAwKSBmYXRhbCgibXVzdCBydW4gYXMgdGhlIEN5cnVzIHVzZXIiLCBFQ19VU0FHRSk7DQogICAg
IHNldHByb2N0aXRsZV9pbml0KGFyZ2MsIGFyZ3YsIGVudnApOw0KIA0KQEAgLTY1MCw3ICs2NTcs
NyBAQA0KICAgICBwcm9jX3JlZ2lzdGVyKCJpbWFwZCIsIGltYXBkX2NsaWVudGhvc3QsIE5VTEws
IE5VTEwpOw0KIA0KICAgICAvKiBTZXQgaW5hY3Rpdml0eSB0aW1lciAqLw0KLSAgICB0aW1lb3V0
ID0gY29uZmlnX2dldGludCgidGltZW91dCIsIDMwKTsNCisgICAgdGltZW91dCA9IGNvbmZpZ19n
ZXRpbnQoSU1BUE9QVF9USU1FT1VUKTsNCiAgICAgaWYgKHRpbWVvdXQgPCAzMCkgdGltZW91dCA9
IDMwOw0KICAgICBwcm90X3NldHRpbWVvdXQoaW1hcGRfaW4sIHRpbWVvdXQqNjApOw0KICAgICBw
cm90X3NldGZsdXNob25yZWFkKGltYXBkX2luLCBpbWFwZF9vdXQpOw0KQEAgLTE3MDMsNyArMTcx
MCw3IEBADQogDQogICAgIC8qIHBvc3NpYmx5IGRpc2FsbG93IGxvZ2luICovDQogICAgIGlmICgo
aW1hcGRfc3RhcnR0bHNfZG9uZSA9PSAwKSAmJg0KLQkoY29uZmlnX2dldHN3aXRjaCgiYWxsb3dw
bGFpbnRleHQiLCAxKSA9PSAwKSAmJg0KKwkoY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9X
UExBSU5URVhUKSA9PSAwKSAmJg0KIAlzdHJjbXAoY2Fub25fdXNlciwgImFub255bW91cyIpICE9
IDApIHsNCiAJZWF0bGluZShpbWFwZF9pbiwgJyAnKTsNCiAJcHJvdF9wcmludGYoaW1hcGRfb3V0
LCAiJXMgTk8gTG9naW4gb25seSBhdmFpbGFibGUgdW5kZXIgYSBsYXllclxyXG4iLA0KQEAgLTE3
MjcsNyArMTczNCw3IEBADQogICAgIHBhc3N3ZCA9IHBhc3N3ZGJ1Zi5zOw0KIA0KICAgICBpZiAo
IXN0cmNtcChjYW5vbl91c2VyLCAiYW5vbnltb3VzIikpIHsNCi0JaWYgKGNvbmZpZ19nZXRzd2l0
Y2goImFsbG93YW5vbnltb3VzbG9naW4iLCAwKSkgew0KKwlpZiAoY29uZmlnX2dldHN3aXRjaChJ
TUFQT1BUX0FMTE9XQU5PTllNT1VTTE9HSU4pKSB7DQogCSAgICBwYXNzd2QgPSBiZWF1dGlmeV9z
dHJpbmcocGFzc3dkKTsNCiAJICAgIGlmIChzdHJsZW4ocGFzc3dkKSA+IDUwMCkgcGFzc3dkWzUw
MF0gPSAnXDAnOw0KIAkgICAgc3lzbG9nKExPR19OT1RJQ0UsICJsb2dpbjogJXMgYW5vbnltb3Vz
ICVzIiwNCkBAIC0xNzc2LDcgKzE3ODMsNyBAQA0KIAkgICAgICAgY2Fub25fdXNlciwgaW1hcGRf
c3RhcnR0bHNfZG9uZSA/ICIrVExTIiA6ICIiLCANCiAJICAgICAgIHJlcGx5ID8gcmVwbHkgOiAi
Iik7DQogDQotCXBsYWludGV4dGxvZ2lucGF1c2UgPSBjb25maWdfZ2V0aW50KCJwbGFpbnRleHRs
b2dpbnBhdXNlIiwgMCk7DQorCXBsYWludGV4dGxvZ2lucGF1c2UgPSBjb25maWdfZ2V0aW50KElN
QVBPUFRfUExBSU5URVhUTE9HSU5QQVVTRSk7DQogCWlmIChwbGFpbnRleHRsb2dpbnBhdXNlICE9
IDAgJiYgIWltYXBkX3N0YXJ0dGxzX2RvbmUpIHsNCiAJICAgIC8qIEFwcGx5IHBlbmFsdHkgb25s
eSBpZiBub3QgdW5kZXIgbGF5ZXIgKi8NCiAJICAgIHNsZWVwKHBsYWludGV4dGxvZ2lucGF1c2Up
Ow0KQEAgLTE3ODQsNyArMTc5MSw3IEBADQogICAgIH0NCiAgICAgDQogICAgIGltYXBkX2F1dGhz
dGF0ZSA9IGF1dGhfbmV3c3RhdGUoY2Fub25fdXNlciwgKGNoYXIgKikwKTsNCi0gICAgdmFsID0g
Y29uZmlnX2dldHN0cmluZygiYWRtaW5zIiwgIiIpOw0KKyAgICB2YWwgPSBjb25maWdfZ2V0c3Ry
aW5nKElNQVBPUFRfQURNSU5TKTsNCiAgICAgd2hpbGUgKCp2YWwpIHsNCiAJZm9yIChwID0gKGNo
YXIgKil2YWw7ICpwICYmICFpc3NwYWNlKChpbnQpICpwKTsgcCsrKTsNCiAJc3RybGNweShidWYs
IHZhbCwgcCAtIHZhbCk7DQpAQCAtMjExOSw3ICsyMTI2LDcgQEANCiANCiAgICAgLyogc3BpdCBv
dXQgb3VyIElEIHN0cmluZy4NCiAgICAgICAgZXZlbnR1YWxseSB0aGlzIG1pZ2h0IGJlIGNvbmZp
Z3VyYWJsZS4gKi8NCi0gICAgaWYgKGNvbmZpZ19nZXRzd2l0Y2goImltYXBpZHJlc3BvbnNlIiwg
MSkpIHsNCisgICAgaWYgKGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9JTUFQSURSRVNQT05TRSkp
IHsNCiAJaWRfcmVzcG9uc2UoaW1hcGRfb3V0KTsNCiAJcHJvdF9wcmludGYoaW1hcGRfb3V0LCAi
KVxyXG4iKTsNCiAgICAgfQ0KQEAgLTIyNDIsOSArMjI0OSwxNyBAQA0KICAgICBpZiAodGxzX2Vu
YWJsZWQoImltYXAiKSkgew0KIAlwcm90X3ByaW50ZihpbWFwZF9vdXQsICIgU1RBUlRUTFMiKTsN
CiAgICAgfQ0KLSAgICBpZiAoIWltYXBkX3N0YXJ0dGxzX2RvbmUgJiYgIWNvbmZpZ19nZXRzd2l0
Y2goImFsbG93cGxhaW50ZXh0IiwgMSkpIHsNCisgICAgaWYgKCFpbWFwZF9zdGFydHRsc19kb25l
ICYmICFjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dQTEFJTlRFWFQpKSB7DQogCXByb3Rf
cHJpbnRmKGltYXBkX291dCwgIiBMT0dJTkRJU0FCTEVEIik7DQogICAgIH0NCis8PDw8PDw8IGlt
YXBkLmMNCisgICAgYWNhcHNlcnZlciA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9BQ0FQX1NF
UlZFUik7DQorICAgIGlmIChhY2Fwc2VydmVyICE9IE5VTEwpIHsNCisJcHJvdF9wcmludGYoaW1h
cGRfb3V0LCAiIEFDQVA9YWNhcDovLyVzJXMvIiwgDQorCQkgICAgYWNhcHNlcnZlciwgZ2xvYmFs
X2RhdGFzZXQpOw0KKyAgICB9DQorPT09PT09PQ0KKz4+Pj4+Pj4gMS4zNDQNCiANCiAgICAgaWYo
Y29uZmlnX211cGRhdGVfc2VydmVyKSB7DQogCXByb3RfcHJpbnRmKGltYXBkX291dCwgIiBNVVBE
QVRFPW11cGRhdGU6Ly8lcy8iLCBjb25maWdfbXVwZGF0ZV9zZXJ2ZXIpOw0KQEAgLTI1NjcsNyAr
MjU4Miw3IEBADQogCQlwcm90X3ByaW50ZihpbWFwZF9vdXQsICIqIE5PIFtBTEVSVF0gJXNcclxu
IiwNCiAJCQkgICAgZXJyb3JfbWVzc2FnZShJTUFQX05PX09WRVJRVU9UQSkpOw0KIAkgICAgfQ0K
LQkgICAgZWxzZSBpZiAodXNhZ2UgPiBjb25maWdfZ2V0aW50KCJxdW90YXdhcm4iLCA5MCkpIHsN
CisJICAgIGVsc2UgaWYgKHVzYWdlID4gY29uZmlnX2dldGludChJTUFQT1BUX1FVT1RBV0FSTikp
IHsNCiAJCWludCB1c2FnZWludCA9IChpbnQpIHVzYWdlOw0KIAkJcHJvdF9wcmludGYoaW1hcGRf
b3V0LCAiKiBOTyBbQUxFUlRdICIpOw0KIAkJcHJvdF9wcmludGYoaW1hcGRfb3V0LCBlcnJvcl9t
ZXNzYWdlKElNQVBfTk9fQ0xPU0VRVU9UQSksDQpAQCAtMzU1OCw3ICszNTczLDcgQEANCiAJCQkJ
ICAgbG9jYWxvbmx5LCBsb2NhbG9ubHkpOw0KIA0KIAlpZiAociA9PSBJTUFQX1BFUk1JU1NJT05f
REVOSUVEICYmICFzdHJjYXNlY21wKG5hbWUsICJJTkJPWCIpICYmDQotCSAgICAoYXV0b2NyZWF0
ZXF1b3RhID0gY29uZmlnX2dldGludCgiYXV0b2NyZWF0ZXF1b3RhIiwgMCkpKSB7DQorCSAgICAo
YXV0b2NyZWF0ZXF1b3RhID0gY29uZmlnX2dldGludChJTUFQT1BUX0FVVE9DUkVBVEVRVU9UQSkp
KSB7DQogDQogCSAgICAvKiBBdXRvIGNyZWF0ZSAqLw0KIAkgICAgciA9IG1ib3hsaXN0X2NyZWF0
ZW1haWxib3gobWFpbGJveG5hbWUsIDAsDQpAQCAtMzk4Niw3ICs0MDAxLDcgQEANCiAgICAgLyog
SWdub3JlIHRoZSByZWZlcmVuY2UgYXJndW1lbnQ/DQogICAgICAgICh0aGUgYmVoYXZpb3IgaW4g
MS41LjEwICYgb2xkZXIpICovDQogICAgIGlmIChpZ25vcmVyZWZlcmVuY2UgPT0gMCkgew0KLQlp
Z25vcmVyZWZlcmVuY2UgPSBjb25maWdfZ2V0c3dpdGNoKCJpZ25vcmVyZWZlcmVuY2UiLCAwKTsN
CisJaWdub3JlcmVmZXJlbmNlID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0lHTk9SRVJFRkVS
RU5DRSk7DQogICAgIH0NCiANCiAgICAgLyogUmVzZXQgc3RhdGUgaW4gbXN0cmluZ2RhdGEgKi8N
CkBAIC00MDI2LDYgKzQwNDEsMjUgQEANCiAJLyogVHJhbnNsYXRlIGFueSBzZXBhcmF0b3JzIGlu
IHBhdHRlcm4gKi8NCiAJbWJveG5hbWVfaGllcnNlcF90b2ludGVybmFsKCZpbWFwZF9uYW1lc3Bh
Y2UsIHBhdHRlcm4pOw0KIA0KKzw8PDw8PDwgaW1hcGQuYw0KKwlpZiAobGlzdG9wdHMgJiBMSVNU
X0xTVUIpIHsNCisJICAgIGludCBmb3JjZSA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExP
V0FMTFNVQlNDUklCRSk7DQorDQorCSAgICAoKmltYXBkX25hbWVzcGFjZS5tYm94bGlzdF9maW5k
c3ViKSgmaW1hcGRfbmFtZXNwYWNlLCBwYXR0ZXJuLA0KKwkJCQkJCWltYXBkX3VzZXJpc2FkbWlu
LCBpbWFwZF91c2VyaWQsDQorCQkJCQkJaW1hcGRfYXV0aHN0YXRlLCBsc3ViZGF0YSwNCisJCQkJ
CQkmbGlzdG9wdHMsIGZvcmNlKTsNCisJICAgIGxzdWJkYXRhKChjaGFyICopMCwgMCwgMCwgJmxp
c3RvcHRzKTsNCisJfQ0KKwllbHNlIGlmIChsaXN0b3B0cyAmIExJU1RfU1VCU0NSSUJFRCkgew0K
KwkgICAgaW50IGZvcmNlID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XQUxMU1VCU0NS
SUJFKTsNCisNCisJICAgICgqaW1hcGRfbmFtZXNwYWNlLm1ib3hsaXN0X2ZpbmRzdWIpKCZpbWFw
ZF9uYW1lc3BhY2UsIHBhdHRlcm4sDQorCQkJCQkJaW1hcGRfdXNlcmlzYWRtaW4sIGltYXBkX3Vz
ZXJpZCwNCisJCQkJCQlpbWFwZF9hdXRoc3RhdGUsIGxpc3RkYXRhLA0KKwkJCQkJCSZsaXN0b3B0
cywgZm9yY2UpOw0KKwkgICAgbGlzdGRhdGEoKGNoYXIgKikwLCAwLCAwLCAmbGlzdG9wdHMpOw0K
Kz09PT09PT0NCiAJLyogQ2hlY2sgdG8gc2VlIGlmIHdlIHNob3VsZCBvbmx5IGxpc3QgdGhlIHBl
cnNvbmFsIG5hbWVzcGFjZSAqLw0KIAlpZiAoIXN0cmNtcChwYXR0ZXJuLCAiKiIpICYmIGNvbmZp
Z19nZXRpbnQoImZvb2xzdHVwaWRjbGllbnRzIiwgMCkpIHsNCiAJICAgIGlmIChidWYpIGZyZWUo
YnVmKTsNCkBAIC00MDQ1LDYgKzQwNzksNyBAQA0KIAkgICAgKCpmaW5kc3ViKSgmaW1hcGRfbmFt
ZXNwYWNlLCBwYXR0ZXJuLA0KIAkJICAgICAgIGltYXBkX3VzZXJpc2FkbWluLCBpbWFwZF91c2Vy
aWQsIGltYXBkX2F1dGhzdGF0ZSwNCiAJCSAgICAgICBsaXN0ZGF0YSwgJmxpc3RvcHRzLCBmb3Jj
ZSk7DQorPj4+Pj4+PiAxLjM5Nw0KIAl9DQogCWVsc2Ugew0KIAkgICAgKCpmaW5kYWxsKSgmaW1h
cGRfbmFtZXNwYWNlLCBwYXR0ZXJuLA0KQEAgLTQwNzAsNyArNDEwNSw3IEBADQogew0KICAgICBp
bnQgcjsNCiAgICAgY2hhciBtYWlsYm94bmFtZVtNQVhfTUFJTEJPWF9OQU1FKzFdOw0KLSAgICBp
bnQgZm9yY2UgPSBjb25maWdfZ2V0c3dpdGNoKCJhbGxvd2FsbHN1YnNjcmliZSIsIDApOw0KKyAg
ICBpbnQgZm9yY2UgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dBTExTVUJTQ1JJQkUp
Ow0KIA0KICAgICBpZiAobmFtZXNwYWNlKSBsY2FzZShuYW1lc3BhY2UpOw0KICAgICBpZiAoIW5h
bWVzcGFjZSB8fCAhc3RyY21wKG5hbWVzcGFjZSwgIm1haWxib3giKSkgew0KQEAgLTQ3NjEsNiAr
NDc5NiwxMiBAQA0KIHZvaWQgY21kX25ldHNjcmFwZShjaGFyICp0YWcpDQogew0KICAgICBjb25z
dCBjaGFyICp1cmw7DQorPDw8PDw8PCBpbWFwZC5jDQorICAgIC8qIHNvIHRlbXB0aW5nLCBhbmQg
eWV0IC4uLiAqLw0KKyAgICAvKiB1cmwgPSAiaHR0cDovL3JhbmRvbS55YWhvby5jb20vcnlsLyI7
ICovDQorICAgIHVybCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9ORVRTQ0FQRVVSTCk7DQor
PT09PT09PQ0KKz4+Pj4+Pj4gMS4zOTcNCiANCiAgICAgdXJsID0gY29uZmlnX2dldHN0cmluZygi
bmV0c2NhcGV1cmwiLCBOVUxMKTsNCiANCkBAIC01MTc5LDcgKzUyMjAsMTEgQEANCiAJZWF0bGlu
ZShpbWFwZF9pbiwgYyk7DQogCWdvdG8gZnJlZWFyZ3M7DQogICAgIH0NCis8PDw8PDw8IGltYXBk
LmMNCiANCisgICAgcHJvdF9wcmludGYoaW1hcGRfb3V0LCAiJXMgTk8gc2V0dGluZyBhbm5vdGF0
aW9ucyBub3Qgc3VwcG9ydGVkXHJcbiIsIHRhZyk7DQorPT09PT09PQ0KKw0KICAgICAvKiBhZG1p
bmlzdHJhdG9ycyBvbmx5IHBsZWFzZSAqLw0KICAgICBpZiAoIWltYXBkX3VzZXJpc2FkbWluKSB7
DQogCXIgPSBJTUFQX1BFUk1JU1NJT05fREVOSUVEOw0KQEAgLTUxODksNyArNTIzNCwxMCBAQA0K
IAlyID0gYW5ub3RhdGVtb3JlX3N0b3JlKGVudHJ5YXR0cywgJmltYXBkX25hbWVzcGFjZSwgaW1h
cGRfdXNlcmlzYWRtaW4sDQogCQkJICAgICAgIGltYXBkX3VzZXJpZCwgaW1hcGRfYXV0aHN0YXRl
KTsNCiAgICAgfQ0KKz4+Pj4+Pj4gMS4zOTcNCiANCis8PDw8PDw8IGltYXBkLmMNCis9PT09PT09
DQogICAgIGlmIChyKSB7DQogCXByb3RfcHJpbnRmKGltYXBkX291dCwgIiVzIE5PICVzXHJcbiIs
IHRhZywgZXJyb3JfbWVzc2FnZShyKSk7DQogICAgIH0gZWxzZSB7DQpAQCAtNTE5Nyw2ICs1MjQ1
LDcgQEANCiAJCSAgICBlcnJvcl9tZXNzYWdlKElNQVBfT0tfQ09NUExFVEVEKSk7DQogICAgIH0N
CiANCis+Pj4+Pj4+IDEuMzk3DQogICBmcmVlYXJnczoNCiAgICAgaWYgKGVudHJ5YXR0cykgZnJl
ZWVudHJ5YXR0cyhlbnRyeWF0dHMpOw0KICAgICByZXR1cm47DQpAQCAtNzE5Niw2ICs3MjQ1LDE4
IEBADQogICAgIGxhc3RuYW1lW21hdGNobGVuXSA9ICdcMCc7DQogICAgIG5vbmV4aXN0ZW50ID0g
MDsNCiANCis8PDw8PDw8IGltYXBkLmMNCisgICAgLyogU2VlIGlmIHN1YnNjcmliZWQgbWFpbGJv
eCBleGlzdHMgKi8NCisgICAgaWYgKChsaXN0b3B0cyAmIExJU1RfU1VCU0NSSUJFRCkgJiYNCisJ
Y29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XQUxMU1VCU0NSSUJFKSkgew0KKwkvKiBjb252
ZXJ0ICJJTkJPWCIgdG8gInVzZXIuPHVzZXJpZD4iICovDQorCWlmICghc3RybmNhc2VjbXAobGFz
dG5hbWUsICJpbmJveCIsIDUpKQ0KKwkgICAgc3ByaW50ZihtYm94bmFtZSwgInVzZXIuJXMlcyIs
IGltYXBkX3VzZXJpZCwgbGFzdG5hbWUrNSk7DQorCWVsc2UNCisJICAgIHN0cmNweShtYm94bmFt
ZSwgbGFzdG5hbWUpOw0KKwlub25leGlzdGVudCA9IG1ib3hsaXN0X2xvb2t1cChtYm94bmFtZSwg
TlVMTCwgTlVMTCwgTlVMTCk7DQorICAgIH0NCis9PT09PT09DQogICAgIC8qIE5vdyB3ZSBuZWVk
IHRvIHNlZSBpZiB0aGlzIG1haWxib3ggZXhpc3RzICovDQogICAgIC8qIGZpcnN0IGNvbnZlcnQg
IklOQk9YIiB0byAidXNlci48dXNlcmlkPiIgKi8NCiAgICAgaWYgKCFzdHJuY2FzZWNtcChsYXN0
bmFtZSwgImluYm94IiwgNSkpDQpAQCAtNzIwOCw2ICs3MjY5LDcgQEANCiAJCQkJICBOVUxMLCBO
VUxMLCBOVUxMLCBOVUxMKTsNCiAgICAgaWYoIW5vbmV4aXN0ZW50ICYmIChtYnR5cGUgJiBNQlRZ
UEVfUkVTRVJWRSkpDQogCW5vbmV4aXN0ZW50ID0gSU1BUF9NQUlMQk9YX1JFU0VSVkVEOw0KKz4+
Pj4+Pj4gMS4zOTcNCiANCiAgICAgaWYgKCFuYW1lW21hdGNobGVuXSkgew0KIAlsYXN0bmFtZWRl
bGF5ZWQgPSAxOw0KSW5kZXg6IGltYXAvaW1hcG9wdC5jDQo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTog
aW1hcG9wdC5jDQpkaWZmIC1OIGltYXBvcHQuYw0KLS0tIC9kZXYvbnVsbAlUdWUgTWF5ICA1IDE2
OjMyOjI3IDE5OTgNCisrKyBpbWFwb3B0LmMJRnJpIEp1biAxNCAxMzowNTowNyAyMDAyDQpAQCAt
MCwwICsxLDIyNCBAQA0KKyNpbmNsdWRlICJpbWFwb3B0LmgiDQorDQorc3RydWN0IGltYXBvcHRf
cyB7DQorICAgIGVudW0gaW1hcG9wdCBvcHQ7ICANCisgICAgY29uc3QgY2hhciAqb3B0bmFtZTsN
CisgICAgdW5pb24gew0KKwljaGFyICpzOw0KKwlpbnQgaTsNCisJaW50IGI7DQorICAgIH0gdmFs
Ow0KKyAgICBlbnVtIG9wdHR5cGUgdDsNCit9Ow0KKw0KKy8qIHRoaXMgZGVmaW5lcyAiaW1hcG9w
dHMiLCB0aGUgYXJyYXkgb2YgbGVnYWwgb3B0aW9ucyBpbmRleGVkIGJ5DQorICAgdGhlIG9wdGlv
biBudW1iZXIgYXMgZGVmaW5lZCBpbiBpbWFwb3B0LmggKi8NCisjaW5jbHVkZSAiaW1hcG9wdC1h
dXRvZ2VuLmMiDQorDQorLyogZm9yIG9wdGlvbnMgdGhhdCBhcmVuJ3QgbGlzdGVkIGFib3ZlICov
DQorc3RydWN0IGNvbmZpZ2xpc3Qgew0KKyAgICBjaGFyICprZXk7DQorICAgIGNoYXIgKnZhbHVl
Ow0KK307DQorDQorc3RhdGljIHN0cnVjdCBjb25maWdsaXN0ICpjb25maWdsaXN0Ow0KK3N0YXRp
YyBpbnQgbmNvbmZpZ2xpc3Q7DQorDQorI2RlZmluZSBDT05GSUdMSVNUR1JPV1NJWkUgMzAgLyog
MTAwICovDQorDQorLyogaW1hcCBjb25maWd1cmF0aW9uIGZ1bmN0aW9ucyAoY29uZmlnLmMpICov
DQoraW50IGNvbmZpZ19yZWFkKGNvbnN0IGNoYXIgKmFsdF9jb25maWcsIGNvbnN0IGNoYXIgKnNl
cnZpY2VuYW1lKQ0KK3sNCisgICAgRklMRSAqaW5maWxlOw0KKyAgICBpbnQgbGluZW5vID0gMDsN
CisgICAgaW50IGFsbG9jZWQgPSAwOw0KKyAgICBjaGFyIGJ1Zls0MDk2XTsNCisgICAgaW50IG9w
dDsNCisgICAgY2hhciAqcCwgKnEsICprZXk7DQorICAgIGludCBzbmxlbiA9IHNlcnZpY2VuYW1l
ID8gc3RybGVuKHNlcnZpY2VuYW1lKSA6IDA7DQorDQorICAgIC8qIHJlYWQgaW4gY29uZmlnIGZp
bGUgKi8NCisgICAgaW5maWxlID0gZm9wZW4oYWx0X2NvbmZpZyA/IGFsdF9jb25maWcgOiBDT05G
SUdfRklMRU5BTUUsICJyIik7DQorICAgIGlmICghaW5maWxlKSB7DQorCXN0cmNweShidWYsIENZ
UlVTX1BBVEgpOw0KKwlzdHJjYXQoYnVmLCBhbHRfY29uZmlnID8gYWx0X2NvbmZpZyA6IENPTkZJ
R19GSUxFTkFNRSk7DQorCWluZmlsZSA9IGZvcGVuKGJ1ZiwgInIiKTsNCisgICAgfQ0KKyAgICBp
ZiAoIWluZmlsZSkgew0KKwlzcHJpbnRmKGJ1ZiwgImNhbid0IG9wZW4gY29uZmlndXJhdGlvbiBm
aWxlICVzOiAlcyIsDQorCQlhbHRfY29uZmlnID8gYWx0X2NvbmZpZyA6IENPTkZJR19GSUxFTkFN
RSwNCisJCWVycm9yX21lc3NhZ2UoZXJybm8pKTsNCisJZmF0YWwoYnVmLCBFQ19DT05GSUcpOw0K
KyAgICB9DQorDQorICAgIHdoaWxlIChmZ2V0cyhidWYsIHNpemVvZihidWYpLCBpbmZpbGUpKSB7
DQorCWxpbmVubysrOw0KKw0KKwlpZiAoYnVmW3N0cmxlbihidWYpLTFdID09ICdcbicpIGJ1Zltz
dHJsZW4oYnVmKS0xXSA9ICdcMCc7DQorCWZvciAocCA9IGJ1ZjsgKnAgJiYgaXNzcGFjZSgoaW50
KSAqcCk7IHArKyk7DQorCWlmICghKnAgfHwgKnAgPT0gJyMnKSBjb250aW51ZTsNCisNCisJa2V5
ID0gcDsNCisJd2hpbGUgKCpwICYmIChpc2FsbnVtKChpbnQpICpwKSB8fCAqcCA9PSAnLScgfHwg
KnAgPT0gJ18nKSkgew0KKwkgICAgaWYgKGlzdXBwZXIoKHVuc2lnbmVkIGNoYXIpICpwKSkgKnAg
PSB0b2xvd2VyKCh1bnNpZ25lZCBjaGFyKSAqcCk7DQorCSAgICBwKys7DQorCX0NCisJaWYgKCpw
ICE9ICc6Jykgew0KKwkgICAgc3ByaW50ZihidWYsDQorCQkgICAgImludmFsaWQgb3B0aW9uIG5h
bWUgb24gbGluZSAlZCBvZiBjb25maWd1cmF0aW9uIGZpbGUiLA0KKwkJICAgIGxpbmVubyk7DQor
CSAgICBmYXRhbChidWYsIEVDX0NPTkZJRyk7DQorCX0NCisJKnArKyA9ICdcMCc7DQorDQorCXdo
aWxlICgqcCAmJiBpc3NwYWNlKChpbnQpICpwKSkgcCsrOw0KKw0KKwkvKiByZW1vdmUgdHJhaWxp
bmcgd2hpdGVzcGFjZSAqLw0KKwlmb3IgKHEgPSBwICsgc3RybGVuKHApIC0gMTsgcSA+IHAgJiYg
aXNzcGFjZSgoaW50KSAqcSk7IHEtLSkgew0KKwkgICAgKnEgPSAnXDAnOw0KKwl9DQorCQ0KKwlp
ZiAoISpwKSB7DQorCSAgICBzcHJpbnRmKGJ1ZiwgImVtcHR5IG9wdGlvbiB2YWx1ZSBvbiBsaW5l
ICVkIG9mIGNvbmZpZ3VyYXRpb24gZmlsZSIsDQorCQkgICAgbGluZW5vKTsNCisJICAgIGZhdGFs
KGJ1ZiwgRUNfQ09ORklHKTsNCisJfQ0KKw0KKwkvKiBsb29rIGZvciBzZXJ2aWNlXyBwcmVmaXgs
IHNraXAgb3ZlciBpdCBpZiBpdCBleGlzdHMgKi8NCisJaWYgKHNlcnZpY2VuYW1lICYmICFzdHJu
Y21wKGtleSwgc2VydmljZW5hbWUsIHNubGVuKSANCisJICAgICAgICAgICAgICAgICYmIGtleVtz
bmxlbl0gPT0gJ18nKSB7DQorCSAgICAvKiBza2lwIHNlcnZpY2VfIHByZWZpeCAqLw0KKwkgICAg
a2V5ICs9IHNubGVuICsgMTsNCisJfQ0KKw0KKwkvKiBsb29rIGZvciB0aGUgY29ycmVzcG9uZGlu
ZyBlbnRyeSBpbiBpbWFwb3B0cyAqLw0KKwlmb3IgKG9wdCA9IElNQVBPUFRfWkVSTzsgb3B0IDwg
SU1BUE9QVF9MQVNUOyBvcHQrKykgew0KKwkgICAgaWYgKCFzdHJjbXAoaW1hcG9wdHNbb3B0XS5v
cHRuYW1lLCBrZXkpKSB7DQorCQlicmVhazsNCisJICAgIH0NCisJfQ0KKw0KKwlpZiAob3B0IDwg
SU1BUE9QVF9MQVNUKSB7DQorCSAgICAvKiB0aGlzIGlzIGEga25vd24gb3B0aW9uICovDQorCSAg
ICBzd2l0Y2ggKGltYXBvcHRzW29wdF0udCkgew0KKwkgICAgY2FzZSBTVFJJTkc6DQorCQlpbWFw
b3B0c1tvcHRdLnZhbC5zID0geHN0cmR1cChwKTsNCisJCWJyZWFrOw0KKw0KKwkgICAgY2FzZSBJ
TlQ6DQorCSAgICB7DQorCQlsb25nIHZhbDsNCisJCWNoYXIgKnB0cjsNCisNCisJCXZhbCA9IHN0
cnRvbChwLCAmcHRyLCAwKTsNCisJCWlmICghcHRyIHx8ICpwdHIgIT0gJ1wwJykgew0KKwkJICAg
IC8qIGVycm9yIGR1cmluZyBjb252ZXJzaW9uICovDQorCQkgICAgc3ByaW50ZihidWYsICJub24t
aW50ZWdlciB2YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIsDQorCQkJICAgIGltYXBvcHRzW29wdF0u
b3B0bmFtZSwgbGluZW5vKTsNCisJCSAgICBmYXRhbChidWYsIEVDX0NPTkZJRyk7DQorCQl9DQor
CQkNCisJCWltYXBvcHRzW29wdF0udmFsLmkgPSB2YWw7DQorCQlicmVhazsNCisJICAgIH0NCisJ
ICAgIGNhc2UgU1dJVENIOg0KKwkgICAgew0KKwkJaW50IHZhbDsNCisNCisJCWlmICgqcCA9PSAn
MCcgfHwgKnAgPT0gJ24nIHx8DQorCQkgICAgKCpwID09ICdvJyAmJiBwWzFdID09ICdmJykgfHwg
KnAgPT0gJ2YnKSB7DQorCQkgICAgcmV0dXJuIDA7DQorCQl9DQorCQllbHNlIGlmICgqcCA9PSAn
MScgfHwgKnAgPT0gJ3knIHx8DQorCQkJICgqcCA9PSAnbycgJiYgcFsxXSA9PSAnbicpIHx8ICpw
ID09ICd0Jykgew0KKwkJICAgIHJldHVybiAxOw0KKwkJfQ0KKwkJZWxzZSB7DQorCQkgICAgLyog
ZXJyb3IgZHVyaW5nIGNvbnZlcnNpb24gKi8NCisJCSAgICBzcHJpbnRmKGJ1ZiwgIm5vbi1zd2l0
Y2ggdmFsdWUgZm9yICVzIGluIGxpbmUgJWQiLA0KKwkJCSAgICBpbWFwb3B0c1tvcHRdLm9wdG5h
bWUsIGxpbmVubyk7DQorCQkgICAgZmF0YWwoYnVmLCBFQ19DT05GSUcpOw0KKwkJfQ0KKwkJYnJl
YWs7DQorCSAgICB9DQorCSAgICBjYXNlIE5PVE9QVDoNCisJCWFib3J0KCk7DQorCSAgICB9DQor
CX0gZWxzZSB7DQorCSAgICAvKiBvdGhlcndpc2UsIHB1dCBpdCBpbnRvIHRoZSBvdmVyZmxvdyBs
aXN0ICovDQorCSAgICBpZiAobmNvbmZpZ2xpc3QgPT0gYWxsb2NlZCkgew0KKwkJYWxsb2NlZCAr
PSBDT05GSUdMSVNUR1JPV1NJWkU7DQorCQljb25maWdsaXN0ID0gKHN0cnVjdCBjb25maWdsaXN0
ICopDQorCQkgICAgeHJlYWxsb2MoY29uZmlnbGlzdCwgYWxsb2NlZCAqIHNpemVvZihzdHJ1Y3Qg
Y29uZmlnbGlzdCkpOw0KKwkgICAgfQ0KKwkgICAgDQorCSAgICBjb25maWdsaXN0W25jb25maWds
aXN0XS5rZXkgPSB4c3RyZHVwKGtleSk7DQorCSAgICBjb25maWdsaXN0W25jb25maWdsaXN0XS52
YWx1ZSA9IHhzdHJkdXAocCk7DQorCSAgICBuY29uZmlnbGlzdCsrOw0KKwl9DQorICAgIH0NCisg
ICAgZmNsb3NlKGluZmlsZSk7DQorDQorICAgIC8qIGV4cGFuZCBjb25maWd1cmF0aW9uIHZhbHVl
cyB7Y29uZmlnX29wdH0gKi8NCisgICAgZm9yICg7Oykgew0KKwlpbnQgZGlkd29yayA9IDA7DQor
DQorCWZvciAob3B0ID0gSU1BUE9QVF9aRVJPOyBvcHQgPCBJTUFQT1BUX0xBU1Q7IG9wdCsrKSB7
DQorCSAgICANCisJICAgIC8qIGhhcyBhIHsuLi59IGluIGl0IC4uLiAqLw0KKw0KKwkgICAgLyog
cmVwbGFjZW1lbnQgb3B0aW9uIGhhcyBhIHsuLi59LCBkbyBub3RoaW5nICovDQorCX0NCisNCisJ
aWYgKCFkaWR3b3JrKSB7DQorCSAgICBicmVhazsNCisJfQ0KKyAgICB9DQorfQ0KKw0KK2NvbnN0
IGNoYXIgKmNvbmZpZ19nZXRzdHJpbmcoZW51bSBpbWFwb3B0IG9wdCkNCit7DQorICAgIGFzc2Vy
dChvcHQgPiBJTUFQT1BUX1pFUk8gJiYgb3B0IDwgSU1BUE9QVF9MQVNUKTsNCisgICAgYXNzZXJ0
KGltYXBvcHRzW29wdF0udCA9PSBTVFJJTkcpOw0KKw0KKyAgICByZXR1cm4gaW1hcG9wdHNbb3B0
XS52YWwuczsNCit9DQorDQoraW50IGNvbmZpZ19nZXRpbnQoZW51bSBpbWFwb3B0IG9wdCkNCit7
DQorICAgIGFzc2VydChvcHQgPiBJTUFQT1BUX1pFUk8gJiYgb3B0IDwgSU1BUE9QVF9MQVNUKTsN
CisgICAgYXNzZXJ0KGltYXBvcHRzW29wdF0udCA9PSBJTlQpOw0KKw0KKyAgICByZXR1cm4gaW1h
cG9wdHNbb3B0XS52YWwuaTsNCit9DQorDQoraW50IGNvbmZpZ19nZXRzd2l0Y2goZW51bSBpbWFw
b3B0IG9wdCkNCit7DQorICAgIGFzc2VydChvcHQgPiBJTUFQT1BUX1pFUk8gJiYgb3B0IDwgSU1B
UE9QVF9MQVNUKTsNCisgICAgYXNzZXJ0KGltYXBvcHRzW29wdF0udCA9PSBTV0lUQ0gpOw0KKw0K
KyAgICByZXR1cm4gaW1hcG9wdHNbb3B0XS52YWwuczsNCit9DQorDQorY29uc3QgY2hhciAqY29u
ZmlnX2dldG92ZXJmbG93c3RyaW5nKGNvbnN0IGNoYXIgKmtleSkNCit7DQorICAgIGludCBvcHQ7
DQorDQorICAgIGZvciAob3B0ID0gMDsgb3B0IDwgbmNvbmZpZ2xpc3Q7IG9wdCsrKSB7DQorCWlm
ICgqa2V5ID09IGNvbmZpZ2xpc3Rbb3B0XS5rZXlbMF0gJiYNCisJICAgICFzdHJjbXAoa2V5LCBj
b25maWdsaXN0W29wdF0ua2V5KSkNCisJICByZXR1cm4gY29uZmlnbGlzdFtvcHRdLnZhbHVlOw0K
KyAgICB9DQorICAgIHJldHVybiBOVUxMOw0KK30NCisNCitjb25zdCBjaGFyICpjb25maWdfcGFy
dGl0aW9uZGlyKGNvbnN0IGNoYXIgKnBhcnRpdGlvbikNCit7DQorICAgIGNoYXIgYnVmWzgwXTsN
CisNCisgICAgaWYgKHN0cmxlbihwYXJ0aXRpb24pID4gNzApIHJldHVybiAwOw0KKyAgICBzdHJj
cHkoYnVmLCAicGFydGl0aW9uLSIpOw0KKyAgICBzdHJjYXQoYnVmLCBwYXJ0aXRpb24pOw0KKw0K
KyAgICByZXR1cm4gY29uZmlnX2dldG92ZXJmbG93c3RyaW5nKGJ1Zik7DQorfQ0KSW5kZXg6IGlt
YXAvaW1hcG9wdGlvbnMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiBpbWFwb3B0aW9ucw0KZGlmZiAt
TiBpbWFwb3B0aW9ucw0KLS0tIC9kZXYvbnVsbAlUdWUgTWF5ICA1IDE2OjMyOjI3IDE5OTgNCisr
KyBpbWFwb3B0aW9ucwlGcmkgSnVuIDE0IDEzOjA1OjA3IDIwMDINCkBAIC0wLDAgKzEsMzY5IEBA
DQorLyoNCisuVEggSU1BUEQuQ09ORiA1ICJQcm9qZWN0IEN5cnVzIiBDTVUNCisuXCIgDQorLlwi
IENvcHlyaWdodCAoYykgMTk5OC0yMDAyIENhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5LiAgQWxs
IHJpZ2h0cyByZXNlcnZlZC4NCisuXCINCisuXCIgUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBz
b3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0DQorLlwiIG1vZGlmaWNhdGlv
biwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucw0K
Ky5cIiBhcmUgbWV0Og0KKy5cIg0KKy5cIiAxLiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNv
ZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodA0KKy5cIiAgICBub3RpY2UsIHRoaXMg
bGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuIA0KKy5cIg0K
Ky5cIiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhl
IGFib3ZlIGNvcHlyaWdodA0KKy5cIiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25z
IGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4NCisuXCIgICAgdGhlIGRvY3VtZW50YXRp
b24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZQ0KKy5cIiAgICBkaXN0
cmlidXRpb24uDQorLlwiDQorLlwiIDMuIFRoZSBuYW1lICJDYXJuZWdpZSBNZWxsb24gVW5pdmVy
c2l0eSIgbXVzdCBub3QgYmUgdXNlZCB0bw0KKy5cIiAgICBlbmRvcnNlIG9yIHByb21vdGUgcHJv
ZHVjdHMgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dA0KKy5cIiAgICBwcmlvciB3
cml0dGVuIHBlcm1pc3Npb24uIEZvciBwZXJtaXNzaW9uIG9yIGFueSBvdGhlciBsZWdhbA0KKy5c
IiAgICBkZXRhaWxzLCBwbGVhc2UgY29udGFjdCAgDQorLlwiICAgICAgT2ZmaWNlIG9mIFRlY2hu
b2xvZ3kgVHJhbnNmZXINCisuXCIgICAgICBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eQ0KKy5c
IiAgICAgIDUwMDAgRm9yYmVzIEF2ZW51ZQ0KKy5cIiAgICAgIFBpdHRzYnVyZ2gsIFBBICAxNTIx
My0zODkwDQorLlwiICAgICAgKDQxMikgMjY4LTQzODcsIGZheDogKDQxMikgMjY4LTczOTUNCisu
XCIgICAgICB0ZWNoLXRyYW5zZmVyQGFuZHJldy5jbXUuZWR1DQorLlwiDQorLlwiIDQuIFJlZGlz
dHJpYnV0aW9ucyBvZiBhbnkgZm9ybSB3aGF0c29ldmVyIG11c3QgcmV0YWluIHRoZSBmb2xsb3dp
bmcNCisuXCIgICAgYWNrbm93bGVkZ21lbnQ6DQorLlwiICAgICJUaGlzIHByb2R1Y3QgaW5jbHVk
ZXMgc29mdHdhcmUgZGV2ZWxvcGVkIGJ5IENvbXB1dGluZyBTZXJ2aWNlcw0KKy5cIiAgICAgYXQg
Q2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkgKGh0dHA6Ly93d3cuY211LmVkdS9jb21wdXRpbmcv
KS4iDQorLlwiDQorLlwiIENBUk5FR0lFIE1FTExPTiBVTklWRVJTSVRZIERJU0NMQUlNUyBBTEwg
V0FSUkFOVElFUyBXSVRIIFJFR0FSRCBUTw0KKy5cIiBUSElTIFNPRlRXQVJFLCBJTkNMVURJTkcg
QUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkNCisuXCIgQU5EIEZJVE5F
U1MsIElOIE5PIEVWRU5UIFNIQUxMIENBUk5FR0lFIE1FTExPTiBVTklWRVJTSVRZIEJFIExJQUJM
RQ0KKy5cIiBGT1IgQU5ZIFNQRUNJQUwsIElORElSRUNUIE9SIENPTlNFUVVFTlRJQUwgREFNQUdF
UyBPUiBBTlkgREFNQUdFUw0KKy5cIiBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NIExPU1MgT0Yg
VVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4NCisuXCIgQU4gQUNUSU9OIE9GIENPTlRS
QUNULCBORUdMSUdFTkNFIE9SIE9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORw0KKy5cIiBP
VVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1IgUEVSRk9STUFOQ0UgT0YgVEhJ
UyBTT0ZUV0FSRS4NCisuXCIgDQorLlNIIE5BTUUNCitpbWFwZC5jb25mIFwtIElNQVAgY29uZmln
dXJhdGlvbiBmaWxlDQorLlNIIERFU0NSSVBUSU9ODQorXGZCL2V0Yy9pbWFwZC5jb25mXGZSIA0K
K2lzIHRoZSBjb25maWd1cmF0aW9uIGZpbGUgZm9yIHRoZSBDeXJ1cyBJTUFQIHNlcnZlci4gIEl0
IGRlZmluZXMNCitsb2NhbCBwYXJhbWV0ZXJzIGZvciBJTUFQLiANCisuUFANCitFYWNoIGxpbmUg
b2YgdGhlIFxmQi9ldGMvaW1hcGQuY29uZlxmUiBmaWxlIGhhcyB0aGUgZm9ybQ0KKy5JUA0KK1xm
SW9wdGlvblxmUjogXGZJdmFsdWVcZlINCisuUFANCit3aGVyZSBcZklvcHRpb25cZlIgaXMgdGhl
IG5hbWUgb2YgdGhlIGNvbmZpZ3VyYXRpb24gb3B0aW9uIGJlaW5nIHNldA0KK2FuZCBcZkl2YWx1
ZVxmUiBpcyB0aGUgdmFsdWUgdGhhdCB0aGUgY29uZmlndXJhdGlvbiBvcHRpb24gaXMgYmVpbmcN
CitzZXQgdG8uDQorLlBQDQorQmxhbmsgbGluZXMgYW5kIGxpbmVzIGJlZ2lubmluZyB3aXRoIGBg
IycnIGFyZSBpZ25vcmVkLg0KKy5QUA0KK0ZvciBib29sZWFuIG9wdGlvbnMsIHRoZSB2YWx1ZXMg
YGB5ZXMnJywgYGBvbicnLCBgYHQnJywgYW5kIGBgMScnIHR1cm4gdGhlDQorb3B0aW9uIG9uLCB0
aGUgdmFsdWVzIGBgbm8nJywgYGBvZmYnJywgYGBmJycsIGFuZCBgYDAnJyB0dXJuIHRoZSBvcHRp
b24gb2ZmLg0KKy5TSCBGSUVMRCBERVNDUklQVElPTlMNCisuUFANCitUaGUgc2VjdGlvbnMgYmVs
b3cgZGV0YWlsIG9wdGlvbnMgdGhhdCBjYW4gYmUgcGxhY2VkIGluIHRoZQ0KK1xmQi9ldGMvaW1h
cGQuY29uZlxmUiBmaWxlLCBhbmQgc2hvdyBlYWNoIG9wdGlvbidzIGRlZmF1bHQgdmFsdWUuDQor
U29tZSBvcHRpb25zIGhhdmUgbm8gZGVmYXVsdCB2YWx1ZSwgdGhlc2UgYXJlIGxpc3RlZCB3aXRo
DQorYGA8bm8gZGVmYXVsdD4nJy4gIFNvbWUgb3B0aW9ucyBkZWZhdWx0IHRvIHRoZSBlbXB0eSBz
dHJpbmcsIHRoZXNlDQorYXJlIGxpc3RlZCB3aXRoIGBgPG5vbmU+JycuDQorKi8NCisNCisjIE9Q
VElPTlMNCisNCit7ICJhY2FwX2F1dGhuYW1lIiwgTlVMTCwgU1RSSU5HIH0NCisNCit7ICJhY2Fw
X2dldGF1dGgiLCBOVUxMLCBTVFJJTkcgfQ0KKw0KK3sgImFjYXBfcGFzc3dvcmQiLCBOVUxMLCBT
VFJJTkcgfQ0KKw0KK3sgImFjYXBfcmVhbG0iLCBOVUxMLCBTVFJJTkcgfQ0KKw0KK3sgImFjYXBf
c2VydmVyIiwgTlVMTCwgU1RSSU5HIH0NCisNCit7ICJhY2FwX3NlcnZlciIsIE5VTEwsIFNUUklO
RyB9DQorDQoreyAiYWNhcF91c2VybmFtZSIsIE5VTEwsIFNUUklORyB9DQorDQoreyAiYWRtaW5z
IiwgIiIsIFNUUklORyB9DQorLyogVGhlIGxpc3Qgb2YgdXNlcmlkcyB3aXRoIGFkbWluaXN0cmF0
aXZlIHJpZ2h0cy4gIFNlcGFyYXRlIGVhY2ggdXNlcmlkDQord2l0aCBhIHNwYWNlLiAgU2l0ZXMg
dXNpbmcgS2VyYmVyb3MgYXV0aGVudGljYXRpb24gbWF5IHVzZQ0KK3NlcGFyYXRlICJhZG1pbiIg
aW5zdGFuY2VzLg0KKy5QUA0KK05vdGUgdGhhdCBhY2NvdW50cyB1c2VkIGJ5IHVzZXJzIHNob3Vs
ZCBub3QgYmUgYWRtaW5pc3RyYXRvcnMuICBBZG1pbmlzdHJhdGl2ZSANCithY2NvdW50cyBzaG91
bGQgbm90IHJlY2VpdmUgbWFpbC4gIFRoYXQgaXMsIGlmIHVzZXIgImpiUm8iIGlzIGEgdXNlciBy
ZWFkaW5nDQorbWFpbCwgaGUgc2hvdWxkIG5vdCBhbHNvIGJlIGluIHRoZSBhZG1pbnMgbGluZS4g
IFNvbWUgcHJvYmxlbXMgbWF5IG9jY3VyDQorb3RoZXJ3aXNlLCBtb3N0IG5vdGFibHkgIHRoZSBh
YmlsaXR5IG9mIGFkbWluaXN0cmF0b3JzIHRvIGNyZWF0ZSB0b3AtbGV2ZWwNCittYWlsYm94ZXMg
dmlzaWJsZSB0byB1c2VycywgYnV0IG5vdCB3cml0YWJsZSBieSB1c2Vycy4gKi8NCisNCit7ICJj
b25maWdkaXJlY3RvcnkiLCBOVUxMLCBTVFJJTkcgfSANCisgICAvKiBUaGUgcGF0aG5hbWUgb2Yg
dGhlIElNQVAgY29uZmlndXJhdGlvbiBkaXJlY3RvcnkuICBUaGlzIGZpZWxkIGlzDQorICAgICAg
cmVxdWlyZWQuICovDQorDQoreyAiZGVmYXVsdGFjbCIsICJhbnlvbmUgbHJzIiwgU1RSSU5HIH0N
CisvKiBUaGUgQWNjZXNzIENvbnRyb2wgTGlzdCAoQUNMKSBwbGFjZWQgb24gYSBuZXdseS1jcmVh
dGVkIChub24tdXNlcikgDQorICAgbWFpbGJveCB0aGF0IGRvZXMgbm90IGhhdmUgYSBwYXJlbnQg
bWFpbGJveC4gKi8NCisNCit7ICJkZWZhdWx0cGFydGl0aW9uIiwgImRlZmF1bHQiLCBTVFJJTkcg
fSANCisgICAvKiBUaGUgcGFydGl0aW9uIG5hbWUgdXNlZCBieSBkZWZhdWx0IGZvciBuZXcgbWFp
bGJveGVzLiAqLw0KKw0KK3sgImRlbGV0ZXJpZ2h0IiwgImMiLCBTVFJJTkcgfQ0KKy8qIFRoZSBy
aWdodCB0aGF0IGEgdXNlciBuZWVkcyB0byBkZWxldGUgYSBtYWlsYm94LiAqLw0KKw0KK3sgImlk
bGVzb2NrZXQiLCAie2NvbmZpZ2RpcmVjdG9yeX0vc29ja2V0L2lkbGUiLCBTVFJJTkcgfQ0KKy8q
IFVuaXggZG9tYWluIHNvY2tldCB0aGF0IGlkbGVkIGxpc3RlbnMgb24uICovDQorDQoreyAibG10
cHNvY2tldCIsICJ7Y29uZmlnZGlyZWN0b3J5fS9zb2NrZXQvbG10cCIsIFNUUklORyB9DQorLyog
VW5peCBkb21haW4gc29ja2V0IHRoYXQgbG10cGQgbGlzdGVucyBvbiwgdXNlZCBieSBkZWxpdmVy
KDgpLiAqLw0KKw0KK3sgImxvZ2lucmVhbG1zIiwgIiIsIFNUUklORyB9DQorLyogVGhlIGxpc3Qg
b2YgcmVtb3RlIHJlYWxtcyB3aG9zZSB1c2VycyBtYXkgbG9nIGluIHVzaW5nIGNyb3NzLXJlYWxt
DQorICAgYXV0aGVudGljYXRpb25zLiAgU2VwZXJhdGUgZWFjaCByZWFsbSBuYW1lIGJ5IGEgc3Bh
Y2UuICAoQQ0KKyAgIGNyb3NzLXJlYWxtIGlkZW50aXR5IGlzIGNvbnNpZGVyZWQgYW55IGlkZW50
aXR5IHJldHVybmVkIGJ5IFNBU0wNCisgICB3aXRoIGFuICJAIiBpbiBpdC4pICovDQorDQoreyAi
bmV3c3ByZWZpeCIsIDAsIFNUUklORyB9DQorLyogUHJlZml4IHRvIGJlIHByZXBlbmRlZCB0byBu
ZXdzZ3JvdXAgbmFtZXMgdG8gbWFrZSB0aGUgY29ycmVzcG9uZGluZw0KKyAgIElNQVAgbWFpbGJv
eCBuYW1lcy4gKi8NCisNCit7ICJuZXdzc3Bvb2wiLCAwLCBTVFJJTkcgfQ0KKy8qIFRoZSBwYXRo
bmFtZSBvZiB0aGUgbmV3cyBzcG9vbCBkaXJlY3RvcnkuICBPbmx5IHVzZWQgaWYgdGhlDQorICAg
XGZCcGFydGl0aW9uLW5ld3NcZlIgY29uZmlndXJhdGlvbiBvcHRpb24gaXMgc2V0LiAqLw0KKw0K
K3sgIm5vdGlmeXNvY2tldCIsICJ7Y29uZmlnZGlyZWN0b3J5fS9zb2NrZXQvbm90aWZ5IiwgU1RS
SU5HIH0NCisvKiBVbml4IGRvbWFpbiBzb2NrZXQgdGhhdCB0aGUgbmV3IG1haWwgbm90aWZpY2F0
aW9uIGRhZW1vbiBsaXN0ZW5zIG9uLiAqLw0KKw0KKyMgeyAicGFydGl0aW9uLW5ld3MiLCAwLCBT
VFJJTkcgfQ0KKw0KK3sgInBvc3RtYXN0ZXIiLCAicG9zdG1hc3RlciIsIFNUUklORyB9DQorLyog
VXNlcm5hbWUgdGhhdCBpcyB1c2VkIGFzIHRoZSAnRnJvbScgYWRkcmVzcyBpbiByZWplY3Rpb24g
TUROcyBwcm9kdWNlZA0KKyAgIGJ5IHNpZXZlLiAqLw0KKw0KK3sgInBvc3RzcGVjIiwgTlVMTCwg
U1RSSU5HIH0NCisNCit7ICJwb3N0dXNlciIsICIiLCBTVFJJTkcgfQ0KKy8qIFVzZXJpZCB1c2Vk
IHRvIGRlbGl2ZXIgbWVzc2FnZXMgdG8gc2hhcmVkIGZvbGRlcnMuICBGb3IgZXhhbXBsZSwgaWYN
CisgICBzZXQgdG8gImJiIiwgZW1haWwgc2VudCB0byAiYmIrc2hhcmVkLmJsYWgiIHdvdWxkIGJl
IGRlbGl2ZXJlZCB0bw0KKyAgIHRoZSAic2hhcmVkLmJsYWgiIGZvbGRlci4gIEJ5IGRlZmF1bHQs
IGFuIGVtYWlsIGFkZHJlc3Mgb2YNCisgICAiK3NoYXJlZC5ibGFoIiB3b3VsZCBiZSB1c2VkLiAq
Lw0KKw0KK3sgInByb3h5X2F1dGhuYW1lIiwgInByb3h5IiwgU1RSSU5HIH0NCisNCit7ICJwcm94
eV9yZWFsbSIsIE5VTEwsIFNUUklORyB9DQorDQoreyAicHJveHlzZXJ2ZXJzIiwgTlVMTCwgU1RS
SU5HIH0NCisvKiBBIGxpc3Qgb2YgdXNlcnMgYW5kIGdyb3VwcyB0aGF0IGFyZSBhbGxvd2VkIHRv
IHByb3h5IGZvciBvdGhlcg0KKyAgIHVzZXJzLCBzZXBlcmF0ZWQgYnkgc3BhY2VzLiAgQW55IHVz
ZXIgbGlzdGVkIGluIHRoaXMgd2lsbCBiZQ0KKyAgIGFsbG93ZWQgdG8gbG9naW4gZm9yIGFueSBv
dGhlciB1c2VyOiB1c2Ugd2l0aCBjYXV0aW9uLiAqLw0KKw0KK3sgInNlbmRtYWlsIiwgIi91c3Iv
bGliL3NlbmRtYWlsIiwgU1RSSU5HIH0NCisvKiBUaGUgcGF0aG5hbWUgb2YgdGhlIHNlbmRtYWls
IGV4ZWN1dGFibGUuICBTaWV2ZSBpbnZva2VzIHNlbmRtYWlsDQorICAgZm9yIHNlbmRpbmcgcmVq
ZWN0aW9ucywgcmVkaXJlY3RzIGFuZCB2YWNhdGlvbiByZXNwb25zZXMuICovDQorDQoreyAic2Vy
dmVybmFtZSIsIE5VTEwsIFNUUklORyB9DQorLyogVGhpcyBpcyB0aGUgaG9zdG5hbWUgdmlzaWJs
ZSBpbiB0aGUgZ3JlZXRpbmcgbWVzc2FnZXMgb2YgdGhlIFBPUCwNCisgICBJTUFQIGFuZCBMTVRQ
IGRhZW1vbnMuIElmIGl0IGlzIHVuc2V0LCB0aGVuIHRoZSByZXN1bHQgcmV0dXJuZWQNCisgICBm
cm9tIGdldGhvc3RuYW1lKDIpIGlzIHVzZWQuICovDQorDQoreyAic2hhcmVkcHJlZml4IiwgIlNo
YXJlZCBGb2xkZXJzIiwgU1RSSU5HIH0NCisvKiBJZiB1c2luZyB0aGUgYWx0ZXJuYXRlIElNQVAg
bmFtZXNwYWNlLCB0aGUgcHJlZml4IGZvciB0aGUgc2hhcmVkDQorICAgbmFtZXNwYWNlLiAgVGhl
IGhpZXJhcmNoeSBkZWxpbWl0ZXIgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGFwcGVuZGVkLiAqLw0K
Kw0KK3sgInNpZXZlZGlyIiwgIi91c3Ivc2lldmUiLCBTVFJJTkcgfQ0KKy8qIElmIHNpZXZldXNl
aG9tZWRpciBpcyBmYWxzZSwgdGhpcyBkaXJlY3RvcnkgaXMgc2VhcmNoZWQgZm9yIFNpZXZlDQor
ICAgc2NyaXB0cy4gKi8NCisNCit7ICJzcnZ0YWIiLCAiIiwgU1RSSU5HIH0NCisvKiBUaGUgcGF0
aG5hbWUgb2YgXGZJc3J2dGFiXGZSIGZpbGUgY29udGFpbmluZyB0aGUgc2VydmVyJ3MgcHJpdmF0
ZQ0KKyAgIGtleS4gIFRoaXMgb3B0aW9uIGlzIHBhc3NlZCB0byB0aGUgU0FTTCBsaWJyYXJ5IGFu
ZCBvdmVycmlkZXMgaXRzDQorICAgZGVmYXVsdCBzZXR0aW5nLiAqLw0KKw0KK3sgInRsc19jYV9m
aWxlIiwgTlVMTCwgU1RSSU5HIH0NCisvKiBGaWxlIGNvbnRhaW5pbmcgb25lIG9yIG1vcmUgQ2Vy
dGlmaWNhdGUgQXV0aG9yaXR5IChDQSkgY2VydGlmaWNhdGVzLiAqLw0KKw0KK3sgInRsc19jYV9w
YXRoIiwgTlVMTCwgU1RSSU5HIH0NCisvKiBQYXRoIHRvIGRpcmVjdG9yeSB3aXRoIGNlcnRpZmlj
YXRlcyBvZiBDQXMuICBUaGlzIGRpcmVjdG9yeSBtdXN0DQorICAgaGF2ZSBmaWxlbmFtZXMgd2l0
aCB0aGUgaGFzaGVkIHZhbHVlIG9mIHRoZSBjZXJ0aWZpY2F0ZSAoc2VlDQorICAgb3BlbnNzbChY
WFgpKS4gKi8NCisNCit7ICJ0bHNfY2VydF9maWxlIiwgTlVMTCwgU1RSSU5HIH0NCisvKiBGaWxl
IGNvbnRhaW5pbmcgdGhlIGNlcnRpZmljYXRlIHByZXNlbnRlZCBmb3Igc2VydmVyIGF1dGhlbnRp
Y2F0aW9uDQorICAgZHVyaW5nIFNUQVJUVExTLiAgQSB2YWx1ZSBvZiAiZGlzYWJsZWQiIHdpbGwg
ZGlzYWJsZSBTU0wvVExTLiAqLw0KKw0KK3sgInRsc19rZXlfZmlsZSIsIE5VTEwsIFNUUklORyB9
DQorLyogRmlsZSBjb250YWluaW5nIHRoZSBwcml2YXRlIGtleSBiZWxvbmdpbmcgdG8gdGhlIHNl
cnZlcg0KKyAgIGNlcnRpZmljYXRlLiAgQSB2YWx1ZSBvZiAiZGlzYWJsZWQiIHdpbGwgZGlzYWJs
ZSBTU0wvVExTLiAqLw0KKw0KK3sgInVtYXNrIiwgIjA3NyIsIFNUUklORyB9DQorLyogVGhlIHVt
YXNrIHZhbHVlIHVzZWQgYnkgdmFyaW91cyBDeXJ1cyBJTUFQIHByb2dyYW1zLiAqLw0KKw0KK3sg
InVzZXJwcmVmaXgiLCAiT3RoZXIgVXNlcnMiLCBTVFJJTkcgfQ0KKy8qIElmIHVzaW5nIHRoZSBh
bHRlcm5hdGUgSU1BUCBuYW1lc3BhY2UsIHRoZSBwcmVmaXggZm9yIHRoZSBvdGhlciB1c2Vycw0K
KyAgIG5hbWVzcGFjZS4gIFRoZSBoaWVyYXJjaHkgZGVsaW1pdGVyIHdpbGwgYmUgYXV0b21hdGlj
YWxseSBhcHBlbmRlZC4gKi8NCisNCit7ICJwcm94eV9wYXNzd29yZCIsIE5VTEwsIFNUUklORyB9
DQorDQoreyAiYWNhcF9yZXRyeV90aW1lb3V0IiwgNjAsIElOVCB9DQorDQoreyAiYXV0b2NyZWF0
ZXF1b3RhIiwgMCwgSU5UIH0NCisvKiBJZiBub256ZXJvLCBub3JtYWwgdXNlcnMgbWF5IGNyZWF0
ZSB0aGVpciBvd24gSU1BUCBhY2NvdW50cyBieQ0KKyAgIGNyZWF0aW5nIHRoZSBtYWlsYm94IElO
Qk9YLiAgVGhlIHVzZXIncyBxdW90YSBpcyBzZXQgdG8gdGhlIHZhbHVlDQorICAgaWYgaXQgaXMg
cG9zaXRpdmUsIG90aGVyd2lzZSB0aGUgdXNlciBoYXMgdW5saW1pdGVkIHF1b3RhLiAqLw0KKw0K
K3sgImltYXBpZGxlcG9sbCIsIDYwLCBJTlQgfQ0KKy8qIFRoZSBpbnRlcnZhbCAoaW4gc2Vjb25k
cykgZm9yIHBvbGxpbmcgdGhlIG1haWxib3ggZm9yIGNoYW5nZXMgd2hpbGUNCisgICBydW5uaW5n
IHRoZSBJRExFIGNvbW1hbmQuICBUaGlzIG9wdGlvbiBpcyB1c2VkIHdoZW4gaWRsZWQgY2FuIG5v
dA0KKyAgIGJlIGNvbnRhY3RlZCBvciB3aGVuIHBvbGxpbmcgaXMgdXNlZCBleGNsdXNpdmVseS4g
IFRoZSBtaW5pbXVtDQorICAgdmFsdWUgaXMgMS4gIEEgdmFsdWUgb2YgMCB3aWxsIGRpc2FibGUg
cG9sbGluZyAoYW5kIGRpc2FibGUgSURMRSBpZg0KKyAgIHBvbGxpbmcgaXMgdGhlIG9ubHkgbWV0
aG9kIGF2YWlsYWJsZSkuICovDQorDQoreyAibWF4bWVzc2FnZXNpemUiLCAwLCBJTlQgfQ0KKy8q
IE1heGltdW0gaW5jb21pbmcgTE1UUCBtZXNzYWdlIHNpemUuICBJZiBub24temVybywgbG10cGQg
d2lsbCByZWplY3QNCisgICBtZXNzYWdlcyBsYXJnZXIgdGhhbiBcZkltYXhtZXNzYWdlc2l6ZVxm
UiBieXRlcy4gIFRoZSBkZWZhdWx0IGlzIHRvDQorICAgYWxsb3cgbWVzc2FnZXMgb2YgYW55IHNp
emUuICovDQorDQoreyAicGxhaW50ZXh0bG9naW5wYXVzZSIsIDAsIElOVCB9DQorLyogTnVtYmVy
IG9mIHNlY29uZHMgdG8gcGF1c2UgYWZ0ZXIgYSBzdWNjZXNzZnVsIHBsYWludGV4dCBsb2dpbi4g
IEZvcg0KKyAgIHN5c3RlbXMgdGhhdCBzdXBwb3J0IHN0cm9uZyBhdXRoZW50aWNhdGlvbiwgdGhp
cyBwZXJtaXRzIHVzZXJzIHRvDQorICAgcGVyY2VpdmUgYSBjb3N0IG9mIHVzaW5nIHBsYWludGV4
dCBwYXNzd29yZHMuICAoVGhpcyBkb2VzIG5vdA0KKyAgIGVmZmVjdCB0aGUgdXNlIG9mIFBMQUlO
IGluIFNBU0wgYXV0aGVudGljYXRpb25zLikgKi8NCisNCit7ICJwb3BleHBpcmV0aW1lIiwgLTEs
IElOVCB9DQorLyogVGhlIG51bWJlciBvZiBkYXlzIGFkdmVydGlzZWQgYXMgYmVpbmcgdGhlIG1p
bmltdW0gYSBtZXNzYWdlIG1heSBiZQ0KKyAgIGxlZnQgb24gdGhlIFBPUCBzZXJ2ZXIgYmVmb3Jl
IGl0IGlzIGRlbGV0ZWQgKHZpYSB0aGUgQ0FQQSBjb21tYW5kLA0KKyAgIGRlZmluZWQgaW4gdGhl
IFBPUDMgRXh0ZW5zaW9uIE1lY2hhbmlzbSwgd2hpY2ggc29tZSBjbGllbnRzIG1heQ0KKyAgIHN1
cHBvcnQpLiAgIk5FVkVSIiwgdGhlIGRlZmF1bHQsIG1heSBiZSBzcGVjaWZpZWQgd2l0aCBhIG5l
Z2F0aXZlDQorICAgbnVtYmVyLiAgVGhlIEN5cnVzIFBPUDMgc2VydmVyIG5ldmVyIGRlbGV0ZXMg
bWFpbCwgbm8gbWF0dGVyIHdoYXQNCisgICB0aGUgdmFsdWUgb2YgdGhpcyBwYXJhbWV0ZXIgaXMu
ICBIb3dldmVyLCBpZiBhIHNpdGUgaW1wbGVtZW50cyBhDQorICAgbGVzcyBsaWJlcmFsIHBvbGlj
eSwgaXQgbmVlZHMgdG8gY2hhbmdlIHRoaXMgcGFyYW1ldGVyDQorICAgYWNjb3JkaW5nbHkuICov
DQorDQoreyAicG9wbWlucG9sbCIsIDAsIElOVCB9DQorLyogU2V0IHRoZSBtaW5pbXVtIGFtb3Vu
dCBvZiB0aW1lIHRoZSBzZXJ2ZXIgZm9yY2VzIHVzZXJzIHRvIHdhaXQNCisgICBiZXR3ZWVuIHN1
Y2Nlc3NpdmUgUE9QIGxvZ2lucywgaW4gbWludXRlcy4gIFRoZSBkZWZhdWx0IGlzIDAuICovDQor
DQoreyAicG9wdGltZW91dCIsIDEwLCBJTlQgfQ0KKy8qIFNldCB0aGUgbGVuZ3RoIG9mIHRoZSBQ
T1Agc2VydmVyJ3MgaW5hY3Rpdml0eSBhdXRvbG9nb3V0IHRpbWVyLA0KKyAgIGluIG1pbnV0ZXMu
ICBUaGUgbWluaW11bSB2YWx1ZSBpcyAxMCwgdGhlIGRlZmF1bHQuICovDQorDQoreyAicXVvdGF3
YXJuIiwgOTAsIElOVCB9DQorLyogVGhlIHBlcmNlbnQgb2YgcXVvdGEgdXRpbGl6YXRpb24gb3Zl
ciB3aGljaCB0aGUgc2VydmVyIGdlbmVyYXRlcw0KKyAgIHdhcm5pbmdzLiAqLw0KKw0KK3sgInNh
c2xfbWF4aW11bV9sYXllciIsIDI1NiwgSU5UIH0NCisvKiBNYXhpbXVtIFNTRiAoc2VjdXJpdHkg
c3RyZW5ndGggZmFjdG9yKSB0aGF0IHRoZSBzZXJ2ZXIgd2lsbCBhbGxvdyBhDQorICAgY2xpZW50
IHRvIG5lZ290aWF0ZS4gKi8NCisNCit7ICJzYXNsX21pbmltdW1fbGF5ZXIiLCAwLCBJTlQgfQ0K
Ky8qIFRoZSBtaW5pbXVtIFNTRiB0aGF0IHRoZSBzZXJ2ZXIgd2lsbCBhbGxvdyBhIGNsaWVudCB0
byBuZWdvdGlhdGUuDQorICAgQSB2YWx1ZSBvZiAxIHJlcXVpcmVzIGludGVncml0eSBwcm90ZWN0
aW9uOyBhbnkgaGlnaGVyIHZhbHVlDQorICAgcmVxdWlyZXMgc29tZSBhbW91bnQgb2YgZW5jcnlw
dGlvbi4gKi8NCisNCit7ICJ0aW1lb3V0IiwgMzAsIElOVCB9DQorLyogVGhlIGxlbmd0aCBvZiB0
aGUgSU1BUCBzZXJ2ZXIncyBpbmFjdGl2aXR5IGF1dG9sb2dvdXQgdGltZXIsDQorICAgaW4gbWlu
dXRlcy4gIFRoZSBtaW5pbXVtIHZhbHVlIGlzIDMwLCB0aGUgZGVmYXVsdC4gKi8NCisNCit7ICJ0
bHNfc2Vzc2lvbl90aW1lb3V0IiwgMTQ0MCwgSU5UIH0NCisvKiBUaGUgbGVuZ3RoIG9mIHRpbWUg
KGluIG1pbnV0ZXMpIHRoYXQgYSBUTFMgc2Vzc2lvbiB3aWxsIGJlIGNhY2hlZA0KKyAgIGZvciBs
YXRlciByZXVzZS4gIFRoZSBtYXhpbXVtIHZhbHVlIGlzIDE0NDAgKDI0IGhvdXJzKSwgdGhlDQor
ICAgZGVmYXVsdC4gIEEgdmFsdWUgb2YgMCB3aWxsIGRpc2FibGUgc2Vzc2lvbiBjYWNoaW5nLiAq
Lw0KKw0KK3sgImFsbG93YWxsc3Vic2NyaWJlIiwgMCwgU1dJVENIIH0NCisNCit7ICJhbGxvd2Fu
b255bW91c2xvZ2luIiwgMCwgU1dJVENIIH0NCisvKiBQZXJtaXQgbG9naW5zIGJ5IHRoZSB1c2Vy
ICJhbm9ueW1vdXMiIHVzaW5nIGFueSBwYXNzd29yZC4gIEFsc28NCisgICBhbGxvd3MgdXNlIG9m
IHRoZSBTQVNMIEFOT05ZTU9VUyBtZWNoYW5pc20uICovDQorDQoreyAiYWxsb3dwbGFpbnRleHQi
LCAxLCBTV0lUQ0ggfQ0KKy8qIEFsbG93IHRoZSB1c2Ugb2YgdGhlIFNBU0wgUExBSU4gbWVjaGFu
aXNtLiAqLw0KKw0KK3sgImFsdG5hbWVzcGFjZSIsIDAsIFNXSVRDSCB9DQorLyoNCitVc2UgdGhl
IGFsdGVybmF0ZSBJTUFQIG5hbWVzcGFjZSwgd2hlcmUgcGVyc29uYWwgZm9sZGVycyByZXNpZGUg
YXQgdGhlDQorc2FtZSBsZXZlbCBpbiB0aGUgaGllcmFyY2h5IGFzIElOQk9YLg0KKy5icg0KKy5z
cA0KK1RoaXMgb3B0aW9uIE9OTFkgYXBwbGllcyB3aGVyZSBpbnRlcmFjdGlvbiB0YWtlcyBwbGFj
ZSB3aXRoIHRoZQ0KK2NsaWVudC91c2VyLiAgQ3VycmVudGx5IHRoaXMgaXMgbGltaXRlZCB0byB0
aGUgSU1BUCBwcm90b2NvbCAoaW1hcGQpDQorYW5kIFNpZXZlIHNjcmlwdHMgKGxtdHBkKS4gIFRo
aXMgb3B0aW9uIGRvZXMgTk9UIGFwcGx5IHRvIGFkbWluIHRvb2xzDQorc3VjaCBhcyBjeXJhZG0g
KGFkbWlucyBPTkxZKSwgcmVjb25zdHJ1Y3QsIHF1b3RhLCBldGMuLCBOT1IgZG9lcyBpdA0KK2Fm
ZmVjdCBMTVRQIGRlbGl2ZXJ5IG9mIG1lc3NhZ2VzIGRpcmVjdGx5IHRvIG1haWxib3hlcyB2aWEg
cGx1cy1hZGRyZXNzaW5nLg0KKyovDQorDQoreyAiZHVwbGljYXRlc3VwcHJlc3Npb24iLCAxLCBT
V0lUQ0ggfQ0KKy8qIElmIGVuYWJsZWQsIGxtdHBkIHdpbGwgc3VwcHJlc3MgZGVsaXZlcnkgb2Yg
YSBtZXNzYWdlIHRvIGEgbWFpbGJveCBpZg0KK2EgbWVzc2FnZSB3aXRoIHRoZSBzYW1lIG1lc3Nh
Z2UtaWQgKG9yIHJlc2VudC1tZXNzYWdlLWlkKSBpcyByZWNvcmRlZA0KK2FzIGhhdmluZyBhbHJl
YWR5IGJlZW4gZGVsaXZlcmVkIHRvIHRoZSBtYWlsYm94LiAgUmVjb3JkcyB0aGUgbWFpbGJveA0K
K2FuZCBtZXNzYWdlLWlkL3Jlc2VudC1tZXNzYWdlLWlkIG9mIGFsbCBzdWNjZXNzZnVsIGRlbGl2
ZXJpZXMuDQorLmJyDQorLnNwDQorTm90ZSB0aGF0IGR1cGxpY2F0ZSBkZWxpdmVyeSBzdXBwcmVz
c2lvbiBpcyByZXF1aXJlZCBmb3IgU2lldmUuDQorRGlzYWJsaW5nIGR1cGxpY2F0ZSBkZWxpdmVy
eSBzdXBwcmVzc2lvbiB3aWxsIGFsc28gZGlzYWJsZSBTaWV2ZSwgYW5kDQorYXMgc3VjaCBzaG91
bGQgb25seSBiZSBkaXNhYmxlZCBmb3IgcGVyZm9ybWFuY2UgcmVhc29ucy4gKi8NCisNCit7ICJo
YXNoaW1hcHNwb29sIiwgMCwgU1dJVENIIH0NCisvKiBJZiBlbmFibGVkLCB0aGUgcGFydGl0aW9u
cyB3aWxsIGFsc28gYmUgaGFzaGVkLCBpbiBhZGRpdGlvbiB0byB0aGUNCisgICBoYXNoaW5nIGRv
bmUgb24gY29uZmlndXJhdGlvbiBkaXJlY3Rvcmllcy4gIFRoaXMgaXMgcmVjb21tZW5kZWQgaWYN
CisgICBvbmUgcGFydGl0aW9uIGhhcyBhIHZlcnkgYnVzaHkgbWFpbGJveCB0cmVlLiAqLw0KKw0K
K3sgImlnbm9yZXJlZmVyZW5jZSIsIDAsIFNXSVRDSCB9DQorDQoreyAiaW1hcGlkcmVzcG9uc2Ui
LCAxLCBTV0lUQ0ggfQ0KKy8qIElmIGVuYWJsZWQsIHRoZSBzZXJ2ZXIgcmVzcG9uZHMgdG8gYW4g
SUQgY29tbWFuZCB3aXRoIGEgcGFyYW1ldGVyDQorICAgbGlzdCBjb250YWluaW5nOiB2ZXJzaW9u
LCB2ZW5kb3IsIHN1cHBvcnQtdXJsLCBvcywgb3MtdmVyc2lvbiwNCisgICBjb21tYW5kLCBhcmd1
bWVudHMsIGVudmlyb25tZW50LiAgT3RoZXJ3aXNlIHRoZSBzZXJ2ZXIgcmV0dXJucyBOSUwuICov
DQorDQoreyAibG9naW51c2VhY2wiLCAwLCBTV0lUQ0ggfQ0KKy8qIElmIGVuYWJsZWQsIGFueSBh
dXRoZW50aWNhdGlvbiBpZGVudGl0eSB3aGljaCBoYXMgXGZCYVxmUiByaWdodHMgb24gYQ0KKyAg
IHVzZXIncyBJTkJPWCBtYXkgbG9nIGluIGFzIHRoYXQgdXNlci4gKi8NCisNCit7ICJyZWplY3Q4
Yml0IiwgMCwgU1dJVENIIH0NCisvKiBJZiBlbmFibGVkLCBsbXRwZCByZWplY3RzIG1lc3NhZ2Vz
IHdpdGggOC1iaXQgY2hhcmFjdGVycyBpbiB0aGUNCisgICBoZWFkZXJzLiAgT3RoZXJ3aXNlLCA4
LWJpdCBjaGFyYWN0ZXJzIGFyZSBjaGFuZ2VkIHRvIGBYJy4gIChBDQorICAgcHJvcGVyIHNvdWx0
aW9uIHRvIG5vbi1BU0NJSSBjaGFyYWN0ZXJzIGluIGhlYWRlcnMgaXMgb2ZmZXJlZCBieQ0KKyAg
IFJGQyAyMDQ3IGFuZCBpdHMgcHJlZGVjZXNzb3JzLikgKi8NCisNCit7ICJzaWV2ZXVzZWhvbWVk
aXIiLCAwLCBTV0lUQ0ggfQ0KKy8qIElmIGVuYWJsZWQsIGxtdHBkIHdpbGwgbG9vayBmb3IgU2ll
dmUgc2NyaXB0cyBpbiB1c2VyJ3MgaG9tZQ0KKyAgIGRpcmVjdG9yaWVzOiB+dXNlci8uc2lldmUu
ICovDQorDQoreyAic2luZ2xlaW5zdGFuY2VzdG9yZSIsIDEsIFNXSVRDSCB9DQorLyogSWYgZW5h
YmxlZCwgbG10cGQgYXR0ZW1wdHMgdG8gb25seSB3cml0ZSBvbmUgY29weSBvZiBhIG1lc3NhZ2Ug
cGVyDQorICAgcGFydGl0aW9uIGFuZCBjcmVhdGUgaGFyZCBsaW5rcywgcmVzdWx0aW5nIGluIGEg
cG90ZW50aWFsbHkgbGFyZ2UNCisgICBkaXNrIHNhdmluZ3MuICovDQorDQoreyAidW5peGhpZXJh
cmNoeXNlcCIsIDAsIFNXSVRDSCB9DQorICAgLyogVXNlIHRoZSBVTklYIHNlcGFyYXRvciBjaGFy
YWN0ZXIgJy8nIGZvciBkZWxpbWl0aW5nIGxldmVscyBvZg0KKyAgICAgIG1haWxib3ggaGllcmFy
Y2h5LiAgVGhlIGRlZmF1bHQgaXMgdG8gdXNlIHRoZSBuZXRuZXdzIHNlcGFyYXRvcg0KKyAgICAg
IGNoYXJhY3RlciAnLicuICovDQorDQoreyAibmV0c2NhcGV1cmwiLCAiaHR0cDovL2FuZHJldzIu
YW5kcmV3LmNtdS5lZHUvY3lydXMvaW1hcGQvbmV0c2NhcGUtYWRtaW4uaHRtbCIsIFNUUklORyB9
DQorLyogSWYgZW5hYmxlZCBhdCBjb21waWxlIHRpbWUsIHRoaXMgc3BlY2lmaWVzIGEgVVJMIHRv
IHJlcGx5IHdoZW4NCisgICBOZXRzY2FwZSBhc2tzIHRoZSBzZXJ2ZXIgd2hlcmUgdGhlIG1haWwg
YWRtaW5pc3RyYXRpb24gSFRUUCBzZXJ2ZXINCisgICBpcy4gIFRoZSBkZWZhdWx0IGlzIGEgc2l0
ZSBhdCBDTVUgd2l0aCBhIGhvcGVmdWxseSBpbmZvcm1hdGl2ZQ0KKyAgIG1lc3NhZ2U7IGFkbWlu
aXN0cmF0b3JzIHNob3VsZCBzZXQgdGhpcyB0byBhIGxvY2FsIHJlc291cmNlIHdpdGgNCisgICBz
b21lIGluZm9ybWF0aW9uIG9mIGdyZWF0ZXIgdXNlLiAqLw0KKw0KK3sgInNpZXZlX21heHNjcmlw
dHNpemUiLCAzMiwgSU5UIH0NCisvKiBNYXhpbXVtIHNpemUgKGluIGtpbG9ieXRlcykgYW55IHNp
ZXZlIHNjcmlwdCBjYW4gYmUsIGVuZm9yY2VkIGF0DQorICAgc3VibWlzc2lvbiBieSB0aW1zaWV2
ZWQoOCkuICovDQorDQoreyAic2lldmVfbWF4c2NyaXB0cyIsIDUsIElOVCB9DQorLyogTWF4aW11
bSBudW1iZXIgb2Ygc2lldmUgc2NyaXB0cyBhbnkgdXNlciBtYXkgaGF2ZSwgZW5mb3JjZWQgYXQN
CisgICBzdWJtaXNzaW9uIGJ5IHRpbXNpZXZlZCg4KS4gKi8NCisNCisjIG5leHQgZmV3IGNvbW1l
bnRlZCBvdXQgc2luY2Ugd2Ugd2FudCB0byBwYXNzICdlbSB0aHJvdWdoDQorIyB0byBsaWJzYXNs
DQorIyB7ICJzYXNsX3B3Y2hlY2tfbWV0aG9kIiwgInNhc2xkYiIsIFNUUklORyB9DQorLyogVGhl
IG1lY2hhbmlzbSB1c2VkIGJ5IHRoZSBzZXJ2ZXIgdG8gdmVyaWZ5IHBsYWludGV4dCBwYXNzd29y
ZHMuDQorICAgUG9zc2libGUgdmFsdWVzIGluY2x1ZGUgInNhc2xkYiIsICJzYXNsYXV0aGQiLCBh
bmQgInB3Y2hlY2siLiAqLw0KKw0KKyMgeyAic2FzbF9hdXRvX3RyYW5zaXRpb24iLCAwLCBTV0lU
Q0ggfQ0KKy8qIElmIGVuYWJsZWQsIHRoZSBTQVNMIGxpYnJhcnkgd2lsbCBhdXRvbWF0aWNhbGx5
IGNyZWF0ZSBhdXRoZW50aWNhdGlvbg0KKyAgIHNlY3JldHMgd2hlbiBnaXZlbiBhIHBsYWludGV4
dCBwYXNzd29yZC4gIFNlZSB0aGUgU0FTTCBkb2N1bWVudGF0aW9uLiAqLw0KKw0KKy8qIA0KKy5T
SCBTRUUgQUxTTw0KKy5QUA0KK1xmQmltYXBkKDgpXGZSLCBcZkJwb3AzZCg4KVxmUiwgXGZCbG10
cGQoOClcZlIsIFxmQnRpbXNpZXZlZCg4KVxmUiwNCitcZkJpZGxlZCg4KVxmUiwgXGZCZGVsaXZl
cig4KVxmUiwgXGZCbWFzdGVyKDgpXGZSDQorKi8NCisNCkluZGV4OiBpbWFwL2xtdHBkLmMNCj09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0NClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5
cnVzL2ltYXAvbG10cGQuYyx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuOTgNCmRpZmYgLXUgLXIx
Ljk4IGxtdHBkLmMNCi0tLSBsbXRwZC5jCTIwMDIvMDYvMDMgMTg6MjI6MjYJMS45OA0KKysrIGxt
dHBkLmMJMjAwMi8wNi8xNCAxNzowNTowNw0KQEAgLTE5NCw3ICsxOTQsNyBAQA0KICAgICAvKiBj
aGVjayBpZiByZW1vdGUgcmVhbG0gKi8NCiAgICAgaWYgKChyZWFsbSA9IHN0cmNocihhdXRoX2lk
ZW50aXR5LCAnQCcpKSE9TlVMTCkgew0KIAlyZWFsbSsrOw0KLQl2YWwgPSBjb25maWdfZ2V0c3Ry
aW5nKCJsb2dpbnJlYWxtcyIsICIiKTsNCisJdmFsID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BU
X0xPR0lOUkVBTE1TKTsNCiAJd2hpbGUgKCp2YWwpIHsNCiAJICAgIGlmICghc3RybmNhc2VjbXAo
dmFsLCByZWFsbSwgc3RybGVuKHJlYWxtKSkgJiYNCiAJCSghdmFsW3N0cmxlbihyZWFsbSldIHx8
IGlzc3BhY2UoKGludCkgdmFsW3N0cmxlbihyZWFsbSldKSkpIHsNCkBAIC0yMTUsNyArMjE1LDcg
QEANCiAgICAgICogZm9yIG5vdyBvbmx5IGFkbWlucyBjYW4gZG8gbG10cCBmcm9tIGFub3RoZXIg
bWFjaGluZQ0KICAgICAgKi8NCiAgICAgYXV0aHN0YXRlID0gYXV0aF9uZXdzdGF0ZShhdXRoX2lk
ZW50aXR5LCBOVUxMKTsNCi0gICAgYWxsb3dlZCA9IGF1dGhpc2EoYXV0aHN0YXRlLCAibG10cCIs
ICJhZG1pbnMiKTsNCisgICAgYWxsb3dlZCA9IGNvbmZpZ19hdXRoaXNhKGF1dGhzdGF0ZSwgSU1B
UE9QVF9BRE1JTlMpOw0KICAgICBhdXRoX2ZyZWVzdGF0ZShhdXRoc3RhdGUpOw0KICAgICANCiAg
ICAgaWYgKCFhbGxvd2VkKSB7DQpAQCAtMjQwLDcgKzI0MCw2IEBADQogew0KICAgICBpbnQgcjsN
CiANCi0gICAgY29uZmlnX2NoYW5nZWlkZW50KCJsbXRwZCIpOw0KICAgICBpZiAoZ2V0ZXVpZCgp
ID09IDApIHJldHVybiAxOw0KICAgICANCiAgICAgc2lnbmFsc19zZXRfc2h1dGRvd24oJnNodXRf
ZG93bik7DQpAQCAtMjQ4LDkgKzI0Nyw5IEBADQogICAgIHNpZ25hbChTSUdQSVBFLCBTSUdfSUdO
KTsNCiANCiAjaWZkZWYgVVNFX1NJRVZFDQotICAgIHNpZXZlX3VzZWhvbWVkaXIgPSBjb25maWdf
Z2V0c3dpdGNoKCJzaWV2ZXVzZWhvbWVkaXIiLCAwKTsNCisgICAgc2lldmVfdXNlaG9tZWRpciA9
IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9TSUVWRVVTRUhPTUVESVIpOw0KICAgICBpZiAoIXNp
ZXZlX3VzZWhvbWVkaXIpIHsNCi0Jc2lldmVfZGlyID0gY29uZmlnX2dldHN0cmluZygic2lldmVk
aXIiLCAiL3Vzci9zaWV2ZSIpOw0KKwlzaWV2ZV9kaXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBP
UFRfU0lFVkVESVIpOw0KICAgICB9IGVsc2Ugew0KIAlzaWV2ZV9kaXIgPSBOVUxMOw0KICAgICB9
DQpAQCAtMjYyLDggKzI2MSw4IEBADQogICAgIHNldHVwX3NpZXZlKCk7DQogI2VuZGlmIC8qIFVT
RV9TSUVWRSAqLw0KIA0KLSAgICBzaW5nbGVpbnN0YW5jZSA9IGNvbmZpZ19nZXRzd2l0Y2goInNp
bmdsZWluc3RhbmNlc3RvcmUiLCAxKTsNCi0gICAgQkIgPSBjb25maWdfZ2V0c3RyaW5nKCJwb3N0
dXNlciIsIEJCKTsNCisgICAgc2luZ2xlaW5zdGFuY2UgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBP
UFRfU0lOR0xFSU5TVEFOQ0VTVE9SRSk7DQorICAgIEJCID0gY29uZmlnX2dldHN0cmluZyhJTUFQ
T1BUX1BPU1RVU0VSKTsNCiANCiAgICAgaWYgKChyID0gc2FzbF9zZXJ2ZXJfaW5pdChteXNhc2xf
Y2IsICJDeXJ1cyIpKSAhPSBTQVNMX09LKSB7DQogCXN5c2xvZyhMT0dfRVJSLCAiU0FTTCBmYWls
ZWQgaW5pdGlhbGl6aW5nOiBzYXNsX3NlcnZlcl9pbml0KCk6ICVzIiwgDQpAQCAtMjcxLDEyICsy
NzAsMjMgQEANCiAJcmV0dXJuIEVDX1NPRlRXQVJFOw0KICAgICB9DQogDQorPDw8PDw8PCBsbXRw
ZC5jDQorICAgIGR1cGVsaW0gPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfRFVQTElDQVRFU1VQ
UFJFU1NJT04pOw0KKyAgICBpZiAoZHVwZWxpbSkgew0KKwkvKiBpbml0aWFsaXplIGR1cGxpY2F0
ZSBkZWxpdmVyeSBkYXRhYmFzZSAqLw0KKwlpZiAoZHVwbGljYXRlX2luaXQoTlVMTCwgMCkgIT0g
MCkgew0KKwkgICAgc3lzbG9nKExPR19FUlIsIA0KKwkJICAgImxtdHBkOiB1bmFibGUgdG8gaW5p
dCBkdXBsaWNhdGUgZGVsaXZlcnkgZGF0YWJhc2VcbiIpOw0KKwkgICAgZHVwZWxpbSA9IDA7DQor
CX0NCis9PT09PT09DQogICAgIGR1cGVsaW0gPSBjb25maWdfZ2V0c3dpdGNoKCJkdXBsaWNhdGVz
dXBwcmVzc2lvbiIsIDEpOw0KICAgICAvKiBpbml0aWFsaXplIGR1cGxpY2F0ZSBkZWxpdmVyeSBk
YXRhYmFzZSAqLw0KICAgICBpZiAoZHVwbGljYXRlX2luaXQoTlVMTCwgMCkgIT0gMCkgew0KIAlz
eXNsb2coTE9HX0VSUiwgDQogCSAgICAgICAibG10cGQ6IHVuYWJsZSB0byBpbml0IGR1cGxpY2F0
ZSBkZWxpdmVyeSBkYXRhYmFzZVxuIik7DQogCWR1cGVsaW0gPSBoYXZlX2R1cGRiID0gMDsNCis+
Pj4+Pj4+IDEuOTgNCiAgICAgfQ0KIA0KICAgICAvKiBzbyB3ZSBjYW4gZG8gbWJveGxpc3Qgb3Bl
cmF0aW9ucyAqLw0KQEAgLTQxOSw2ICs0MjksMTUgQEANCiAgICAgfQ0KIH0NCiANCis8PDw8PDw8
IGxtdHBkLmMNCisjZGVmaW5lIERFRkFVTFRfU0VORE1BSUwgKCIvdXNyL2xpYi9zZW5kbWFpbCIp
DQorI2RlZmluZSBERUZBVUxUX1BPU1RNQVNURVIgKCJwb3N0bWFzdGVyIikNCisNCisjZGVmaW5l
IFNFTkRNQUlMIChjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU0VORE1BSUwpKQ0KKyNkZWZpbmUg
UE9TVE1BU1RFUiAoY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1BPU1RNQVNURVIpKQ0KKw0KKz09
PT09PT0NCis+Pj4+Pj4+IDEuODcNCiBzdGF0aWMgaW50IGdsb2JhbF9vdXRnb2luZ19jb3VudCA9
IDA7DQogDQogcGlkX3Qgb3Blbl9zZW5kbWFpbChjb25zdCBjaGFyICphcmd2W10sIEZJTEUgKipz
bSkNCkBAIC03OTAsMTMgKzgwOSwyNyBAQA0KIAkJCXZvaWQgKm1jIF9fYXR0cmlidXRlX18oKHVu
dXNlZCkpLA0KIAkJCWNvbnN0IGNoYXIgKiplcnJtc2cgX19hdHRyaWJ1dGVfXygodW51c2VkKSkp
DQogew0KKzw8PDw8PDwgbG10cGQuYw0KKyAgICBzaWV2ZV9ub3RpZnlfY29udGV4dF90ICpuYyA9
IChzaWV2ZV9ub3RpZnlfY29udGV4dF90ICopIGFjOw0KKyAgICBzY3JpcHRfZGF0YV90ICpzZCA9
IChzY3JpcHRfZGF0YV90ICopIHNjcmlwdF9jb250ZXh0Ow0KKw0KKyAgICBzbm1wX2luY3JlbWVu
dChTSUVWRV9OT1RJRlksIDEpOw0KKz09PT09PT0NCiAgICAgY29uc3QgY2hhciAqbm90aWZpZXIg
PSBjb25maWdfZ2V0c3RyaW5nKCJzaWV2ZW5vdGlmaWVyIiwgTlVMTCk7DQogDQogICAgIGlmIChu
b3RpZmllcikgew0KIAlzaWV2ZV9ub3RpZnlfY29udGV4dF90ICpuYyA9IChzaWV2ZV9ub3RpZnlf
Y29udGV4dF90ICopIGFjOw0KIAlzY3JpcHRfZGF0YV90ICpzZCA9IChzY3JpcHRfZGF0YV90ICop
IHNjcmlwdF9jb250ZXh0Ow0KIAlpbnQgbm9wdCA9IDA7DQorPj4+Pj4+PiAxLjk4DQogDQorPDw8
PDw8PCBsbXRwZC5jDQorICAgIG5vdGlmeSgiU0lFVkUiLA0KKwkgICBuYy0+cHJpb3JpdHksDQor
CSAgIHNkLT51c2VybmFtZSwNCisJICAgTlVMTCwNCisJICAgbmMtPm1lc3NhZ2UpOw0KKz09PT09
PT0NCiAJc25tcF9pbmNyZW1lbnQoU0lFVkVfTk9USUZZLCAxKTsNCiANCiAJLyogY291bnQgb3B0
aW9ucyAqLw0KQEAgLTgwNiw2ICs4MzksNyBAQA0KIAkgICAgICAgIlNJRVZFIiwgbmMtPnByaW9y
aXR5LCBzZC0+dXNlcm5hbWUsIE5VTEwsDQogCSAgICAgICBub3B0LCBuYy0+b3B0aW9ucywgbmMt
Pm1lc3NhZ2UpOw0KICAgICB9DQorPj4+Pj4+PiAxLjk4DQogICAgIA0KICAgICByZXR1cm4gU0lF
VkVfT0s7DQogfQ0KSW5kZXg6IGltYXAvbG10cGVuZ2luZS5jDQo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmls
ZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL2xtdHBlbmdp
bmUuYyx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNzUNCmRpZmYgLXUgLXIxLjc1IGxtdHBlbmdp
bmUuYw0KLS0tIGxtdHBlbmdpbmUuYwkyMDAyLzA2LzA2IDAwOjEyOjM0CTEuNzUNCisrKyBsbXRw
ZW5naW5lLmMJMjAwMi8wNi8xNCAxNzowNTowOA0KQEAgLTEyMzAsMTEgKzEyMzAsMjcgQEANCiAj
ZW5kaWYNCiAgICAgY2Quc3RhcnR0bHNfZG9uZSA9IDA7DQogDQorPDw8PDw8PCBsbXRwZW5naW5l
LmMNCisgICAgbWF4X21zZ3NpemUgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfTUFYTUVTU0FHRVNJ
WkUpOw0KKyAgICBpZiAoIW1heF9tc2dzaXplKSBtYXhfbXNnc2l6ZSA9IElOVF9NQVg7DQorPT09
PT09PQ0KICAgICBzcHJpbnRmKHNodXRkb3duZmlsZW5hbWUsICIlcy9tc2cvc2h1dGRvd24iLCBj
b25maWdfZGlyKTsNCiAgICAgbWF4X21zZ3NpemUgPSBjb25maWdfZ2V0aW50KCJtYXhtZXNzYWdl
c2l6ZSIsIElOVF9NQVgpOw0KKz4+Pj4+Pj4gMS42NA0KIA0KICAgICBtc2dfbmV3KCZtc2cpOw0K
IA0KKzw8PDw8PDwgbG10cGVuZ2luZS5jDQorICAgIGlmIChzYXNsX3NlcnZlcl9uZXcoImxtdHAi
LCBOVUxMLCBOVUxMLCBOVUxMLA0KKwkJCU5VTEwsIE5VTEwsIDAsICZjZC5jb25uKSAhPSBTQVNM
X09LKSB7DQorCWZhdGFsKCJTQVNMIGZhaWxlZCBpbml0aWFsaXppbmc6IHNhc2xfc2VydmVyX25l
dygpIiwgRUNfVEVNUEZBSUwpOw0KKyAgICB9DQorDQorICAgIC8qIHNldCBteSBhbGxvd2FibGUg
c2VjdXJpdHkgcHJvcGVydGllcyAqLw0KKyAgICBzZWNmbGFncyA9IFNBU0xfU0VDX05PQU5PTllN
T1VTOw0KKyAgICBpZiAoIWNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV1BMQUlOVEVYVCkp
IHsNCisJc2VjZmxhZ3MgfD0gU0FTTF9TRUNfTk9QTEFJTlRFWFQ7DQorPT09PT09PQ0KICAgICAv
KiBkb24ndCBsZWFrIG9sZCBjb25uZWN0aW9ucyAqLw0KICAgICBpZihzYXNscHJvcHMuaXBsb2Nh
bHBvcnQpIHsNCiAJZnJlZShzYXNscHJvcHMuaXBsb2NhbHBvcnQpOw0KQEAgLTEyNDMsNiArMTI1
OSw3IEBADQogICAgIGlmKHNhc2xwcm9wcy5pcHJlbW90ZXBvcnQpIHsNCiAJZnJlZShzYXNscHJv
cHMuaXByZW1vdGVwb3J0KTsNCiAJc2FzbHByb3BzLmlwcmVtb3RlcG9ydCA9IE5VTEw7DQorPj4+
Pj4+PiAxLjY0DQogICAgIH0NCiANCiAgICAgLyogZGV0ZXJtaW5lIHdobyB3ZSdyZSB0YWxraW5n
IHRvICovDQpAQCAtMjA3MSw2ICsyMDg4LDcgQEANCiAgICAgY2hhciAqaW47DQogICAgIGNvbnN0
IGNoYXIgKm91dDsNCiAgICAgdW5zaWduZWQgaW50IGlubGVuLCBvdXRsZW47DQorICAgIGNoYXIg
Km1lY2hhdmFpbDsNCiAgICAgY29uc3QgY2hhciAqbWVjaHVzaW5nOw0KICAgICB1bnNpZ25lZCBi
NjRsZW47DQogICAgIGNoYXIgbG9jYWxpcFs2MF0sIHJlbW90ZWlwWzYwXTsNCkBAIC0yMDk5LDEx
ICsyMTE3LDI2IEBADQogICAgIHIgPSBzYXNsX3NldHByb3AoY29ubi0+c2FzbGNvbm4sIFNBU0xf
SVBMT0NBTFBPUlQsIGxvY2FsaXApOw0KICAgICBpZiAociAhPSBTQVNMX09LKSByZXR1cm4gQVVU
SF9FUlJPUjsNCiAgICAgciA9IHNhc2xfc2V0cHJvcChjb25uLT5zYXNsY29ubiwgU0FTTF9JUFJF
TU9URVBPUlQsIHJlbW90ZWlwKTsNCis8PDw8PDw8IGxtdHBlbmdpbmUuYw0KKyAgICBpZiAociAh
PSBTQVNMX09LKSByZXR1cm4gcjsNCisNCisgICAgc3RyY3B5KGJ1ZiwgY29ubi0+aG9zdCk7DQor
ICAgIHAgPSBzdHJjaHIoYnVmLCAnLicpOw0KKyAgICAqcCA9ICdcMCc7DQorICAgIHN0cmNhdChi
dWYsICJfbWVjaHMiKTsNCisgICAgbWVjaGF2YWlsID0gY29uZmlnX2dldG92ZXJmbG93c3RyaW5n
KGJ1Zik7DQorICAgIGlmICghbWVjaGF2YWlsKSBtZWNoYXZhaWwgPSBjb25uLT5tZWNoczsNCis9
PT09PT09DQogICAgIGlmIChyICE9IFNBU0xfT0spIHJldHVybiBBVVRIX0VSUk9SOw0KKz4+Pj4+
Pj4gMS42NA0KIA0KICAgICAvKiB3ZSBub3cgZG8gdGhlIGFjdHVhbCBTQVNMIGV4Y2hhbmdlICov
DQorPDw8PDw8PCBsbXRwZW5naW5lLmMNCisgICAgciA9IHNhc2xfY2xpZW50X3N0YXJ0KGNvbm4t
PnNhc2xjb25uLCBtZWNoYXZhaWwsDQorPT09PT09PQ0KICAgICByID0gc2FzbF9jbGllbnRfc3Rh
cnQoY29ubi0+c2FzbGNvbm4sIA0KIAkJCSAgY29ubi0+bWVjaHMsDQorPj4+Pj4+PiAxLjY0DQog
CQkJICBOVUxMLCAmb3V0LCAmb3V0bGVuLCAmbWVjaHVzaW5nKTsNCiAgICAgaWYgKChyICE9IFNB
U0xfT0spICYmIChyICE9IFNBU0xfQ09OVElOVUUpKQ0KIAlyZXR1cm4gQVVUSF9FUlJPUjsNCklu
ZGV4OiBpbWFwL2xtdHBwcm94eWQuYw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3
LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9sbXRwcHJveHlkLmMsdg0KcmV0cmll
dmluZyByZXZpc2lvbiAxLjQyDQpkaWZmIC11IC1yMS40MiBsbXRwcHJveHlkLmMNCi0tLSBsbXRw
cHJveHlkLmMJMjAwMi8wNi8wMyAxODoyMjoyNgkxLjQyDQorKysgbG10cHByb3h5ZC5jCTIwMDIv
MDYvMTQgMTc6MDU6MDgNCkBAIC0xNzUsNyArMTc1LDcgQEANCiAgICAgLyogY2hlY2sgaWYgcmVt
b3RlIHJlYWxtICovDQogICAgIGlmICgocmVhbG0gPSBzdHJjaHIoYXV0aF9pZGVudGl0eSwgJ0An
KSkhPU5VTEwpIHsNCiAJcmVhbG0rKzsNCi0JdmFsID0gY29uZmlnX2dldHN0cmluZygibG9naW5y
ZWFsbXMiLCAiIik7DQorCXZhbCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9MT0dJTlJFQUxN
Uyk7DQogCXdoaWxlICgqdmFsKSB7DQogCSAgICBpZiAoIXN0cm5jYXNlY21wKHZhbCwgcmVhbG0s
IHN0cmxlbihyZWFsbSkpICYmDQogCQkoIXZhbFtzdHJsZW4ocmVhbG0pXSB8fCBpc3NwYWNlKChp
bnQpIHZhbFtzdHJsZW4ocmVhbG0pXSkpKSB7DQpAQCAtMTk2LDcgKzE5Niw3IEBADQogICAgICAq
IGZvciBub3cgb25seSBhZG1pbnMgY2FuIGRvIGxtdHAgZnJvbSBhbm90aGVyIG1hY2hpbmUNCiAg
ICAgICovDQogICAgIGF1dGhzdGF0ZSA9IGF1dGhfbmV3c3RhdGUoYXV0aF9pZGVudGl0eSwgTlVM
TCk7DQotICAgIGFsbG93ZWQgPSBhdXRoaXNhKGF1dGhzdGF0ZSwgImxtdHAiLCAiYWRtaW5zIik7
DQorICAgIGFsbG93ZWQgPSBjb25maWdfYXV0aGlzYShhdXRoc3RhdGUsIElNQVBPUFRfQURNSU5T
KTsNCiAgICAgYXV0aF9mcmVlc3RhdGUoYXV0aHN0YXRlKTsNCiAgICAgDQogICAgIGlmICghYWxs
b3dlZCkgew0KQEAgLTIxOCwyNiArMjE4LDUzIEBADQogew0KICAgICBpbnQgcjsNCiANCis8PDw8
PDw8IGxtdHBwcm94eWQuYw0KKz09PT09PT0NCiAgICAgY29uZmlnX2NoYW5nZWlkZW50KCJsbXRw
cHJveHlkIik7DQorPj4+Pj4+PiAxLjQyDQogICAgIGlmIChnZXRldWlkKCkgPT0gMCkgcmV0dXJu
IDE7DQogICAgIA0KICAgICBzaWduYWxzX3NldF9zaHV0ZG93bigmc2h1dF9kb3duKTsNCiAgICAg
c2lnbmFsc19hZGRfaGFuZGxlcnMoKTsNCiAgICAgc2lnbmFsKFNJR1BJUEUsIFNJR19JR04pOw0K
IA0KKzw8PDw8PDwgbG10cHByb3h5ZC5jDQorI2lmZGVmIFVTRV9TSUVWRQ0KKyAgICBzaWV2ZV9k
aXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU0lFVkVESVIpOw0KKyAgICBteWxtdHAuYWRk
aGVhZGVycyA9IHhtYWxsb2MoODApOw0KKyAgICBzbnByaW50ZihteWxtdHAuYWRkaGVhZGVycywg
ODAsICJYLVNpZXZlOiAlc1xyXG4iLCBTSUVWRV9WRVJTSU9OKTsNCisNCisgICAgLyogc2V0dXAg
c2lldmUgc3VwcG9ydCAqLw0KKyAgICBzZXR1cF9zaWV2ZSgpOw0KKyNlbmRpZiAvKiBVU0VfU0lF
VkUgKi8NCis9PT09PT09DQogICAgIEJCID0gY29uZmlnX2dldHN0cmluZygicG9zdHVzZXIiLCBC
Qik7DQorPj4+Pj4+PiAxLjM3DQogDQorICAgIEJCID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BU
X1BPU1RVU0VSKTsNCisNCiAgICAgaWYgKChyID0gc2FzbF9zZXJ2ZXJfaW5pdChteXNhc2xfY2Is
ICJDeXJ1cyIpKSAhPSBTQVNMX09LKSB7DQogCXN5c2xvZyhMT0dfRVJSLCAiU0FTTCBmYWlsZWQg
aW5pdGlhbGl6aW5nOiBzYXNsX3NlcnZlcl9pbml0KCk6ICVzIiwgDQogCSAgICAgICBzYXNsX2Vy
cnN0cmluZyhyLCBOVUxMLCBOVUxMKSk7DQogCXJldHVybiBFQ19TT0ZUV0FSRTsNCiAgICAgfQ0K
IA0KKzw8PDw8PDwgbG10cHByb3h5ZC5jDQorICAgIGR1cGVsaW0gPSBjb25maWdfZ2V0c3dpdGNo
KElNQVBPUFRfRFVQTElDQVRFU1VQUFJFU1NJT04pOw0KKyAgICBpZiAoZHVwZWxpbSkgew0KKwkv
KiBpbml0aWFsaXplIGR1cGxpY2F0ZSBkZWxpdmVyeSBkYXRhYmFzZSAqLw0KKwlpZiAoZHVwbGlj
YXRlX2luaXQoTlVMTCwgMCkgIT0gMCkgew0KKwkgICAgc3lzbG9nKExPR19FUlIsIA0KKwkJICAg
ImRlbGl2ZXI6IHVuYWJsZSB0byBpbml0IGR1cGxpY2F0ZSBkZWxpdmVyeSBkYXRhYmFzZVxuIik7
DQorCSAgICBkdXBlbGltID0gMDsNCisJfQ0KKz09PT09PT0NCiAgICAgciA9IHNhc2xfY2xpZW50
X2luaXQoTlVMTCk7DQogICAgIGlmKHIgIT0gMCkgew0KIAlzeXNsb2coTE9HX0VSUiwgImNvdWxk
IG5vdCBpbml0aWFsaXplIGNsaWVudC1zaWRlIFNBU0w6ICVzIiwNCiAJICAgICAgIHNhc2xfZXJy
c3RyaW5nKHIsIE5VTEwsIE5VTEwpKTsNCiAJcmV0dXJuIEVDX1NPRlRXQVJFOw0KKz4+Pj4+Pj4g
MS4zNw0KICAgICB9DQogDQogICAgIC8qIFNldCBuYW1lc3BhY2UgKi8NCkBAIC0yOTMsNiArMzIw
LDQ0MCBAQA0KIAkgICAgdXNhZ2UoKTsNCiAJfQ0KICAgICB9DQorPDw8PDw8PCBsbXRwcHJveHlk
LmMNCisNCisgICAgc25tcF9pbmNyZW1lbnQoVE9UQUxfQ09OTkVDVElPTlMsIDEpOw0KKyAgICBz
bm1wX2luY3JlbWVudChBQ1RJVkVfQ09OTkVDVElPTlMsIDEpOw0KKw0KKyAgICBsbXRwbW9kZSgm
bXlsbXRwLCBkZWxpdmVyX2luLCBkZWxpdmVyX291dCwgMCk7DQorICAgIHNodXRfZG93bigwKTsN
CisNCisgICAgcmV0dXJuIDA7DQorfQ0KKw0KKy8qIGNhbGxlZCBpZiAnc2VydmljZV9pbml0KCkn
IHdhcyBjYWxsZWQgYnV0IG5vdCAnc2VydmljZV9tYWluKCknICovDQordm9pZCBzZXJ2aWNlX2Fi
b3J0KHZvaWQpDQorew0KKyAgICBkdXBsaWNhdGVfZG9uZSgpOw0KKw0KKyAgICBtYm94bGlzdF9j
bG9zZSgpOw0KKyAgICBtYm94bGlzdF9kb25lKCk7DQorfQ0KKw0KKyNpZmRlZiBVU0VfU0lFVkUN
CitzdGF0aWMgY2hhciAqbWFrZV9zaWV2ZV9kYihjb25zdCBjaGFyICp1c2VyKQ0KK3sNCisgICAg
c3RhdGljIGNoYXIgYnVmW01BWF9NQUlMQk9YX1BBVEhdOw0KKw0KKyAgICBidWZbMF0gPSAnLic7
DQorICAgIGJ1ZlsxXSA9ICdcMCc7DQorICAgIHN0cmNhdChidWYsIHVzZXIpOw0KKyAgICBzdHJj
YXQoYnVmLCAiLnNpZXZlLiIpOw0KKw0KKyAgICByZXR1cm4gYnVmOw0KK30NCisNCisvKiBnZXRz
IHRoZSBoZWFkZXIgImhlYWQiIGZyb20gbXNnLiAqLw0KK3N0YXRpYyBpbnQgZ2V0aGVhZGVyKHZv
aWQgKnYsIGNvbnN0IGNoYXIgKnBoZWFkLCBjb25zdCBjaGFyICoqKmJvZHkpDQorew0KKyAgICBt
ZXNzYWdlX2RhdGFfdCAqbSA9ICgobXlkYXRhX3QgKikgdiktPm07DQorDQorICAgIGlmIChwaGVh
ZD09TlVMTCkgcmV0dXJuIFNJRVZFX0ZBSUw7DQorICAgICpib2R5ID0gbXNnX2dldGhlYWRlciht
LCBwaGVhZCk7DQorDQorICAgIGlmICgqYm9keSkgew0KKwlyZXR1cm4gU0lFVkVfT0s7DQorICAg
IH0gZWxzZSB7DQorCXJldHVybiBTSUVWRV9GQUlMOw0KKyAgICB9DQorfQ0KKw0KK3N0YXRpYyBp
bnQgZ2V0c2l6ZSh2b2lkICptYywgaW50ICpzaXplKQ0KK3sNCisgICAgbWVzc2FnZV9kYXRhX3Qg
Km0gPSAoKG15ZGF0YV90ICopIG1jKS0+bTsNCisNCisgICAgKnNpemUgPSBtc2dfZ2V0c2l6ZSht
KTsNCisgICAgcmV0dXJuIFNJRVZFX09LOw0KK30NCisNCisvKiB3ZSB1c2UgdGhlIHRlbXAgZmll
bGQgaW4gbWVzc2FnZV9kYXRhIHRvIGF2b2lkIGhhdmluZyB0byBtYWxsb2MgbWVtb3J5DQorICAg
dG8gcmV0dXJuLCBhbmQgd2UgYWxzbyBjYW4ndCBleHBvc2Ugb3VyIHRoZSByZWNlaXBpZW50cyB0
byB0aGUgbWVzc2FnZSAqLw0KK2ludCBnZXRlbnZlbG9wZSh2b2lkICptYywgY29uc3QgY2hhciAq
ZmllbGQsIGNvbnN0IGNoYXIgKioqY29udGVudHMpDQorew0KKyAgICBteWRhdGFfdCAqbXlkYXRh
ID0gKG15ZGF0YV90ICopIG1jOw0KKyAgICBtZXNzYWdlX2RhdGFfdCAqbSA9IG15ZGF0YS0+bTsN
CisNCisgICAgaWYgKCFzdHJjYXNlY21wKGZpZWxkLCAiZnJvbSIpKSB7DQorCSpjb250ZW50cyA9
IG15ZGF0YS0+dGVtcDsNCisJbXlkYXRhLT50ZW1wWzBdID0gbS0+cmV0dXJuX3BhdGg7DQorCW15
ZGF0YS0+dGVtcFsxXSA9IE5VTEw7DQorCXJldHVybiBTSUVWRV9PSzsNCisgICAgfSBlbHNlIGlm
ICghc3RyY2FzZWNtcChmaWVsZCwgInRvIikpIHsNCisJKmNvbnRlbnRzID0gbXlkYXRhLT50ZW1w
Ow0KKwlteWRhdGEtPnRlbXBbMF0gPSBtc2dfZ2V0cmNwdGFsbChtLCBteWRhdGEtPmN1cl9yY3B0
KTsNCisJbXlkYXRhLT50ZW1wWzFdID0gTlVMTDsNCisJcmV0dXJuIFNJRVZFX09LOw0KKyAgICB9
IGVsc2Ugew0KKwkqY29udGVudHMgPSBOVUxMOw0KKwlyZXR1cm4gU0lFVkVfRkFJTDsNCisgICAg
fQ0KK30NCisNCisjZGVmaW5lIERFRkFVTFRfU0VORE1BSUwgKCIvdXNyL2xpYi9zZW5kbWFpbCIp
DQorI2RlZmluZSBERUZBVUxUX1BPU1RNQVNURVIgKCJwb3N0bWFzdGVyIikNCisNCisjZGVmaW5l
IFNFTkRNQUlMIChjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU0VORE1BSUwpKQ0KKyNkZWZpbmUg
UE9TVE1BU1RFUiAoY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1BPU1RNQVNURVIpKQ0KKw0KK3N0
YXRpYyBjaGFyICptb250aFtdID0geyAiSmFuIiwgIkZlYiIsICJNYXIiLCAiQXByIiwgIk1heSIs
ICJKdW4iLA0KKyAgICAgICAgICAgICAgICAgICAgICAgICAiSnVsIiwgIkF1ZyIsICJTZXAiLCAi
T2N0IiwgIk5vdiIsICJEZWMiIH07DQorDQorc3RhdGljIGNoYXIgKndkYXlbXSA9IHsgIlN1biIs
ICJNb24iLCAiVHVlIiwgIldlZCIsICJUaHUiLCAiRnJpIiwgIlNhdCIgfTsNCisNCitzdGF0aWMg
aW50IGdsb2JhbF9vdXRnb2luZ19jb3VudCA9IDA7DQorDQorcGlkX3Qgb3Blbl9zZW5kbWFpbChj
b25zdCBjaGFyICphcmd2W10sIEZJTEUgKipzbSkNCit7DQorICAgIGludCBmZHNbMl07DQorICAg
IEZJTEUgKnJldDsNCisgICAgcGlkX3QgcDsNCisNCisgICAgcGlwZShmZHMpOw0KKyAgICBpZiAo
KHAgPSBmb3JrKCkpID09IDApIHsNCisJLyogaSdtIHRoZSBjaGlsZCEgcnVuIHNlbmRtYWlsISAq
Lw0KKwljbG9zZShmZHNbMV0pOw0KKwkvKiBtYWtlIHRoZSBwaXBlIGJlIHN0ZGluICovDQorCWR1
cDIoZmRzWzBdLCAwKTsNCisJZXhlY3YoU0VORE1BSUwsIChjaGFyICoqKSBhcmd2KTsNCisNCisJ
LyogaWYgd2UncmUgaGVyZSB3ZSBzdWNrICovDQorCXByaW50ZigiNDUxIGRlbGl2ZXI6IGRpZG4n
dCBleGVjPyE/XHJcbiIpOw0KKwlmYXRhbCgiY291bGRuJ3QgZXhlYyIsIEVDX1RFTVBGQUlMKTsN
CisgICAgfQ0KKyAgICAvKiBpJ20gdGhlIHBhcmVudCAqLw0KKyAgICBjbG9zZShmZHNbMF0pOw0K
KyAgICByZXQgPSBmZG9wZW4oZmRzWzFdLCAidyIpOw0KKyAgICAqc20gPSByZXQ7DQorDQorICAg
IHJldHVybiBwOw0KK30NCisNCisvKiBzZW5kbWFpbF9lcnJzdHIuICBjcmVhdGUgYSBkZXNjcmlw
dGl2ZSBtZXNzYWdlIGdpdmVuICdzbV9zdGF0JzogDQorICAgdGhlIGV4aXQgY29kZSBmcm9tIHdh
aXQoKSBmcm9tIHNlbmRtYWlsLg0KKw0KKyAgIG5vdCB0aHJlYWQgc2FmZSwgYnV0IHByb2JhYmx5
IG9rICovDQorc3RhdGljIGNoYXIgKnNlbmRtYWlsX2VycnN0cihpbnQgc21fc3RhdCkNCit7DQor
ICAgIHN0YXRpYyBjaGFyIGVycnN0clsyMDBdOw0KKw0KKyAgICBpZiAoV0lGRVhJVEVEKHNtX3N0
YXQpKSB7DQorCXNucHJpbnRmKGVycnN0ciwgc2l6ZW9mIGVycnN0ciwNCisJCSAiU2VuZG1haWwg
cHJvY2VzcyB0ZXJtaW5hdGVkIG5vcm1hbGx5LCBleGl0IHN0YXR1cyAlZFxuIiwNCisJCSBXRVhJ
VFNUQVRVUyhzbV9zdGF0KSk7DQorICAgIH0gZWxzZSBpZiAoV0lGU0lHTkFMRUQoc21fc3RhdCkp
IHsNCisJc25wcmludGYoZXJyc3RyLCBzaXplb2YgZXJyc3RyLA0KKwkJIlNlbmRtYWlsIHByb2Nl
c3MgdGVybWluYXRlZCBhYm5vcm1hbGx5LCBzaWduYWwgPSAlZCAlc1xuIiwNCisJCVdURVJNU0lH
KHNtX3N0YXQpLCANCisjaWZkZWYgV0NPUkVEVU1QDQorCQlXQ09SRURVTVAoc21fc3RhdCkgPyAi
IC0tIGNvcmUgZmlsZSBnZW5lcmF0ZWQiIDoNCisjZW5kaWYNCisJCSIiKTsNCisgICAgfSBlbHNl
IGlmIChXSUZTVE9QUEVEKHNtX3N0YXQpKSB7DQorCXNucHJpbnRmKGVycnN0ciwgc2l6ZW9mIGVy
cnN0ciwNCisJCSAiU2VuZG1haWwgcHJvY2VzcyBzdG9wcGVkLCBzaWduYWwgPSAlZFxuIiwNCisJ
CVdURVJNU0lHKHNtX3N0YXQpKTsNCisgICAgfSBlbHNlIHsNCisJcmV0dXJuIE5VTEw7DQorICAg
IH0NCisgICAgDQorICAgIHJldHVybiBlcnJzdHI7DQorfQ0KKw0KK2ludCBzZW5kX3JlamVjdGlv
bihjb25zdCBjaGFyICpvcmlnaWQsDQorCQkgICBjb25zdCBjaGFyICpyZWp0bywNCisJCSAgIGNv
bnN0IGNoYXIgKm9yaWdyZWNlaXAsIA0KKwkJICAgY29uc3QgY2hhciAqbWFpbHJlY2VpcCwgDQor
CQkgICBjb25zdCBjaGFyICpyZWFzb24sIA0KKwkJICAgc3RydWN0IHByb3RzdHJlYW0gKmZpbGUp
DQorew0KKyAgICBGSUxFICpzbTsNCisgICAgY29uc3QgY2hhciAqc21idWZbNl07DQorICAgIGNo
YXIgYnVmWzgxOTJdLCAqbmFtZWJ1ZjsNCisgICAgaW50IGksIHNtX3N0YXQ7DQorICAgIHRpbWVf
dCB0Ow0KKyAgICBzdHJ1Y3QgdG0gKnRtOw0KKyAgICBsb25nIGdtdG9mZjsNCisgICAgaW50IGdt
dG5lZ2F0aXZlID0gMDsNCisgICAgcGlkX3Qgc21fcGlkLCBwOw0KKw0KKyAgICBzbWJ1ZlswXSA9
ICJzZW5kbWFpbCI7DQorICAgIHNtYnVmWzFdID0gIi1mIjsNCisgICAgc21idWZbMl0gPSAiPD4i
Ow0KKyAgICBzbWJ1ZlszXSA9ICItLSI7DQorICAgIHNtYnVmWzRdID0gcmVqdG87DQorICAgIHNt
YnVmWzVdID0gTlVMTDsNCisgICAgc21fcGlkID0gb3Blbl9zZW5kbWFpbChzbWJ1ZiwgJnNtKTsN
CisgICAgaWYgKHNtID09IE5VTEwpIHsNCisJcmV0dXJuIC0xOw0KKyAgICB9DQorDQorICAgIHQg
PSB0aW1lKE5VTEwpOw0KKyAgICBwID0gZ2V0cGlkKCk7DQorICAgIHNucHJpbnRmKGJ1Ziwgc2l6
ZW9mKGJ1ZiksICI8Y211LXNpZXZlLSVkLSVkLSVkQCVzPiIsIHAsIChpbnQpIHQsIA0KKwkgICAg
IGdsb2JhbF9vdXRnb2luZ19jb3VudCsrLCBjb25maWdfc2VydmVybmFtZSk7DQorICAgIA0KKyAg
ICBuYW1lYnVmID0gbWFrZV9zaWV2ZV9kYihtYWlscmVjZWlwKTsNCisgICAgZHVwbGljYXRlX21h
cmsoYnVmLCBzdHJsZW4oYnVmKSwgbmFtZWJ1Ziwgc3RybGVuKG5hbWVidWYpLCB0KTsNCisgICAg
ZnByaW50ZihzbSwgIk1lc3NhZ2UtSUQ6ICVzXHJcbiIsIGJ1Zik7DQorDQorICAgIHRtID0gbG9j
YWx0aW1lKCZ0KTsNCisgICAgZ210b2ZmID0gZ210b2ZmX29mKHRtLCB0KTsNCisgICAgaWYgKGdt
dG9mZiA8IDApIHsNCisJZ210b2ZmID0gLWdtdG9mZjsNCisJZ210bmVnYXRpdmUgPSAxOw0KKyAg
ICB9DQorICAgIGdtdG9mZiAvPSA2MDsNCisgICAgZnByaW50ZihzbSwgIkRhdGU6ICVzLCAlMDJk
ICVzICU0ZCAlMDJkOiUwMmQ6JTAyZCAlYyUuMmx1JS4ybHVcclxuIiwNCisJICAgIHdkYXlbdG0t
PnRtX3dkYXldLCANCisJICAgIHRtLT50bV9tZGF5LCBtb250aFt0bS0+dG1fbW9uXSwgdG0tPnRt
X3llYXIgKyAxOTAwLA0KKwkgICAgdG0tPnRtX2hvdXIsIHRtLT50bV9taW4sIHRtLT50bV9zZWMs
DQorICAgICAgICAgICAgZ210bmVnYXRpdmUgPyAnLScgOiAnKycsIGdtdG9mZiAvIDYwLCBnbXRv
ZmYgJSA2MCk7DQorDQorICAgIGZwcmludGYoc20sICJYLVNpZXZlOiAlc1xyXG4iLCBTSUVWRV9W
RVJTSU9OKTsNCisgICAgZnByaW50ZihzbSwgIkZyb206IE1haWwgU2lldmUgU3Vic3lzdGVtIDwl
cz5cclxuIiwgUE9TVE1BU1RFUik7DQorICAgIGZwcmludGYoc20sICJUbzogPCVzPlxyXG4iLCBy
ZWp0byk7DQorICAgIGZwcmludGYoc20sICJNSU1FLVZlcnNpb246IDEuMFxyXG4iKTsNCisgICAg
ZnByaW50ZihzbSwgIkNvbnRlbnQtVHlwZTogIg0KKwkgICAgIm11bHRpcGFydC9yZXBvcnQ7IHJl
cG9ydC10eXBlPWRpc3Bvc2l0aW9uLW5vdGlmaWNhdGlvbjsiDQorCSAgICAiXHJcblx0Ym91bmRh
cnk9XCIlZC8lc1wiXHJcbiIsIChpbnQpIHAsIGNvbmZpZ19zZXJ2ZXJuYW1lKTsNCisgICAgZnBy
aW50ZihzbSwgIlN1YmplY3Q6IEF1dG9tYXRpY2FsbHkgcmVqZWN0ZWQgbWFpbFxyXG4iKTsNCisg
ICAgZnByaW50ZihzbSwgIkF1dG8tU3VibWl0dGVkOiBhdXRvLXJlcGxpZWQgKHJlamVjdGVkKVxy
XG4iKTsNCisgICAgZnByaW50ZihzbSwgIlxyXG5UaGlzIGlzIGEgTUlNRS1lbmNhcHN1bGF0ZWQg
bWVzc2FnZVxyXG5cclxuIik7DQorDQorICAgIC8qIHRoaXMgaXMgdGhlIGh1bWFuIHJlYWRhYmxl
IHN0YXR1cyByZXBvcnQgKi8NCisgICAgZnByaW50ZihzbSwgIi0tJWQvJXNcclxuXHJcbiIsIChp
bnQpIHAsIGNvbmZpZ19zZXJ2ZXJuYW1lKTsNCisgICAgZnByaW50ZihzbSwgIllvdXIgbWVzc2Fn
ZSB3YXMgYXV0b21hdGljYWxseSByZWplY3RlZCBieSBTaWV2ZSwgYSBtYWlsXHJcbiINCisJICAg
ICJmaWx0ZXJpbmcgbGFuZ3VhZ2UuXHJcblxyXG4iKTsNCisgICAgZnByaW50ZihzbSwgIlRoZSBm
b2xsb3dpbmcgcmVhc29uIHdhcyBnaXZlbjpcclxuJXNcclxuXHJcbiIsIHJlYXNvbik7DQorDQor
ICAgIC8qIHRoaXMgaXMgdGhlIE1ETiBzdGF0dXMgcmVwb3J0ICovDQorICAgIGZwcmludGYoc20s
ICItLSVkLyVzXHJcbiINCisJICAgICJDb250ZW50LVR5cGU6IG1lc3NhZ2UvZGlzcG9zaXRpb24t
bm90aWZpY2F0aW9uXHJcblxyXG4iLA0KKwkgICAgKGludCkgcCwgY29uZmlnX3NlcnZlcm5hbWUp
Ow0KKyAgICBmcHJpbnRmKHNtLCAiUmVwb3J0aW5nLVVBOiAlczsgQ3lydXMgJXMvJXNcclxuIiwN
CisJICAgIGNvbmZpZ19zZXJ2ZXJuYW1lLCBDWVJVU19WRVJTSU9OLCBTSUVWRV9WRVJTSU9OKTsN
CisgICAgaWYgKG9yaWdyZWNlaXApDQorCWZwcmludGYoc20sICJPcmlnaW5hbC1SZWNpcGllbnQ6
IHJmYzgyMjsgJXNcclxuIiwgb3JpZ3JlY2VpcCk7DQorICAgIGZwcmludGYoc20sICJGaW5hbC1S
ZWNpcGllbnQ6IHJmYzgyMjsgJXNcclxuIiwgbWFpbHJlY2VpcCk7DQorICAgIGZwcmludGYoc20s
ICJPcmlnaW5hbC1NZXNzYWdlLUlEOiAlc1xyXG4iLCBvcmlnaWQpOw0KKyAgICBmcHJpbnRmKHNt
LCAiRGlzcG9zaXRpb246ICINCisJICAgICJhdXRvbWF0aWMtYWN0aW9uL01ETi1zZW50LWF1dG9t
YXRpY2FsbHk7IGRlbGV0ZWRcclxuIik7DQorICAgIGZwcmludGYoc20sICJcclxuIik7DQorDQor
ICAgIC8qIHRoaXMgaXMgdGhlIG9yaWdpbmFsIG1lc3NhZ2UgKi8NCisgICAgZnByaW50ZihzbSwg
Ii0tJWQvJXNcclxuQ29udGVudC1UeXBlOiBtZXNzYWdlL3JmYzgyMlxyXG5cclxuIiwNCisJICAg
IChpbnQpIHAsIGNvbmZpZ19zZXJ2ZXJuYW1lKTsNCisgICAgcHJvdF9yZXdpbmQoZmlsZSk7DQor
ICAgIHdoaWxlICgoaSA9IHByb3RfcmVhZChmaWxlLCBidWYsIHNpemVvZihidWYpKSkgPiAwKSB7
DQorCWZ3cml0ZShidWYsIGksIDEsIHNtKTsNCisgICAgfQ0KKyAgICBmcHJpbnRmKHNtLCAiXHJc
blxyXG4iKTsNCisgICAgZnByaW50ZihzbSwgIi0tJWQvJXMtLVxyXG4iLCAoaW50KSBwLCBjb25m
aWdfc2VydmVybmFtZSk7DQorDQorICAgIGZjbG9zZShzbSk7DQorICAgIHdoaWxlICh3YWl0cGlk
KHNtX3BpZCwgJnNtX3N0YXQsIDApIDwgMCk7DQorDQorICAgIHJldHVybiBzbV9zdGF0OwkvKiBz
ZW5kbWFpbCBleGl0IHZhbHVlICovDQorfQ0KKw0KK2ludCBzZW5kX2ZvcndhcmQoY2hhciAqZm9y
d2FyZHRvLCBjaGFyICpyZXR1cm5fcGF0aCwgc3RydWN0IHByb3RzdHJlYW0gKmZpbGUpDQorew0K
KyAgICBGSUxFICpzbTsNCisgICAgY29uc3QgY2hhciAqc21idWZbNl07DQorICAgIGludCBpLCBz
bV9zdGF0Ow0KKyAgICBjaGFyIGJ1ZlsxMDI0XTsNCisgICAgcGlkX3Qgc21fcGlkOw0KKw0KKyAg
ICBzbWJ1ZlswXSA9ICJzZW5kbWFpbCI7DQorICAgIGlmIChyZXR1cm5fcGF0aCAhPSBOVUxMKSB7
DQorCXNtYnVmWzFdID0gIi1mIjsNCisJc21idWZbMl0gPSByZXR1cm5fcGF0aDsNCisgICAgfSBl
bHNlIHsNCisJc21idWZbMV0gPSAiLWYiOw0KKwlzbWJ1ZlsyXSA9ICI8PiI7DQorICAgIH0NCisg
ICAgc21idWZbM10gPSAiLS0iOw0KKyAgICBzbWJ1Zls0XSA9IGZvcndhcmR0bzsNCisgICAgc21i
dWZbNV0gPSBOVUxMOw0KKyAgICBzbV9waWQgPSBvcGVuX3NlbmRtYWlsKHNtYnVmLCAmc20pOw0K
KwkNCisgICAgaWYgKHNtID09IE5VTEwpIHsNCisJcmV0dXJuIC0xOw0KKyAgICB9DQorDQorICAg
IHByb3RfcmV3aW5kKGZpbGUpOw0KKw0KKyAgICB3aGlsZSAoKGkgPSBwcm90X3JlYWQoZmlsZSwg
YnVmLCBzaXplb2YoYnVmKSkpID4gMCkgew0KKwlmd3JpdGUoYnVmLCBpLCAxLCBzbSk7DQorICAg
IH0NCisNCisgICAgZmNsb3NlKHNtKTsNCisgICAgd2hpbGUgKHdhaXRwaWQoc21fcGlkLCAmc21f
c3RhdCwgMCkgPCAwKTsNCisNCisgICAgcmV0dXJuIHNtX3N0YXQ7CS8qIHNlbmRtYWlsIGV4aXQg
dmFsdWUgKi8NCit9DQorDQorDQorc3RhdGljDQoraW50IHNpZXZlX3JlZGlyZWN0KHZvaWQgKmFj
LCB2b2lkICppYywgdm9pZCAqc2MsIHZvaWQgKm1jLCBjb25zdCBjaGFyICoqZXJybXNnKQ0KK3sN
CisgICAgc2lldmVfcmVkaXJlY3RfY29udGV4dF90ICpyYyA9IChzaWV2ZV9yZWRpcmVjdF9jb250
ZXh0X3QgKikgYWM7DQorICAgIHNjcmlwdF9kYXRhX3QgKnNkID0gKHNjcmlwdF9kYXRhX3QgKikg
c2M7DQorICAgIG1lc3NhZ2VfZGF0YV90ICptID0gKChteWRhdGFfdCAqKSBtYyktPm07DQorICAg
IGNoYXIgYnVmWzgxOTJdLCAqc2lldmVkYiA9IE5VTEw7DQorICAgIGludCByZXM7DQorDQorICAg
IC8qIGlmIHdlIGhhdmUgYSBtc2dpZCwgd2UgY2FuIHRyYWNrIG91ciByZWRpcmVjdHMgKi8NCisg
ICAgaWYgKG0tPmlkKSB7DQorCXNucHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1ZiksICIlcy0lcyIsIG0t
PmlkLCByYy0+YWRkcik7DQorCXNpZXZlZGIgPSBtYWtlX3NpZXZlX2RiKHNkLT51c2VybmFtZSk7
DQorDQorCS8qIG9rLCBsZXQncyBzZWUgaWYgd2UndmUgcmVkaXJlY3RlZCB0aGlzIG1lc3NhZ2Ug
YmVmb3JlICovDQorCWlmIChkdXBsaWNhdGVfY2hlY2soYnVmLCBzdHJsZW4oYnVmKSwgc2lldmVk
Yiwgc3RybGVuKHNpZXZlZGIpKSkNCisJICAgIHJldHVybiBTSUVWRV9PSzsNCisgICAgfQ0KKw0K
KyAgICBpZiAoKHJlcyA9IHNlbmRfZm9yd2FyZChyYy0+YWRkciwgbS0+cmV0dXJuX3BhdGgsIG0t
PmRhdGEpKSA9PSAwKSB7DQorCS8qIG1hcmsgdGhpcyBtZXNzYWdlIGFzIHJlZGlyZWN0ZWQgKi8N
CisJaWYgKHNpZXZlZGIpIGR1cGxpY2F0ZV9tYXJrKGJ1Ziwgc3RybGVuKGJ1ZiksIA0KKwkJCQkg
ICAgc2lldmVkYiwgc3RybGVuKHNpZXZlZGIpLCB0aW1lKE5VTEwpKTsNCisNCisJc25tcF9pbmNy
ZW1lbnQoU0lFVkVfUkVESVJFQ1QsIDEpOw0KKwlyZXR1cm4gU0lFVkVfT0s7DQorICAgIH0gZWxz
ZSB7DQorCWlmIChyZXMgPT0gLTEpIHsNCisJICAgICplcnJtc2cgPSAiQ291bGQgbm90IHNwYXdu
IHNlbmRtYWlsIHByb2Nlc3MiOw0KKwl9IGVsc2Ugew0KKwkgICAgKmVycm1zZyA9IHNlbmRtYWls
X2VycnN0cihyZXMpOw0KKwl9DQorCXJldHVybiBTSUVWRV9GQUlMOw0KKyAgICB9DQorfQ0KKw0K
K3N0YXRpYw0KK2ludCBzaWV2ZV9kaXNjYXJkKHZvaWQgKmFjLCB2b2lkICppYywgdm9pZCAqc2Ms
IHZvaWQgKm1jLCBjb25zdCBjaGFyICoqZXJybXNnKQ0KK3sNCisgICAgc25tcF9pbmNyZW1lbnQo
U0lFVkVfRElTQ0FSRCwgMSk7DQorDQorICAgIC8qIG9rLCB3ZSB3b24ndCBmaWxlIGl0ICovDQor
ICAgIHJldHVybiBTSUVWRV9PSzsNCit9DQorDQorc3RhdGljDQoraW50IHNpZXZlX3JlamVjdCh2
b2lkICphYywgdm9pZCAqaWMsIHZvaWQgKnNjLCB2b2lkICptYywgY29uc3QgY2hhciAqKmVycm1z
ZykNCit7DQorICAgIHNpZXZlX3JlamVjdF9jb250ZXh0X3QgKnJjID0gKHNpZXZlX3JlamVjdF9j
b250ZXh0X3QgKikgYWM7DQorICAgIHNjcmlwdF9kYXRhX3QgKnNkID0gKHNjcmlwdF9kYXRhX3Qg
Kikgc2M7DQorICAgIG1lc3NhZ2VfZGF0YV90ICptZCA9ICgobXlkYXRhX3QgKikgbWMpLT5tOw0K
KyAgICBjb25zdCBjaGFyICoqYm9keTsNCisgICAgY29uc3QgY2hhciAqb3JpZ3JlY2VpcDsNCisg
ICAgaW50IHJlczsNCisNCisgICAgaWYgKG1kLT5yZXR1cm5fcGF0aCA9PSBOVUxMKSB7DQorCS8q
IHJldHVybiBtZXNzYWdlIHRvIHdobz8hPyAqLw0KKwkqZXJybXNnID0gIk5vIHJldHVybi1wYXRo
IGZvciByZXBseSI7DQorCXJldHVybiBTSUVWRV9GQUlMOw0KKyAgICB9DQorICAgIA0KKyAgICBi
b2R5ID0gbXNnX2dldGhlYWRlcihtZCwgIm9yaWdpbmFsLXJlY2lwaWVudCIpOw0KKyAgICBvcmln
cmVjZWlwID0gYm9keSA/IGJvZHlbMF0gOiBOVUxMOw0KKyAgICBpZiAoKHJlcyA9IHNlbmRfcmVq
ZWN0aW9uKG1kLT5pZCwgbWQtPnJldHVybl9wYXRoLCANCisJCQkgICAgICBvcmlncmVjZWlwLCBz
ZC0+dXNlcm5hbWUsDQorCQkJICAgICAgcmMtPm1zZywgbWQtPmRhdGEpKSA9PSAwKSB7DQorCXNu
bXBfaW5jcmVtZW50KFNJRVZFX1JFSkVDVCwgMSk7DQorCXJldHVybiBTSUVWRV9PSzsNCisgICAg
fSBlbHNlIHsNCisJaWYgKHJlcyA9PSAtMSkgew0KKwkgICAgKmVycm1zZyA9ICJDb3VsZCBub3Qg
c3Bhd24gc2VuZG1haWwgcHJvY2VzcyI7DQorCX0gZWxzZSB7DQorCSAgICAqZXJybXNnID0gc2Vu
ZG1haWxfZXJyc3RyKHJlcyk7DQorCX0NCisJcmV0dXJuIFNJRVZFX0ZBSUw7DQorICAgIH0NCit9
DQorDQorc3RhdGljDQoraW50IHNpZXZlX2ZpbGVpbnRvKHZvaWQgKmFjLCB2b2lkICppYywgdm9p
ZCAqc2MsIHZvaWQgKm1jLCBjb25zdCBjaGFyICoqZXJybXNnKQ0KK3sNCisgICAgc2lldmVfZmls
ZWludG9fY29udGV4dF90ICpmYyA9IChzaWV2ZV9maWxlaW50b19jb250ZXh0X3QgKikgYWM7DQor
ICAgIHNjcmlwdF9kYXRhX3QgKnNkID0gKHNjcmlwdF9kYXRhX3QgKikgc2M7DQorICAgIG15ZGF0
YV90ICptZGF0YSA9IChteWRhdGFfdCAqKSBtYzsNCisgICAgbWVzc2FnZV9kYXRhX3QgKm1kID0g
bWRhdGEtPm07DQorICAgIGludCByZXQ7DQorICAgIGNoYXIgKm1haWxib3huYW1lID0gZmMtPm1h
aWxib3g7DQorICAgIGNoYXIgbmFtZWJ1ZltNQVhfTUFJTEJPWF9OQU1FXTsNCisNCisgICAgaWYg
KHNkLT51c2VybmFtZSAmJiAhc3RybmNhc2VjbXAobWFpbGJveG5hbWUsICJJTkJPWCIsIDUpKSB7
DQorCS8qIGNhbm9uaWNhbGl6ZSBtYWlsYm94ICovDQorCXNucHJpbnRmKG5hbWVidWYsIHNpemVv
ZiBuYW1lYnVmLA0KKwkJICIlcyt1c2VyLiVzJXMiLCBCQiwgc2QtPnVzZXJuYW1lLCBtYWlsYm94
bmFtZSArIDUpOw0KKyAgICB9IGVsc2Ugew0KKwlzbnByaW50ZihuYW1lYnVmLCBzaXplb2YgbmFt
ZWJ1ZiwgIiVzKyVzIiwgQkIsIG1haWxib3huYW1lKTsNCisgICAgfQ0KKw0KKyAgICAvKiBkZWxp
dmVyIGFzIHRoZSB1c2VyIHdobyBvd25zIHRoZSBzY3JpcHQgKi8NCisgICAgcmV0ID0gYWRkZGVz
dChtZGF0YSwgbmFtZWJ1Ziwgc2QtPnVzZXJuYW1lKTsNCisgICAgc25tcF9pbmNyZW1lbnQoU0lF
VkVfRklMRUlOVE8sIDEpOw0KKw0KKyAgICBpZiAoIXJldCkgew0KKwlyZXR1cm4gU0lFVkVfT0s7
DQorICAgIH0gZWxzZSB7DQorCXJldHVybiBTSUVWRV9GQUlMOw0KKyAgICB9DQorfQ0KKw0KK3N0
YXRpYw0KK2ludCBzaWV2ZV9rZWVwKHZvaWQgKmFjLCB2b2lkICppYywgdm9pZCAqc2MsIHZvaWQg
Km1jLCBjb25zdCBjaGFyICoqZXJybXNnKQ0KK3sNCisgICAgc2lldmVfa2VlcF9jb250ZXh0X3Qg
KmtjID0gKHNpZXZlX2tlZXBfY29udGV4dF90ICopIGFjOw0KKyAgICBzY3JpcHRfZGF0YV90ICpz
ZCA9IChzY3JpcHRfZGF0YV90ICopIHNjOw0KKyAgICBteWRhdGFfdCAqbXlkYXRhID0gKG15ZGF0
YV90ICopIG1jOw0KKyAgICBtZXNzYWdlX2RhdGFfdCAqbWQgPSBteWRhdGEtPm07DQorICAgIGNo
YXIgbmFtZWJ1ZltNQVhfTUFJTEJPWF9OQU1FXTsNCisgICAgaW50IHJldCA9IDE7DQorDQorICAg
IGlmIChzZC0+bWFpbGJveG5hbWUpIHsNCisJc25wcmludGYobmFtZWJ1Ziwgc2l6ZW9mKG5hbWVi
dWYpLCANCisJCSAiJXMrJXMiLCBzZC0+dXNlcm5hbWUsIHNkLT5tYWlsYm94bmFtZSk7DQorICAg
IH0gZWxzZSB7DQorCXNucHJpbnRmKG5hbWVidWYsIHNpemVvZihuYW1lYnVmKSwgIiVzIiwgc2Qt
PnVzZXJuYW1lKTsNCisgICAgfQ0KKw0KKyAgICBzbm1wX2luY3JlbWVudChTSUVWRV9LRUVQLCAx
KTsNCisgICAgcmV0dXJuIFNJRVZFX09LOw0KK30NCisNCitzdGF0aWMgaW50IHNpZXZlX25vdGlm
eSh2b2lkICphYywNCisJCQl2b2lkICppbnRlcnBfY29udGV4dCwgDQorCQkJdm9pZCAqc2NyaXB0
X2NvbnRleHQsDQorCQkJdm9pZCAqbWMsDQorCQkJY29uc3QgY2hhciAqKmVycm1zZykNCit7DQor
ICAgIHNpZXZlX25vdGlmeV9jb250ZXh0X3QgKm5jID0gKHNpZXZlX25vdGlmeV9jb250ZXh0X3Qg
KikgYWM7DQorICAgIHNjcmlwdF9kYXRhX3QgKnNkID0gKHNjcmlwdF9kYXRhX3QgKikgc2NyaXB0
X2NvbnRleHQ7DQorDQorICAgIHNubXBfaW5jcmVtZW50KFNJRVZFX05PVElGWSwgMSk7DQorDQor
ICAgIG5vdGlmeSgiU0lFVkUiLA0KKwkgICBuYy0+cHJpb3JpdHksDQorCSAgIHNkLT51c2VybmFt
ZSwNCisJICAgTlVMTCwNCisJICAgbmMtPm1lc3NhZ2UpOw0KKyAgICANCisgICAgcmV0dXJuIFNJ
RVZFX09LOw0KK30NCis9PT09PT09DQorPj4+Pj4+PiAxLjM3DQogDQogICAgIC8qIGdldCBhIGNv
bm5lY3Rpb24gdG8gdGhlIG11cGRhdGUgc2VydmVyICovDQogICAgIHIgPSAwOw0KSW5kZXg6IGlt
YXAvbWFpbGJveC5jDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9z
eXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL21haWxib3guYyx2DQpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuMTMzDQpkaWZmIC11IC1yMS4xMzMgbWFpbGJveC5jDQotLS0gbWFpbGJveC5jCTIwMDIvMDUv
MjggMTU6NTU6MDUJMS4xMzMNCisrKyBtYWlsYm94LmMJMjAwMi8wNi8xNCAxNzowNTowOQ0KQEAg
LTEyMCw2ICsxMjAsNyBAQA0KICAgICAicmVzZW50LWZyb20iLA0KICAgICAibmV3c2dyb3VwcyIs
DQogICAgICJmb2xsb3d1cC10byIsDQorICAgIC8qIHh4eCB3YW50IFgtUHJpb3JpdHkgZm9yIE1v
emlsbGE6ICovDQogfTsNCiBpbnQgbWFpbGJveF9udW1fY2FjaGVfaGVhZGVyID0NCiAgIHNpemVv
ZihtYWlsYm94X2NhY2hlX2hlYWRlcl9uYW1lKS9zaXplb2YoY2hhciAqKTsNCkBAIC0xNTMsNyAr
MTU0LDcgQEANCiAgICAgc3RydWN0IHN0YXQgc2J1ZjsNCiANCiAgICAgLyogaWYgbm90IGNvbmZp
Z3VyZWQgdG8gZG8gYWNhcCBkbyBub3RoaW5nICovDQotICAgIGlmIChjb25maWdfZ2V0c3RyaW5n
KCJhY2FwX3NlcnZlciIsIE5VTEwpPT1OVUxMKSByZXR1cm4gMDsNCisgICAgaWYgKGNvbmZpZ19n
ZXRzdHJpbmcoSU1BUE9QVF9BQ0FQX1NFUlZFUikgPT0gTlVMTCkgcmV0dXJuIDA7DQogDQogICAg
IGlmICgocyA9IHNvY2tldChBRl9VTklYLCBTT0NLX0RHUkFNLCAwKSkgPT0gLTEpIHsNCiAJcmV0
dXJuIElNQVBfSU9FUlJPUjsNCkluZGV4OiBpbWFwL21ib3hsaXN0LmMNCj09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJD
UyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvbWJv
eGxpc3QuYyx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTk2DQpkaWZmIC11IC1yMS4xOTYgbWJv
eGxpc3QuYw0KLS0tIG1ib3hsaXN0LmMJMjAwMi8wNi8wMyAxOTozOToyOQkxLjE5Ng0KKysrIG1i
b3hsaXN0LmMJMjAwMi8wNi8xNCAxNzowNTowOQ0KQEAgLTExNSwxNSArMTE1LDcgQEANCiANCiAg
ICAgYXNzZXJ0KHBhcnRpdGlvbiAmJiBwYXRocCk7DQogDQotICAgIHBhcnRpdGlvbmxlbiA9IHN0
cmxlbihwYXJ0aXRpb24pOw0KLQ0KLSAgICBpZiAocGFydGl0aW9ubGVuID4gc2l6ZW9mKG9wdGlv
bmJ1ZiktMTEpIHsNCi0JcmV0dXJuIElNQVBfUEFSVElUSU9OX1VOS05PV047DQotICAgIH0NCi0g
ICAgc3RyY3B5KG9wdGlvbmJ1ZiwgInBhcnRpdGlvbi0iKTsNCi0gICAgc3RyY2F0KG9wdGlvbmJ1
ZiwgcGFydGl0aW9uKTsNCi0gICAgDQotICAgIHJvb3QgPSBjb25maWdfZ2V0c3RyaW5nKG9wdGlv
bmJ1ZiwgKGNoYXIgKikwKTsNCisgICAgcm9vdCA9IGNvbmZpZ19wYXJ0aXRpb25kaXIocGFydGl0
aW9uKTsNCiAgICAgaWYgKCFyb290KSB7DQogCXJldHVybiBJTUFQX1BBUlRJVElPTl9VTktOT1dO
Ow0KICAgICB9DQpAQCAtMTQ0LDcgKzEzNiw3IEBADQogDQogc3RhdGljIGNvbnN0IGludCBnZXRf
ZGVsZXRlcmlnaHQodm9pZCkNCiB7DQotICAgIGNvbnN0IGNoYXIgKnIgPSBjb25maWdfZ2V0c3Ry
aW5nKCJkZWxldGVyaWdodCIsICJjIik7DQorICAgIGNvbnN0IGNoYXIgKnIgPSBjb25maWdfZ2V0
c3RyaW5nKElNQVBPUFRfREVMRVRFUklHSFQpOw0KIA0KICAgICByZXR1cm4gY3lydXNfYWNsX3N0
cnRvbWFzayhyKTsNCiB9DQpAQCAtMjk0LDcgKzI4Niw3IEBADQogICAgIHN0cmNweShvcHRpb25i
dWYsICJwYXJ0aXRpb24tIik7DQogICAgIHN0cmNweShvcHRpb25idWYgKyAxMCwgcGFydGl0aW9u
KTsNCiAgICAgDQotICAgIHJvb3QgPSBjb25maWdfZ2V0c3RyaW5nKG9wdGlvbmJ1ZiwgKGNoYXIg
KikwKTsNCisgICAgcm9vdCA9IGNvbmZpZ19wYXJ0aXRpb25kaXIocGFydGl0aW9uKTsNCiAgICAg
aWYgKCFyb290KSB7DQogCXJldHVybiBJTUFQX1BBUlRJVElPTl9VTktOT1dOOw0KICAgICB9DQpA
QCAtNDU1LDcgKzQ0Nyw3IEBADQogCSAgICAgKiBOb2JvZHkgZWxzZSBzdGFydHMgd2l0aCBhbnkg
YWNjZXNzIHRvIHNhbWUuDQogCSAgICAgKi8NCiAJICAgIGlkZW50aWZpZXIgPSB4c3RyZHVwKG5h
bWUrNSk7DQotCSAgICBpZiAoY29uZmlnX2dldHN3aXRjaCgidW5peGhpZXJhcmNoeXNlcCIsIDAp
KSB7DQorCSAgICBpZiAoY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX1VOSVhISUVSQVJDSFlTRVAp
KSB7DQogCQkvKg0KIAkJICogVGhlIG1haWxib3huYW1lIGlzIG5vdyBpbiB0aGUgaW50ZXJuYWwg
Zm9ybWF0LA0KIAkJICogc28gd2Ugd2UgbmVlZCB0byBjaGFuZ2UgRE9UQ0hBUnMgYmFjayB0byAn
LicNCkBAIC00NzAsNyArNDYyLDcgQEANCiAJICAgIGZyZWUoaWRlbnRpZmllcik7DQogCX0gZWxz
ZSB7DQogCSAgICBkZWZhdWx0YWNsID0gaWRlbnRpZmllciA9IA0KLQkJeHN0cmR1cChjb25maWdf
Z2V0c3RyaW5nKCJkZWZhdWx0YWNsIiwgImFueW9uZSBscnMiKSk7DQorCQl4c3RyZHVwKGNvbmZp
Z19nZXRzdHJpbmcoSU1BUE9QVF9ERUZBVUxUQUNMKSk7DQogCSAgICBmb3IgKDs7KSB7DQogCQl3
aGlsZSAoKmlkZW50aWZpZXIgJiYgaXNzcGFjZSgoaW50KSAqaWRlbnRpZmllcikpIGlkZW50aWZp
ZXIrKzsNCiAJCXJpZ2h0cyA9IGlkZW50aWZpZXI7DQpAQCAtNTc1LDggKzU2Nyw3IEBADQogDQog
ICAgIGlmICghKG1idHlwZSAmIE1CVFlQRV9SRU1PVEUpKSB7DQogCS8qIEdldCBwYXJ0aXRpb24n
cyBwYXRoICovDQotCXNwcmludGYoYnVmLCAicGFydGl0aW9uLSVzIiwgbmV3cGFydGl0aW9uKTsN
Ci0Jcm9vdCA9IGNvbmZpZ19nZXRzdHJpbmcoYnVmLCAoY2hhciAqKTApOw0KKwlyb290ID0gY29u
ZmlnX3BhcnRpdGlvbmRpcihuZXdwYXJ0aXRpb24pOw0KIAlpZiAoIXJvb3QpIHsNCiAJICAgIHIg
PSBJTUFQX1BBUlRJVElPTl9VTktOT1dOOw0KIAkgICAgZ290byBkb25lOw0KQEAgLTEwNTMsMTkg
KzEwNDQsNjAgQEANCiAJfQ0KICAgICB9DQogDQorPDw8PDw8PCBtYm94bGlzdC5jDQorPDw8PDw8
PCBtYm94bGlzdC5jDQorICAgIGlmICghciAmJiAhcGFydGl0aW9ubW92ZSkgew0KKwkvKiAzLiBv
cGVuIEFDQVAgY29ubmVjdGlvbiBpZiBuZWNlc3NhcnkgKi8NCisJYWNhcG1ib3hfaGFuZGxlX3Qg
KmFjYXBoYW5kbGUgPSBhY2FwbWJveF9nZXRfaGFuZGxlKCk7DQorDQorCS8qIDUuIEFDQVAgbWFr
ZSB0aGUgbmV3IGVudHJ5LCBzZXQgYXMgcmVzZXJ2ZWQgKi8NCisJYWNhcG1ib3hfbmV3KCZtYm94
ZGF0YSwgTlVMTCwgbmV3bmFtZSk7DQorCXIgPSBhY2FwbWJveF9jcmVhdGUoYWNhcGhhbmRsZSwg
Jm1ib3hkYXRhKTsNCisJaWYgKHIgIT0gQUNBUF9PSykgew0KKwkgICAgZ290byBkb25lOw0KKwl9
DQorCWFjYXBfbWFkZW5ldyA9IDE7DQorPT09PT09PQ0KKyAgICBpZiAoIXIgJiYgIXBhcnRpdGlv
bm1vdmUgJiYgbXVwZGF0ZV9zZXJ2ZXIpIHsNCisJLyogUmVzZXJ2ZSBuZXcgbmFtZSBpbiBNVVBE
QVRFICovDQorCWNoYXIgYnVmW01BWF9QQVJUSVRJT05fTEVOICsgSE9TVE5BTUVfU0laRSArIDJd
Ow0KKwlzcHJpbnRmKGJ1ZiwgIiVzISVzIiwgY29uZmlnX3NlcnZlcm5hbWUsIG5ld3BhcnRpdGlv
bik7DQorCQ0KKwlyID0gbXVwZGF0ZV9jb25uZWN0KG11cGRhdGVfc2VydmVyLCBOVUxMLCAmbXVw
ZGF0ZV9oLCBOVUxMKTsNCisJaWYocikgew0KKwkgICAgc3lzbG9nKExPR19FUlIsDQorCQkgICAi
Y2FuIG5vdCBjb25uZWN0IHRvIG11cGRhdGUgc2VydmVyIGZvciByZXNlcnZhdGlvbiBvbiAnJXMn
IiwNCisJCSAgIG5ld25hbWUpOw0KKwkgICAgZ290byBkb25lOw0KKwl9DQorCQ0KKwkvKiByZXNl
cnZlIHRoZSBtYWlsYm94IGluIE1VUERBVEUgKi8NCisJciA9IG11cGRhdGVfcmVzZXJ2ZShtdXBk
YXRlX2gsIG5ld25hbWUsIGJ1Zik7DQorPT09PT09PQ0KICAgICAvKiAzLiBPcGVuIG11cGRhdGUg
Y29ubmVjdGlvbiBhbmQgcmVzZXJ2ZSBuZXcgbmFtZSAoaWYgbmVlZGVkKSAqLyANCiAgICAgaWYo
IXIgJiYgY29uZmlnX211cGRhdGVfc2VydmVyKSB7CQ0KIAlyID0gbXVwZGF0ZV9jb25uZWN0KGNv
bmZpZ19tdXBkYXRlX3NlcnZlciwgTlVMTCwgJm11cGRhdGVfaCwgTlVMTCk7DQorPj4+Pj4+PiAx
LjE5Ng0KIAlpZihyKSB7DQogCSAgICBzeXNsb2coTE9HX0VSUiwNCiAJCSAgICJjYW4gbm90IGNv
bm5lY3QgdG8gbXVwZGF0ZSBzZXJ2ZXIgZm9yIHJlbmFtZSBvZiAnJXMnIiwNCiAJCSAgIG5ld25h
bWUpOw0KIAkgICAgZ290byBkb25lOw0KIAl9DQorPDw8PDw8PCBtYm94bGlzdC5jDQorCQ0KKwlt
YWRlbmV3ID0gMTsNCisgICAgfSBlbHNlIGlmKCFyICYmIHBhcnRpdGlvbm1vdmUgJiYgbXVwZGF0
ZV9zZXJ2ZXIpIHsNCisJLyogY29tbWl0IHRoZSB1cGRhdGUgdG8gTVVQREFURSAqLw0KKwljaGFy
IGJ1ZltNQVhfUEFSVElUSU9OX0xFTiArIEhPU1ROQU1FX1NJWkUgKyAyXTsNCisJc3ByaW50Zihi
dWYsICIlcyElcyIsIGNvbmZpZ19zZXJ2ZXJuYW1lLCBuZXdwYXJ0aXRpb24pOw0KKz4+Pj4+Pj4g
MS4xNzENCis9PT09PT09DQogCWlmICghcGFydGl0aW9ubW92ZSkgew0KIAkgICAgLyogUmVzZXJ2
ZSBuZXcgbmFtZSBpbiBNVVBEQVRFICovDQogCSAgICBjaGFyIGJ1ZltNQVhfUEFSVElUSU9OX0xF
TiArIEhPU1ROQU1FX1NJWkUgKyAyXTsNCiAJICAgIHNwcmludGYoYnVmLCAiJXMhJXMiLCBjb25m
aWdfc2VydmVybmFtZSwgbmV3cGFydGl0aW9uKTsNCis+Pj4+Pj4+IDEuMTk2DQogDQogCSAgICBy
ID0gbXVwZGF0ZV9yZXNlcnZlKG11cGRhdGVfaCwgbmV3bmFtZSwgYnVmKTsNCiAJICAgIGlmKHIp
IHsNCkBAIC0xMjYzLDExICsxMjk1LDE5IEBADQogCQkgICAiTVVQREFURTogY2FuJ3QgZGVsZXRl
IG1haWxib3ggZW50cnkgJyVzJyIsIG9sZG5hbWUpOw0KIAl9DQogICAgIH0NCis8PDw8PDw8IG1i
b3hsaXN0LmMNCis9PT09PT09DQogDQogICAgIGlmKG9sZG9wZW4pIG1haWxib3hfY2xvc2UoJm9s
ZG1haWxib3gpOw0KKz4+Pj4+Pj4gMS4xOTYNCisNCis8PDw8PDw8IG1ib3hsaXN0LmMNCisgICAg
aWYobXVwZGF0ZV9zZXJ2ZXIpIG11cGRhdGVfZGlzY29ubmVjdCgmbXVwZGF0ZV9oKTsNCiANCis9
PT09PT09DQogICAgIGlmKGNvbmZpZ19tdXBkYXRlX3NlcnZlcikgbXVwZGF0ZV9kaXNjb25uZWN0
KCZtdXBkYXRlX2gpOw0KIA0KKz4+Pj4+Pj4gMS4xOTYNCiAgICAgLyogZnJlZSBtZW1vcnkgKi8N
CiAgICAgaWYgKG5ld2FjbCkgZnJlZShuZXdhY2wpOwkvKiB3ZSdyZSBkb25lIHdpdGggdGhlIG5l
dyBBQ0wgKi8NCiAgICAgaWYgKG5ld3BhcnRpdGlvbikgZnJlZShuZXdwYXJ0aXRpb24pOw0KQEAg
LTEzOTAsOSArMTQzMCwzMSBAQA0KIAl9DQogICAgIH0NCiANCisgICAgLyogb2ssIG1ha2UgdGhl
IGNoYW5nZSAqLw0KKyAgICBtYm94ZW50ID0gbWJveGxpc3RfbWFrZWVudHJ5KG1idHlwZSwgcGFy
dGl0aW9uLCBuZXdhY2wpOw0KKw0KKyAgICByID0gREItPnN0b3JlKG1iZGIsIG5hbWUsIHN0cmxl
bihuYW1lKSwgbWJveGVudCwgc3RybGVuKG1ib3hlbnQpLCAmdGlkKTsNCisgICAgc3dpdGNoIChy
KSB7DQorICAgIGNhc2UgMDoNCisJYnJlYWs7DQorICAgIGNhc2UgQ1lSVVNEQl9BR0FJTjoNCisJ
Z290byByZXRyeTsNCisgICAgZGVmYXVsdDoNCisJc3lzbG9nKExPR19FUlIsICJEQkVSUk9SOiBl
cnJvciB1cGRhdGluZyBhY2wgJXM6ICVzIiwNCisJICAgICAgIG5hbWUsIGN5cnVzZGJfc3RyZXJy
b3IocikpOw0KKwlyID0gSU1BUF9JT0VSUk9SOw0KKwlnb3RvIGRvbmU7DQorICAgIH0NCisNCis8
PDw8PDw8IG1ib3hsaXN0LmMNCisgICAgaWYgKCEobWJ0eXBlICYgTUJUWVBFX1JFTU9URSkpIHsN
CisJLyogb3BlbiAmIGxvY2sgbWFpbGJveCBoZWFkZXIgKi8NCisgICAgICAgIHIgPSBtYWlsYm94
X29wZW5faGVhZGVyX3BhdGgobmFtZSwgcGF0aCwgYWNsLCBOVUxMLCAmbWFpbGJveCwgMCk7DQor
PT09PT09PQ0KICAgICBpZighcikgew0KIAkvKiBvaywgY2hhbmdlIHRoZSBkYXRhYmFzZSAqLw0K
IAltYm94ZW50ID0gbWJveGxpc3RfbWFrZWVudHJ5KG1idHlwZSwgcGFydGl0aW9uLCBuZXdhY2wp
Ow0KKz4+Pj4+Pj4gMS4xOTYNCiANCiAJZG8gew0KIAkgICAgciA9IERCLT5zdG9yZShtYmRiLCBu
YW1lLCBzdHJsZW4obmFtZSksDQpAQCAtMTQwNiw2ICsxNDY4LDEzIEBADQogCX0NCiAgICAgfQ0K
IA0KKyAgZG9uZToNCisgICAgaWYgKG1ib3hlbnQpIGZyZWUobWJveGVudCk7DQorDQorPDw8PDw8
PCBtYm94bGlzdC5jDQorICAgIGlmIChyKSB7DQorCWludCByMjsNCis9PT09PT09DQogICAgIC8q
IDQuIENoYW5nZSBiYWNrdXAgY29weSAoY3lydXMuaGVhZGVyKSAqLw0KICAgICAvKiB3ZSBhbHJl
YWR5IGhhdmUgaXQgbG9ja2VkIGZyb20gYWJvdmUgKi8NCiAgICAgaWYgKCFyICYmICEobWJ0eXBl
ICYgTUJUWVBFX1JFTU9URSkpIHsNCkBAIC0xNDEzLDYgKzE0ODIsNyBAQA0KIAltYWlsYm94LmFj
bCA9IHhzdHJkdXAobmV3YWNsKTsNCiAJciA9IG1haWxib3hfd3JpdGVfaGVhZGVyKCZtYWlsYm94
KTsNCiAgICAgfQ0KKz4+Pj4+Pj4gMS4xOTYNCiANCiAgICAgLyogNS4gQ29tbWl0IHRyYW5zYWN0
aW9uICovDQogICAgIGlmICghcikgew0KSW5kZXg6IGltYXAvbWJveG5hbWUuYw0KPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQ0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1h
cC9tYm94bmFtZS5jLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS4yNQ0KZGlmZiAtdSAtcjEuMjUg
bWJveG5hbWUuYw0KLS0tIG1ib3huYW1lLmMJMjAwMi8wMS8yNCAxNjozOToyOAkxLjI1DQorKysg
bWJveG5hbWUuYwkyMDAyLzA2LzE0IDE3OjA1OjA5DQpAQCAtMzA3LDE0ICszMDcsMTUgQEANCiAN
CiAgICAgYXNzZXJ0KG5hbWVzcGFjZSAhPSBOVUxMKTsNCiANCi0gICAgbmFtZXNwYWNlLT5oaWVy
X3NlcCA9IGNvbmZpZ19nZXRzd2l0Y2goInVuaXhoaWVyYXJjaHlzZXAiLCAwKSA/ICcvJyA6ICcu
JzsNCi0gICAgbmFtZXNwYWNlLT5pc2FsdCA9ICFmb3JjZV9zdGQgJiYgY29uZmlnX2dldHN3aXRj
aCgiYWx0bmFtZXNwYWNlIiwgMCk7DQorICAgIG5hbWVzcGFjZS0+aGllcl9zZXAgPSBjb25maWdf
Z2V0c3dpdGNoKElNQVBPUFRfVU5JWEhJRVJBUkNIWVNFUCkgPyANCisgICAgICAnLycgOiAnLic7
DQorICAgIG5hbWVzcGFjZS0+aXNhbHQgPSAhZm9yY2Vfc3RkICYmIGNvbmZpZ19nZXRzd2l0Y2go
SU1BUE9QVF9BTFROQU1FU1BBQ0UpOw0KIA0KICAgICBpZiAobmFtZXNwYWNlLT5pc2FsdCkgew0K
IAkvKiBhbHRlcm5hdGUgbmFtZXNwYWNlICovDQogCXN0cmNweShuYW1lc3BhY2UtPnByZWZpeFtO
QU1FU1BBQ0VfSU5CT1hdLCAiIik7DQogDQotCXByZWZpeCA9IGNvbmZpZ19nZXRzdHJpbmcoInVz
ZXJwcmVmaXgiLCAiT3RoZXIgVXNlcnMiKTsNCisJcHJlZml4ID0gY29uZmlnX2dldHN0cmluZyhJ
TUFQT1BUX1VTRVJQUkVGSVgpOw0KIAlpZiAoIXByZWZpeCB8fCBzdHJsZW4ocHJlZml4KSA9PSAw
IHx8DQogCSAgICBzdHJsZW4ocHJlZml4KSA+PSBNQVhfTkFNRVNQQUNFX1BSRUZJWCB8fA0KIAkg
ICAgc3RyY2hyKHByZWZpeCxuYW1lc3BhY2UtPmhpZXJfc2VwKSAhPSBOVUxMKQ0KQEAgLTMyMiw3
ICszMjMsNyBAQA0KIAlzcHJpbnRmKG5hbWVzcGFjZS0+cHJlZml4W05BTUVTUEFDRV9VU0VSXSwg
IiUuKnMlYyIsDQogCQlNQVhfTkFNRVNQQUNFX1BSRUZJWC0xLCBwcmVmaXgsIG5hbWVzcGFjZS0+
aGllcl9zZXApOw0KIA0KLQlwcmVmaXggPSBjb25maWdfZ2V0c3RyaW5nKCJzaGFyZWRwcmVmaXgi
LCAiU2hhcmVkIEZvbGRlcnMiKTsNCisJcHJlZml4ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BU
X1NIQVJFRFBSRUZJWCk7DQogCWlmICghcHJlZml4IHx8IHN0cmxlbihwcmVmaXgpID09IDAgfHwN
CiAJICAgIHN0cmxlbihwcmVmaXgpID49IE1BWF9OQU1FU1BBQ0VfUFJFRklYIHx8DQogCSAgICBz
dHJjaHIocHJlZml4LCBuYW1lc3BhY2UtPmhpZXJfc2VwKSAhPSBOVUxMIHx8DQpAQCAtNDY1LDcg
KzQ2Niw3IEBADQogICAgIGludCB1Y3M0Ow0KICAgICBpbnQgdW5peHNlcDsNCiANCi0gICAgdW5p
eHNlcCA9IGNvbmZpZ19nZXRzd2l0Y2goInVuaXhoaWVyYXJjaHlzZXAiLCAwKTsNCisgICAgdW5p
eHNlcCA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9VTklYSElFUkFSQ0hZU0VQKTsNCiANCiAg
ICAgaWYgKHN0cmxlbihuYW1lKSA+IE1BWF9NQUlMQk9YX05BTUUpIHJldHVybiBJTUFQX01BSUxC
T1hfQkFETkFNRTsNCiAgICAgZm9yIChpID0gMDsgaSA8IE5VTV9CQURNQk9YUEFUVEVSTlM7IGkr
Kykgew0KSW5kZXg6IGltYXAvbWVzc2FnZS5jDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2Fmcy9h
bmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL21lc3NhZ2UuYyx2DQpyZXRy
aWV2aW5nIHJldmlzaW9uIDEuODgNCmRpZmYgLXUgLXIxLjg4IG1lc3NhZ2UuYw0KLS0tIG1lc3Nh
Z2UuYwkyMDAwLzEyLzI2IDIxOjM1OjQxCTEuODgNCisrKyBtZXNzYWdlLmMJMjAwMi8wNi8xNCAx
NzowNToxMA0KQEAgLTIyOCw3ICsyMjgsNyBAQA0KICAgICBpbnQgciA9IDA7DQogICAgIGludCBu
Ow0KICAgICBpbnQgc2F3Y3IgPSAwLCBzYXdubDsNCi0gICAgaW50IHJlamVjdDhiaXQgPSBjb25m
aWdfZ2V0c3dpdGNoKCJyZWplY3Q4Yml0IiwgMCk7DQorICAgIGludCByZWplY3Q4Yml0ID0gY29u
ZmlnX2dldHN3aXRjaChJTUFQT1BUX1JFSkVDVDhCSVQpOw0KICAgICBpbnQgaW5oZWFkZXIgPSAx
LCBibGFua2xpbmUgPSAxOw0KIA0KICAgICB3aGlsZSAoc2l6ZSkgew0KSW5kZXg6IGltYXAvbXVw
ZGF0ZS5jDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0v
Y3ZzL3NyYy9jeXJ1cy9pbWFwL211cGRhdGUuYyx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNjAN
CmRpZmYgLXUgLXIxLjYwIG11cGRhdGUuYw0KLS0tIG11cGRhdGUuYwkyMDAyLzA2LzAzIDE4OjIy
OjI2CTEuNjANCisrKyBtdXBkYXRlLmMJMjAwMi8wNi8xNCAxNzowNToxMQ0KQEAgLTMxNiw4ICsz
MTYsNiBAQA0KICAgICBpbnQgcjsNCiAgICAgaW50IG9wdDsNCiANCi0gICAgY29uZmlnX2NoYW5n
ZWlkZW50KCJtdXBkYXRlIik7DQotICAgIA0KICAgICBpZiAoZ2V0ZXVpZCgpID09IDApIGZhdGFs
KCJtdXN0IHJ1biBhcyB0aGUgQ3lydXMgdXNlciIsIEVDX1VTQUdFKTsNCiANCiAgICAgLyogc2V0
IHNpZ25hbCBoYW5kbGVycyAqLw0KQEAgLTc5OCwxMyArNzk2LDEyOSBAQA0KICAgICByZXR1cm4g
MDsNCiB9DQogDQorPDw8PDw8PCBtdXBkYXRlLmMNCisvKiBtYWlsYm94IG5hbWUgTVVTVCBiZSBm
aXJzdCwgc2luY2UgaXQgaXMgdGhlIGtleSAqLw0KK3N0cnVjdCBtYmVudCB7DQorICAgIGNoYXIg
bWFpbGJveFtNQVhfTUFJTEJPWF9OQU1FXTsNCisgICAgY2hhciBzZXJ2ZXJbTUFYX01BSUxCT1hf
TkFNRV07DQorICAgIGVudW0gc2V0dHlwZSB0Ow0KKyAgICBjaGFyIGFjbFsxXTsNCit9Ow0KKw0K
K3N0YXRpYyBGSUxFICpkYmxvZzsNCisNCisvKiB0aGlzIGRlcGVuZHMgb24gbWFpbGJveCBuYW1l
IGJlaW5nIGZpcnN0ICovDQorc3RhdGljIGludCBteWNtcChjb25zdCB2b2lkICp2MSwgY29uc3Qg
dm9pZCAqdjIpDQorew0KKyAgICByZXR1cm4gc3RyY21wKChjb25zdCBjaGFyICopIHYxLCAoY29u
c3QgY2hhciAqKSB2Mik7DQorfQ0KKw0KKy8qIHJlYWQgZnJvbSBkaXNrDQorIGRhdGFiYXNlIG11
c3QgYmUgdW5sb2NrZWQuICovDQorPT09PT09PQ0KIC8qIHJlYWQgZnJvbSBkaXNrIGRhdGFiYXNl
IG11c3QgYmUgdW5sb2NrZWQuICovDQorPj4+Pj4+PiAxLjUyDQogdm9pZCBkYXRhYmFzZV9pbml0
KCkNCiB7DQogICAgIHB0aHJlYWRfbXV0ZXhfbG9jaygmbWFpbGJveGVzX211dGV4KTsgLyogTE9D
SyAqLw0KKzw8PDw8PDwgbXVwZGF0ZS5jDQorDQorICAgIG1haWxib3hlcyA9IHNraXBsaXN0X25l
dygyMCwgMC41LCAmbXljbXApOw0KKyAgICBzbnByaW50ZihkYm5hbWUsIHNpemVvZiBkYm5hbWUs
ICIlcy8lcyIsIGNvbmZpZ19kaXIsICJtdXBkYXRlLmxvZyIpOw0KKyAgICBkYiA9IGZvcGVuKGRi
bmFtZSwgInIiKTsNCisgICAgaWYgKGRiICE9IE5VTEwpIHsNCisJd2hpbGUgKCFmZW9mKGRiKSkg
ew0KKwkgICAgaW50IGM7DQorCSAgICBzdHJ1Y3QgbWJlbnQgbSwgKm1wdHI7DQorCSAgICBpbnQg
aSA9IDA7DQorDQorCSAgICBjID0gZmdldGMoZGIpOw0KKwkgICAgaWYgKGMgPT0gJ0EnKSBtLnQg
PSBTRVRfQUNUSVZFOw0KKwkgICAgZWxzZSBpZiAoYyA9PSAnUicpIG0udCA9IFNFVF9SRVNFUlZF
Ow0KKwkgICAgZWxzZSBpZiAoYyA9PSAnRCcpIG0udCA9IFNFVF9ERUxFVEU7DQorCSAgICBlbHNl
IGlmIChjID09IC0xKSBicmVhazsNCisJICAgIGVsc2UgYWJvcnQoKTsNCisNCisJICAgIC8qIHNr
aXAgYWZ0ZXIgXHQgKi8NCisJICAgIHdoaWxlICgoYyA9IGZnZXRjKGRiKSkgPiAwKSB7DQorCQlp
ZiAoYyA9PSAnXHQnKSBicmVhazsNCisJICAgIH0NCisJICAgIGlmIChjIDwgMCkgYnJlYWs7DQor
DQorCSAgICB3aGlsZSAoKGMgPSBmZ2V0YyhkYikpID4gMCkgew0KKwkJaWYgKGMgPT0gJ1xuJyB8
fCBjID09ICdcdCcpIGJyZWFrOw0KKwkJbS5tYWlsYm94W2krK10gPSBjOw0KKwkJYXNzZXJ0KGkg
IT0gTUFYX01BSUxCT1hfTkFNRSk7DQorCSAgICB9DQorCSAgICBtLm1haWxib3hbaV0gPSAnXDAn
Ow0KKw0KKwkgICAgc3dpdGNoIChtLnQpIHsNCisJICAgIGNhc2UgU0VUX0FDVElWRToNCisJICAg
IHsNCisJCWNoYXIgKmFjbCA9IE5VTEw7DQorCQlpbnQgYWNsYWxsb2MgPSAwOw0KKw0KKwkJaSA9
IDA7DQorCQl3aGlsZSAoKGMgPSBmZ2V0YyhkYikpID4gMCkgew0KKwkJICAgIGlmIChjID09ICdc
bicgfHwgYyA9PSAnXHQnKSBicmVhazsNCisJCSAgICBtLnNlcnZlcltpKytdID0gYzsNCisJCSAg
ICBhc3NlcnQoaSAhPSBNQVhfTUFJTEJPWF9OQU1FKTsNCisJCX0NCisJCW0uc2VydmVyW2ldID0g
J1wwJzsNCisNCisJCWFzc2VydChjID09ICdcdCcpOw0KKwkJaSA9IDA7DQorCQl3aGlsZSAoKGMg
PSBmZ2V0YyhkYikpID4gMCkgew0KKwkJICAgIGlmIChjID09ICdcbicgfHwgYyA9PSAnXHQnKSBi
cmVhazsNCisJCSAgICBpZiAoaSA9PSBhY2xhbGxvYykgew0KKwkJCWFjbCA9IHhyZWFsbG9jKGFj
bCwgYWNsYWxsb2MgKz0gNTAwKTsNCisJCSAgICB9DQorCQkgICAgYWNsW2krK10gPSBjOw0KKwkJ
fQ0KIA0KKwkJbXB0ciA9IHhtYWxsb2Moc2l6ZW9mKHN0cnVjdCBtYmVudCkgKyAoaSArIDEpKTsN
CisJCW1lbWNweShtcHRyLCAmbSwgc2l6ZW9mKHN0cnVjdCBtYmVudCkpOw0KKwkJbWVtY3B5KG1w
dHItPmFjbCwgYWNsLCBpKTsNCisJCW1wdHItPmFjbFtpXSA9ICdcMCc7DQorCQlpZiAoYWNsKSBm
cmVlKGFjbCk7DQorDQorCQlzaW5zZXJ0KG1haWxib3hlcywgbXB0cik7DQorCQlicmVhazsNCisJ
ICAgIH0NCisJICAgIGNhc2UgU0VUX1JFU0VSVkU6DQorCQlpID0gMDsNCisJCXdoaWxlICgoYyA9
IGZnZXRjKGRiKSkgPiAwKSB7DQorCQkgICAgaWYgKGMgPT0gJ1xuJyB8fCBjID09ICdcdCcpIGJy
ZWFrOw0KKwkJICAgIG0uc2VydmVyW2krK10gPSBjOw0KKwkJICAgIGFzc2VydChpICE9IE1BWF9N
QUlMQk9YX05BTUUpOw0KKwkJfQ0KKwkJbS5zZXJ2ZXJbaV0gPSAnXDAnOw0KKw0KKwkJbXB0ciA9
IHhtYWxsb2Moc2l6ZW9mKHN0cnVjdCBtYmVudCkpOw0KKwkJbWVtY3B5KG1wdHIsICZtLCBzaXpl
b2Yoc3RydWN0IG1iZW50KSk7DQorCQlzaW5zZXJ0KG1haWxib3hlcywgbXB0cik7DQorCQlicmVh
azsNCisJICAgIGNhc2UgU0VUX0RFTEVURToNCisJCXNkZWxldGUobWFpbGJveGVzLCAmbSk7DQor
CQlicmVhazsNCisJICAgIH0NCisJfQ0KKw0KKwlmY2xvc2UoZGIpOw0KKyAgICB9DQorPT09PT09
PQ0KKz4+Pj4+Pj4gMS41Mg0KKw0KKzw8PDw8PDwgbXVwZGF0ZS5jDQorICAgIGRibG9nID0gZm9w
ZW4oZGJuYW1lLCAiYSIpOw0KKyAgICBpZiAoZGJsb2cgPT0gTlVMTCkgew0KKwlzeXNsb2coTE9H
X0NSSVQsICJ1bmFibGUgdG8gb3BlbiBsb2dmaWxlICVzOiAlbSIsIGRibmFtZSk7DQorCWFib3J0
KCk7DQorICAgIH0NCis9PT09PT09DQogICAgIG1ib3hsaXN0X2luaXQoMCk7DQogICAgIG1ib3hs
aXN0X29wZW4oTlVMTCk7DQorPj4+Pj4+PiAxLjUyDQogDQogICAgIHB0aHJlYWRfbXV0ZXhfdW5s
b2NrKCZtYWlsYm94ZXNfbXV0ZXgpOyAvKiBVTkxPQ0sgKi8NCiB9DQpAQCAtODMxLDYgKzk0NSwx
MyBAQA0KIAkgICBtYWlsYm94IGNhbiBoYXZlISAqLw0KIAlhYm9ydCgpOw0KICAgICB9DQorICAg
IGlmIChmZmx1c2goZGJsb2cpIDwgMCkgew0KKwlzeXNsb2coTE9HX0VSUiwgImZmbHVzaCBtdXBk
YXRlIGxvZzogJW0iKTsNCisgICAgfQ0KKzw8PDw8PDwgbXVwZGF0ZS5jDQorICAgIGlmIChmc3lu
YyhmaWxlbm8oZGJsb2cpKSA8IDApIHsNCisJc3lzbG9nKExPR19FUlIsICJmc3luYyBtdXBkYXRl
IGxvZzogJW0iKTsNCis9PT09PT09DQogfQ0KIA0KIC8qIGxvb2t1cCBpbiBkYXRhYmFzZS4gZGF0
YWJhc2UgbXVzdCBiZSBsb2NrZWQgKi8NCkBAIC04NTgsNiArOTc5LDcgQEANCiAJZWxzZSBvdXQg
PSBtcG9vbF9tYWxsb2MocG9vbCwgc2l6ZW9mKHN0cnVjdCBtYmVudCkgKyBzdHJsZW4oYWNsKSk7
DQogCW91dC0+dCA9IFNFVF9BQ1RJVkU7DQogCXN0cmNweShvdXQtPmFjbCwgYWNsKTsNCis+Pj4+
Pj4+IDEuNTINCiAgICAgfQ0KIA0KICAgICBvdXQtPm1haWxib3ggPSAocG9vbCkgPyBtcG9vbF9z
dHJkdXAocG9vbCwgbmFtZSkgOiB4c3RyZHVwKG5hbWUpOw0KSW5kZXg6IGltYXAvbm90aWZ5X3Vu
aXguYw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IG5vdGlmeV91bml4LmMNCmRpZmYgLU4gbm90aWZ5
X3VuaXguYw0KLS0tIC9kZXYvbnVsbAlUdWUgTWF5ICA1IDE2OjMyOjI3IDE5OTgNCisrKyBub3Rp
ZnlfdW5peC5jCUZyaSBKdW4gMTQgMTM6MDU6MTEgMjAwMg0KQEAgLTAsMCArMSw5NSBAQA0KKy8q
IG5vdGlmeV91bml4LmMgLS0gTW9kdWxlIHRvIHNlbmQgbm90aWZpY2F0aW9ucyB0byBVbml4IHNv
Y2tldC1iYXNlZCBzZXJ2ZXINCisgKiAgICBDb3B5cmlnaHQgKGMpIDIwMDAtMjAwMSwgSmVyZW15
IEhvd2FyZCwgakBob3dhcmQuZm0NCisgKi8NCisNCisNCisjaW5jbHVkZSA8c3RkaW8uaD4NCisj
aW5jbHVkZSA8c3lzL3R5cGVzLmg+DQorI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4NCisjaW5jbHVk
ZSA8c3lzL3VuLmg+DQorI2luY2x1ZGUgPHN5cy90aW1lLmg+DQorI2luY2x1ZGUgPGVycm5vLmg+
DQorI2luY2x1ZGUgPHN0cmluZy5oPg0KKyNpbmNsdWRlIDx1bmlzdGQuaD4NCisjaW5jbHVkZSA8
c3lzbG9nLmg+DQorI2luY2x1ZGUgPGZjbnRsLmg+DQorI2luY2x1ZGUgImltYXBjb25mLmgiDQor
I2luY2x1ZGUgInJldHJ5LmgiDQorI2luY2x1ZGUgIm5vdGlmeS5oIg0KKw0KK2NvbnN0IGNoYXIg
Km5vdGlmeV9tZXRob2RfZGVzYyA9ICJ1bml4IjsNCisNCisjZGVmaW5lIEZOQU1FX05PVElGWV9T
T0NLICIvc29ja2V0L25vdGlmeSINCisNCit2b2lkIG5vdGlmeShjb25zdCBjaGFyICpjbGFzcywN
CisJICAgIGNvbnN0IGNoYXIgKmluc3RhbmNlLA0KKwkgICAgY29uc3QgY2hhciAqdXNlciwNCisJ
ICAgIGNvbnN0IGNoYXIgKm1haWxib3gsDQorCSAgICBjb25zdCBjaGFyICptZXNzYWdlKQ0KK3sN
CisgICAgY2hhciBidWZbODBdOw0KKyAgICBjb25zdCBjaGFyICpub3RpZnlfc29jazsNCisgICAg
c3RydWN0IHNvY2thZGRyIG15bmFtZTsNCisNCisgICAgaW50ICAgc29jaywgYWRkcmxlbiwgY250
Ow0KKyAgICBmZF9zZXQgcmVhZF90ZW1wbGF0ZSwgd3JpdGVfdGVtcGxhdGU7IA0KKyAgICBzdHJ1
Y3QgdGltZXZhbCB3YWl0OyANCisNCisgICAgaW50IGZkZmxhZ3M7DQorICAgIHN0cnVjdCBpb3Zl
YyBpb3ZbMjBdOw0KKyAgICBpbnQgbnVtX2lvdjsNCisNCisgICAgc29jayA9IHNvY2tldChBRl9V
TklYLCBTT0NLX1NUUkVBTSwgMCk7DQorICAgIGlmIChzb2NrIDwgMCkgew0KKwlzeXNsb2coTE9H
X0VSUiwgIm5vdGlmeV91bml4OiBzb2NrZXQoKTogJW0iKTsNCisJcmV0dXJuOw0KKyAgICB9DQor
DQorICAgIG15bmFtZS5zYV9mYW1pbHkgPSBBRl9VTklYOw0KKyAgICBub3RpZnlfc29jayA9IGNv
bmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9OT1RJRllTT0NLRVQpOw0KKyAgICBpZiAobm90aWZ5X3Nv
Y2spIHsJDQorCXN0cmNweShteW5hbWUuc2FfZGF0YSwgbm90aWZ5X3NvY2spOw0KKyAgICB9DQor
ICAgIGVsc2Ugew0KKwlzdHJjcHkobXluYW1lLnNhX2RhdGEsIGNvbmZpZ19kaXIpOw0KKwlzdHJj
YXQobXluYW1lLnNhX2RhdGEsIEZOQU1FX05PVElGWV9TT0NLKTsNCisgICAgfQ0KKyAgICBhZGRy
bGVuID0gc3RybGVuKG15bmFtZS5zYV9kYXRhKSArIHNpemVvZihteW5hbWUuc2FfZmFtaWx5KTsN
CisgICAgDQorICAgIC8qIHB1dCB1cyBpbiBub24tYmxvY2tpbmcgbW9kZSAqLw0KKyAgICBmZGZs
YWdzID0gZmNudGwoc29jaywgRl9HRVRGRCwgMCk7DQorICAgIGlmIChmZGZsYWdzICE9IC0xKSBm
ZGZsYWdzID0gZmNudGwoc29jaywgRl9TRVRGTCwgT19OT05CTE9DSyB8IGZkZmxhZ3MpOw0KKyAg
ICBpZiAoZmRmbGFncyA9PSAtMSkgeyANCisJc3lzbG9nKExPR19FUlIsIA0KKwkgICAgICAgIm5v
dGlmeV91bml4OiBzZXR0aW5nIHNvY2tldCB0byBub25ibG9ja2luZzogZmNudGwoKTogJW0iKTsN
CisJY2xvc2Uoc29jayk7IA0KKwlyZXR1cm47IA0KKyAgICB9DQorDQorICAgIGlmIChjb25uZWN0
KCBzb2NrLCAmbXluYW1lLCBhZGRybGVuKSA8IDApIHsNCisJc3lzbG9nKExPR19FUlIsICJub3Rp
ZnlfdW5peDogY29ubmVjdCgpOiAlbSIpOw0KKwlyZXR1cm47DQorICAgIH0NCisNCisgICAgLyog
IC4gLiAuIC4gLiAgKi8NCisNCisgICAgbnVtX2lvdiA9IDA7DQorDQorICAgIFdSSVRFVl9BRERT
VFJfVE9fSU9WRUMoaW92LCBudW1faW92LCAoY2hhciopIGNsYXNzKTsNCisgICAgV1JJVEVWX0FE
RFNUUl9UT19JT1ZFQyhpb3YsIG51bV9pb3YsICJcbiIpOw0KKyAgICBXUklURVZfQUREU1RSX1RP
X0lPVkVDKGlvdiwgbnVtX2lvdiwgKGNoYXIqKSBpbnN0YW5jZSk7DQorICAgIFdSSVRFVl9BRERT
VFJfVE9fSU9WRUMoaW92LCBudW1faW92LCAiXG4iKTsNCisgICAgV1JJVEVWX0FERFNUUl9UT19J
T1ZFQyhpb3YsIG51bV9pb3YsIChjaGFyKikgdXNlcik7DQorICAgIFdSSVRFVl9BRERTVFJfVE9f
SU9WRUMoaW92LCBudW1faW92LCAiXG4iKTsNCisgICAgV1JJVEVWX0FERFNUUl9UT19JT1ZFQyhp
b3YsIG51bV9pb3YsIChjaGFyKikgbWFpbGJveCk7DQorICAgIFdSSVRFVl9BRERTVFJfVE9fSU9W
RUMoaW92LCBudW1faW92LCAiXG4iKTsNCisgICAgV1JJVEVWX0FERFNUUl9UT19JT1ZFQyhpb3Ys
IG51bV9pb3YsIChjaGFyKikgbWVzc2FnZSk7DQorICAgIFdSSVRFVl9BRERTVFJfVE9fSU9WRUMo
aW92LCBudW1faW92LCAiXG4iKTsNCisgICAgY250ID0gcmV0cnlfd3JpdGV2KHNvY2ssIGlvdiwg
bnVtX2lvdik7DQorDQorICAgIGlmIChjbnQgPCAwKSB7DQorCXN5c2xvZyhMT0dfRVJSLCAibm90
aWZ5X3VuaXg6IHJldHJ5X3dyaXRldigpOiAlbSIpOw0KKyAgICB9DQorDQorICAgIGNsb3NlKHNv
Y2spOw0KK30NCkluZGV4OiBpbWFwL3BvcDNkLmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvYWZz
L2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvcG9wM2QuYyx2DQpyZXRy
aWV2aW5nIHJldmlzaW9uIDEuMTIyDQpkaWZmIC11IC1yMS4xMjIgcG9wM2QuYw0KLS0tIHBvcDNk
LmMJMjAwMi8wNi8wMyAxODoyMjoyNwkxLjEyMg0KKysrIHBvcDNkLmMJMjAwMi8wNi8xNCAxNzow
NToxMQ0KQEAgLTMxMiw3ICszMTIsNiBAQA0KICAgICBpbnQgcjsNCiAgICAgaW50IG9wdDsNCiAN
Ci0gICAgY29uZmlnX2NoYW5nZWlkZW50KCJwb3AzZCIpOw0KICAgICBpZiAoZ2V0ZXVpZCgpID09
IDApIGZhdGFsKCJtdXN0IHJ1biBhcyB0aGUgQ3lydXMgdXNlciIsIEVDX1VTQUdFKTsNCiAgICAg
c2V0cHJvY3RpdGxlX2luaXQoYXJnYywgYXJndiwgZW52cCk7DQogDQpAQCAtNDM0LDcgKzQzMyw3
IEBADQogICAgIHByb2NfcmVnaXN0ZXIoInBvcDNkIiwgcG9wZF9jbGllbnRob3N0LCBOVUxMLCBO
VUxMKTsNCiANCiAgICAgLyogU2V0IGluYWN0aXZpdHkgdGltZXIgKi8NCi0gICAgdGltZW91dCA9
IGNvbmZpZ19nZXRpbnQoInBvcHRpbWVvdXQiLCAxMCk7DQorICAgIHRpbWVvdXQgPSBjb25maWdf
Z2V0aW50KElNQVBPUFRfUE9QVElNRU9VVCk7DQogICAgIGlmICh0aW1lb3V0IDwgMTApIHRpbWVv
dXQgPSAxMDsNCiAgICAgcHJvdF9zZXR0aW1lb3V0KHBvcGRfaW4sIHRpbWVvdXQqNjApOw0KICAg
ICBwcm90X3NldGZsdXNob25yZWFkKHBvcGRfaW4sIHBvcGRfb3V0KTsNCkBAIC01NDUsNyArNTQ0
LDcgQEANCiAJZmF0YWwoIkNhbm5vdCBnZXQgY2xpZW50J3MgSVAgYWRkcmVzcyIsIEVDX09TRVJS
KTsNCiAgICAgfQ0KIA0KLSAgICBzcnZ0YWIgPSBjb25maWdfZ2V0c3RyaW5nKCJzcnZ0YWIiLCAi
Iik7DQorICAgIHNydnRhYiA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9TUlZUQUIpOw0KIA0K
ICAgICBzdHJjcHkoaW5zdGFuY2UsICIqIik7DQogICAgIHIgPSBrcmJfcmVjdmF1dGgoMEwsIDAs
ICZ0aWNrZXQsICJwb3AiLCBpbnN0YW5jZSwNCkBAIC0xMDM2LDcgKzEwMzUsNyBAQA0KIA0KICAg
ICAvKiBwb3NzaWJseSBkaXNhbGxvdyBVU0VSICovDQogICAgIGlmICghKGtmbGFnIHx8IHBvcGRf
c3RhcnR0bHNfZG9uZSB8fA0KLQkgIGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0Iiwg
MSkpKSB7DQorCSAgY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhUKSkpIHsN
CiAJcHJvdF9wcmludGYocG9wZF9vdXQsDQogCQkgICAgIi1FUlIgW0FVVEhdIFVTRVIgY29tbWFu
ZCBvbmx5IGF2YWlsYWJsZSB1bmRlciBhIGxheWVyXHJcbiIpOw0KIAlyZXR1cm47DQpAQCAtMTEw
Nyw3ICsxMTA2LDcgQEANCiAjZW5kaWYNCiANCiAgICAgaWYgKCFzdHJjbXAocG9wZF91c2VyaWQs
ICJhbm9ueW1vdXMiKSkgew0KLQlpZiAoY29uZmlnX2dldHN3aXRjaCgiYWxsb3dhbm9ueW1vdXNs
b2dpbiIsIDApKSB7DQorCWlmIChjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dBTk9OWU1P
VVNMT0dJTikpIHsNCiAJICAgIHBhc3MgPSBiZWF1dGlmeV9zdHJpbmcocGFzcyk7DQogCSAgICBp
ZiAoc3RybGVuKHBhc3MpID4gNTAwKSBwYXNzWzUwMF0gPSAnXDAnOw0KIAkgICAgc3lzbG9nKExP
R19OT1RJQ0UsICJsb2dpbjogJXMgYW5vbnltb3VzICVzIiwNCkBAIC0xMTM3LDExICsxMTM2LDE4
IEBADQogCXJldHVybjsNCiAgICAgfQ0KICAgICBlbHNlIHsNCis8PDw8PDw8IHBvcDNkLmMNCisJ
c3lzbG9nKExPR19OT1RJQ0UsICJsb2dpbjogJXMgJXMgcGxhaW50ZXh0ICVzIiwNCisJICAgICAg
IHBvcGRfY2xpZW50aG9zdCwgcG9wZF91c2VyaWQsIHJlcGx5ID8gcmVwbHkgOiAiIik7DQorCXBs
YWludGV4dGxvZ2lucGF1c2UgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfUExBSU5URVhUTE9HSU5Q
QVVTRSk7DQorCWlmIChwbGFpbnRleHRsb2dpbnBhdXNlICE9IDApIHsNCis9PT09PT09DQogCXN5
c2xvZyhMT0dfTk9USUNFLCAibG9naW46ICVzICVzIHBsYWludGV4dCVzICVzIiwgcG9wZF9jbGll
bnRob3N0LA0KIAkgICAgICAgcG9wZF91c2VyaWQsIHBvcGRfc3RhcnR0bHNfZG9uZSA/ICIrVExT
IiA6ICIiLCANCiAJICAgICAgIHJlcGx5ID8gcmVwbHkgOiAiIik7DQogDQogCWlmICgocGxhaW50
ZXh0bG9naW5wYXVzZSA9IGNvbmZpZ19nZXRpbnQoInBsYWludGV4dGxvZ2lucGF1c2UiLCAwKSkh
PTApIHsNCis+Pj4+Pj4+IDEuMTIyDQogCSAgICBzbGVlcChwbGFpbnRleHRsb2dpbnBhdXNlKTsN
CiAJfQ0KICAgICB9DQpAQCAtMTE1Myw4ICsxMTU5LDggQEANCiB2b2lkDQogY21kX2NhcGEoKQ0K
IHsNCi0gICAgaW50IG1pbnBvbGwgPSBjb25maWdfZ2V0aW50KCJwb3BtaW5wb2xsIiwgMCkgKiA2
MDsNCi0gICAgaW50IGV4cGlyZSA9IGNvbmZpZ19nZXRpbnQoInBvcGV4cGlyZXRpbWUiLCAtMSk7
DQorICAgIGludCBtaW5wb2xsID0gY29uZmlnX2dldGludChJTUFQT1BUX1BPUE1JTlBPTEwpICog
NjA7DQorICAgIGludCBleHBpcmUgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfUE9QRVhQSVJFVElN
RSk7DQogICAgIHVuc2lnbmVkIG1lY2hjb3VudDsNCiAgICAgY29uc3QgY2hhciAqbWVjaGxpc3Q7
DQogDQpAQCAtMTE4NSw3ICsxMTkxLDggQEANCiAgICAgcHJvdF9wcmludGYocG9wZF9vdXQsICJS
RVNQLUNPREVTXHJcbiIpOw0KICAgICBwcm90X3ByaW50Zihwb3BkX291dCwgIkFVVEgtUkVTUC1D
T0RFXHJcbiIpOw0KIA0KLSAgICBpZiAoa2ZsYWcgfHwgcG9wZF9zdGFydHRsc19kb25lIHx8IGNv
bmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0IiwgMSkpIHsNCisgICAgaWYgKGtmbGFnIHx8
IHBvcGRfc3RhcnR0bHNfZG9uZSB8fCANCisJY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9X
UExBSU5URVhUKSkgew0KIAlwcm90X3ByaW50Zihwb3BkX291dCwgIlVTRVJcclxuIik7DQogICAg
IH0NCiAgICAgDQpAQCAtMTM4Miw4ICsxMzg5LDggQEANCiAJcmV0dXJuIDE7DQogICAgIH0NCiAN
Ci0gICAgaWYgKChtaW5wb2xsID0gY29uZmlnX2dldGludCgicG9wbWlucG9sbCIsIDApKSAmJg0K
LQltYm94c3RydWN0LnBvcDNfbGFzdF9sb2dpbiArIDYwKm1pbnBvbGwgPiBwb3BkX2xvZ2luX3Rp
bWUpIHsNCisgICAgaWYgKChtaW5wb2xsID0gY29uZmlnX2dldGludChJTUFQT1BUX1BPUE1JTlBP
TEwpKSAmJg0KKwltYm94c3RydWN0LnBvcDNfbGFzdF9sb2dpbiArIDYwICogbWlucG9sbCA+IHBv
cGRfbG9naW5fdGltZSkgew0KIAlwcm90X3ByaW50Zihwb3BkX291dCwNCiAJICAgICItRVJSIFtM
T0dJTi1ERUxBWV0gTG9naW5zIG11c3QgYmUgYXQgbGVhc3QgJWQgbWludXRlJXMgYXBhcnRcclxu
IiwNCiAJCSAgICBtaW5wb2xsLCBtaW5wb2xsID4gMSA/ICJzIiA6ICIiKTsNCkluZGV4OiBpbWFw
L3BvcDNwcm94eWQuYw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUv
c3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9wb3AzcHJveHlkLmMsdg0KcmV0cmlldmluZyByZXZp
c2lvbiAxLjQxDQpkaWZmIC11IC1yMS40MSBwb3AzcHJveHlkLmMNCi0tLSBwb3AzcHJveHlkLmMJ
MjAwMi8wNi8wMyAxODoyMjoyNwkxLjQxDQorKysgcG9wM3Byb3h5ZC5jCTIwMDIvMDYvMTQgMTc6
MDU6MTINCkBAIC0xNjgsNyArMTY4LDYgQEANCiB7DQogICAgIGludCByOw0KIA0KLSAgICBjb25m
aWdfY2hhbmdlaWRlbnQoInBvcDNkIik7DQogICAgIGlmIChnZXRldWlkKCkgPT0gMCkgZmF0YWwo
Im11c3QgcnVuIGFzIHRoZSBDeXJ1cyB1c2VyIiwgRUNfVVNBR0UpOw0KICAgICBzZXRwcm9jdGl0
bGVfaW5pdChhcmdjLCBhcmd2LCBlbnZwKTsNCiANCkBAIC0yODYsNyArMjg1LDcgQEANCiAgICAg
cHJvY19yZWdpc3RlcigicG9wM2QiLCBwb3BkX2NsaWVudGhvc3QsIE5VTEwsIE5VTEwpOw0KIA0K
ICAgICAvKiBTZXQgaW5hY3Rpdml0eSB0aW1lciAqLw0KLSAgICB0aW1lb3V0ID0gY29uZmlnX2dl
dGludCgicG9wdGltZW91dCIsIDEwKTsNCisgICAgdGltZW91dCA9IGNvbmZpZ19nZXRpbnQoSU1B
UE9QVF9QT1BUSU1FT1VUKTsNCiAgICAgaWYgKHRpbWVvdXQgPCAxMCkgdGltZW91dCA9IDEwOw0K
ICAgICBwcm90X3NldHRpbWVvdXQocG9wZF9pbiwgdGltZW91dCo2MCk7DQogICAgIHByb3Rfc2V0
Zmx1c2hvbnJlYWQocG9wZF9pbiwgcG9wZF9vdXQpOw0KQEAgLTQxOCw3ICs0MTcsNyBAQA0KIAlm
YXRhbCgiQ2Fubm90IGdldCBjbGllbnQncyBJUCBhZGRyZXNzIiwgRUNfT1NFUlIpOw0KICAgICB9
DQogDQotICAgIHNydnRhYiA9IGNvbmZpZ19nZXRzdHJpbmcoInNydnRhYiIsICIiKTsNCisgICAg
c3J2dGFiID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NSVlRBQik7DQogDQogICAgIHN0cmNw
eShpbnN0YW5jZSwgIioiKTsNCiAgICAgciA9IGtyYl9yZWN2YXV0aCgwTCwgMCwgJnRpY2tldCwg
InBvcCIsIGluc3RhbmNlLA0KQEAgLTU2OCwxMCArNTY3LDggQEANCiAJcmV0dXJuOw0KICAgICB9
DQogDQotICAgIHRsc19jZXJ0ID0gKGNoYXIgKiljb25maWdfZ2V0c3RyaW5nKCJ0bHNfcG9wM19j
ZXJ0X2ZpbGUiLA0KLQkJCQkJY29uZmlnX2dldHN0cmluZygidGxzX2NlcnRfZmlsZSIsICIiKSk7
DQotICAgIHRsc19rZXkgPSAoY2hhciAqKWNvbmZpZ19nZXRzdHJpbmcoInRsc19wb3AzX2tleV9m
aWxlIiwNCi0JCQkJICAgICAgIGNvbmZpZ19nZXRzdHJpbmcoInRsc19rZXlfZmlsZSIsICIiKSk7
DQorICAgIHRsc19jZXJ0ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1RMU19DRVJUX0ZJTEUp
Ow0KKyAgICB0bHNfa2V5ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1RMU19LRVlfRklMRSk7
DQogDQogICAgIHJlc3VsdD10bHNfaW5pdF9zZXJ2ZXJlbmdpbmUoInBvcDMiLA0KIAkJCQkgNSwg
ICAgICAgIC8qIGRlcHRoIHRvIHZlcmlmeSAqLw0KQEAgLTc0MSw3ICs3MzgsNyBAQA0KIA0KICAg
ICAvKiBwb3NzaWJseSBkaXNhbGxvdyBVU0VSICovDQogICAgIGlmICghKGtmbGFnIHx8IHBvcGRf
c3RhcnR0bHNfZG9uZSB8fA0KLQkgIGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0Iiwg
MSkpKSB7DQorCSAgY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhUKSkpIHsN
CiAJcHJvdF9wcmludGYocG9wZF9vdXQsDQogCQkgICAgIi1FUlIgW0FVVEhdIFVTRVIgY29tbWFu
ZCBvbmx5IGF2YWlsYWJsZSB1bmRlciBhIGxheWVyXHJcbiIpOw0KIAlyZXR1cm47DQpAQCAtODAx
LDcgKzc5OCw3IEBADQogI2VuZGlmDQogDQogICAgIGlmICghc3RyY21wKHBvcGRfdXNlcmlkLCAi
YW5vbnltb3VzIikpIHsNCi0JaWYgKGNvbmZpZ19nZXRzd2l0Y2goImFsbG93YW5vbnltb3VzbG9n
aW4iLCAwKSkgew0KKwlpZiAoY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XQU5PTllNT1VT
TE9HSU4pKSB7DQogCSAgICBwYXNzID0gYmVhdXRpZnlfc3RyaW5nKHBhc3MpOw0KIAkgICAgaWYg
KHN0cmxlbihwYXNzKSA+IDUwMCkgcGFzc1s1MDBdID0gJ1wwJzsNCiAJICAgIHN5c2xvZyhMT0df
Tk9USUNFLCAibG9naW46ICVzIGFub255bW91cyAlcyIsDQpAQCAtODMxLDExICs4MjgsMTcgQEAN
CiAJcmV0dXJuOw0KICAgICB9DQogICAgIGVsc2Ugew0KKzw8PDw8PDwgcG9wM3Byb3h5ZC5jDQor
CXN5c2xvZyhMT0dfTk9USUNFLCAibG9naW46ICVzICVzIHBsYWludGV4dCAlcyIsDQorCSAgICAg
ICBwb3BkX2NsaWVudGhvc3QsIHBvcGRfdXNlcmlkLCByZXBseSA/IHJlcGx5IDogIiIpOw0KKwlw
bGFpbnRleHRsb2dpbnBhdXNlID0gY29uZmlnX2dldGludChJTUFQT1BUX1BMQUlOVEVYVExPR0lO
UEFVU0UpOw0KKz09PT09PT0NCiAJc3lzbG9nKExPR19OT1RJQ0UsICJsb2dpbjogJXMgJXMgcGxh
aW50ZXh0JXMgJXMiLCBwb3BkX2NsaWVudGhvc3QsDQogCSAgICAgICBwb3BkX3VzZXJpZCwgcG9w
ZF9zdGFydHRsc19kb25lID8gIitUTFMiIDogIiIsIA0KIAkgICAgICAgcmVwbHkgPyByZXBseSA6
ICIiKTsNCiANCiAJcGxhaW50ZXh0bG9naW5wYXVzZSA9IGNvbmZpZ19nZXRpbnQoInBsYWludGV4
dGxvZ2lucGF1c2UiLCAwKTsNCis+Pj4+Pj4+IDEuNDENCiAJaWYgKHBsYWludGV4dGxvZ2lucGF1
c2UpIHNsZWVwKHBsYWludGV4dGxvZ2lucGF1c2UpOw0KICAgICB9DQogDQpAQCAtODQ4LDggKzg1
MSw4IEBADQogdm9pZA0KIGNtZF9jYXBhKCkNCiB7DQotICAgIGludCBtaW5wb2xsID0gY29uZmln
X2dldGludCgicG9wbWlucG9sbCIsIDApICogNjA7DQotICAgIGludCBleHBpcmUgPSBjb25maWdf
Z2V0aW50KCJwb3BleHBpcmV0aW1lIiwgLTEpOw0KKyAgICBpbnQgbWlucG9sbCA9IGNvbmZpZ19n
ZXRpbnQoSU1BUE9QVF9QT1BNSU5QT0xMKSAqIDYwOw0KKyAgICBpbnQgZXhwaXJlID0gY29uZmln
X2dldGludChJTUFQT1BUX1BPUEVYUElSRVRJTUUpOw0KICAgICB1bnNpZ25lZCBtZWNoY291bnQ7
DQogICAgIGNvbnN0IGNoYXIgKm1lY2hsaXN0Ow0KIA0KQEAgLTg4MCw3ICs4ODMsOCBAQA0KICAg
ICBwcm90X3ByaW50Zihwb3BkX291dCwgIlJFU1AtQ09ERVNcclxuIik7DQogICAgIHByb3RfcHJp
bnRmKHBvcGRfb3V0LCAiQVVUSC1SRVNQLUNPREVcclxuIik7DQogDQotICAgIGlmIChrZmxhZyB8
fCBwb3BkX3N0YXJ0dGxzX2RvbmUgfHwgY29uZmlnX2dldHN3aXRjaCgiYWxsb3dwbGFpbnRleHQi
LCAxKSkgew0KKyAgICBpZiAoa2ZsYWcgfHwgcG9wZF9zdGFydHRsc19kb25lIHx8IA0KKwljb25m
aWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dQTEFJTlRFWFQpKSB7DQogCXByb3RfcHJpbnRmKHBv
cGRfb3V0LCAiVVNFUlxyXG4iKTsNCiAgICAgfQ0KICAgICANCkBAIC0xMTAxLDE2ICsxMTA1LDE3
IEBADQogICAgIGNvbnN0IGNoYXIgKm1lY2h1c2luZzsNCiAgICAgdW5zaWduZWQgYjY0bGVuOw0K
ICAgICBjaGFyIGxvY2FsaXBbNjBdLCByZW1vdGVpcFs2MF07DQorICAgIGNoYXIgKmF2YWlsbWVj
aHM7DQogICAgIGNvbnN0IGNoYXIgKnBhc3M7DQogDQogICAgIHN0cmNweShvcHRzdHIsIGhvc3Ru
YW1lKTsNCiAgICAgcCA9IHN0cmNocihvcHRzdHIsICcuJyk7DQogICAgIGlmIChwKSAqcCA9ICdc
MCc7DQogICAgIHN0cmNhdChvcHRzdHIsICJfcGFzc3dvcmQiKTsNCi0gICAgcGFzcyA9IGNvbmZp
Z19nZXRzdHJpbmcob3B0c3RyLCBOVUxMKTsNCisgICAgcGFzcyA9IGNvbmZpZ19nZXRvdmVyZmxv
d3N0cmluZyhvcHRzdHIpOw0KICAgICBjYiA9IG15c2FzbF9jYWxsYmFja3MocG9wZF91c2VyaWQs
IA0KLQkJCSAgY29uZmlnX2dldHN0cmluZygicHJveHlfYXV0aG5hbWUiLCAicHJveHkiKSwNCi0J
CQkgIGNvbmZpZ19nZXRzdHJpbmcoInByb3h5X3JlYWxtIiwgTlVMTCksDQorCQkJICBjb25maWdf
Z2V0c3RyaW5nKElNQVBPUFRfUFJPWFlfQVVUSE5BTUUpLA0KKwkJCSAgY29uZmlnX2dldHN0cmlu
ZyhJTUFQT1BUX1BST1hZX1JFQUxNKSwNCiAJCQkgIHBhc3MpOw0KIA0KICAgICByID0gc2FzbF9j
bGllbnRfbmV3KCJwb3AiLCBob3N0bmFtZSwgTlVMTCwgTlVMTCwNCkBAIC0xMTU0LDEwICsxMTU5
LDExIEBADQogICAgIHAgPSBzdHJjaHIoYnVmLCAnLicpOw0KICAgICAqcCA9ICdcMCc7DQogICAg
IHN0cmNhdChidWYsICJfbWVjaHMiKTsNCisgICAgYXZhaWxtZWNocyA9IGNvbmZpZ19nZXRvdmVy
Zmxvd3N0cmluZyhidWYpOw0KKyAgICBpZiAoIWF2YWlsbWVjaHMpIGF2YWlsbWVjaHMgPSAiS0VS
QkVST1NfVjQiOyAvKiB4eHggKi8NCiANCiAgICAgLyogd2Ugbm93IGRvIHRoZSBhY3R1YWwgU0FT
TCBleGNoYW5nZSAqLw0KLSAgICByID0gc2FzbF9jbGllbnRfc3RhcnQoYmFja2VuZF9zYXNsY29u
biwgDQotCQkJICBjb25maWdfZ2V0c3RyaW5nKGJ1ZiwgIktFUkJFUk9TX1Y0IiksDQorICAgIHIg
PSBzYXNsX2NsaWVudF9zdGFydChiYWNrZW5kX3Nhc2xjb25uLCBhdmFpbG1lY2hzLA0KIAkJCSAg
TlVMTCwgJm91dCwgJm91dGxlbiwgJm1lY2h1c2luZyk7DQogICAgIGlmICgociAhPSBTQVNMX09L
KSAmJiAociAhPSBTQVNMX0NPTlRJTlVFKSkgew0KIAlyZXR1cm4gcjsNCkluZGV4OiBpbWFwL3By
b3h5ZC5jDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0v
Y3ZzL3NyYy9jeXJ1cy9pbWFwL3Byb3h5ZC5jLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS4xMjgN
CmRpZmYgLXUgLXIxLjEyOCBwcm94eWQuYw0KLS0tIHByb3h5ZC5jCTIwMDIvMDYvMDcgMTU6NDI6
MTUJMS4xMjgNCisrKyBwcm94eWQuYwkyMDAyLzA2LzE0IDE3OjA1OjEzDQpAQCAtNjI5LDYgKzYy
OSwyMDEgQEANCiAgICAgfQ0KIH0NCiANCis8PDw8PDw8IHByb3h5ZC5jDQorPDw8PDw8PCBwcm94
eWQuYw0KK3N0YXRpYyBpbnQgbXlzYXNsX2dldGF1dGhsaW5lKHN0cnVjdCBwcm90c3RyZWFtICpw
LCBjaGFyICp0YWcsDQorCQkJICAgICAgY2hhciAqKmxpbmUsIHVuc2lnbmVkIGludCAqbGluZWxl
bikNCit7DQorICAgIGNoYXIgYnVmWzIwOTZdOw0KKyAgICBjaGFyICpzdHIgPSAoY2hhciAqKSBi
dWY7DQorICAgIA0KKyAgICBpZiAoIXByb3RfZmdldHMoc3RyLCBzaXplb2YoYnVmKSwgcCkpIHsN
CisJcmV0dXJuIFNBU0xfRkFJTDsNCisgICAgfQ0KKyAgICBpZiAoIXN0cm5jbXAoc3RyLCB0YWcs
IHN0cmxlbih0YWcpKSkgew0KKwlzdHIgKz0gc3RybGVuKHRhZykgKyAxOw0KKwlpZiAoIXN0cm5j
YXNlY21wKHN0ciwgIk9LICIsIDMpKSB7IHJldHVybiBTQVNMX09LOyB9DQorCWlmICghc3RybmNh
c2VjbXAoc3RyLCAiTk8gIiwgMykpIHsgcmV0dXJuIFNBU0xfQkFEQVVUSDsgfQ0KKwlyZXR1cm4g
U0FTTF9GQUlMOyAvKiBodWg/ICovDQorICAgIH0gZWxzZSBpZiAoc3RyWzBdID09ICcrJyAmJiBz
dHJbMV0gPT0gJyAnKSB7DQorCXVuc2lnbmVkIGJ1ZmxlbjsNCisJc3RyICs9IDI7IC8qIGp1bXAg
cGFzdCB0aGUgIisgIiAqLw0KKw0KKwlidWZsZW4gPSBzdHJsZW4oc3RyKSArIDE7DQorDQorCSps
aW5lID0geG1hbGxvYyhidWZsZW4pOw0KKwlpZiAoKnN0ciAhPSAnXHInKSB7CS8qIGRlY29kZSBp
dCAqLw0KKwkgICAgaW50IHI7DQorCSAgICANCisJICAgIHIgPSBzYXNsX2RlY29kZTY0KHN0ciwg
c3RybGVuKHN0ciksICpsaW5lLCBidWZsZW4sIGxpbmVsZW4pOw0KKwkgICAgaWYgKHIgIT0gU0FT
TF9PSykgew0KKwkJcmV0dXJuIHI7DQorCSAgICB9DQorCSAgICANCisJICAgIHJldHVybiBTQVNM
X0NPTlRJTlVFOw0KKwl9IGVsc2UgewkJLyogYmxhbmsgY2hhbGxlbmdlICovDQorCSAgICAqbGlu
ZSA9IE5VTEw7DQorCSAgICAqbGluZWxlbiA9IDA7DQorDQorCSAgICByZXR1cm4gU0FTTF9DT05U
SU5VRTsNCisJfQ0KKyAgICB9IGVsc2Ugew0KKwkvKiBodWg/Pz8gKi8NCisJcmV0dXJuIFNBU0xf
RkFJTDsNCisgICAgfQ0KK30NCisNCitleHRlcm4gc2FzbF9jYWxsYmFja190ICpteXNhc2xfY2Fs
bGJhY2tzKGNvbnN0IGNoYXIgKnVzZXJuYW1lLA0KKwkJCQkJIGNvbnN0IGNoYXIgKmF1dGhuYW1l
LA0KKwkJCQkJIGNvbnN0IGNoYXIgKnJlYWxtLA0KKwkJCQkJIGNvbnN0IGNoYXIgKnBhc3N3b3Jk
KTsNCit2b2lkIGZyZWVfY2FsbGJhY2tzKHNhc2xfY2FsbGJhY2tfdCAqaW4pOw0KKw0KK3N0YXRp
YyBpbnQgcHJveHlfYXV0aGVudGljYXRlKHN0cnVjdCBiYWNrZW5kICpzKQ0KK3sNCisgICAgaW50
IHI7DQorICAgIHNhc2xfc2VjdXJpdHlfcHJvcGVydGllc190ICpzZWNwcm9wcyA9IE5VTEw7DQor
ICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBzYWRkcl9sLCBzYWRkcl9yOw0KKyAgICBjaGFyIHJlbW90
ZWlwWzYwXSwgbG9jYWxpcFs2MF07DQorICAgIHNvY2tsZW5fdCBhZGRyc2l6ZTsNCisgICAgc2Fz
bF9jYWxsYmFja190ICpjYjsNCisgICAgY2hhciBteXRhZ1sxMjhdOw0KKyAgICBjaGFyIGJ1Zlsy
MDQ4XTsNCisgICAgY2hhciBvcHRzdHJbMTI4XTsNCisgICAgY2hhciAqaW4sICpwOw0KKyAgICBj
b25zdCBjaGFyICpvdXQ7DQorICAgIHVuc2lnbmVkIGludCBpbmxlbiwgb3V0bGVuOw0KKyAgICBj
b25zdCBjaGFyICptZWNodXNpbmc7DQorICAgIHVuc2lnbmVkIGI2NGxlbjsNCisgICAgY2hhciAq
YXZhaWxtZWNoczsNCisgICAgY29uc3QgY2hhciAqcGFzczsNCisNCisgICAgc3RyY3B5KG9wdHN0
ciwgcy0+aG9zdG5hbWUpOw0KKyAgICBwID0gc3RyY2hyKG9wdHN0ciwgJy4nKTsNCisgICAgaWYg
KHApICpwID0gJ1wwJzsNCisgICAgc3RyY2F0KG9wdHN0ciwgIl9wYXNzd29yZCIpOw0KKyAgICBw
YXNzID0gY29uZmlnX2dldG92ZXJmbG93c3RyaW5nKG9wdHN0cik7DQorICAgIGNiID0gbXlzYXNs
X2NhbGxiYWNrcyhwcm94eWRfdXNlcmlkLCANCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9Q
VF9QUk9YWV9BVVRITkFNRSksDQorCQkJICBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfUFJPWFlf
UkVBTE0pLA0KKwkJCSAgcGFzcyk7DQorDQorICAgIC8qIHNldCB0aGUgSVAgYWRkcmVzc2VzICov
DQorICAgIGFkZHJzaXplPXNpemVvZihzdHJ1Y3Qgc29ja2FkZHJfaW4pOw0KKyAgICBpZiAoZ2V0
cGVlcm5hbWUocy0+c29jaywgKHN0cnVjdCBzb2NrYWRkciAqKSZzYWRkcl9yLCAmYWRkcnNpemUp
ICE9IDApDQorCXJldHVybiBTQVNMX0ZBSUw7DQorICAgIGlmKGlwdG9zdHJpbmcoKHN0cnVjdCBz
b2NrYWRkciAqKSZzYWRkcl9yLCBzaXplb2Yoc3RydWN0IHNvY2thZGRyX2luKSwNCisJCSAgcmVt
b3RlaXAsIDYwKSAhPSAwKQ0KKwlyZXR1cm4gU0FTTF9GQUlMOw0KKyAgDQorICAgIGFkZHJzaXpl
PXNpemVvZihzdHJ1Y3Qgc29ja2FkZHJfaW4pOw0KKyAgICBpZiAoZ2V0c29ja25hbWUocy0+c29j
aywgKHN0cnVjdCBzb2NrYWRkciAqKSZzYWRkcl9sLCAmYWRkcnNpemUpIT0wKQ0KKwlyZXR1cm4g
U0FTTF9GQUlMOw0KKyAgICBpZihpcHRvc3RyaW5nKChzdHJ1Y3Qgc29ja2FkZHIgKikmc2FkZHJf
bCwgc2l6ZW9mKHN0cnVjdCBzb2NrYWRkcl9pbiksDQorCQkgIGxvY2FsaXAsIDYwKSAhPSAwKQ0K
KwlyZXR1cm4gU0FTTF9GQUlMOw0KKw0KKyAgICByID0gc2FzbF9jbGllbnRfbmV3KCJpbWFwIiwg
cy0+aG9zdG5hbWUsIGxvY2FsaXAsIHJlbW90ZWlwLA0KKwkJCWNiLCAwLCAmcy0+c2FzbGNvbm4p
Ow0KKyAgICBpZiAociAhPSBTQVNMX09LKSB7DQorCXJldHVybiByOw0KKyAgICB9DQorDQorICAg
IHNlY3Byb3BzID0gbXlzYXNsX3NlY3Byb3BzKDApOw0KKyAgICByID0gc2FzbF9zZXRwcm9wKHMt
PnNhc2xjb25uLCBTQVNMX1NFQ19QUk9QUywgc2VjcHJvcHMpOw0KKyAgICBpZiAociAhPSBTQVNM
X09LKSB7DQorCXJldHVybiByOw0KKyAgICB9DQorDQorICAgIC8qIHJlYWQgdGhlIGluaXRpYWwg
Z3JlZXRpbmcgKi8NCisgICAgaWYgKCFwcm90X2ZnZXRzKGJ1Ziwgc2l6ZW9mKGJ1ZiksIHMtPmlu
KSkgew0KKwlzeXNsb2coTE9HX0VSUiwNCisJICAgICAgICJwcm94eWRfYXV0aGVudGljYXRlKCk6
IGNvdWxkbid0IHJlYWQgaW5pdGlhbCBncmVldGluZzogJXMiLA0KKwkgICAgICAgcy0+aW4tPmVy
cm9yID8gcy0+aW4tPmVycm9yIDogIihudWxsKSIpOw0KKwlyZXR1cm4gU0FTTF9GQUlMOw0KKyAg
ICB9DQorDQorICAgIHN0cmNweShidWYsIHMtPmhvc3RuYW1lKTsNCisgICAgcCA9IHN0cmNocihi
dWYsICcuJyk7DQorICAgICpwID0gJ1wwJzsNCisgICAgc3RyY2F0KGJ1ZiwgIl9tZWNocyIpOw0K
KyAgICBhdmFpbG1lY2hzID0gY29uZmlnX2dldG92ZXJmbG93c3RyaW5nKGJ1Zik7DQorICAgIGlm
ICghYXZhaWxtZWNocykgYXZhaWxtZWNocyA9ICJLRVJCRVJPU19WNCI7IC8qIHh4eCAqLw0KKw0K
KyAgICAvKiB3ZSBub3cgZG8gdGhlIGFjdHVhbCBTQVNMIGV4Y2hhbmdlICovDQorICAgIHIgPSBz
YXNsX2NsaWVudF9zdGFydChzLT5zYXNsY29ubiwgYXZhaWxtZWNocywNCisJCQkgIE5VTEwsIE5V
TEwsIE5VTEwsICZtZWNodXNpbmcpOw0KKyAgICBpZiAoKHIgIT0gU0FTTF9PSykgJiYgKHIgIT0g
U0FTTF9DT05USU5VRSkpIHsNCisJcmV0dXJuIHI7DQorICAgIH0NCisgICAgcHJveHlkX2dlbnRh
ZyhteXRhZyk7DQorICAgIHByb3RfcHJpbnRmKHMtPm91dCwgIiVzIEFVVEhFTlRJQ0FURSAlc1xy
XG4iLCBteXRhZywgbWVjaHVzaW5nKTsNCisNCisgICAgaW4gPSBOVUxMOw0KKyAgICBpbmxlbiA9
IDA7DQorICAgIHIgPSBteXNhc2xfZ2V0YXV0aGxpbmUocy0+aW4sIG15dGFnLCAmaW4sICZpbmxl
bik7DQorICAgIHdoaWxlIChyID09IFNBU0xfQ09OVElOVUUpIHsNCisJciA9IHNhc2xfY2xpZW50
X3N0ZXAocy0+c2FzbGNvbm4sIGluLCBpbmxlbiwgTlVMTCwgJm91dCwgJm91dGxlbik7DQorCWlm
IChpbikgeyANCisJICAgIGZyZWUoaW4pOw0KKwl9DQorCWlmIChyICE9IFNBU0xfT0sgJiYgciAh
PSBTQVNMX0NPTlRJTlVFKSB7DQorCSAgICByZXR1cm4gcjsNCisJfQ0KKw0KKwlyID0gc2FzbF9l
bmNvZGU2NChvdXQsIG91dGxlbiwgYnVmLCBzaXplb2YoYnVmKSwgJmI2NGxlbik7DQorCWlmIChy
ICE9IFNBU0xfT0spIHsNCisJICAgIHJldHVybiByOw0KKwl9DQorDQorCXByb3Rfd3JpdGUocy0+
b3V0LCBidWYsIGI2NGxlbik7DQorCXByb3RfcHJpbnRmKHMtPm91dCwgIlxyXG4iKTsNCisNCisJ
ciA9IG15c2FzbF9nZXRhdXRobGluZShzLT5pbiwgbXl0YWcsICZpbiwgJmlubGVuKTsNCisgICAg
fQ0KKw0KKyAgICBmcmVlX2NhbGxiYWNrcyhjYik7DQorDQorICAgIGlmIChyID09IFNBU0xfT0sp
IHsNCisJcHJvdF9zZXRzYXNsKHMtPmluLCBzLT5zYXNsY29ubik7DQorCXByb3Rfc2V0c2FzbChz
LT5vdXQsIHMtPnNhc2xjb25uKTsNCisgICAgfQ0KKw0KKyAgICAvKiByID09IFNBU0xfT0sgb24g
c3VjY2VzcyAqLw0KKyAgICByZXR1cm4gcjsNCit9DQorDQordm9pZCBwcm94eWRfY2FwYWJpbGl0
eShzdHJ1Y3QgYmFja2VuZCAqcykNCit7DQorICAgIGNoYXIgdGFnWzEyOF07DQorICAgIGNoYXIg
cmVzcFsxMDI0XTsNCisgICAgaW50IHN0ID0gMDsNCisNCisgICAgcHJveHlkX2dlbnRhZyh0YWcp
Ow0KKyAgICBwcm90X3ByaW50ZihzLT5vdXQsICIlcyBDYXBhYmlsaXR5XHJcbiIsIHRhZyk7DQor
ICAgIGRvIHsNCisJaWYgKCFwcm90X2ZnZXRzKHJlc3AsIHNpemVvZihyZXNwKSwgcy0+aW4pKSBy
ZXR1cm47DQorCWlmICghc3RybmNhc2VjbXAocmVzcCwgIiogQ2FwYWJpbGl0eSAiLCAxMykpIHsN
CisJICAgIHN0Kys7IC8qIGluY3JlbWVudCBzdGF0ZSAqLw0KKwkgICAgaWYgKHN0cnN0cihyZXNw
LCAiSURMRSIpKSBzLT5jYXBhYmlsaXR5IHw9IElETEU7DQorCSAgICBpZiAoc3Ryc3RyKHJlc3As
ICJNVVBEQVRFIikpIHMtPmNhcGFiaWxpdHkgfD0gTVVQREFURTsNCisJfSBlbHNlIHsNCisJICAg
IC8qIGxpbmUgd2Ugd2VyZW4ndCBleHBlY3RpbmcuIGhtbW0uICovDQorCX0NCisgICAgfSB3aGls
ZSAoc3QgPT0gMCk7DQorICAgIGRvIHsNCisJaWYgKCFwcm90X2ZnZXRzKHJlc3AsIHNpemVvZihy
ZXNwKSwgcy0+aW4pKSByZXR1cm47DQorCWlmICghc3RybmNtcChyZXNwLCB0YWcsIHN0cmxlbih0
YWcpKSkgew0KKwkgICAgc3QrKzsgLyogaW5jcmVtZW50IHN0YXRlICovDQorCX0gZWxzZSB7DQor
CSAgICAvKiBsaW5lIHdlIHdlcmVuJ3QgZXhwZWN0aW5nLiBobW1tLiAqLw0KKwl9DQorICAgIH0g
d2hpbGUgKHN0ID09IDEpOw0KK30NCisNCis9PT09PT09DQorPj4+Pj4+PiAxLjEwNw0KKz09PT09
PT0NCiAvKiBUaGlzIGhhbmRsZXMgcGlwaW5nIG9mIHRoZSBMU1VCIGNvbW1hbmQsIGJlY2F1c2Ug
d2UgaGF2ZSB0byBmaWd1cmUgb3V0DQogICogd2hhdCBtYWlsYm94ZXMgYWN0dWFsbHkgZXhpc3Qg
YmVmb3JlIHBhc3NpbmcgdGhlbSB0byB0aGUgZW5kIHVzZXIuDQogICoNCkBAIC04MjMsNiArMTAx
OCw3IEBADQogICAgIHJldHVybiByOw0KIH0NCiANCis+Pj4+Pj4+IDEuMTI4DQogdm9pZCBwcm94
eWRfZG93bnNlcnZlcihzdHJ1Y3QgYmFja2VuZCAqcykNCiB7DQogICAgIGlmICghcyB8fCAhcy0+
dGltZW91dCkgew0KQEAgLTg3NCwxMSArMTA3MCw2OSBAQA0KIAl9DQogCWkrKzsNCiAgICAgfQ0K
Kzw8PDw8PDwgcHJveHlkLmMNCisNCisgICAgaWYgKCFyZXQpIHsNCisJc3RydWN0IGhvc3RlbnQg
KmhwOw0KIA0KKwlyZXQgPSB4bWFsbG9jKHNpemVvZihzdHJ1Y3QgYmFja2VuZCkpOw0KKwltZW1z
ZXQocmV0LCAwLCBzaXplb2Yoc3RydWN0IGJhY2tlbmQpKTsNCisJcmV0LT5ob3N0bmFtZSA9IHhz
dHJkdXAoc2VydmVyKTsNCisJaWYgKChocCA9IGdldGhvc3RieW5hbWUoc2VydmVyKSkgPT0gTlVM
TCkgew0KKwkgICAgc3lzbG9nKExPR19FUlIsICJnZXRob3N0YnluYW1lKCVzKSBmYWlsZWQ6ICVt
Iiwgc2VydmVyKTsNCisJICAgIGZyZWUocmV0KTsNCisJICAgIHJldHVybiBOVUxMOw0KKwl9DQor
CXJldC0+YWRkci5zaW5fZmFtaWx5ID0gQUZfSU5FVDsNCisJbWVtY3B5KCZyZXQtPmFkZHIuc2lu
X2FkZHIsIGhwLT5oX2FkZHIsIGhwLT5oX2xlbmd0aCk7DQorCXJldC0+YWRkci5zaW5fcG9ydCA9
IGh0b25zKDE0Myk7DQorPT09PT09PQ0KKz4+Pj4+Pj4gMS4xMDcNCisNCis8PDw8PDw8IHByb3h5
ZC5jDQorCXJldC0+dGltZW91dCA9IE5VTEw7DQorICAgIH0NCisgCQ0KKyAgICBpZiAoIXJldC0+
dGltZW91dCkgew0KKz09PT09PT0NCiAgICAgaWYgKCFyZXQgfHwgIXJldC0+dGltZW91dCkgew0K
Kz4+Pj4+Pj4gMS4xMDcNCiAJLyogbmVlZCB0byAocmUpZXN0YWJsaXNoIGNvbm5lY3Rpb24gdG8g
c2VydmVyIG9yIGNyZWF0ZSBvbmUgKi8NCis8PDw8PDw8IHByb3h5ZC5jDQorCWludCBzb2NrOw0K
KwlpbnQgcjsNCisNCisJaWYgKChzb2NrID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfU1RSRUFNLCAw
KSkgPCAwKSB7DQorCSAgICBzeXNsb2coTE9HX0VSUiwgInNvY2tldCgpIGZhaWxlZDogJW0iKTsN
CisJICAgIGZyZWUocmV0KTsNCisJICAgIHJldHVybiBOVUxMOw0KKwl9DQorCWlmIChjb25uZWN0
KHNvY2ssIChzdHJ1Y3Qgc29ja2FkZHIgKikgJnJldC0+YWRkciwgDQorCQkgICAgc2l6ZW9mKHJl
dC0+YWRkcikpIDwgMCkgew0KKwkgICAgc3lzbG9nKExPR19FUlIsICJjb25uZWN0KCVzKSBmYWls
ZWQ6ICVtIiwgc2VydmVyKTsNCisJICAgIGZyZWUocmV0KTsNCisJICAgIHJldHVybiBOVUxMOw0K
Kwl9DQorCQ0KKwlyZXQtPmluID0gcHJvdF9uZXcoc29jaywgMCk7DQorCXJldC0+b3V0ID0gcHJv
dF9uZXcoc29jaywgMSk7DQorCXJldC0+c29jayA9IHNvY2s7DQorCXByb3Rfc2V0Zmx1c2hvbnJl
YWQocmV0LT5pbiwgcmV0LT5vdXQpOw0KKw0KKwkvKiBub3cgbmVlZCB0byBhdXRoZW50aWNhdGUg
dG8gYmFja2VuZCBzZXJ2ZXIgKi8NCisJaWYgKChyID0gcHJveHlfYXV0aGVudGljYXRlKHJldCkp
KSB7DQorCSAgICBzeXNsb2coTE9HX0VSUiwgImNvdWxkbid0IGF1dGhlbnRpY2F0ZSB0byBiYWNr
ZW5kIHNlcnZlcjogJXMiLA0KKwkJICAgc2FzbF9lcnJzdHJpbmcociwgTlVMTCwgTlVMTCkpOw0K
KwkgICAgZnJlZShyZXQpOw0KKwkgICAgcmV0dXJuIE5VTEw7DQorCX0NCisNCisJLyogZmluZCB0
aGUgY2FwYWJpbGl0aWVzIG9mIHRoZSBzZXJ2ZXIgKi8NCisJcHJveHlkX2NhcGFiaWxpdHkocmV0
KTsNCis9PT09PT09DQogCXJldCA9IGZpbmRzZXJ2ZXIocmV0LCBzZXJ2ZXIsIHByb3h5ZF91c2Vy
aWQpOw0KIAlpZighcmV0KSByZXR1cm4gTlVMTDsNCis+Pj4+Pj4+IDEuMTA3DQogDQogCS8qIGFk
ZCB0aGUgdGltZW91dCAqLw0KIAlyZXQtPnRpbWVvdXQgPSBwcm90X2FkZHdhaXRldmVudChwcm94
eWRfaW4sIHRpbWUoTlVMTCkgKyBJRExFX1RJTUVPVVQsDQpAQCAtMTA0MCw3ICsxMjk0LDcgQEAN
CiAgICAgLyogY2hlY2sgaWYgcmVtb3RlIHJlYWxtICovDQogICAgIGlmICgocmVhbG0gPSBzdHJj
aHIoYXV0aF9pZGVudGl0eSwgJ0AnKSkhPU5VTEwpIHsNCiAJcmVhbG0rKzsNCi0JdmFsID0gY29u
ZmlnX2dldHN0cmluZygibG9naW5yZWFsbXMiLCAiIik7DQorCXZhbCA9IGNvbmZpZ19nZXRzdHJp
bmcoSU1BUE9QVF9MT0dJTlJFQUxNUyk7DQogCXdoaWxlICgqdmFsKSB7DQogCSAgICBpZiAoIXN0
cm5jYXNlY21wKHZhbCwgcmVhbG0sIHN0cmxlbihyZWFsbSkpICYmDQogCQkoIXZhbFtzdHJsZW4o
cmVhbG0pXSB8fCBpc3NwYWNlKChpbnQpIHZhbFtzdHJsZW4ocmVhbG0pXSkpKSB7DQpAQCAtMTA2
MCwxNiArMTMxNCwxNiBAQA0KICAgICBwcm94eWRfYXV0aHN0YXRlID0gYXV0aF9uZXdzdGF0ZShh
dXRoX2lkZW50aXR5LCBOVUxMKTsNCiANCiAgICAgLyogb2ssIGlzIGF1dGhfaWRlbnRpdHkgYW4g
YWRtaW4/ICovDQotICAgIHByb3h5ZF91c2VyaXNhZG1pbiA9IGF1dGhpc2EocHJveHlkX2F1dGhz
dGF0ZSwgImltYXAiLCAiYWRtaW5zIik7DQorICAgIHByb3h5ZF91c2VyaXNhZG1pbiA9IGNvbmZp
Z19hdXRoaXNhKHByb3h5ZF9hdXRoc3RhdGUsIElNQVBPUFRfQURNSU5TKTsNCiANCiAgICAgaWYg
KHN0cmNtcChhdXRoX2lkZW50aXR5LCByZXF1ZXN0ZWRfdXNlcikpIHsNCiAJLyogd2Ugd2FudCB0
byBhdXRoZW50aWNhdGUgYXMgYSBkaWZmZXJlbnQgdXNlcjsgd2UnbGwgYWxsb3cgdGhpcw0KIAkg
ICBpZiB3ZSdyZSBhbiBhZG1pbiBvciBpZiB3ZSd2ZSBhbGxvd2VkIEFDTCBwcm94eSBsb2dpbnMg
Ki8NCi0JaW50IHVzZV9hY2wgPSBjb25maWdfZ2V0c3dpdGNoKCJsb2dpbnVzZWFjbCIsIDApOw0K
KwlpbnQgdXNlX2FjbCA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9MT0dJTlVTRUFDTCk7DQog
DQogCWlmIChwcm94eWRfdXNlcmlzYWRtaW4gfHwNCiAJICAgICh1c2VfYWNsICYmIGFjbF9vayhy
ZXF1ZXN0ZWRfdXNlciwgYXV0aF9pZGVudGl0eSkpIHx8DQotCSAgICBhdXRoaXNhKHByb3h5ZF9h
dXRoc3RhdGUsICJpbWFwIiwgInByb3h5c2VydmVycyIpKSB7DQorCSAgICBjb25maWdfYXV0aGlz
YShwcm94eWRfYXV0aHN0YXRlLCBJTUFQT1BUX1BST1hZU0VSVkVSUykpIHsNCiAJICAgIC8qIHBy
b3h5IG9rISAqLw0KIA0KIAkgICAgcHJveHlkX3VzZXJpc2FkbWluID0gMDsJLyogbm8gbG9uZ2Vy
IGFkbWluICovDQpAQCAtMTEwOSw3ICsxMzYzLDYgQEANCiAgICAgaW50IG9wdDsNCiAgICAgaW50
IHI7DQogDQotICAgIGNvbmZpZ19jaGFuZ2VpZGVudCgicHJveHlkIik7DQogICAgIGlmIChnZXRl
dWlkKCkgPT0gMCkgZmF0YWwoIm11c3QgcnVuIGFzIHRoZSBDeXJ1cyB1c2VyIiwgRUNfVVNBR0Up
Ow0KICAgICBzZXRwcm9jdGl0bGVfaW5pdChhcmdjLCBhcmd2LCBlbnZwKTsNCiANCkBAIC0xMzE4
LDcgKzE1NzEsNyBAQA0KICAgICBwcm9jX3JlZ2lzdGVyKCJwcm94eWQiLCBwcm94eWRfY2xpZW50
aG9zdCwgKGNoYXIgKikwLCAoY2hhciAqKTApOw0KIA0KICAgICAvKiBTZXQgaW5hY3Rpdml0eSB0
aW1lciAqLw0KLSAgICB0aW1lb3V0ID0gY29uZmlnX2dldGludCgidGltZW91dCIsIDMwKTsNCisg
ICAgdGltZW91dCA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9USU1FT1VUKTsNCiAgICAgaWYgKHRp
bWVvdXQgPCAzMCkgdGltZW91dCA9IDMwOw0KICAgICBwcm90X3NldHRpbWVvdXQocHJveHlkX2lu
LCB0aW1lb3V0KjYwKTsNCiAgICAgcHJvdF9zZXRmbHVzaG9ucmVhZChwcm94eWRfaW4sIHByb3h5
ZF9vdXQpOw0KQEAgLTIxNzMsNyArMjQyNiw3IEBADQogDQogICAgIC8qIHBvc3NpYmx5IGRpc2Fs
bG93IGxvZ2luICovDQogICAgIGlmICgocHJveHlkX3N0YXJ0dGxzX2RvbmUgPT0gMCkgJiYNCi0J
KGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0IiwgMSkgPT0gMCkgJiYNCisJKGNvbmZp
Z19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV1BMQUlOVEVYVCkgPT0gMCkgJiYNCiAJc3RyY21wKGNh
bm9uX3VzZXIsICJhbm9ueW1vdXMiKSAhPSAwKSB7DQogCWVhdGxpbmUocHJveHlkX2luLCAnICcp
Ow0KIAlwcm90X3ByaW50Zihwcm94eWRfb3V0LCAiJXMgTk8gTG9naW4gb25seSBhdmFpbGFibGUg
dW5kZXIgYSBsYXllclxyXG4iLA0KQEAgLTIxOTcsNyArMjQ1MCw3IEBADQogICAgIHBhc3N3ZCA9
IHBhc3N3ZGJ1Zi5zOw0KIA0KICAgICBpZiAoIXN0cmNtcChjYW5vbl91c2VyLCAiYW5vbnltb3Vz
IikpIHsNCi0JaWYgKGNvbmZpZ19nZXRzd2l0Y2goImFsbG93YW5vbnltb3VzbG9naW4iLCAwKSkg
ew0KKwlpZiAoY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XQU5PTllNT1VTTE9HSU4pKSB7
DQogCSAgICBwYXNzd2QgPSBiZWF1dGlmeV9zdHJpbmcocGFzc3dkKTsNCiAJICAgIGlmIChzdHJs
ZW4ocGFzc3dkKSA+IDUwMCkgcGFzc3dkWzUwMF0gPSAnXDAnOw0KIAkgICAgc3lzbG9nKExPR19O
T1RJQ0UsICJsb2dpbjogJXMgYW5vbnltb3VzICVzIiwNCkBAIC0yMjM4LDEyICsyNDkxLDE4IEBA
DQogICAgIH0NCiAgICAgZWxzZSB7DQogCXByb3h5ZF91c2VyaWQgPSB4c3RyZHVwKGNhbm9uX3Vz
ZXIpOw0KKzw8PDw8PDwgcHJveHlkLmMNCisJc3lzbG9nKExPR19OT1RJQ0UsICJsb2dpbjogJXMg
JXMgcGxhaW50ZXh0ICVzIiwgcHJveHlkX2NsaWVudGhvc3QsDQorCSAgICAgICBjYW5vbl91c2Vy
LCByZXBseSA/IHJlcGx5IDogIiIpOw0KKwlwbGFpbnRleHRsb2dpbnBhdXNlID0gY29uZmlnX2dl
dGludChJTUFQT1BUX1BMQUlOVEVYVExPR0lOUEFVU0UpOw0KKz09PT09PT0NCiANCiAJc3lzbG9n
KExPR19OT1RJQ0UsICJsb2dpbjogJXMgJXMgcGxhaW50ZXh0JXMgJXMiLCBwcm94eWRfY2xpZW50
aG9zdCwNCiAJICAgICAgIGNhbm9uX3VzZXIsIHByb3h5ZF9zdGFydHRsc19kb25lID8gIitUTFMi
IDogIiIsIA0KIAkgICAgICAgcmVwbHkgPyByZXBseSA6ICIiKTsNCiANCiAJcGxhaW50ZXh0bG9n
aW5wYXVzZSA9IGNvbmZpZ19nZXRpbnQoInBsYWludGV4dGxvZ2lucGF1c2UiLCAwKTsNCis+Pj4+
Pj4+IDEuMTI4DQogCWlmIChwbGFpbnRleHRsb2dpbnBhdXNlKSB7DQogDQogCSAgICAvKiBBcHBs
eSBwZW5hbHR5IG9ubHkgaWYgbm90IHVuZGVyIGxheWVyICovDQpAQCAtMjI1NSw3ICsyNTE0LDcg
QEANCiANCiAgICAgcHJveHlkX2F1dGhzdGF0ZSA9IGF1dGhfbmV3c3RhdGUoY2Fub25fdXNlciwg
KGNoYXIgKikwKTsNCiANCi0gICAgdmFsID0gY29uZmlnX2dldHN0cmluZygiYWRtaW5zIiwgIiIp
Ow0KKyAgICB2YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQURNSU5TKTsNCiAgICAgd2hp
bGUgKCp2YWwpIHsNCiAJZm9yIChwID0gKGNoYXIgKil2YWw7ICpwICYmICFpc3NwYWNlKChpbnQp
ICpwKTsgcCsrKTsNCiAJc3RybGNweShidWYsIHZhbCwgcCAtIHZhbCk7DQpAQCAtMjU4Nyw3ICsy
ODQ2LDcgQEANCiANCiAgICAgLyogc3BpdCBvdXQgb3VyIElEIHN0cmluZy4NCiAgICAgICAgZXZl
bnR1YWxseSB0aGlzIG1pZ2h0IGJlIGNvbmZpZ3VyYWJsZS4gKi8NCi0gICAgaWYgKGNvbmZpZ19n
ZXRzd2l0Y2goImltYXBpZHJlc3BvbnNlIiwgMSkpIHsNCisgICAgaWYgKGNvbmZpZ19nZXRzd2l0
Y2goSU1BUE9QVF9JTUFQSURSRVNQT05TRSkpIHsNCiAJaWRfcmVzcG9uc2UocHJveHlkX291dCk7
DQogDQogCS8qIGFkZCBpbmZvIGFib3V0IHRoZSBiYWNrZW5kICovDQpAQCAtMjY1MSw3ICsyOTEw
LDcgQEANCiANCiAgICAgLyogZ2V0IHBvbGxpbmcgcGVyaW9kICovDQogICAgIGlmIChpZGxlX3Bl
cmlvZCA9PSAtMSkgew0KLSAgICAgIGlkbGVfcGVyaW9kID0gY29uZmlnX2dldGludCgiaW1hcGlk
bGVwb2xsIiwgNjApOw0KKyAgICAgIGlkbGVfcGVyaW9kID0gY29uZmlnX2dldGludChJTUFQT1BU
X0lNQVBJRExFUE9MTCk7DQogICAgICAgaWYgKGlkbGVfcGVyaW9kIDwgMSkgaWRsZV9wZXJpb2Qg
PSAxOw0KICAgICB9DQogDQpAQCAtMjg1NSwxMCArMzExNCwxNiBAQA0KIA0KICAgICBpZiAodGxz
X2VuYWJsZWQoImltYXAiKSkgew0KIAlwcm90X3ByaW50Zihwcm94eWRfb3V0LCAiIFNUQVJUVExT
Iik7DQorPDw8PDw8PCBwcm94eWQuYw0KKyAgICBpZiAoIXByb3h5ZF9zdGFydHRsc19kb25lICYm
ICFjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dQTEFJTlRFWFQpKSB7DQorCXByb3RfcHJp
bnRmKHByb3h5ZF9vdXQsICIgTE9HSU5ESVNBQkxFRCIpOw0KKyAgICB9DQorPT09PT09PQ0KICAg
ICB9DQogICAgIGlmICghcHJveHlkX3N0YXJ0dGxzX2RvbmUgJiYgIWNvbmZpZ19nZXRzd2l0Y2go
ImFsbG93cGxhaW50ZXh0IiwgMSkpIHsNCiAJcHJvdF9wcmludGYocHJveHlkX291dCwgIiBMT0dJ
TkRJU0FCTEVEIik7CQ0KICAgICB9DQorPj4+Pj4+PiAxLjEwMA0KIA0KICAgICBpZiAoc2FzbF9s
aXN0bWVjaChwcm94eWRfc2FzbGNvbm4sIE5VTEwsIA0KIAkJICAgICAgIkFVVEg9IiwgIiBBVVRI
PSIsICIiLA0KQEAgLTM5MTksNyArNDE4NCw3IEBADQogICAgIC8qIElnbm9yZSB0aGUgcmVmZXJl
bmNlIGFyZ3VtZW50Pw0KICAgICAgICAodGhlIGJlaGF2aW9yIGluIDEuNS4xMCAmIG9sZGVyKSAq
Lw0KICAgICBpZiAoaWdub3JlcmVmZXJlbmNlID09IC0xKSB7DQotCWlnbm9yZXJlZmVyZW5jZSA9
IGNvbmZpZ19nZXRzd2l0Y2goImlnbm9yZXJlZmVyZW5jZSIsIDApOw0KKwlpZ25vcmVyZWZlcmVu
Y2UgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfSUdOT1JFUkVGRVJFTkNFKTsNCiAgICAgfQ0K
IA0KICAgICAvKiBSZXNldCBzdGF0ZSBpbiBtc3RyaW5nZGF0YSAqLw0KQEAgLTQ2NTAsOCArNDkx
NSw3IEBADQogICAgIGNvbnN0IGNoYXIgKnVybDsNCiAgICAgLyogc28gdGVtcHRpbmcsIGFuZCB5
ZXQgLi4uICovDQogICAgIC8qIHVybCA9ICJodHRwOi8vcmFuZG9tLnlhaG9vLmNvbS9yeWwvIjsg
Ki8NCi0gICAgdXJsID0gY29uZmlnX2dldHN0cmluZygibmV0c2NhcGV1cmwiLA0KLQkJCSAgICJo
dHRwOi8vYW5kcmV3Mi5hbmRyZXcuY211LmVkdS9jeXJ1cy9pbWFwZC9uZXRzY2FwZS1hZG1pbi5o
dG1sIik7DQorICAgIHVybCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9ORVRTQ0FQRVVSTCk7
DQogDQogICAgIC8qIEkgb25seSBrbm93IG9mIHRocmVlIHRoaW5ncyB0byByZXBseSB3aXRoOiAq
Lw0KICAgICBwcm90X3ByaW50Zihwcm94eWRfb3V0LA0KSW5kZXg6IGltYXAvc2VuZG1haWwtbWFw
LmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMv
c3JjL2N5cnVzL2ltYXAvc2VuZG1haWwtbWFwLmMsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjQN
CmRpZmYgLXUgLXIxLjQgc2VuZG1haWwtbWFwLmMNCi0tLSBzZW5kbWFpbC1tYXAuYwkyMDAxLzEx
LzI3IDAyOjI1OjAwCTEuNA0KKysrIHNlbmRtYWlsLW1hcC5jCTIwMDIvMDYvMTQgMTc6MDU6MTMN
CkBAIC0xMzgsMTQgKzEzOCwxNCBAQA0KICAgICBzYXNsX2NhbGxiYWNrX3QgKmNiOw0KIA0KICAg
ICBpZiAoIXVzZXIpIHsNCi0JdXNlciA9IGNvbmZpZ19nZXRzdHJpbmcoImFjYXBfdXNlcm5hbWUi
LCBOVUxMKTsNCisJdXNlciA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9BQ0FQX1VTRVJOQU1F
KTsNCiAgICAgfQ0KICAgICBpZiAodXNlciA9PSBOVUxMKSB7DQogCXN5c2xvZyhMT0dfRVJSLCAi
dW5hYmxlIHRvIGZpbmQgb3B0aW9uIGFjYXBfdXNlcm5hbWUiKTsNCiAJZmF0YWwoImNvdWxkbid0
IGNvbm5lY3QgdG8gYWNhcCBzZXJ2ZXIiLCBFQ19VTkFWQUlMQUJMRSk7DQogICAgIH0NCiANCi0g
ICAgYXV0aHByb2cgPSBjb25maWdfZ2V0c3RyaW5nKCJhY2FwX2dldGF1dGgiLCBOVUxMKTsNCisg
ICAgYXV0aHByb2cgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQUNBUF9HRVRBVVRIKTsNCiAg
ICAgaWYgKGF1dGhwcm9nKSB7DQogCXN5c3RlbShhdXRocHJvZyk7DQogICAgIH0NCkBAIC0xNjIs
OSArMTYyLDkgQEANCiAgICAgciA9IEFDQVBfTk9fQ09OTkVDVElPTjsNCiANCiAgICAgY2IgPSBt
eXNhc2xfY2FsbGJhY2tzKHVzZXIsDQotCQkJICBjb25maWdfZ2V0c3RyaW5nKCJhY2FwX2F1dGhu
YW1lIiwgdXNlciksDQotCQkJICBjb25maWdfZ2V0c3RyaW5nKCJhY2FwX3JlYWxtIiwgTlVMTCks
DQotCQkJICBjb25maWdfZ2V0c3RyaW5nKCJhY2FwX3Bhc3N3b3JkIiwgTlVMTCkpOw0KKwkJCSAg
Y29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0FDQVBfQVVUSE5BTUUpLA0KKwkJCSAgY29uZmlnX2dl
dHN0cmluZyhJTUFQT1BUX0FDQVBfUkVBTE0pLA0KKwkJCSAgY29uZmlnX2dldHN0cmluZyhJTUFQ
T1BUX0FDQVBfUEFTU1dPUkQpKTsNCiAgICAgciA9IGFjYXBfY29ubl9jb25uZWN0KGFjYXB1cmws
IGNiLCAmYWNhcF9jb25uKTsNCiAgICAgZnJlZV9jYWxsYmFja3MoY2IpOw0KICAgICBpZiAociAh
PSBBQ0FQX09LKSB7DQpAQCAtNDc2LDcgKzQ3Niw3IEBADQogDQogICAgIGFjYXBfaW5pdCgpOw0K
IA0KLSAgICBzZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKCJhY2FwX3NlcnZlciIsIE5VTEwpOw0K
KyAgICBzZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQUNBUF9TRVJWRVIpOw0KICAg
ICBpZiAoIXNlcnZlcikgZmF0YWwoIm5vIEFDQVAgc2VydmVycyBzcGVjaWZpZWQiLCBFQ19VU0FH
RSk7DQogICAgIA0KICAgICBzaWduYWwoU0lHVEVSTSwgJmhhbmRsZXIpOw0KQEAgLTUwMCw3ICs1
MDAsNyBAQA0KIAkgICAgZmF0YWwoImNhbid0IGRvd25sb2FkIGxpc3Qgb2YgbWFpbGJveGVzXG4i
LCBFQ19VTkFWQUlMQUJMRSk7DQogCX0gZWxzZSB7DQogCSAgICBhY2FwX2Nvbm5fY2xvc2UoYWNh
cF9jb25uKTsNCi0JICAgIHNsZWVwKGNvbmZpZ19nZXRpbnQoImFjYXBfcmV0cnlfdGltZW91dCIs
IDYwKSk7DQorCSAgICBzbGVlcChjb25maWdfZ2V0aW50KElNQVBPUFRfQUNBUF9SRVRSWV9USU1F
T1VUKSk7DQogCSAgICBleGVjdihhcmd2WzBdLCBhcmd2KTsNCiAJfQ0KICAgICB9DQpAQCAtNTMz
LDcgKzUzMyw3IEBADQogCSAgIHRvIHJlZXN0YWJsaXNoIHRoZSBjb25uZWN0aW9uIHdpdGggdGhl
IEFDQVAgc2VydmVyIGFuZA0KIAkgICByZXN5bmNocm9uaXplICovDQogCWFjYXBfY29ubl9jbG9z
ZShhY2FwX2Nvbm4pOw0KLQlzbGVlcChjb25maWdfZ2V0aW50KCJhY2FwX3JldHJ5X3RpbWVvdXQi
LCA2MCkpOw0KKwlzbGVlcChjb25maWdfZ2V0aW50KElNQVBPUFRfQUNBUF9SRVRSWV9USU1FT1VU
KSk7DQogCWV4ZWN2KGFyZ3ZbMF0sIGFyZ3YpOw0KICAgICB9DQogDQpJbmRleDogaW1hcC9zeW5j
bmV3cy5jDQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0v
Y3ZzL3NyYy9jeXJ1cy9pbWFwL3N5bmNuZXdzLmMsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjE5
DQpkaWZmIC11IC1yMS4xOSBzeW5jbmV3cy5jDQotLS0gc3luY25ld3MuYwkyMDAxLzAyLzIyIDE5
OjI3OjIwCTEuMTkNCisrKyBzeW5jbmV3cy5jCTIwMDIvMDYvMTQgMTc6MDU6MTQNCkBAIC0xNDAs
NyArMTQwLDcgQEANCiAgICAgaW50IG5ld3NwcmVmaXhsZW4gPSAwOw0KICAgICBpbnQgbGluZW5v
ID0gMDsNCiANCi0gICAgbmV3c3ByZWZpeCA9IGNvbmZpZ19nZXRzdHJpbmcoIm5ld3NwcmVmaXgi
LCAwKTsNCisgICAgbmV3c3ByZWZpeCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9ORVdTUFJF
RklYKTsNCiAgICAgaWYgKG5ld3NwcmVmaXgpIHsNCiAJbmV3c3ByZWZpeGxlbiA9IHN0cmxlbihu
ZXdzcHJlZml4KTsNCiAJaWYgKG5ld3NwcmVmaXhbbmV3c3ByZWZpeGxlbi0xXSA9PSAnLicpIHsN
CkluZGV4OiBpbWFwL3RhcmdldC1hY2FwLmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvYWZzL2Fu
ZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvdGFyZ2V0LWFjYXAuYyx2DQpy
ZXRyaWV2aW5nIHJldmlzaW9uIDEuMjgNCmRpZmYgLXUgLXIxLjI4IHRhcmdldC1hY2FwLmMNCi0t
LSB0YXJnZXQtYWNhcC5jCTIwMDEvMTEvMjcgMDI6MjU6MDAJMS4yOA0KKysrIHRhcmdldC1hY2Fw
LmMJMjAwMi8wNi8xNCAxNzowNToxNA0KQEAgLTEzMSw3ICsxMzEsNyBAQA0KICAgICBzYXNsX2Nh
bGxiYWNrX3QgKmNiOw0KICAgICBzdGF0aWMgaW50IGZpcnN0dGltZSA9IDE7DQogDQotICAgIHVz
ZXIgPSBjb25maWdfZ2V0c3RyaW5nKCJhY2FwX3VzZXJuYW1lIiwgTlVMTCk7DQorICAgIHVzZXIg
PSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQUNBUF9VU0VSTkFNRSk7DQogICAgIGlmICh1c2Vy
ID09IE5VTEwpIHsNCiAgICAgICAgIHN5c2xvZyhMT0dfRVJSLCAidW5hYmxlIHRvIGZpbmQgb3B0
aW9uIGFjYXBfdXNlcm5hbWUiKTsNCiAJZmF0YWwoImNvdWxkbid0IGNvbm5lY3QgdG8gYWNhcCBz
ZXJ2ZXIiLCBFQ19VTkFWQUlMQUJMRSk7DQpAQCAtMTM5LDExICsxMzksMTEgQEANCiANCiAgICAg
aWYgKGZpcnN0dGltZSkgew0KIAljYiA9IG15c2FzbF9jYWxsYmFja3ModXNlciwNCi0JCQkgICAg
ICBjb25maWdfZ2V0c3RyaW5nKCJhY2FwX2F1dGhuYW1lIiwgdXNlciksDQotCQkJICAgICAgY29u
ZmlnX2dldHN0cmluZygiYWNhcF9yZWFsbSIsIE5VTEwpLA0KLQkJCSAgICAgIGNvbmZpZ19nZXRz
dHJpbmcoImFjYXBfcGFzc3dvcmQiLCBOVUxMKSk7DQorCQkJICAgICAgY29uZmlnX2dldHN0cmlu
ZyhJTUFQT1BUX0FDQVBfQVVUSE5BTUUpLA0KKwkJCSAgICAgIGNvbmZpZ19nZXRzdHJpbmcoSU1B
UE9QVF9BQ0FQX1JFQUxNKSwNCisJCQkgICAgICBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQUNB
UF9QQVNTV09SRCkpOw0KIA0KLQlhdXRocHJvZyA9IGNvbmZpZ19nZXRzdHJpbmcoImFjYXBfZ2V0
YXV0aCIsIE5VTEwpOw0KKwlhdXRocHJvZyA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9BQ0FQ
X0dFVEFVVEgpOw0KIAlpZiAoYXV0aHByb2cpIHsNCiAgICAgICAgICAgICBzeXN0ZW0oYXV0aHBy
b2cpOw0KIAl9DQpAQCAtMTY2LDcgKzE2Niw3IEBADQogICAgIHIgPSBhY2FwX2Nvbm5fY29ubmVj
dChhY2FwdXJsLCBjYiwgJmFjYXBfY29ubik7DQogICAgIGZyZWVfY2FsbGJhY2tzKGNiKTsNCiAg
ICAgaWYgKHIgIT0gQUNBUF9PSykgew0KLQlpbnQgdCA9IGNvbmZpZ19nZXRpbnQoImFjYXBfcmV0
cnlfdGltZW91dCIsIDYwKTsNCisJaW50IHQgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfQUNBUF9S
RVRSWV9USU1FT1VUKTsNCiAJDQogCWFjYXBfY29ubl9jbG9zZShhY2FwX2Nvbm4pOw0KICAgICAg
ICAgc3lzbG9nKExPR19XQVJOSU5HLCAiY291bGRuJ3QgY29ubmVjdCB0byBBQ0FQIHNlcnZlcjog
JXM7Ig0KQEAgLTU5Myw3ICs1OTMsNyBAQA0KIA0KICAgICBhY2FwX2luaXQoKTsNCiANCi0gICAg
c2VydmVyID0gY29uZmlnX2dldHN0cmluZygiYWNhcF9zZXJ2ZXIiLCBOVUxMKTsNCisgICAgc2Vy
dmVyID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0FDQVBfU0VSVkVSKTsNCiAgICAgaWYgKCFz
ZXJ2ZXIpIGZhdGFsKCJubyBBQ0FQIHNlcnZlcnMgc3BlY2lmaWVkIiwgRUNfVVNBR0UpOw0KICAg
ICANCiAgICAgbWJveGxpc3RfaW5pdCgwKTsNCkluZGV4OiBpbWFwL3Rscy5jDQo9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
DQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFw
L3Rscy5jLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS4zOA0KZGlmZiAtdSAtcjEuMzggdGxzLmMN
Ci0tLSB0bHMuYwkyMDAyLzA2LzAzIDE2OjU5OjU3CTEuMzgNCisrKyB0bHMuYwkyMDAyLzA2LzE0
IDE3OjA1OjE0DQpAQCAtMTUwLDE3ICsxNTAsMTIgQEANCiANCiBpbnQgdGxzX2VuYWJsZWQoY29u
c3QgY2hhciAqaWRlbnQpDQogew0KLSAgICBjaGFyIGJ1Zls1MF07DQogICAgIGNvbnN0IGNoYXIg
KnZhbDsNCiANCi0gICAgc3ByaW50ZihidWYsICJ0bHNfJXNfY2VydF9maWxlIiwgaWRlbnQpOw0K
LSAgICB2YWwgPSBjb25maWdfZ2V0c3RyaW5nKGJ1ZiwNCi0JCQkgICBjb25maWdfZ2V0c3RyaW5n
KCJ0bHNfY2VydF9maWxlIiwgTlVMTCkpOw0KKyAgICB2YWwgPSBjb25maWdfZ2V0c3RyaW5nKElN
QVBPUFRfVExTX0NFUlRfRklMRSk7DQogICAgIGlmICghdmFsIHx8ICFzdHJjYXNlY21wKHZhbCwg
ImRpc2FibGVkIikpIHJldHVybiAwOw0KIA0KLSAgICBzcHJpbnRmKGJ1ZiwgInRsc18lc19rZXlf
ZmlsZSIsIGlkZW50KTsNCi0gICAgdmFsID0gY29uZmlnX2dldHN0cmluZyhidWYsDQotCQkJICAg
Y29uZmlnX2dldHN0cmluZygidGxzX2tleV9maWxlIiwgTlVMTCkpOw0KKyAgICB2YWwgPSBjb25m
aWdfZ2V0c3RyaW5nKElNQVBPUFRfVExTX0tFWV9GSUxFKTsNCiAgICAgaWYgKCF2YWwgfHwgIXN0
cmNhc2VjbXAodmFsLCAiZGlzYWJsZWQiKSkgcmV0dXJuIDA7DQogDQogICAgIHJldHVybiAxOw0K
QEAgLTYxOCw3ICs2MTMsNyBAQA0KIAkJCQkgICBTU0xfU0VTU19DQUNIRV9OT19JTlRFUk5BTF9M
T09LVVApOw0KIA0KICAgICAvKiBHZXQgdGhlIHNlc3Npb24gdGltZW91dCBmcm9tIHRoZSBjb25m
aWcgZmlsZSAoaW4gbWludXRlcykgKi8NCi0gICAgdGltZW91dCA9IGNvbmZpZ19nZXRpbnQoInRs
c19zZXNzaW9uX3RpbWVvdXQiLCAxNDQwKTsgLyogMjQgaG91cnMgKi8NCisgICAgdGltZW91dCA9
IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9UTFNfU0VTU0lPTl9USU1FT1VUKTsNCiAgICAgaWYgKHRp
bWVvdXQgPCAwKSB0aW1lb3V0ID0gMDsNCiAgICAgaWYgKHRpbWVvdXQgPiAxNDQwKSB0aW1lb3V0
ID0gMTQ0MDsgLyogMjQgaG91cnMgbWF4ICovDQogDQpAQCAtNjYxLDEyICs2NTYsMTcgQEANCiAJ
fQ0KICAgICB9DQogDQorPDw8PDw8PCB0bHMuYw0KKyAgICBDQWZpbGUgPSBjb25maWdfZ2V0c3Ry
aW5nKElNQVBPUFRfVExTX0NBX0ZJTEUpOw0KKyAgICBDQXBhdGggPSBjb25maWdfZ2V0c3RyaW5n
KElNQVBPUFRfVExTX0NBX1BBVEgpOw0KKz09PT09PT0NCiAgICAgY2lwaGVyX2xpc3QgPSBjb25m
aWdfZ2V0c3RyaW5nKCJ0bHNfY2lwaGVyX2xpc3QiLCAiREVGQVVMVCIpOw0KICAgICBpZiAoIVNT
TF9DVFhfc2V0X2NpcGhlcl9saXN0KGN0eCwgY2lwaGVyX2xpc3QpKSB7DQogCXN5c2xvZyhMT0df
RVJSLCJUTFMgZW5naW5lOiBjYW5ub3QgbG9hZCBjaXBoZXIgbGlzdCAnJXMnIiwNCiAJICAgICAg
IGNpcGhlcl9saXN0KTsNCiAJcmV0dXJuICgtMSk7DQogICAgIH0NCis+Pj4+Pj4+IDEuMzUNCiAN
CiAgICAgQ0FmaWxlID0gY29uZmlnX2dldHN0cmluZygidGxzX2NhX2ZpbGUiLCBOVUxMKTsNCiAg
ICAgQ0FwYXRoID0gY29uZmlnX2dldHN0cmluZygidGxzX2NhX3BhdGgiLCBOVUxMKTsNCkBAIC02
NzcsNiArNjc3LDEwIEBADQogCXN5c2xvZyhMT0dfTk9USUNFLCJUTFMgZW5naW5lOiBjYW5ub3Qg
bG9hZCBDQSBkYXRhIik7CQ0KICAgICB9DQogDQorPDw8PDw8PCB0bHMuYw0KKyAgICBzX2NlcnRf
ZmlsZSA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9UTFNfQ0VSVF9GSUxFKTsNCisgICAgc19r
ZXlfZmlsZSA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9UTFNfS0VZX0ZJTEUpOw0KKz09PT09
PT0NCiAgICAgc3ByaW50ZihidWYsICJ0bHNfJXNfY2VydF9maWxlIiwgaWRlbnQpOw0KICAgICBz
X2NlcnRfZmlsZSA9IGNvbmZpZ19nZXRzdHJpbmcoYnVmLA0KIAkJCQkgICBjb25maWdfZ2V0c3Ry
aW5nKCJ0bHNfY2VydF9maWxlIiwgTlVMTCkpOw0KQEAgLTY4NCw2ICs2ODgsNyBAQA0KICAgICBz
cHJpbnRmKGJ1ZiwgInRsc18lc19rZXlfZmlsZSIsIGlkZW50KTsNCiAgICAgc19rZXlfZmlsZSA9
IGNvbmZpZ19nZXRzdHJpbmcoYnVmLA0KIAkJCQkgIGNvbmZpZ19nZXRzdHJpbmcoInRsc19rZXlf
ZmlsZSIsIE5VTEwpKTsNCis+Pj4+Pj4+IDEuMzUNCiANCiAgICAgaWYgKCFzZXRfY2VydF9zdHVm
ZihjdHgsIHNfY2VydF9maWxlLCBzX2tleV9maWxlKSkgew0KIAlzeXNsb2coTE9HX0VSUiwiVExT
IGVuZ2luZTogY2Fubm90IGxvYWQgY2VydC9rZXkgZGF0YSIpOw0KSW5kZXg6IG1hbi9pbWFwZC5j
b25mLjUNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9j
dnMvc3JjL2N5cnVzL21hbi9pbWFwZC5jb25mLjUsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjY0
DQpkaWZmIC11IC1yMS42NCBpbWFwZC5jb25mLjUNCi0tLSBpbWFwZC5jb25mLjUJMjAwMi8wNi8x
MCAxODozNToxMgkxLjY0DQorKysgaW1hcGQuY29uZi41CTIwMDIvMDYvMTQgMTc6MDU6MTUNCkBA
IC02OCwxMDQgKzY4LDMzIEBADQogYGA8bm8gZGVmYXVsdD4nJy4gIFNvbWUgb3B0aW9ucyBkZWZh
dWx0IHRvIHRoZSBlbXB0eSBzdHJpbmcsIHRoZXNlDQogYXJlIGxpc3RlZCB3aXRoIGBgPG5vbmU+
JycuDQogLklQICJcZkJjb25maWdkaXJlY3Rvcnk6XGZSIDxubyBkZWZhdWx0PiIgNQ0KLVRoZSBw
YXRobmFtZSBvZiB0aGUgSU1BUCBjb25maWd1cmF0aW9uIGRpcmVjdG9yeS4gIFRoaXMgZmllbGQg
aXMgcmVxdWlyZWQuDQogLklQICJcZkJkZWZhdWx0cGFydGl0aW9uOlxmUiBkZWZhdWx0IiA1DQot
VGhlIHBhcnRpdGlvbiBuYW1lIHVzZWQgYnkgZGVmYXVsdCBmb3IgbmV3IG1haWxib3hlcy4NCiAu
SVAgIlxmQnBhcnRpdGlvbi1cZkluYW1lXGZCOlxmUiA8bm8gZGVmYXVsdD4iIDUNCiBUaGUgcGF0
aG5hbWUgb2YgdGhlIHBhcnRpdGlvbiBcZkluYW1lXGZSLiAgQXQgbGVhc3Qgb25lIGZpZWxkLCBm
b3IgdGhlDQogcGFydGl0aW9uIG5hbWVkIGluIHRoZSBcZkJkZWZhdWx0cGFydGl0aW9uXGZSIG9w
dGlvbiwgaXMgcmVxdWlyZWQuDQogRm9yIGV4YW1wbGUsIGlmIHRoZSB2YWx1ZSBvZiB0aGUgXGZC
ZGVmYXVsdHBhcnRpb25cZlIgb3B0aW9uIGlzDQogXGZCZGVmYXVsdFxmUiwgdGhlbiB0aGUgXGZC
cGFydGl0aW9uLWRlZmF1bHRcZlIgZmllbGQgaXMgcmVxdWlyZWQuDQogLklQICJcZkJ1bml4aGll
cmFyY2h5c2VwOlxmUiBubyIgNQ0KLVVzZSB0aGUgVU5JWCBzZXBhcmF0b3IgY2hhcmFjdGVyICcv
JyBmb3IgZGVsaW1pdGluZyBsZXZlbHMgb2YgbWFpbGJveA0KLWhpZXJhcmNoeS4gIFRoZSBkZWZh
dWx0IGlzIHRvIHVzZSB0aGUgbmV0bmV3cyBzZXBhcmF0b3IgY2hhcmFjdGVyICcuJy4gDQogLklQ
ICJcZkJhbHRuYW1lc3BhY2U6XGZSIG5vIiA1DQotVXNlIHRoZSBhbHRlcm5hdGUgSU1BUCBuYW1l
c3BhY2UsIHdoZXJlIHBlcnNvbmFsIGZvbGRlcnMgcmVzaWRlIGF0IHRoZQ0KLXNhbWUgbGV2ZWwg
aW4gdGhlIGhpZXJhcmNoeSBhcyBJTkJPWC4NCi0uYnINCi0uc3ANCi1UaGlzIG9wdGlvbiBPTkxZ
IGFwcGxpZXMgd2hlcmUgaW50ZXJhY3Rpb24gdGFrZXMgcGxhY2Ugd2l0aCB0aGUNCi1jbGllbnQv
dXNlci4gIEN1cnJlbnRseSB0aGlzIGlzIGxpbWl0ZWQgdG8gdGhlIElNQVAgcHJvdG9jb2wgKGlt
YXBkKQ0KLWFuZCBTaWV2ZSBzY3JpcHRzIChsbXRwZCkuICBUaGlzIG9wdGlvbiBkb2VzIE5PVCBh
cHBseSB0byBhZG1pbiB0b29scw0KLXN1Y2ggYXMgY3lyYWRtIChhZG1pbnMgT05MWSksIHJlY29u
c3RydWN0LCBxdW90YSwgZXRjLiwgTk9SIGRvZXMgaXQNCi1hZmZlY3QgTE1UUCBkZWxpdmVyeSBv
ZiBtZXNzYWdlcyBkaXJlY3RseSB0byBtYWlsYm94ZXMgdmlhIHBsdXMtYWRkcmVzc2luZy4NCiAu
SVAgIlxmQnVzZXJwcmVmaXg6XGZSIE90aGVyIFVzZXJzIiA1DQotSWYgdXNpbmcgdGhlIGFsdGVy
bmF0ZSBJTUFQIG5hbWVzcGFjZSwgdGhlIHByZWZpeCBmb3IgdGhlIG90aGVyIHVzZXJzDQotbmFt
ZXNwYWNlLiAgVGhlIGhpZXJhcmNoeSBkZWxpbWl0ZXIgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGFw
cGVuZGVkLg0KIC5JUCAiXGZCc2hhcmVkcHJlZml4OlxmUiBTaGFyZWQgRm9sZGVycyIgNQ0KLUlm
IHVzaW5nIHRoZSBhbHRlcm5hdGUgSU1BUCBuYW1lc3BhY2UsIHRoZSBwcmVmaXggZm9yIHRoZSBz
aGFyZWQNCi1uYW1lc3BhY2UuICBUaGUgaGllcmFyY2h5IGRlbGltaXRlciB3aWxsIGJlIGF1dG9t
YXRpY2FsbHkgYXBwZW5kZWQuDQogLklQICJcZkJ1bWFzazpcZlIgMDc3IiA1DQotVGhlIHVtYXNr
IHZhbHVlIHVzZWQgYnkgdmFyaW91cyBDeXJ1cyBJTUFQIHByb2dyYW1zLg0KIC5JUCAiXGZCc2Vy
dmVybmFtZTpcZlIgPHJlc3VsdCByZXR1cm5lZCBieSBnZXRob3N0bmFtZSgyKT4iIDUNCi1UaGlz
IGlzIHRoZSBob3N0bmFtZSB2aXNpYmxlIGluIHRoZSBncmVldGluZyBtZXNzYWdlcyBvZiB0aGUg
UE9QLCBJTUFQIGFuZCBMTVRQDQotZGFlbW9ucy4gSWYgaXQgaXMgdW5zZXQsIHRoZW4gdGhlIHJl
c3VsdCByZXR1cm5lZCBmcm9tIGdldGhvc3RuYW1lKDIpIGlzIHVzZWQuDQogLklQICJcZkJhbGxv
d2Fub255bW91c2xvZ2luOlxmUiBubyIgNQ0KLVBlcm1pdCBsb2dpbnMgYnkgdGhlIHVzZXIgImFu
b255bW91cyIgdXNpbmcgYW55IHBhc3N3b3JkLiAgQWxzbyBhbGxvd3MNCi11c2Ugb2YgdGhlIFNB
U0wgQU5PTllNT1VTIG1lY2hhbmlzbS4NCiAuSVAgIlxmQmFsbG93cGxhaW50ZXh0OlxmUiB5ZXMi
IDUNCi1BbGxvdyB0aGUgdXNlIG9mIHRoZSBTQVNMIFBMQUlOIG1lY2hhbmlzbS4NCiAuSVAgIlxm
QnF1b3Rhd2FybjpcZlIgOTAiIDUNCi1UaGUgcGVyY2VudCBvZiBxdW90YSB1dGlsaXphdGlvbiBv
dmVyIHdoaWNoIHRoZSBzZXJ2ZXIgZ2VuZXJhdGVzDQotd2FybmluZ3MuDQogLklQICJcZkJ0aW1l
b3V0OlxmUiAzMCIgNQ0KLVRoZSBsZW5ndGggb2YgdGhlIElNQVAgc2VydmVyJ3MgaW5hY3Rpdml0
eSBhdXRvbG9nb3V0IHRpbWVyLA0KLWluIG1pbnV0ZXMuICBUaGUgbWluaW11bSB2YWx1ZSBpcyAz
MCwgdGhlIGRlZmF1bHQuDQogLklQICJcZkJpbWFwaWRsZXBvbGw6XGZSIDYwIiA1DQotVGhlIGlu
dGVydmFsIChpbiBzZWNvbmRzKSBmb3IgcG9sbGluZyB0aGUgbWFpbGJveCBmb3IgY2hhbmdlcyB3
aGlsZQ0KLXJ1bm5pbmcgdGhlIElETEUgY29tbWFuZC4gIFRoaXMgb3B0aW9uIGlzIHVzZWQgd2hl
biBpZGxlZCBjYW4gbm90IGJlDQotY29udGFjdGVkIG9yIHdoZW4gcG9sbGluZyBpcyB1c2VkIGV4
Y2x1c2l2ZWx5LiAgVGhlIG1pbmltdW0gdmFsdWUgaXMNCi0xLiAgQSB2YWx1ZSBvZiAwIHdpbGwg
ZGlzYWJsZSBwb2xsaW5nIChhbmQgZGlzYWJsZSBJRExFIGlmIHBvbGxpbmcgaXMNCi10aGUgb25s
eSBtZXRob2QgYXZhaWxhYmxlKS4NCiAuSVAgIlxmQmltYXBpZHJlc3BvbnNlOlxmUiB5ZXMiIDUN
Ci1JZiBlbmFibGVkLCB0aGUgc2VydmVyIHJlc3BvbmRzIHRvIGFuIElEIGNvbW1hbmQgd2l0aCBh
IHBhcmFtZXRlcg0KLWxpc3QgY29udGFpbmluZzogdmVyc2lvbiwgdmVuZG9yLCBzdXBwb3J0LXVy
bCwgb3MsIG9zLXZlcnNpb24sDQotY29tbWFuZCwgYXJndW1lbnRzLCBlbnZpcm9ubWVudC4gIE90
aGVyd2lzZSB0aGUgc2VydmVyIHJldHVybnMgTklMLg0KIC5JUCAiXGZCcG9wdGltZW91dDpcZlIg
MTAiIDUNCi1TZXQgdGhlIGxlbmd0aCBvZiB0aGUgUE9QIHNlcnZlcidzIGluYWN0aXZpdHkgYXV0
b2xvZ291dCB0aW1lciwNCi1pbiBtaW51dGVzLiAgVGhlIG1pbmltdW0gdmFsdWUgaXMgMTAsIHRo
ZSBkZWZhdWx0Lg0KIC5JUCAiXGZCcG9wbWlucG9sbDpcZlIgMCIgNQ0KLVNldCB0aGUgbWluaW11
bSBhbW91bnQgb2YgdGltZSB0aGUgc2VydmVyIGZvcmNlcyB1c2VycyB0byB3YWl0IGJldHdlZW4N
Ci1zdWNjZXNzaXZlIFBPUCBsb2dpbnMsDQotaW4gbWludXRlcy4gIFRoZSBkZWZhdWx0IGlzIDAu
DQogLklQICJcZkJwb3BleHBpcmV0aW1lOlxmUiAwIiA1DQotVGhlIG51bWJlciBvZiBkYXlzIGFk
dmVydGlzZWQgYXMgYmVpbmcgdGhlIG1pbmltdW0gYSBtZXNzYWdlIG1heSBiZSBsZWZ0IG9uDQot
dGhlIFBPUCBzZXJ2ZXIgYmVmb3JlIGl0IGlzIGRlbGV0ZWQgKHZpYSB0aGUgQ0FQQSBjb21tYW5k
LCBkZWZpbmVkIGluIHRoZSBQT1AzDQotRXh0ZW5zaW9uIE1lY2hhbmlzbSwgd2hpY2ggc29tZSBj
bGllbnRzIG1heSBzdXBwb3J0KS4gICJORVZFUiIsIHRoZSBkZWZhdWx0LA0KLW1heSBiZSBzcGVj
aWZpZWQgd2l0aCBhIG5lZ2F0aXZlIG51bWJlci4gIFRoZSBDeXJ1cyBQT1AzIHNlcnZlciBuZXZl
ciBkZWxldGVzDQotbWFpbCwgbm8gbWF0dGVyIHdoYXQgdGhlIHZhbHVlIG9mIHRoaXMgcGFyYW1l
dGVyIGlzLiAgSG93ZXZlciwgaWYgYSBzaXRlDQotaW1wbGVtZW50cyBhIGxlc3MgbGliZXJhbCBw
b2xpY3ksIGl0IG5lZWRzIHRvIGNoYW5nZSB0aGlzIHBhcmFtZXRlcg0KLWFjY29yZGluZ2x5Lg0K
IC5JUCAiXGZCYWRtaW5zOlxmUiA8bm9uZT4iIDUNCi1UaGUgbGlzdCBvZiB1c2VyaWRzIHdpdGgg
YWRtaW5pc3RyYXRpdmUgcmlnaHRzLiAgU2VwYXJhdGUgZWFjaCB1c2VyaWQNCi13aXRoIGEgc3Bh
Y2UuICBTaXRlcyB1c2luZyBLZXJiZXJvcyBhdXRoZW50aWNhdGlvbiBtYXkgdXNlDQotc2VwYXJh
dGUgImFkbWluIiBpbnN0YW5jZXMuDQotLlBQDQotTm90ZSB0aGF0IGFjY291bnRzIHVzZWQgYnkg
dXNlcnMgc2hvdWxkIG5vdCBiZSBhZG1pbmlzdHJhdG9ycy4gIEFkbWluaXN0cmF0aXZlIA0KLWFj
Y291bnRzIHNob3VsZCBub3QgcmVjZWl2ZSBtYWlsLiAgVGhhdCBpcywgaWYgdXNlciAiamJSbyIg
aXMgYSB1c2VyIHJlYWRpbmcNCi1tYWlsLCBoZSBzaG91bGQgbm90IGFsc28gYmUgaW4gdGhlIGFk
bWlucyBsaW5lLiAgU29tZSBwcm9ibGVtcyBtYXkgb2NjdXINCi1vdGhlcndpc2UsIG1vc3Qgbm90
YWJseSAgdGhlIGFiaWxpdHkgb2YgYWRtaW5pc3RyYXRvcnMgdG8gY3JlYXRlIHRvcC1sZXZlbA0K
LW1haWxib3hlcyB2aXNpYmxlIHRvIHVzZXJzLCBidXQgbm90IHdyaXRhYmxlIGJ5IHVzZXJzLg0K
IC5JUCAiXGZCcHJveHlzZXJ2ZXJzOlxmUiA8bm9uZT4iIDUNCi1BIGxpc3Qgb2YgdXNlcnMgYW5k
IGdyb3VwcyB0aGF0IGFyZSBhbGxvd2VkIHRvIHByb3h5IGZvciBvdGhlciB1c2VycywNCi1zZXBl
cmF0ZWQgYnkgc3BhY2VzLiAgQW55IHVzZXIgbGlzdGVkIGluIHRoaXMgd2lsbCBiZSBhbGxvd2Vk
IHRvIGxvZ2luDQotZm9yIGFueSBvdGhlciB1c2VyOiB1c2Ugd2l0aCBjYXV0aW9uLg0KIC5JUCAi
XGZCZGVmYXVsdGFjbDpcZlIgYW55b25lIGxycyIgNQ0KLVRoZSBBY2Nlc3MgQ29udHJvbCBMaXN0
IChBQ0wpIHBsYWNlZCBvbiBhIG5ld2x5LWNyZWF0ZWQgKG5vbi11c2VyKSANCi1tYWlsYm94IHRo
YXQgZG9lcyBub3QgaGF2ZSBhIHBhcmVudCBtYWlsYm94Lg0KIC5JUCAiXGZCbmV3c3Nwb29sXGZC
OlxmUiA8bm8gZGVmYXVsdD4iIDUNCi1UaGUgcGF0aG5hbWUgb2YgdGhlIG5ld3Mgc3Bvb2wgZGly
ZWN0b3J5LiAgT25seSB1c2VkIGlmIHRoZQ0KLVxmQnBhcnRpdGlvbi1uZXdzXGZSIGNvbmZpZ3Vy
YXRpb24gb3B0aW9uIGlzIHNldC4NCiAuSVAgIlxmQm5ld3NwcmVmaXg6XGZSIDxub25lPiIgNQ0K
LVByZWZpeCB0byBiZSBwcmVwZW5kZWQgdG8gbmV3c2dyb3VwIG5hbWVzIHRvIG1ha2UgdGhlIGNv
cnJlc3BvbmRpbmcNCi1JTUFQIG1haWxib3ggbmFtZXMuDQogLklQICJcZkJhdXRvY3JlYXRlcXVv
dGE6XGZSIDAiIDUNCi1JZiBub256ZXJvLCBub3JtYWwgdXNlcnMgbWF5IGNyZWF0ZSB0aGVpciBv
d24gSU1BUCBhY2NvdW50cyBieQ0KLWNyZWF0aW5nIHRoZSBtYWlsYm94IElOQk9YLiAgVGhlIHVz
ZXIncyBxdW90YSBpcyBzZXQgdG8gdGhlIHZhbHVlIGlmDQotaXQgaXMgcG9zaXRpdmUsIG90aGVy
d2lzZSB0aGUgdXNlciBoYXMgdW5saW1pdGVkIHF1b3RhLg0KLS5JUCAiXGZCbG9ndGltZXN0YW1w
czpcZlIgbm8iIDUNCi1JbmNsdWRlIG5vdGF0aW9ucyBpbiB0aGUgcHJvdG9jb2wgdGVsZW1ldHJ5
IGxvZ3MgaW5kaWNhdGluZyB0aGUgbnVtYmVyIG9mDQotc2Vjb25kcyBzaW5jZSB0aGUgbGFzdCBj
b21tYW5kIG9yIHJlc3BvbnNlLg0KIC5JUCAiXGZCcGxhaW50ZXh0bG9naW5wYXVzZTpcZlIgMCIg
NQ0KIE51bWJlciBvZiBzZWNvbmRzIHRvIHBhdXNlIGFmdGVyIGEgc3VjY2Vzc2Z1bCBwbGFpbnRl
eHQgbG9naW4uICBGb3INCiBzeXN0ZW1zIHRoYXQgc3VwcG9ydCBzdHJvbmcgYXV0aGVudGljYXRp
b24sIHRoaXMgcGVybWl0cyB1c2VycyB0bw0KQEAgLTE5Niw4ICsxMjUsOCBAQA0KIElmIGVuYWJs
ZWQsIGxtdHBkIHJlamVjdHMgbWVzc2FnZXMgd2l0aCA4LWJpdCBjaGFyYWN0ZXJzIGluIHRoZSBo
ZWFkZXJzLg0KIE90aGVyd2lzZSwgOC1iaXQgY2hhcmFjdGVycyBhcmUgY2hhbmdlZCB0byBgWCcu
ICAoQSBwcm9wZXIgc291bHRpb24gdG8NCiBub24tQVNDSUkgY2hhcmFjdGVycyBpbiBoZWFkZXJz
IGlzIG9mZmVyZWQgYnkgUkZDIDIwNDcgYW5kIGl0cyBwcmVkZWNlc3NvcnMuKQ0KLS5JUCAiXGZC
bWF4bWVzc2FnZXNpemU6XGZSIDx1bmxpbWl0ZWQ+IiA1DQotTWF4aW11bSBpbmNvbWluZyBMTVRQ
IG1lc3NhZ2Ugc2l6ZS4gIElmIHNldCwgbG10cGQgd2lsbA0KKy5JUCAiXGZCbWF4bWVzc2FnZXNp
emU6XGZSIDAiIDUNCitNYXhpbXVtIGluY29taW5nIExNVFAgbWVzc2FnZSBzaXplLiAgSWYgbm9u
LXplcm8sIGxtdHBkIHdpbGwNCiByZWplY3QgbWVzc2FnZXMgbGFyZ2VyIHRoYW4gXGZJbWF4bWVz
c2FnZXNpemVcZlIgYnl0ZXMuICBUaGUgZGVmYXVsdA0KIGlzIHRvIGFsbG93IG1lc3NhZ2VzIG9m
IGFueSBzaXplLg0KIC5JUCAiXGZCbG10cF9vdmVycXVvdGFfcGVybV9mYWlsdXJlOlxmUiBubyIg
NQ0KSW5kZXg6IG1hbi9tYXN0ZXIuOA0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3
LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvbWFuL21hc3Rlci44LHYNCnJldHJpZXZpbmcg
cmV2aXNpb24gMS42DQpkaWZmIC11IC1yMS42IG1hc3Rlci44DQotLS0gbWFzdGVyLjgJMjAwMi8w
NS8yNSAxOTo1Nzo0OAkxLjYNCisrKyBtYXN0ZXIuOAkyMDAyLzA2LzE0IDE3OjA1OjE1DQpAQCAt
NDUsNiArNDUsMTAgQEANCiAuU0ggU1lOT1BTSVMNCiAuQiBtYXN0ZXINCiBbDQorLkIgXC1DDQor
LkkgY29uZmlnZmlsZQ0KK10NCitbDQogLkIgXC1sDQogLkkgbGlzdGVuIHF1ZXVlDQogXQ0KQEAg
LTY0LDE5ICs2OCwyMyBAQA0KIHdoZW4gaXQgcmVjZWl2ZXMgYSBTSUdURVJNLg0KIC5TSCBPUFRJ
T05TDQogLlRQDQorLkJJIFwtQyAiIGFsdGVybmF0ZSBjb25maWdmaWxlIg0KK1RlbGwgbWFzdGVy
dCB0byB1c2UgYSBjb25maWd1cmF0aW9uIGZpbGUgb3RoZXIgdGhhbiAvZXRjL2N5cnVzLmNvbmYu
DQorLlRQDQogLkJJIFwtbCAiIGxpc3RlbiBxdWV1ZSBiYWNrbG9nIg0KIEluY3JlYXNlIHRoZSBs
aXN0ZW4gcXVldWUgYmFja2xvZy4gQnkgZGVmYXVsdCwgdGhlIGxpc3RlbiBxdWV1ZSBpcyBzZXQN
CiB0byAzMi4gICBPbiBzeXN0ZW1zIHdpdGggYSBoaWdoIGNvbm5lY3Rpb24gcmF0ZSwgaXQgbWF5
IGJlIGRlc2lyYWJsZQ0KIHRvIGluY3JlYXNlIHRoaXMgdmFsdWUuIHJlZmVyIHRvIFxmQmxpc3Rl
bigyKVxmUiBmb3IgZGV0YWlscy4NCiAuVFANCiAuQkkgXC1EDQotRG9uJ3QgY2xvc2Ugc3RkaW4v
c3Rkb3V0L3N0ZGVyci4gUHJpbWlhcmx5IHVzZWZ1bCBmb3IgZGVidWdnaW5nLg0KK0Rvbid0IGNs
b3NlIHN0ZGluL3N0ZG91dC9zdGRlcnIgYW5kIHJ1biBpbiB0aGUgZm9yZWdyb3VuZC4gUHJpbWFy
aWx5DQordXNlZnVsIGZvciBkZWJ1Z2dpbmcuDQogLlNIIENPTkZJR1VSQVRJT04NCiBVcG9uIGV4
ZWN1dGlvbiwNCiAuSSBtYXN0ZXINCiByZWFkcyBpdHMgY29uZmlndXJhdGlvbiBpbmZvcm1hdGlv
biBvdXQgb2YgdGhlDQogLklSIGN5cnVzLmNvbmYgKDUpDQotZmlsZS4NCitmaWxlIG9yIHRoZSBm
aWxlIHNwZWNpZmllZCBieSB0aGUgLUMgb3B0aW9uLg0KIC5QUA0KIC5JIE1hc3Rlcg0KIHJlcmVh
ZHMgaXRzIGNvbmZpZ3VyYXRpb24gZmlsZSB3aGVuIGl0IHJlY2VpdmVzIGEgaGFuZ3VwIHNpZ25h
bCwNCkluZGV4OiBtYXN0ZXIvQ1lSVVMtTUFTVEVSLm1pYg0KPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6
IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvbWFzdGVyL0NZUlVTLU1B
U1RFUi5taWIsdg0KcmV0cmlldmluZyByZXZpc2lvbiAxLjQNCmRpZmYgLXUgLXIxLjQgQ1lSVVMt
TUFTVEVSLm1pYg0KLS0tIENZUlVTLU1BU1RFUi5taWIJMjAwMS8wOC8xNCAxNjoxMToyNgkxLjQN
CisrKyBDWVJVUy1NQVNURVIubWliCTIwMDIvMDYvMTQgMTc6MDU6MTUNCkBAIC0xMDksNiArMTA5
LDEyIEBADQogDQogICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VDb25uZWN0aW9ucyAg
ICAgQ291bnRlcjMyDQogDQorICAgICAgICAgICAgICAgICAgICAgICAgIHNlcnZpY2VSZWFkeSAg
ICAgICAgICAgR2F1Z2UzMg0KKw0KKyAgICAgICAgICAgICAgICAgICAgICAgICBzZXJ2aWNlQnVz
eSAgICAgICAgICAgIEdhdWdlMzINCisNCisJCQkgc2VydmljZUZhaWx1cmVzCUNvdW50ZXIzMg0K
Kw0KICAgICAgICAgICAgICAgICAgICAgICAgICB9IAkJICAgDQogDQogICAgICAgLS0gZm9ya3Mg
c2luY2Ugc3RhcnR1cA0KQEAgLTEzNSwxMCArMTQxLDkgQEANCiAgICAgICAgICAgICAgICAgICAg
ICAgICAgQUNDRVNTICAgICByZWFkLW9ubHkgDQogDQogICAgICAgICAgICAgICAgICAgICAgICAg
IFNUQVRVUyAgICAgbWFuZGF0b3J5IA0KLQ0KLSAgICAgICAgICAgICAgICAgICAgICAgICBERVND
UklQVElPTiAgIlRoZSB0b3RhbCBudW1iZXIgb2YgY2hpbGRyZW4gY3VycmVudGx5IA0KIA0KLSAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFjdGl2ZS4iIA0KKyAgICAgICAg
ICAgICAgICAgICAgICAgICBERVNDUklQVElPTiAgIlRoZSB0b3RhbCBudW1iZXIgb2YgcHJvY2Vz
c2VzIGFzc29jaWF0ZWQNCisJCQkgICAgIHdpdGggdGhpcyBzZXJ2aWNlLiINCiANCiAgICAgICAg
ICAgICAgICAgICAgICAgICAgOjo9IHsgc2VydmljZUVudHJ5IDIgfSANCiANCkBAIC0xODAsNiAr
MTg1LDQ2IEBADQogCQkJICAgICAgICAgICAgICAgc2VydmljZSBzaW5jZSBpbml0aWFsaXphdGlv
bi4iIA0KIA0KICAgICAgICAgICAgICAgICAgICAgICAgICA6Oj0geyBzZXJ2aWNlRW50cnkgNSB9
IA0KKw0KKyAgICAgIC0tIGZvcmtzIHNpbmNlIHN0YXJ0dXANCisgICAgICBzZXJ2aWNlUmVhZHkg
ICAgICAgT0JKRUNULVRZUEUgDQorDQorICAgICAgICAgICAgICAgICAgICAgICAgIFNZTlRBWCAg
ICAgR2F1Z2UzMiANCisNCisgICAgICAgICAgICAgICAgICAgICAgICAgQUNDRVNTICAgICByZWFk
LW9ubHkgDQorDQorICAgICAgICAgICAgICAgICAgICAgICAgIFNUQVRVUyAgICAgbWFuZGF0b3J5
IA0KKw0KKyAgICAgICAgICAgICAgICAgICAgICAgICBERVNDUklQVElPTiAgIlRoZSBudW1iZXIg
b2YgcHJvY2Vzc2VzIHdhaXRpbmcNCisJCQkgICAgIGZvciBpbmNvbWluZyBjb25uZWN0aW9ucyBm
b3IgdGhpcyBzZXJ2aWNlLiINCisNCisgICAgICAgICAgICAgICAgICAgICAgICAgOjo9IHsgc2Vy
dmljZUVudHJ5IDYgfSANCisNCisgICAgICBzZXJ2aWNlQnVzeSAgICAgICAgT0JKRUNULVRZUEUg
DQorDQorICAgICAgICAgICAgICAgICAgICAgICAgIFNZTlRBWCAgICAgR2F1Z2UzMiANCisNCisg
ICAgICAgICAgICAgICAgICAgICAgICAgQUNDRVNTICAgICByZWFkLW9ubHkgDQorDQorICAgICAg
ICAgICAgICAgICAgICAgICAgIFNUQVRVUyAgICAgbWFuZGF0b3J5IA0KKw0KKyAgICAgICAgICAg
ICAgICAgICAgICAgICBERVNDUklQVElPTiAgIlRoZSBudW1iZXIgb2YgcHJvY2Vzc2VzIGN1cnJl
bnRseQ0KKwkJCSAgICAgc2VydmljaW5nIGNvbm5lY3Rpb25zIGZvciB0aGlzIHNlcnZpY2UuIg0K
Kw0KKyAgICAgICAgICAgICAgICAgICAgICAgICA6Oj0geyBzZXJ2aWNlRW50cnkgNyB9IA0KKw0K
KyAgICAgIHNlcnZpY2VGYWlsdXJlcyAgICBPQkpFQ1QtVFlQRSANCisNCisgICAgICAgICAgICAg
ICAgICAgICAgICAgU1lOVEFYICAgICBDb3VudGVyMzIgDQorDQorICAgICAgICAgICAgICAgICAg
ICAgICAgIEFDQ0VTUyAgICAgcmVhZC1vbmx5IA0KKw0KKyAgICAgICAgICAgICAgICAgICAgICAg
ICBTVEFUVVMgICAgIG1hbmRhdG9yeSANCisNCisgICAgICAgICAgICAgICAgICAgICAgICAgREVT
Q1JJUFRJT04gICJUaGUgdG90YWwgbnVtYmVyIG9mIHByb2Nlc3NlcyB0aGF0DQorCQkJICAgICBo
YXZlIGV4aXRlZCBiYWRseSBmb3IgdGhpcyBzZXJ2aWNlLiINCisNCisgICAgICAgICAgICAgICAg
ICAgICAgICAgOjo9IHsgc2VydmljZUVudHJ5IDggfSANCiANCiAtLSBldmVudCB0YWJsZQ0KIA0K
SW5kZXg6IG1hc3Rlci9jeXJ1c01hc3Rlck1JQi5jDQo9PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2Fm
cy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9tYXN0ZXIvY3lydXNNYXN0ZXJN
SUIuYyx2DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuOQ0KZGlmZiAtdSAtcjEuOSBjeXJ1c01hc3Rl
ck1JQi5jDQotLS0gY3lydXNNYXN0ZXJNSUIuYwkyMDAyLzAyLzE5IDE4OjUwOjE1CTEuOQ0KKysr
IGN5cnVzTWFzdGVyTUlCLmMJMjAwMi8wNi8xNCAxNzowNToxNQ0KQEAgLTczLDYgKzczLDEyIEBA
DQogICB7IFNFUlZJQ0VJRCAgICAgICAgICAgLCBBU05fSU5URUdFUiAgICwgTk9BQ0NFU1MgLCB2
YXJfc2VydmljZVRhYmxlLCAzLCB7IDIsMSw0IH0gfSwNCiAjZGVmaW5lICAgU0VSVklDRUNPTk5T
ICAgICAgICAgIDkNCiAgIHsgU0VSVklDRUNPTk5TICAgICAgICAsIEFTTl9DT1VOVEVSICAgLCBO
T0FDQ0VTUyAsIHZhcl9zZXJ2aWNlVGFibGUsIDMsIHsgMiwxLDUgfSB9LA0KKyNkZWZpbmUgU0VS
VklDRVJFQURZIDEwDQorICB7IFNFUlZJQ0VSRUFEWSAgICAgICAgLCBBU05fR0FVR0UgICAgICwg
Tk9BQ0NFU1MgLCB2YXJfc2VydmljZVRhYmxlLCAzLCB7IDIsMSw1IH0gfSwNCisjZGVmaW5lIFNF
UlZJQ0VCVVNZIDExDQorICB7IFNFUlZJQ0VCVVNZICAgICAgICAgLCBBU05fR0FVR0UgICAgICwg
Tk9BQ0NFU1MgLCB2YXJfc2VydmljZVRhYmxlLCAzLCB7IDIsMSw1IH0gfSwNCisjZGVmaW5lIFNF
UlZJQ0VGQUlMVVJFUyAxMg0KKyAgeyBTRVJWSUNFRkFJTFVSRVMgICAgICwgQVNOX0NPVU5URVIg
ICAsIE5PQUNDRVNTICwgdmFyX3NlcnZpY2VUYWJsZSwgMywgeyAyLDEsNSB9IH0NCiB9Ow0KIC8q
ICAgIChMID0gbGVuZ3RoIG9mIHRoZSBvaWRzdWZmaXgpICovDQogDQpAQCAtMjEzLDYgKzIxOSwx
OSBAQA0KIA0KICAgICBjYXNlIFNFUlZJQ0VDT05OUzoNCiAJbG9uZ19yZXQgPSBTZXJ2aWNlc1tp
bmRleCAtIDFdLm5jb25uZWN0aW9uczsNCisJcmV0dXJuICh1bnNpZ25lZCBjaGFyICopICZsb25n
X3JldDsNCisNCisgICAgY2FzZSBTRVJWSUNFUkVBRFk6DQorCWxvbmdfcmV0ID0gU2VydmljZXNb
aW5kZXggLSAxXS5yZWFkeV93b3JrZXJzOw0KKwlyZXR1cm4gKHVuc2lnbmVkIGNoYXIgKikgJmxv
bmdfcmV0Ow0KKw0KKyAgICBjYXNlIFNFUlZJQ0VCVVNZOg0KKwlsb25nX3JldCA9IA0KKwkgICAg
U2VydmljZXNbaW5kZXggLSAxXS5uYWN0aXZlIC0gU2VydmljZXNbaW5kZXggLSAxXS5yZWFkeV93
b3JrZXJzOw0KKwlyZXR1cm4gKHVuc2lnbmVkIGNoYXIgKikgJmxvbmdfcmV0Ow0KKw0KKyAgICBj
YXNlIFNFUlZJQ0VGQUlMVVJFUzoNCisJbG9uZ19yZXQgPSBTZXJ2aWNlc1tpbmRleCAtIDFdLm5m
YWlsdXJlczsNCiAJcmV0dXJuICh1bnNpZ25lZCBjaGFyICopICZsb25nX3JldDsNCiANCiAgICAg
ZGVmYXVsdDoNCkluZGV4OiBtYXN0ZXIvbWFzdGVyLmMNCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAv
YWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL21hc3Rlci9tYXN0ZXIuYyx2
DQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNjcNCmRpZmYgLXUgLXIxLjY3IG1hc3Rlci5jDQotLS0g
bWFzdGVyLmMJMjAwMi8wNi8wNyAyMDoxMzozNQkxLjY3DQorKysgbWFzdGVyLmMJMjAwMi8wNi8x
NCAxNzowNToxNQ0KQEAgLTEwMiw2ICsxMDIsNyBAQA0KIA0KIHN0YXRpYyBpbnQgdmVyYm9zZSA9
IDA7DQogc3RhdGljIGludCBsaXN0ZW5fcXVldWVfYmFja2xvZyA9IDMyOw0KK3N0YXRpYyBjaGFy
ICpjb25maWdfZmlsZW5hbWUgPSBOVUxMOw0KIA0KIHN0cnVjdCBzZXJ2aWNlICpTZXJ2aWNlcyA9
IE5VTEw7DQogaW50IGFsbG9jc2VydmljZXMgPSAwOw0KQEAgLTY0MCw2ICs2NDEsMjQgQEANCiAN
CiAgICAgLyogcnVuIGFsbCBldmVudHMgKi8NCiAgICAgd2hpbGUgKGEgJiYgYSAhPSBzY2hlZHVs
ZSkgew0KKzw8PDw8PDwgbWFzdGVyLmMNCisJc3dpdGNoIChwID0gZm9yaygpKSB7DQorCWNhc2Ug
LTE6DQorCSAgICBzeXNsb2coTE9HX0NSSVQsICJjYW4ndCBmb3JrIHByb2Nlc3MgdG8gcnVuIGV2
ZW50ICVzIiwgYS0+bmFtZSk7DQorCSAgICBicmVhazsNCisNCisJY2FzZSAwOg0KKwkgICAgaWYg
KGJlY29tZV9jeXJ1cygpICE9IDApIHsNCisJCXN5c2xvZyhMT0dfRVJSLCAiY2FuJ3QgY2hhbmdl
IHRvIHRoZSBjeXJ1cyB1c2VyIik7DQorCQlleGl0KDEpOw0KKwkgICAgfQ0KKw0KKwkgICAgLyog
Y2xvc2UgYWxsIGxpc3RlbmVycyAqLw0KKwkgICAgZm9yIChpID0gMDsgaSA8IG5zZXJ2aWNlczsg
aSsrKSB7DQorCQlpZiAoU2VydmljZXNbaV0uc29ja2V0ID4gMCkgY2xvc2UoU2VydmljZXNbaV0u
c29ja2V0KTsNCisJCWlmIChTZXJ2aWNlc1tpXS5zdGF0WzBdID4gMCkgY2xvc2UoU2VydmljZXNb
aV0uc3RhdFswXSk7DQorCQlpZiAoU2VydmljZXNbaV0uc3RhdFsxXSA+IDApIGNsb3NlKFNlcnZp
Y2VzW2ldLnN0YXRbMV0pOw0KKz09PT09PT0NCiAJLyogaWYgYS0+ZXhlYyBpcyBOVUxMLCB3ZSBq
dXN0IHVzZWQgdGhlIGV2ZW50IHRvIHdha2UgdXAsDQogCSAqIHNvIHdlIGFjdHVhbGx5IGRvbid0
IG5lZWQgdG8gZXhlYyBhbnl0aGluZyBhdCB0aGUgbW9tZW50ICovDQogCWlmKGEtPmV4ZWMpIHsN
CkBAIC02ODEsMTAgKzcwMCwzNiBAQA0KIAkJY3RhYmxlW3AgJSBjaGlsZF90YWJsZV9zaXplXSA9
IGM7DQogCQkNCiAJCWJyZWFrOw0KKz4+Pj4+Pj4gMS42Nw0KIAkgICAgfQ0KKzw8PDw8PDwgbWFz
dGVyLmMNCisJICAgIGxpbWl0X2ZkcygyNTYpOw0KKw0KKwkgICAgZ2V0X3Byb2cocGF0aCwgYS0+
ZXhlYyk7DQorCSAgICBzeXNsb2coTE9HX0RFQlVHLCAiYWJvdXQgdG8gZXhlYyAlcyIsIHBhdGgp
Ow0KKwkgICAgZXhlY3YocGF0aCwgYS0+ZXhlYyk7DQorCSAgICBzeXNsb2coTE9HX0VSUiwgImNh
bid0IGV4ZWMgJXMgb24gc2NoZWR1bGU6ICVtIiwgcGF0aCk7DQorCSAgICBleGl0KEVYX09TRVJS
KTsNCisJICAgIGJyZWFrOw0KKwkgICAgDQorCWRlZmF1bHQ6DQorCSAgICAvKiB3ZSBkb24ndCB3
YWl0IGZvciBpdCB0byBjb21wbGV0ZSAqLw0KKwkgICAgDQorCSAgICAvKiBhZGQgdG8gY2hpbGQg
dGFibGUgKi8NCisJICAgIGMgPSBnZXRfY2VudHJ5KCk7DQorCSAgICBjLT5waWQgPSBwOw0KKwkg
ICAgYy0+cyA9IE5VTEw7DQorCSAgICBjLT5uZXh0ID0gY3RhYmxlW3AgJSBjaGlsZF90YWJsZV9z
aXplXTsNCisJICAgIGN0YWJsZVtwICUgY2hpbGRfdGFibGVfc2l6ZV0gPSBjOw0KKw0KKwkgICAg
YnJlYWs7DQorCX0NCisNCis9PT09PT09DQogCX0gLyogYS0+ZXhlYyAqLw0KIAkNCiAJLyogcmVz
Y2hlZHVsZSBhcyBuZWVkZWQgKi8NCis+Pj4+Pj4+IDEuNjcNCiAJYiA9IGEtPm5leHQ7DQogCWlm
IChhLT5wZXJpb2QpIHsNCiAJICAgIGEtPm1hcmsgPSBub3cgKyBhLT5wZXJpb2Q7DQpAQCAtNzAz
LDE2ICs3NDgsMTkgQEANCiAgICAgaW50IHN0YXR1czsNCiAgICAgcGlkX3QgcGlkOw0KICAgICBz
dHJ1Y3QgY2VudHJ5ICpjOw0KKyAgICBpbnQgZmFpbHVyZSA9IDA7DQogDQogICAgIHdoaWxlICgo
cGlkID0gd2FpdHBpZCgocGlkX3QpIC0xLCAmc3RhdHVzLCBXTk9IQU5HKSkgPiAwKSB7DQogCWlm
IChXSUZFWElURUQoc3RhdHVzKSkgew0KIAkgICAgc3lzbG9nKExPR19ERUJVRywgInByb2Nlc3Mg
JWQgZXhpdGVkLCBzdGF0dXMgJWQiLCBwaWQsIA0KIAkJICAgV0VYSVRTVEFUVVMoc3RhdHVzKSk7
DQorCSAgICBmYWlsdXJlID0gMTsNCiAJfQ0KIA0KIAlpZiAoV0lGU0lHTkFMRUQoc3RhdHVzKSkg
ew0KIAkgICAgc3lzbG9nKExPR19FUlIsICJwcm9jZXNzICVkIGV4aXRlZCwgc2lnbmFsZWQgdG8g
ZGVhdGggYnkgJWQiLA0KIAkJICAgcGlkLCBXVEVSTVNJRyhzdGF0dXMpKTsNCisJICAgIGZhaWx1
cmUgPSAxOw0KIAl9DQogDQogCS8qIGFjY291bnQgZm9yIHRoZSBjaGlsZCAqLw0KQEAgLTcyMSw3
ICs3NjksMTAgQEANCiAJICAgIC8qIGZpcnN0IHRoaW5nIGluIHRoZSBsaW5rZWQgbGlzdCAqLw0K
IA0KIAkgICAgLyogZGVjcmVtZW50IGFjdGl2ZSBjb3VudCBmb3Igc2VydmljZSAqLw0KLQkgICAg
aWYgKGMtPnMpIGMtPnMtPm5hY3RpdmUtLTsNCisJICAgIGlmIChjLT5zKSB7DQorCQljLT5zLT5u
YWN0aXZlLS07DQorCQljLT5zLT5uZmFpbHVyZXMgKz0gZmFpbHVyZTsNCisJICAgIH0NCiANCiAJ
ICAgIGN0YWJsZVtwaWQgJSBjaGlsZF90YWJsZV9zaXplXSA9IGMtPm5leHQ7DQogCSAgICBjLT5u
ZXh0ID0gY2ZyZWVsaXN0Ow0KQEAgLTczOCw3ICs3ODksMTAgQEANCiANCiAJCXQgPSBjLT5uZXh0
Ow0KIAkJLyogZGVjcmVtZW50IGFjdGl2ZSBjb3VudCBmb3Igc2VydmljZSAqLw0KLQkJaWYgKHQt
PnMpIHQtPnMtPm5hY3RpdmUtLTsNCisJCWlmICh0LT5zKSB7DQorCQkgICAgdC0+cy0+bmFjdGl2
ZS0tOw0KKwkJICAgIHQtPnMtPm5mYWlsdXJlcyArPSBmYWlsdXJlOw0KKwkJfQ0KIA0KIAkJYy0+
bmV4dCA9IHQtPm5leHQ7IC8qIHJlbW92ZSBub2RlICovDQogCQl0LT5uZXh0ID0gY2ZyZWVsaXN0
OyAvKiBhZGQgdG8gZnJlZWxpc3QgKi8NCkBAIC0xMDIxLDYgKzEwNzUsNyBAQA0KIAkNCiAJU2Vy
dmljZXNbbnNlcnZpY2VzXS5uZm9ya3MgPSAwOw0KIAlTZXJ2aWNlc1tuc2VydmljZXNdLm5hY3Rp
dmUgPSAwOw0KKwlTZXJ2aWNlc1tuc2VydmljZXNdLm5mYWlsdXJlcyA9IDA7DQogCVNlcnZpY2Vz
W25zZXJ2aWNlc10ubmNvbm5lY3Rpb25zID0gMDsNCiANCiAJaWYgKHZlcmJvc2UgPiAyKQ0KQEAg
LTExMDgsOCArMTE2MywxMyBAQA0KICAgICAgICB0aGV5IHdpbGwgYmUgcmUtZW5hYmxlZCBpZiB0
aGV5IGFwcGVhciBpbiBjb25maWcgZmlsZSAqLw0KICAgICBmb3IgKGkgPSAwOyBpIDwgbnNlcnZp
Y2VzOyBpKyspIFNlcnZpY2VzW2ldLmV4ZWMgPSBOVUxMOw0KIA0KKzw8PDw8PDwgbWFzdGVyLmMN
CisgICAgIC8qIHJlYWQgc2VydmljZXMgKi8NCisgICAgbWFzdGVyY29uZl9nZXRzZWN0aW9uKGNv
bmZpZ19maWxlbmFtZSwgIlNFUlZJQ0VTIiwgJmFkZF9zZXJ2aWNlLCBOVUxMKTsNCis9PT09PT09
DQogICAgIC8qIHJlYWQgc2VydmljZXMgKi8NCiAgICAgbWFzdGVyY29uZl9nZXRzZWN0aW9uKCJT
RVJWSUNFUyIsICZhZGRfc2VydmljZSwgKHZvaWQqKSAxKTsNCis+Pj4+Pj4+IDEuNjQNCiANCiAg
ICAgZm9yIChpID0gMDsgaSA8IG5zZXJ2aWNlczsgaSsrKSB7DQogCWlmICghU2VydmljZXNbaV0u
ZXhlYyAmJiBTZXJ2aWNlc1tpXS5zb2NrZXQpIHsNCkBAIC0xMTI1LDYgKzExODUsNyBAQA0KIAkg
ICAgU2VydmljZXNbaV0uZGVzaXJlZF93b3JrZXJzID0gMDsNCiAJICAgIFNlcnZpY2VzW2ldLm5m
b3JrcyA9IDA7DQogCSAgICBTZXJ2aWNlc1tpXS5uYWN0aXZlID0gMDsNCisJICAgIFNlcnZpY2Vz
W2ldLm5mYWlsdXJlcyA9IDA7DQogCSAgICBTZXJ2aWNlc1tpXS5uY29ubmVjdGlvbnMgPSAwOw0K
IA0KIAkgICAgLyogY2xvc2UgYWxsIGxpc3RlbmVycyAqLw0KQEAgLTExNTgsNyArMTIxOSwxMSBA
QA0KICAgICB9DQogDQogICAgIC8qIHJlYWQgZXZlbnRzICovDQorPDw8PDw8PCBtYXN0ZXIuYw0K
KyAgICBtYXN0ZXJjb25mX2dldHNlY3Rpb24oY29uZmlnX2ZpbGVuYW1lLCAiRVZFTlRTIiwgJmFk
ZF9ldmVudCwgTlVMTCk7DQorPT09PT09PQ0KICAgICBtYXN0ZXJjb25mX2dldHNlY3Rpb24oIkVW
RU5UUyIsICZhZGRfZXZlbnQsICh2b2lkKikgMSk7DQorPj4+Pj4+PiAxLjY0DQogfQ0KIA0KIGlu
dCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikNCkBAIC0xMTcyLDggKzEyMzcsMTQgQEANCiAN
CiAgICAgcCA9IGdldGVudigiQ1lSVVNfVkVSQk9TRSIpOw0KICAgICBpZiAocCkgdmVyYm9zZSA9
IGF0b2kocCkgKyAxOw0KLSAgICB3aGlsZSAoKG9wdCA9IGdldG9wdChhcmdjLCBhcmd2LCAibDpE
IikpICE9IEVPRikgew0KKyAgICB3aGlsZSAoKG9wdCA9IGdldG9wdChhcmdjLCBhcmd2LCAiQzps
OkQiKSkgIT0gRU9GKSB7DQogCXN3aXRjaCAob3B0KSB7DQorCWNhc2UgJ0MnOiAvKiBjeXJ1cy5j
b25mICovDQorCSAgICBjb25maWdfZmlsZW5hbWUgPSBzdHJkdXAob3B0YXJnKTsNCisJICAgIGlm
ICghY29uZmlnX2ZpbGVuYW1lKSB7DQorCQlmYXRhbCgib3V0IG9mIG1lbW9yeSIsIEVYX1VOQVZB
SUxBQkxFKTsNCisJICAgIH0NCisJICAgIGJyZWFrOw0KIAljYXNlICdsJzogLyogdXNlciBkZWZp
bmVkIGxpc3RlbiBxdWV1ZSBiYWNrbG9nICovDQogCSAgICBsaXN0ZW5fcXVldWVfYmFja2xvZyA9
IGF0b2kob3B0YXJnKTsNCiAJICAgIGJyZWFrOw0KQEAgLTEyMjMsOSArMTI5NCw5IEBADQogICAg
IGluaXRfc25tcCgiY3lydXNNYXN0ZXIiKTsgDQogI2VuZGlmDQogDQotICAgIG1hc3RlcmNvbmZf
Z2V0c2VjdGlvbigiU1RBUlQiLCAmYWRkX3N0YXJ0LCBOVUxMKTsNCi0gICAgbWFzdGVyY29uZl9n
ZXRzZWN0aW9uKCJTRVJWSUNFUyIsICZhZGRfc2VydmljZSwgTlVMTCk7DQotICAgIG1hc3RlcmNv
bmZfZ2V0c2VjdGlvbigiRVZFTlRTIiwgJmFkZF9ldmVudCwgTlVMTCk7DQorICAgIG1hc3RlcmNv
bmZfZ2V0c2VjdGlvbihjb25maWdfZmlsZW5hbWUsICJTVEFSVCIsICZhZGRfc3RhcnQsIE5VTEwp
Ow0KKyAgICBtYXN0ZXJjb25mX2dldHNlY3Rpb24oY29uZmlnX2ZpbGVuYW1lLCAiU0VSVklDRVMi
LCAmYWRkX3NlcnZpY2UsIE5VTEwpOw0KKyAgICBtYXN0ZXJjb25mX2dldHNlY3Rpb24oY29uZmln
X2ZpbGVuYW1lLCAiRVZFTlRTIiwgJmFkZF9ldmVudCwgTlVMTCk7DQogDQogICAgIC8qIHNldCBz
aWduYWwgaGFuZGxlcnMgKi8NCiAgICAgc2lnaGFuZGxlcl9zZXR1cCgpOw0KSW5kZXg6IG1hc3Rl
ci9tYXN0ZXIuaA0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lz
dGVtL2N2cy9zcmMvY3lydXMvbWFzdGVyL21hc3Rlci5oLHYNCnJldHJpZXZpbmcgcmV2aXNpb24g
MS42DQpkaWZmIC11IC1yMS42IG1hc3Rlci5oDQotLS0gbWFzdGVyLmgJMjAwMi8wNS8yNSAxOTo1
Nzo0OAkxLjYNCisrKyBtYXN0ZXIuaAkyMDAyLzA2LzE0IDE3OjA1OjE1DQpAQCAtMjgsOCArMjgs
MTIgQEANCiAgICAgaW50IG5mb3JrczsNCiAgICAgaW50IG5hY3RpdmU7DQogICAgIGludCBuY29u
bmVjdGlvbnM7DQorPDw8PDw8PCBtYXN0ZXIuaA0KKyAgICBpbnQgbmZhaWx1cmVzOw0KKz09PT09
PT0NCiANCiAgICAgdW5zaWduZWQgaW50IGZvcmtyYXRlOw0KKz4+Pj4+Pj4gMS42DQogfTsNCiAN
CiBleHRlcm4gc3RydWN0IHNlcnZpY2UgKlNlcnZpY2VzOw0KSW5kZXg6IG1hc3Rlci9tYXN0ZXJj
b25mLmMNCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9j
dnMvc3JjL2N5cnVzL21hc3Rlci9tYXN0ZXJjb25mLmMsdg0KcmV0cmlldmluZyByZXZpc2lvbiAx
LjYNCmRpZmYgLXUgLXIxLjYgbWFzdGVyY29uZi5jDQotLS0gbWFzdGVyY29uZi5jCTIwMDEvMDkv
MDMgMTk6MzY6MDcJMS42DQorKysgbWFzdGVyY29uZi5jCTIwMDIvMDYvMTQgMTc6MDU6MTUNCkBA
IC03Niw2ICs3Niw3IEBADQogfQ0KIA0KIHN0cnVjdCBlbnRyeSB7DQorICAgIGNvbnN0IGNoYXIg
KmZpbGVuYW1lOw0KICAgICBjaGFyICpsaW5lOw0KICAgICBpbnQgbGluZW5vOw0KIH07DQpAQCAt
MTAyLDcgKzEwMyw3IEBADQogCSAgICB9DQogCSAgICBpZiAoKnAgIT0gJyInKSB7DQogCQlzcHJp
bnRmKGssICJjb25maWd1cmF0aW9uIGZpbGUgJXM6IG1pc3NpbmcgXCIgb24gbGluZSAlZCIsDQot
CQkJQ09ORklHX0ZJTEVOQU1FLCBlLT5saW5lbm8pOw0KKwkJCWUtPmZpbGVuYW1lLCBlLT5saW5l
bm8pOw0KIAkJZmF0YWwoaywgRVhfQ09ORklHKTsNCiAJICAgIH0NCiAJfSBlbHNlIHsNCkBAIC0x
NDcsMTMgKzE0OCwxNSBAQA0KICAgICByZXR1cm4gZGVmOw0KIH0NCiANCi1zdGF0aWMgdm9pZCBw
cm9jZXNzX3NlY3Rpb24oRklMRSAqZiwgaW50ICpsbnB0ciwgDQorc3RhdGljIHZvaWQgcHJvY2Vz
c19zZWN0aW9uKGNvbnN0IGNoYXIgKmZpbGVuYW1lLCANCisJCQkgICAgRklMRSAqZiwgaW50ICps
bnB0ciwgDQogCQkJICAgIG1hc3RlcmNvbmZfcHJvY2VzcyAqZnVuYywgdm9pZCAqcm9jaykNCiB7
DQogICAgIHN0cnVjdCBlbnRyeSBlOw0KICAgICBjaGFyIGJ1Zls0MDk2XTsNCiAgICAgaW50IGxp
bmVubyA9ICpsbnB0cjsNCiANCisgICAgZS5maWxlbmFtZSA9IGZpbGVuYW1lOw0KICAgICB3aGls
ZSAoZmdldHMoYnVmLCBzaXplb2YoYnVmKSwgZikpIHsNCiAJY2hhciAqcCwgKnE7DQogDQpAQCAt
MTg5LDcgKzE5Miw4IEBADQogICAgICpsbnB0ciA9IGxpbmVubzsNCiB9DQogDQotdm9pZCBtYXN0
ZXJjb25mX2dldHNlY3Rpb24oY29uc3QgY2hhciAqc2VjdGlvbiwgbWFzdGVyY29uZl9wcm9jZXNz
ICpmLA0KK3ZvaWQgbWFzdGVyY29uZl9nZXRzZWN0aW9uKGNvbnN0IGNoYXIgKmZpbGUsDQorCQkJ
ICAgY29uc3QgY2hhciAqc2VjdGlvbiwgbWFzdGVyY29uZl9wcm9jZXNzICpmLA0KIAkJCSAgIHZv
aWQgKnJvY2spDQogew0KICAgICBGSUxFICppbmZpbGU7DQpAQCAtMTk4LDEwICsyMDIsMTIgQEAN
CiAgICAgaW50IGxpbmVubyA9IDA7DQogICAgIGNoYXIgYnVmWzQwOTZdOw0KIA0KLSAgICBpbmZp
bGUgPSBmb3BlbihDT05GSUdfRklMRU5BTUUsICJyIik7DQorICAgIGlmIChmaWxlID09IE5VTEwp
IGZpbGUgPSBDT05GSUdfRklMRU5BTUU7DQorDQorICAgIGluZmlsZSA9IGZvcGVuKGZpbGUsICJy
Iik7DQogICAgIGlmICghaW5maWxlKSB7DQotCXNwcmludGYoYnVmLCAiY2FuJ3Qgb3BlbiBjb25m
aWd1cmF0aW9uIGZpbGUgJXM6ICVzIiwgQ09ORklHX0ZJTEVOQU1FLA0KLQkJc3RyZXJyb3IoZXJy
bm8pKTsNCisJc3ByaW50ZihidWYsICJjYW4ndCBvcGVuIGNvbmZpZ3VyYXRpb24gZmlsZSAlczog
JXMiLCANCisJCWZpbGUsIHN0cmVycm9yKGVycm5vKSk7DQogCWZhdGFsKGJ1ZiwgRVhfQ09ORklH
KTsNCiAgICAgfQ0KIA0KQEAgLTIyOSw3ICsyMzUsNyBAQA0KIAkgICAgfQ0KIA0KIAkgICAgLyog
dmFsaWQgb3BlbmluZzsgcHJvY2VzcyB0aGUgc2VjdGlvbiAqLw0KLQkgICAgaWYgKGxldmVsID09
IDEpIHByb2Nlc3Nfc2VjdGlvbihpbmZpbGUsICZsaW5lbm8sIGYsIHJvY2spOw0KKwkgICAgaWYg
KGxldmVsID09IDEpIHByb2Nlc3Nfc2VjdGlvbihmaWxlLCBpbmZpbGUsICZsaW5lbm8sIGYsIHJv
Y2spOw0KIA0KIAkgICAgY29udGludWU7DQogCX0NCkluZGV4OiBtYXN0ZXIvbWFzdGVyY29uZi5o
DQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09DQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3Ny
Yy9jeXJ1cy9tYXN0ZXIvbWFzdGVyY29uZi5oLHYNCnJldHJpZXZpbmcgcmV2aXNpb24gMS4zDQpk
aWZmIC11IC1yMS4zIG1hc3RlcmNvbmYuaA0KLS0tIG1hc3RlcmNvbmYuaAkyMDAwLzA1LzIzIDIw
OjU2OjMwCTEuMw0KKysrIG1hc3RlcmNvbmYuaAkyMDAyLzA2LzE0IDE3OjA1OjE1DQpAQCAtNTgs
NyArNTgsMTAgQEANCiAvKiBlbnRyeSB2YWx1ZXMgYXJlIGdvb2QgdW50aWwgdGhlIG5leHQgY2Fs
bCAqLw0KIHR5cGVkZWYgdm9pZCBtYXN0ZXJjb25mX3Byb2Nlc3MoY29uc3QgY2hhciAqbmFtZSwg
c3RydWN0IGVudHJ5ICplLCB2b2lkICpyb2NrKTsNCiANCi1leHRlcm4gdm9pZCBtYXN0ZXJjb25m
X2dldHNlY3Rpb24oY29uc3QgY2hhciAqc2VjdGlvbiwgDQorLyogcmVhZCBhIHNpbmdsZSBzZWN0
aW9uIGZyb20gdGhlIGNvbmZpZ3VyYXRpb24gZmlsZSAnZmlsZScgbWFraW5nDQorICAgY2FsbGJh
Y2tzIGFzIGFwcHJvcHJpYXRlOyBwYXNzIE5VTEwgZm9yIGRlZmF1bHQgKi8NCitleHRlcm4gdm9p
ZCBtYXN0ZXJjb25mX2dldHNlY3Rpb24oY29uc3QgY2hhciAqZmlsZSwgDQorCQkJCSAgY29uc3Qg
Y2hhciAqc2VjdGlvbiwgDQogCQkJCSAgbWFzdGVyY29uZl9wcm9jZXNzICpmLCB2b2lkICpyb2Nr
KTsNCiANCiAjZW5kaWYgLyogSU5DTFVERURfTUFTVEVSQ09ORl9IICovDQpJbmRleDogbWFzdGVy
L3NlcnZpY2UuYw0KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQ0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lz
dGVtL2N2cy9zcmMvY3lydXMvbWFzdGVyL3NlcnZpY2UuYyx2DQpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuMzcNCmRpZmYgLXUgLXIxLjM3IHNlcnZpY2UuYw0KLS0tIHNlcnZpY2UuYwkyMDAyLzA2LzA0
IDE5OjQ5OjU1CTEuMzcNCisrKyBzZXJ2aWNlLmMJMjAwMi8wNi8xNCAxNzowNToxNg0KQEAgLTI5
MiwxMiArMjkyLDE3IEBADQogCXN5c2xvZyhMT0dfRVJSLCAiY291bGQgbm90IGdldGVudihDWVJV
U19TRVJWSUNFKTsgZXhpdGluZyIpOw0KIAlleGl0KEVYX1NPRlRXQVJFKTsNCiAgICAgfQ0KKzw8
PDw8PDwgc2VydmljZS5jDQorICAgIA0KKyAgICBjb25maWdfaW5pdChhbHRfY29uZmlnLCBwKTsN
Cis9PT09PT09DQogICAgIHNlcnZpY2UgPSBzdHJkdXAocCk7DQogICAgIGlmIChzZXJ2aWNlID09
IE5VTEwpIHsNCiAJc3lzbG9nKExPR19FUlIsICJjb3VsZG4ndCBzdHJkdXAoKSBzZXJ2aWNlOiAl
bSIpOw0KIAlleGl0KEVYX09TRVJSKTsNCiAgICAgfQ0KICAgICBjb25maWdfaW5pdChhbHRfY29u
ZmlnLCBzZXJ2aWNlKTsNCis+Pj4+Pj4+IDEuMzANCiANCiAgICAgaWYgKGNhbGxfZGVidWdnZXIp
IHsNCiAJY2hhciBkZWJ1Z2J1ZlsxMDI0XTsNCkluZGV4OiB0b29scy9jb25maWcyaGVhZGVyDQo9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09DQpSQ1MgZmlsZTogY29uZmlnMmhlYWRlcg0KZGlmZiAtTiBjb25maWcyaGVhZGVy
DQotLS0gL2Rldi9udWxsCVR1ZSBNYXkgIDUgMTY6MzI6MjcgMTk5OA0KKysrIGNvbmZpZzJoZWFk
ZXIJRnJpIEp1biAxNCAxMzowNToxNiAyMDAyDQpAQCAtMCwwICsxLDEzOCBAQA0KKyMhL2Jpbi9z
aA0KKyMgJElkJA0KKyMNCisjIENvcHlyaWdodCAoYykgMjAwMSBDYXJuZWdpZSBNZWxsb24gVW5p
dmVyc2l0eS4gIEFsbCByaWdodHMgcmVzZXJ2ZWQuDQorIw0KKyMgUmVkaXN0cmlidXRpb24gYW5k
IHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0DQorIyBtb2Rp
ZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRp
dGlvbnMNCisjIGFyZSBtZXQ6DQorIw0KKyMgMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBj
b2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQNCisjICAgIG5vdGljZSwgdGhpcyBs
aXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4gDQorIw0KKyMg
Mi4gUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92
ZSBjb3B5cmlnaHQNCisjICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRo
ZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbg0KKyMgICAgdGhlIGRvY3VtZW50YXRpb24gYW5kL29y
IG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZQ0KKyMgICAgZGlzdHJpYnV0aW9uLg0K
KyMNCisjIDMuIFRoZSBuYW1lICJDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eSIgbXVzdCBub3Qg
YmUgdXNlZCB0bw0KKyMgICAgZW5kb3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzIGRlcml2ZWQgZnJv
bSB0aGlzIHNvZnR3YXJlIHdpdGhvdXQNCisjICAgIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi4g
Rm9yIHBlcm1pc3Npb24gb3IgYW55IG90aGVyIGxlZ2FsDQorIyAgICBkZXRhaWxzLCBwbGVhc2Ug
Y29udGFjdCAgDQorIyAgICAgIE9mZmljZSBvZiBUZWNobm9sb2d5IFRyYW5zZmVyDQorIyAgICAg
IENhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5DQorIyAgICAgIDUwMDAgRm9yYmVzIEF2ZW51ZQ0K
KyMgICAgICBQaXR0c2J1cmdoLCBQQSAgMTUyMTMtMzg5MA0KKyMgICAgICAoNDEyKSAyNjgtNDM4
NywgZmF4OiAoNDEyKSAyNjgtNzM5NQ0KKyMgICAgICB0ZWNoLXRyYW5zZmVyQGFuZHJldy5jbXUu
ZWR1DQorIw0KKyMgNC4gUmVkaXN0cmlidXRpb25zIG9mIGFueSBmb3JtIHdoYXRzb2V2ZXIgbXVz
dCByZXRhaW4gdGhlIGZvbGxvd2luZw0KKyMgICAgYWNrbm93bGVkZ21lbnQ6DQorIyAgICAiVGhp
cyBwcm9kdWN0IGluY2x1ZGVzIHNvZnR3YXJlIGRldmVsb3BlZCBieSBDb21wdXRpbmcgU2Vydmlj
ZXMNCisjICAgICBhdCBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eSAoaHR0cDovL3d3dy5jbXUu
ZWR1L2NvbXB1dGluZy8pLiINCisjDQorIyBDQVJORUdJRSBNRUxMT04gVU5JVkVSU0lUWSBESVND
TEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSCBSRUdBUkQgVE8NCisjIFRISVMgU09GVFdBUkUsIElO
Q0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQ0KKyMgQU5E
IEZJVE5FU1MsIElOIE5PIEVWRU5UIFNIQUxMIENBUk5FR0lFIE1FTExPTiBVTklWRVJTSVRZIEJF
IExJQUJMRQ0KKyMgRk9SIEFOWSBTUEVDSUFMLCBJTkRJUkVDVCBPUiBDT05TRVFVRU5USUFMIERB
TUFHRVMgT1IgQU5ZIERBTUFHRVMNCisjIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST00gTE9TUyBP
RiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTg0KKyMgQU4gQUNUSU9OIE9GIENPTlRS
QUNULCBORUdMSUdFTkNFIE9SIE9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORw0KKyMgT1VU
IE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SIFBFUkZPUk1BTkNFIE9GIFRISVMg
U09GVFdBUkUuDQorIw0KK2V4ZWMgcGVybCAteCAtUyAkMCAkezErIiRAIn0gIyAtKi1wZXJsLSot
DQorIyFwZXJsIC13DQorDQoraWYgKCRdICF+IC9eNVwuLiovKSB7DQorICAjIHVoLW9oLiB0aGlz
IGlzbid0IHBlcmwgNS4NCisgIGZvcmVhY2ggKHNwbGl0KC86LywgJEVOVntQQVRIfSkpIHsgIyB0
cnkgdG8gZmluZCAicGVybDUiLg0KKyAgICBleGVjKCIkXy9wZXJsNSIsICIteCIsICItUyIsICQw
LCBAQVJHVikgaWYgKC14ICIkXy9wZXJsNSIpOw0KKyAgfQ0KKyAgIyB3ZSBmYWlsZWQuIGJhaWwu
DQorICBkaWUgIllvdXIgcGVybCBpcyB0b28gb2xkOyBJIG5lZWQgcGVybCA1LlxuIjsNCit9DQor
DQorIyBsb2FkIHRoZSByZWFsIHNjcmlwdC4gdGhpcyBpcyBpc29sYXRlZCBpbiBhbiAnZXZhbCcg
c28gcGVybDQgd29uJ3QNCisjIGNob2tlIG9uIHRoZSBwZXJsNS1pc21zLg0KK2V2YWwgam9pbigi
XG4iLCA8REFUQT4pOw0KK2lmICgkQCkgeyBkaWUgIiRAIjsgfQ0KKw0KK19fRU5EX18NCityZXF1
aXJlIDU7DQorDQordXNlIHN0cmljdDsNCisNCitteSAkbW9kZSA9IDA7DQorbXkgJHNhdmUgPSAi
IjsNCisNCitkaWUgIndyb25nIG51bWJlciBvZiBhcmd1bWVudHMiIGlmICgkI0FSR1YgIT0gMSk7
DQorbXkgKCRjZmlsZSwgJGhmaWxlKSA9IEBBUkdWOw0KKw0KK29wZW4gQ0ZJTEUsICI+JGNmaWxl
IjsNCitvcGVuIEhGSUxFLCAiPiRoZmlsZSI7DQorDQorbXkgJGJsYW5rID0gIiI7DQorbXkgJHZl
cnNpb24gPSAiXCRSZXZpc2lvbiRibGFuayI7DQorJHZlcnNpb24gPX4gcy8uUmV2aXNpb246ICgu
KikgLyQxLzsNCitwcmludCBIRklMRSAiLyogYXV0by1nZW5lcmF0ZWQgYnkgY29uZmlnMmhlYWRl
ciAkdmVyc2lvbiAqL1xuIjsNCitwcmludCBDRklMRSAiLyogYXV0by1nZW5lcmF0ZWQgYnkgY29u
ZmlnMmhlYWRlciAkdmVyc2lvbiAqL1xuIjsNCisNCitwcmludCBIRklMRSAiI2lmbmRlZiBJTkNM
VURFRF9JTUFQT1BUSU9OU19IXG4iOw0KK3ByaW50IEhGSUxFICIjZGVmaW5lIElOQ0xVREVEX0lN
QVBPUFRJT05TX0hcbiI7DQorcHJpbnQgSEZJTEUgIlxuIjsNCisNCisjIHByb3RvdHlwZXMNCitw
cmludCBIRklMRSA8PEVPRg0KK2VudW0gaW1hcG9wdDsNCisNCitlbnVtIGltYXBvcHQgew0KKyAg
SU1BUE9QVF9aRVJPID0gMCwNCitFT0YNCisgICAgOw0KKw0KK3ByaW50IENGSUxFIDw8RU9GDQor
ZW51bSBvcHR0eXBlIHsNCisgIE5PVE9QVCwNCisgIFNUUklORywNCisgIElOVCwNCisgIFNXSVRD
SA0KK307DQorDQorc3RydWN0IGltYXBvcHRfcyBpbWFwb3B0c1tdID0NCit7DQorICAgIHsgSU1B
UE9QVF9aRVJPLCAiIiwgTlVMTCwgTk9UT1BUIH0sDQorRU9GDQorICAgIDsNCisNCisjIG91dHB1
dCBlbnVtZXJhdGlvbg0KKw0KK3doaWxlICg8U1RESU4+KSB7DQorICAgIG5leHQgaWYgKC9eXCMv
KTsNCisgICAgIyBsb29rIGZvciB7IG9wdGlvbiwgZGVmYXVsdCwgdHlwZSB9DQorICAgIGlmICht
fHtccypcIiguKj8pXCJccyosXHMqKFwiPy4qP1wiPylccyosXHMqKC4qPylccyp9fCkgew0KKwlt
eSAkb3B0ID0gJDE7DQorCXByaW50IEhGSUxFICIgIElNQVBPUFRfIiwgdWMoJG9wdCksICIsXG4i
Ow0KKw0KKwlwcmludCBDRklMRSAiICB7IElNQVBPUFRfIiwgdWMoJG9wdCksICIsICQxLCAkMiwg
JDMgfSxcbiI7DQorICAgIH0gZWxzZSB7DQorCSNjaG9tcDsNCisJI3ByaW50ICJyZWplY3RlZCAn
JF8nXG4iOw0KKyAgICB9DQorfQ0KKw0KK3ByaW50IEhGSUxFIDw8RU9GDQorDQorICBJTUFQT1BU
X0xBU1QNCit9Ow0KKw0KKyNlbmRpZiAvKiBJTkNMVURFRF9JTUFQT1BUSU9OU19IICovDQorRU9G
DQorICAgIDsNCisNCitwcmludCBDRklMRSA8PEVPRg0KKyAgeyBJTUFQT1BUX0xBU1QsIE5VTEws
IE5VTEwsIE5PVE9QVCB9DQorfTsNCisNCisvKiBjIGNvZGUgZ29lcyBoZXJlICovDQorDQorRU9G
DQorOw0KSW5kZXg6IHRvb2xzL2NvbmZpZzJtYW4NCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0NClJDUyBmaWxlOiBjb25m
aWcybWFuDQpkaWZmIC1OIGNvbmZpZzJtYW4NCi0tLSAvZGV2L251bGwJVHVlIE1heSAgNSAxNjoz
MjoyNyAxOTk4DQorKysgY29uZmlnMm1hbglGcmkgSnVuIDE0IDEzOjA1OjE2IDIwMDINCkBAIC0w
LDAgKzEsMTExIEBADQorIyEvYmluL3NoDQorIyAkSWQkDQorIw0KKyMgQ29weXJpZ2h0IChjKSAy
MDAxIENhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5LiAgQWxsIHJpZ2h0cyByZXNlcnZlZC4NCisj
DQorIyBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3
aXRoIG9yIHdpdGhvdXQNCisjIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0
aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucw0KKyMgYXJlIG1ldDoNCisjDQorIyAxLiBSZWRp
c3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdo
dA0KKyMgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2lu
ZyBkaXNjbGFpbWVyLiANCisjDQorIyAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0g
bXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodA0KKyMgICAgbm90aWNlLCB0aGlzIGxp
c3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluDQorIyAgICB0
aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhl
DQorIyAgICBkaXN0cmlidXRpb24uDQorIw0KKyMgMy4gVGhlIG5hbWUgIkNhcm5lZ2llIE1lbGxv
biBVbml2ZXJzaXR5IiBtdXN0IG5vdCBiZSB1c2VkIHRvDQorIyAgICBlbmRvcnNlIG9yIHByb21v
dGUgcHJvZHVjdHMgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dA0KKyMgICAgcHJp
b3Igd3JpdHRlbiBwZXJtaXNzaW9uLiBGb3IgcGVybWlzc2lvbiBvciBhbnkgb3RoZXIgbGVnYWwN
CisjICAgIGRldGFpbHMsIHBsZWFzZSBjb250YWN0ICANCisjICAgICAgT2ZmaWNlIG9mIFRlY2hu
b2xvZ3kgVHJhbnNmZXINCisjICAgICAgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkNCisjICAg
ICAgNTAwMCBGb3JiZXMgQXZlbnVlDQorIyAgICAgIFBpdHRzYnVyZ2gsIFBBICAxNTIxMy0zODkw
DQorIyAgICAgICg0MTIpIDI2OC00Mzg3LCBmYXg6ICg0MTIpIDI2OC03Mzk1DQorIyAgICAgIHRl
Y2gtdHJhbnNmZXJAYW5kcmV3LmNtdS5lZHUNCisjDQorIyA0LiBSZWRpc3RyaWJ1dGlvbnMgb2Yg
YW55IGZvcm0gd2hhdHNvZXZlciBtdXN0IHJldGFpbiB0aGUgZm9sbG93aW5nDQorIyAgICBhY2tu
b3dsZWRnbWVudDoNCisjICAgICJUaGlzIHByb2R1Y3QgaW5jbHVkZXMgc29mdHdhcmUgZGV2ZWxv
cGVkIGJ5IENvbXB1dGluZyBTZXJ2aWNlcw0KKyMgICAgIGF0IENhcm5lZ2llIE1lbGxvbiBVbml2
ZXJzaXR5IChodHRwOi8vd3d3LmNtdS5lZHUvY29tcHV0aW5nLykuIg0KKyMNCisjIENBUk5FR0lF
IE1FTExPTiBVTklWRVJTSVRZIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIIFJFR0FSRCBU
Tw0KKyMgVEhJUyBTT0ZUV0FSRSwgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0Yg
TUVSQ0hBTlRBQklMSVRZDQorIyBBTkQgRklUTkVTUywgSU4gTk8gRVZFTlQgU0hBTEwgQ0FSTkVH
SUUgTUVMTE9OIFVOSVZFUlNJVFkgQkUgTElBQkxFDQorIyBGT1IgQU5ZIFNQRUNJQUwsIElORElS
RUNUIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUw0KKyMgV0hBVFNPRVZF
UiBSRVNVTFRJTkcgRlJPTSBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElO
DQorIyBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1IgT1RIRVIgVE9SVElPVVMg
QUNUSU9OLCBBUklTSU5HDQorIyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0Ug
T1IgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4NCisjDQorZXhlYyBwZXJsIC14IC1TICQw
ICR7MSsiJEAifSAjIC0qLXBlcmwtKi0NCisjIXBlcmwgLXcNCisNCitpZiAoJF0gIX4gL141XC4u
Ki8pIHsNCisgICMgdWgtb2guIHRoaXMgaXNuJ3QgcGVybCA1Lg0KKyAgZm9yZWFjaCAoc3BsaXQo
LzovLCAkRU5We1BBVEh9KSkgeyAjIHRyeSB0byBmaW5kICJwZXJsNSIuDQorICAgIGV4ZWMoIiRf
L3Blcmw1IiwgIi14IiwgIi1TIiwgJDAsIEBBUkdWKSBpZiAoLXggIiRfL3Blcmw1Iik7DQorICB9
DQorICAjIHdlIGZhaWxlZC4gYmFpbC4NCisgIGRpZSAiWW91ciBwZXJsIGlzIHRvbyBvbGQ7IEkg
bmVlZCBwZXJsIDUuXG4iOw0KK30NCisNCisjIGxvYWQgdGhlIHJlYWwgc2NyaXB0LiB0aGlzIGlz
IGlzb2xhdGVkIGluIGFuICdldmFsJyBzbyBwZXJsNCB3b24ndA0KKyMgY2hva2Ugb24gdGhlIHBl
cmw1LWlzbXMuDQorZXZhbCBqb2luKCJcbiIsIDxEQVRBPik7DQoraWYgKCRAKSB7IGRpZSAiJEAi
OyB9DQorDQorX19FTkRfXw0KK3JlcXVpcmUgNTsNCisNCit1c2Ugc3RyaWN0Ow0KKw0KK215ICRt
b2RlID0gMDsNCitteSAkc2F2ZSA9ICIiOw0KKw0KK215ICRibGFuayA9ICIiOw0KK215ICR2ZXJz
aW9uID0gIlwkUmV2aXNpb24kYmxhbmsiOw0KKyR2ZXJzaW9uID1+IHMvLlJldmlzaW9uOiAoLiop
IC8kMS87DQorcHJpbnQgIi5cXFwiIC0qLSBucm9mZiAtKi1cbiI7DQorcHJpbnQgIi5cXFwiIGF1
dG8tZ2VuZXJhdGVkIGJ5IGNvbmZpZzJtYW4gJHZlcnNpb25cbiI7DQorDQord2hpbGUgKDw+KSB7
DQorICAgIGlmICgkbW9kZSA9PSAwKSB7DQorCSMgbG9vayBmb3IgeyBvcHRpb24sIGRlZmF1bHQs
IHR5cGUgfTsgZG9uJ3Qgb3V0cHV0IHVudGlsIHdlDQorCSMgaGl0IGEgY29tbWVudA0KKwlpZiAo
bXx7XHMqXCIoLio/KVwiXHMqLFxzKlwiPyguKj8pXCI/XHMqLFxzKiguKj8pXHMqfXwpIHsNCisJ
ICAgIG15ICRvcHQgPSAkMTsNCisJICAgIG15ICRkZWYgPSAkMiBlcSAiTlVMTCIgPyAiPG5vbmU+
IiA6ICQyOw0KKwkgICAgaWYgKCRkZWYgZXEgIiIpIHsgJGRlZiA9ICI8ZW1wdHk+IiB9DQorCSAg
ICAkc2F2ZSA9ICIuSVAgXCJcXGZCJDE6XFxmUiAkZGVmXCIgNVxuIjsNCisJfQ0KKw0KKwkjIGxv
b2sgZm9yIHNpbmdsZS1saW5lIGNvbW1lbnQNCisJZWxzaWYgKG18L1wqXHMqKC4qKVxzKlwqL3wp
IHsNCisJICAgIHByaW50ICRzYXZlOyAkc2F2ZSA9ICIiOw0KKwkgICAgcHJpbnQgIiQxXG4iOw0K
Kwl9DQorDQorCSMgbG9vayBmb3IgLyogdG8gc2hpZnQgaW50byBwYXNzdGhyb3VnaCBtb2RlOyBw
cmludCBjdXJyZW50DQorCSMgY2FjaGVkIG9wdGlvbiBoZWFkZXIgaWYgYW55DQorCWVsc2lmICht
fC9cKlxzKiguKil8KSB7DQorCSAgICBwcmludCAkc2F2ZTsgJHNhdmUgPSAiIjsNCisJICAgIHBy
aW50ICQxOw0KKwkgICAgJG1vZGUgPSAxOw0KKwl9DQorCWVsc2Ugew0KKwkgICAgY2hvbXA7DQor
CSAgICAjcHJpbnQgImlnbm9yaW5nICckXydcbiI7DQorCX0NCisgICAgfSBlbHNpZiAoJG1vZGUg
PT0gMSkgew0KKwkjIHBhc3N0aHJ1OyBsb29rIGZvciAqLyB0byBlbmQNCisJaWYgKG18XHMqKC4q
KVwqL3wpIHsNCisJICAgIHByaW50ICQxOw0KKwkgICAgcHJpbnQgIlxuIjsNCisJICAgICRtb2Rl
ID0gMDsgIyBiYWNrIHRvIHNlYXJjaCBtb2RlDQorCX0gZWxzaWYgKG18XHMqKC4qKVxzKnwpIHsN
CisJICAgIHByaW50ICIkMVxuIjsNCisJfQ0KKyAgICB9DQorfQ0K
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>46</attachid>
            <date>2002-06-18 20:29 EDT</date>
            <desc>closer to working patch</desc>
            <filename>imapconfig.patch</filename>
            <type>text/plain</type>
            <size>121401</size>
            <attacher>rjs3@andrew.cmu.edu</attacher>
            
              <data encoding="base64">SW5kZXg6IGRvYy9jaGFuZ2VzLmh0bWwKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcu
Y211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9kb2MvY2hhbmdlcy5odG1sLHYKcmV0cmlldmlu
ZyByZXZpc2lvbiAxLjQwCmRpZmYgLXUgLXIxLjQwIGNoYW5nZXMuaHRtbAotLS0gY2hhbmdlcy5o
dG1sCTIwMDIvMDUvMzEgMTk6MzM6MzYJMS40MAorKysgY2hhbmdlcy5odG1sCTIwMDIvMDYvMTgg
MjA6NTM6MDcKQEAgLTEyLDYgKzEyLDIxIEBACiA8aDI+Q2hhbmdlcyB0byB0aGUgQ3lydXMgSU1B
UCBTZXJ2ZXIgc2luY2UgMi4xLjQ8L2gyPgogCiA8dWw+Cis8bGk+VGhlcmUgaGF2ZSBiZWVuIGV4
dGVuc2l2ZSBwZXJmb3JtYW5jZSBhbmQgY29uc2lzdGFuY3kgY2hhbmdlcyB0bwordGhlIGNvbmZp
Z3VyYXRpb24gc3Vic3lzdGVtLiAgVGhpcyB3aWxsIGJvdGggZW5zdXJlIGdyZWF0ZXIgY29uc2lz
dGFuY3kKK2JldHdlZW4gdGhlIGRvY3VtZW50YXRpb24gYW5kIHRoZSBjb2RlLCBhcyB3ZWxsIGFz
IGEgbW9yZSBzdGFuZGFyZCBmb3JtYXQKK2ZvciBzcGVjaWZpbmcgc2VydmljZS1zcGVjaWZpYyBj
b25maWd1cmF0aW9uIG9wdGlvbnMgaW4gaW1hcGQuY29uZi4gIEltcG9ydGFudAorY2hhbmdlcyBh
cmUgZGV0YWlsZWQgaGVyZToKKzx1bD4KKyAgPGxpPiBUaGUgdGxzX1tzZXJ2aWNlXV8qIGNvbmZp
Z3VyYXRpb24gb3B0aW9ucyBoYXZlIGJlZW4gcmVtb3ZlZC4gIE5vdwordXNlIFtzZXJ2aWNlbmFt
ZV1fdGxzXyosIHdoZXJlIHNlcnZpY2VuYW1lIGlzIHRoZSBzZXJ2aWNlIGlkZW50aWZpZXIgZnJv
bQorY3lydXMuY29uZiBmb3IgdGhhdCBwYXJ0aWN1bGFyIHByb2Nlc3MuPC9saT4KKyAgPGxpPiBB
ZG1pbmlzdHJhdGl2ZSBncm91cHMgKGUuZy4gYWRtaW5zIGFuZCBsbXRwX2FkbWlucykgbm8gbG9u
Z2VyIHVuaW9uLAorc2VydmljZSBncm91cHMgY29tcGxldGVseSBvdmVycmlkZSB0aGUgZ2VuZXJp
YyBncm91cC4gPC9saT4KKyAgPGxpPiBsbXRwX2FsbG93cGxhaW50ZXh0IGlzIG5vIGxvbmdlciBh
IGRlZmluZWQgcGFyYW1ldGVyIGFuZCBtdXN0CitiZSBzcGVjaWZpZWQgdXNpbmcgdGhlIHNlcnZp
Y2UgbmFtZSBvZiB5b3VyIGxtdHAgcHJvY2VzcyBpZiB5b3UKK3JlcXVpcmUgYSBzcGVjaWZpYyB2
YWx1ZTwvbGk+Cis8L3VsPjwvbGk+CiA8bGk+IFNpZXZlIGlzIG5vIGxvbmdlciBkZXBlbmRlbnQg
b24gZHVwbGljYXRlIGRlbGl2ZXJ5IHN1cHByZXNzaW9uCiAoaXQgc3RpbGwgdXNlcyB0aGUgZHVw
bGljYXRlIGRlbGl2ZXJ5IGRhdGFiYXNlIGhvd2V2ZXIpLiA8L2xpPgogCkluZGV4OiBpbWFwL01h
a2VmaWxlLmluCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVt
L2N2cy9zcmMvY3lydXMvaW1hcC9NYWtlZmlsZS5pbix2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4x
NjQKZGlmZiAtdSAtcjEuMTY0IE1ha2VmaWxlLmluCi0tLSBNYWtlZmlsZS5pbgkyMDAyLzA1LzI2
IDAwOjUwOjUyCTEuMTY0CisrKyBNYWtlZmlsZS5pbgkyMDAyLzA2LzE3IDIwOjI5OjExCkBAIC05
NywxMCArOTcsMTEgQEAKIGN5cnVzX3ByZWZpeCA9IEBjeXJ1c19wcmVmaXhACiAKIExPQkpTPSBh
cHBlbmQubyBtYWlsYm94Lm8gbWJveGxpc3QubyBtdXBkYXRlLWNsaWVudC5vIG1ib3huYW1lLm8g
bWVzc2FnZS5vIFwKLQljb25maWcubyBpbWFwX2Vyci5vIG11cGRhdGVfZXJyLm8gcHJvYy5vIHNl
dHByb2N0aXRsZS5vIGNvbnZlcnRfY29kZS5vIFwKLQlkdXBsaWNhdGUubyBzYXNsY2xpZW50Lm8g
YWNhcG1ib3gubyBzaWduYWxzLm8gYW5ub3RhdGUubyBcCi0Jc2VhcmNoX2VuZ2luZXMubyBzcXVh
dC5vIHNxdWF0X2ludGVybmFsLm8gbWJkdW1wLm8gXAotCWJhc2U2NC5vIGltYXBwYXJzZS5vIHRl
bGVtZXRyeS5vIHVzZXIubyBub3RpZnkubyAkKFNFRU4pICQoSURMRSkKKwljb25maWcubyBpbWFw
X2Vyci5vIG11cGRhdGVfZXJyLm8gcHJvYy5vIHNldHByb2N0aXRsZS5vIFwKKwljb252ZXJ0X2Nv
ZGUubyBkdXBsaWNhdGUubyBzYXNsY2xpZW50Lm8gYWNhcG1ib3gubyBzaWduYWxzLm8gXAorCWFu
bm90YXRlLm8gc2VhcmNoX2VuZ2luZXMubyBzcXVhdC5vIHNxdWF0X2ludGVybmFsLm8gbWJkdW1w
Lm8gXAorCWJhc2U2NC5vIGltYXBwYXJzZS5vIHRlbGVtZXRyeS5vIHVzZXIubyBub3RpZnkubyBp
bWFwb3B0cy5vIFwKKwkkKFNFRU4pICQoSURMRSkKIAogSU1BUERPQkpTPXB1c2hzdGF0cy5vIGJh
Y2tlbmQubyBpbWFwZC5vIGluZGV4Lm8gdGxzLm8gdmVyc2lvbi5vCiAKQEAgLTExOCw3ICsxMTks
OCBAQAogCUBJTUFQX1BST0dTQAogCiBCVUlMVFNPVVJDRVMgPSBpbWFwX2Vyci5jIGltYXBfZXJy
LmggcHVzaHN0YXRzLmMgcHVzaHN0YXRzLmggXAotCWxtdHBzdGF0cy5jIGxtdHBzdGF0cy5oIHh2
ZXJzaW9uLmggbXVwZGF0ZV9lcnIuYyBtdXBkYXRlX2Vyci5oCisJbG10cHN0YXRzLmMgbG10cHN0
YXRzLmggeHZlcnNpb24uaCBtdXBkYXRlX2Vyci5jIG11cGRhdGVfZXJyLmggXAorCWltYXBvcHRz
LmggaW1hcG9wdHMuYwogCiBhbGw6ICQoQlVJTFRTT1VSQ0VTKSAkKFBST0dTKSAkKFNVSURQUk9H
UykKIApAQCAtMTU3LDYgKzE1OSw5IEBACiAKIGxtdHBzdGF0cy5jIGxtdHBzdGF0cy5oOiBsbXRw
c3RhdHMuc25tcCAkKHNyY2RpcikvLi4vc25tcC9zbm1wZ2VuCiAJJChzcmNkaXIpLy4uL3NubXAv
c25tcGdlbiAkKHNyY2RpcikvbG10cHN0YXRzLnNubXAKKworaW1hcG9wdHMuYyBpbWFwb3B0cy5o
OiBpbWFwb3B0aW9ucyAkKHNyY2RpcikvLi4vdG9vbHMvY29uZmlnMmhlYWRlcgorCSQoc3JjZGly
KS8uLi90b29scy9jb25maWcyaGVhZGVyICQoc3JjZGlyKS9pbWFwb3B0cy5jICQoc3JjZGlyKS9p
bWFwb3B0cy5oIDwgJChzcmNkaXIpL2ltYXBvcHRpb25zCiAKIGNvbGxlY3RuZXdzOiBjb2xsZWN0
bmV3cy5vIGxpYmltYXAuYSAkKERFUExJQlMpCiAJJChDQykgJChMREZMQUdTKSAtbyBjb2xsZWN0
bmV3cyBjb2xsZWN0bmV3cy5vIGxpYmltYXAuYSAkKERFUExJQlMpIFwKSW5kZXg6IGltYXAvYWNh
cG1ib3guYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9j
dnMvc3JjL2N5cnVzL2ltYXAvYWNhcG1ib3guYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zMQpk
aWZmIC11IC1yMS4zMSBhY2FwbWJveC5jCi0tLSBhY2FwbWJveC5jCTIwMDIvMDUvMjUgMTk6NTc6
NDMJMS4zMQorKysgYWNhcG1ib3guYwkyMDAyLzA2LzE4IDIwOjM3OjIwCkBAIC0xMDUsOCArMTA1
LDggQEAKIAlzdHJjYXQocG9zdGFkZHIsICJAIik7CiAJc3RyY2F0KHBvc3RhZGRyLCBzZXJ2ZXIp
OwogICAgIH0gZWxzZSB7Ci0JY29uc3QgY2hhciAqcG9zdHNwZWMgPSBjb25maWdfZ2V0c3RyaW5n
KCJwb3N0c3BlYyIsIE5VTEwpOwotCWNvbnN0IGNoYXIgKkJCID0gY29uZmlnX2dldHN0cmluZygi
cG9zdHVzZXIiLCAiYmIiKTsKKwljb25zdCBjaGFyICpwb3N0c3BlYyA9IGNvbmZpZ19nZXRzdHJp
bmcoSU1BUE9QVF9QT1NUU1BFQyk7CisJY29uc3QgY2hhciAqQkIgPSBjb25maWdfZ2V0c3RyaW5n
KElNQVBPUFRfUE9TVFVTRVIpOwogCiAJaWYgKHBvc3RzcGVjKSB7CiAJICAgIHNucHJpbnRmKHBv
c3RhZGRyLCBzaXplb2YocG9zdGFkZHIpLCBwb3N0c3BlYywgbmFtZSk7CkBAIC0xNzYsNyArMTc2
LDcgQEAKICAgICBjb25zdCBjaGFyICphdXRocHJvZzsKICAgICBzYXNsX2NhbGxiYWNrX3QgKmNi
OwogICAgIAotICAgIGFjYXBzZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKCJhY2FwX3NlcnZlciIs
IE5VTEwpOworICAgIGFjYXBzZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQUNBUF9T
RVJWRVIpOwogICAgIGlmICghYWNhcHNlcnZlcikgcmV0dXJuIE5VTEw7CiAKICAgICBpZiAoY2Fj
aGVkX2Nvbm4pIHsKQEAgLTE5NywyMSArMTk3LDIxIEBACiAgICAgY2FjaGVkX2Nvbm4gPSAoYWNh
cG1ib3hfaGFuZGxlX3QgKikgeG1hbGxvYyhzaXplb2YoYWNhcG1ib3hfaGFuZGxlX3QpKTsKICAg
ICBjYWNoZWRfY29ubi0+Y29ubiA9IE5VTEw7CiAgICAgCi0gICAgdXNlciA9IGNvbmZpZ19nZXRz
dHJpbmcoImFjYXBfdXNlcm5hbWUiLCBOVUxMKTsKKyAgICB1c2VyID0gY29uZmlnX2dldHN0cmlu
ZyhJTUFQT1BUX0FDQVBfVVNFUk5BTUUpOwogICAgIGlmICh1c2VyID09IE5VTEwpIHsKIAlzeXNs
b2coTE9HX0VSUiwgInVuYWJsZSB0byBmaW5kIG9wdGlvbiBhY2FwX3VzZXJuYW1lIik7CiAJcmV0
dXJuIGNhY2hlZF9jb25uOwogICAgIH0KIAotICAgIGF1dGhwcm9nID0gY29uZmlnX2dldHN0cmlu
ZygiYWNhcF9nZXRhdXRoIiwgTlVMTCk7CisgICAgYXV0aHByb2cgPSBjb25maWdfZ2V0c3RyaW5n
KElNQVBPUFRfQUNBUF9HRVRBVVRIKTsKICAgICBpZiAoYXV0aHByb2cpIHsKIAlzeXN0ZW0oYXV0
aHByb2cpOwogICAgIH0KIAogICAgIGNiID0gbXlzYXNsX2NhbGxiYWNrcyh1c2VyLAotCQkJICBj
b25maWdfZ2V0c3RyaW5nKCJhY2FwX2F1dGhuYW1lIiwgdXNlciksCi0JCQkgIGNvbmZpZ19nZXRz
dHJpbmcoImFjYXBfcmVhbG0iLCBOVUxMKSwKLQkJCSAgY29uZmlnX2dldHN0cmluZygiYWNhcF9w
YXNzd29yZCIsIE5VTEwpKTsKKwkJCSAgY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0FDQVBfQVVU
SE5BTUUpLAorCQkJICBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQUNBUF9SRUFMTSksCisJCQkg
IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9BQ0FQX1BBU1NXT1JEKSk7CiAgICAgc25wcmludGYo
c3RyLCBzaXplb2Yoc3RyKSwgImFjYXA6Ly8lc0Alcy8iLCB1c2VyLCBhY2Fwc2VydmVyKTsKICAg
ICByID0gYWNhcF9jb25uX2Nvbm5lY3Qoc3RyLCBjYiwgJihjYWNoZWRfY29ubi0+Y29ubikpOwog
ICAgIGZyZWVfY2FsbGJhY2tzKGNiKTsKSW5kZXg6IGltYXAvYmFja2VuZC5jCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
UkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9i
YWNrZW5kLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNwpkaWZmIC11IC1yMS43IGJhY2tlbmQu
YwotLS0gYmFja2VuZC5jCTIwMDIvMDUvMDYgMTc6MTg6NDkJMS43CisrKyBiYWNrZW5kLmMJMjAw
Mi8wNi8xOCAxOTo1Nzo0OApAQCAtMjM0LDEwICsyMzQsMTEgQEAKICAgICBwID0gc3RyY2hyKG9w
dHN0ciwgJy4nKTsKICAgICBpZiAocCkgKnAgPSAnXDAnOwogICAgIHN0cmNhdChvcHRzdHIsICJf
cGFzc3dvcmQiKTsKLSAgICBwYXNzID0gY29uZmlnX2dldHN0cmluZyhvcHRzdHIsIE5VTEwpOwor
ICAgIHBhc3MgPSBjb25maWdfZ2V0b3ZlcmZsb3dzdHJpbmcob3B0c3RyLCBOVUxMKTsKKyAgICBp
ZighcGFzcykgcGFzcyA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9QQVNTV09SRCk7
CiAgICAgY2IgPSBteXNhc2xfY2FsbGJhY2tzKHVzZXJpZCwgCi0JCQkgIGNvbmZpZ19nZXRzdHJp
bmcoInByb3h5X2F1dGhuYW1lIiwgInByb3h5IiksCi0JCQkgIGNvbmZpZ19nZXRzdHJpbmcoInBy
b3h5X3JlYWxtIiwgTlVMTCksCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9B
VVRITkFNRSksCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9SRUFMTSksCiAJ
CQkgIHBhc3MpOwogCiAgICAgLyogc2V0IHRoZSBJUCBhZGRyZXNzZXMgKi8KQEAgLTI4MSw3ICsy
ODIsNyBAQAogICAgIHAgPSBzdHJjaHIoYnVmLCAnLicpOwogICAgICpwID0gJ1wwJzsKICAgICBz
dHJjYXQoYnVmLCAiX21lY2hzIik7Ci0gICAgbWVjaF9jb25mID0gY29uZmlnX2dldHN0cmluZyhi
dWYsIE5VTEwpOworICAgIG1lY2hfY29uZiA9IGNvbmZpZ19nZXRvdmVyZmxvd3N0cmluZyhidWYs
IE5VTEwpOwogICAgIAogICAgIC8qIElmIHdlIGRvbid0IGhhdmUgYSBtZWNoX2NvbmYsIGFzayB0
aGUgc2VydmVyIHdoYXQgaXQgY2FuIGRvICovCiAgICAgaWYoIW1lY2hfY29uZikgewpJbmRleDog
aW1hcC9jb25maWcuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5
c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvY29uZmlnLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEu
NTUKZGlmZiAtdSAtcjEuNTUgY29uZmlnLmMKLS0tIGNvbmZpZy5jCTIwMDIvMDYvMTggMTY6NDA6
MTkJMS41NQorKysgY29uZmlnLmMJMjAwMi8wNi8xOCAyMDozMzozOApAQCAtNTcsNiArNTcsNyBA
QAogI2VuZGlmCiAKICNpbmNsdWRlICJpbWFwY29uZi5oIgorI2luY2x1ZGUgImltYXBvcHRzLmgi
CiAjaW5jbHVkZSAiZXhpdGNvZGVzLmgiCiAjaW5jbHVkZSAieG1hbGxvYy5oIgogI2luY2x1ZGUg
Im1ib3hsaXN0LmgiCkBAIC03MCwxOSArNzEsMTkgQEAKIAogI2RlZmluZSBDT05GSUdfRklMRU5B
TUUgIi9ldGMvaW1hcGQuY29uZiIKIAotI2RlZmluZSBDT05GSUdIQVNIU0laRSAyMDAgLyogPiAy
eCAjIG9mIG9wdGlvbnMgKi8KKyNkZWZpbmUgQ09ORklHSEFTSFNJWkUgMzAgLyogcmVsYXRpdmVs
eSBzbWFsbCwKKwkJCSAgICogYmVjYXVzZSBpdCBpcyBmb3Igb3ZlcmZsb3cgb25seSAqLwogc3Rh
dGljIHN0cnVjdCBoYXNoX3RhYmxlIGNvbmZpZ2hhc2g7CiAKIC8qIGNhY2hlZCBjb25maWd1cmF0
aW9uIHZhcmlhYmxlcyBhY2Nlc3NpYmxlIHRvIHRoZSBleHRlcm5hbCB3b3JsZCAqLwogY29uc3Qg
Y2hhciAqY29uZmlnX2ZpbGVuYW1lOyAgICAgLyogZmlsZW5hbWUgb2YgY29uZmlndXJhdGlvbiBm
aWxlICovCiBjb25zdCBjaGFyICpjb25maWdfZGlyOwkJICAgICAgICAgICAvKiBpZSAvdmFyL2lt
YXAgKi8KIGNvbnN0IGNoYXIgKmNvbmZpZ19kZWZwYXJ0aXRpb247ICAgICAgICAgICAvKiAvdmFy
L3Nwb29sL2ltYXAgKi8KLWNvbnN0IGNoYXIgKmNvbmZpZ19uZXdzc3Bvb2w7CSAgICAgICAgICAg
LyogL3Zhci9zcG9vbC9uZXdzICovCiBjb25zdCBjaGFyICpjb25maWdfc2VydmVybmFtZTsJICAg
ICAgICAgICAvKiBnZXRob3N0bmFtZSgpICovCiBjb25zdCBjaGFyICpjb25maWdfbXVwZGF0ZV9z
ZXJ2ZXI7ICAgICAgICAgLyogTlVMTCAqLwogaW50IGNvbmZpZ19oYXNoaW1hcHNwb29sOwkgICAg
ICAgICAgIC8qIGYgKi8KIAotc3RhdGljIHZvaWQgY29uZmlnX3JlYWQoY29uc3QgY2hhciAqYWx0
X2NvbmZpZyk7CitzdGF0aWMgdm9pZCBjb25maWdfcmVhZChjb25zdCBjaGFyICphbHRfY29uZmln
LCBjb25zdCBjaGFyICppZGVudCk7CiAKIGludCBjb25maWdfaW5pdChjb25zdCBjaGFyICphbHRf
Y29uZmlnLCBjb25zdCBjaGFyICppZGVudCkKIHsKQEAgLTEwMCwxNyArMTAxLDExIEBACiAJZmF0
YWwoImNvdWxkIG5vdCBjb25zdHJ1Y3QgY29uZmlndXJhdGlvbiBoYXNoIHRhYmxlIiwgRUNfQ09O
RklHKTsKICAgICB9CiAKLSAgICBjb25maWdfcmVhZChhbHRfY29uZmlnKTsKKyAgICAvKiBMb2Fk
IGNvbmZpZ3VyYXRpb24gZmlsZS4gIFRoaXMgd2lsbCBzZXQgY29uZmlnX2RpciB3aGVuIGl0IGZp
bmRzIGl0ICovCisgICAgY29uZmlnX3JlYWQoYWx0X2NvbmZpZywgaWRlbnQpOwogCi0gICAgLyog
TG9vayB1cCBjb25maWdkaXJlY3RvcnkgY29uZmlnIG9wdGlvbiAqLwotICAgIGNvbmZpZ19kaXIg
PSBjb25maWdfZ2V0c3RyaW5nKCJjb25maWdkaXJlY3RvcnkiLCAoY2hhciAqKTApOwotICAgIGlm
ICghY29uZmlnX2RpcikgewotCWZhdGFsKCJjb25maWdkaXJlY3Rvcnkgb3B0aW9uIG5vdCBzcGVj
aWZpZWQgaW4gY29uZmlndXJhdGlvbiBmaWxlIiwKLQkgICAgICBFQ19DT05GSUcpOwotICAgIH0K
LQogICAgIC8qIExvb2sgdXAgZGVmYXVsdCBwYXJ0aXRpb24gKi8KLSAgICBjb25maWdfZGVmcGFy
dGl0aW9uID0gY29uZmlnX2dldHN0cmluZygiZGVmYXVsdHBhcnRpdGlvbiIsICJkZWZhdWx0Iik7
CisgICAgY29uZmlnX2RlZnBhcnRpdGlvbiA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9ERUZB
VUxUUEFSVElUSU9OKTsKICAgICBmb3IgKHAgPSAoY2hhciAqKWNvbmZpZ19kZWZwYXJ0aXRpb247
ICpwOyBwKyspIHsKIAlpZiAoIWlzYWxudW0oKHVuc2lnbmVkIGNoYXIpICpwKSkKIAkgIGZhdGFs
KCJkZWZhdWx0cGFydGl0aW9uIG9wdGlvbiBjb250YWlucyBub24tYWxwaGFudW1lcmljIGNoYXJh
Y3RlciIsCkBAIC0xMjQsNzIgKzExOSw1OSBAQAogICAgIH0KIAogICAgIC8qIExvb2sgdXAgdW1h
c2sgKi8KLSAgICB2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJ1bWFzayIsICIwNzciKTsKKyAgICB2
YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfVU1BU0spOwogICAgIHdoaWxlICgqdmFsKSB7
CiAJaWYgKCp2YWwgPj0gJzAnICYmICp2YWwgPD0gJzcnKSB1bWFza3ZhbCA9IHVtYXNrdmFsKjgg
KyAqdmFsIC0gJzAnOwogCXZhbCsrOwogICAgIH0KICAgICB1bWFzayh1bWFza3ZhbCk7CiAKLSAg
ICAvKiBMb29rIHVwIG5ld3Mgc3Bvb2wgKi8KLSAgICBjb25maWdfbmV3c3Nwb29sID0gY29uZmln
X2dldHN0cmluZygibmV3c3Nwb29sIiwgMCk7Ci0KICAgICAvKiBsb29rIHVwIG1haWxib3ggaGFz
aGluZyAqLwotICAgIGNvbmZpZ19oYXNoaW1hcHNwb29sID0gY29uZmlnX2dldHN3aXRjaCgiaGFz
aGltYXBzcG9vbCIsIDApOworICAgIGNvbmZpZ19oYXNoaW1hcHNwb29sID0gY29uZmlnX2dldHN3
aXRjaChJTUFQT1BUX0hBU0hJTUFQU1BPT0wpOwogCiAgICAgLyogbG9vayB1cCB0aGUgaG9zdG5h
bWUgd2Ugc2hvdWxkIHByZXNlbnQgdG8gdGhlIHVzZXIgKi8KLSAgICBjb25maWdfc2VydmVybmFt
ZSA9IGNvbmZpZ19nZXRzdHJpbmcoInNlcnZlcm5hbWUiLCAwKTsKKyAgICBjb25maWdfc2VydmVy
bmFtZSA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9TRVJWRVJOQU1FKTsKICAgICBpZiAoIWNv
bmZpZ19zZXJ2ZXJuYW1lKSB7CiAJY29uZmlnX3NlcnZlcm5hbWUgPSB4bWFsbG9jKHNpemVvZihj
aGFyKSAqIDI1Nik7CiAJZ2V0aG9zdG5hbWUoKGNoYXIgKikgY29uZmlnX3NlcnZlcm5hbWUsIDI1
Nik7CiAgICAgfQogCi0gICAgY29uZmlnX211cGRhdGVfc2VydmVyID0gY29uZmlnX2dldHN0cmlu
ZygibXVwZGF0ZV9zZXJ2ZXIiLCBOVUxMKTsKKyAgICBjb25maWdfbXVwZGF0ZV9zZXJ2ZXIgPSBj
b25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTVVQREFURV9TRVJWRVIpOwogCiAgICAgcmV0dXJuIDA7
CiB9CiAKLWludCBjb25maWdfY2hhbmdlaWRlbnQoY29uc3QgY2hhciAqaWRlbnQpCitjb25zdCBj
aGFyICpjb25maWdfZ2V0c3RyaW5nKGVudW0gaW1hcG9wdCBvcHQpCiB7Ci0gICAgY2xvc2Vsb2co
KTsKLSAgICBvcGVubG9nKGlkZW50LCBMT0dfUElELCBMT0dfTE9DQUw2KTsKLSAgICByZXR1cm4g
MDsKKyAgICBhc3NlcnQob3B0ID4gSU1BUE9QVF9aRVJPICYmIG9wdCA8IElNQVBPUFRfTEFTVCk7
CisgICAgYXNzZXJ0KGltYXBvcHRzW29wdF0udCA9PSBPUFRfU1RSSU5HKTsKKyAgICAKKyAgICBy
ZXR1cm4gaW1hcG9wdHNbb3B0XS52YWwuczsKIH0KIAotY29uc3QgY2hhciAqY29uZmlnX2dldHN0
cmluZyhjb25zdCBjaGFyICprZXksIGNvbnN0IGNoYXIgKmRlZikKK2ludCBjb25maWdfZ2V0aW50
KGVudW0gaW1hcG9wdCBvcHQpCiB7Ci0gICAgY2hhciAqcmV0OworICAgIGFzc2VydChvcHQgPiBJ
TUFQT1BUX1pFUk8gJiYgb3B0IDwgSU1BUE9QVF9MQVNUKTsKKyAgICBhc3NlcnQoaW1hcG9wdHNb
b3B0XS50ID09IE9QVF9JTlQpOwogCi0gICAgcmV0ID0gaGFzaF9sb29rdXAoa2V5LCAmY29uZmln
aGFzaCk7Ci0KLSAgICByZXR1cm4gcmV0ID8gcmV0IDogZGVmOworICAgIHJldHVybiBpbWFwb3B0
c1tvcHRdLnZhbC5pOwogfQogCi1pbnQgY29uZmlnX2dldGludChjb25zdCBjaGFyICprZXksIGlu
dCBkZWYpCitpbnQgY29uZmlnX2dldHN3aXRjaChlbnVtIGltYXBvcHQgb3B0KQogewotICAgIGNv
bnN0IGNoYXIgKnZhbCA9IGNvbmZpZ19nZXRzdHJpbmcoa2V5LCAoY2hhciAqKTApOwotCi0gICAg
aWYgKCF2YWwpIHJldHVybiBkZWY7Ci0gICAgaWYgKCFpc2RpZ2l0KChpbnQpICp2YWwpICYmICgq
dmFsICE9ICctJyB8fCAhaXNkaWdpdCgoaW50KSB2YWxbMV0pKSkgCi0JcmV0dXJuIGRlZjsKLSAg
ICByZXR1cm4gYXRvaSh2YWwpOworICAgIGFzc2VydChvcHQgPiBJTUFQT1BUX1pFUk8gJiYgb3B0
IDwgSU1BUE9QVF9MQVNUKTsKKyAgICBhc3NlcnQoaW1hcG9wdHNbb3B0XS50ID09IE9QVF9TV0lU
Q0gpOworICAgIAorICAgIHJldHVybiBpbWFwb3B0c1tvcHRdLnZhbC5iOwogfQogCi1pbnQgY29u
ZmlnX2dldHN3aXRjaChjb25zdCBjaGFyICprZXksIGludCBkZWYpCitjb25zdCBjaGFyICpjb25m
aWdfZ2V0b3ZlcmZsb3dzdHJpbmcoY29uc3QgY2hhciAqa2V5LCBjb25zdCBjaGFyICpkZWYpCiB7
Ci0gICAgY29uc3QgY2hhciAqdmFsID0gY29uZmlnX2dldHN0cmluZyhrZXksIChjaGFyICopMCk7
CisgICAgY2hhciAqcmV0OwogCi0gICAgaWYgKCF2YWwpIHJldHVybiBkZWY7CisgICAgcmV0ID0g
aGFzaF9sb29rdXAoa2V5LCAmY29uZmlnaGFzaCk7CiAKLSAgICBpZiAoKnZhbCA9PSAnMCcgfHwg
KnZhbCA9PSAnbicgfHwKLQkoKnZhbCA9PSAnbycgJiYgdmFsWzFdID09ICdmJykgfHwgKnZhbCA9
PSAnZicpIHsKLQlyZXR1cm4gMDsKLSAgICB9Ci0gICAgZWxzZSBpZiAoKnZhbCA9PSAnMScgfHwg
KnZhbCA9PSAneScgfHwKLQkgICAgICgqdmFsID09ICdvJyAmJiB2YWxbMV0gPT0gJ24nKSB8fCAq
dmFsID09ICd0JykgewotCXJldHVybiAxOwotICAgIH0KLSAgICByZXR1cm4gZGVmOworICAgIHJl
dHVybiByZXQgPyByZXQgOiBkZWY7CiB9CiAKIGNvbnN0IGNoYXIgKmNvbmZpZ19wYXJ0aXRpb25k
aXIoY29uc3QgY2hhciAqcGFydGl0aW9uKQpAQCAtMjAwLDc1ICsxODIsMjM4IEBACiAgICAgc3Ry
Y3B5KGJ1ZiwgInBhcnRpdGlvbi0iKTsKICAgICBzdHJjYXQoYnVmLCBwYXJ0aXRpb24pOwogCi0g
ICAgcmV0dXJuIGNvbmZpZ19nZXRzdHJpbmcoYnVmLCAoY2hhciAqKTApOworICAgIHJldHVybiBj
b25maWdfZ2V0b3ZlcmZsb3dzdHJpbmcoYnVmLCBOVUxMKTsKIH0KIAotc3RhdGljIHZvaWQgY29u
ZmlnX3JlYWQoY29uc3QgY2hhciAqYWx0X2NvbmZpZykKK3N0YXRpYyB2b2lkIGNvbmZpZ19yZWFk
KGNvbnN0IGNoYXIgKmFsdF9jb25maWcsIGNvbnN0IGNoYXIgKmlkZW50KQogewogICAgIEZJTEUg
KmluZmlsZTsKKyAgICBlbnVtIG9wdHR5cGUgb3B0OwogICAgIGludCBsaW5lbm8gPSAwOwotICAg
IGNoYXIgYnVmWzQwOTZdOwotICAgIGNoYXIgKnAsICpxLCAqa2V5LCAqdmFsLCAqbmV3dmFsOwor
ICAgIGNoYXIgYnVmWzQwOTZdLCBlcnJidWZbMTAyNF07CisgICAgY2hhciAqcCwgKnEsICprZXks
ICpmdWxsa2V5LCAqdmFsLCAqbmV3dmFsOworICAgIGludCBzZXJ2aWNlX3NwZWNpZmljOworICAg
IGludCBpZGxlbiA9IGlkZW50ID8gc3RybGVuKGlkZW50KSA6IDA7CiAKICAgICBpZihhbHRfY29u
ZmlnKSBjb25maWdfZmlsZW5hbWUgPSB4c3RyZHVwKGFsdF9jb25maWcpOwogICAgIGVsc2UgY29u
ZmlnX2ZpbGVuYW1lID0geHN0cmR1cChDT05GSUdfRklMRU5BTUUpOwogCi0gICAgaW5maWxlID0g
Zm9wZW4oYWx0X2NvbmZpZyA/IGFsdF9jb25maWcgOiBDT05GSUdfRklMRU5BTUUsICJyIik7Cisg
ICAgLyogcmVhZCBpbiBjb25maWcgZmlsZSAqLworICAgIGluZmlsZSA9IGZvcGVuKGNvbmZpZ19m
aWxlbmFtZSwgInIiKTsKICAgICBpZiAoIWluZmlsZSkgewogCXN0cmNweShidWYsIENZUlVTX1BB
VEgpOwotCXN0cmNhdChidWYsIGFsdF9jb25maWcgPyBhbHRfY29uZmlnIDogQ09ORklHX0ZJTEVO
QU1FKTsKKwlzdHJjYXQoYnVmLCBjb25maWdfZmlsZW5hbWUpOwogCWluZmlsZSA9IGZvcGVuKGJ1
ZiwgInIiKTsKICAgICB9CiAgICAgaWYgKCFpbmZpbGUpIHsKLQlzcHJpbnRmKGJ1ZiwgImNhbid0
IG9wZW4gY29uZmlndXJhdGlvbiBmaWxlICVzOiAlcyIsCi0JCWFsdF9jb25maWcgPyBhbHRfY29u
ZmlnIDogQ09ORklHX0ZJTEVOQU1FLAotCQllcnJvcl9tZXNzYWdlKGVycm5vKSk7CisJc3ByaW50
ZihlcnJidWYsICJjYW4ndCBvcGVuIGNvbmZpZ3VyYXRpb24gZmlsZSAlczogJXMiLAorCQljb25m
aWdfZmlsZW5hbWUsIGVycm9yX21lc3NhZ2UoZXJybm8pKTsKIAlmYXRhbChidWYsIEVDX0NPTkZJ
Ryk7CiAgICAgfQogICAgIAogICAgIHdoaWxlIChmZ2V0cyhidWYsIHNpemVvZihidWYpLCBpbmZp
bGUpKSB7CiAJbGluZW5vKys7CiAKKwlzZXJ2aWNlX3NwZWNpZmljID0gMDsKKwkKIAlpZiAoYnVm
W3N0cmxlbihidWYpLTFdID09ICdcbicpIGJ1ZltzdHJsZW4oYnVmKS0xXSA9ICdcMCc7CiAJZm9y
IChwID0gYnVmOyAqcCAmJiBpc3NwYWNlKChpbnQpICpwKTsgcCsrKTsKIAlpZiAoISpwIHx8ICpw
ID09ICcjJykgY29udGludWU7CiAKLQlrZXkgPSBwOworCWZ1bGxrZXkgPSBrZXkgPSBwOwogCXdo
aWxlICgqcCAmJiAoaXNhbG51bSgoaW50KSAqcCkgfHwgKnAgPT0gJy0nIHx8ICpwID09ICdfJykp
IHsKIAkgICAgaWYgKGlzdXBwZXIoKHVuc2lnbmVkIGNoYXIpICpwKSkgKnAgPSB0b2xvd2VyKCh1
bnNpZ25lZCBjaGFyKSAqcCk7CiAJICAgIHArKzsKIAl9CiAJaWYgKCpwICE9ICc6JykgewotCSAg
ICBzcHJpbnRmKGJ1ZiwKKwkgICAgc3ByaW50ZihlcnJidWYsCiAJCSAgICAiaW52YWxpZCBvcHRp
b24gbmFtZSBvbiBsaW5lICVkIG9mIGNvbmZpZ3VyYXRpb24gZmlsZSIsCiAJCSAgICBsaW5lbm8p
OwogCSAgICBmYXRhbChidWYsIEVDX0NPTkZJRyk7CiAJfQogCSpwKysgPSAnXDAnOwotCisJCiAJ
d2hpbGUgKCpwICYmIGlzc3BhY2UoKGludCkgKnApKSBwKys7Ci0KKwkKIAkvKiByZW1vdmUgdHJh
aWxpbmcgd2hpdGVzcGFjZSAqLwogCWZvciAocSA9IHAgKyBzdHJsZW4ocCkgLSAxOyBxID4gcCAm
JiBpc3NwYWNlKChpbnQpICpxKTsgcS0tKSB7CiAJICAgICpxID0gJ1wwJzsKIAl9CiAJCiAJaWYg
KCEqcCkgewotCSAgICBzcHJpbnRmKGJ1ZiwgImVtcHR5IG9wdGlvbiB2YWx1ZSBvbiBsaW5lICVk
IG9mIGNvbmZpZ3VyYXRpb24gZmlsZSIsCisJICAgIHNwcmludGYoZXJyYnVmLAorCQkgICAgImVt
cHR5IG9wdGlvbiB2YWx1ZSBvbiBsaW5lICVkIG9mIGNvbmZpZ3VyYXRpb24gZmlsZSIsCiAJCSAg
ICBsaW5lbm8pOwogCSAgICBmYXRhbChidWYsIEVDX0NPTkZJRyk7CiAJfQorCQorICAgICAgICAv
KiBsb29rIGZvciBzZXJ2aWNlXyBwcmVmaXgsIHNraXAgb3ZlciBpdCBpZiBpdCBleGlzdHMgKi8K
KwlpZiAoaWRlbnQgJiYgIXN0cm5jYXNlY21wKGtleSwgaWRlbnQsIGlkbGVuKSAKKwkgICAgJiYg
a2V5W2lkbGVuXSA9PSAnXycpIHsKKwkgICAgLyogc2tpcCBzZXJ2aWNlXyBwcmVmaXggKi8KKwkg
ICAga2V5ICs9IGlkbGVuICsgMTsKKwkgICAgc2VydmljZV9zcGVjaWZpYyA9IDE7CisJfQogCi0J
bmV3dmFsID0geHN0cmR1cChwKTsKLQl2YWwgPSBoYXNoX2luc2VydChrZXksIG5ld3ZhbCwgJmNv
bmZpZ2hhc2gpOwotCWlmKHZhbCAhPSBuZXd2YWwpIHsKLQkgICAgY2hhciBlcnJidWZbNDA5Nl07
Ci0JICAgIHNwcmludGYoZXJyYnVmLCAib3B0aW9uICclcycgd2FzIHNwZWNpZmllZCB0d2ljZSBp
biBjb25maWcgZmlsZSIsCi0JCSAgICBrZXkpOwotCSAgICBmYXRhbChlcnJidWYsIEVDX0NPTkZJ
Ryk7CisJLyogbG9vayBmb3IgdGhlIGNvcnJlc3BvbmRpbmcgZW50cnkgaW4gaW1hcG9wdHMgKi8K
KwkvKiB4eHggYXMgbG9uZyBhcyB3ZSBrbm93IHRoaXMgbGlzdCBpcyBzb3J0ZWQgd2UgY291bGQg
cHJvYmFibGx5CisJICogYmUgbW9yZSBlZmZpY2llbnQgYWJvdXQgdGhpcyAqLworCWZvciAob3B0
ID0gSU1BUE9QVF9aRVJPOyBvcHQgPCBJTUFQT1BUX0xBU1Q7IG9wdCsrKSB7CisJICAgIGlmICgh
c3RyY2FzZWNtcChpbWFwb3B0c1tvcHRdLm9wdG5hbWUsIGtleSkpIHsKKwkJYnJlYWs7CisJICAg
IH0KIAl9CisKKwlpZiAob3B0IDwgSU1BUE9QVF9MQVNUKSB7CisJICAgIC8qIE9rYXksIHdlIGtu
b3cgYWJvdXQgdGhpcyBjb25maWd1cmUgb3B0aW9uLgorCSAgICAgKiBTbyBmaXJzdCBjaGVjayB0
aGF0IHdlIGhhdmUgZWl0aGVyCisJICAgICAqICAxLiBub3Qgc2VlbiBpdAorCSAgICAgKiAgMi4g
c2VlbiBpdHMgZ2VuZXJpYyBmb3JtLCBidXQgdGhpcyBpcyBhIHNlcnZpY2Ugc3BlY2lmaWMgZm9y
bQorCSAgICAgKgorCSAgICAgKiAgSWYgd2UgaGF2ZSBhbHJlYWR5IHNlZW4gYSBzZXJ2aWNlLXNw
ZWNpZmljIGZvcm0sIGFuZCB0aGlzIGlzCisJICAgICAqICBhIGdlbmVyaWMgZm9ybSwganVzdCBz
a2lwIGl0IGFuZCBkb24ndCBtb2FuLgorCSAgICAgKi8KKwkgICAgaWYoKGltYXBvcHRzW29wdF0u
c2VlbiA9PSAxICYmICFzZXJ2aWNlX3NwZWNpZmljKSAKKwkgICAgIHx8KGltYXBvcHRzW29wdF0u
c2VlbiA9PSAyICYmIHNlcnZpY2Vfc3BlY2lmaWMpKSB7CisJCXNwcmludGYoZXJyYnVmLAorCQkJ
Im9wdGlvbiAnJXMnIHdhcyBzcGVjaWZpZWQgdHdpY2UgaW4gY29uZmlnIGZpbGUgKHNlY29uZCBv
Y2N1cmFuY2Ugb24gbGluZSAlZCkiLAorCQkJZnVsbGtleSwgbGluZW5vKTsKKwkJZmF0YWwoZXJy
YnVmLCBFQ19DT05GSUcpOworCSAgICB9IGVsc2UgaWYoaW1hcG9wdHNbb3B0XS5zZWVuID09IDIg
JiYgIXNlcnZpY2Vfc3BlY2lmaWMpIHsKKwkJY29udGludWU7CisJICAgIH0KKworCSAgICAvKiBJ
ZiB3ZSd2ZSBzZWVuIGl0IGFscmVhZHksIHdlJ3JlIHJlcGxhY2luZyBpdCwgc28gd2UgbmVlZAor
CSAgICAgKiB0byBmcmVlIHRoZSBjdXJyZW50IHN0cmluZyBpZiB0aGVyZSBpcyBvbmUgKi8KKwkg
ICAgaWYoaW1hcG9wdHNbb3B0XS5zZWVuICYmIGltYXBvcHRzW29wdF0udCA9PSBPUFRfU1RSSU5H
KQorCQlmcmVlKChjaGFyICopaW1hcG9wdHNbb3B0XS52YWwucyk7CisKKyAgICAgICAgICAgIGlm
KHNlcnZpY2Vfc3BlY2lmaWMpCisJCWltYXBvcHRzW29wdF0uc2VlbiA9IDI7CisJICAgIGVsc2UK
KwkJaW1hcG9wdHNbb3B0XS5zZWVuID0gMTsKKwkgICAgCisJICAgIC8qIHRoaXMgaXMgYSBrbm93
biBvcHRpb24gKi8KKwkgICAgc3dpdGNoIChpbWFwb3B0c1tvcHRdLnQpIHsKKwkgICAgY2FzZSBP
UFRfU1RSSU5HOiAKKwkgICAgewkJICAgIAorCQlpbWFwb3B0c1tvcHRdLnZhbC5zID0geHN0cmR1
cChwKTsKKworCQlpZihvcHQgPT0gSU1BUE9QVF9DT05GSUdESVJFQ1RPUlkpCisJCSAgICBjb25m
aWdfZGlyID0gaW1hcG9wdHNbb3B0XS52YWwuczsKKworCQlicmVhazsKKwkgICAgfQorCSAgICBj
YXNlIE9QVF9JTlQ6CisJICAgIHsKKwkJbG9uZyB2YWw7CisJCWNoYXIgKnB0cjsKKwkJCisJCXZh
bCA9IHN0cnRvbChwLCAmcHRyLCAwKTsKKwkJaWYgKCFwdHIgfHwgKnB0ciAhPSAnXDAnKSB7CisJ
CSAgICAvKiBlcnJvciBkdXJpbmcgY29udmVyc2lvbiAqLworCQkgICAgc3ByaW50ZihlcnJidWYs
ICJub24taW50ZWdlciB2YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIsCisJCQkgICAgaW1hcG9wdHNb
b3B0XS5vcHRuYW1lLCBsaW5lbm8pOworCQkgICAgZmF0YWwoYnVmLCBFQ19DT05GSUcpOworCQl9
CisKKwkJaW1hcG9wdHNbb3B0XS52YWwuaSA9IHZhbDsKKwkJYnJlYWs7CisJICAgIH0KKwkgICAg
Y2FzZSBPUFRfU1dJVENIOgorCSAgICB7CisJCWlmICgqcCA9PSAnMCcgfHwgKnAgPT0gJ24nIHx8
CisJCSAgICAoKnAgPT0gJ28nICYmIHBbMV0gPT0gJ2YnKSB8fCAqcCA9PSAnZicpIHsKKwkJICAg
IGltYXBvcHRzW29wdF0udmFsLmIgPSAwOworCQl9CisJCWVsc2UgaWYgKCpwID09ICcxJyB8fCAq
cCA9PSAneScgfHwKKwkJCSAoKnAgPT0gJ28nICYmIHBbMV0gPT0gJ24nKSB8fCAqcCA9PSAndCcp
IHsKKwkJICAgIGltYXBvcHRzW29wdF0udmFsLmIgPSAxOworCQl9CisJCWVsc2UgeworCQkgICAg
LyogZXJyb3IgZHVyaW5nIGNvbnZlcnNpb24gKi8KKwkJICAgIHNwcmludGYoZXJyYnVmLCAibm9u
LXN3aXRjaCB2YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIsCisJCQkgICAgaW1hcG9wdHNbb3B0XS5v
cHRuYW1lLCBsaW5lbm8pOworCQkgICAgZmF0YWwoYnVmLCBFQ19DT05GSUcpOworCQl9CisJCWJy
ZWFrOworCSAgICB9CisJICAgIGNhc2UgT1BUX05PVE9QVDoKKwkgICAgZGVmYXVsdDoKKwkJYWJv
cnQoKTsKKwkgICAgfQorCX0gZWxzZSB7CisJICAgIC8qIGNoZWNrIHRvIG1ha2Ugc3VyZSBpdCdz
IHZhbGlkIGZvciBvdmVyZmxvdyAqLworCSAgICAvKiB0aGF0IGlzLCBwYXJ0aXRpb24gbmFtZXMg
YW5kIGFueXRoaW5nIHRoYXQgbWlnaHQgYmUKKwkgICAgICogdXNlZCBieSBTQVNMICovCisvKgor
ICB4eHggdGhpcyB3b3VsZCBiZSBuaWNlIGlmIGl0IHdhc24ndCBmb3Igb3RoZXIgc2VydmljZXMg
d2hvIG1pZ2h0IGJlCisgICAgICBzaGFyaW5nIHRoaXMgY29uZmlnIGZpbGUgYW5kIHdob3NlIG5h
bWVzIHdlIGNhbm5vdCBwcmVkaWN0CisKKwkgICAgaWYoc3RybmNhc2VjbXAoa2V5LCJzYXNsXyIs
NSkKKwkgICAgJiYgc3RybmNhc2VjbXAoa2V5LCJwYXJ0aXRpb24tIiwxMCkpIHsKKwkJc3ByaW50
ZihlcnJidWYsCisJCQkib3B0aW9uICclcycgaXMgdW5rbm93biBvbiBsaW5lICVkIG9mIGNvbmZp
ZyBmaWxlIiwKKwkJCWZ1bGxrZXksIGxpbmVubyk7CisJCWZhdGFsKGVycmJ1ZiwgRUNfQ09ORklH
KTsKKwkgICAgfQorKi8KKworCSAgICAvKiBQdXQgaXQgaW4gdGhlIG92ZXJmbG93IGhhc2ggdGFi
bGUgKi8KKwkgICAgbmV3dmFsID0geHN0cmR1cChwKTsKKwkgICAgdmFsID0gaGFzaF9pbnNlcnQo
a2V5LCBuZXd2YWwsICZjb25maWdoYXNoKTsKKwkgICAgaWYodmFsICE9IG5ld3ZhbCkgeworCQlz
cHJpbnRmKGVycmJ1ZiwKKwkJCSJvcHRpb24gJyVzJyB3YXMgc3BlY2lmaWVkIHR3aWNlIGluIGNv
bmZpZyBmaWxlIChzZWNvbmQgb2NjdXJhbmNlIG9uIGxpbmUgJWQpIiwKKwkJCWZ1bGxrZXksIGxp
bmVubyk7CisJCWZhdGFsKGVycmJ1ZiwgRUNfQ09ORklHKTsKKwkgICAgfQorCX0KICAgICB9CiAg
ICAgZmNsb3NlKGluZmlsZSk7CisKKyAgICAvKiBDaGVjayBjb25maWdkaXJlY3RvcnkgY29uZmln
IG9wdGlvbiAqLworICAgIGlmICghY29uZmlnX2RpcikgeworCWZhdGFsKCJjb25maWdkaXJlY3Rv
cnkgb3B0aW9uIG5vdCBzcGVjaWZpZWQgaW4gY29uZmlndXJhdGlvbiBmaWxlIiwKKwkgICAgICBF
Q19DT05GSUcpOworICAgIH0KKworICAgIC8qIFNjYW4gb3B0aW9ucyB0byBzZWUgaWYgd2UgbmVl
ZCB0byByZXBsYWNlIHtjb25maWdkaXJlY3Rvcnl9ICovCisgICAgLyogeHh4IG5lZWQgdG8gc2Nh
biBvdmVyZmxvdyBvcHRpb25zIGFzIHdlbGwhICovCisgICAgZm9yKG9wdCA9IElNQVBPUFRfWkVS
Tzsgb3B0IDwgSU1BUE9QVF9MQVNUOyBvcHQrKykgeworCWlmKCFpbWFwb3B0c1tvcHRdLnZhbC5z
IHx8CisJICAgaW1hcG9wdHNbb3B0XS50ICE9IE9QVF9TVFJJTkcgfHwKKwkgICBvcHQgPT0gSU1B
UE9QVF9DT05GSUdESVJFQ1RPUlkpIHsKKwkgICAgLyogU2tpcCBvcHRpb25zIHRoYXQgaGF2ZSBh
IE5VTEwgdmFsdWUsIGFyZW4ndCBzdHJpbmdzLCBvcgorCSAgICAgKiBhcmUgdGhlIGNvbmZpZ2Rp
cmVjdG9yeSBvcHRpb24gKi8KKwkgICAgY29udGludWU7CisJfQorCQorCS8qIFdlIHVzZSBzb21l
IG1hZ2ljIG51bWJlcnMgaGVyZSwKKwkgKiAxNyBpcyB0aGUgbGVuZ3RoIG9mICJ7Y29uZmlnZGly
ZWN0b3J5fSIsCisJICogMTYgaXMgb25lIGxlc3MgdGhhbiB0aGF0IGxlbmd0aCwgc28gdGhhdCB0
aGUgcmVwbGFjZW1lbnQgc3RyaW5nCisJICogICAgdGhhdCBpcyBtYWxsb2NlZCBoYXMgcm9vbSBm
b3IgdGhlICdcMCcgKi8KKwlpZighc3RybmNhc2VjbXAoaW1hcG9wdHNbb3B0XS52YWwucywie2Nv
bmZpZ2RpcmVjdG9yeX0iLDE3KSkgeworCSAgICBjb25zdCBjaGFyICpzdHIgPSBpbWFwb3B0c1tv
cHRdLnZhbC5zOworCSAgICBjaGFyICpuZXdzdHJpbmcgPQorCQl4bWFsbG9jKHN0cmxlbihjb25m
aWdfZGlyKSArIHN0cmxlbihzdHIpIC0gMTYpOworCSAgICBjaGFyICpmcmVlbWUgPSBOVUxMOwor
CSAgICAKKwkgICAgLyogd2UgbmVlZCB0byByZXBsYWNlIHRoaXMgc3RyaW5nLCB3aWxsIHdlIG5l
ZWQgdG8gZnJlZQorCSAgICAgKiB0aGUgY3VycmVudCB2YWx1ZT8gIC0tIG9ubHkgaWYgd2UndmUg
YWN0dWFsbHkgc2VlbiBpdCBpbgorCSAgICAgKiB0aGUgY29uZmlnIGZpbGUuICovCisJICAgIGlm
KGltYXBvcHRzW29wdF0uc2VlbikKKwkJZnJlZW1lID0gKGNoYXIgKilzdHI7CisKKwkgICAgLyog
QnVpbGQgcmVwbGFjZW1lbnQgc3RyaW5nIGZyb20gY29uZmlnZGlyZWN0b3J5IG9wdGlvbiAqLwor
CSAgICBzdHJjcHkobmV3c3RyaW5nLCBjb25maWdfZGlyKTsKKwkgICAgc3RyY2F0KG5ld3N0cmlu
Zywgc3RyICsgMTcpOworCisJICAgIGltYXBvcHRzW29wdF0udmFsLnMgPSBuZXdzdHJpbmc7CisK
KwkgICAgaWYoZnJlZW1lKSBmcmVlKGZyZWVtZSk7CisJfQorICAgIH0KIH0KIAogLyogdGhpcyBp
cyBhIHdyYXBwZXIgdG8gY2FsbCB0aGUgY3lydXMgY29uZmlndXJhdGlvbiBmcm9tIFNBU0wgKi8K
QEAgLTI4Myw3ICs0MjgsNyBAQAogCiAgICAgaWYgKCFzdHJjbXAob3B0aW9uLCAic3J2dGFiIikp
IHsgCiAJLyogd2UgZG9uJ3QgdHJhbnNmb3JtIHNydnRhYiEgKi8KLQkqcmVzdWx0ID0gY29uZmln
X2dldHN0cmluZyhvcHRpb24sIE5VTEwpOworCSpyZXN1bHQgPSBjb25maWdfZ2V0c3RyaW5nKElN
QVBPUFRfU1JWVEFCKTsKICAgICB9IGVsc2UgewogCSpyZXN1bHQgPSBOVUxMOwogCkBAIC0yOTMs
MTQgKzQzOCwxNCBAQAogCSAgICBzdHJsY2F0KG9wdCwgcGx1Z2luX25hbWUsIHNsKTsKIAkgICAg
c3RybGNhdChvcHQsICJfIiwgc2wpOwogCSAgICBzdHJsY2F0KG9wdCwgb3B0aW9uLCBzbCk7Ci0J
ICAgICpyZXN1bHQgPSBjb25maWdfZ2V0c3RyaW5nKG9wdCwgTlVMTCk7CisJICAgICpyZXN1bHQg
PSBjb25maWdfZ2V0b3ZlcmZsb3dzdHJpbmcob3B0LCBOVUxMKTsKIAl9CiAKIAlpZiAoKnJlc3Vs
dCA9PSBOVUxMKSB7CiAJICAgIC8qIHRyeSB3aXRob3V0IHRoZSBwbHVnaW4gbmFtZSAqLwogCSAg
ICBzdHJsY3B5KG9wdCwgInNhc2xfIiwgc2wpOwogCSAgICBzdHJsY2F0KG9wdCwgb3B0aW9uLCBz
bCk7Ci0JICAgICpyZXN1bHQgPSBjb25maWdfZ2V0c3RyaW5nKG9wdCwgTlVMTCk7CisJICAgICpy
ZXN1bHQgPSBjb25maWdfZ2V0b3ZlcmZsb3dzdHJpbmcob3B0LCBOVUxMKTsKIAl9CiAgICAgfQog
CkBAIC0zMjAsMTQgKzQ2NSwxNCBAQAogICAgIHN0YXRpYyBzYXNsX3NlY3VyaXR5X3Byb3BlcnRp
ZXNfdCByZXQ7CiAKICAgICByZXQubWF4YnVmc2l6ZSA9IFBST1RfQlVGU0laRTsKLSAgICByZXQu
bWluX3NzZiA9IGNvbmZpZ19nZXRpbnQoInNhc2xfbWluaW11bV9sYXllciIsIDApOwkKKyAgICBy
ZXQubWluX3NzZiA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9TQVNMX01JTklNVU1fTEFZRVIpOwkK
IAkJCQkvKiBtaW5pbXVtIGFsbG93YWJsZSBzZWN1cml0eSBzdHJlbmd0aCAqLwotICAgIHJldC5t
YXhfc3NmID0gY29uZmlnX2dldGludCgic2FzbF9tYXhpbXVtX2xheWVyIiwgMjU2KTsKKyAgICBy
ZXQubWF4X3NzZiA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9TQVNMX01BWElNVU1fTEFZRVIpOwog
CQkJCS8qIG1heGltdW0gYWxsb3dhYmxlIHNlY3VyaXR5IHN0cmVuZ3RoICovCiAKICAgICByZXQu
c2VjdXJpdHlfZmxhZ3MgPSBmbGFnczsKICAgICAvKiByZXQuc2VjdXJpdHlfZmxhZ3MgfD0gU0FT
TF9TRUNfTk9QTEFJTlRFWFQ7ICovCi0gICAgaWYgKCFjb25maWdfZ2V0c3dpdGNoKCJhbGxvd2Fu
b255bW91c2xvZ2luIiwgMCkpIHsKKyAgICBpZiAoIWNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9B
TExPV0FOT05ZTU9VU0xPR0lOKSkgewogCXJldC5zZWN1cml0eV9mbGFncyB8PSBTQVNMX1NFQ19O
T0FOT05ZTU9VUzsKICAgICB9CiAgICAgcmV0LnByb3BlcnR5X25hbWVzID0gTlVMTDsKQEAgLTMz
NiwxMSArNDgxLDE0IEBACiAgICAgcmV0dXJuICZyZXQ7CiB9CiAKLS8qIHRydWUgaWYgJ2F1dGhz
dGF0ZScgaXMgaW4gJ3ZhbCcgKi8KLXN0YXRpYyBpbnQgaXNhKHN0cnVjdCBhdXRoX3N0YXRlICph
dXRoc3RhdGUsIGNvbnN0IGNoYXIgKm9wdCkKKy8qIHRydWUgaWYgJ2F1dGhzdGF0ZScgaXMgaW4g
J29wdCcgKi8KK2ludCBjb25maWdfYXV0aGlzYShzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aHN0YXRl
LCBlbnVtIGltYXBvcHQgb3B0KQogewogICAgIGNoYXIgYnVmWzEwMjRdOwotICAgIGNvbnN0IGNo
YXIgKnZhbCA9IGNvbmZpZ19nZXRzdHJpbmcob3B0LCAiIik7CisgICAgY29uc3QgY2hhciAqdmFs
ID0gY29uZmlnX2dldHN0cmluZyhvcHQpOworCisgICAgLyogSXMgdGhlIG9wdGlvbiBkZWZpbmVk
PyAqLworICAgIGlmKCF2YWwpIHJldHVybiAwOwogCiAgICAgd2hpbGUgKCp2YWwpIHsKIAljaGFy
ICpwOwpAQCAtMzU1LDM0ICs1MDMsOCBAQAogCXZhbCA9IHA7CiAJd2hpbGUgKCp2YWwgJiYgaXNz
cGFjZSgoaW50KSAqdmFsKSkgdmFsKys7CiAgICAgfQotICAgIHJldHVybiAwOwotfQotCi0vKiAK
LSAqIGNoZWNrICdzZXJ2aWNlX2NsYXNzJyBhbmQgJ2NsYXNzJwotICovCi1pbnQgYXV0aGlzYShz
dHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aHN0YXRlLCAKLQkgICAgY29uc3QgY2hhciAqc2VydmljZSwg
Ci0JICAgIGNvbnN0IGNoYXIgKmNsYXNzKQotewotICAgIGNoYXIgYnVmWzUxMl07CiAKLSAgICBp
ZiAoIWF1dGhzdGF0ZSkgewotCS8qIG5vdCBhdXRoZW50aWNhdGVkPyAqLwotCXJldHVybiAwOwot
ICAgIH0KLQotICAgIC8qICdjbGFzcycgKi8KLSAgICBpZiAoaXNhKGF1dGhzdGF0ZSwgY2xhc3Mp
KSB7Ci0JcmV0dXJuIDE7Ci0gICAgfQotCi0gICAgLyogJ3NlcnZpY2VfY2xhc3MnICovCi0gICAg
c25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwgIiVzXyVzIiwgc2VydmljZSwgY2xhc3MpOwotICAg
IGlmIChpc2EoYXV0aHN0YXRlLCBidWYpKSB7Ci0JcmV0dXJuIDE7Ci0gICAgfQotICAgIAorICAg
IGFib3J0KCk7CiAgICAgcmV0dXJuIDA7CiB9CiAKSW5kZXg6IGltYXAvZGVsaXZlci5jCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMv
aW1hcC9kZWxpdmVyLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTY0CmRpZmYgLXUgLXIxLjE2
NCBkZWxpdmVyLmMKLS0tIGRlbGl2ZXIuYwkyMDAyLzA1LzI1IDE5OjU3OjQ0CTEuMTY0CisrKyBk
ZWxpdmVyLmMJMjAwMi8wNi8xOCAyMzo0MTowNwpAQCAtMjYxLDcgKzI2MSw3IEBACiAKICAgICBj
b25maWdfaW5pdChhbHRfY29uZmlnLCAiZGVsaXZlciIpOwogCi0gICAgc29ja2FkZHIgPSBjb25m
aWdfZ2V0c3RyaW5nKCJsbXRwc29ja2V0IiwgTlVMTCk7CisgICAgc29ja2FkZHIgPSBjb25maWdf
Z2V0c3RyaW5nKElNQVBPUFRfTE1UUFNPQ0tFVCk7CiAgICAgaWYgKCFzb2NrYWRkcikgewkKIAlz
dHJjcHkoYnVmLCBjb25maWdfZGlyKTsKIAlzdHJjYXQoYnVmLCAiL3NvY2tldC9sbXRwIik7CkBA
IC0zNDQsOCArMzQ0LDggQEAKICAgICBpZiAobWFpbGJveCkgbWwgPSBzdHJsZW4obWFpbGJveCk7
CiAgICAgaWYgKG51bXVzZXJzID09IDApIHsKIAkvKiBqdXN0IGRlbGl2ZXIgdG8gbWFpbGJveCAn
bWFpbGJveCcgKi8KLQljb25zdCBjaGFyICpCQiA9IGNvbmZpZ19nZXRzdHJpbmcoInBvc3R1c2Vy
IiwgIiIpOwotCXR4bi0+cmNwdFswXS5hZGRyID0gKGNoYXIgKikgeG1hbGxvYyhtbCArIHN0cmxl
bihCQikgKyAyKTsgLyogbGVha3MhICovCisJY29uc3QgY2hhciAqQkIgPSBjb25maWdfZ2V0c3Ry
aW5nKElNQVBPUFRfUE9TVFVTRVIpOworCXR4bi0+cmNwdFswXS5hZGRyID0gKGNoYXIgKikgeG1h
bGxvYyhtbCArIHN0cmxlbihCQikgKyAyKTsgLyogeHh4IGxlYWtzISAqLwogCXNwcmludGYodHhu
LT5yY3B0WzBdLmFkZHIsICIlcyslcyIsIEJCLCBtYWlsYm94KTsKICAgICB9IGVsc2UgewogCS8q
IHNldHVwIGVhY2ggcmVjaXBpZW50ICovCkluZGV4OiBpbWFwL2Z1ZC5jCj09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9mdWQu
Yyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zMgpkaWZmIC11IC1yMS4zMiBmdWQuYwotLS0gZnVk
LmMJMjAwMi8wNi8wMyAxODoyMjoyNAkxLjMyCisrKyBmdWQuYwkyMDAyLzA2LzE4IDIzOjM4OjM3
CkBAIC0xNTgsOCArMTU4LDYgQEAKIHsKICAgICBpbnQgb3B0OwogICAgCi0gICAgY29uZmlnX2No
YW5nZWlkZW50KCJmdWQiKTsKLQogICAgIGlmIChnZXRldWlkKCkgPT0gMCkgZmF0YWwoIm11c3Qg
cnVuIGFzIHRoZSBDeXJ1cyB1c2VyIiwgRUNfVVNBR0UpOwogCiAgICAgc2V0cHJvY3RpdGxlX2lu
aXQoYXJnYywgYXJndiwgZW52cCk7CkluZGV4OiBpbWFwL2lkbGVfcG9sbC5jCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
UkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9p
ZGxlX3BvbGwuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS41CmRpZmYgLXUgLXIxLjUgaWRsZV9w
b2xsLmMKLS0tIGlkbGVfcG9sbC5jCTIwMDEvMTEvMTkgMjE6MzI6NDQJMS41CisrKyBpZGxlX3Bv
bGwuYwkyMDAyLzA2LzE4IDIwOjQwOjE5CkBAIC02NSw3ICs2NSw3IEBACiB7CiAgICAgLyogZ2V0
IHBvbGxpbmcgcGVyaW9kICovCiAgICAgaWYgKGlkbGVfcGVyaW9kID09IC0xKSB7Ci0gICAgICBp
ZGxlX3BlcmlvZCA9IGNvbmZpZ19nZXRpbnQoImltYXBpZGxlcG9sbCIsIDYwKTsKKyAgICAgIGlk
bGVfcGVyaW9kID0gY29uZmlnX2dldGludChJTUFQT1BUX0lNQVBJRExFUE9MTCk7CiAgICAgICBp
ZiAoaWRsZV9wZXJpb2QgPCAwKSBpZGxlX3BlcmlvZCA9IDA7CiAgICAgfQogCkluZGV4OiBpbWFw
L2ltYXBjb25mLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0
ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL2ltYXBjb25mLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEu
MTYKZGlmZiAtdSAtcjEuMTYgaW1hcGNvbmYuaAotLS0gaW1hcGNvbmYuaAkyMDAyLzA2LzE0IDE4
OjE4OjQ5CTEuMTYKKysrIGltYXBjb25mLmgJMjAwMi8wNi8xOCAyMDozMToxNwpAQCAtNDQsMTQg
KzQ0LDIyIEBACiAjZGVmaW5lIElOQ0xVREVEX0lNQVBDT05GX0gKIAogI2luY2x1ZGUgPHNhc2wv
c2FzbC5oPgorI2luY2x1ZGUgImltYXBvcHRzLmgiCiAjaW5jbHVkZSAiYXV0aC5oIgogCisvKiBT
dGFydHVwIHRoZSBjb25maWd1cmF0aW9uIHN1YnN5c3RlbSAqLwogZXh0ZXJuIGludCBjb25maWdf
aW5pdChjb25zdCBjaGFyICphbHRfY29uZmlnLCBjb25zdCBjaGFyICppZGVudCk7Ci1leHRlcm4g
Y29uc3QgY2hhciAqY29uZmlnX2dldHN0cmluZyhjb25zdCBjaGFyICprZXksIGNvbnN0IGNoYXIg
KmRlZik7Ci1leHRlcm4gaW50IGNvbmZpZ19nZXRpbnQoY29uc3QgY2hhciAqa2V5LCBpbnQgZGVm
KTsKLWV4dGVybiBpbnQgY29uZmlnX2dldHN3aXRjaChjb25zdCBjaGFyICprZXksIGludCBkZWYp
OworCisvKiB0aGVzZSB3aWxsIGFzc2VydCgpIGlmIHRoZXkncmUgY2FsbGVkIG9uIHRoZSB3cm9u
ZyB0eXBlIG9mCisgICBvcHRpb24gKGltYXBvcHQuYykgKi8KK2V4dGVybiBjb25zdCBjaGFyICpj
b25maWdfZ2V0c3RyaW5nKGVudW0gaW1hcG9wdCBvcHQpOworZXh0ZXJuIGludCBjb25maWdfZ2V0
aW50KGVudW0gaW1hcG9wdCBvcHQpOworZXh0ZXJuIGludCBjb25maWdfZ2V0c3dpdGNoKGVudW0g
aW1hcG9wdCBvcHQpOworCisvKiB0aGVzZSB3b3JrIG9uIGFkZGl0aW9uYWwgc3RyaW5ncyB0aGF0
IGFyZSBub3QgZGVmaW5lZCBpbiB0aGUKKyAqIGltYXBvcHRpb25zIHRhYmxlICovCitleHRlcm4g
Y29uc3QgY2hhciAqY29uZmlnX2dldG92ZXJmbG93c3RyaW5nKGNvbnN0IGNoYXIgKmtleSwgY29u
c3QgY2hhciAqZGVmKTsKIGV4dGVybiBjb25zdCBjaGFyICpjb25maWdfcGFydGl0aW9uZGlyKGNv
bnN0IGNoYXIgKnBhcnRpdGlvbik7Ci1leHRlcm4gaW50IGNvbmZpZ19jaGFuZ2VpZGVudChjb25z
dCBjaGFyICppZGVudCk7CiAKIC8qIHNhc2wgY29uZmlndXJhdGlvbiAqLwogZXh0ZXJuIGludCBt
eXNhc2xfY29uZmlnKHZvaWQgKmNvbnRleHQsCkBAIC04NiwxOSArOTQsMTUgQEAKICNlbmRpZgog
CiAvKiBjaGVjayBpZiBgYXV0aHN0YXRlJyBpcyBhIHZhbGlkIG1lbWJlciBvZiBjbGFzcyAqLwot
ZXh0ZXJuIGludCBhdXRoaXNhKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoc3RhdGUsIAotCQkgICBj
b25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpjbGFzcyk7CitleHRlcm4gaW50IGNvbmZp
Z19hdXRoaXNhKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoc3RhdGUsIAorCQkJICBlbnVtIGltYXBv
cHQgb3B0KTsKIAogLyogVmFsdWVzIG9mIG1hbmRhdG9yeSBvcHRpb25zICovCiBleHRlcm4gY29u
c3QgY2hhciAqY29uZmlnX2ZpbGVuYW1lOwotCiBleHRlcm4gY29uc3QgY2hhciAqY29uZmlnX2Rp
cjsKIGV4dGVybiBjb25zdCBjaGFyICpjb25maWdfZGVmcGFydGl0aW9uOwotZXh0ZXJuIGNvbnN0
IGNoYXIgKmNvbmZpZ19uZXdzc3Bvb2w7Ci0KIGV4dGVybiBjb25zdCBjaGFyICpjb25maWdfc2Vy
dmVybmFtZTsKIGV4dGVybiBjb25zdCBjaGFyICpjb25maWdfbXVwZGF0ZV9zZXJ2ZXI7Ci0KIGV4
dGVybiBpbnQgY29uZmlnX2hhc2hpbWFwc3Bvb2w7CiAKIC8qIHNpZ25hbCBoYW5kbGluZyAoc2ln
bmFscy5jKSAqLwpJbmRleDogaW1hcC9pbWFwZC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMv
YW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9pbWFwZC5jLHYKcmV0cmll
dmluZyByZXZpc2lvbiAxLjM5NwpkaWZmIC11IC1yMS4zOTcgaW1hcGQuYwotLS0gaW1hcGQuYwky
MDAyLzA2LzA3IDAyOjA1OjMyCTEuMzk3CisrKyBpbWFwZC5jCTIwMDIvMDYvMTggMjA6MTE6NDIK
QEAgLTI5NCw3ICsyOTQsNyBAQAogICAgIC8qIGNoZWNrIGlmIHJlbW90ZSByZWFsbSAqLwogICAg
IGlmICgocmVhbG0gPSBzdHJjaHIoYXV0aF9pZGVudGl0eSwgJ0AnKSkhPU5VTEwpIHsKIAlyZWFs
bSsrOwotCXZhbCA9IGNvbmZpZ19nZXRzdHJpbmcoImxvZ2lucmVhbG1zIiwgIiIpOworCXZhbCA9
IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9MT0dJTlJFQUxNUyk7CiAJd2hpbGUgKCp2YWwpIHsK
IAkgICAgaWYgKCFzdHJuY2FzZWNtcCh2YWwsIHJlYWxtLCBzdHJsZW4ocmVhbG0pKSAmJgogCQko
IXZhbFtzdHJsZW4ocmVhbG0pXSB8fCBpc3NwYWNlKChpbnQpIHZhbFtzdHJsZW4ocmVhbG0pXSkp
KSB7CkBAIC0zMTQsMTYgKzMxNCwxNiBAQAogICAgIGltYXBkX2F1dGhzdGF0ZSA9IGF1dGhfbmV3
c3RhdGUoYXV0aF9pZGVudGl0eSwgTlVMTCk7CiAKICAgICAvKiBvaywgaXMgYXV0aF9pZGVudGl0
eSBhbiBhZG1pbj8gKi8KLSAgICBpbWFwZF91c2VyaXNhZG1pbiA9IGF1dGhpc2EoaW1hcGRfYXV0
aHN0YXRlLCAiaW1hcCIsICJhZG1pbnMiKTsKKyAgICBpbWFwZF91c2VyaXNhZG1pbiA9IGNvbmZp
Z19hdXRoaXNhKGltYXBkX2F1dGhzdGF0ZSwgSU1BUE9QVF9BRE1JTlMpOwogCiAgICAgaWYgKGFs
ZW4gIT0gcmxlbiB8fCBzdHJuY21wKGF1dGhfaWRlbnRpdHksIHJlcXVlc3RlZF91c2VyLCBhbGVu
KSkgewogCS8qIHdlIHdhbnQgdG8gYXV0aGVudGljYXRlIGFzIGEgZGlmZmVyZW50IHVzZXI7IHdl
J2xsIGFsbG93IHRoaXMKIAkgICBpZiB3ZSdyZSBhbiBhZG1pbiBvciBpZiB3ZSd2ZSBhbGxvd2Vk
IEFDTCBwcm94eSBsb2dpbnMgKi8KLQlpbnQgdXNlX2FjbCA9IGNvbmZpZ19nZXRzd2l0Y2goImxv
Z2ludXNlYWNsIiwgMCk7CisJaW50IHVzZV9hY2wgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRf
TE9HSU5VU0VBQ0wpOwogCiAJaWYgKGltYXBkX3VzZXJpc2FkbWluIHx8CiAJICAgICh1c2VfYWNs
ICYmIGFjbF9vayhyZXF1ZXN0ZWRfdXNlciwgaW1hcGRfYXV0aHN0YXRlKSkgfHwKLQkgICAgYXV0
aGlzYShpbWFwZF9hdXRoc3RhdGUsICJpbWFwIiwgInByb3h5c2VydmVycyIpKSB7CisJICAgIGNv
bmZpZ19hdXRoaXNhKGltYXBkX2F1dGhzdGF0ZSwgSU1BUE9QVF9QUk9YWVNFUlZFUlMpKSB7CiAJ
ICAgIC8qIHByb3h5IG9rISAqLwogCiAJICAgIGltYXBkX3VzZXJpc2FkbWluID0gMDsJLyogbm8g
bG9uZ2VyIGFkbWluICovCkBAIC0zMzMsNyArMzMzLDcgQEAKIAogCSAgICAvKiBhcmUgd2UgYSBw
cm94eSBhZG1pbj8gKi8KIAkgICAgaW1hcGRfdXNlcmlzcHJveHlhZG1pbiA9Ci0JCWF1dGhpc2Eo
aW1hcGRfYXV0aHN0YXRlLCAiaW1hcCIsICJhZG1pbnMiKTsKKwkJY29uZmlnX2F1dGhpc2EoaW1h
cGRfYXV0aHN0YXRlLCBJTUFQT1BUX0FETUlOUyk7CiAJfSBlbHNlIHsKIAkgICAgc2FzbF9zZXRl
cnJvcihjb25uLCAwLCAidXNlciAlcyBpcyBub3QgYWxsb3dlZCB0byBwcm94eSIsCiAJCQkgIGF1
dGhfaWRlbnRpdHkpOwpAQCAtNTAwLDggKzUwMCw2IEBACiB7CiAgICAgaW50IHI7CiAgICAgaW50
IG9wdDsKLQotICAgIGNvbmZpZ19jaGFuZ2VpZGVudCgiaW1hcGQiKTsKICAgICAKICAgICBpZiAo
Z2V0ZXVpZCgpID09IDApIGZhdGFsKCJtdXN0IHJ1biBhcyB0aGUgQ3lydXMgdXNlciIsIEVDX1VT
QUdFKTsKICAgICBzZXRwcm9jdGl0bGVfaW5pdChhcmdjLCBhcmd2LCBlbnZwKTsKQEAgLTU1NCw3
ICs1NTIsNyBAQAogIAkgICAgYnJlYWs7CiAJY2FzZSAncyc6IC8qIGltYXBzIChkbyBzdGFydHRs
cyByaWdodCBhd2F5KSAqLwogCSAgICBpbWFwcyA9IDE7Ci0JICAgIGlmICghdGxzX2VuYWJsZWQo
ImltYXAiKSkgeworCSAgICBpZiAoIXRsc19lbmFibGVkKCkpIHsKIAkJc3lzbG9nKExPR19FUlIs
ICJpbWFwczogcmVxdWlyZWQgT3BlblNTTCBvcHRpb25zIG5vdCBwcmVzZW50Iik7CiAJCWZhdGFs
KCJpbWFwczogcmVxdWlyZWQgT3BlblNTTCBvcHRpb25zIG5vdCBwcmVzZW50IiwKIAkJICAgICAg
RUNfQ09ORklHKTsKQEAgLTY1MCw3ICs2NDgsNyBAQAogICAgIHByb2NfcmVnaXN0ZXIoImltYXBk
IiwgaW1hcGRfY2xpZW50aG9zdCwgTlVMTCwgTlVMTCk7CiAKICAgICAvKiBTZXQgaW5hY3Rpdml0
eSB0aW1lciAqLwotICAgIHRpbWVvdXQgPSBjb25maWdfZ2V0aW50KCJ0aW1lb3V0IiwgMzApOwor
ICAgIHRpbWVvdXQgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfVElNRU9VVCk7CiAgICAgaWYgKHRp
bWVvdXQgPCAzMCkgdGltZW91dCA9IDMwOwogICAgIHByb3Rfc2V0dGltZW91dChpbWFwZF9pbiwg
dGltZW91dCo2MCk7CiAgICAgcHJvdF9zZXRmbHVzaG9ucmVhZChpbWFwZF9pbiwgaW1hcGRfb3V0
KTsKQEAgLTEzNjcsNyArMTM2NSw3IEBACiAJICAgIAogCWNhc2UgJ1MnOgogCSAgICBpZiAoIXN0
cmNtcChjbWQucywgIlN0YXJ0dGxzIikpIHsKLQkJaWYgKCF0bHNfZW5hYmxlZCgiaW1hcCIpKSB7
CisJCWlmICghdGxzX2VuYWJsZWQoKSkgewogCQkgICAgLyogd2UgZG9uJ3Qgc3VwcG9ydCBzdGFy
dHRscyAqLwogCQkgICAgZ290byBiYWRjbWQ7CiAJCX0KQEAgLTE3MDMsNyArMTcwMSw3IEBACiAK
ICAgICAvKiBwb3NzaWJseSBkaXNhbGxvdyBsb2dpbiAqLwogICAgIGlmICgoaW1hcGRfc3RhcnR0
bHNfZG9uZSA9PSAwKSAmJgotCShjb25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsIDEp
ID09IDApICYmCisJKGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV1BMQUlOVEVYVCkgPT0g
MCkgJiYKIAlzdHJjbXAoY2Fub25fdXNlciwgImFub255bW91cyIpICE9IDApIHsKIAllYXRsaW5l
KGltYXBkX2luLCAnICcpOwogCXByb3RfcHJpbnRmKGltYXBkX291dCwgIiVzIE5PIExvZ2luIG9u
bHkgYXZhaWxhYmxlIHVuZGVyIGEgbGF5ZXJcclxuIiwKQEAgLTE3MjcsNyArMTcyNSw3IEBACiAg
ICAgcGFzc3dkID0gcGFzc3dkYnVmLnM7CiAKICAgICBpZiAoIXN0cmNtcChjYW5vbl91c2VyLCAi
YW5vbnltb3VzIikpIHsKLQlpZiAoY29uZmlnX2dldHN3aXRjaCgiYWxsb3dhbm9ueW1vdXNsb2dp
biIsIDApKSB7CisJaWYgKGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV0FOT05ZTU9VU0xP
R0lOKSkgewogCSAgICBwYXNzd2QgPSBiZWF1dGlmeV9zdHJpbmcocGFzc3dkKTsKIAkgICAgaWYg
KHN0cmxlbihwYXNzd2QpID4gNTAwKSBwYXNzd2RbNTAwXSA9ICdcMCc7CiAJICAgIHN5c2xvZyhM
T0dfTk9USUNFLCAibG9naW46ICVzIGFub255bW91cyAlcyIsCkBAIC0xNzc2LDcgKzE3NzQsNyBA
QAogCSAgICAgICBjYW5vbl91c2VyLCBpbWFwZF9zdGFydHRsc19kb25lID8gIitUTFMiIDogIiIs
IAogCSAgICAgICByZXBseSA/IHJlcGx5IDogIiIpOwogCi0JcGxhaW50ZXh0bG9naW5wYXVzZSA9
IGNvbmZpZ19nZXRpbnQoInBsYWludGV4dGxvZ2lucGF1c2UiLCAwKTsKKwlwbGFpbnRleHRsb2dp
bnBhdXNlID0gY29uZmlnX2dldGludChJTUFQT1BUX1BMQUlOVEVYVExPR0lOUEFVU0UpOwogCWlm
IChwbGFpbnRleHRsb2dpbnBhdXNlICE9IDAgJiYgIWltYXBkX3N0YXJ0dGxzX2RvbmUpIHsKIAkg
ICAgLyogQXBwbHkgcGVuYWx0eSBvbmx5IGlmIG5vdCB1bmRlciBsYXllciAqLwogCSAgICBzbGVl
cChwbGFpbnRleHRsb2dpbnBhdXNlKTsKQEAgLTE3ODQsNyArMTc4Miw3IEBACiAgICAgfQogICAg
IAogICAgIGltYXBkX2F1dGhzdGF0ZSA9IGF1dGhfbmV3c3RhdGUoY2Fub25fdXNlciwgKGNoYXIg
KikwKTsKLSAgICB2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJhZG1pbnMiLCAiIik7CisgICAgdmFs
ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0FETUlOUyk7CiAgICAgd2hpbGUgKCp2YWwpIHsK
IAlmb3IgKHAgPSAoY2hhciAqKXZhbDsgKnAgJiYgIWlzc3BhY2UoKGludCkgKnApOyBwKyspOwog
CXN0cmxjcHkoYnVmLCB2YWwsIHAgLSB2YWwpOwpAQCAtMjExOSw3ICsyMTE3LDcgQEAKIAogICAg
IC8qIHNwaXQgb3V0IG91ciBJRCBzdHJpbmcuCiAgICAgICAgZXZlbnR1YWxseSB0aGlzIG1pZ2h0
IGJlIGNvbmZpZ3VyYWJsZS4gKi8KLSAgICBpZiAoY29uZmlnX2dldHN3aXRjaCgiaW1hcGlkcmVz
cG9uc2UiLCAxKSkgeworICAgIGlmIChjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfSU1BUElEUkVT
UE9OU0UpKSB7CiAJaWRfcmVzcG9uc2UoaW1hcGRfb3V0KTsKIAlwcm90X3ByaW50ZihpbWFwZF9v
dXQsICIpXHJcbiIpOwogICAgIH0KQEAgLTIyMzksMTAgKzIyMzcsMTAgQEAKIAlwcm90X3ByaW50
ZihpbWFwZF9vdXQsICIgSURMRSIpOwogICAgIH0KIAotICAgIGlmICh0bHNfZW5hYmxlZCgiaW1h
cCIpKSB7CisgICAgaWYgKHRsc19lbmFibGVkKCkpIHsKIAlwcm90X3ByaW50ZihpbWFwZF9vdXQs
ICIgU1RBUlRUTFMiKTsKICAgICB9Ci0gICAgaWYgKCFpbWFwZF9zdGFydHRsc19kb25lICYmICFj
b25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsIDEpKSB7CisgICAgaWYgKCFpbWFwZF9z
dGFydHRsc19kb25lICYmICFjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dQTEFJTlRFWFQp
KSB7CiAJcHJvdF9wcmludGYoaW1hcGRfb3V0LCAiIExPR0lORElTQUJMRUQiKTsKICAgICB9CiAK
QEAgLTI1NjcsNyArMjU2NSw3IEBACiAJCXByb3RfcHJpbnRmKGltYXBkX291dCwgIiogTk8gW0FM
RVJUXSAlc1xyXG4iLAogCQkJICAgIGVycm9yX21lc3NhZ2UoSU1BUF9OT19PVkVSUVVPVEEpKTsK
IAkgICAgfQotCSAgICBlbHNlIGlmICh1c2FnZSA+IGNvbmZpZ19nZXRpbnQoInF1b3Rhd2FybiIs
IDkwKSkgeworCSAgICBlbHNlIGlmICh1c2FnZSA+IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9RVU9U
QVdBUk4pKSB7CiAJCWludCB1c2FnZWludCA9IChpbnQpIHVzYWdlOwogCQlwcm90X3ByaW50Zihp
bWFwZF9vdXQsICIqIE5PIFtBTEVSVF0gIik7CiAJCXByb3RfcHJpbnRmKGltYXBkX291dCwgZXJy
b3JfbWVzc2FnZShJTUFQX05PX0NMT1NFUVVPVEEpLApAQCAtMzU1OCw3ICszNTU2LDcgQEAKIAkJ
CQkgICBsb2NhbG9ubHksIGxvY2Fsb25seSk7CiAKIAlpZiAociA9PSBJTUFQX1BFUk1JU1NJT05f
REVOSUVEICYmICFzdHJjYXNlY21wKG5hbWUsICJJTkJPWCIpICYmCi0JICAgIChhdXRvY3JlYXRl
cXVvdGEgPSBjb25maWdfZ2V0aW50KCJhdXRvY3JlYXRlcXVvdGEiLCAwKSkpIHsKKwkgICAgKGF1
dG9jcmVhdGVxdW90YSA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9BVVRPQ1JFQVRFUVVPVEEpKSkg
ewogCiAJICAgIC8qIEF1dG8gY3JlYXRlICovCiAJICAgIHIgPSBtYm94bGlzdF9jcmVhdGVtYWls
Ym94KG1haWxib3huYW1lLCAwLApAQCAtMzkzNyw3ICszOTM1LDcgQEAKICAgICBtYm94bmFtZV9o
aWVyc2VwX3RvaW50ZXJuYWwoJmltYXBkX25hbWVzcGFjZSwgcGF0dGVybik7CiAKICAgICBpZiAo
IXN0cmNhc2VjbXAobmFtZXNwYWNlLCAibWFpbGJveGVzIikpIHsKLQlpbnQgZm9yY2UgPSBjb25m
aWdfZ2V0c3dpdGNoKCJhbGxvd2FsbHN1YnNjcmliZSIsIDApOworCWludCBmb3JjZSA9IGNvbmZp
Z19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV0FMTFNVQlNDUklCRSk7CiAKIAkoKmltYXBkX25hbWVz
cGFjZS5tYm94bGlzdF9maW5kc3ViKSgmaW1hcGRfbmFtZXNwYWNlLCBwYXR0ZXJuLAogCQkJCQkg
ICAgaW1hcGRfdXNlcmlzYWRtaW4sIGltYXBkX3VzZXJpZCwKQEAgLTM5ODYsNyArMzk4NCw3IEBA
CiAgICAgLyogSWdub3JlIHRoZSByZWZlcmVuY2UgYXJndW1lbnQ/CiAgICAgICAgKHRoZSBiZWhh
dmlvciBpbiAxLjUuMTAgJiBvbGRlcikgKi8KICAgICBpZiAoaWdub3JlcmVmZXJlbmNlID09IDAp
IHsKLQlpZ25vcmVyZWZlcmVuY2UgPSBjb25maWdfZ2V0c3dpdGNoKCJpZ25vcmVyZWZlcmVuY2Ui
LCAwKTsKKwlpZ25vcmVyZWZlcmVuY2UgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfSUdOT1JF
UkVGRVJFTkNFKTsKICAgICB9CiAKICAgICAvKiBSZXNldCBzdGF0ZSBpbiBtc3RyaW5nZGF0YSAq
LwpAQCAtNDAyNyw3ICs0MDI1LDggQEAKIAltYm94bmFtZV9oaWVyc2VwX3RvaW50ZXJuYWwoJmlt
YXBkX25hbWVzcGFjZSwgcGF0dGVybik7CiAKIAkvKiBDaGVjayB0byBzZWUgaWYgd2Ugc2hvdWxk
IG9ubHkgbGlzdCB0aGUgcGVyc29uYWwgbmFtZXNwYWNlICovCi0JaWYgKCFzdHJjbXAocGF0dGVy
biwgIioiKSAmJiBjb25maWdfZ2V0aW50KCJmb29sc3R1cGlkY2xpZW50cyIsIDApKSB7CisJaWYg
KCFzdHJjbXAocGF0dGVybiwgIioiKQorCSAgICAmJiBjb25maWdfZ2V0aW50KElNQVBPUFRfRk9P
TFNUVVBJRENMSUVOVFMpKSB7CiAJICAgIGlmIChidWYpIGZyZWUoYnVmKTsKIAkgICAgYnVmID0g
c3RyZHVwKCJJTkJPWCoiKTsKIAkgICAgcGF0dGVybiA9IGJ1ZjsKQEAgLTQwNDAsNyArNDAzOSw3
IEBACiAJfQogCiAJaWYgKGxpc3RvcHRzICYgTElTVF9MU1VCIHx8IGxpc3RvcHRzICYgTElTVF9T
VUJTQ1JJQkVEKSB7Ci0JICAgIGludCBmb3JjZSA9IGNvbmZpZ19nZXRzd2l0Y2goImFsbG93YWxs
c3Vic2NyaWJlIiwgMCk7CisJICAgIGludCBmb3JjZSA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9Q
VF9BTExPV0FMTFNVQlNDUklCRSk7CiAKIAkgICAgKCpmaW5kc3ViKSgmaW1hcGRfbmFtZXNwYWNl
LCBwYXR0ZXJuLAogCQkgICAgICAgaW1hcGRfdXNlcmlzYWRtaW4sIGltYXBkX3VzZXJpZCwgaW1h
cGRfYXV0aHN0YXRlLApAQCAtNDA3MCw3ICs0MDY5LDcgQEAKIHsKICAgICBpbnQgcjsKICAgICBj
aGFyIG1haWxib3huYW1lW01BWF9NQUlMQk9YX05BTUUrMV07Ci0gICAgaW50IGZvcmNlID0gY29u
ZmlnX2dldHN3aXRjaCgiYWxsb3dhbGxzdWJzY3JpYmUiLCAwKTsKKyAgICBpbnQgZm9yY2UgPSBj
b25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dBTExTVUJTQ1JJQkUpOwogCiAgICAgaWYgKG5h
bWVzcGFjZSkgbGNhc2UobmFtZXNwYWNlKTsKICAgICBpZiAoIW5hbWVzcGFjZSB8fCAhc3RyY21w
KG5hbWVzcGFjZSwgIm1haWxib3giKSkgewpAQCAtNDc2Miw3ICs0NzYxLDcgQEAKIHsKICAgICBj
b25zdCBjaGFyICp1cmw7CiAKLSAgICB1cmwgPSBjb25maWdfZ2V0c3RyaW5nKCJuZXRzY2FwZXVy
bCIsIE5VTEwpOworICAgIHVybCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9ORVRTQ0FQRVVS
TCk7CiAKICAgICAvKiBJIG9ubHkga25vdyBvZiB0aHJlZSB0aGluZ3MgdG8gcmVwbHkgd2l0aDog
Ki8KICAgICBwcm90X3ByaW50ZihpbWFwZF9vdXQsCkluZGV4OiBpbWFwL2xtdHBkLmMKPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9p
bWFwL2xtdHBkLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuOTgKZGlmZiAtdSAtcjEuOTggbG10
cGQuYwotLS0gbG10cGQuYwkyMDAyLzA2LzAzIDE4OjIyOjI2CTEuOTgKKysrIGxtdHBkLmMJMjAw
Mi8wNi8xOCAyMDo0NTo1MApAQCAtMTk0LDcgKzE5NCw3IEBACiAgICAgLyogY2hlY2sgaWYgcmVt
b3RlIHJlYWxtICovCiAgICAgaWYgKChyZWFsbSA9IHN0cmNocihhdXRoX2lkZW50aXR5LCAnQCcp
KSE9TlVMTCkgewogCXJlYWxtKys7Ci0JdmFsID0gY29uZmlnX2dldHN0cmluZygibG9naW5yZWFs
bXMiLCAiIik7CisJdmFsID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0xPR0lOUkVBTE1TKTsK
IAl3aGlsZSAoKnZhbCkgewogCSAgICBpZiAoIXN0cm5jYXNlY21wKHZhbCwgcmVhbG0sIHN0cmxl
bihyZWFsbSkpICYmCiAJCSghdmFsW3N0cmxlbihyZWFsbSldIHx8IGlzc3BhY2UoKGludCkgdmFs
W3N0cmxlbihyZWFsbSldKSkpIHsKQEAgLTIxNSw3ICsyMTUsNyBAQAogICAgICAqIGZvciBub3cg
b25seSBhZG1pbnMgY2FuIGRvIGxtdHAgZnJvbSBhbm90aGVyIG1hY2hpbmUKICAgICAgKi8KICAg
ICBhdXRoc3RhdGUgPSBhdXRoX25ld3N0YXRlKGF1dGhfaWRlbnRpdHksIE5VTEwpOwotICAgIGFs
bG93ZWQgPSBhdXRoaXNhKGF1dGhzdGF0ZSwgImxtdHAiLCAiYWRtaW5zIik7CisgICAgYWxsb3dl
ZCA9IGNvbmZpZ19hdXRoaXNhKGF1dGhzdGF0ZSwgSU1BUE9QVF9BRE1JTlMpOwogICAgIGF1dGhf
ZnJlZXN0YXRlKGF1dGhzdGF0ZSk7CiAgICAgCiAgICAgaWYgKCFhbGxvd2VkKSB7CkBAIC0yNDAs
NyArMjQwLDYgQEAKIHsKICAgICBpbnQgcjsKIAotICAgIGNvbmZpZ19jaGFuZ2VpZGVudCgibG10
cGQiKTsKICAgICBpZiAoZ2V0ZXVpZCgpID09IDApIHJldHVybiAxOwogICAgIAogICAgIHNpZ25h
bHNfc2V0X3NodXRkb3duKCZzaHV0X2Rvd24pOwpAQCAtMjQ4LDkgKzI0Nyw5IEBACiAgICAgc2ln
bmFsKFNJR1BJUEUsIFNJR19JR04pOwogCiAjaWZkZWYgVVNFX1NJRVZFCi0gICAgc2lldmVfdXNl
aG9tZWRpciA9IGNvbmZpZ19nZXRzd2l0Y2goInNpZXZldXNlaG9tZWRpciIsIDApOworICAgIHNp
ZXZlX3VzZWhvbWVkaXIgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfU0lFVkVVU0VIT01FRElS
KTsKICAgICBpZiAoIXNpZXZlX3VzZWhvbWVkaXIpIHsKLQlzaWV2ZV9kaXIgPSBjb25maWdfZ2V0
c3RyaW5nKCJzaWV2ZWRpciIsICIvdXNyL3NpZXZlIik7CisJc2lldmVfZGlyID0gY29uZmlnX2dl
dHN0cmluZyhJTUFQT1BUX1NJRVZFRElSKTsKICAgICB9IGVsc2UgewogCXNpZXZlX2RpciA9IE5V
TEw7CiAgICAgfQpAQCAtMjYyLDggKzI2MSw4IEBACiAgICAgc2V0dXBfc2lldmUoKTsKICNlbmRp
ZiAvKiBVU0VfU0lFVkUgKi8KIAotICAgIHNpbmdsZWluc3RhbmNlID0gY29uZmlnX2dldHN3aXRj
aCgic2luZ2xlaW5zdGFuY2VzdG9yZSIsIDEpOwotICAgIEJCID0gY29uZmlnX2dldHN0cmluZygi
cG9zdHVzZXIiLCBCQik7CisgICAgc2luZ2xlaW5zdGFuY2UgPSBjb25maWdfZ2V0c3dpdGNoKElN
QVBPUFRfU0lOR0xFSU5TVEFOQ0VTVE9SRSk7CisgICAgQkIgPSBjb25maWdfZ2V0c3RyaW5nKElN
QVBPUFRfUE9TVFVTRVIpOwogCiAgICAgaWYgKChyID0gc2FzbF9zZXJ2ZXJfaW5pdChteXNhc2xf
Y2IsICJDeXJ1cyIpKSAhPSBTQVNMX09LKSB7CiAJc3lzbG9nKExPR19FUlIsICJTQVNMIGZhaWxl
ZCBpbml0aWFsaXppbmc6IHNhc2xfc2VydmVyX2luaXQoKTogJXMiLCAKQEAgLTI3MSw3ICsyNzAs
NyBAQAogCXJldHVybiBFQ19TT0ZUV0FSRTsKICAgICB9CiAKLSAgICBkdXBlbGltID0gY29uZmln
X2dldHN3aXRjaCgiZHVwbGljYXRlc3VwcHJlc3Npb24iLCAxKTsKKyAgICBkdXBlbGltID0gY29u
ZmlnX2dldHN3aXRjaChJTUFQT1BUX0RVUExJQ0FURVNVUFBSRVNTSU9OKTsKICAgICAvKiBpbml0
aWFsaXplIGR1cGxpY2F0ZSBkZWxpdmVyeSBkYXRhYmFzZSAqLwogICAgIGlmIChkdXBsaWNhdGVf
aW5pdChOVUxMLCAwKSAhPSAwKSB7CiAJc3lzbG9nKExPR19FUlIsIApAQCAtNDMzLDcgKzQzMiw3
IEBACiAJY2xvc2UoZmRzWzFdKTsKIAkvKiBtYWtlIHRoZSBwaXBlIGJlIHN0ZGluICovCiAJZHVw
MihmZHNbMF0sIDApOwotCWV4ZWN2KFNFTkRNQUlMLCAoY2hhciAqKikgYXJndik7CisJZXhlY3Yo
Y29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NFTkRNQUlMKSwgKGNoYXIgKiopIGFyZ3YpOwogCiAJ
LyogaWYgd2UncmUgaGVyZSB3ZSBzdWNrICovCiAJcHJpbnRmKCI0NTEgbG10cGQ6IGRpZG4ndCBl
eGVjPyE/XHJcbiIpOwpAQCAtNTE4LDcgKzUxNyw3IEBACiAgICAgZnByaW50ZihzbSwgIkRhdGU6
ICVzXHJcbiIsIGRhdGVzdHIpOwogCiAgICAgZnByaW50ZihzbSwgIlgtU2lldmU6ICVzXHJcbiIs
IFNJRVZFX1ZFUlNJT04pOwotICAgIGZwcmludGYoc20sICJGcm9tOiBNYWlsIFNpZXZlIFN1YnN5
c3RlbSA8JXM+XHJcbiIsIFBPU1RNQVNURVIpOworICAgIGZwcmludGYoc20sICJGcm9tOiBNYWls
IFNpZXZlIFN1YnN5c3RlbSA8JXM+XHJcbiIsIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QT1NU
TUFTVEVSKSk7CiAgICAgZnByaW50ZihzbSwgIlRvOiA8JXM+XHJcbiIsIHJlanRvKTsKICAgICBm
cHJpbnRmKHNtLCAiTUlNRS1WZXJzaW9uOiAxLjBcclxuIik7CiAgICAgZnByaW50ZihzbSwgIkNv
bnRlbnQtVHlwZTogIgpAQCAtNzkwLDcgKzc4OSw3IEBACiAJCQl2b2lkICptYyBfX2F0dHJpYnV0
ZV9fKCh1bnVzZWQpKSwKIAkJCWNvbnN0IGNoYXIgKiplcnJtc2cgX19hdHRyaWJ1dGVfXygodW51
c2VkKSkpCiB7Ci0gICAgY29uc3QgY2hhciAqbm90aWZpZXIgPSBjb25maWdfZ2V0c3RyaW5nKCJz
aWV2ZW5vdGlmaWVyIiwgTlVMTCk7CisgICAgY29uc3QgY2hhciAqbm90aWZpZXIgPSBjb25maWdf
Z2V0c3RyaW5nKElNQVBPUFRfU0lFVkVOT1RJRklFUik7CiAKICAgICBpZiAobm90aWZpZXIpIHsK
IAlzaWV2ZV9ub3RpZnlfY29udGV4dF90ICpuYyA9IChzaWV2ZV9ub3RpZnlfY29udGV4dF90ICop
IGFjOwpAQCAtMTE1OSw3ICsxMTU4LDcgQEAKICAgICB9CiAKICAgICBpZiAoIXIgJiYgdXNlcikg
ewotCWNvbnN0IGNoYXIgKm5vdGlmaWVyID0gY29uZmlnX2dldHN0cmluZygibWFpbG5vdGlmaWVy
IiwgTlVMTCk7CisJY29uc3QgY2hhciAqbm90aWZpZXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBP
UFRfTUFJTE5PVElGSUVSKTsKIAogCWlmIChub3RpZmllcikgewogCSAgICAvKiBkbyB3ZSB3YW50
IHRvIHJlcGxhY2UgdXNlci5YWFggd2l0aCBJTkJPWD8gKi8KSW5kZXg6IGltYXAvbG10cGVuZ2lu
ZS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9z
cmMvY3lydXMvaW1hcC9sbXRwZW5naW5lLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNzUKZGlm
ZiAtdSAtcjEuNzUgbG10cGVuZ2luZS5jCi0tLSBsbXRwZW5naW5lLmMJMjAwMi8wNi8wNiAwMDox
MjozNAkxLjc1CisrKyBsbXRwZW5naW5lLmMJMjAwMi8wNi8xOCAyMDo1NDoxMgpAQCAtMTg0LDE0
ICsxODQsMTQgQEAKICI1NTAteW91ciBtZXNzYWdlLCBvciAlcyBpZiB5b3UgYmVsaWV2ZSB5b3Vc
clxuIgogIjU1MC1yZWNlaXZlZCB0aGlzIG1lc3NhZ2UgaW4gZXJyb3IuXHJcbiIKICI1NTAgNS43
LjEgUGVybWlzc2lvbiBkZW5pZWRcclxuIiwgCi0JCQlQT1NUTUFTVEVSKTsKKwkJCWNvbmZpZ19n
ZXRzdHJpbmcoSU1BUE9QVF9QT1NUTUFTVEVSKSk7CiAJfSBlbHNlIHsKIAkgICAgcHJvdF9wcmlu
dGYocG91dCwgIjU1MCA1LjcuMSBQZXJtaXNzaW9uIGRlbmllZFxyXG4iKTsKIAl9CiAJYnJlYWs7
CiAKICAgICBjYXNlIElNQVBfUVVPVEFfRVhDRUVERUQ6Ci0JaWYoY29uZmlnX2dldHN3aXRjaCgi
bG10cF9vdmVycXVvdGFfcGVybV9mYWlsdXJlIiwwKSkgeworCWlmKGNvbmZpZ19nZXRzd2l0Y2go
SU1BUE9QVF9MTVRQX09WRVJfUVVPVEFfUEVSTV9GQUlMVVJFKSkgewogCSAgICAvKiBOb3QgRGVm
YXVsdCAtIFBlcm0gRmFpbHVyZSAqLwogCSAgICBwcm90X3ByaW50Zihwb3V0LCAiNTUyIDUuMi4y
IE92ZXIgcXVvdGFcclxuIik7CiAJfSBlbHNlIHsKQEAgLTcyNiw3ICs3MjYsNyBAQAogICAgIGlu
dCBvZmYgPSAwOwogICAgIHN0YXRlIHMgPSBOQU1FX1NUQVJUOwogICAgIGludCByID0gMDsKLSAg
ICBpbnQgcmVqZWN0OGJpdCA9IGNvbmZpZ19nZXRzd2l0Y2goInJlamVjdDhiaXQiLCAwKTsKKyAg
ICBpbnQgcmVqZWN0OGJpdCA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9SRUpFQ1Q4QklUKTsK
IAogICAgIGlmIChuYW1lbGVuID09IDApIHsKIAluYW1lbGVuICs9IE5BTUVJTkM7CkBAIC0xMjMx
LDggKzEyMzEsMTEgQEAKICAgICBjZC5zdGFydHRsc19kb25lID0gMDsKIAogICAgIHNwcmludGYo
c2h1dGRvd25maWxlbmFtZSwgIiVzL21zZy9zaHV0ZG93biIsIGNvbmZpZ19kaXIpOwotICAgIG1h
eF9tc2dzaXplID0gY29uZmlnX2dldGludCgibWF4bWVzc2FnZXNpemUiLCBJTlRfTUFYKTsKKyAg
ICBtYXhfbXNnc2l6ZSA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9NQVhNRVNTQUdFU0laRSk7CiAK
KyAgICAvKiBJZiBtYXhfbXNnc2l6ZSBpcyAwLCBhbGxvdyBhbnkgc2l6ZSAqLworICAgIGlmKCFt
YXhfbXNnc2l6ZSkgbWF4X21zZ3NpemUgPSBJTlRfTUFYOworCiAgICAgbXNnX25ldygmbXNnKTsK
IAogICAgIC8qIGRvbid0IGxlYWsgb2xkIGNvbm5lY3Rpb25zICovCkBAIC0xMzAyLDEwICsxMzA1
LDggQEAKICAgICAvKiBzZXQgbXkgYWxsb3dhYmxlIHNlY3VyaXR5IHByb3BlcnRpZXMgKi8KICAg
ICAvKiBBTk9OWU1PVVMgaXMgc2lsbHkgYmVjYXVzZSB3ZSBhbGxvdyB0aGF0IGFueXdheSAqLwog
ICAgIHNlY2ZsYWdzID0gU0FTTF9TRUNfTk9BTk9OWU1PVVM7Ci0gICAgcGxhaW50ZXh0X3Jlc3Vs
dCA9IGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0IiwxKTsKLSAgICBpZiAoIWNvbmZp
Z19nZXRzd2l0Y2goImxtdHBfYWxsb3dwbGFpbnRleHQiLCBwbGFpbnRleHRfcmVzdWx0KSkgewot
CXNlY2ZsYWdzIHw9IFNBU0xfU0VDX05PUExBSU5URVhUOwotICAgIH0KKyAgICBwbGFpbnRleHRf
cmVzdWx0ID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhUKTsKKwogICAg
IHNlY3Byb3BzID0gbXlzYXNsX3NlY3Byb3BzKHNlY2ZsYWdzKTsKICAgICBzYXNsX3NldHByb3Ao
Y2QuY29ubiwgU0FTTF9TRUNfUFJPUFMsIHNlY3Byb3BzKTsKIApAQCAtMTU3MSw3ICsxNTcyLDcg
QEAKIAkJICBwcm90X3ByaW50Zihwb3V0LCAiMjUwLVNJWkUgJWRcclxuIiwgbWF4X21zZ3NpemUp
OwogCSAgICAgIGVsc2UKIAkJICBwcm90X3ByaW50Zihwb3V0LCAiMjUwLVNJWkVcclxuIik7Ci0J
ICAgICAgaWYgKHRsc19lbmFibGVkKCJsbXRwIikgJiYgIWZ1bmMtPnByZWF1dGgpIHsKKwkgICAg
ICBpZiAodGxzX2VuYWJsZWQoKSAmJiAhZnVuYy0+cHJlYXV0aCkgewogCQkgIHByb3RfcHJpbnRm
KHBvdXQsICIyNTAtU1RBUlRUTFNcclxuIik7CiAJICAgICAgfQogCSAgICAgIGlmIChzYXNsX2xp
c3RtZWNoKGNkLmNvbm4sIE5VTEwsICJBVVRIICIsICIgIiwgIiIsICZtZWNocywgCkBAIC0xNTkw
LDcgKzE1OTEsNyBAQAogICAgICAgY2FzZSAnbSc6CiAgICAgICBjYXNlICdNJzoKIAkgICAgaWYg
KCFhdXRoZW50aWNhdGVkKSB7Ci0JCWlmIChjb25maWdfZ2V0c3dpdGNoKCJzb2Z0X25vYXV0aCIs
IDEpKSB7CisJCWlmIChjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfU09GVF9OT0FVVEgpKSB7CiAJ
CSAgICBwcm90X3ByaW50Zihwb3V0LCAiNDMwIEF1dGhlbnRpY2F0aW9uIHJlcXVpcmVkXHJcbiIp
OwogCQl9IGVsc2UgewogCQkgICAgcHJvdF9wcmludGYocG91dCwgIjUzMCBBdXRoZW50aWNhdGlv
biByZXF1aXJlZFxyXG4iKTsKQEAgLTE3ODUsNyArMTc4Niw3IEBACiAgICAgICBjYXNlICdzJzoK
ICAgICAgIGNhc2UgJ1MnOgogI2lmZGVmIEhBVkVfU1NMCi0JICAgIGlmICghc3RyY2FzZWNtcChi
dWYsICJzdGFydHRscyIpICYmIHRsc19lbmFibGVkKCJsbXRwIikgJiYKKwkgICAgaWYgKCFzdHJj
YXNlY21wKGJ1ZiwgInN0YXJ0dGxzIikgJiYgdGxzX2VuYWJsZWQoKSAmJgogCQkhZnVuYy0+cHJl
YXV0aCkgeyAvKiBkb24ndCBuZWVkIFRMUyBmb3IgcHJlYXV0aCdkIGNvbm5lY3QgKi8KIAkJaW50
ICpsYXllcnA7CiAJCXNhc2xfc3NmX3Qgc3NmOwpAQCAtMjU2NCwxMCArMjU2NSw3IEBACiAgICAg
CiAgICAgc2VjZmxhZ3MgPSBTQVNMX1NFQ19OT0FOT05ZTU9VUzsKIAotICAgIHBsYWludGV4dF9y
ZXN1bHQgPSBjb25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsIDEpOwotICAgIGlmICgh
Y29uZmlnX2dldHN3aXRjaCgibG10cF9hbGxvd3BsYWludGV4dCIsIHBsYWludGV4dF9yZXN1bHQp
KSB7Ci0Jc2VjZmxhZ3MgfD0gU0FTTF9TRUNfTk9QTEFJTlRFWFQ7Ci0gICAgfQorICAgIHBsYWlu
dGV4dF9yZXN1bHQgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dQTEFJTlRFWFQpOwog
ICAgIHNlY3Byb3BzID0gbXlzYXNsX3NlY3Byb3BzKHNlY2ZsYWdzKTsKICAgICByZXQgPSBzYXNs
X3NldHByb3AoKmNvbm4sIFNBU0xfU0VDX1BST1BTLCBzZWNwcm9wcyk7CiAgICAgaWYocmV0ICE9
IFNBU0xfT0spIHJldHVybiByZXQ7CkluZGV4OiBpbWFwL2xtdHBlbmdpbmUuaAo9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAv
bG10cGVuZ2luZS5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjEzCmRpZmYgLXUgLXIxLjEzIGxt
dHBlbmdpbmUuaAotLS0gbG10cGVuZ2luZS5oCTIwMDIvMDQvMTEgMTg6MzY6NTYJMS4xMworKysg
bG10cGVuZ2luZS5oCTIwMDIvMDYvMTggMjA6NDU6MjEKQEAgLTQzLDEzICs0Myw2IEBACiAjaWZu
ZGVmIExNVFBFTkdJTkVfSAogI2RlZmluZSBMTVRQRU5HSU5FX0gKIAotLyogY29uZmlndXJhdGlv
biBwYXJhbWV0ZXJzICovCi0jZGVmaW5lIERFRkFVTFRfU0VORE1BSUwgKCIvdXNyL2xpYi9zZW5k
bWFpbCIpCi0jZGVmaW5lIERFRkFVTFRfUE9TVE1BU1RFUiAoInBvc3RtYXN0ZXIiKQotCi0jZGVm
aW5lIFNFTkRNQUlMIChjb25maWdfZ2V0c3RyaW5nKCJzZW5kbWFpbCIsIERFRkFVTFRfU0VORE1B
SUwpKQotI2RlZmluZSBQT1NUTUFTVEVSIChjb25maWdfZ2V0c3RyaW5nKCJwb3N0bWFzdGVyIiwg
REVGQVVMVF9QT1NUTUFTVEVSKSkKLQogLyoqKioqKioqKioqKioqKioqIHNlcnZlci1zaWRlIExN
VFAgKioqKioqKioqKioqKioqKioqKi8KIAogI2RlZmluZSBIRUFERVJDQUNIRVNJWkUgNDAwOQpJ
bmRleDogaW1hcC9sbXRwcHJveHlkLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcu
Y211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL2xtdHBwcm94eWQuYyx2CnJldHJpZXZp
bmcgcmV2aXNpb24gMS40MgpkaWZmIC11IC1yMS40MiBsbXRwcHJveHlkLmMKLS0tIGxtdHBwcm94
eWQuYwkyMDAyLzA2LzAzIDE4OjIyOjI2CTEuNDIKKysrIGxtdHBwcm94eWQuYwkyMDAyLzA2LzE5
IDAwOjA5OjMwCkBAIC0xNTIsNyArMTUyLDYgQEAKIHN0YXRpYyBpbnQgcXVvdGFvdmVycmlkZSA9
IDA7CQkvKiBzaG91bGQgaSBvdmVycmlkZSBxdW90YT8gKi8KIGNvbnN0IGNoYXIgKkJCID0gIiI7
CiBzdGF0aWMgbXVwZGF0ZV9oYW5kbGUgKm1oYW5kbGUgPSBOVUxMOwotc3RhdGljIGNvbnN0IGNo
YXIgKm11cGRhdGVfc2VydmVyID0gTlVMTDsKIGludCBkZWxpdmVyX2xvZ2ZkID0gLTE7IC8qIHVz
ZWQgaW4gbG10cGVuZ2luZS5jICovCiAKIC8qIGN1cnJlbnQgbmFtZXNwYWNlICovCkBAIC0xNzUs
NyArMTc0LDcgQEAKICAgICAvKiBjaGVjayBpZiByZW1vdGUgcmVhbG0gKi8KICAgICBpZiAoKHJl
YWxtID0gc3RyY2hyKGF1dGhfaWRlbnRpdHksICdAJykpIT1OVUxMKSB7CiAJcmVhbG0rKzsKLQl2
YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJlYWxtcyIsICIiKTsKKwl2YWwgPSBjb25maWdf
Z2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMpOwogCXdoaWxlICgqdmFsKSB7CiAJICAgIGlm
ICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3RybGVuKHJlYWxtKSkgJiYKIAkJKCF2YWxbc3Ry
bGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2YWxbc3RybGVuKHJlYWxtKV0pKSkgewpAQCAt
MTk2LDcgKzE5NSw3IEBACiAgICAgICogZm9yIG5vdyBvbmx5IGFkbWlucyBjYW4gZG8gbG10cCBm
cm9tIGFub3RoZXIgbWFjaGluZQogICAgICAqLwogICAgIGF1dGhzdGF0ZSA9IGF1dGhfbmV3c3Rh
dGUoYXV0aF9pZGVudGl0eSwgTlVMTCk7Ci0gICAgYWxsb3dlZCA9IGF1dGhpc2EoYXV0aHN0YXRl
LCAibG10cCIsICJhZG1pbnMiKTsKKyAgICBhbGxvd2VkID0gY29uZmlnX2F1dGhpc2EoYXV0aHN0
YXRlLCBJTUFQT1BUX0FETUlOUyk7CiAgICAgYXV0aF9mcmVlc3RhdGUoYXV0aHN0YXRlKTsKICAg
ICAKICAgICBpZiAoIWFsbG93ZWQpIHsKQEAgLTIxOCwxNCArMjE3LDEzIEBACiB7CiAgICAgaW50
IHI7CiAKLSAgICBjb25maWdfY2hhbmdlaWRlbnQoImxtdHBwcm94eWQiKTsKICAgICBpZiAoZ2V0
ZXVpZCgpID09IDApIHJldHVybiAxOwogICAgIAogICAgIHNpZ25hbHNfc2V0X3NodXRkb3duKCZz
aHV0X2Rvd24pOwogICAgIHNpZ25hbHNfYWRkX2hhbmRsZXJzKCk7CiAgICAgc2lnbmFsKFNJR1BJ
UEUsIFNJR19JR04pOwogCi0gICAgQkIgPSBjb25maWdfZ2V0c3RyaW5nKCJwb3N0dXNlciIsIEJC
KTsKKyAgICBCQiA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QT1NUVVNFUik7CiAKICAgICBp
ZiAoKHIgPSBzYXNsX3NlcnZlcl9pbml0KG15c2FzbF9jYiwgIkN5cnVzIikpICE9IFNBU0xfT0sp
IHsKIAlzeXNsb2coTE9HX0VSUiwgIlNBU0wgZmFpbGVkIGluaXRpYWxpemluZzogc2FzbF9zZXJ2
ZXJfaW5pdCgpOiAlcyIsIApAQCAtMjQ2LDggKzI0NCw3IEBACiAJZmF0YWwoZXJyb3JfbWVzc2Fn
ZShyKSwgRUNfQ09ORklHKTsKICAgICB9CiAKLSAgICBtdXBkYXRlX3NlcnZlciA9IGNvbmZpZ19n
ZXRzdHJpbmcoIm11cGRhdGVfc2VydmVyIiwgTlVMTCk7Ci0gICAgaWYgKCFtdXBkYXRlX3NlcnZl
cikgeworICAgIGlmICghY29uZmlnX211cGRhdGVfc2VydmVyKSB7CiAJc3lzbG9nKExPR19FUlIs
ICJubyBtdXBkYXRlX3NlcnZlciBkZWZpbmVkIik7CiAJcmV0dXJuIEVDX0NPTkZJRzsKICAgICB9
CkBAIC0zMDYsMTMgKzMwMywxMyBAQAogICAgIH0KICAgICAvKiBjb25uZWN0IHRvIHRoZSBtdXBk
YXRlIHNlcnZlciAqLwogICAgIGlmICghbWhhbmRsZSkgewotCXIgPSBtdXBkYXRlX2Nvbm5lY3Qo
bXVwZGF0ZV9zZXJ2ZXIsIE5VTEwsICZtaGFuZGxlLCBOVUxMKTsKKwlyID0gbXVwZGF0ZV9jb25u
ZWN0KGNvbmZpZ19tdXBkYXRlX3NlcnZlciwgTlVMTCwgJm1oYW5kbGUsIE5VTEwpOwogICAgIH0J
CiAgICAgaWYgKCFyKSB7CiAJbG10cG1vZGUoJm15bG10cCwgZGVsaXZlcl9pbiwgZGVsaXZlcl9v
dXQsIDApOwogICAgIH0gZWxzZSB7CiAJbWhhbmRsZSA9IE5VTEw7Ci0Jc3lzbG9nKExPR19FUlIs
ICJjb3VsZG4ndCBjb25uZWN0IHRvICVzOiAlcyIsIG11cGRhdGVfc2VydmVyLAorCXN5c2xvZyhM
T0dfRVJSLCAiY291bGRuJ3QgY29ubmVjdCB0byAlczogJXMiLCBjb25maWdfbXVwZGF0ZV9zZXJ2
ZXIsCiAJICAgICAgIGVycm9yX21lc3NhZ2UocikpOwogCXByb3RfcHJpbnRmKGRlbGl2ZXJfb3V0
LCAiNDUxICVzIExNVFAgQ3lydXMgJXMgJXNcclxuIiwKIAkJICAgIGNvbmZpZ19zZXJ2ZXJuYW1l
LCBDWVJVU19WRVJTSU9OLCBlcnJvcl9tZXNzYWdlKHIpKTsKQEAgLTM4MSwxMSArMzc4LDE0IEBA
CiAJY3AgPSBzdHJjaHIob3B0c3RyLCAnLicpOwogCWlmIChjcCkgKmNwID0gJ1wwJzsKIAlzdHJj
YXQob3B0c3RyLCAiX3Bhc3N3b3JkIik7Ci0JcGFzcyA9IGNvbmZpZ19nZXRzdHJpbmcob3B0c3Ry
LCBOVUxMKTsKKwlwYXNzID0gY29uZmlnX2dldG92ZXJmbG93c3RyaW5nKG9wdHN0ciwgTlVMTCk7
CisJaWYoIXBhc3MpIHBhc3MgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfUFJPWFlfUEFTU1dP
UkQpOwogCi0JY2IgPSBteXNhc2xfY2FsbGJhY2tzKGNvbmZpZ19nZXRzdHJpbmcoImxtdHBwcm94
eV91c2VybmFtZSIsICIiKSwKLQkJCSAgICAgIGNvbmZpZ19nZXRzdHJpbmcoImxtdHBwcm94eV9h
dXRobmFtZSIsICJwcm94eSIpLAotCQkJICAgICAgY29uZmlnX2dldHN0cmluZygibG10cHByb3h5
X3JlYWxtIiwgTlVMTCksCisJLyogQXV0aG9yaXphdGlvbiBkb2VzIG5vdCBtYXR0ZXIgZm9yIExN
VFAsIHNvIHdlJ2xsIGp1c3QgcGFzcworCSAqIHRoZSBlbXB0eSBzdHJpbmcuICovCisJY2IgPSBt
eXNhc2xfY2FsbGJhY2tzKCIiLAorCQkJICAgICAgY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1BS
T1hZX0FVVEhOQU1FKSwKKwkJCSAgICAgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9S
RUFMTSksCiAJCQkgICAgICBwYXNzKTsKIAkKIAlyID0gbG10cF9jb25uZWN0KHAtPmhvc3QsIGNi
LCAmcC0+Y29ubik7CkluZGV4OiBpbWFwL21iZHVtcC5jCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9h
ZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9tYmR1bXAuYyx2CnJl
dHJpZXZpbmcgcmV2aXNpb24gMS4xOApkaWZmIC11IC1yMS4xOCBtYmR1bXAuYwotLS0gbWJkdW1w
LmMJMjAwMi8wNS8yNCAxODowNToxNQkxLjE4CisrKyBtYmR1bXAuYwkyMDAyLzA2LzE4IDIwOjM4
OjI2CkBAIC0zMjYsNyArMzI2LDcgQEAKIAogICAgIGlmKHVzZXJpZCkgewogCWNoYXIgc2lldmVf
cGF0aFtNQVhfTUFJTEJPWF9QQVRIXTsKLQlpbnQgc2lldmVfdXNlaG9tZWRpciA9IGNvbmZpZ19n
ZXRzd2l0Y2goInNpZXZldXNlaG9tZWRpciIsIDApOworCWludCBzaWV2ZV91c2Vob21lZGlyID0g
Y29uZmlnX2dldHN3aXRjaChJTUFQT1BUX1NJRVZFVVNFSE9NRURJUik7CiAKIAkvKiBuZWVkIHRv
IHRyYW5zZmVyIHNlZW4sIHN1YnMsIGFuZCBzaWV2ZSBmaWxlcyAqLwogCWZvcihpPTA7aTwzO2kr
KykgewpAQCAtMzc5LDcgKzM3OSw3IEBACiAJICAgIG1iZGlyID0gTlVMTDsKIAogCSAgICBzbnBy
aW50ZihzaWV2ZV9wYXRoLCBzaXplb2Yoc2lldmVfcGF0aCksICIlcy8lYy8lcyIsCi0JCSAgICAg
Y29uZmlnX2dldHN0cmluZygic2lldmVkaXIiLCAiL3Vzci9zaWV2ZSIpLAorCQkgICAgIGNvbmZp
Z19nZXRzdHJpbmcoSU1BUE9QVF9TSUVWRURJUiksCiAJCSAgICAgdXNlcmlkWzBdLCB1c2VyaWQp
OwogCSAgICBtYmRpcj1vcGVuZGlyKHNpZXZlX3BhdGgpOwogCSAgICAKQEAgLTQ2NCw3ICs0NjQs
NyBAQAogICAgIGNvbnN0IGNoYXIgKnVzZXJpZCA9IE5VTEw7CiAgICAgc3RydWN0IG1haWxib3gg
bWI7CiAgICAgY2hhciBzaWV2ZV9wYXRoWzIwNDhdOwotICAgIGludCBzaWV2ZV91c2Vob21lZGly
ID0gY29uZmlnX2dldHN3aXRjaCgic2lldmV1c2Vob21lZGlyIiwgMCk7CisgICAgaW50IHNpZXZl
X3VzZWhvbWVkaXIgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfU0lFVkVVU0VIT01FRElSKTsK
ICAgICAKICAgICBtZW1zZXQoJmZpbGUsIDAsIHNpemVvZihzdHJ1Y3QgYnVmKSk7CiAgICAgbWVt
c2V0KCZkYXRhLCAwLCBzaXplb2Yoc3RydWN0IGJ1ZikpOwpAQCAtNDc2LDcgKzQ3Niw3IEBACiAK
IAlpZighc2lldmVfdXNlaG9tZWRpcikKIAkgICAgc25wcmludGYoc2lldmVfcGF0aCwgc2l6ZW9m
KHNpZXZlX3BhdGgpLCAiJXMvJWMvJXMiLAotCQkgICAgIGNvbmZpZ19nZXRzdHJpbmcoInNpZXZl
ZGlyIiwgIi91c3Ivc2lldmUiKSwKKwkJICAgICBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU0lF
VkVESVIpLAogCQkgICAgIHVzZXJpZFswXSwgdXNlcmlkKTsKICAgICB9CiAKSW5kZXg6IGltYXAv
bWJveGxpc3QuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3Rl
bS9jdnMvc3JjL2N5cnVzL2ltYXAvbWJveGxpc3QuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4x
OTYKZGlmZiAtdSAtcjEuMTk2IG1ib3hsaXN0LmMKLS0tIG1ib3hsaXN0LmMJMjAwMi8wNi8wMyAx
OTozOToyOQkxLjE5NgorKysgbWJveGxpc3QuYwkyMDAyLzA2LzE4IDIwOjIxOjIzCkBAIC0xMDgs
MjUgKzEwOCwxNCBAQAogc3RhdGljIGludCBtYm94bGlzdF9nZXRwYXRoKGNvbnN0IGNoYXIgKnBh
cnRpdGlvbiwgY29uc3QgY2hhciAqbmFtZSwgCiAJCQkgICAgY2hhciAqKnBhdGhwKQogewotICAg
IHNpemVfdCBwYXJ0aXRpb25sZW47Ci0gICAgY2hhciBvcHRpb25idWZbTUFYX01BSUxCT1hfTkFN
RSsxXTsKICAgICBzdGF0aWMgY2hhciBwYXRocmVzdWx0W01BWF9NQUlMQk9YX1BBVEhdOwogICAg
IGNvbnN0IGNoYXIgKnJvb3Q7CiAKICAgICBhc3NlcnQocGFydGl0aW9uICYmIHBhdGhwKTsKIAot
ICAgIHBhcnRpdGlvbmxlbiA9IHN0cmxlbihwYXJ0aXRpb24pOworICAgIHJvb3QgPSBjb25maWdf
cGFydGl0aW9uZGlyKHBhcnRpdGlvbik7CisgICAgaWYgKCFyb290KSByZXR1cm4gSU1BUF9QQVJU
SVRJT05fVU5LTk9XTjsKIAotICAgIGlmIChwYXJ0aXRpb25sZW4gPiBzaXplb2Yob3B0aW9uYnVm
KS0xMSkgewotCXJldHVybiBJTUFQX1BBUlRJVElPTl9VTktOT1dOOwotICAgIH0KLSAgICBzdHJj
cHkob3B0aW9uYnVmLCAicGFydGl0aW9uLSIpOwotICAgIHN0cmNhdChvcHRpb25idWYsIHBhcnRp
dGlvbik7Ci0gICAgCi0gICAgcm9vdCA9IGNvbmZpZ19nZXRzdHJpbmcob3B0aW9uYnVmLCAoY2hh
ciAqKTApOwotICAgIGlmICghcm9vdCkgewotCXJldHVybiBJTUFQX1BBUlRJVElPTl9VTktOT1dO
OwotICAgIH0KICAgICBtYWlsYm94X2hhc2hfbWJveChwYXRocmVzdWx0LCByb290LCBuYW1lKTsK
IAogICAgICpwYXRocCA9IHBhdGhyZXN1bHQ7CkBAIC0xNDQsNyArMTMzLDcgQEAKIAogc3RhdGlj
IGNvbnN0IGludCBnZXRfZGVsZXRlcmlnaHQodm9pZCkKIHsKLSAgICBjb25zdCBjaGFyICpyID0g
Y29uZmlnX2dldHN0cmluZygiZGVsZXRlcmlnaHQiLCAiYyIpOworICAgIGNvbnN0IGNoYXIgKnIg
PSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfREVMRVRFUklHSFQpOwogCiAgICAgcmV0dXJuIGN5
cnVzX2FjbF9zdHJ0b21hc2socik7CiB9CkBAIC0yNzQsNyArMjYzLDYgQEAKIAogaW50IG1ib3hs
aXN0X2ZpbmRzdGFnZShjb25zdCBjaGFyICpuYW1lLCBjaGFyICpzdGFnZWRpcikgCiB7Ci0gICAg
Y2hhciBvcHRpb25idWZbTUFYX01BSUxCT1hfTkFNRSsxXTsKICAgICBjb25zdCBjaGFyICpyb290
OwogICAgIGNoYXIgKnBhcnRpdGlvbjsKICAgICBpbnQgcjsKQEAgLTI4OSwxNSArMjc3LDEwIEBA
CiAgICAgZGVmYXVsdDoKIAlyZXR1cm4gcjsKIAlicmVhazsKLSAgICB9Ci0JCi0gICAgc3RyY3B5
KG9wdGlvbmJ1ZiwgInBhcnRpdGlvbi0iKTsKLSAgICBzdHJjcHkob3B0aW9uYnVmICsgMTAsIHBh
cnRpdGlvbik7Ci0gICAgCi0gICAgcm9vdCA9IGNvbmZpZ19nZXRzdHJpbmcob3B0aW9uYnVmLCAo
Y2hhciAqKTApOwotICAgIGlmICghcm9vdCkgewotCXJldHVybiBJTUFQX1BBUlRJVElPTl9VTktO
T1dOOwogICAgIH0KKwkgICAgCisgICAgcm9vdCA9IGNvbmZpZ19wYXJ0aXRpb25kaXIocGFydGl0
aW9uKTsKKyAgICBpZiAoIXJvb3QpIHJldHVybiBJTUFQX1BBUlRJVElPTl9VTktOT1dOOwogCQog
ICAgIHNwcmludGYoc3RhZ2VkaXIsICIlcy9zdGFnZS4vIiwgcm9vdCk7CiAgICAgCkBAIC00NTUs
NyArNDM4LDcgQEAKIAkgICAgICogTm9ib2R5IGVsc2Ugc3RhcnRzIHdpdGggYW55IGFjY2VzcyB0
byBzYW1lLgogCSAgICAgKi8KIAkgICAgaWRlbnRpZmllciA9IHhzdHJkdXAobmFtZSs1KTsKLQkg
ICAgaWYgKGNvbmZpZ19nZXRzd2l0Y2goInVuaXhoaWVyYXJjaHlzZXAiLCAwKSkgeworCSAgICBp
ZiAoY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX1VOSVhISUVSQVJDSFlTRVApKSB7CiAJCS8qCiAJ
CSAqIFRoZSBtYWlsYm94bmFtZSBpcyBub3cgaW4gdGhlIGludGVybmFsIGZvcm1hdCwKIAkJICog
c28gd2Ugd2UgbmVlZCB0byBjaGFuZ2UgRE9UQ0hBUnMgYmFjayB0byAnLicKQEAgLTQ3MCw3ICs0
NTMsNyBAQAogCSAgICBmcmVlKGlkZW50aWZpZXIpOwogCX0gZWxzZSB7CiAJICAgIGRlZmF1bHRh
Y2wgPSBpZGVudGlmaWVyID0gCi0JCXhzdHJkdXAoY29uZmlnX2dldHN0cmluZygiZGVmYXVsdGFj
bCIsICJhbnlvbmUgbHJzIikpOworCQl4c3RyZHVwKGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9E
RUZBVUxUQUNMKSk7CiAJICAgIGZvciAoOzspIHsKIAkJd2hpbGUgKCppZGVudGlmaWVyICYmIGlz
c3BhY2UoKGludCkgKmlkZW50aWZpZXIpKSBpZGVudGlmaWVyKys7CiAJCXJpZ2h0cyA9IGlkZW50
aWZpZXI7CkBAIC01NzUsOCArNTU4LDcgQEAKIAogICAgIGlmICghKG1idHlwZSAmIE1CVFlQRV9S
RU1PVEUpKSB7CiAJLyogR2V0IHBhcnRpdGlvbidzIHBhdGggKi8KLQlzcHJpbnRmKGJ1ZiwgInBh
cnRpdGlvbi0lcyIsIG5ld3BhcnRpdGlvbik7Ci0Jcm9vdCA9IGNvbmZpZ19nZXRzdHJpbmcoYnVm
LCAoY2hhciAqKTApOworCXJvb3QgPSBjb25maWdfcGFydGl0aW9uZGlyKG5ld3BhcnRpdGlvbik7
CiAJaWYgKCFyb290KSB7CiAJICAgIHIgPSBJTUFQX1BBUlRJVElPTl9VTktOT1dOOwogCSAgICBn
b3RvIGRvbmU7CkluZGV4OiBpbWFwL21ib3huYW1lLmMKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fm
cy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL21ib3huYW1lLmMsdgpy
ZXRyaWV2aW5nIHJldmlzaW9uIDEuMjUKZGlmZiAtdSAtcjEuMjUgbWJveG5hbWUuYwotLS0gbWJv
eG5hbWUuYwkyMDAyLzAxLzI0IDE2OjM5OjI4CTEuMjUKKysrIG1ib3huYW1lLmMJMjAwMi8wNi8x
OCAyMDoyODozMQpAQCAtMjM2LDcgKzIzNiw4IEBACiAKIC8qIEhhbmRsZSBjb252ZXJzaW9uIGZy
b20gdGhlIGludGVybmFsIG5hbWVzcGFjZSB0byB0aGUgc3RhbmRhcmQgbmFtZXNwYWNlICovCiBz
dGF0aWMgaW50IG1ib3huYW1lX3RvZXh0ZXJuYWwoc3RydWN0IG5hbWVzcGFjZSAqbmFtZXNwYWNl
LCBjb25zdCBjaGFyICpuYW1lLAotCQkJICAgICAgIGNvbnN0IGNoYXIgKnVzZXJpZCwgY2hhciAq
cmVzdWx0KQorCQkJICAgICAgIGNvbnN0IGNoYXIgKnVzZXJpZCBfX2F0dHJpYnV0ZV9fKCh1bnVz
ZWQpKSwKKwkJCSAgICAgICBjaGFyICpyZXN1bHQpCiB7CiAgICAgc3RyY3B5KHJlc3VsdCwgbmFt
ZSk7CiAKQEAgLTMwNywxNCArMzA4LDE1IEBACiAKICAgICBhc3NlcnQobmFtZXNwYWNlICE9IE5V
TEwpOwogCi0gICAgbmFtZXNwYWNlLT5oaWVyX3NlcCA9IGNvbmZpZ19nZXRzd2l0Y2goInVuaXho
aWVyYXJjaHlzZXAiLCAwKSA/ICcvJyA6ICcuJzsKLSAgICBuYW1lc3BhY2UtPmlzYWx0ID0gIWZv
cmNlX3N0ZCAmJiBjb25maWdfZ2V0c3dpdGNoKCJhbHRuYW1lc3BhY2UiLCAwKTsKKyAgICBuYW1l
c3BhY2UtPmhpZXJfc2VwID0KKwljb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfVU5JWEhJRVJBUkNI
WVNFUCkgPyAnLycgOiAnLic7CisgICAgbmFtZXNwYWNlLT5pc2FsdCA9ICFmb3JjZV9zdGQgJiYg
Y29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMVE5BTUVTUEFDRSk7CiAKICAgICBpZiAobmFtZXNw
YWNlLT5pc2FsdCkgewogCS8qIGFsdGVybmF0ZSBuYW1lc3BhY2UgKi8KIAlzdHJjcHkobmFtZXNw
YWNlLT5wcmVmaXhbTkFNRVNQQUNFX0lOQk9YXSwgIiIpOwogCi0JcHJlZml4ID0gY29uZmlnX2dl
dHN0cmluZygidXNlcnByZWZpeCIsICJPdGhlciBVc2VycyIpOworCXByZWZpeCA9IGNvbmZpZ19n
ZXRzdHJpbmcoSU1BUE9QVF9VU0VSUFJFRklYKTsKIAlpZiAoIXByZWZpeCB8fCBzdHJsZW4ocHJl
Zml4KSA9PSAwIHx8CiAJICAgIHN0cmxlbihwcmVmaXgpID49IE1BWF9OQU1FU1BBQ0VfUFJFRklY
IHx8CiAJICAgIHN0cmNocihwcmVmaXgsbmFtZXNwYWNlLT5oaWVyX3NlcCkgIT0gTlVMTCkKQEAg
LTMyMiw3ICszMjQsNyBAQAogCXNwcmludGYobmFtZXNwYWNlLT5wcmVmaXhbTkFNRVNQQUNFX1VT
RVJdLCAiJS4qcyVjIiwKIAkJTUFYX05BTUVTUEFDRV9QUkVGSVgtMSwgcHJlZml4LCBuYW1lc3Bh
Y2UtPmhpZXJfc2VwKTsKIAotCXByZWZpeCA9IGNvbmZpZ19nZXRzdHJpbmcoInNoYXJlZHByZWZp
eCIsICJTaGFyZWQgRm9sZGVycyIpOworCXByZWZpeCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9Q
VF9TSEFSRURQUkVGSVgpOwogCWlmICghcHJlZml4IHx8IHN0cmxlbihwcmVmaXgpID09IDAgfHwK
IAkgICAgc3RybGVuKHByZWZpeCkgPj0gTUFYX05BTUVTUEFDRV9QUkVGSVggfHwKIAkgICAgc3Ry
Y2hyKHByZWZpeCwgbmFtZXNwYWNlLT5oaWVyX3NlcCkgIT0gTlVMTCB8fApAQCAtNDY1LDcgKzQ2
Nyw3IEBACiAgICAgaW50IHVjczQ7CiAgICAgaW50IHVuaXhzZXA7CiAKLSAgICB1bml4c2VwID0g
Y29uZmlnX2dldHN3aXRjaCgidW5peGhpZXJhcmNoeXNlcCIsIDApOworICAgIHVuaXhzZXAgPSBj
b25maWdfZ2V0c3dpdGNoKElNQVBPUFRfVU5JWEhJRVJBUkNIWVNFUCk7CiAKICAgICBpZiAoc3Ry
bGVuKG5hbWUpID4gTUFYX01BSUxCT1hfTkFNRSkgcmV0dXJuIElNQVBfTUFJTEJPWF9CQUROQU1F
OwogICAgIGZvciAoaSA9IDA7IGkgPCBOVU1fQkFETUJPWFBBVFRFUk5TOyBpKyspIHsKSW5kZXg6
IGltYXAvbWVzc2FnZS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUv
c3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9tZXNzYWdlLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuODgKZGlmZiAtdSAtcjEuODggbWVzc2FnZS5jCi0tLSBtZXNzYWdlLmMJMjAwMC8xMi8yNiAy
MTozNTo0MQkxLjg4CisrKyBtZXNzYWdlLmMJMjAwMi8wNi8xOCAyMDoyOTowMQpAQCAtMjI4LDcg
KzIyOCw3IEBACiAgICAgaW50IHIgPSAwOwogICAgIGludCBuOwogICAgIGludCBzYXdjciA9IDAs
IHNhd25sOwotICAgIGludCByZWplY3Q4Yml0ID0gY29uZmlnX2dldHN3aXRjaCgicmVqZWN0OGJp
dCIsIDApOworICAgIGludCByZWplY3Q4Yml0ID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX1JF
SkVDVDhCSVQpOwogICAgIGludCBpbmhlYWRlciA9IDEsIGJsYW5rbGluZSA9IDE7CiAKICAgICB3
aGlsZSAoc2l6ZSkgewpJbmRleDogaW1hcC9tdXBkYXRlLWNsaWVudC5jCj09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9tdXBk
YXRlLWNsaWVudC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjMyCmRpZmYgLXUgLXIxLjMyIG11
cGRhdGUtY2xpZW50LmMKLS0tIG11cGRhdGUtY2xpZW50LmMJMjAwMi8wNC8wNSAxOTo1MjoyNwkx
LjMyCisrKyBtdXBkYXRlLWNsaWVudC5jCTIwMDIvMDYvMTggMjA6MjY6MzUKQEAgLTgyLDE0ICs4
MiwxNCBAQAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBj
aGFyICpwYXNzd29yZCk7CiBleHRlcm4gdm9pZCBmcmVlX2NhbGxiYWNrcyhzYXNsX2NhbGxiYWNr
X3QgKmluKTsKIAotc3RhdGljIHNhc2xfc2VjdXJpdHlfcHJvcGVydGllc190ICptYWtlX3NlY3By
b3BzKGludCBtaW4sIGludCBtYXgpCitzdGF0aWMgc2FzbF9zZWN1cml0eV9wcm9wZXJ0aWVzX3Qg
Km1ha2Vfc2VjcHJvcHModm9pZCkKIHsKICAgc2FzbF9zZWN1cml0eV9wcm9wZXJ0aWVzX3QgKnJl
dCA9CiAgICAgICAoc2FzbF9zZWN1cml0eV9wcm9wZXJ0aWVzX3QgKikgeHptYWxsb2Moc2l6ZW9m
KHNhc2xfc2VjdXJpdHlfcHJvcGVydGllc190KSk7CiAKICAgcmV0LT5tYXhidWZzaXplID0gUFJP
VF9CVUZTSVpFOwotICByZXQtPm1pbl9zc2YgPSBjb25maWdfZ2V0aW50KCJzYXNsX21pbmltdW1f
bGF5ZXIiLCBtaW4pOwkKLSAgcmV0LT5tYXhfc3NmID0gY29uZmlnX2dldGludCgic2FzbF9tYXhp
bXVtX2xheWVyIiwgbWF4KTsKKyAgcmV0LT5taW5fc3NmID0gY29uZmlnX2dldGludChJTUFQT1BU
X1NBU0xfTUlOSU1VTV9MQVlFUik7CQorICByZXQtPm1heF9zc2YgPSBjb25maWdfZ2V0aW50KElN
QVBPUFRfU0FTTF9NQVhJTVVNX0xBWUVSKTsKIAogICByZXR1cm4gcmV0OwogfQpAQCAtMTE0LDcg
KzExNCw3IEBACiAJcmV0dXJuIDE7CiAgICAgfQogCi0gICAgc2VjcHJvcHMgPSBtYWtlX3NlY3By
b3BzKDAsIDI1Nik7CisgICAgc2VjcHJvcHMgPSBtYWtlX3NlY3Byb3BzKCk7CiAgICAgaWYoIXNl
Y3Byb3BzKSByZXR1cm4gMTsKICAgICAKICAgICBzYXNscmVzdWx0PXNhc2xfc2V0cHJvcChoLT5z
YXNsY29ubiwgU0FTTF9TRUNfUFJPUFMsIHNlY3Byb3BzKTsKQEAgLTI1MywxNCArMjUzLDExIEBA
CiAKICAgICAvKiBvcGVuIGNvbm5lY3Rpb24gdG8gJ3NlcnZlcicgKi8KICAgICBpZighc2VydmVy
KSB7Ci0Jc2VydmVyID0gY29uZmlnX2dldHN0cmluZygibXVwZGF0ZV9zZXJ2ZXIiLCBOVUxMKTsK
KwlzZXJ2ZXIgPSBjb25maWdfbXVwZGF0ZV9zZXJ2ZXI7CiAJaWYgKHNlcnZlciA9PSBOVUxMKSB7
CiAJICAgIGZhdGFsKCJjb3VsZG4ndCBnZXQgbXVwZGF0ZSBzZXJ2ZXIgbmFtZSIsIEVDX1VOQVZB
SUxBQkxFKTsKIAl9CiAgICAgfQotICAgIGlmKCFwb3J0KSB7Ci0JcG9ydCA9IGNvbmZpZ19nZXRz
dHJpbmcoIm11cGRhdGVfcG9ydCIsTlVMTCk7Ci0gICAgfQogICAgIAogICAgIGhwID0gZ2V0aG9z
dGJ5bmFtZShzZXJ2ZXIpOwogICAgIGlmICghaHApIHsKQEAgLTI4OSw3ICsyODYsNyBAQAogICAg
IH0gZWxzZSBpZigoc3AgPSBnZXRzZXJ2YnluYW1lKCJtdXBkYXRlIiwgInRjcCIpKSAhPSBOVUxM
KSB7CiAJYWRkci5zaW5fcG9ydCA9IHNwLT5zX3BvcnQ7CiAgICAgfSBlbHNlIHsKLQlhZGRyLnNp
bl9wb3J0ID0gaHRvbnMoMjAwNCk7CisJYWRkci5zaW5fcG9ydCA9IGNvbmZpZ19nZXRpbnQoSU1B
UE9QVF9NVVBEQVRFX1BPUlQpOwogICAgIH0KIAogICAgIGlmIChjb25uZWN0KHMsIChzdHJ1Y3Qg
c29ja2FkZHIgKikmYWRkciwgc2l6ZW9mKGFkZHIpKSA9PSAtMSkgewpAQCAtMzAzLDEwICszMDAs
MTAgQEAKIAogICAgIGlmKCFjYnMpIHsKIAlsb2NhbF9jYnMgPSAxOwotCWNicyA9IG15c2FzbF9j
YWxsYmFja3MoY29uZmlnX2dldHN0cmluZygibXVwZGF0ZV91c2VybmFtZSIsIiIpLAotCQkJICAg
ICAgIGNvbmZpZ19nZXRzdHJpbmcoIm11cGRhdGVfYXV0aG5hbWUiLE5VTEwpLAotCQkJICAgICAg
IGNvbmZpZ19nZXRzdHJpbmcoIm11cGRhdGVfcmVhbG0iLE5VTEwpLAotCQkJICAgICAgIGNvbmZp
Z19nZXRzdHJpbmcoIm11cGRhdGVfcGFzc3dvcmQiLE5VTEwpKTsKKwljYnMgPSBteXNhc2xfY2Fs
bGJhY2tzKGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9NVVBEQVRFX1VTRVJOQU1FKSwKKwkJCSAg
ICAgICBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTVVQREFURV9BVVRITkFNRSksCisJCQkgICAg
ICAgY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX01VUERBVEVfUkVBTE0pLAorCQkJICAgICAgIGNv
bmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9NVVBEQVRFX1BBU1NXT1JEKSk7CiAgICAgfQogCiAgICAg
c2FzbHJlc3VsdCA9IHNhc2xfY2xpZW50X25ldyhzZXJ2aWNlX25hbWUsCkluZGV4OiBpbWFwL211
cGRhdGUtc2xhdmUuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5
c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvbXVwZGF0ZS1zbGF2ZS5jLHYKcmV0cmlldmluZyByZXZp
c2lvbiAxLjE2CmRpZmYgLXUgLXIxLjE2IG11cGRhdGUtc2xhdmUuYwotLS0gbXVwZGF0ZS1zbGF2
ZS5jCTIwMDIvMDIvMjUgMjI6NDI6MzkJMS4xNgorKysgbXVwZGF0ZS1zbGF2ZS5jCTIwMDIvMDYv
MTkgMDA6MTQ6NDEKQEAgLTIyMywzNCArMjIzLDMwIEBACiAKIHZvaWQgKm11cGRhdGVfY2xpZW50
X3N0YXJ0KHZvaWQgKnJvY2sgX19hdHRyaWJ1dGVfXygodW51c2VkKSkpCiB7Ci0gICAgY29uc3Qg
Y2hhciAqc2VydmVyLCAqbnVtOwogICAgIG11cGRhdGVfaGFuZGxlICpoID0gTlVMTDsKICAgICBp
bnQgcmV0cnlfZGVsYXkgPSAyMCwgcmVhbF9kZWxheTsKICAgICBpbnQgcmV0OwogCiAgICAgc3Jh
bmQodGltZShOVUxMKSAqIGdldHBpZCgpKTsKIAotICAgIHNlcnZlciA9IGNvbmZpZ19nZXRzdHJp
bmcoIm11cGRhdGVfc2VydmVyIiwgTlVMTCk7Ci0gICAgaWYoc2VydmVyID09IE5VTEwpIHsKKyAg
ICBpZighY29uZmlnX211cGRhdGVfc2VydmVyKSB7CiAJZmF0YWwoImNvdWxkbid0IGdldCBtdXBk
YXRlIHNlcnZlciBuYW1lIiwgRUNfVU5BVkFJTEFCTEUpOwogICAgIH0KIAotICAgIG51bSA9IGNv
bmZpZ19nZXRzdHJpbmcoIm11cGRhdGVfcmV0cnlfZGVsYXkiLE5VTEwpOwotICAgIGlmKG51bSAm
JiBpbXBhcnNlX2lzbnVtYmVyKG51bSkpIHsKLQlyZXRyeV9kZWxheSA9IGF0b2kobnVtKTsKLQlp
ZihyZXRyeV9kZWxheSA8IDApIHsKLQkgICAgZmF0YWwoImludmFsaWQgdmFsdWUgZm9yIG11cGRh
dGVfcmV0cnlfZGVsYXkiLCBFQ19VTkFWQUlMQUJMRSk7Ci0JfQorICAgIHJldHJ5X2RlbGF5ID0g
Y29uZmlnX2dldGludChJTUFQT1BUX01VUERBVEVfUkVUUllfREVMQVkpOworICAgIGlmKHJldHJ5
X2RlbGF5IDwgMCkgeworCWZhdGFsKCJpbnZhbGlkIHZhbHVlIGZvciBtdXBkYXRlX3JldHJ5X2Rl
bGF5IiwgRUNfVU5BVkFJTEFCTEUpOwogICAgIH0KIAogICAgIHdoaWxlKDEpIHsKLQlyZXQgPSBt
dXBkYXRlX2Nvbm5lY3Qoc2VydmVyLCBOVUxMLCAmaCwgTlVMTCk7CisJcmV0ID0gbXVwZGF0ZV9j
b25uZWN0KGNvbmZpZ19tdXBkYXRlX3NlcnZlciwgTlVMTCwgJmgsIE5VTEwpOwogCWlmKHJldCkg
ewogCSAgICBzeXNsb2coTE9HX0VSUiwiY291bGRuJ3QgY29ubmVjdCB0byBtdXBkYXRlIHNlcnZl
ciIpOwogCSAgICBnb3RvIHJldHJ5OwogCX0KICAgIAotCXN5c2xvZyhMT0dfRVJSLCAic3VjY2Vz
c2Z1bCBtdXBkYXRlIGNvbm5lY3Rpb24gdG8gJXMiLCBzZXJ2ZXIpOworCXN5c2xvZyhMT0dfRVJS
LCAic3VjY2Vzc2Z1bCBtdXBkYXRlIGNvbm5lY3Rpb24gdG8gJXMiLAorCSAgICAgICBjb25maWdf
bXVwZGF0ZV9zZXJ2ZXIpOwogCiAJbXVwZGF0ZV9saXN0ZW4oaCwgcmV0cnlfZGVsYXkpOwogCklu
ZGV4OiBpbWFwL211cGRhdGUuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUu
ZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvbXVwZGF0ZS5jLHYKcmV0cmlldmluZyByZXZp
c2lvbiAxLjYwCmRpZmYgLXUgLXIxLjYwIG11cGRhdGUuYwotLS0gbXVwZGF0ZS5jCTIwMDIvMDYv
MDMgMTg6MjI6MjYJMS42MAorKysgbXVwZGF0ZS5jCTIwMDIvMDYvMTkgMDA6MTI6MzUKQEAgLTI2
OCw3ICsyNjgsNyBAQAogICAgIC8qIGNoZWNrIGlmIHJlbW90ZSByZWFsbSAqLwogICAgIGlmICgo
cmVhbG0gPSBzdHJjaHIoYXV0aF9pZF9idWYsICdAJykpIT1OVUxMKSB7CiAJcmVhbG0rKzsKLQl2
YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJlYWxtcyIsICIiKTsKKwl2YWwgPSBjb25maWdf
Z2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMpOwogCXdoaWxlICgqdmFsKSB7CiAJICAgIGlm
ICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3RybGVuKHJlYWxtKSkgJiYKIAkJKCF2YWxbc3Ry
bGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2YWxbc3RybGVuKHJlYWxtKV0pKSkgewpAQCAt
Mjg5LDcgKzI4OSw3IEBACiAgICAgICogZm9yIG5vdyBvbmx5IGFkbWlucyBjYW4gZG8gbXVwZGF0
ZSBmcm9tIGFub3RoZXIgbWFjaGluZQogICAgICAqLwogICAgIGF1dGhzdGF0ZSA9IGF1dGhfbmV3
c3RhdGUoYXV0aF9pZF9idWYsIE5VTEwpOwotICAgIGFsbG93ZWQgPSBhdXRoaXNhKGF1dGhzdGF0
ZSwgIm11cGRhdGUiLCAiYWRtaW5zIik7CisgICAgYWxsb3dlZCA9IGNvbmZpZ19hdXRoaXNhKGF1
dGhzdGF0ZSwgSU1BUE9QVF9BRE1JTlMpOwogICAgIGF1dGhfZnJlZXN0YXRlKGF1dGhzdGF0ZSk7
CiAgICAgCiAgICAgaWYgKCFhbGxvd2VkKSB7CkBAIC0zMTYsOCArMzE2LDYgQEAKICAgICBpbnQg
cjsKICAgICBpbnQgb3B0OwogCi0gICAgY29uZmlnX2NoYW5nZWlkZW50KCJtdXBkYXRlIik7Ci0g
ICAgCiAgICAgaWYgKGdldGV1aWQoKSA9PSAwKSBmYXRhbCgibXVzdCBydW4gYXMgdGhlIEN5cnVz
IHVzZXIiLCBFQ19VU0FHRSk7CiAKICAgICAvKiBzZXQgc2lnbmFsIGhhbmRsZXJzICovCkBAIC0z
NjUsMTcgKzM2Myw2IEBACiAJfQogICAgIH0KIAotICAgIC8qIFNsYXZlIFNraXBsaXN0IEZhc3Qg
UmVzeW5jPyAqLwotICAgIGlmKCFtYXN0ZXJwICYmIGNvbmZpZ19nZXRzd2l0Y2goIm11cGRhdGVf
c2xhdmVfZmFzdF9yZXN5bmMiLDApKSB7Ci0JY2hhciBmbmFtZVs0MDk2XTsKLQkKLQlpZihzbnBy
aW50ZihmbmFtZSw0MDk2LCIlcyVzIixjb25maWdfZGlyLEZOQU1FX01CT1hMSVNUKSA9PSAtMSkK
LQkgICAgZmF0YWwoIm1ib3hsaXN0IGRhdGFiYXNlIGZpbGVuYW1lIHRvbyBsYXJnZSIsRUNfVEVN
UEZBSUwpOwotCi0JcHV0ZW52KCJDWVJVU19TS0lQTElTVF9VTlNBRkU9MSIpOwotIAl1bmxpbmso
Zm5hbWUpOwotICAgIH0KLQogICAgIGRhdGFiYXNlX2luaXQoKTsKIAogICAgIGlmICghbWFzdGVy
cCkgewpAQCAtNDQwLDEwICs0MjcsMTEgQEAKIAogICAgIC8qIEFVVEggYmFubmVyIGlzIG1hbmRh
dG9yeSAqLwogICAgIGlmKCFtYXN0ZXJwKSB7Ci0JY29uc3QgY2hhciAqbXVwZGF0ZV9zZXJ2ZXIg
PSBjb25maWdfZ2V0c3RyaW5nKCJtdXBkYXRlX3NlcnZlciIsIE5VTEwpOwotCWlmKCFtdXBkYXRl
X3NlcnZlcikKKwlpZighY29uZmlnX211cGRhdGVfc2VydmVyKQogCSAgICBmYXRhbCgibXVwZGF0
ZSBzZXJ2ZXIgd2FzIG5vdCBzcGVjaWZpZWQgZm9yIHNsYXZlIiwgRUNfVEVNUEZBSUwpOwotCXNu
cHJpbnRmKHNsYXZlYnVmLCBzaXplb2Yoc2xhdmVidWYpLCAibXVwZGF0ZTovLyVzIiwgbXVwZGF0
ZV9zZXJ2ZXIpOworCisJc25wcmludGYoc2xhdmVidWYsIHNpemVvZihzbGF2ZWJ1ZiksICJtdXBk
YXRlOi8vJXMiLAorCQkgY29uZmlnX211cGRhdGVfc2VydmVyKTsKICAgICB9CiAJCQogICAgIHBy
b3RfcHJpbnRmKGMtPnBvdXQsCkBAIC02OTksNyArNjg3LDcgQEAKICAgICBzdHJ1Y3Qgc29ja2Fk
ZHJfaW4gbG9jYWxhZGRyLCByZW1vdGVhZGRyOwogICAgIGludCBoYXZlYWRkciA9IDA7CiAgICAg
aW50IHNhbGVuOwotICAgIGludCBzZWNmbGFncywgcGxhaW50ZXh0X3Jlc3VsdDsKKyAgICBpbnQg
c2VjZmxhZ3M7CiAgICAgc2FzbF9zZWN1cml0eV9wcm9wZXJ0aWVzX3QgKnNlY3Byb3BzID0gTlVM
TDsKICAgICBjaGFyIGxvY2FsaXBbNjBdLCByZW1vdGVpcFs2MF07CiAgICAgY2hhciBjbGllbnRo
b3N0WzI1MF07CkBAIC03NjIsOCArNzUwLDcgQEAKIAogICAgIC8qIHNldCBteSBhbGxvd2FibGUg
c2VjdXJpdHkgcHJvcGVydGllcyAqLwogICAgIHNlY2ZsYWdzID0gU0FTTF9TRUNfTk9BTk9OWU1P
VVM7Ci0gICAgcGxhaW50ZXh0X3Jlc3VsdCA9IGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50
ZXh0IiwxKTsKLSAgICBpZiAoIWNvbmZpZ19nZXRzd2l0Y2goIm11cGRhdGVfYWxsb3dwbGFpbnRl
eHQiLCBwbGFpbnRleHRfcmVzdWx0KSkgeworICAgIGlmICghY29uZmlnX2dldHN3aXRjaChJTUFQ
T1BUX0FMTE9XUExBSU5URVhUKSkgewogCXNlY2ZsYWdzIHw9IFNBU0xfU0VDX05PUExBSU5URVhU
OwogICAgIH0KICAgICBzZWNwcm9wcyA9IG15c2FzbF9zZWNwcm9wcyhzZWNmbGFncyk7CkBAIC0x
MjU1LDcgKzEyNDIsNyBAQAogLyogUmVzZXQgdGhlIGdpdmVuIHNhc2xfY29ubl90IHRvIGEgc2Fu
ZSBzdGF0ZSAqLwogc3RhdGljIGludCByZXNldF9zYXNsY29ubihzdHJ1Y3QgY29ubiAqYykKIHsK
LSAgICBpbnQgcmV0LCBzZWNmbGFncywgcGxhaW50ZXh0X3Jlc3VsdDsKKyAgICBpbnQgcmV0LCBz
ZWNmbGFnczsKICAgICBzYXNsX3NlY3VyaXR5X3Byb3BlcnRpZXNfdCAqc2VjcHJvcHMgPSBOVUxM
OwogCiAgICAgc2FzbF9kaXNwb3NlKCZjLT5zYXNsY29ubik7CkBAIC0xMjc2LDggKzEyNjMsNyBA
QAogICAgIGlmKHJldCAhPSBTQVNMX09LKSByZXR1cm4gcmV0OwogICAgIAogICAgIHNlY2ZsYWdz
ID0gU0FTTF9TRUNfTk9BTk9OWU1PVVM7Ci0gICAgcGxhaW50ZXh0X3Jlc3VsdCA9IGNvbmZpZ19n
ZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0IiwxKTsKLSAgICBpZiAoIWNvbmZpZ19nZXRzd2l0Y2go
Im11cGRhdGVfYWxsb3dwbGFpbnRleHQiLCBwbGFpbnRleHRfcmVzdWx0KSkgeworICAgIGlmICgh
Y29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhUKSkgewogCXNlY2ZsYWdzIHw9
IFNBU0xfU0VDX05PUExBSU5URVhUOwogICAgIH0KICAgICBzZWNwcm9wcyA9IG15c2FzbF9zZWNw
cm9wcyhzZWNmbGFncyk7CkluZGV4OiBpbWFwL25vdGlmeS5jCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6
IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9ub3RpZnkuYyx2
CnJldHJpZXZpbmcgcmV2aXNpb24gMS42CmRpZmYgLXUgLXIxLjYgbm90aWZ5LmMKLS0tIG5vdGlm
eS5jCTIwMDIvMDUvMDcgMTg6NTA6MjEJMS42CisrKyBub3RpZnkuYwkyMDAyLzA2LzE4IDIwOjM5
OjQwCkBAIC05MywxMyArOTMsMTMgQEAKIAogICAgIHNvYyA9IHNvY2tldChBRl9VTklYLCBTT0NL
X0RHUkFNLCAwKTsKICAgICBpZiAoc29jID09IC0xKSB7Ci0Jc3lzbG9nKExPR19FUlIsICJ1bmFi
bGUgdG8gb3BlbiBub3RpZnkgc29ja2V0KCk6ICVtIik7CisJc3lzbG9nKExPR19FUlIsICJ1bmFi
bGUgdG8gY3JlYXRlIG5vdGlmeSBzb2NrZXQoKTogJW0iKTsKIAlyZXR1cm47CiAgICAgfQogCiAg
ICAgbWVtc2V0KChjaGFyICopJnN1bl9kYXRhLCAwLCBzaXplb2Yoc3VuX2RhdGEpKTsKICAgICBz
dW5fZGF0YS5zdW5fZmFtaWx5ID0gQUZfVU5JWDsKLSAgICBub3RpZnlfc29jayA9IGNvbmZpZ19n
ZXRzdHJpbmcoIm5vdGlmeXNvY2tldCIsIE5VTEwpOworICAgIG5vdGlmeV9zb2NrID0gY29uZmln
X2dldHN0cmluZyhJTUFQT1BUX05PVElGWVNPQ0tFVCk7CiAgICAgaWYgKG5vdGlmeV9zb2NrKSB7
CQogCXN0cmNweShzdW5fZGF0YS5zdW5fcGF0aCwgbm90aWZ5X3NvY2spOwogICAgIH0KSW5kZXg6
IGltYXAvcG9wM2QuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5
c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvcG9wM2QuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4x
MjIKZGlmZiAtdSAtcjEuMTIyIHBvcDNkLmMKLS0tIHBvcDNkLmMJMjAwMi8wNi8wMyAxODoyMjoy
NwkxLjEyMgorKysgcG9wM2QuYwkyMDAyLzA2LzE4IDIzOjM3OjA3CkBAIC0xODksNyArMTg5LDcg
QEAKICAgICAvKiBjaGVjayBpZiByZW1vdGUgcmVhbG0gKi8KICAgICBpZiAoKHJlYWxtID0gc3Ry
Y2hyKGF1dGhfaWRlbnRpdHksICdAJykpIT1OVUxMKSB7CiAJcmVhbG0rKzsKLQl2YWwgPSBjb25m
aWdfZ2V0c3RyaW5nKCJsb2dpbnJlYWxtcyIsICIiKTsKKwl2YWwgPSBjb25maWdfZ2V0c3RyaW5n
KElNQVBPUFRfTE9HSU5SRUFMTVMpOwogCXdoaWxlICgqdmFsKSB7CiAJICAgIGlmICghc3RybmNh
c2VjbXAodmFsLCByZWFsbSwgc3RybGVuKHJlYWxtKSkgJiYKIAkJKCF2YWxbc3RybGVuKHJlYWxt
KV0gfHwgaXNzcGFjZSgoaW50KSB2YWxbc3RybGVuKHJlYWxtKV0pKSkgewpAQCAtMjA5LDEzICsy
MDksMTMgQEAKICAgICBhdXRoc3RhdGUgPSBhdXRoX25ld3N0YXRlKGF1dGhfaWRlbnRpdHksIE5V
TEwpOwogCiAgICAgLyogb2ssIGlzIGF1dGhfaWRlbnRpdHkgYW4gYWRtaW4/ICovCi0gICAgdXNl
cmlzYWRtaW4gPSBhdXRoaXNhKGF1dGhzdGF0ZSwgImltYXAiLCAiYWRtaW5zIik7CisgICAgdXNl
cmlzYWRtaW4gPSBjb25maWdfYXV0aGlzYShhdXRoc3RhdGUsIElNQVBPUFRfQURNSU5TKTsKIAog
ICAgIGlmIChhbGVuICE9IHJsZW4gfHwgc3RybmNtcChhdXRoX2lkZW50aXR5LCByZXF1ZXN0ZWRf
dXNlciwgYWxlbikpIHsKIAkvKiB3ZSB3YW50IHRvIGF1dGhlbnRpY2F0ZSBhcyBhIGRpZmZlcmVu
dCB1c2VyOyB3ZSdsbCBhbGxvdyB0aGlzCiAJICAgaWYgd2UncmUgYW4gYWRtaW4gb3IgaWYgd2Un
dmUgYWxsb3dlZCBBQ0wgcHJveHkgbG9naW5zICovCiAJaWYgKHVzZXJpc2FkbWluIHx8Ci0JICAg
IGF1dGhpc2EoYXV0aHN0YXRlLCAiaW1hcCIsICJwcm94eXNlcnZlcnMiKSkgeworCSAgICBjb25m
aWdfYXV0aGlzYShhdXRoc3RhdGUsIElNQVBPUFRfUFJPWFlTRVJWRVJTKSkgewogCiAJICAgIC8q
IHByb3h5IG9rISAqLwogCSAgICBhdXRoX2ZyZWVzdGF0ZShhdXRoc3RhdGUpOwpAQCAtMzEyLDcg
KzMxMiw2IEBACiAgICAgaW50IHI7CiAgICAgaW50IG9wdDsKIAotICAgIGNvbmZpZ19jaGFuZ2Vp
ZGVudCgicG9wM2QiKTsKICAgICBpZiAoZ2V0ZXVpZCgpID09IDApIGZhdGFsKCJtdXN0IHJ1biBh
cyB0aGUgQ3lydXMgdXNlciIsIEVDX1VTQUdFKTsKICAgICBzZXRwcm9jdGl0bGVfaW5pdChhcmdj
LCBhcmd2LCBlbnZwKTsKIApAQCAtMzU1LDcgKzM1NCw3IEBACiAgCSAgICBicmVhazsKIAljYXNl
ICdzJzogLyogcG9wM3MgKGRvIHN0YXJ0dGxzIHJpZ2h0IGF3YXkpICovCiAJICAgIHBvcDNzID0g
MTsKLQkgICAgaWYgKCF0bHNfZW5hYmxlZCgicG9wMyIpKSB7CisJICAgIGlmICghdGxzX2VuYWJs
ZWQoKSkgewogCQlzeXNsb2coTE9HX0VSUiwgInBvcDNzOiByZXF1aXJlZCBPcGVuU1NMIG9wdGlv
bnMgbm90IHByZXNlbnQiKTsKIAkJZmF0YWwoInBvcDNzOiByZXF1aXJlZCBPcGVuU1NMIG9wdGlv
bnMgbm90IHByZXNlbnQiLAogCQkgICAgICBFQ19DT05GSUcpOwpAQCAtNDM0LDcgKzQzMyw3IEBA
CiAgICAgcHJvY19yZWdpc3RlcigicG9wM2QiLCBwb3BkX2NsaWVudGhvc3QsIE5VTEwsIE5VTEwp
OwogCiAgICAgLyogU2V0IGluYWN0aXZpdHkgdGltZXIgKi8KLSAgICB0aW1lb3V0ID0gY29uZmln
X2dldGludCgicG9wdGltZW91dCIsIDEwKTsKKyAgICB0aW1lb3V0ID0gY29uZmlnX2dldGludChJ
TUFQT1BUX1BPUFRJTUVPVVQpOwogICAgIGlmICh0aW1lb3V0IDwgMTApIHRpbWVvdXQgPSAxMDsK
ICAgICBwcm90X3NldHRpbWVvdXQocG9wZF9pbiwgdGltZW91dCo2MCk7CiAgICAgcHJvdF9zZXRm
bHVzaG9ucmVhZChwb3BkX2luLCBwb3BkX291dCk7CkBAIC01NDUsNyArNTQ0LDcgQEAKIAlmYXRh
bCgiQ2Fubm90IGdldCBjbGllbnQncyBJUCBhZGRyZXNzIiwgRUNfT1NFUlIpOwogICAgIH0KIAot
ICAgIHNydnRhYiA9IGNvbmZpZ19nZXRzdHJpbmcoInNydnRhYiIsICIiKTsKKyAgICBzcnZ0YWIg
PSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU1JWVEFCKTsKIAogICAgIHN0cmNweShpbnN0YW5j
ZSwgIioiKTsKICAgICByID0ga3JiX3JlY3ZhdXRoKDBMLCAwLCAmdGlja2V0LCAicG9wIiwgaW5z
dGFuY2UsCkBAIC02NTEsNyArNjUwLDcgQEAKIAkJY21kX2NhcGEoKTsKIAkgICAgfQogCX0KLQll
bHNlIGlmICghc3RyY21wKGlucHV0YnVmLCAic3RscyIpICYmIHRsc19lbmFibGVkKCJwb3AzIikp
IHsKKwllbHNlIGlmICghc3RyY21wKGlucHV0YnVmLCAic3RscyIpICYmIHRsc19lbmFibGVkKCkp
IHsKIAkgICAgaWYgKGFyZykgewogCQlwcm90X3ByaW50Zihwb3BkX291dCwKIAkJCSAgICAiLUVS
UiBTVExTIGRvZXNuJ3QgdGFrZSBhbnkgYXJndW1lbnRzXHJcbiIpOwpAQCAtMTAzNiw3ICsxMDM1
LDcgQEAKIAogICAgIC8qIHBvc3NpYmx5IGRpc2FsbG93IFVTRVIgKi8KICAgICBpZiAoIShrZmxh
ZyB8fCBwb3BkX3N0YXJ0dGxzX2RvbmUgfHwKLQkgIGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxh
aW50ZXh0IiwgMSkpKSB7CisJICBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dQTEFJTlRF
WFQpKSkgewogCXByb3RfcHJpbnRmKHBvcGRfb3V0LAogCQkgICAgIi1FUlIgW0FVVEhdIFVTRVIg
Y29tbWFuZCBvbmx5IGF2YWlsYWJsZSB1bmRlciBhIGxheWVyXHJcbiIpOwogCXJldHVybjsKQEAg
LTExMDcsNyArMTEwNiw3IEBACiAjZW5kaWYKIAogICAgIGlmICghc3RyY21wKHBvcGRfdXNlcmlk
LCAiYW5vbnltb3VzIikpIHsKLQlpZiAoY29uZmlnX2dldHN3aXRjaCgiYWxsb3dhbm9ueW1vdXNs
b2dpbiIsIDApKSB7CisJaWYgKGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV0FOT05ZTU9V
U0xPR0lOKSkgewogCSAgICBwYXNzID0gYmVhdXRpZnlfc3RyaW5nKHBhc3MpOwogCSAgICBpZiAo
c3RybGVuKHBhc3MpID4gNTAwKSBwYXNzWzUwMF0gPSAnXDAnOwogCSAgICBzeXNsb2coTE9HX05P
VElDRSwgImxvZ2luOiAlcyBhbm9ueW1vdXMgJXMiLApAQCAtMTE0MSw3ICsxMTQwLDggQEAKIAkg
ICAgICAgcG9wZF91c2VyaWQsIHBvcGRfc3RhcnR0bHNfZG9uZSA/ICIrVExTIiA6ICIiLCAKIAkg
ICAgICAgcmVwbHkgPyByZXBseSA6ICIiKTsKIAotCWlmICgocGxhaW50ZXh0bG9naW5wYXVzZSA9
IGNvbmZpZ19nZXRpbnQoInBsYWludGV4dGxvZ2lucGF1c2UiLCAwKSkhPTApIHsKKwlpZiAoKHBs
YWludGV4dGxvZ2lucGF1c2UgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfUExBSU5URVhUTE9HSU5Q
QVVTRSkpCisJICAgICAhPSAwKSB7CiAJICAgIHNsZWVwKHBsYWludGV4dGxvZ2lucGF1c2UpOwog
CX0KICAgICB9CkBAIC0xMTUzLDggKzExNTMsOCBAQAogdm9pZAogY21kX2NhcGEoKQogewotICAg
IGludCBtaW5wb2xsID0gY29uZmlnX2dldGludCgicG9wbWlucG9sbCIsIDApICogNjA7Ci0gICAg
aW50IGV4cGlyZSA9IGNvbmZpZ19nZXRpbnQoInBvcGV4cGlyZXRpbWUiLCAtMSk7CisgICAgaW50
IG1pbnBvbGwgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfUE9QTUlOUE9MTCkgKiA2MDsKKyAgICBp
bnQgZXhwaXJlID0gY29uZmlnX2dldGludChJTUFQT1BUX1BPUEVYUElSRVRJTUUpOwogICAgIHVu
c2lnbmVkIG1lY2hjb3VudDsKICAgICBjb25zdCBjaGFyICptZWNobGlzdDsKIApAQCAtMTE2OSw3
ICsxMTY5LDcgQEAKIAlwcm90X3dyaXRlKHBvcGRfb3V0LCBtZWNobGlzdCwgc3RybGVuKG1lY2hs
aXN0KSk7CiAgICAgfQogCi0gICAgaWYgKHRsc19lbmFibGVkKCJwb3AzIikpIHsKKyAgICBpZiAo
dGxzX2VuYWJsZWQoKSkgewogCXByb3RfcHJpbnRmKHBvcGRfb3V0LCAiU1RMU1xyXG4iKTsKICAg
ICB9CiAgICAgaWYgKGV4cGlyZSA8IDApIHsKQEAgLTExODUsNyArMTE4NSw4IEBACiAgICAgcHJv
dF9wcmludGYocG9wZF9vdXQsICJSRVNQLUNPREVTXHJcbiIpOwogICAgIHByb3RfcHJpbnRmKHBv
cGRfb3V0LCAiQVVUSC1SRVNQLUNPREVcclxuIik7CiAKLSAgICBpZiAoa2ZsYWcgfHwgcG9wZF9z
dGFydHRsc19kb25lIHx8IGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0IiwgMSkpIHsK
KyAgICBpZihrZmxhZyB8fCBwb3BkX3N0YXJ0dGxzX2RvbmUKKyAgICB8fCBjb25maWdfZ2V0c3dp
dGNoKElNQVBPUFRfQUxMT1dQTEFJTlRFWFQpKSB7CiAJcHJvdF9wcmludGYocG9wZF9vdXQsICJV
U0VSXHJcbiIpOwogICAgIH0KICAgICAKQEAgLTEzODIsNyArMTM4Myw3IEBACiAJcmV0dXJuIDE7
CiAgICAgfQogCi0gICAgaWYgKChtaW5wb2xsID0gY29uZmlnX2dldGludCgicG9wbWlucG9sbCIs
IDApKSAmJgorICAgIGlmICgobWlucG9sbCA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9QT1BNSU5Q
T0xMKSkgJiYKIAltYm94c3RydWN0LnBvcDNfbGFzdF9sb2dpbiArIDYwKm1pbnBvbGwgPiBwb3Bk
X2xvZ2luX3RpbWUpIHsKIAlwcm90X3ByaW50Zihwb3BkX291dCwKIAkgICAgIi1FUlIgW0xPR0lO
LURFTEFZXSBMb2dpbnMgbXVzdCBiZSBhdCBsZWFzdCAlZCBtaW51dGUlcyBhcGFydFxyXG4iLApJ
bmRleDogaW1hcC9wb3AzcHJveHlkLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcu
Y211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL3BvcDNwcm94eWQuYyx2CnJldHJpZXZp
bmcgcmV2aXNpb24gMS40MgpkaWZmIC11IC1yMS40MiBwb3AzcHJveHlkLmMKLS0tIHBvcDNwcm94
eWQuYwkyMDAyLzA2LzEyIDIwOjAwOjEyCTEuNDIKKysrIHBvcDNwcm94eWQuYwkyMDAyLzA2LzE5
IDAwOjAxOjQ4CkBAIC0xNzMsNyArMTczLDcgQEAKICAgICAvKiBjaGVjayBpZiByZW1vdGUgcmVh
bG0gKi8KICAgICBpZiAoKHJlYWxtID0gc3RyY2hyKGF1dGhfaWRlbnRpdHksICdAJykpIT1OVUxM
KSB7CiAJcmVhbG0rKzsKLQl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJlYWxtcyIsICIi
KTsKKwl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMpOwogCXdoaWxl
ICgqdmFsKSB7CiAJICAgIGlmICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3RybGVuKHJlYWxt
KSkgJiYKIAkJKCF2YWxbc3RybGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2YWxbc3RybGVu
KHJlYWxtKV0pKSkgewpAQCAtMTkzLDEzICsxOTMsMTMgQEAKICAgICBhdXRoc3RhdGUgPSBhdXRo
X25ld3N0YXRlKGF1dGhfaWRlbnRpdHksIE5VTEwpOwogCiAgICAgLyogb2ssIGlzIGF1dGhfaWRl
bnRpdHkgYW4gYWRtaW4/ICovCi0gICAgdXNlcmlzYWRtaW4gPSBhdXRoaXNhKGF1dGhzdGF0ZSwg
ImltYXAiLCAiYWRtaW5zIik7CisgICAgdXNlcmlzYWRtaW4gPSBjb25maWdfYXV0aGlzYShhdXRo
c3RhdGUsIElNQVBPUFRfQURNSU5TKTsKIAogICAgIGlmIChhbGVuICE9IHJsZW4gfHwgc3RybmNt
cChhdXRoX2lkZW50aXR5LCByZXF1ZXN0ZWRfdXNlciwgYWxlbikpIHsKIAkvKiB3ZSB3YW50IHRv
IGF1dGhlbnRpY2F0ZSBhcyBhIGRpZmZlcmVudCB1c2VyOyB3ZSdsbCBhbGxvdyB0aGlzCiAJICAg
aWYgd2UncmUgYW4gYWRtaW4gb3IgaWYgd2UndmUgYWxsb3dlZCBBQ0wgcHJveHkgbG9naW5zICov
CiAJaWYgKHVzZXJpc2FkbWluIHx8Ci0JICAgIGF1dGhpc2EoYXV0aHN0YXRlLCAiaW1hcCIsICJw
cm94eXNlcnZlcnMiKSkgeworCSAgICBjb25maWdfYXV0aGlzYShhdXRoc3RhdGUsIElNQVBPUFRf
QURNSU5TKSkgewogCiAJICAgIC8qIHByb3h5IG9rISAqLwogCSAgICBhdXRoX2ZyZWVzdGF0ZShh
dXRoc3RhdGUpOwpAQCAtMjMxLDcgKzIzMSw2IEBACiB7CiAgICAgaW50IHI7CiAKLSAgICBjb25m
aWdfY2hhbmdlaWRlbnQoInBvcDNkIik7CiAgICAgaWYgKGdldGV1aWQoKSA9PSAwKSBmYXRhbCgi
bXVzdCBydW4gYXMgdGhlIEN5cnVzIHVzZXIiLCBFQ19VU0FHRSk7CiAgICAgc2V0cHJvY3RpdGxl
X2luaXQoYXJnYywgYXJndiwgZW52cCk7CiAKQEAgLTI5Miw3ICsyOTEsNyBAQAogIAkgICAgYnJl
YWs7CiAJY2FzZSAncyc6IC8qIHBvcDNzIChkbyBzdGFydHRscyByaWdodCBhd2F5KSAqLwogCSAg
ICBwb3AzcyA9IDE7Ci0JICAgIGlmICghdGxzX2VuYWJsZWQoInBvcDMiKSkgeworCSAgICBpZiAo
IXRsc19lbmFibGVkKCkpIHsKIAkJc3lzbG9nKExPR19FUlIsICJwb3AzczogcmVxdWlyZWQgT3Bl
blNTTCBvcHRpb25zIG5vdCBwcmVzZW50Iik7CiAJCWZhdGFsKCJwb3AzczogcmVxdWlyZWQgT3Bl
blNTTCBvcHRpb25zIG5vdCBwcmVzZW50IiwKIAkJICAgICAgRUNfQ09ORklHKTsKQEAgLTM0OSw3
ICszNDgsNyBAQAogICAgIHByb2NfcmVnaXN0ZXIoInBvcDNkIiwgcG9wZF9jbGllbnRob3N0LCBO
VUxMLCBOVUxMKTsKIAogICAgIC8qIFNldCBpbmFjdGl2aXR5IHRpbWVyICovCi0gICAgdGltZW91
dCA9IGNvbmZpZ19nZXRpbnQoInBvcHRpbWVvdXQiLCAxMCk7CisgICAgdGltZW91dCA9IGNvbmZp
Z19nZXRpbnQoSU1BUE9QVF9QT1BUSU1FT1VUKTsKICAgICBpZiAodGltZW91dCA8IDEwKSB0aW1l
b3V0ID0gMTA7CiAgICAgcHJvdF9zZXR0aW1lb3V0KHBvcGRfaW4sIHRpbWVvdXQqNjApOwogICAg
IHByb3Rfc2V0Zmx1c2hvbnJlYWQocG9wZF9pbiwgcG9wZF9vdXQpOwpAQCAtNDgxLDcgKzQ4MCw3
IEBACiAJZmF0YWwoIkNhbm5vdCBnZXQgY2xpZW50J3MgSVAgYWRkcmVzcyIsIEVDX09TRVJSKTsK
ICAgICB9CiAKLSAgICBzcnZ0YWIgPSBjb25maWdfZ2V0c3RyaW5nKCJzcnZ0YWIiLCAiIik7Cisg
ICAgc3J2dGFiID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NSVlRBQik7CiAKICAgICBzdHJj
cHkoaW5zdGFuY2UsICIqIik7CiAgICAgciA9IGtyYl9yZWN2YXV0aCgwTCwgMCwgJnRpY2tldCwg
InBvcCIsIGluc3RhbmNlLApAQCAtNTk4LDcgKzU5Nyw3IEBACiAJZWxzZSBpZiAoIXN0cmNtcChp
bnB1dGJ1ZiwgImF1dGgiKSkgewogCSAgICBjbWRfYXV0aChhcmcpOwogCX0KLQllbHNlIGlmICgh
c3RyY21wKGlucHV0YnVmLCAic3RscyIpICYmIHRsc19lbmFibGVkKCJwb3AzIikpIHsKKwllbHNl
IGlmICghc3RyY21wKGlucHV0YnVmLCAic3RscyIpICYmIHRsc19lbmFibGVkKCkpIHsKIAkgICAg
aWYgKGFyZykgewogCQlwcm90X3ByaW50Zihwb3BkX291dCwKIAkJCSAgICAiLUVSUiBTVExTIGRv
ZXNuJ3QgdGFrZSBhbnkgYXJndWVtZW50c1xyXG4iKTsKQEAgLTYxNSw3ICs2MTQsNiBAQAogI2lm
ZGVmIEhBVkVfU1NMCiBzdGF0aWMgdm9pZCBjbWRfc3RhcnR0bHMoaW50IHBvcDNzKQogewotICAg
IGNoYXIgKnRsc19jZXJ0LCAqdGxzX2tleTsKICAgICBpbnQgcmVzdWx0OwogICAgIGludCAqbGF5
ZXJwOwogICAgIGNoYXIgKmF1dGhfaWQ7CkBAIC02MzEsMTEgKzYyOSw2IEBACiAJcmV0dXJuOwog
ICAgIH0KIAotICAgIHRsc19jZXJ0ID0gKGNoYXIgKiljb25maWdfZ2V0c3RyaW5nKCJ0bHNfcG9w
M19jZXJ0X2ZpbGUiLAotCQkJCQljb25maWdfZ2V0c3RyaW5nKCJ0bHNfY2VydF9maWxlIiwgIiIp
KTsKLSAgICB0bHNfa2V5ID0gKGNoYXIgKiljb25maWdfZ2V0c3RyaW5nKCJ0bHNfcG9wM19rZXlf
ZmlsZSIsCi0JCQkJICAgICAgIGNvbmZpZ19nZXRzdHJpbmcoInRsc19rZXlfZmlsZSIsICIiKSk7
Ci0KICAgICByZXN1bHQ9dGxzX2luaXRfc2VydmVyZW5naW5lKCJwb3AzIiwKIAkJCQkgNSwgICAg
ICAgIC8qIGRlcHRoIHRvIHZlcmlmeSAqLwogCQkJCSAhcG9wM3MsICAgLyogY2FuIGNsaWVudCBh
dXRoPyAqLwpAQCAtODA0LDcgKzc5Nyw3IEBACiAKICAgICAvKiBwb3NzaWJseSBkaXNhbGxvdyBV
U0VSICovCiAgICAgaWYgKCEoa2ZsYWcgfHwgcG9wZF9zdGFydHRsc19kb25lIHx8Ci0JICBjb25m
aWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsIDEpKSkgeworCSAgY29uZmlnX2dldHN3aXRj
aChJTUFQT1BUX0FMTE9XUExBSU5URVhUKSkpIHsKIAlwcm90X3ByaW50Zihwb3BkX291dCwKIAkJ
ICAgICItRVJSIFtBVVRIXSBVU0VSIGNvbW1hbmQgb25seSBhdmFpbGFibGUgdW5kZXIgYSBsYXll
clxyXG4iKTsKIAlyZXR1cm47CkBAIC04NjQsNyArODU3LDcgQEAKICNlbmRpZgogCiAgICAgaWYg
KCFzdHJjbXAocG9wZF91c2VyaWQsICJhbm9ueW1vdXMiKSkgewotCWlmIChjb25maWdfZ2V0c3dp
dGNoKCJhbGxvd2Fub255bW91c2xvZ2luIiwgMCkpIHsKKwlpZiAoY29uZmlnX2dldHN3aXRjaChJ
TUFQT1BUX0FMTE9XQU5PTllNT1VTTE9HSU4pKSB7CiAJICAgIHBhc3MgPSBiZWF1dGlmeV9zdHJp
bmcocGFzcyk7CiAJICAgIGlmIChzdHJsZW4ocGFzcykgPiA1MDApIHBhc3NbNTAwXSA9ICdcMCc7
CiAJICAgIHN5c2xvZyhMT0dfTk9USUNFLCAibG9naW46ICVzIGFub255bW91cyAlcyIsCkBAIC04
OTgsNyArODkxLDcgQEAKIAkgICAgICAgcG9wZF91c2VyaWQsIHBvcGRfc3RhcnR0bHNfZG9uZSA/
ICIrVExTIiA6ICIiLCAKIAkgICAgICAgcmVwbHkgPyByZXBseSA6ICIiKTsKIAotCXBsYWludGV4
dGxvZ2lucGF1c2UgPSBjb25maWdfZ2V0aW50KCJwbGFpbnRleHRsb2dpbnBhdXNlIiwgMCk7CisJ
cGxhaW50ZXh0bG9naW5wYXVzZSA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9QTEFJTlRFWFRMT0dJ
TlBBVVNFKTsKIAlpZiAocGxhaW50ZXh0bG9naW5wYXVzZSkgc2xlZXAocGxhaW50ZXh0bG9naW5w
YXVzZSk7CiAgICAgfQogCkBAIC05MTEsOCArOTA0LDggQEAKIHZvaWQKIGNtZF9jYXBhKCkKIHsK
LSAgICBpbnQgbWlucG9sbCA9IGNvbmZpZ19nZXRpbnQoInBvcG1pbnBvbGwiLCAwKSAqIDYwOwot
ICAgIGludCBleHBpcmUgPSBjb25maWdfZ2V0aW50KCJwb3BleHBpcmV0aW1lIiwgLTEpOworICAg
IGludCBtaW5wb2xsID0gY29uZmlnX2dldGludChJTUFQT1BUX1BPUE1JTlBPTEwpICogNjA7Cisg
ICAgaW50IGV4cGlyZSA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9QT1BFWFBJUkVUSU1FKTsKICAg
ICB1bnNpZ25lZCBtZWNoY291bnQ7CiAgICAgY29uc3QgY2hhciAqbWVjaGxpc3Q7CiAKQEAgLTky
Nyw3ICs5MjAsNyBAQAogCXByb3Rfd3JpdGUocG9wZF9vdXQsIG1lY2hsaXN0LCBzdHJsZW4obWVj
aGxpc3QpKTsKICAgICB9CiAKLSAgICBpZiAodGxzX2VuYWJsZWQoInBvcDMiKSkgeworICAgIGlm
ICh0bHNfZW5hYmxlZCgpKSB7CiAJcHJvdF9wcmludGYocG9wZF9vdXQsICJTVExTXHJcbiIpOwog
ICAgIH0KICAgICBpZiAoZXhwaXJlIDwgMCkgewpAQCAtOTQzLDcgKzkzNiw3IEBACiAgICAgcHJv
dF9wcmludGYocG9wZF9vdXQsICJSRVNQLUNPREVTXHJcbiIpOwogICAgIHByb3RfcHJpbnRmKHBv
cGRfb3V0LCAiQVVUSC1SRVNQLUNPREVcclxuIik7CiAKLSAgICBpZiAoa2ZsYWcgfHwgcG9wZF9z
dGFydHRsc19kb25lIHx8IGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0IiwgMSkpIHsK
KyAgICBpZiAoa2ZsYWcgfHwgcG9wZF9zdGFydHRsc19kb25lIHx8IGNvbmZpZ19nZXRzd2l0Y2go
SU1BUE9QVF9BTExPV1BMQUlOVEVYVCkpIHsKIAlwcm90X3ByaW50Zihwb3BkX291dCwgIlVTRVJc
clxuIik7CiAgICAgfQogICAgIApAQCAtMTE0OCw2ICsxMTQxLDUyIEBACiAJCQkJCSBjb25zdCBj
aGFyICpwYXNzd29yZCk7CiBleHRlcm4gdm9pZCBmcmVlX2NhbGxiYWNrcyhzYXNsX2NhbGxiYWNr
X3QgKmluKTsKIAorc3RhdGljIGNoYXIgKnBhcnNlbWVjaGxpc3QoY2hhciAqc3RyKQoreworICBj
aGFyICp0bXA7CisgIGNoYXIgKnJldD1tYWxsb2Moc3RybGVuKHN0cikrMSk7CisgIGlmIChyZXQ9
PU5VTEwpIHJldHVybiBOVUxMOworCisgIHN0cmNweShyZXQsIiIpOworCisgIGlmICgodG1wPXN0
cnN0cihzdHIsIlNBU0wgIikpIT1OVUxMKQorICB7CisgICAgY2hhciAqZW5kPXRtcCs1OworICAg
IHRtcCs9NTsKKworICAgIHdoaWxlKCgoKmVuZCkhPSdcbicpICYmICgoKmVuZCkhPSdcMCcpKQor
ICAgICAgZW5kKys7CisKKyAgICAoKmVuZCk9J1wwJzsKKworICAgIHN0cmNweShyZXQsIHRtcCk7
CisgIH0KKworICByZXR1cm4gcmV0OworfQorCitzdGF0aWMgY2hhciAqYXNrX2NhcGFiaWxpdHko
c3RydWN0IHByb3RzdHJlYW0gKnBvdXQsIHN0cnVjdCBwcm90c3RyZWFtICpwaW4pCit7CisgIGNo
YXIgc3RyWzEwMjRdOworICBjaGFyICpyZXQgPSBOVUxMOworCisgIC8qIHJlcXVlc3QgY2FwYWJp
bGl0aWVzIG9mIHNlcnZlciAqLworICBwcm90X3ByaW50Zihwb3V0LCAiQ0FQQVxyXG4iKTsKKyAg
cHJvdF9mbHVzaChwb3V0KTsKKworICBkbyB7CisgICAgICBpZiAocHJvdF9mZ2V0cyhzdHIsc2l6
ZW9mKHN0cikscGluKSA9PSBOVUxMKSB7CisJICByZXR1cm4gTlVMTDsKKyAgICAgIH0KKyAgICAg
IHByaW50ZigiUzogJXMiLCBzdHIpOworICAgICAgaWYgKCFzdHJuY2FzZWNtcChzdHIsIlNBU0wg
Iiw1KSkgeworCSAgcmV0PXBhcnNlbWVjaGxpc3Qoc3RyKTsKKyAgICAgIH0KKyAgfSB3aGlsZSAo
c3RybmNhc2VjbXAoc3RyLCAiLiIsIDEpKTsKKworICByZXR1cm4gcmV0OworfQorCiBzdGF0aWMg
aW50IHByb3h5X2F1dGhlbnRpY2F0ZShjb25zdCBjaGFyICpob3N0bmFtZSkKIHsKICAgICBpbnQg
cjsKQEAgLTExNjEsNyArMTIwMCw4IEBACiAgICAgY2hhciAqaW4sICpwOwogICAgIGNvbnN0IGNo
YXIgKm91dDsKICAgICB1bnNpZ25lZCBpbnQgaW5sZW4sIG91dGxlbjsKLSAgICBjb25zdCBjaGFy
ICptZWNodXNpbmc7CisgICAgY29uc3QgY2hhciAqbWVjaF9jb25mLCAqbWVjaHVzaW5nOworICAg
IGNoYXIgKm1lY2hsaXN0OwogICAgIHVuc2lnbmVkIGI2NGxlbjsKICAgICBjaGFyIGxvY2FsaXBb
NjBdLCByZW1vdGVpcFs2MF07CiAgICAgY29uc3QgY2hhciAqcGFzczsKQEAgLTExNzAsMTAgKzEy
MTAsMTEgQEAKICAgICBwID0gc3RyY2hyKG9wdHN0ciwgJy4nKTsKICAgICBpZiAocCkgKnAgPSAn
XDAnOwogICAgIHN0cmNhdChvcHRzdHIsICJfcGFzc3dvcmQiKTsKLSAgICBwYXNzID0gY29uZmln
X2dldHN0cmluZyhvcHRzdHIsIE5VTEwpOworICAgIHBhc3MgPSBjb25maWdfZ2V0b3ZlcmZsb3dz
dHJpbmcob3B0c3RyLCBOVUxMKTsKKyAgICBpZighcGFzcykgcGFzcyA9IGNvbmZpZ19nZXRzdHJp
bmcoSU1BUE9QVF9QUk9YWV9QQVNTV09SRCk7CiAgICAgY2IgPSBteXNhc2xfY2FsbGJhY2tzKHBv
cGRfdXNlcmlkLCAKLQkJCSAgY29uZmlnX2dldHN0cmluZygicHJveHlfYXV0aG5hbWUiLCAicHJv
eHkiKSwKLQkJCSAgY29uZmlnX2dldHN0cmluZygicHJveHlfcmVhbG0iLCBOVUxMKSwKKwkJCSAg
Y29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1BST1hZX0FVVEhOQU1FKSwKKwkJCSAgY29uZmlnX2dl
dHN0cmluZyhJTUFQT1BUX1BST1hZX1JFQUxNKSwKIAkJCSAgcGFzcyk7CiAKICAgICByID0gc2Fz
bF9jbGllbnRfbmV3KCJwb3AiLCBob3N0bmFtZSwgTlVMTCwgTlVMTCwKQEAgLTEyMTMsMTUgKzEy
NTQsMzAgQEAKIAlyZXR1cm4gU0FTTF9GQUlMOwogICAgIH0KIAorICAgIC8qIEdldCBTQVNMIG1l
Y2hhbmlzbSBsaXN0ICovCisgICAgLyogV2UgY2FuIGZvcmNlIGEgcGFydGljdWxhciBtZWNoYW5p
c20gdXNpbmcgYSA8c2hvcnRob3N0Pl9tZWNocyBvcHRpb24gKi8KICAgICBzdHJjcHkoYnVmLCBo
b3N0bmFtZSk7CiAgICAgcCA9IHN0cmNocihidWYsICcuJyk7CiAgICAgKnAgPSAnXDAnOwogICAg
IHN0cmNhdChidWYsICJfbWVjaHMiKTsKKyAgICBtZWNoX2NvbmYgPSBjb25maWdfZ2V0b3ZlcmZs
b3dzdHJpbmcoYnVmLCBOVUxMKTsKKyAgICAKKyAgICAvKiBJZiB3ZSBkb24ndCBoYXZlIGEgbWVj
aF9jb25mLCBhc2sgdGhlIHNlcnZlciB3aGF0IGl0IGNhbiBkbyAqLworICAgIGlmKCFtZWNoX2Nv
bmYpIHsKKwltZWNobGlzdCA9IGFza19jYXBhYmlsaXR5KGJhY2tlbmRfb3V0LCBiYWNrZW5kX2lu
KTsKKyAgICB9IGVsc2UgeworCW1lY2hsaXN0ID0geHN0cmR1cChtZWNoX2NvbmYpOworICAgIH0K
IAogICAgIC8qIHdlIG5vdyBkbyB0aGUgYWN0dWFsIFNBU0wgZXhjaGFuZ2UgKi8KICAgICByID0g
c2FzbF9jbGllbnRfc3RhcnQoYmFja2VuZF9zYXNsY29ubiwgCi0JCQkgIGNvbmZpZ19nZXRzdHJp
bmcoYnVmLCAiS0VSQkVST1NfVjQiKSwKKwkJCSAgbWVjaGxpc3QsCiAJCQkgIE5VTEwsICZvdXQs
ICZvdXRsZW4sICZtZWNodXNpbmcpOworCisgICAgLyogZ2FyYmFnZSBjb2xsZWN0ICovCisgICAg
ZnJlZShtZWNobGlzdCk7CisgICAgbWVjaGxpc3QgPSBOVUxMOworCiAgICAgaWYgKChyICE9IFNB
U0xfT0spICYmIChyICE9IFNBU0xfQ09OVElOVUUpKSB7CiAJcmV0dXJuIHI7CiAgICAgfQpJbmRl
eDogaW1hcC9wcm94eWQuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1
L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvcHJveHlkLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuMTI5CmRpZmYgLXUgLXIxLjEyOSBwcm94eWQuYwotLS0gcHJveHlkLmMJMjAwMi8wNi8xNCAx
ODoxODozNAkxLjEyOQorKysgcHJveHlkLmMJMjAwMi8wNi8xOCAyMzo0Njo0NApAQCAtNjQxLDcg
KzY0MSw3IEBACiAJCSAgICAgaW50IGZvcl9maW5kKSAKIHsKICAgICBpbnQgdGFnbGVuID0gc3Ry
bGVuKHRhZyk7Ci0gICAgaW50IGksYzsKKyAgICBpbnQgYzsKICAgICBpbnQgciA9IFBST1hZX09L
OwogICAgIGludCBleGlzdF9yOwogICAgIGNoYXIgbWFpbGJveG5hbWVbTUFYX01BSUxCT1hfUEFU
SCArIDFdOwpAQCAtMTA3MSw3ICsxMDcxLDcgQEAKICAgICAvKiBjaGVjayBpZiByZW1vdGUgcmVh
bG0gKi8KICAgICBpZiAoKHJlYWxtID0gc3RyY2hyKGF1dGhfaWRlbnRpdHksICdAJykpIT1OVUxM
KSB7CiAJcmVhbG0rKzsKLQl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJlYWxtcyIsICIi
KTsKKwl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMpOwogCXdoaWxl
ICgqdmFsKSB7CiAJICAgIGlmICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3RybGVuKHJlYWxt
KSkgJiYKIAkJKCF2YWxbc3RybGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2YWxbc3RybGVu
KHJlYWxtKV0pKSkgewpAQCAtMTA5MSwxNiArMTA5MSwxNiBAQAogICAgIHByb3h5ZF9hdXRoc3Rh
dGUgPSBhdXRoX25ld3N0YXRlKGF1dGhfaWRlbnRpdHksIE5VTEwpOwogCiAgICAgLyogb2ssIGlz
IGF1dGhfaWRlbnRpdHkgYW4gYWRtaW4/ICovCi0gICAgcHJveHlkX3VzZXJpc2FkbWluID0gYXV0
aGlzYShwcm94eWRfYXV0aHN0YXRlLCAiaW1hcCIsICJhZG1pbnMiKTsKKyAgICBwcm94eWRfdXNl
cmlzYWRtaW4gPSBjb25maWdfYXV0aGlzYShwcm94eWRfYXV0aHN0YXRlLCBJTUFQT1BUX0FETUlO
Uyk7CiAKICAgICBpZiAoc3RyY21wKGF1dGhfaWRlbnRpdHksIHJlcXVlc3RlZF91c2VyKSkgewog
CS8qIHdlIHdhbnQgdG8gYXV0aGVudGljYXRlIGFzIGEgZGlmZmVyZW50IHVzZXI7IHdlJ2xsIGFs
bG93IHRoaXMKIAkgICBpZiB3ZSdyZSBhbiBhZG1pbiBvciBpZiB3ZSd2ZSBhbGxvd2VkIEFDTCBw
cm94eSBsb2dpbnMgKi8KLQlpbnQgdXNlX2FjbCA9IGNvbmZpZ19nZXRzd2l0Y2goImxvZ2ludXNl
YWNsIiwgMCk7CisJaW50IHVzZV9hY2wgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfTE9HSU5V
U0VBQ0wpOwogCiAJaWYgKHByb3h5ZF91c2VyaXNhZG1pbiB8fAogCSAgICAodXNlX2FjbCAmJiBh
Y2xfb2socmVxdWVzdGVkX3VzZXIsIGF1dGhfaWRlbnRpdHkpKSB8fAotCSAgICBhdXRoaXNhKHBy
b3h5ZF9hdXRoc3RhdGUsICJpbWFwIiwgInByb3h5c2VydmVycyIpKSB7CisJICAgIGNvbmZpZ19h
dXRoaXNhKHByb3h5ZF9hdXRoc3RhdGUsIElNQVBPUFRfUFJPWFlTRVJWRVJTKSkgewogCSAgICAv
KiBwcm94eSBvayEgKi8KIAogCSAgICBwcm94eWRfdXNlcmlzYWRtaW4gPSAwOwkvKiBubyBsb25n
ZXIgYWRtaW4gKi8KQEAgLTExNDAsNyArMTE0MCw2IEBACiAgICAgaW50IG9wdDsKICAgICBpbnQg
cjsKIAotICAgIGNvbmZpZ19jaGFuZ2VpZGVudCgicHJveHlkIik7CiAgICAgaWYgKGdldGV1aWQo
KSA9PSAwKSBmYXRhbCgibXVzdCBydW4gYXMgdGhlIEN5cnVzIHVzZXIiLCBFQ19VU0FHRSk7CiAg
ICAgc2V0cHJvY3RpdGxlX2luaXQoYXJnYywgYXJndiwgZW52cCk7CiAKQEAgLTExODAsNyArMTE3
OSw3IEBACiAgCSAgICBicmVhazsKIAljYXNlICdzJzogLyogaW1hcHMgKGRvIHN0YXJ0dGxzIHJp
Z2h0IGF3YXkpICovCiAJICAgIGltYXBzID0gMTsKLQkgICAgaWYgKCF0bHNfZW5hYmxlZCgiaW1h
cCIpKSB7CisJICAgIGlmICghdGxzX2VuYWJsZWQoKSkgewogCQlzeXNsb2coTE9HX0VSUiwgImlt
YXBzOiByZXF1aXJlZCBPcGVuU1NMIG9wdGlvbnMgbm90IHByZXNlbnQiKTsKIAkJZmF0YWwoImlt
YXBzOiByZXF1aXJlZCBPcGVuU1NMIG9wdGlvbnMgbm90IHByZXNlbnQiLAogCQkgICAgICBFQ19D
T05GSUcpOwpAQCAtMTM0OSw3ICsxMzQ4LDcgQEAKICAgICBwcm9jX3JlZ2lzdGVyKCJwcm94eWQi
LCBwcm94eWRfY2xpZW50aG9zdCwgKGNoYXIgKikwLCAoY2hhciAqKTApOwogCiAgICAgLyogU2V0
IGluYWN0aXZpdHkgdGltZXIgKi8KLSAgICB0aW1lb3V0ID0gY29uZmlnX2dldGludCgidGltZW91
dCIsIDMwKTsKKyAgICB0aW1lb3V0ID0gY29uZmlnX2dldGludChJTUFQT1BUX1RJTUVPVVQpOwog
ICAgIGlmICh0aW1lb3V0IDwgMzApIHRpbWVvdXQgPSAzMDsKICAgICBwcm90X3NldHRpbWVvdXQo
cHJveHlkX2luLCB0aW1lb3V0KjYwKTsKICAgICBwcm90X3NldGZsdXNob25yZWFkKHByb3h5ZF9p
biwgcHJveHlkX291dCk7CkBAIC0xOTI4LDcgKzE5MjcsNyBAQAogCSAgICAKIAljYXNlICdTJzoK
IAkgICAgaWYgKCFzdHJjbXAoY21kLnMsICJTdGFydHRscyIpKSB7Ci0JCWlmICghdGxzX2VuYWJs
ZWQoImltYXAiKSkgeworCQlpZiAoIXRsc19lbmFibGVkKCkpIHsKIAkJICAgIC8qIHdlIGRvbid0
IHN1cHBvcnQgc3RhcnR0bHMgKi8KIAkJICAgIGdvdG8gYmFkY21kOwogCQl9CkBAIC0yMjA0LDcg
KzIyMDMsNyBAQAogCiAgICAgLyogcG9zc2libHkgZGlzYWxsb3cgbG9naW4gKi8KICAgICBpZiAo
KHByb3h5ZF9zdGFydHRsc19kb25lID09IDApICYmCi0JKGNvbmZpZ19nZXRzd2l0Y2goImFsbG93
cGxhaW50ZXh0IiwgMSkgPT0gMCkgJiYKKwkoY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9X
UExBSU5URVhUKSA9PSAwKSAmJgogCXN0cmNtcChjYW5vbl91c2VyLCAiYW5vbnltb3VzIikgIT0g
MCkgewogCWVhdGxpbmUocHJveHlkX2luLCAnICcpOwogCXByb3RfcHJpbnRmKHByb3h5ZF9vdXQs
ICIlcyBOTyBMb2dpbiBvbmx5IGF2YWlsYWJsZSB1bmRlciBhIGxheWVyXHJcbiIsCkBAIC0yMjI4
LDcgKzIyMjcsNyBAQAogICAgIHBhc3N3ZCA9IHBhc3N3ZGJ1Zi5zOwogCiAgICAgaWYgKCFzdHJj
bXAoY2Fub25fdXNlciwgImFub255bW91cyIpKSB7Ci0JaWYgKGNvbmZpZ19nZXRzd2l0Y2goImFs
bG93YW5vbnltb3VzbG9naW4iLCAwKSkgeworCWlmIChjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRf
QUxMT1dBTk9OWU1PVVNMT0dJTikpIHsKIAkgICAgcGFzc3dkID0gYmVhdXRpZnlfc3RyaW5nKHBh
c3N3ZCk7CiAJICAgIGlmIChzdHJsZW4ocGFzc3dkKSA+IDUwMCkgcGFzc3dkWzUwMF0gPSAnXDAn
OwogCSAgICBzeXNsb2coTE9HX05PVElDRSwgImxvZ2luOiAlcyBhbm9ueW1vdXMgJXMiLApAQCAt
MjI3NCw3ICsyMjczLDcgQEAKIAkgICAgICAgY2Fub25fdXNlciwgcHJveHlkX3N0YXJ0dGxzX2Rv
bmUgPyAiK1RMUyIgOiAiIiwgCiAJICAgICAgIHJlcGx5ID8gcmVwbHkgOiAiIik7CiAKLQlwbGFp
bnRleHRsb2dpbnBhdXNlID0gY29uZmlnX2dldGludCgicGxhaW50ZXh0bG9naW5wYXVzZSIsIDAp
OworCXBsYWludGV4dGxvZ2lucGF1c2UgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfUExBSU5URVhU
TE9HSU5QQVVTRSk7CiAJaWYgKHBsYWludGV4dGxvZ2lucGF1c2UpIHsKIAogCSAgICAvKiBBcHBs
eSBwZW5hbHR5IG9ubHkgaWYgbm90IHVuZGVyIGxheWVyICovCkBAIC0yMjg2LDcgKzIyODUsNyBA
QAogCiAgICAgcHJveHlkX2F1dGhzdGF0ZSA9IGF1dGhfbmV3c3RhdGUoY2Fub25fdXNlciwgKGNo
YXIgKikwKTsKIAotICAgIHZhbCA9IGNvbmZpZ19nZXRzdHJpbmcoImFkbWlucyIsICIiKTsKKyAg
ICB2YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQURNSU5TKTsKICAgICB3aGlsZSAoKnZh
bCkgewogCWZvciAocCA9IChjaGFyICopdmFsOyAqcCAmJiAhaXNzcGFjZSgoaW50KSAqcCk7IHAr
Kyk7CiAJc3RybGNweShidWYsIHZhbCwgcCAtIHZhbCk7CkBAIC0yNjE4LDcgKzI2MTcsNyBAQAog
CiAgICAgLyogc3BpdCBvdXQgb3VyIElEIHN0cmluZy4KICAgICAgICBldmVudHVhbGx5IHRoaXMg
bWlnaHQgYmUgY29uZmlndXJhYmxlLiAqLwotICAgIGlmIChjb25maWdfZ2V0c3dpdGNoKCJpbWFw
aWRyZXNwb25zZSIsIDEpKSB7CisgICAgaWYgKGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9JTUFQ
SURSRVNQT05TRSkpIHsKIAlpZF9yZXNwb25zZShwcm94eWRfb3V0KTsKIAogCS8qIGFkZCBpbmZv
IGFib3V0IHRoZSBiYWNrZW5kICovCkBAIC0yNjgyLDcgKzI2ODEsNyBAQAogCiAgICAgLyogZ2V0
IHBvbGxpbmcgcGVyaW9kICovCiAgICAgaWYgKGlkbGVfcGVyaW9kID09IC0xKSB7Ci0gICAgICBp
ZGxlX3BlcmlvZCA9IGNvbmZpZ19nZXRpbnQoImltYXBpZGxlcG9sbCIsIDYwKTsKKyAgICAgIGlk
bGVfcGVyaW9kID0gY29uZmlnX2dldGludChJTUFQT1BUX0lNQVBJRExFUE9MTCkpOwogICAgICAg
aWYgKGlkbGVfcGVyaW9kIDwgMSkgaWRsZV9wZXJpb2QgPSAxOwogICAgIH0KIApAQCAtMjg4NCwx
MCArMjg4MywxMCBAQAogICAgIHByb3RfcHJpbnRmKHByb3h5ZF9vdXQsICIgSURMRSIpOwogI2Vu
ZGlmCiAKLSAgICBpZiAodGxzX2VuYWJsZWQoImltYXAiKSkgeworICAgIGlmICh0bHNfZW5hYmxl
ZCgpKSB7CiAJcHJvdF9wcmludGYocHJveHlkX291dCwgIiBTVEFSVFRMUyIpOwogICAgIH0KLSAg
ICBpZiAoIXByb3h5ZF9zdGFydHRsc19kb25lICYmICFjb25maWdfZ2V0c3dpdGNoKCJhbGxvd3Bs
YWludGV4dCIsIDEpKSB7CisgICAgaWYgKCFwcm94eWRfc3RhcnR0bHNfZG9uZSAmJiAhY29uZmln
X2dldHN3aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhUKSkgewogCXByb3RfcHJpbnRmKHByb3h5
ZF9vdXQsICIgTE9HSU5ESVNBQkxFRCIpOwkKICAgICB9CiAKQEAgLTM5NTAsNyArMzk0OSw3IEBA
CiAgICAgLyogSWdub3JlIHRoZSByZWZlcmVuY2UgYXJndW1lbnQ/CiAgICAgICAgKHRoZSBiZWhh
dmlvciBpbiAxLjUuMTAgJiBvbGRlcikgKi8KICAgICBpZiAoaWdub3JlcmVmZXJlbmNlID09IC0x
KSB7Ci0JaWdub3JlcmVmZXJlbmNlID0gY29uZmlnX2dldHN3aXRjaCgiaWdub3JlcmVmZXJlbmNl
IiwgMCk7CisJaWdub3JlcmVmZXJlbmNlID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0lHTk9S
RVJFRkVSRU5DRSk7CiAgICAgfQogCiAgICAgLyogUmVzZXQgc3RhdGUgaW4gbXN0cmluZ2RhdGEg
Ki8KQEAgLTQ2MzYsNyArNDYzNSw3IEBACiAKICAgICBpZiAoIXIpIHIgPSBtbG9va3VwKG1haWxi
b3huYW1lLCAmc2VydmVyLCBOVUxMLCBOVUxMKTsKICAgICBpZiAoIXIgJiYgc3VwcG9ydHNfcmVm
ZXJyYWxzCi0JJiYgY29uZmlnX2dldHN3aXRjaCgicHJveHlkX2FsbG93X3N0YXR1c19yZWZlcnJh
bCIsMCkpIHsgCisJJiYgY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX1BST1hZRF9BTExPV19TVEFU
VVNfUkVGRVJSQUwpKSB7IAogCXByb3h5ZF9yZWZlcih0YWcsIHNlcnZlciwgbWFpbGJveG5hbWUp
OwogCS8qIEVhdCB0aGUgYXJndW1lbnQgKi8KIAllYXRsaW5lKHByb3h5ZF9pbiwgcHJvdF9nZXRj
KHByb3h5ZF9pbikpOwpAQCAtNDY4MSw4ICs0NjgwLDcgQEAKICAgICBjb25zdCBjaGFyICp1cmw7
CiAgICAgLyogc28gdGVtcHRpbmcsIGFuZCB5ZXQgLi4uICovCiAgICAgLyogdXJsID0gImh0dHA6
Ly9yYW5kb20ueWFob28uY29tL3J5bC8iOyAqLwotICAgIHVybCA9IGNvbmZpZ19nZXRzdHJpbmco
Im5ldHNjYXBldXJsIiwKLQkJCSAgICJodHRwOi8vYW5kcmV3Mi5hbmRyZXcuY211LmVkdS9jeXJ1
cy9pbWFwZC9uZXRzY2FwZS1hZG1pbi5odG1sIik7CisgICAgdXJsID0gY29uZmlnX2dldHN0cmlu
ZyhJTUFQT1BUX05FVFNDQVBFVVJMKTsKIAogICAgIC8qIEkgb25seSBrbm93IG9mIHRocmVlIHRo
aW5ncyB0byByZXBseSB3aXRoOiAqLwogICAgIHByb3RfcHJpbnRmKHByb3h5ZF9vdXQsCkluZGV4
OiBpbWFwL3Rscy5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lz
dGVtL2N2cy9zcmMvY3lydXMvaW1hcC90bHMuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zOApk
aWZmIC11IC1yMS4zOCB0bHMuYwotLS0gdGxzLmMJMjAwMi8wNi8wMyAxNjo1OTo1NwkxLjM4Cisr
KyB0bHMuYwkyMDAyLzA2LzE4IDIwOjU0OjM2CkBAIC0xNDgsMTkgKzE0OCwxNCBAQAogc3RhdGlj
IGludCBkb19kdW1wID0gMDsJCS8qIGFjdGl2ZWx5IGR1bXBpbmcgcHJvdG9jb2w/ICovCiAKIAot
aW50IHRsc19lbmFibGVkKGNvbnN0IGNoYXIgKmlkZW50KQoraW50IHRsc19lbmFibGVkKHZvaWQp
CiB7Ci0gICAgY2hhciBidWZbNTBdOwogICAgIGNvbnN0IGNoYXIgKnZhbDsKIAotICAgIHNwcmlu
dGYoYnVmLCAidGxzXyVzX2NlcnRfZmlsZSIsIGlkZW50KTsKLSAgICB2YWwgPSBjb25maWdfZ2V0
c3RyaW5nKGJ1ZiwKLQkJCSAgIGNvbmZpZ19nZXRzdHJpbmcoInRsc19jZXJ0X2ZpbGUiLCBOVUxM
KSk7CisgICAgdmFsID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1RMU19DRVJUX0ZJTEUpOwog
ICAgIGlmICghdmFsIHx8ICFzdHJjYXNlY21wKHZhbCwgImRpc2FibGVkIikpIHJldHVybiAwOwog
Ci0gICAgc3ByaW50ZihidWYsICJ0bHNfJXNfa2V5X2ZpbGUiLCBpZGVudCk7Ci0gICAgdmFsID0g
Y29uZmlnX2dldHN0cmluZyhidWYsCi0JCQkgICBjb25maWdfZ2V0c3RyaW5nKCJ0bHNfa2V5X2Zp
bGUiLCBOVUxMKSk7CisgICAgdmFsID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1RMU19LRVlf
RklMRSk7CiAgICAgaWYgKCF2YWwgfHwgIXN0cmNhc2VjbXAodmFsLCAiZGlzYWJsZWQiKSkgcmV0
dXJuIDA7CiAKICAgICByZXR1cm4gMTsKQEAgLTIwOSw3ICsyMDQsOSBAQAogCiAvKiB0YWtlbiBm
cm9tIE9wZW5TU0wgYXBwcy9zX2NiLmMgKi8KIAotc3RhdGljIFJTQSAqdG1wX3JzYV9jYihTU0wg
KiBzLCBpbnQgZXhwb3J0LCBpbnQga2V5bGVuZ3RoKQorc3RhdGljIFJTQSAqdG1wX3JzYV9jYihT
U0wgKiBzIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAorCQkgICAgICAgaW50IGV4cG9ydCBfX2F0
dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKwkJICAgICAgIGludCBrZXlsZW5ndGgpCiB7CiAgICAgc3Rh
dGljIFJTQSAqcnNhX3RtcCA9IE5VTEw7CiAKQEAgLTM4Myw3ICszODAsOCBAQAogICogbmVnb3Rp
YXRlZCBhbmQgc2Vzc2lvbiBjYWNoaW5nIGlzIGVuYWJsZWQuICBXZSBzYXZlIHRoZSBzZXNzaW9u
IGluCiAgKiBhIGRhdGFiYXNlIHNvIHRoYXQgd2UgY2FuIHNoYXJlIHNlc3Npb25zIGJldHdlZW4g
cHJvY2Vzc2VzLiAKICAqLyAKLXN0YXRpYyBpbnQgbmV3X3Nlc3Npb25fY2IoU1NMICpzc2wsIFNT
TF9TRVNTSU9OICpzZXNzKQorc3RhdGljIGludCBuZXdfc2Vzc2lvbl9jYihTU0wgKnNzbCBfX2F0
dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKwkJCSAgU1NMX1NFU1NJT04gKnNlc3MpCiB7CiAgICAgaW50
IGxlbjsKICAgICB1bnNpZ25lZCBjaGFyICpkYXRhID0gTlVMTCwgKmFzbjsKQEAgLTQ3MSw3ICs0
NjksOCBAQAogICogcmVtb3ZlZCBiZWNhdXNlIGl0IGlzIGV4cGlyZWQgb3Igd2hlbiBhIGNvbm5l
Y3Rpb24gd2FzIG5vdCBzaHV0ZG93bgogICogY2xlYW5seS4KICAqLwotc3RhdGljIHZvaWQgcmVt
b3ZlX3Nlc3Npb25fY2IoU1NMX0NUWCAqY3R4LCBTU0xfU0VTU0lPTiAqc2VzcykKK3N0YXRpYyB2
b2lkIHJlbW92ZV9zZXNzaW9uX2NiKFNTTF9DVFggKmN0eCBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQp
KSwKKwkJCSAgICAgIFNTTF9TRVNTSU9OICpzZXNzKQogewogICAgIGFzc2VydChzZXNzKTsKIApA
QCAtNDg0LDcgKzQ4Myw4IEBACiAgKiBjYWxsZWQsIGFsc28gd2hlbiBzZXNzaW9uIGNhY2hpbmcg
d2FzIGRpc2FibGVkLiAgV2UgbG9va3VwIHRoZQogICogc2Vzc2lvbiBpbiBvdXIgZGF0YWJhc2Ug
aW4gY2FzZSBpdCB3YXMgc3RvcmVkIGJ5IGFub3RoZXIgcHJvY2Vzcy4KICAqLwotc3RhdGljIFNT
TF9TRVNTSU9OICpnZXRfc2Vzc2lvbl9jYihTU0wgKnNzbCwgdW5zaWduZWQgY2hhciAqaWQsIGlu
dCBpZGxlbiwKK3N0YXRpYyBTU0xfU0VTU0lPTiAqZ2V0X3Nlc3Npb25fY2IoU1NMICpzc2wgX19h
dHRyaWJ1dGVfXygodW51c2VkKSksCisJCQkJICAgdW5zaWduZWQgY2hhciAqaWQsIGludCBpZGxl
biwKIAkJCQkgICBpbnQgKmNvcHkpCiB7CiAgICAgaW50IHJldDsKQEAgLTU2Niw3ICs1NjYsNiBA
QAogewogICAgIGludCAgICAgb2ZmID0gMDsKICAgICBpbnQgICAgIHZlcmlmeV9mbGFncyA9IFNT
TF9WRVJJRllfTk9ORTsKLSAgICBjaGFyICAgIGJ1Zls1MF07CiAgICAgY29uc3QgY2hhciAgICpj
aXBoZXJfbGlzdDsKICAgICBjb25zdCBjaGFyICAgKkNBcGF0aDsKICAgICBjb25zdCBjaGFyICAg
KkNBZmlsZTsKQEAgLTYxOCw3ICs2MTcsNyBAQAogCQkJCSAgIFNTTF9TRVNTX0NBQ0hFX05PX0lO
VEVSTkFMX0xPT0tVUCk7CiAKICAgICAvKiBHZXQgdGhlIHNlc3Npb24gdGltZW91dCBmcm9tIHRo
ZSBjb25maWcgZmlsZSAoaW4gbWludXRlcykgKi8KLSAgICB0aW1lb3V0ID0gY29uZmlnX2dldGlu
dCgidGxzX3Nlc3Npb25fdGltZW91dCIsIDE0NDApOyAvKiAyNCBob3VycyAqLworICAgIHRpbWVv
dXQgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfVExTX1NFU1NJT05fVElNRU9VVCk7CiAgICAgaWYg
KHRpbWVvdXQgPCAwKSB0aW1lb3V0ID0gMDsKICAgICBpZiAodGltZW91dCA+IDE0NDApIHRpbWVv
dXQgPSAxNDQwOyAvKiAyNCBob3VycyBtYXggKi8KIApAQCAtNjQ0LDggKzY0Myw3IEBACiAJciA9
IERCLT5pbml0KGRiZGlyLCAwKTsKIAogCWlmIChyICE9IDApCi0JICAgIHN5c2xvZyhMT0dfRVJS
LCAiREJFUlJPUjogaW5pdCAlczogJXMiLCBidWYsCi0JCSAgIGN5cnVzZGJfc3RyZXJyb3Iocikp
OworCSAgICBzeXNsb2coTE9HX0VSUiwgIkRCRVJST1I6IGluaXQ6ICVzIiwgY3lydXNkYl9zdHJl
cnJvcihyKSk7CiAJZWxzZSB7CiAJICAgIC8qIGNyZWF0ZSB0aGUgbmFtZSBvZiB0aGUgZGIgZmls
ZSAqLwogCSAgICBzdHJjcHkoZGJkaXIsIGNvbmZpZ19kaXIpOwpAQCAtNjYxLDE1ICs2NTksMTUg
QEAKIAl9CiAgICAgfQogCi0gICAgY2lwaGVyX2xpc3QgPSBjb25maWdfZ2V0c3RyaW5nKCJ0bHNf
Y2lwaGVyX2xpc3QiLCAiREVGQVVMVCIpOworICAgIGNpcGhlcl9saXN0ID0gY29uZmlnX2dldHN0
cmluZyhJTUFQT1BUX1RMU19DSVBIRVJfTElTVCk7CiAgICAgaWYgKCFTU0xfQ1RYX3NldF9jaXBo
ZXJfbGlzdChjdHgsIGNpcGhlcl9saXN0KSkgewogCXN5c2xvZyhMT0dfRVJSLCJUTFMgZW5naW5l
OiBjYW5ub3QgbG9hZCBjaXBoZXIgbGlzdCAnJXMnIiwKIAkgICAgICAgY2lwaGVyX2xpc3QpOwog
CXJldHVybiAoLTEpOwogICAgIH0KIAotICAgIENBZmlsZSA9IGNvbmZpZ19nZXRzdHJpbmcoInRs
c19jYV9maWxlIiwgTlVMTCk7Ci0gICAgQ0FwYXRoID0gY29uZmlnX2dldHN0cmluZygidGxzX2Nh
X3BhdGgiLCBOVUxMKTsKKyAgICBDQWZpbGUgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfVExT
X0NBX0ZJTEUpOworICAgIENBcGF0aCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9UTFNfQ0Ff
UEFUSCk7CiAKICAgICBpZiAoKCFTU0xfQ1RYX2xvYWRfdmVyaWZ5X2xvY2F0aW9ucyhjdHgsIENB
ZmlsZSwgQ0FwYXRoKSkgfHwKIAkoIVNTTF9DVFhfc2V0X2RlZmF1bHRfdmVyaWZ5X3BhdGhzKGN0
eCkpKSB7CkBAIC02NzcsMTMgKzY3NSw4IEBACiAJc3lzbG9nKExPR19OT1RJQ0UsIlRMUyBlbmdp
bmU6IGNhbm5vdCBsb2FkIENBIGRhdGEiKTsJCiAgICAgfQogCi0gICAgc3ByaW50ZihidWYsICJ0
bHNfJXNfY2VydF9maWxlIiwgaWRlbnQpOwotICAgIHNfY2VydF9maWxlID0gY29uZmlnX2dldHN0
cmluZyhidWYsCi0JCQkJICAgY29uZmlnX2dldHN0cmluZygidGxzX2NlcnRfZmlsZSIsIE5VTEwp
KTsKLQotICAgIHNwcmludGYoYnVmLCAidGxzXyVzX2tleV9maWxlIiwgaWRlbnQpOwotICAgIHNf
a2V5X2ZpbGUgPSBjb25maWdfZ2V0c3RyaW5nKGJ1ZiwKLQkJCQkgIGNvbmZpZ19nZXRzdHJpbmco
InRsc19rZXlfZmlsZSIsIE5VTEwpKTsKKyAgICBzX2NlcnRfZmlsZSA9IGNvbmZpZ19nZXRzdHJp
bmcoSU1BUE9QVF9UTFNfQ0VSVF9GSUxFKTsKKyAgICBzX2tleV9maWxlID0gY29uZmlnX2dldHN0
cmluZyhJTUFQT1BUX1RMU19LRVlfRklMRSk7CiAKICAgICBpZiAoIXNldF9jZXJ0X3N0dWZmKGN0
eCwgc19jZXJ0X2ZpbGUsIHNfa2V5X2ZpbGUpKSB7CiAJc3lzbG9nKExPR19FUlIsIlRMUyBlbmdp
bmU6IGNhbm5vdCBsb2FkIGNlcnQva2V5IGRhdGEiKTsKQEAgLTY5NSw5ICs2ODgsNyBAQAogICAg
IGlmIChhc2tjZXJ0IT0wKQogCXZlcmlmeV9mbGFncyB8PSBTU0xfVkVSSUZZX1BFRVIgfCBTU0xf
VkVSSUZZX0NMSUVOVF9PTkNFOwogCi0gICAgc3ByaW50ZihidWYsICJ0bHNfJXNfcmVxdWlyZV9j
ZXJ0IiwgaWRlbnQpOwotICAgIHJlcXVpcmVjZXJ0ID0gY29uZmlnX2dldHN3aXRjaChidWYsCi0J
CQkJICAgY29uZmlnX2dldHN3aXRjaCgidGxzX3JlcXVpcmVfY2VydCIsIDApKTsKKyAgICByZXF1
aXJlY2VydCA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9UTFNfUkVRVUlSRV9DRVJUKTsKICAg
ICBpZiAocmVxdWlyZWNlcnQpCiAJdmVyaWZ5X2ZsYWdzIHw9IFNTTF9WRVJJRllfUEVFUiB8IFNT
TF9WRVJJRllfRkFJTF9JRl9OT19QRUVSX0NFUlQKIAkgICAgfCBTU0xfVkVSSUZZX0NMSUVOVF9P
TkNFOwpAQCAtMTA2MSw3ICsxMDUyLDcgQEAKIAogI2Vsc2UKIAotaW50IHRsc19lbmFibGVkKGNv
bnN0IGNoYXIgKmlkZW50KQoraW50IHRsc19lbmFibGVkKHZvaWQpCiB7CiAgICAgcmV0dXJuIDA7
CiB9CkluZGV4OiBpbWFwL3Rscy5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNt
dS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC90bHMuaCx2CnJldHJpZXZpbmcgcmV2aXNp
b24gMS4xNQpkaWZmIC11IC1yMS4xNSB0bHMuaAotLS0gdGxzLmgJMjAwMi8wNi8wMiAxNToyNTo0
MwkxLjE1CisrKyB0bHMuaAkyMDAyLzA2LzE4IDIwOjExOjI0CkBAIC00OSw3ICs0OSw3IEBACiAj
ZGVmaW5lIElOQ0xVREVEX1RMU19ICiAKIC8qIGlzIHRscyBlbmFibGVkPyAqLwotaW50IHRsc19l
bmFibGVkKGNvbnN0IGNoYXIgKmlkZW50KTsKK2ludCB0bHNfZW5hYmxlZCh2b2lkKTsKIAogLyog
bmFtZSBvZiB0aGUgU1NML1RMUyBzZXNzaW9ucyBkYXRhYmFzZSAqLwogI2RlZmluZSBGTkFNRV9U
TFNTRVNTSU9OUyAiL3Rsc19zZXNzaW9ucy5kYiIKSW5kZXg6IGltYXAvdXNlci5jCj09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1h
cC91c2VyLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTAKZGlmZiAtdSAtcjEuMTAgdXNlci5j
Ci0tLSB1c2VyLmMJMjAwMi8wNS8yMyAyMToxMjozOQkxLjEwCisrKyB1c2VyLmMJMjAwMi8wNi8x
OCAyMDozOTowNApAQCAtMTIxLDEwICsxMjEsMTAgQEAKICAgICBzdHJ1Y3QgZGlyZW50ICpuZXh0
ID0gTlVMTDsKICAgICAKICAgICAvKiBvaCB3ZWxsICovCi0gICAgaWYoY29uZmlnX2dldHN3aXRj
aCgic2lldmV1c2Vob21lZGlyIiwgMCkpIHJldHVybiAwOworICAgIGlmKGNvbmZpZ19nZXRzd2l0
Y2goSU1BUE9QVF9TSUVWRVVTRUhPTUVESVIpKSByZXR1cm4gMDsKICAgICAKICAgICBzbnByaW50
ZihzaWV2ZV9wYXRoLCBzaXplb2Yoc2lldmVfcGF0aCksICIlcy8lYy8lcyIsCi0JICAgICBjb25m
aWdfZ2V0c3RyaW5nKCJzaWV2ZWRpciIsICIvdXNyL3NpZXZlIiksCisJICAgICBjb25maWdfZ2V0
c3RyaW5nKElNQVBPUFRfU0lFVkVESVIpLAogCSAgICAgdXNlclswXSwgdXNlcik7CiAgICAgbWJk
aXI9b3BlbmRpcihzaWV2ZV9wYXRoKTsKIApJbmRleDogbWFuL01ha2VmaWxlLmluCj09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvbWFu
L01ha2VmaWxlLmluLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjI1CmRpZmYgLXUgLXIxLjI1IE1h
a2VmaWxlLmluCi0tLSBNYWtlZmlsZS5pbgkyMDAyLzA1LzI1IDE5OjU3OjQ3CTEuMjUKKysrIE1h
a2VmaWxlLmluCTIwMDIvMDYvMTcgMjA6MDI6NTcKQEAgLTgyLDYgKzgyLDkgQEAKIAlAZWNobyBj
cmVhdGluZyBzaWV2ZXNoZWxsLjEKIAlwb2QybWFuICQoc3JjZGlyKS8uLi9wZXJsL3NpZXZlL3Nj
cmlwdHMvc2lldmVzaGVsbC5wbCA+ICQoc3JjZGlyKS9zaWV2ZXNoZWxsLjEKIAoraW1hcGQuY29u
Zi41OiAkKHNyY2RpcikvLi4vaW1hcC9pbWFwb3B0aW9ucyAkKHNyY2RpcikvLi4vdG9vbHMvY29u
ZmlnMmhlYWRlcgorCSQoc3JjZGlyKS8uLi90b29scy9jb25maWcybWFuICQoc3JjZGlyKS8uLi9p
bWFwL2ltYXBvcHRpb25zID4gaW1hcGQuY29uZi41CisKIGluc3RhbGw6CiAJZm9yIGZpbGUgaW4g
JChNQU4xKTsgXAogCWRvIFwKSW5kZXg6IG1hbi9pbWFwZC5jb25mLjUKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9tYW4vaW1hcGQu
Y29uZi41LHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjY1CmRpZmYgLXUgLXIxLjY1IGltYXBkLmNv
bmYuNQotLS0gaW1hcGQuY29uZi41CTIwMDIvMDYvMTIgMTc6Mzg6NTgJMS42NQorKysgaW1hcGQu
Y29uZi41CTIwMDIvMDYvMTkgMDA6MDc6NTUKQEAgLTEsNCArMSw2IEBACiAuXCIgLSotIG5yb2Zm
IC0qLQorLlwiIGF1dG8tZ2VuZXJhdGVkIGJ5IGNvbmZpZzJtYW4gJFJldmlzaW9uCisuXCIgLSot
IG5yb2ZmIC0qLQogLlRIIElNQVBELkNPTkYgNSAiUHJvamVjdCBDeXJ1cyIgQ01VCiAuXCIgCiAu
XCIgQ29weXJpZ2h0IChjKSAxOTk4LTIwMDAgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkuICBB
bGwgcmlnaHRzIHJlc2VydmVkLgpAQCAtNDAsNyArNDIsNiBAQAogLlwiIE9VVCBPRiBPUiBJTiBD
T05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUiBQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLgog
LlwiIAogLlwiICRJZDogaW1hcGQuY29uZi41LHYgMS42NSAyMDAyLzA2LzEyIDE3OjM4OjU4IHJq
czMgRXhwICQKLQogLlNIIE5BTUUKIGltYXBkLmNvbmYgXC0gSU1BUCBjb25maWd1cmF0aW9uIGZp
bGUKIC5TSCBERVNDUklQVElPTgpAQCAtNjcsMjk2ICs2OCwyMzAgQEAKIFNvbWUgb3B0aW9ucyBo
YXZlIG5vIGRlZmF1bHQgdmFsdWUsIHRoZXNlIGFyZSBsaXN0ZWQgd2l0aAogYGA8bm8gZGVmYXVs
dD4nJy4gIFNvbWUgb3B0aW9ucyBkZWZhdWx0IHRvIHRoZSBlbXB0eSBzdHJpbmcsIHRoZXNlCiBh
cmUgbGlzdGVkIHdpdGggYGA8bm9uZT4nJy4KLS5JUCAiXGZCY29uZmlnZGlyZWN0b3J5OlxmUiA8
bm8gZGVmYXVsdD4iIDUKLVRoZSBwYXRobmFtZSBvZiB0aGUgSU1BUCBjb25maWd1cmF0aW9uIGRp
cmVjdG9yeS4gIFRoaXMgZmllbGQgaXMgcmVxdWlyZWQuCi0uSVAgIlxmQmRlZmF1bHRwYXJ0aXRp
b246XGZSIGRlZmF1bHQiIDUKLVRoZSBwYXJ0aXRpb24gbmFtZSB1c2VkIGJ5IGRlZmF1bHQgZm9y
IG5ldyBtYWlsYm94ZXMuCi0uSVAgIlxmQnBhcnRpdGlvbi1cZkluYW1lXGZCOlxmUiA8bm8gZGVm
YXVsdD4iIDUKLVRoZSBwYXRobmFtZSBvZiB0aGUgcGFydGl0aW9uIFxmSW5hbWVcZlIuICBBdCBs
ZWFzdCBvbmUgZmllbGQsIGZvciB0aGUKLXBhcnRpdGlvbiBuYW1lZCBpbiB0aGUgXGZCZGVmYXVs
dHBhcnRpdGlvblxmUiBvcHRpb24sIGlzIHJlcXVpcmVkLgotRm9yIGV4YW1wbGUsIGlmIHRoZSB2
YWx1ZSBvZiB0aGUgXGZCZGVmYXVsdHBhcnRpb25cZlIgb3B0aW9uIGlzCi1cZkJkZWZhdWx0XGZS
LCB0aGVuIHRoZSBcZkJwYXJ0aXRpb24tZGVmYXVsdFxmUiBmaWVsZCBpcyByZXF1aXJlZC4KLS5J
UCAiXGZCdW5peGhpZXJhcmNoeXNlcDpcZlIgbm8iIDUKLVVzZSB0aGUgVU5JWCBzZXBhcmF0b3Ig
Y2hhcmFjdGVyICcvJyBmb3IgZGVsaW1pdGluZyBsZXZlbHMgb2YgbWFpbGJveAotaGllcmFyY2h5
LiAgVGhlIGRlZmF1bHQgaXMgdG8gdXNlIHRoZSBuZXRuZXdzIHNlcGFyYXRvciBjaGFyYWN0ZXIg
Jy4nLiAKLS5JUCAiXGZCYWx0bmFtZXNwYWNlOlxmUiBubyIgNQotVXNlIHRoZSBhbHRlcm5hdGUg
SU1BUCBuYW1lc3BhY2UsIHdoZXJlIHBlcnNvbmFsIGZvbGRlcnMgcmVzaWRlIGF0IHRoZQotc2Ft
ZSBsZXZlbCBpbiB0aGUgaGllcmFyY2h5IGFzIElOQk9YLgotLmJyCi0uc3AKKworLklQICJcZkJh
ZG1pbnM6XGZSIDxlbXB0eSBzdHJpbmc+IiA1CitUaGUgbGlzdCBvZiB1c2VyaWRzIHdpdGggYWRt
aW5pc3RyYXRpdmUgcmlnaHRzLiAgU2VwYXJhdGUgZWFjaCB1c2VyaWR3aXRoIGEgc3BhY2UuICBT
aXRlcyB1c2luZyBLZXJiZXJvcyBhdXRoZW50aWNhdGlvbiBtYXkgdXNlCitzZXBhcmF0ZSAiYWRt
aW4iIGluc3RhbmNlcy4KKy5QUAorTm90ZSB0aGF0IGFjY291bnRzIHVzZWQgYnkgdXNlcnMgc2hv
dWxkIG5vdCBiZSBhZG1pbmlzdHJhdG9ycy4KK0FkbWluaXN0cmF0aXZlIGFjY291bnRzIHNob3Vs
ZCBub3QgcmVjZWl2ZSBtYWlsLiAgVGhhdCBpcywgaWYgdXNlcgorImpiUm8iIGlzIGEgdXNlciBy
ZWFkaW5nIG1haWwsIGhlIHNob3VsZCBub3QgYWxzbyBiZSBpbiB0aGUgYWRtaW5zIGxpbmUuCitT
b21lIHByb2JsZW1zIG1heSBvY2N1ciBvdGhlcndpc2UsIG1vc3Qgbm90YWJseSB0aGUgYWJpbGl0
eSBvZgorYWRtaW5pc3RyYXRvcnMgdG8gY3JlYXRlIHRvcC1sZXZlbCBtYWlsYm94ZXMgdmlzaWJs
ZSB0byB1c2VycywKK2J1dCBub3Qgd3JpdGFibGUgYnkgdXNlcnMuIAorLklQICJcZkJhbGxvd2Fs
bHN1YnNjcmliZTpcZlIgMCIgNQorQWxsb3cgc3Vic2NyaXB0aW9uIHRvIG5vbmV4aXN0YW50IG1h
aWxib3hlcy4gCisuSVAgIlxmQmFsbG93YW5vbnltb3VzbG9naW46XGZSIDAiIDUKK1Blcm1pdCBs
b2dpbnMgYnkgdGhlIHVzZXIgImFub255bW91cyIgdXNpbmcgYW55IHBhc3N3b3JkLiAgQWxzb2Fs
bG93cyB1c2Ugb2YgdGhlIFNBU0wgQU5PTllNT1VTIG1lY2hhbmlzbS4gCisuSVAgIlxmQmFsbG93
cGxhaW50ZXh0OlxmUiAxIiA1CitBbGxvdyB0aGUgdXNlIG9mIHRoZSBTQVNMIFBMQUlOIG1lY2hh
bmlzbS4gCisuSVAgIlxmQmFsdG5hbWVzcGFjZTpcZlIgMCIgNQorVXNlIHRoZSBhbHRlcm5hdGUg
SU1BUCBuYW1lc3BhY2UsIHdoZXJlIHBlcnNvbmFsIGZvbGRlcnMgcmVzaWRlIGF0IHRoZXNhbWUg
bGV2ZWwgaW4gdGhlIGhpZXJhcmNoeSBhcyBJTkJPWC4KKy5QUAogVGhpcyBvcHRpb24gT05MWSBh
cHBsaWVzIHdoZXJlIGludGVyYWN0aW9uIHRha2VzIHBsYWNlIHdpdGggdGhlCiBjbGllbnQvdXNl
ci4gIEN1cnJlbnRseSB0aGlzIGlzIGxpbWl0ZWQgdG8gdGhlIElNQVAgcHJvdG9jb2wgKGltYXBk
KQogYW5kIFNpZXZlIHNjcmlwdHMgKGxtdHBkKS4gIFRoaXMgb3B0aW9uIGRvZXMgTk9UIGFwcGx5
IHRvIGFkbWluIHRvb2xzCiBzdWNoIGFzIGN5cmFkbSAoYWRtaW5zIE9OTFkpLCByZWNvbnN0cnVj
dCwgcXVvdGEsIGV0Yy4sIE5PUiBkb2VzIGl0Ci1hZmZlY3QgTE1UUCBkZWxpdmVyeSBvZiBtZXNz
YWdlcyBkaXJlY3RseSB0byBtYWlsYm94ZXMgdmlhIHBsdXMtYWRkcmVzc2luZy4KLS5JUCAiXGZC
dXNlcnByZWZpeDpcZlIgT3RoZXIgVXNlcnMiIDUKLUlmIHVzaW5nIHRoZSBhbHRlcm5hdGUgSU1B
UCBuYW1lc3BhY2UsIHRoZSBwcmVmaXggZm9yIHRoZSBvdGhlciB1c2VycwotbmFtZXNwYWNlLiAg
VGhlIGhpZXJhcmNoeSBkZWxpbWl0ZXIgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGFwcGVuZGVkLgot
LklQICJcZkJzaGFyZWRwcmVmaXg6XGZSIFNoYXJlZCBGb2xkZXJzIiA1Ci1JZiB1c2luZyB0aGUg
YWx0ZXJuYXRlIElNQVAgbmFtZXNwYWNlLCB0aGUgcHJlZml4IGZvciB0aGUgc2hhcmVkCi1uYW1l
c3BhY2UuICBUaGUgaGllcmFyY2h5IGRlbGltaXRlciB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgYXBw
ZW5kZWQuCi0uSVAgIlxmQnVtYXNrOlxmUiAwNzciIDUKLVRoZSB1bWFzayB2YWx1ZSB1c2VkIGJ5
IHZhcmlvdXMgQ3lydXMgSU1BUCBwcm9ncmFtcy4KLS5JUCAiXGZCc2VydmVybmFtZTpcZlIgPHJl
c3VsdCByZXR1cm5lZCBieSBnZXRob3N0bmFtZSgyKT4iIDUKLVRoaXMgaXMgdGhlIGhvc3RuYW1l
IHZpc2libGUgaW4gdGhlIGdyZWV0aW5nIG1lc3NhZ2VzIG9mIHRoZSBQT1AsIElNQVAgYW5kIExN
VFAKLWRhZW1vbnMuIElmIGl0IGlzIHVuc2V0LCB0aGVuIHRoZSByZXN1bHQgcmV0dXJuZWQgZnJv
bSBnZXRob3N0bmFtZSgyKSBpcyB1c2VkLgotLklQICJcZkJhbGxvd2Fub255bW91c2xvZ2luOlxm
UiBubyIgNQotUGVybWl0IGxvZ2lucyBieSB0aGUgdXNlciAiYW5vbnltb3VzIiB1c2luZyBhbnkg
cGFzc3dvcmQuICBBbHNvIGFsbG93cwotdXNlIG9mIHRoZSBTQVNMIEFOT05ZTU9VUyBtZWNoYW5p
c20uCi0uSVAgIlxmQmFsbG93cGxhaW50ZXh0OlxmUiB5ZXMiIDUKLUFsbG93IHRoZSB1c2Ugb2Yg
dGhlIFNBU0wgUExBSU4gbWVjaGFuaXNtLgotLklQICJcZkJxdW90YXdhcm46XGZSIDkwIiA1Ci1U
aGUgcGVyY2VudCBvZiBxdW90YSB1dGlsaXphdGlvbiBvdmVyIHdoaWNoIHRoZSBzZXJ2ZXIgZ2Vu
ZXJhdGVzCi13YXJuaW5ncy4KLS5JUCAiXGZCdGltZW91dDpcZlIgMzAiIDUKLVRoZSBsZW5ndGgg
b2YgdGhlIElNQVAgc2VydmVyJ3MgaW5hY3Rpdml0eSBhdXRvbG9nb3V0IHRpbWVyLAotaW4gbWlu
dXRlcy4gIFRoZSBtaW5pbXVtIHZhbHVlIGlzIDMwLCB0aGUgZGVmYXVsdC4KK2FmZmVjdCBMTVRQ
IGRlbGl2ZXJ5IG9mIG1lc3NhZ2VzIGRpcmVjdGx5IHRvIG1haWxib3hlcyB2aWEKK3BsdXMtYWRk
cmVzc2luZy4gCisuSVAgIlxmQmF1dG9jcmVhdGVxdW90YTpcZlIgMCIgNQorSWYgbm9uemVybywg
bm9ybWFsIHVzZXJzIG1heSBjcmVhdGUgdGhlaXIgb3duIElNQVAgYWNjb3VudHMgYnljcmVhdGlu
ZyB0aGUgbWFpbGJveCBJTkJPWC4gIFRoZSB1c2VyJ3MgcXVvdGEgaXMgc2V0IHRvIHRoZSB2YWx1
ZQoraWYgaXQgaXMgcG9zaXRpdmUsIG90aGVyd2lzZSB0aGUgdXNlciBoYXMgdW5saW1pdGVkIHF1
b3RhLiAKKy5JUCAiXGZCY29uZmlnZGlyZWN0b3J5OlxmUiA8bm9uZT4iIDUKK1RoZSBwYXRobmFt
ZSBvZiB0aGUgSU1BUCBjb25maWd1cmF0aW9uIGRpcmVjdG9yeS4gIFRoaXMgZmllbGQgaXNyZXF1
aXJlZC4gCisuSVAgIlxmQmRlYnVnX2NvbW1hbmQ6XGZSIDxub25lPiIgNQorRGVidWcgY29tbWFu
ZCB0byBiZSB1c2VkIGJ5IHByb2Nlc3NlcyBzdGFydGVkIHdpdGggLUQgb3B0aW9uLiAgVGhlIHN0
cmluZ2lzIGEgQyBmb3JtYXQgc3RyaW5nIHRoYXQgZ2V0cyAzIG9wdGlvbnM6IHRoZSBmaXJzdCBp
cyB0aGUgbmFtZSBvZiB0aGUKK2V4ZWN1dGFibGUgKHdpdGhvdXQgcGF0aCkuICBUaGUgc2Vjb25k
IGlzIHRoZSBwaWQgKGludGVnZXIpIGFuZCB0aGUgdGhpcmQKK2lzIHRoZSBzZXJ2aWNlIElELiAg
RXhhbXBsZTogL3Vzci9sb2NhbC9iaW4vZ2RiIC91c3IvY3lydXMvYmluLyVzICVkIAorLklQICJc
ZkJkZWZhdWx0YWNsOlxmUiBhbnlvbmUgbHJzIiA1CitUaGUgQWNjZXNzIENvbnRyb2wgTGlzdCAo
QUNMKSBwbGFjZWQgb24gYSBuZXdseS1jcmVhdGVkIChub24tdXNlciltYWlsYm94IHRoYXQgZG9l
cyBub3QgaGF2ZSBhIHBhcmVudCBtYWlsYm94LiAKKy5JUCAiXGZCZGVmYXVsdHBhcnRpdGlvbjpc
ZlIgZGVmYXVsdCIgNQorVGhlIHBhcnRpdGlvbiBuYW1lIHVzZWQgYnkgZGVmYXVsdCBmb3IgbmV3
IG1haWxib3hlcy4gCisuSVAgIlxmQmRlbGV0ZXJpZ2h0OlxmUiBjIiA1CitUaGUgcmlnaHQgdGhh
dCBhIHVzZXIgbmVlZHMgdG8gZGVsZXRlIGEgbWFpbGJveC4gCisuSVAgIlxmQmR1cGxpY2F0ZXN1
cHByZXNzaW9uOlxmUiAxIiA1CitJZiBlbmFibGVkLCBsbXRwZCB3aWxsIHN1cHByZXNzIGRlbGl2
ZXJ5IG9mIGEgbWVzc2FnZSB0byBhIG1haWxib3ggaWZhIG1lc3NhZ2Ugd2l0aCB0aGUgc2FtZSBt
ZXNzYWdlLWlkIChvciByZXNlbnQtbWVzc2FnZS1pZCkgaXMgcmVjb3JkZWQKK2FzIGhhdmluZyBh
bHJlYWR5IGJlZW4gZGVsaXZlcmVkIHRvIHRoZSBtYWlsYm94LiAgUmVjb3JkcyB0aGUgbWFpbGJv
eAorYW5kIG1lc3NhZ2UtaWQvcmVzZW50LW1lc3NhZ2UtaWQgb2YgYWxsIHN1Y2Nlc3NmdWwgZGVs
aXZlcmllcy4gCisuSVAgIlxmQmZvb2xzdHVwaWRjbGllbnRzOlxmUiAwIiA1CitJZiBlbmFibGVk
LCBvbmx5IGxpc3QgdGhlIHBlcnNvbmFsIG5hbWVzcGFjZSB3aGVuIGEgTElTVCAiKiIgaXMgcGVy
Zm9ybWVkLihpdCBjaGFuZ2VzIHRoZSByZXF1ZXN0IHRvIGEgTElTVCAiSU5CT1gqIiAKKy5JUCAi
XGZCaGFzaGltYXBzcG9vbDpcZlIgMCIgNQorSWYgZW5hYmxlZCwgdGhlIHBhcnRpdGlvbnMgd2ls
bCBhbHNvIGJlIGhhc2hlZCwgaW4gYWRkaXRpb24gdG8gdGhlaGFzaGluZyBkb25lIG9uIGNvbmZp
Z3VyYXRpb24gZGlyZWN0b3JpZXMuICBUaGlzIGlzIHJlY29tbWVuZGVkIGlmCitvbmUgcGFydGl0
aW9uIGhhcyBhIHZlcnkgYnVzaHkgbWFpbGJveCB0cmVlLiAKKy5JUCAiXGZCaG9zdG5hbWVfbWVj
aHM6XGZSIDxub25lPiIgNQorRm9yY2UgYSBwYXJ0aWN1YXIgbGlzdCBvZiBTQVNMIG1lY2hhbmlz
bXMgdG8gYmUgdXNlZCB3aGVuIGF1dGhlbnRpY2F0aW5ndG8gdGhlIGJhY2tlbmQgc2VydmVyIGhv
c3RuYW1lICh3aGVyZSBob3N0bmFtZSBpcyB0aGUgc2hvcnQgaG9zdG5hbWUgb2YKK3RoZSBzZXJ2
ZXIgaW4gcXVlc3Rpb24pLiBJZiBpdCBpcyBub3Qgc3BlY2lmaWVkIGl0IHdpbGwgcXVlcnkgdGhl
IHNlcnZlcgorZm9yIGF2YWlsYWJsZSBtZWNoYW5pc21zIGFuZCBwaWNrIG9uZSB0byB1c2UuIC0g
Q3lydXMgTXVyZGVyCisKKyMgeyAiaG9zdG5hbWVfcGFzc3dvcmQiLCBOVUxMLCBTVFJJTkcgfQor
LyogVGhlIHBhc3N3b3JkIHRvIHVzZSBmb3IgYXV0aGVudGljYXRpb24gdG8gdGhlIGJhY2tlbmQg
c2VydmVyIGhvc3RuYW1lCisod2hlcmUgaG9zdG5hbWUgaXMgdGhlIHNob3J0IGhvc3RuYW1lIG9m
IHRoZSBzZXJ2ZXIpIC0gQ3lydXMgTXVyZGVyIAorLklQICJcZkJpZGxlc29ja2V0OlxmUiB7Y29u
ZmlnZGlyZWN0b3J5fS9zb2NrZXQvaWRsZSIgNQorVW5peCBkb21haW4gc29ja2V0IHRoYXQgaWRs
ZWQgbGlzdGVucyBvbi4gCisuSVAgIlxmQmlnbm9yZXJlZmVyZW5jZTpcZlIgMCIgNQorRm9yIGJh
Y2t3YXJkcyBjb21wYXRpYmlsaXR5IHdpdGggQ3lydXMgMS41LjEwIGFuZCBlYXJsaWVyIC0tIGln
bm9yZSogdGhlIHJlZmVyZW5jZSBhcmd1bWVudCBpbiBMSVNUIG9yIExTVUIgY29tbWFuZHNhIAog
LklQICJcZkJpbWFwaWRsZXBvbGw6XGZSIDYwIiA1Ci1UaGUgaW50ZXJ2YWwgKGluIHNlY29uZHMp
IGZvciBwb2xsaW5nIHRoZSBtYWlsYm94IGZvciBjaGFuZ2VzIHdoaWxlCi1ydW5uaW5nIHRoZSBJ
RExFIGNvbW1hbmQuICBUaGlzIG9wdGlvbiBpcyB1c2VkIHdoZW4gaWRsZWQgY2FuIG5vdCBiZQot
Y29udGFjdGVkIG9yIHdoZW4gcG9sbGluZyBpcyB1c2VkIGV4Y2x1c2l2ZWx5LiAgVGhlIG1pbmlt
dW0gdmFsdWUgaXMKLTEuICBBIHZhbHVlIG9mIDAgd2lsbCBkaXNhYmxlIHBvbGxpbmcgKGFuZCBk
aXNhYmxlIElETEUgaWYgcG9sbGluZyBpcwotdGhlIG9ubHkgbWV0aG9kIGF2YWlsYWJsZSkuCi0u
SVAgIlxmQmltYXBpZHJlc3BvbnNlOlxmUiB5ZXMiIDUKLUlmIGVuYWJsZWQsIHRoZSBzZXJ2ZXIg
cmVzcG9uZHMgdG8gYW4gSUQgY29tbWFuZCB3aXRoIGEgcGFyYW1ldGVyCi1saXN0IGNvbnRhaW5p
bmc6IHZlcnNpb24sIHZlbmRvciwgc3VwcG9ydC11cmwsIG9zLCBvcy12ZXJzaW9uLAotY29tbWFu
ZCwgYXJndW1lbnRzLCBlbnZpcm9ubWVudC4gIE90aGVyd2lzZSB0aGUgc2VydmVyIHJldHVybnMg
TklMLgotLklQICJcZkJwb3B0aW1lb3V0OlxmUiAxMCIgNQotU2V0IHRoZSBsZW5ndGggb2YgdGhl
IFBPUCBzZXJ2ZXIncyBpbmFjdGl2aXR5IGF1dG9sb2dvdXQgdGltZXIsCi1pbiBtaW51dGVzLiAg
VGhlIG1pbmltdW0gdmFsdWUgaXMgMTAsIHRoZSBkZWZhdWx0LgorVGhlIGludGVydmFsIChpbiBz
ZWNvbmRzKSBmb3IgcG9sbGluZyB0aGUgbWFpbGJveCBmb3IgY2hhbmdlcyB3aGlsZXJ1bm5pbmcg
dGhlIElETEUgY29tbWFuZC4gIFRoaXMgb3B0aW9uIGlzIHVzZWQgd2hlbiBpZGxlZCBjYW4gbm90
CitiZSBjb250YWN0ZWQgb3Igd2hlbiBwb2xsaW5nIGlzIHVzZWQgZXhjbHVzaXZlbHkuICBUaGUg
bWluaW11bQordmFsdWUgaXMgMS4gIEEgdmFsdWUgb2YgMCB3aWxsIGRpc2FibGUgcG9sbGluZyAo
YW5kIGRpc2FibGUgSURMRSBpZgorcG9sbGluZyBpcyB0aGUgb25seSBtZXRob2QgYXZhaWxhYmxl
KS4gCisuSVAgIlxmQmltYXBpZHJlc3BvbnNlOlxmUiAxIiA1CitJZiBlbmFibGVkLCB0aGUgc2Vy
dmVyIHJlc3BvbmRzIHRvIGFuIElEIGNvbW1hbmQgd2l0aCBhIHBhcmFtZXRlciBsaXN0IGNvbnRh
aW5pbmc6IHZlcnNpb24sIHZlbmRvciwgc3VwcG9ydC11cmwsIG9zLCBvcy12ZXJzaW9uLAorY29t
bWFuZCwgYXJndW1lbnRzLCBlbnZpcm9ubWVudC4gIE90aGVyd2lzZSB0aGUgc2VydmVyIHJldHVy
bnMgTklMLiAKKy5JUCAiXGZCbG10cF9vdmVyX3F1b3RhX3Blcm1fZmFpbHVyZTpcZlIgMCIgNQor
SWYgZW5hYmxlZCwgbG10cGQgcmV0dXJucyBhIHBlcm1hbmVudCBmYWlsdXJlIGNvZGUgd2hlbiBh
IHVzZXInc21haWxib3ggaXMgb3ZlciBxdW90YS4gIEJ5IGRlZmF1bHQsIHRoZSBmYWlsdXJlIGlz
IHRlbXBvcmFyeS4gCisuSVAgIlxmQmxtdHBzb2NrZXQ6XGZSIHtjb25maWdkaXJlY3Rvcnl9L3Nv
Y2tldC9sbXRwIiA1CitVbml4IGRvbWFpbiBzb2NrZXQgdGhhdCBsbXRwZCBsaXN0ZW5zIG9uLCB1
c2VkIGJ5IGRlbGl2ZXIoOCkuIAorLklQICJcZkJsb2dpbnJlYWxtczpcZlIgPGVtcHR5IHN0cmlu
Zz4iIDUKK1RoZSBsaXN0IG9mIHJlbW90ZSByZWFsbXMgd2hvc2UgdXNlcnMgbWF5IGxvZyBpbiB1
c2luZyBjcm9zcy1yZWFsbWF1dGhlbnRpY2F0aW9ucy4gIFNlcGVyYXRlIGVhY2ggcmVhbG0gbmFt
ZSBieSBhIHNwYWNlLiAgKEEKK2Nyb3NzLXJlYWxtIGlkZW50aXR5IGlzIGNvbnNpZGVyZWQgYW55
IGlkZW50aXR5IHJldHVybmVkIGJ5IFNBU0wKK3dpdGggYW4gIkAiIGluIGl0LikgCisuSVAgIlxm
QmxvZ2ludXNlYWNsOlxmUiAwIiA1CitJZiBlbmFibGVkLCBhbnkgYXV0aGVudGljYXRpb24gaWRl
bnRpdHkgd2hpY2ggaGFzIFxmQmFcZlIgcmlnaHRzIG9uIGF1c2VyJ3MgSU5CT1ggbWF5IGxvZyBp
biBhcyB0aGF0IHVzZXIuIAorLklQICJcZkJsb2d0aW1lc3RhbXBzOlxmUiAwIiA1CitJbmNsdWRl
IG5vdGF0aW9ucyBpbiB0aGUgcHJvdG9jb2wgdGVsZW1ldHJ5IGxvZ3MgaW5kaWNhdGluZyB0aGUg
bnVtYmVyIG9mc2Vjb25kcyBzaW5jZSB0aGUgbGFzdCBjb21tYW5kIG9yIHJlc3BvbnNlLiAKKy5J
UCAiXGZCbWFpbG5vdGlmaWVyOlxmUiA8bm9uZT4iIDUKK05vdGlmeWQoOCkgbWV0aG9kIHRvIHVz
ZSBmb3IgIk1BSUwiIG5vdGlmaWNhdGlvbnMuICBJZiBub3Qgc2V0LCAiTUFJTCJub3RpZmljYXRp
b25zIGFyZSBkaXNhYmxlZC4gCisuSVAgIlxmQm1heG1lc3NhZ2VzaXplOlxmUiAwIiA1CitNYXhp
bXVtIGluY29taW5nIExNVFAgbWVzc2FnZSBzaXplLiAgSWYgbm9uLXplcm8sIGxtdHBkIHdpbGwg
cmVqZWN0bWVzc2FnZXMgbGFyZ2VyIHRoYW4gXGZJbWF4bWVzc2FnZXNpemVcZlIgYnl0ZXMuICBJ
ZiBzZXQgdG8gMCwgdGhpcword2lsbCBhbGxvdyBtZXNzYWdlcyBvZiBhbnkgc2l6ZSAodGhlIGRl
ZmF1bHQpLiAKKy5JUCAiXGZCbXVwZGF0ZV9hdXRobmFtZTpcZlIgPG5vbmU+IiA1CitUaGUgU0FT
TCB1c2VybmFtZSAoQXV0aGVudGljYXRpb24gTmFtZSkgdG8gdXNlIHdoZW4gYXV0aGVudGljYXRp
bmcgdG8gdGhlbXVwZGF0ZSBzZXJ2ZXIgKGlmIG5lZWRlZCkuIAorLklQICJcZkJtdXBkYXRlX3Bh
c3N3b3JkOlxmUiA8bm9uZT4iIDUKK1RoZSBTQVNMIHBhc3N3b3JkIChpZiBuZWVkZWQpIHRvIHVz
ZSB3aGVuIGF1dGhlbnRpY2F0aW5nIHRvIHRoZW11cGRhdGUgc2VydmVyLiAKKy5JUCAiXGZCbXVw
ZGF0ZV9wb3J0OlxmUiAyMDA0IiA1CitUaGUgcG9ydCBvZiB0aGUgbXVwZGF0ZSBzZXJ2ZXIgZm9y
IHRoZSBDeXJ1cyBNdXJkZXIgCisuSVAgIlxmQm11cGRhdGVfcmVhbG06XGZSIDxub25lPiIgNQor
VGhlIFNBU0wgcmVhbG0gKGlmIG5lZWRlZCkgdG8gdXNlIHdoZW4gYXV0aGVudGljYXRpbmcgdG8g
dGhlIG11cGRhdGVzZXJ2ZXIuIAorLklQICJcZkJtdXBkYXRlX3JldHJ5X2RlbGF5OlxmUiAyMCIg
NQorVGhlIGJhc2UgdGltZSB0byB3YWl0IGJldHdlZW4gY29ubmVjdGlvbiByZXRyaWVzIHRvIHRo
ZSBtdXBkYXRlIHNlcnZlci4gCisuSVAgIlxmQm11cGRhdGVfc2VydmVyOlxmUiA8bm9uZT4iIDUK
K1RoZSBtdXBkYXRlIHNlcnZlciBmb3IgdGhlIEN5cnVzIE11cmRlciAKKy5JUCAiXGZCbXVwZGF0
ZV91c2VybmFtZTpcZlIgPGVtcHR5IHN0cmluZz4iIDUKK1RoZSBTQVNMIHVzZXJuYW1lIChBdXRo
b3JpemF0aW9uIE5hbWUpIHRvIHVzZSB3aGVuIGF1dGhlbnRpY2F0aW5nIHRvdGhlIG11cGRhdGUg
c2VydmVyIAorLklQICJcZkJuZXRzY2FwZXVybDpcZlIgaHR0cDovL2FzZy53ZWIuY211LmVkdS9j
eXJ1cy9pbWFwZC9uZXRzY2FwZS1hZG1pbi5odG1sIiA1CitJZiBlbmFibGVkIGF0IGNvbXBpbGUg
dGltZSwgdGhpcyBzcGVjaWZpZXMgYSBVUkwgdG8gcmVwbHkgd2hlbk5ldHNjYXBlIGFza3MgdGhl
IHNlcnZlciB3aGVyZSB0aGUgbWFpbCBhZG1pbmlzdHJhdGlvbiBIVFRQIHNlcnZlcgoraXMuICBU
aGUgZGVmYXVsdCBpcyBhIHNpdGUgYXQgQ01VIHdpdGggYSBob3BlZnVsbHkgaW5mb3JtYXRpdmUK
K21lc3NhZ2U7IGFkbWluaXN0cmF0b3JzIHNob3VsZCBzZXQgdGhpcyB0byBhIGxvY2FsIHJlc291
cmNlIHdpdGgKK3NvbWUgaW5mb3JtYXRpb24gb2YgZ3JlYXRlciB1c2UuIAorLklQICJcZkJuZXdz
cHJlZml4OlxmUiAwIiA1CitQcmVmaXggdG8gYmUgcHJlcGVuZGVkIHRvIG5ld3Nncm91cCBuYW1l
cyB0byBtYWtlIHRoZSBjb3JyZXNwb25kaW5nSU1BUCBtYWlsYm94IG5hbWVzLiAKKy5JUCAiXGZC
bm90aWZ5c29ja2V0OlxmUiB7Y29uZmlnZGlyZWN0b3J5fS9zb2NrZXQvbm90aWZ5IiA1CitVbml4
IGRvbWFpbiBzb2NrZXQgdGhhdCB0aGUgbmV3IG1haWwgbm90aWZpY2F0aW9uIGRhZW1vbiBsaXN0
ZW5zIG9uLiAKKy5JUCAiXGZCcGFydGl0aW9uLW5hbWU6XGZSIDxub25lPiIgNQorVGhlIHBhdGhu
YW1lIG9mIHRoZSBwYXJ0aXRpb24gXGZJbmFtZVxmUi4gIEF0IGxlYXN0IG9uZSBmaWVsZCwgZm9y
IHRoZXBhcnRpdGlvbiBuYW1lZCBpbiB0aGUgXGZCZGVmYXVsdHBhcnRpdGlvblxmUiBvcHRpb24s
IGlzIHJlcXVpcmVkLgorRm9yIGV4YW1wbGUsIGlmIHRoZSB2YWx1ZSBvZiB0aGUgXGZCZGVmYXVs
dHBhcnRpb25cZlIgb3B0aW9uIGlzCitcZkJkZWZhdWx0XGZSLCB0aGVuIHRoZSBcZkJwYXJ0aXRp
b24tZGVmYXVsdFxmUiBmaWVsZCBpcyByZXF1aXJlZC4gCisuSVAgIlxmQnBsYWludGV4dGxvZ2lu
cGF1c2U6XGZSIDAiIDUKK051bWJlciBvZiBzZWNvbmRzIHRvIHBhdXNlIGFmdGVyIGEgc3VjY2Vz
c2Z1bCBwbGFpbnRleHQgbG9naW4uICBGb3JzeXN0ZW1zIHRoYXQgc3VwcG9ydCBzdHJvbmcgYXV0
aGVudGljYXRpb24sIHRoaXMgcGVybWl0cyB1c2VycyB0byAgCitwZXJjZWl2ZSBhIGNvc3Qgb2Yg
dXNpbmcgcGxhaW50ZXh0IHBhc3N3b3Jkcy4gIChUaGlzIGRvZXMgbm90CithZmZlY3QgdGhlIHVz
ZSBvZiBQTEFJTiBpbiBTQVNMIGF1dGhlbnRpY2F0aW9ucy4pIAorLklQICJcZkJwb3BleHBpcmV0
aW1lOlxmUiAtMSIgNQorVGhlIG51bWJlciBvZiBkYXlzIGFkdmVydGlzZWQgYXMgYmVpbmcgdGhl
IG1pbmltdW0gYSBtZXNzYWdlIG1heSBiZWxlZnQgb24gdGhlIFBPUCBzZXJ2ZXIgYmVmb3JlIGl0
IGlzIGRlbGV0ZWQgKHZpYSB0aGUgQ0FQQSBjb21tYW5kLAorZGVmaW5lZCBpbiB0aGUgUE9QMyBF
eHRlbnNpb24gTWVjaGFuaXNtLCB3aGljaCBzb21lIGNsaWVudHMgbWF5CitzdXBwb3J0KS4gICJO
RVZFUiIsIHRoZSBkZWZhdWx0LCBtYXkgYmUgc3BlY2lmaWVkIHdpdGggYSBuZWdhdGl2ZQorbnVt
YmVyLiAgVGhlIEN5cnVzIFBPUDMgc2VydmVyIG5ldmVyIGRlbGV0ZXMgbWFpbCwgbm8gbWF0dGVy
IHdoYXQgIAordGhlIHZhbHVlIG9mIHRoaXMgcGFyYW1ldGVyIGlzLiAgSG93ZXZlciwgaWYgYSBz
aXRlIGltcGxlbWVudHMgYSAKK2xlc3MgbGliZXJhbCBwb2xpY3ksIGl0IG5lZWRzIHRvIGNoYW5n
ZSB0aGlzIHBhcmFtZXRlcgorYWNjb3JkaW5nbHkuIAogLklQICJcZkJwb3BtaW5wb2xsOlxmUiAw
IiA1Ci1TZXQgdGhlIG1pbmltdW0gYW1vdW50IG9mIHRpbWUgdGhlIHNlcnZlciBmb3JjZXMgdXNl
cnMgdG8gd2FpdCBiZXR3ZWVuCi1zdWNjZXNzaXZlIFBPUCBsb2dpbnMsCi1pbiBtaW51dGVzLiAg
VGhlIGRlZmF1bHQgaXMgMC4KLS5JUCAiXGZCcG9wZXhwaXJldGltZTpcZlIgMCIgNQotVGhlIG51
bWJlciBvZiBkYXlzIGFkdmVydGlzZWQgYXMgYmVpbmcgdGhlIG1pbmltdW0gYSBtZXNzYWdlIG1h
eSBiZSBsZWZ0IG9uCi10aGUgUE9QIHNlcnZlciBiZWZvcmUgaXQgaXMgZGVsZXRlZCAodmlhIHRo
ZSBDQVBBIGNvbW1hbmQsIGRlZmluZWQgaW4gdGhlIFBPUDMKLUV4dGVuc2lvbiBNZWNoYW5pc20s
IHdoaWNoIHNvbWUgY2xpZW50cyBtYXkgc3VwcG9ydCkuICAiTkVWRVIiLCB0aGUgZGVmYXVsdCwK
LW1heSBiZSBzcGVjaWZpZWQgd2l0aCBhIG5lZ2F0aXZlIG51bWJlci4gIFRoZSBDeXJ1cyBQT1Az
IHNlcnZlciBuZXZlciBkZWxldGVzCi1tYWlsLCBubyBtYXR0ZXIgd2hhdCB0aGUgdmFsdWUgb2Yg
dGhpcyBwYXJhbWV0ZXIgaXMuICBIb3dldmVyLCBpZiBhIHNpdGUKLWltcGxlbWVudHMgYSBsZXNz
IGxpYmVyYWwgcG9saWN5LCBpdCBuZWVkcyB0byBjaGFuZ2UgdGhpcyBwYXJhbWV0ZXIKLWFjY29y
ZGluZ2x5LgotLklQICJcZkJhZG1pbnM6XGZSIDxub25lPiIgNQotVGhlIGxpc3Qgb2YgdXNlcmlk
cyB3aXRoIGFkbWluaXN0cmF0aXZlIHJpZ2h0cy4gIFNlcGFyYXRlIGVhY2ggdXNlcmlkCi13aXRo
IGEgc3BhY2UuICBTaXRlcyB1c2luZyBLZXJiZXJvcyBhdXRoZW50aWNhdGlvbiBtYXkgdXNlCi1z
ZXBhcmF0ZSAiYWRtaW4iIGluc3RhbmNlcy4KLS5QUAotTm90ZSB0aGF0IGFjY291bnRzIHVzZWQg
YnkgdXNlcnMgc2hvdWxkIG5vdCBiZSBhZG1pbmlzdHJhdG9ycy4gIEFkbWluaXN0cmF0aXZlIAot
YWNjb3VudHMgc2hvdWxkIG5vdCByZWNlaXZlIG1haWwuICBUaGF0IGlzLCBpZiB1c2VyICJqYlJv
IiBpcyBhIHVzZXIgcmVhZGluZwotbWFpbCwgaGUgc2hvdWxkIG5vdCBhbHNvIGJlIGluIHRoZSBh
ZG1pbnMgbGluZS4gIFNvbWUgcHJvYmxlbXMgbWF5IG9jY3VyCi1vdGhlcndpc2UsIG1vc3Qgbm90
YWJseSAgdGhlIGFiaWxpdHkgb2YgYWRtaW5pc3RyYXRvcnMgdG8gY3JlYXRlIHRvcC1sZXZlbAot
bWFpbGJveGVzIHZpc2libGUgdG8gdXNlcnMsIGJ1dCBub3Qgd3JpdGFibGUgYnkgdXNlcnMuCitT
ZXQgdGhlIG1pbmltdW0gYW1vdW50IG9mIHRpbWUgdGhlIHNlcnZlciBmb3JjZXMgdXNlcnMgdG8g
d2FpdGJldHdlZW4gc3VjY2Vzc2l2ZSBQT1AgbG9naW5zLCBpbiBtaW51dGVzLiAgVGhlIGRlZmF1
bHQgaXMgMC4gCisuSVAgIlxmQnBvcHRpbWVvdXQ6XGZSIDEwIiA1CitTZXQgdGhlIGxlbmd0aCBv
ZiB0aGUgUE9QIHNlcnZlcidzIGluYWN0aXZpdHkgYXV0b2xvZ291dCB0aW1lciwgICAgaW4gbWlu
dXRlcy4gIFRoZSBtaW5pbXVtIHZhbHVlIGlzIDEwLCB0aGUgZGVmYXVsdC4gCisuSVAgIlxmQnBv
c3RtYXN0ZXI6XGZSIHBvc3RtYXN0ZXIiIDUKK1VzZXJuYW1lIHRoYXQgaXMgdXNlZCBhcyB0aGUg
J0Zyb20nIGFkZHJlc3MgaW4gcmVqZWN0aW9uIE1ETnMgcHJvZHVjZWRieSBzaWV2ZS4gCisuSVAg
IlxmQnBvc3R1c2VyOlxmUiA8ZW1wdHkgc3RyaW5nPiIgNQorVXNlcmlkIHVzZWQgdG8gZGVsaXZl
ciBtZXNzYWdlcyB0byBzaGFyZWQgZm9sZGVycy4gIEZvciBleGFtcGxlLCBpZnNldCB0byAiYmIi
LCBlbWFpbCBzZW50IHRvICJiYitzaGFyZWQuYmxhaCIgd291bGQgYmUgZGVsaXZlcmVkIHRvCit0
aGUgInNoYXJlZC5ibGFoIiBmb2xkZXIuICBCeSBkZWZhdWx0LCBhbiBlbWFpbCBhZGRyZXNzIG9m
CisiK3NoYXJlZC5ibGFoIiB3b3VsZCBiZSB1c2VkLiAKKy5JUCAiXGZCcHJveHlfYXV0aG5hbWU6
XGZSIHByb3h5IiA1CitUaGUgYXV0aGVudGljYXRpb24gbmFtZSB0byB1c2Ugd2hlbiBhdXRoZW50
aWNhdGluZyB0byBhIGJhY2tlbmQgc2VydmVyaW4gdGhlIEN5cnVzIE11cmRlci4gCisuSVAgIlxm
QnByb3h5X3Bhc3N3b3JkOlxmUiA8bm9uZT4iIDUKK1RoZSBkZWZhdWx0IHBhc3N3b3JkIHRvIHVz
ZSB3aGVuIGF1dGhlbnRpY2F0aW5nIHRvIGEgYmFja2VuZCBzZXJ2ZXJpbiB0aGUgQ3lydXMgTXVy
ZGVyLiAgTWF5IGJlIG92ZXJyaWRkZW4gb24gYSBob3N0LXNwZWNpZmljIGJhc2lzIHVzaW5nCit0
aGUgaG9zdG5hbWVfcGFzc3dvcmQgb3B0aW9uLiAKKy5JUCAiXGZCcHJveHlfcmVhbG06XGZSIDxu
b25lPiIgNQorVGhlIGF1dGhlbnRpY2F0aW9uIHJlYWxtIHRvIHVzZSB3aGVuIGF1dGhlbnRpY2F0
aW5nIHRvIGEgYmFja2VuZCBzZXJ2ZXJpbiB0aGUgQ3lydXMgTXVyZGVyIAorLklQICJcZkJwcm94
eWRfYWxsb3dfc3RhdHVzX3JlZmVycmFsOlxmUiAwIiA1CitTZXQgdG8gdHJ1ZSB0byBhbGxvdyBw
cm94eWQgdG8gaXNzdWUgcmVmZXJyYWxzIHRvIGNsaWVudHMgdGhhdCBzdXBwb3J0IGl0d2hlbiBh
bnN3ZXJpbmcgdGhlIFNUQVRVUyBjb21tYW5kLiAgVGhpcyBpcyBkaXNhYmxlZCBieSBkZWZhdWx0
IHNpbmNlCitzb21lIGNsaWVudHMgaXNzdWUgbWFueSBTVEFUVVMgY29tbWFuZHMgaW4gYSByb3cs
IGFuZCBkbyBub3QgY2FjaGUgdGhlCitjb25uZWN0aW9ucyB0aGF0IHRoZXNlIHJlZmVycmFscyB3
b3VsZCBjYXVzZSwgdGh1cyByZXN1bHRpbmcgaW4gYSBoaWdoZXIKK2F1dGhlbnRpY2F0aW9uIGxv
YWQgb24gdGhlIHJlc3BlY3RpdmUgYmFja2VuZCBzZXJ2ZXIuIAogLklQICJcZkJwcm94eXNlcnZl
cnM6XGZSIDxub25lPiIgNQotQSBsaXN0IG9mIHVzZXJzIGFuZCBncm91cHMgdGhhdCBhcmUgYWxs
b3dlZCB0byBwcm94eSBmb3Igb3RoZXIgdXNlcnMsCi1zZXBlcmF0ZWQgYnkgc3BhY2VzLiAgQW55
IHVzZXIgbGlzdGVkIGluIHRoaXMgd2lsbCBiZSBhbGxvd2VkIHRvIGxvZ2luCi1mb3IgYW55IG90
aGVyIHVzZXI6IHVzZSB3aXRoIGNhdXRpb24uCi0uSVAgIlxmQmRlZmF1bHRhY2w6XGZSIGFueW9u
ZSBscnMiIDUKLVRoZSBBY2Nlc3MgQ29udHJvbCBMaXN0IChBQ0wpIHBsYWNlZCBvbiBhIG5ld2x5
LWNyZWF0ZWQgKG5vbi11c2VyKSAKLW1haWxib3ggdGhhdCBkb2VzIG5vdCBoYXZlIGEgcGFyZW50
IG1haWxib3guCi0uSVAgIlxmQm5ld3NzcG9vbFxmQjpcZlIgPG5vIGRlZmF1bHQ+IiA1Ci1UaGUg
cGF0aG5hbWUgb2YgdGhlIG5ld3Mgc3Bvb2wgZGlyZWN0b3J5LiAgT25seSB1c2VkIGlmIHRoZQot
XGZCcGFydGl0aW9uLW5ld3NcZlIgY29uZmlndXJhdGlvbiBvcHRpb24gaXMgc2V0LgotLklQICJc
ZkJuZXdzcHJlZml4OlxmUiA8bm9uZT4iIDUKLVByZWZpeCB0byBiZSBwcmVwZW5kZWQgdG8gbmV3
c2dyb3VwIG5hbWVzIHRvIG1ha2UgdGhlIGNvcnJlc3BvbmRpbmcKLUlNQVAgbWFpbGJveCBuYW1l
cy4KLS5JUCAiXGZCYXV0b2NyZWF0ZXF1b3RhOlxmUiAwIiA1Ci1JZiBub256ZXJvLCBub3JtYWwg
dXNlcnMgbWF5IGNyZWF0ZSB0aGVpciBvd24gSU1BUCBhY2NvdW50cyBieQotY3JlYXRpbmcgdGhl
IG1haWxib3ggSU5CT1guICBUaGUgdXNlcidzIHF1b3RhIGlzIHNldCB0byB0aGUgdmFsdWUgaWYK
LWl0IGlzIHBvc2l0aXZlLCBvdGhlcndpc2UgdGhlIHVzZXIgaGFzIHVubGltaXRlZCBxdW90YS4K
LS5JUCAiXGZCbG9ndGltZXN0YW1wczpcZlIgbm8iIDUKLUluY2x1ZGUgbm90YXRpb25zIGluIHRo
ZSBwcm90b2NvbCB0ZWxlbWV0cnkgbG9ncyBpbmRpY2F0aW5nIHRoZSBudW1iZXIgb2YKLXNlY29u
ZHMgc2luY2UgdGhlIGxhc3QgY29tbWFuZCBvciByZXNwb25zZS4KLS5JUCAiXGZCcGxhaW50ZXh0
bG9naW5wYXVzZTpcZlIgMCIgNQotTnVtYmVyIG9mIHNlY29uZHMgdG8gcGF1c2UgYWZ0ZXIgYSBz
dWNjZXNzZnVsIHBsYWludGV4dCBsb2dpbi4gIEZvcgotc3lzdGVtcyB0aGF0IHN1cHBvcnQgc3Ry
b25nIGF1dGhlbnRpY2F0aW9uLCB0aGlzIHBlcm1pdHMgdXNlcnMgdG8KLXBlcmNlaXZlIGEgY29z
dCBvZiB1c2luZyBwbGFpbnRleHQgcGFzc3dvcmRzLiAgKFRoaXMgZG9lcyBub3QgZWZmZWN0Ci10
aGUgdXNlIG9mIFBMQUlOIGluIFNBU0wgYXV0aGVudGljYXRpb25zLikKLS5JUCAiXGZCc3J2dGFi
OlxmUiAvZXRjL3NydnRhYiIgNQotVGhlIHBhdGhuYW1lIG9mIFxmSXNydnRhYlxmUiBmaWxlIGNv
bnRhaW5pbmcgdGhlIHNlcnZlcidzIHByaXZhdGUgCi1rZXkuICBUaGlzIG9wdGlvbiBpcyBwYXNz
ZWQgdG8gdGhlIFNBU0wgbGlicmFyeSBhbmQgb3ZlcnJpZGVzIGl0cwotZGVmYXVsdCBzZXR0aW5n
LgotLklQICJcZkJsb2dpbnJlYWxtczpcZlIgPG5vbmU+IiA1Ci1UaGUgbGlzdCBvZiByZW1vdGUg
cmVhbG1zIHdob3NlIHVzZXJzIG1heSBsb2cgaW4gdXNpbmcgCi1jcm9zcy1yZWFsbSBhdXRoZW50
aWNhdGlvbnMuICBTZXBlcmF0ZSBlYWNoIHJlYWxtIG5hbWUKLWJ5IGEgc3BhY2UuICAoQSBjcm9z
cy1yZWFsbSBpZGVudGl0eSBpcyBjb25zaWRlcmVkIGFueSBpZGVudGl0eQotcmV0dXJuZWQgYnkg
U0FTTCB3aXRoIGFuICJAIiBpbiBpdC4pCi0uSVAgIlxmQmxvZ2ludXNlYWNsOlxmUiBubyIgNQot
SWYgZW5hYmxlZCwgYW55IGF1dGhlbnRpY2F0aW9uIGlkZW50aXR5IHdoaWNoIGhhcyBcZkJhXGZS
IHJpZ2h0cyBvbiBhCi11c2VyJ3MgSU5CT1ggbWF5IGxvZyBpbiBhcyB0aGF0IHVzZXIuCi0uSVAg
IlxmQnNpbmdsZWluc3RhbmNlc3RvcmU6XGZSIHllcyIgNQotSWYgZW5hYmxlZCwgbG10cGQgYXR0
ZW1wdHMgdG8gb25seSB3cml0ZSBvbmUgY29weSBvZiBhIG1lc3NhZ2UgcGVyCi1wYXJ0aXRpb24g
YW5kIGNyZWF0ZSBoYXJkIGxpbmtzLCByZXN1bHRpbmcgaW4gYSBwb3RlbnRpYWxseSBsYXJnZSBk
aXNrCi1zYXZpbmdzLgotLklQICJcZkJkdXBsaWNhdGVzdXBwcmVzc2lvbjpcZlIgeWVzIiA1Ci1J
ZiBlbmFibGVkLCBsbXRwZCB3aWxsIHN1cHByZXNzIGRlbGl2ZXJ5IG9mIGEgbWVzc2FnZSB0byBh
IG1haWxib3ggaWYKLWEgbWVzc2FnZSB3aXRoIHRoZSBzYW1lIG1lc3NhZ2UtaWQgKG9yIHJlc2Vu
dC1tZXNzYWdlLWlkKSBpcyByZWNvcmRlZAotYXMgaGF2aW5nIGFscmVhZHkgYmVlbiBkZWxpdmVy
ZWQgdG8gdGhlIG1haWxib3guICBSZWNvcmRzIHRoZSBtYWlsYm94Ci1hbmQgbWVzc2FnZS1pZC9y
ZXNlbnQtbWVzc2FnZS1pZCBvZiBhbGwgc3VjY2Vzc2Z1bCBkZWxpdmVyaWVzLgotLklQICJcZkJy
ZWplY3Q4Yml0OlxmUiBubyIgNQotSWYgZW5hYmxlZCwgbG10cGQgcmVqZWN0cyBtZXNzYWdlcyB3
aXRoIDgtYml0IGNoYXJhY3RlcnMgaW4gdGhlIGhlYWRlcnMuCi1PdGhlcndpc2UsIDgtYml0IGNo
YXJhY3RlcnMgYXJlIGNoYW5nZWQgdG8gYFgnLiAgKEEgcHJvcGVyIHNvdWx0aW9uIHRvCi1ub24t
QVNDSUkgY2hhcmFjdGVycyBpbiBoZWFkZXJzIGlzIG9mZmVyZWQgYnkgUkZDIDIwNDcgYW5kIGl0
cyBwcmVkZWNlc3NvcnMuKQotLklQICJcZkJtYXhtZXNzYWdlc2l6ZTpcZlIgPHVubGltaXRlZD4i
IDUKLU1heGltdW0gaW5jb21pbmcgTE1UUCBtZXNzYWdlIHNpemUuICBJZiBzZXQsIGxtdHBkIHdp
bGwKLXJlamVjdCBtZXNzYWdlcyBsYXJnZXIgdGhhbiBcZkltYXhtZXNzYWdlc2l6ZVxmUiBieXRl
cy4gIFRoZSBkZWZhdWx0Ci1pcyB0byBhbGxvdyBtZXNzYWdlcyBvZiBhbnkgc2l6ZS4KLS5JUCAi
XGZCbG10cF9vdmVycXVvdGFfcGVybV9mYWlsdXJlOlxmUiBubyIgNQotSWYgZW5hYmxlZCwgbG10
cGQgcmV0dXJucyBhIHBlcm1hbmVudCBmYWlsdXJlIGNvZGUgd2hlbiBhIHVzZXIncwotbWFpbGJv
eCBpcyBvdmVyIHF1b3RhLiAgQnkgZGVmYXVsdCwgdGhlIGZhaWx1cmUgaXMgdGVtcG9yYXJ5Lgot
LklQICJcZkJsbXRwX2FsbG93cGxhaW50ZXh0OlxmUiA8c2V0dGluZyBvZiBcZklhbGxvd3BsYWlu
dGV4dFxmUj4iIDUKLUFsbG93IHRoZSB1c2Ugb2YgdGhlIFNBU0wgUExBSU4gbWVjaGFuaXNtIGZv
ciBMTVRQLgotLklQICJcZkJwb3N0dXNlcjpcZlIgPG5vbmU+IiA1Ci1Vc2VyaWQgdXNlZCB0byBk
ZWxpdmVyIG1lc3NhZ2VzIHRvIHNoYXJlZCBmb2xkZXJzLiAgRm9yIGV4YW1wbGUsIGlmCi1zZXQg
dG8gImJiIiwgZW1haWwgc2VudCB0byAiYmIrc2hhcmVkLmJsYWgiIHdvdWxkIGJlIGRlbGl2ZXJl
ZCB0byB0aGUKLSJzaGFyZWQuYmxhaCIgZm9sZGVyLiAgQnkgZGVmYXVsdCwgYW4gZW1haWwgYWRk
cmVzcyBvZiAiK3NoYXJlZC5ibGFoIgotd291bGQgYmUgdXNlZC4KLS5JUCAiXGZCbmV0c2NhcGV1
cmw6XGZSIDxubyBkZWZhdWx0PiIgNQotSWYgZW5hYmxlZCBhdCBjb21waWxlIHRpbWUsIHRoaXMg
c3BlY2lmaWVzIGEgVVJMIHRvIHJlcGx5IHdoZW4KLU5ldHNjYXBlIGFza3MgdGhlIHNlcnZlciB3
aGVyZSB0aGUgbWFpbCBhZG1pbmlzdHJhdGlvbiBIVFRQIHNlcnZlciBpcy4KLUFkbWluaXN0cmF0
b3JzIHNob3VsZCBzZXQgdGhpcyB0byBhIGxvY2FsIHJlc291cmNlIHdpdGggc29tZQotdXNlZnVs
IGluZm9ybWF0aW9uIGZvciBlbmQgdXNlcnMuICBJZiBub3Qgc2V0LCBubyBVUkwgaXMgYWR2ZXJ0
aXNlZC4KLS5JUCAiXGZCbWFpbG5vdGlmaWVyOlxmUiA8bm8gZGVmYXVsdD4iIDUKLU5vdGlmeWQo
OCkgbWV0aG9kIHRvIHVzZSBmb3IgIk1BSUwiIG5vdGlmaWNhdGlvbnMuICBJZiBub3Qgc2V0LCAi
TUFJTCIKLW5vdGlmaWNhdGlvbnMgYXJlIGRpc2FibGVkLgotLklQICJcZkJzaWV2ZW5vdGlmaWVy
OlxmUiA8bm8gZGVmYXVsdD4iIDUKLU5vdGlmeWQoOCkgbWV0aG9kIHRvIHVzZSBmb3IgIlNJRVZF
IiBub3RpZmljYXRpb25zLiAgSWYgbm90IHNldCwgIlNJRVZFIgotbm90aWZpY2F0aW9ucyBhcmUg
ZGlzYWJsZWQuCi0uYnIKLS5zcAotVGhpcyBtZXRob2QgaXMgb25seSB1c2VkIHdoZW4gbm8gbWV0
aG9kIGlzIHNwZWNpZmllZCBpbiB0aGUgc2NyaXB0LgotLklQICJcZkJzaWV2ZXVzZWhvbWVkaXI6
XGZSIGZhbHNlIiA1Ci1JZiBlbmFibGVkLCBsbXRwZCB3aWxsIGxvb2sgZm9yIFNpZXZlIHNjcmlw
dHMgaW4gdXNlcidzIGhvbWUKLWRpcmVjdG9yaWVzOiB+dXNlci8uc2lldmUuCi0uSVAgIlxmQnNp
ZXZlZGlyOlxmUiAvdXNyL3NpZXZlIiA1Ci1JZiBzaWV2ZXVzZWhvbWVkaXIgaXMgZmFsc2UsIHRo
aXMgZGlyZWN0b3J5IGlzIHNlYXJjaGVkIGZvciBTaWV2ZQotc2NyaXB0cy4KK0EgbGlzdCBvZiB1
c2VycyBhbmQgZ3JvdXBzIHRoYXQgYXJlIGFsbG93ZWQgdG8gcHJveHkgZm9yIG90aGVydXNlcnMs
IHNlcGVyYXRlZCBieSBzcGFjZXMuICBBbnkgdXNlciBsaXN0ZWQgaW4gdGhpcyB3aWxsIGJlCith
bGxvd2VkIHRvIGxvZ2luIGZvciBhbnkgb3RoZXIgdXNlcjogdXNlIHdpdGggY2F1dGlvbi4gCisu
SVAgIlxmQnF1b3Rhd2FybjpcZlIgOTAiIDUKK1RoZSBwZXJjZW50IG9mIHF1b3RhIHV0aWxpemF0
aW9uIG92ZXIgd2hpY2ggdGhlIHNlcnZlciBnZW5lcmF0ZXN3YXJuaW5ncy4gCisuSVAgIlxmQnJl
amVjdDhiaXQ6XGZSIDAiIDUKK0lmIGVuYWJsZWQsIGxtdHBkIHJlamVjdHMgbWVzc2FnZXMgd2l0
aCA4LWJpdCBjaGFyYWN0ZXJzIGluIHRoZWhlYWRlcnMuICBPdGhlcndpc2UsIDgtYml0IGNoYXJh
Y3RlcnMgYXJlIGNoYW5nZWQgdG8gYFgnLiAgKEEKK3Byb3BlciBzb3VsdGlvbiB0byBub24tQVND
SUkgY2hhcmFjdGVycyBpbiBoZWFkZXJzIGlzIG9mZmVyZWQgYnkgIAorUkZDIDIwNDcgYW5kIGl0
cyBwcmVkZWNlc3NvcnMuKSAKKy5JUCAiXGZCc2FzbF9hdXRvX3RyYW5zaXRpb246XGZSIDAiIDUK
K0lmIGVuYWJsZWQsIHRoZSBTQVNMIGxpYnJhcnkgd2lsbCBhdXRvbWF0aWNhbGx5IGNyZWF0ZSBh
dXRoZW50aWNhdGlvbnNlY3JldHMgd2hlbiBnaXZlbiBhIHBsYWludGV4dCBwYXNzd29yZC4gIFNl
ZSB0aGUgU0FTTCBkb2N1bWVudGF0aW9uLiAKKy5JUCAiXGZCc2FzbF9tYXhpbXVtX2xheWVyOlxm
UiAyNTYiIDUKK01heGltdW0gU1NGIChzZWN1cml0eSBzdHJlbmd0aCBmYWN0b3IpIHRoYXQgdGhl
IHNlcnZlciB3aWxsIGFsbG93IGFjbGllbnQgdG8gbmVnb3RpYXRlLiAKKy5JUCAiXGZCc2FzbF9t
aW5pbXVtX2xheWVyOlxmUiAwIiA1CitUaGUgbWluaW11bSBTU0YgdGhhdCB0aGUgc2VydmVyIHdp
bGwgYWxsb3cgYSBjbGllbnQgdG8gbmVnb3RpYXRlLkEgdmFsdWUgb2YgMSByZXF1aXJlcyBpbnRl
Z3JpdHkgcHJvdGVjdGlvbjsgYW55IGhpZ2hlciB2YWx1ZSAgCityZXF1aXJlcyBzb21lIGFtb3Vu
dCBvZiBlbmNyeXB0aW9uLiAKKy5JUCAiXGZCc2FzbF9vcHRpb246XGZSIDAiIDUKK0FueSBTQVNM
IG9wdGlvbiBjYW4gYmUgc2V0IGJ5IHByZWNlZWRpbmcgaXQgd2l0aCAic2FzbF8iLiAgVGhpc2Zp
bGUgb3ZlcnJpZGVzIHRoZSBTQVNMIGNvbmZpZ3VyYXRpb24gZmlsZS4gCisuSVAgIlxmQnNhc2xf
cHdjaGVja19tZXRob2Q6XGZSIDxub25lPiIgNQorVGhlIG1lY2hhbmlzbSB1c2VkIGJ5IHRoZSBz
ZXJ2ZXIgdG8gdmVyaWZ5IHBsYWludGV4dCBwYXNzd29yZHMuIFBvc3NpYmxlIHZhbHVlcyBpbmNs
dWRlICJhdXhwcm9wIiwgInNhc2xhdXRoZCIsIGFuZCAicHdjaGVjayIuIAogLklQICJcZkJzZW5k
bWFpbDpcZlIgL3Vzci9saWIvc2VuZG1haWwiIDUKLVRoZSBwYXRobmFtZSBvZiB0aGUgc2VuZG1h
aWwgZXhlY3V0YWJsZS4gIFNpZXZlIHVzZXMgc2VuZG1haWwgZm9yIHNlbmRpbmcKLXJlamVjdGlv
bnMsIHJlZGlyZWN0cyBhbmQgdmFjYXRpb24gcmVzcG9uc2VzLgotLklQICJcZkJwb3N0bWFzdGVy
OlxmUiBwb3N0bWFzdGVyIiA1Ci1Vc2VybmFtZSB0aGF0IGlzIHVzZWQgYXMgdGhlICdGcm9tJyBh
ZGRyZXNzIGluIHJlamVjdGlvbiBNRE5zIHByb2R1Y2VkCi1ieSBzaWV2ZS4KLS5JUCAiXGZCaGFz
aGltYXBzcG9vbDpcZlIgZmFsc2UiIDUKLUlmIGVuYWJsZWQsIHRoZSBwYXJ0aXRpb25zIHdpbGwg
YWxzbyBiZSBoYXNoZWQsIGluIGFkZGl0aW9uIHRvIHRoZQotaGFzaGluZyBkb25lIG9uIGNvbmZp
Z3VyYXRpb24gZGlyZWN0b3JpZXMuICBUaGlzIGlzIHJlY29tbWVuZGVkIGlmIG9uZQotcGFydGl0
aW9uIGhhcyBhIHZlcnkgYnVzaHkgbWFpbGJveCB0cmVlLgorVGhlIHBhdGhuYW1lIG9mIHRoZSBz
ZW5kbWFpbCBleGVjdXRhYmxlLiAgU2lldmUgaW52b2tlcyBzZW5kbWFpbGZvciBzZW5kaW5nIHJl
amVjdGlvbnMsIHJlZGlyZWN0cyBhbmQgdmFjYXRpb24gcmVzcG9uc2VzLiAKKy5JUCAiXGZCc2Vy
dmVybmFtZTpcZlIgPG5vbmU+IiA1CitUaGlzIGlzIHRoZSBob3N0bmFtZSB2aXNpYmxlIGluIHRo
ZSBncmVldGluZyBtZXNzYWdlcyBvZiB0aGUgUE9QLElNQVAgYW5kIExNVFAgZGFlbW9ucy4gSWYg
aXQgaXMgdW5zZXQsIHRoZW4gdGhlIHJlc3VsdCByZXR1cm5lZAorZnJvbSBnZXRob3N0bmFtZSgy
KSBpcyB1c2VkLiAKKy5JUCAiXGZCc2hhcmVkcHJlZml4OlxmUiBTaGFyZWQgRm9sZGVycyIgNQor
SWYgdXNpbmcgdGhlIGFsdGVybmF0ZSBJTUFQIG5hbWVzcGFjZSwgdGhlIHByZWZpeCBmb3IgdGhl
IHNoYXJlZG5hbWVzcGFjZS4gIFRoZSBoaWVyYXJjaHkgZGVsaW1pdGVyIHdpbGwgYmUgYXV0b21h
dGljYWxseSBhcHBlbmRlZC4gCiAuSVAgIlxmQnNpZXZlX21heHNjcmlwdHNpemU6XGZSIDMyIiA1
Ci1NYXhpbXVtIHNpemUgKGluIGtpbG9ieXRlcykgYW55IHNpZXZlIHNjcmlwdCBjYW4gYmUsIGVu
Zm9yY2VkIGF0Ci1zdWJtaXNzaW9uIGJ5IHRpbXNpZXZlZCg4KS4KK01heGltdW0gc2l6ZSAoaW4g
a2lsb2J5dGVzKSBhbnkgc2lldmUgc2NyaXB0IGNhbiBiZSwgZW5mb3JjZWQgYXRzdWJtaXNzaW9u
IGJ5IHRpbXNpZXZlZCg4KS4gCiAuSVAgIlxmQnNpZXZlX21heHNjcmlwdHM6XGZSIDUiIDUKLU1h
eGltdW0gbnVtYmVyIG9mIHNpZXZlIHNjcmlwdHMgYW55IHVzZXIgbWF5IGhhdmUsIGVuZm9yY2Vk
IGF0Ci1zdWJtaXNzaW9uIGJ5IHRpbXNpZXZlZCg4KS4KLS5JUCAiXGZCc2FzbF9tYXhpbXVtX2xh
eWVyOlxmUiAyNTYiIDUKLU1heGltdW0gU1NGIChzZWN1cml0eSBzdHJlbmd0aCBmYWN0b3IpIHRo
YXQgdGhlIHNlcnZlciB3aWxsIGFsbG93IGEKLWNsaWVudCB0byBuZWdvdGlhdGUuCi0uSVAgIlxm
QnNhc2xfbWluaW11bV9sYXllcjpcZlIgMCIgNQotVGhlIG1pbmltdW0gU1NGIHRoYXQgdGhlIHNl
cnZlciB3aWxsIGFsbG93IGEgY2xpZW50IHRvIG5lZ290aWF0ZS4gIEEKLXZhbHVlIG9mIDEgcmVx
dWlyZXMgaW50ZWdyaXR5IHByb3RlY3Rpb247IGFueSBoaWdoZXIgdmFsdWUgcmVxdWlyZXMKLXNv
bWUgYW1vdW50IG9mIGVuY3J5cHRpb24uCi0uSVAgIlxmQnNhc2xfcHdjaGVja19tZXRob2Q6XGZS
IGF1eHByb3AiIDUKLVRoZSBtZWNoYW5pc20gdXNlZCBieSB0aGUgc2VydmVyIHRvIHZlcmlmeSBw
bGFpbnRleHQgcGFzc3dvcmRzLgotUG9zc2libGUgdmFsdWVzIGFsc28gaW5jbHVkZSAic2FzbGF1
dGhkIiBhbmQgInB3Y2hlY2siLgotLklQICJcZkJzYXNsX2F1dG9fdHJhbnNpdGlvbjpcZlIgbm8i
IDUKLUlmIGVuYWJsZWQsIHRoZSBTQVNMIGxpYnJhcnkgd2lsbCBhdXRvbWF0aWNhbGx5IGNyZWF0
ZSBhdXRoZW50aWNhdGlvbgotc2VjcmV0cyB3aGVuIGdpdmVuIGEgcGxhaW50ZXh0IHBhc3N3b3Jk
LiAgU2VlIHRoZSBTQVNMIGRvY3VtZW50YXRpb24uCi0uSVAgIlxmQnNhc2xfb3B0aW9uOlxmUiIg
NQotQW55IG90aGVyIFNBU0wgb3B0aW9uIGNhbiBiZSBzZXQgYnkgcHJlY2VlZGluZyBpdCB3aXRo
ICJzYXNsXyIuICBUaGlzCi1maWxlIG92ZXJyaWRlcyB0aGUgU0FTTCBjb25maWd1cmF0aW9uIGZp
bGUuCitNYXhpbXVtIG51bWJlciBvZiBzaWV2ZSBzY3JpcHRzIGFueSB1c2VyIG1heSBoYXZlLCBl
bmZvcmNlZCBhdHN1Ym1pc3Npb24gYnkgdGltc2lldmVkKDgpLiAKKy5JUCAiXGZCc2lldmVkaXI6
XGZSIC91c3Ivc2lldmUiIDUKK0lmIHNpZXZldXNlaG9tZWRpciBpcyBmYWxzZSwgdGhpcyBkaXJl
Y3RvcnkgaXMgc2VhcmNoZWQgZm9yIFNpZXZlc2NyaXB0cy4gCisuSVAgIlxmQnNpZXZlbm90aWZp
ZXI6XGZSIDxub25lPiIgNQorTm90aWZ5ZCg4KSBtZXRob2QgdG8gdXNlIGZvciAiU0lFVkUiIG5v
dGlmaWNhdGlvbnMuICBJZiBub3Qgc2V0LCAiU0lFVkUibm90aWZpY2F0aW9ucyBhcmUgZGlzYWJs
ZWQuCisuUFAKK1RoaXMgbWV0aG9kIGlzIG9ubHkgdXNlZCB3aGVuIG5vIG1ldGhvZCBpcyBzcGVj
aWZpZWQgaW4gdGhlIHNjcmlwdC4gCisuSVAgIlxmQnNpZXZldXNlaG9tZWRpcjpcZlIgMCIgNQor
SWYgZW5hYmxlZCwgbG10cGQgd2lsbCBsb29rIGZvciBTaWV2ZSBzY3JpcHRzIGluIHVzZXIncyBo
b21lZGlyZWN0b3JpZXM6IH51c2VyLy5zaWV2ZS4gCisuSVAgIlxmQnNpbmdsZWluc3RhbmNlc3Rv
cmU6XGZSIDEiIDUKK0lmIGVuYWJsZWQsIGxtdHBkIGF0dGVtcHRzIHRvIG9ubHkgd3JpdGUgb25l
IGNvcHkgb2YgYSBtZXNzYWdlIHBlcnBhcnRpdGlvbiBhbmQgY3JlYXRlIGhhcmQgbGlua3MsIHJl
c3VsdGluZyBpbiBhIHBvdGVudGlhbGx5IGxhcmdlCitkaXNrIHNhdmluZ3MuIAorLklQICJcZkJz
b2Z0X25vYXV0aDpcZlIgMSIgNQorSWYgZW5hYmxlZCwgbG10cGQgcmV0dXJucyB0ZW1wb3Jhcnkg
ZmFpbHVyZXMgaWYgdGhlIGNsaWVudCBkb2VzIG5vdCogc3VjY2Vzc2Z1bGx5IGF1dGhlbnRpY2F0
ZS4gIE90aGVyd2lzZSBsbXRwZCByZXR1cm5zIHBlcm1hbmFudCBmYWlsdXJlcworKiAoY2F1c2lu
ZyB0aGUgbWFpbCB0byBib3VuY2UgaW1tZWRpYXRlbHkpLiAKKy5JUCAiXGZCc3J2dGFiOlxmUiA8
ZW1wdHkgc3RyaW5nPiIgNQorVGhlIHBhdGhuYW1lIG9mIFxmSXNydnRhYlxmUiBmaWxlIGNvbnRh
aW5pbmcgdGhlIHNlcnZlcidzIHByaXZhdGVrZXkuICBUaGlzIG9wdGlvbiBpcyBwYXNzZWQgdG8g
dGhlIFNBU0wgbGlicmFyeSBhbmQgb3ZlcnJpZGVzIGl0cworZGVmYXVsdCBzZXR0aW5nLiAKKy5J
UCAiXGZCdGltZW91dDpcZlIgMzAiIDUKK1RoZSBsZW5ndGggb2YgdGhlIElNQVAgc2VydmVyJ3Mg
aW5hY3Rpdml0eSBhdXRvbG9nb3V0IHRpbWVyLCAgICAgICBpbiBtaW51dGVzLiAgVGhlIG1pbmlt
dW0gdmFsdWUgaXMgMzAsIHRoZSBkZWZhdWx0LiAKKy5JUCAiXGZCdGxzX2NhX2ZpbGU6XGZSIDxu
b25lPiIgNQorRmlsZSBjb250YWluaW5nIG9uZSBvciBtb3JlIENlcnRpZmljYXRlIEF1dGhvcml0
eSAoQ0EpIGNlcnRpZmljYXRlcy4gCisuSVAgIlxmQnRsc19jYV9wYXRoOlxmUiA8bm9uZT4iIDUK
K1BhdGggdG8gZGlyZWN0b3J5IHdpdGggY2VydGlmaWNhdGVzIG9mIENBcy4gIFRoaXMgZGlyZWN0
b3J5IG11c3RoYXZlIGZpbGVuYW1lcyB3aXRoIHRoZSBoYXNoZWQgdmFsdWUgb2YgdGhlIGNlcnRp
ZmljYXRlIChzZWUKK29wZW5zc2woWFhYKSkuIAogLklQICJcZkJ0bHNfY2VydF9maWxlOlxmUiA8
bm9uZT4iIDUKLUZpbGUgY29udGFpbmluZyB0aGUgZ2xvYmFsIGNlcnRpZmljYXRlIHVzZWQgZm9y
IEFMTCBzZXJ2aWNlcyAoaW1hcCwKLXBvcDMsIGxtdHAsIHNpZXZlKS4KK0ZpbGUgY29udGFpbmlu
ZyB0aGUgY2VydGlmaWNhdGUgcHJlc2VudGVkIGZvciBzZXJ2ZXIgYXV0aGVudGljYXRpb25kdXJp
bmcgU1RBUlRUTFMuICBBIHZhbHVlIG9mICJkaXNhYmxlZCIgd2lsbCBkaXNhYmxlIFNTTC9UTFMu
IAorLklQICJcZkJ0bHNfY2lwaGVyX2xpc3Q6XGZSIERFRkFVTFQiIDUKK1RoZSBsaXN0IG9mIFNT
TC9UTFMgY2lwaGVycyB0byBhbGxvdy4gIFRoZSBmb3JtYXQgb2YgdGhlIHN0cmluZyBpc2Rlc2Ny
aWJlZCBpbiBjaXBoZXJzKDEpLiAKIC5JUCAiXGZCdGxzX2tleV9maWxlOlxmUiA8bm9uZT4iIDUK
LUZpbGUgY29udGFpbmluZyB0aGUgcHJpdmF0ZSBrZXkgYmVsb25naW5nIHRvIHRoZSBnbG9iYWwg
c2VydmVyCi1jZXJ0aWZpY2F0ZS4KK0ZpbGUgY29udGFpbmluZyB0aGUgcHJpdmF0ZSBrZXkgYmVs
b25naW5nIHRvIHRoZSBzZXJ2ZXJjZXJ0aWZpY2F0ZS4gIEEgdmFsdWUgb2YgImRpc2FibGVkIiB3
aWxsIGRpc2FibGUgU1NML1RMUy4gCiAuSVAgIlxmQnRsc19yZXF1aXJlX2NlcnQ6XGZSIDAiIDUK
LVJlcXVpcmUgYSBjbGllbnQgY2VydGlmaWNhdGUgZm9yIEFMTCBzZXJ2aWNlcyAoaW1hcCwgcG9w
MywgbG10cCwgc2lldmUpLgotLklQICJcZkJ0bHNfaW1hcF9jZXJ0X2ZpbGU6XGZSIDxub25lPiIg
NQotRmlsZSBjb250YWluaW5nIHRoZSBjZXJ0aWZpY2F0ZSB1c2VkIGZvciBpbWFwIE9OTFkuICBJ
ZiBub3Qgc3BlY2lmaWVkLAotdGhlIGdsb2JhbCBjZXJ0aWZpY2F0ZSBpcyB1c2VkLiAgQSB2YWx1
ZSBvZiAiZGlzYWJsZWQiIHdpbGwgZGlzYWJsZQotU1NML1RMUyBmb3IgaW1hcC4KLS5JUCAiXGZC
dGxzX2ltYXBfa2V5X2ZpbGU6XGZSIDxub25lPiIgNQotRmlsZSBjb250YWluaW5nIHRoZSBwcml2
YXRlIGtleSBiZWxvbmdpbmcgdG8gdGhlIGltYXAtc3BlY2lmaWMgc2VydmVyCi1jZXJ0aWZpY2F0
ZS4gIElmIG5vdCBzcGVjaWZpZWQsIHRoZSBnbG9iYWwgcHJpdmF0ZSBrZXkgaXMgdXNlZC4gIEEK
LXZhbHVlIG9mICJkaXNhYmxlZCIgd2lsbCBkaXNhYmxlIFNTTC9UTFMgZm9yIGltYXAuCi0uSVAg
IlxmQnRsc19pbWFwX3JlcXVpcmVfY2VydDpcZlIgMCIgNQotUmVxdWlyZSBhIGNsaWVudCBjZXJ0
aWZpY2F0ZSBmb3IgaW1hcCBPTkxZLgotLklQICJcZkJ0bHNfcG9wM19jZXJ0X2ZpbGU6XGZSIDxu
b25lPiIgNQotRmlsZSBjb250YWluaW5nIHRoZSBjZXJ0aWZpY2F0ZSB1c2VkIGZvciBwb3AzIE9O
TFkuICBJZiBub3Qgc3BlY2lmaWVkLAotdGhlIGdsb2JhbCBjZXJ0aWZpY2F0ZSBpcyB1c2VkLiAg
QSB2YWx1ZSBvZiAiZGlzYWJsZWQiIHdpbGwgZGlzYWJsZQotU1NML1RMUyBmb3IgcG9wMy4KLS5J
UCAiXGZCdGxzX3BvcDNfa2V5X2ZpbGU6XGZSIDxub25lPiIgNQotRmlsZSBjb250YWluaW5nIHRo
ZSBwcml2YXRlIGtleSBiZWxvbmdpbmcgdG8gdGhlIHBvcDMtc3BlY2lmaWMgc2VydmVyCi1jZXJ0
aWZpY2F0ZS4gIElmIG5vdCBzcGVjaWZpZWQsIHRoZSBnbG9iYWwgcHJpdmF0ZSBrZXkgaXMgdXNl
ZC4gIEEKLXZhbHVlIG9mICJkaXNhYmxlZCIgd2lsbCBkaXNhYmxlIFNTTC9UTFMgZm9yIHBvcDMu
Ci0uSVAgIlxmQnRsc19wb3AzX3JlcXVpcmVfY2VydDpcZlIgMCIgNQotUmVxdWlyZSBhIGNsaWVu
dCBjZXJ0aWZpY2F0ZSBmb3IgcG9wMyBPTkxZLgotLklQICJcZkJ0bHNfbG10cF9jZXJ0X2ZpbGU6
XGZSIDxub25lPiIgNQotRmlsZSBjb250YWluaW5nIHRoZSBjZXJ0aWZpY2F0ZSB1c2VkIGZvciBs
bXRwIE9OTFkuICBJZiBub3Qgc3BlY2lmaWVkLAotdGhlIGdsb2JhbCBjZXJ0aWZpY2F0ZSBpcyB1
c2VkLiAgQSB2YWx1ZSBvZiAiZGlzYWJsZWQiIHdpbGwgZGlzYWJsZQotVExTIGZvciBsbXRwLgot
LklQICJcZkJ0bHNfbG10cF9rZXlfZmlsZTpcZlIgPG5vbmU+IiA1Ci1GaWxlIGNvbnRhaW5pbmcg
dGhlIHByaXZhdGUga2V5IGJlbG9uZ2luZyB0byB0aGUgbG10cC1zcGVjaWZpYyBzZXJ2ZXIKLWNl
cnRpZmljYXRlLiAgSWYgbm90IHNwZWNpZmllZCwgdGhlIGdsb2JhbCBwcml2YXRlIGtleSBpcyB1
c2VkLiAgQQotdmFsdWUgb2YgImRpc2FibGVkIiB3aWxsIGRpc2FibGUgVExTIGZvciBsbXRwLgot
LklQICJcZkJ0bHNfbG10cF9yZXF1aXJlX2NlcnQ6XGZSIDAiIDUKLVJlcXVpcmUgYSBjbGllbnQg
Y2VydGlmaWNhdGUgZm9yIGxtdHAgT05MWS4KLS5JUCAiXGZCdGxzX3NpZXZlX2NlcnRfZmlsZTpc
ZlIgPG5vbmU+IiA1Ci1GaWxlIGNvbnRhaW5pbmcgdGhlIGNlcnRpZmljYXRlIHVzZWQgZm9yIHNp
ZXZlIE9OTFkuICBJZiBub3Qgc3BlY2lmaWVkLAotdGhlIGdsb2JhbCBjZXJ0aWZpY2F0ZSBpcyB1
c2VkLiAgQSB2YWx1ZSBvZiAiZGlzYWJsZWQiIHdpbGwgZGlzYWJsZQotVExTIGZvciBzaWV2ZS4K
LS5JUCAiXGZCdGxzX3NpZXZlX2tleV9maWxlOlxmUiA8bm9uZT4iIDUKLUZpbGUgY29udGFpbmlu
ZyB0aGUgcHJpdmF0ZSBrZXkgYmVsb25naW5nIHRvIHRoZSBzaWV2ZS1zcGVjaWZpYyBzZXJ2ZXIK
LWNlcnRpZmljYXRlLiAgSWYgbm90IHNwZWNpZmllZCwgdGhlIGdsb2JhbCBwcml2YXRlIGtleSBp
cyB1c2VkLiAgQQotdmFsdWUgb2YgImRpc2FibGVkIiB3aWxsIGRpc2FibGUgVExTIGZvciBzaWV2
ZS4KLS5JUCAiXGZCdGxzX3NpZXZlX3JlcXVpcmVfY2VydDpcZlIgMCIgNQotUmVxdWlyZSBhIGNs
aWVudCBjZXJ0aWZpY2F0ZSBmb3Igc2lldmUgT05MWS4KLS5JUCAiXGZCdGxzX2NhX2ZpbGU6XGZS
IDxub25lPiIgNQotRmlsZSBjb250YWluaW5nIG9uZSBvciBtb3JlIENlcnRpZmljYXRlIEF1dGhv
cml0eSAoQ0EpIGNlcnRpZmljYXRlcy4KLS5JUCAiXGZCdGxzX2NhX3BhdGg6XGZSIDxub25lPiIg
NQotUGF0aCB0byBkaXJlY3Rvcnkgd2l0aCBjZXJ0aWZpY2F0ZXMgb2YgQ0FzLgorUmVxdWlyZSBh
IGNsaWVudCBjZXJ0aWZpY2F0ZSBmb3IgQUxMIHNlcnZpY2VzIChpbWFwLCBwb3AzLCBsbXRwLCBz
aWV2ZSkuIAogLklQICJcZkJ0bHNfc2Vzc2lvbl90aW1lb3V0OlxmUiAxNDQwIiA1Ci1UaGUgbGVu
Z3RoIG9mIHRpbWUgKGluIG1pbnV0ZXMpIHRoYXQgYSBUTFMgc2Vzc2lvbiB3aWxsIGJlIGNhY2hl
ZCBmb3IKLWxhdGVyIHJldXNlLiAgVGhlIG1heGltdW0gdmFsdWUgaXMgMTQ0MCAoMjQgaG91cnMp
LCB0aGUgZGVmYXVsdC4gIEEKLXZhbHVlIG9mIDAgd2lsbCBkaXNhYmxlIHNlc3Npb24gY2FjaGlu
Zy4KLS5JUCAiXGZCdGxzX2NpcGhlcl9saXN0OlxmUiBERUZBVUxUIiA1Ci1UaGUgbGlzdCBvZiBT
U0wvVExTIGNpcGhlcnMgdG8gYWxsb3cuICBUaGUgZm9ybWF0IG9mIHRoZSBzdHJpbmcgaXMKLWRl
c2NyaWJlZCBpbiBjaXBoZXJzKDEpLgotLklQICJcZkJkZWxldGVyaWdodDpcZlIgYyIgNQotVGhl
IHJpZ2h0IHRoYXQgYSB1c2VyIG5lZWRzIHRvIGRlbGV0ZSBhIG1haWxib3guCi0uSVAgIlxmQmxt
dHBzb2NrZXQ6XGZSIC92YXIvaW1hcC9zb2NrZXQvbG10cCIgNQotVW5peCBkb21haW4gc29ja2V0
IHRoYXQgbG10cGQgbGlzdGVucyBvbiwgdXNlZCBieSBkZWxpdmVyKDgpLgotLklQICJcZkJpZGxl
c29ja2V0OlxmUiAvdmFyL2ltYXAvc29ja2V0L2lkbGUiIDUKLVVuaXggZG9tYWluIHNvY2tldCB0
aGF0IGlkbGVkIGxpc3RlbnMgb24uCi0uSVAgIlxmQm5vdGlmeXNvY2tldDpcZlIgL3Zhci9pbWFw
L3NvY2tldC9ub3RpZnkiIDUKLVVuaXggZG9tYWluIHNvY2tldCB0aGF0IHRoZSBuZXcgbWFpbCBu
b3RpZmljYXRpb24gZGFlbW9uIGxpc3RlbnMgb24uCi0uSVAgIlxmQmRlYnVnX2NvbW1hbmQ6XGZS
IDxub25lPiIgNQotRGVidWcgY29tbWFuZCB0byBiZSB1c2VkIGJ5IHByb2Nlc3NlcyBzdGFydGVk
IHdpdGggLUQgb3B0aW9uLiAgVGhlIHN0cmluZwotaXMgYSBDIGZvcm1hdCBzdHJpbmcgdGhhdCBn
ZXRzIDMgb3B0aW9uczogdGhlIGZpcnN0IGlzIHRoZSBuYW1lIG9mIHRoZQotZXhlY3V0YWJsZSAo
d2l0aG91dCBwYXRoKS4gIFRoZSBzZWNvbmQgaXMgdGhlIHBpZCAoaW50ZWdlcikgYW5kIHRoZSB0
aGlyZAotaXMgdGhlIHNlcnZpY2UgSUQuICBFeGFtcGxlOiAvdXNyL2xvY2FsL2Jpbi9nZGIgL3Vz
ci9jeXJ1cy9iaW4vJXMgJWQKLS5JUCAiXGZCcHJveHlkX2FsbG93X3N0YXR1c19yZWZlcnJhbDpc
ZlIgZmFsc2UiIDUKLVNldCB0byB0cnVlIHRvIGFsbG93IHByb3h5ZCB0byBpc3N1ZSByZWZlcnJh
bHMgdG8gY2xpZW50cyB0aGF0IHN1cHBvcnQgaXQKLXdoZW4gYW5zd2VyaW5nIHRoZSBTVEFUVVMg
Y29tbWFuZC4gIFRoaXMgaXMgZGlzYWJsZWQgYnkgZGVmYXVsdCBzaW5jZQotc29tZSBjbGllbnRz
IGlzc3VlIG1hbnkgU1RBVFVTIGNvbW1hbmRzIGluIGEgcm93LCBhbmQgZG8gbm90IGNhY2hlIHRo
ZQotY29ubmVjdGlvbnMgdGhhdCB0aGVzZSByZWZlcnJhbHMgd291bGQgY2F1c2UsIHRodXMgcmVz
dWx0aW5nIGluIGEgaGlnaGVyCi1hdXRoZW50aWNhdGlvbiBsb2FkIG9uIHRoZSByZXNwZWN0aXZl
IGJhY2tlbmQgc2VydmVyLgotLklQICJcZkJtdXBkYXRlX3NlcnZlcjpcZlIgPG5vbmU+IiA1Ci1U
aGUgbXVwZGF0ZSBzZXJ2ZXIgZm9yIHRoZSBDeXJ1cyBNdXJkZXIKLS5JUCAiXGZCbXVwZGF0ZV9w
b3J0OlxmUiA8bm9uZT4iIDUKLVRoZSBwb3J0IG9mIHRoZSBtdXBkYXRlIHNlcnZlciBmb3IgdGhl
IEN5cnVzIE11cmRlcgotLklQICJcZkJtdXBkYXRlX3VzZXJuYW1lOlxmUiA8bm9uZT4iIDUKLVRo
ZSBTQVNMIHVzZXJuYW1lIChBdXRob3JpemF0aW9uIE5hbWUpIHRvIHVzZSB3aGVuIGF1dGhlbnRp
Y2F0aW5nIHRvIHRoZSBtdXBkYXRlIHNlcnZlci4KLS5JUCAiXGZCbXVwZGF0ZV9hdXRobmFtZTpc
ZlIgPG5vbmU+IiA1Ci1UaGUgU0FTTCB1c2VybmFtZSAoQXV0aGVudGljYXRpb24gTmFtZSkgdG8g
dXNlIHdoZW4gYXV0aGVudGljYXRpbmcgdG8gdGhlCi1tdXBkYXRlIHNlcnZlciAoaWYgbmVlZGVk
KS4KLS5JUCAiXGZCbXVwZGF0ZV9yZWFsbTpcZlIgPG5vbmU+IiA1Ci1UaGUgU0FTTCByZWFsbSAo
aWYgbmVlZGVkKSB0byB1c2Ugd2hlbiBhdXRoZW50aWNhdGluZyB0byB0aGUgbXVwZGF0ZSBzZXJ2
ZXIuCi0uSVAgIlxmQm11cGRhdGVfcGFzc3dvcmQ6XGZSIDxub25lPiIgNQotVGhlIFNBU0wgcGFz
c3dvcmQgKGlmIG5lZWRlZCkgdG8gdXNlIHdoZW4gYXV0aGVudGljYXRpbmcgdG8gdGhlIG11cGRh
dGUgc2VydmVyLgotLklQICJcZkJtdXBkYXRlX3JldHJ5X2RlbGF5OlxmUiAyMCIgNQotVGhlIHRp
bWUgdG8gd2FpdCBiZXR3ZWVuIGNvbm5lY3Rpb24gcmV0cmllcyB0byB0aGUgbXVwZGF0ZSBzZXJ2
ZXIuCitUaGUgbGVuZ3RoIG9mIHRpbWUgKGluIG1pbnV0ZXMpIHRoYXQgYSBUTFMgc2Vzc2lvbiB3
aWxsIGJlIGNhY2hlZGZvciBsYXRlciByZXVzZS4gIFRoZSBtYXhpbXVtIHZhbHVlIGlzIDE0NDAg
KDI0IGhvdXJzKSwgdGhlCitkZWZhdWx0LiAgQSB2YWx1ZSBvZiAwIHdpbGwgZGlzYWJsZSBzZXNz
aW9uIGNhY2hpbmcuIAorLklQICJcZkJ1bWFzazpcZlIgMDc3IiA1CitUaGUgdW1hc2sgdmFsdWUg
dXNlZCBieSB2YXJpb3VzIEN5cnVzIElNQVAgcHJvZ3JhbXMuIAorLklQICJcZkJ1c2VycHJlZml4
OlxmUiBPdGhlciBVc2VycyIgNQorSWYgdXNpbmcgdGhlIGFsdGVybmF0ZSBJTUFQIG5hbWVzcGFj
ZSwgdGhlIHByZWZpeCBmb3IgdGhlIG90aGVyIHVzZXJzbmFtZXNwYWNlLiAgVGhlIGhpZXJhcmNo
eSBkZWxpbWl0ZXIgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGFwcGVuZGVkLiAKKy5JUCAiXGZCdW5p
eGhpZXJhcmNoeXNlcDpcZlIgMCIgNQorVXNlIHRoZSBVTklYIHNlcGFyYXRvciBjaGFyYWN0ZXIg
Jy8nIGZvciBkZWxpbWl0aW5nIGxldmVscyBvZm1haWxib3ggaGllcmFyY2h5LiAgVGhlIGRlZmF1
bHQgaXMgdG8gdXNlIHRoZSBuZXRuZXdzIHNlcGFyYXRvcgorY2hhcmFjdGVyICcuJy4gCiAuU0gg
U0VFIEFMU08KIC5QUAogXGZCaW1hcGQoOClcZlIsIFxmQnBvcDNkKDgpXGZSLCBcZkJsbXRwZCg4
KVxmUiwgXGZCdGltc2lldmVkKDgpXGZSLAogXGZCaWRsZWQoOClcZlIsIFxmQm5vdGlmeWQoOClc
ZlIsIFxmQmRlbGl2ZXIoOClcZlIsIFxmQm1hc3Rlcig4KVxmUiwgCiBcZkJjaXBoZXJzKDEpXGZS
CisKSW5kZXg6IG5vdGlmeWQvbm90aWZ5X21haWx0by5jCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9h
ZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvbm90aWZ5ZC9ub3RpZnlfbWFp
bHRvLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMwpkaWZmIC11IC1yMS4zIG5vdGlmeV9tYWls
dG8uYwotLS0gbm90aWZ5X21haWx0by5jCTIwMDIvMDMvMTggMTU6MTQ6MTcJMS4zCisrKyBub3Rp
ZnlfbWFpbHRvLmMJMjAwMi8wNi8xOSAwMDoyNDoxOApAQCAtNTksMTAgKzU5LDcgQEAKICNkZWZp
bmUgREVGQVVMVF9TRU5ETUFJTCAoIi91c3IvbGliL3NlbmRtYWlsIikKICNkZWZpbmUgREVGQVVM
VF9QT1NUTUFTVEVSICgicG9zdG1hc3RlciIpCiAKLSNkZWZpbmUgU0VORE1BSUwgKGNvbmZpZ19n
ZXRzdHJpbmcoInNlbmRtYWlsIiwgREVGQVVMVF9TRU5ETUFJTCkpCi0jZGVmaW5lIFBPU1RNQVNU
RVIgKGNvbmZpZ19nZXRzdHJpbmcoInBvc3RtYXN0ZXIiLCBERUZBVUxUX1BPU1RNQVNURVIpKQog
Ci0KIHN0YXRpYyBpbnQgZ2xvYmFsX291dGdvaW5nX2NvdW50ID0gMDsKIAogY2hhciogbm90aWZ5
X21haWx0byhjb25zdCBjaGFyICpjbGFzcyBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKQEAgLTk5
LDcgKzk2LDcgQEAKIAljbG9zZShmZHNbMV0pOwogCS8qIG1ha2UgdGhlIHBpcGUgYmUgc3RkaW4g
Ki8KIAlkdXAyKGZkc1swXSwgMCk7Ci0JZXhlY3YoU0VORE1BSUwsIChjaGFyICoqKSBzbWJ1Zik7
CisJZXhlY3YoY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NFTkRNQUlMKSwgKGNoYXIgKiopIHNt
YnVmKTsKIAogCS8qIGlmIHdlJ3JlIGhlcmUgd2Ugc3VjayAqLwogCXJldHVybiBzdHJkdXAoIk5P
IG1haWx0byBjb3VsZG4ndCBleGVjIik7CkBAIC0xMjEsNyArMTE4LDcgQEAKICAgICBmcHJpbnRm
KHNtLCAiRGF0ZTogJXNcclxuIiwgZGF0ZXN0cik7CiAgICAgCiAgICAgZnByaW50ZihzbSwgIlgt
U2lldmU6ICVzXHJcbiIsIFNJRVZFX1ZFUlNJT04pOwotICAgIGZwcmludGYoc20sICJGcm9tOiBN
YWlsIFNpZXZlIFN1YnN5c3RlbSA8JXM+XHJcbiIsIFBPU1RNQVNURVIpOworICAgIGZwcmludGYo
c20sICJGcm9tOiBNYWlsIFNpZXZlIFN1YnN5c3RlbSA8JXM+XHJcbiIsIGNvbmZpZ19nZXRzdHJp
bmcoSU1BUE9QVF9QT1NUTUFTVEVSKSk7CiAgICAgZnByaW50ZihzbSwgIlRvOiA8JXM+XHJcbiIs
IG9wdGlvbnNbMF0pOwogICAgIGZwcmludGYoc20sICJTdWJqZWN0OiBbU0lFVkVdIE5ldyBtYWls
IG5vdGlmaWNhdGlvblxyXG4iKTsKICAgICBmcHJpbnRmKHNtLCAiXHJcbiIpOwpJbmRleDogbm90
aWZ5ZC9ub3RpZnlkLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9z
eXN0ZW0vY3ZzL3NyYy9jeXJ1cy9ub3RpZnlkL25vdGlmeWQuYyx2CnJldHJpZXZpbmcgcmV2aXNp
b24gMS44CmRpZmYgLXUgLXIxLjggbm90aWZ5ZC5jCi0tLSBub3RpZnlkLmMJMjAwMi8wNi8wMyAx
ODoyMjozNQkxLjgKKysrIG5vdGlmeWQuYwkyMDAyLzA2LzE5IDAwOjI1OjIxCkBAIC0yMTIsNyAr
MjEyLDYgQEAKICAgICBpbnQgb3B0OwogICAgIGNoYXIgKm1ldGhvZCA9ICJudWxsIjsKIAotICAg
IGNvbmZpZ19jaGFuZ2VpZGVudCgibm90aWZ5ZCIpOwogICAgIGlmIChnZXRldWlkKCkgPT0gMCkg
ZmF0YWwoIm11c3QgcnVuIGFzIHRoZSBDeXJ1cyB1c2VyIiwgRUNfVVNBR0UpOwogCiAgICAgd2hp
bGUgKChvcHQgPSBnZXRvcHQoYXJnYywgYXJndiwgIkM6RG06IikpICE9IEVPRikgewpJbmRleDog
dGltc2lldmVkL2FjdGlvbnMuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUu
ZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL3RpbXNpZXZlZC9hY3Rpb25zLmMsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuMzAKZGlmZiAtdSAtcjEuMzAgYWN0aW9ucy5jCi0tLSBhY3Rpb25zLmMJMjAw
Mi8wMi8xOSAxODo1MDoxNQkxLjMwCisrKyBhY3Rpb25zLmMJMjAwMi8wNi8xOSAwMDoxNjozNwpA
QCAtMSw3ICsxLDYgQEAKIC8qIGFjdGlvbnMuYyAtLSBleGVjdXRlcyB0aGUgY29tbWFuZHMgZm9y
IHRpbXNpZXZlZAogICogVGltIE1hcnRpbgogICogJElkOiBhY3Rpb25zLmMsdiAxLjMwIDIwMDIv
MDIvMTkgMTg6NTA6MTUga2VuMyBFeHAgJAotICogCiAgKi8KIC8qCiAgKiBDb3B5cmlnaHQgKGMp
IDE5OTktMjAwMCBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eS4gIEFsbCByaWdodHMgcmVzZXJ2
ZWQuCkBAIC04MSwxMCArODAsMTAgQEAKIHsKICAgaW50IHNpZXZlX3VzZWhvbWVkaXIgPSAwOwog
Ci0gIHNpZXZlX3VzZWhvbWVkaXIgPSBjb25maWdfZ2V0c3dpdGNoKCJzaWV2ZXVzZWhvbWVkaXIi
LCAwKTsKKyAgc2lldmVfdXNlaG9tZWRpciA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9TSUVW
RVVTRUhPTUVESVIpOwogICAKICAgaWYgKCFzaWV2ZV91c2Vob21lZGlyKSB7Ci0gICAgICBzaWV2
ZV9kaXIgPSAoY2hhciAqKSBjb25maWdfZ2V0c3RyaW5nKCJzaWV2ZWRpciIsICIvdXNyL3NpZXZl
Iik7CisgICAgICBzaWV2ZV9kaXIgPSAoY2hhciAqKSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRf
U0lFVkVESVIpOwogICB9IGVsc2UgewogICAgICAgLyogY2FuJ3QgdXNlIGhvbWUgZGlyZWN0b3Jp
ZXMgd2l0aCB0aW1zaWV2ZWQgKi8KICAgICAgIHN5c2xvZyhMT0dfRVJSLCAiY2FuJ3QgdXNlIGhv
bWUgZGlyZWN0b3JpZXMiKTsKQEAgLTE2NSw3ICsxNjQsNyBAQAogICAgIC8qIFNpZXZlIGNhcGFi
aWxpdGllcyAqLwogICAgIHByb3RfcHJpbnRmKGNvbm4sIlwiU0lFVkVcIiBcIiVzXCJcclxuIixz
aWV2ZV9saXN0ZXh0ZW5zaW9ucygpKTsKIAotICAgIGlmICh0bHNfZW5hYmxlZCgic2lldmUiKSkg
eworICAgIGlmICh0bHNfZW5hYmxlZCgpKSB7CiAJcHJvdF9wcmludGYoY29ubiwgIlwiU1RBUlRU
TFNcIlxyXG4iKTsKICAgICB9CiAKQEAgLTI5Miw3ICsyOTEsNyBAQAogCiAgIGVsc2UgewogICAg
ICAgLyogc2VlIGlmIHRoaXMgd291bGQgcHV0IHRoZSB1c2VyIG92ZXIgcXVvdGEgKi8KLSAgICAg
IG1heHNjcmlwdHMgPSBjb25maWdfZ2V0aW50KCJzaWV2ZV9tYXhzY3JpcHRzIiw1KTsKKyAgICAg
IG1heHNjcmlwdHMgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfU0lFVkVfTUFYU0NSSVBUUyk7CiAK
ICAgICAgIGlmIChjb3VudHNjcmlwdHMoc3RyaW5nX0RBVEFQVFIobmFtZSkpKzEgPiBtYXhzY3Jp
cHRzKQogICAgICAgewpAQCAtNTU5LDcgKzU1OCw3IEBACiAgICAgfQogCiAgICAgLyogc2VlIGlm
IHRoZSBzaXplIG9mIHRoZSBzY3JpcHQgaXMgdG9vIGJpZyAqLwotICAgIG1heHNjcmlwdHNpemUg
PSBjb25maWdfZ2V0aW50KCJzaWV2ZV9tYXhzY3JpcHRzaXplIiwgMzIpOworICAgIG1heHNjcmlw
dHNpemUgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfU0lFVkVfTUFYU0NSSVBUU0laRSk7CiAgICAg
bWF4c2NyaXB0c2l6ZSAqPSAxMDI0OwogCiAgICAgaWYgKG51bSA+IG1heHNjcmlwdHNpemUpCkBA
IC01NzIsNyArNTcxLDcgQEAKICAgICB9CiAKICAgICAvKiBzZWUgaWYgdGhpcyB3b3VsZCBwdXQg
dGhlIHVzZXIgb3ZlciBxdW90YSAqLwotICAgIG1heHNjcmlwdHMgPSBjb25maWdfZ2V0aW50KCJz
aWV2ZV9tYXhzY3JpcHRzIiw1KTsKKyAgICBtYXhzY3JpcHRzID0gY29uZmlnX2dldGludChJTUFQ
T1BUX1NJRVZFX01BWFNDUklQVFMpOwogCiAgICAgaWYgKGNvdW50c2NyaXB0cyhzdHJpbmdfREFU
QVBUUihzaWV2ZV9uYW1lKSkrMSA+IG1heHNjcmlwdHMpCiAgICAgewpJbmRleDogdGltc2lldmVk
L2xleC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2
cy9zcmMvY3lydXMvdGltc2lldmVkL2xleC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjE5CmRp
ZmYgLXUgLXIxLjE5IGxleC5jCi0tLSBsZXguYwkyMDAyLzAyLzE2IDIwOjU2OjU2CTEuMTkKKysr
IGxleC5jCTIwMDIvMDYvMTkgMDA6MTg6NDQKQEAgLTYyLDcgKzYyLDcgQEAKICNpbmNsdWRlICJp
bWFwY29uZi5oIgogI2luY2x1ZGUgInhtYWxsb2MuaCIKIAotaW50IHRva2VuX2xvb2t1cCAoY2hh
ciAqc3RyLCBpbnQgbGVuKQoraW50IHRva2VuX2xvb2t1cCAoY2hhciAqc3RyLCBpbnQgbGVuIF9f
YXR0cmlidXRlX18oKHVudXNlZCkpKQogewogICAgIHN3aXRjaCAoKnN0cikgewogICAgIGNhc2Ug
J2EnOgpAQCAtOTUsNyArOTUsNyBAQAogCiAgICAgY2FzZSAncyc6CiAJaWYgKHN0cmNtcChzdHIs
ICJzZXRhY3RpdmUiKT09MCkgcmV0dXJuIFNFVEFDVElWRTsKLQlpZiAoc3RyY21wKHN0ciwgInN0
YXJ0dGxzIik9PTAgJiYgdGxzX2VuYWJsZWQoInNpZXZlIikpCisJaWYgKHN0cmNtcChzdHIsICJz
dGFydHRscyIpPT0wICYmIHRsc19lbmFibGVkKCkpCiAJICAgIHJldHVybiBTVEFSVFRMUzsKIAli
cmVhazsKICAgICB9CkBAIC0xMzYsNyArMTM2LDcgQEAKIAogaW50IGxleF9pbml0KHZvaWQpCiB7
Ci0gIG1heHNjcmlwdHNpemUgPSBjb25maWdfZ2V0aW50KCJzaWV2ZV9tYXhzY3JpcHRzaXplIiwg
MzIpOworICBtYXhzY3JpcHRzaXplID0gY29uZmlnX2dldGludChJTUFQT1BUX1NJRVZFX01BWFND
UklQVFNJWkUpOwogICBtYXhzY3JpcHRzaXplICo9IDEwMjQ7CiAKICAgYnVmZmVyID0gKGNoYXIg
KikgeG1hbGxvYyhtYXhzY3JpcHRzaXplKTsKSW5kZXg6IHRpbXNpZXZlZC9wYXJzZXIuYwo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVz
L3RpbXNpZXZlZC9wYXJzZXIuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4yMApkaWZmIC11IC1y
MS4yMCBwYXJzZXIuYwotLS0gcGFyc2VyLmMJMjAwMi8wNi8wMiAxNToyNTo0NAkxLjIwCisrKyBw
YXJzZXIuYwkyMDAyLzA2LzE5IDAwOjIxOjE1CkBAIC0xMjYsNyArMTI2LDcgQEAKIAogICBpZiAo
IWF1dGhlbnRpY2F0ZWQgJiYgKHRva2VuID4gMjU1KSAmJiAodG9rZW4hPUFVVEhFTlRJQ0FURSkg
JiYKICAgICAgICh0b2tlbiE9TE9HT1VUKSAmJiAodG9rZW4hPUNBUEFCSUxJVFkpICYmCi0gICAg
ICAoIXRsc19lbmFibGVkKCJzaWV2ZSIpIHx8ICh0b2tlbiE9U1RBUlRUTFMpKSkKKyAgICAgICgh
dGxzX2VuYWJsZWQoKSB8fCAodG9rZW4hPVNUQVJUVExTKSkpCiAgIHsKICAgICBlcnJvcl9tc2cg
PSAiQXV0aGVudGljYXRlIGZpcnN0IjsKICAgICBpZiAodG9rZW4hPUVPTCkKSW5kZXg6IHRpbXNp
ZXZlZC90aW1zaWV2ZWQuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1
L3N5c3RlbS9jdnMvc3JjL2N5cnVzL3RpbXNpZXZlZC90aW1zaWV2ZWQuYyx2CnJldHJpZXZpbmcg
cmV2aXNpb24gMS40MApkaWZmIC11IC1yMS40MCB0aW1zaWV2ZWQuYwotLS0gdGltc2lldmVkLmMJ
MjAwMi8wNS8yNSAxOTo1Nzo1MwkxLjQwCisrKyB0aW1zaWV2ZWQuYwkyMDAyLzA2LzE5IDAwOjIw
OjI5CkBAIC0yMDYsNyArMjA2LDcgQEAKICAgICAvKiBjaGVjayBpZiByZW1vdGUgcmVhbG0gKi8K
ICAgICBpZiAoKHJlYWxtID0gc3RyY2hyKGF1dGhfaWRlbnRpdHksICdAJykpIT1OVUxMKSB7CiAJ
cmVhbG0rKzsKLQl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJlYWxtcyIsICIiKTsKKwl2
YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMpOwogCXdoaWxlICgqdmFs
KSB7CiAJICAgIGlmICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3RybGVuKHJlYWxtKSkgJiYK
IAkJKCF2YWxbc3RybGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2YWxbc3RybGVuKHJlYWxt
KV0pKSkgewpAQCAtMjI2LDE2ICsyMjYsMTYgQEAKICAgICBzaWV2ZWRfYXV0aHN0YXRlID0gYXV0
aF9uZXdzdGF0ZShhdXRoX2lkZW50aXR5LCBOVUxMKTsKIAogICAgIC8qIG9rLCBpcyBhdXRoX2lk
ZW50aXR5IGFuIGFkbWluPyAqLwotICAgIHNpZXZlZF91c2VyaXNhZG1pbiA9IGF1dGhpc2Eoc2ll
dmVkX2F1dGhzdGF0ZSwgInNpZXZlIiwgImFkbWlucyIpOworICAgIHNpZXZlZF91c2VyaXNhZG1p
biA9IGNvbmZpZ19hdXRoaXNhKHNpZXZlZF9hdXRoc3RhdGUsIElNQVBPUFRfQURNSU5TKTsKIAog
ICAgIGlmIChzdHJjbXAoYXV0aF9pZGVudGl0eSwgcmVxdWVzdGVkX3VzZXIpKSB7CiAgICAgICAg
IC8qIHdlIHdhbnQgdG8gYXV0aGVudGljYXRlIGFzIGEgZGlmZmVyZW50IHVzZXI7IHdlJ2xsIGFs
bG93IHRoaXMKICAgICAgICAgICAgaWYgd2UncmUgYW4gYWRtaW4gb3IgaWYgd2UndmUgYWxsb3dl
ZCBBQ0wgcHJveHkgbG9naW5zICovCi0gICAgICAgIGludCB1c2VfYWNsID0gY29uZmlnX2dldHN3
aXRjaCgibG9naW51c2VhY2wiLCAwKTsKKyAgICAgICAgaW50IHVzZV9hY2wgPSBjb25maWdfZ2V0
c3dpdGNoKElNQVBPUFRfTE9HSU5VU0VBQ0wpOwogCiAgICAgICAgIGlmIChzaWV2ZWRfdXNlcmlz
YWRtaW4gfHwKICAgICAgICAgICAgICh1c2VfYWNsICYmIGFjbF9vayhyZXF1ZXN0ZWRfdXNlciwg
YXV0aF9pZGVudGl0eSwgc2lldmVkX2F1dGhzdGF0ZSkpIHx8Ci0gICAgICAgICAgICBhdXRoaXNh
KHNpZXZlZF9hdXRoc3RhdGUsICJzaWV2ZSIsICJwcm94eXNlcnZlcnMiKSkgeworICAgICAgICAg
ICAgY29uZmlnX2F1dGhpc2Eoc2lldmVkX2F1dGhzdGF0ZSwgSU1BUE9QVF9QUk9YWVNFUlZFUlMp
KSB7CiAgICAgICAgICAgICAvKiBwcm94eSBvayEgKi8KIAogCSAgICBzaWV2ZWRfdXNlcmlzYWRt
aW4gPSAwOyAvKiBubyBsb25nZXIgYWRtaW4gKi8KQEAgLTI4OSw4ICsyODksNyBAQAogICAgIHNp
ZXZlZF9pbiA9IHByb3RfbmV3KDAsIDApOwogICAgIHNpZXZlZF9vdXQgPSBwcm90X25ldygxLCAx
KTsKIAotICAgIGNvbmZpZ19jaGFuZ2VpZGVudCgidGltc2lldmVkIik7Ci0gICAgdGltZW91dCA9
IGNvbmZpZ19nZXRpbnQoInRpbWVvdXQiLCAxMCk7CisgICAgdGltZW91dCA9IGNvbmZpZ19nZXRp
bnQoSU1BUE9QVF9USU1FT1VUKTsKICAgICBpZiAodGltZW91dCA8IDEwKSB0aW1lb3V0ID0gMTA7
CiAgICAgcHJvdF9zZXR0aW1lb3V0KHNpZXZlZF9pbiwgdGltZW91dCAqIDYwKTsKICAgICBwcm90
X3NldGZsdXNob25yZWFkKHNpZXZlZF9pbiwgc2lldmVkX291dCk7CkBAIC0zNTAsNyArMzQ5LDcg
QEAKIAogICAgIC8qIHdpbGwgYWx3YXlzIHJldHVybiBzb21ldGhpbmcgdmFsaWQgKi8KICAgICAv
KiBzaG91bGQgYmUgY29uZmlndXJhYmxlISAqLwotICAgIGlmICghY29uZmlnX2dldHN3aXRjaCgi
YWxsb3dwbGFpbnRleHQiLCAxKSkgeworICAgIGlmICghY29uZmlnX2dldHN3aXRjaChJTUFQT1BU
X0FMTE9XUExBSU5URVhUKSkgewogCXNlY2ZsYWdzIHw9IFNBU0xfU0VDX05PUExBSU5URVhUOwog
ICAgIH0KICAgICBzZWNwcm9wcyA9IG15c2FzbF9zZWNwcm9wcyhzZWNmbGFncyk7CkBAIC0zODks
NyArMzg4LDcgQEAKIAkJCSAgIHNhc2xwcm9wcy5pcGxvY2FscG9ydCk7CiAgICAgaWYocmV0ICE9
IFNBU0xfT0spIHJldHVybiByZXQ7CiAgICAgCi0gICAgaWYgKCFjb25maWdfZ2V0c3dpdGNoKCJh
bGxvd3BsYWludGV4dCIsIDEpKSB7CisgICAgaWYgKCFjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRf
QUxMT1dQTEFJTlRFWFQpKSB7CiAJc2VjZmxhZ3MgfD0gU0FTTF9TRUNfTk9QTEFJTlRFWFQ7CiAg
ICAgfQogICAgIHNlY3Byb3BzID0gbXlzYXNsX3NlY3Byb3BzKHNlY2ZsYWdzKTsK
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>47</attachid>
            <date>2002-06-18 20:58 EDT</date>
            <desc>Same as previous, except with the added files this time.</desc>
            <filename>imapconfig.patch</filename>
            <type>text/plain</type>
            <size>138388</size>
            <attacher>rjs3@andrew.cmu.edu</attacher>
            
              <data encoding="base64">SW5kZXg6IGRvYy9jaGFuZ2VzLmh0bWwKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcu
Y211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9kb2MvY2hhbmdlcy5odG1sLHYKcmV0cmlldmlu
ZyByZXZpc2lvbiAxLjQwCmRpZmYgLXUgLXIxLjQwIGNoYW5nZXMuaHRtbAotLS0gY2hhbmdlcy5o
dG1sCTIwMDIvMDUvMzEgMTk6MzM6MzYJMS40MAorKysgY2hhbmdlcy5odG1sCTIwMDIvMDYvMTgg
MjA6NTM6MDcKQEAgLTEyLDYgKzEyLDIxIEBACiA8aDI+Q2hhbmdlcyB0byB0aGUgQ3lydXMgSU1B
UCBTZXJ2ZXIgc2luY2UgMi4xLjQ8L2gyPgogCiA8dWw+Cis8bGk+VGhlcmUgaGF2ZSBiZWVuIGV4
dGVuc2l2ZSBwZXJmb3JtYW5jZSBhbmQgY29uc2lzdGFuY3kgY2hhbmdlcyB0bwordGhlIGNvbmZp
Z3VyYXRpb24gc3Vic3lzdGVtLiAgVGhpcyB3aWxsIGJvdGggZW5zdXJlIGdyZWF0ZXIgY29uc2lz
dGFuY3kKK2JldHdlZW4gdGhlIGRvY3VtZW50YXRpb24gYW5kIHRoZSBjb2RlLCBhcyB3ZWxsIGFz
IGEgbW9yZSBzdGFuZGFyZCBmb3JtYXQKK2ZvciBzcGVjaWZpbmcgc2VydmljZS1zcGVjaWZpYyBj
b25maWd1cmF0aW9uIG9wdGlvbnMgaW4gaW1hcGQuY29uZi4gIEltcG9ydGFudAorY2hhbmdlcyBh
cmUgZGV0YWlsZWQgaGVyZToKKzx1bD4KKyAgPGxpPiBUaGUgdGxzX1tzZXJ2aWNlXV8qIGNvbmZp
Z3VyYXRpb24gb3B0aW9ucyBoYXZlIGJlZW4gcmVtb3ZlZC4gIE5vdwordXNlIFtzZXJ2aWNlbmFt
ZV1fdGxzXyosIHdoZXJlIHNlcnZpY2VuYW1lIGlzIHRoZSBzZXJ2aWNlIGlkZW50aWZpZXIgZnJv
bQorY3lydXMuY29uZiBmb3IgdGhhdCBwYXJ0aWN1bGFyIHByb2Nlc3MuPC9saT4KKyAgPGxpPiBB
ZG1pbmlzdHJhdGl2ZSBncm91cHMgKGUuZy4gYWRtaW5zIGFuZCBsbXRwX2FkbWlucykgbm8gbG9u
Z2VyIHVuaW9uLAorc2VydmljZSBncm91cHMgY29tcGxldGVseSBvdmVycmlkZSB0aGUgZ2VuZXJp
YyBncm91cC4gPC9saT4KKyAgPGxpPiBsbXRwX2FsbG93cGxhaW50ZXh0IGlzIG5vIGxvbmdlciBh
IGRlZmluZWQgcGFyYW1ldGVyIGFuZCBtdXN0CitiZSBzcGVjaWZpZWQgdXNpbmcgdGhlIHNlcnZp
Y2UgbmFtZSBvZiB5b3VyIGxtdHAgcHJvY2VzcyBpZiB5b3UKK3JlcXVpcmUgYSBzcGVjaWZpYyB2
YWx1ZTwvbGk+Cis8L3VsPjwvbGk+CiA8bGk+IFNpZXZlIGlzIG5vIGxvbmdlciBkZXBlbmRlbnQg
b24gZHVwbGljYXRlIGRlbGl2ZXJ5IHN1cHByZXNzaW9uCiAoaXQgc3RpbGwgdXNlcyB0aGUgZHVw
bGljYXRlIGRlbGl2ZXJ5IGRhdGFiYXNlIGhvd2V2ZXIpLiA8L2xpPgogCkluZGV4OiBpbWFwL01h
a2VmaWxlLmluCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVt
L2N2cy9zcmMvY3lydXMvaW1hcC9NYWtlZmlsZS5pbix2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4x
NjQKZGlmZiAtdSAtcjEuMTY0IE1ha2VmaWxlLmluCi0tLSBNYWtlZmlsZS5pbgkyMDAyLzA1LzI2
IDAwOjUwOjUyCTEuMTY0CisrKyBNYWtlZmlsZS5pbgkyMDAyLzA2LzE3IDIwOjI5OjExCkBAIC05
NywxMCArOTcsMTEgQEAKIGN5cnVzX3ByZWZpeCA9IEBjeXJ1c19wcmVmaXhACiAKIExPQkpTPSBh
cHBlbmQubyBtYWlsYm94Lm8gbWJveGxpc3QubyBtdXBkYXRlLWNsaWVudC5vIG1ib3huYW1lLm8g
bWVzc2FnZS5vIFwKLQljb25maWcubyBpbWFwX2Vyci5vIG11cGRhdGVfZXJyLm8gcHJvYy5vIHNl
dHByb2N0aXRsZS5vIGNvbnZlcnRfY29kZS5vIFwKLQlkdXBsaWNhdGUubyBzYXNsY2xpZW50Lm8g
YWNhcG1ib3gubyBzaWduYWxzLm8gYW5ub3RhdGUubyBcCi0Jc2VhcmNoX2VuZ2luZXMubyBzcXVh
dC5vIHNxdWF0X2ludGVybmFsLm8gbWJkdW1wLm8gXAotCWJhc2U2NC5vIGltYXBwYXJzZS5vIHRl
bGVtZXRyeS5vIHVzZXIubyBub3RpZnkubyAkKFNFRU4pICQoSURMRSkKKwljb25maWcubyBpbWFw
X2Vyci5vIG11cGRhdGVfZXJyLm8gcHJvYy5vIHNldHByb2N0aXRsZS5vIFwKKwljb252ZXJ0X2Nv
ZGUubyBkdXBsaWNhdGUubyBzYXNsY2xpZW50Lm8gYWNhcG1ib3gubyBzaWduYWxzLm8gXAorCWFu
bm90YXRlLm8gc2VhcmNoX2VuZ2luZXMubyBzcXVhdC5vIHNxdWF0X2ludGVybmFsLm8gbWJkdW1w
Lm8gXAorCWJhc2U2NC5vIGltYXBwYXJzZS5vIHRlbGVtZXRyeS5vIHVzZXIubyBub3RpZnkubyBp
bWFwb3B0cy5vIFwKKwkkKFNFRU4pICQoSURMRSkKIAogSU1BUERPQkpTPXB1c2hzdGF0cy5vIGJh
Y2tlbmQubyBpbWFwZC5vIGluZGV4Lm8gdGxzLm8gdmVyc2lvbi5vCiAKQEAgLTExOCw3ICsxMTks
OCBAQAogCUBJTUFQX1BST0dTQAogCiBCVUlMVFNPVVJDRVMgPSBpbWFwX2Vyci5jIGltYXBfZXJy
LmggcHVzaHN0YXRzLmMgcHVzaHN0YXRzLmggXAotCWxtdHBzdGF0cy5jIGxtdHBzdGF0cy5oIHh2
ZXJzaW9uLmggbXVwZGF0ZV9lcnIuYyBtdXBkYXRlX2Vyci5oCisJbG10cHN0YXRzLmMgbG10cHN0
YXRzLmggeHZlcnNpb24uaCBtdXBkYXRlX2Vyci5jIG11cGRhdGVfZXJyLmggXAorCWltYXBvcHRz
LmggaW1hcG9wdHMuYwogCiBhbGw6ICQoQlVJTFRTT1VSQ0VTKSAkKFBST0dTKSAkKFNVSURQUk9H
UykKIApAQCAtMTU3LDYgKzE1OSw5IEBACiAKIGxtdHBzdGF0cy5jIGxtdHBzdGF0cy5oOiBsbXRw
c3RhdHMuc25tcCAkKHNyY2RpcikvLi4vc25tcC9zbm1wZ2VuCiAJJChzcmNkaXIpLy4uL3NubXAv
c25tcGdlbiAkKHNyY2RpcikvbG10cHN0YXRzLnNubXAKKworaW1hcG9wdHMuYyBpbWFwb3B0cy5o
OiBpbWFwb3B0aW9ucyAkKHNyY2RpcikvLi4vdG9vbHMvY29uZmlnMmhlYWRlcgorCSQoc3JjZGly
KS8uLi90b29scy9jb25maWcyaGVhZGVyICQoc3JjZGlyKS9pbWFwb3B0cy5jICQoc3JjZGlyKS9p
bWFwb3B0cy5oIDwgJChzcmNkaXIpL2ltYXBvcHRpb25zCiAKIGNvbGxlY3RuZXdzOiBjb2xsZWN0
bmV3cy5vIGxpYmltYXAuYSAkKERFUExJQlMpCiAJJChDQykgJChMREZMQUdTKSAtbyBjb2xsZWN0
bmV3cyBjb2xsZWN0bmV3cy5vIGxpYmltYXAuYSAkKERFUExJQlMpIFwKSW5kZXg6IGltYXAvYWNh
cG1ib3guYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9j
dnMvc3JjL2N5cnVzL2ltYXAvYWNhcG1ib3guYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zMQpk
aWZmIC11IC1yMS4zMSBhY2FwbWJveC5jCi0tLSBhY2FwbWJveC5jCTIwMDIvMDUvMjUgMTk6NTc6
NDMJMS4zMQorKysgYWNhcG1ib3guYwkyMDAyLzA2LzE4IDIwOjM3OjIwCkBAIC0xMDUsOCArMTA1
LDggQEAKIAlzdHJjYXQocG9zdGFkZHIsICJAIik7CiAJc3RyY2F0KHBvc3RhZGRyLCBzZXJ2ZXIp
OwogICAgIH0gZWxzZSB7Ci0JY29uc3QgY2hhciAqcG9zdHNwZWMgPSBjb25maWdfZ2V0c3RyaW5n
KCJwb3N0c3BlYyIsIE5VTEwpOwotCWNvbnN0IGNoYXIgKkJCID0gY29uZmlnX2dldHN0cmluZygi
cG9zdHVzZXIiLCAiYmIiKTsKKwljb25zdCBjaGFyICpwb3N0c3BlYyA9IGNvbmZpZ19nZXRzdHJp
bmcoSU1BUE9QVF9QT1NUU1BFQyk7CisJY29uc3QgY2hhciAqQkIgPSBjb25maWdfZ2V0c3RyaW5n
KElNQVBPUFRfUE9TVFVTRVIpOwogCiAJaWYgKHBvc3RzcGVjKSB7CiAJICAgIHNucHJpbnRmKHBv
c3RhZGRyLCBzaXplb2YocG9zdGFkZHIpLCBwb3N0c3BlYywgbmFtZSk7CkBAIC0xNzYsNyArMTc2
LDcgQEAKICAgICBjb25zdCBjaGFyICphdXRocHJvZzsKICAgICBzYXNsX2NhbGxiYWNrX3QgKmNi
OwogICAgIAotICAgIGFjYXBzZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKCJhY2FwX3NlcnZlciIs
IE5VTEwpOworICAgIGFjYXBzZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQUNBUF9T
RVJWRVIpOwogICAgIGlmICghYWNhcHNlcnZlcikgcmV0dXJuIE5VTEw7CiAKICAgICBpZiAoY2Fj
aGVkX2Nvbm4pIHsKQEAgLTE5NywyMSArMTk3LDIxIEBACiAgICAgY2FjaGVkX2Nvbm4gPSAoYWNh
cG1ib3hfaGFuZGxlX3QgKikgeG1hbGxvYyhzaXplb2YoYWNhcG1ib3hfaGFuZGxlX3QpKTsKICAg
ICBjYWNoZWRfY29ubi0+Y29ubiA9IE5VTEw7CiAgICAgCi0gICAgdXNlciA9IGNvbmZpZ19nZXRz
dHJpbmcoImFjYXBfdXNlcm5hbWUiLCBOVUxMKTsKKyAgICB1c2VyID0gY29uZmlnX2dldHN0cmlu
ZyhJTUFQT1BUX0FDQVBfVVNFUk5BTUUpOwogICAgIGlmICh1c2VyID09IE5VTEwpIHsKIAlzeXNs
b2coTE9HX0VSUiwgInVuYWJsZSB0byBmaW5kIG9wdGlvbiBhY2FwX3VzZXJuYW1lIik7CiAJcmV0
dXJuIGNhY2hlZF9jb25uOwogICAgIH0KIAotICAgIGF1dGhwcm9nID0gY29uZmlnX2dldHN0cmlu
ZygiYWNhcF9nZXRhdXRoIiwgTlVMTCk7CisgICAgYXV0aHByb2cgPSBjb25maWdfZ2V0c3RyaW5n
KElNQVBPUFRfQUNBUF9HRVRBVVRIKTsKICAgICBpZiAoYXV0aHByb2cpIHsKIAlzeXN0ZW0oYXV0
aHByb2cpOwogICAgIH0KIAogICAgIGNiID0gbXlzYXNsX2NhbGxiYWNrcyh1c2VyLAotCQkJICBj
b25maWdfZ2V0c3RyaW5nKCJhY2FwX2F1dGhuYW1lIiwgdXNlciksCi0JCQkgIGNvbmZpZ19nZXRz
dHJpbmcoImFjYXBfcmVhbG0iLCBOVUxMKSwKLQkJCSAgY29uZmlnX2dldHN0cmluZygiYWNhcF9w
YXNzd29yZCIsIE5VTEwpKTsKKwkJCSAgY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0FDQVBfQVVU
SE5BTUUpLAorCQkJICBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQUNBUF9SRUFMTSksCisJCQkg
IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9BQ0FQX1BBU1NXT1JEKSk7CiAgICAgc25wcmludGYo
c3RyLCBzaXplb2Yoc3RyKSwgImFjYXA6Ly8lc0Alcy8iLCB1c2VyLCBhY2Fwc2VydmVyKTsKICAg
ICByID0gYWNhcF9jb25uX2Nvbm5lY3Qoc3RyLCBjYiwgJihjYWNoZWRfY29ubi0+Y29ubikpOwog
ICAgIGZyZWVfY2FsbGJhY2tzKGNiKTsKSW5kZXg6IGltYXAvYmFja2VuZC5jCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
UkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9i
YWNrZW5kLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNwpkaWZmIC11IC1yMS43IGJhY2tlbmQu
YwotLS0gYmFja2VuZC5jCTIwMDIvMDUvMDYgMTc6MTg6NDkJMS43CisrKyBiYWNrZW5kLmMJMjAw
Mi8wNi8xOCAxOTo1Nzo0OApAQCAtMjM0LDEwICsyMzQsMTEgQEAKICAgICBwID0gc3RyY2hyKG9w
dHN0ciwgJy4nKTsKICAgICBpZiAocCkgKnAgPSAnXDAnOwogICAgIHN0cmNhdChvcHRzdHIsICJf
cGFzc3dvcmQiKTsKLSAgICBwYXNzID0gY29uZmlnX2dldHN0cmluZyhvcHRzdHIsIE5VTEwpOwor
ICAgIHBhc3MgPSBjb25maWdfZ2V0b3ZlcmZsb3dzdHJpbmcob3B0c3RyLCBOVUxMKTsKKyAgICBp
ZighcGFzcykgcGFzcyA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9QQVNTV09SRCk7
CiAgICAgY2IgPSBteXNhc2xfY2FsbGJhY2tzKHVzZXJpZCwgCi0JCQkgIGNvbmZpZ19nZXRzdHJp
bmcoInByb3h5X2F1dGhuYW1lIiwgInByb3h5IiksCi0JCQkgIGNvbmZpZ19nZXRzdHJpbmcoInBy
b3h5X3JlYWxtIiwgTlVMTCksCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9B
VVRITkFNRSksCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9SRUFMTSksCiAJ
CQkgIHBhc3MpOwogCiAgICAgLyogc2V0IHRoZSBJUCBhZGRyZXNzZXMgKi8KQEAgLTI4MSw3ICsy
ODIsNyBAQAogICAgIHAgPSBzdHJjaHIoYnVmLCAnLicpOwogICAgICpwID0gJ1wwJzsKICAgICBz
dHJjYXQoYnVmLCAiX21lY2hzIik7Ci0gICAgbWVjaF9jb25mID0gY29uZmlnX2dldHN0cmluZyhi
dWYsIE5VTEwpOworICAgIG1lY2hfY29uZiA9IGNvbmZpZ19nZXRvdmVyZmxvd3N0cmluZyhidWYs
IE5VTEwpOwogICAgIAogICAgIC8qIElmIHdlIGRvbid0IGhhdmUgYSBtZWNoX2NvbmYsIGFzayB0
aGUgc2VydmVyIHdoYXQgaXQgY2FuIGRvICovCiAgICAgaWYoIW1lY2hfY29uZikgewpJbmRleDog
aW1hcC9jb25maWcuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5
c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvY29uZmlnLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEu
NTUKZGlmZiAtdSAtcjEuNTUgY29uZmlnLmMKLS0tIGNvbmZpZy5jCTIwMDIvMDYvMTggMTY6NDA6
MTkJMS41NQorKysgY29uZmlnLmMJMjAwMi8wNi8xOCAyMDozMzozOApAQCAtNTcsNiArNTcsNyBA
QAogI2VuZGlmCiAKICNpbmNsdWRlICJpbWFwY29uZi5oIgorI2luY2x1ZGUgImltYXBvcHRzLmgi
CiAjaW5jbHVkZSAiZXhpdGNvZGVzLmgiCiAjaW5jbHVkZSAieG1hbGxvYy5oIgogI2luY2x1ZGUg
Im1ib3hsaXN0LmgiCkBAIC03MCwxOSArNzEsMTkgQEAKIAogI2RlZmluZSBDT05GSUdfRklMRU5B
TUUgIi9ldGMvaW1hcGQuY29uZiIKIAotI2RlZmluZSBDT05GSUdIQVNIU0laRSAyMDAgLyogPiAy
eCAjIG9mIG9wdGlvbnMgKi8KKyNkZWZpbmUgQ09ORklHSEFTSFNJWkUgMzAgLyogcmVsYXRpdmVs
eSBzbWFsbCwKKwkJCSAgICogYmVjYXVzZSBpdCBpcyBmb3Igb3ZlcmZsb3cgb25seSAqLwogc3Rh
dGljIHN0cnVjdCBoYXNoX3RhYmxlIGNvbmZpZ2hhc2g7CiAKIC8qIGNhY2hlZCBjb25maWd1cmF0
aW9uIHZhcmlhYmxlcyBhY2Nlc3NpYmxlIHRvIHRoZSBleHRlcm5hbCB3b3JsZCAqLwogY29uc3Qg
Y2hhciAqY29uZmlnX2ZpbGVuYW1lOyAgICAgLyogZmlsZW5hbWUgb2YgY29uZmlndXJhdGlvbiBm
aWxlICovCiBjb25zdCBjaGFyICpjb25maWdfZGlyOwkJICAgICAgICAgICAvKiBpZSAvdmFyL2lt
YXAgKi8KIGNvbnN0IGNoYXIgKmNvbmZpZ19kZWZwYXJ0aXRpb247ICAgICAgICAgICAvKiAvdmFy
L3Nwb29sL2ltYXAgKi8KLWNvbnN0IGNoYXIgKmNvbmZpZ19uZXdzc3Bvb2w7CSAgICAgICAgICAg
LyogL3Zhci9zcG9vbC9uZXdzICovCiBjb25zdCBjaGFyICpjb25maWdfc2VydmVybmFtZTsJICAg
ICAgICAgICAvKiBnZXRob3N0bmFtZSgpICovCiBjb25zdCBjaGFyICpjb25maWdfbXVwZGF0ZV9z
ZXJ2ZXI7ICAgICAgICAgLyogTlVMTCAqLwogaW50IGNvbmZpZ19oYXNoaW1hcHNwb29sOwkgICAg
ICAgICAgIC8qIGYgKi8KIAotc3RhdGljIHZvaWQgY29uZmlnX3JlYWQoY29uc3QgY2hhciAqYWx0
X2NvbmZpZyk7CitzdGF0aWMgdm9pZCBjb25maWdfcmVhZChjb25zdCBjaGFyICphbHRfY29uZmln
LCBjb25zdCBjaGFyICppZGVudCk7CiAKIGludCBjb25maWdfaW5pdChjb25zdCBjaGFyICphbHRf
Y29uZmlnLCBjb25zdCBjaGFyICppZGVudCkKIHsKQEAgLTEwMCwxNyArMTAxLDExIEBACiAJZmF0
YWwoImNvdWxkIG5vdCBjb25zdHJ1Y3QgY29uZmlndXJhdGlvbiBoYXNoIHRhYmxlIiwgRUNfQ09O
RklHKTsKICAgICB9CiAKLSAgICBjb25maWdfcmVhZChhbHRfY29uZmlnKTsKKyAgICAvKiBMb2Fk
IGNvbmZpZ3VyYXRpb24gZmlsZS4gIFRoaXMgd2lsbCBzZXQgY29uZmlnX2RpciB3aGVuIGl0IGZp
bmRzIGl0ICovCisgICAgY29uZmlnX3JlYWQoYWx0X2NvbmZpZywgaWRlbnQpOwogCi0gICAgLyog
TG9vayB1cCBjb25maWdkaXJlY3RvcnkgY29uZmlnIG9wdGlvbiAqLwotICAgIGNvbmZpZ19kaXIg
PSBjb25maWdfZ2V0c3RyaW5nKCJjb25maWdkaXJlY3RvcnkiLCAoY2hhciAqKTApOwotICAgIGlm
ICghY29uZmlnX2RpcikgewotCWZhdGFsKCJjb25maWdkaXJlY3Rvcnkgb3B0aW9uIG5vdCBzcGVj
aWZpZWQgaW4gY29uZmlndXJhdGlvbiBmaWxlIiwKLQkgICAgICBFQ19DT05GSUcpOwotICAgIH0K
LQogICAgIC8qIExvb2sgdXAgZGVmYXVsdCBwYXJ0aXRpb24gKi8KLSAgICBjb25maWdfZGVmcGFy
dGl0aW9uID0gY29uZmlnX2dldHN0cmluZygiZGVmYXVsdHBhcnRpdGlvbiIsICJkZWZhdWx0Iik7
CisgICAgY29uZmlnX2RlZnBhcnRpdGlvbiA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9ERUZB
VUxUUEFSVElUSU9OKTsKICAgICBmb3IgKHAgPSAoY2hhciAqKWNvbmZpZ19kZWZwYXJ0aXRpb247
ICpwOyBwKyspIHsKIAlpZiAoIWlzYWxudW0oKHVuc2lnbmVkIGNoYXIpICpwKSkKIAkgIGZhdGFs
KCJkZWZhdWx0cGFydGl0aW9uIG9wdGlvbiBjb250YWlucyBub24tYWxwaGFudW1lcmljIGNoYXJh
Y3RlciIsCkBAIC0xMjQsNzIgKzExOSw1OSBAQAogICAgIH0KIAogICAgIC8qIExvb2sgdXAgdW1h
c2sgKi8KLSAgICB2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJ1bWFzayIsICIwNzciKTsKKyAgICB2
YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfVU1BU0spOwogICAgIHdoaWxlICgqdmFsKSB7
CiAJaWYgKCp2YWwgPj0gJzAnICYmICp2YWwgPD0gJzcnKSB1bWFza3ZhbCA9IHVtYXNrdmFsKjgg
KyAqdmFsIC0gJzAnOwogCXZhbCsrOwogICAgIH0KICAgICB1bWFzayh1bWFza3ZhbCk7CiAKLSAg
ICAvKiBMb29rIHVwIG5ld3Mgc3Bvb2wgKi8KLSAgICBjb25maWdfbmV3c3Nwb29sID0gY29uZmln
X2dldHN0cmluZygibmV3c3Nwb29sIiwgMCk7Ci0KICAgICAvKiBsb29rIHVwIG1haWxib3ggaGFz
aGluZyAqLwotICAgIGNvbmZpZ19oYXNoaW1hcHNwb29sID0gY29uZmlnX2dldHN3aXRjaCgiaGFz
aGltYXBzcG9vbCIsIDApOworICAgIGNvbmZpZ19oYXNoaW1hcHNwb29sID0gY29uZmlnX2dldHN3
aXRjaChJTUFQT1BUX0hBU0hJTUFQU1BPT0wpOwogCiAgICAgLyogbG9vayB1cCB0aGUgaG9zdG5h
bWUgd2Ugc2hvdWxkIHByZXNlbnQgdG8gdGhlIHVzZXIgKi8KLSAgICBjb25maWdfc2VydmVybmFt
ZSA9IGNvbmZpZ19nZXRzdHJpbmcoInNlcnZlcm5hbWUiLCAwKTsKKyAgICBjb25maWdfc2VydmVy
bmFtZSA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9TRVJWRVJOQU1FKTsKICAgICBpZiAoIWNv
bmZpZ19zZXJ2ZXJuYW1lKSB7CiAJY29uZmlnX3NlcnZlcm5hbWUgPSB4bWFsbG9jKHNpemVvZihj
aGFyKSAqIDI1Nik7CiAJZ2V0aG9zdG5hbWUoKGNoYXIgKikgY29uZmlnX3NlcnZlcm5hbWUsIDI1
Nik7CiAgICAgfQogCi0gICAgY29uZmlnX211cGRhdGVfc2VydmVyID0gY29uZmlnX2dldHN0cmlu
ZygibXVwZGF0ZV9zZXJ2ZXIiLCBOVUxMKTsKKyAgICBjb25maWdfbXVwZGF0ZV9zZXJ2ZXIgPSBj
b25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTVVQREFURV9TRVJWRVIpOwogCiAgICAgcmV0dXJuIDA7
CiB9CiAKLWludCBjb25maWdfY2hhbmdlaWRlbnQoY29uc3QgY2hhciAqaWRlbnQpCitjb25zdCBj
aGFyICpjb25maWdfZ2V0c3RyaW5nKGVudW0gaW1hcG9wdCBvcHQpCiB7Ci0gICAgY2xvc2Vsb2co
KTsKLSAgICBvcGVubG9nKGlkZW50LCBMT0dfUElELCBMT0dfTE9DQUw2KTsKLSAgICByZXR1cm4g
MDsKKyAgICBhc3NlcnQob3B0ID4gSU1BUE9QVF9aRVJPICYmIG9wdCA8IElNQVBPUFRfTEFTVCk7
CisgICAgYXNzZXJ0KGltYXBvcHRzW29wdF0udCA9PSBPUFRfU1RSSU5HKTsKKyAgICAKKyAgICBy
ZXR1cm4gaW1hcG9wdHNbb3B0XS52YWwuczsKIH0KIAotY29uc3QgY2hhciAqY29uZmlnX2dldHN0
cmluZyhjb25zdCBjaGFyICprZXksIGNvbnN0IGNoYXIgKmRlZikKK2ludCBjb25maWdfZ2V0aW50
KGVudW0gaW1hcG9wdCBvcHQpCiB7Ci0gICAgY2hhciAqcmV0OworICAgIGFzc2VydChvcHQgPiBJ
TUFQT1BUX1pFUk8gJiYgb3B0IDwgSU1BUE9QVF9MQVNUKTsKKyAgICBhc3NlcnQoaW1hcG9wdHNb
b3B0XS50ID09IE9QVF9JTlQpOwogCi0gICAgcmV0ID0gaGFzaF9sb29rdXAoa2V5LCAmY29uZmln
aGFzaCk7Ci0KLSAgICByZXR1cm4gcmV0ID8gcmV0IDogZGVmOworICAgIHJldHVybiBpbWFwb3B0
c1tvcHRdLnZhbC5pOwogfQogCi1pbnQgY29uZmlnX2dldGludChjb25zdCBjaGFyICprZXksIGlu
dCBkZWYpCitpbnQgY29uZmlnX2dldHN3aXRjaChlbnVtIGltYXBvcHQgb3B0KQogewotICAgIGNv
bnN0IGNoYXIgKnZhbCA9IGNvbmZpZ19nZXRzdHJpbmcoa2V5LCAoY2hhciAqKTApOwotCi0gICAg
aWYgKCF2YWwpIHJldHVybiBkZWY7Ci0gICAgaWYgKCFpc2RpZ2l0KChpbnQpICp2YWwpICYmICgq
dmFsICE9ICctJyB8fCAhaXNkaWdpdCgoaW50KSB2YWxbMV0pKSkgCi0JcmV0dXJuIGRlZjsKLSAg
ICByZXR1cm4gYXRvaSh2YWwpOworICAgIGFzc2VydChvcHQgPiBJTUFQT1BUX1pFUk8gJiYgb3B0
IDwgSU1BUE9QVF9MQVNUKTsKKyAgICBhc3NlcnQoaW1hcG9wdHNbb3B0XS50ID09IE9QVF9TV0lU
Q0gpOworICAgIAorICAgIHJldHVybiBpbWFwb3B0c1tvcHRdLnZhbC5iOwogfQogCi1pbnQgY29u
ZmlnX2dldHN3aXRjaChjb25zdCBjaGFyICprZXksIGludCBkZWYpCitjb25zdCBjaGFyICpjb25m
aWdfZ2V0b3ZlcmZsb3dzdHJpbmcoY29uc3QgY2hhciAqa2V5LCBjb25zdCBjaGFyICpkZWYpCiB7
Ci0gICAgY29uc3QgY2hhciAqdmFsID0gY29uZmlnX2dldHN0cmluZyhrZXksIChjaGFyICopMCk7
CisgICAgY2hhciAqcmV0OwogCi0gICAgaWYgKCF2YWwpIHJldHVybiBkZWY7CisgICAgcmV0ID0g
aGFzaF9sb29rdXAoa2V5LCAmY29uZmlnaGFzaCk7CiAKLSAgICBpZiAoKnZhbCA9PSAnMCcgfHwg
KnZhbCA9PSAnbicgfHwKLQkoKnZhbCA9PSAnbycgJiYgdmFsWzFdID09ICdmJykgfHwgKnZhbCA9
PSAnZicpIHsKLQlyZXR1cm4gMDsKLSAgICB9Ci0gICAgZWxzZSBpZiAoKnZhbCA9PSAnMScgfHwg
KnZhbCA9PSAneScgfHwKLQkgICAgICgqdmFsID09ICdvJyAmJiB2YWxbMV0gPT0gJ24nKSB8fCAq
dmFsID09ICd0JykgewotCXJldHVybiAxOwotICAgIH0KLSAgICByZXR1cm4gZGVmOworICAgIHJl
dHVybiByZXQgPyByZXQgOiBkZWY7CiB9CiAKIGNvbnN0IGNoYXIgKmNvbmZpZ19wYXJ0aXRpb25k
aXIoY29uc3QgY2hhciAqcGFydGl0aW9uKQpAQCAtMjAwLDc1ICsxODIsMjM4IEBACiAgICAgc3Ry
Y3B5KGJ1ZiwgInBhcnRpdGlvbi0iKTsKICAgICBzdHJjYXQoYnVmLCBwYXJ0aXRpb24pOwogCi0g
ICAgcmV0dXJuIGNvbmZpZ19nZXRzdHJpbmcoYnVmLCAoY2hhciAqKTApOworICAgIHJldHVybiBj
b25maWdfZ2V0b3ZlcmZsb3dzdHJpbmcoYnVmLCBOVUxMKTsKIH0KIAotc3RhdGljIHZvaWQgY29u
ZmlnX3JlYWQoY29uc3QgY2hhciAqYWx0X2NvbmZpZykKK3N0YXRpYyB2b2lkIGNvbmZpZ19yZWFk
KGNvbnN0IGNoYXIgKmFsdF9jb25maWcsIGNvbnN0IGNoYXIgKmlkZW50KQogewogICAgIEZJTEUg
KmluZmlsZTsKKyAgICBlbnVtIG9wdHR5cGUgb3B0OwogICAgIGludCBsaW5lbm8gPSAwOwotICAg
IGNoYXIgYnVmWzQwOTZdOwotICAgIGNoYXIgKnAsICpxLCAqa2V5LCAqdmFsLCAqbmV3dmFsOwor
ICAgIGNoYXIgYnVmWzQwOTZdLCBlcnJidWZbMTAyNF07CisgICAgY2hhciAqcCwgKnEsICprZXks
ICpmdWxsa2V5LCAqdmFsLCAqbmV3dmFsOworICAgIGludCBzZXJ2aWNlX3NwZWNpZmljOworICAg
IGludCBpZGxlbiA9IGlkZW50ID8gc3RybGVuKGlkZW50KSA6IDA7CiAKICAgICBpZihhbHRfY29u
ZmlnKSBjb25maWdfZmlsZW5hbWUgPSB4c3RyZHVwKGFsdF9jb25maWcpOwogICAgIGVsc2UgY29u
ZmlnX2ZpbGVuYW1lID0geHN0cmR1cChDT05GSUdfRklMRU5BTUUpOwogCi0gICAgaW5maWxlID0g
Zm9wZW4oYWx0X2NvbmZpZyA/IGFsdF9jb25maWcgOiBDT05GSUdfRklMRU5BTUUsICJyIik7Cisg
ICAgLyogcmVhZCBpbiBjb25maWcgZmlsZSAqLworICAgIGluZmlsZSA9IGZvcGVuKGNvbmZpZ19m
aWxlbmFtZSwgInIiKTsKICAgICBpZiAoIWluZmlsZSkgewogCXN0cmNweShidWYsIENZUlVTX1BB
VEgpOwotCXN0cmNhdChidWYsIGFsdF9jb25maWcgPyBhbHRfY29uZmlnIDogQ09ORklHX0ZJTEVO
QU1FKTsKKwlzdHJjYXQoYnVmLCBjb25maWdfZmlsZW5hbWUpOwogCWluZmlsZSA9IGZvcGVuKGJ1
ZiwgInIiKTsKICAgICB9CiAgICAgaWYgKCFpbmZpbGUpIHsKLQlzcHJpbnRmKGJ1ZiwgImNhbid0
IG9wZW4gY29uZmlndXJhdGlvbiBmaWxlICVzOiAlcyIsCi0JCWFsdF9jb25maWcgPyBhbHRfY29u
ZmlnIDogQ09ORklHX0ZJTEVOQU1FLAotCQllcnJvcl9tZXNzYWdlKGVycm5vKSk7CisJc3ByaW50
ZihlcnJidWYsICJjYW4ndCBvcGVuIGNvbmZpZ3VyYXRpb24gZmlsZSAlczogJXMiLAorCQljb25m
aWdfZmlsZW5hbWUsIGVycm9yX21lc3NhZ2UoZXJybm8pKTsKIAlmYXRhbChidWYsIEVDX0NPTkZJ
Ryk7CiAgICAgfQogICAgIAogICAgIHdoaWxlIChmZ2V0cyhidWYsIHNpemVvZihidWYpLCBpbmZp
bGUpKSB7CiAJbGluZW5vKys7CiAKKwlzZXJ2aWNlX3NwZWNpZmljID0gMDsKKwkKIAlpZiAoYnVm
W3N0cmxlbihidWYpLTFdID09ICdcbicpIGJ1ZltzdHJsZW4oYnVmKS0xXSA9ICdcMCc7CiAJZm9y
IChwID0gYnVmOyAqcCAmJiBpc3NwYWNlKChpbnQpICpwKTsgcCsrKTsKIAlpZiAoISpwIHx8ICpw
ID09ICcjJykgY29udGludWU7CiAKLQlrZXkgPSBwOworCWZ1bGxrZXkgPSBrZXkgPSBwOwogCXdo
aWxlICgqcCAmJiAoaXNhbG51bSgoaW50KSAqcCkgfHwgKnAgPT0gJy0nIHx8ICpwID09ICdfJykp
IHsKIAkgICAgaWYgKGlzdXBwZXIoKHVuc2lnbmVkIGNoYXIpICpwKSkgKnAgPSB0b2xvd2VyKCh1
bnNpZ25lZCBjaGFyKSAqcCk7CiAJICAgIHArKzsKIAl9CiAJaWYgKCpwICE9ICc6JykgewotCSAg
ICBzcHJpbnRmKGJ1ZiwKKwkgICAgc3ByaW50ZihlcnJidWYsCiAJCSAgICAiaW52YWxpZCBvcHRp
b24gbmFtZSBvbiBsaW5lICVkIG9mIGNvbmZpZ3VyYXRpb24gZmlsZSIsCiAJCSAgICBsaW5lbm8p
OwogCSAgICBmYXRhbChidWYsIEVDX0NPTkZJRyk7CiAJfQogCSpwKysgPSAnXDAnOwotCisJCiAJ
d2hpbGUgKCpwICYmIGlzc3BhY2UoKGludCkgKnApKSBwKys7Ci0KKwkKIAkvKiByZW1vdmUgdHJh
aWxpbmcgd2hpdGVzcGFjZSAqLwogCWZvciAocSA9IHAgKyBzdHJsZW4ocCkgLSAxOyBxID4gcCAm
JiBpc3NwYWNlKChpbnQpICpxKTsgcS0tKSB7CiAJICAgICpxID0gJ1wwJzsKIAl9CiAJCiAJaWYg
KCEqcCkgewotCSAgICBzcHJpbnRmKGJ1ZiwgImVtcHR5IG9wdGlvbiB2YWx1ZSBvbiBsaW5lICVk
IG9mIGNvbmZpZ3VyYXRpb24gZmlsZSIsCisJICAgIHNwcmludGYoZXJyYnVmLAorCQkgICAgImVt
cHR5IG9wdGlvbiB2YWx1ZSBvbiBsaW5lICVkIG9mIGNvbmZpZ3VyYXRpb24gZmlsZSIsCiAJCSAg
ICBsaW5lbm8pOwogCSAgICBmYXRhbChidWYsIEVDX0NPTkZJRyk7CiAJfQorCQorICAgICAgICAv
KiBsb29rIGZvciBzZXJ2aWNlXyBwcmVmaXgsIHNraXAgb3ZlciBpdCBpZiBpdCBleGlzdHMgKi8K
KwlpZiAoaWRlbnQgJiYgIXN0cm5jYXNlY21wKGtleSwgaWRlbnQsIGlkbGVuKSAKKwkgICAgJiYg
a2V5W2lkbGVuXSA9PSAnXycpIHsKKwkgICAgLyogc2tpcCBzZXJ2aWNlXyBwcmVmaXggKi8KKwkg
ICAga2V5ICs9IGlkbGVuICsgMTsKKwkgICAgc2VydmljZV9zcGVjaWZpYyA9IDE7CisJfQogCi0J
bmV3dmFsID0geHN0cmR1cChwKTsKLQl2YWwgPSBoYXNoX2luc2VydChrZXksIG5ld3ZhbCwgJmNv
bmZpZ2hhc2gpOwotCWlmKHZhbCAhPSBuZXd2YWwpIHsKLQkgICAgY2hhciBlcnJidWZbNDA5Nl07
Ci0JICAgIHNwcmludGYoZXJyYnVmLCAib3B0aW9uICclcycgd2FzIHNwZWNpZmllZCB0d2ljZSBp
biBjb25maWcgZmlsZSIsCi0JCSAgICBrZXkpOwotCSAgICBmYXRhbChlcnJidWYsIEVDX0NPTkZJ
Ryk7CisJLyogbG9vayBmb3IgdGhlIGNvcnJlc3BvbmRpbmcgZW50cnkgaW4gaW1hcG9wdHMgKi8K
KwkvKiB4eHggYXMgbG9uZyBhcyB3ZSBrbm93IHRoaXMgbGlzdCBpcyBzb3J0ZWQgd2UgY291bGQg
cHJvYmFibGx5CisJICogYmUgbW9yZSBlZmZpY2llbnQgYWJvdXQgdGhpcyAqLworCWZvciAob3B0
ID0gSU1BUE9QVF9aRVJPOyBvcHQgPCBJTUFQT1BUX0xBU1Q7IG9wdCsrKSB7CisJICAgIGlmICgh
c3RyY2FzZWNtcChpbWFwb3B0c1tvcHRdLm9wdG5hbWUsIGtleSkpIHsKKwkJYnJlYWs7CisJICAg
IH0KIAl9CisKKwlpZiAob3B0IDwgSU1BUE9QVF9MQVNUKSB7CisJICAgIC8qIE9rYXksIHdlIGtu
b3cgYWJvdXQgdGhpcyBjb25maWd1cmUgb3B0aW9uLgorCSAgICAgKiBTbyBmaXJzdCBjaGVjayB0
aGF0IHdlIGhhdmUgZWl0aGVyCisJICAgICAqICAxLiBub3Qgc2VlbiBpdAorCSAgICAgKiAgMi4g
c2VlbiBpdHMgZ2VuZXJpYyBmb3JtLCBidXQgdGhpcyBpcyBhIHNlcnZpY2Ugc3BlY2lmaWMgZm9y
bQorCSAgICAgKgorCSAgICAgKiAgSWYgd2UgaGF2ZSBhbHJlYWR5IHNlZW4gYSBzZXJ2aWNlLXNw
ZWNpZmljIGZvcm0sIGFuZCB0aGlzIGlzCisJICAgICAqICBhIGdlbmVyaWMgZm9ybSwganVzdCBz
a2lwIGl0IGFuZCBkb24ndCBtb2FuLgorCSAgICAgKi8KKwkgICAgaWYoKGltYXBvcHRzW29wdF0u
c2VlbiA9PSAxICYmICFzZXJ2aWNlX3NwZWNpZmljKSAKKwkgICAgIHx8KGltYXBvcHRzW29wdF0u
c2VlbiA9PSAyICYmIHNlcnZpY2Vfc3BlY2lmaWMpKSB7CisJCXNwcmludGYoZXJyYnVmLAorCQkJ
Im9wdGlvbiAnJXMnIHdhcyBzcGVjaWZpZWQgdHdpY2UgaW4gY29uZmlnIGZpbGUgKHNlY29uZCBv
Y2N1cmFuY2Ugb24gbGluZSAlZCkiLAorCQkJZnVsbGtleSwgbGluZW5vKTsKKwkJZmF0YWwoZXJy
YnVmLCBFQ19DT05GSUcpOworCSAgICB9IGVsc2UgaWYoaW1hcG9wdHNbb3B0XS5zZWVuID09IDIg
JiYgIXNlcnZpY2Vfc3BlY2lmaWMpIHsKKwkJY29udGludWU7CisJICAgIH0KKworCSAgICAvKiBJ
ZiB3ZSd2ZSBzZWVuIGl0IGFscmVhZHksIHdlJ3JlIHJlcGxhY2luZyBpdCwgc28gd2UgbmVlZAor
CSAgICAgKiB0byBmcmVlIHRoZSBjdXJyZW50IHN0cmluZyBpZiB0aGVyZSBpcyBvbmUgKi8KKwkg
ICAgaWYoaW1hcG9wdHNbb3B0XS5zZWVuICYmIGltYXBvcHRzW29wdF0udCA9PSBPUFRfU1RSSU5H
KQorCQlmcmVlKChjaGFyICopaW1hcG9wdHNbb3B0XS52YWwucyk7CisKKyAgICAgICAgICAgIGlm
KHNlcnZpY2Vfc3BlY2lmaWMpCisJCWltYXBvcHRzW29wdF0uc2VlbiA9IDI7CisJICAgIGVsc2UK
KwkJaW1hcG9wdHNbb3B0XS5zZWVuID0gMTsKKwkgICAgCisJICAgIC8qIHRoaXMgaXMgYSBrbm93
biBvcHRpb24gKi8KKwkgICAgc3dpdGNoIChpbWFwb3B0c1tvcHRdLnQpIHsKKwkgICAgY2FzZSBP
UFRfU1RSSU5HOiAKKwkgICAgewkJICAgIAorCQlpbWFwb3B0c1tvcHRdLnZhbC5zID0geHN0cmR1
cChwKTsKKworCQlpZihvcHQgPT0gSU1BUE9QVF9DT05GSUdESVJFQ1RPUlkpCisJCSAgICBjb25m
aWdfZGlyID0gaW1hcG9wdHNbb3B0XS52YWwuczsKKworCQlicmVhazsKKwkgICAgfQorCSAgICBj
YXNlIE9QVF9JTlQ6CisJICAgIHsKKwkJbG9uZyB2YWw7CisJCWNoYXIgKnB0cjsKKwkJCisJCXZh
bCA9IHN0cnRvbChwLCAmcHRyLCAwKTsKKwkJaWYgKCFwdHIgfHwgKnB0ciAhPSAnXDAnKSB7CisJ
CSAgICAvKiBlcnJvciBkdXJpbmcgY29udmVyc2lvbiAqLworCQkgICAgc3ByaW50ZihlcnJidWYs
ICJub24taW50ZWdlciB2YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIsCisJCQkgICAgaW1hcG9wdHNb
b3B0XS5vcHRuYW1lLCBsaW5lbm8pOworCQkgICAgZmF0YWwoYnVmLCBFQ19DT05GSUcpOworCQl9
CisKKwkJaW1hcG9wdHNbb3B0XS52YWwuaSA9IHZhbDsKKwkJYnJlYWs7CisJICAgIH0KKwkgICAg
Y2FzZSBPUFRfU1dJVENIOgorCSAgICB7CisJCWlmICgqcCA9PSAnMCcgfHwgKnAgPT0gJ24nIHx8
CisJCSAgICAoKnAgPT0gJ28nICYmIHBbMV0gPT0gJ2YnKSB8fCAqcCA9PSAnZicpIHsKKwkJICAg
IGltYXBvcHRzW29wdF0udmFsLmIgPSAwOworCQl9CisJCWVsc2UgaWYgKCpwID09ICcxJyB8fCAq
cCA9PSAneScgfHwKKwkJCSAoKnAgPT0gJ28nICYmIHBbMV0gPT0gJ24nKSB8fCAqcCA9PSAndCcp
IHsKKwkJICAgIGltYXBvcHRzW29wdF0udmFsLmIgPSAxOworCQl9CisJCWVsc2UgeworCQkgICAg
LyogZXJyb3IgZHVyaW5nIGNvbnZlcnNpb24gKi8KKwkJICAgIHNwcmludGYoZXJyYnVmLCAibm9u
LXN3aXRjaCB2YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIsCisJCQkgICAgaW1hcG9wdHNbb3B0XS5v
cHRuYW1lLCBsaW5lbm8pOworCQkgICAgZmF0YWwoYnVmLCBFQ19DT05GSUcpOworCQl9CisJCWJy
ZWFrOworCSAgICB9CisJICAgIGNhc2UgT1BUX05PVE9QVDoKKwkgICAgZGVmYXVsdDoKKwkJYWJv
cnQoKTsKKwkgICAgfQorCX0gZWxzZSB7CisJICAgIC8qIGNoZWNrIHRvIG1ha2Ugc3VyZSBpdCdz
IHZhbGlkIGZvciBvdmVyZmxvdyAqLworCSAgICAvKiB0aGF0IGlzLCBwYXJ0aXRpb24gbmFtZXMg
YW5kIGFueXRoaW5nIHRoYXQgbWlnaHQgYmUKKwkgICAgICogdXNlZCBieSBTQVNMICovCisvKgor
ICB4eHggdGhpcyB3b3VsZCBiZSBuaWNlIGlmIGl0IHdhc24ndCBmb3Igb3RoZXIgc2VydmljZXMg
d2hvIG1pZ2h0IGJlCisgICAgICBzaGFyaW5nIHRoaXMgY29uZmlnIGZpbGUgYW5kIHdob3NlIG5h
bWVzIHdlIGNhbm5vdCBwcmVkaWN0CisKKwkgICAgaWYoc3RybmNhc2VjbXAoa2V5LCJzYXNsXyIs
NSkKKwkgICAgJiYgc3RybmNhc2VjbXAoa2V5LCJwYXJ0aXRpb24tIiwxMCkpIHsKKwkJc3ByaW50
ZihlcnJidWYsCisJCQkib3B0aW9uICclcycgaXMgdW5rbm93biBvbiBsaW5lICVkIG9mIGNvbmZp
ZyBmaWxlIiwKKwkJCWZ1bGxrZXksIGxpbmVubyk7CisJCWZhdGFsKGVycmJ1ZiwgRUNfQ09ORklH
KTsKKwkgICAgfQorKi8KKworCSAgICAvKiBQdXQgaXQgaW4gdGhlIG92ZXJmbG93IGhhc2ggdGFi
bGUgKi8KKwkgICAgbmV3dmFsID0geHN0cmR1cChwKTsKKwkgICAgdmFsID0gaGFzaF9pbnNlcnQo
a2V5LCBuZXd2YWwsICZjb25maWdoYXNoKTsKKwkgICAgaWYodmFsICE9IG5ld3ZhbCkgeworCQlz
cHJpbnRmKGVycmJ1ZiwKKwkJCSJvcHRpb24gJyVzJyB3YXMgc3BlY2lmaWVkIHR3aWNlIGluIGNv
bmZpZyBmaWxlIChzZWNvbmQgb2NjdXJhbmNlIG9uIGxpbmUgJWQpIiwKKwkJCWZ1bGxrZXksIGxp
bmVubyk7CisJCWZhdGFsKGVycmJ1ZiwgRUNfQ09ORklHKTsKKwkgICAgfQorCX0KICAgICB9CiAg
ICAgZmNsb3NlKGluZmlsZSk7CisKKyAgICAvKiBDaGVjayBjb25maWdkaXJlY3RvcnkgY29uZmln
IG9wdGlvbiAqLworICAgIGlmICghY29uZmlnX2RpcikgeworCWZhdGFsKCJjb25maWdkaXJlY3Rv
cnkgb3B0aW9uIG5vdCBzcGVjaWZpZWQgaW4gY29uZmlndXJhdGlvbiBmaWxlIiwKKwkgICAgICBF
Q19DT05GSUcpOworICAgIH0KKworICAgIC8qIFNjYW4gb3B0aW9ucyB0byBzZWUgaWYgd2UgbmVl
ZCB0byByZXBsYWNlIHtjb25maWdkaXJlY3Rvcnl9ICovCisgICAgLyogeHh4IG5lZWQgdG8gc2Nh
biBvdmVyZmxvdyBvcHRpb25zIGFzIHdlbGwhICovCisgICAgZm9yKG9wdCA9IElNQVBPUFRfWkVS
Tzsgb3B0IDwgSU1BUE9QVF9MQVNUOyBvcHQrKykgeworCWlmKCFpbWFwb3B0c1tvcHRdLnZhbC5z
IHx8CisJICAgaW1hcG9wdHNbb3B0XS50ICE9IE9QVF9TVFJJTkcgfHwKKwkgICBvcHQgPT0gSU1B
UE9QVF9DT05GSUdESVJFQ1RPUlkpIHsKKwkgICAgLyogU2tpcCBvcHRpb25zIHRoYXQgaGF2ZSBh
IE5VTEwgdmFsdWUsIGFyZW4ndCBzdHJpbmdzLCBvcgorCSAgICAgKiBhcmUgdGhlIGNvbmZpZ2Rp
cmVjdG9yeSBvcHRpb24gKi8KKwkgICAgY29udGludWU7CisJfQorCQorCS8qIFdlIHVzZSBzb21l
IG1hZ2ljIG51bWJlcnMgaGVyZSwKKwkgKiAxNyBpcyB0aGUgbGVuZ3RoIG9mICJ7Y29uZmlnZGly
ZWN0b3J5fSIsCisJICogMTYgaXMgb25lIGxlc3MgdGhhbiB0aGF0IGxlbmd0aCwgc28gdGhhdCB0
aGUgcmVwbGFjZW1lbnQgc3RyaW5nCisJICogICAgdGhhdCBpcyBtYWxsb2NlZCBoYXMgcm9vbSBm
b3IgdGhlICdcMCcgKi8KKwlpZighc3RybmNhc2VjbXAoaW1hcG9wdHNbb3B0XS52YWwucywie2Nv
bmZpZ2RpcmVjdG9yeX0iLDE3KSkgeworCSAgICBjb25zdCBjaGFyICpzdHIgPSBpbWFwb3B0c1tv
cHRdLnZhbC5zOworCSAgICBjaGFyICpuZXdzdHJpbmcgPQorCQl4bWFsbG9jKHN0cmxlbihjb25m
aWdfZGlyKSArIHN0cmxlbihzdHIpIC0gMTYpOworCSAgICBjaGFyICpmcmVlbWUgPSBOVUxMOwor
CSAgICAKKwkgICAgLyogd2UgbmVlZCB0byByZXBsYWNlIHRoaXMgc3RyaW5nLCB3aWxsIHdlIG5l
ZWQgdG8gZnJlZQorCSAgICAgKiB0aGUgY3VycmVudCB2YWx1ZT8gIC0tIG9ubHkgaWYgd2UndmUg
YWN0dWFsbHkgc2VlbiBpdCBpbgorCSAgICAgKiB0aGUgY29uZmlnIGZpbGUuICovCisJICAgIGlm
KGltYXBvcHRzW29wdF0uc2VlbikKKwkJZnJlZW1lID0gKGNoYXIgKilzdHI7CisKKwkgICAgLyog
QnVpbGQgcmVwbGFjZW1lbnQgc3RyaW5nIGZyb20gY29uZmlnZGlyZWN0b3J5IG9wdGlvbiAqLwor
CSAgICBzdHJjcHkobmV3c3RyaW5nLCBjb25maWdfZGlyKTsKKwkgICAgc3RyY2F0KG5ld3N0cmlu
Zywgc3RyICsgMTcpOworCisJICAgIGltYXBvcHRzW29wdF0udmFsLnMgPSBuZXdzdHJpbmc7CisK
KwkgICAgaWYoZnJlZW1lKSBmcmVlKGZyZWVtZSk7CisJfQorICAgIH0KIH0KIAogLyogdGhpcyBp
cyBhIHdyYXBwZXIgdG8gY2FsbCB0aGUgY3lydXMgY29uZmlndXJhdGlvbiBmcm9tIFNBU0wgKi8K
QEAgLTI4Myw3ICs0MjgsNyBAQAogCiAgICAgaWYgKCFzdHJjbXAob3B0aW9uLCAic3J2dGFiIikp
IHsgCiAJLyogd2UgZG9uJ3QgdHJhbnNmb3JtIHNydnRhYiEgKi8KLQkqcmVzdWx0ID0gY29uZmln
X2dldHN0cmluZyhvcHRpb24sIE5VTEwpOworCSpyZXN1bHQgPSBjb25maWdfZ2V0c3RyaW5nKElN
QVBPUFRfU1JWVEFCKTsKICAgICB9IGVsc2UgewogCSpyZXN1bHQgPSBOVUxMOwogCkBAIC0yOTMs
MTQgKzQzOCwxNCBAQAogCSAgICBzdHJsY2F0KG9wdCwgcGx1Z2luX25hbWUsIHNsKTsKIAkgICAg
c3RybGNhdChvcHQsICJfIiwgc2wpOwogCSAgICBzdHJsY2F0KG9wdCwgb3B0aW9uLCBzbCk7Ci0J
ICAgICpyZXN1bHQgPSBjb25maWdfZ2V0c3RyaW5nKG9wdCwgTlVMTCk7CisJICAgICpyZXN1bHQg
PSBjb25maWdfZ2V0b3ZlcmZsb3dzdHJpbmcob3B0LCBOVUxMKTsKIAl9CiAKIAlpZiAoKnJlc3Vs
dCA9PSBOVUxMKSB7CiAJICAgIC8qIHRyeSB3aXRob3V0IHRoZSBwbHVnaW4gbmFtZSAqLwogCSAg
ICBzdHJsY3B5KG9wdCwgInNhc2xfIiwgc2wpOwogCSAgICBzdHJsY2F0KG9wdCwgb3B0aW9uLCBz
bCk7Ci0JICAgICpyZXN1bHQgPSBjb25maWdfZ2V0c3RyaW5nKG9wdCwgTlVMTCk7CisJICAgICpy
ZXN1bHQgPSBjb25maWdfZ2V0b3ZlcmZsb3dzdHJpbmcob3B0LCBOVUxMKTsKIAl9CiAgICAgfQog
CkBAIC0zMjAsMTQgKzQ2NSwxNCBAQAogICAgIHN0YXRpYyBzYXNsX3NlY3VyaXR5X3Byb3BlcnRp
ZXNfdCByZXQ7CiAKICAgICByZXQubWF4YnVmc2l6ZSA9IFBST1RfQlVGU0laRTsKLSAgICByZXQu
bWluX3NzZiA9IGNvbmZpZ19nZXRpbnQoInNhc2xfbWluaW11bV9sYXllciIsIDApOwkKKyAgICBy
ZXQubWluX3NzZiA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9TQVNMX01JTklNVU1fTEFZRVIpOwkK
IAkJCQkvKiBtaW5pbXVtIGFsbG93YWJsZSBzZWN1cml0eSBzdHJlbmd0aCAqLwotICAgIHJldC5t
YXhfc3NmID0gY29uZmlnX2dldGludCgic2FzbF9tYXhpbXVtX2xheWVyIiwgMjU2KTsKKyAgICBy
ZXQubWF4X3NzZiA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9TQVNMX01BWElNVU1fTEFZRVIpOwog
CQkJCS8qIG1heGltdW0gYWxsb3dhYmxlIHNlY3VyaXR5IHN0cmVuZ3RoICovCiAKICAgICByZXQu
c2VjdXJpdHlfZmxhZ3MgPSBmbGFnczsKICAgICAvKiByZXQuc2VjdXJpdHlfZmxhZ3MgfD0gU0FT
TF9TRUNfTk9QTEFJTlRFWFQ7ICovCi0gICAgaWYgKCFjb25maWdfZ2V0c3dpdGNoKCJhbGxvd2Fu
b255bW91c2xvZ2luIiwgMCkpIHsKKyAgICBpZiAoIWNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9B
TExPV0FOT05ZTU9VU0xPR0lOKSkgewogCXJldC5zZWN1cml0eV9mbGFncyB8PSBTQVNMX1NFQ19O
T0FOT05ZTU9VUzsKICAgICB9CiAgICAgcmV0LnByb3BlcnR5X25hbWVzID0gTlVMTDsKQEAgLTMz
NiwxMSArNDgxLDE0IEBACiAgICAgcmV0dXJuICZyZXQ7CiB9CiAKLS8qIHRydWUgaWYgJ2F1dGhz
dGF0ZScgaXMgaW4gJ3ZhbCcgKi8KLXN0YXRpYyBpbnQgaXNhKHN0cnVjdCBhdXRoX3N0YXRlICph
dXRoc3RhdGUsIGNvbnN0IGNoYXIgKm9wdCkKKy8qIHRydWUgaWYgJ2F1dGhzdGF0ZScgaXMgaW4g
J29wdCcgKi8KK2ludCBjb25maWdfYXV0aGlzYShzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aHN0YXRl
LCBlbnVtIGltYXBvcHQgb3B0KQogewogICAgIGNoYXIgYnVmWzEwMjRdOwotICAgIGNvbnN0IGNo
YXIgKnZhbCA9IGNvbmZpZ19nZXRzdHJpbmcob3B0LCAiIik7CisgICAgY29uc3QgY2hhciAqdmFs
ID0gY29uZmlnX2dldHN0cmluZyhvcHQpOworCisgICAgLyogSXMgdGhlIG9wdGlvbiBkZWZpbmVk
PyAqLworICAgIGlmKCF2YWwpIHJldHVybiAwOwogCiAgICAgd2hpbGUgKCp2YWwpIHsKIAljaGFy
ICpwOwpAQCAtMzU1LDM0ICs1MDMsOCBAQAogCXZhbCA9IHA7CiAJd2hpbGUgKCp2YWwgJiYgaXNz
cGFjZSgoaW50KSAqdmFsKSkgdmFsKys7CiAgICAgfQotICAgIHJldHVybiAwOwotfQotCi0vKiAK
LSAqIGNoZWNrICdzZXJ2aWNlX2NsYXNzJyBhbmQgJ2NsYXNzJwotICovCi1pbnQgYXV0aGlzYShz
dHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aHN0YXRlLCAKLQkgICAgY29uc3QgY2hhciAqc2VydmljZSwg
Ci0JICAgIGNvbnN0IGNoYXIgKmNsYXNzKQotewotICAgIGNoYXIgYnVmWzUxMl07CiAKLSAgICBp
ZiAoIWF1dGhzdGF0ZSkgewotCS8qIG5vdCBhdXRoZW50aWNhdGVkPyAqLwotCXJldHVybiAwOwot
ICAgIH0KLQotICAgIC8qICdjbGFzcycgKi8KLSAgICBpZiAoaXNhKGF1dGhzdGF0ZSwgY2xhc3Mp
KSB7Ci0JcmV0dXJuIDE7Ci0gICAgfQotCi0gICAgLyogJ3NlcnZpY2VfY2xhc3MnICovCi0gICAg
c25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwgIiVzXyVzIiwgc2VydmljZSwgY2xhc3MpOwotICAg
IGlmIChpc2EoYXV0aHN0YXRlLCBidWYpKSB7Ci0JcmV0dXJuIDE7Ci0gICAgfQotICAgIAorICAg
IGFib3J0KCk7CiAgICAgcmV0dXJuIDA7CiB9CiAKSW5kZXg6IGltYXAvZGVsaXZlci5jCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMv
aW1hcC9kZWxpdmVyLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTY0CmRpZmYgLXUgLXIxLjE2
NCBkZWxpdmVyLmMKLS0tIGRlbGl2ZXIuYwkyMDAyLzA1LzI1IDE5OjU3OjQ0CTEuMTY0CisrKyBk
ZWxpdmVyLmMJMjAwMi8wNi8xOCAyMzo0MTowNwpAQCAtMjYxLDcgKzI2MSw3IEBACiAKICAgICBj
b25maWdfaW5pdChhbHRfY29uZmlnLCAiZGVsaXZlciIpOwogCi0gICAgc29ja2FkZHIgPSBjb25m
aWdfZ2V0c3RyaW5nKCJsbXRwc29ja2V0IiwgTlVMTCk7CisgICAgc29ja2FkZHIgPSBjb25maWdf
Z2V0c3RyaW5nKElNQVBPUFRfTE1UUFNPQ0tFVCk7CiAgICAgaWYgKCFzb2NrYWRkcikgewkKIAlz
dHJjcHkoYnVmLCBjb25maWdfZGlyKTsKIAlzdHJjYXQoYnVmLCAiL3NvY2tldC9sbXRwIik7CkBA
IC0zNDQsOCArMzQ0LDggQEAKICAgICBpZiAobWFpbGJveCkgbWwgPSBzdHJsZW4obWFpbGJveCk7
CiAgICAgaWYgKG51bXVzZXJzID09IDApIHsKIAkvKiBqdXN0IGRlbGl2ZXIgdG8gbWFpbGJveCAn
bWFpbGJveCcgKi8KLQljb25zdCBjaGFyICpCQiA9IGNvbmZpZ19nZXRzdHJpbmcoInBvc3R1c2Vy
IiwgIiIpOwotCXR4bi0+cmNwdFswXS5hZGRyID0gKGNoYXIgKikgeG1hbGxvYyhtbCArIHN0cmxl
bihCQikgKyAyKTsgLyogbGVha3MhICovCisJY29uc3QgY2hhciAqQkIgPSBjb25maWdfZ2V0c3Ry
aW5nKElNQVBPUFRfUE9TVFVTRVIpOworCXR4bi0+cmNwdFswXS5hZGRyID0gKGNoYXIgKikgeG1h
bGxvYyhtbCArIHN0cmxlbihCQikgKyAyKTsgLyogeHh4IGxlYWtzISAqLwogCXNwcmludGYodHhu
LT5yY3B0WzBdLmFkZHIsICIlcyslcyIsIEJCLCBtYWlsYm94KTsKICAgICB9IGVsc2UgewogCS8q
IHNldHVwIGVhY2ggcmVjaXBpZW50ICovCkluZGV4OiBpbWFwL2Z1ZC5jCj09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9mdWQu
Yyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zMgpkaWZmIC11IC1yMS4zMiBmdWQuYwotLS0gZnVk
LmMJMjAwMi8wNi8wMyAxODoyMjoyNAkxLjMyCisrKyBmdWQuYwkyMDAyLzA2LzE4IDIzOjM4OjM3
CkBAIC0xNTgsOCArMTU4LDYgQEAKIHsKICAgICBpbnQgb3B0OwogICAgCi0gICAgY29uZmlnX2No
YW5nZWlkZW50KCJmdWQiKTsKLQogICAgIGlmIChnZXRldWlkKCkgPT0gMCkgZmF0YWwoIm11c3Qg
cnVuIGFzIHRoZSBDeXJ1cyB1c2VyIiwgRUNfVVNBR0UpOwogCiAgICAgc2V0cHJvY3RpdGxlX2lu
aXQoYXJnYywgYXJndiwgZW52cCk7CkluZGV4OiBpbWFwL2lkbGVfcG9sbC5jCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
UkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9p
ZGxlX3BvbGwuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS41CmRpZmYgLXUgLXIxLjUgaWRsZV9w
b2xsLmMKLS0tIGlkbGVfcG9sbC5jCTIwMDEvMTEvMTkgMjE6MzI6NDQJMS41CisrKyBpZGxlX3Bv
bGwuYwkyMDAyLzA2LzE4IDIwOjQwOjE5CkBAIC02NSw3ICs2NSw3IEBACiB7CiAgICAgLyogZ2V0
IHBvbGxpbmcgcGVyaW9kICovCiAgICAgaWYgKGlkbGVfcGVyaW9kID09IC0xKSB7Ci0gICAgICBp
ZGxlX3BlcmlvZCA9IGNvbmZpZ19nZXRpbnQoImltYXBpZGxlcG9sbCIsIDYwKTsKKyAgICAgIGlk
bGVfcGVyaW9kID0gY29uZmlnX2dldGludChJTUFQT1BUX0lNQVBJRExFUE9MTCk7CiAgICAgICBp
ZiAoaWRsZV9wZXJpb2QgPCAwKSBpZGxlX3BlcmlvZCA9IDA7CiAgICAgfQogCkluZGV4OiBpbWFw
L2ltYXBjb25mLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0
ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL2ltYXBjb25mLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEu
MTYKZGlmZiAtdSAtcjEuMTYgaW1hcGNvbmYuaAotLS0gaW1hcGNvbmYuaAkyMDAyLzA2LzE0IDE4
OjE4OjQ5CTEuMTYKKysrIGltYXBjb25mLmgJMjAwMi8wNi8xOCAyMDozMToxNwpAQCAtNDQsMTQg
KzQ0LDIyIEBACiAjZGVmaW5lIElOQ0xVREVEX0lNQVBDT05GX0gKIAogI2luY2x1ZGUgPHNhc2wv
c2FzbC5oPgorI2luY2x1ZGUgImltYXBvcHRzLmgiCiAjaW5jbHVkZSAiYXV0aC5oIgogCisvKiBT
dGFydHVwIHRoZSBjb25maWd1cmF0aW9uIHN1YnN5c3RlbSAqLwogZXh0ZXJuIGludCBjb25maWdf
aW5pdChjb25zdCBjaGFyICphbHRfY29uZmlnLCBjb25zdCBjaGFyICppZGVudCk7Ci1leHRlcm4g
Y29uc3QgY2hhciAqY29uZmlnX2dldHN0cmluZyhjb25zdCBjaGFyICprZXksIGNvbnN0IGNoYXIg
KmRlZik7Ci1leHRlcm4gaW50IGNvbmZpZ19nZXRpbnQoY29uc3QgY2hhciAqa2V5LCBpbnQgZGVm
KTsKLWV4dGVybiBpbnQgY29uZmlnX2dldHN3aXRjaChjb25zdCBjaGFyICprZXksIGludCBkZWYp
OworCisvKiB0aGVzZSB3aWxsIGFzc2VydCgpIGlmIHRoZXkncmUgY2FsbGVkIG9uIHRoZSB3cm9u
ZyB0eXBlIG9mCisgICBvcHRpb24gKGltYXBvcHQuYykgKi8KK2V4dGVybiBjb25zdCBjaGFyICpj
b25maWdfZ2V0c3RyaW5nKGVudW0gaW1hcG9wdCBvcHQpOworZXh0ZXJuIGludCBjb25maWdfZ2V0
aW50KGVudW0gaW1hcG9wdCBvcHQpOworZXh0ZXJuIGludCBjb25maWdfZ2V0c3dpdGNoKGVudW0g
aW1hcG9wdCBvcHQpOworCisvKiB0aGVzZSB3b3JrIG9uIGFkZGl0aW9uYWwgc3RyaW5ncyB0aGF0
IGFyZSBub3QgZGVmaW5lZCBpbiB0aGUKKyAqIGltYXBvcHRpb25zIHRhYmxlICovCitleHRlcm4g
Y29uc3QgY2hhciAqY29uZmlnX2dldG92ZXJmbG93c3RyaW5nKGNvbnN0IGNoYXIgKmtleSwgY29u
c3QgY2hhciAqZGVmKTsKIGV4dGVybiBjb25zdCBjaGFyICpjb25maWdfcGFydGl0aW9uZGlyKGNv
bnN0IGNoYXIgKnBhcnRpdGlvbik7Ci1leHRlcm4gaW50IGNvbmZpZ19jaGFuZ2VpZGVudChjb25z
dCBjaGFyICppZGVudCk7CiAKIC8qIHNhc2wgY29uZmlndXJhdGlvbiAqLwogZXh0ZXJuIGludCBt
eXNhc2xfY29uZmlnKHZvaWQgKmNvbnRleHQsCkBAIC04NiwxOSArOTQsMTUgQEAKICNlbmRpZgog
CiAvKiBjaGVjayBpZiBgYXV0aHN0YXRlJyBpcyBhIHZhbGlkIG1lbWJlciBvZiBjbGFzcyAqLwot
ZXh0ZXJuIGludCBhdXRoaXNhKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoc3RhdGUsIAotCQkgICBj
b25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpjbGFzcyk7CitleHRlcm4gaW50IGNvbmZp
Z19hdXRoaXNhKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoc3RhdGUsIAorCQkJICBlbnVtIGltYXBv
cHQgb3B0KTsKIAogLyogVmFsdWVzIG9mIG1hbmRhdG9yeSBvcHRpb25zICovCiBleHRlcm4gY29u
c3QgY2hhciAqY29uZmlnX2ZpbGVuYW1lOwotCiBleHRlcm4gY29uc3QgY2hhciAqY29uZmlnX2Rp
cjsKIGV4dGVybiBjb25zdCBjaGFyICpjb25maWdfZGVmcGFydGl0aW9uOwotZXh0ZXJuIGNvbnN0
IGNoYXIgKmNvbmZpZ19uZXdzc3Bvb2w7Ci0KIGV4dGVybiBjb25zdCBjaGFyICpjb25maWdfc2Vy
dmVybmFtZTsKIGV4dGVybiBjb25zdCBjaGFyICpjb25maWdfbXVwZGF0ZV9zZXJ2ZXI7Ci0KIGV4
dGVybiBpbnQgY29uZmlnX2hhc2hpbWFwc3Bvb2w7CiAKIC8qIHNpZ25hbCBoYW5kbGluZyAoc2ln
bmFscy5jKSAqLwpJbmRleDogaW1hcC9pbWFwZC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMv
YW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9pbWFwZC5jLHYKcmV0cmll
dmluZyByZXZpc2lvbiAxLjM5NwpkaWZmIC11IC1yMS4zOTcgaW1hcGQuYwotLS0gaW1hcGQuYwky
MDAyLzA2LzA3IDAyOjA1OjMyCTEuMzk3CisrKyBpbWFwZC5jCTIwMDIvMDYvMTggMjA6MTE6NDIK
QEAgLTI5NCw3ICsyOTQsNyBAQAogICAgIC8qIGNoZWNrIGlmIHJlbW90ZSByZWFsbSAqLwogICAg
IGlmICgocmVhbG0gPSBzdHJjaHIoYXV0aF9pZGVudGl0eSwgJ0AnKSkhPU5VTEwpIHsKIAlyZWFs
bSsrOwotCXZhbCA9IGNvbmZpZ19nZXRzdHJpbmcoImxvZ2lucmVhbG1zIiwgIiIpOworCXZhbCA9
IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9MT0dJTlJFQUxNUyk7CiAJd2hpbGUgKCp2YWwpIHsK
IAkgICAgaWYgKCFzdHJuY2FzZWNtcCh2YWwsIHJlYWxtLCBzdHJsZW4ocmVhbG0pKSAmJgogCQko
IXZhbFtzdHJsZW4ocmVhbG0pXSB8fCBpc3NwYWNlKChpbnQpIHZhbFtzdHJsZW4ocmVhbG0pXSkp
KSB7CkBAIC0zMTQsMTYgKzMxNCwxNiBAQAogICAgIGltYXBkX2F1dGhzdGF0ZSA9IGF1dGhfbmV3
c3RhdGUoYXV0aF9pZGVudGl0eSwgTlVMTCk7CiAKICAgICAvKiBvaywgaXMgYXV0aF9pZGVudGl0
eSBhbiBhZG1pbj8gKi8KLSAgICBpbWFwZF91c2VyaXNhZG1pbiA9IGF1dGhpc2EoaW1hcGRfYXV0
aHN0YXRlLCAiaW1hcCIsICJhZG1pbnMiKTsKKyAgICBpbWFwZF91c2VyaXNhZG1pbiA9IGNvbmZp
Z19hdXRoaXNhKGltYXBkX2F1dGhzdGF0ZSwgSU1BUE9QVF9BRE1JTlMpOwogCiAgICAgaWYgKGFs
ZW4gIT0gcmxlbiB8fCBzdHJuY21wKGF1dGhfaWRlbnRpdHksIHJlcXVlc3RlZF91c2VyLCBhbGVu
KSkgewogCS8qIHdlIHdhbnQgdG8gYXV0aGVudGljYXRlIGFzIGEgZGlmZmVyZW50IHVzZXI7IHdl
J2xsIGFsbG93IHRoaXMKIAkgICBpZiB3ZSdyZSBhbiBhZG1pbiBvciBpZiB3ZSd2ZSBhbGxvd2Vk
IEFDTCBwcm94eSBsb2dpbnMgKi8KLQlpbnQgdXNlX2FjbCA9IGNvbmZpZ19nZXRzd2l0Y2goImxv
Z2ludXNlYWNsIiwgMCk7CisJaW50IHVzZV9hY2wgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRf
TE9HSU5VU0VBQ0wpOwogCiAJaWYgKGltYXBkX3VzZXJpc2FkbWluIHx8CiAJICAgICh1c2VfYWNs
ICYmIGFjbF9vayhyZXF1ZXN0ZWRfdXNlciwgaW1hcGRfYXV0aHN0YXRlKSkgfHwKLQkgICAgYXV0
aGlzYShpbWFwZF9hdXRoc3RhdGUsICJpbWFwIiwgInByb3h5c2VydmVycyIpKSB7CisJICAgIGNv
bmZpZ19hdXRoaXNhKGltYXBkX2F1dGhzdGF0ZSwgSU1BUE9QVF9QUk9YWVNFUlZFUlMpKSB7CiAJ
ICAgIC8qIHByb3h5IG9rISAqLwogCiAJICAgIGltYXBkX3VzZXJpc2FkbWluID0gMDsJLyogbm8g
bG9uZ2VyIGFkbWluICovCkBAIC0zMzMsNyArMzMzLDcgQEAKIAogCSAgICAvKiBhcmUgd2UgYSBw
cm94eSBhZG1pbj8gKi8KIAkgICAgaW1hcGRfdXNlcmlzcHJveHlhZG1pbiA9Ci0JCWF1dGhpc2Eo
aW1hcGRfYXV0aHN0YXRlLCAiaW1hcCIsICJhZG1pbnMiKTsKKwkJY29uZmlnX2F1dGhpc2EoaW1h
cGRfYXV0aHN0YXRlLCBJTUFQT1BUX0FETUlOUyk7CiAJfSBlbHNlIHsKIAkgICAgc2FzbF9zZXRl
cnJvcihjb25uLCAwLCAidXNlciAlcyBpcyBub3QgYWxsb3dlZCB0byBwcm94eSIsCiAJCQkgIGF1
dGhfaWRlbnRpdHkpOwpAQCAtNTAwLDggKzUwMCw2IEBACiB7CiAgICAgaW50IHI7CiAgICAgaW50
IG9wdDsKLQotICAgIGNvbmZpZ19jaGFuZ2VpZGVudCgiaW1hcGQiKTsKICAgICAKICAgICBpZiAo
Z2V0ZXVpZCgpID09IDApIGZhdGFsKCJtdXN0IHJ1biBhcyB0aGUgQ3lydXMgdXNlciIsIEVDX1VT
QUdFKTsKICAgICBzZXRwcm9jdGl0bGVfaW5pdChhcmdjLCBhcmd2LCBlbnZwKTsKQEAgLTU1NCw3
ICs1NTIsNyBAQAogIAkgICAgYnJlYWs7CiAJY2FzZSAncyc6IC8qIGltYXBzIChkbyBzdGFydHRs
cyByaWdodCBhd2F5KSAqLwogCSAgICBpbWFwcyA9IDE7Ci0JICAgIGlmICghdGxzX2VuYWJsZWQo
ImltYXAiKSkgeworCSAgICBpZiAoIXRsc19lbmFibGVkKCkpIHsKIAkJc3lzbG9nKExPR19FUlIs
ICJpbWFwczogcmVxdWlyZWQgT3BlblNTTCBvcHRpb25zIG5vdCBwcmVzZW50Iik7CiAJCWZhdGFs
KCJpbWFwczogcmVxdWlyZWQgT3BlblNTTCBvcHRpb25zIG5vdCBwcmVzZW50IiwKIAkJICAgICAg
RUNfQ09ORklHKTsKQEAgLTY1MCw3ICs2NDgsNyBAQAogICAgIHByb2NfcmVnaXN0ZXIoImltYXBk
IiwgaW1hcGRfY2xpZW50aG9zdCwgTlVMTCwgTlVMTCk7CiAKICAgICAvKiBTZXQgaW5hY3Rpdml0
eSB0aW1lciAqLwotICAgIHRpbWVvdXQgPSBjb25maWdfZ2V0aW50KCJ0aW1lb3V0IiwgMzApOwor
ICAgIHRpbWVvdXQgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfVElNRU9VVCk7CiAgICAgaWYgKHRp
bWVvdXQgPCAzMCkgdGltZW91dCA9IDMwOwogICAgIHByb3Rfc2V0dGltZW91dChpbWFwZF9pbiwg
dGltZW91dCo2MCk7CiAgICAgcHJvdF9zZXRmbHVzaG9ucmVhZChpbWFwZF9pbiwgaW1hcGRfb3V0
KTsKQEAgLTEzNjcsNyArMTM2NSw3IEBACiAJICAgIAogCWNhc2UgJ1MnOgogCSAgICBpZiAoIXN0
cmNtcChjbWQucywgIlN0YXJ0dGxzIikpIHsKLQkJaWYgKCF0bHNfZW5hYmxlZCgiaW1hcCIpKSB7
CisJCWlmICghdGxzX2VuYWJsZWQoKSkgewogCQkgICAgLyogd2UgZG9uJ3Qgc3VwcG9ydCBzdGFy
dHRscyAqLwogCQkgICAgZ290byBiYWRjbWQ7CiAJCX0KQEAgLTE3MDMsNyArMTcwMSw3IEBACiAK
ICAgICAvKiBwb3NzaWJseSBkaXNhbGxvdyBsb2dpbiAqLwogICAgIGlmICgoaW1hcGRfc3RhcnR0
bHNfZG9uZSA9PSAwKSAmJgotCShjb25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsIDEp
ID09IDApICYmCisJKGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV1BMQUlOVEVYVCkgPT0g
MCkgJiYKIAlzdHJjbXAoY2Fub25fdXNlciwgImFub255bW91cyIpICE9IDApIHsKIAllYXRsaW5l
KGltYXBkX2luLCAnICcpOwogCXByb3RfcHJpbnRmKGltYXBkX291dCwgIiVzIE5PIExvZ2luIG9u
bHkgYXZhaWxhYmxlIHVuZGVyIGEgbGF5ZXJcclxuIiwKQEAgLTE3MjcsNyArMTcyNSw3IEBACiAg
ICAgcGFzc3dkID0gcGFzc3dkYnVmLnM7CiAKICAgICBpZiAoIXN0cmNtcChjYW5vbl91c2VyLCAi
YW5vbnltb3VzIikpIHsKLQlpZiAoY29uZmlnX2dldHN3aXRjaCgiYWxsb3dhbm9ueW1vdXNsb2dp
biIsIDApKSB7CisJaWYgKGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV0FOT05ZTU9VU0xP
R0lOKSkgewogCSAgICBwYXNzd2QgPSBiZWF1dGlmeV9zdHJpbmcocGFzc3dkKTsKIAkgICAgaWYg
KHN0cmxlbihwYXNzd2QpID4gNTAwKSBwYXNzd2RbNTAwXSA9ICdcMCc7CiAJICAgIHN5c2xvZyhM
T0dfTk9USUNFLCAibG9naW46ICVzIGFub255bW91cyAlcyIsCkBAIC0xNzc2LDcgKzE3NzQsNyBA
QAogCSAgICAgICBjYW5vbl91c2VyLCBpbWFwZF9zdGFydHRsc19kb25lID8gIitUTFMiIDogIiIs
IAogCSAgICAgICByZXBseSA/IHJlcGx5IDogIiIpOwogCi0JcGxhaW50ZXh0bG9naW5wYXVzZSA9
IGNvbmZpZ19nZXRpbnQoInBsYWludGV4dGxvZ2lucGF1c2UiLCAwKTsKKwlwbGFpbnRleHRsb2dp
bnBhdXNlID0gY29uZmlnX2dldGludChJTUFQT1BUX1BMQUlOVEVYVExPR0lOUEFVU0UpOwogCWlm
IChwbGFpbnRleHRsb2dpbnBhdXNlICE9IDAgJiYgIWltYXBkX3N0YXJ0dGxzX2RvbmUpIHsKIAkg
ICAgLyogQXBwbHkgcGVuYWx0eSBvbmx5IGlmIG5vdCB1bmRlciBsYXllciAqLwogCSAgICBzbGVl
cChwbGFpbnRleHRsb2dpbnBhdXNlKTsKQEAgLTE3ODQsNyArMTc4Miw3IEBACiAgICAgfQogICAg
IAogICAgIGltYXBkX2F1dGhzdGF0ZSA9IGF1dGhfbmV3c3RhdGUoY2Fub25fdXNlciwgKGNoYXIg
KikwKTsKLSAgICB2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJhZG1pbnMiLCAiIik7CisgICAgdmFs
ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0FETUlOUyk7CiAgICAgd2hpbGUgKCp2YWwpIHsK
IAlmb3IgKHAgPSAoY2hhciAqKXZhbDsgKnAgJiYgIWlzc3BhY2UoKGludCkgKnApOyBwKyspOwog
CXN0cmxjcHkoYnVmLCB2YWwsIHAgLSB2YWwpOwpAQCAtMjExOSw3ICsyMTE3LDcgQEAKIAogICAg
IC8qIHNwaXQgb3V0IG91ciBJRCBzdHJpbmcuCiAgICAgICAgZXZlbnR1YWxseSB0aGlzIG1pZ2h0
IGJlIGNvbmZpZ3VyYWJsZS4gKi8KLSAgICBpZiAoY29uZmlnX2dldHN3aXRjaCgiaW1hcGlkcmVz
cG9uc2UiLCAxKSkgeworICAgIGlmIChjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfSU1BUElEUkVT
UE9OU0UpKSB7CiAJaWRfcmVzcG9uc2UoaW1hcGRfb3V0KTsKIAlwcm90X3ByaW50ZihpbWFwZF9v
dXQsICIpXHJcbiIpOwogICAgIH0KQEAgLTIyMzksMTAgKzIyMzcsMTAgQEAKIAlwcm90X3ByaW50
ZihpbWFwZF9vdXQsICIgSURMRSIpOwogICAgIH0KIAotICAgIGlmICh0bHNfZW5hYmxlZCgiaW1h
cCIpKSB7CisgICAgaWYgKHRsc19lbmFibGVkKCkpIHsKIAlwcm90X3ByaW50ZihpbWFwZF9vdXQs
ICIgU1RBUlRUTFMiKTsKICAgICB9Ci0gICAgaWYgKCFpbWFwZF9zdGFydHRsc19kb25lICYmICFj
b25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsIDEpKSB7CisgICAgaWYgKCFpbWFwZF9z
dGFydHRsc19kb25lICYmICFjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dQTEFJTlRFWFQp
KSB7CiAJcHJvdF9wcmludGYoaW1hcGRfb3V0LCAiIExPR0lORElTQUJMRUQiKTsKICAgICB9CiAK
QEAgLTI1NjcsNyArMjU2NSw3IEBACiAJCXByb3RfcHJpbnRmKGltYXBkX291dCwgIiogTk8gW0FM
RVJUXSAlc1xyXG4iLAogCQkJICAgIGVycm9yX21lc3NhZ2UoSU1BUF9OT19PVkVSUVVPVEEpKTsK
IAkgICAgfQotCSAgICBlbHNlIGlmICh1c2FnZSA+IGNvbmZpZ19nZXRpbnQoInF1b3Rhd2FybiIs
IDkwKSkgeworCSAgICBlbHNlIGlmICh1c2FnZSA+IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9RVU9U
QVdBUk4pKSB7CiAJCWludCB1c2FnZWludCA9IChpbnQpIHVzYWdlOwogCQlwcm90X3ByaW50Zihp
bWFwZF9vdXQsICIqIE5PIFtBTEVSVF0gIik7CiAJCXByb3RfcHJpbnRmKGltYXBkX291dCwgZXJy
b3JfbWVzc2FnZShJTUFQX05PX0NMT1NFUVVPVEEpLApAQCAtMzU1OCw3ICszNTU2LDcgQEAKIAkJ
CQkgICBsb2NhbG9ubHksIGxvY2Fsb25seSk7CiAKIAlpZiAociA9PSBJTUFQX1BFUk1JU1NJT05f
REVOSUVEICYmICFzdHJjYXNlY21wKG5hbWUsICJJTkJPWCIpICYmCi0JICAgIChhdXRvY3JlYXRl
cXVvdGEgPSBjb25maWdfZ2V0aW50KCJhdXRvY3JlYXRlcXVvdGEiLCAwKSkpIHsKKwkgICAgKGF1
dG9jcmVhdGVxdW90YSA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9BVVRPQ1JFQVRFUVVPVEEpKSkg
ewogCiAJICAgIC8qIEF1dG8gY3JlYXRlICovCiAJICAgIHIgPSBtYm94bGlzdF9jcmVhdGVtYWls
Ym94KG1haWxib3huYW1lLCAwLApAQCAtMzkzNyw3ICszOTM1LDcgQEAKICAgICBtYm94bmFtZV9o
aWVyc2VwX3RvaW50ZXJuYWwoJmltYXBkX25hbWVzcGFjZSwgcGF0dGVybik7CiAKICAgICBpZiAo
IXN0cmNhc2VjbXAobmFtZXNwYWNlLCAibWFpbGJveGVzIikpIHsKLQlpbnQgZm9yY2UgPSBjb25m
aWdfZ2V0c3dpdGNoKCJhbGxvd2FsbHN1YnNjcmliZSIsIDApOworCWludCBmb3JjZSA9IGNvbmZp
Z19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV0FMTFNVQlNDUklCRSk7CiAKIAkoKmltYXBkX25hbWVz
cGFjZS5tYm94bGlzdF9maW5kc3ViKSgmaW1hcGRfbmFtZXNwYWNlLCBwYXR0ZXJuLAogCQkJCQkg
ICAgaW1hcGRfdXNlcmlzYWRtaW4sIGltYXBkX3VzZXJpZCwKQEAgLTM5ODYsNyArMzk4NCw3IEBA
CiAgICAgLyogSWdub3JlIHRoZSByZWZlcmVuY2UgYXJndW1lbnQ/CiAgICAgICAgKHRoZSBiZWhh
dmlvciBpbiAxLjUuMTAgJiBvbGRlcikgKi8KICAgICBpZiAoaWdub3JlcmVmZXJlbmNlID09IDAp
IHsKLQlpZ25vcmVyZWZlcmVuY2UgPSBjb25maWdfZ2V0c3dpdGNoKCJpZ25vcmVyZWZlcmVuY2Ui
LCAwKTsKKwlpZ25vcmVyZWZlcmVuY2UgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfSUdOT1JF
UkVGRVJFTkNFKTsKICAgICB9CiAKICAgICAvKiBSZXNldCBzdGF0ZSBpbiBtc3RyaW5nZGF0YSAq
LwpAQCAtNDAyNyw3ICs0MDI1LDggQEAKIAltYm94bmFtZV9oaWVyc2VwX3RvaW50ZXJuYWwoJmlt
YXBkX25hbWVzcGFjZSwgcGF0dGVybik7CiAKIAkvKiBDaGVjayB0byBzZWUgaWYgd2Ugc2hvdWxk
IG9ubHkgbGlzdCB0aGUgcGVyc29uYWwgbmFtZXNwYWNlICovCi0JaWYgKCFzdHJjbXAocGF0dGVy
biwgIioiKSAmJiBjb25maWdfZ2V0aW50KCJmb29sc3R1cGlkY2xpZW50cyIsIDApKSB7CisJaWYg
KCFzdHJjbXAocGF0dGVybiwgIioiKQorCSAgICAmJiBjb25maWdfZ2V0aW50KElNQVBPUFRfRk9P
TFNUVVBJRENMSUVOVFMpKSB7CiAJICAgIGlmIChidWYpIGZyZWUoYnVmKTsKIAkgICAgYnVmID0g
c3RyZHVwKCJJTkJPWCoiKTsKIAkgICAgcGF0dGVybiA9IGJ1ZjsKQEAgLTQwNDAsNyArNDAzOSw3
IEBACiAJfQogCiAJaWYgKGxpc3RvcHRzICYgTElTVF9MU1VCIHx8IGxpc3RvcHRzICYgTElTVF9T
VUJTQ1JJQkVEKSB7Ci0JICAgIGludCBmb3JjZSA9IGNvbmZpZ19nZXRzd2l0Y2goImFsbG93YWxs
c3Vic2NyaWJlIiwgMCk7CisJICAgIGludCBmb3JjZSA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9Q
VF9BTExPV0FMTFNVQlNDUklCRSk7CiAKIAkgICAgKCpmaW5kc3ViKSgmaW1hcGRfbmFtZXNwYWNl
LCBwYXR0ZXJuLAogCQkgICAgICAgaW1hcGRfdXNlcmlzYWRtaW4sIGltYXBkX3VzZXJpZCwgaW1h
cGRfYXV0aHN0YXRlLApAQCAtNDA3MCw3ICs0MDY5LDcgQEAKIHsKICAgICBpbnQgcjsKICAgICBj
aGFyIG1haWxib3huYW1lW01BWF9NQUlMQk9YX05BTUUrMV07Ci0gICAgaW50IGZvcmNlID0gY29u
ZmlnX2dldHN3aXRjaCgiYWxsb3dhbGxzdWJzY3JpYmUiLCAwKTsKKyAgICBpbnQgZm9yY2UgPSBj
b25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dBTExTVUJTQ1JJQkUpOwogCiAgICAgaWYgKG5h
bWVzcGFjZSkgbGNhc2UobmFtZXNwYWNlKTsKICAgICBpZiAoIW5hbWVzcGFjZSB8fCAhc3RyY21w
KG5hbWVzcGFjZSwgIm1haWxib3giKSkgewpAQCAtNDc2Miw3ICs0NzYxLDcgQEAKIHsKICAgICBj
b25zdCBjaGFyICp1cmw7CiAKLSAgICB1cmwgPSBjb25maWdfZ2V0c3RyaW5nKCJuZXRzY2FwZXVy
bCIsIE5VTEwpOworICAgIHVybCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9ORVRTQ0FQRVVS
TCk7CiAKICAgICAvKiBJIG9ubHkga25vdyBvZiB0aHJlZSB0aGluZ3MgdG8gcmVwbHkgd2l0aDog
Ki8KICAgICBwcm90X3ByaW50ZihpbWFwZF9vdXQsCkluZGV4OiBpbWFwL2ltYXBvcHRpb25zCj09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0KUkNTIGZpbGU6IGltYXBvcHRpb25zCmRpZmYgLU4gaW1hcG9wdGlvbnMKLS0tIC9k
ZXYvbnVsbAlUdWUgSnVuIDE4IDA2OjAxOjIzIDIwMDIKKysrIGltYXBvcHRpb25zCVR1ZSBKdW4g
MTggMjA6MDc6MDkgMjAwMgpAQCAtMCwwICsxLDQ2NiBAQAorLyoKKy5cIiAtKi0gbnJvZmYgLSot
CisuVEggSU1BUEQuQ09ORiA1ICJQcm9qZWN0IEN5cnVzIiBDTVUKKy5cIiAKKy5cIiBDb3B5cmln
aHQgKGMpIDE5OTgtMjAwMCBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eS4gIEFsbCByaWdodHMg
cmVzZXJ2ZWQuCisuXCIKKy5cIiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQg
YmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQKKy5cIiBtb2RpZmljYXRpb24sIGFyZSBwZXJt
aXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKKy5cIiBhcmUgbWV0
OgorLlwiCisuXCIgMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWlu
IHRoZSBhYm92ZSBjb3B5cmlnaHQKKy5cIiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRp
b25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuIAorLlwiCisuXCIgMi4gUmVkaXN0cmli
dXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQK
Ky5cIiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5n
IGRpc2NsYWltZXIgaW4KKy5cIiAgICB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0
ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlCisuXCIgICAgZGlzdHJpYnV0aW9uLgorLlwiCisuXCIg
My4gVGhlIG5hbWUgIkNhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5IiBtdXN0IG5vdCBiZSB1c2Vk
IHRvCisuXCIgICAgZW5kb3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzIGRlcml2ZWQgZnJvbSB0aGlz
IHNvZnR3YXJlIHdpdGhvdXQKKy5cIiAgICBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uIEZvciBw
ZXJtaXNzaW9uIG9yIGFueSBvdGhlciBsZWdhbAorLlwiICAgIGRldGFpbHMsIHBsZWFzZSBjb250
YWN0ICAKKy5cIiAgICAgIE9mZmljZSBvZiBUZWNobm9sb2d5IFRyYW5zZmVyCisuXCIgICAgICBD
YXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eQorLlwiICAgICAgNTAwMCBGb3JiZXMgQXZlbnVlCisu
XCIgICAgICBQaXR0c2J1cmdoLCBQQSAgMTUyMTMtMzg5MAorLlwiICAgICAgKDQxMikgMjY4LTQz
ODcsIGZheDogKDQxMikgMjY4LTczOTUKKy5cIiAgICAgIHRlY2gtdHJhbnNmZXJAYW5kcmV3LmNt
dS5lZHUKKy5cIgorLlwiIDQuIFJlZGlzdHJpYnV0aW9ucyBvZiBhbnkgZm9ybSB3aGF0c29ldmVy
IG11c3QgcmV0YWluIHRoZSBmb2xsb3dpbmcKKy5cIiAgICBhY2tub3dsZWRnbWVudDoKKy5cIiAg
ICAiVGhpcyBwcm9kdWN0IGluY2x1ZGVzIHNvZnR3YXJlIGRldmVsb3BlZCBieSBDb21wdXRpbmcg
U2VydmljZXMKKy5cIiAgICAgYXQgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkgKGh0dHA6Ly93
d3cuY211LmVkdS9jb21wdXRpbmcvKS4iCisuXCIKKy5cIiBDQVJORUdJRSBNRUxMT04gVU5JVkVS
U0lUWSBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSCBSRUdBUkQgVE8KKy5cIiBUSElTIFNP
RlRXQVJFLCBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJ
VFkKKy5cIiBBTkQgRklUTkVTUywgSU4gTk8gRVZFTlQgU0hBTEwgQ0FSTkVHSUUgTUVMTE9OIFVO
SVZFUlNJVFkgQkUgTElBQkxFCisuXCIgRk9SIEFOWSBTUEVDSUFMLCBJTkRJUkVDVCBPUiBDT05T
RVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMKKy5cIiBXSEFUU09FVkVSIFJFU1VMVElO
RyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4KKy5cIiBBTiBB
Q1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1IgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBB
UklTSU5HCisuXCIgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SIFBFUkZP
Uk1BTkNFIE9GIFRISVMgU09GVFdBUkUuCisuXCIgCisuXCIgJElkOiBpbWFwZC5jb25mLjUsdiAx
LjY1IDIwMDIvMDYvMTIgMTc6Mzg6NTggcmpzMyBFeHAgJAorLlNIIE5BTUUKK2ltYXBkLmNvbmYg
XC0gSU1BUCBjb25maWd1cmF0aW9uIGZpbGUKKy5TSCBERVNDUklQVElPTgorXGZCL2V0Yy9pbWFw
ZC5jb25mXGZSIAoraXMgdGhlIGNvbmZpZ3VyYXRpb24gZmlsZSBmb3IgdGhlIEN5cnVzIElNQVAg
c2VydmVyLiAgSXQgZGVmaW5lcworbG9jYWwgcGFyYW1ldGVycyBmb3IgSU1BUC4gCisuUFAKK0Vh
Y2ggbGluZSBvZiB0aGUgXGZCL2V0Yy9pbWFwZC5jb25mXGZSIGZpbGUgaGFzIHRoZSBmb3JtCisu
SVAKK1xmSW9wdGlvblxmUjogXGZJdmFsdWVcZlIKKy5QUAord2hlcmUgXGZJb3B0aW9uXGZSIGlz
IHRoZSBuYW1lIG9mIHRoZSBjb25maWd1cmF0aW9uIG9wdGlvbiBiZWluZyBzZXQKK2FuZCBcZkl2
YWx1ZVxmUiBpcyB0aGUgdmFsdWUgdGhhdCB0aGUgY29uZmlndXJhdGlvbiBvcHRpb24gaXMgYmVp
bmcKK3NldCB0by4KKy5QUAorQmxhbmsgbGluZXMgYW5kIGxpbmVzIGJlZ2lubmluZyB3aXRoIGBg
IycnIGFyZSBpZ25vcmVkLgorLlBQCitGb3IgYm9vbGVhbiBvcHRpb25zLCB0aGUgdmFsdWVzIGBg
eWVzJycsIGBgb24nJywgYGB0JycsIGFuZCBgYDEnJyB0dXJuIHRoZQorb3B0aW9uIG9uLCB0aGUg
dmFsdWVzIGBgbm8nJywgYGBvZmYnJywgYGBmJycsIGFuZCBgYDAnJyB0dXJuIHRoZSBvcHRpb24g
b2ZmLgorLlNIIEZJRUxEIERFU0NSSVBUSU9OUworLlBQCitUaGUgc2VjdGlvbnMgYmVsb3cgZGV0
YWlsIG9wdGlvbnMgdGhhdCBjYW4gYmUgcGxhY2VkIGluIHRoZQorXGZCL2V0Yy9pbWFwZC5jb25m
XGZSIGZpbGUsIGFuZCBzaG93IGVhY2ggb3B0aW9uJ3MgZGVmYXVsdCB2YWx1ZS4KK1NvbWUgb3B0
aW9ucyBoYXZlIG5vIGRlZmF1bHQgdmFsdWUsIHRoZXNlIGFyZSBsaXN0ZWQgd2l0aAorYGA8bm8g
ZGVmYXVsdD4nJy4gIFNvbWUgb3B0aW9ucyBkZWZhdWx0IHRvIHRoZSBlbXB0eSBzdHJpbmcsIHRo
ZXNlCithcmUgbGlzdGVkIHdpdGggYGA8bm9uZT4nJy4KKyovCisKKyMgT1BUSU9OUworCit7ICJh
Y2FwX2F1dGhuYW1lIiwgTlVMTCwgU1RSSU5HIH0KKworeyAiYWNhcF9nZXRhdXRoIiwgTlVMTCwg
U1RSSU5HIH0KKworeyAiYWNhcF9wYXNzd29yZCIsIE5VTEwsIFNUUklORyB9CisKK3sgImFjYXBf
cmVhbG0iLCBOVUxMLCBTVFJJTkcgfQorCit7ICJhY2FwX3JldHJ5X3RpbWVvdXQiLCA2MCwgSU5U
IH0KKworeyAiYWNhcF9zZXJ2ZXIiLCBOVUxMLCBTVFJJTkcgfSAgCisKK3sgImFjYXBfdXNlcm5h
bWUiLCBOVUxMLCBTVFJJTkcgfQorCit7ICJhZG1pbnMiLCAiIiwgU1RSSU5HIH0KKy8qIFRoZSBs
aXN0IG9mIHVzZXJpZHMgd2l0aCBhZG1pbmlzdHJhdGl2ZSByaWdodHMuICBTZXBhcmF0ZSBlYWNo
IHVzZXJpZAorICAgd2l0aCBhIHNwYWNlLiAgU2l0ZXMgdXNpbmcgS2VyYmVyb3MgYXV0aGVudGlj
YXRpb24gbWF5IHVzZQorICAgc2VwYXJhdGUgImFkbWluIiBpbnN0YW5jZXMuCisuUFAKKyAgIE5v
dGUgdGhhdCBhY2NvdW50cyB1c2VkIGJ5IHVzZXJzIHNob3VsZCBub3QgYmUgYWRtaW5pc3RyYXRv
cnMuCisgICBBZG1pbmlzdHJhdGl2ZSBhY2NvdW50cyBzaG91bGQgbm90IHJlY2VpdmUgbWFpbC4g
IFRoYXQgaXMsIGlmIHVzZXIKKyAgICJqYlJvIiBpcyBhIHVzZXIgcmVhZGluZyBtYWlsLCBoZSBz
aG91bGQgbm90IGFsc28gYmUgaW4gdGhlIGFkbWlucyBsaW5lLgorICAgU29tZSBwcm9ibGVtcyBt
YXkgb2NjdXIgb3RoZXJ3aXNlLCBtb3N0IG5vdGFibHkgdGhlIGFiaWxpdHkgb2YKKyAgIGFkbWlu
aXN0cmF0b3JzIHRvIGNyZWF0ZSB0b3AtbGV2ZWwgbWFpbGJveGVzIHZpc2libGUgdG8gdXNlcnMs
CisgICBidXQgbm90IHdyaXRhYmxlIGJ5IHVzZXJzLiAqLworCit7ICJhbGxvd2FsbHN1YnNjcmli
ZSIsIDAsIFNXSVRDSCB9CisvKiBBbGxvdyBzdWJzY3JpcHRpb24gdG8gbm9uZXhpc3RhbnQgbWFp
bGJveGVzLiAqLworCit7ICJhbGxvd2Fub255bW91c2xvZ2luIiwgMCwgU1dJVENIIH0KKy8qIFBl
cm1pdCBsb2dpbnMgYnkgdGhlIHVzZXIgImFub255bW91cyIgdXNpbmcgYW55IHBhc3N3b3JkLiAg
QWxzbworICAgYWxsb3dzIHVzZSBvZiB0aGUgU0FTTCBBTk9OWU1PVVMgbWVjaGFuaXNtLiAqLwor
Cit7ICJhbGxvd3BsYWludGV4dCIsIDEsIFNXSVRDSCB9CisvKiBBbGxvdyB0aGUgdXNlIG9mIHRo
ZSBTQVNMIFBMQUlOIG1lY2hhbmlzbS4gKi8KKyAgIAoreyAiYWx0bmFtZXNwYWNlIiwgMCwgU1dJ
VENIIH0KKy8qIFVzZSB0aGUgYWx0ZXJuYXRlIElNQVAgbmFtZXNwYWNlLCB3aGVyZSBwZXJzb25h
bCBmb2xkZXJzIHJlc2lkZSBhdCB0aGUKKyAgIHNhbWUgbGV2ZWwgaW4gdGhlIGhpZXJhcmNoeSBh
cyBJTkJPWC4KKy5QUAorICAgVGhpcyBvcHRpb24gT05MWSBhcHBsaWVzIHdoZXJlIGludGVyYWN0
aW9uIHRha2VzIHBsYWNlIHdpdGggdGhlCisgICBjbGllbnQvdXNlci4gIEN1cnJlbnRseSB0aGlz
IGlzIGxpbWl0ZWQgdG8gdGhlIElNQVAgcHJvdG9jb2wgKGltYXBkKQorICAgYW5kIFNpZXZlIHNj
cmlwdHMgKGxtdHBkKS4gIFRoaXMgb3B0aW9uIGRvZXMgTk9UIGFwcGx5IHRvIGFkbWluIHRvb2xz
CisgICBzdWNoIGFzIGN5cmFkbSAoYWRtaW5zIE9OTFkpLCByZWNvbnN0cnVjdCwgcXVvdGEsIGV0
Yy4sIE5PUiBkb2VzIGl0CisgICBhZmZlY3QgTE1UUCBkZWxpdmVyeSBvZiBtZXNzYWdlcyBkaXJl
Y3RseSB0byBtYWlsYm94ZXMgdmlhCisgICBwbHVzLWFkZHJlc3NpbmcuICovCisKK3sgImF1dG9j
cmVhdGVxdW90YSIsIDAsIElOVCB9CisvKiBJZiBub256ZXJvLCBub3JtYWwgdXNlcnMgbWF5IGNy
ZWF0ZSB0aGVpciBvd24gSU1BUCBhY2NvdW50cyBieQorICAgY3JlYXRpbmcgdGhlIG1haWxib3gg
SU5CT1guICBUaGUgdXNlcidzIHF1b3RhIGlzIHNldCB0byB0aGUgdmFsdWUKKyAgIGlmIGl0IGlz
IHBvc2l0aXZlLCBvdGhlcndpc2UgdGhlIHVzZXIgaGFzIHVubGltaXRlZCBxdW90YS4gKi8KKwor
eyAiY29uZmlnZGlyZWN0b3J5IiwgTlVMTCwgU1RSSU5HIH0KKy8qIFRoZSBwYXRobmFtZSBvZiB0
aGUgSU1BUCBjb25maWd1cmF0aW9uIGRpcmVjdG9yeS4gIFRoaXMgZmllbGQgaXMKKyAgIHJlcXVp
cmVkLiAqLworCit7ICJkZWJ1Z19jb21tYW5kIiwgTlVMTCwgU1RSSU5HIH0KKy8qIERlYnVnIGNv
bW1hbmQgdG8gYmUgdXNlZCBieSBwcm9jZXNzZXMgc3RhcnRlZCB3aXRoIC1EIG9wdGlvbi4gIFRo
ZSBzdHJpbmcKKyAgIGlzIGEgQyBmb3JtYXQgc3RyaW5nIHRoYXQgZ2V0cyAzIG9wdGlvbnM6IHRo
ZSBmaXJzdCBpcyB0aGUgbmFtZSBvZiB0aGUKKyAgIGV4ZWN1dGFibGUgKHdpdGhvdXQgcGF0aCku
ICBUaGUgc2Vjb25kIGlzIHRoZSBwaWQgKGludGVnZXIpIGFuZCB0aGUgdGhpcmQKKyAgIGlzIHRo
ZSBzZXJ2aWNlIElELiAgRXhhbXBsZTogL3Vzci9sb2NhbC9iaW4vZ2RiIC91c3IvY3lydXMvYmlu
LyVzICVkICovCisKK3sgImRlZmF1bHRhY2wiLCAiYW55b25lIGxycyIsIFNUUklORyB9CisvKiBU
aGUgQWNjZXNzIENvbnRyb2wgTGlzdCAoQUNMKSBwbGFjZWQgb24gYSBuZXdseS1jcmVhdGVkIChu
b24tdXNlcikKKyAgIG1haWxib3ggdGhhdCBkb2VzIG5vdCBoYXZlIGEgcGFyZW50IG1haWxib3gu
ICovCisKK3sgImRlZmF1bHRwYXJ0aXRpb24iLCAiZGVmYXVsdCIsIFNUUklORyB9CisvKiBUaGUg
cGFydGl0aW9uIG5hbWUgdXNlZCBieSBkZWZhdWx0IGZvciBuZXcgbWFpbGJveGVzLiAqLworCit7
ICJkZWxldGVyaWdodCIsICJjIiwgU1RSSU5HIH0KKy8qIFRoZSByaWdodCB0aGF0IGEgdXNlciBu
ZWVkcyB0byBkZWxldGUgYSBtYWlsYm94LiAqLworCit7ICJkdXBsaWNhdGVzdXBwcmVzc2lvbiIs
IDEsIFNXSVRDSCB9CisvKiBJZiBlbmFibGVkLCBsbXRwZCB3aWxsIHN1cHByZXNzIGRlbGl2ZXJ5
IG9mIGEgbWVzc2FnZSB0byBhIG1haWxib3ggaWYKKyAgIGEgbWVzc2FnZSB3aXRoIHRoZSBzYW1l
IG1lc3NhZ2UtaWQgKG9yIHJlc2VudC1tZXNzYWdlLWlkKSBpcyByZWNvcmRlZAorICAgYXMgaGF2
aW5nIGFscmVhZHkgYmVlbiBkZWxpdmVyZWQgdG8gdGhlIG1haWxib3guICBSZWNvcmRzIHRoZSBt
YWlsYm94CisgICBhbmQgbWVzc2FnZS1pZC9yZXNlbnQtbWVzc2FnZS1pZCBvZiBhbGwgc3VjY2Vz
c2Z1bCBkZWxpdmVyaWVzLiAqLworCit7ICJmb29sc3R1cGlkY2xpZW50cyIsIDAsIFNXSVRDSCB9
CisvKiBJZiBlbmFibGVkLCBvbmx5IGxpc3QgdGhlIHBlcnNvbmFsIG5hbWVzcGFjZSB3aGVuIGEg
TElTVCAiKiIgaXMgcGVyZm9ybWVkLgorICAgKGl0IGNoYW5nZXMgdGhlIHJlcXVlc3QgdG8gYSBM
SVNUICJJTkJPWCoiICovCisKK3sgImhhc2hpbWFwc3Bvb2wiLCAwLCBTV0lUQ0ggfQorLyogSWYg
ZW5hYmxlZCwgdGhlIHBhcnRpdGlvbnMgd2lsbCBhbHNvIGJlIGhhc2hlZCwgaW4gYWRkaXRpb24g
dG8gdGhlCisgICBoYXNoaW5nIGRvbmUgb24gY29uZmlndXJhdGlvbiBkaXJlY3Rvcmllcy4gIFRo
aXMgaXMgcmVjb21tZW5kZWQgaWYKKyAgIG9uZSBwYXJ0aXRpb24gaGFzIGEgdmVyeSBidXNoeSBt
YWlsYm94IHRyZWUuICovCisKKyMgQ29tbWVudGVkIG91dCAtIHRoZXJlJ3Mgbm8gc3VjaCB0aGlu
ZyBhcyAicGFydGl0aW9uLW5hbWUiLCBidXQgd2UgbmVlZAorIyB0aGlzIGZvciB0aGUgbWFuIHBh
Z2UKKyMgeyAiaG9zdG5hbWVfbWVjaHMiLCBOVUxMLCBTVFJJTkcgfQorLyogRm9yY2UgYSBwYXJ0
aWN1YXIgbGlzdCBvZiBTQVNMIG1lY2hhbmlzbXMgdG8gYmUgdXNlZCB3aGVuIGF1dGhlbnRpY2F0
aW5nCisgICB0byB0aGUgYmFja2VuZCBzZXJ2ZXIgaG9zdG5hbWUgKHdoZXJlIGhvc3RuYW1lIGlz
IHRoZSBzaG9ydCBob3N0bmFtZSBvZgorICAgdGhlIHNlcnZlciBpbiBxdWVzdGlvbikuIElmIGl0
IGlzIG5vdCBzcGVjaWZpZWQgaXQgd2lsbCBxdWVyeSB0aGUgc2VydmVyCisgICBmb3IgYXZhaWxh
YmxlIG1lY2hhbmlzbXMgYW5kIHBpY2sgb25lIHRvIHVzZS4gLSBDeXJ1cyBNdXJkZXIKKworIyB7
ICJob3N0bmFtZV9wYXNzd29yZCIsIE5VTEwsIFNUUklORyB9CisvKiBUaGUgcGFzc3dvcmQgdG8g
dXNlIGZvciBhdXRoZW50aWNhdGlvbiB0byB0aGUgYmFja2VuZCBzZXJ2ZXIgaG9zdG5hbWUKKyAg
ICh3aGVyZSBob3N0bmFtZSBpcyB0aGUgc2hvcnQgaG9zdG5hbWUgb2YgdGhlIHNlcnZlcikgLSBD
eXJ1cyBNdXJkZXIgKi8KKworeyAiaWRsZXNvY2tldCIsICJ7Y29uZmlnZGlyZWN0b3J5fS9zb2Nr
ZXQvaWRsZSIsIFNUUklORyB9CisvKiBVbml4IGRvbWFpbiBzb2NrZXQgdGhhdCBpZGxlZCBsaXN0
ZW5zIG9uLiAqLworCit7ICJpZ25vcmVyZWZlcmVuY2UiLCAwLCBTV0lUQ0ggfQorLyogRm9yIGJh
Y2t3YXJkcyBjb21wYXRpYmlsaXR5IHdpdGggQ3lydXMgMS41LjEwIGFuZCBlYXJsaWVyIC0tIGln
bm9yZQorICogdGhlIHJlZmVyZW5jZSBhcmd1bWVudCBpbiBMSVNUIG9yIExTVUIgY29tbWFuZHNh
ICovCisKK3sgImltYXBpZGxlcG9sbCIsIDYwLCBJTlQgfQorLyogVGhlIGludGVydmFsIChpbiBz
ZWNvbmRzKSBmb3IgcG9sbGluZyB0aGUgbWFpbGJveCBmb3IgY2hhbmdlcyB3aGlsZQorICAgcnVu
bmluZyB0aGUgSURMRSBjb21tYW5kLiAgVGhpcyBvcHRpb24gaXMgdXNlZCB3aGVuIGlkbGVkIGNh
biBub3QKKyAgIGJlIGNvbnRhY3RlZCBvciB3aGVuIHBvbGxpbmcgaXMgdXNlZCBleGNsdXNpdmVs
eS4gIFRoZSBtaW5pbXVtCisgICB2YWx1ZSBpcyAxLiAgQSB2YWx1ZSBvZiAwIHdpbGwgZGlzYWJs
ZSBwb2xsaW5nIChhbmQgZGlzYWJsZSBJRExFIGlmCisgICBwb2xsaW5nIGlzIHRoZSBvbmx5IG1l
dGhvZCBhdmFpbGFibGUpLiAqLworCit7ICJpbWFwaWRyZXNwb25zZSIsIDEsIFNXSVRDSCB9Cisv
KiBJZiBlbmFibGVkLCB0aGUgc2VydmVyIHJlc3BvbmRzIHRvIGFuIElEIGNvbW1hbmQgd2l0aCBh
IHBhcmFtZXRlciAKKyAgIGxpc3QgY29udGFpbmluZzogdmVyc2lvbiwgdmVuZG9yLCBzdXBwb3J0
LXVybCwgb3MsIG9zLXZlcnNpb24sCisgICBjb21tYW5kLCBhcmd1bWVudHMsIGVudmlyb25tZW50
LiAgT3RoZXJ3aXNlIHRoZSBzZXJ2ZXIgcmV0dXJucyBOSUwuICovCisKK3sgImxtdHBfb3Zlcl9x
dW90YV9wZXJtX2ZhaWx1cmUiLCAwLCBTV0lUQ0ggfQorLyogSWYgZW5hYmxlZCwgbG10cGQgcmV0
dXJucyBhIHBlcm1hbmVudCBmYWlsdXJlIGNvZGUgd2hlbiBhIHVzZXIncworICAgbWFpbGJveCBp
cyBvdmVyIHF1b3RhLiAgQnkgZGVmYXVsdCwgdGhlIGZhaWx1cmUgaXMgdGVtcG9yYXJ5LiAqLwor
Cit7ICJsbXRwc29ja2V0IiwgIntjb25maWdkaXJlY3Rvcnl9L3NvY2tldC9sbXRwIiwgU1RSSU5H
IH0KKy8qIFVuaXggZG9tYWluIHNvY2tldCB0aGF0IGxtdHBkIGxpc3RlbnMgb24sIHVzZWQgYnkg
ZGVsaXZlcig4KS4gKi8KKworeyAibG9naW5yZWFsbXMiLCAiIiwgU1RSSU5HIH0KKy8qIFRoZSBs
aXN0IG9mIHJlbW90ZSByZWFsbXMgd2hvc2UgdXNlcnMgbWF5IGxvZyBpbiB1c2luZyBjcm9zcy1y
ZWFsbQorICAgYXV0aGVudGljYXRpb25zLiAgU2VwZXJhdGUgZWFjaCByZWFsbSBuYW1lIGJ5IGEg
c3BhY2UuICAoQQorICAgY3Jvc3MtcmVhbG0gaWRlbnRpdHkgaXMgY29uc2lkZXJlZCBhbnkgaWRl
bnRpdHkgcmV0dXJuZWQgYnkgU0FTTAorICAgd2l0aCBhbiAiQCIgaW4gaXQuKSAqLworCit7ICJs
b2dpbnVzZWFjbCIsIDAsIFNXSVRDSCB9CisvKiBJZiBlbmFibGVkLCBhbnkgYXV0aGVudGljYXRp
b24gaWRlbnRpdHkgd2hpY2ggaGFzIFxmQmFcZlIgcmlnaHRzIG9uIGEKKyAgIHVzZXIncyBJTkJP
WCBtYXkgbG9nIGluIGFzIHRoYXQgdXNlci4gKi8KKworeyAibG9ndGltZXN0YW1wcyIsIDAsIFNX
SVRDSCB9CisvKiBJbmNsdWRlIG5vdGF0aW9ucyBpbiB0aGUgcHJvdG9jb2wgdGVsZW1ldHJ5IGxv
Z3MgaW5kaWNhdGluZyB0aGUgbnVtYmVyIG9mCisgICBzZWNvbmRzIHNpbmNlIHRoZSBsYXN0IGNv
bW1hbmQgb3IgcmVzcG9uc2UuICovCisKK3sgIm1haWxub3RpZmllciIsIE5VTEwsIFNUUklORyB9
CisvKiBOb3RpZnlkKDgpIG1ldGhvZCB0byB1c2UgZm9yICJNQUlMIiBub3RpZmljYXRpb25zLiAg
SWYgbm90IHNldCwgIk1BSUwiCisgICBub3RpZmljYXRpb25zIGFyZSBkaXNhYmxlZC4gKi8KKwor
eyAibWF4bWVzc2FnZXNpemUiLCAwLCBJTlQgfQorLyogTWF4aW11bSBpbmNvbWluZyBMTVRQIG1l
c3NhZ2Ugc2l6ZS4gIElmIG5vbi16ZXJvLCBsbXRwZCB3aWxsIHJlamVjdAorICAgbWVzc2FnZXMg
bGFyZ2VyIHRoYW4gXGZJbWF4bWVzc2FnZXNpemVcZlIgYnl0ZXMuICBJZiBzZXQgdG8gMCwgdGhp
cworICAgd2lsbCBhbGxvdyBtZXNzYWdlcyBvZiBhbnkgc2l6ZSAodGhlIGRlZmF1bHQpLiAqLwor
Cit7ICJtdXBkYXRlX2F1dGhuYW1lIiwgTlVMTCwgU1RSSU5HIH0KKy8qIFRoZSBTQVNMIHVzZXJu
YW1lIChBdXRoZW50aWNhdGlvbiBOYW1lKSB0byB1c2Ugd2hlbiBhdXRoZW50aWNhdGluZyB0byB0
aGUKKyAgIG11cGRhdGUgc2VydmVyIChpZiBuZWVkZWQpLiAqLworCit7ICJtdXBkYXRlX3Bhc3N3
b3JkIiwgTlVMTCwgU1RSSU5HIH0KKy8qIFRoZSBTQVNMIHBhc3N3b3JkIChpZiBuZWVkZWQpIHRv
IHVzZSB3aGVuIGF1dGhlbnRpY2F0aW5nIHRvIHRoZQorICAgbXVwZGF0ZSBzZXJ2ZXIuICovCisK
K3sgIm11cGRhdGVfcG9ydCIsIDIwMDQsIElOVCB9CisvKiBUaGUgcG9ydCBvZiB0aGUgbXVwZGF0
ZSBzZXJ2ZXIgZm9yIHRoZSBDeXJ1cyBNdXJkZXIgKi8KKworeyAibXVwZGF0ZV9yZWFsbSIsIE5V
TEwsIFNUUklORyB9CisvKiBUaGUgU0FTTCByZWFsbSAoaWYgbmVlZGVkKSB0byB1c2Ugd2hlbiBh
dXRoZW50aWNhdGluZyB0byB0aGUgbXVwZGF0ZQorICAgc2VydmVyLiAqLworCit7ICJtdXBkYXRl
X3JldHJ5X2RlbGF5IiwgMjAsIElOVCB9CisvKiBUaGUgYmFzZSB0aW1lIHRvIHdhaXQgYmV0d2Vl
biBjb25uZWN0aW9uIHJldHJpZXMgdG8gdGhlIG11cGRhdGUgc2VydmVyLiAqLworCit7ICJtdXBk
YXRlX3NlcnZlciIsIE5VTEwsIFNUUklORyB9CisvKiBUaGUgbXVwZGF0ZSBzZXJ2ZXIgZm9yIHRo
ZSBDeXJ1cyBNdXJkZXIgKi8KKworeyAibXVwZGF0ZV91c2VybmFtZSIsICIiLCBTVFJJTkcgfQor
LyogVGhlIFNBU0wgdXNlcm5hbWUgKEF1dGhvcml6YXRpb24gTmFtZSkgdG8gdXNlIHdoZW4gYXV0
aGVudGljYXRpbmcgdG8KKyAgIHRoZSBtdXBkYXRlIHNlcnZlciAqLworCit7ICJuZXRzY2FwZXVy
bCIsICJodHRwOi8vYXNnLndlYi5jbXUuZWR1L2N5cnVzL2ltYXBkL25ldHNjYXBlLWFkbWluLmh0
bWwiLCBTVFJJTkcgfQorLyogSWYgZW5hYmxlZCBhdCBjb21waWxlIHRpbWUsIHRoaXMgc3BlY2lm
aWVzIGEgVVJMIHRvIHJlcGx5IHdoZW4KKyAgIE5ldHNjYXBlIGFza3MgdGhlIHNlcnZlciB3aGVy
ZSB0aGUgbWFpbCBhZG1pbmlzdHJhdGlvbiBIVFRQIHNlcnZlcgorICAgaXMuICBUaGUgZGVmYXVs
dCBpcyBhIHNpdGUgYXQgQ01VIHdpdGggYSBob3BlZnVsbHkgaW5mb3JtYXRpdmUKKyAgIG1lc3Nh
Z2U7IGFkbWluaXN0cmF0b3JzIHNob3VsZCBzZXQgdGhpcyB0byBhIGxvY2FsIHJlc291cmNlIHdp
dGgKKyAgIHNvbWUgaW5mb3JtYXRpb24gb2YgZ3JlYXRlciB1c2UuICovCisKK3sgIm5ld3NwcmVm
aXgiLCAwLCBTVFJJTkcgfQorLyogUHJlZml4IHRvIGJlIHByZXBlbmRlZCB0byBuZXdzZ3JvdXAg
bmFtZXMgdG8gbWFrZSB0aGUgY29ycmVzcG9uZGluZworICAgSU1BUCBtYWlsYm94IG5hbWVzLiAq
LworCit7ICJub3RpZnlzb2NrZXQiLCAie2NvbmZpZ2RpcmVjdG9yeX0vc29ja2V0L25vdGlmeSIs
IFNUUklORyB9CisvKiBVbml4IGRvbWFpbiBzb2NrZXQgdGhhdCB0aGUgbmV3IG1haWwgbm90aWZp
Y2F0aW9uIGRhZW1vbiBsaXN0ZW5zIG9uLiAqLworCisjIENvbW1lbnRlZCBvdXQgLSB0aGVyZSdz
IG5vIHN1Y2ggdGhpbmcgYXMgInBhcnRpdGlvbi1uYW1lIiwgYnV0IHdlIG5lZWQKKyMgdGhpcyBm
b3IgdGhlIG1hbiBwYWdlCisjIHsgInBhcnRpdGlvbi1uYW1lIiwgTlVMTCwgU1RSSU5HIH0KKy8q
IFRoZSBwYXRobmFtZSBvZiB0aGUgcGFydGl0aW9uIFxmSW5hbWVcZlIuICBBdCBsZWFzdCBvbmUg
ZmllbGQsIGZvciB0aGUKKyAgIHBhcnRpdGlvbiBuYW1lZCBpbiB0aGUgXGZCZGVmYXVsdHBhcnRp
dGlvblxmUiBvcHRpb24sIGlzIHJlcXVpcmVkLgorICAgRm9yIGV4YW1wbGUsIGlmIHRoZSB2YWx1
ZSBvZiB0aGUgXGZCZGVmYXVsdHBhcnRpb25cZlIgb3B0aW9uIGlzCisgICBcZkJkZWZhdWx0XGZS
LCB0aGVuIHRoZSBcZkJwYXJ0aXRpb24tZGVmYXVsdFxmUiBmaWVsZCBpcyByZXF1aXJlZC4gKi8K
KworIyB7ICJwYXJ0aXRpb24tbmV3cyIsIE5VTEwsIFNUUklORyB9CisKK3sgInBsYWludGV4dGxv
Z2lucGF1c2UiLCAwLCBJTlQgfQorLyogTnVtYmVyIG9mIHNlY29uZHMgdG8gcGF1c2UgYWZ0ZXIg
YSBzdWNjZXNzZnVsIHBsYWludGV4dCBsb2dpbi4gIEZvcgorICAgc3lzdGVtcyB0aGF0IHN1cHBv
cnQgc3Ryb25nIGF1dGhlbnRpY2F0aW9uLCB0aGlzIHBlcm1pdHMgdXNlcnMgdG8gIAorICAgcGVy
Y2VpdmUgYSBjb3N0IG9mIHVzaW5nIHBsYWludGV4dCBwYXNzd29yZHMuICAoVGhpcyBkb2VzIG5v
dAorICAgYWZmZWN0IHRoZSB1c2Ugb2YgUExBSU4gaW4gU0FTTCBhdXRoZW50aWNhdGlvbnMuKSAq
LworCit7ICJwb3BleHBpcmV0aW1lIiwgLTEsIElOVCB9CisvKiBUaGUgbnVtYmVyIG9mIGRheXMg
YWR2ZXJ0aXNlZCBhcyBiZWluZyB0aGUgbWluaW11bSBhIG1lc3NhZ2UgbWF5IGJlCisgICBsZWZ0
IG9uIHRoZSBQT1Agc2VydmVyIGJlZm9yZSBpdCBpcyBkZWxldGVkICh2aWEgdGhlIENBUEEgY29t
bWFuZCwKKyAgIGRlZmluZWQgaW4gdGhlIFBPUDMgRXh0ZW5zaW9uIE1lY2hhbmlzbSwgd2hpY2gg
c29tZSBjbGllbnRzIG1heQorICAgc3VwcG9ydCkuICAiTkVWRVIiLCB0aGUgZGVmYXVsdCwgbWF5
IGJlIHNwZWNpZmllZCB3aXRoIGEgbmVnYXRpdmUKKyAgIG51bWJlci4gIFRoZSBDeXJ1cyBQT1Az
IHNlcnZlciBuZXZlciBkZWxldGVzIG1haWwsIG5vIG1hdHRlciB3aGF0ICAKKyAgIHRoZSB2YWx1
ZSBvZiB0aGlzIHBhcmFtZXRlciBpcy4gIEhvd2V2ZXIsIGlmIGEgc2l0ZSBpbXBsZW1lbnRzIGEg
CisgICBsZXNzIGxpYmVyYWwgcG9saWN5LCBpdCBuZWVkcyB0byBjaGFuZ2UgdGhpcyBwYXJhbWV0
ZXIKKyAgIGFjY29yZGluZ2x5LiAqLworCit7ICJwb3BtaW5wb2xsIiwgMCwgSU5UIH0KKy8qIFNl
dCB0aGUgbWluaW11bSBhbW91bnQgb2YgdGltZSB0aGUgc2VydmVyIGZvcmNlcyB1c2VycyB0byB3
YWl0CisgICBiZXR3ZWVuIHN1Y2Nlc3NpdmUgUE9QIGxvZ2lucywgaW4gbWludXRlcy4gIFRoZSBk
ZWZhdWx0IGlzIDAuICovIAorCit7ICJwb3B0aW1lb3V0IiwgMTAsIElOVCB9CisvKiBTZXQgdGhl
IGxlbmd0aCBvZiB0aGUgUE9QIHNlcnZlcidzIGluYWN0aXZpdHkgYXV0b2xvZ291dCB0aW1lciwg
ICAgCisgICBpbiBtaW51dGVzLiAgVGhlIG1pbmltdW0gdmFsdWUgaXMgMTAsIHRoZSBkZWZhdWx0
LiAqLworCit7ICJwb3N0bWFzdGVyIiwgInBvc3RtYXN0ZXIiLCBTVFJJTkcgfQorLyogVXNlcm5h
bWUgdGhhdCBpcyB1c2VkIGFzIHRoZSAnRnJvbScgYWRkcmVzcyBpbiByZWplY3Rpb24gTUROcyBw
cm9kdWNlZAorICAgYnkgc2lldmUuICovCisgICAKK3sgInBvc3RzcGVjIiwgTlVMTCwgU1RSSU5H
IH0KKworeyAicG9zdHVzZXIiLCAiIiwgU1RSSU5HIH0KKy8qIFVzZXJpZCB1c2VkIHRvIGRlbGl2
ZXIgbWVzc2FnZXMgdG8gc2hhcmVkIGZvbGRlcnMuICBGb3IgZXhhbXBsZSwgaWYKKyAgIHNldCB0
byAiYmIiLCBlbWFpbCBzZW50IHRvICJiYitzaGFyZWQuYmxhaCIgd291bGQgYmUgZGVsaXZlcmVk
IHRvCisgICB0aGUgInNoYXJlZC5ibGFoIiBmb2xkZXIuICBCeSBkZWZhdWx0LCBhbiBlbWFpbCBh
ZGRyZXNzIG9mCisgICAiK3NoYXJlZC5ibGFoIiB3b3VsZCBiZSB1c2VkLiAqLyAKKworeyAicHJv
eHlfYXV0aG5hbWUiLCAicHJveHkiLCBTVFJJTkcgfQorLyogVGhlIGF1dGhlbnRpY2F0aW9uIG5h
bWUgdG8gdXNlIHdoZW4gYXV0aGVudGljYXRpbmcgdG8gYSBiYWNrZW5kIHNlcnZlcgorICAgaW4g
dGhlIEN5cnVzIE11cmRlci4gKi8KKworeyAicHJveHlfcGFzc3dvcmQiLCBOVUxMLCBTVFJJTkcg
fQorLyogVGhlIGRlZmF1bHQgcGFzc3dvcmQgdG8gdXNlIHdoZW4gYXV0aGVudGljYXRpbmcgdG8g
YSBiYWNrZW5kIHNlcnZlcgorICAgaW4gdGhlIEN5cnVzIE11cmRlci4gIE1heSBiZSBvdmVycmlk
ZGVuIG9uIGEgaG9zdC1zcGVjaWZpYyBiYXNpcyB1c2luZworICAgdGhlIGhvc3RuYW1lX3Bhc3N3
b3JkIG9wdGlvbi4gKi8KKworeyAicHJveHlfcmVhbG0iLCBOVUxMLCBTVFJJTkcgfQorLyogVGhl
IGF1dGhlbnRpY2F0aW9uIHJlYWxtIHRvIHVzZSB3aGVuIGF1dGhlbnRpY2F0aW5nIHRvIGEgYmFj
a2VuZCBzZXJ2ZXIKKyAgIGluIHRoZSBDeXJ1cyBNdXJkZXIgKi8KKworeyAicHJveHlkX2FsbG93
X3N0YXR1c19yZWZlcnJhbCIsIDAsIFNXSVRDSCB9CisvKiBTZXQgdG8gdHJ1ZSB0byBhbGxvdyBw
cm94eWQgdG8gaXNzdWUgcmVmZXJyYWxzIHRvIGNsaWVudHMgdGhhdCBzdXBwb3J0IGl0CisgICB3
aGVuIGFuc3dlcmluZyB0aGUgU1RBVFVTIGNvbW1hbmQuICBUaGlzIGlzIGRpc2FibGVkIGJ5IGRl
ZmF1bHQgc2luY2UKKyAgIHNvbWUgY2xpZW50cyBpc3N1ZSBtYW55IFNUQVRVUyBjb21tYW5kcyBp
biBhIHJvdywgYW5kIGRvIG5vdCBjYWNoZSB0aGUKKyAgIGNvbm5lY3Rpb25zIHRoYXQgdGhlc2Ug
cmVmZXJyYWxzIHdvdWxkIGNhdXNlLCB0aHVzIHJlc3VsdGluZyBpbiBhIGhpZ2hlcgorICAgYXV0
aGVudGljYXRpb24gbG9hZCBvbiB0aGUgcmVzcGVjdGl2ZSBiYWNrZW5kIHNlcnZlci4gKi8KKwor
eyAicHJveHlzZXJ2ZXJzIiwgTlVMTCwgU1RSSU5HIH0KKy8qIEEgbGlzdCBvZiB1c2VycyBhbmQg
Z3JvdXBzIHRoYXQgYXJlIGFsbG93ZWQgdG8gcHJveHkgZm9yIG90aGVyCisgICB1c2Vycywgc2Vw
ZXJhdGVkIGJ5IHNwYWNlcy4gIEFueSB1c2VyIGxpc3RlZCBpbiB0aGlzIHdpbGwgYmUKKyAgIGFs
bG93ZWQgdG8gbG9naW4gZm9yIGFueSBvdGhlciB1c2VyOiB1c2Ugd2l0aCBjYXV0aW9uLiAqLyAK
KworeyAicXVvdGF3YXJuIiwgOTAsIElOVCB9CisvKiBUaGUgcGVyY2VudCBvZiBxdW90YSB1dGls
aXphdGlvbiBvdmVyIHdoaWNoIHRoZSBzZXJ2ZXIgZ2VuZXJhdGVzCisgICB3YXJuaW5ncy4gKi8K
KworeyAicmVqZWN0OGJpdCIsIDAsIFNXSVRDSCB9CisvKiBJZiBlbmFibGVkLCBsbXRwZCByZWpl
Y3RzIG1lc3NhZ2VzIHdpdGggOC1iaXQgY2hhcmFjdGVycyBpbiB0aGUKKyAgIGhlYWRlcnMuICBP
dGhlcndpc2UsIDgtYml0IGNoYXJhY3RlcnMgYXJlIGNoYW5nZWQgdG8gYFgnLiAgKEEKKyAgIHBy
b3BlciBzb3VsdGlvbiB0byBub24tQVNDSUkgY2hhcmFjdGVycyBpbiBoZWFkZXJzIGlzIG9mZmVy
ZWQgYnkgIAorICAgUkZDIDIwNDcgYW5kIGl0cyBwcmVkZWNlc3NvcnMuKSAqLworCisjIENvbW1l
bnRlZCBvdXQgLSB1c2VkIGJ5IGxpYnNhc2wKKyMgeyAic2FzbF9hdXRvX3RyYW5zaXRpb24iLCAw
LCBTV0lUQ0ggfQorLyogSWYgZW5hYmxlZCwgdGhlIFNBU0wgbGlicmFyeSB3aWxsIGF1dG9tYXRp
Y2FsbHkgY3JlYXRlIGF1dGhlbnRpY2F0aW9uCisgICBzZWNyZXRzIHdoZW4gZ2l2ZW4gYSBwbGFp
bnRleHQgcGFzc3dvcmQuICBTZWUgdGhlIFNBU0wgZG9jdW1lbnRhdGlvbi4gKi8KKworeyAic2Fz
bF9tYXhpbXVtX2xheWVyIiwgMjU2LCBJTlQgfQorLyogTWF4aW11bSBTU0YgKHNlY3VyaXR5IHN0
cmVuZ3RoIGZhY3RvcikgdGhhdCB0aGUgc2VydmVyIHdpbGwgYWxsb3cgYQorICAgY2xpZW50IHRv
IG5lZ290aWF0ZS4gKi8KKworeyAic2FzbF9taW5pbXVtX2xheWVyIiwgMCwgSU5UIH0KKy8qIFRo
ZSBtaW5pbXVtIFNTRiB0aGF0IHRoZSBzZXJ2ZXIgd2lsbCBhbGxvdyBhIGNsaWVudCB0byBuZWdv
dGlhdGUuCisgICBBIHZhbHVlIG9mIDEgcmVxdWlyZXMgaW50ZWdyaXR5IHByb3RlY3Rpb247IGFu
eSBoaWdoZXIgdmFsdWUgIAorICAgcmVxdWlyZXMgc29tZSBhbW91bnQgb2YgZW5jcnlwdGlvbi4g
Ki8KKworIyBDb21tZW50ZWQgb3V0IC0gdXNlZCBieSBsaWJzYXNsCisjIHsgInNhc2xfb3B0aW9u
IiwgMCwgU1RSSU5HIH0KKy8qIEFueSBTQVNMIG9wdGlvbiBjYW4gYmUgc2V0IGJ5IHByZWNlZWRp
bmcgaXQgd2l0aCAic2FzbF8iLiAgVGhpcworICAgZmlsZSBvdmVycmlkZXMgdGhlIFNBU0wgY29u
ZmlndXJhdGlvbiBmaWxlLiAqLworCisjIENvbW1lbnRlZCBvdXQgLSB1c2VkIGJ5IGxpYnNhc2wK
KyMgeyAic2FzbF9wd2NoZWNrX21ldGhvZCIsIE5VTEwsIFNUUklORyB9CisvKiBUaGUgbWVjaGFu
aXNtIHVzZWQgYnkgdGhlIHNlcnZlciB0byB2ZXJpZnkgcGxhaW50ZXh0IHBhc3N3b3Jkcy4gCisg
ICBQb3NzaWJsZSB2YWx1ZXMgaW5jbHVkZSAiYXV4cHJvcCIsICJzYXNsYXV0aGQiLCBhbmQgInB3
Y2hlY2siLiAqLworCit7ICJzZW5kbWFpbCIsICIvdXNyL2xpYi9zZW5kbWFpbCIsIFNUUklORyB9
CisvKiBUaGUgcGF0aG5hbWUgb2YgdGhlIHNlbmRtYWlsIGV4ZWN1dGFibGUuICBTaWV2ZSBpbnZv
a2VzIHNlbmRtYWlsCisgICBmb3Igc2VuZGluZyByZWplY3Rpb25zLCByZWRpcmVjdHMgYW5kIHZh
Y2F0aW9uIHJlc3BvbnNlcy4gKi8KKworeyAic2VydmVybmFtZSIsIE5VTEwsIFNUUklORyB9Cisv
KiBUaGlzIGlzIHRoZSBob3N0bmFtZSB2aXNpYmxlIGluIHRoZSBncmVldGluZyBtZXNzYWdlcyBv
ZiB0aGUgUE9QLAorICAgSU1BUCBhbmQgTE1UUCBkYWVtb25zLiBJZiBpdCBpcyB1bnNldCwgdGhl
biB0aGUgcmVzdWx0IHJldHVybmVkCisgICBmcm9tIGdldGhvc3RuYW1lKDIpIGlzIHVzZWQuICov
CisgICAKK3sgInNoYXJlZHByZWZpeCIsICJTaGFyZWQgRm9sZGVycyIsIFNUUklORyB9CisvKiBJ
ZiB1c2luZyB0aGUgYWx0ZXJuYXRlIElNQVAgbmFtZXNwYWNlLCB0aGUgcHJlZml4IGZvciB0aGUg
c2hhcmVkCisgICBuYW1lc3BhY2UuICBUaGUgaGllcmFyY2h5IGRlbGltaXRlciB3aWxsIGJlIGF1
dG9tYXRpY2FsbHkgYXBwZW5kZWQuICovCisKK3sgInNpZXZlX21heHNjcmlwdHNpemUiLCAzMiwg
SU5UIH0KKy8qIE1heGltdW0gc2l6ZSAoaW4ga2lsb2J5dGVzKSBhbnkgc2lldmUgc2NyaXB0IGNh
biBiZSwgZW5mb3JjZWQgYXQKKyAgIHN1Ym1pc3Npb24gYnkgdGltc2lldmVkKDgpLiAqLworCit7
ICJzaWV2ZV9tYXhzY3JpcHRzIiwgNSwgSU5UIH0KKy8qIE1heGltdW0gbnVtYmVyIG9mIHNpZXZl
IHNjcmlwdHMgYW55IHVzZXIgbWF5IGhhdmUsIGVuZm9yY2VkIGF0CisgICBzdWJtaXNzaW9uIGJ5
IHRpbXNpZXZlZCg4KS4gKi8KKyAgIAoreyAic2lldmVkaXIiLCAiL3Vzci9zaWV2ZSIsIFNUUklO
RyB9CisvKiBJZiBzaWV2ZXVzZWhvbWVkaXIgaXMgZmFsc2UsIHRoaXMgZGlyZWN0b3J5IGlzIHNl
YXJjaGVkIGZvciBTaWV2ZQorICAgc2NyaXB0cy4gKi8KKworeyAic2lldmVub3RpZmllciIsIE5V
TEwsIFNUUklORyB9CisvKiBOb3RpZnlkKDgpIG1ldGhvZCB0byB1c2UgZm9yICJTSUVWRSIgbm90
aWZpY2F0aW9ucy4gIElmIG5vdCBzZXQsICJTSUVWRSIKKyAgIG5vdGlmaWNhdGlvbnMgYXJlIGRp
c2FibGVkLgorLlBQCisgICBUaGlzIG1ldGhvZCBpcyBvbmx5IHVzZWQgd2hlbiBubyBtZXRob2Qg
aXMgc3BlY2lmaWVkIGluIHRoZSBzY3JpcHQuICovCisKK3sgInNpZXZldXNlaG9tZWRpciIsIDAs
IFNXSVRDSCB9CisvKiBJZiBlbmFibGVkLCBsbXRwZCB3aWxsIGxvb2sgZm9yIFNpZXZlIHNjcmlw
dHMgaW4gdXNlcidzIGhvbWUKKyAgIGRpcmVjdG9yaWVzOiB+dXNlci8uc2lldmUuICovCisKK3sg
InNpbmdsZWluc3RhbmNlc3RvcmUiLCAxLCBTV0lUQ0ggfQorLyogSWYgZW5hYmxlZCwgbG10cGQg
YXR0ZW1wdHMgdG8gb25seSB3cml0ZSBvbmUgY29weSBvZiBhIG1lc3NhZ2UgcGVyCisgICBwYXJ0
aXRpb24gYW5kIGNyZWF0ZSBoYXJkIGxpbmtzLCByZXN1bHRpbmcgaW4gYSBwb3RlbnRpYWxseSBs
YXJnZQorICAgZGlzayBzYXZpbmdzLiAqLworCit7ICJzb2Z0X25vYXV0aCIsIDEsIFNXSVRDSCB9
CisvKiBJZiBlbmFibGVkLCBsbXRwZCByZXR1cm5zIHRlbXBvcmFyeSBmYWlsdXJlcyBpZiB0aGUg
Y2xpZW50IGRvZXMgbm90CisgKiBzdWNjZXNzZnVsbHkgYXV0aGVudGljYXRlLiAgT3RoZXJ3aXNl
IGxtdHBkIHJldHVybnMgcGVybWFuYW50IGZhaWx1cmVzCisgKiAoY2F1c2luZyB0aGUgbWFpbCB0
byBib3VuY2UgaW1tZWRpYXRlbHkpLiAqLworCit7ICJzcnZ0YWIiLCAiIiwgU1RSSU5HIH0KKy8q
IFRoZSBwYXRobmFtZSBvZiBcZklzcnZ0YWJcZlIgZmlsZSBjb250YWluaW5nIHRoZSBzZXJ2ZXIn
cyBwcml2YXRlCisgICBrZXkuICBUaGlzIG9wdGlvbiBpcyBwYXNzZWQgdG8gdGhlIFNBU0wgbGli
cmFyeSBhbmQgb3ZlcnJpZGVzIGl0cworICAgZGVmYXVsdCBzZXR0aW5nLiAqLworCit7ICJ0aW1l
b3V0IiwgMzAsIElOVCB9ICAgCisvKiBUaGUgbGVuZ3RoIG9mIHRoZSBJTUFQIHNlcnZlcidzIGlu
YWN0aXZpdHkgYXV0b2xvZ291dCB0aW1lciwgICAgICAgCisgICBpbiBtaW51dGVzLiAgVGhlIG1p
bmltdW0gdmFsdWUgaXMgMzAsIHRoZSBkZWZhdWx0LiAqLworCit7ICJ0bHNfY2FfZmlsZSIsIE5V
TEwsIFNUUklORyB9CisvKiBGaWxlIGNvbnRhaW5pbmcgb25lIG9yIG1vcmUgQ2VydGlmaWNhdGUg
QXV0aG9yaXR5IChDQSkgY2VydGlmaWNhdGVzLiAqLworCit7ICJ0bHNfY2FfcGF0aCIsIE5VTEws
IFNUUklORyB9CisvKiBQYXRoIHRvIGRpcmVjdG9yeSB3aXRoIGNlcnRpZmljYXRlcyBvZiBDQXMu
ICBUaGlzIGRpcmVjdG9yeSBtdXN0CisgICBoYXZlIGZpbGVuYW1lcyB3aXRoIHRoZSBoYXNoZWQg
dmFsdWUgb2YgdGhlIGNlcnRpZmljYXRlIChzZWUKKyAgIG9wZW5zc2woWFhYKSkuICovCisKK3sg
InRsc19jZXJ0X2ZpbGUiLCBOVUxMLCBTVFJJTkcgfQorLyogRmlsZSBjb250YWluaW5nIHRoZSBj
ZXJ0aWZpY2F0ZSBwcmVzZW50ZWQgZm9yIHNlcnZlciBhdXRoZW50aWNhdGlvbgorICAgZHVyaW5n
IFNUQVJUVExTLiAgQSB2YWx1ZSBvZiAiZGlzYWJsZWQiIHdpbGwgZGlzYWJsZSBTU0wvVExTLiAq
LworCit7ICJ0bHNfY2lwaGVyX2xpc3QiLCAiREVGQVVMVCIsIFNUUklORyB9CisvKiBUaGUgbGlz
dCBvZiBTU0wvVExTIGNpcGhlcnMgdG8gYWxsb3cuICBUaGUgZm9ybWF0IG9mIHRoZSBzdHJpbmcg
aXMKKyAgIGRlc2NyaWJlZCBpbiBjaXBoZXJzKDEpLiAqLworCit7ICJ0bHNfa2V5X2ZpbGUiLCBO
VUxMLCBTVFJJTkcgfQorLyogRmlsZSBjb250YWluaW5nIHRoZSBwcml2YXRlIGtleSBiZWxvbmdp
bmcgdG8gdGhlIHNlcnZlcgorICAgY2VydGlmaWNhdGUuICBBIHZhbHVlIG9mICJkaXNhYmxlZCIg
d2lsbCBkaXNhYmxlIFNTTC9UTFMuICovCisKK3sgInRsc19yZXF1aXJlX2NlcnQiLCAwLCBTV0lU
Q0ggfQorLyogUmVxdWlyZSBhIGNsaWVudCBjZXJ0aWZpY2F0ZSBmb3IgQUxMIHNlcnZpY2VzIChp
bWFwLCBwb3AzLCBsbXRwLCBzaWV2ZSkuICovCisKK3sgInRsc19zZXNzaW9uX3RpbWVvdXQiLCAx
NDQwLCBJTlQgfQorLyogVGhlIGxlbmd0aCBvZiB0aW1lIChpbiBtaW51dGVzKSB0aGF0IGEgVExT
IHNlc3Npb24gd2lsbCBiZSBjYWNoZWQKKyAgIGZvciBsYXRlciByZXVzZS4gIFRoZSBtYXhpbXVt
IHZhbHVlIGlzIDE0NDAgKDI0IGhvdXJzKSwgdGhlCisgICBkZWZhdWx0LiAgQSB2YWx1ZSBvZiAw
IHdpbGwgZGlzYWJsZSBzZXNzaW9uIGNhY2hpbmcuICovCisKK3sgInVtYXNrIiwgIjA3NyIsIFNU
UklORyB9CisvKiBUaGUgdW1hc2sgdmFsdWUgdXNlZCBieSB2YXJpb3VzIEN5cnVzIElNQVAgcHJv
Z3JhbXMuICovCisKK3sgInVzZXJwcmVmaXgiLCAiT3RoZXIgVXNlcnMiLCBTVFJJTkcgfQorLyog
SWYgdXNpbmcgdGhlIGFsdGVybmF0ZSBJTUFQIG5hbWVzcGFjZSwgdGhlIHByZWZpeCBmb3IgdGhl
IG90aGVyIHVzZXJzCisgICBuYW1lc3BhY2UuICBUaGUgaGllcmFyY2h5IGRlbGltaXRlciB3aWxs
IGJlIGF1dG9tYXRpY2FsbHkgYXBwZW5kZWQuICovCisKK3sgInVuaXhoaWVyYXJjaHlzZXAiLCAw
LCBTV0lUQ0ggfQorLyogVXNlIHRoZSBVTklYIHNlcGFyYXRvciBjaGFyYWN0ZXIgJy8nIGZvciBk
ZWxpbWl0aW5nIGxldmVscyBvZgorICAgbWFpbGJveCBoaWVyYXJjaHkuICBUaGUgZGVmYXVsdCBp
cyB0byB1c2UgdGhlIG5ldG5ld3Mgc2VwYXJhdG9yCisgICBjaGFyYWN0ZXIgJy4nLiAqLworCisv
KgorLlNIIFNFRSBBTFNPCisuUFAKK1xmQmltYXBkKDgpXGZSLCBcZkJwb3AzZCg4KVxmUiwgXGZC
bG10cGQoOClcZlIsIFxmQnRpbXNpZXZlZCg4KVxmUiwKK1xmQmlkbGVkKDgpXGZSLCBcZkJub3Rp
ZnlkKDgpXGZSLCBcZkJkZWxpdmVyKDgpXGZSLCBcZkJtYXN0ZXIoOClcZlIsIAorXGZCY2lwaGVy
cygxKVxmUgorKi8KXCBObyBuZXdsaW5lIGF0IGVuZCBvZiBmaWxlCkluZGV4OiBpbWFwL2xtdHBk
LmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3Ny
Yy9jeXJ1cy9pbWFwL2xtdHBkLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuOTgKZGlmZiAtdSAt
cjEuOTggbG10cGQuYwotLS0gbG10cGQuYwkyMDAyLzA2LzAzIDE4OjIyOjI2CTEuOTgKKysrIGxt
dHBkLmMJMjAwMi8wNi8xOCAyMDo0NTo1MApAQCAtMTk0LDcgKzE5NCw3IEBACiAgICAgLyogY2hl
Y2sgaWYgcmVtb3RlIHJlYWxtICovCiAgICAgaWYgKChyZWFsbSA9IHN0cmNocihhdXRoX2lkZW50
aXR5LCAnQCcpKSE9TlVMTCkgewogCXJlYWxtKys7Ci0JdmFsID0gY29uZmlnX2dldHN0cmluZygi
bG9naW5yZWFsbXMiLCAiIik7CisJdmFsID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0xPR0lO
UkVBTE1TKTsKIAl3aGlsZSAoKnZhbCkgewogCSAgICBpZiAoIXN0cm5jYXNlY21wKHZhbCwgcmVh
bG0sIHN0cmxlbihyZWFsbSkpICYmCiAJCSghdmFsW3N0cmxlbihyZWFsbSldIHx8IGlzc3BhY2Uo
KGludCkgdmFsW3N0cmxlbihyZWFsbSldKSkpIHsKQEAgLTIxNSw3ICsyMTUsNyBAQAogICAgICAq
IGZvciBub3cgb25seSBhZG1pbnMgY2FuIGRvIGxtdHAgZnJvbSBhbm90aGVyIG1hY2hpbmUKICAg
ICAgKi8KICAgICBhdXRoc3RhdGUgPSBhdXRoX25ld3N0YXRlKGF1dGhfaWRlbnRpdHksIE5VTEwp
OwotICAgIGFsbG93ZWQgPSBhdXRoaXNhKGF1dGhzdGF0ZSwgImxtdHAiLCAiYWRtaW5zIik7Cisg
ICAgYWxsb3dlZCA9IGNvbmZpZ19hdXRoaXNhKGF1dGhzdGF0ZSwgSU1BUE9QVF9BRE1JTlMpOwog
ICAgIGF1dGhfZnJlZXN0YXRlKGF1dGhzdGF0ZSk7CiAgICAgCiAgICAgaWYgKCFhbGxvd2VkKSB7
CkBAIC0yNDAsNyArMjQwLDYgQEAKIHsKICAgICBpbnQgcjsKIAotICAgIGNvbmZpZ19jaGFuZ2Vp
ZGVudCgibG10cGQiKTsKICAgICBpZiAoZ2V0ZXVpZCgpID09IDApIHJldHVybiAxOwogICAgIAog
ICAgIHNpZ25hbHNfc2V0X3NodXRkb3duKCZzaHV0X2Rvd24pOwpAQCAtMjQ4LDkgKzI0Nyw5IEBA
CiAgICAgc2lnbmFsKFNJR1BJUEUsIFNJR19JR04pOwogCiAjaWZkZWYgVVNFX1NJRVZFCi0gICAg
c2lldmVfdXNlaG9tZWRpciA9IGNvbmZpZ19nZXRzd2l0Y2goInNpZXZldXNlaG9tZWRpciIsIDAp
OworICAgIHNpZXZlX3VzZWhvbWVkaXIgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfU0lFVkVV
U0VIT01FRElSKTsKICAgICBpZiAoIXNpZXZlX3VzZWhvbWVkaXIpIHsKLQlzaWV2ZV9kaXIgPSBj
b25maWdfZ2V0c3RyaW5nKCJzaWV2ZWRpciIsICIvdXNyL3NpZXZlIik7CisJc2lldmVfZGlyID0g
Y29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NJRVZFRElSKTsKICAgICB9IGVsc2UgewogCXNpZXZl
X2RpciA9IE5VTEw7CiAgICAgfQpAQCAtMjYyLDggKzI2MSw4IEBACiAgICAgc2V0dXBfc2lldmUo
KTsKICNlbmRpZiAvKiBVU0VfU0lFVkUgKi8KIAotICAgIHNpbmdsZWluc3RhbmNlID0gY29uZmln
X2dldHN3aXRjaCgic2luZ2xlaW5zdGFuY2VzdG9yZSIsIDEpOwotICAgIEJCID0gY29uZmlnX2dl
dHN0cmluZygicG9zdHVzZXIiLCBCQik7CisgICAgc2luZ2xlaW5zdGFuY2UgPSBjb25maWdfZ2V0
c3dpdGNoKElNQVBPUFRfU0lOR0xFSU5TVEFOQ0VTVE9SRSk7CisgICAgQkIgPSBjb25maWdfZ2V0
c3RyaW5nKElNQVBPUFRfUE9TVFVTRVIpOwogCiAgICAgaWYgKChyID0gc2FzbF9zZXJ2ZXJfaW5p
dChteXNhc2xfY2IsICJDeXJ1cyIpKSAhPSBTQVNMX09LKSB7CiAJc3lzbG9nKExPR19FUlIsICJT
QVNMIGZhaWxlZCBpbml0aWFsaXppbmc6IHNhc2xfc2VydmVyX2luaXQoKTogJXMiLCAKQEAgLTI3
MSw3ICsyNzAsNyBAQAogCXJldHVybiBFQ19TT0ZUV0FSRTsKICAgICB9CiAKLSAgICBkdXBlbGlt
ID0gY29uZmlnX2dldHN3aXRjaCgiZHVwbGljYXRlc3VwcHJlc3Npb24iLCAxKTsKKyAgICBkdXBl
bGltID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0RVUExJQ0FURVNVUFBSRVNTSU9OKTsKICAg
ICAvKiBpbml0aWFsaXplIGR1cGxpY2F0ZSBkZWxpdmVyeSBkYXRhYmFzZSAqLwogICAgIGlmIChk
dXBsaWNhdGVfaW5pdChOVUxMLCAwKSAhPSAwKSB7CiAJc3lzbG9nKExPR19FUlIsIApAQCAtNDMz
LDcgKzQzMiw3IEBACiAJY2xvc2UoZmRzWzFdKTsKIAkvKiBtYWtlIHRoZSBwaXBlIGJlIHN0ZGlu
ICovCiAJZHVwMihmZHNbMF0sIDApOwotCWV4ZWN2KFNFTkRNQUlMLCAoY2hhciAqKikgYXJndik7
CisJZXhlY3YoY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NFTkRNQUlMKSwgKGNoYXIgKiopIGFy
Z3YpOwogCiAJLyogaWYgd2UncmUgaGVyZSB3ZSBzdWNrICovCiAJcHJpbnRmKCI0NTEgbG10cGQ6
IGRpZG4ndCBleGVjPyE/XHJcbiIpOwpAQCAtNTE4LDcgKzUxNyw3IEBACiAgICAgZnByaW50Zihz
bSwgIkRhdGU6ICVzXHJcbiIsIGRhdGVzdHIpOwogCiAgICAgZnByaW50ZihzbSwgIlgtU2lldmU6
ICVzXHJcbiIsIFNJRVZFX1ZFUlNJT04pOwotICAgIGZwcmludGYoc20sICJGcm9tOiBNYWlsIFNp
ZXZlIFN1YnN5c3RlbSA8JXM+XHJcbiIsIFBPU1RNQVNURVIpOworICAgIGZwcmludGYoc20sICJG
cm9tOiBNYWlsIFNpZXZlIFN1YnN5c3RlbSA8JXM+XHJcbiIsIGNvbmZpZ19nZXRzdHJpbmcoSU1B
UE9QVF9QT1NUTUFTVEVSKSk7CiAgICAgZnByaW50ZihzbSwgIlRvOiA8JXM+XHJcbiIsIHJlanRv
KTsKICAgICBmcHJpbnRmKHNtLCAiTUlNRS1WZXJzaW9uOiAxLjBcclxuIik7CiAgICAgZnByaW50
ZihzbSwgIkNvbnRlbnQtVHlwZTogIgpAQCAtNzkwLDcgKzc4OSw3IEBACiAJCQl2b2lkICptYyBf
X2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKIAkJCWNvbnN0IGNoYXIgKiplcnJtc2cgX19hdHRyaWJ1
dGVfXygodW51c2VkKSkpCiB7Ci0gICAgY29uc3QgY2hhciAqbm90aWZpZXIgPSBjb25maWdfZ2V0
c3RyaW5nKCJzaWV2ZW5vdGlmaWVyIiwgTlVMTCk7CisgICAgY29uc3QgY2hhciAqbm90aWZpZXIg
PSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU0lFVkVOT1RJRklFUik7CiAKICAgICBpZiAobm90
aWZpZXIpIHsKIAlzaWV2ZV9ub3RpZnlfY29udGV4dF90ICpuYyA9IChzaWV2ZV9ub3RpZnlfY29u
dGV4dF90ICopIGFjOwpAQCAtMTE1OSw3ICsxMTU4LDcgQEAKICAgICB9CiAKICAgICBpZiAoIXIg
JiYgdXNlcikgewotCWNvbnN0IGNoYXIgKm5vdGlmaWVyID0gY29uZmlnX2dldHN0cmluZygibWFp
bG5vdGlmaWVyIiwgTlVMTCk7CisJY29uc3QgY2hhciAqbm90aWZpZXIgPSBjb25maWdfZ2V0c3Ry
aW5nKElNQVBPUFRfTUFJTE5PVElGSUVSKTsKIAogCWlmIChub3RpZmllcikgewogCSAgICAvKiBk
byB3ZSB3YW50IHRvIHJlcGxhY2UgdXNlci5YWFggd2l0aCBJTkJPWD8gKi8KSW5kZXg6IGltYXAv
bG10cGVuZ2luZS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lz
dGVtL2N2cy9zcmMvY3lydXMvaW1hcC9sbXRwZW5naW5lLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuNzUKZGlmZiAtdSAtcjEuNzUgbG10cGVuZ2luZS5jCi0tLSBsbXRwZW5naW5lLmMJMjAwMi8w
Ni8wNiAwMDoxMjozNAkxLjc1CisrKyBsbXRwZW5naW5lLmMJMjAwMi8wNi8xOCAyMDo1NDoxMgpA
QCAtMTg0LDE0ICsxODQsMTQgQEAKICI1NTAteW91ciBtZXNzYWdlLCBvciAlcyBpZiB5b3UgYmVs
aWV2ZSB5b3VcclxuIgogIjU1MC1yZWNlaXZlZCB0aGlzIG1lc3NhZ2UgaW4gZXJyb3IuXHJcbiIK
ICI1NTAgNS43LjEgUGVybWlzc2lvbiBkZW5pZWRcclxuIiwgCi0JCQlQT1NUTUFTVEVSKTsKKwkJ
CWNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QT1NUTUFTVEVSKSk7CiAJfSBlbHNlIHsKIAkgICAg
cHJvdF9wcmludGYocG91dCwgIjU1MCA1LjcuMSBQZXJtaXNzaW9uIGRlbmllZFxyXG4iKTsKIAl9
CiAJYnJlYWs7CiAKICAgICBjYXNlIElNQVBfUVVPVEFfRVhDRUVERUQ6Ci0JaWYoY29uZmlnX2dl
dHN3aXRjaCgibG10cF9vdmVycXVvdGFfcGVybV9mYWlsdXJlIiwwKSkgeworCWlmKGNvbmZpZ19n
ZXRzd2l0Y2goSU1BUE9QVF9MTVRQX09WRVJfUVVPVEFfUEVSTV9GQUlMVVJFKSkgewogCSAgICAv
KiBOb3QgRGVmYXVsdCAtIFBlcm0gRmFpbHVyZSAqLwogCSAgICBwcm90X3ByaW50Zihwb3V0LCAi
NTUyIDUuMi4yIE92ZXIgcXVvdGFcclxuIik7CiAJfSBlbHNlIHsKQEAgLTcyNiw3ICs3MjYsNyBA
QAogICAgIGludCBvZmYgPSAwOwogICAgIHN0YXRlIHMgPSBOQU1FX1NUQVJUOwogICAgIGludCBy
ID0gMDsKLSAgICBpbnQgcmVqZWN0OGJpdCA9IGNvbmZpZ19nZXRzd2l0Y2goInJlamVjdDhiaXQi
LCAwKTsKKyAgICBpbnQgcmVqZWN0OGJpdCA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9SRUpF
Q1Q4QklUKTsKIAogICAgIGlmIChuYW1lbGVuID09IDApIHsKIAluYW1lbGVuICs9IE5BTUVJTkM7
CkBAIC0xMjMxLDggKzEyMzEsMTEgQEAKICAgICBjZC5zdGFydHRsc19kb25lID0gMDsKIAogICAg
IHNwcmludGYoc2h1dGRvd25maWxlbmFtZSwgIiVzL21zZy9zaHV0ZG93biIsIGNvbmZpZ19kaXIp
OwotICAgIG1heF9tc2dzaXplID0gY29uZmlnX2dldGludCgibWF4bWVzc2FnZXNpemUiLCBJTlRf
TUFYKTsKKyAgICBtYXhfbXNnc2l6ZSA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9NQVhNRVNTQUdF
U0laRSk7CiAKKyAgICAvKiBJZiBtYXhfbXNnc2l6ZSBpcyAwLCBhbGxvdyBhbnkgc2l6ZSAqLwor
ICAgIGlmKCFtYXhfbXNnc2l6ZSkgbWF4X21zZ3NpemUgPSBJTlRfTUFYOworCiAgICAgbXNnX25l
dygmbXNnKTsKIAogICAgIC8qIGRvbid0IGxlYWsgb2xkIGNvbm5lY3Rpb25zICovCkBAIC0xMzAy
LDEwICsxMzA1LDggQEAKICAgICAvKiBzZXQgbXkgYWxsb3dhYmxlIHNlY3VyaXR5IHByb3BlcnRp
ZXMgKi8KICAgICAvKiBBTk9OWU1PVVMgaXMgc2lsbHkgYmVjYXVzZSB3ZSBhbGxvdyB0aGF0IGFu
eXdheSAqLwogICAgIHNlY2ZsYWdzID0gU0FTTF9TRUNfTk9BTk9OWU1PVVM7Ci0gICAgcGxhaW50
ZXh0X3Jlc3VsdCA9IGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0IiwxKTsKLSAgICBp
ZiAoIWNvbmZpZ19nZXRzd2l0Y2goImxtdHBfYWxsb3dwbGFpbnRleHQiLCBwbGFpbnRleHRfcmVz
dWx0KSkgewotCXNlY2ZsYWdzIHw9IFNBU0xfU0VDX05PUExBSU5URVhUOwotICAgIH0KKyAgICBw
bGFpbnRleHRfcmVzdWx0ID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhU
KTsKKwogICAgIHNlY3Byb3BzID0gbXlzYXNsX3NlY3Byb3BzKHNlY2ZsYWdzKTsKICAgICBzYXNs
X3NldHByb3AoY2QuY29ubiwgU0FTTF9TRUNfUFJPUFMsIHNlY3Byb3BzKTsKIApAQCAtMTU3MSw3
ICsxNTcyLDcgQEAKIAkJICBwcm90X3ByaW50Zihwb3V0LCAiMjUwLVNJWkUgJWRcclxuIiwgbWF4
X21zZ3NpemUpOwogCSAgICAgIGVsc2UKIAkJICBwcm90X3ByaW50Zihwb3V0LCAiMjUwLVNJWkVc
clxuIik7Ci0JICAgICAgaWYgKHRsc19lbmFibGVkKCJsbXRwIikgJiYgIWZ1bmMtPnByZWF1dGgp
IHsKKwkgICAgICBpZiAodGxzX2VuYWJsZWQoKSAmJiAhZnVuYy0+cHJlYXV0aCkgewogCQkgIHBy
b3RfcHJpbnRmKHBvdXQsICIyNTAtU1RBUlRUTFNcclxuIik7CiAJICAgICAgfQogCSAgICAgIGlm
IChzYXNsX2xpc3RtZWNoKGNkLmNvbm4sIE5VTEwsICJBVVRIICIsICIgIiwgIiIsICZtZWNocywg
CkBAIC0xNTkwLDcgKzE1OTEsNyBAQAogICAgICAgY2FzZSAnbSc6CiAgICAgICBjYXNlICdNJzoK
IAkgICAgaWYgKCFhdXRoZW50aWNhdGVkKSB7Ci0JCWlmIChjb25maWdfZ2V0c3dpdGNoKCJzb2Z0
X25vYXV0aCIsIDEpKSB7CisJCWlmIChjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfU09GVF9OT0FV
VEgpKSB7CiAJCSAgICBwcm90X3ByaW50Zihwb3V0LCAiNDMwIEF1dGhlbnRpY2F0aW9uIHJlcXVp
cmVkXHJcbiIpOwogCQl9IGVsc2UgewogCQkgICAgcHJvdF9wcmludGYocG91dCwgIjUzMCBBdXRo
ZW50aWNhdGlvbiByZXF1aXJlZFxyXG4iKTsKQEAgLTE3ODUsNyArMTc4Niw3IEBACiAgICAgICBj
YXNlICdzJzoKICAgICAgIGNhc2UgJ1MnOgogI2lmZGVmIEhBVkVfU1NMCi0JICAgIGlmICghc3Ry
Y2FzZWNtcChidWYsICJzdGFydHRscyIpICYmIHRsc19lbmFibGVkKCJsbXRwIikgJiYKKwkgICAg
aWYgKCFzdHJjYXNlY21wKGJ1ZiwgInN0YXJ0dGxzIikgJiYgdGxzX2VuYWJsZWQoKSAmJgogCQkh
ZnVuYy0+cHJlYXV0aCkgeyAvKiBkb24ndCBuZWVkIFRMUyBmb3IgcHJlYXV0aCdkIGNvbm5lY3Qg
Ki8KIAkJaW50ICpsYXllcnA7CiAJCXNhc2xfc3NmX3Qgc3NmOwpAQCAtMjU2NCwxMCArMjU2NSw3
IEBACiAgICAgCiAgICAgc2VjZmxhZ3MgPSBTQVNMX1NFQ19OT0FOT05ZTU9VUzsKIAotICAgIHBs
YWludGV4dF9yZXN1bHQgPSBjb25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsIDEpOwot
ICAgIGlmICghY29uZmlnX2dldHN3aXRjaCgibG10cF9hbGxvd3BsYWludGV4dCIsIHBsYWludGV4
dF9yZXN1bHQpKSB7Ci0Jc2VjZmxhZ3MgfD0gU0FTTF9TRUNfTk9QTEFJTlRFWFQ7Ci0gICAgfQor
ICAgIHBsYWludGV4dF9yZXN1bHQgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dQTEFJ
TlRFWFQpOwogICAgIHNlY3Byb3BzID0gbXlzYXNsX3NlY3Byb3BzKHNlY2ZsYWdzKTsKICAgICBy
ZXQgPSBzYXNsX3NldHByb3AoKmNvbm4sIFNBU0xfU0VDX1BST1BTLCBzZWNwcm9wcyk7CiAgICAg
aWYocmV0ICE9IFNBU0xfT0spIHJldHVybiByZXQ7CkluZGV4OiBpbWFwL2xtdHBlbmdpbmUuaAo9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5
cnVzL2ltYXAvbG10cGVuZ2luZS5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjEzCmRpZmYgLXUg
LXIxLjEzIGxtdHBlbmdpbmUuaAotLS0gbG10cGVuZ2luZS5oCTIwMDIvMDQvMTEgMTg6MzY6NTYJ
MS4xMworKysgbG10cGVuZ2luZS5oCTIwMDIvMDYvMTggMjA6NDU6MjEKQEAgLTQzLDEzICs0Myw2
IEBACiAjaWZuZGVmIExNVFBFTkdJTkVfSAogI2RlZmluZSBMTVRQRU5HSU5FX0gKIAotLyogY29u
ZmlndXJhdGlvbiBwYXJhbWV0ZXJzICovCi0jZGVmaW5lIERFRkFVTFRfU0VORE1BSUwgKCIvdXNy
L2xpYi9zZW5kbWFpbCIpCi0jZGVmaW5lIERFRkFVTFRfUE9TVE1BU1RFUiAoInBvc3RtYXN0ZXIi
KQotCi0jZGVmaW5lIFNFTkRNQUlMIChjb25maWdfZ2V0c3RyaW5nKCJzZW5kbWFpbCIsIERFRkFV
TFRfU0VORE1BSUwpKQotI2RlZmluZSBQT1NUTUFTVEVSIChjb25maWdfZ2V0c3RyaW5nKCJwb3N0
bWFzdGVyIiwgREVGQVVMVF9QT1NUTUFTVEVSKSkKLQogLyoqKioqKioqKioqKioqKioqIHNlcnZl
ci1zaWRlIExNVFAgKioqKioqKioqKioqKioqKioqKi8KIAogI2RlZmluZSBIRUFERVJDQUNIRVNJ
WkUgNDAwOQpJbmRleDogaW1hcC9sbXRwcHJveHlkLmMKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fm
cy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL2xtdHBwcm94eWQuYyx2
CnJldHJpZXZpbmcgcmV2aXNpb24gMS40MgpkaWZmIC11IC1yMS40MiBsbXRwcHJveHlkLmMKLS0t
IGxtdHBwcm94eWQuYwkyMDAyLzA2LzAzIDE4OjIyOjI2CTEuNDIKKysrIGxtdHBwcm94eWQuYwky
MDAyLzA2LzE5IDAwOjA5OjMwCkBAIC0xNTIsNyArMTUyLDYgQEAKIHN0YXRpYyBpbnQgcXVvdGFv
dmVycmlkZSA9IDA7CQkvKiBzaG91bGQgaSBvdmVycmlkZSBxdW90YT8gKi8KIGNvbnN0IGNoYXIg
KkJCID0gIiI7CiBzdGF0aWMgbXVwZGF0ZV9oYW5kbGUgKm1oYW5kbGUgPSBOVUxMOwotc3RhdGlj
IGNvbnN0IGNoYXIgKm11cGRhdGVfc2VydmVyID0gTlVMTDsKIGludCBkZWxpdmVyX2xvZ2ZkID0g
LTE7IC8qIHVzZWQgaW4gbG10cGVuZ2luZS5jICovCiAKIC8qIGN1cnJlbnQgbmFtZXNwYWNlICov
CkBAIC0xNzUsNyArMTc0LDcgQEAKICAgICAvKiBjaGVjayBpZiByZW1vdGUgcmVhbG0gKi8KICAg
ICBpZiAoKHJlYWxtID0gc3RyY2hyKGF1dGhfaWRlbnRpdHksICdAJykpIT1OVUxMKSB7CiAJcmVh
bG0rKzsKLQl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJlYWxtcyIsICIiKTsKKwl2YWwg
PSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMpOwogCXdoaWxlICgqdmFsKSB7
CiAJICAgIGlmICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3RybGVuKHJlYWxtKSkgJiYKIAkJ
KCF2YWxbc3RybGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2YWxbc3RybGVuKHJlYWxtKV0p
KSkgewpAQCAtMTk2LDcgKzE5NSw3IEBACiAgICAgICogZm9yIG5vdyBvbmx5IGFkbWlucyBjYW4g
ZG8gbG10cCBmcm9tIGFub3RoZXIgbWFjaGluZQogICAgICAqLwogICAgIGF1dGhzdGF0ZSA9IGF1
dGhfbmV3c3RhdGUoYXV0aF9pZGVudGl0eSwgTlVMTCk7Ci0gICAgYWxsb3dlZCA9IGF1dGhpc2Eo
YXV0aHN0YXRlLCAibG10cCIsICJhZG1pbnMiKTsKKyAgICBhbGxvd2VkID0gY29uZmlnX2F1dGhp
c2EoYXV0aHN0YXRlLCBJTUFQT1BUX0FETUlOUyk7CiAgICAgYXV0aF9mcmVlc3RhdGUoYXV0aHN0
YXRlKTsKICAgICAKICAgICBpZiAoIWFsbG93ZWQpIHsKQEAgLTIxOCwxNCArMjE3LDEzIEBACiB7
CiAgICAgaW50IHI7CiAKLSAgICBjb25maWdfY2hhbmdlaWRlbnQoImxtdHBwcm94eWQiKTsKICAg
ICBpZiAoZ2V0ZXVpZCgpID09IDApIHJldHVybiAxOwogICAgIAogICAgIHNpZ25hbHNfc2V0X3No
dXRkb3duKCZzaHV0X2Rvd24pOwogICAgIHNpZ25hbHNfYWRkX2hhbmRsZXJzKCk7CiAgICAgc2ln
bmFsKFNJR1BJUEUsIFNJR19JR04pOwogCi0gICAgQkIgPSBjb25maWdfZ2V0c3RyaW5nKCJwb3N0
dXNlciIsIEJCKTsKKyAgICBCQiA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QT1NUVVNFUik7
CiAKICAgICBpZiAoKHIgPSBzYXNsX3NlcnZlcl9pbml0KG15c2FzbF9jYiwgIkN5cnVzIikpICE9
IFNBU0xfT0spIHsKIAlzeXNsb2coTE9HX0VSUiwgIlNBU0wgZmFpbGVkIGluaXRpYWxpemluZzog
c2FzbF9zZXJ2ZXJfaW5pdCgpOiAlcyIsIApAQCAtMjQ2LDggKzI0NCw3IEBACiAJZmF0YWwoZXJy
b3JfbWVzc2FnZShyKSwgRUNfQ09ORklHKTsKICAgICB9CiAKLSAgICBtdXBkYXRlX3NlcnZlciA9
IGNvbmZpZ19nZXRzdHJpbmcoIm11cGRhdGVfc2VydmVyIiwgTlVMTCk7Ci0gICAgaWYgKCFtdXBk
YXRlX3NlcnZlcikgeworICAgIGlmICghY29uZmlnX211cGRhdGVfc2VydmVyKSB7CiAJc3lzbG9n
KExPR19FUlIsICJubyBtdXBkYXRlX3NlcnZlciBkZWZpbmVkIik7CiAJcmV0dXJuIEVDX0NPTkZJ
RzsKICAgICB9CkBAIC0zMDYsMTMgKzMwMywxMyBAQAogICAgIH0KICAgICAvKiBjb25uZWN0IHRv
IHRoZSBtdXBkYXRlIHNlcnZlciAqLwogICAgIGlmICghbWhhbmRsZSkgewotCXIgPSBtdXBkYXRl
X2Nvbm5lY3QobXVwZGF0ZV9zZXJ2ZXIsIE5VTEwsICZtaGFuZGxlLCBOVUxMKTsKKwlyID0gbXVw
ZGF0ZV9jb25uZWN0KGNvbmZpZ19tdXBkYXRlX3NlcnZlciwgTlVMTCwgJm1oYW5kbGUsIE5VTEwp
OwogICAgIH0JCiAgICAgaWYgKCFyKSB7CiAJbG10cG1vZGUoJm15bG10cCwgZGVsaXZlcl9pbiwg
ZGVsaXZlcl9vdXQsIDApOwogICAgIH0gZWxzZSB7CiAJbWhhbmRsZSA9IE5VTEw7Ci0Jc3lzbG9n
KExPR19FUlIsICJjb3VsZG4ndCBjb25uZWN0IHRvICVzOiAlcyIsIG11cGRhdGVfc2VydmVyLAor
CXN5c2xvZyhMT0dfRVJSLCAiY291bGRuJ3QgY29ubmVjdCB0byAlczogJXMiLCBjb25maWdfbXVw
ZGF0ZV9zZXJ2ZXIsCiAJICAgICAgIGVycm9yX21lc3NhZ2UocikpOwogCXByb3RfcHJpbnRmKGRl
bGl2ZXJfb3V0LCAiNDUxICVzIExNVFAgQ3lydXMgJXMgJXNcclxuIiwKIAkJICAgIGNvbmZpZ19z
ZXJ2ZXJuYW1lLCBDWVJVU19WRVJTSU9OLCBlcnJvcl9tZXNzYWdlKHIpKTsKQEAgLTM4MSwxMSAr
Mzc4LDE0IEBACiAJY3AgPSBzdHJjaHIob3B0c3RyLCAnLicpOwogCWlmIChjcCkgKmNwID0gJ1ww
JzsKIAlzdHJjYXQob3B0c3RyLCAiX3Bhc3N3b3JkIik7Ci0JcGFzcyA9IGNvbmZpZ19nZXRzdHJp
bmcob3B0c3RyLCBOVUxMKTsKKwlwYXNzID0gY29uZmlnX2dldG92ZXJmbG93c3RyaW5nKG9wdHN0
ciwgTlVMTCk7CisJaWYoIXBhc3MpIHBhc3MgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfUFJP
WFlfUEFTU1dPUkQpOwogCi0JY2IgPSBteXNhc2xfY2FsbGJhY2tzKGNvbmZpZ19nZXRzdHJpbmco
ImxtdHBwcm94eV91c2VybmFtZSIsICIiKSwKLQkJCSAgICAgIGNvbmZpZ19nZXRzdHJpbmcoImxt
dHBwcm94eV9hdXRobmFtZSIsICJwcm94eSIpLAotCQkJICAgICAgY29uZmlnX2dldHN0cmluZygi
bG10cHByb3h5X3JlYWxtIiwgTlVMTCksCisJLyogQXV0aG9yaXphdGlvbiBkb2VzIG5vdCBtYXR0
ZXIgZm9yIExNVFAsIHNvIHdlJ2xsIGp1c3QgcGFzcworCSAqIHRoZSBlbXB0eSBzdHJpbmcuICov
CisJY2IgPSBteXNhc2xfY2FsbGJhY2tzKCIiLAorCQkJICAgICAgY29uZmlnX2dldHN0cmluZyhJ
TUFQT1BUX1BST1hZX0FVVEhOQU1FKSwKKwkJCSAgICAgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9Q
VF9QUk9YWV9SRUFMTSksCiAJCQkgICAgICBwYXNzKTsKIAkKIAlyID0gbG10cF9jb25uZWN0KHAt
Pmhvc3QsIGNiLCAmcC0+Y29ubik7CkluZGV4OiBpbWFwL21iZHVtcC5jCj09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9tYmR1
bXAuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xOApkaWZmIC11IC1yMS4xOCBtYmR1bXAuYwot
LS0gbWJkdW1wLmMJMjAwMi8wNS8yNCAxODowNToxNQkxLjE4CisrKyBtYmR1bXAuYwkyMDAyLzA2
LzE4IDIwOjM4OjI2CkBAIC0zMjYsNyArMzI2LDcgQEAKIAogICAgIGlmKHVzZXJpZCkgewogCWNo
YXIgc2lldmVfcGF0aFtNQVhfTUFJTEJPWF9QQVRIXTsKLQlpbnQgc2lldmVfdXNlaG9tZWRpciA9
IGNvbmZpZ19nZXRzd2l0Y2goInNpZXZldXNlaG9tZWRpciIsIDApOworCWludCBzaWV2ZV91c2Vo
b21lZGlyID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX1NJRVZFVVNFSE9NRURJUik7CiAKIAkv
KiBuZWVkIHRvIHRyYW5zZmVyIHNlZW4sIHN1YnMsIGFuZCBzaWV2ZSBmaWxlcyAqLwogCWZvcihp
PTA7aTwzO2krKykgewpAQCAtMzc5LDcgKzM3OSw3IEBACiAJICAgIG1iZGlyID0gTlVMTDsKIAog
CSAgICBzbnByaW50ZihzaWV2ZV9wYXRoLCBzaXplb2Yoc2lldmVfcGF0aCksICIlcy8lYy8lcyIs
Ci0JCSAgICAgY29uZmlnX2dldHN0cmluZygic2lldmVkaXIiLCAiL3Vzci9zaWV2ZSIpLAorCQkg
ICAgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9TSUVWRURJUiksCiAJCSAgICAgdXNlcmlkWzBd
LCB1c2VyaWQpOwogCSAgICBtYmRpcj1vcGVuZGlyKHNpZXZlX3BhdGgpOwogCSAgICAKQEAgLTQ2
NCw3ICs0NjQsNyBAQAogICAgIGNvbnN0IGNoYXIgKnVzZXJpZCA9IE5VTEw7CiAgICAgc3RydWN0
IG1haWxib3ggbWI7CiAgICAgY2hhciBzaWV2ZV9wYXRoWzIwNDhdOwotICAgIGludCBzaWV2ZV91
c2Vob21lZGlyID0gY29uZmlnX2dldHN3aXRjaCgic2lldmV1c2Vob21lZGlyIiwgMCk7CisgICAg
aW50IHNpZXZlX3VzZWhvbWVkaXIgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfU0lFVkVVU0VI
T01FRElSKTsKICAgICAKICAgICBtZW1zZXQoJmZpbGUsIDAsIHNpemVvZihzdHJ1Y3QgYnVmKSk7
CiAgICAgbWVtc2V0KCZkYXRhLCAwLCBzaXplb2Yoc3RydWN0IGJ1ZikpOwpAQCAtNDc2LDcgKzQ3
Niw3IEBACiAKIAlpZighc2lldmVfdXNlaG9tZWRpcikKIAkgICAgc25wcmludGYoc2lldmVfcGF0
aCwgc2l6ZW9mKHNpZXZlX3BhdGgpLCAiJXMvJWMvJXMiLAotCQkgICAgIGNvbmZpZ19nZXRzdHJp
bmcoInNpZXZlZGlyIiwgIi91c3Ivc2lldmUiKSwKKwkJICAgICBjb25maWdfZ2V0c3RyaW5nKElN
QVBPUFRfU0lFVkVESVIpLAogCQkgICAgIHVzZXJpZFswXSwgdXNlcmlkKTsKICAgICB9CiAKSW5k
ZXg6IGltYXAvbWJveGxpc3QuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUu
ZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvbWJveGxpc3QuYyx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMS4xOTYKZGlmZiAtdSAtcjEuMTk2IG1ib3hsaXN0LmMKLS0tIG1ib3hsaXN0LmMJMjAw
Mi8wNi8wMyAxOTozOToyOQkxLjE5NgorKysgbWJveGxpc3QuYwkyMDAyLzA2LzE4IDIwOjIxOjIz
CkBAIC0xMDgsMjUgKzEwOCwxNCBAQAogc3RhdGljIGludCBtYm94bGlzdF9nZXRwYXRoKGNvbnN0
IGNoYXIgKnBhcnRpdGlvbiwgY29uc3QgY2hhciAqbmFtZSwgCiAJCQkgICAgY2hhciAqKnBhdGhw
KQogewotICAgIHNpemVfdCBwYXJ0aXRpb25sZW47Ci0gICAgY2hhciBvcHRpb25idWZbTUFYX01B
SUxCT1hfTkFNRSsxXTsKICAgICBzdGF0aWMgY2hhciBwYXRocmVzdWx0W01BWF9NQUlMQk9YX1BB
VEhdOwogICAgIGNvbnN0IGNoYXIgKnJvb3Q7CiAKICAgICBhc3NlcnQocGFydGl0aW9uICYmIHBh
dGhwKTsKIAotICAgIHBhcnRpdGlvbmxlbiA9IHN0cmxlbihwYXJ0aXRpb24pOworICAgIHJvb3Qg
PSBjb25maWdfcGFydGl0aW9uZGlyKHBhcnRpdGlvbik7CisgICAgaWYgKCFyb290KSByZXR1cm4g
SU1BUF9QQVJUSVRJT05fVU5LTk9XTjsKIAotICAgIGlmIChwYXJ0aXRpb25sZW4gPiBzaXplb2Yo
b3B0aW9uYnVmKS0xMSkgewotCXJldHVybiBJTUFQX1BBUlRJVElPTl9VTktOT1dOOwotICAgIH0K
LSAgICBzdHJjcHkob3B0aW9uYnVmLCAicGFydGl0aW9uLSIpOwotICAgIHN0cmNhdChvcHRpb25i
dWYsIHBhcnRpdGlvbik7Ci0gICAgCi0gICAgcm9vdCA9IGNvbmZpZ19nZXRzdHJpbmcob3B0aW9u
YnVmLCAoY2hhciAqKTApOwotICAgIGlmICghcm9vdCkgewotCXJldHVybiBJTUFQX1BBUlRJVElP
Tl9VTktOT1dOOwotICAgIH0KICAgICBtYWlsYm94X2hhc2hfbWJveChwYXRocmVzdWx0LCByb290
LCBuYW1lKTsKIAogICAgICpwYXRocCA9IHBhdGhyZXN1bHQ7CkBAIC0xNDQsNyArMTMzLDcgQEAK
IAogc3RhdGljIGNvbnN0IGludCBnZXRfZGVsZXRlcmlnaHQodm9pZCkKIHsKLSAgICBjb25zdCBj
aGFyICpyID0gY29uZmlnX2dldHN0cmluZygiZGVsZXRlcmlnaHQiLCAiYyIpOworICAgIGNvbnN0
IGNoYXIgKnIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfREVMRVRFUklHSFQpOwogCiAgICAg
cmV0dXJuIGN5cnVzX2FjbF9zdHJ0b21hc2socik7CiB9CkBAIC0yNzQsNyArMjYzLDYgQEAKIAog
aW50IG1ib3hsaXN0X2ZpbmRzdGFnZShjb25zdCBjaGFyICpuYW1lLCBjaGFyICpzdGFnZWRpcikg
CiB7Ci0gICAgY2hhciBvcHRpb25idWZbTUFYX01BSUxCT1hfTkFNRSsxXTsKICAgICBjb25zdCBj
aGFyICpyb290OwogICAgIGNoYXIgKnBhcnRpdGlvbjsKICAgICBpbnQgcjsKQEAgLTI4OSwxNSAr
Mjc3LDEwIEBACiAgICAgZGVmYXVsdDoKIAlyZXR1cm4gcjsKIAlicmVhazsKLSAgICB9Ci0JCi0g
ICAgc3RyY3B5KG9wdGlvbmJ1ZiwgInBhcnRpdGlvbi0iKTsKLSAgICBzdHJjcHkob3B0aW9uYnVm
ICsgMTAsIHBhcnRpdGlvbik7Ci0gICAgCi0gICAgcm9vdCA9IGNvbmZpZ19nZXRzdHJpbmcob3B0
aW9uYnVmLCAoY2hhciAqKTApOwotICAgIGlmICghcm9vdCkgewotCXJldHVybiBJTUFQX1BBUlRJ
VElPTl9VTktOT1dOOwogICAgIH0KKwkgICAgCisgICAgcm9vdCA9IGNvbmZpZ19wYXJ0aXRpb25k
aXIocGFydGl0aW9uKTsKKyAgICBpZiAoIXJvb3QpIHJldHVybiBJTUFQX1BBUlRJVElPTl9VTktO
T1dOOwogCQogICAgIHNwcmludGYoc3RhZ2VkaXIsICIlcy9zdGFnZS4vIiwgcm9vdCk7CiAgICAg
CkBAIC00NTUsNyArNDM4LDcgQEAKIAkgICAgICogTm9ib2R5IGVsc2Ugc3RhcnRzIHdpdGggYW55
IGFjY2VzcyB0byBzYW1lLgogCSAgICAgKi8KIAkgICAgaWRlbnRpZmllciA9IHhzdHJkdXAobmFt
ZSs1KTsKLQkgICAgaWYgKGNvbmZpZ19nZXRzd2l0Y2goInVuaXhoaWVyYXJjaHlzZXAiLCAwKSkg
eworCSAgICBpZiAoY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX1VOSVhISUVSQVJDSFlTRVApKSB7
CiAJCS8qCiAJCSAqIFRoZSBtYWlsYm94bmFtZSBpcyBub3cgaW4gdGhlIGludGVybmFsIGZvcm1h
dCwKIAkJICogc28gd2Ugd2UgbmVlZCB0byBjaGFuZ2UgRE9UQ0hBUnMgYmFjayB0byAnLicKQEAg
LTQ3MCw3ICs0NTMsNyBAQAogCSAgICBmcmVlKGlkZW50aWZpZXIpOwogCX0gZWxzZSB7CiAJICAg
IGRlZmF1bHRhY2wgPSBpZGVudGlmaWVyID0gCi0JCXhzdHJkdXAoY29uZmlnX2dldHN0cmluZygi
ZGVmYXVsdGFjbCIsICJhbnlvbmUgbHJzIikpOworCQl4c3RyZHVwKGNvbmZpZ19nZXRzdHJpbmco
SU1BUE9QVF9ERUZBVUxUQUNMKSk7CiAJICAgIGZvciAoOzspIHsKIAkJd2hpbGUgKCppZGVudGlm
aWVyICYmIGlzc3BhY2UoKGludCkgKmlkZW50aWZpZXIpKSBpZGVudGlmaWVyKys7CiAJCXJpZ2h0
cyA9IGlkZW50aWZpZXI7CkBAIC01NzUsOCArNTU4LDcgQEAKIAogICAgIGlmICghKG1idHlwZSAm
IE1CVFlQRV9SRU1PVEUpKSB7CiAJLyogR2V0IHBhcnRpdGlvbidzIHBhdGggKi8KLQlzcHJpbnRm
KGJ1ZiwgInBhcnRpdGlvbi0lcyIsIG5ld3BhcnRpdGlvbik7Ci0Jcm9vdCA9IGNvbmZpZ19nZXRz
dHJpbmcoYnVmLCAoY2hhciAqKTApOworCXJvb3QgPSBjb25maWdfcGFydGl0aW9uZGlyKG5ld3Bh
cnRpdGlvbik7CiAJaWYgKCFyb290KSB7CiAJICAgIHIgPSBJTUFQX1BBUlRJVElPTl9VTktOT1dO
OwogCSAgICBnb3RvIGRvbmU7CkluZGV4OiBpbWFwL21ib3huYW1lLmMKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL21ib3hu
YW1lLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjUKZGlmZiAtdSAtcjEuMjUgbWJveG5hbWUu
YwotLS0gbWJveG5hbWUuYwkyMDAyLzAxLzI0IDE2OjM5OjI4CTEuMjUKKysrIG1ib3huYW1lLmMJ
MjAwMi8wNi8xOCAyMDoyODozMQpAQCAtMjM2LDcgKzIzNiw4IEBACiAKIC8qIEhhbmRsZSBjb252
ZXJzaW9uIGZyb20gdGhlIGludGVybmFsIG5hbWVzcGFjZSB0byB0aGUgc3RhbmRhcmQgbmFtZXNw
YWNlICovCiBzdGF0aWMgaW50IG1ib3huYW1lX3RvZXh0ZXJuYWwoc3RydWN0IG5hbWVzcGFjZSAq
bmFtZXNwYWNlLCBjb25zdCBjaGFyICpuYW1lLAotCQkJICAgICAgIGNvbnN0IGNoYXIgKnVzZXJp
ZCwgY2hhciAqcmVzdWx0KQorCQkJICAgICAgIGNvbnN0IGNoYXIgKnVzZXJpZCBfX2F0dHJpYnV0
ZV9fKCh1bnVzZWQpKSwKKwkJCSAgICAgICBjaGFyICpyZXN1bHQpCiB7CiAgICAgc3RyY3B5KHJl
c3VsdCwgbmFtZSk7CiAKQEAgLTMwNywxNCArMzA4LDE1IEBACiAKICAgICBhc3NlcnQobmFtZXNw
YWNlICE9IE5VTEwpOwogCi0gICAgbmFtZXNwYWNlLT5oaWVyX3NlcCA9IGNvbmZpZ19nZXRzd2l0
Y2goInVuaXhoaWVyYXJjaHlzZXAiLCAwKSA/ICcvJyA6ICcuJzsKLSAgICBuYW1lc3BhY2UtPmlz
YWx0ID0gIWZvcmNlX3N0ZCAmJiBjb25maWdfZ2V0c3dpdGNoKCJhbHRuYW1lc3BhY2UiLCAwKTsK
KyAgICBuYW1lc3BhY2UtPmhpZXJfc2VwID0KKwljb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfVU5J
WEhJRVJBUkNIWVNFUCkgPyAnLycgOiAnLic7CisgICAgbmFtZXNwYWNlLT5pc2FsdCA9ICFmb3Jj
ZV9zdGQgJiYgY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMVE5BTUVTUEFDRSk7CiAKICAgICBp
ZiAobmFtZXNwYWNlLT5pc2FsdCkgewogCS8qIGFsdGVybmF0ZSBuYW1lc3BhY2UgKi8KIAlzdHJj
cHkobmFtZXNwYWNlLT5wcmVmaXhbTkFNRVNQQUNFX0lOQk9YXSwgIiIpOwogCi0JcHJlZml4ID0g
Y29uZmlnX2dldHN0cmluZygidXNlcnByZWZpeCIsICJPdGhlciBVc2VycyIpOworCXByZWZpeCA9
IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9VU0VSUFJFRklYKTsKIAlpZiAoIXByZWZpeCB8fCBz
dHJsZW4ocHJlZml4KSA9PSAwIHx8CiAJICAgIHN0cmxlbihwcmVmaXgpID49IE1BWF9OQU1FU1BB
Q0VfUFJFRklYIHx8CiAJICAgIHN0cmNocihwcmVmaXgsbmFtZXNwYWNlLT5oaWVyX3NlcCkgIT0g
TlVMTCkKQEAgLTMyMiw3ICszMjQsNyBAQAogCXNwcmludGYobmFtZXNwYWNlLT5wcmVmaXhbTkFN
RVNQQUNFX1VTRVJdLCAiJS4qcyVjIiwKIAkJTUFYX05BTUVTUEFDRV9QUkVGSVgtMSwgcHJlZml4
LCBuYW1lc3BhY2UtPmhpZXJfc2VwKTsKIAotCXByZWZpeCA9IGNvbmZpZ19nZXRzdHJpbmcoInNo
YXJlZHByZWZpeCIsICJTaGFyZWQgRm9sZGVycyIpOworCXByZWZpeCA9IGNvbmZpZ19nZXRzdHJp
bmcoSU1BUE9QVF9TSEFSRURQUkVGSVgpOwogCWlmICghcHJlZml4IHx8IHN0cmxlbihwcmVmaXgp
ID09IDAgfHwKIAkgICAgc3RybGVuKHByZWZpeCkgPj0gTUFYX05BTUVTUEFDRV9QUkVGSVggfHwK
IAkgICAgc3RyY2hyKHByZWZpeCwgbmFtZXNwYWNlLT5oaWVyX3NlcCkgIT0gTlVMTCB8fApAQCAt
NDY1LDcgKzQ2Nyw3IEBACiAgICAgaW50IHVjczQ7CiAgICAgaW50IHVuaXhzZXA7CiAKLSAgICB1
bml4c2VwID0gY29uZmlnX2dldHN3aXRjaCgidW5peGhpZXJhcmNoeXNlcCIsIDApOworICAgIHVu
aXhzZXAgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfVU5JWEhJRVJBUkNIWVNFUCk7CiAKICAg
ICBpZiAoc3RybGVuKG5hbWUpID4gTUFYX01BSUxCT1hfTkFNRSkgcmV0dXJuIElNQVBfTUFJTEJP
WF9CQUROQU1FOwogICAgIGZvciAoaSA9IDA7IGkgPCBOVU1fQkFETUJPWFBBVFRFUk5TOyBpKysp
IHsKSW5kZXg6IGltYXAvbWVzc2FnZS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3
LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9tZXNzYWdlLmMsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuODgKZGlmZiAtdSAtcjEuODggbWVzc2FnZS5jCi0tLSBtZXNzYWdlLmMJMjAw
MC8xMi8yNiAyMTozNTo0MQkxLjg4CisrKyBtZXNzYWdlLmMJMjAwMi8wNi8xOCAyMDoyOTowMQpA
QCAtMjI4LDcgKzIyOCw3IEBACiAgICAgaW50IHIgPSAwOwogICAgIGludCBuOwogICAgIGludCBz
YXdjciA9IDAsIHNhd25sOwotICAgIGludCByZWplY3Q4Yml0ID0gY29uZmlnX2dldHN3aXRjaCgi
cmVqZWN0OGJpdCIsIDApOworICAgIGludCByZWplY3Q4Yml0ID0gY29uZmlnX2dldHN3aXRjaChJ
TUFQT1BUX1JFSkVDVDhCSVQpOwogICAgIGludCBpbmhlYWRlciA9IDEsIGJsYW5rbGluZSA9IDE7
CiAKICAgICB3aGlsZSAoc2l6ZSkgewpJbmRleDogaW1hcC9tdXBkYXRlLWNsaWVudC5jCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMv
aW1hcC9tdXBkYXRlLWNsaWVudC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjMyCmRpZmYgLXUg
LXIxLjMyIG11cGRhdGUtY2xpZW50LmMKLS0tIG11cGRhdGUtY2xpZW50LmMJMjAwMi8wNC8wNSAx
OTo1MjoyNwkxLjMyCisrKyBtdXBkYXRlLWNsaWVudC5jCTIwMDIvMDYvMTggMjA6MjY6MzUKQEAg
LTgyLDE0ICs4MiwxNCBAQAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICBjb25zdCBjaGFyICpwYXNzd29yZCk7CiBleHRlcm4gdm9pZCBmcmVlX2NhbGxiYWNrcyhzYXNs
X2NhbGxiYWNrX3QgKmluKTsKIAotc3RhdGljIHNhc2xfc2VjdXJpdHlfcHJvcGVydGllc190ICpt
YWtlX3NlY3Byb3BzKGludCBtaW4sIGludCBtYXgpCitzdGF0aWMgc2FzbF9zZWN1cml0eV9wcm9w
ZXJ0aWVzX3QgKm1ha2Vfc2VjcHJvcHModm9pZCkKIHsKICAgc2FzbF9zZWN1cml0eV9wcm9wZXJ0
aWVzX3QgKnJldCA9CiAgICAgICAoc2FzbF9zZWN1cml0eV9wcm9wZXJ0aWVzX3QgKikgeHptYWxs
b2Moc2l6ZW9mKHNhc2xfc2VjdXJpdHlfcHJvcGVydGllc190KSk7CiAKICAgcmV0LT5tYXhidWZz
aXplID0gUFJPVF9CVUZTSVpFOwotICByZXQtPm1pbl9zc2YgPSBjb25maWdfZ2V0aW50KCJzYXNs
X21pbmltdW1fbGF5ZXIiLCBtaW4pOwkKLSAgcmV0LT5tYXhfc3NmID0gY29uZmlnX2dldGludCgi
c2FzbF9tYXhpbXVtX2xheWVyIiwgbWF4KTsKKyAgcmV0LT5taW5fc3NmID0gY29uZmlnX2dldGlu
dChJTUFQT1BUX1NBU0xfTUlOSU1VTV9MQVlFUik7CQorICByZXQtPm1heF9zc2YgPSBjb25maWdf
Z2V0aW50KElNQVBPUFRfU0FTTF9NQVhJTVVNX0xBWUVSKTsKIAogICByZXR1cm4gcmV0OwogfQpA
QCAtMTE0LDcgKzExNCw3IEBACiAJcmV0dXJuIDE7CiAgICAgfQogCi0gICAgc2VjcHJvcHMgPSBt
YWtlX3NlY3Byb3BzKDAsIDI1Nik7CisgICAgc2VjcHJvcHMgPSBtYWtlX3NlY3Byb3BzKCk7CiAg
ICAgaWYoIXNlY3Byb3BzKSByZXR1cm4gMTsKICAgICAKICAgICBzYXNscmVzdWx0PXNhc2xfc2V0
cHJvcChoLT5zYXNsY29ubiwgU0FTTF9TRUNfUFJPUFMsIHNlY3Byb3BzKTsKQEAgLTI1MywxNCAr
MjUzLDExIEBACiAKICAgICAvKiBvcGVuIGNvbm5lY3Rpb24gdG8gJ3NlcnZlcicgKi8KICAgICBp
Zighc2VydmVyKSB7Ci0Jc2VydmVyID0gY29uZmlnX2dldHN0cmluZygibXVwZGF0ZV9zZXJ2ZXIi
LCBOVUxMKTsKKwlzZXJ2ZXIgPSBjb25maWdfbXVwZGF0ZV9zZXJ2ZXI7CiAJaWYgKHNlcnZlciA9
PSBOVUxMKSB7CiAJICAgIGZhdGFsKCJjb3VsZG4ndCBnZXQgbXVwZGF0ZSBzZXJ2ZXIgbmFtZSIs
IEVDX1VOQVZBSUxBQkxFKTsKIAl9CiAgICAgfQotICAgIGlmKCFwb3J0KSB7Ci0JcG9ydCA9IGNv
bmZpZ19nZXRzdHJpbmcoIm11cGRhdGVfcG9ydCIsTlVMTCk7Ci0gICAgfQogICAgIAogICAgIGhw
ID0gZ2V0aG9zdGJ5bmFtZShzZXJ2ZXIpOwogICAgIGlmICghaHApIHsKQEAgLTI4OSw3ICsyODYs
NyBAQAogICAgIH0gZWxzZSBpZigoc3AgPSBnZXRzZXJ2YnluYW1lKCJtdXBkYXRlIiwgInRjcCIp
KSAhPSBOVUxMKSB7CiAJYWRkci5zaW5fcG9ydCA9IHNwLT5zX3BvcnQ7CiAgICAgfSBlbHNlIHsK
LQlhZGRyLnNpbl9wb3J0ID0gaHRvbnMoMjAwNCk7CisJYWRkci5zaW5fcG9ydCA9IGNvbmZpZ19n
ZXRpbnQoSU1BUE9QVF9NVVBEQVRFX1BPUlQpOwogICAgIH0KIAogICAgIGlmIChjb25uZWN0KHMs
IChzdHJ1Y3Qgc29ja2FkZHIgKikmYWRkciwgc2l6ZW9mKGFkZHIpKSA9PSAtMSkgewpAQCAtMzAz
LDEwICszMDAsMTAgQEAKIAogICAgIGlmKCFjYnMpIHsKIAlsb2NhbF9jYnMgPSAxOwotCWNicyA9
IG15c2FzbF9jYWxsYmFja3MoY29uZmlnX2dldHN0cmluZygibXVwZGF0ZV91c2VybmFtZSIsIiIp
LAotCQkJICAgICAgIGNvbmZpZ19nZXRzdHJpbmcoIm11cGRhdGVfYXV0aG5hbWUiLE5VTEwpLAot
CQkJICAgICAgIGNvbmZpZ19nZXRzdHJpbmcoIm11cGRhdGVfcmVhbG0iLE5VTEwpLAotCQkJICAg
ICAgIGNvbmZpZ19nZXRzdHJpbmcoIm11cGRhdGVfcGFzc3dvcmQiLE5VTEwpKTsKKwljYnMgPSBt
eXNhc2xfY2FsbGJhY2tzKGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9NVVBEQVRFX1VTRVJOQU1F
KSwKKwkJCSAgICAgICBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTVVQREFURV9BVVRITkFNRSks
CisJCQkgICAgICAgY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX01VUERBVEVfUkVBTE0pLAorCQkJ
ICAgICAgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9NVVBEQVRFX1BBU1NXT1JEKSk7CiAgICAg
fQogCiAgICAgc2FzbHJlc3VsdCA9IHNhc2xfY2xpZW50X25ldyhzZXJ2aWNlX25hbWUsCkluZGV4
OiBpbWFwL211cGRhdGUtc2xhdmUuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5j
bXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvbXVwZGF0ZS1zbGF2ZS5jLHYKcmV0cmll
dmluZyByZXZpc2lvbiAxLjE2CmRpZmYgLXUgLXIxLjE2IG11cGRhdGUtc2xhdmUuYwotLS0gbXVw
ZGF0ZS1zbGF2ZS5jCTIwMDIvMDIvMjUgMjI6NDI6MzkJMS4xNgorKysgbXVwZGF0ZS1zbGF2ZS5j
CTIwMDIvMDYvMTkgMDA6MTQ6NDEKQEAgLTIyMywzNCArMjIzLDMwIEBACiAKIHZvaWQgKm11cGRh
dGVfY2xpZW50X3N0YXJ0KHZvaWQgKnJvY2sgX19hdHRyaWJ1dGVfXygodW51c2VkKSkpCiB7Ci0g
ICAgY29uc3QgY2hhciAqc2VydmVyLCAqbnVtOwogICAgIG11cGRhdGVfaGFuZGxlICpoID0gTlVM
TDsKICAgICBpbnQgcmV0cnlfZGVsYXkgPSAyMCwgcmVhbF9kZWxheTsKICAgICBpbnQgcmV0Owog
CiAgICAgc3JhbmQodGltZShOVUxMKSAqIGdldHBpZCgpKTsKIAotICAgIHNlcnZlciA9IGNvbmZp
Z19nZXRzdHJpbmcoIm11cGRhdGVfc2VydmVyIiwgTlVMTCk7Ci0gICAgaWYoc2VydmVyID09IE5V
TEwpIHsKKyAgICBpZighY29uZmlnX211cGRhdGVfc2VydmVyKSB7CiAJZmF0YWwoImNvdWxkbid0
IGdldCBtdXBkYXRlIHNlcnZlciBuYW1lIiwgRUNfVU5BVkFJTEFCTEUpOwogICAgIH0KIAotICAg
IG51bSA9IGNvbmZpZ19nZXRzdHJpbmcoIm11cGRhdGVfcmV0cnlfZGVsYXkiLE5VTEwpOwotICAg
IGlmKG51bSAmJiBpbXBhcnNlX2lzbnVtYmVyKG51bSkpIHsKLQlyZXRyeV9kZWxheSA9IGF0b2ko
bnVtKTsKLQlpZihyZXRyeV9kZWxheSA8IDApIHsKLQkgICAgZmF0YWwoImludmFsaWQgdmFsdWUg
Zm9yIG11cGRhdGVfcmV0cnlfZGVsYXkiLCBFQ19VTkFWQUlMQUJMRSk7Ci0JfQorICAgIHJldHJ5
X2RlbGF5ID0gY29uZmlnX2dldGludChJTUFQT1BUX01VUERBVEVfUkVUUllfREVMQVkpOworICAg
IGlmKHJldHJ5X2RlbGF5IDwgMCkgeworCWZhdGFsKCJpbnZhbGlkIHZhbHVlIGZvciBtdXBkYXRl
X3JldHJ5X2RlbGF5IiwgRUNfVU5BVkFJTEFCTEUpOwogICAgIH0KIAogICAgIHdoaWxlKDEpIHsK
LQlyZXQgPSBtdXBkYXRlX2Nvbm5lY3Qoc2VydmVyLCBOVUxMLCAmaCwgTlVMTCk7CisJcmV0ID0g
bXVwZGF0ZV9jb25uZWN0KGNvbmZpZ19tdXBkYXRlX3NlcnZlciwgTlVMTCwgJmgsIE5VTEwpOwog
CWlmKHJldCkgewogCSAgICBzeXNsb2coTE9HX0VSUiwiY291bGRuJ3QgY29ubmVjdCB0byBtdXBk
YXRlIHNlcnZlciIpOwogCSAgICBnb3RvIHJldHJ5OwogCX0KICAgIAotCXN5c2xvZyhMT0dfRVJS
LCAic3VjY2Vzc2Z1bCBtdXBkYXRlIGNvbm5lY3Rpb24gdG8gJXMiLCBzZXJ2ZXIpOworCXN5c2xv
ZyhMT0dfRVJSLCAic3VjY2Vzc2Z1bCBtdXBkYXRlIGNvbm5lY3Rpb24gdG8gJXMiLAorCSAgICAg
ICBjb25maWdfbXVwZGF0ZV9zZXJ2ZXIpOwogCiAJbXVwZGF0ZV9saXN0ZW4oaCwgcmV0cnlfZGVs
YXkpOwogCkluZGV4OiBpbWFwL211cGRhdGUuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2Fu
ZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvbXVwZGF0ZS5jLHYKcmV0cmll
dmluZyByZXZpc2lvbiAxLjYwCmRpZmYgLXUgLXIxLjYwIG11cGRhdGUuYwotLS0gbXVwZGF0ZS5j
CTIwMDIvMDYvMDMgMTg6MjI6MjYJMS42MAorKysgbXVwZGF0ZS5jCTIwMDIvMDYvMTkgMDA6MTI6
MzUKQEAgLTI2OCw3ICsyNjgsNyBAQAogICAgIC8qIGNoZWNrIGlmIHJlbW90ZSByZWFsbSAqLwog
ICAgIGlmICgocmVhbG0gPSBzdHJjaHIoYXV0aF9pZF9idWYsICdAJykpIT1OVUxMKSB7CiAJcmVh
bG0rKzsKLQl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJlYWxtcyIsICIiKTsKKwl2YWwg
PSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMpOwogCXdoaWxlICgqdmFsKSB7
CiAJICAgIGlmICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3RybGVuKHJlYWxtKSkgJiYKIAkJ
KCF2YWxbc3RybGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2YWxbc3RybGVuKHJlYWxtKV0p
KSkgewpAQCAtMjg5LDcgKzI4OSw3IEBACiAgICAgICogZm9yIG5vdyBvbmx5IGFkbWlucyBjYW4g
ZG8gbXVwZGF0ZSBmcm9tIGFub3RoZXIgbWFjaGluZQogICAgICAqLwogICAgIGF1dGhzdGF0ZSA9
IGF1dGhfbmV3c3RhdGUoYXV0aF9pZF9idWYsIE5VTEwpOwotICAgIGFsbG93ZWQgPSBhdXRoaXNh
KGF1dGhzdGF0ZSwgIm11cGRhdGUiLCAiYWRtaW5zIik7CisgICAgYWxsb3dlZCA9IGNvbmZpZ19h
dXRoaXNhKGF1dGhzdGF0ZSwgSU1BUE9QVF9BRE1JTlMpOwogICAgIGF1dGhfZnJlZXN0YXRlKGF1
dGhzdGF0ZSk7CiAgICAgCiAgICAgaWYgKCFhbGxvd2VkKSB7CkBAIC0zMTYsOCArMzE2LDYgQEAK
ICAgICBpbnQgcjsKICAgICBpbnQgb3B0OwogCi0gICAgY29uZmlnX2NoYW5nZWlkZW50KCJtdXBk
YXRlIik7Ci0gICAgCiAgICAgaWYgKGdldGV1aWQoKSA9PSAwKSBmYXRhbCgibXVzdCBydW4gYXMg
dGhlIEN5cnVzIHVzZXIiLCBFQ19VU0FHRSk7CiAKICAgICAvKiBzZXQgc2lnbmFsIGhhbmRsZXJz
ICovCkBAIC0zNjUsMTcgKzM2Myw2IEBACiAJfQogICAgIH0KIAotICAgIC8qIFNsYXZlIFNraXBs
aXN0IEZhc3QgUmVzeW5jPyAqLwotICAgIGlmKCFtYXN0ZXJwICYmIGNvbmZpZ19nZXRzd2l0Y2go
Im11cGRhdGVfc2xhdmVfZmFzdF9yZXN5bmMiLDApKSB7Ci0JY2hhciBmbmFtZVs0MDk2XTsKLQkK
LQlpZihzbnByaW50ZihmbmFtZSw0MDk2LCIlcyVzIixjb25maWdfZGlyLEZOQU1FX01CT1hMSVNU
KSA9PSAtMSkKLQkgICAgZmF0YWwoIm1ib3hsaXN0IGRhdGFiYXNlIGZpbGVuYW1lIHRvbyBsYXJn
ZSIsRUNfVEVNUEZBSUwpOwotCi0JcHV0ZW52KCJDWVJVU19TS0lQTElTVF9VTlNBRkU9MSIpOwot
IAl1bmxpbmsoZm5hbWUpOwotICAgIH0KLQogICAgIGRhdGFiYXNlX2luaXQoKTsKIAogICAgIGlm
ICghbWFzdGVycCkgewpAQCAtNDQwLDEwICs0MjcsMTEgQEAKIAogICAgIC8qIEFVVEggYmFubmVy
IGlzIG1hbmRhdG9yeSAqLwogICAgIGlmKCFtYXN0ZXJwKSB7Ci0JY29uc3QgY2hhciAqbXVwZGF0
ZV9zZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKCJtdXBkYXRlX3NlcnZlciIsIE5VTEwpOwotCWlm
KCFtdXBkYXRlX3NlcnZlcikKKwlpZighY29uZmlnX211cGRhdGVfc2VydmVyKQogCSAgICBmYXRh
bCgibXVwZGF0ZSBzZXJ2ZXIgd2FzIG5vdCBzcGVjaWZpZWQgZm9yIHNsYXZlIiwgRUNfVEVNUEZB
SUwpOwotCXNucHJpbnRmKHNsYXZlYnVmLCBzaXplb2Yoc2xhdmVidWYpLCAibXVwZGF0ZTovLyVz
IiwgbXVwZGF0ZV9zZXJ2ZXIpOworCisJc25wcmludGYoc2xhdmVidWYsIHNpemVvZihzbGF2ZWJ1
ZiksICJtdXBkYXRlOi8vJXMiLAorCQkgY29uZmlnX211cGRhdGVfc2VydmVyKTsKICAgICB9CiAJ
CQogICAgIHByb3RfcHJpbnRmKGMtPnBvdXQsCkBAIC02OTksNyArNjg3LDcgQEAKICAgICBzdHJ1
Y3Qgc29ja2FkZHJfaW4gbG9jYWxhZGRyLCByZW1vdGVhZGRyOwogICAgIGludCBoYXZlYWRkciA9
IDA7CiAgICAgaW50IHNhbGVuOwotICAgIGludCBzZWNmbGFncywgcGxhaW50ZXh0X3Jlc3VsdDsK
KyAgICBpbnQgc2VjZmxhZ3M7CiAgICAgc2FzbF9zZWN1cml0eV9wcm9wZXJ0aWVzX3QgKnNlY3By
b3BzID0gTlVMTDsKICAgICBjaGFyIGxvY2FsaXBbNjBdLCByZW1vdGVpcFs2MF07CiAgICAgY2hh
ciBjbGllbnRob3N0WzI1MF07CkBAIC03NjIsOCArNzUwLDcgQEAKIAogICAgIC8qIHNldCBteSBh
bGxvd2FibGUgc2VjdXJpdHkgcHJvcGVydGllcyAqLwogICAgIHNlY2ZsYWdzID0gU0FTTF9TRUNf
Tk9BTk9OWU1PVVM7Ci0gICAgcGxhaW50ZXh0X3Jlc3VsdCA9IGNvbmZpZ19nZXRzd2l0Y2goImFs
bG93cGxhaW50ZXh0IiwxKTsKLSAgICBpZiAoIWNvbmZpZ19nZXRzd2l0Y2goIm11cGRhdGVfYWxs
b3dwbGFpbnRleHQiLCBwbGFpbnRleHRfcmVzdWx0KSkgeworICAgIGlmICghY29uZmlnX2dldHN3
aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhUKSkgewogCXNlY2ZsYWdzIHw9IFNBU0xfU0VDX05P
UExBSU5URVhUOwogICAgIH0KICAgICBzZWNwcm9wcyA9IG15c2FzbF9zZWNwcm9wcyhzZWNmbGFn
cyk7CkBAIC0xMjU1LDcgKzEyNDIsNyBAQAogLyogUmVzZXQgdGhlIGdpdmVuIHNhc2xfY29ubl90
IHRvIGEgc2FuZSBzdGF0ZSAqLwogc3RhdGljIGludCByZXNldF9zYXNsY29ubihzdHJ1Y3QgY29u
biAqYykKIHsKLSAgICBpbnQgcmV0LCBzZWNmbGFncywgcGxhaW50ZXh0X3Jlc3VsdDsKKyAgICBp
bnQgcmV0LCBzZWNmbGFnczsKICAgICBzYXNsX3NlY3VyaXR5X3Byb3BlcnRpZXNfdCAqc2VjcHJv
cHMgPSBOVUxMOwogCiAgICAgc2FzbF9kaXNwb3NlKCZjLT5zYXNsY29ubik7CkBAIC0xMjc2LDgg
KzEyNjMsNyBAQAogICAgIGlmKHJldCAhPSBTQVNMX09LKSByZXR1cm4gcmV0OwogICAgIAogICAg
IHNlY2ZsYWdzID0gU0FTTF9TRUNfTk9BTk9OWU1PVVM7Ci0gICAgcGxhaW50ZXh0X3Jlc3VsdCA9
IGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0IiwxKTsKLSAgICBpZiAoIWNvbmZpZ19n
ZXRzd2l0Y2goIm11cGRhdGVfYWxsb3dwbGFpbnRleHQiLCBwbGFpbnRleHRfcmVzdWx0KSkgewor
ICAgIGlmICghY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhUKSkgewogCXNl
Y2ZsYWdzIHw9IFNBU0xfU0VDX05PUExBSU5URVhUOwogICAgIH0KICAgICBzZWNwcm9wcyA9IG15
c2FzbF9zZWNwcm9wcyhzZWNmbGFncyk7CkluZGV4OiBpbWFwL25vdGlmeS5jCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
UkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9u
b3RpZnkuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS42CmRpZmYgLXUgLXIxLjYgbm90aWZ5LmMK
LS0tIG5vdGlmeS5jCTIwMDIvMDUvMDcgMTg6NTA6MjEJMS42CisrKyBub3RpZnkuYwkyMDAyLzA2
LzE4IDIwOjM5OjQwCkBAIC05MywxMyArOTMsMTMgQEAKIAogICAgIHNvYyA9IHNvY2tldChBRl9V
TklYLCBTT0NLX0RHUkFNLCAwKTsKICAgICBpZiAoc29jID09IC0xKSB7Ci0Jc3lzbG9nKExPR19F
UlIsICJ1bmFibGUgdG8gb3BlbiBub3RpZnkgc29ja2V0KCk6ICVtIik7CisJc3lzbG9nKExPR19F
UlIsICJ1bmFibGUgdG8gY3JlYXRlIG5vdGlmeSBzb2NrZXQoKTogJW0iKTsKIAlyZXR1cm47CiAg
ICAgfQogCiAgICAgbWVtc2V0KChjaGFyICopJnN1bl9kYXRhLCAwLCBzaXplb2Yoc3VuX2RhdGEp
KTsKICAgICBzdW5fZGF0YS5zdW5fZmFtaWx5ID0gQUZfVU5JWDsKLSAgICBub3RpZnlfc29jayA9
IGNvbmZpZ19nZXRzdHJpbmcoIm5vdGlmeXNvY2tldCIsIE5VTEwpOworICAgIG5vdGlmeV9zb2Nr
ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX05PVElGWVNPQ0tFVCk7CiAgICAgaWYgKG5vdGlm
eV9zb2NrKSB7CQogCXN0cmNweShzdW5fZGF0YS5zdW5fcGF0aCwgbm90aWZ5X3NvY2spOwogICAg
IH0KSW5kZXg6IGltYXAvcG9wM2QuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5j
bXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvcG9wM2QuYyx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMS4xMjIKZGlmZiAtdSAtcjEuMTIyIHBvcDNkLmMKLS0tIHBvcDNkLmMJMjAwMi8wNi8w
MyAxODoyMjoyNwkxLjEyMgorKysgcG9wM2QuYwkyMDAyLzA2LzE4IDIzOjM3OjA3CkBAIC0xODks
NyArMTg5LDcgQEAKICAgICAvKiBjaGVjayBpZiByZW1vdGUgcmVhbG0gKi8KICAgICBpZiAoKHJl
YWxtID0gc3RyY2hyKGF1dGhfaWRlbnRpdHksICdAJykpIT1OVUxMKSB7CiAJcmVhbG0rKzsKLQl2
YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJlYWxtcyIsICIiKTsKKwl2YWwgPSBjb25maWdf
Z2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMpOwogCXdoaWxlICgqdmFsKSB7CiAJICAgIGlm
ICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3RybGVuKHJlYWxtKSkgJiYKIAkJKCF2YWxbc3Ry
bGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2YWxbc3RybGVuKHJlYWxtKV0pKSkgewpAQCAt
MjA5LDEzICsyMDksMTMgQEAKICAgICBhdXRoc3RhdGUgPSBhdXRoX25ld3N0YXRlKGF1dGhfaWRl
bnRpdHksIE5VTEwpOwogCiAgICAgLyogb2ssIGlzIGF1dGhfaWRlbnRpdHkgYW4gYWRtaW4/ICov
Ci0gICAgdXNlcmlzYWRtaW4gPSBhdXRoaXNhKGF1dGhzdGF0ZSwgImltYXAiLCAiYWRtaW5zIik7
CisgICAgdXNlcmlzYWRtaW4gPSBjb25maWdfYXV0aGlzYShhdXRoc3RhdGUsIElNQVBPUFRfQURN
SU5TKTsKIAogICAgIGlmIChhbGVuICE9IHJsZW4gfHwgc3RybmNtcChhdXRoX2lkZW50aXR5LCBy
ZXF1ZXN0ZWRfdXNlciwgYWxlbikpIHsKIAkvKiB3ZSB3YW50IHRvIGF1dGhlbnRpY2F0ZSBhcyBh
IGRpZmZlcmVudCB1c2VyOyB3ZSdsbCBhbGxvdyB0aGlzCiAJICAgaWYgd2UncmUgYW4gYWRtaW4g
b3IgaWYgd2UndmUgYWxsb3dlZCBBQ0wgcHJveHkgbG9naW5zICovCiAJaWYgKHVzZXJpc2FkbWlu
IHx8Ci0JICAgIGF1dGhpc2EoYXV0aHN0YXRlLCAiaW1hcCIsICJwcm94eXNlcnZlcnMiKSkgewor
CSAgICBjb25maWdfYXV0aGlzYShhdXRoc3RhdGUsIElNQVBPUFRfUFJPWFlTRVJWRVJTKSkgewog
CiAJICAgIC8qIHByb3h5IG9rISAqLwogCSAgICBhdXRoX2ZyZWVzdGF0ZShhdXRoc3RhdGUpOwpA
QCAtMzEyLDcgKzMxMiw2IEBACiAgICAgaW50IHI7CiAgICAgaW50IG9wdDsKIAotICAgIGNvbmZp
Z19jaGFuZ2VpZGVudCgicG9wM2QiKTsKICAgICBpZiAoZ2V0ZXVpZCgpID09IDApIGZhdGFsKCJt
dXN0IHJ1biBhcyB0aGUgQ3lydXMgdXNlciIsIEVDX1VTQUdFKTsKICAgICBzZXRwcm9jdGl0bGVf
aW5pdChhcmdjLCBhcmd2LCBlbnZwKTsKIApAQCAtMzU1LDcgKzM1NCw3IEBACiAgCSAgICBicmVh
azsKIAljYXNlICdzJzogLyogcG9wM3MgKGRvIHN0YXJ0dGxzIHJpZ2h0IGF3YXkpICovCiAJICAg
IHBvcDNzID0gMTsKLQkgICAgaWYgKCF0bHNfZW5hYmxlZCgicG9wMyIpKSB7CisJICAgIGlmICgh
dGxzX2VuYWJsZWQoKSkgewogCQlzeXNsb2coTE9HX0VSUiwgInBvcDNzOiByZXF1aXJlZCBPcGVu
U1NMIG9wdGlvbnMgbm90IHByZXNlbnQiKTsKIAkJZmF0YWwoInBvcDNzOiByZXF1aXJlZCBPcGVu
U1NMIG9wdGlvbnMgbm90IHByZXNlbnQiLAogCQkgICAgICBFQ19DT05GSUcpOwpAQCAtNDM0LDcg
KzQzMyw3IEBACiAgICAgcHJvY19yZWdpc3RlcigicG9wM2QiLCBwb3BkX2NsaWVudGhvc3QsIE5V
TEwsIE5VTEwpOwogCiAgICAgLyogU2V0IGluYWN0aXZpdHkgdGltZXIgKi8KLSAgICB0aW1lb3V0
ID0gY29uZmlnX2dldGludCgicG9wdGltZW91dCIsIDEwKTsKKyAgICB0aW1lb3V0ID0gY29uZmln
X2dldGludChJTUFQT1BUX1BPUFRJTUVPVVQpOwogICAgIGlmICh0aW1lb3V0IDwgMTApIHRpbWVv
dXQgPSAxMDsKICAgICBwcm90X3NldHRpbWVvdXQocG9wZF9pbiwgdGltZW91dCo2MCk7CiAgICAg
cHJvdF9zZXRmbHVzaG9ucmVhZChwb3BkX2luLCBwb3BkX291dCk7CkBAIC01NDUsNyArNTQ0LDcg
QEAKIAlmYXRhbCgiQ2Fubm90IGdldCBjbGllbnQncyBJUCBhZGRyZXNzIiwgRUNfT1NFUlIpOwog
ICAgIH0KIAotICAgIHNydnRhYiA9IGNvbmZpZ19nZXRzdHJpbmcoInNydnRhYiIsICIiKTsKKyAg
ICBzcnZ0YWIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU1JWVEFCKTsKIAogICAgIHN0cmNw
eShpbnN0YW5jZSwgIioiKTsKICAgICByID0ga3JiX3JlY3ZhdXRoKDBMLCAwLCAmdGlja2V0LCAi
cG9wIiwgaW5zdGFuY2UsCkBAIC02NTEsNyArNjUwLDcgQEAKIAkJY21kX2NhcGEoKTsKIAkgICAg
fQogCX0KLQllbHNlIGlmICghc3RyY21wKGlucHV0YnVmLCAic3RscyIpICYmIHRsc19lbmFibGVk
KCJwb3AzIikpIHsKKwllbHNlIGlmICghc3RyY21wKGlucHV0YnVmLCAic3RscyIpICYmIHRsc19l
bmFibGVkKCkpIHsKIAkgICAgaWYgKGFyZykgewogCQlwcm90X3ByaW50Zihwb3BkX291dCwKIAkJ
CSAgICAiLUVSUiBTVExTIGRvZXNuJ3QgdGFrZSBhbnkgYXJndW1lbnRzXHJcbiIpOwpAQCAtMTAz
Niw3ICsxMDM1LDcgQEAKIAogICAgIC8qIHBvc3NpYmx5IGRpc2FsbG93IFVTRVIgKi8KICAgICBp
ZiAoIShrZmxhZyB8fCBwb3BkX3N0YXJ0dGxzX2RvbmUgfHwKLQkgIGNvbmZpZ19nZXRzd2l0Y2go
ImFsbG93cGxhaW50ZXh0IiwgMSkpKSB7CisJICBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxM
T1dQTEFJTlRFWFQpKSkgewogCXByb3RfcHJpbnRmKHBvcGRfb3V0LAogCQkgICAgIi1FUlIgW0FV
VEhdIFVTRVIgY29tbWFuZCBvbmx5IGF2YWlsYWJsZSB1bmRlciBhIGxheWVyXHJcbiIpOwogCXJl
dHVybjsKQEAgLTExMDcsNyArMTEwNiw3IEBACiAjZW5kaWYKIAogICAgIGlmICghc3RyY21wKHBv
cGRfdXNlcmlkLCAiYW5vbnltb3VzIikpIHsKLQlpZiAoY29uZmlnX2dldHN3aXRjaCgiYWxsb3dh
bm9ueW1vdXNsb2dpbiIsIDApKSB7CisJaWYgKGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExP
V0FOT05ZTU9VU0xPR0lOKSkgewogCSAgICBwYXNzID0gYmVhdXRpZnlfc3RyaW5nKHBhc3MpOwog
CSAgICBpZiAoc3RybGVuKHBhc3MpID4gNTAwKSBwYXNzWzUwMF0gPSAnXDAnOwogCSAgICBzeXNs
b2coTE9HX05PVElDRSwgImxvZ2luOiAlcyBhbm9ueW1vdXMgJXMiLApAQCAtMTE0MSw3ICsxMTQw
LDggQEAKIAkgICAgICAgcG9wZF91c2VyaWQsIHBvcGRfc3RhcnR0bHNfZG9uZSA/ICIrVExTIiA6
ICIiLCAKIAkgICAgICAgcmVwbHkgPyByZXBseSA6ICIiKTsKIAotCWlmICgocGxhaW50ZXh0bG9n
aW5wYXVzZSA9IGNvbmZpZ19nZXRpbnQoInBsYWludGV4dGxvZ2lucGF1c2UiLCAwKSkhPTApIHsK
KwlpZiAoKHBsYWludGV4dGxvZ2lucGF1c2UgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfUExBSU5U
RVhUTE9HSU5QQVVTRSkpCisJICAgICAhPSAwKSB7CiAJICAgIHNsZWVwKHBsYWludGV4dGxvZ2lu
cGF1c2UpOwogCX0KICAgICB9CkBAIC0xMTUzLDggKzExNTMsOCBAQAogdm9pZAogY21kX2NhcGEo
KQogewotICAgIGludCBtaW5wb2xsID0gY29uZmlnX2dldGludCgicG9wbWlucG9sbCIsIDApICog
NjA7Ci0gICAgaW50IGV4cGlyZSA9IGNvbmZpZ19nZXRpbnQoInBvcGV4cGlyZXRpbWUiLCAtMSk7
CisgICAgaW50IG1pbnBvbGwgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfUE9QTUlOUE9MTCkgKiA2
MDsKKyAgICBpbnQgZXhwaXJlID0gY29uZmlnX2dldGludChJTUFQT1BUX1BPUEVYUElSRVRJTUUp
OwogICAgIHVuc2lnbmVkIG1lY2hjb3VudDsKICAgICBjb25zdCBjaGFyICptZWNobGlzdDsKIApA
QCAtMTE2OSw3ICsxMTY5LDcgQEAKIAlwcm90X3dyaXRlKHBvcGRfb3V0LCBtZWNobGlzdCwgc3Ry
bGVuKG1lY2hsaXN0KSk7CiAgICAgfQogCi0gICAgaWYgKHRsc19lbmFibGVkKCJwb3AzIikpIHsK
KyAgICBpZiAodGxzX2VuYWJsZWQoKSkgewogCXByb3RfcHJpbnRmKHBvcGRfb3V0LCAiU1RMU1xy
XG4iKTsKICAgICB9CiAgICAgaWYgKGV4cGlyZSA8IDApIHsKQEAgLTExODUsNyArMTE4NSw4IEBA
CiAgICAgcHJvdF9wcmludGYocG9wZF9vdXQsICJSRVNQLUNPREVTXHJcbiIpOwogICAgIHByb3Rf
cHJpbnRmKHBvcGRfb3V0LCAiQVVUSC1SRVNQLUNPREVcclxuIik7CiAKLSAgICBpZiAoa2ZsYWcg
fHwgcG9wZF9zdGFydHRsc19kb25lIHx8IGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0
IiwgMSkpIHsKKyAgICBpZihrZmxhZyB8fCBwb3BkX3N0YXJ0dGxzX2RvbmUKKyAgICB8fCBjb25m
aWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dQTEFJTlRFWFQpKSB7CiAJcHJvdF9wcmludGYocG9w
ZF9vdXQsICJVU0VSXHJcbiIpOwogICAgIH0KICAgICAKQEAgLTEzODIsNyArMTM4Myw3IEBACiAJ
cmV0dXJuIDE7CiAgICAgfQogCi0gICAgaWYgKChtaW5wb2xsID0gY29uZmlnX2dldGludCgicG9w
bWlucG9sbCIsIDApKSAmJgorICAgIGlmICgobWlucG9sbCA9IGNvbmZpZ19nZXRpbnQoSU1BUE9Q
VF9QT1BNSU5QT0xMKSkgJiYKIAltYm94c3RydWN0LnBvcDNfbGFzdF9sb2dpbiArIDYwKm1pbnBv
bGwgPiBwb3BkX2xvZ2luX3RpbWUpIHsKIAlwcm90X3ByaW50Zihwb3BkX291dCwKIAkgICAgIi1F
UlIgW0xPR0lOLURFTEFZXSBMb2dpbnMgbXVzdCBiZSBhdCBsZWFzdCAlZCBtaW51dGUlcyBhcGFy
dFxyXG4iLApJbmRleDogaW1hcC9wb3AzcHJveHlkLmMKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fm
cy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL3BvcDNwcm94eWQuYyx2
CnJldHJpZXZpbmcgcmV2aXNpb24gMS40MgpkaWZmIC11IC1yMS40MiBwb3AzcHJveHlkLmMKLS0t
IHBvcDNwcm94eWQuYwkyMDAyLzA2LzEyIDIwOjAwOjEyCTEuNDIKKysrIHBvcDNwcm94eWQuYwky
MDAyLzA2LzE5IDAwOjAxOjQ4CkBAIC0xNzMsNyArMTczLDcgQEAKICAgICAvKiBjaGVjayBpZiBy
ZW1vdGUgcmVhbG0gKi8KICAgICBpZiAoKHJlYWxtID0gc3RyY2hyKGF1dGhfaWRlbnRpdHksICdA
JykpIT1OVUxMKSB7CiAJcmVhbG0rKzsKLQl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJl
YWxtcyIsICIiKTsKKwl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMp
OwogCXdoaWxlICgqdmFsKSB7CiAJICAgIGlmICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3Ry
bGVuKHJlYWxtKSkgJiYKIAkJKCF2YWxbc3RybGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2
YWxbc3RybGVuKHJlYWxtKV0pKSkgewpAQCAtMTkzLDEzICsxOTMsMTMgQEAKICAgICBhdXRoc3Rh
dGUgPSBhdXRoX25ld3N0YXRlKGF1dGhfaWRlbnRpdHksIE5VTEwpOwogCiAgICAgLyogb2ssIGlz
IGF1dGhfaWRlbnRpdHkgYW4gYWRtaW4/ICovCi0gICAgdXNlcmlzYWRtaW4gPSBhdXRoaXNhKGF1
dGhzdGF0ZSwgImltYXAiLCAiYWRtaW5zIik7CisgICAgdXNlcmlzYWRtaW4gPSBjb25maWdfYXV0
aGlzYShhdXRoc3RhdGUsIElNQVBPUFRfQURNSU5TKTsKIAogICAgIGlmIChhbGVuICE9IHJsZW4g
fHwgc3RybmNtcChhdXRoX2lkZW50aXR5LCByZXF1ZXN0ZWRfdXNlciwgYWxlbikpIHsKIAkvKiB3
ZSB3YW50IHRvIGF1dGhlbnRpY2F0ZSBhcyBhIGRpZmZlcmVudCB1c2VyOyB3ZSdsbCBhbGxvdyB0
aGlzCiAJICAgaWYgd2UncmUgYW4gYWRtaW4gb3IgaWYgd2UndmUgYWxsb3dlZCBBQ0wgcHJveHkg
bG9naW5zICovCiAJaWYgKHVzZXJpc2FkbWluIHx8Ci0JICAgIGF1dGhpc2EoYXV0aHN0YXRlLCAi
aW1hcCIsICJwcm94eXNlcnZlcnMiKSkgeworCSAgICBjb25maWdfYXV0aGlzYShhdXRoc3RhdGUs
IElNQVBPUFRfQURNSU5TKSkgewogCiAJICAgIC8qIHByb3h5IG9rISAqLwogCSAgICBhdXRoX2Zy
ZWVzdGF0ZShhdXRoc3RhdGUpOwpAQCAtMjMxLDcgKzIzMSw2IEBACiB7CiAgICAgaW50IHI7CiAK
LSAgICBjb25maWdfY2hhbmdlaWRlbnQoInBvcDNkIik7CiAgICAgaWYgKGdldGV1aWQoKSA9PSAw
KSBmYXRhbCgibXVzdCBydW4gYXMgdGhlIEN5cnVzIHVzZXIiLCBFQ19VU0FHRSk7CiAgICAgc2V0
cHJvY3RpdGxlX2luaXQoYXJnYywgYXJndiwgZW52cCk7CiAKQEAgLTI5Miw3ICsyOTEsNyBAQAog
IAkgICAgYnJlYWs7CiAJY2FzZSAncyc6IC8qIHBvcDNzIChkbyBzdGFydHRscyByaWdodCBhd2F5
KSAqLwogCSAgICBwb3AzcyA9IDE7Ci0JICAgIGlmICghdGxzX2VuYWJsZWQoInBvcDMiKSkgewor
CSAgICBpZiAoIXRsc19lbmFibGVkKCkpIHsKIAkJc3lzbG9nKExPR19FUlIsICJwb3AzczogcmVx
dWlyZWQgT3BlblNTTCBvcHRpb25zIG5vdCBwcmVzZW50Iik7CiAJCWZhdGFsKCJwb3AzczogcmVx
dWlyZWQgT3BlblNTTCBvcHRpb25zIG5vdCBwcmVzZW50IiwKIAkJICAgICAgRUNfQ09ORklHKTsK
QEAgLTM0OSw3ICszNDgsNyBAQAogICAgIHByb2NfcmVnaXN0ZXIoInBvcDNkIiwgcG9wZF9jbGll
bnRob3N0LCBOVUxMLCBOVUxMKTsKIAogICAgIC8qIFNldCBpbmFjdGl2aXR5IHRpbWVyICovCi0g
ICAgdGltZW91dCA9IGNvbmZpZ19nZXRpbnQoInBvcHRpbWVvdXQiLCAxMCk7CisgICAgdGltZW91
dCA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9QT1BUSU1FT1VUKTsKICAgICBpZiAodGltZW91dCA8
IDEwKSB0aW1lb3V0ID0gMTA7CiAgICAgcHJvdF9zZXR0aW1lb3V0KHBvcGRfaW4sIHRpbWVvdXQq
NjApOwogICAgIHByb3Rfc2V0Zmx1c2hvbnJlYWQocG9wZF9pbiwgcG9wZF9vdXQpOwpAQCAtNDgx
LDcgKzQ4MCw3IEBACiAJZmF0YWwoIkNhbm5vdCBnZXQgY2xpZW50J3MgSVAgYWRkcmVzcyIsIEVD
X09TRVJSKTsKICAgICB9CiAKLSAgICBzcnZ0YWIgPSBjb25maWdfZ2V0c3RyaW5nKCJzcnZ0YWIi
LCAiIik7CisgICAgc3J2dGFiID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NSVlRBQik7CiAK
ICAgICBzdHJjcHkoaW5zdGFuY2UsICIqIik7CiAgICAgciA9IGtyYl9yZWN2YXV0aCgwTCwgMCwg
JnRpY2tldCwgInBvcCIsIGluc3RhbmNlLApAQCAtNTk4LDcgKzU5Nyw3IEBACiAJZWxzZSBpZiAo
IXN0cmNtcChpbnB1dGJ1ZiwgImF1dGgiKSkgewogCSAgICBjbWRfYXV0aChhcmcpOwogCX0KLQll
bHNlIGlmICghc3RyY21wKGlucHV0YnVmLCAic3RscyIpICYmIHRsc19lbmFibGVkKCJwb3AzIikp
IHsKKwllbHNlIGlmICghc3RyY21wKGlucHV0YnVmLCAic3RscyIpICYmIHRsc19lbmFibGVkKCkp
IHsKIAkgICAgaWYgKGFyZykgewogCQlwcm90X3ByaW50Zihwb3BkX291dCwKIAkJCSAgICAiLUVS
UiBTVExTIGRvZXNuJ3QgdGFrZSBhbnkgYXJndWVtZW50c1xyXG4iKTsKQEAgLTYxNSw3ICs2MTQs
NiBAQAogI2lmZGVmIEhBVkVfU1NMCiBzdGF0aWMgdm9pZCBjbWRfc3RhcnR0bHMoaW50IHBvcDNz
KQogewotICAgIGNoYXIgKnRsc19jZXJ0LCAqdGxzX2tleTsKICAgICBpbnQgcmVzdWx0OwogICAg
IGludCAqbGF5ZXJwOwogICAgIGNoYXIgKmF1dGhfaWQ7CkBAIC02MzEsMTEgKzYyOSw2IEBACiAJ
cmV0dXJuOwogICAgIH0KIAotICAgIHRsc19jZXJ0ID0gKGNoYXIgKiljb25maWdfZ2V0c3RyaW5n
KCJ0bHNfcG9wM19jZXJ0X2ZpbGUiLAotCQkJCQljb25maWdfZ2V0c3RyaW5nKCJ0bHNfY2VydF9m
aWxlIiwgIiIpKTsKLSAgICB0bHNfa2V5ID0gKGNoYXIgKiljb25maWdfZ2V0c3RyaW5nKCJ0bHNf
cG9wM19rZXlfZmlsZSIsCi0JCQkJICAgICAgIGNvbmZpZ19nZXRzdHJpbmcoInRsc19rZXlfZmls
ZSIsICIiKSk7Ci0KICAgICByZXN1bHQ9dGxzX2luaXRfc2VydmVyZW5naW5lKCJwb3AzIiwKIAkJ
CQkgNSwgICAgICAgIC8qIGRlcHRoIHRvIHZlcmlmeSAqLwogCQkJCSAhcG9wM3MsICAgLyogY2Fu
IGNsaWVudCBhdXRoPyAqLwpAQCAtODA0LDcgKzc5Nyw3IEBACiAKICAgICAvKiBwb3NzaWJseSBk
aXNhbGxvdyBVU0VSICovCiAgICAgaWYgKCEoa2ZsYWcgfHwgcG9wZF9zdGFydHRsc19kb25lIHx8
Ci0JICBjb25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsIDEpKSkgeworCSAgY29uZmln
X2dldHN3aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhUKSkpIHsKIAlwcm90X3ByaW50Zihwb3Bk
X291dCwKIAkJICAgICItRVJSIFtBVVRIXSBVU0VSIGNvbW1hbmQgb25seSBhdmFpbGFibGUgdW5k
ZXIgYSBsYXllclxyXG4iKTsKIAlyZXR1cm47CkBAIC04NjQsNyArODU3LDcgQEAKICNlbmRpZgog
CiAgICAgaWYgKCFzdHJjbXAocG9wZF91c2VyaWQsICJhbm9ueW1vdXMiKSkgewotCWlmIChjb25m
aWdfZ2V0c3dpdGNoKCJhbGxvd2Fub255bW91c2xvZ2luIiwgMCkpIHsKKwlpZiAoY29uZmlnX2dl
dHN3aXRjaChJTUFQT1BUX0FMTE9XQU5PTllNT1VTTE9HSU4pKSB7CiAJICAgIHBhc3MgPSBiZWF1
dGlmeV9zdHJpbmcocGFzcyk7CiAJICAgIGlmIChzdHJsZW4ocGFzcykgPiA1MDApIHBhc3NbNTAw
XSA9ICdcMCc7CiAJICAgIHN5c2xvZyhMT0dfTk9USUNFLCAibG9naW46ICVzIGFub255bW91cyAl
cyIsCkBAIC04OTgsNyArODkxLDcgQEAKIAkgICAgICAgcG9wZF91c2VyaWQsIHBvcGRfc3RhcnR0
bHNfZG9uZSA/ICIrVExTIiA6ICIiLCAKIAkgICAgICAgcmVwbHkgPyByZXBseSA6ICIiKTsKIAot
CXBsYWludGV4dGxvZ2lucGF1c2UgPSBjb25maWdfZ2V0aW50KCJwbGFpbnRleHRsb2dpbnBhdXNl
IiwgMCk7CisJcGxhaW50ZXh0bG9naW5wYXVzZSA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9QTEFJ
TlRFWFRMT0dJTlBBVVNFKTsKIAlpZiAocGxhaW50ZXh0bG9naW5wYXVzZSkgc2xlZXAocGxhaW50
ZXh0bG9naW5wYXVzZSk7CiAgICAgfQogCkBAIC05MTEsOCArOTA0LDggQEAKIHZvaWQKIGNtZF9j
YXBhKCkKIHsKLSAgICBpbnQgbWlucG9sbCA9IGNvbmZpZ19nZXRpbnQoInBvcG1pbnBvbGwiLCAw
KSAqIDYwOwotICAgIGludCBleHBpcmUgPSBjb25maWdfZ2V0aW50KCJwb3BleHBpcmV0aW1lIiwg
LTEpOworICAgIGludCBtaW5wb2xsID0gY29uZmlnX2dldGludChJTUFQT1BUX1BPUE1JTlBPTEwp
ICogNjA7CisgICAgaW50IGV4cGlyZSA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9QT1BFWFBJUkVU
SU1FKTsKICAgICB1bnNpZ25lZCBtZWNoY291bnQ7CiAgICAgY29uc3QgY2hhciAqbWVjaGxpc3Q7
CiAKQEAgLTkyNyw3ICs5MjAsNyBAQAogCXByb3Rfd3JpdGUocG9wZF9vdXQsIG1lY2hsaXN0LCBz
dHJsZW4obWVjaGxpc3QpKTsKICAgICB9CiAKLSAgICBpZiAodGxzX2VuYWJsZWQoInBvcDMiKSkg
eworICAgIGlmICh0bHNfZW5hYmxlZCgpKSB7CiAJcHJvdF9wcmludGYocG9wZF9vdXQsICJTVExT
XHJcbiIpOwogICAgIH0KICAgICBpZiAoZXhwaXJlIDwgMCkgewpAQCAtOTQzLDcgKzkzNiw3IEBA
CiAgICAgcHJvdF9wcmludGYocG9wZF9vdXQsICJSRVNQLUNPREVTXHJcbiIpOwogICAgIHByb3Rf
cHJpbnRmKHBvcGRfb3V0LCAiQVVUSC1SRVNQLUNPREVcclxuIik7CiAKLSAgICBpZiAoa2ZsYWcg
fHwgcG9wZF9zdGFydHRsc19kb25lIHx8IGNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0
IiwgMSkpIHsKKyAgICBpZiAoa2ZsYWcgfHwgcG9wZF9zdGFydHRsc19kb25lIHx8IGNvbmZpZ19n
ZXRzd2l0Y2goSU1BUE9QVF9BTExPV1BMQUlOVEVYVCkpIHsKIAlwcm90X3ByaW50Zihwb3BkX291
dCwgIlVTRVJcclxuIik7CiAgICAgfQogICAgIApAQCAtMTE0OCw2ICsxMTQxLDUyIEBACiAJCQkJ
CSBjb25zdCBjaGFyICpwYXNzd29yZCk7CiBleHRlcm4gdm9pZCBmcmVlX2NhbGxiYWNrcyhzYXNs
X2NhbGxiYWNrX3QgKmluKTsKIAorc3RhdGljIGNoYXIgKnBhcnNlbWVjaGxpc3QoY2hhciAqc3Ry
KQoreworICBjaGFyICp0bXA7CisgIGNoYXIgKnJldD1tYWxsb2Moc3RybGVuKHN0cikrMSk7Cisg
IGlmIChyZXQ9PU5VTEwpIHJldHVybiBOVUxMOworCisgIHN0cmNweShyZXQsIiIpOworCisgIGlm
ICgodG1wPXN0cnN0cihzdHIsIlNBU0wgIikpIT1OVUxMKQorICB7CisgICAgY2hhciAqZW5kPXRt
cCs1OworICAgIHRtcCs9NTsKKworICAgIHdoaWxlKCgoKmVuZCkhPSdcbicpICYmICgoKmVuZCkh
PSdcMCcpKQorICAgICAgZW5kKys7CisKKyAgICAoKmVuZCk9J1wwJzsKKworICAgIHN0cmNweShy
ZXQsIHRtcCk7CisgIH0KKworICByZXR1cm4gcmV0OworfQorCitzdGF0aWMgY2hhciAqYXNrX2Nh
cGFiaWxpdHkoc3RydWN0IHByb3RzdHJlYW0gKnBvdXQsIHN0cnVjdCBwcm90c3RyZWFtICpwaW4p
Cit7CisgIGNoYXIgc3RyWzEwMjRdOworICBjaGFyICpyZXQgPSBOVUxMOworCisgIC8qIHJlcXVl
c3QgY2FwYWJpbGl0aWVzIG9mIHNlcnZlciAqLworICBwcm90X3ByaW50Zihwb3V0LCAiQ0FQQVxy
XG4iKTsKKyAgcHJvdF9mbHVzaChwb3V0KTsKKworICBkbyB7CisgICAgICBpZiAocHJvdF9mZ2V0
cyhzdHIsc2l6ZW9mKHN0cikscGluKSA9PSBOVUxMKSB7CisJICByZXR1cm4gTlVMTDsKKyAgICAg
IH0KKyAgICAgIHByaW50ZigiUzogJXMiLCBzdHIpOworICAgICAgaWYgKCFzdHJuY2FzZWNtcChz
dHIsIlNBU0wgIiw1KSkgeworCSAgcmV0PXBhcnNlbWVjaGxpc3Qoc3RyKTsKKyAgICAgIH0KKyAg
fSB3aGlsZSAoc3RybmNhc2VjbXAoc3RyLCAiLiIsIDEpKTsKKworICByZXR1cm4gcmV0OworfQor
CiBzdGF0aWMgaW50IHByb3h5X2F1dGhlbnRpY2F0ZShjb25zdCBjaGFyICpob3N0bmFtZSkKIHsK
ICAgICBpbnQgcjsKQEAgLTExNjEsNyArMTIwMCw4IEBACiAgICAgY2hhciAqaW4sICpwOwogICAg
IGNvbnN0IGNoYXIgKm91dDsKICAgICB1bnNpZ25lZCBpbnQgaW5sZW4sIG91dGxlbjsKLSAgICBj
b25zdCBjaGFyICptZWNodXNpbmc7CisgICAgY29uc3QgY2hhciAqbWVjaF9jb25mLCAqbWVjaHVz
aW5nOworICAgIGNoYXIgKm1lY2hsaXN0OwogICAgIHVuc2lnbmVkIGI2NGxlbjsKICAgICBjaGFy
IGxvY2FsaXBbNjBdLCByZW1vdGVpcFs2MF07CiAgICAgY29uc3QgY2hhciAqcGFzczsKQEAgLTEx
NzAsMTAgKzEyMTAsMTEgQEAKICAgICBwID0gc3RyY2hyKG9wdHN0ciwgJy4nKTsKICAgICBpZiAo
cCkgKnAgPSAnXDAnOwogICAgIHN0cmNhdChvcHRzdHIsICJfcGFzc3dvcmQiKTsKLSAgICBwYXNz
ID0gY29uZmlnX2dldHN0cmluZyhvcHRzdHIsIE5VTEwpOworICAgIHBhc3MgPSBjb25maWdfZ2V0
b3ZlcmZsb3dzdHJpbmcob3B0c3RyLCBOVUxMKTsKKyAgICBpZighcGFzcykgcGFzcyA9IGNvbmZp
Z19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9QQVNTV09SRCk7CiAgICAgY2IgPSBteXNhc2xfY2Fs
bGJhY2tzKHBvcGRfdXNlcmlkLCAKLQkJCSAgY29uZmlnX2dldHN0cmluZygicHJveHlfYXV0aG5h
bWUiLCAicHJveHkiKSwKLQkJCSAgY29uZmlnX2dldHN0cmluZygicHJveHlfcmVhbG0iLCBOVUxM
KSwKKwkJCSAgY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1BST1hZX0FVVEhOQU1FKSwKKwkJCSAg
Y29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1BST1hZX1JFQUxNKSwKIAkJCSAgcGFzcyk7CiAKICAg
ICByID0gc2FzbF9jbGllbnRfbmV3KCJwb3AiLCBob3N0bmFtZSwgTlVMTCwgTlVMTCwKQEAgLTEy
MTMsMTUgKzEyNTQsMzAgQEAKIAlyZXR1cm4gU0FTTF9GQUlMOwogICAgIH0KIAorICAgIC8qIEdl
dCBTQVNMIG1lY2hhbmlzbSBsaXN0ICovCisgICAgLyogV2UgY2FuIGZvcmNlIGEgcGFydGljdWxh
ciBtZWNoYW5pc20gdXNpbmcgYSA8c2hvcnRob3N0Pl9tZWNocyBvcHRpb24gKi8KICAgICBzdHJj
cHkoYnVmLCBob3N0bmFtZSk7CiAgICAgcCA9IHN0cmNocihidWYsICcuJyk7CiAgICAgKnAgPSAn
XDAnOwogICAgIHN0cmNhdChidWYsICJfbWVjaHMiKTsKKyAgICBtZWNoX2NvbmYgPSBjb25maWdf
Z2V0b3ZlcmZsb3dzdHJpbmcoYnVmLCBOVUxMKTsKKyAgICAKKyAgICAvKiBJZiB3ZSBkb24ndCBo
YXZlIGEgbWVjaF9jb25mLCBhc2sgdGhlIHNlcnZlciB3aGF0IGl0IGNhbiBkbyAqLworICAgIGlm
KCFtZWNoX2NvbmYpIHsKKwltZWNobGlzdCA9IGFza19jYXBhYmlsaXR5KGJhY2tlbmRfb3V0LCBi
YWNrZW5kX2luKTsKKyAgICB9IGVsc2UgeworCW1lY2hsaXN0ID0geHN0cmR1cChtZWNoX2NvbmYp
OworICAgIH0KIAogICAgIC8qIHdlIG5vdyBkbyB0aGUgYWN0dWFsIFNBU0wgZXhjaGFuZ2UgKi8K
ICAgICByID0gc2FzbF9jbGllbnRfc3RhcnQoYmFja2VuZF9zYXNsY29ubiwgCi0JCQkgIGNvbmZp
Z19nZXRzdHJpbmcoYnVmLCAiS0VSQkVST1NfVjQiKSwKKwkJCSAgbWVjaGxpc3QsCiAJCQkgIE5V
TEwsICZvdXQsICZvdXRsZW4sICZtZWNodXNpbmcpOworCisgICAgLyogZ2FyYmFnZSBjb2xsZWN0
ICovCisgICAgZnJlZShtZWNobGlzdCk7CisgICAgbWVjaGxpc3QgPSBOVUxMOworCiAgICAgaWYg
KChyICE9IFNBU0xfT0spICYmIChyICE9IFNBU0xfQ09OVElOVUUpKSB7CiAJcmV0dXJuIHI7CiAg
ICAgfQpJbmRleDogaW1hcC9wcm94eWQuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJl
dy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvcHJveHlkLmMsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuMTI5CmRpZmYgLXUgLXIxLjEyOSBwcm94eWQuYwotLS0gcHJveHlkLmMJMjAw
Mi8wNi8xNCAxODoxODozNAkxLjEyOQorKysgcHJveHlkLmMJMjAwMi8wNi8xOCAyMzo0Njo0NApA
QCAtNjQxLDcgKzY0MSw3IEBACiAJCSAgICAgaW50IGZvcl9maW5kKSAKIHsKICAgICBpbnQgdGFn
bGVuID0gc3RybGVuKHRhZyk7Ci0gICAgaW50IGksYzsKKyAgICBpbnQgYzsKICAgICBpbnQgciA9
IFBST1hZX09LOwogICAgIGludCBleGlzdF9yOwogICAgIGNoYXIgbWFpbGJveG5hbWVbTUFYX01B
SUxCT1hfUEFUSCArIDFdOwpAQCAtMTA3MSw3ICsxMDcxLDcgQEAKICAgICAvKiBjaGVjayBpZiBy
ZW1vdGUgcmVhbG0gKi8KICAgICBpZiAoKHJlYWxtID0gc3RyY2hyKGF1dGhfaWRlbnRpdHksICdA
JykpIT1OVUxMKSB7CiAJcmVhbG0rKzsKLQl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJl
YWxtcyIsICIiKTsKKwl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMp
OwogCXdoaWxlICgqdmFsKSB7CiAJICAgIGlmICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3Ry
bGVuKHJlYWxtKSkgJiYKIAkJKCF2YWxbc3RybGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2
YWxbc3RybGVuKHJlYWxtKV0pKSkgewpAQCAtMTA5MSwxNiArMTA5MSwxNiBAQAogICAgIHByb3h5
ZF9hdXRoc3RhdGUgPSBhdXRoX25ld3N0YXRlKGF1dGhfaWRlbnRpdHksIE5VTEwpOwogCiAgICAg
Lyogb2ssIGlzIGF1dGhfaWRlbnRpdHkgYW4gYWRtaW4/ICovCi0gICAgcHJveHlkX3VzZXJpc2Fk
bWluID0gYXV0aGlzYShwcm94eWRfYXV0aHN0YXRlLCAiaW1hcCIsICJhZG1pbnMiKTsKKyAgICBw
cm94eWRfdXNlcmlzYWRtaW4gPSBjb25maWdfYXV0aGlzYShwcm94eWRfYXV0aHN0YXRlLCBJTUFQ
T1BUX0FETUlOUyk7CiAKICAgICBpZiAoc3RyY21wKGF1dGhfaWRlbnRpdHksIHJlcXVlc3RlZF91
c2VyKSkgewogCS8qIHdlIHdhbnQgdG8gYXV0aGVudGljYXRlIGFzIGEgZGlmZmVyZW50IHVzZXI7
IHdlJ2xsIGFsbG93IHRoaXMKIAkgICBpZiB3ZSdyZSBhbiBhZG1pbiBvciBpZiB3ZSd2ZSBhbGxv
d2VkIEFDTCBwcm94eSBsb2dpbnMgKi8KLQlpbnQgdXNlX2FjbCA9IGNvbmZpZ19nZXRzd2l0Y2go
ImxvZ2ludXNlYWNsIiwgMCk7CisJaW50IHVzZV9hY2wgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBP
UFRfTE9HSU5VU0VBQ0wpOwogCiAJaWYgKHByb3h5ZF91c2VyaXNhZG1pbiB8fAogCSAgICAodXNl
X2FjbCAmJiBhY2xfb2socmVxdWVzdGVkX3VzZXIsIGF1dGhfaWRlbnRpdHkpKSB8fAotCSAgICBh
dXRoaXNhKHByb3h5ZF9hdXRoc3RhdGUsICJpbWFwIiwgInByb3h5c2VydmVycyIpKSB7CisJICAg
IGNvbmZpZ19hdXRoaXNhKHByb3h5ZF9hdXRoc3RhdGUsIElNQVBPUFRfUFJPWFlTRVJWRVJTKSkg
ewogCSAgICAvKiBwcm94eSBvayEgKi8KIAogCSAgICBwcm94eWRfdXNlcmlzYWRtaW4gPSAwOwkv
KiBubyBsb25nZXIgYWRtaW4gKi8KQEAgLTExNDAsNyArMTE0MCw2IEBACiAgICAgaW50IG9wdDsK
ICAgICBpbnQgcjsKIAotICAgIGNvbmZpZ19jaGFuZ2VpZGVudCgicHJveHlkIik7CiAgICAgaWYg
KGdldGV1aWQoKSA9PSAwKSBmYXRhbCgibXVzdCBydW4gYXMgdGhlIEN5cnVzIHVzZXIiLCBFQ19V
U0FHRSk7CiAgICAgc2V0cHJvY3RpdGxlX2luaXQoYXJnYywgYXJndiwgZW52cCk7CiAKQEAgLTEx
ODAsNyArMTE3OSw3IEBACiAgCSAgICBicmVhazsKIAljYXNlICdzJzogLyogaW1hcHMgKGRvIHN0
YXJ0dGxzIHJpZ2h0IGF3YXkpICovCiAJICAgIGltYXBzID0gMTsKLQkgICAgaWYgKCF0bHNfZW5h
YmxlZCgiaW1hcCIpKSB7CisJICAgIGlmICghdGxzX2VuYWJsZWQoKSkgewogCQlzeXNsb2coTE9H
X0VSUiwgImltYXBzOiByZXF1aXJlZCBPcGVuU1NMIG9wdGlvbnMgbm90IHByZXNlbnQiKTsKIAkJ
ZmF0YWwoImltYXBzOiByZXF1aXJlZCBPcGVuU1NMIG9wdGlvbnMgbm90IHByZXNlbnQiLAogCQkg
ICAgICBFQ19DT05GSUcpOwpAQCAtMTM0OSw3ICsxMzQ4LDcgQEAKICAgICBwcm9jX3JlZ2lzdGVy
KCJwcm94eWQiLCBwcm94eWRfY2xpZW50aG9zdCwgKGNoYXIgKikwLCAoY2hhciAqKTApOwogCiAg
ICAgLyogU2V0IGluYWN0aXZpdHkgdGltZXIgKi8KLSAgICB0aW1lb3V0ID0gY29uZmlnX2dldGlu
dCgidGltZW91dCIsIDMwKTsKKyAgICB0aW1lb3V0ID0gY29uZmlnX2dldGludChJTUFQT1BUX1RJ
TUVPVVQpOwogICAgIGlmICh0aW1lb3V0IDwgMzApIHRpbWVvdXQgPSAzMDsKICAgICBwcm90X3Nl
dHRpbWVvdXQocHJveHlkX2luLCB0aW1lb3V0KjYwKTsKICAgICBwcm90X3NldGZsdXNob25yZWFk
KHByb3h5ZF9pbiwgcHJveHlkX291dCk7CkBAIC0xOTI4LDcgKzE5MjcsNyBAQAogCSAgICAKIAlj
YXNlICdTJzoKIAkgICAgaWYgKCFzdHJjbXAoY21kLnMsICJTdGFydHRscyIpKSB7Ci0JCWlmICgh
dGxzX2VuYWJsZWQoImltYXAiKSkgeworCQlpZiAoIXRsc19lbmFibGVkKCkpIHsKIAkJICAgIC8q
IHdlIGRvbid0IHN1cHBvcnQgc3RhcnR0bHMgKi8KIAkJICAgIGdvdG8gYmFkY21kOwogCQl9CkBA
IC0yMjA0LDcgKzIyMDMsNyBAQAogCiAgICAgLyogcG9zc2libHkgZGlzYWxsb3cgbG9naW4gKi8K
ICAgICBpZiAoKHByb3h5ZF9zdGFydHRsc19kb25lID09IDApICYmCi0JKGNvbmZpZ19nZXRzd2l0
Y2goImFsbG93cGxhaW50ZXh0IiwgMSkgPT0gMCkgJiYKKwkoY29uZmlnX2dldHN3aXRjaChJTUFQ
T1BUX0FMTE9XUExBSU5URVhUKSA9PSAwKSAmJgogCXN0cmNtcChjYW5vbl91c2VyLCAiYW5vbnlt
b3VzIikgIT0gMCkgewogCWVhdGxpbmUocHJveHlkX2luLCAnICcpOwogCXByb3RfcHJpbnRmKHBy
b3h5ZF9vdXQsICIlcyBOTyBMb2dpbiBvbmx5IGF2YWlsYWJsZSB1bmRlciBhIGxheWVyXHJcbiIs
CkBAIC0yMjI4LDcgKzIyMjcsNyBAQAogICAgIHBhc3N3ZCA9IHBhc3N3ZGJ1Zi5zOwogCiAgICAg
aWYgKCFzdHJjbXAoY2Fub25fdXNlciwgImFub255bW91cyIpKSB7Ci0JaWYgKGNvbmZpZ19nZXRz
d2l0Y2goImFsbG93YW5vbnltb3VzbG9naW4iLCAwKSkgeworCWlmIChjb25maWdfZ2V0c3dpdGNo
KElNQVBPUFRfQUxMT1dBTk9OWU1PVVNMT0dJTikpIHsKIAkgICAgcGFzc3dkID0gYmVhdXRpZnlf
c3RyaW5nKHBhc3N3ZCk7CiAJICAgIGlmIChzdHJsZW4ocGFzc3dkKSA+IDUwMCkgcGFzc3dkWzUw
MF0gPSAnXDAnOwogCSAgICBzeXNsb2coTE9HX05PVElDRSwgImxvZ2luOiAlcyBhbm9ueW1vdXMg
JXMiLApAQCAtMjI3NCw3ICsyMjczLDcgQEAKIAkgICAgICAgY2Fub25fdXNlciwgcHJveHlkX3N0
YXJ0dGxzX2RvbmUgPyAiK1RMUyIgOiAiIiwgCiAJICAgICAgIHJlcGx5ID8gcmVwbHkgOiAiIik7
CiAKLQlwbGFpbnRleHRsb2dpbnBhdXNlID0gY29uZmlnX2dldGludCgicGxhaW50ZXh0bG9naW5w
YXVzZSIsIDApOworCXBsYWludGV4dGxvZ2lucGF1c2UgPSBjb25maWdfZ2V0aW50KElNQVBPUFRf
UExBSU5URVhUTE9HSU5QQVVTRSk7CiAJaWYgKHBsYWludGV4dGxvZ2lucGF1c2UpIHsKIAogCSAg
ICAvKiBBcHBseSBwZW5hbHR5IG9ubHkgaWYgbm90IHVuZGVyIGxheWVyICovCkBAIC0yMjg2LDcg
KzIyODUsNyBAQAogCiAgICAgcHJveHlkX2F1dGhzdGF0ZSA9IGF1dGhfbmV3c3RhdGUoY2Fub25f
dXNlciwgKGNoYXIgKikwKTsKIAotICAgIHZhbCA9IGNvbmZpZ19nZXRzdHJpbmcoImFkbWlucyIs
ICIiKTsKKyAgICB2YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQURNSU5TKTsKICAgICB3
aGlsZSAoKnZhbCkgewogCWZvciAocCA9IChjaGFyICopdmFsOyAqcCAmJiAhaXNzcGFjZSgoaW50
KSAqcCk7IHArKyk7CiAJc3RybGNweShidWYsIHZhbCwgcCAtIHZhbCk7CkBAIC0yNjE4LDcgKzI2
MTcsNyBAQAogCiAgICAgLyogc3BpdCBvdXQgb3VyIElEIHN0cmluZy4KICAgICAgICBldmVudHVh
bGx5IHRoaXMgbWlnaHQgYmUgY29uZmlndXJhYmxlLiAqLwotICAgIGlmIChjb25maWdfZ2V0c3dp
dGNoKCJpbWFwaWRyZXNwb25zZSIsIDEpKSB7CisgICAgaWYgKGNvbmZpZ19nZXRzd2l0Y2goSU1B
UE9QVF9JTUFQSURSRVNQT05TRSkpIHsKIAlpZF9yZXNwb25zZShwcm94eWRfb3V0KTsKIAogCS8q
IGFkZCBpbmZvIGFib3V0IHRoZSBiYWNrZW5kICovCkBAIC0yNjgyLDcgKzI2ODEsNyBAQAogCiAg
ICAgLyogZ2V0IHBvbGxpbmcgcGVyaW9kICovCiAgICAgaWYgKGlkbGVfcGVyaW9kID09IC0xKSB7
Ci0gICAgICBpZGxlX3BlcmlvZCA9IGNvbmZpZ19nZXRpbnQoImltYXBpZGxlcG9sbCIsIDYwKTsK
KyAgICAgIGlkbGVfcGVyaW9kID0gY29uZmlnX2dldGludChJTUFQT1BUX0lNQVBJRExFUE9MTCkp
OwogICAgICAgaWYgKGlkbGVfcGVyaW9kIDwgMSkgaWRsZV9wZXJpb2QgPSAxOwogICAgIH0KIApA
QCAtMjg4NCwxMCArMjg4MywxMCBAQAogICAgIHByb3RfcHJpbnRmKHByb3h5ZF9vdXQsICIgSURM
RSIpOwogI2VuZGlmCiAKLSAgICBpZiAodGxzX2VuYWJsZWQoImltYXAiKSkgeworICAgIGlmICh0
bHNfZW5hYmxlZCgpKSB7CiAJcHJvdF9wcmludGYocHJveHlkX291dCwgIiBTVEFSVFRMUyIpOwog
ICAgIH0KLSAgICBpZiAoIXByb3h5ZF9zdGFydHRsc19kb25lICYmICFjb25maWdfZ2V0c3dpdGNo
KCJhbGxvd3BsYWludGV4dCIsIDEpKSB7CisgICAgaWYgKCFwcm94eWRfc3RhcnR0bHNfZG9uZSAm
JiAhY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhUKSkgewogCXByb3RfcHJp
bnRmKHByb3h5ZF9vdXQsICIgTE9HSU5ESVNBQkxFRCIpOwkKICAgICB9CiAKQEAgLTM5NTAsNyAr
Mzk0OSw3IEBACiAgICAgLyogSWdub3JlIHRoZSByZWZlcmVuY2UgYXJndW1lbnQ/CiAgICAgICAg
KHRoZSBiZWhhdmlvciBpbiAxLjUuMTAgJiBvbGRlcikgKi8KICAgICBpZiAoaWdub3JlcmVmZXJl
bmNlID09IC0xKSB7Ci0JaWdub3JlcmVmZXJlbmNlID0gY29uZmlnX2dldHN3aXRjaCgiaWdub3Jl
cmVmZXJlbmNlIiwgMCk7CisJaWdub3JlcmVmZXJlbmNlID0gY29uZmlnX2dldHN3aXRjaChJTUFQ
T1BUX0lHTk9SRVJFRkVSRU5DRSk7CiAgICAgfQogCiAgICAgLyogUmVzZXQgc3RhdGUgaW4gbXN0
cmluZ2RhdGEgKi8KQEAgLTQ2MzYsNyArNDYzNSw3IEBACiAKICAgICBpZiAoIXIpIHIgPSBtbG9v
a3VwKG1haWxib3huYW1lLCAmc2VydmVyLCBOVUxMLCBOVUxMKTsKICAgICBpZiAoIXIgJiYgc3Vw
cG9ydHNfcmVmZXJyYWxzCi0JJiYgY29uZmlnX2dldHN3aXRjaCgicHJveHlkX2FsbG93X3N0YXR1
c19yZWZlcnJhbCIsMCkpIHsgCisJJiYgY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX1BST1hZRF9B
TExPV19TVEFUVVNfUkVGRVJSQUwpKSB7IAogCXByb3h5ZF9yZWZlcih0YWcsIHNlcnZlciwgbWFp
bGJveG5hbWUpOwogCS8qIEVhdCB0aGUgYXJndW1lbnQgKi8KIAllYXRsaW5lKHByb3h5ZF9pbiwg
cHJvdF9nZXRjKHByb3h5ZF9pbikpOwpAQCAtNDY4MSw4ICs0NjgwLDcgQEAKICAgICBjb25zdCBj
aGFyICp1cmw7CiAgICAgLyogc28gdGVtcHRpbmcsIGFuZCB5ZXQgLi4uICovCiAgICAgLyogdXJs
ID0gImh0dHA6Ly9yYW5kb20ueWFob28uY29tL3J5bC8iOyAqLwotICAgIHVybCA9IGNvbmZpZ19n
ZXRzdHJpbmcoIm5ldHNjYXBldXJsIiwKLQkJCSAgICJodHRwOi8vYW5kcmV3Mi5hbmRyZXcuY211
LmVkdS9jeXJ1cy9pbWFwZC9uZXRzY2FwZS1hZG1pbi5odG1sIik7CisgICAgdXJsID0gY29uZmln
X2dldHN0cmluZyhJTUFQT1BUX05FVFNDQVBFVVJMKTsKIAogICAgIC8qIEkgb25seSBrbm93IG9m
IHRocmVlIHRoaW5ncyB0byByZXBseSB3aXRoOiAqLwogICAgIHByb3RfcHJpbnRmKHByb3h5ZF9v
dXQsCkluZGV4OiBpbWFwL3Rscy5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNt
dS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC90bHMuYyx2CnJldHJpZXZpbmcgcmV2aXNp
b24gMS4zOApkaWZmIC11IC1yMS4zOCB0bHMuYwotLS0gdGxzLmMJMjAwMi8wNi8wMyAxNjo1OTo1
NwkxLjM4CisrKyB0bHMuYwkyMDAyLzA2LzE4IDIwOjU0OjM2CkBAIC0xNDgsMTkgKzE0OCwxNCBA
QAogc3RhdGljIGludCBkb19kdW1wID0gMDsJCS8qIGFjdGl2ZWx5IGR1bXBpbmcgcHJvdG9jb2w/
ICovCiAKIAotaW50IHRsc19lbmFibGVkKGNvbnN0IGNoYXIgKmlkZW50KQoraW50IHRsc19lbmFi
bGVkKHZvaWQpCiB7Ci0gICAgY2hhciBidWZbNTBdOwogICAgIGNvbnN0IGNoYXIgKnZhbDsKIAot
ICAgIHNwcmludGYoYnVmLCAidGxzXyVzX2NlcnRfZmlsZSIsIGlkZW50KTsKLSAgICB2YWwgPSBj
b25maWdfZ2V0c3RyaW5nKGJ1ZiwKLQkJCSAgIGNvbmZpZ19nZXRzdHJpbmcoInRsc19jZXJ0X2Zp
bGUiLCBOVUxMKSk7CisgICAgdmFsID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1RMU19DRVJU
X0ZJTEUpOwogICAgIGlmICghdmFsIHx8ICFzdHJjYXNlY21wKHZhbCwgImRpc2FibGVkIikpIHJl
dHVybiAwOwogCi0gICAgc3ByaW50ZihidWYsICJ0bHNfJXNfa2V5X2ZpbGUiLCBpZGVudCk7Ci0g
ICAgdmFsID0gY29uZmlnX2dldHN0cmluZyhidWYsCi0JCQkgICBjb25maWdfZ2V0c3RyaW5nKCJ0
bHNfa2V5X2ZpbGUiLCBOVUxMKSk7CisgICAgdmFsID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BU
X1RMU19LRVlfRklMRSk7CiAgICAgaWYgKCF2YWwgfHwgIXN0cmNhc2VjbXAodmFsLCAiZGlzYWJs
ZWQiKSkgcmV0dXJuIDA7CiAKICAgICByZXR1cm4gMTsKQEAgLTIwOSw3ICsyMDQsOSBAQAogCiAv
KiB0YWtlbiBmcm9tIE9wZW5TU0wgYXBwcy9zX2NiLmMgKi8KIAotc3RhdGljIFJTQSAqdG1wX3Jz
YV9jYihTU0wgKiBzLCBpbnQgZXhwb3J0LCBpbnQga2V5bGVuZ3RoKQorc3RhdGljIFJTQSAqdG1w
X3JzYV9jYihTU0wgKiBzIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAorCQkgICAgICAgaW50IGV4
cG9ydCBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKwkJICAgICAgIGludCBrZXlsZW5ndGgpCiB7
CiAgICAgc3RhdGljIFJTQSAqcnNhX3RtcCA9IE5VTEw7CiAKQEAgLTM4Myw3ICszODAsOCBAQAog
ICogbmVnb3RpYXRlZCBhbmQgc2Vzc2lvbiBjYWNoaW5nIGlzIGVuYWJsZWQuICBXZSBzYXZlIHRo
ZSBzZXNzaW9uIGluCiAgKiBhIGRhdGFiYXNlIHNvIHRoYXQgd2UgY2FuIHNoYXJlIHNlc3Npb25z
IGJldHdlZW4gcHJvY2Vzc2VzLiAKICAqLyAKLXN0YXRpYyBpbnQgbmV3X3Nlc3Npb25fY2IoU1NM
ICpzc2wsIFNTTF9TRVNTSU9OICpzZXNzKQorc3RhdGljIGludCBuZXdfc2Vzc2lvbl9jYihTU0wg
KnNzbCBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKwkJCSAgU1NMX1NFU1NJT04gKnNlc3MpCiB7
CiAgICAgaW50IGxlbjsKICAgICB1bnNpZ25lZCBjaGFyICpkYXRhID0gTlVMTCwgKmFzbjsKQEAg
LTQ3MSw3ICs0NjksOCBAQAogICogcmVtb3ZlZCBiZWNhdXNlIGl0IGlzIGV4cGlyZWQgb3Igd2hl
biBhIGNvbm5lY3Rpb24gd2FzIG5vdCBzaHV0ZG93bgogICogY2xlYW5seS4KICAqLwotc3RhdGlj
IHZvaWQgcmVtb3ZlX3Nlc3Npb25fY2IoU1NMX0NUWCAqY3R4LCBTU0xfU0VTU0lPTiAqc2VzcykK
K3N0YXRpYyB2b2lkIHJlbW92ZV9zZXNzaW9uX2NiKFNTTF9DVFggKmN0eCBfX2F0dHJpYnV0ZV9f
KCh1bnVzZWQpKSwKKwkJCSAgICAgIFNTTF9TRVNTSU9OICpzZXNzKQogewogICAgIGFzc2VydChz
ZXNzKTsKIApAQCAtNDg0LDcgKzQ4Myw4IEBACiAgKiBjYWxsZWQsIGFsc28gd2hlbiBzZXNzaW9u
IGNhY2hpbmcgd2FzIGRpc2FibGVkLiAgV2UgbG9va3VwIHRoZQogICogc2Vzc2lvbiBpbiBvdXIg
ZGF0YWJhc2UgaW4gY2FzZSBpdCB3YXMgc3RvcmVkIGJ5IGFub3RoZXIgcHJvY2Vzcy4KICAqLwot
c3RhdGljIFNTTF9TRVNTSU9OICpnZXRfc2Vzc2lvbl9jYihTU0wgKnNzbCwgdW5zaWduZWQgY2hh
ciAqaWQsIGludCBpZGxlbiwKK3N0YXRpYyBTU0xfU0VTU0lPTiAqZ2V0X3Nlc3Npb25fY2IoU1NM
ICpzc2wgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisJCQkJICAgdW5zaWduZWQgY2hhciAqaWQs
IGludCBpZGxlbiwKIAkJCQkgICBpbnQgKmNvcHkpCiB7CiAgICAgaW50IHJldDsKQEAgLTU2Niw3
ICs1NjYsNiBAQAogewogICAgIGludCAgICAgb2ZmID0gMDsKICAgICBpbnQgICAgIHZlcmlmeV9m
bGFncyA9IFNTTF9WRVJJRllfTk9ORTsKLSAgICBjaGFyICAgIGJ1Zls1MF07CiAgICAgY29uc3Qg
Y2hhciAgICpjaXBoZXJfbGlzdDsKICAgICBjb25zdCBjaGFyICAgKkNBcGF0aDsKICAgICBjb25z
dCBjaGFyICAgKkNBZmlsZTsKQEAgLTYxOCw3ICs2MTcsNyBAQAogCQkJCSAgIFNTTF9TRVNTX0NB
Q0hFX05PX0lOVEVSTkFMX0xPT0tVUCk7CiAKICAgICAvKiBHZXQgdGhlIHNlc3Npb24gdGltZW91
dCBmcm9tIHRoZSBjb25maWcgZmlsZSAoaW4gbWludXRlcykgKi8KLSAgICB0aW1lb3V0ID0gY29u
ZmlnX2dldGludCgidGxzX3Nlc3Npb25fdGltZW91dCIsIDE0NDApOyAvKiAyNCBob3VycyAqLwor
ICAgIHRpbWVvdXQgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfVExTX1NFU1NJT05fVElNRU9VVCk7
CiAgICAgaWYgKHRpbWVvdXQgPCAwKSB0aW1lb3V0ID0gMDsKICAgICBpZiAodGltZW91dCA+IDE0
NDApIHRpbWVvdXQgPSAxNDQwOyAvKiAyNCBob3VycyBtYXggKi8KIApAQCAtNjQ0LDggKzY0Myw3
IEBACiAJciA9IERCLT5pbml0KGRiZGlyLCAwKTsKIAogCWlmIChyICE9IDApCi0JICAgIHN5c2xv
ZyhMT0dfRVJSLCAiREJFUlJPUjogaW5pdCAlczogJXMiLCBidWYsCi0JCSAgIGN5cnVzZGJfc3Ry
ZXJyb3IocikpOworCSAgICBzeXNsb2coTE9HX0VSUiwgIkRCRVJST1I6IGluaXQ6ICVzIiwgY3ly
dXNkYl9zdHJlcnJvcihyKSk7CiAJZWxzZSB7CiAJICAgIC8qIGNyZWF0ZSB0aGUgbmFtZSBvZiB0
aGUgZGIgZmlsZSAqLwogCSAgICBzdHJjcHkoZGJkaXIsIGNvbmZpZ19kaXIpOwpAQCAtNjYxLDE1
ICs2NTksMTUgQEAKIAl9CiAgICAgfQogCi0gICAgY2lwaGVyX2xpc3QgPSBjb25maWdfZ2V0c3Ry
aW5nKCJ0bHNfY2lwaGVyX2xpc3QiLCAiREVGQVVMVCIpOworICAgIGNpcGhlcl9saXN0ID0gY29u
ZmlnX2dldHN0cmluZyhJTUFQT1BUX1RMU19DSVBIRVJfTElTVCk7CiAgICAgaWYgKCFTU0xfQ1RY
X3NldF9jaXBoZXJfbGlzdChjdHgsIGNpcGhlcl9saXN0KSkgewogCXN5c2xvZyhMT0dfRVJSLCJU
TFMgZW5naW5lOiBjYW5ub3QgbG9hZCBjaXBoZXIgbGlzdCAnJXMnIiwKIAkgICAgICAgY2lwaGVy
X2xpc3QpOwogCXJldHVybiAoLTEpOwogICAgIH0KIAotICAgIENBZmlsZSA9IGNvbmZpZ19nZXRz
dHJpbmcoInRsc19jYV9maWxlIiwgTlVMTCk7Ci0gICAgQ0FwYXRoID0gY29uZmlnX2dldHN0cmlu
ZygidGxzX2NhX3BhdGgiLCBOVUxMKTsKKyAgICBDQWZpbGUgPSBjb25maWdfZ2V0c3RyaW5nKElN
QVBPUFRfVExTX0NBX0ZJTEUpOworICAgIENBcGF0aCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9Q
VF9UTFNfQ0FfUEFUSCk7CiAKICAgICBpZiAoKCFTU0xfQ1RYX2xvYWRfdmVyaWZ5X2xvY2F0aW9u
cyhjdHgsIENBZmlsZSwgQ0FwYXRoKSkgfHwKIAkoIVNTTF9DVFhfc2V0X2RlZmF1bHRfdmVyaWZ5
X3BhdGhzKGN0eCkpKSB7CkBAIC02NzcsMTMgKzY3NSw4IEBACiAJc3lzbG9nKExPR19OT1RJQ0Us
IlRMUyBlbmdpbmU6IGNhbm5vdCBsb2FkIENBIGRhdGEiKTsJCiAgICAgfQogCi0gICAgc3ByaW50
ZihidWYsICJ0bHNfJXNfY2VydF9maWxlIiwgaWRlbnQpOwotICAgIHNfY2VydF9maWxlID0gY29u
ZmlnX2dldHN0cmluZyhidWYsCi0JCQkJICAgY29uZmlnX2dldHN0cmluZygidGxzX2NlcnRfZmls
ZSIsIE5VTEwpKTsKLQotICAgIHNwcmludGYoYnVmLCAidGxzXyVzX2tleV9maWxlIiwgaWRlbnQp
OwotICAgIHNfa2V5X2ZpbGUgPSBjb25maWdfZ2V0c3RyaW5nKGJ1ZiwKLQkJCQkgIGNvbmZpZ19n
ZXRzdHJpbmcoInRsc19rZXlfZmlsZSIsIE5VTEwpKTsKKyAgICBzX2NlcnRfZmlsZSA9IGNvbmZp
Z19nZXRzdHJpbmcoSU1BUE9QVF9UTFNfQ0VSVF9GSUxFKTsKKyAgICBzX2tleV9maWxlID0gY29u
ZmlnX2dldHN0cmluZyhJTUFQT1BUX1RMU19LRVlfRklMRSk7CiAKICAgICBpZiAoIXNldF9jZXJ0
X3N0dWZmKGN0eCwgc19jZXJ0X2ZpbGUsIHNfa2V5X2ZpbGUpKSB7CiAJc3lzbG9nKExPR19FUlIs
IlRMUyBlbmdpbmU6IGNhbm5vdCBsb2FkIGNlcnQva2V5IGRhdGEiKTsKQEAgLTY5NSw5ICs2ODgs
NyBAQAogICAgIGlmIChhc2tjZXJ0IT0wKQogCXZlcmlmeV9mbGFncyB8PSBTU0xfVkVSSUZZX1BF
RVIgfCBTU0xfVkVSSUZZX0NMSUVOVF9PTkNFOwogCi0gICAgc3ByaW50ZihidWYsICJ0bHNfJXNf
cmVxdWlyZV9jZXJ0IiwgaWRlbnQpOwotICAgIHJlcXVpcmVjZXJ0ID0gY29uZmlnX2dldHN3aXRj
aChidWYsCi0JCQkJICAgY29uZmlnX2dldHN3aXRjaCgidGxzX3JlcXVpcmVfY2VydCIsIDApKTsK
KyAgICByZXF1aXJlY2VydCA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9UTFNfUkVRVUlSRV9D
RVJUKTsKICAgICBpZiAocmVxdWlyZWNlcnQpCiAJdmVyaWZ5X2ZsYWdzIHw9IFNTTF9WRVJJRllf
UEVFUiB8IFNTTF9WRVJJRllfRkFJTF9JRl9OT19QRUVSX0NFUlQKIAkgICAgfCBTU0xfVkVSSUZZ
X0NMSUVOVF9PTkNFOwpAQCAtMTA2MSw3ICsxMDUyLDcgQEAKIAogI2Vsc2UKIAotaW50IHRsc19l
bmFibGVkKGNvbnN0IGNoYXIgKmlkZW50KQoraW50IHRsc19lbmFibGVkKHZvaWQpCiB7CiAgICAg
cmV0dXJuIDA7CiB9CkluZGV4OiBpbWFwL3Rscy5oCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMv
YW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC90bHMuaCx2CnJldHJpZXZp
bmcgcmV2aXNpb24gMS4xNQpkaWZmIC11IC1yMS4xNSB0bHMuaAotLS0gdGxzLmgJMjAwMi8wNi8w
MiAxNToyNTo0MwkxLjE1CisrKyB0bHMuaAkyMDAyLzA2LzE4IDIwOjExOjI0CkBAIC00OSw3ICs0
OSw3IEBACiAjZGVmaW5lIElOQ0xVREVEX1RMU19ICiAKIC8qIGlzIHRscyBlbmFibGVkPyAqLwot
aW50IHRsc19lbmFibGVkKGNvbnN0IGNoYXIgKmlkZW50KTsKK2ludCB0bHNfZW5hYmxlZCh2b2lk
KTsKIAogLyogbmFtZSBvZiB0aGUgU1NML1RMUyBzZXNzaW9ucyBkYXRhYmFzZSAqLwogI2RlZmlu
ZSBGTkFNRV9UTFNTRVNTSU9OUyAiL3Rsc19zZXNzaW9ucy5kYiIKSW5kZXg6IGltYXAvdXNlci5j
Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMv
Y3lydXMvaW1hcC91c2VyLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTAKZGlmZiAtdSAtcjEu
MTAgdXNlci5jCi0tLSB1c2VyLmMJMjAwMi8wNS8yMyAyMToxMjozOQkxLjEwCisrKyB1c2VyLmMJ
MjAwMi8wNi8xOCAyMDozOTowNApAQCAtMTIxLDEwICsxMjEsMTAgQEAKICAgICBzdHJ1Y3QgZGly
ZW50ICpuZXh0ID0gTlVMTDsKICAgICAKICAgICAvKiBvaCB3ZWxsICovCi0gICAgaWYoY29uZmln
X2dldHN3aXRjaCgic2lldmV1c2Vob21lZGlyIiwgMCkpIHJldHVybiAwOworICAgIGlmKGNvbmZp
Z19nZXRzd2l0Y2goSU1BUE9QVF9TSUVWRVVTRUhPTUVESVIpKSByZXR1cm4gMDsKICAgICAKICAg
ICBzbnByaW50ZihzaWV2ZV9wYXRoLCBzaXplb2Yoc2lldmVfcGF0aCksICIlcy8lYy8lcyIsCi0J
ICAgICBjb25maWdfZ2V0c3RyaW5nKCJzaWV2ZWRpciIsICIvdXNyL3NpZXZlIiksCisJICAgICBj
b25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU0lFVkVESVIpLAogCSAgICAgdXNlclswXSwgdXNlcik7
CiAgICAgbWJkaXI9b3BlbmRpcihzaWV2ZV9wYXRoKTsKIApJbmRleDogbWFuLy5jdnNpZ25vcmUK
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9j
eXJ1cy9tYW4vLmN2c2lnbm9yZSx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xCmRpZmYgLXUgLXIx
LjEgLmN2c2lnbm9yZQotLS0gLmN2c2lnbm9yZQkyMDAyLzAxLzA2IDAyOjAzOjMxCTEuMQorKysg
LmN2c2lnbm9yZQkyMDAyLzA2LzE5IDAwOjU1OjUzCkBAIC0xLDIgKzEsMyBAQAogTWFrZWZpbGUK
IHNpZXZlc2hlbGwuMQoraW1hcGQuY29uZi41CkluZGV4OiBtYW4vTWFrZWZpbGUuaW4KPT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9t
YW4vTWFrZWZpbGUuaW4sdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjUKZGlmZiAtdSAtcjEuMjUg
TWFrZWZpbGUuaW4KLS0tIE1ha2VmaWxlLmluCTIwMDIvMDUvMjUgMTk6NTc6NDcJMS4yNQorKysg
TWFrZWZpbGUuaW4JMjAwMi8wNi8xNyAyMDowMjo1NwpAQCAtODIsNiArODIsOSBAQAogCUBlY2hv
IGNyZWF0aW5nIHNpZXZlc2hlbGwuMQogCXBvZDJtYW4gJChzcmNkaXIpLy4uL3Blcmwvc2lldmUv
c2NyaXB0cy9zaWV2ZXNoZWxsLnBsID4gJChzcmNkaXIpL3NpZXZlc2hlbGwuMQogCitpbWFwZC5j
b25mLjU6ICQoc3JjZGlyKS8uLi9pbWFwL2ltYXBvcHRpb25zICQoc3JjZGlyKS8uLi90b29scy9j
b25maWcyaGVhZGVyCisJJChzcmNkaXIpLy4uL3Rvb2xzL2NvbmZpZzJtYW4gJChzcmNkaXIpLy4u
L2ltYXAvaW1hcG9wdGlvbnMgPiBpbWFwZC5jb25mLjUKKwogaW5zdGFsbDoKIAlmb3IgZmlsZSBp
biAkKE1BTjEpOyBcCiAJZG8gXApJbmRleDogbWFuL2ltYXBkLmNvbmYuNQo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJD
UyBmaWxlOiBpbWFwZC5jb25mLjUKZGlmZiAtTiBpbWFwZC5jb25mLjUKLS0tIC90bXAvY3ZzRUJB
MklhNDgyCVR1ZSBKdW4gMTggMjA6NTY6MTcgMjAwMgorKysgL2Rldi9udWxsCVR1ZSBKdW4gMTgg
MDY6MDE6MjMgMjAwMgpAQCAtMSwzNjIgKzAsMCBAQAotLlwiIC0qLSBucm9mZiAtKi0KLS5USCBJ
TUFQRC5DT05GIDUgIlByb2plY3QgQ3lydXMiIENNVQotLlwiIAotLlwiIENvcHlyaWdodCAoYykg
MTk5OC0yMDAwIENhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5LiAgQWxsIHJpZ2h0cyByZXNlcnZl
ZC4KLS5cIgotLlwiIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkg
Zm9ybXMsIHdpdGggb3Igd2l0aG91dAotLlwiIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBw
cm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucwotLlwiIGFyZSBtZXQ6Ci0uXCIK
LS5cIiAxLiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFi
b3ZlIGNvcHlyaWdodAotLlwiICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5k
IHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4gCi0uXCIKLS5cIiAyLiBSZWRpc3RyaWJ1dGlvbnMg
aW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAotLlwiICAg
IG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xh
aW1lciBpbgotLlwiICAgIHRoZSBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMg
cHJvdmlkZWQgd2l0aCB0aGUKLS5cIiAgICBkaXN0cmlidXRpb24uCi0uXCIKLS5cIiAzLiBUaGUg
bmFtZSAiQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkiIG11c3Qgbm90IGJlIHVzZWQgdG8KLS5c
IiAgICBlbmRvcnNlIG9yIHByb21vdGUgcHJvZHVjdHMgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdh
cmUgd2l0aG91dAotLlwiICAgIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi4gRm9yIHBlcm1pc3Np
b24gb3IgYW55IG90aGVyIGxlZ2FsCi0uXCIgICAgZGV0YWlscywgcGxlYXNlIGNvbnRhY3QgIAot
LlwiICAgICAgT2ZmaWNlIG9mIFRlY2hub2xvZ3kgVHJhbnNmZXIKLS5cIiAgICAgIENhcm5lZ2ll
IE1lbGxvbiBVbml2ZXJzaXR5Ci0uXCIgICAgICA1MDAwIEZvcmJlcyBBdmVudWUKLS5cIiAgICAg
IFBpdHRzYnVyZ2gsIFBBICAxNTIxMy0zODkwCi0uXCIgICAgICAoNDEyKSAyNjgtNDM4NywgZmF4
OiAoNDEyKSAyNjgtNzM5NQotLlwiICAgICAgdGVjaC10cmFuc2ZlckBhbmRyZXcuY211LmVkdQot
LlwiCi0uXCIgNC4gUmVkaXN0cmlidXRpb25zIG9mIGFueSBmb3JtIHdoYXRzb2V2ZXIgbXVzdCBy
ZXRhaW4gdGhlIGZvbGxvd2luZwotLlwiICAgIGFja25vd2xlZGdtZW50OgotLlwiICAgICJUaGlz
IHByb2R1Y3QgaW5jbHVkZXMgc29mdHdhcmUgZGV2ZWxvcGVkIGJ5IENvbXB1dGluZyBTZXJ2aWNl
cwotLlwiICAgICBhdCBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eSAoaHR0cDovL3d3dy5jbXUu
ZWR1L2NvbXB1dGluZy8pLiIKLS5cIgotLlwiIENBUk5FR0lFIE1FTExPTiBVTklWRVJTSVRZIERJ
U0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIIFJFR0FSRCBUTwotLlwiIFRISVMgU09GVFdBUkUs
IElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQotLlwi
IEFORCBGSVRORVNTLCBJTiBOTyBFVkVOVCBTSEFMTCBDQVJORUdJRSBNRUxMT04gVU5JVkVSU0lU
WSBCRSBMSUFCTEUKLS5cIiBGT1IgQU5ZIFNQRUNJQUwsIElORElSRUNUIE9SIENPTlNFUVVFTlRJ
QUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUwotLlwiIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST00g
TE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTgotLlwiIEFOIEFDVElPTiBP
RiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUiBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcK
LS5cIiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1IgUEVSRk9STUFOQ0Ug
T0YgVEhJUyBTT0ZUV0FSRS4KLS5cIiAKLS5cIiAkSWQ6IGltYXBkLmNvbmYuNSx2IDEuNjUgMjAw
Mi8wNi8xMiAxNzozODo1OCByanMzIEV4cCAkCi0KLS5TSCBOQU1FCi1pbWFwZC5jb25mIFwtIElN
QVAgY29uZmlndXJhdGlvbiBmaWxlCi0uU0ggREVTQ1JJUFRJT04KLVxmQi9ldGMvaW1hcGQuY29u
ZlxmUiAKLWlzIHRoZSBjb25maWd1cmF0aW9uIGZpbGUgZm9yIHRoZSBDeXJ1cyBJTUFQIHNlcnZl
ci4gIEl0IGRlZmluZXMKLWxvY2FsIHBhcmFtZXRlcnMgZm9yIElNQVAuIAotLlBQCi1FYWNoIGxp
bmUgb2YgdGhlIFxmQi9ldGMvaW1hcGQuY29uZlxmUiBmaWxlIGhhcyB0aGUgZm9ybQotLklQCi1c
ZklvcHRpb25cZlI6IFxmSXZhbHVlXGZSCi0uUFAKLXdoZXJlIFxmSW9wdGlvblxmUiBpcyB0aGUg
bmFtZSBvZiB0aGUgY29uZmlndXJhdGlvbiBvcHRpb24gYmVpbmcgc2V0Ci1hbmQgXGZJdmFsdWVc
ZlIgaXMgdGhlIHZhbHVlIHRoYXQgdGhlIGNvbmZpZ3VyYXRpb24gb3B0aW9uIGlzIGJlaW5nCi1z
ZXQgdG8uCi0uUFAKLUJsYW5rIGxpbmVzIGFuZCBsaW5lcyBiZWdpbm5pbmcgd2l0aCBgYCMnJyBh
cmUgaWdub3JlZC4KLS5QUAotRm9yIGJvb2xlYW4gb3B0aW9ucywgdGhlIHZhbHVlcyBgYHllcycn
LCBgYG9uJycsIGBgdCcnLCBhbmQgYGAxJycgdHVybiB0aGUKLW9wdGlvbiBvbiwgdGhlIHZhbHVl
cyBgYG5vJycsIGBgb2ZmJycsIGBgZicnLCBhbmQgYGAwJycgdHVybiB0aGUgb3B0aW9uIG9mZi4K
LS5TSCBGSUVMRCBERVNDUklQVElPTlMKLS5QUAotVGhlIHNlY3Rpb25zIGJlbG93IGRldGFpbCBv
cHRpb25zIHRoYXQgY2FuIGJlIHBsYWNlZCBpbiB0aGUKLVxmQi9ldGMvaW1hcGQuY29uZlxmUiBm
aWxlLCBhbmQgc2hvdyBlYWNoIG9wdGlvbidzIGRlZmF1bHQgdmFsdWUuCi1Tb21lIG9wdGlvbnMg
aGF2ZSBubyBkZWZhdWx0IHZhbHVlLCB0aGVzZSBhcmUgbGlzdGVkIHdpdGgKLWBgPG5vIGRlZmF1
bHQ+JycuICBTb21lIG9wdGlvbnMgZGVmYXVsdCB0byB0aGUgZW1wdHkgc3RyaW5nLCB0aGVzZQot
YXJlIGxpc3RlZCB3aXRoIGBgPG5vbmU+JycuCi0uSVAgIlxmQmNvbmZpZ2RpcmVjdG9yeTpcZlIg
PG5vIGRlZmF1bHQ+IiA1Ci1UaGUgcGF0aG5hbWUgb2YgdGhlIElNQVAgY29uZmlndXJhdGlvbiBk
aXJlY3RvcnkuICBUaGlzIGZpZWxkIGlzIHJlcXVpcmVkLgotLklQICJcZkJkZWZhdWx0cGFydGl0
aW9uOlxmUiBkZWZhdWx0IiA1Ci1UaGUgcGFydGl0aW9uIG5hbWUgdXNlZCBieSBkZWZhdWx0IGZv
ciBuZXcgbWFpbGJveGVzLgotLklQICJcZkJwYXJ0aXRpb24tXGZJbmFtZVxmQjpcZlIgPG5vIGRl
ZmF1bHQ+IiA1Ci1UaGUgcGF0aG5hbWUgb2YgdGhlIHBhcnRpdGlvbiBcZkluYW1lXGZSLiAgQXQg
bGVhc3Qgb25lIGZpZWxkLCBmb3IgdGhlCi1wYXJ0aXRpb24gbmFtZWQgaW4gdGhlIFxmQmRlZmF1
bHRwYXJ0aXRpb25cZlIgb3B0aW9uLCBpcyByZXF1aXJlZC4KLUZvciBleGFtcGxlLCBpZiB0aGUg
dmFsdWUgb2YgdGhlIFxmQmRlZmF1bHRwYXJ0aW9uXGZSIG9wdGlvbiBpcwotXGZCZGVmYXVsdFxm
UiwgdGhlbiB0aGUgXGZCcGFydGl0aW9uLWRlZmF1bHRcZlIgZmllbGQgaXMgcmVxdWlyZWQuCi0u
SVAgIlxmQnVuaXhoaWVyYXJjaHlzZXA6XGZSIG5vIiA1Ci1Vc2UgdGhlIFVOSVggc2VwYXJhdG9y
IGNoYXJhY3RlciAnLycgZm9yIGRlbGltaXRpbmcgbGV2ZWxzIG9mIG1haWxib3gKLWhpZXJhcmNo
eS4gIFRoZSBkZWZhdWx0IGlzIHRvIHVzZSB0aGUgbmV0bmV3cyBzZXBhcmF0b3IgY2hhcmFjdGVy
ICcuJy4gCi0uSVAgIlxmQmFsdG5hbWVzcGFjZTpcZlIgbm8iIDUKLVVzZSB0aGUgYWx0ZXJuYXRl
IElNQVAgbmFtZXNwYWNlLCB3aGVyZSBwZXJzb25hbCBmb2xkZXJzIHJlc2lkZSBhdCB0aGUKLXNh
bWUgbGV2ZWwgaW4gdGhlIGhpZXJhcmNoeSBhcyBJTkJPWC4KLS5icgotLnNwCi1UaGlzIG9wdGlv
biBPTkxZIGFwcGxpZXMgd2hlcmUgaW50ZXJhY3Rpb24gdGFrZXMgcGxhY2Ugd2l0aCB0aGUKLWNs
aWVudC91c2VyLiAgQ3VycmVudGx5IHRoaXMgaXMgbGltaXRlZCB0byB0aGUgSU1BUCBwcm90b2Nv
bCAoaW1hcGQpCi1hbmQgU2lldmUgc2NyaXB0cyAobG10cGQpLiAgVGhpcyBvcHRpb24gZG9lcyBO
T1QgYXBwbHkgdG8gYWRtaW4gdG9vbHMKLXN1Y2ggYXMgY3lyYWRtIChhZG1pbnMgT05MWSksIHJl
Y29uc3RydWN0LCBxdW90YSwgZXRjLiwgTk9SIGRvZXMgaXQKLWFmZmVjdCBMTVRQIGRlbGl2ZXJ5
IG9mIG1lc3NhZ2VzIGRpcmVjdGx5IHRvIG1haWxib3hlcyB2aWEgcGx1cy1hZGRyZXNzaW5nLgot
LklQICJcZkJ1c2VycHJlZml4OlxmUiBPdGhlciBVc2VycyIgNQotSWYgdXNpbmcgdGhlIGFsdGVy
bmF0ZSBJTUFQIG5hbWVzcGFjZSwgdGhlIHByZWZpeCBmb3IgdGhlIG90aGVyIHVzZXJzCi1uYW1l
c3BhY2UuICBUaGUgaGllcmFyY2h5IGRlbGltaXRlciB3aWxsIGJlIGF1dG9tYXRpY2FsbHkgYXBw
ZW5kZWQuCi0uSVAgIlxmQnNoYXJlZHByZWZpeDpcZlIgU2hhcmVkIEZvbGRlcnMiIDUKLUlmIHVz
aW5nIHRoZSBhbHRlcm5hdGUgSU1BUCBuYW1lc3BhY2UsIHRoZSBwcmVmaXggZm9yIHRoZSBzaGFy
ZWQKLW5hbWVzcGFjZS4gIFRoZSBoaWVyYXJjaHkgZGVsaW1pdGVyIHdpbGwgYmUgYXV0b21hdGlj
YWxseSBhcHBlbmRlZC4KLS5JUCAiXGZCdW1hc2s6XGZSIDA3NyIgNQotVGhlIHVtYXNrIHZhbHVl
IHVzZWQgYnkgdmFyaW91cyBDeXJ1cyBJTUFQIHByb2dyYW1zLgotLklQICJcZkJzZXJ2ZXJuYW1l
OlxmUiA8cmVzdWx0IHJldHVybmVkIGJ5IGdldGhvc3RuYW1lKDIpPiIgNQotVGhpcyBpcyB0aGUg
aG9zdG5hbWUgdmlzaWJsZSBpbiB0aGUgZ3JlZXRpbmcgbWVzc2FnZXMgb2YgdGhlIFBPUCwgSU1B
UCBhbmQgTE1UUAotZGFlbW9ucy4gSWYgaXQgaXMgdW5zZXQsIHRoZW4gdGhlIHJlc3VsdCByZXR1
cm5lZCBmcm9tIGdldGhvc3RuYW1lKDIpIGlzIHVzZWQuCi0uSVAgIlxmQmFsbG93YW5vbnltb3Vz
bG9naW46XGZSIG5vIiA1Ci1QZXJtaXQgbG9naW5zIGJ5IHRoZSB1c2VyICJhbm9ueW1vdXMiIHVz
aW5nIGFueSBwYXNzd29yZC4gIEFsc28gYWxsb3dzCi11c2Ugb2YgdGhlIFNBU0wgQU5PTllNT1VT
IG1lY2hhbmlzbS4KLS5JUCAiXGZCYWxsb3dwbGFpbnRleHQ6XGZSIHllcyIgNQotQWxsb3cgdGhl
IHVzZSBvZiB0aGUgU0FTTCBQTEFJTiBtZWNoYW5pc20uCi0uSVAgIlxmQnF1b3Rhd2FybjpcZlIg
OTAiIDUKLVRoZSBwZXJjZW50IG9mIHF1b3RhIHV0aWxpemF0aW9uIG92ZXIgd2hpY2ggdGhlIHNl
cnZlciBnZW5lcmF0ZXMKLXdhcm5pbmdzLgotLklQICJcZkJ0aW1lb3V0OlxmUiAzMCIgNQotVGhl
IGxlbmd0aCBvZiB0aGUgSU1BUCBzZXJ2ZXIncyBpbmFjdGl2aXR5IGF1dG9sb2dvdXQgdGltZXIs
Ci1pbiBtaW51dGVzLiAgVGhlIG1pbmltdW0gdmFsdWUgaXMgMzAsIHRoZSBkZWZhdWx0LgotLklQ
ICJcZkJpbWFwaWRsZXBvbGw6XGZSIDYwIiA1Ci1UaGUgaW50ZXJ2YWwgKGluIHNlY29uZHMpIGZv
ciBwb2xsaW5nIHRoZSBtYWlsYm94IGZvciBjaGFuZ2VzIHdoaWxlCi1ydW5uaW5nIHRoZSBJRExF
IGNvbW1hbmQuICBUaGlzIG9wdGlvbiBpcyB1c2VkIHdoZW4gaWRsZWQgY2FuIG5vdCBiZQotY29u
dGFjdGVkIG9yIHdoZW4gcG9sbGluZyBpcyB1c2VkIGV4Y2x1c2l2ZWx5LiAgVGhlIG1pbmltdW0g
dmFsdWUgaXMKLTEuICBBIHZhbHVlIG9mIDAgd2lsbCBkaXNhYmxlIHBvbGxpbmcgKGFuZCBkaXNh
YmxlIElETEUgaWYgcG9sbGluZyBpcwotdGhlIG9ubHkgbWV0aG9kIGF2YWlsYWJsZSkuCi0uSVAg
IlxmQmltYXBpZHJlc3BvbnNlOlxmUiB5ZXMiIDUKLUlmIGVuYWJsZWQsIHRoZSBzZXJ2ZXIgcmVz
cG9uZHMgdG8gYW4gSUQgY29tbWFuZCB3aXRoIGEgcGFyYW1ldGVyCi1saXN0IGNvbnRhaW5pbmc6
IHZlcnNpb24sIHZlbmRvciwgc3VwcG9ydC11cmwsIG9zLCBvcy12ZXJzaW9uLAotY29tbWFuZCwg
YXJndW1lbnRzLCBlbnZpcm9ubWVudC4gIE90aGVyd2lzZSB0aGUgc2VydmVyIHJldHVybnMgTklM
LgotLklQICJcZkJwb3B0aW1lb3V0OlxmUiAxMCIgNQotU2V0IHRoZSBsZW5ndGggb2YgdGhlIFBP
UCBzZXJ2ZXIncyBpbmFjdGl2aXR5IGF1dG9sb2dvdXQgdGltZXIsCi1pbiBtaW51dGVzLiAgVGhl
IG1pbmltdW0gdmFsdWUgaXMgMTAsIHRoZSBkZWZhdWx0LgotLklQICJcZkJwb3BtaW5wb2xsOlxm
UiAwIiA1Ci1TZXQgdGhlIG1pbmltdW0gYW1vdW50IG9mIHRpbWUgdGhlIHNlcnZlciBmb3JjZXMg
dXNlcnMgdG8gd2FpdCBiZXR3ZWVuCi1zdWNjZXNzaXZlIFBPUCBsb2dpbnMsCi1pbiBtaW51dGVz
LiAgVGhlIGRlZmF1bHQgaXMgMC4KLS5JUCAiXGZCcG9wZXhwaXJldGltZTpcZlIgMCIgNQotVGhl
IG51bWJlciBvZiBkYXlzIGFkdmVydGlzZWQgYXMgYmVpbmcgdGhlIG1pbmltdW0gYSBtZXNzYWdl
IG1heSBiZSBsZWZ0IG9uCi10aGUgUE9QIHNlcnZlciBiZWZvcmUgaXQgaXMgZGVsZXRlZCAodmlh
IHRoZSBDQVBBIGNvbW1hbmQsIGRlZmluZWQgaW4gdGhlIFBPUDMKLUV4dGVuc2lvbiBNZWNoYW5p
c20sIHdoaWNoIHNvbWUgY2xpZW50cyBtYXkgc3VwcG9ydCkuICAiTkVWRVIiLCB0aGUgZGVmYXVs
dCwKLW1heSBiZSBzcGVjaWZpZWQgd2l0aCBhIG5lZ2F0aXZlIG51bWJlci4gIFRoZSBDeXJ1cyBQ
T1AzIHNlcnZlciBuZXZlciBkZWxldGVzCi1tYWlsLCBubyBtYXR0ZXIgd2hhdCB0aGUgdmFsdWUg
b2YgdGhpcyBwYXJhbWV0ZXIgaXMuICBIb3dldmVyLCBpZiBhIHNpdGUKLWltcGxlbWVudHMgYSBs
ZXNzIGxpYmVyYWwgcG9saWN5LCBpdCBuZWVkcyB0byBjaGFuZ2UgdGhpcyBwYXJhbWV0ZXIKLWFj
Y29yZGluZ2x5LgotLklQICJcZkJhZG1pbnM6XGZSIDxub25lPiIgNQotVGhlIGxpc3Qgb2YgdXNl
cmlkcyB3aXRoIGFkbWluaXN0cmF0aXZlIHJpZ2h0cy4gIFNlcGFyYXRlIGVhY2ggdXNlcmlkCi13
aXRoIGEgc3BhY2UuICBTaXRlcyB1c2luZyBLZXJiZXJvcyBhdXRoZW50aWNhdGlvbiBtYXkgdXNl
Ci1zZXBhcmF0ZSAiYWRtaW4iIGluc3RhbmNlcy4KLS5QUAotTm90ZSB0aGF0IGFjY291bnRzIHVz
ZWQgYnkgdXNlcnMgc2hvdWxkIG5vdCBiZSBhZG1pbmlzdHJhdG9ycy4gIEFkbWluaXN0cmF0aXZl
IAotYWNjb3VudHMgc2hvdWxkIG5vdCByZWNlaXZlIG1haWwuICBUaGF0IGlzLCBpZiB1c2VyICJq
YlJvIiBpcyBhIHVzZXIgcmVhZGluZwotbWFpbCwgaGUgc2hvdWxkIG5vdCBhbHNvIGJlIGluIHRo
ZSBhZG1pbnMgbGluZS4gIFNvbWUgcHJvYmxlbXMgbWF5IG9jY3VyCi1vdGhlcndpc2UsIG1vc3Qg
bm90YWJseSAgdGhlIGFiaWxpdHkgb2YgYWRtaW5pc3RyYXRvcnMgdG8gY3JlYXRlIHRvcC1sZXZl
bAotbWFpbGJveGVzIHZpc2libGUgdG8gdXNlcnMsIGJ1dCBub3Qgd3JpdGFibGUgYnkgdXNlcnMu
Ci0uSVAgIlxmQnByb3h5c2VydmVyczpcZlIgPG5vbmU+IiA1Ci1BIGxpc3Qgb2YgdXNlcnMgYW5k
IGdyb3VwcyB0aGF0IGFyZSBhbGxvd2VkIHRvIHByb3h5IGZvciBvdGhlciB1c2VycywKLXNlcGVy
YXRlZCBieSBzcGFjZXMuICBBbnkgdXNlciBsaXN0ZWQgaW4gdGhpcyB3aWxsIGJlIGFsbG93ZWQg
dG8gbG9naW4KLWZvciBhbnkgb3RoZXIgdXNlcjogdXNlIHdpdGggY2F1dGlvbi4KLS5JUCAiXGZC
ZGVmYXVsdGFjbDpcZlIgYW55b25lIGxycyIgNQotVGhlIEFjY2VzcyBDb250cm9sIExpc3QgKEFD
TCkgcGxhY2VkIG9uIGEgbmV3bHktY3JlYXRlZCAobm9uLXVzZXIpIAotbWFpbGJveCB0aGF0IGRv
ZXMgbm90IGhhdmUgYSBwYXJlbnQgbWFpbGJveC4KLS5JUCAiXGZCbmV3c3Nwb29sXGZCOlxmUiA8
bm8gZGVmYXVsdD4iIDUKLVRoZSBwYXRobmFtZSBvZiB0aGUgbmV3cyBzcG9vbCBkaXJlY3Rvcnku
ICBPbmx5IHVzZWQgaWYgdGhlCi1cZkJwYXJ0aXRpb24tbmV3c1xmUiBjb25maWd1cmF0aW9uIG9w
dGlvbiBpcyBzZXQuCi0uSVAgIlxmQm5ld3NwcmVmaXg6XGZSIDxub25lPiIgNQotUHJlZml4IHRv
IGJlIHByZXBlbmRlZCB0byBuZXdzZ3JvdXAgbmFtZXMgdG8gbWFrZSB0aGUgY29ycmVzcG9uZGlu
ZwotSU1BUCBtYWlsYm94IG5hbWVzLgotLklQICJcZkJhdXRvY3JlYXRlcXVvdGE6XGZSIDAiIDUK
LUlmIG5vbnplcm8sIG5vcm1hbCB1c2VycyBtYXkgY3JlYXRlIHRoZWlyIG93biBJTUFQIGFjY291
bnRzIGJ5Ci1jcmVhdGluZyB0aGUgbWFpbGJveCBJTkJPWC4gIFRoZSB1c2VyJ3MgcXVvdGEgaXMg
c2V0IHRvIHRoZSB2YWx1ZSBpZgotaXQgaXMgcG9zaXRpdmUsIG90aGVyd2lzZSB0aGUgdXNlciBo
YXMgdW5saW1pdGVkIHF1b3RhLgotLklQICJcZkJsb2d0aW1lc3RhbXBzOlxmUiBubyIgNQotSW5j
bHVkZSBub3RhdGlvbnMgaW4gdGhlIHByb3RvY29sIHRlbGVtZXRyeSBsb2dzIGluZGljYXRpbmcg
dGhlIG51bWJlciBvZgotc2Vjb25kcyBzaW5jZSB0aGUgbGFzdCBjb21tYW5kIG9yIHJlc3BvbnNl
LgotLklQICJcZkJwbGFpbnRleHRsb2dpbnBhdXNlOlxmUiAwIiA1Ci1OdW1iZXIgb2Ygc2Vjb25k
cyB0byBwYXVzZSBhZnRlciBhIHN1Y2Nlc3NmdWwgcGxhaW50ZXh0IGxvZ2luLiAgRm9yCi1zeXN0
ZW1zIHRoYXQgc3VwcG9ydCBzdHJvbmcgYXV0aGVudGljYXRpb24sIHRoaXMgcGVybWl0cyB1c2Vy
cyB0bwotcGVyY2VpdmUgYSBjb3N0IG9mIHVzaW5nIHBsYWludGV4dCBwYXNzd29yZHMuICAoVGhp
cyBkb2VzIG5vdCBlZmZlY3QKLXRoZSB1c2Ugb2YgUExBSU4gaW4gU0FTTCBhdXRoZW50aWNhdGlv
bnMuKQotLklQICJcZkJzcnZ0YWI6XGZSIC9ldGMvc3J2dGFiIiA1Ci1UaGUgcGF0aG5hbWUgb2Yg
XGZJc3J2dGFiXGZSIGZpbGUgY29udGFpbmluZyB0aGUgc2VydmVyJ3MgcHJpdmF0ZSAKLWtleS4g
IFRoaXMgb3B0aW9uIGlzIHBhc3NlZCB0byB0aGUgU0FTTCBsaWJyYXJ5IGFuZCBvdmVycmlkZXMg
aXRzCi1kZWZhdWx0IHNldHRpbmcuCi0uSVAgIlxmQmxvZ2lucmVhbG1zOlxmUiA8bm9uZT4iIDUK
LVRoZSBsaXN0IG9mIHJlbW90ZSByZWFsbXMgd2hvc2UgdXNlcnMgbWF5IGxvZyBpbiB1c2luZyAK
LWNyb3NzLXJlYWxtIGF1dGhlbnRpY2F0aW9ucy4gIFNlcGVyYXRlIGVhY2ggcmVhbG0gbmFtZQot
YnkgYSBzcGFjZS4gIChBIGNyb3NzLXJlYWxtIGlkZW50aXR5IGlzIGNvbnNpZGVyZWQgYW55IGlk
ZW50aXR5Ci1yZXR1cm5lZCBieSBTQVNMIHdpdGggYW4gIkAiIGluIGl0LikKLS5JUCAiXGZCbG9n
aW51c2VhY2w6XGZSIG5vIiA1Ci1JZiBlbmFibGVkLCBhbnkgYXV0aGVudGljYXRpb24gaWRlbnRp
dHkgd2hpY2ggaGFzIFxmQmFcZlIgcmlnaHRzIG9uIGEKLXVzZXIncyBJTkJPWCBtYXkgbG9nIGlu
IGFzIHRoYXQgdXNlci4KLS5JUCAiXGZCc2luZ2xlaW5zdGFuY2VzdG9yZTpcZlIgeWVzIiA1Ci1J
ZiBlbmFibGVkLCBsbXRwZCBhdHRlbXB0cyB0byBvbmx5IHdyaXRlIG9uZSBjb3B5IG9mIGEgbWVz
c2FnZSBwZXIKLXBhcnRpdGlvbiBhbmQgY3JlYXRlIGhhcmQgbGlua3MsIHJlc3VsdGluZyBpbiBh
IHBvdGVudGlhbGx5IGxhcmdlIGRpc2sKLXNhdmluZ3MuCi0uSVAgIlxmQmR1cGxpY2F0ZXN1cHBy
ZXNzaW9uOlxmUiB5ZXMiIDUKLUlmIGVuYWJsZWQsIGxtdHBkIHdpbGwgc3VwcHJlc3MgZGVsaXZl
cnkgb2YgYSBtZXNzYWdlIHRvIGEgbWFpbGJveCBpZgotYSBtZXNzYWdlIHdpdGggdGhlIHNhbWUg
bWVzc2FnZS1pZCAob3IgcmVzZW50LW1lc3NhZ2UtaWQpIGlzIHJlY29yZGVkCi1hcyBoYXZpbmcg
YWxyZWFkeSBiZWVuIGRlbGl2ZXJlZCB0byB0aGUgbWFpbGJveC4gIFJlY29yZHMgdGhlIG1haWxi
b3gKLWFuZCBtZXNzYWdlLWlkL3Jlc2VudC1tZXNzYWdlLWlkIG9mIGFsbCBzdWNjZXNzZnVsIGRl
bGl2ZXJpZXMuCi0uSVAgIlxmQnJlamVjdDhiaXQ6XGZSIG5vIiA1Ci1JZiBlbmFibGVkLCBsbXRw
ZCByZWplY3RzIG1lc3NhZ2VzIHdpdGggOC1iaXQgY2hhcmFjdGVycyBpbiB0aGUgaGVhZGVycy4K
LU90aGVyd2lzZSwgOC1iaXQgY2hhcmFjdGVycyBhcmUgY2hhbmdlZCB0byBgWCcuICAoQSBwcm9w
ZXIgc291bHRpb24gdG8KLW5vbi1BU0NJSSBjaGFyYWN0ZXJzIGluIGhlYWRlcnMgaXMgb2ZmZXJl
ZCBieSBSRkMgMjA0NyBhbmQgaXRzIHByZWRlY2Vzc29ycy4pCi0uSVAgIlxmQm1heG1lc3NhZ2Vz
aXplOlxmUiA8dW5saW1pdGVkPiIgNQotTWF4aW11bSBpbmNvbWluZyBMTVRQIG1lc3NhZ2Ugc2l6
ZS4gIElmIHNldCwgbG10cGQgd2lsbAotcmVqZWN0IG1lc3NhZ2VzIGxhcmdlciB0aGFuIFxmSW1h
eG1lc3NhZ2VzaXplXGZSIGJ5dGVzLiAgVGhlIGRlZmF1bHQKLWlzIHRvIGFsbG93IG1lc3NhZ2Vz
IG9mIGFueSBzaXplLgotLklQICJcZkJsbXRwX292ZXJxdW90YV9wZXJtX2ZhaWx1cmU6XGZSIG5v
IiA1Ci1JZiBlbmFibGVkLCBsbXRwZCByZXR1cm5zIGEgcGVybWFuZW50IGZhaWx1cmUgY29kZSB3
aGVuIGEgdXNlcidzCi1tYWlsYm94IGlzIG92ZXIgcXVvdGEuICBCeSBkZWZhdWx0LCB0aGUgZmFp
bHVyZSBpcyB0ZW1wb3JhcnkuCi0uSVAgIlxmQmxtdHBfYWxsb3dwbGFpbnRleHQ6XGZSIDxzZXR0
aW5nIG9mIFxmSWFsbG93cGxhaW50ZXh0XGZSPiIgNQotQWxsb3cgdGhlIHVzZSBvZiB0aGUgU0FT
TCBQTEFJTiBtZWNoYW5pc20gZm9yIExNVFAuCi0uSVAgIlxmQnBvc3R1c2VyOlxmUiA8bm9uZT4i
IDUKLVVzZXJpZCB1c2VkIHRvIGRlbGl2ZXIgbWVzc2FnZXMgdG8gc2hhcmVkIGZvbGRlcnMuICBG
b3IgZXhhbXBsZSwgaWYKLXNldCB0byAiYmIiLCBlbWFpbCBzZW50IHRvICJiYitzaGFyZWQuYmxh
aCIgd291bGQgYmUgZGVsaXZlcmVkIHRvIHRoZQotInNoYXJlZC5ibGFoIiBmb2xkZXIuICBCeSBk
ZWZhdWx0LCBhbiBlbWFpbCBhZGRyZXNzIG9mICIrc2hhcmVkLmJsYWgiCi13b3VsZCBiZSB1c2Vk
LgotLklQICJcZkJuZXRzY2FwZXVybDpcZlIgPG5vIGRlZmF1bHQ+IiA1Ci1JZiBlbmFibGVkIGF0
IGNvbXBpbGUgdGltZSwgdGhpcyBzcGVjaWZpZXMgYSBVUkwgdG8gcmVwbHkgd2hlbgotTmV0c2Nh
cGUgYXNrcyB0aGUgc2VydmVyIHdoZXJlIHRoZSBtYWlsIGFkbWluaXN0cmF0aW9uIEhUVFAgc2Vy
dmVyIGlzLgotQWRtaW5pc3RyYXRvcnMgc2hvdWxkIHNldCB0aGlzIHRvIGEgbG9jYWwgcmVzb3Vy
Y2Ugd2l0aCBzb21lCi11c2VmdWwgaW5mb3JtYXRpb24gZm9yIGVuZCB1c2Vycy4gIElmIG5vdCBz
ZXQsIG5vIFVSTCBpcyBhZHZlcnRpc2VkLgotLklQICJcZkJtYWlsbm90aWZpZXI6XGZSIDxubyBk
ZWZhdWx0PiIgNQotTm90aWZ5ZCg4KSBtZXRob2QgdG8gdXNlIGZvciAiTUFJTCIgbm90aWZpY2F0
aW9ucy4gIElmIG5vdCBzZXQsICJNQUlMIgotbm90aWZpY2F0aW9ucyBhcmUgZGlzYWJsZWQuCi0u
SVAgIlxmQnNpZXZlbm90aWZpZXI6XGZSIDxubyBkZWZhdWx0PiIgNQotTm90aWZ5ZCg4KSBtZXRo
b2QgdG8gdXNlIGZvciAiU0lFVkUiIG5vdGlmaWNhdGlvbnMuICBJZiBub3Qgc2V0LCAiU0lFVkUi
Ci1ub3RpZmljYXRpb25zIGFyZSBkaXNhYmxlZC4KLS5icgotLnNwCi1UaGlzIG1ldGhvZCBpcyBv
bmx5IHVzZWQgd2hlbiBubyBtZXRob2QgaXMgc3BlY2lmaWVkIGluIHRoZSBzY3JpcHQuCi0uSVAg
IlxmQnNpZXZldXNlaG9tZWRpcjpcZlIgZmFsc2UiIDUKLUlmIGVuYWJsZWQsIGxtdHBkIHdpbGwg
bG9vayBmb3IgU2lldmUgc2NyaXB0cyBpbiB1c2VyJ3MgaG9tZQotZGlyZWN0b3JpZXM6IH51c2Vy
Ly5zaWV2ZS4KLS5JUCAiXGZCc2lldmVkaXI6XGZSIC91c3Ivc2lldmUiIDUKLUlmIHNpZXZldXNl
aG9tZWRpciBpcyBmYWxzZSwgdGhpcyBkaXJlY3RvcnkgaXMgc2VhcmNoZWQgZm9yIFNpZXZlCi1z
Y3JpcHRzLgotLklQICJcZkJzZW5kbWFpbDpcZlIgL3Vzci9saWIvc2VuZG1haWwiIDUKLVRoZSBw
YXRobmFtZSBvZiB0aGUgc2VuZG1haWwgZXhlY3V0YWJsZS4gIFNpZXZlIHVzZXMgc2VuZG1haWwg
Zm9yIHNlbmRpbmcKLXJlamVjdGlvbnMsIHJlZGlyZWN0cyBhbmQgdmFjYXRpb24gcmVzcG9uc2Vz
LgotLklQICJcZkJwb3N0bWFzdGVyOlxmUiBwb3N0bWFzdGVyIiA1Ci1Vc2VybmFtZSB0aGF0IGlz
IHVzZWQgYXMgdGhlICdGcm9tJyBhZGRyZXNzIGluIHJlamVjdGlvbiBNRE5zIHByb2R1Y2VkCi1i
eSBzaWV2ZS4KLS5JUCAiXGZCaGFzaGltYXBzcG9vbDpcZlIgZmFsc2UiIDUKLUlmIGVuYWJsZWQs
IHRoZSBwYXJ0aXRpb25zIHdpbGwgYWxzbyBiZSBoYXNoZWQsIGluIGFkZGl0aW9uIHRvIHRoZQot
aGFzaGluZyBkb25lIG9uIGNvbmZpZ3VyYXRpb24gZGlyZWN0b3JpZXMuICBUaGlzIGlzIHJlY29t
bWVuZGVkIGlmIG9uZQotcGFydGl0aW9uIGhhcyBhIHZlcnkgYnVzaHkgbWFpbGJveCB0cmVlLgot
LklQICJcZkJzaWV2ZV9tYXhzY3JpcHRzaXplOlxmUiAzMiIgNQotTWF4aW11bSBzaXplIChpbiBr
aWxvYnl0ZXMpIGFueSBzaWV2ZSBzY3JpcHQgY2FuIGJlLCBlbmZvcmNlZCBhdAotc3VibWlzc2lv
biBieSB0aW1zaWV2ZWQoOCkuCi0uSVAgIlxmQnNpZXZlX21heHNjcmlwdHM6XGZSIDUiIDUKLU1h
eGltdW0gbnVtYmVyIG9mIHNpZXZlIHNjcmlwdHMgYW55IHVzZXIgbWF5IGhhdmUsIGVuZm9yY2Vk
IGF0Ci1zdWJtaXNzaW9uIGJ5IHRpbXNpZXZlZCg4KS4KLS5JUCAiXGZCc2FzbF9tYXhpbXVtX2xh
eWVyOlxmUiAyNTYiIDUKLU1heGltdW0gU1NGIChzZWN1cml0eSBzdHJlbmd0aCBmYWN0b3IpIHRo
YXQgdGhlIHNlcnZlciB3aWxsIGFsbG93IGEKLWNsaWVudCB0byBuZWdvdGlhdGUuCi0uSVAgIlxm
QnNhc2xfbWluaW11bV9sYXllcjpcZlIgMCIgNQotVGhlIG1pbmltdW0gU1NGIHRoYXQgdGhlIHNl
cnZlciB3aWxsIGFsbG93IGEgY2xpZW50IHRvIG5lZ290aWF0ZS4gIEEKLXZhbHVlIG9mIDEgcmVx
dWlyZXMgaW50ZWdyaXR5IHByb3RlY3Rpb247IGFueSBoaWdoZXIgdmFsdWUgcmVxdWlyZXMKLXNv
bWUgYW1vdW50IG9mIGVuY3J5cHRpb24uCi0uSVAgIlxmQnNhc2xfcHdjaGVja19tZXRob2Q6XGZS
IGF1eHByb3AiIDUKLVRoZSBtZWNoYW5pc20gdXNlZCBieSB0aGUgc2VydmVyIHRvIHZlcmlmeSBw
bGFpbnRleHQgcGFzc3dvcmRzLgotUG9zc2libGUgdmFsdWVzIGFsc28gaW5jbHVkZSAic2FzbGF1
dGhkIiBhbmQgInB3Y2hlY2siLgotLklQICJcZkJzYXNsX2F1dG9fdHJhbnNpdGlvbjpcZlIgbm8i
IDUKLUlmIGVuYWJsZWQsIHRoZSBTQVNMIGxpYnJhcnkgd2lsbCBhdXRvbWF0aWNhbGx5IGNyZWF0
ZSBhdXRoZW50aWNhdGlvbgotc2VjcmV0cyB3aGVuIGdpdmVuIGEgcGxhaW50ZXh0IHBhc3N3b3Jk
LiAgU2VlIHRoZSBTQVNMIGRvY3VtZW50YXRpb24uCi0uSVAgIlxmQnNhc2xfb3B0aW9uOlxmUiIg
NQotQW55IG90aGVyIFNBU0wgb3B0aW9uIGNhbiBiZSBzZXQgYnkgcHJlY2VlZGluZyBpdCB3aXRo
ICJzYXNsXyIuICBUaGlzCi1maWxlIG92ZXJyaWRlcyB0aGUgU0FTTCBjb25maWd1cmF0aW9uIGZp
bGUuCi0uSVAgIlxmQnRsc19jZXJ0X2ZpbGU6XGZSIDxub25lPiIgNQotRmlsZSBjb250YWluaW5n
IHRoZSBnbG9iYWwgY2VydGlmaWNhdGUgdXNlZCBmb3IgQUxMIHNlcnZpY2VzIChpbWFwLAotcG9w
MywgbG10cCwgc2lldmUpLgotLklQICJcZkJ0bHNfa2V5X2ZpbGU6XGZSIDxub25lPiIgNQotRmls
ZSBjb250YWluaW5nIHRoZSBwcml2YXRlIGtleSBiZWxvbmdpbmcgdG8gdGhlIGdsb2JhbCBzZXJ2
ZXIKLWNlcnRpZmljYXRlLgotLklQICJcZkJ0bHNfcmVxdWlyZV9jZXJ0OlxmUiAwIiA1Ci1SZXF1
aXJlIGEgY2xpZW50IGNlcnRpZmljYXRlIGZvciBBTEwgc2VydmljZXMgKGltYXAsIHBvcDMsIGxt
dHAsIHNpZXZlKS4KLS5JUCAiXGZCdGxzX2ltYXBfY2VydF9maWxlOlxmUiA8bm9uZT4iIDUKLUZp
bGUgY29udGFpbmluZyB0aGUgY2VydGlmaWNhdGUgdXNlZCBmb3IgaW1hcCBPTkxZLiAgSWYgbm90
IHNwZWNpZmllZCwKLXRoZSBnbG9iYWwgY2VydGlmaWNhdGUgaXMgdXNlZC4gIEEgdmFsdWUgb2Yg
ImRpc2FibGVkIiB3aWxsIGRpc2FibGUKLVNTTC9UTFMgZm9yIGltYXAuCi0uSVAgIlxmQnRsc19p
bWFwX2tleV9maWxlOlxmUiA8bm9uZT4iIDUKLUZpbGUgY29udGFpbmluZyB0aGUgcHJpdmF0ZSBr
ZXkgYmVsb25naW5nIHRvIHRoZSBpbWFwLXNwZWNpZmljIHNlcnZlcgotY2VydGlmaWNhdGUuICBJ
ZiBub3Qgc3BlY2lmaWVkLCB0aGUgZ2xvYmFsIHByaXZhdGUga2V5IGlzIHVzZWQuICBBCi12YWx1
ZSBvZiAiZGlzYWJsZWQiIHdpbGwgZGlzYWJsZSBTU0wvVExTIGZvciBpbWFwLgotLklQICJcZkJ0
bHNfaW1hcF9yZXF1aXJlX2NlcnQ6XGZSIDAiIDUKLVJlcXVpcmUgYSBjbGllbnQgY2VydGlmaWNh
dGUgZm9yIGltYXAgT05MWS4KLS5JUCAiXGZCdGxzX3BvcDNfY2VydF9maWxlOlxmUiA8bm9uZT4i
IDUKLUZpbGUgY29udGFpbmluZyB0aGUgY2VydGlmaWNhdGUgdXNlZCBmb3IgcG9wMyBPTkxZLiAg
SWYgbm90IHNwZWNpZmllZCwKLXRoZSBnbG9iYWwgY2VydGlmaWNhdGUgaXMgdXNlZC4gIEEgdmFs
dWUgb2YgImRpc2FibGVkIiB3aWxsIGRpc2FibGUKLVNTTC9UTFMgZm9yIHBvcDMuCi0uSVAgIlxm
QnRsc19wb3AzX2tleV9maWxlOlxmUiA8bm9uZT4iIDUKLUZpbGUgY29udGFpbmluZyB0aGUgcHJp
dmF0ZSBrZXkgYmVsb25naW5nIHRvIHRoZSBwb3AzLXNwZWNpZmljIHNlcnZlcgotY2VydGlmaWNh
dGUuICBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgZ2xvYmFsIHByaXZhdGUga2V5IGlzIHVzZWQuICBB
Ci12YWx1ZSBvZiAiZGlzYWJsZWQiIHdpbGwgZGlzYWJsZSBTU0wvVExTIGZvciBwb3AzLgotLklQ
ICJcZkJ0bHNfcG9wM19yZXF1aXJlX2NlcnQ6XGZSIDAiIDUKLVJlcXVpcmUgYSBjbGllbnQgY2Vy
dGlmaWNhdGUgZm9yIHBvcDMgT05MWS4KLS5JUCAiXGZCdGxzX2xtdHBfY2VydF9maWxlOlxmUiA8
bm9uZT4iIDUKLUZpbGUgY29udGFpbmluZyB0aGUgY2VydGlmaWNhdGUgdXNlZCBmb3IgbG10cCBP
TkxZLiAgSWYgbm90IHNwZWNpZmllZCwKLXRoZSBnbG9iYWwgY2VydGlmaWNhdGUgaXMgdXNlZC4g
IEEgdmFsdWUgb2YgImRpc2FibGVkIiB3aWxsIGRpc2FibGUKLVRMUyBmb3IgbG10cC4KLS5JUCAi
XGZCdGxzX2xtdHBfa2V5X2ZpbGU6XGZSIDxub25lPiIgNQotRmlsZSBjb250YWluaW5nIHRoZSBw
cml2YXRlIGtleSBiZWxvbmdpbmcgdG8gdGhlIGxtdHAtc3BlY2lmaWMgc2VydmVyCi1jZXJ0aWZp
Y2F0ZS4gIElmIG5vdCBzcGVjaWZpZWQsIHRoZSBnbG9iYWwgcHJpdmF0ZSBrZXkgaXMgdXNlZC4g
IEEKLXZhbHVlIG9mICJkaXNhYmxlZCIgd2lsbCBkaXNhYmxlIFRMUyBmb3IgbG10cC4KLS5JUCAi
XGZCdGxzX2xtdHBfcmVxdWlyZV9jZXJ0OlxmUiAwIiA1Ci1SZXF1aXJlIGEgY2xpZW50IGNlcnRp
ZmljYXRlIGZvciBsbXRwIE9OTFkuCi0uSVAgIlxmQnRsc19zaWV2ZV9jZXJ0X2ZpbGU6XGZSIDxu
b25lPiIgNQotRmlsZSBjb250YWluaW5nIHRoZSBjZXJ0aWZpY2F0ZSB1c2VkIGZvciBzaWV2ZSBP
TkxZLiAgSWYgbm90IHNwZWNpZmllZCwKLXRoZSBnbG9iYWwgY2VydGlmaWNhdGUgaXMgdXNlZC4g
IEEgdmFsdWUgb2YgImRpc2FibGVkIiB3aWxsIGRpc2FibGUKLVRMUyBmb3Igc2lldmUuCi0uSVAg
IlxmQnRsc19zaWV2ZV9rZXlfZmlsZTpcZlIgPG5vbmU+IiA1Ci1GaWxlIGNvbnRhaW5pbmcgdGhl
IHByaXZhdGUga2V5IGJlbG9uZ2luZyB0byB0aGUgc2lldmUtc3BlY2lmaWMgc2VydmVyCi1jZXJ0
aWZpY2F0ZS4gIElmIG5vdCBzcGVjaWZpZWQsIHRoZSBnbG9iYWwgcHJpdmF0ZSBrZXkgaXMgdXNl
ZC4gIEEKLXZhbHVlIG9mICJkaXNhYmxlZCIgd2lsbCBkaXNhYmxlIFRMUyBmb3Igc2lldmUuCi0u
SVAgIlxmQnRsc19zaWV2ZV9yZXF1aXJlX2NlcnQ6XGZSIDAiIDUKLVJlcXVpcmUgYSBjbGllbnQg
Y2VydGlmaWNhdGUgZm9yIHNpZXZlIE9OTFkuCi0uSVAgIlxmQnRsc19jYV9maWxlOlxmUiA8bm9u
ZT4iIDUKLUZpbGUgY29udGFpbmluZyBvbmUgb3IgbW9yZSBDZXJ0aWZpY2F0ZSBBdXRob3JpdHkg
KENBKSBjZXJ0aWZpY2F0ZXMuCi0uSVAgIlxmQnRsc19jYV9wYXRoOlxmUiA8bm9uZT4iIDUKLVBh
dGggdG8gZGlyZWN0b3J5IHdpdGggY2VydGlmaWNhdGVzIG9mIENBcy4KLS5JUCAiXGZCdGxzX3Nl
c3Npb25fdGltZW91dDpcZlIgMTQ0MCIgNQotVGhlIGxlbmd0aCBvZiB0aW1lIChpbiBtaW51dGVz
KSB0aGF0IGEgVExTIHNlc3Npb24gd2lsbCBiZSBjYWNoZWQgZm9yCi1sYXRlciByZXVzZS4gIFRo
ZSBtYXhpbXVtIHZhbHVlIGlzIDE0NDAgKDI0IGhvdXJzKSwgdGhlIGRlZmF1bHQuICBBCi12YWx1
ZSBvZiAwIHdpbGwgZGlzYWJsZSBzZXNzaW9uIGNhY2hpbmcuCi0uSVAgIlxmQnRsc19jaXBoZXJf
bGlzdDpcZlIgREVGQVVMVCIgNQotVGhlIGxpc3Qgb2YgU1NML1RMUyBjaXBoZXJzIHRvIGFsbG93
LiAgVGhlIGZvcm1hdCBvZiB0aGUgc3RyaW5nIGlzCi1kZXNjcmliZWQgaW4gY2lwaGVycygxKS4K
LS5JUCAiXGZCZGVsZXRlcmlnaHQ6XGZSIGMiIDUKLVRoZSByaWdodCB0aGF0IGEgdXNlciBuZWVk
cyB0byBkZWxldGUgYSBtYWlsYm94LgotLklQICJcZkJsbXRwc29ja2V0OlxmUiAvdmFyL2ltYXAv
c29ja2V0L2xtdHAiIDUKLVVuaXggZG9tYWluIHNvY2tldCB0aGF0IGxtdHBkIGxpc3RlbnMgb24s
IHVzZWQgYnkgZGVsaXZlcig4KS4KLS5JUCAiXGZCaWRsZXNvY2tldDpcZlIgL3Zhci9pbWFwL3Nv
Y2tldC9pZGxlIiA1Ci1Vbml4IGRvbWFpbiBzb2NrZXQgdGhhdCBpZGxlZCBsaXN0ZW5zIG9uLgot
LklQICJcZkJub3RpZnlzb2NrZXQ6XGZSIC92YXIvaW1hcC9zb2NrZXQvbm90aWZ5IiA1Ci1Vbml4
IGRvbWFpbiBzb2NrZXQgdGhhdCB0aGUgbmV3IG1haWwgbm90aWZpY2F0aW9uIGRhZW1vbiBsaXN0
ZW5zIG9uLgotLklQICJcZkJkZWJ1Z19jb21tYW5kOlxmUiA8bm9uZT4iIDUKLURlYnVnIGNvbW1h
bmQgdG8gYmUgdXNlZCBieSBwcm9jZXNzZXMgc3RhcnRlZCB3aXRoIC1EIG9wdGlvbi4gIFRoZSBz
dHJpbmcKLWlzIGEgQyBmb3JtYXQgc3RyaW5nIHRoYXQgZ2V0cyAzIG9wdGlvbnM6IHRoZSBmaXJz
dCBpcyB0aGUgbmFtZSBvZiB0aGUKLWV4ZWN1dGFibGUgKHdpdGhvdXQgcGF0aCkuICBUaGUgc2Vj
b25kIGlzIHRoZSBwaWQgKGludGVnZXIpIGFuZCB0aGUgdGhpcmQKLWlzIHRoZSBzZXJ2aWNlIElE
LiAgRXhhbXBsZTogL3Vzci9sb2NhbC9iaW4vZ2RiIC91c3IvY3lydXMvYmluLyVzICVkCi0uSVAg
IlxmQnByb3h5ZF9hbGxvd19zdGF0dXNfcmVmZXJyYWw6XGZSIGZhbHNlIiA1Ci1TZXQgdG8gdHJ1
ZSB0byBhbGxvdyBwcm94eWQgdG8gaXNzdWUgcmVmZXJyYWxzIHRvIGNsaWVudHMgdGhhdCBzdXBw
b3J0IGl0Ci13aGVuIGFuc3dlcmluZyB0aGUgU1RBVFVTIGNvbW1hbmQuICBUaGlzIGlzIGRpc2Fi
bGVkIGJ5IGRlZmF1bHQgc2luY2UKLXNvbWUgY2xpZW50cyBpc3N1ZSBtYW55IFNUQVRVUyBjb21t
YW5kcyBpbiBhIHJvdywgYW5kIGRvIG5vdCBjYWNoZSB0aGUKLWNvbm5lY3Rpb25zIHRoYXQgdGhl
c2UgcmVmZXJyYWxzIHdvdWxkIGNhdXNlLCB0aHVzIHJlc3VsdGluZyBpbiBhIGhpZ2hlcgotYXV0
aGVudGljYXRpb24gbG9hZCBvbiB0aGUgcmVzcGVjdGl2ZSBiYWNrZW5kIHNlcnZlci4KLS5JUCAi
XGZCbXVwZGF0ZV9zZXJ2ZXI6XGZSIDxub25lPiIgNQotVGhlIG11cGRhdGUgc2VydmVyIGZvciB0
aGUgQ3lydXMgTXVyZGVyCi0uSVAgIlxmQm11cGRhdGVfcG9ydDpcZlIgPG5vbmU+IiA1Ci1UaGUg
cG9ydCBvZiB0aGUgbXVwZGF0ZSBzZXJ2ZXIgZm9yIHRoZSBDeXJ1cyBNdXJkZXIKLS5JUCAiXGZC
bXVwZGF0ZV91c2VybmFtZTpcZlIgPG5vbmU+IiA1Ci1UaGUgU0FTTCB1c2VybmFtZSAoQXV0aG9y
aXphdGlvbiBOYW1lKSB0byB1c2Ugd2hlbiBhdXRoZW50aWNhdGluZyB0byB0aGUgbXVwZGF0ZSBz
ZXJ2ZXIuCi0uSVAgIlxmQm11cGRhdGVfYXV0aG5hbWU6XGZSIDxub25lPiIgNQotVGhlIFNBU0wg
dXNlcm5hbWUgKEF1dGhlbnRpY2F0aW9uIE5hbWUpIHRvIHVzZSB3aGVuIGF1dGhlbnRpY2F0aW5n
IHRvIHRoZQotbXVwZGF0ZSBzZXJ2ZXIgKGlmIG5lZWRlZCkuCi0uSVAgIlxmQm11cGRhdGVfcmVh
bG06XGZSIDxub25lPiIgNQotVGhlIFNBU0wgcmVhbG0gKGlmIG5lZWRlZCkgdG8gdXNlIHdoZW4g
YXV0aGVudGljYXRpbmcgdG8gdGhlIG11cGRhdGUgc2VydmVyLgotLklQICJcZkJtdXBkYXRlX3Bh
c3N3b3JkOlxmUiA8bm9uZT4iIDUKLVRoZSBTQVNMIHBhc3N3b3JkIChpZiBuZWVkZWQpIHRvIHVz
ZSB3aGVuIGF1dGhlbnRpY2F0aW5nIHRvIHRoZSBtdXBkYXRlIHNlcnZlci4KLS5JUCAiXGZCbXVw
ZGF0ZV9yZXRyeV9kZWxheTpcZlIgMjAiIDUKLVRoZSB0aW1lIHRvIHdhaXQgYmV0d2VlbiBjb25u
ZWN0aW9uIHJldHJpZXMgdG8gdGhlIG11cGRhdGUgc2VydmVyLgotLlNIIFNFRSBBTFNPCi0uUFAK
LVxmQmltYXBkKDgpXGZSLCBcZkJwb3AzZCg4KVxmUiwgXGZCbG10cGQoOClcZlIsIFxmQnRpbXNp
ZXZlZCg4KVxmUiwKLVxmQmlkbGVkKDgpXGZSLCBcZkJub3RpZnlkKDgpXGZSLCBcZkJkZWxpdmVy
KDgpXGZSLCBcZkJtYXN0ZXIoOClcZlIsIAotXGZCY2lwaGVycygxKVxmUgpJbmRleDogbm90aWZ5
ZC9ub3RpZnlfbWFpbHRvLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVk
dS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9ub3RpZnlkL25vdGlmeV9tYWlsdG8uYyx2CnJldHJpZXZp
bmcgcmV2aXNpb24gMS4zCmRpZmYgLXUgLXIxLjMgbm90aWZ5X21haWx0by5jCi0tLSBub3RpZnlf
bWFpbHRvLmMJMjAwMi8wMy8xOCAxNToxNDoxNwkxLjMKKysrIG5vdGlmeV9tYWlsdG8uYwkyMDAy
LzA2LzE5IDAwOjI0OjE4CkBAIC01OSwxMCArNTksNyBAQAogI2RlZmluZSBERUZBVUxUX1NFTkRN
QUlMICgiL3Vzci9saWIvc2VuZG1haWwiKQogI2RlZmluZSBERUZBVUxUX1BPU1RNQVNURVIgKCJw
b3N0bWFzdGVyIikKIAotI2RlZmluZSBTRU5ETUFJTCAoY29uZmlnX2dldHN0cmluZygic2VuZG1h
aWwiLCBERUZBVUxUX1NFTkRNQUlMKSkKLSNkZWZpbmUgUE9TVE1BU1RFUiAoY29uZmlnX2dldHN0
cmluZygicG9zdG1hc3RlciIsIERFRkFVTFRfUE9TVE1BU1RFUikpCiAKLQogc3RhdGljIGludCBn
bG9iYWxfb3V0Z29pbmdfY291bnQgPSAwOwogCiBjaGFyKiBub3RpZnlfbWFpbHRvKGNvbnN0IGNo
YXIgKmNsYXNzIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLApAQCAtOTksNyArOTYsNyBAQAogCWNs
b3NlKGZkc1sxXSk7CiAJLyogbWFrZSB0aGUgcGlwZSBiZSBzdGRpbiAqLwogCWR1cDIoZmRzWzBd
LCAwKTsKLQlleGVjdihTRU5ETUFJTCwgKGNoYXIgKiopIHNtYnVmKTsKKwlleGVjdihjb25maWdf
Z2V0c3RyaW5nKElNQVBPUFRfU0VORE1BSUwpLCAoY2hhciAqKikgc21idWYpOwogCiAJLyogaWYg
d2UncmUgaGVyZSB3ZSBzdWNrICovCiAJcmV0dXJuIHN0cmR1cCgiTk8gbWFpbHRvIGNvdWxkbid0
IGV4ZWMiKTsKQEAgLTEyMSw3ICsxMTgsNyBAQAogICAgIGZwcmludGYoc20sICJEYXRlOiAlc1xy
XG4iLCBkYXRlc3RyKTsKICAgICAKICAgICBmcHJpbnRmKHNtLCAiWC1TaWV2ZTogJXNcclxuIiwg
U0lFVkVfVkVSU0lPTik7Ci0gICAgZnByaW50ZihzbSwgIkZyb206IE1haWwgU2lldmUgU3Vic3lz
dGVtIDwlcz5cclxuIiwgUE9TVE1BU1RFUik7CisgICAgZnByaW50ZihzbSwgIkZyb206IE1haWwg
U2lldmUgU3Vic3lzdGVtIDwlcz5cclxuIiwgY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1BPU1RN
QVNURVIpKTsKICAgICBmcHJpbnRmKHNtLCAiVG86IDwlcz5cclxuIiwgb3B0aW9uc1swXSk7CiAg
ICAgZnByaW50ZihzbSwgIlN1YmplY3Q6IFtTSUVWRV0gTmV3IG1haWwgbm90aWZpY2F0aW9uXHJc
biIpOwogICAgIGZwcmludGYoc20sICJcclxuIik7CkluZGV4OiBub3RpZnlkL25vdGlmeWQuYwo9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5
cnVzL25vdGlmeWQvbm90aWZ5ZC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjgKZGlmZiAtdSAt
cjEuOCBub3RpZnlkLmMKLS0tIG5vdGlmeWQuYwkyMDAyLzA2LzAzIDE4OjIyOjM1CTEuOAorKysg
bm90aWZ5ZC5jCTIwMDIvMDYvMTkgMDA6MjU6MjEKQEAgLTIxMiw3ICsyMTIsNiBAQAogICAgIGlu
dCBvcHQ7CiAgICAgY2hhciAqbWV0aG9kID0gIm51bGwiOwogCi0gICAgY29uZmlnX2NoYW5nZWlk
ZW50KCJub3RpZnlkIik7CiAgICAgaWYgKGdldGV1aWQoKSA9PSAwKSBmYXRhbCgibXVzdCBydW4g
YXMgdGhlIEN5cnVzIHVzZXIiLCBFQ19VU0FHRSk7CiAKICAgICB3aGlsZSAoKG9wdCA9IGdldG9w
dChhcmdjLCBhcmd2LCAiQzpEbToiKSkgIT0gRU9GKSB7CkluZGV4OiB0aW1zaWV2ZWQvYWN0aW9u
cy5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9z
cmMvY3lydXMvdGltc2lldmVkL2FjdGlvbnMuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zMApk
aWZmIC11IC1yMS4zMCBhY3Rpb25zLmMKLS0tIGFjdGlvbnMuYwkyMDAyLzAyLzE5IDE4OjUwOjE1
CTEuMzAKKysrIGFjdGlvbnMuYwkyMDAyLzA2LzE5IDAwOjE2OjM3CkBAIC0xLDcgKzEsNiBAQAog
LyogYWN0aW9ucy5jIC0tIGV4ZWN1dGVzIHRoZSBjb21tYW5kcyBmb3IgdGltc2lldmVkCiAgKiBU
aW0gTWFydGluCiAgKiAkSWQ6IGFjdGlvbnMuYyx2IDEuMzAgMjAwMi8wMi8xOSAxODo1MDoxNSBr
ZW4zIEV4cCAkCi0gKiAKICAqLwogLyoKICAqIENvcHlyaWdodCAoYykgMTk5OS0yMDAwIENhcm5l
Z2llIE1lbGxvbiBVbml2ZXJzaXR5LiAgQWxsIHJpZ2h0cyByZXNlcnZlZC4KQEAgLTgxLDEwICs4
MCwxMCBAQAogewogICBpbnQgc2lldmVfdXNlaG9tZWRpciA9IDA7CiAKLSAgc2lldmVfdXNlaG9t
ZWRpciA9IGNvbmZpZ19nZXRzd2l0Y2goInNpZXZldXNlaG9tZWRpciIsIDApOworICBzaWV2ZV91
c2Vob21lZGlyID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX1NJRVZFVVNFSE9NRURJUik7CiAg
IAogICBpZiAoIXNpZXZlX3VzZWhvbWVkaXIpIHsKLSAgICAgIHNpZXZlX2RpciA9IChjaGFyICop
IGNvbmZpZ19nZXRzdHJpbmcoInNpZXZlZGlyIiwgIi91c3Ivc2lldmUiKTsKKyAgICAgIHNpZXZl
X2RpciA9IChjaGFyICopIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9TSUVWRURJUik7CiAgIH0g
ZWxzZSB7CiAgICAgICAvKiBjYW4ndCB1c2UgaG9tZSBkaXJlY3RvcmllcyB3aXRoIHRpbXNpZXZl
ZCAqLwogICAgICAgc3lzbG9nKExPR19FUlIsICJjYW4ndCB1c2UgaG9tZSBkaXJlY3RvcmllcyIp
OwpAQCAtMTY1LDcgKzE2NCw3IEBACiAgICAgLyogU2lldmUgY2FwYWJpbGl0aWVzICovCiAgICAg
cHJvdF9wcmludGYoY29ubiwiXCJTSUVWRVwiIFwiJXNcIlxyXG4iLHNpZXZlX2xpc3RleHRlbnNp
b25zKCkpOwogCi0gICAgaWYgKHRsc19lbmFibGVkKCJzaWV2ZSIpKSB7CisgICAgaWYgKHRsc19l
bmFibGVkKCkpIHsKIAlwcm90X3ByaW50Zihjb25uLCAiXCJTVEFSVFRMU1wiXHJcbiIpOwogICAg
IH0KIApAQCAtMjkyLDcgKzI5MSw3IEBACiAKICAgZWxzZSB7CiAgICAgICAvKiBzZWUgaWYgdGhp
cyB3b3VsZCBwdXQgdGhlIHVzZXIgb3ZlciBxdW90YSAqLwotICAgICAgbWF4c2NyaXB0cyA9IGNv
bmZpZ19nZXRpbnQoInNpZXZlX21heHNjcmlwdHMiLDUpOworICAgICAgbWF4c2NyaXB0cyA9IGNv
bmZpZ19nZXRpbnQoSU1BUE9QVF9TSUVWRV9NQVhTQ1JJUFRTKTsKIAogICAgICAgaWYgKGNvdW50
c2NyaXB0cyhzdHJpbmdfREFUQVBUUihuYW1lKSkrMSA+IG1heHNjcmlwdHMpCiAgICAgICB7CkBA
IC01NTksNyArNTU4LDcgQEAKICAgICB9CiAKICAgICAvKiBzZWUgaWYgdGhlIHNpemUgb2YgdGhl
IHNjcmlwdCBpcyB0b28gYmlnICovCi0gICAgbWF4c2NyaXB0c2l6ZSA9IGNvbmZpZ19nZXRpbnQo
InNpZXZlX21heHNjcmlwdHNpemUiLCAzMik7CisgICAgbWF4c2NyaXB0c2l6ZSA9IGNvbmZpZ19n
ZXRpbnQoSU1BUE9QVF9TSUVWRV9NQVhTQ1JJUFRTSVpFKTsKICAgICBtYXhzY3JpcHRzaXplICo9
IDEwMjQ7CiAKICAgICBpZiAobnVtID4gbWF4c2NyaXB0c2l6ZSkKQEAgLTU3Miw3ICs1NzEsNyBA
QAogICAgIH0KIAogICAgIC8qIHNlZSBpZiB0aGlzIHdvdWxkIHB1dCB0aGUgdXNlciBvdmVyIHF1
b3RhICovCi0gICAgbWF4c2NyaXB0cyA9IGNvbmZpZ19nZXRpbnQoInNpZXZlX21heHNjcmlwdHMi
LDUpOworICAgIG1heHNjcmlwdHMgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfU0lFVkVfTUFYU0NS
SVBUUyk7CiAKICAgICBpZiAoY291bnRzY3JpcHRzKHN0cmluZ19EQVRBUFRSKHNpZXZlX25hbWUp
KSsxID4gbWF4c2NyaXB0cykKICAgICB7CkluZGV4OiB0aW1zaWV2ZWQvbGV4LmMKPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy90aW1z
aWV2ZWQvbGV4LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTkKZGlmZiAtdSAtcjEuMTkgbGV4
LmMKLS0tIGxleC5jCTIwMDIvMDIvMTYgMjA6NTY6NTYJMS4xOQorKysgbGV4LmMJMjAwMi8wNi8x
OSAwMDoxODo0NApAQCAtNjIsNyArNjIsNyBAQAogI2luY2x1ZGUgImltYXBjb25mLmgiCiAjaW5j
bHVkZSAieG1hbGxvYy5oIgogCi1pbnQgdG9rZW5fbG9va3VwIChjaGFyICpzdHIsIGludCBsZW4p
CitpbnQgdG9rZW5fbG9va3VwIChjaGFyICpzdHIsIGludCBsZW4gX19hdHRyaWJ1dGVfXygodW51
c2VkKSkpCiB7CiAgICAgc3dpdGNoICgqc3RyKSB7CiAgICAgY2FzZSAnYSc6CkBAIC05NSw3ICs5
NSw3IEBACiAKICAgICBjYXNlICdzJzoKIAlpZiAoc3RyY21wKHN0ciwgInNldGFjdGl2ZSIpPT0w
KSByZXR1cm4gU0VUQUNUSVZFOwotCWlmIChzdHJjbXAoc3RyLCAic3RhcnR0bHMiKT09MCAmJiB0
bHNfZW5hYmxlZCgic2lldmUiKSkKKwlpZiAoc3RyY21wKHN0ciwgInN0YXJ0dGxzIik9PTAgJiYg
dGxzX2VuYWJsZWQoKSkKIAkgICAgcmV0dXJuIFNUQVJUVExTOwogCWJyZWFrOwogICAgIH0KQEAg
LTEzNiw3ICsxMzYsNyBAQAogCiBpbnQgbGV4X2luaXQodm9pZCkKIHsKLSAgbWF4c2NyaXB0c2l6
ZSA9IGNvbmZpZ19nZXRpbnQoInNpZXZlX21heHNjcmlwdHNpemUiLCAzMik7CisgIG1heHNjcmlw
dHNpemUgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfU0lFVkVfTUFYU0NSSVBUU0laRSk7CiAgIG1h
eHNjcmlwdHNpemUgKj0gMTAyNDsKIAogICBidWZmZXIgPSAoY2hhciAqKSB4bWFsbG9jKG1heHNj
cmlwdHNpemUpOwpJbmRleDogdGltc2lldmVkL3BhcnNlci5jCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6
IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvdGltc2lldmVkL3BhcnNl
ci5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjIwCmRpZmYgLXUgLXIxLjIwIHBhcnNlci5jCi0t
LSBwYXJzZXIuYwkyMDAyLzA2LzAyIDE1OjI1OjQ0CTEuMjAKKysrIHBhcnNlci5jCTIwMDIvMDYv
MTkgMDA6MjE6MTUKQEAgLTEyNiw3ICsxMjYsNyBAQAogCiAgIGlmICghYXV0aGVudGljYXRlZCAm
JiAodG9rZW4gPiAyNTUpICYmICh0b2tlbiE9QVVUSEVOVElDQVRFKSAmJgogICAgICAgKHRva2Vu
IT1MT0dPVVQpICYmICh0b2tlbiE9Q0FQQUJJTElUWSkgJiYKLSAgICAgICghdGxzX2VuYWJsZWQo
InNpZXZlIikgfHwgKHRva2VuIT1TVEFSVFRMUykpKQorICAgICAgKCF0bHNfZW5hYmxlZCgpIHx8
ICh0b2tlbiE9U1RBUlRUTFMpKSkKICAgewogICAgIGVycm9yX21zZyA9ICJBdXRoZW50aWNhdGUg
Zmlyc3QiOwogICAgIGlmICh0b2tlbiE9RU9MKQpJbmRleDogdGltc2lldmVkL3RpbXNpZXZlZC5j
Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMv
Y3lydXMvdGltc2lldmVkL3RpbXNpZXZlZC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjQwCmRp
ZmYgLXUgLXIxLjQwIHRpbXNpZXZlZC5jCi0tLSB0aW1zaWV2ZWQuYwkyMDAyLzA1LzI1IDE5OjU3
OjUzCTEuNDAKKysrIHRpbXNpZXZlZC5jCTIwMDIvMDYvMTkgMDA6MjA6MjkKQEAgLTIwNiw3ICsy
MDYsNyBAQAogICAgIC8qIGNoZWNrIGlmIHJlbW90ZSByZWFsbSAqLwogICAgIGlmICgocmVhbG0g
PSBzdHJjaHIoYXV0aF9pZGVudGl0eSwgJ0AnKSkhPU5VTEwpIHsKIAlyZWFsbSsrOwotCXZhbCA9
IGNvbmZpZ19nZXRzdHJpbmcoImxvZ2lucmVhbG1zIiwgIiIpOworCXZhbCA9IGNvbmZpZ19nZXRz
dHJpbmcoSU1BUE9QVF9MT0dJTlJFQUxNUyk7CiAJd2hpbGUgKCp2YWwpIHsKIAkgICAgaWYgKCFz
dHJuY2FzZWNtcCh2YWwsIHJlYWxtLCBzdHJsZW4ocmVhbG0pKSAmJgogCQkoIXZhbFtzdHJsZW4o
cmVhbG0pXSB8fCBpc3NwYWNlKChpbnQpIHZhbFtzdHJsZW4ocmVhbG0pXSkpKSB7CkBAIC0yMjYs
MTYgKzIyNiwxNiBAQAogICAgIHNpZXZlZF9hdXRoc3RhdGUgPSBhdXRoX25ld3N0YXRlKGF1dGhf
aWRlbnRpdHksIE5VTEwpOwogCiAgICAgLyogb2ssIGlzIGF1dGhfaWRlbnRpdHkgYW4gYWRtaW4/
ICovCi0gICAgc2lldmVkX3VzZXJpc2FkbWluID0gYXV0aGlzYShzaWV2ZWRfYXV0aHN0YXRlLCAi
c2lldmUiLCAiYWRtaW5zIik7CisgICAgc2lldmVkX3VzZXJpc2FkbWluID0gY29uZmlnX2F1dGhp
c2Eoc2lldmVkX2F1dGhzdGF0ZSwgSU1BUE9QVF9BRE1JTlMpOwogCiAgICAgaWYgKHN0cmNtcChh
dXRoX2lkZW50aXR5LCByZXF1ZXN0ZWRfdXNlcikpIHsKICAgICAgICAgLyogd2Ugd2FudCB0byBh
dXRoZW50aWNhdGUgYXMgYSBkaWZmZXJlbnQgdXNlcjsgd2UnbGwgYWxsb3cgdGhpcwogICAgICAg
ICAgICBpZiB3ZSdyZSBhbiBhZG1pbiBvciBpZiB3ZSd2ZSBhbGxvd2VkIEFDTCBwcm94eSBsb2dp
bnMgKi8KLSAgICAgICAgaW50IHVzZV9hY2wgPSBjb25maWdfZ2V0c3dpdGNoKCJsb2dpbnVzZWFj
bCIsIDApOworICAgICAgICBpbnQgdXNlX2FjbCA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9M
T0dJTlVTRUFDTCk7CiAKICAgICAgICAgaWYgKHNpZXZlZF91c2VyaXNhZG1pbiB8fAogICAgICAg
ICAgICAgKHVzZV9hY2wgJiYgYWNsX29rKHJlcXVlc3RlZF91c2VyLCBhdXRoX2lkZW50aXR5LCBz
aWV2ZWRfYXV0aHN0YXRlKSkgfHwKLSAgICAgICAgICAgIGF1dGhpc2Eoc2lldmVkX2F1dGhzdGF0
ZSwgInNpZXZlIiwgInByb3h5c2VydmVycyIpKSB7CisgICAgICAgICAgICBjb25maWdfYXV0aGlz
YShzaWV2ZWRfYXV0aHN0YXRlLCBJTUFQT1BUX1BST1hZU0VSVkVSUykpIHsKICAgICAgICAgICAg
IC8qIHByb3h5IG9rISAqLwogCiAJICAgIHNpZXZlZF91c2VyaXNhZG1pbiA9IDA7IC8qIG5vIGxv
bmdlciBhZG1pbiAqLwpAQCAtMjg5LDggKzI4OSw3IEBACiAgICAgc2lldmVkX2luID0gcHJvdF9u
ZXcoMCwgMCk7CiAgICAgc2lldmVkX291dCA9IHByb3RfbmV3KDEsIDEpOwogCi0gICAgY29uZmln
X2NoYW5nZWlkZW50KCJ0aW1zaWV2ZWQiKTsKLSAgICB0aW1lb3V0ID0gY29uZmlnX2dldGludCgi
dGltZW91dCIsIDEwKTsKKyAgICB0aW1lb3V0ID0gY29uZmlnX2dldGludChJTUFQT1BUX1RJTUVP
VVQpOwogICAgIGlmICh0aW1lb3V0IDwgMTApIHRpbWVvdXQgPSAxMDsKICAgICBwcm90X3NldHRp
bWVvdXQoc2lldmVkX2luLCB0aW1lb3V0ICogNjApOwogICAgIHByb3Rfc2V0Zmx1c2hvbnJlYWQo
c2lldmVkX2luLCBzaWV2ZWRfb3V0KTsKQEAgLTM1MCw3ICszNDksNyBAQAogCiAgICAgLyogd2ls
bCBhbHdheXMgcmV0dXJuIHNvbWV0aGluZyB2YWxpZCAqLwogICAgIC8qIHNob3VsZCBiZSBjb25m
aWd1cmFibGUhICovCi0gICAgaWYgKCFjb25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIs
IDEpKSB7CisgICAgaWYgKCFjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dQTEFJTlRFWFQp
KSB7CiAJc2VjZmxhZ3MgfD0gU0FTTF9TRUNfTk9QTEFJTlRFWFQ7CiAgICAgfQogICAgIHNlY3By
b3BzID0gbXlzYXNsX3NlY3Byb3BzKHNlY2ZsYWdzKTsKQEAgLTM4OSw3ICszODgsNyBAQAogCQkJ
ICAgc2FzbHByb3BzLmlwbG9jYWxwb3J0KTsKICAgICBpZihyZXQgIT0gU0FTTF9PSykgcmV0dXJu
IHJldDsKICAgICAKLSAgICBpZiAoIWNvbmZpZ19nZXRzd2l0Y2goImFsbG93cGxhaW50ZXh0Iiwg
MSkpIHsKKyAgICBpZiAoIWNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV1BMQUlOVEVYVCkp
IHsKIAlzZWNmbGFncyB8PSBTQVNMX1NFQ19OT1BMQUlOVEVYVDsKICAgICB9CiAgICAgc2VjcHJv
cHMgPSBteXNhc2xfc2VjcHJvcHMoc2VjZmxhZ3MpOwpJbmRleDogdG9vbHMvY29uZmlnMmhlYWRl
cgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09ClJDUyBmaWxlOiBjb25maWcyaGVhZGVyCmRpZmYgLU4gY29uZmlnMmhlYWRl
cgotLS0gL2Rldi9udWxsCVR1ZSBKdW4gMTggMDY6MDE6MjMgMjAwMgorKysgY29uZmlnMmhlYWRl
cglUdWUgSnVuIDE4IDEzOjQ5OjA5IDIwMDIKQEAgLTAsMCArMSwxNzUgQEAKKyMhL2Jpbi9zaAor
IyAkSWQkCisjCisjIENvcHlyaWdodCAoYykgMjAwMSBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0
eS4gIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisjCisjIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4g
c291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAorIyBtb2RpZmljYXRpb24s
IGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKKyMg
YXJlIG1ldDoKKyMKKyMgMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0
YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQKKyMgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0
aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLiAKKyMKKyMgMi4gUmVkaXN0cmlidXRp
b25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQKKyMg
ICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNj
bGFpbWVyIGluCisjICAgIHRoZSBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMg
cHJvdmlkZWQgd2l0aCB0aGUKKyMgICAgZGlzdHJpYnV0aW9uLgorIworIyAzLiBUaGUgbmFtZSAi
Q2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkiIG11c3Qgbm90IGJlIHVzZWQgdG8KKyMgICAgZW5k
b3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzIGRlcml2ZWQgZnJvbSB0aGlzIHNvZnR3YXJlIHdpdGhv
dXQKKyMgICAgcHJpb3Igd3JpdHRlbiBwZXJtaXNzaW9uLiBGb3IgcGVybWlzc2lvbiBvciBhbnkg
b3RoZXIgbGVnYWwKKyMgICAgZGV0YWlscywgcGxlYXNlIGNvbnRhY3QgIAorIyAgICAgIE9mZmlj
ZSBvZiBUZWNobm9sb2d5IFRyYW5zZmVyCisjICAgICAgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNp
dHkKKyMgICAgICA1MDAwIEZvcmJlcyBBdmVudWUKKyMgICAgICBQaXR0c2J1cmdoLCBQQSAgMTUy
MTMtMzg5MAorIyAgICAgICg0MTIpIDI2OC00Mzg3LCBmYXg6ICg0MTIpIDI2OC03Mzk1CisjICAg
ICAgdGVjaC10cmFuc2ZlckBhbmRyZXcuY211LmVkdQorIworIyA0LiBSZWRpc3RyaWJ1dGlvbnMg
b2YgYW55IGZvcm0gd2hhdHNvZXZlciBtdXN0IHJldGFpbiB0aGUgZm9sbG93aW5nCisjICAgIGFj
a25vd2xlZGdtZW50OgorIyAgICAiVGhpcyBwcm9kdWN0IGluY2x1ZGVzIHNvZnR3YXJlIGRldmVs
b3BlZCBieSBDb21wdXRpbmcgU2VydmljZXMKKyMgICAgIGF0IENhcm5lZ2llIE1lbGxvbiBVbml2
ZXJzaXR5IChodHRwOi8vd3d3LmNtdS5lZHUvY29tcHV0aW5nLykuIgorIworIyBDQVJORUdJRSBN
RUxMT04gVU5JVkVSU0lUWSBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSCBSRUdBUkQgVE8K
KyMgVEhJUyBTT0ZUV0FSRSwgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVS
Q0hBTlRBQklMSVRZCisjIEFORCBGSVRORVNTLCBJTiBOTyBFVkVOVCBTSEFMTCBDQVJORUdJRSBN
RUxMT04gVU5JVkVSU0lUWSBCRSBMSUFCTEUKKyMgRk9SIEFOWSBTUEVDSUFMLCBJTkRJUkVDVCBP
UiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMKKyMgV0hBVFNPRVZFUiBSRVNV
TFRJTkcgRlJPTSBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOCisjIEFO
IEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUiBPVEhFUiBUT1JUSU9VUyBBQ1RJT04s
IEFSSVNJTkcKKyMgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SIFBFUkZP
Uk1BTkNFIE9GIFRISVMgU09GVFdBUkUuCisjCitleGVjIHBlcmwgLXggLVMgJDAgJHsxKyIkQCJ9
ICMgLSotcGVybC0qLQorIyFwZXJsIC13CisKK2lmICgkXSAhfiAvXjVcLi4qLykgeworICAjIHVo
LW9oLiB0aGlzIGlzbid0IHBlcmwgNS4KKyAgZm9yZWFjaCAoc3BsaXQoLzovLCAkRU5We1BBVEh9
KSkgeyAjIHRyeSB0byBmaW5kICJwZXJsNSIuCisgICAgZXhlYygiJF8vcGVybDUiLCAiLXgiLCAi
LVMiLCAkMCwgQEFSR1YpIGlmICgteCAiJF8vcGVybDUiKTsKKyAgfQorICAjIHdlIGZhaWxlZC4g
YmFpbC4KKyAgZGllICJZb3VyIHBlcmwgaXMgdG9vIG9sZDsgSSBuZWVkIHBlcmwgNS5cbiI7Cit9
CisKKyMgbG9hZCB0aGUgcmVhbCBzY3JpcHQuIHRoaXMgaXMgaXNvbGF0ZWQgaW4gYW4gJ2V2YWwn
IHNvIHBlcmw0IHdvbid0CisjIGNob2tlIG9uIHRoZSBwZXJsNS1pc21zLgorZXZhbCBqb2luKCJc
biIsIDxEQVRBPik7CitpZiAoJEApIHsgZGllICIkQCI7IH0KKworX19FTkRfXworcmVxdWlyZSA1
OworCit1c2Ugc3RyaWN0OworCitteSAkbW9kZSA9IDA7CitteSAkc2F2ZSA9ICIiOworCitkaWUg
Indyb25nIG51bWJlciBvZiBhcmd1bWVudHMiIGlmICgkI0FSR1YgIT0gMSk7CitteSAoJGNmaWxl
LCAkaGZpbGUpID0gQEFSR1Y7CisKK29wZW4gQ0ZJTEUsICI+JGNmaWxlIjsKK29wZW4gSEZJTEUs
ICI+JGhmaWxlIjsKKworbXkgJGJsYW5rID0gIiI7CitteSAkdmVyc2lvbiA9ICJcJFJldmlzaW9u
JGJsYW5rIjsKKyR2ZXJzaW9uID1+IHMvLlJldmlzaW9uOiAoLiopIC8kMS87CitwcmludCBIRklM
RSAiLyogYXV0by1nZW5lcmF0ZWQgYnkgY29uZmlnMmhlYWRlciAkdmVyc2lvbiAqL1xuIjsKK3By
aW50IENGSUxFICIvKiBhdXRvLWdlbmVyYXRlZCBieSBjb25maWcyaGVhZGVyICR2ZXJzaW9uICov
XG4iOworCitwcmludCBIRklMRSAiI2lmbmRlZiBJTkNMVURFRF9JTUFQT1BUU19IXG4iOworcHJp
bnQgSEZJTEUgIiNkZWZpbmUgSU5DTFVERURfSU1BUE9QVFNfSFxuIjsKK3ByaW50IEhGSUxFICJc
biI7CisKKyMgcHJvdG90eXBlcworbXkgJG9wdDsKKworcHJpbnQgSEZJTEUgImVudW0gb3B0dHlw
ZSB7XG4iOworZm9yZWFjaCAkb3B0ICgiT1BUX05PVE9QVCIsIk9QVF9TVFJJTkciLCJPUFRfSU5U
IiwiT1BUX1NXSVRDSCIpIHsKKyAgICBwcmludCBIRklMRSAiICAkb3B0LFxuIjsKK30KK3ByaW50
IEhGSUxFICJ9O1xuXG4iOworCitwcmludCBIRklMRSA8PEVPRgorZW51bSBpbWFwb3B0IHsKKyAg
SU1BUE9QVF9aRVJPID0gMCwKK0VPRgorICAgIDsKKworcHJpbnQgQ0ZJTEUgPDxFT0YKKy8qIERP
IE5PVCBFRElUICovCisvKiBUSElTIEZJTEUgQVVUT01BVElDQUxMWSBHRU5FUkFURUQgQlkgY29u
ZmlnMmhlYWRlciAkdmVyc2lvbiAqLworI2luY2x1ZGUgPGNvbmZpZy5oPgorI2luY2x1ZGUgPHN5
cy90eXBlcy5oPgorI2lmZGVmIEhBVkVfVU5JU1REX0gKKyNpbmNsdWRlIDx1bmlzdGQuaD4KKyNl
bmRpZgorI2luY2x1ZGUgPHN5c2xvZy5oPgorI2luY2x1ZGUgPGNvbV9lcnIuaD4KKyNpbmNsdWRl
IDxzdGRsaWIuaD4KKyNpbmNsdWRlIDxzdHJpbmcuaD4KKyNpbmNsdWRlICJpbWFwb3B0cy5oIgor
CitzdHJ1Y3QgaW1hcG9wdF9zIGltYXBvcHRzW10gPQoreworICAgIHsgSU1BUE9QVF9aRVJPLCAi
IiwgMCwgeyBOVUxMIH0sIE9QVF9OT1RPUFQgfSwKK0VPRgorICAgIDsKKworIyBvdXRwdXQgZW51
bWVyYXRpb24KKword2hpbGUgKDxTVERJTj4pIHsKKyAgICBuZXh0IGlmICgvXlwjLyk7CisgICAg
IyBsb29rIGZvciB7IG9wdGlvbiwgZGVmYXVsdCwgdHlwZSB9CisKKyAgICAjIE5vdGUgdGhhdCB0
aGUgY29kZSB3ZSBvdXRwdXQgaGFzIHRvIHBsYXkgaW50ZXJlc3RpbmcgZ2FtZXMgdG8gZ2V0Cisg
ICAgIyB0aGUgdW5pb24gdG8gaW5pdGlsaXplIGl0c2VsZiBpbiBhIHN5bnRhY3RpY2x5IHZhbGlk
IG1hbm5lci4KKyAgICAjIE5hbWVseSwgd2UgbmVlZCB0byBpbml0aWxpemUgdGhlIHVuaW9uIGl0
c2VsZiwgbm90IHRoZSBtZW1iZXJzIG9mCisgICAgIyB0aGUgdW5pb24sIGFuZCB3ZSBuZWVkIHRv
IGVuc3VyZSB3ZSBhcmUgaW5pdGlsaXppbmcgdGhlIHVuaW9uIHdpdGgKKyAgICAjIHNvbXRoaW5n
IG9mIGEgdHlwZSB0aGF0IGlzIGluIHRoZSB1bmlvbi4KKyAgICBpZiAobXx7XHMqXCIoLio/KVwi
XHMqLFxzKihcIj8uKj9cIj8pXHMqLFxzKiguKj8pXHMqfXwpIHsKKwlteSAkb3B0ID0gJDE7CisJ
bXkgJHZhbHVlOworCisJcHJpbnQgSEZJTEUgIiAgSU1BUE9QVF8iLCB1Yygkb3B0KSwgIixcbiI7
CisKKwlpZigkMyBlcSAiU1RSSU5HIikgeworCSAgICAkdmFsdWUgPSAiKHVuaW9uIGNvbmZpZ192
YWx1ZSkoKGNvbnN0IGNoYXIgKikkMikiOworCX0gZWxzZSB7CisJICAgICR2YWx1ZSA9ICIodW5p
b24gY29uZmlnX3ZhbHVlKSgoaW50KSQyKSI7CisJfQorCisJcHJpbnQgQ0ZJTEUgIiAgeyBJTUFQ
T1BUXyIsIHVjKCRvcHQpLCAiLCBcIiQxXCIsIDAsICR2YWx1ZSwgT1BUXyQzIH0sXG4iOworICAg
IH0gZWxzZSB7CisJI2Nob21wOworCSNwcmludCAicmVqZWN0ZWQgJyRfJ1xuIjsKKyAgICB9Cit9
CisKK3ByaW50IEhGSUxFIDw8RU9GCisgIElNQVBPUFRfTEFTVAorfTsKK2V4dGVybiBzdHJ1Y3Qg
aW1hcG9wdF9zIGltYXBvcHRzW107Cit1bmlvbiBjb25maWdfdmFsdWUgeworICAgICAgIGNvbnN0
IGNoYXIgKnM7CisgICAgICAgaW50IGk7CisgICAgICAgaW50IGI7Cit9Oworc3RydWN0IGltYXBv
cHRfcyB7CisgICAgY29uc3QgZW51bSBpbWFwb3B0IG9wdDsKKyAgICBjb25zdCBjaGFyICpvcHRu
YW1lOworICAgIGludCBzZWVuOworICAgIHVuaW9uIGNvbmZpZ192YWx1ZSB2YWw7CisgICAgY29u
c3QgZW51bSBvcHR0eXBlIHQ7Cit9OworI2VuZGlmIC8qIElOQ0xVREVEX0lNQVBPUFRJT05TX0gg
Ki8KK0VPRgorICAgIDsKKworcHJpbnQgQ0ZJTEUgPDxFT0YKKyAgeyBJTUFQT1BUX0xBU1QsIE5V
TEwsIDAsIHsgTlVMTCB9LCBPUFRfTk9UT1BUIH0KK307CisKKy8qIGMgY29kZSBnb2VzIGhlcmUg
Ki8KKworRU9GCis7CkluZGV4OiB0b29scy9jb25maWcybWFuCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6
IGNvbmZpZzJtYW4KZGlmZiAtTiBjb25maWcybWFuCi0tLSAvZGV2L251bGwJVHVlIEp1biAxOCAw
NjowMToyMyAyMDAyCisrKyBjb25maWcybWFuCU1vbiBKdW4gMTcgMTY6MDI6MzQgMjAwMgpAQCAt
MCwwICsxLDExMSBAQAorIyEvYmluL3NoCisjICRJZCQKKyMKKyMgQ29weXJpZ2h0IChjKSAyMDAx
IENhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5LiAgQWxsIHJpZ2h0cyByZXNlcnZlZC4KKyMKKyMg
UmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBv
ciB3aXRob3V0CisjIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRo
ZSBmb2xsb3dpbmcgY29uZGl0aW9ucworIyBhcmUgbWV0OgorIworIyAxLiBSZWRpc3RyaWJ1dGlv
bnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNvcHlyaWdodAorIyAgICBu
b3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWlt
ZXIuIAorIworIyAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1
Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAorIyAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRp
b25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4KKyMgICAgdGhlIGRvY3VtZW50YXRp
b24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZQorIyAgICBkaXN0cmli
dXRpb24uCisjCisjIDMuIFRoZSBuYW1lICJDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eSIgbXVz
dCBub3QgYmUgdXNlZCB0bworIyAgICBlbmRvcnNlIG9yIHByb21vdGUgcHJvZHVjdHMgZGVyaXZl
ZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91dAorIyAgICBwcmlvciB3cml0dGVuIHBlcm1pc3Np
b24uIEZvciBwZXJtaXNzaW9uIG9yIGFueSBvdGhlciBsZWdhbAorIyAgICBkZXRhaWxzLCBwbGVh
c2UgY29udGFjdCAgCisjICAgICAgT2ZmaWNlIG9mIFRlY2hub2xvZ3kgVHJhbnNmZXIKKyMgICAg
ICBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eQorIyAgICAgIDUwMDAgRm9yYmVzIEF2ZW51ZQor
IyAgICAgIFBpdHRzYnVyZ2gsIFBBICAxNTIxMy0zODkwCisjICAgICAgKDQxMikgMjY4LTQzODcs
IGZheDogKDQxMikgMjY4LTczOTUKKyMgICAgICB0ZWNoLXRyYW5zZmVyQGFuZHJldy5jbXUuZWR1
CisjCisjIDQuIFJlZGlzdHJpYnV0aW9ucyBvZiBhbnkgZm9ybSB3aGF0c29ldmVyIG11c3QgcmV0
YWluIHRoZSBmb2xsb3dpbmcKKyMgICAgYWNrbm93bGVkZ21lbnQ6CisjICAgICJUaGlzIHByb2R1
Y3QgaW5jbHVkZXMgc29mdHdhcmUgZGV2ZWxvcGVkIGJ5IENvbXB1dGluZyBTZXJ2aWNlcworIyAg
ICAgYXQgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkgKGh0dHA6Ly93d3cuY211LmVkdS9jb21w
dXRpbmcvKS4iCisjCisjIENBUk5FR0lFIE1FTExPTiBVTklWRVJTSVRZIERJU0NMQUlNUyBBTEwg
V0FSUkFOVElFUyBXSVRIIFJFR0FSRCBUTworIyBUSElTIFNPRlRXQVJFLCBJTkNMVURJTkcgQUxM
IElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkKKyMgQU5EIEZJVE5FU1MsIElO
IE5PIEVWRU5UIFNIQUxMIENBUk5FR0lFIE1FTExPTiBVTklWRVJTSVRZIEJFIExJQUJMRQorIyBG
T1IgQU5ZIFNQRUNJQUwsIElORElSRUNUIE9SIENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkg
REFNQUdFUworIyBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9S
IFBST0ZJVFMsIFdIRVRIRVIgSU4KKyMgQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNF
IE9SIE9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORworIyBPVVQgT0YgT1IgSU4gQ09OTkVD
VElPTiBXSVRIIFRIRSBVU0UgT1IgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KKyMKK2V4
ZWMgcGVybCAteCAtUyAkMCAkezErIiRAIn0gIyAtKi1wZXJsLSotCisjIXBlcmwgLXcKKworaWYg
KCRdICF+IC9eNVwuLiovKSB7CisgICMgdWgtb2guIHRoaXMgaXNuJ3QgcGVybCA1LgorICBmb3Jl
YWNoIChzcGxpdCgvOi8sICRFTlZ7UEFUSH0pKSB7ICMgdHJ5IHRvIGZpbmQgInBlcmw1Ii4KKyAg
ICBleGVjKCIkXy9wZXJsNSIsICIteCIsICItUyIsICQwLCBAQVJHVikgaWYgKC14ICIkXy9wZXJs
NSIpOworICB9CisgICMgd2UgZmFpbGVkLiBiYWlsLgorICBkaWUgIllvdXIgcGVybCBpcyB0b28g
b2xkOyBJIG5lZWQgcGVybCA1LlxuIjsKK30KKworIyBsb2FkIHRoZSByZWFsIHNjcmlwdC4gdGhp
cyBpcyBpc29sYXRlZCBpbiBhbiAnZXZhbCcgc28gcGVybDQgd29uJ3QKKyMgY2hva2Ugb24gdGhl
IHBlcmw1LWlzbXMuCitldmFsIGpvaW4oIlxuIiwgPERBVEE+KTsKK2lmICgkQCkgeyBkaWUgIiRA
IjsgfQorCitfX0VORF9fCityZXF1aXJlIDU7CisKK3VzZSBzdHJpY3Q7CisKK215ICRtb2RlID0g
MDsKK215ICRzYXZlID0gIiI7CisKK215ICRibGFuayA9ICIiOworbXkgJHZlcnNpb24gPSAiXCRS
ZXZpc2lvbiRibGFuayI7CiskdmVyc2lvbiA9fiBzLy5SZXZpc2lvbjogKC4qKSAvJDEvOworcHJp
bnQgIi5cXFwiIC0qLSBucm9mZiAtKi1cbiI7CitwcmludCAiLlxcXCIgYXV0by1nZW5lcmF0ZWQg
YnkgY29uZmlnMm1hbiAkdmVyc2lvblxuIjsKKword2hpbGUgKDw+KSB7CisgICAgaWYgKCRtb2Rl
ID09IDApIHsKKwkjIGxvb2sgZm9yIHsgb3B0aW9uLCBkZWZhdWx0LCB0eXBlIH07IGRvbid0IG91
dHB1dCB1bnRpbCB3ZQorCSMgaGl0IGEgY29tbWVudAorCWlmIChtfHtccypcIiguKj8pXCJccyos
XHMqXCI/KC4qPylcIj9ccyosXHMqKC4qPylccyp9fCkgeworCSAgICBteSAkb3B0ID0gJDE7CisJ
ICAgIG15ICRkZWYgPSAkMiBlcSAiTlVMTCIgPyAiPG5vbmU+IiA6ICQyOworCSAgICBpZiAoJGRl
ZiBlcSAiIikgeyAkZGVmID0gIjxlbXB0eSBzdHJpbmc+IiB9CisJICAgICRzYXZlID0gIi5JUCBc
IlxcZkIkMTpcXGZSICRkZWZcIiA1XG4iOworCX0KKworCSMgbG9vayBmb3Igc2luZ2xlLWxpbmUg
Y29tbWVudAorCWVsc2lmIChtfC9cKlxzKiguKilccypcKi98KSB7CisJICAgIHByaW50ICRzYXZl
OyAkc2F2ZSA9ICIiOworCSAgICBwcmludCAiJDFcbiI7CisJfQorCisJIyBsb29rIGZvciAvKiB0
byBzaGlmdCBpbnRvIHBhc3N0aHJvdWdoIG1vZGU7IHByaW50IGN1cnJlbnQKKwkjIGNhY2hlZCBv
cHRpb24gaGVhZGVyIGlmIGFueQorCWVsc2lmIChtfC9cKlxzKiguKil8KSB7CisJICAgIHByaW50
ICRzYXZlOyAkc2F2ZSA9ICIiOworCSAgICBwcmludCAkMTsKKwkgICAgJG1vZGUgPSAxOworCX0K
KwllbHNlIHsKKwkgICAgY2hvbXA7CisJICAgICNwcmludCAiaWdub3JpbmcgJyRfJ1xuIjsKKwl9
CisgICAgfSBlbHNpZiAoJG1vZGUgPT0gMSkgeworCSMgcGFzc3RocnU7IGxvb2sgZm9yICovIHRv
IGVuZAorCWlmIChtfFxzKiguKilcKi98KSB7CisJICAgIHByaW50ICQxOworCSAgICBwcmludCAi
XG4iOworCSAgICAkbW9kZSA9IDA7ICMgYmFjayB0byBzZWFyY2ggbW9kZQorCX0gZWxzaWYgKG18
XHMqKC4qKVxzKnwpIHsKKwkgICAgcHJpbnQgIiQxXG4iOworCX0KKyAgICB9Cit9Cg==
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>48</attachid>
            <date>2002-06-20 13:55 EDT</date>
            <desc>Current patch.</desc>
            <filename>newconfig.patch</filename>
            <type>text/plain</type>
            <size>139031</size>
            <attacher>rjs3@andrew.cmu.edu</attacher>
            
              <data encoding="base64">SW5kZXg6IGRvYy9jaGFuZ2VzLmh0bWwKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcu
Y211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9kb2MvY2hhbmdlcy5odG1sLHYKcmV0cmlldmlu
ZyByZXZpc2lvbiAxLjQwCmRpZmYgLXUgLXIxLjQwIGNoYW5nZXMuaHRtbAotLS0gY2hhbmdlcy5o
dG1sCTIwMDIvMDUvMzEgMTk6MzM6MzYJMS40MAorKysgY2hhbmdlcy5odG1sCTIwMDIvMDYvMTgg
MjA6NTM6MDcKQEAgLTEyLDYgKzEyLDIxIEBACiA8aDI+Q2hhbmdlcyB0byB0aGUgQ3lydXMgSU1B
UCBTZXJ2ZXIgc2luY2UgMi4xLjQ8L2gyPgogCiA8dWw+Cis8bGk+VGhlcmUgaGF2ZSBiZWVuIGV4
dGVuc2l2ZSBwZXJmb3JtYW5jZSBhbmQgY29uc2lzdGFuY3kgY2hhbmdlcyB0bwordGhlIGNvbmZp
Z3VyYXRpb24gc3Vic3lzdGVtLiAgVGhpcyB3aWxsIGJvdGggZW5zdXJlIGdyZWF0ZXIgY29uc2lz
dGFuY3kKK2JldHdlZW4gdGhlIGRvY3VtZW50YXRpb24gYW5kIHRoZSBjb2RlLCBhcyB3ZWxsIGFz
IGEgbW9yZSBzdGFuZGFyZCBmb3JtYXQKK2ZvciBzcGVjaWZpbmcgc2VydmljZS1zcGVjaWZpYyBj
b25maWd1cmF0aW9uIG9wdGlvbnMgaW4gaW1hcGQuY29uZi4gIEltcG9ydGFudAorY2hhbmdlcyBh
cmUgZGV0YWlsZWQgaGVyZToKKzx1bD4KKyAgPGxpPiBUaGUgdGxzX1tzZXJ2aWNlXV8qIGNvbmZp
Z3VyYXRpb24gb3B0aW9ucyBoYXZlIGJlZW4gcmVtb3ZlZC4gIE5vdwordXNlIFtzZXJ2aWNlbmFt
ZV1fdGxzXyosIHdoZXJlIHNlcnZpY2VuYW1lIGlzIHRoZSBzZXJ2aWNlIGlkZW50aWZpZXIgZnJv
bQorY3lydXMuY29uZiBmb3IgdGhhdCBwYXJ0aWN1bGFyIHByb2Nlc3MuPC9saT4KKyAgPGxpPiBB
ZG1pbmlzdHJhdGl2ZSBncm91cHMgKGUuZy4gYWRtaW5zIGFuZCBsbXRwX2FkbWlucykgbm8gbG9u
Z2VyIHVuaW9uLAorc2VydmljZSBncm91cHMgY29tcGxldGVseSBvdmVycmlkZSB0aGUgZ2VuZXJp
YyBncm91cC4gPC9saT4KKyAgPGxpPiBsbXRwX2FsbG93cGxhaW50ZXh0IGlzIG5vIGxvbmdlciBh
IGRlZmluZWQgcGFyYW1ldGVyIGFuZCBtdXN0CitiZSBzcGVjaWZpZWQgdXNpbmcgdGhlIHNlcnZp
Y2UgbmFtZSBvZiB5b3VyIGxtdHAgcHJvY2VzcyBpZiB5b3UKK3JlcXVpcmUgYSBzcGVjaWZpYyB2
YWx1ZTwvbGk+Cis8L3VsPjwvbGk+CiA8bGk+IFNpZXZlIGlzIG5vIGxvbmdlciBkZXBlbmRlbnQg
b24gZHVwbGljYXRlIGRlbGl2ZXJ5IHN1cHByZXNzaW9uCiAoaXQgc3RpbGwgdXNlcyB0aGUgZHVw
bGljYXRlIGRlbGl2ZXJ5IGRhdGFiYXNlIGhvd2V2ZXIpLiA8L2xpPgogCkluZGV4OiBpbWFwL01h
a2VmaWxlLmluCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVt
L2N2cy9zcmMvY3lydXMvaW1hcC9NYWtlZmlsZS5pbix2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4x
NjQKZGlmZiAtdSAtcjEuMTY0IE1ha2VmaWxlLmluCi0tLSBNYWtlZmlsZS5pbgkyMDAyLzA1LzI2
IDAwOjUwOjUyCTEuMTY0CisrKyBNYWtlZmlsZS5pbgkyMDAyLzA2LzE3IDIwOjI5OjExCkBAIC05
NywxMCArOTcsMTEgQEAKIGN5cnVzX3ByZWZpeCA9IEBjeXJ1c19wcmVmaXhACiAKIExPQkpTPSBh
cHBlbmQubyBtYWlsYm94Lm8gbWJveGxpc3QubyBtdXBkYXRlLWNsaWVudC5vIG1ib3huYW1lLm8g
bWVzc2FnZS5vIFwKLQljb25maWcubyBpbWFwX2Vyci5vIG11cGRhdGVfZXJyLm8gcHJvYy5vIHNl
dHByb2N0aXRsZS5vIGNvbnZlcnRfY29kZS5vIFwKLQlkdXBsaWNhdGUubyBzYXNsY2xpZW50Lm8g
YWNhcG1ib3gubyBzaWduYWxzLm8gYW5ub3RhdGUubyBcCi0Jc2VhcmNoX2VuZ2luZXMubyBzcXVh
dC5vIHNxdWF0X2ludGVybmFsLm8gbWJkdW1wLm8gXAotCWJhc2U2NC5vIGltYXBwYXJzZS5vIHRl
bGVtZXRyeS5vIHVzZXIubyBub3RpZnkubyAkKFNFRU4pICQoSURMRSkKKwljb25maWcubyBpbWFw
X2Vyci5vIG11cGRhdGVfZXJyLm8gcHJvYy5vIHNldHByb2N0aXRsZS5vIFwKKwljb252ZXJ0X2Nv
ZGUubyBkdXBsaWNhdGUubyBzYXNsY2xpZW50Lm8gYWNhcG1ib3gubyBzaWduYWxzLm8gXAorCWFu
bm90YXRlLm8gc2VhcmNoX2VuZ2luZXMubyBzcXVhdC5vIHNxdWF0X2ludGVybmFsLm8gbWJkdW1w
Lm8gXAorCWJhc2U2NC5vIGltYXBwYXJzZS5vIHRlbGVtZXRyeS5vIHVzZXIubyBub3RpZnkubyBp
bWFwb3B0cy5vIFwKKwkkKFNFRU4pICQoSURMRSkKIAogSU1BUERPQkpTPXB1c2hzdGF0cy5vIGJh
Y2tlbmQubyBpbWFwZC5vIGluZGV4Lm8gdGxzLm8gdmVyc2lvbi5vCiAKQEAgLTExOCw3ICsxMTks
OCBAQAogCUBJTUFQX1BST0dTQAogCiBCVUlMVFNPVVJDRVMgPSBpbWFwX2Vyci5jIGltYXBfZXJy
LmggcHVzaHN0YXRzLmMgcHVzaHN0YXRzLmggXAotCWxtdHBzdGF0cy5jIGxtdHBzdGF0cy5oIHh2
ZXJzaW9uLmggbXVwZGF0ZV9lcnIuYyBtdXBkYXRlX2Vyci5oCisJbG10cHN0YXRzLmMgbG10cHN0
YXRzLmggeHZlcnNpb24uaCBtdXBkYXRlX2Vyci5jIG11cGRhdGVfZXJyLmggXAorCWltYXBvcHRz
LmggaW1hcG9wdHMuYwogCiBhbGw6ICQoQlVJTFRTT1VSQ0VTKSAkKFBST0dTKSAkKFNVSURQUk9H
UykKIApAQCAtMTU3LDYgKzE1OSw5IEBACiAKIGxtdHBzdGF0cy5jIGxtdHBzdGF0cy5oOiBsbXRw
c3RhdHMuc25tcCAkKHNyY2RpcikvLi4vc25tcC9zbm1wZ2VuCiAJJChzcmNkaXIpLy4uL3NubXAv
c25tcGdlbiAkKHNyY2RpcikvbG10cHN0YXRzLnNubXAKKworaW1hcG9wdHMuYyBpbWFwb3B0cy5o
OiBpbWFwb3B0aW9ucyAkKHNyY2RpcikvLi4vdG9vbHMvY29uZmlnMmhlYWRlcgorCSQoc3JjZGly
KS8uLi90b29scy9jb25maWcyaGVhZGVyICQoc3JjZGlyKS9pbWFwb3B0cy5jICQoc3JjZGlyKS9p
bWFwb3B0cy5oIDwgJChzcmNkaXIpL2ltYXBvcHRpb25zCiAKIGNvbGxlY3RuZXdzOiBjb2xsZWN0
bmV3cy5vIGxpYmltYXAuYSAkKERFUExJQlMpCiAJJChDQykgJChMREZMQUdTKSAtbyBjb2xsZWN0
bmV3cyBjb2xsZWN0bmV3cy5vIGxpYmltYXAuYSAkKERFUExJQlMpIFwKSW5kZXg6IGltYXAvYWNh
cG1ib3guYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9j
dnMvc3JjL2N5cnVzL2ltYXAvYWNhcG1ib3guYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zMQpk
aWZmIC11IC1yMS4zMSBhY2FwbWJveC5jCi0tLSBhY2FwbWJveC5jCTIwMDIvMDUvMjUgMTk6NTc6
NDMJMS4zMQorKysgYWNhcG1ib3guYwkyMDAyLzA2LzE4IDIwOjM3OjIwCkBAIC0xMDUsOCArMTA1
LDggQEAKIAlzdHJjYXQocG9zdGFkZHIsICJAIik7CiAJc3RyY2F0KHBvc3RhZGRyLCBzZXJ2ZXIp
OwogICAgIH0gZWxzZSB7Ci0JY29uc3QgY2hhciAqcG9zdHNwZWMgPSBjb25maWdfZ2V0c3RyaW5n
KCJwb3N0c3BlYyIsIE5VTEwpOwotCWNvbnN0IGNoYXIgKkJCID0gY29uZmlnX2dldHN0cmluZygi
cG9zdHVzZXIiLCAiYmIiKTsKKwljb25zdCBjaGFyICpwb3N0c3BlYyA9IGNvbmZpZ19nZXRzdHJp
bmcoSU1BUE9QVF9QT1NUU1BFQyk7CisJY29uc3QgY2hhciAqQkIgPSBjb25maWdfZ2V0c3RyaW5n
KElNQVBPUFRfUE9TVFVTRVIpOwogCiAJaWYgKHBvc3RzcGVjKSB7CiAJICAgIHNucHJpbnRmKHBv
c3RhZGRyLCBzaXplb2YocG9zdGFkZHIpLCBwb3N0c3BlYywgbmFtZSk7CkBAIC0xNzYsNyArMTc2
LDcgQEAKICAgICBjb25zdCBjaGFyICphdXRocHJvZzsKICAgICBzYXNsX2NhbGxiYWNrX3QgKmNi
OwogICAgIAotICAgIGFjYXBzZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKCJhY2FwX3NlcnZlciIs
IE5VTEwpOworICAgIGFjYXBzZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQUNBUF9T
RVJWRVIpOwogICAgIGlmICghYWNhcHNlcnZlcikgcmV0dXJuIE5VTEw7CiAKICAgICBpZiAoY2Fj
aGVkX2Nvbm4pIHsKQEAgLTE5NywyMSArMTk3LDIxIEBACiAgICAgY2FjaGVkX2Nvbm4gPSAoYWNh
cG1ib3hfaGFuZGxlX3QgKikgeG1hbGxvYyhzaXplb2YoYWNhcG1ib3hfaGFuZGxlX3QpKTsKICAg
ICBjYWNoZWRfY29ubi0+Y29ubiA9IE5VTEw7CiAgICAgCi0gICAgdXNlciA9IGNvbmZpZ19nZXRz
dHJpbmcoImFjYXBfdXNlcm5hbWUiLCBOVUxMKTsKKyAgICB1c2VyID0gY29uZmlnX2dldHN0cmlu
ZyhJTUFQT1BUX0FDQVBfVVNFUk5BTUUpOwogICAgIGlmICh1c2VyID09IE5VTEwpIHsKIAlzeXNs
b2coTE9HX0VSUiwgInVuYWJsZSB0byBmaW5kIG9wdGlvbiBhY2FwX3VzZXJuYW1lIik7CiAJcmV0
dXJuIGNhY2hlZF9jb25uOwogICAgIH0KIAotICAgIGF1dGhwcm9nID0gY29uZmlnX2dldHN0cmlu
ZygiYWNhcF9nZXRhdXRoIiwgTlVMTCk7CisgICAgYXV0aHByb2cgPSBjb25maWdfZ2V0c3RyaW5n
KElNQVBPUFRfQUNBUF9HRVRBVVRIKTsKICAgICBpZiAoYXV0aHByb2cpIHsKIAlzeXN0ZW0oYXV0
aHByb2cpOwogICAgIH0KIAogICAgIGNiID0gbXlzYXNsX2NhbGxiYWNrcyh1c2VyLAotCQkJICBj
b25maWdfZ2V0c3RyaW5nKCJhY2FwX2F1dGhuYW1lIiwgdXNlciksCi0JCQkgIGNvbmZpZ19nZXRz
dHJpbmcoImFjYXBfcmVhbG0iLCBOVUxMKSwKLQkJCSAgY29uZmlnX2dldHN0cmluZygiYWNhcF9w
YXNzd29yZCIsIE5VTEwpKTsKKwkJCSAgY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0FDQVBfQVVU
SE5BTUUpLAorCQkJICBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQUNBUF9SRUFMTSksCisJCQkg
IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9BQ0FQX1BBU1NXT1JEKSk7CiAgICAgc25wcmludGYo
c3RyLCBzaXplb2Yoc3RyKSwgImFjYXA6Ly8lc0Alcy8iLCB1c2VyLCBhY2Fwc2VydmVyKTsKICAg
ICByID0gYWNhcF9jb25uX2Nvbm5lY3Qoc3RyLCBjYiwgJihjYWNoZWRfY29ubi0+Y29ubikpOwog
ICAgIGZyZWVfY2FsbGJhY2tzKGNiKTsKSW5kZXg6IGltYXAvYmFja2VuZC5jCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
UkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9i
YWNrZW5kLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNwpkaWZmIC11IC1yMS43IGJhY2tlbmQu
YwotLS0gYmFja2VuZC5jCTIwMDIvMDUvMDYgMTc6MTg6NDkJMS43CisrKyBiYWNrZW5kLmMJMjAw
Mi8wNi8xOCAxOTo1Nzo0OApAQCAtMjM0LDEwICsyMzQsMTEgQEAKICAgICBwID0gc3RyY2hyKG9w
dHN0ciwgJy4nKTsKICAgICBpZiAocCkgKnAgPSAnXDAnOwogICAgIHN0cmNhdChvcHRzdHIsICJf
cGFzc3dvcmQiKTsKLSAgICBwYXNzID0gY29uZmlnX2dldHN0cmluZyhvcHRzdHIsIE5VTEwpOwor
ICAgIHBhc3MgPSBjb25maWdfZ2V0b3ZlcmZsb3dzdHJpbmcob3B0c3RyLCBOVUxMKTsKKyAgICBp
ZighcGFzcykgcGFzcyA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9QQVNTV09SRCk7
CiAgICAgY2IgPSBteXNhc2xfY2FsbGJhY2tzKHVzZXJpZCwgCi0JCQkgIGNvbmZpZ19nZXRzdHJp
bmcoInByb3h5X2F1dGhuYW1lIiwgInByb3h5IiksCi0JCQkgIGNvbmZpZ19nZXRzdHJpbmcoInBy
b3h5X3JlYWxtIiwgTlVMTCksCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9B
VVRITkFNRSksCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9SRUFMTSksCiAJ
CQkgIHBhc3MpOwogCiAgICAgLyogc2V0IHRoZSBJUCBhZGRyZXNzZXMgKi8KQEAgLTI4MSw3ICsy
ODIsNyBAQAogICAgIHAgPSBzdHJjaHIoYnVmLCAnLicpOwogICAgICpwID0gJ1wwJzsKICAgICBz
dHJjYXQoYnVmLCAiX21lY2hzIik7Ci0gICAgbWVjaF9jb25mID0gY29uZmlnX2dldHN0cmluZyhi
dWYsIE5VTEwpOworICAgIG1lY2hfY29uZiA9IGNvbmZpZ19nZXRvdmVyZmxvd3N0cmluZyhidWYs
IE5VTEwpOwogICAgIAogICAgIC8qIElmIHdlIGRvbid0IGhhdmUgYSBtZWNoX2NvbmYsIGFzayB0
aGUgc2VydmVyIHdoYXQgaXQgY2FuIGRvICovCiAgICAgaWYoIW1lY2hfY29uZikgewpJbmRleDog
aW1hcC9jb25maWcuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5
c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvY29uZmlnLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEu
NTUKZGlmZiAtdSAtcjEuNTUgY29uZmlnLmMKLS0tIGNvbmZpZy5jCTIwMDIvMDYvMTggMTY6NDA6
MTkJMS41NQorKysgY29uZmlnLmMJMjAwMi8wNi8yMCAxNDo0NjoyOQpAQCAtNTcsNiArNTcsNyBA
QAogI2VuZGlmCiAKICNpbmNsdWRlICJpbWFwY29uZi5oIgorI2luY2x1ZGUgImltYXBvcHRzLmgi
CiAjaW5jbHVkZSAiZXhpdGNvZGVzLmgiCiAjaW5jbHVkZSAieG1hbGxvYy5oIgogI2luY2x1ZGUg
Im1ib3hsaXN0LmgiCkBAIC03MCwxOCArNzEsMjAgQEAKIAogI2RlZmluZSBDT05GSUdfRklMRU5B
TUUgIi9ldGMvaW1hcGQuY29uZiIKIAotI2RlZmluZSBDT05GSUdIQVNIU0laRSAyMDAgLyogPiAy
eCAjIG9mIG9wdGlvbnMgKi8KKyNkZWZpbmUgQ09ORklHSEFTSFNJWkUgMzAgLyogcmVsYXRpdmVs
eSBzbWFsbCwKKwkJCSAgICogYmVjYXVzZSBpdCBpcyBmb3Igb3ZlcmZsb3cgb25seSAqLwogc3Rh
dGljIHN0cnVjdCBoYXNoX3RhYmxlIGNvbmZpZ2hhc2g7CiAKIC8qIGNhY2hlZCBjb25maWd1cmF0
aW9uIHZhcmlhYmxlcyBhY2Nlc3NpYmxlIHRvIHRoZSBleHRlcm5hbCB3b3JsZCAqLwogY29uc3Qg
Y2hhciAqY29uZmlnX2ZpbGVuYW1lOyAgICAgLyogZmlsZW5hbWUgb2YgY29uZmlndXJhdGlvbiBm
aWxlICovCiBjb25zdCBjaGFyICpjb25maWdfZGlyOwkJICAgICAgICAgICAvKiBpZSAvdmFyL2lt
YXAgKi8KIGNvbnN0IGNoYXIgKmNvbmZpZ19kZWZwYXJ0aXRpb247ICAgICAgICAgICAvKiAvdmFy
L3Nwb29sL2ltYXAgKi8KLWNvbnN0IGNoYXIgKmNvbmZpZ19uZXdzc3Bvb2w7CSAgICAgICAgICAg
LyogL3Zhci9zcG9vbC9uZXdzICovCiBjb25zdCBjaGFyICpjb25maWdfc2VydmVybmFtZTsJICAg
ICAgICAgICAvKiBnZXRob3N0bmFtZSgpICovCiBjb25zdCBjaGFyICpjb25maWdfbXVwZGF0ZV9z
ZXJ2ZXI7ICAgICAgICAgLyogTlVMTCAqLwogaW50IGNvbmZpZ19oYXNoaW1hcHNwb29sOwkgICAg
ICAgICAgIC8qIGYgKi8KIAorY29uc3QgY2hhciAqY29uZmlnX2lkZW50OyAgICAgICAgICAgICAg
ICAgIC8qIHRoZSBzZXJ2aWNlIG5hbWUgKi8KKwogc3RhdGljIHZvaWQgY29uZmlnX3JlYWQoY29u
c3QgY2hhciAqYWx0X2NvbmZpZyk7CiAKIGludCBjb25maWdfaW5pdChjb25zdCBjaGFyICphbHRf
Y29uZmlnLCBjb25zdCBjaGFyICppZGVudCkKQEAgLTkzLDI0ICs5NiwyMyBAQAogCiAgICAgaW5p
dGlhbGl6ZV9pbWFwX2Vycm9yX3RhYmxlKCk7CiAgICAgaW5pdGlhbGl6ZV9tdXBkX2Vycm9yX3Rh
YmxlKCk7CisKKyAgICBpZighaWRlbnQpCisJZmF0YWwoInNlcnZpY2UgbmFtZSB3YXMgbm90IHNw
ZWNpZmllZCB0byBjb25maWdfaW5pdCIsIEVDX0NPTkZJRyk7CiAKLSAgICBvcGVubG9nKGlkZW50
LCBMT0dfUElELCBMT0dfTE9DQUw2KTsKKyAgICBjb25maWdfaWRlbnQgPSBpZGVudDsKKyAgICAK
KyAgICBvcGVubG9nKGNvbmZpZ19pZGVudCwgTE9HX1BJRCwgTE9HX0xPQ0FMNik7CiAKICAgICBp
ZighY29uc3RydWN0X2hhc2hfdGFibGUoJmNvbmZpZ2hhc2gsIENPTkZJR0hBU0hTSVpFLCAxKSkg
ewogCWZhdGFsKCJjb3VsZCBub3QgY29uc3RydWN0IGNvbmZpZ3VyYXRpb24gaGFzaCB0YWJsZSIs
IEVDX0NPTkZJRyk7CiAgICAgfQogCisgICAgLyogTG9hZCBjb25maWd1cmF0aW9uIGZpbGUuICBU
aGlzIHdpbGwgc2V0IGNvbmZpZ19kaXIgd2hlbiBpdCBmaW5kcyBpdCAqLwogICAgIGNvbmZpZ19y
ZWFkKGFsdF9jb25maWcpOwogCi0gICAgLyogTG9vayB1cCBjb25maWdkaXJlY3RvcnkgY29uZmln
IG9wdGlvbiAqLwotICAgIGNvbmZpZ19kaXIgPSBjb25maWdfZ2V0c3RyaW5nKCJjb25maWdkaXJl
Y3RvcnkiLCAoY2hhciAqKTApOwotICAgIGlmICghY29uZmlnX2RpcikgewotCWZhdGFsKCJjb25m
aWdkaXJlY3Rvcnkgb3B0aW9uIG5vdCBzcGVjaWZpZWQgaW4gY29uZmlndXJhdGlvbiBmaWxlIiwK
LQkgICAgICBFQ19DT05GSUcpOwotICAgIH0KLQogICAgIC8qIExvb2sgdXAgZGVmYXVsdCBwYXJ0
aXRpb24gKi8KLSAgICBjb25maWdfZGVmcGFydGl0aW9uID0gY29uZmlnX2dldHN0cmluZygiZGVm
YXVsdHBhcnRpdGlvbiIsICJkZWZhdWx0Iik7CisgICAgY29uZmlnX2RlZnBhcnRpdGlvbiA9IGNv
bmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9ERUZBVUxUUEFSVElUSU9OKTsKICAgICBmb3IgKHAgPSAo
Y2hhciAqKWNvbmZpZ19kZWZwYXJ0aXRpb247ICpwOyBwKyspIHsKIAlpZiAoIWlzYWxudW0oKHVu
c2lnbmVkIGNoYXIpICpwKSkKIAkgIGZhdGFsKCJkZWZhdWx0cGFydGl0aW9uIG9wdGlvbiBjb250
YWlucyBub24tYWxwaGFudW1lcmljIGNoYXJhY3RlciIsCkBAIC0xMjQsNzIgKzEyNiw3MSBAQAog
ICAgIH0KIAogICAgIC8qIExvb2sgdXAgdW1hc2sgKi8KLSAgICB2YWwgPSBjb25maWdfZ2V0c3Ry
aW5nKCJ1bWFzayIsICIwNzciKTsKKyAgICB2YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRf
VU1BU0spOwogICAgIHdoaWxlICgqdmFsKSB7CiAJaWYgKCp2YWwgPj0gJzAnICYmICp2YWwgPD0g
JzcnKSB1bWFza3ZhbCA9IHVtYXNrdmFsKjggKyAqdmFsIC0gJzAnOwogCXZhbCsrOwogICAgIH0K
ICAgICB1bWFzayh1bWFza3ZhbCk7CiAKLSAgICAvKiBMb29rIHVwIG5ld3Mgc3Bvb2wgKi8KLSAg
ICBjb25maWdfbmV3c3Nwb29sID0gY29uZmlnX2dldHN0cmluZygibmV3c3Nwb29sIiwgMCk7Ci0K
ICAgICAvKiBsb29rIHVwIG1haWxib3ggaGFzaGluZyAqLwotICAgIGNvbmZpZ19oYXNoaW1hcHNw
b29sID0gY29uZmlnX2dldHN3aXRjaCgiaGFzaGltYXBzcG9vbCIsIDApOworICAgIGNvbmZpZ19o
YXNoaW1hcHNwb29sID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0hBU0hJTUFQU1BPT0wpOwog
CiAgICAgLyogbG9vayB1cCB0aGUgaG9zdG5hbWUgd2Ugc2hvdWxkIHByZXNlbnQgdG8gdGhlIHVz
ZXIgKi8KLSAgICBjb25maWdfc2VydmVybmFtZSA9IGNvbmZpZ19nZXRzdHJpbmcoInNlcnZlcm5h
bWUiLCAwKTsKKyAgICBjb25maWdfc2VydmVybmFtZSA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9Q
VF9TRVJWRVJOQU1FKTsKICAgICBpZiAoIWNvbmZpZ19zZXJ2ZXJuYW1lKSB7CiAJY29uZmlnX3Nl
cnZlcm5hbWUgPSB4bWFsbG9jKHNpemVvZihjaGFyKSAqIDI1Nik7CiAJZ2V0aG9zdG5hbWUoKGNo
YXIgKikgY29uZmlnX3NlcnZlcm5hbWUsIDI1Nik7CiAgICAgfQogCi0gICAgY29uZmlnX211cGRh
dGVfc2VydmVyID0gY29uZmlnX2dldHN0cmluZygibXVwZGF0ZV9zZXJ2ZXIiLCBOVUxMKTsKKyAg
ICBjb25maWdfbXVwZGF0ZV9zZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTVVQREFU
RV9TRVJWRVIpOwogCiAgICAgcmV0dXJuIDA7CiB9CiAKLWludCBjb25maWdfY2hhbmdlaWRlbnQo
Y29uc3QgY2hhciAqaWRlbnQpCitjb25zdCBjaGFyICpjb25maWdfZ2V0c3RyaW5nKGVudW0gaW1h
cG9wdCBvcHQpCiB7Ci0gICAgY2xvc2Vsb2coKTsKLSAgICBvcGVubG9nKGlkZW50LCBMT0dfUElE
LCBMT0dfTE9DQUw2KTsKLSAgICByZXR1cm4gMDsKKyAgICBhc3NlcnQob3B0ID4gSU1BUE9QVF9a
RVJPICYmIG9wdCA8IElNQVBPUFRfTEFTVCk7CisgICAgYXNzZXJ0KGltYXBvcHRzW29wdF0udCA9
PSBPUFRfU1RSSU5HKTsKKyAgICAKKyAgICByZXR1cm4gaW1hcG9wdHNbb3B0XS52YWwuczsKIH0K
IAotY29uc3QgY2hhciAqY29uZmlnX2dldHN0cmluZyhjb25zdCBjaGFyICprZXksIGNvbnN0IGNo
YXIgKmRlZikKK2ludCBjb25maWdfZ2V0aW50KGVudW0gaW1hcG9wdCBvcHQpCiB7Ci0gICAgY2hh
ciAqcmV0OwotCi0gICAgcmV0ID0gaGFzaF9sb29rdXAoa2V5LCAmY29uZmlnaGFzaCk7CisgICAg
YXNzZXJ0KG9wdCA+IElNQVBPUFRfWkVSTyAmJiBvcHQgPCBJTUFQT1BUX0xBU1QpOworICAgIGFz
c2VydChpbWFwb3B0c1tvcHRdLnQgPT0gT1BUX0lOVCk7CiAKLSAgICByZXR1cm4gcmV0ID8gcmV0
IDogZGVmOworICAgIHJldHVybiBpbWFwb3B0c1tvcHRdLnZhbC5pOwogfQogCi1pbnQgY29uZmln
X2dldGludChjb25zdCBjaGFyICprZXksIGludCBkZWYpCitpbnQgY29uZmlnX2dldHN3aXRjaChl
bnVtIGltYXBvcHQgb3B0KQogewotICAgIGNvbnN0IGNoYXIgKnZhbCA9IGNvbmZpZ19nZXRzdHJp
bmcoa2V5LCAoY2hhciAqKTApOwotCi0gICAgaWYgKCF2YWwpIHJldHVybiBkZWY7Ci0gICAgaWYg
KCFpc2RpZ2l0KChpbnQpICp2YWwpICYmICgqdmFsICE9ICctJyB8fCAhaXNkaWdpdCgoaW50KSB2
YWxbMV0pKSkgCi0JcmV0dXJuIGRlZjsKLSAgICByZXR1cm4gYXRvaSh2YWwpOworICAgIGFzc2Vy
dChvcHQgPiBJTUFQT1BUX1pFUk8gJiYgb3B0IDwgSU1BUE9QVF9MQVNUKTsKKyAgICBhc3NlcnQo
aW1hcG9wdHNbb3B0XS50ID09IE9QVF9TV0lUQ0gpOworICAgIAorICAgIHJldHVybiBpbWFwb3B0
c1tvcHRdLnZhbC5iOwogfQogCi1pbnQgY29uZmlnX2dldHN3aXRjaChjb25zdCBjaGFyICprZXks
IGludCBkZWYpCitjb25zdCBjaGFyICpjb25maWdfZ2V0b3ZlcmZsb3dzdHJpbmcoY29uc3QgY2hh
ciAqa2V5LCBjb25zdCBjaGFyICpkZWYpCiB7Ci0gICAgY29uc3QgY2hhciAqdmFsID0gY29uZmln
X2dldHN0cmluZyhrZXksIChjaGFyICopMCk7CisgICAgY2hhciBidWZbMjU2XTsKKyAgICBjaGFy
ICpyZXQ7CiAKLSAgICBpZiAoIXZhbCkgcmV0dXJuIGRlZjsKKyAgICAvKiBGaXJzdCBsb29rdXAg
PGlkZW50Pl9rZXksIHRvIHNlZSBpZiB3ZSBoYXZlIGEgc2VydmljZS1zcGVjaWZpYworICAgICAq
IG92ZXJyaWRlICovCiAKLSAgICBpZiAoKnZhbCA9PSAnMCcgfHwgKnZhbCA9PSAnbicgfHwKLQko
KnZhbCA9PSAnbycgJiYgdmFsWzFdID09ICdmJykgfHwgKnZhbCA9PSAnZicpIHsKLQlyZXR1cm4g
MDsKLSAgICB9Ci0gICAgZWxzZSBpZiAoKnZhbCA9PSAnMScgfHwgKnZhbCA9PSAneScgfHwKLQkg
ICAgICgqdmFsID09ICdvJyAmJiB2YWxbMV0gPT0gJ24nKSB8fCAqdmFsID09ICd0JykgewotCXJl
dHVybiAxOwotICAgIH0KLSAgICByZXR1cm4gZGVmOworICAgIGlmKHNucHJpbnRmKGJ1ZixzaXpl
b2YoYnVmKSwiJXNfJXMiLGNvbmZpZ19pZGVudCxrZXkpID09IC0xKQorCWZhdGFsKCJrZXkgdG9v
IGxvbmcgaW4gY29uZmlnX2dldG92ZXJmbG93c3RyaW5nIiwgRUNfVEVNUEZBSUwpOworICAgIAor
ICAgIHJldCA9IGhhc2hfbG9va3VwKGJ1ZiwgJmNvbmZpZ2hhc2gpOworICAgIAorICAgIC8qIE5v
IHNlcnZpY2Utc3BlY2lmaWMgb3ZlcnJpZGUsIGNoZWNrIHRoZSBhY3R1YWwga2V5ICovCisgICAg
aWYoIXJldCkKKwlyZXQgPSBoYXNoX2xvb2t1cChrZXksICZjb25maWdoYXNoKTsKKworICAgIC8q
IFJldHVybiB3aGF0IHdlIGdvdCBvciB0aGUgZGVmYXVsdCAqLworICAgIHJldHVybiByZXQgPyBy
ZXQgOiBkZWY7CiB9CiAKIGNvbnN0IGNoYXIgKmNvbmZpZ19wYXJ0aXRpb25kaXIoY29uc3QgY2hh
ciAqcGFydGl0aW9uKQpAQCAtMjAwLDc1ICsyMDEsMjM4IEBACiAgICAgc3RyY3B5KGJ1ZiwgInBh
cnRpdGlvbi0iKTsKICAgICBzdHJjYXQoYnVmLCBwYXJ0aXRpb24pOwogCi0gICAgcmV0dXJuIGNv
bmZpZ19nZXRzdHJpbmcoYnVmLCAoY2hhciAqKTApOworICAgIHJldHVybiBjb25maWdfZ2V0b3Zl
cmZsb3dzdHJpbmcoYnVmLCBOVUxMKTsKIH0KIAogc3RhdGljIHZvaWQgY29uZmlnX3JlYWQoY29u
c3QgY2hhciAqYWx0X2NvbmZpZykKIHsKICAgICBGSUxFICppbmZpbGU7CisgICAgZW51bSBvcHR0
eXBlIG9wdDsKICAgICBpbnQgbGluZW5vID0gMDsKLSAgICBjaGFyIGJ1Zls0MDk2XTsKLSAgICBj
aGFyICpwLCAqcSwgKmtleSwgKnZhbCwgKm5ld3ZhbDsKKyAgICBjaGFyIGJ1Zls0MDk2XSwgZXJy
YnVmWzEwMjRdOworICAgIGNoYXIgKnAsICpxLCAqa2V5LCAqZnVsbGtleSwgKnZhbCwgKm5ld3Zh
bDsKKyAgICBpbnQgc2VydmljZV9zcGVjaWZpYzsKKyAgICBpbnQgaWRsZW4gPSBzdHJsZW4oY29u
ZmlnX2lkZW50KTsKIAogICAgIGlmKGFsdF9jb25maWcpIGNvbmZpZ19maWxlbmFtZSA9IHhzdHJk
dXAoYWx0X2NvbmZpZyk7CiAgICAgZWxzZSBjb25maWdfZmlsZW5hbWUgPSB4c3RyZHVwKENPTkZJ
R19GSUxFTkFNRSk7CiAKLSAgICBpbmZpbGUgPSBmb3BlbihhbHRfY29uZmlnID8gYWx0X2NvbmZp
ZyA6IENPTkZJR19GSUxFTkFNRSwgInIiKTsKKyAgICAvKiByZWFkIGluIGNvbmZpZyBmaWxlICov
CisgICAgaW5maWxlID0gZm9wZW4oY29uZmlnX2ZpbGVuYW1lLCAiciIpOwogICAgIGlmICghaW5m
aWxlKSB7CiAJc3RyY3B5KGJ1ZiwgQ1lSVVNfUEFUSCk7Ci0Jc3RyY2F0KGJ1ZiwgYWx0X2NvbmZp
ZyA/IGFsdF9jb25maWcgOiBDT05GSUdfRklMRU5BTUUpOworCXN0cmNhdChidWYsIGNvbmZpZ19m
aWxlbmFtZSk7CiAJaW5maWxlID0gZm9wZW4oYnVmLCAiciIpOwogICAgIH0KICAgICBpZiAoIWlu
ZmlsZSkgewotCXNwcmludGYoYnVmLCAiY2FuJ3Qgb3BlbiBjb25maWd1cmF0aW9uIGZpbGUgJXM6
ICVzIiwKLQkJYWx0X2NvbmZpZyA/IGFsdF9jb25maWcgOiBDT05GSUdfRklMRU5BTUUsCi0JCWVy
cm9yX21lc3NhZ2UoZXJybm8pKTsKKwlzcHJpbnRmKGVycmJ1ZiwgImNhbid0IG9wZW4gY29uZmln
dXJhdGlvbiBmaWxlICVzOiAlcyIsCisJCWNvbmZpZ19maWxlbmFtZSwgZXJyb3JfbWVzc2FnZShl
cnJubykpOwogCWZhdGFsKGJ1ZiwgRUNfQ09ORklHKTsKICAgICB9CiAgICAgCiAgICAgd2hpbGUg
KGZnZXRzKGJ1Ziwgc2l6ZW9mKGJ1ZiksIGluZmlsZSkpIHsKIAlsaW5lbm8rKzsKIAorCXNlcnZp
Y2Vfc3BlY2lmaWMgPSAwOworCQogCWlmIChidWZbc3RybGVuKGJ1ZiktMV0gPT0gJ1xuJykgYnVm
W3N0cmxlbihidWYpLTFdID0gJ1wwJzsKIAlmb3IgKHAgPSBidWY7ICpwICYmIGlzc3BhY2UoKGlu
dCkgKnApOyBwKyspOwogCWlmICghKnAgfHwgKnAgPT0gJyMnKSBjb250aW51ZTsKIAotCWtleSA9
IHA7CisJZnVsbGtleSA9IGtleSA9IHA7CiAJd2hpbGUgKCpwICYmIChpc2FsbnVtKChpbnQpICpw
KSB8fCAqcCA9PSAnLScgfHwgKnAgPT0gJ18nKSkgewogCSAgICBpZiAoaXN1cHBlcigodW5zaWdu
ZWQgY2hhcikgKnApKSAqcCA9IHRvbG93ZXIoKHVuc2lnbmVkIGNoYXIpICpwKTsKIAkgICAgcCsr
OwogCX0KIAlpZiAoKnAgIT0gJzonKSB7Ci0JICAgIHNwcmludGYoYnVmLAorCSAgICBzcHJpbnRm
KGVycmJ1ZiwKIAkJICAgICJpbnZhbGlkIG9wdGlvbiBuYW1lIG9uIGxpbmUgJWQgb2YgY29uZmln
dXJhdGlvbiBmaWxlIiwKIAkJICAgIGxpbmVubyk7CiAJICAgIGZhdGFsKGJ1ZiwgRUNfQ09ORklH
KTsKIAl9CiAJKnArKyA9ICdcMCc7Ci0KKwkKIAl3aGlsZSAoKnAgJiYgaXNzcGFjZSgoaW50KSAq
cCkpIHArKzsKLQorCQogCS8qIHJlbW92ZSB0cmFpbGluZyB3aGl0ZXNwYWNlICovCiAJZm9yIChx
ID0gcCArIHN0cmxlbihwKSAtIDE7IHEgPiBwICYmIGlzc3BhY2UoKGludCkgKnEpOyBxLS0pIHsK
IAkgICAgKnEgPSAnXDAnOwogCX0KIAkKIAlpZiAoISpwKSB7Ci0JICAgIHNwcmludGYoYnVmLCAi
ZW1wdHkgb3B0aW9uIHZhbHVlIG9uIGxpbmUgJWQgb2YgY29uZmlndXJhdGlvbiBmaWxlIiwKKwkg
ICAgc3ByaW50ZihlcnJidWYsCisJCSAgICAiZW1wdHkgb3B0aW9uIHZhbHVlIG9uIGxpbmUgJWQg
b2YgY29uZmlndXJhdGlvbiBmaWxlIiwKIAkJICAgIGxpbmVubyk7CiAJICAgIGZhdGFsKGJ1Ziwg
RUNfQ09ORklHKTsKIAl9CisJCisgICAgICAgIC8qIGxvb2sgZm9yIHNlcnZpY2VfIHByZWZpeCwg
c2tpcCBvdmVyIGl0IGlmIGl0IGV4aXN0cyAqLworCWlmICghc3RybmNhc2VjbXAoa2V5LCBjb25m
aWdfaWRlbnQsIGlkbGVuKSAKKwkgICAgJiYga2V5W2lkbGVuXSA9PSAnXycpIHsKKwkgICAgLyog
c2tpcCBzZXJ2aWNlXyBwcmVmaXggKi8KKwkgICAga2V5ICs9IGlkbGVuICsgMTsKKwkgICAgc2Vy
dmljZV9zcGVjaWZpYyA9IDE7CisJfQorCisJLyogbG9vayBmb3IgdGhlIGNvcnJlc3BvbmRpbmcg
ZW50cnkgaW4gaW1hcG9wdHMgKi8KKwkvKiB4eHggYXMgbG9uZyBhcyB3ZSBrbm93IHRoaXMgbGlz
dCBpcyBzb3J0ZWQgd2UgY291bGQgcHJvYmFibGx5CisJICogYmUgbW9yZSBlZmZpY2llbnQgYWJv
dXQgdGhpcyAqLworCWZvciAob3B0ID0gSU1BUE9QVF9aRVJPOyBvcHQgPCBJTUFQT1BUX0xBU1Q7
IG9wdCsrKSB7CisJICAgIGlmICghc3RyY2FzZWNtcChpbWFwb3B0c1tvcHRdLm9wdG5hbWUsIGtl
eSkpIHsKKwkJYnJlYWs7CisJICAgIH0KKwl9CiAKLQluZXd2YWwgPSB4c3RyZHVwKHApOwotCXZh
bCA9IGhhc2hfaW5zZXJ0KGtleSwgbmV3dmFsLCAmY29uZmlnaGFzaCk7Ci0JaWYodmFsICE9IG5l
d3ZhbCkgewotCSAgICBjaGFyIGVycmJ1Zls0MDk2XTsKLQkgICAgc3ByaW50ZihlcnJidWYsICJv
cHRpb24gJyVzJyB3YXMgc3BlY2lmaWVkIHR3aWNlIGluIGNvbmZpZyBmaWxlIiwKLQkJICAgIGtl
eSk7Ci0JICAgIGZhdGFsKGVycmJ1ZiwgRUNfQ09ORklHKTsKKwlpZiAob3B0IDwgSU1BUE9QVF9M
QVNUKSB7CisJICAgIC8qIE9rYXksIHdlIGtub3cgYWJvdXQgdGhpcyBjb25maWd1cmUgb3B0aW9u
LgorCSAgICAgKiBTbyBmaXJzdCBjaGVjayB0aGF0IHdlIGhhdmUgZWl0aGVyCisJICAgICAqICAx
LiBub3Qgc2VlbiBpdAorCSAgICAgKiAgMi4gc2VlbiBpdHMgZ2VuZXJpYyBmb3JtLCBidXQgdGhp
cyBpcyBhIHNlcnZpY2Ugc3BlY2lmaWMgZm9ybQorCSAgICAgKgorCSAgICAgKiAgSWYgd2UgaGF2
ZSBhbHJlYWR5IHNlZW4gYSBzZXJ2aWNlLXNwZWNpZmljIGZvcm0sIGFuZCB0aGlzIGlzCisJICAg
ICAqICBhIGdlbmVyaWMgZm9ybSwganVzdCBza2lwIGl0IGFuZCBkb24ndCBtb2FuLgorCSAgICAg
Ki8KKwkgICAgaWYoKGltYXBvcHRzW29wdF0uc2VlbiA9PSAxICYmICFzZXJ2aWNlX3NwZWNpZmlj
KSAKKwkgICAgIHx8KGltYXBvcHRzW29wdF0uc2VlbiA9PSAyICYmIHNlcnZpY2Vfc3BlY2lmaWMp
KSB7CisJCXNwcmludGYoZXJyYnVmLAorCQkJIm9wdGlvbiAnJXMnIHdhcyBzcGVjaWZpZWQgdHdp
Y2UgaW4gY29uZmlnIGZpbGUgKHNlY29uZCBvY2N1cmFuY2Ugb24gbGluZSAlZCkiLAorCQkJZnVs
bGtleSwgbGluZW5vKTsKKwkJZmF0YWwoZXJyYnVmLCBFQ19DT05GSUcpOworCSAgICB9IGVsc2Ug
aWYoaW1hcG9wdHNbb3B0XS5zZWVuID09IDIgJiYgIXNlcnZpY2Vfc3BlY2lmaWMpIHsKKwkJY29u
dGludWU7CisJICAgIH0KKworCSAgICAvKiBJZiB3ZSd2ZSBzZWVuIGl0IGFscmVhZHksIHdlJ3Jl
IHJlcGxhY2luZyBpdCwgc28gd2UgbmVlZAorCSAgICAgKiB0byBmcmVlIHRoZSBjdXJyZW50IHN0
cmluZyBpZiB0aGVyZSBpcyBvbmUgKi8KKwkgICAgaWYoaW1hcG9wdHNbb3B0XS5zZWVuICYmIGlt
YXBvcHRzW29wdF0udCA9PSBPUFRfU1RSSU5HKQorCQlmcmVlKChjaGFyICopaW1hcG9wdHNbb3B0
XS52YWwucyk7CisKKyAgICAgICAgICAgIGlmKHNlcnZpY2Vfc3BlY2lmaWMpCisJCWltYXBvcHRz
W29wdF0uc2VlbiA9IDI7CisJICAgIGVsc2UKKwkJaW1hcG9wdHNbb3B0XS5zZWVuID0gMTsKKwkg
ICAgCisJICAgIC8qIHRoaXMgaXMgYSBrbm93biBvcHRpb24gKi8KKwkgICAgc3dpdGNoIChpbWFw
b3B0c1tvcHRdLnQpIHsKKwkgICAgY2FzZSBPUFRfU1RSSU5HOiAKKwkgICAgewkJICAgIAorCQlp
bWFwb3B0c1tvcHRdLnZhbC5zID0geHN0cmR1cChwKTsKKworCQlpZihvcHQgPT0gSU1BUE9QVF9D
T05GSUdESVJFQ1RPUlkpCisJCSAgICBjb25maWdfZGlyID0gaW1hcG9wdHNbb3B0XS52YWwuczsK
KworCQlicmVhazsKKwkgICAgfQorCSAgICBjYXNlIE9QVF9JTlQ6CisJICAgIHsKKwkJbG9uZyB2
YWw7CisJCWNoYXIgKnB0cjsKKwkJCisJCXZhbCA9IHN0cnRvbChwLCAmcHRyLCAwKTsKKwkJaWYg
KCFwdHIgfHwgKnB0ciAhPSAnXDAnKSB7CisJCSAgICAvKiBlcnJvciBkdXJpbmcgY29udmVyc2lv
biAqLworCQkgICAgc3ByaW50ZihlcnJidWYsICJub24taW50ZWdlciB2YWx1ZSBmb3IgJXMgaW4g
bGluZSAlZCIsCisJCQkgICAgaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBsaW5lbm8pOworCQkgICAg
ZmF0YWwoYnVmLCBFQ19DT05GSUcpOworCQl9CisKKwkJaW1hcG9wdHNbb3B0XS52YWwuaSA9IHZh
bDsKKwkJYnJlYWs7CisJICAgIH0KKwkgICAgY2FzZSBPUFRfU1dJVENIOgorCSAgICB7CisJCWlm
ICgqcCA9PSAnMCcgfHwgKnAgPT0gJ24nIHx8CisJCSAgICAoKnAgPT0gJ28nICYmIHBbMV0gPT0g
J2YnKSB8fCAqcCA9PSAnZicpIHsKKwkJICAgIGltYXBvcHRzW29wdF0udmFsLmIgPSAwOworCQl9
CisJCWVsc2UgaWYgKCpwID09ICcxJyB8fCAqcCA9PSAneScgfHwKKwkJCSAoKnAgPT0gJ28nICYm
IHBbMV0gPT0gJ24nKSB8fCAqcCA9PSAndCcpIHsKKwkJICAgIGltYXBvcHRzW29wdF0udmFsLmIg
PSAxOworCQl9CisJCWVsc2UgeworCQkgICAgLyogZXJyb3IgZHVyaW5nIGNvbnZlcnNpb24gKi8K
KwkJICAgIHNwcmludGYoZXJyYnVmLCAibm9uLXN3aXRjaCB2YWx1ZSBmb3IgJXMgaW4gbGluZSAl
ZCIsCisJCQkgICAgaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBsaW5lbm8pOworCQkgICAgZmF0YWwo
YnVmLCBFQ19DT05GSUcpOworCQl9CisJCWJyZWFrOworCSAgICB9CisJICAgIGNhc2UgT1BUX05P
VE9QVDoKKwkgICAgZGVmYXVsdDoKKwkJYWJvcnQoKTsKKwkgICAgfQorCX0gZWxzZSB7CisJICAg
IC8qIGNoZWNrIHRvIG1ha2Ugc3VyZSBpdCdzIHZhbGlkIGZvciBvdmVyZmxvdyAqLworCSAgICAv
KiB0aGF0IGlzLCBwYXJ0aXRpb24gbmFtZXMgYW5kIGFueXRoaW5nIHRoYXQgbWlnaHQgYmUKKwkg
ICAgICogdXNlZCBieSBTQVNMICovCisvKgorICB4eHggdGhpcyB3b3VsZCBiZSBuaWNlIGlmIGl0
IHdhc24ndCBmb3Igb3RoZXIgc2VydmljZXMgd2hvIG1pZ2h0IGJlCisgICAgICBzaGFyaW5nIHRo
aXMgY29uZmlnIGZpbGUgYW5kIHdob3NlIG5hbWVzIHdlIGNhbm5vdCBwcmVkaWN0CisKKwkgICAg
aWYoc3RybmNhc2VjbXAoa2V5LCJzYXNsXyIsNSkKKwkgICAgJiYgc3RybmNhc2VjbXAoa2V5LCJw
YXJ0aXRpb24tIiwxMCkpIHsKKwkJc3ByaW50ZihlcnJidWYsCisJCQkib3B0aW9uICclcycgaXMg
dW5rbm93biBvbiBsaW5lICVkIG9mIGNvbmZpZyBmaWxlIiwKKwkJCWZ1bGxrZXksIGxpbmVubyk7
CisJCWZhdGFsKGVycmJ1ZiwgRUNfQ09ORklHKTsKKwkgICAgfQorKi8KKworCSAgICAvKiBQdXQg
aXQgaW4gdGhlIG92ZXJmbG93IGhhc2ggdGFibGUgKi8KKwkgICAgbmV3dmFsID0geHN0cmR1cChw
KTsKKwkgICAgdmFsID0gaGFzaF9pbnNlcnQoa2V5LCBuZXd2YWwsICZjb25maWdoYXNoKTsKKwkg
ICAgaWYodmFsICE9IG5ld3ZhbCkgeworCQlzcHJpbnRmKGVycmJ1ZiwKKwkJCSJvcHRpb24gJyVz
JyB3YXMgc3BlY2lmaWVkIHR3aWNlIGluIGNvbmZpZyBmaWxlIChzZWNvbmQgb2NjdXJhbmNlIG9u
IGxpbmUgJWQpIiwKKwkJCWZ1bGxrZXksIGxpbmVubyk7CisJCWZhdGFsKGVycmJ1ZiwgRUNfQ09O
RklHKTsKKwkgICAgfQogCX0KICAgICB9CiAgICAgZmNsb3NlKGluZmlsZSk7CisKKyAgICAvKiBD
aGVjayBjb25maWdkaXJlY3RvcnkgY29uZmlnIG9wdGlvbiAqLworICAgIGlmICghY29uZmlnX2Rp
cikgeworCWZhdGFsKCJjb25maWdkaXJlY3Rvcnkgb3B0aW9uIG5vdCBzcGVjaWZpZWQgaW4gY29u
ZmlndXJhdGlvbiBmaWxlIiwKKwkgICAgICBFQ19DT05GSUcpOworICAgIH0KKworICAgIC8qIFNj
YW4gb3B0aW9ucyB0byBzZWUgaWYgd2UgbmVlZCB0byByZXBsYWNlIHtjb25maWdkaXJlY3Rvcnl9
ICovCisgICAgLyogeHh4IG5lZWQgdG8gc2NhbiBvdmVyZmxvdyBvcHRpb25zIGFzIHdlbGwhICov
CisgICAgZm9yKG9wdCA9IElNQVBPUFRfWkVSTzsgb3B0IDwgSU1BUE9QVF9MQVNUOyBvcHQrKykg
eworCWlmKCFpbWFwb3B0c1tvcHRdLnZhbC5zIHx8CisJICAgaW1hcG9wdHNbb3B0XS50ICE9IE9Q
VF9TVFJJTkcgfHwKKwkgICBvcHQgPT0gSU1BUE9QVF9DT05GSUdESVJFQ1RPUlkpIHsKKwkgICAg
LyogU2tpcCBvcHRpb25zIHRoYXQgaGF2ZSBhIE5VTEwgdmFsdWUsIGFyZW4ndCBzdHJpbmdzLCBv
cgorCSAgICAgKiBhcmUgdGhlIGNvbmZpZ2RpcmVjdG9yeSBvcHRpb24gKi8KKwkgICAgY29udGlu
dWU7CisJfQorCQorCS8qIFdlIHVzZSBzb21lIG1hZ2ljIG51bWJlcnMgaGVyZSwKKwkgKiAxNyBp
cyB0aGUgbGVuZ3RoIG9mICJ7Y29uZmlnZGlyZWN0b3J5fSIsCisJICogMTYgaXMgb25lIGxlc3Mg
dGhhbiB0aGF0IGxlbmd0aCwgc28gdGhhdCB0aGUgcmVwbGFjZW1lbnQgc3RyaW5nCisJICogICAg
dGhhdCBpcyBtYWxsb2NlZCBoYXMgcm9vbSBmb3IgdGhlICdcMCcgKi8KKwlpZighc3RybmNhc2Vj
bXAoaW1hcG9wdHNbb3B0XS52YWwucywie2NvbmZpZ2RpcmVjdG9yeX0iLDE3KSkgeworCSAgICBj
b25zdCBjaGFyICpzdHIgPSBpbWFwb3B0c1tvcHRdLnZhbC5zOworCSAgICBjaGFyICpuZXdzdHJp
bmcgPQorCQl4bWFsbG9jKHN0cmxlbihjb25maWdfZGlyKSArIHN0cmxlbihzdHIpIC0gMTYpOwor
CSAgICBjaGFyICpmcmVlbWUgPSBOVUxMOworCSAgICAKKwkgICAgLyogd2UgbmVlZCB0byByZXBs
YWNlIHRoaXMgc3RyaW5nLCB3aWxsIHdlIG5lZWQgdG8gZnJlZQorCSAgICAgKiB0aGUgY3VycmVu
dCB2YWx1ZT8gIC0tIG9ubHkgaWYgd2UndmUgYWN0dWFsbHkgc2VlbiBpdCBpbgorCSAgICAgKiB0
aGUgY29uZmlnIGZpbGUuICovCisJICAgIGlmKGltYXBvcHRzW29wdF0uc2VlbikKKwkJZnJlZW1l
ID0gKGNoYXIgKilzdHI7CisKKwkgICAgLyogQnVpbGQgcmVwbGFjZW1lbnQgc3RyaW5nIGZyb20g
Y29uZmlnZGlyZWN0b3J5IG9wdGlvbiAqLworCSAgICBzdHJjcHkobmV3c3RyaW5nLCBjb25maWdf
ZGlyKTsKKwkgICAgc3RyY2F0KG5ld3N0cmluZywgc3RyICsgMTcpOworCisJICAgIGltYXBvcHRz
W29wdF0udmFsLnMgPSBuZXdzdHJpbmc7CisKKwkgICAgaWYoZnJlZW1lKSBmcmVlKGZyZWVtZSk7
CisJfQorICAgIH0KIH0KIAogLyogdGhpcyBpcyBhIHdyYXBwZXIgdG8gY2FsbCB0aGUgY3lydXMg
Y29uZmlndXJhdGlvbiBmcm9tIFNBU0wgKi8KQEAgLTI4Myw3ICs0NDcsNyBAQAogCiAgICAgaWYg
KCFzdHJjbXAob3B0aW9uLCAic3J2dGFiIikpIHsgCiAJLyogd2UgZG9uJ3QgdHJhbnNmb3JtIHNy
dnRhYiEgKi8KLQkqcmVzdWx0ID0gY29uZmlnX2dldHN0cmluZyhvcHRpb24sIE5VTEwpOworCSpy
ZXN1bHQgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU1JWVEFCKTsKICAgICB9IGVsc2Ugewog
CSpyZXN1bHQgPSBOVUxMOwogCkBAIC0yOTMsMTQgKzQ1NywxNCBAQAogCSAgICBzdHJsY2F0KG9w
dCwgcGx1Z2luX25hbWUsIHNsKTsKIAkgICAgc3RybGNhdChvcHQsICJfIiwgc2wpOwogCSAgICBz
dHJsY2F0KG9wdCwgb3B0aW9uLCBzbCk7Ci0JICAgICpyZXN1bHQgPSBjb25maWdfZ2V0c3RyaW5n
KG9wdCwgTlVMTCk7CisJICAgICpyZXN1bHQgPSBjb25maWdfZ2V0b3ZlcmZsb3dzdHJpbmcob3B0
LCBOVUxMKTsKIAl9CiAKIAlpZiAoKnJlc3VsdCA9PSBOVUxMKSB7CiAJICAgIC8qIHRyeSB3aXRo
b3V0IHRoZSBwbHVnaW4gbmFtZSAqLwogCSAgICBzdHJsY3B5KG9wdCwgInNhc2xfIiwgc2wpOwog
CSAgICBzdHJsY2F0KG9wdCwgb3B0aW9uLCBzbCk7Ci0JICAgICpyZXN1bHQgPSBjb25maWdfZ2V0
c3RyaW5nKG9wdCwgTlVMTCk7CisJICAgICpyZXN1bHQgPSBjb25maWdfZ2V0b3ZlcmZsb3dzdHJp
bmcob3B0LCBOVUxMKTsKIAl9CiAgICAgfQogCkBAIC0zMjAsMTQgKzQ4NCwxNCBAQAogICAgIHN0
YXRpYyBzYXNsX3NlY3VyaXR5X3Byb3BlcnRpZXNfdCByZXQ7CiAKICAgICByZXQubWF4YnVmc2l6
ZSA9IFBST1RfQlVGU0laRTsKLSAgICByZXQubWluX3NzZiA9IGNvbmZpZ19nZXRpbnQoInNhc2xf
bWluaW11bV9sYXllciIsIDApOwkKKyAgICByZXQubWluX3NzZiA9IGNvbmZpZ19nZXRpbnQoSU1B
UE9QVF9TQVNMX01JTklNVU1fTEFZRVIpOwkKIAkJCQkvKiBtaW5pbXVtIGFsbG93YWJsZSBzZWN1
cml0eSBzdHJlbmd0aCAqLwotICAgIHJldC5tYXhfc3NmID0gY29uZmlnX2dldGludCgic2FzbF9t
YXhpbXVtX2xheWVyIiwgMjU2KTsKKyAgICByZXQubWF4X3NzZiA9IGNvbmZpZ19nZXRpbnQoSU1B
UE9QVF9TQVNMX01BWElNVU1fTEFZRVIpOwogCQkJCS8qIG1heGltdW0gYWxsb3dhYmxlIHNlY3Vy
aXR5IHN0cmVuZ3RoICovCiAKICAgICByZXQuc2VjdXJpdHlfZmxhZ3MgPSBmbGFnczsKICAgICAv
KiByZXQuc2VjdXJpdHlfZmxhZ3MgfD0gU0FTTF9TRUNfTk9QTEFJTlRFWFQ7ICovCi0gICAgaWYg
KCFjb25maWdfZ2V0c3dpdGNoKCJhbGxvd2Fub255bW91c2xvZ2luIiwgMCkpIHsKKyAgICBpZiAo
IWNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV0FOT05ZTU9VU0xPR0lOKSkgewogCXJldC5z
ZWN1cml0eV9mbGFncyB8PSBTQVNMX1NFQ19OT0FOT05ZTU9VUzsKICAgICB9CiAgICAgcmV0LnBy
b3BlcnR5X25hbWVzID0gTlVMTDsKQEAgLTMzNiwxMiArNTAwLDE1IEBACiAgICAgcmV0dXJuICZy
ZXQ7CiB9CiAKLS8qIHRydWUgaWYgJ2F1dGhzdGF0ZScgaXMgaW4gJ3ZhbCcgKi8KLXN0YXRpYyBp
bnQgaXNhKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoc3RhdGUsIGNvbnN0IGNoYXIgKm9wdCkKKy8q
IHRydWUgaWYgJ2F1dGhzdGF0ZScgaXMgaW4gJ29wdCcgKi8KK2ludCBjb25maWdfYXV0aGlzYShz
dHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aHN0YXRlLCBlbnVtIGltYXBvcHQgb3B0KQogewogICAgIGNo
YXIgYnVmWzEwMjRdOwotICAgIGNvbnN0IGNoYXIgKnZhbCA9IGNvbmZpZ19nZXRzdHJpbmcob3B0
LCAiIik7CisgICAgY29uc3QgY2hhciAqdmFsID0gY29uZmlnX2dldHN0cmluZyhvcHQpOwogCisg
ICAgLyogSXMgdGhlIG9wdGlvbiBkZWZpbmVkPyAqLworICAgIGlmKCF2YWwpIHJldHVybiAwOwor
CiAgICAgd2hpbGUgKCp2YWwpIHsKIAljaGFyICpwOwogCQpAQCAtMzU1LDM0ICs1MjIsNyBAQAog
CXZhbCA9IHA7CiAJd2hpbGUgKCp2YWwgJiYgaXNzcGFjZSgoaW50KSAqdmFsKSkgdmFsKys7CiAg
ICAgfQotICAgIHJldHVybiAwOwotfQotCi0vKiAKLSAqIGNoZWNrICdzZXJ2aWNlX2NsYXNzJyBh
bmQgJ2NsYXNzJwotICovCi1pbnQgYXV0aGlzYShzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aHN0YXRl
LCAKLQkgICAgY29uc3QgY2hhciAqc2VydmljZSwgCi0JICAgIGNvbnN0IGNoYXIgKmNsYXNzKQot
ewotICAgIGNoYXIgYnVmWzUxMl07Ci0KLSAgICBpZiAoIWF1dGhzdGF0ZSkgewotCS8qIG5vdCBh
dXRoZW50aWNhdGVkPyAqLwotCXJldHVybiAwOwotICAgIH0KIAotICAgIC8qICdjbGFzcycgKi8K
LSAgICBpZiAoaXNhKGF1dGhzdGF0ZSwgY2xhc3MpKSB7Ci0JcmV0dXJuIDE7Ci0gICAgfQotCi0g
ICAgLyogJ3NlcnZpY2VfY2xhc3MnICovCi0gICAgc25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwg
IiVzXyVzIiwgc2VydmljZSwgY2xhc3MpOwotICAgIGlmIChpc2EoYXV0aHN0YXRlLCBidWYpKSB7
Ci0JcmV0dXJuIDE7Ci0gICAgfQotICAgIAogICAgIHJldHVybiAwOwogfQogCkluZGV4OiBpbWFw
L2RlbGl2ZXIuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3Rl
bS9jdnMvc3JjL2N5cnVzL2ltYXAvZGVsaXZlci5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjE2
NApkaWZmIC11IC1yMS4xNjQgZGVsaXZlci5jCi0tLSBkZWxpdmVyLmMJMjAwMi8wNS8yNSAxOTo1
Nzo0NAkxLjE2NAorKysgZGVsaXZlci5jCTIwMDIvMDYvMTggMjM6NDE6MDcKQEAgLTI2MSw3ICsy
NjEsNyBAQAogCiAgICAgY29uZmlnX2luaXQoYWx0X2NvbmZpZywgImRlbGl2ZXIiKTsKIAotICAg
IHNvY2thZGRyID0gY29uZmlnX2dldHN0cmluZygibG10cHNvY2tldCIsIE5VTEwpOworICAgIHNv
Y2thZGRyID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0xNVFBTT0NLRVQpOwogICAgIGlmICgh
c29ja2FkZHIpIHsJCiAJc3RyY3B5KGJ1ZiwgY29uZmlnX2Rpcik7CiAJc3RyY2F0KGJ1ZiwgIi9z
b2NrZXQvbG10cCIpOwpAQCAtMzQ0LDggKzM0NCw4IEBACiAgICAgaWYgKG1haWxib3gpIG1sID0g
c3RybGVuKG1haWxib3gpOwogICAgIGlmIChudW11c2VycyA9PSAwKSB7CiAJLyoganVzdCBkZWxp
dmVyIHRvIG1haWxib3ggJ21haWxib3gnICovCi0JY29uc3QgY2hhciAqQkIgPSBjb25maWdfZ2V0
c3RyaW5nKCJwb3N0dXNlciIsICIiKTsKLQl0eG4tPnJjcHRbMF0uYWRkciA9IChjaGFyICopIHht
YWxsb2MobWwgKyBzdHJsZW4oQkIpICsgMik7IC8qIGxlYWtzISAqLworCWNvbnN0IGNoYXIgKkJC
ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1BPU1RVU0VSKTsKKwl0eG4tPnJjcHRbMF0uYWRk
ciA9IChjaGFyICopIHhtYWxsb2MobWwgKyBzdHJsZW4oQkIpICsgMik7IC8qIHh4eCBsZWFrcyEg
Ki8KIAlzcHJpbnRmKHR4bi0+cmNwdFswXS5hZGRyLCAiJXMrJXMiLCBCQiwgbWFpbGJveCk7CiAg
ICAgfSBlbHNlIHsKIAkvKiBzZXR1cCBlYWNoIHJlY2lwaWVudCAqLwpJbmRleDogaW1hcC9mdWQu
Ywo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3Jj
L2N5cnVzL2ltYXAvZnVkLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMzIKZGlmZiAtdSAtcjEu
MzIgZnVkLmMKLS0tIGZ1ZC5jCTIwMDIvMDYvMDMgMTg6MjI6MjQJMS4zMgorKysgZnVkLmMJMjAw
Mi8wNi8xOCAyMzozODozNwpAQCAtMTU4LDggKzE1OCw2IEBACiB7CiAgICAgaW50IG9wdDsKICAg
IAotICAgIGNvbmZpZ19jaGFuZ2VpZGVudCgiZnVkIik7Ci0KICAgICBpZiAoZ2V0ZXVpZCgpID09
IDApIGZhdGFsKCJtdXN0IHJ1biBhcyB0aGUgQ3lydXMgdXNlciIsIEVDX1VTQUdFKTsKIAogICAg
IHNldHByb2N0aXRsZV9pbml0KGFyZ2MsIGFyZ3YsIGVudnApOwpJbmRleDogaW1hcC9pZGxlX3Bv
bGwuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMv
c3JjL2N5cnVzL2ltYXAvaWRsZV9wb2xsLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNQpkaWZm
IC11IC1yMS41IGlkbGVfcG9sbC5jCi0tLSBpZGxlX3BvbGwuYwkyMDAxLzExLzE5IDIxOjMyOjQ0
CTEuNQorKysgaWRsZV9wb2xsLmMJMjAwMi8wNi8xOCAyMDo0MDoxOQpAQCAtNjUsNyArNjUsNyBA
QAogewogICAgIC8qIGdldCBwb2xsaW5nIHBlcmlvZCAqLwogICAgIGlmIChpZGxlX3BlcmlvZCA9
PSAtMSkgewotICAgICAgaWRsZV9wZXJpb2QgPSBjb25maWdfZ2V0aW50KCJpbWFwaWRsZXBvbGwi
LCA2MCk7CisgICAgICBpZGxlX3BlcmlvZCA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9JTUFQSURM
RVBPTEwpOwogICAgICAgaWYgKGlkbGVfcGVyaW9kIDwgMCkgaWRsZV9wZXJpb2QgPSAwOwogICAg
IH0KIApJbmRleDogaW1hcC9pbWFwY29uZi5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5k
cmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9pbWFwY29uZi5oLHYKcmV0cmll
dmluZyByZXZpc2lvbiAxLjE2CmRpZmYgLXUgLXIxLjE2IGltYXBjb25mLmgKLS0tIGltYXBjb25m
LmgJMjAwMi8wNi8xNCAxODoxODo0OQkxLjE2CisrKyBpbWFwY29uZi5oCTIwMDIvMDYvMTggMjA6
MzE6MTcKQEAgLTQ0LDE0ICs0NCwyMiBAQAogI2RlZmluZSBJTkNMVURFRF9JTUFQQ09ORl9ICiAK
ICNpbmNsdWRlIDxzYXNsL3Nhc2wuaD4KKyNpbmNsdWRlICJpbWFwb3B0cy5oIgogI2luY2x1ZGUg
ImF1dGguaCIKIAorLyogU3RhcnR1cCB0aGUgY29uZmlndXJhdGlvbiBzdWJzeXN0ZW0gKi8KIGV4
dGVybiBpbnQgY29uZmlnX2luaXQoY29uc3QgY2hhciAqYWx0X2NvbmZpZywgY29uc3QgY2hhciAq
aWRlbnQpOwotZXh0ZXJuIGNvbnN0IGNoYXIgKmNvbmZpZ19nZXRzdHJpbmcoY29uc3QgY2hhciAq
a2V5LCBjb25zdCBjaGFyICpkZWYpOwotZXh0ZXJuIGludCBjb25maWdfZ2V0aW50KGNvbnN0IGNo
YXIgKmtleSwgaW50IGRlZik7Ci1leHRlcm4gaW50IGNvbmZpZ19nZXRzd2l0Y2goY29uc3QgY2hh
ciAqa2V5LCBpbnQgZGVmKTsKKworLyogdGhlc2Ugd2lsbCBhc3NlcnQoKSBpZiB0aGV5J3JlIGNh
bGxlZCBvbiB0aGUgd3JvbmcgdHlwZSBvZgorICAgb3B0aW9uIChpbWFwb3B0LmMpICovCitleHRl
cm4gY29uc3QgY2hhciAqY29uZmlnX2dldHN0cmluZyhlbnVtIGltYXBvcHQgb3B0KTsKK2V4dGVy
biBpbnQgY29uZmlnX2dldGludChlbnVtIGltYXBvcHQgb3B0KTsKK2V4dGVybiBpbnQgY29uZmln
X2dldHN3aXRjaChlbnVtIGltYXBvcHQgb3B0KTsKKworLyogdGhlc2Ugd29yayBvbiBhZGRpdGlv
bmFsIHN0cmluZ3MgdGhhdCBhcmUgbm90IGRlZmluZWQgaW4gdGhlCisgKiBpbWFwb3B0aW9ucyB0
YWJsZSAqLworZXh0ZXJuIGNvbnN0IGNoYXIgKmNvbmZpZ19nZXRvdmVyZmxvd3N0cmluZyhjb25z
dCBjaGFyICprZXksIGNvbnN0IGNoYXIgKmRlZik7CiBleHRlcm4gY29uc3QgY2hhciAqY29uZmln
X3BhcnRpdGlvbmRpcihjb25zdCBjaGFyICpwYXJ0aXRpb24pOwotZXh0ZXJuIGludCBjb25maWdf
Y2hhbmdlaWRlbnQoY29uc3QgY2hhciAqaWRlbnQpOwogCiAvKiBzYXNsIGNvbmZpZ3VyYXRpb24g
Ki8KIGV4dGVybiBpbnQgbXlzYXNsX2NvbmZpZyh2b2lkICpjb250ZXh0LApAQCAtODYsMTkgKzk0
LDE1IEBACiAjZW5kaWYKIAogLyogY2hlY2sgaWYgYGF1dGhzdGF0ZScgaXMgYSB2YWxpZCBtZW1i
ZXIgb2YgY2xhc3MgKi8KLWV4dGVybiBpbnQgYXV0aGlzYShzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0
aHN0YXRlLCAKLQkJICAgY29uc3QgY2hhciAqc2VydmljZSwgY29uc3QgY2hhciAqY2xhc3MpOwor
ZXh0ZXJuIGludCBjb25maWdfYXV0aGlzYShzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aHN0YXRlLCAK
KwkJCSAgZW51bSBpbWFwb3B0IG9wdCk7CiAKIC8qIFZhbHVlcyBvZiBtYW5kYXRvcnkgb3B0aW9u
cyAqLwogZXh0ZXJuIGNvbnN0IGNoYXIgKmNvbmZpZ19maWxlbmFtZTsKLQogZXh0ZXJuIGNvbnN0
IGNoYXIgKmNvbmZpZ19kaXI7CiBleHRlcm4gY29uc3QgY2hhciAqY29uZmlnX2RlZnBhcnRpdGlv
bjsKLWV4dGVybiBjb25zdCBjaGFyICpjb25maWdfbmV3c3Nwb29sOwotCiBleHRlcm4gY29uc3Qg
Y2hhciAqY29uZmlnX3NlcnZlcm5hbWU7CiBleHRlcm4gY29uc3QgY2hhciAqY29uZmlnX211cGRh
dGVfc2VydmVyOwotCiBleHRlcm4gaW50IGNvbmZpZ19oYXNoaW1hcHNwb29sOwogCiAvKiBzaWdu
YWwgaGFuZGxpbmcgKHNpZ25hbHMuYykgKi8KSW5kZXg6IGltYXAvaW1hcGQuYwo9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAv
aW1hcGQuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zOTcKZGlmZiAtdSAtcjEuMzk3IGltYXBk
LmMKLS0tIGltYXBkLmMJMjAwMi8wNi8wNyAwMjowNTozMgkxLjM5NworKysgaW1hcGQuYwkyMDAy
LzA2LzE5IDIwOjE4OjIxCkBAIC0yOTQsNyArMjk0LDcgQEAKICAgICAvKiBjaGVjayBpZiByZW1v
dGUgcmVhbG0gKi8KICAgICBpZiAoKHJlYWxtID0gc3RyY2hyKGF1dGhfaWRlbnRpdHksICdAJykp
IT1OVUxMKSB7CiAJcmVhbG0rKzsKLQl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJlYWxt
cyIsICIiKTsKKwl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMpOwog
CXdoaWxlICgqdmFsKSB7CiAJICAgIGlmICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3RybGVu
KHJlYWxtKSkgJiYKIAkJKCF2YWxbc3RybGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2YWxb
c3RybGVuKHJlYWxtKV0pKSkgewpAQCAtMzE0LDE2ICszMTQsMTYgQEAKICAgICBpbWFwZF9hdXRo
c3RhdGUgPSBhdXRoX25ld3N0YXRlKGF1dGhfaWRlbnRpdHksIE5VTEwpOwogCiAgICAgLyogb2ss
IGlzIGF1dGhfaWRlbnRpdHkgYW4gYWRtaW4/ICovCi0gICAgaW1hcGRfdXNlcmlzYWRtaW4gPSBh
dXRoaXNhKGltYXBkX2F1dGhzdGF0ZSwgImltYXAiLCAiYWRtaW5zIik7CisgICAgaW1hcGRfdXNl
cmlzYWRtaW4gPSBjb25maWdfYXV0aGlzYShpbWFwZF9hdXRoc3RhdGUsIElNQVBPUFRfQURNSU5T
KTsKIAogICAgIGlmIChhbGVuICE9IHJsZW4gfHwgc3RybmNtcChhdXRoX2lkZW50aXR5LCByZXF1
ZXN0ZWRfdXNlciwgYWxlbikpIHsKIAkvKiB3ZSB3YW50IHRvIGF1dGhlbnRpY2F0ZSBhcyBhIGRp
ZmZlcmVudCB1c2VyOyB3ZSdsbCBhbGxvdyB0aGlzCiAJICAgaWYgd2UncmUgYW4gYWRtaW4gb3Ig
aWYgd2UndmUgYWxsb3dlZCBBQ0wgcHJveHkgbG9naW5zICovCi0JaW50IHVzZV9hY2wgPSBjb25m
aWdfZ2V0c3dpdGNoKCJsb2dpbnVzZWFjbCIsIDApOworCWludCB1c2VfYWNsID0gY29uZmlnX2dl
dHN3aXRjaChJTUFQT1BUX0xPR0lOVVNFQUNMKTsKIAogCWlmIChpbWFwZF91c2VyaXNhZG1pbiB8
fAogCSAgICAodXNlX2FjbCAmJiBhY2xfb2socmVxdWVzdGVkX3VzZXIsIGltYXBkX2F1dGhzdGF0
ZSkpIHx8Ci0JICAgIGF1dGhpc2EoaW1hcGRfYXV0aHN0YXRlLCAiaW1hcCIsICJwcm94eXNlcnZl
cnMiKSkgeworCSAgICBjb25maWdfYXV0aGlzYShpbWFwZF9hdXRoc3RhdGUsIElNQVBPUFRfUFJP
WFlTRVJWRVJTKSkgewogCSAgICAvKiBwcm94eSBvayEgKi8KIAogCSAgICBpbWFwZF91c2VyaXNh
ZG1pbiA9IDA7CS8qIG5vIGxvbmdlciBhZG1pbiAqLwpAQCAtMzMzLDcgKzMzMyw3IEBACiAKIAkg
ICAgLyogYXJlIHdlIGEgcHJveHkgYWRtaW4/ICovCiAJICAgIGltYXBkX3VzZXJpc3Byb3h5YWRt
aW4gPQotCQlhdXRoaXNhKGltYXBkX2F1dGhzdGF0ZSwgImltYXAiLCAiYWRtaW5zIik7CisJCWNv
bmZpZ19hdXRoaXNhKGltYXBkX2F1dGhzdGF0ZSwgSU1BUE9QVF9BRE1JTlMpOwogCX0gZWxzZSB7
CiAJICAgIHNhc2xfc2V0ZXJyb3IoY29ubiwgMCwgInVzZXIgJXMgaXMgbm90IGFsbG93ZWQgdG8g
cHJveHkiLAogCQkJICBhdXRoX2lkZW50aXR5KTsKQEAgLTUwMCw4ICs1MDAsNiBAQAogewogICAg
IGludCByOwogICAgIGludCBvcHQ7Ci0KLSAgICBjb25maWdfY2hhbmdlaWRlbnQoImltYXBkIik7
CiAgICAgCiAgICAgaWYgKGdldGV1aWQoKSA9PSAwKSBmYXRhbCgibXVzdCBydW4gYXMgdGhlIEN5
cnVzIHVzZXIiLCBFQ19VU0FHRSk7CiAgICAgc2V0cHJvY3RpdGxlX2luaXQoYXJnYywgYXJndiwg
ZW52cCk7CkBAIC01NTQsNyArNTUyLDcgQEAKICAJICAgIGJyZWFrOwogCWNhc2UgJ3MnOiAvKiBp
bWFwcyAoZG8gc3RhcnR0bHMgcmlnaHQgYXdheSkgKi8KIAkgICAgaW1hcHMgPSAxOwotCSAgICBp
ZiAoIXRsc19lbmFibGVkKCJpbWFwIikpIHsKKwkgICAgaWYgKCF0bHNfZW5hYmxlZCgpKSB7CiAJ
CXN5c2xvZyhMT0dfRVJSLCAiaW1hcHM6IHJlcXVpcmVkIE9wZW5TU0wgb3B0aW9ucyBub3QgcHJl
c2VudCIpOwogCQlmYXRhbCgiaW1hcHM6IHJlcXVpcmVkIE9wZW5TU0wgb3B0aW9ucyBub3QgcHJl
c2VudCIsCiAJCSAgICAgIEVDX0NPTkZJRyk7CkBAIC02NTAsNyArNjQ4LDcgQEAKICAgICBwcm9j
X3JlZ2lzdGVyKCJpbWFwZCIsIGltYXBkX2NsaWVudGhvc3QsIE5VTEwsIE5VTEwpOwogCiAgICAg
LyogU2V0IGluYWN0aXZpdHkgdGltZXIgKi8KLSAgICB0aW1lb3V0ID0gY29uZmlnX2dldGludCgi
dGltZW91dCIsIDMwKTsKKyAgICB0aW1lb3V0ID0gY29uZmlnX2dldGludChJTUFQT1BUX1RJTUVP
VVQpOwogICAgIGlmICh0aW1lb3V0IDwgMzApIHRpbWVvdXQgPSAzMDsKICAgICBwcm90X3NldHRp
bWVvdXQoaW1hcGRfaW4sIHRpbWVvdXQqNjApOwogICAgIHByb3Rfc2V0Zmx1c2hvbnJlYWQoaW1h
cGRfaW4sIGltYXBkX291dCk7CkBAIC0xMzY3LDcgKzEzNjUsNyBAQAogCSAgICAKIAljYXNlICdT
JzoKIAkgICAgaWYgKCFzdHJjbXAoY21kLnMsICJTdGFydHRscyIpKSB7Ci0JCWlmICghdGxzX2Vu
YWJsZWQoImltYXAiKSkgeworCQlpZiAoIXRsc19lbmFibGVkKCkpIHsKIAkJICAgIC8qIHdlIGRv
bid0IHN1cHBvcnQgc3RhcnR0bHMgKi8KIAkJICAgIGdvdG8gYmFkY21kOwogCQl9CkBAIC0xNzAz
LDcgKzE3MDEsNyBAQAogCiAgICAgLyogcG9zc2libHkgZGlzYWxsb3cgbG9naW4gKi8KICAgICBp
ZiAoKGltYXBkX3N0YXJ0dGxzX2RvbmUgPT0gMCkgJiYKLQkoY29uZmlnX2dldHN3aXRjaCgiYWxs
b3dwbGFpbnRleHQiLCAxKSA9PSAwKSAmJgorCShjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxM
T1dQTEFJTlRFWFQpID09IDApICYmCiAJc3RyY21wKGNhbm9uX3VzZXIsICJhbm9ueW1vdXMiKSAh
PSAwKSB7CiAJZWF0bGluZShpbWFwZF9pbiwgJyAnKTsKIAlwcm90X3ByaW50ZihpbWFwZF9vdXQs
ICIlcyBOTyBMb2dpbiBvbmx5IGF2YWlsYWJsZSB1bmRlciBhIGxheWVyXHJcbiIsCkBAIC0xNzI3
LDcgKzE3MjUsNyBAQAogICAgIHBhc3N3ZCA9IHBhc3N3ZGJ1Zi5zOwogCiAgICAgaWYgKCFzdHJj
bXAoY2Fub25fdXNlciwgImFub255bW91cyIpKSB7Ci0JaWYgKGNvbmZpZ19nZXRzd2l0Y2goImFs
bG93YW5vbnltb3VzbG9naW4iLCAwKSkgeworCWlmIChjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRf
QUxMT1dBTk9OWU1PVVNMT0dJTikpIHsKIAkgICAgcGFzc3dkID0gYmVhdXRpZnlfc3RyaW5nKHBh
c3N3ZCk7CiAJICAgIGlmIChzdHJsZW4ocGFzc3dkKSA+IDUwMCkgcGFzc3dkWzUwMF0gPSAnXDAn
OwogCSAgICBzeXNsb2coTE9HX05PVElDRSwgImxvZ2luOiAlcyBhbm9ueW1vdXMgJXMiLApAQCAt
MTc3Niw3ICsxNzc0LDcgQEAKIAkgICAgICAgY2Fub25fdXNlciwgaW1hcGRfc3RhcnR0bHNfZG9u
ZSA/ICIrVExTIiA6ICIiLCAKIAkgICAgICAgcmVwbHkgPyByZXBseSA6ICIiKTsKIAotCXBsYWlu
dGV4dGxvZ2lucGF1c2UgPSBjb25maWdfZ2V0aW50KCJwbGFpbnRleHRsb2dpbnBhdXNlIiwgMCk7
CisJcGxhaW50ZXh0bG9naW5wYXVzZSA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9QTEFJTlRFWFRM
T0dJTlBBVVNFKTsKIAlpZiAocGxhaW50ZXh0bG9naW5wYXVzZSAhPSAwICYmICFpbWFwZF9zdGFy
dHRsc19kb25lKSB7CiAJICAgIC8qIEFwcGx5IHBlbmFsdHkgb25seSBpZiBub3QgdW5kZXIgbGF5
ZXIgKi8KIAkgICAgc2xlZXAocGxhaW50ZXh0bG9naW5wYXVzZSk7CkBAIC0xNzg0LDcgKzE3ODIs
NyBAQAogICAgIH0KICAgICAKICAgICBpbWFwZF9hdXRoc3RhdGUgPSBhdXRoX25ld3N0YXRlKGNh
bm9uX3VzZXIsIChjaGFyICopMCk7Ci0gICAgdmFsID0gY29uZmlnX2dldHN0cmluZygiYWRtaW5z
IiwgIiIpOworICAgIHZhbCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9BRE1JTlMpOwogICAg
IHdoaWxlICgqdmFsKSB7CiAJZm9yIChwID0gKGNoYXIgKil2YWw7ICpwICYmICFpc3NwYWNlKChp
bnQpICpwKTsgcCsrKTsKIAlzdHJsY3B5KGJ1ZiwgdmFsLCBwIC0gdmFsKTsKQEAgLTIxMTksNyAr
MjExNyw3IEBACiAKICAgICAvKiBzcGl0IG91dCBvdXIgSUQgc3RyaW5nLgogICAgICAgIGV2ZW50
dWFsbHkgdGhpcyBtaWdodCBiZSBjb25maWd1cmFibGUuICovCi0gICAgaWYgKGNvbmZpZ19nZXRz
d2l0Y2goImltYXBpZHJlc3BvbnNlIiwgMSkpIHsKKyAgICBpZiAoY29uZmlnX2dldHN3aXRjaChJ
TUFQT1BUX0lNQVBJRFJFU1BPTlNFKSkgewogCWlkX3Jlc3BvbnNlKGltYXBkX291dCk7CiAJcHJv
dF9wcmludGYoaW1hcGRfb3V0LCAiKVxyXG4iKTsKICAgICB9CkBAIC0yMjM5LDEwICsyMjM3LDEw
IEBACiAJcHJvdF9wcmludGYoaW1hcGRfb3V0LCAiIElETEUiKTsKICAgICB9CiAKLSAgICBpZiAo
dGxzX2VuYWJsZWQoImltYXAiKSkgeworICAgIGlmICh0bHNfZW5hYmxlZCgpKSB7CiAJcHJvdF9w
cmludGYoaW1hcGRfb3V0LCAiIFNUQVJUVExTIik7CiAgICAgfQotICAgIGlmICghaW1hcGRfc3Rh
cnR0bHNfZG9uZSAmJiAhY29uZmlnX2dldHN3aXRjaCgiYWxsb3dwbGFpbnRleHQiLCAxKSkgewor
ICAgIGlmICghaW1hcGRfc3RhcnR0bHNfZG9uZSAmJiAhY29uZmlnX2dldHN3aXRjaChJTUFQT1BU
X0FMTE9XUExBSU5URVhUKSkgewogCXByb3RfcHJpbnRmKGltYXBkX291dCwgIiBMT0dJTkRJU0FC
TEVEIik7CiAgICAgfQogCkBAIC0yNTY3LDcgKzI1NjUsNyBAQAogCQlwcm90X3ByaW50ZihpbWFw
ZF9vdXQsICIqIE5PIFtBTEVSVF0gJXNcclxuIiwKIAkJCSAgICBlcnJvcl9tZXNzYWdlKElNQVBf
Tk9fT1ZFUlFVT1RBKSk7CiAJICAgIH0KLQkgICAgZWxzZSBpZiAodXNhZ2UgPiBjb25maWdfZ2V0
aW50KCJxdW90YXdhcm4iLCA5MCkpIHsKKwkgICAgZWxzZSBpZiAodXNhZ2UgPiBjb25maWdfZ2V0
aW50KElNQVBPUFRfUVVPVEFXQVJOKSkgewogCQlpbnQgdXNhZ2VpbnQgPSAoaW50KSB1c2FnZTsK
IAkJcHJvdF9wcmludGYoaW1hcGRfb3V0LCAiKiBOTyBbQUxFUlRdICIpOwogCQlwcm90X3ByaW50
ZihpbWFwZF9vdXQsIGVycm9yX21lc3NhZ2UoSU1BUF9OT19DTE9TRVFVT1RBKSwKQEAgLTM1NTgs
NyArMzU1Niw3IEBACiAJCQkJICAgbG9jYWxvbmx5LCBsb2NhbG9ubHkpOwogCiAJaWYgKHIgPT0g
SU1BUF9QRVJNSVNTSU9OX0RFTklFRCAmJiAhc3RyY2FzZWNtcChuYW1lLCAiSU5CT1giKSAmJgot
CSAgICAoYXV0b2NyZWF0ZXF1b3RhID0gY29uZmlnX2dldGludCgiYXV0b2NyZWF0ZXF1b3RhIiwg
MCkpKSB7CisJICAgIChhdXRvY3JlYXRlcXVvdGEgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfQVVU
T0NSRUFURVFVT1RBKSkpIHsKIAogCSAgICAvKiBBdXRvIGNyZWF0ZSAqLwogCSAgICByID0gbWJv
eGxpc3RfY3JlYXRlbWFpbGJveChtYWlsYm94bmFtZSwgMCwKQEAgLTM5MzcsNyArMzkzNSw3IEBA
CiAgICAgbWJveG5hbWVfaGllcnNlcF90b2ludGVybmFsKCZpbWFwZF9uYW1lc3BhY2UsIHBhdHRl
cm4pOwogCiAgICAgaWYgKCFzdHJjYXNlY21wKG5hbWVzcGFjZSwgIm1haWxib3hlcyIpKSB7Ci0J
aW50IGZvcmNlID0gY29uZmlnX2dldHN3aXRjaCgiYWxsb3dhbGxzdWJzY3JpYmUiLCAwKTsKKwlp
bnQgZm9yY2UgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dBTExTVUJTQ1JJQkUpOwog
CiAJKCppbWFwZF9uYW1lc3BhY2UubWJveGxpc3RfZmluZHN1YikoJmltYXBkX25hbWVzcGFjZSwg
cGF0dGVybiwKIAkJCQkJICAgIGltYXBkX3VzZXJpc2FkbWluLCBpbWFwZF91c2VyaWQsCkBAIC0z
OTg2LDcgKzM5ODQsNyBAQAogICAgIC8qIElnbm9yZSB0aGUgcmVmZXJlbmNlIGFyZ3VtZW50Pwog
ICAgICAgICh0aGUgYmVoYXZpb3IgaW4gMS41LjEwICYgb2xkZXIpICovCiAgICAgaWYgKGlnbm9y
ZXJlZmVyZW5jZSA9PSAwKSB7Ci0JaWdub3JlcmVmZXJlbmNlID0gY29uZmlnX2dldHN3aXRjaCgi
aWdub3JlcmVmZXJlbmNlIiwgMCk7CisJaWdub3JlcmVmZXJlbmNlID0gY29uZmlnX2dldHN3aXRj
aChJTUFQT1BUX0lHTk9SRVJFRkVSRU5DRSk7CiAgICAgfQogCiAgICAgLyogUmVzZXQgc3RhdGUg
aW4gbXN0cmluZ2RhdGEgKi8KQEAgLTQwMjcsNyArNDAyNSw4IEBACiAJbWJveG5hbWVfaGllcnNl
cF90b2ludGVybmFsKCZpbWFwZF9uYW1lc3BhY2UsIHBhdHRlcm4pOwogCiAJLyogQ2hlY2sgdG8g
c2VlIGlmIHdlIHNob3VsZCBvbmx5IGxpc3QgdGhlIHBlcnNvbmFsIG5hbWVzcGFjZSAqLwotCWlm
ICghc3RyY21wKHBhdHRlcm4sICIqIikgJiYgY29uZmlnX2dldGludCgiZm9vbHN0dXBpZGNsaWVu
dHMiLCAwKSkgeworCWlmICghc3RyY21wKHBhdHRlcm4sICIqIikKKwkgICAgJiYgY29uZmlnX2dl
dHN3aXRjaChJTUFQT1BUX0ZPT0xTVFVQSURDTElFTlRTKSkgewogCSAgICBpZiAoYnVmKSBmcmVl
KGJ1Zik7CiAJICAgIGJ1ZiA9IHN0cmR1cCgiSU5CT1gqIik7CiAJICAgIHBhdHRlcm4gPSBidWY7
CkBAIC00MDQwLDcgKzQwMzksNyBAQAogCX0KIAogCWlmIChsaXN0b3B0cyAmIExJU1RfTFNVQiB8
fCBsaXN0b3B0cyAmIExJU1RfU1VCU0NSSUJFRCkgewotCSAgICBpbnQgZm9yY2UgPSBjb25maWdf
Z2V0c3dpdGNoKCJhbGxvd2FsbHN1YnNjcmliZSIsIDApOworCSAgICBpbnQgZm9yY2UgPSBjb25m
aWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dBTExTVUJTQ1JJQkUpOwogCiAJICAgICgqZmluZHN1
YikoJmltYXBkX25hbWVzcGFjZSwgcGF0dGVybiwKIAkJICAgICAgIGltYXBkX3VzZXJpc2FkbWlu
LCBpbWFwZF91c2VyaWQsIGltYXBkX2F1dGhzdGF0ZSwKQEAgLTQwNzAsNyArNDA2OSw3IEBACiB7
CiAgICAgaW50IHI7CiAgICAgY2hhciBtYWlsYm94bmFtZVtNQVhfTUFJTEJPWF9OQU1FKzFdOwot
ICAgIGludCBmb3JjZSA9IGNvbmZpZ19nZXRzd2l0Y2goImFsbG93YWxsc3Vic2NyaWJlIiwgMCk7
CisgICAgaW50IGZvcmNlID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XQUxMU1VCU0NS
SUJFKTsKIAogICAgIGlmIChuYW1lc3BhY2UpIGxjYXNlKG5hbWVzcGFjZSk7CiAgICAgaWYgKCFu
YW1lc3BhY2UgfHwgIXN0cmNtcChuYW1lc3BhY2UsICJtYWlsYm94IikpIHsKQEAgLTQ3NjIsNyAr
NDc2MSw3IEBACiB7CiAgICAgY29uc3QgY2hhciAqdXJsOwogCi0gICAgdXJsID0gY29uZmlnX2dl
dHN0cmluZygibmV0c2NhcGV1cmwiLCBOVUxMKTsKKyAgICB1cmwgPSBjb25maWdfZ2V0c3RyaW5n
KElNQVBPUFRfTkVUU0NBUEVVUkwpOwogCiAgICAgLyogSSBvbmx5IGtub3cgb2YgdGhyZWUgdGhp
bmdzIHRvIHJlcGx5IHdpdGg6ICovCiAgICAgcHJvdF9wcmludGYoaW1hcGRfb3V0LApJbmRleDog
aW1hcC9pbWFwb3B0aW9ucwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiBpbWFwb3B0aW9ucwpkaWZmIC1O
IGltYXBvcHRpb25zCi0tLSAvZGV2L251bGwJVHVlIE1heSAgNSAxNjozMjoyNyAxOTk4CisrKyBp
bWFwb3B0aW9ucwlUdWUgSnVuIDE4IDIwOjA3OjA5IDIwMDIKQEAgLTAsMCArMSw0NjYgQEAKKy8q
CisuXCIgLSotIG5yb2ZmIC0qLQorLlRIIElNQVBELkNPTkYgNSAiUHJvamVjdCBDeXJ1cyIgQ01V
CisuXCIgCisuXCIgQ29weXJpZ2h0IChjKSAxOTk4LTIwMDAgQ2FybmVnaWUgTWVsbG9uIFVuaXZl
cnNpdHkuICBBbGwgcmlnaHRzIHJlc2VydmVkLgorLlwiCisuXCIgUmVkaXN0cmlidXRpb24gYW5k
IHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0CisuXCIgbW9k
aWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25k
aXRpb25zCisuXCIgYXJlIG1ldDoKKy5cIgorLlwiIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3Vy
Y2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0CisuXCIgICAgbm90aWNlLCB0
aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLiAKKy5c
IgorLlwiIDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0
aGUgYWJvdmUgY29weXJpZ2h0CisuXCIgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9u
cyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluCisuXCIgICAgdGhlIGRvY3VtZW50YXRp
b24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZQorLlwiICAgIGRpc3Ry
aWJ1dGlvbi4KKy5cIgorLlwiIDMuIFRoZSBuYW1lICJDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0
eSIgbXVzdCBub3QgYmUgdXNlZCB0bworLlwiICAgIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0
cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0CisuXCIgICAgcHJpb3Igd3JpdHRl
biBwZXJtaXNzaW9uLiBGb3IgcGVybWlzc2lvbiBvciBhbnkgb3RoZXIgbGVnYWwKKy5cIiAgICBk
ZXRhaWxzLCBwbGVhc2UgY29udGFjdCAgCisuXCIgICAgICBPZmZpY2Ugb2YgVGVjaG5vbG9neSBU
cmFuc2ZlcgorLlwiICAgICAgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkKKy5cIiAgICAgIDUw
MDAgRm9yYmVzIEF2ZW51ZQorLlwiICAgICAgUGl0dHNidXJnaCwgUEEgIDE1MjEzLTM4OTAKKy5c
IiAgICAgICg0MTIpIDI2OC00Mzg3LCBmYXg6ICg0MTIpIDI2OC03Mzk1CisuXCIgICAgICB0ZWNo
LXRyYW5zZmVyQGFuZHJldy5jbXUuZWR1CisuXCIKKy5cIiA0LiBSZWRpc3RyaWJ1dGlvbnMgb2Yg
YW55IGZvcm0gd2hhdHNvZXZlciBtdXN0IHJldGFpbiB0aGUgZm9sbG93aW5nCisuXCIgICAgYWNr
bm93bGVkZ21lbnQ6CisuXCIgICAgIlRoaXMgcHJvZHVjdCBpbmNsdWRlcyBzb2Z0d2FyZSBkZXZl
bG9wZWQgYnkgQ29tcHV0aW5nIFNlcnZpY2VzCisuXCIgICAgIGF0IENhcm5lZ2llIE1lbGxvbiBV
bml2ZXJzaXR5IChodHRwOi8vd3d3LmNtdS5lZHUvY29tcHV0aW5nLykuIgorLlwiCisuXCIgQ0FS
TkVHSUUgTUVMTE9OIFVOSVZFUlNJVFkgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEggUkVH
QVJEIFRPCisuXCIgVEhJUyBTT0ZUV0FSRSwgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJ
RVMgT0YgTUVSQ0hBTlRBQklMSVRZCisuXCIgQU5EIEZJVE5FU1MsIElOIE5PIEVWRU5UIFNIQUxM
IENBUk5FR0lFIE1FTExPTiBVTklWRVJTSVRZIEJFIExJQUJMRQorLlwiIEZPUiBBTlkgU1BFQ0lB
TCwgSU5ESVJFQ1QgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTCisuXCIg
V0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTSBMT1NTIE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBX
SEVUSEVSIElOCisuXCIgQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SIE9USEVS
IFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORworLlwiIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJ
VEggVEhFIFVTRSBPUiBQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLgorLlwiIAorLlwiICRJ
ZDogaW1hcGQuY29uZi41LHYgMS42NSAyMDAyLzA2LzEyIDE3OjM4OjU4IHJqczMgRXhwICQKKy5T
SCBOQU1FCitpbWFwZC5jb25mIFwtIElNQVAgY29uZmlndXJhdGlvbiBmaWxlCisuU0ggREVTQ1JJ
UFRJT04KK1xmQi9ldGMvaW1hcGQuY29uZlxmUiAKK2lzIHRoZSBjb25maWd1cmF0aW9uIGZpbGUg
Zm9yIHRoZSBDeXJ1cyBJTUFQIHNlcnZlci4gIEl0IGRlZmluZXMKK2xvY2FsIHBhcmFtZXRlcnMg
Zm9yIElNQVAuIAorLlBQCitFYWNoIGxpbmUgb2YgdGhlIFxmQi9ldGMvaW1hcGQuY29uZlxmUiBm
aWxlIGhhcyB0aGUgZm9ybQorLklQCitcZklvcHRpb25cZlI6IFxmSXZhbHVlXGZSCisuUFAKK3do
ZXJlIFxmSW9wdGlvblxmUiBpcyB0aGUgbmFtZSBvZiB0aGUgY29uZmlndXJhdGlvbiBvcHRpb24g
YmVpbmcgc2V0CithbmQgXGZJdmFsdWVcZlIgaXMgdGhlIHZhbHVlIHRoYXQgdGhlIGNvbmZpZ3Vy
YXRpb24gb3B0aW9uIGlzIGJlaW5nCitzZXQgdG8uCisuUFAKK0JsYW5rIGxpbmVzIGFuZCBsaW5l
cyBiZWdpbm5pbmcgd2l0aCBgYCMnJyBhcmUgaWdub3JlZC4KKy5QUAorRm9yIGJvb2xlYW4gb3B0
aW9ucywgdGhlIHZhbHVlcyBgYHllcycnLCBgYG9uJycsIGBgdCcnLCBhbmQgYGAxJycgdHVybiB0
aGUKK29wdGlvbiBvbiwgdGhlIHZhbHVlcyBgYG5vJycsIGBgb2ZmJycsIGBgZicnLCBhbmQgYGAw
JycgdHVybiB0aGUgb3B0aW9uIG9mZi4KKy5TSCBGSUVMRCBERVNDUklQVElPTlMKKy5QUAorVGhl
IHNlY3Rpb25zIGJlbG93IGRldGFpbCBvcHRpb25zIHRoYXQgY2FuIGJlIHBsYWNlZCBpbiB0aGUK
K1xmQi9ldGMvaW1hcGQuY29uZlxmUiBmaWxlLCBhbmQgc2hvdyBlYWNoIG9wdGlvbidzIGRlZmF1
bHQgdmFsdWUuCitTb21lIG9wdGlvbnMgaGF2ZSBubyBkZWZhdWx0IHZhbHVlLCB0aGVzZSBhcmUg
bGlzdGVkIHdpdGgKK2BgPG5vIGRlZmF1bHQ+JycuICBTb21lIG9wdGlvbnMgZGVmYXVsdCB0byB0
aGUgZW1wdHkgc3RyaW5nLCB0aGVzZQorYXJlIGxpc3RlZCB3aXRoIGBgPG5vbmU+JycuCisqLwor
CisjIE9QVElPTlMKKworeyAiYWNhcF9hdXRobmFtZSIsIE5VTEwsIFNUUklORyB9CisKK3sgImFj
YXBfZ2V0YXV0aCIsIE5VTEwsIFNUUklORyB9CisKK3sgImFjYXBfcGFzc3dvcmQiLCBOVUxMLCBT
VFJJTkcgfQorCit7ICJhY2FwX3JlYWxtIiwgTlVMTCwgU1RSSU5HIH0KKworeyAiYWNhcF9yZXRy
eV90aW1lb3V0IiwgNjAsIElOVCB9CisKK3sgImFjYXBfc2VydmVyIiwgTlVMTCwgU1RSSU5HIH0g
IAorCit7ICJhY2FwX3VzZXJuYW1lIiwgTlVMTCwgU1RSSU5HIH0KKworeyAiYWRtaW5zIiwgIiIs
IFNUUklORyB9CisvKiBUaGUgbGlzdCBvZiB1c2VyaWRzIHdpdGggYWRtaW5pc3RyYXRpdmUgcmln
aHRzLiAgU2VwYXJhdGUgZWFjaCB1c2VyaWQKKyAgIHdpdGggYSBzcGFjZS4gIFNpdGVzIHVzaW5n
IEtlcmJlcm9zIGF1dGhlbnRpY2F0aW9uIG1heSB1c2UKKyAgIHNlcGFyYXRlICJhZG1pbiIgaW5z
dGFuY2VzLgorLlBQCisgICBOb3RlIHRoYXQgYWNjb3VudHMgdXNlZCBieSB1c2VycyBzaG91bGQg
bm90IGJlIGFkbWluaXN0cmF0b3JzLgorICAgQWRtaW5pc3RyYXRpdmUgYWNjb3VudHMgc2hvdWxk
IG5vdCByZWNlaXZlIG1haWwuICBUaGF0IGlzLCBpZiB1c2VyCisgICAiamJSbyIgaXMgYSB1c2Vy
IHJlYWRpbmcgbWFpbCwgaGUgc2hvdWxkIG5vdCBhbHNvIGJlIGluIHRoZSBhZG1pbnMgbGluZS4K
KyAgIFNvbWUgcHJvYmxlbXMgbWF5IG9jY3VyIG90aGVyd2lzZSwgbW9zdCBub3RhYmx5IHRoZSBh
YmlsaXR5IG9mCisgICBhZG1pbmlzdHJhdG9ycyB0byBjcmVhdGUgdG9wLWxldmVsIG1haWxib3hl
cyB2aXNpYmxlIHRvIHVzZXJzLAorICAgYnV0IG5vdCB3cml0YWJsZSBieSB1c2Vycy4gKi8KKwor
eyAiYWxsb3dhbGxzdWJzY3JpYmUiLCAwLCBTV0lUQ0ggfQorLyogQWxsb3cgc3Vic2NyaXB0aW9u
IHRvIG5vbmV4aXN0YW50IG1haWxib3hlcy4gKi8KKworeyAiYWxsb3dhbm9ueW1vdXNsb2dpbiIs
IDAsIFNXSVRDSCB9CisvKiBQZXJtaXQgbG9naW5zIGJ5IHRoZSB1c2VyICJhbm9ueW1vdXMiIHVz
aW5nIGFueSBwYXNzd29yZC4gIEFsc28KKyAgIGFsbG93cyB1c2Ugb2YgdGhlIFNBU0wgQU5PTllN
T1VTIG1lY2hhbmlzbS4gKi8KKworeyAiYWxsb3dwbGFpbnRleHQiLCAxLCBTV0lUQ0ggfQorLyog
QWxsb3cgdGhlIHVzZSBvZiB0aGUgU0FTTCBQTEFJTiBtZWNoYW5pc20uICovCisgICAKK3sgImFs
dG5hbWVzcGFjZSIsIDAsIFNXSVRDSCB9CisvKiBVc2UgdGhlIGFsdGVybmF0ZSBJTUFQIG5hbWVz
cGFjZSwgd2hlcmUgcGVyc29uYWwgZm9sZGVycyByZXNpZGUgYXQgdGhlCisgICBzYW1lIGxldmVs
IGluIHRoZSBoaWVyYXJjaHkgYXMgSU5CT1guCisuUFAKKyAgIFRoaXMgb3B0aW9uIE9OTFkgYXBw
bGllcyB3aGVyZSBpbnRlcmFjdGlvbiB0YWtlcyBwbGFjZSB3aXRoIHRoZQorICAgY2xpZW50L3Vz
ZXIuICBDdXJyZW50bHkgdGhpcyBpcyBsaW1pdGVkIHRvIHRoZSBJTUFQIHByb3RvY29sIChpbWFw
ZCkKKyAgIGFuZCBTaWV2ZSBzY3JpcHRzIChsbXRwZCkuICBUaGlzIG9wdGlvbiBkb2VzIE5PVCBh
cHBseSB0byBhZG1pbiB0b29scworICAgc3VjaCBhcyBjeXJhZG0gKGFkbWlucyBPTkxZKSwgcmVj
b25zdHJ1Y3QsIHF1b3RhLCBldGMuLCBOT1IgZG9lcyBpdAorICAgYWZmZWN0IExNVFAgZGVsaXZl
cnkgb2YgbWVzc2FnZXMgZGlyZWN0bHkgdG8gbWFpbGJveGVzIHZpYQorICAgcGx1cy1hZGRyZXNz
aW5nLiAqLworCit7ICJhdXRvY3JlYXRlcXVvdGEiLCAwLCBJTlQgfQorLyogSWYgbm9uemVybywg
bm9ybWFsIHVzZXJzIG1heSBjcmVhdGUgdGhlaXIgb3duIElNQVAgYWNjb3VudHMgYnkKKyAgIGNy
ZWF0aW5nIHRoZSBtYWlsYm94IElOQk9YLiAgVGhlIHVzZXIncyBxdW90YSBpcyBzZXQgdG8gdGhl
IHZhbHVlCisgICBpZiBpdCBpcyBwb3NpdGl2ZSwgb3RoZXJ3aXNlIHRoZSB1c2VyIGhhcyB1bmxp
bWl0ZWQgcXVvdGEuICovCisKK3sgImNvbmZpZ2RpcmVjdG9yeSIsIE5VTEwsIFNUUklORyB9Cisv
KiBUaGUgcGF0aG5hbWUgb2YgdGhlIElNQVAgY29uZmlndXJhdGlvbiBkaXJlY3RvcnkuICBUaGlz
IGZpZWxkIGlzCisgICByZXF1aXJlZC4gKi8KKworeyAiZGVidWdfY29tbWFuZCIsIE5VTEwsIFNU
UklORyB9CisvKiBEZWJ1ZyBjb21tYW5kIHRvIGJlIHVzZWQgYnkgcHJvY2Vzc2VzIHN0YXJ0ZWQg
d2l0aCAtRCBvcHRpb24uICBUaGUgc3RyaW5nCisgICBpcyBhIEMgZm9ybWF0IHN0cmluZyB0aGF0
IGdldHMgMyBvcHRpb25zOiB0aGUgZmlyc3QgaXMgdGhlIG5hbWUgb2YgdGhlCisgICBleGVjdXRh
YmxlICh3aXRob3V0IHBhdGgpLiAgVGhlIHNlY29uZCBpcyB0aGUgcGlkIChpbnRlZ2VyKSBhbmQg
dGhlIHRoaXJkCisgICBpcyB0aGUgc2VydmljZSBJRC4gIEV4YW1wbGU6IC91c3IvbG9jYWwvYmlu
L2dkYiAvdXNyL2N5cnVzL2Jpbi8lcyAlZCAqLworCit7ICJkZWZhdWx0YWNsIiwgImFueW9uZSBs
cnMiLCBTVFJJTkcgfQorLyogVGhlIEFjY2VzcyBDb250cm9sIExpc3QgKEFDTCkgcGxhY2VkIG9u
IGEgbmV3bHktY3JlYXRlZCAobm9uLXVzZXIpCisgICBtYWlsYm94IHRoYXQgZG9lcyBub3QgaGF2
ZSBhIHBhcmVudCBtYWlsYm94LiAqLworCit7ICJkZWZhdWx0cGFydGl0aW9uIiwgImRlZmF1bHQi
LCBTVFJJTkcgfQorLyogVGhlIHBhcnRpdGlvbiBuYW1lIHVzZWQgYnkgZGVmYXVsdCBmb3IgbmV3
IG1haWxib3hlcy4gKi8KKworeyAiZGVsZXRlcmlnaHQiLCAiYyIsIFNUUklORyB9CisvKiBUaGUg
cmlnaHQgdGhhdCBhIHVzZXIgbmVlZHMgdG8gZGVsZXRlIGEgbWFpbGJveC4gKi8KKworeyAiZHVw
bGljYXRlc3VwcHJlc3Npb24iLCAxLCBTV0lUQ0ggfQorLyogSWYgZW5hYmxlZCwgbG10cGQgd2ls
bCBzdXBwcmVzcyBkZWxpdmVyeSBvZiBhIG1lc3NhZ2UgdG8gYSBtYWlsYm94IGlmCisgICBhIG1l
c3NhZ2Ugd2l0aCB0aGUgc2FtZSBtZXNzYWdlLWlkIChvciByZXNlbnQtbWVzc2FnZS1pZCkgaXMg
cmVjb3JkZWQKKyAgIGFzIGhhdmluZyBhbHJlYWR5IGJlZW4gZGVsaXZlcmVkIHRvIHRoZSBtYWls
Ym94LiAgUmVjb3JkcyB0aGUgbWFpbGJveAorICAgYW5kIG1lc3NhZ2UtaWQvcmVzZW50LW1lc3Nh
Z2UtaWQgb2YgYWxsIHN1Y2Nlc3NmdWwgZGVsaXZlcmllcy4gKi8KKworeyAiZm9vbHN0dXBpZGNs
aWVudHMiLCAwLCBTV0lUQ0ggfQorLyogSWYgZW5hYmxlZCwgb25seSBsaXN0IHRoZSBwZXJzb25h
bCBuYW1lc3BhY2Ugd2hlbiBhIExJU1QgIioiIGlzIHBlcmZvcm1lZC4KKyAgIChpdCBjaGFuZ2Vz
IHRoZSByZXF1ZXN0IHRvIGEgTElTVCAiSU5CT1gqIiAqLworCit7ICJoYXNoaW1hcHNwb29sIiwg
MCwgU1dJVENIIH0KKy8qIElmIGVuYWJsZWQsIHRoZSBwYXJ0aXRpb25zIHdpbGwgYWxzbyBiZSBo
YXNoZWQsIGluIGFkZGl0aW9uIHRvIHRoZQorICAgaGFzaGluZyBkb25lIG9uIGNvbmZpZ3VyYXRp
b24gZGlyZWN0b3JpZXMuICBUaGlzIGlzIHJlY29tbWVuZGVkIGlmCisgICBvbmUgcGFydGl0aW9u
IGhhcyBhIHZlcnkgYnVzaHkgbWFpbGJveCB0cmVlLiAqLworCisjIENvbW1lbnRlZCBvdXQgLSB0
aGVyZSdzIG5vIHN1Y2ggdGhpbmcgYXMgInBhcnRpdGlvbi1uYW1lIiwgYnV0IHdlIG5lZWQKKyMg
dGhpcyBmb3IgdGhlIG1hbiBwYWdlCisjIHsgImhvc3RuYW1lX21lY2hzIiwgTlVMTCwgU1RSSU5H
IH0KKy8qIEZvcmNlIGEgcGFydGljdWFyIGxpc3Qgb2YgU0FTTCBtZWNoYW5pc21zIHRvIGJlIHVz
ZWQgd2hlbiBhdXRoZW50aWNhdGluZworICAgdG8gdGhlIGJhY2tlbmQgc2VydmVyIGhvc3RuYW1l
ICh3aGVyZSBob3N0bmFtZSBpcyB0aGUgc2hvcnQgaG9zdG5hbWUgb2YKKyAgIHRoZSBzZXJ2ZXIg
aW4gcXVlc3Rpb24pLiBJZiBpdCBpcyBub3Qgc3BlY2lmaWVkIGl0IHdpbGwgcXVlcnkgdGhlIHNl
cnZlcgorICAgZm9yIGF2YWlsYWJsZSBtZWNoYW5pc21zIGFuZCBwaWNrIG9uZSB0byB1c2UuIC0g
Q3lydXMgTXVyZGVyCisKKyMgeyAiaG9zdG5hbWVfcGFzc3dvcmQiLCBOVUxMLCBTVFJJTkcgfQor
LyogVGhlIHBhc3N3b3JkIHRvIHVzZSBmb3IgYXV0aGVudGljYXRpb24gdG8gdGhlIGJhY2tlbmQg
c2VydmVyIGhvc3RuYW1lCisgICAod2hlcmUgaG9zdG5hbWUgaXMgdGhlIHNob3J0IGhvc3RuYW1l
IG9mIHRoZSBzZXJ2ZXIpIC0gQ3lydXMgTXVyZGVyICovCisKK3sgImlkbGVzb2NrZXQiLCAie2Nv
bmZpZ2RpcmVjdG9yeX0vc29ja2V0L2lkbGUiLCBTVFJJTkcgfQorLyogVW5peCBkb21haW4gc29j
a2V0IHRoYXQgaWRsZWQgbGlzdGVucyBvbi4gKi8KKworeyAiaWdub3JlcmVmZXJlbmNlIiwgMCwg
U1dJVENIIH0KKy8qIEZvciBiYWNrd2FyZHMgY29tcGF0aWJpbGl0eSB3aXRoIEN5cnVzIDEuNS4x
MCBhbmQgZWFybGllciAtLSBpZ25vcmUKKyAqIHRoZSByZWZlcmVuY2UgYXJndW1lbnQgaW4gTElT
VCBvciBMU1VCIGNvbW1hbmRzYSAqLworCit7ICJpbWFwaWRsZXBvbGwiLCA2MCwgSU5UIH0KKy8q
IFRoZSBpbnRlcnZhbCAoaW4gc2Vjb25kcykgZm9yIHBvbGxpbmcgdGhlIG1haWxib3ggZm9yIGNo
YW5nZXMgd2hpbGUKKyAgIHJ1bm5pbmcgdGhlIElETEUgY29tbWFuZC4gIFRoaXMgb3B0aW9uIGlz
IHVzZWQgd2hlbiBpZGxlZCBjYW4gbm90CisgICBiZSBjb250YWN0ZWQgb3Igd2hlbiBwb2xsaW5n
IGlzIHVzZWQgZXhjbHVzaXZlbHkuICBUaGUgbWluaW11bQorICAgdmFsdWUgaXMgMS4gIEEgdmFs
dWUgb2YgMCB3aWxsIGRpc2FibGUgcG9sbGluZyAoYW5kIGRpc2FibGUgSURMRSBpZgorICAgcG9s
bGluZyBpcyB0aGUgb25seSBtZXRob2QgYXZhaWxhYmxlKS4gKi8KKworeyAiaW1hcGlkcmVzcG9u
c2UiLCAxLCBTV0lUQ0ggfQorLyogSWYgZW5hYmxlZCwgdGhlIHNlcnZlciByZXNwb25kcyB0byBh
biBJRCBjb21tYW5kIHdpdGggYSBwYXJhbWV0ZXIgCisgICBsaXN0IGNvbnRhaW5pbmc6IHZlcnNp
b24sIHZlbmRvciwgc3VwcG9ydC11cmwsIG9zLCBvcy12ZXJzaW9uLAorICAgY29tbWFuZCwgYXJn
dW1lbnRzLCBlbnZpcm9ubWVudC4gIE90aGVyd2lzZSB0aGUgc2VydmVyIHJldHVybnMgTklMLiAq
LworCit7ICJsbXRwX292ZXJfcXVvdGFfcGVybV9mYWlsdXJlIiwgMCwgU1dJVENIIH0KKy8qIElm
IGVuYWJsZWQsIGxtdHBkIHJldHVybnMgYSBwZXJtYW5lbnQgZmFpbHVyZSBjb2RlIHdoZW4gYSB1
c2VyJ3MKKyAgIG1haWxib3ggaXMgb3ZlciBxdW90YS4gIEJ5IGRlZmF1bHQsIHRoZSBmYWlsdXJl
IGlzIHRlbXBvcmFyeS4gKi8KKworeyAibG10cHNvY2tldCIsICJ7Y29uZmlnZGlyZWN0b3J5fS9z
b2NrZXQvbG10cCIsIFNUUklORyB9CisvKiBVbml4IGRvbWFpbiBzb2NrZXQgdGhhdCBsbXRwZCBs
aXN0ZW5zIG9uLCB1c2VkIGJ5IGRlbGl2ZXIoOCkuICovCisKK3sgImxvZ2lucmVhbG1zIiwgIiIs
IFNUUklORyB9CisvKiBUaGUgbGlzdCBvZiByZW1vdGUgcmVhbG1zIHdob3NlIHVzZXJzIG1heSBs
b2cgaW4gdXNpbmcgY3Jvc3MtcmVhbG0KKyAgIGF1dGhlbnRpY2F0aW9ucy4gIFNlcGVyYXRlIGVh
Y2ggcmVhbG0gbmFtZSBieSBhIHNwYWNlLiAgKEEKKyAgIGNyb3NzLXJlYWxtIGlkZW50aXR5IGlz
IGNvbnNpZGVyZWQgYW55IGlkZW50aXR5IHJldHVybmVkIGJ5IFNBU0wKKyAgIHdpdGggYW4gIkAi
IGluIGl0LikgKi8KKworeyAibG9naW51c2VhY2wiLCAwLCBTV0lUQ0ggfQorLyogSWYgZW5hYmxl
ZCwgYW55IGF1dGhlbnRpY2F0aW9uIGlkZW50aXR5IHdoaWNoIGhhcyBcZkJhXGZSIHJpZ2h0cyBv
biBhCisgICB1c2VyJ3MgSU5CT1ggbWF5IGxvZyBpbiBhcyB0aGF0IHVzZXIuICovCisKK3sgImxv
Z3RpbWVzdGFtcHMiLCAwLCBTV0lUQ0ggfQorLyogSW5jbHVkZSBub3RhdGlvbnMgaW4gdGhlIHBy
b3RvY29sIHRlbGVtZXRyeSBsb2dzIGluZGljYXRpbmcgdGhlIG51bWJlciBvZgorICAgc2Vjb25k
cyBzaW5jZSB0aGUgbGFzdCBjb21tYW5kIG9yIHJlc3BvbnNlLiAqLworCit7ICJtYWlsbm90aWZp
ZXIiLCBOVUxMLCBTVFJJTkcgfQorLyogTm90aWZ5ZCg4KSBtZXRob2QgdG8gdXNlIGZvciAiTUFJ
TCIgbm90aWZpY2F0aW9ucy4gIElmIG5vdCBzZXQsICJNQUlMIgorICAgbm90aWZpY2F0aW9ucyBh
cmUgZGlzYWJsZWQuICovCisKK3sgIm1heG1lc3NhZ2VzaXplIiwgMCwgSU5UIH0KKy8qIE1heGlt
dW0gaW5jb21pbmcgTE1UUCBtZXNzYWdlIHNpemUuICBJZiBub24temVybywgbG10cGQgd2lsbCBy
ZWplY3QKKyAgIG1lc3NhZ2VzIGxhcmdlciB0aGFuIFxmSW1heG1lc3NhZ2VzaXplXGZSIGJ5dGVz
LiAgSWYgc2V0IHRvIDAsIHRoaXMKKyAgIHdpbGwgYWxsb3cgbWVzc2FnZXMgb2YgYW55IHNpemUg
KHRoZSBkZWZhdWx0KS4gKi8KKworeyAibXVwZGF0ZV9hdXRobmFtZSIsIE5VTEwsIFNUUklORyB9
CisvKiBUaGUgU0FTTCB1c2VybmFtZSAoQXV0aGVudGljYXRpb24gTmFtZSkgdG8gdXNlIHdoZW4g
YXV0aGVudGljYXRpbmcgdG8gdGhlCisgICBtdXBkYXRlIHNlcnZlciAoaWYgbmVlZGVkKS4gKi8K
KworeyAibXVwZGF0ZV9wYXNzd29yZCIsIE5VTEwsIFNUUklORyB9CisvKiBUaGUgU0FTTCBwYXNz
d29yZCAoaWYgbmVlZGVkKSB0byB1c2Ugd2hlbiBhdXRoZW50aWNhdGluZyB0byB0aGUKKyAgIG11
cGRhdGUgc2VydmVyLiAqLworCit7ICJtdXBkYXRlX3BvcnQiLCAyMDA0LCBJTlQgfQorLyogVGhl
IHBvcnQgb2YgdGhlIG11cGRhdGUgc2VydmVyIGZvciB0aGUgQ3lydXMgTXVyZGVyICovCisKK3sg
Im11cGRhdGVfcmVhbG0iLCBOVUxMLCBTVFJJTkcgfQorLyogVGhlIFNBU0wgcmVhbG0gKGlmIG5l
ZWRlZCkgdG8gdXNlIHdoZW4gYXV0aGVudGljYXRpbmcgdG8gdGhlIG11cGRhdGUKKyAgIHNlcnZl
ci4gKi8KKworeyAibXVwZGF0ZV9yZXRyeV9kZWxheSIsIDIwLCBJTlQgfQorLyogVGhlIGJhc2Ug
dGltZSB0byB3YWl0IGJldHdlZW4gY29ubmVjdGlvbiByZXRyaWVzIHRvIHRoZSBtdXBkYXRlIHNl
cnZlci4gKi8KKworeyAibXVwZGF0ZV9zZXJ2ZXIiLCBOVUxMLCBTVFJJTkcgfQorLyogVGhlIG11
cGRhdGUgc2VydmVyIGZvciB0aGUgQ3lydXMgTXVyZGVyICovCisKK3sgIm11cGRhdGVfdXNlcm5h
bWUiLCAiIiwgU1RSSU5HIH0KKy8qIFRoZSBTQVNMIHVzZXJuYW1lIChBdXRob3JpemF0aW9uIE5h
bWUpIHRvIHVzZSB3aGVuIGF1dGhlbnRpY2F0aW5nIHRvCisgICB0aGUgbXVwZGF0ZSBzZXJ2ZXIg
Ki8KKworeyAibmV0c2NhcGV1cmwiLCAiaHR0cDovL2FzZy53ZWIuY211LmVkdS9jeXJ1cy9pbWFw
ZC9uZXRzY2FwZS1hZG1pbi5odG1sIiwgU1RSSU5HIH0KKy8qIElmIGVuYWJsZWQgYXQgY29tcGls
ZSB0aW1lLCB0aGlzIHNwZWNpZmllcyBhIFVSTCB0byByZXBseSB3aGVuCisgICBOZXRzY2FwZSBh
c2tzIHRoZSBzZXJ2ZXIgd2hlcmUgdGhlIG1haWwgYWRtaW5pc3RyYXRpb24gSFRUUCBzZXJ2ZXIK
KyAgIGlzLiAgVGhlIGRlZmF1bHQgaXMgYSBzaXRlIGF0IENNVSB3aXRoIGEgaG9wZWZ1bGx5IGlu
Zm9ybWF0aXZlCisgICBtZXNzYWdlOyBhZG1pbmlzdHJhdG9ycyBzaG91bGQgc2V0IHRoaXMgdG8g
YSBsb2NhbCByZXNvdXJjZSB3aXRoCisgICBzb21lIGluZm9ybWF0aW9uIG9mIGdyZWF0ZXIgdXNl
LiAqLworCit7ICJuZXdzcHJlZml4IiwgMCwgU1RSSU5HIH0KKy8qIFByZWZpeCB0byBiZSBwcmVw
ZW5kZWQgdG8gbmV3c2dyb3VwIG5hbWVzIHRvIG1ha2UgdGhlIGNvcnJlc3BvbmRpbmcKKyAgIElN
QVAgbWFpbGJveCBuYW1lcy4gKi8KKworeyAibm90aWZ5c29ja2V0IiwgIntjb25maWdkaXJlY3Rv
cnl9L3NvY2tldC9ub3RpZnkiLCBTVFJJTkcgfQorLyogVW5peCBkb21haW4gc29ja2V0IHRoYXQg
dGhlIG5ldyBtYWlsIG5vdGlmaWNhdGlvbiBkYWVtb24gbGlzdGVucyBvbi4gKi8KKworIyBDb21t
ZW50ZWQgb3V0IC0gdGhlcmUncyBubyBzdWNoIHRoaW5nIGFzICJwYXJ0aXRpb24tbmFtZSIsIGJ1
dCB3ZSBuZWVkCisjIHRoaXMgZm9yIHRoZSBtYW4gcGFnZQorIyB7ICJwYXJ0aXRpb24tbmFtZSIs
IE5VTEwsIFNUUklORyB9CisvKiBUaGUgcGF0aG5hbWUgb2YgdGhlIHBhcnRpdGlvbiBcZkluYW1l
XGZSLiAgQXQgbGVhc3Qgb25lIGZpZWxkLCBmb3IgdGhlCisgICBwYXJ0aXRpb24gbmFtZWQgaW4g
dGhlIFxmQmRlZmF1bHRwYXJ0aXRpb25cZlIgb3B0aW9uLCBpcyByZXF1aXJlZC4KKyAgIEZvciBl
eGFtcGxlLCBpZiB0aGUgdmFsdWUgb2YgdGhlIFxmQmRlZmF1bHRwYXJ0aW9uXGZSIG9wdGlvbiBp
cworICAgXGZCZGVmYXVsdFxmUiwgdGhlbiB0aGUgXGZCcGFydGl0aW9uLWRlZmF1bHRcZlIgZmll
bGQgaXMgcmVxdWlyZWQuICovCisKKyMgeyAicGFydGl0aW9uLW5ld3MiLCBOVUxMLCBTVFJJTkcg
fQorCit7ICJwbGFpbnRleHRsb2dpbnBhdXNlIiwgMCwgSU5UIH0KKy8qIE51bWJlciBvZiBzZWNv
bmRzIHRvIHBhdXNlIGFmdGVyIGEgc3VjY2Vzc2Z1bCBwbGFpbnRleHQgbG9naW4uICBGb3IKKyAg
IHN5c3RlbXMgdGhhdCBzdXBwb3J0IHN0cm9uZyBhdXRoZW50aWNhdGlvbiwgdGhpcyBwZXJtaXRz
IHVzZXJzIHRvICAKKyAgIHBlcmNlaXZlIGEgY29zdCBvZiB1c2luZyBwbGFpbnRleHQgcGFzc3dv
cmRzLiAgKFRoaXMgZG9lcyBub3QKKyAgIGFmZmVjdCB0aGUgdXNlIG9mIFBMQUlOIGluIFNBU0wg
YXV0aGVudGljYXRpb25zLikgKi8KKworeyAicG9wZXhwaXJldGltZSIsIC0xLCBJTlQgfQorLyog
VGhlIG51bWJlciBvZiBkYXlzIGFkdmVydGlzZWQgYXMgYmVpbmcgdGhlIG1pbmltdW0gYSBtZXNz
YWdlIG1heSBiZQorICAgbGVmdCBvbiB0aGUgUE9QIHNlcnZlciBiZWZvcmUgaXQgaXMgZGVsZXRl
ZCAodmlhIHRoZSBDQVBBIGNvbW1hbmQsCisgICBkZWZpbmVkIGluIHRoZSBQT1AzIEV4dGVuc2lv
biBNZWNoYW5pc20sIHdoaWNoIHNvbWUgY2xpZW50cyBtYXkKKyAgIHN1cHBvcnQpLiAgIk5FVkVS
IiwgdGhlIGRlZmF1bHQsIG1heSBiZSBzcGVjaWZpZWQgd2l0aCBhIG5lZ2F0aXZlCisgICBudW1i
ZXIuICBUaGUgQ3lydXMgUE9QMyBzZXJ2ZXIgbmV2ZXIgZGVsZXRlcyBtYWlsLCBubyBtYXR0ZXIg
d2hhdCAgCisgICB0aGUgdmFsdWUgb2YgdGhpcyBwYXJhbWV0ZXIgaXMuICBIb3dldmVyLCBpZiBh
IHNpdGUgaW1wbGVtZW50cyBhIAorICAgbGVzcyBsaWJlcmFsIHBvbGljeSwgaXQgbmVlZHMgdG8g
Y2hhbmdlIHRoaXMgcGFyYW1ldGVyCisgICBhY2NvcmRpbmdseS4gKi8KKworeyAicG9wbWlucG9s
bCIsIDAsIElOVCB9CisvKiBTZXQgdGhlIG1pbmltdW0gYW1vdW50IG9mIHRpbWUgdGhlIHNlcnZl
ciBmb3JjZXMgdXNlcnMgdG8gd2FpdAorICAgYmV0d2VlbiBzdWNjZXNzaXZlIFBPUCBsb2dpbnMs
IGluIG1pbnV0ZXMuICBUaGUgZGVmYXVsdCBpcyAwLiAqLyAKKworeyAicG9wdGltZW91dCIsIDEw
LCBJTlQgfQorLyogU2V0IHRoZSBsZW5ndGggb2YgdGhlIFBPUCBzZXJ2ZXIncyBpbmFjdGl2aXR5
IGF1dG9sb2dvdXQgdGltZXIsICAgIAorICAgaW4gbWludXRlcy4gIFRoZSBtaW5pbXVtIHZhbHVl
IGlzIDEwLCB0aGUgZGVmYXVsdC4gKi8KKworeyAicG9zdG1hc3RlciIsICJwb3N0bWFzdGVyIiwg
U1RSSU5HIH0KKy8qIFVzZXJuYW1lIHRoYXQgaXMgdXNlZCBhcyB0aGUgJ0Zyb20nIGFkZHJlc3Mg
aW4gcmVqZWN0aW9uIE1ETnMgcHJvZHVjZWQKKyAgIGJ5IHNpZXZlLiAqLworICAgCit7ICJwb3N0
c3BlYyIsIE5VTEwsIFNUUklORyB9CisKK3sgInBvc3R1c2VyIiwgIiIsIFNUUklORyB9CisvKiBV
c2VyaWQgdXNlZCB0byBkZWxpdmVyIG1lc3NhZ2VzIHRvIHNoYXJlZCBmb2xkZXJzLiAgRm9yIGV4
YW1wbGUsIGlmCisgICBzZXQgdG8gImJiIiwgZW1haWwgc2VudCB0byAiYmIrc2hhcmVkLmJsYWgi
IHdvdWxkIGJlIGRlbGl2ZXJlZCB0bworICAgdGhlICJzaGFyZWQuYmxhaCIgZm9sZGVyLiAgQnkg
ZGVmYXVsdCwgYW4gZW1haWwgYWRkcmVzcyBvZgorICAgIitzaGFyZWQuYmxhaCIgd291bGQgYmUg
dXNlZC4gKi8gCisKK3sgInByb3h5X2F1dGhuYW1lIiwgInByb3h5IiwgU1RSSU5HIH0KKy8qIFRo
ZSBhdXRoZW50aWNhdGlvbiBuYW1lIHRvIHVzZSB3aGVuIGF1dGhlbnRpY2F0aW5nIHRvIGEgYmFj
a2VuZCBzZXJ2ZXIKKyAgIGluIHRoZSBDeXJ1cyBNdXJkZXIuICovCisKK3sgInByb3h5X3Bhc3N3
b3JkIiwgTlVMTCwgU1RSSU5HIH0KKy8qIFRoZSBkZWZhdWx0IHBhc3N3b3JkIHRvIHVzZSB3aGVu
IGF1dGhlbnRpY2F0aW5nIHRvIGEgYmFja2VuZCBzZXJ2ZXIKKyAgIGluIHRoZSBDeXJ1cyBNdXJk
ZXIuICBNYXkgYmUgb3ZlcnJpZGRlbiBvbiBhIGhvc3Qtc3BlY2lmaWMgYmFzaXMgdXNpbmcKKyAg
IHRoZSBob3N0bmFtZV9wYXNzd29yZCBvcHRpb24uICovCisKK3sgInByb3h5X3JlYWxtIiwgTlVM
TCwgU1RSSU5HIH0KKy8qIFRoZSBhdXRoZW50aWNhdGlvbiByZWFsbSB0byB1c2Ugd2hlbiBhdXRo
ZW50aWNhdGluZyB0byBhIGJhY2tlbmQgc2VydmVyCisgICBpbiB0aGUgQ3lydXMgTXVyZGVyICov
CisKK3sgInByb3h5ZF9hbGxvd19zdGF0dXNfcmVmZXJyYWwiLCAwLCBTV0lUQ0ggfQorLyogU2V0
IHRvIHRydWUgdG8gYWxsb3cgcHJveHlkIHRvIGlzc3VlIHJlZmVycmFscyB0byBjbGllbnRzIHRo
YXQgc3VwcG9ydCBpdAorICAgd2hlbiBhbnN3ZXJpbmcgdGhlIFNUQVRVUyBjb21tYW5kLiAgVGhp
cyBpcyBkaXNhYmxlZCBieSBkZWZhdWx0IHNpbmNlCisgICBzb21lIGNsaWVudHMgaXNzdWUgbWFu
eSBTVEFUVVMgY29tbWFuZHMgaW4gYSByb3csIGFuZCBkbyBub3QgY2FjaGUgdGhlCisgICBjb25u
ZWN0aW9ucyB0aGF0IHRoZXNlIHJlZmVycmFscyB3b3VsZCBjYXVzZSwgdGh1cyByZXN1bHRpbmcg
aW4gYSBoaWdoZXIKKyAgIGF1dGhlbnRpY2F0aW9uIGxvYWQgb24gdGhlIHJlc3BlY3RpdmUgYmFj
a2VuZCBzZXJ2ZXIuICovCisKK3sgInByb3h5c2VydmVycyIsIE5VTEwsIFNUUklORyB9CisvKiBB
IGxpc3Qgb2YgdXNlcnMgYW5kIGdyb3VwcyB0aGF0IGFyZSBhbGxvd2VkIHRvIHByb3h5IGZvciBv
dGhlcgorICAgdXNlcnMsIHNlcGVyYXRlZCBieSBzcGFjZXMuICBBbnkgdXNlciBsaXN0ZWQgaW4g
dGhpcyB3aWxsIGJlCisgICBhbGxvd2VkIHRvIGxvZ2luIGZvciBhbnkgb3RoZXIgdXNlcjogdXNl
IHdpdGggY2F1dGlvbi4gKi8gCisKK3sgInF1b3Rhd2FybiIsIDkwLCBJTlQgfQorLyogVGhlIHBl
cmNlbnQgb2YgcXVvdGEgdXRpbGl6YXRpb24gb3ZlciB3aGljaCB0aGUgc2VydmVyIGdlbmVyYXRl
cworICAgd2FybmluZ3MuICovCisKK3sgInJlamVjdDhiaXQiLCAwLCBTV0lUQ0ggfQorLyogSWYg
ZW5hYmxlZCwgbG10cGQgcmVqZWN0cyBtZXNzYWdlcyB3aXRoIDgtYml0IGNoYXJhY3RlcnMgaW4g
dGhlCisgICBoZWFkZXJzLiAgT3RoZXJ3aXNlLCA4LWJpdCBjaGFyYWN0ZXJzIGFyZSBjaGFuZ2Vk
IHRvIGBYJy4gIChBCisgICBwcm9wZXIgc291bHRpb24gdG8gbm9uLUFTQ0lJIGNoYXJhY3RlcnMg
aW4gaGVhZGVycyBpcyBvZmZlcmVkIGJ5ICAKKyAgIFJGQyAyMDQ3IGFuZCBpdHMgcHJlZGVjZXNz
b3JzLikgKi8KKworIyBDb21tZW50ZWQgb3V0IC0gdXNlZCBieSBsaWJzYXNsCisjIHsgInNhc2xf
YXV0b190cmFuc2l0aW9uIiwgMCwgU1dJVENIIH0KKy8qIElmIGVuYWJsZWQsIHRoZSBTQVNMIGxp
YnJhcnkgd2lsbCBhdXRvbWF0aWNhbGx5IGNyZWF0ZSBhdXRoZW50aWNhdGlvbgorICAgc2VjcmV0
cyB3aGVuIGdpdmVuIGEgcGxhaW50ZXh0IHBhc3N3b3JkLiAgU2VlIHRoZSBTQVNMIGRvY3VtZW50
YXRpb24uICovCisKK3sgInNhc2xfbWF4aW11bV9sYXllciIsIDI1NiwgSU5UIH0KKy8qIE1heGlt
dW0gU1NGIChzZWN1cml0eSBzdHJlbmd0aCBmYWN0b3IpIHRoYXQgdGhlIHNlcnZlciB3aWxsIGFs
bG93IGEKKyAgIGNsaWVudCB0byBuZWdvdGlhdGUuICovCisKK3sgInNhc2xfbWluaW11bV9sYXll
ciIsIDAsIElOVCB9CisvKiBUaGUgbWluaW11bSBTU0YgdGhhdCB0aGUgc2VydmVyIHdpbGwgYWxs
b3cgYSBjbGllbnQgdG8gbmVnb3RpYXRlLgorICAgQSB2YWx1ZSBvZiAxIHJlcXVpcmVzIGludGVn
cml0eSBwcm90ZWN0aW9uOyBhbnkgaGlnaGVyIHZhbHVlICAKKyAgIHJlcXVpcmVzIHNvbWUgYW1v
dW50IG9mIGVuY3J5cHRpb24uICovCisKKyMgQ29tbWVudGVkIG91dCAtIHVzZWQgYnkgbGlic2Fz
bAorIyB7ICJzYXNsX29wdGlvbiIsIDAsIFNUUklORyB9CisvKiBBbnkgU0FTTCBvcHRpb24gY2Fu
IGJlIHNldCBieSBwcmVjZWVkaW5nIGl0IHdpdGggInNhc2xfIi4gIFRoaXMKKyAgIGZpbGUgb3Zl
cnJpZGVzIHRoZSBTQVNMIGNvbmZpZ3VyYXRpb24gZmlsZS4gKi8KKworIyBDb21tZW50ZWQgb3V0
IC0gdXNlZCBieSBsaWJzYXNsCisjIHsgInNhc2xfcHdjaGVja19tZXRob2QiLCBOVUxMLCBTVFJJ
TkcgfQorLyogVGhlIG1lY2hhbmlzbSB1c2VkIGJ5IHRoZSBzZXJ2ZXIgdG8gdmVyaWZ5IHBsYWlu
dGV4dCBwYXNzd29yZHMuIAorICAgUG9zc2libGUgdmFsdWVzIGluY2x1ZGUgImF1eHByb3AiLCAi
c2FzbGF1dGhkIiwgYW5kICJwd2NoZWNrIi4gKi8KKworeyAic2VuZG1haWwiLCAiL3Vzci9saWIv
c2VuZG1haWwiLCBTVFJJTkcgfQorLyogVGhlIHBhdGhuYW1lIG9mIHRoZSBzZW5kbWFpbCBleGVj
dXRhYmxlLiAgU2lldmUgaW52b2tlcyBzZW5kbWFpbAorICAgZm9yIHNlbmRpbmcgcmVqZWN0aW9u
cywgcmVkaXJlY3RzIGFuZCB2YWNhdGlvbiByZXNwb25zZXMuICovCisKK3sgInNlcnZlcm5hbWUi
LCBOVUxMLCBTVFJJTkcgfQorLyogVGhpcyBpcyB0aGUgaG9zdG5hbWUgdmlzaWJsZSBpbiB0aGUg
Z3JlZXRpbmcgbWVzc2FnZXMgb2YgdGhlIFBPUCwKKyAgIElNQVAgYW5kIExNVFAgZGFlbW9ucy4g
SWYgaXQgaXMgdW5zZXQsIHRoZW4gdGhlIHJlc3VsdCByZXR1cm5lZAorICAgZnJvbSBnZXRob3N0
bmFtZSgyKSBpcyB1c2VkLiAqLworICAgCit7ICJzaGFyZWRwcmVmaXgiLCAiU2hhcmVkIEZvbGRl
cnMiLCBTVFJJTkcgfQorLyogSWYgdXNpbmcgdGhlIGFsdGVybmF0ZSBJTUFQIG5hbWVzcGFjZSwg
dGhlIHByZWZpeCBmb3IgdGhlIHNoYXJlZAorICAgbmFtZXNwYWNlLiAgVGhlIGhpZXJhcmNoeSBk
ZWxpbWl0ZXIgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGFwcGVuZGVkLiAqLworCit7ICJzaWV2ZV9t
YXhzY3JpcHRzaXplIiwgMzIsIElOVCB9CisvKiBNYXhpbXVtIHNpemUgKGluIGtpbG9ieXRlcykg
YW55IHNpZXZlIHNjcmlwdCBjYW4gYmUsIGVuZm9yY2VkIGF0CisgICBzdWJtaXNzaW9uIGJ5IHRp
bXNpZXZlZCg4KS4gKi8KKworeyAic2lldmVfbWF4c2NyaXB0cyIsIDUsIElOVCB9CisvKiBNYXhp
bXVtIG51bWJlciBvZiBzaWV2ZSBzY3JpcHRzIGFueSB1c2VyIG1heSBoYXZlLCBlbmZvcmNlZCBh
dAorICAgc3VibWlzc2lvbiBieSB0aW1zaWV2ZWQoOCkuICovCisgICAKK3sgInNpZXZlZGlyIiwg
Ii91c3Ivc2lldmUiLCBTVFJJTkcgfQorLyogSWYgc2lldmV1c2Vob21lZGlyIGlzIGZhbHNlLCB0
aGlzIGRpcmVjdG9yeSBpcyBzZWFyY2hlZCBmb3IgU2lldmUKKyAgIHNjcmlwdHMuICovCisKK3sg
InNpZXZlbm90aWZpZXIiLCBOVUxMLCBTVFJJTkcgfQorLyogTm90aWZ5ZCg4KSBtZXRob2QgdG8g
dXNlIGZvciAiU0lFVkUiIG5vdGlmaWNhdGlvbnMuICBJZiBub3Qgc2V0LCAiU0lFVkUiCisgICBu
b3RpZmljYXRpb25zIGFyZSBkaXNhYmxlZC4KKy5QUAorICAgVGhpcyBtZXRob2QgaXMgb25seSB1
c2VkIHdoZW4gbm8gbWV0aG9kIGlzIHNwZWNpZmllZCBpbiB0aGUgc2NyaXB0LiAqLworCit7ICJz
aWV2ZXVzZWhvbWVkaXIiLCAwLCBTV0lUQ0ggfQorLyogSWYgZW5hYmxlZCwgbG10cGQgd2lsbCBs
b29rIGZvciBTaWV2ZSBzY3JpcHRzIGluIHVzZXIncyBob21lCisgICBkaXJlY3RvcmllczogfnVz
ZXIvLnNpZXZlLiAqLworCit7ICJzaW5nbGVpbnN0YW5jZXN0b3JlIiwgMSwgU1dJVENIIH0KKy8q
IElmIGVuYWJsZWQsIGxtdHBkIGF0dGVtcHRzIHRvIG9ubHkgd3JpdGUgb25lIGNvcHkgb2YgYSBt
ZXNzYWdlIHBlcgorICAgcGFydGl0aW9uIGFuZCBjcmVhdGUgaGFyZCBsaW5rcywgcmVzdWx0aW5n
IGluIGEgcG90ZW50aWFsbHkgbGFyZ2UKKyAgIGRpc2sgc2F2aW5ncy4gKi8KKworeyAic29mdF9u
b2F1dGgiLCAxLCBTV0lUQ0ggfQorLyogSWYgZW5hYmxlZCwgbG10cGQgcmV0dXJucyB0ZW1wb3Jh
cnkgZmFpbHVyZXMgaWYgdGhlIGNsaWVudCBkb2VzIG5vdAorICogc3VjY2Vzc2Z1bGx5IGF1dGhl
bnRpY2F0ZS4gIE90aGVyd2lzZSBsbXRwZCByZXR1cm5zIHBlcm1hbmFudCBmYWlsdXJlcworICog
KGNhdXNpbmcgdGhlIG1haWwgdG8gYm91bmNlIGltbWVkaWF0ZWx5KS4gKi8KKworeyAic3J2dGFi
IiwgIiIsIFNUUklORyB9CisvKiBUaGUgcGF0aG5hbWUgb2YgXGZJc3J2dGFiXGZSIGZpbGUgY29u
dGFpbmluZyB0aGUgc2VydmVyJ3MgcHJpdmF0ZQorICAga2V5LiAgVGhpcyBvcHRpb24gaXMgcGFz
c2VkIHRvIHRoZSBTQVNMIGxpYnJhcnkgYW5kIG92ZXJyaWRlcyBpdHMKKyAgIGRlZmF1bHQgc2V0
dGluZy4gKi8KKworeyAidGltZW91dCIsIDMwLCBJTlQgfSAgIAorLyogVGhlIGxlbmd0aCBvZiB0
aGUgSU1BUCBzZXJ2ZXIncyBpbmFjdGl2aXR5IGF1dG9sb2dvdXQgdGltZXIsICAgICAgIAorICAg
aW4gbWludXRlcy4gIFRoZSBtaW5pbXVtIHZhbHVlIGlzIDMwLCB0aGUgZGVmYXVsdC4gKi8KKwor
eyAidGxzX2NhX2ZpbGUiLCBOVUxMLCBTVFJJTkcgfQorLyogRmlsZSBjb250YWluaW5nIG9uZSBv
ciBtb3JlIENlcnRpZmljYXRlIEF1dGhvcml0eSAoQ0EpIGNlcnRpZmljYXRlcy4gKi8KKworeyAi
dGxzX2NhX3BhdGgiLCBOVUxMLCBTVFJJTkcgfQorLyogUGF0aCB0byBkaXJlY3Rvcnkgd2l0aCBj
ZXJ0aWZpY2F0ZXMgb2YgQ0FzLiAgVGhpcyBkaXJlY3RvcnkgbXVzdAorICAgaGF2ZSBmaWxlbmFt
ZXMgd2l0aCB0aGUgaGFzaGVkIHZhbHVlIG9mIHRoZSBjZXJ0aWZpY2F0ZSAoc2VlCisgICBvcGVu
c3NsKFhYWCkpLiAqLworCit7ICJ0bHNfY2VydF9maWxlIiwgTlVMTCwgU1RSSU5HIH0KKy8qIEZp
bGUgY29udGFpbmluZyB0aGUgY2VydGlmaWNhdGUgcHJlc2VudGVkIGZvciBzZXJ2ZXIgYXV0aGVu
dGljYXRpb24KKyAgIGR1cmluZyBTVEFSVFRMUy4gIEEgdmFsdWUgb2YgImRpc2FibGVkIiB3aWxs
IGRpc2FibGUgU1NML1RMUy4gKi8KKworeyAidGxzX2NpcGhlcl9saXN0IiwgIkRFRkFVTFQiLCBT
VFJJTkcgfQorLyogVGhlIGxpc3Qgb2YgU1NML1RMUyBjaXBoZXJzIHRvIGFsbG93LiAgVGhlIGZv
cm1hdCBvZiB0aGUgc3RyaW5nIGlzCisgICBkZXNjcmliZWQgaW4gY2lwaGVycygxKS4gKi8KKwor
eyAidGxzX2tleV9maWxlIiwgTlVMTCwgU1RSSU5HIH0KKy8qIEZpbGUgY29udGFpbmluZyB0aGUg
cHJpdmF0ZSBrZXkgYmVsb25naW5nIHRvIHRoZSBzZXJ2ZXIKKyAgIGNlcnRpZmljYXRlLiAgQSB2
YWx1ZSBvZiAiZGlzYWJsZWQiIHdpbGwgZGlzYWJsZSBTU0wvVExTLiAqLworCit7ICJ0bHNfcmVx
dWlyZV9jZXJ0IiwgMCwgU1dJVENIIH0KKy8qIFJlcXVpcmUgYSBjbGllbnQgY2VydGlmaWNhdGUg
Zm9yIEFMTCBzZXJ2aWNlcyAoaW1hcCwgcG9wMywgbG10cCwgc2lldmUpLiAqLworCit7ICJ0bHNf
c2Vzc2lvbl90aW1lb3V0IiwgMTQ0MCwgSU5UIH0KKy8qIFRoZSBsZW5ndGggb2YgdGltZSAoaW4g
bWludXRlcykgdGhhdCBhIFRMUyBzZXNzaW9uIHdpbGwgYmUgY2FjaGVkCisgICBmb3IgbGF0ZXIg
cmV1c2UuICBUaGUgbWF4aW11bSB2YWx1ZSBpcyAxNDQwICgyNCBob3VycyksIHRoZQorICAgZGVm
YXVsdC4gIEEgdmFsdWUgb2YgMCB3aWxsIGRpc2FibGUgc2Vzc2lvbiBjYWNoaW5nLiAqLworCit7
ICJ1bWFzayIsICIwNzciLCBTVFJJTkcgfQorLyogVGhlIHVtYXNrIHZhbHVlIHVzZWQgYnkgdmFy
aW91cyBDeXJ1cyBJTUFQIHByb2dyYW1zLiAqLworCit7ICJ1c2VycHJlZml4IiwgIk90aGVyIFVz
ZXJzIiwgU1RSSU5HIH0KKy8qIElmIHVzaW5nIHRoZSBhbHRlcm5hdGUgSU1BUCBuYW1lc3BhY2Us
IHRoZSBwcmVmaXggZm9yIHRoZSBvdGhlciB1c2VycworICAgbmFtZXNwYWNlLiAgVGhlIGhpZXJh
cmNoeSBkZWxpbWl0ZXIgd2lsbCBiZSBhdXRvbWF0aWNhbGx5IGFwcGVuZGVkLiAqLworCit7ICJ1
bml4aGllcmFyY2h5c2VwIiwgMCwgU1dJVENIIH0KKy8qIFVzZSB0aGUgVU5JWCBzZXBhcmF0b3Ig
Y2hhcmFjdGVyICcvJyBmb3IgZGVsaW1pdGluZyBsZXZlbHMgb2YKKyAgIG1haWxib3ggaGllcmFy
Y2h5LiAgVGhlIGRlZmF1bHQgaXMgdG8gdXNlIHRoZSBuZXRuZXdzIHNlcGFyYXRvcgorICAgY2hh
cmFjdGVyICcuJy4gKi8KKworLyoKKy5TSCBTRUUgQUxTTworLlBQCitcZkJpbWFwZCg4KVxmUiwg
XGZCcG9wM2QoOClcZlIsIFxmQmxtdHBkKDgpXGZSLCBcZkJ0aW1zaWV2ZWQoOClcZlIsCitcZkJp
ZGxlZCg4KVxmUiwgXGZCbm90aWZ5ZCg4KVxmUiwgXGZCZGVsaXZlcig4KVxmUiwgXGZCbWFzdGVy
KDgpXGZSLCAKK1xmQmNpcGhlcnMoMSlcZlIKKyovClwgTm8gbmV3bGluZSBhdCBlbmQgb2YgZmls
ZQpJbmRleDogaW1hcC9sbXRwZC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNt
dS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9sbXRwZC5jLHYKcmV0cmlldmluZyByZXZp
c2lvbiAxLjk4CmRpZmYgLXUgLXIxLjk4IGxtdHBkLmMKLS0tIGxtdHBkLmMJMjAwMi8wNi8wMyAx
ODoyMjoyNgkxLjk4CisrKyBsbXRwZC5jCTIwMDIvMDYvMTggMjA6NDU6NTAKQEAgLTE5NCw3ICsx
OTQsNyBAQAogICAgIC8qIGNoZWNrIGlmIHJlbW90ZSByZWFsbSAqLwogICAgIGlmICgocmVhbG0g
PSBzdHJjaHIoYXV0aF9pZGVudGl0eSwgJ0AnKSkhPU5VTEwpIHsKIAlyZWFsbSsrOwotCXZhbCA9
IGNvbmZpZ19nZXRzdHJpbmcoImxvZ2lucmVhbG1zIiwgIiIpOworCXZhbCA9IGNvbmZpZ19nZXRz
dHJpbmcoSU1BUE9QVF9MT0dJTlJFQUxNUyk7CiAJd2hpbGUgKCp2YWwpIHsKIAkgICAgaWYgKCFz
dHJuY2FzZWNtcCh2YWwsIHJlYWxtLCBzdHJsZW4ocmVhbG0pKSAmJgogCQkoIXZhbFtzdHJsZW4o
cmVhbG0pXSB8fCBpc3NwYWNlKChpbnQpIHZhbFtzdHJsZW4ocmVhbG0pXSkpKSB7CkBAIC0yMTUs
NyArMjE1LDcgQEAKICAgICAgKiBmb3Igbm93IG9ubHkgYWRtaW5zIGNhbiBkbyBsbXRwIGZyb20g
YW5vdGhlciBtYWNoaW5lCiAgICAgICovCiAgICAgYXV0aHN0YXRlID0gYXV0aF9uZXdzdGF0ZShh
dXRoX2lkZW50aXR5LCBOVUxMKTsKLSAgICBhbGxvd2VkID0gYXV0aGlzYShhdXRoc3RhdGUsICJs
bXRwIiwgImFkbWlucyIpOworICAgIGFsbG93ZWQgPSBjb25maWdfYXV0aGlzYShhdXRoc3RhdGUs
IElNQVBPUFRfQURNSU5TKTsKICAgICBhdXRoX2ZyZWVzdGF0ZShhdXRoc3RhdGUpOwogICAgIAog
ICAgIGlmICghYWxsb3dlZCkgewpAQCAtMjQwLDcgKzI0MCw2IEBACiB7CiAgICAgaW50IHI7CiAK
LSAgICBjb25maWdfY2hhbmdlaWRlbnQoImxtdHBkIik7CiAgICAgaWYgKGdldGV1aWQoKSA9PSAw
KSByZXR1cm4gMTsKICAgICAKICAgICBzaWduYWxzX3NldF9zaHV0ZG93bigmc2h1dF9kb3duKTsK
QEAgLTI0OCw5ICsyNDcsOSBAQAogICAgIHNpZ25hbChTSUdQSVBFLCBTSUdfSUdOKTsKIAogI2lm
ZGVmIFVTRV9TSUVWRQotICAgIHNpZXZlX3VzZWhvbWVkaXIgPSBjb25maWdfZ2V0c3dpdGNoKCJz
aWV2ZXVzZWhvbWVkaXIiLCAwKTsKKyAgICBzaWV2ZV91c2Vob21lZGlyID0gY29uZmlnX2dldHN3
aXRjaChJTUFQT1BUX1NJRVZFVVNFSE9NRURJUik7CiAgICAgaWYgKCFzaWV2ZV91c2Vob21lZGly
KSB7Ci0Jc2lldmVfZGlyID0gY29uZmlnX2dldHN0cmluZygic2lldmVkaXIiLCAiL3Vzci9zaWV2
ZSIpOworCXNpZXZlX2RpciA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9TSUVWRURJUik7CiAg
ICAgfSBlbHNlIHsKIAlzaWV2ZV9kaXIgPSBOVUxMOwogICAgIH0KQEAgLTI2Miw4ICsyNjEsOCBA
QAogICAgIHNldHVwX3NpZXZlKCk7CiAjZW5kaWYgLyogVVNFX1NJRVZFICovCiAKLSAgICBzaW5n
bGVpbnN0YW5jZSA9IGNvbmZpZ19nZXRzd2l0Y2goInNpbmdsZWluc3RhbmNlc3RvcmUiLCAxKTsK
LSAgICBCQiA9IGNvbmZpZ19nZXRzdHJpbmcoInBvc3R1c2VyIiwgQkIpOworICAgIHNpbmdsZWlu
c3RhbmNlID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX1NJTkdMRUlOU1RBTkNFU1RPUkUpOwor
ICAgIEJCID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1BPU1RVU0VSKTsKIAogICAgIGlmICgo
ciA9IHNhc2xfc2VydmVyX2luaXQobXlzYXNsX2NiLCAiQ3lydXMiKSkgIT0gU0FTTF9PSykgewog
CXN5c2xvZyhMT0dfRVJSLCAiU0FTTCBmYWlsZWQgaW5pdGlhbGl6aW5nOiBzYXNsX3NlcnZlcl9p
bml0KCk6ICVzIiwgCkBAIC0yNzEsNyArMjcwLDcgQEAKIAlyZXR1cm4gRUNfU09GVFdBUkU7CiAg
ICAgfQogCi0gICAgZHVwZWxpbSA9IGNvbmZpZ19nZXRzd2l0Y2goImR1cGxpY2F0ZXN1cHByZXNz
aW9uIiwgMSk7CisgICAgZHVwZWxpbSA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9EVVBMSUNB
VEVTVVBQUkVTU0lPTik7CiAgICAgLyogaW5pdGlhbGl6ZSBkdXBsaWNhdGUgZGVsaXZlcnkgZGF0
YWJhc2UgKi8KICAgICBpZiAoZHVwbGljYXRlX2luaXQoTlVMTCwgMCkgIT0gMCkgewogCXN5c2xv
ZyhMT0dfRVJSLCAKQEAgLTQzMyw3ICs0MzIsNyBAQAogCWNsb3NlKGZkc1sxXSk7CiAJLyogbWFr
ZSB0aGUgcGlwZSBiZSBzdGRpbiAqLwogCWR1cDIoZmRzWzBdLCAwKTsKLQlleGVjdihTRU5ETUFJ
TCwgKGNoYXIgKiopIGFyZ3YpOworCWV4ZWN2KGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9TRU5E
TUFJTCksIChjaGFyICoqKSBhcmd2KTsKIAogCS8qIGlmIHdlJ3JlIGhlcmUgd2Ugc3VjayAqLwog
CXByaW50ZigiNDUxIGxtdHBkOiBkaWRuJ3QgZXhlYz8hP1xyXG4iKTsKQEAgLTUxOCw3ICs1MTcs
NyBAQAogICAgIGZwcmludGYoc20sICJEYXRlOiAlc1xyXG4iLCBkYXRlc3RyKTsKIAogICAgIGZw
cmludGYoc20sICJYLVNpZXZlOiAlc1xyXG4iLCBTSUVWRV9WRVJTSU9OKTsKLSAgICBmcHJpbnRm
KHNtLCAiRnJvbTogTWFpbCBTaWV2ZSBTdWJzeXN0ZW0gPCVzPlxyXG4iLCBQT1NUTUFTVEVSKTsK
KyAgICBmcHJpbnRmKHNtLCAiRnJvbTogTWFpbCBTaWV2ZSBTdWJzeXN0ZW0gPCVzPlxyXG4iLCBj
b25maWdfZ2V0c3RyaW5nKElNQVBPUFRfUE9TVE1BU1RFUikpOwogICAgIGZwcmludGYoc20sICJU
bzogPCVzPlxyXG4iLCByZWp0byk7CiAgICAgZnByaW50ZihzbSwgIk1JTUUtVmVyc2lvbjogMS4w
XHJcbiIpOwogICAgIGZwcmludGYoc20sICJDb250ZW50LVR5cGU6ICIKQEAgLTc5MCw3ICs3ODks
NyBAQAogCQkJdm9pZCAqbWMgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAJCQljb25zdCBjaGFy
ICoqZXJybXNnIF9fYXR0cmlidXRlX18oKHVudXNlZCkpKQogewotICAgIGNvbnN0IGNoYXIgKm5v
dGlmaWVyID0gY29uZmlnX2dldHN0cmluZygic2lldmVub3RpZmllciIsIE5VTEwpOworICAgIGNv
bnN0IGNoYXIgKm5vdGlmaWVyID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NJRVZFTk9USUZJ
RVIpOwogCiAgICAgaWYgKG5vdGlmaWVyKSB7CiAJc2lldmVfbm90aWZ5X2NvbnRleHRfdCAqbmMg
PSAoc2lldmVfbm90aWZ5X2NvbnRleHRfdCAqKSBhYzsKQEAgLTExNTksNyArMTE1OCw3IEBACiAg
ICAgfQogCiAgICAgaWYgKCFyICYmIHVzZXIpIHsKLQljb25zdCBjaGFyICpub3RpZmllciA9IGNv
bmZpZ19nZXRzdHJpbmcoIm1haWxub3RpZmllciIsIE5VTEwpOworCWNvbnN0IGNoYXIgKm5vdGlm
aWVyID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX01BSUxOT1RJRklFUik7CiAKIAlpZiAobm90
aWZpZXIpIHsKIAkgICAgLyogZG8gd2Ugd2FudCB0byByZXBsYWNlIHVzZXIuWFhYIHdpdGggSU5C
T1g/ICovCkluZGV4OiBpbWFwL2xtdHBlbmdpbmUuYwo9PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZz
L2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvbG10cGVuZ2luZS5jLHYK
cmV0cmlldmluZyByZXZpc2lvbiAxLjc1CmRpZmYgLXUgLXIxLjc1IGxtdHBlbmdpbmUuYwotLS0g
bG10cGVuZ2luZS5jCTIwMDIvMDYvMDYgMDA6MTI6MzQJMS43NQorKysgbG10cGVuZ2luZS5jCTIw
MDIvMDYvMTggMjA6NTQ6MTIKQEAgLTE4NCwxNCArMTg0LDE0IEBACiAiNTUwLXlvdXIgbWVzc2Fn
ZSwgb3IgJXMgaWYgeW91IGJlbGlldmUgeW91XHJcbiIKICI1NTAtcmVjZWl2ZWQgdGhpcyBtZXNz
YWdlIGluIGVycm9yLlxyXG4iCiAiNTUwIDUuNy4xIFBlcm1pc3Npb24gZGVuaWVkXHJcbiIsIAot
CQkJUE9TVE1BU1RFUik7CisJCQljb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfUE9TVE1BU1RFUikp
OwogCX0gZWxzZSB7CiAJICAgIHByb3RfcHJpbnRmKHBvdXQsICI1NTAgNS43LjEgUGVybWlzc2lv
biBkZW5pZWRcclxuIik7CiAJfQogCWJyZWFrOwogCiAgICAgY2FzZSBJTUFQX1FVT1RBX0VYQ0VF
REVEOgotCWlmKGNvbmZpZ19nZXRzd2l0Y2goImxtdHBfb3ZlcnF1b3RhX3Blcm1fZmFpbHVyZSIs
MCkpIHsKKwlpZihjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfTE1UUF9PVkVSX1FVT1RBX1BFUk1f
RkFJTFVSRSkpIHsKIAkgICAgLyogTm90IERlZmF1bHQgLSBQZXJtIEZhaWx1cmUgKi8KIAkgICAg
cHJvdF9wcmludGYocG91dCwgIjU1MiA1LjIuMiBPdmVyIHF1b3RhXHJcbiIpOwogCX0gZWxzZSB7
CkBAIC03MjYsNyArNzI2LDcgQEAKICAgICBpbnQgb2ZmID0gMDsKICAgICBzdGF0ZSBzID0gTkFN
RV9TVEFSVDsKICAgICBpbnQgciA9IDA7Ci0gICAgaW50IHJlamVjdDhiaXQgPSBjb25maWdfZ2V0
c3dpdGNoKCJyZWplY3Q4Yml0IiwgMCk7CisgICAgaW50IHJlamVjdDhiaXQgPSBjb25maWdfZ2V0
c3dpdGNoKElNQVBPUFRfUkVKRUNUOEJJVCk7CiAKICAgICBpZiAobmFtZWxlbiA9PSAwKSB7CiAJ
bmFtZWxlbiArPSBOQU1FSU5DOwpAQCAtMTIzMSw4ICsxMjMxLDExIEBACiAgICAgY2Quc3RhcnR0
bHNfZG9uZSA9IDA7CiAKICAgICBzcHJpbnRmKHNodXRkb3duZmlsZW5hbWUsICIlcy9tc2cvc2h1
dGRvd24iLCBjb25maWdfZGlyKTsKLSAgICBtYXhfbXNnc2l6ZSA9IGNvbmZpZ19nZXRpbnQoIm1h
eG1lc3NhZ2VzaXplIiwgSU5UX01BWCk7CisgICAgbWF4X21zZ3NpemUgPSBjb25maWdfZ2V0aW50
KElNQVBPUFRfTUFYTUVTU0FHRVNJWkUpOwogCisgICAgLyogSWYgbWF4X21zZ3NpemUgaXMgMCwg
YWxsb3cgYW55IHNpemUgKi8KKyAgICBpZighbWF4X21zZ3NpemUpIG1heF9tc2dzaXplID0gSU5U
X01BWDsKKwogICAgIG1zZ19uZXcoJm1zZyk7CiAKICAgICAvKiBkb24ndCBsZWFrIG9sZCBjb25u
ZWN0aW9ucyAqLwpAQCAtMTMwMiwxMCArMTMwNSw4IEBACiAgICAgLyogc2V0IG15IGFsbG93YWJs
ZSBzZWN1cml0eSBwcm9wZXJ0aWVzICovCiAgICAgLyogQU5PTllNT1VTIGlzIHNpbGx5IGJlY2F1
c2Ugd2UgYWxsb3cgdGhhdCBhbnl3YXkgKi8KICAgICBzZWNmbGFncyA9IFNBU0xfU0VDX05PQU5P
TllNT1VTOwotICAgIHBsYWludGV4dF9yZXN1bHQgPSBjb25maWdfZ2V0c3dpdGNoKCJhbGxvd3Bs
YWludGV4dCIsMSk7Ci0gICAgaWYgKCFjb25maWdfZ2V0c3dpdGNoKCJsbXRwX2FsbG93cGxhaW50
ZXh0IiwgcGxhaW50ZXh0X3Jlc3VsdCkpIHsKLQlzZWNmbGFncyB8PSBTQVNMX1NFQ19OT1BMQUlO
VEVYVDsKLSAgICB9CisgICAgcGxhaW50ZXh0X3Jlc3VsdCA9IGNvbmZpZ19nZXRzd2l0Y2goSU1B
UE9QVF9BTExPV1BMQUlOVEVYVCk7CisKICAgICBzZWNwcm9wcyA9IG15c2FzbF9zZWNwcm9wcyhz
ZWNmbGFncyk7CiAgICAgc2FzbF9zZXRwcm9wKGNkLmNvbm4sIFNBU0xfU0VDX1BST1BTLCBzZWNw
cm9wcyk7CiAKQEAgLTE1NzEsNyArMTU3Miw3IEBACiAJCSAgcHJvdF9wcmludGYocG91dCwgIjI1
MC1TSVpFICVkXHJcbiIsIG1heF9tc2dzaXplKTsKIAkgICAgICBlbHNlCiAJCSAgcHJvdF9wcmlu
dGYocG91dCwgIjI1MC1TSVpFXHJcbiIpOwotCSAgICAgIGlmICh0bHNfZW5hYmxlZCgibG10cCIp
ICYmICFmdW5jLT5wcmVhdXRoKSB7CisJICAgICAgaWYgKHRsc19lbmFibGVkKCkgJiYgIWZ1bmMt
PnByZWF1dGgpIHsKIAkJICBwcm90X3ByaW50Zihwb3V0LCAiMjUwLVNUQVJUVExTXHJcbiIpOwog
CSAgICAgIH0KIAkgICAgICBpZiAoc2FzbF9saXN0bWVjaChjZC5jb25uLCBOVUxMLCAiQVVUSCAi
LCAiICIsICIiLCAmbWVjaHMsIApAQCAtMTU5MCw3ICsxNTkxLDcgQEAKICAgICAgIGNhc2UgJ20n
OgogICAgICAgY2FzZSAnTSc6CiAJICAgIGlmICghYXV0aGVudGljYXRlZCkgewotCQlpZiAoY29u
ZmlnX2dldHN3aXRjaCgic29mdF9ub2F1dGgiLCAxKSkgeworCQlpZiAoY29uZmlnX2dldHN3aXRj
aChJTUFQT1BUX1NPRlRfTk9BVVRIKSkgewogCQkgICAgcHJvdF9wcmludGYocG91dCwgIjQzMCBB
dXRoZW50aWNhdGlvbiByZXF1aXJlZFxyXG4iKTsKIAkJfSBlbHNlIHsKIAkJICAgIHByb3RfcHJp
bnRmKHBvdXQsICI1MzAgQXV0aGVudGljYXRpb24gcmVxdWlyZWRcclxuIik7CkBAIC0xNzg1LDcg
KzE3ODYsNyBAQAogICAgICAgY2FzZSAncyc6CiAgICAgICBjYXNlICdTJzoKICNpZmRlZiBIQVZF
X1NTTAotCSAgICBpZiAoIXN0cmNhc2VjbXAoYnVmLCAic3RhcnR0bHMiKSAmJiB0bHNfZW5hYmxl
ZCgibG10cCIpICYmCisJICAgIGlmICghc3RyY2FzZWNtcChidWYsICJzdGFydHRscyIpICYmIHRs
c19lbmFibGVkKCkgJiYKIAkJIWZ1bmMtPnByZWF1dGgpIHsgLyogZG9uJ3QgbmVlZCBUTFMgZm9y
IHByZWF1dGgnZCBjb25uZWN0ICovCiAJCWludCAqbGF5ZXJwOwogCQlzYXNsX3NzZl90IHNzZjsK
QEAgLTI1NjQsMTAgKzI1NjUsNyBAQAogICAgIAogICAgIHNlY2ZsYWdzID0gU0FTTF9TRUNfTk9B
Tk9OWU1PVVM7CiAKLSAgICBwbGFpbnRleHRfcmVzdWx0ID0gY29uZmlnX2dldHN3aXRjaCgiYWxs
b3dwbGFpbnRleHQiLCAxKTsKLSAgICBpZiAoIWNvbmZpZ19nZXRzd2l0Y2goImxtdHBfYWxsb3dw
bGFpbnRleHQiLCBwbGFpbnRleHRfcmVzdWx0KSkgewotCXNlY2ZsYWdzIHw9IFNBU0xfU0VDX05P
UExBSU5URVhUOwotICAgIH0KKyAgICBwbGFpbnRleHRfcmVzdWx0ID0gY29uZmlnX2dldHN3aXRj
aChJTUFQT1BUX0FMTE9XUExBSU5URVhUKTsKICAgICBzZWNwcm9wcyA9IG15c2FzbF9zZWNwcm9w
cyhzZWNmbGFncyk7CiAgICAgcmV0ID0gc2FzbF9zZXRwcm9wKCpjb25uLCBTQVNMX1NFQ19QUk9Q
Uywgc2VjcHJvcHMpOwogICAgIGlmKHJldCAhPSBTQVNMX09LKSByZXR1cm4gcmV0OwpJbmRleDog
aW1hcC9sbXRwZW5naW5lLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVk
dS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL2xtdHBlbmdpbmUuaCx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMS4xMwpkaWZmIC11IC1yMS4xMyBsbXRwZW5naW5lLmgKLS0tIGxtdHBlbmdpbmUuaAky
MDAyLzA0LzExIDE4OjM2OjU2CTEuMTMKKysrIGxtdHBlbmdpbmUuaAkyMDAyLzA2LzE4IDIwOjQ1
OjIxCkBAIC00MywxMyArNDMsNiBAQAogI2lmbmRlZiBMTVRQRU5HSU5FX0gKICNkZWZpbmUgTE1U
UEVOR0lORV9ICiAKLS8qIGNvbmZpZ3VyYXRpb24gcGFyYW1ldGVycyAqLwotI2RlZmluZSBERUZB
VUxUX1NFTkRNQUlMICgiL3Vzci9saWIvc2VuZG1haWwiKQotI2RlZmluZSBERUZBVUxUX1BPU1RN
QVNURVIgKCJwb3N0bWFzdGVyIikKLQotI2RlZmluZSBTRU5ETUFJTCAoY29uZmlnX2dldHN0cmlu
Zygic2VuZG1haWwiLCBERUZBVUxUX1NFTkRNQUlMKSkKLSNkZWZpbmUgUE9TVE1BU1RFUiAoY29u
ZmlnX2dldHN0cmluZygicG9zdG1hc3RlciIsIERFRkFVTFRfUE9TVE1BU1RFUikpCi0KIC8qKioq
KioqKioqKioqKioqKiBzZXJ2ZXItc2lkZSBMTVRQICoqKioqKioqKioqKioqKioqKiovCiAKICNk
ZWZpbmUgSEVBREVSQ0FDSEVTSVpFIDQwMDkKSW5kZXg6IGltYXAvbG10cHByb3h5ZC5jCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMv
aW1hcC9sbXRwcHJveHlkLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNDIKZGlmZiAtdSAtcjEu
NDIgbG10cHByb3h5ZC5jCi0tLSBsbXRwcHJveHlkLmMJMjAwMi8wNi8wMyAxODoyMjoyNgkxLjQy
CisrKyBsbXRwcHJveHlkLmMJMjAwMi8wNi8xOSAwMDowOTozMApAQCAtMTUyLDcgKzE1Miw2IEBA
CiBzdGF0aWMgaW50IHF1b3Rhb3ZlcnJpZGUgPSAwOwkJLyogc2hvdWxkIGkgb3ZlcnJpZGUgcXVv
dGE/ICovCiBjb25zdCBjaGFyICpCQiA9ICIiOwogc3RhdGljIG11cGRhdGVfaGFuZGxlICptaGFu
ZGxlID0gTlVMTDsKLXN0YXRpYyBjb25zdCBjaGFyICptdXBkYXRlX3NlcnZlciA9IE5VTEw7CiBp
bnQgZGVsaXZlcl9sb2dmZCA9IC0xOyAvKiB1c2VkIGluIGxtdHBlbmdpbmUuYyAqLwogCiAvKiBj
dXJyZW50IG5hbWVzcGFjZSAqLwpAQCAtMTc1LDcgKzE3NCw3IEBACiAgICAgLyogY2hlY2sgaWYg
cmVtb3RlIHJlYWxtICovCiAgICAgaWYgKChyZWFsbSA9IHN0cmNocihhdXRoX2lkZW50aXR5LCAn
QCcpKSE9TlVMTCkgewogCXJlYWxtKys7Ci0JdmFsID0gY29uZmlnX2dldHN0cmluZygibG9naW5y
ZWFsbXMiLCAiIik7CisJdmFsID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0xPR0lOUkVBTE1T
KTsKIAl3aGlsZSAoKnZhbCkgewogCSAgICBpZiAoIXN0cm5jYXNlY21wKHZhbCwgcmVhbG0sIHN0
cmxlbihyZWFsbSkpICYmCiAJCSghdmFsW3N0cmxlbihyZWFsbSldIHx8IGlzc3BhY2UoKGludCkg
dmFsW3N0cmxlbihyZWFsbSldKSkpIHsKQEAgLTE5Niw3ICsxOTUsNyBAQAogICAgICAqIGZvciBu
b3cgb25seSBhZG1pbnMgY2FuIGRvIGxtdHAgZnJvbSBhbm90aGVyIG1hY2hpbmUKICAgICAgKi8K
ICAgICBhdXRoc3RhdGUgPSBhdXRoX25ld3N0YXRlKGF1dGhfaWRlbnRpdHksIE5VTEwpOwotICAg
IGFsbG93ZWQgPSBhdXRoaXNhKGF1dGhzdGF0ZSwgImxtdHAiLCAiYWRtaW5zIik7CisgICAgYWxs
b3dlZCA9IGNvbmZpZ19hdXRoaXNhKGF1dGhzdGF0ZSwgSU1BUE9QVF9BRE1JTlMpOwogICAgIGF1
dGhfZnJlZXN0YXRlKGF1dGhzdGF0ZSk7CiAgICAgCiAgICAgaWYgKCFhbGxvd2VkKSB7CkBAIC0y
MTgsMTQgKzIxNywxMyBAQAogewogICAgIGludCByOwogCi0gICAgY29uZmlnX2NoYW5nZWlkZW50
KCJsbXRwcHJveHlkIik7CiAgICAgaWYgKGdldGV1aWQoKSA9PSAwKSByZXR1cm4gMTsKICAgICAK
ICAgICBzaWduYWxzX3NldF9zaHV0ZG93bigmc2h1dF9kb3duKTsKICAgICBzaWduYWxzX2FkZF9o
YW5kbGVycygpOwogICAgIHNpZ25hbChTSUdQSVBFLCBTSUdfSUdOKTsKIAotICAgIEJCID0gY29u
ZmlnX2dldHN0cmluZygicG9zdHVzZXIiLCBCQik7CisgICAgQkIgPSBjb25maWdfZ2V0c3RyaW5n
KElNQVBPUFRfUE9TVFVTRVIpOwogCiAgICAgaWYgKChyID0gc2FzbF9zZXJ2ZXJfaW5pdChteXNh
c2xfY2IsICJDeXJ1cyIpKSAhPSBTQVNMX09LKSB7CiAJc3lzbG9nKExPR19FUlIsICJTQVNMIGZh
aWxlZCBpbml0aWFsaXppbmc6IHNhc2xfc2VydmVyX2luaXQoKTogJXMiLCAKQEAgLTI0Niw4ICsy
NDQsNyBAQAogCWZhdGFsKGVycm9yX21lc3NhZ2UociksIEVDX0NPTkZJRyk7CiAgICAgfQogCi0g
ICAgbXVwZGF0ZV9zZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKCJtdXBkYXRlX3NlcnZlciIsIE5V
TEwpOwotICAgIGlmICghbXVwZGF0ZV9zZXJ2ZXIpIHsKKyAgICBpZiAoIWNvbmZpZ19tdXBkYXRl
X3NlcnZlcikgewogCXN5c2xvZyhMT0dfRVJSLCAibm8gbXVwZGF0ZV9zZXJ2ZXIgZGVmaW5lZCIp
OwogCXJldHVybiBFQ19DT05GSUc7CiAgICAgfQpAQCAtMzA2LDEzICszMDMsMTMgQEAKICAgICB9
CiAgICAgLyogY29ubmVjdCB0byB0aGUgbXVwZGF0ZSBzZXJ2ZXIgKi8KICAgICBpZiAoIW1oYW5k
bGUpIHsKLQlyID0gbXVwZGF0ZV9jb25uZWN0KG11cGRhdGVfc2VydmVyLCBOVUxMLCAmbWhhbmRs
ZSwgTlVMTCk7CisJciA9IG11cGRhdGVfY29ubmVjdChjb25maWdfbXVwZGF0ZV9zZXJ2ZXIsIE5V
TEwsICZtaGFuZGxlLCBOVUxMKTsKICAgICB9CQogICAgIGlmICghcikgewogCWxtdHBtb2RlKCZt
eWxtdHAsIGRlbGl2ZXJfaW4sIGRlbGl2ZXJfb3V0LCAwKTsKICAgICB9IGVsc2UgewogCW1oYW5k
bGUgPSBOVUxMOwotCXN5c2xvZyhMT0dfRVJSLCAiY291bGRuJ3QgY29ubmVjdCB0byAlczogJXMi
LCBtdXBkYXRlX3NlcnZlciwKKwlzeXNsb2coTE9HX0VSUiwgImNvdWxkbid0IGNvbm5lY3QgdG8g
JXM6ICVzIiwgY29uZmlnX211cGRhdGVfc2VydmVyLAogCSAgICAgICBlcnJvcl9tZXNzYWdlKHIp
KTsKIAlwcm90X3ByaW50ZihkZWxpdmVyX291dCwgIjQ1MSAlcyBMTVRQIEN5cnVzICVzICVzXHJc
biIsCiAJCSAgICBjb25maWdfc2VydmVybmFtZSwgQ1lSVVNfVkVSU0lPTiwgZXJyb3JfbWVzc2Fn
ZShyKSk7CkBAIC0zODEsMTEgKzM3OCwxNCBAQAogCWNwID0gc3RyY2hyKG9wdHN0ciwgJy4nKTsK
IAlpZiAoY3ApICpjcCA9ICdcMCc7CiAJc3RyY2F0KG9wdHN0ciwgIl9wYXNzd29yZCIpOwotCXBh
c3MgPSBjb25maWdfZ2V0c3RyaW5nKG9wdHN0ciwgTlVMTCk7CisJcGFzcyA9IGNvbmZpZ19nZXRv
dmVyZmxvd3N0cmluZyhvcHRzdHIsIE5VTEwpOworCWlmKCFwYXNzKSBwYXNzID0gY29uZmlnX2dl
dHN0cmluZyhJTUFQT1BUX1BST1hZX1BBU1NXT1JEKTsKIAotCWNiID0gbXlzYXNsX2NhbGxiYWNr
cyhjb25maWdfZ2V0c3RyaW5nKCJsbXRwcHJveHlfdXNlcm5hbWUiLCAiIiksCi0JCQkgICAgICBj
b25maWdfZ2V0c3RyaW5nKCJsbXRwcHJveHlfYXV0aG5hbWUiLCAicHJveHkiKSwKLQkJCSAgICAg
IGNvbmZpZ19nZXRzdHJpbmcoImxtdHBwcm94eV9yZWFsbSIsIE5VTEwpLAorCS8qIEF1dGhvcml6
YXRpb24gZG9lcyBub3QgbWF0dGVyIGZvciBMTVRQLCBzbyB3ZSdsbCBqdXN0IHBhc3MKKwkgKiB0
aGUgZW1wdHkgc3RyaW5nLiAqLworCWNiID0gbXlzYXNsX2NhbGxiYWNrcygiIiwKKwkJCSAgICAg
IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9BVVRITkFNRSksCisJCQkgICAgICBjb25m
aWdfZ2V0c3RyaW5nKElNQVBPUFRfUFJPWFlfUkVBTE0pLAogCQkJICAgICAgcGFzcyk7CiAJCiAJ
ciA9IGxtdHBfY29ubmVjdChwLT5ob3N0LCBjYiwgJnAtPmNvbm4pOwpJbmRleDogaW1hcC9tYmR1
bXAuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMv
c3JjL2N5cnVzL2ltYXAvbWJkdW1wLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTgKZGlmZiAt
dSAtcjEuMTggbWJkdW1wLmMKLS0tIG1iZHVtcC5jCTIwMDIvMDUvMjQgMTg6MDU6MTUJMS4xOAor
KysgbWJkdW1wLmMJMjAwMi8wNi8xOCAyMDozODoyNgpAQCAtMzI2LDcgKzMyNiw3IEBACiAKICAg
ICBpZih1c2VyaWQpIHsKIAljaGFyIHNpZXZlX3BhdGhbTUFYX01BSUxCT1hfUEFUSF07Ci0JaW50
IHNpZXZlX3VzZWhvbWVkaXIgPSBjb25maWdfZ2V0c3dpdGNoKCJzaWV2ZXVzZWhvbWVkaXIiLCAw
KTsKKwlpbnQgc2lldmVfdXNlaG9tZWRpciA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9TSUVW
RVVTRUhPTUVESVIpOwogCiAJLyogbmVlZCB0byB0cmFuc2ZlciBzZWVuLCBzdWJzLCBhbmQgc2ll
dmUgZmlsZXMgKi8KIAlmb3IoaT0wO2k8MztpKyspIHsKQEAgLTM3OSw3ICszNzksNyBAQAogCSAg
ICBtYmRpciA9IE5VTEw7CiAKIAkgICAgc25wcmludGYoc2lldmVfcGF0aCwgc2l6ZW9mKHNpZXZl
X3BhdGgpLCAiJXMvJWMvJXMiLAotCQkgICAgIGNvbmZpZ19nZXRzdHJpbmcoInNpZXZlZGlyIiwg
Ii91c3Ivc2lldmUiKSwKKwkJICAgICBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU0lFVkVESVIp
LAogCQkgICAgIHVzZXJpZFswXSwgdXNlcmlkKTsKIAkgICAgbWJkaXI9b3BlbmRpcihzaWV2ZV9w
YXRoKTsKIAkgICAgCkBAIC00NjQsNyArNDY0LDcgQEAKICAgICBjb25zdCBjaGFyICp1c2VyaWQg
PSBOVUxMOwogICAgIHN0cnVjdCBtYWlsYm94IG1iOwogICAgIGNoYXIgc2lldmVfcGF0aFsyMDQ4
XTsKLSAgICBpbnQgc2lldmVfdXNlaG9tZWRpciA9IGNvbmZpZ19nZXRzd2l0Y2goInNpZXZldXNl
aG9tZWRpciIsIDApOworICAgIGludCBzaWV2ZV91c2Vob21lZGlyID0gY29uZmlnX2dldHN3aXRj
aChJTUFQT1BUX1NJRVZFVVNFSE9NRURJUik7CiAgICAgCiAgICAgbWVtc2V0KCZmaWxlLCAwLCBz
aXplb2Yoc3RydWN0IGJ1ZikpOwogICAgIG1lbXNldCgmZGF0YSwgMCwgc2l6ZW9mKHN0cnVjdCBi
dWYpKTsKQEAgLTQ3Niw3ICs0NzYsNyBAQAogCiAJaWYoIXNpZXZlX3VzZWhvbWVkaXIpCiAJICAg
IHNucHJpbnRmKHNpZXZlX3BhdGgsIHNpemVvZihzaWV2ZV9wYXRoKSwgIiVzLyVjLyVzIiwKLQkJ
ICAgICBjb25maWdfZ2V0c3RyaW5nKCJzaWV2ZWRpciIsICIvdXNyL3NpZXZlIiksCisJCSAgICAg
Y29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NJRVZFRElSKSwKIAkJICAgICB1c2VyaWRbMF0sIHVz
ZXJpZCk7CiAgICAgfQogCkluZGV4OiBpbWFwL21ib3hsaXN0LmMKPT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmls
ZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL21ib3hsaXN0
LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTk3CmRpZmYgLXUgLXIxLjE5NyBtYm94bGlzdC5j
Ci0tLSBtYm94bGlzdC5jCTIwMDIvMDYvMjAgMTY6MzY6MTMJMS4xOTcKKysrIG1ib3hsaXN0LmMJ
MjAwMi8wNi8yMCAxNjozODoyMQpAQCAtMTA4LDI1ICsxMDgsMTQgQEAKIHN0YXRpYyBpbnQgbWJv
eGxpc3RfZ2V0cGF0aChjb25zdCBjaGFyICpwYXJ0aXRpb24sIGNvbnN0IGNoYXIgKm5hbWUsIAog
CQkJICAgIGNoYXIgKipwYXRocCkKIHsKLSAgICBzaXplX3QgcGFydGl0aW9ubGVuOwotICAgIGNo
YXIgb3B0aW9uYnVmW01BWF9NQUlMQk9YX05BTUUrMV07CiAgICAgc3RhdGljIGNoYXIgcGF0aHJl
c3VsdFtNQVhfTUFJTEJPWF9QQVRIXTsKICAgICBjb25zdCBjaGFyICpyb290OwogCiAgICAgYXNz
ZXJ0KHBhcnRpdGlvbiAmJiBwYXRocCk7CiAKLSAgICBwYXJ0aXRpb25sZW4gPSBzdHJsZW4ocGFy
dGl0aW9uKTsKKyAgICByb290ID0gY29uZmlnX3BhcnRpdGlvbmRpcihwYXJ0aXRpb24pOworICAg
IGlmICghcm9vdCkgcmV0dXJuIElNQVBfUEFSVElUSU9OX1VOS05PV047CiAKLSAgICBpZiAocGFy
dGl0aW9ubGVuID4gc2l6ZW9mKG9wdGlvbmJ1ZiktMTEpIHsKLQlyZXR1cm4gSU1BUF9QQVJUSVRJ
T05fVU5LTk9XTjsKLSAgICB9Ci0gICAgc3RyY3B5KG9wdGlvbmJ1ZiwgInBhcnRpdGlvbi0iKTsK
LSAgICBzdHJjYXQob3B0aW9uYnVmLCBwYXJ0aXRpb24pOwotICAgIAotICAgIHJvb3QgPSBjb25m
aWdfZ2V0c3RyaW5nKG9wdGlvbmJ1ZiwgKGNoYXIgKikwKTsKLSAgICBpZiAoIXJvb3QpIHsKLQly
ZXR1cm4gSU1BUF9QQVJUSVRJT05fVU5LTk9XTjsKLSAgICB9CiAgICAgbWFpbGJveF9oYXNoX21i
b3gocGF0aHJlc3VsdCwgcm9vdCwgbmFtZSk7CiAKICAgICAqcGF0aHAgPSBwYXRocmVzdWx0OwpA
QCAtMTQ0LDcgKzEzMyw3IEBACiAKIHN0YXRpYyBjb25zdCBpbnQgZ2V0X2RlbGV0ZXJpZ2h0KHZv
aWQpCiB7Ci0gICAgY29uc3QgY2hhciAqciA9IGNvbmZpZ19nZXRzdHJpbmcoImRlbGV0ZXJpZ2h0
IiwgImMiKTsKKyAgICBjb25zdCBjaGFyICpyID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0RF
TEVURVJJR0hUKTsKIAogICAgIHJldHVybiBjeXJ1c19hY2xfc3RydG9tYXNrKHIpOwogfQpAQCAt
Mjc0LDcgKzI2Myw2IEBACiAKIGludCBtYm94bGlzdF9maW5kc3RhZ2UoY29uc3QgY2hhciAqbmFt
ZSwgY2hhciAqc3RhZ2VkaXIpIAogewotICAgIGNoYXIgb3B0aW9uYnVmW01BWF9NQUlMQk9YX05B
TUUrMV07CiAgICAgY29uc3QgY2hhciAqcm9vdDsKICAgICBjaGFyICpwYXJ0aXRpb247CiAgICAg
aW50IHI7CkBAIC0yODksMTUgKzI3NywxMCBAQAogICAgIGRlZmF1bHQ6CiAJcmV0dXJuIHI7CiAJ
YnJlYWs7Ci0gICAgfQotCQotICAgIHN0cmNweShvcHRpb25idWYsICJwYXJ0aXRpb24tIik7Ci0g
ICAgc3RyY3B5KG9wdGlvbmJ1ZiArIDEwLCBwYXJ0aXRpb24pOwotICAgIAotICAgIHJvb3QgPSBj
b25maWdfZ2V0c3RyaW5nKG9wdGlvbmJ1ZiwgKGNoYXIgKikwKTsKLSAgICBpZiAoIXJvb3QpIHsK
LQlyZXR1cm4gSU1BUF9QQVJUSVRJT05fVU5LTk9XTjsKICAgICB9CisJICAgIAorICAgIHJvb3Qg
PSBjb25maWdfcGFydGl0aW9uZGlyKHBhcnRpdGlvbik7CisgICAgaWYgKCFyb290KSByZXR1cm4g
SU1BUF9QQVJUSVRJT05fVU5LTk9XTjsKIAkKICAgICBzcHJpbnRmKHN0YWdlZGlyLCAiJXMvc3Rh
Z2UuLyIsIHJvb3QpOwogICAgIApAQCAtNDU1LDcgKzQzOCw3IEBACiAJICAgICAqIE5vYm9keSBl
bHNlIHN0YXJ0cyB3aXRoIGFueSBhY2Nlc3MgdG8gc2FtZS4KIAkgICAgICovCiAJICAgIGlkZW50
aWZpZXIgPSB4c3RyZHVwKG5hbWUrNSk7Ci0JICAgIGlmIChjb25maWdfZ2V0c3dpdGNoKCJ1bml4
aGllcmFyY2h5c2VwIiwgMCkpIHsKKwkgICAgaWYgKGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9V
TklYSElFUkFSQ0hZU0VQKSkgewogCQkvKgogCQkgKiBUaGUgbWFpbGJveG5hbWUgaXMgbm93IGlu
IHRoZSBpbnRlcm5hbCBmb3JtYXQsCiAJCSAqIHNvIHdlIHdlIG5lZWQgdG8gY2hhbmdlIERPVENI
QVJzIGJhY2sgdG8gJy4nCkBAIC00NzAsNyArNDUzLDcgQEAKIAkgICAgZnJlZShpZGVudGlmaWVy
KTsKIAl9IGVsc2UgewogCSAgICBkZWZhdWx0YWNsID0gaWRlbnRpZmllciA9IAotCQl4c3RyZHVw
KGNvbmZpZ19nZXRzdHJpbmcoImRlZmF1bHRhY2wiLCAiYW55b25lIGxycyIpKTsKKwkJeHN0cmR1
cChjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfREVGQVVMVEFDTCkpOwogCSAgICBmb3IgKDs7KSB7
CiAJCXdoaWxlICgqaWRlbnRpZmllciAmJiBpc3NwYWNlKChpbnQpICppZGVudGlmaWVyKSkgaWRl
bnRpZmllcisrOwogCQlyaWdodHMgPSBpZGVudGlmaWVyOwpAQCAtNTc1LDggKzU1OCw3IEBACiAK
ICAgICBpZiAoIShtYnR5cGUgJiBNQlRZUEVfUkVNT1RFKSkgewogCS8qIEdldCBwYXJ0aXRpb24n
cyBwYXRoICovCi0Jc3ByaW50ZihidWYsICJwYXJ0aXRpb24tJXMiLCBuZXdwYXJ0aXRpb24pOwot
CXJvb3QgPSBjb25maWdfZ2V0c3RyaW5nKGJ1ZiwgKGNoYXIgKikwKTsKKwlyb290ID0gY29uZmln
X3BhcnRpdGlvbmRpcihuZXdwYXJ0aXRpb24pOwogCWlmICghcm9vdCkgewogCSAgICByID0gSU1B
UF9QQVJUSVRJT05fVU5LTk9XTjsKIAkgICAgZ290byBkb25lOwpJbmRleDogaW1hcC9tYm94bmFt
ZS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9z
cmMvY3lydXMvaW1hcC9tYm94bmFtZS5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjI1CmRpZmYg
LXUgLXIxLjI1IG1ib3huYW1lLmMKLS0tIG1ib3huYW1lLmMJMjAwMi8wMS8yNCAxNjozOToyOAkx
LjI1CisrKyBtYm94bmFtZS5jCTIwMDIvMDYvMTggMjA6Mjg6MzEKQEAgLTIzNiw3ICsyMzYsOCBA
QAogCiAvKiBIYW5kbGUgY29udmVyc2lvbiBmcm9tIHRoZSBpbnRlcm5hbCBuYW1lc3BhY2UgdG8g
dGhlIHN0YW5kYXJkIG5hbWVzcGFjZSAqLwogc3RhdGljIGludCBtYm94bmFtZV90b2V4dGVybmFs
KHN0cnVjdCBuYW1lc3BhY2UgKm5hbWVzcGFjZSwgY29uc3QgY2hhciAqbmFtZSwKLQkJCSAgICAg
ICBjb25zdCBjaGFyICp1c2VyaWQsIGNoYXIgKnJlc3VsdCkKKwkJCSAgICAgICBjb25zdCBjaGFy
ICp1c2VyaWQgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisJCQkgICAgICAgY2hhciAqcmVzdWx0
KQogewogICAgIHN0cmNweShyZXN1bHQsIG5hbWUpOwogCkBAIC0zMDcsMTQgKzMwOCwxNSBAQAog
CiAgICAgYXNzZXJ0KG5hbWVzcGFjZSAhPSBOVUxMKTsKIAotICAgIG5hbWVzcGFjZS0+aGllcl9z
ZXAgPSBjb25maWdfZ2V0c3dpdGNoKCJ1bml4aGllcmFyY2h5c2VwIiwgMCkgPyAnLycgOiAnLic7
Ci0gICAgbmFtZXNwYWNlLT5pc2FsdCA9ICFmb3JjZV9zdGQgJiYgY29uZmlnX2dldHN3aXRjaCgi
YWx0bmFtZXNwYWNlIiwgMCk7CisgICAgbmFtZXNwYWNlLT5oaWVyX3NlcCA9CisJY29uZmlnX2dl
dHN3aXRjaChJTUFQT1BUX1VOSVhISUVSQVJDSFlTRVApID8gJy8nIDogJy4nOworICAgIG5hbWVz
cGFjZS0+aXNhbHQgPSAhZm9yY2Vfc3RkICYmIGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTFRO
QU1FU1BBQ0UpOwogCiAgICAgaWYgKG5hbWVzcGFjZS0+aXNhbHQpIHsKIAkvKiBhbHRlcm5hdGUg
bmFtZXNwYWNlICovCiAJc3RyY3B5KG5hbWVzcGFjZS0+cHJlZml4W05BTUVTUEFDRV9JTkJPWF0s
ICIiKTsKIAotCXByZWZpeCA9IGNvbmZpZ19nZXRzdHJpbmcoInVzZXJwcmVmaXgiLCAiT3RoZXIg
VXNlcnMiKTsKKwlwcmVmaXggPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfVVNFUlBSRUZJWCk7
CiAJaWYgKCFwcmVmaXggfHwgc3RybGVuKHByZWZpeCkgPT0gMCB8fAogCSAgICBzdHJsZW4ocHJl
Zml4KSA+PSBNQVhfTkFNRVNQQUNFX1BSRUZJWCB8fAogCSAgICBzdHJjaHIocHJlZml4LG5hbWVz
cGFjZS0+aGllcl9zZXApICE9IE5VTEwpCkBAIC0zMjIsNyArMzI0LDcgQEAKIAlzcHJpbnRmKG5h
bWVzcGFjZS0+cHJlZml4W05BTUVTUEFDRV9VU0VSXSwgIiUuKnMlYyIsCiAJCU1BWF9OQU1FU1BB
Q0VfUFJFRklYLTEsIHByZWZpeCwgbmFtZXNwYWNlLT5oaWVyX3NlcCk7CiAKLQlwcmVmaXggPSBj
b25maWdfZ2V0c3RyaW5nKCJzaGFyZWRwcmVmaXgiLCAiU2hhcmVkIEZvbGRlcnMiKTsKKwlwcmVm
aXggPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU0hBUkVEUFJFRklYKTsKIAlpZiAoIXByZWZp
eCB8fCBzdHJsZW4ocHJlZml4KSA9PSAwIHx8CiAJICAgIHN0cmxlbihwcmVmaXgpID49IE1BWF9O
QU1FU1BBQ0VfUFJFRklYIHx8CiAJICAgIHN0cmNocihwcmVmaXgsIG5hbWVzcGFjZS0+aGllcl9z
ZXApICE9IE5VTEwgfHwKQEAgLTQ2NSw3ICs0NjcsNyBAQAogICAgIGludCB1Y3M0OwogICAgIGlu
dCB1bml4c2VwOwogCi0gICAgdW5peHNlcCA9IGNvbmZpZ19nZXRzd2l0Y2goInVuaXhoaWVyYXJj
aHlzZXAiLCAwKTsKKyAgICB1bml4c2VwID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX1VOSVhI
SUVSQVJDSFlTRVApOwogCiAgICAgaWYgKHN0cmxlbihuYW1lKSA+IE1BWF9NQUlMQk9YX05BTUUp
IHJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsKICAgICBmb3IgKGkgPSAwOyBpIDwgTlVNX0JB
RE1CT1hQQVRURVJOUzsgaSsrKSB7CkluZGV4OiBpbWFwL21lc3NhZ2UuYwo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJD
UyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvbWVz
c2FnZS5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjg4CmRpZmYgLXUgLXIxLjg4IG1lc3NhZ2Uu
YwotLS0gbWVzc2FnZS5jCTIwMDAvMTIvMjYgMjE6MzU6NDEJMS44OAorKysgbWVzc2FnZS5jCTIw
MDIvMDYvMTggMjA6Mjk6MDEKQEAgLTIyOCw3ICsyMjgsNyBAQAogICAgIGludCByID0gMDsKICAg
ICBpbnQgbjsKICAgICBpbnQgc2F3Y3IgPSAwLCBzYXdubDsKLSAgICBpbnQgcmVqZWN0OGJpdCA9
IGNvbmZpZ19nZXRzd2l0Y2goInJlamVjdDhiaXQiLCAwKTsKKyAgICBpbnQgcmVqZWN0OGJpdCA9
IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9SRUpFQ1Q4QklUKTsKICAgICBpbnQgaW5oZWFkZXIg
PSAxLCBibGFua2xpbmUgPSAxOwogCiAgICAgd2hpbGUgKHNpemUpIHsKSW5kZXg6IGltYXAvbXVw
ZGF0ZS1jbGllbnQuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5
c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvbXVwZGF0ZS1jbGllbnQuYyx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMS4zMgpkaWZmIC11IC1yMS4zMiBtdXBkYXRlLWNsaWVudC5jCi0tLSBtdXBkYXRlLWNs
aWVudC5jCTIwMDIvMDQvMDUgMTk6NTI6MjcJMS4zMgorKysgbXVwZGF0ZS1jbGllbnQuYwkyMDAy
LzA2LzE4IDIwOjI2OjM1CkBAIC04MiwxNCArODIsMTQgQEAKICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2hhciAqcGFzc3dvcmQpOwogZXh0ZXJuIHZvaWQg
ZnJlZV9jYWxsYmFja3Moc2FzbF9jYWxsYmFja190ICppbik7CiAKLXN0YXRpYyBzYXNsX3NlY3Vy
aXR5X3Byb3BlcnRpZXNfdCAqbWFrZV9zZWNwcm9wcyhpbnQgbWluLCBpbnQgbWF4KQorc3RhdGlj
IHNhc2xfc2VjdXJpdHlfcHJvcGVydGllc190ICptYWtlX3NlY3Byb3BzKHZvaWQpCiB7CiAgIHNh
c2xfc2VjdXJpdHlfcHJvcGVydGllc190ICpyZXQgPQogICAgICAgKHNhc2xfc2VjdXJpdHlfcHJv
cGVydGllc190ICopIHh6bWFsbG9jKHNpemVvZihzYXNsX3NlY3VyaXR5X3Byb3BlcnRpZXNfdCkp
OwogCiAgIHJldC0+bWF4YnVmc2l6ZSA9IFBST1RfQlVGU0laRTsKLSAgcmV0LT5taW5fc3NmID0g
Y29uZmlnX2dldGludCgic2FzbF9taW5pbXVtX2xheWVyIiwgbWluKTsJCi0gIHJldC0+bWF4X3Nz
ZiA9IGNvbmZpZ19nZXRpbnQoInNhc2xfbWF4aW11bV9sYXllciIsIG1heCk7CisgIHJldC0+bWlu
X3NzZiA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9TQVNMX01JTklNVU1fTEFZRVIpOwkKKyAgcmV0
LT5tYXhfc3NmID0gY29uZmlnX2dldGludChJTUFQT1BUX1NBU0xfTUFYSU1VTV9MQVlFUik7CiAK
ICAgcmV0dXJuIHJldDsKIH0KQEAgLTExNCw3ICsxMTQsNyBAQAogCXJldHVybiAxOwogICAgIH0K
IAotICAgIHNlY3Byb3BzID0gbWFrZV9zZWNwcm9wcygwLCAyNTYpOworICAgIHNlY3Byb3BzID0g
bWFrZV9zZWNwcm9wcygpOwogICAgIGlmKCFzZWNwcm9wcykgcmV0dXJuIDE7CiAgICAgCiAgICAg
c2FzbHJlc3VsdD1zYXNsX3NldHByb3AoaC0+c2FzbGNvbm4sIFNBU0xfU0VDX1BST1BTLCBzZWNw
cm9wcyk7CkBAIC0yNTMsMTQgKzI1MywxMSBAQAogCiAgICAgLyogb3BlbiBjb25uZWN0aW9uIHRv
ICdzZXJ2ZXInICovCiAgICAgaWYoIXNlcnZlcikgewotCXNlcnZlciA9IGNvbmZpZ19nZXRzdHJp
bmcoIm11cGRhdGVfc2VydmVyIiwgTlVMTCk7CisJc2VydmVyID0gY29uZmlnX211cGRhdGVfc2Vy
dmVyOwogCWlmIChzZXJ2ZXIgPT0gTlVMTCkgewogCSAgICBmYXRhbCgiY291bGRuJ3QgZ2V0IG11
cGRhdGUgc2VydmVyIG5hbWUiLCBFQ19VTkFWQUlMQUJMRSk7CiAJfQogICAgIH0KLSAgICBpZigh
cG9ydCkgewotCXBvcnQgPSBjb25maWdfZ2V0c3RyaW5nKCJtdXBkYXRlX3BvcnQiLE5VTEwpOwot
ICAgIH0KICAgICAKICAgICBocCA9IGdldGhvc3RieW5hbWUoc2VydmVyKTsKICAgICBpZiAoIWhw
KSB7CkBAIC0yODksNyArMjg2LDcgQEAKICAgICB9IGVsc2UgaWYoKHNwID0gZ2V0c2VydmJ5bmFt
ZSgibXVwZGF0ZSIsICJ0Y3AiKSkgIT0gTlVMTCkgewogCWFkZHIuc2luX3BvcnQgPSBzcC0+c19w
b3J0OwogICAgIH0gZWxzZSB7Ci0JYWRkci5zaW5fcG9ydCA9IGh0b25zKDIwMDQpOworCWFkZHIu
c2luX3BvcnQgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfTVVQREFURV9QT1JUKTsKICAgICB9CiAK
ICAgICBpZiAoY29ubmVjdChzLCAoc3RydWN0IHNvY2thZGRyICopJmFkZHIsIHNpemVvZihhZGRy
KSkgPT0gLTEpIHsKQEAgLTMwMywxMCArMzAwLDEwIEBACiAKICAgICBpZighY2JzKSB7CiAJbG9j
YWxfY2JzID0gMTsKLQljYnMgPSBteXNhc2xfY2FsbGJhY2tzKGNvbmZpZ19nZXRzdHJpbmcoIm11
cGRhdGVfdXNlcm5hbWUiLCIiKSwKLQkJCSAgICAgICBjb25maWdfZ2V0c3RyaW5nKCJtdXBkYXRl
X2F1dGhuYW1lIixOVUxMKSwKLQkJCSAgICAgICBjb25maWdfZ2V0c3RyaW5nKCJtdXBkYXRlX3Jl
YWxtIixOVUxMKSwKLQkJCSAgICAgICBjb25maWdfZ2V0c3RyaW5nKCJtdXBkYXRlX3Bhc3N3b3Jk
IixOVUxMKSk7CisJY2JzID0gbXlzYXNsX2NhbGxiYWNrcyhjb25maWdfZ2V0c3RyaW5nKElNQVBP
UFRfTVVQREFURV9VU0VSTkFNRSksCisJCQkgICAgICAgY29uZmlnX2dldHN0cmluZyhJTUFQT1BU
X01VUERBVEVfQVVUSE5BTUUpLAorCQkJICAgICAgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9N
VVBEQVRFX1JFQUxNKSwKKwkJCSAgICAgICBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTVVQREFU
RV9QQVNTV09SRCkpOwogICAgIH0KIAogICAgIHNhc2xyZXN1bHQgPSBzYXNsX2NsaWVudF9uZXco
c2VydmljZV9uYW1lLApJbmRleDogaW1hcC9tdXBkYXRlLXNsYXZlLmMKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL211cGRh
dGUtc2xhdmUuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xNgpkaWZmIC11IC1yMS4xNiBtdXBk
YXRlLXNsYXZlLmMKLS0tIG11cGRhdGUtc2xhdmUuYwkyMDAyLzAyLzI1IDIyOjQyOjM5CTEuMTYK
KysrIG11cGRhdGUtc2xhdmUuYwkyMDAyLzA2LzE5IDAwOjE0OjQxCkBAIC0yMjMsMzQgKzIyMywz
MCBAQAogCiB2b2lkICptdXBkYXRlX2NsaWVudF9zdGFydCh2b2lkICpyb2NrIF9fYXR0cmlidXRl
X18oKHVudXNlZCkpKQogewotICAgIGNvbnN0IGNoYXIgKnNlcnZlciwgKm51bTsKICAgICBtdXBk
YXRlX2hhbmRsZSAqaCA9IE5VTEw7CiAgICAgaW50IHJldHJ5X2RlbGF5ID0gMjAsIHJlYWxfZGVs
YXk7CiAgICAgaW50IHJldDsKIAogICAgIHNyYW5kKHRpbWUoTlVMTCkgKiBnZXRwaWQoKSk7CiAK
LSAgICBzZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKCJtdXBkYXRlX3NlcnZlciIsIE5VTEwpOwot
ICAgIGlmKHNlcnZlciA9PSBOVUxMKSB7CisgICAgaWYoIWNvbmZpZ19tdXBkYXRlX3NlcnZlcikg
ewogCWZhdGFsKCJjb3VsZG4ndCBnZXQgbXVwZGF0ZSBzZXJ2ZXIgbmFtZSIsIEVDX1VOQVZBSUxB
QkxFKTsKICAgICB9CiAKLSAgICBudW0gPSBjb25maWdfZ2V0c3RyaW5nKCJtdXBkYXRlX3JldHJ5
X2RlbGF5IixOVUxMKTsKLSAgICBpZihudW0gJiYgaW1wYXJzZV9pc251bWJlcihudW0pKSB7Ci0J
cmV0cnlfZGVsYXkgPSBhdG9pKG51bSk7Ci0JaWYocmV0cnlfZGVsYXkgPCAwKSB7Ci0JICAgIGZh
dGFsKCJpbnZhbGlkIHZhbHVlIGZvciBtdXBkYXRlX3JldHJ5X2RlbGF5IiwgRUNfVU5BVkFJTEFC
TEUpOwotCX0KKyAgICByZXRyeV9kZWxheSA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9NVVBEQVRF
X1JFVFJZX0RFTEFZKTsKKyAgICBpZihyZXRyeV9kZWxheSA8IDApIHsKKwlmYXRhbCgiaW52YWxp
ZCB2YWx1ZSBmb3IgbXVwZGF0ZV9yZXRyeV9kZWxheSIsIEVDX1VOQVZBSUxBQkxFKTsKICAgICB9
CiAKICAgICB3aGlsZSgxKSB7Ci0JcmV0ID0gbXVwZGF0ZV9jb25uZWN0KHNlcnZlciwgTlVMTCwg
JmgsIE5VTEwpOworCXJldCA9IG11cGRhdGVfY29ubmVjdChjb25maWdfbXVwZGF0ZV9zZXJ2ZXIs
IE5VTEwsICZoLCBOVUxMKTsKIAlpZihyZXQpIHsKIAkgICAgc3lzbG9nKExPR19FUlIsImNvdWxk
bid0IGNvbm5lY3QgdG8gbXVwZGF0ZSBzZXJ2ZXIiKTsKIAkgICAgZ290byByZXRyeTsKIAl9CiAg
ICAKLQlzeXNsb2coTE9HX0VSUiwgInN1Y2Nlc3NmdWwgbXVwZGF0ZSBjb25uZWN0aW9uIHRvICVz
Iiwgc2VydmVyKTsKKwlzeXNsb2coTE9HX0VSUiwgInN1Y2Nlc3NmdWwgbXVwZGF0ZSBjb25uZWN0
aW9uIHRvICVzIiwKKwkgICAgICAgY29uZmlnX211cGRhdGVfc2VydmVyKTsKIAogCW11cGRhdGVf
bGlzdGVuKGgsIHJldHJ5X2RlbGF5KTsKIApJbmRleDogaW1hcC9tdXBkYXRlLmMKPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFw
L211cGRhdGUuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS42MApkaWZmIC11IC1yMS42MCBtdXBk
YXRlLmMKLS0tIG11cGRhdGUuYwkyMDAyLzA2LzAzIDE4OjIyOjI2CTEuNjAKKysrIG11cGRhdGUu
YwkyMDAyLzA2LzE5IDAwOjEyOjM1CkBAIC0yNjgsNyArMjY4LDcgQEAKICAgICAvKiBjaGVjayBp
ZiByZW1vdGUgcmVhbG0gKi8KICAgICBpZiAoKHJlYWxtID0gc3RyY2hyKGF1dGhfaWRfYnVmLCAn
QCcpKSE9TlVMTCkgewogCXJlYWxtKys7Ci0JdmFsID0gY29uZmlnX2dldHN0cmluZygibG9naW5y
ZWFsbXMiLCAiIik7CisJdmFsID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0xPR0lOUkVBTE1T
KTsKIAl3aGlsZSAoKnZhbCkgewogCSAgICBpZiAoIXN0cm5jYXNlY21wKHZhbCwgcmVhbG0sIHN0
cmxlbihyZWFsbSkpICYmCiAJCSghdmFsW3N0cmxlbihyZWFsbSldIHx8IGlzc3BhY2UoKGludCkg
dmFsW3N0cmxlbihyZWFsbSldKSkpIHsKQEAgLTI4OSw3ICsyODksNyBAQAogICAgICAqIGZvciBu
b3cgb25seSBhZG1pbnMgY2FuIGRvIG11cGRhdGUgZnJvbSBhbm90aGVyIG1hY2hpbmUKICAgICAg
Ki8KICAgICBhdXRoc3RhdGUgPSBhdXRoX25ld3N0YXRlKGF1dGhfaWRfYnVmLCBOVUxMKTsKLSAg
ICBhbGxvd2VkID0gYXV0aGlzYShhdXRoc3RhdGUsICJtdXBkYXRlIiwgImFkbWlucyIpOworICAg
IGFsbG93ZWQgPSBjb25maWdfYXV0aGlzYShhdXRoc3RhdGUsIElNQVBPUFRfQURNSU5TKTsKICAg
ICBhdXRoX2ZyZWVzdGF0ZShhdXRoc3RhdGUpOwogICAgIAogICAgIGlmICghYWxsb3dlZCkgewpA
QCAtMzE2LDggKzMxNiw2IEBACiAgICAgaW50IHI7CiAgICAgaW50IG9wdDsKIAotICAgIGNvbmZp
Z19jaGFuZ2VpZGVudCgibXVwZGF0ZSIpOwotICAgIAogICAgIGlmIChnZXRldWlkKCkgPT0gMCkg
ZmF0YWwoIm11c3QgcnVuIGFzIHRoZSBDeXJ1cyB1c2VyIiwgRUNfVVNBR0UpOwogCiAgICAgLyog
c2V0IHNpZ25hbCBoYW5kbGVycyAqLwpAQCAtMzY1LDE3ICszNjMsNiBAQAogCX0KICAgICB9CiAK
LSAgICAvKiBTbGF2ZSBTa2lwbGlzdCBGYXN0IFJlc3luYz8gKi8KLSAgICBpZighbWFzdGVycCAm
JiBjb25maWdfZ2V0c3dpdGNoKCJtdXBkYXRlX3NsYXZlX2Zhc3RfcmVzeW5jIiwwKSkgewotCWNo
YXIgZm5hbWVbNDA5Nl07Ci0JCi0JaWYoc25wcmludGYoZm5hbWUsNDA5NiwiJXMlcyIsY29uZmln
X2RpcixGTkFNRV9NQk9YTElTVCkgPT0gLTEpCi0JICAgIGZhdGFsKCJtYm94bGlzdCBkYXRhYmFz
ZSBmaWxlbmFtZSB0b28gbGFyZ2UiLEVDX1RFTVBGQUlMKTsKLQotCXB1dGVudigiQ1lSVVNfU0tJ
UExJU1RfVU5TQUZFPTEiKTsKLSAJdW5saW5rKGZuYW1lKTsKLSAgICB9Ci0KICAgICBkYXRhYmFz
ZV9pbml0KCk7CiAKICAgICBpZiAoIW1hc3RlcnApIHsKQEAgLTQ0MCwxMCArNDI3LDExIEBACiAK
ICAgICAvKiBBVVRIIGJhbm5lciBpcyBtYW5kYXRvcnkgKi8KICAgICBpZighbWFzdGVycCkgewot
CWNvbnN0IGNoYXIgKm11cGRhdGVfc2VydmVyID0gY29uZmlnX2dldHN0cmluZygibXVwZGF0ZV9z
ZXJ2ZXIiLCBOVUxMKTsKLQlpZighbXVwZGF0ZV9zZXJ2ZXIpCisJaWYoIWNvbmZpZ19tdXBkYXRl
X3NlcnZlcikKIAkgICAgZmF0YWwoIm11cGRhdGUgc2VydmVyIHdhcyBub3Qgc3BlY2lmaWVkIGZv
ciBzbGF2ZSIsIEVDX1RFTVBGQUlMKTsKLQlzbnByaW50ZihzbGF2ZWJ1Ziwgc2l6ZW9mKHNsYXZl
YnVmKSwgIm11cGRhdGU6Ly8lcyIsIG11cGRhdGVfc2VydmVyKTsKKworCXNucHJpbnRmKHNsYXZl
YnVmLCBzaXplb2Yoc2xhdmVidWYpLCAibXVwZGF0ZTovLyVzIiwKKwkJIGNvbmZpZ19tdXBkYXRl
X3NlcnZlcik7CiAgICAgfQogCQkKICAgICBwcm90X3ByaW50ZihjLT5wb3V0LApAQCAtNjk5LDcg
KzY4Nyw3IEBACiAgICAgc3RydWN0IHNvY2thZGRyX2luIGxvY2FsYWRkciwgcmVtb3RlYWRkcjsK
ICAgICBpbnQgaGF2ZWFkZHIgPSAwOwogICAgIGludCBzYWxlbjsKLSAgICBpbnQgc2VjZmxhZ3Ms
IHBsYWludGV4dF9yZXN1bHQ7CisgICAgaW50IHNlY2ZsYWdzOwogICAgIHNhc2xfc2VjdXJpdHlf
cHJvcGVydGllc190ICpzZWNwcm9wcyA9IE5VTEw7CiAgICAgY2hhciBsb2NhbGlwWzYwXSwgcmVt
b3RlaXBbNjBdOwogICAgIGNoYXIgY2xpZW50aG9zdFsyNTBdOwpAQCAtNzYyLDggKzc1MCw3IEBA
CiAKICAgICAvKiBzZXQgbXkgYWxsb3dhYmxlIHNlY3VyaXR5IHByb3BlcnRpZXMgKi8KICAgICBz
ZWNmbGFncyA9IFNBU0xfU0VDX05PQU5PTllNT1VTOwotICAgIHBsYWludGV4dF9yZXN1bHQgPSBj
b25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsMSk7Ci0gICAgaWYgKCFjb25maWdfZ2V0
c3dpdGNoKCJtdXBkYXRlX2FsbG93cGxhaW50ZXh0IiwgcGxhaW50ZXh0X3Jlc3VsdCkpIHsKKyAg
ICBpZiAoIWNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV1BMQUlOVEVYVCkpIHsKIAlzZWNm
bGFncyB8PSBTQVNMX1NFQ19OT1BMQUlOVEVYVDsKICAgICB9CiAgICAgc2VjcHJvcHMgPSBteXNh
c2xfc2VjcHJvcHMoc2VjZmxhZ3MpOwpAQCAtMTI1NSw3ICsxMjQyLDcgQEAKIC8qIFJlc2V0IHRo
ZSBnaXZlbiBzYXNsX2Nvbm5fdCB0byBhIHNhbmUgc3RhdGUgKi8KIHN0YXRpYyBpbnQgcmVzZXRf
c2FzbGNvbm4oc3RydWN0IGNvbm4gKmMpCiB7Ci0gICAgaW50IHJldCwgc2VjZmxhZ3MsIHBsYWlu
dGV4dF9yZXN1bHQ7CisgICAgaW50IHJldCwgc2VjZmxhZ3M7CiAgICAgc2FzbF9zZWN1cml0eV9w
cm9wZXJ0aWVzX3QgKnNlY3Byb3BzID0gTlVMTDsKIAogICAgIHNhc2xfZGlzcG9zZSgmYy0+c2Fz
bGNvbm4pOwpAQCAtMTI3Niw4ICsxMjYzLDcgQEAKICAgICBpZihyZXQgIT0gU0FTTF9PSykgcmV0
dXJuIHJldDsKICAgICAKICAgICBzZWNmbGFncyA9IFNBU0xfU0VDX05PQU5PTllNT1VTOwotICAg
IHBsYWludGV4dF9yZXN1bHQgPSBjb25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsMSk7
Ci0gICAgaWYgKCFjb25maWdfZ2V0c3dpdGNoKCJtdXBkYXRlX2FsbG93cGxhaW50ZXh0IiwgcGxh
aW50ZXh0X3Jlc3VsdCkpIHsKKyAgICBpZiAoIWNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExP
V1BMQUlOVEVYVCkpIHsKIAlzZWNmbGFncyB8PSBTQVNMX1NFQ19OT1BMQUlOVEVYVDsKICAgICB9
CiAgICAgc2VjcHJvcHMgPSBteXNhc2xfc2VjcHJvcHMoc2VjZmxhZ3MpOwpJbmRleDogaW1hcC9u
b3RpZnkuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9j
dnMvc3JjL2N5cnVzL2ltYXAvbm90aWZ5LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNgpkaWZm
IC11IC1yMS42IG5vdGlmeS5jCi0tLSBub3RpZnkuYwkyMDAyLzA1LzA3IDE4OjUwOjIxCTEuNgor
Kysgbm90aWZ5LmMJMjAwMi8wNi8xOCAyMDozOTo0MApAQCAtOTMsMTMgKzkzLDEzIEBACiAKICAg
ICBzb2MgPSBzb2NrZXQoQUZfVU5JWCwgU09DS19ER1JBTSwgMCk7CiAgICAgaWYgKHNvYyA9PSAt
MSkgewotCXN5c2xvZyhMT0dfRVJSLCAidW5hYmxlIHRvIG9wZW4gbm90aWZ5IHNvY2tldCgpOiAl
bSIpOworCXN5c2xvZyhMT0dfRVJSLCAidW5hYmxlIHRvIGNyZWF0ZSBub3RpZnkgc29ja2V0KCk6
ICVtIik7CiAJcmV0dXJuOwogICAgIH0KIAogICAgIG1lbXNldCgoY2hhciAqKSZzdW5fZGF0YSwg
MCwgc2l6ZW9mKHN1bl9kYXRhKSk7CiAgICAgc3VuX2RhdGEuc3VuX2ZhbWlseSA9IEFGX1VOSVg7
Ci0gICAgbm90aWZ5X3NvY2sgPSBjb25maWdfZ2V0c3RyaW5nKCJub3RpZnlzb2NrZXQiLCBOVUxM
KTsKKyAgICBub3RpZnlfc29jayA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9OT1RJRllTT0NL
RVQpOwogICAgIGlmIChub3RpZnlfc29jaykgewkKIAlzdHJjcHkoc3VuX2RhdGEuc3VuX3BhdGgs
IG5vdGlmeV9zb2NrKTsKICAgICB9CkluZGV4OiBpbWFwL3BvcDNkLmMKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL3BvcDNk
LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTIyCmRpZmYgLXUgLXIxLjEyMiBwb3AzZC5jCi0t
LSBwb3AzZC5jCTIwMDIvMDYvMDMgMTg6MjI6MjcJMS4xMjIKKysrIHBvcDNkLmMJMjAwMi8wNi8x
OCAyMzozNzowNwpAQCAtMTg5LDcgKzE4OSw3IEBACiAgICAgLyogY2hlY2sgaWYgcmVtb3RlIHJl
YWxtICovCiAgICAgaWYgKChyZWFsbSA9IHN0cmNocihhdXRoX2lkZW50aXR5LCAnQCcpKSE9TlVM
TCkgewogCXJlYWxtKys7Ci0JdmFsID0gY29uZmlnX2dldHN0cmluZygibG9naW5yZWFsbXMiLCAi
Iik7CisJdmFsID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0xPR0lOUkVBTE1TKTsKIAl3aGls
ZSAoKnZhbCkgewogCSAgICBpZiAoIXN0cm5jYXNlY21wKHZhbCwgcmVhbG0sIHN0cmxlbihyZWFs
bSkpICYmCiAJCSghdmFsW3N0cmxlbihyZWFsbSldIHx8IGlzc3BhY2UoKGludCkgdmFsW3N0cmxl
bihyZWFsbSldKSkpIHsKQEAgLTIwOSwxMyArMjA5LDEzIEBACiAgICAgYXV0aHN0YXRlID0gYXV0
aF9uZXdzdGF0ZShhdXRoX2lkZW50aXR5LCBOVUxMKTsKIAogICAgIC8qIG9rLCBpcyBhdXRoX2lk
ZW50aXR5IGFuIGFkbWluPyAqLwotICAgIHVzZXJpc2FkbWluID0gYXV0aGlzYShhdXRoc3RhdGUs
ICJpbWFwIiwgImFkbWlucyIpOworICAgIHVzZXJpc2FkbWluID0gY29uZmlnX2F1dGhpc2EoYXV0
aHN0YXRlLCBJTUFQT1BUX0FETUlOUyk7CiAKICAgICBpZiAoYWxlbiAhPSBybGVuIHx8IHN0cm5j
bXAoYXV0aF9pZGVudGl0eSwgcmVxdWVzdGVkX3VzZXIsIGFsZW4pKSB7CiAJLyogd2Ugd2FudCB0
byBhdXRoZW50aWNhdGUgYXMgYSBkaWZmZXJlbnQgdXNlcjsgd2UnbGwgYWxsb3cgdGhpcwogCSAg
IGlmIHdlJ3JlIGFuIGFkbWluIG9yIGlmIHdlJ3ZlIGFsbG93ZWQgQUNMIHByb3h5IGxvZ2lucyAq
LwogCWlmICh1c2VyaXNhZG1pbiB8fAotCSAgICBhdXRoaXNhKGF1dGhzdGF0ZSwgImltYXAiLCAi
cHJveHlzZXJ2ZXJzIikpIHsKKwkgICAgY29uZmlnX2F1dGhpc2EoYXV0aHN0YXRlLCBJTUFQT1BU
X1BST1hZU0VSVkVSUykpIHsKIAogCSAgICAvKiBwcm94eSBvayEgKi8KIAkgICAgYXV0aF9mcmVl
c3RhdGUoYXV0aHN0YXRlKTsKQEAgLTMxMiw3ICszMTIsNiBAQAogICAgIGludCByOwogICAgIGlu
dCBvcHQ7CiAKLSAgICBjb25maWdfY2hhbmdlaWRlbnQoInBvcDNkIik7CiAgICAgaWYgKGdldGV1
aWQoKSA9PSAwKSBmYXRhbCgibXVzdCBydW4gYXMgdGhlIEN5cnVzIHVzZXIiLCBFQ19VU0FHRSk7
CiAgICAgc2V0cHJvY3RpdGxlX2luaXQoYXJnYywgYXJndiwgZW52cCk7CiAKQEAgLTM1NSw3ICsz
NTQsNyBAQAogIAkgICAgYnJlYWs7CiAJY2FzZSAncyc6IC8qIHBvcDNzIChkbyBzdGFydHRscyBy
aWdodCBhd2F5KSAqLwogCSAgICBwb3AzcyA9IDE7Ci0JICAgIGlmICghdGxzX2VuYWJsZWQoInBv
cDMiKSkgeworCSAgICBpZiAoIXRsc19lbmFibGVkKCkpIHsKIAkJc3lzbG9nKExPR19FUlIsICJw
b3AzczogcmVxdWlyZWQgT3BlblNTTCBvcHRpb25zIG5vdCBwcmVzZW50Iik7CiAJCWZhdGFsKCJw
b3AzczogcmVxdWlyZWQgT3BlblNTTCBvcHRpb25zIG5vdCBwcmVzZW50IiwKIAkJICAgICAgRUNf
Q09ORklHKTsKQEAgLTQzNCw3ICs0MzMsNyBAQAogICAgIHByb2NfcmVnaXN0ZXIoInBvcDNkIiwg
cG9wZF9jbGllbnRob3N0LCBOVUxMLCBOVUxMKTsKIAogICAgIC8qIFNldCBpbmFjdGl2aXR5IHRp
bWVyICovCi0gICAgdGltZW91dCA9IGNvbmZpZ19nZXRpbnQoInBvcHRpbWVvdXQiLCAxMCk7Cisg
ICAgdGltZW91dCA9IGNvbmZpZ19nZXRpbnQoSU1BUE9QVF9QT1BUSU1FT1VUKTsKICAgICBpZiAo
dGltZW91dCA8IDEwKSB0aW1lb3V0ID0gMTA7CiAgICAgcHJvdF9zZXR0aW1lb3V0KHBvcGRfaW4s
IHRpbWVvdXQqNjApOwogICAgIHByb3Rfc2V0Zmx1c2hvbnJlYWQocG9wZF9pbiwgcG9wZF9vdXQp
OwpAQCAtNTQ1LDcgKzU0NCw3IEBACiAJZmF0YWwoIkNhbm5vdCBnZXQgY2xpZW50J3MgSVAgYWRk
cmVzcyIsIEVDX09TRVJSKTsKICAgICB9CiAKLSAgICBzcnZ0YWIgPSBjb25maWdfZ2V0c3RyaW5n
KCJzcnZ0YWIiLCAiIik7CisgICAgc3J2dGFiID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NS
VlRBQik7CiAKICAgICBzdHJjcHkoaW5zdGFuY2UsICIqIik7CiAgICAgciA9IGtyYl9yZWN2YXV0
aCgwTCwgMCwgJnRpY2tldCwgInBvcCIsIGluc3RhbmNlLApAQCAtNjUxLDcgKzY1MCw3IEBACiAJ
CWNtZF9jYXBhKCk7CiAJICAgIH0KIAl9Ci0JZWxzZSBpZiAoIXN0cmNtcChpbnB1dGJ1ZiwgInN0
bHMiKSAmJiB0bHNfZW5hYmxlZCgicG9wMyIpKSB7CisJZWxzZSBpZiAoIXN0cmNtcChpbnB1dGJ1
ZiwgInN0bHMiKSAmJiB0bHNfZW5hYmxlZCgpKSB7CiAJICAgIGlmIChhcmcpIHsKIAkJcHJvdF9w
cmludGYocG9wZF9vdXQsCiAJCQkgICAgIi1FUlIgU1RMUyBkb2Vzbid0IHRha2UgYW55IGFyZ3Vt
ZW50c1xyXG4iKTsKQEAgLTEwMzYsNyArMTAzNSw3IEBACiAKICAgICAvKiBwb3NzaWJseSBkaXNh
bGxvdyBVU0VSICovCiAgICAgaWYgKCEoa2ZsYWcgfHwgcG9wZF9zdGFydHRsc19kb25lIHx8Ci0J
ICBjb25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsIDEpKSkgeworCSAgY29uZmlnX2dl
dHN3aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhUKSkpIHsKIAlwcm90X3ByaW50Zihwb3BkX291
dCwKIAkJICAgICItRVJSIFtBVVRIXSBVU0VSIGNvbW1hbmQgb25seSBhdmFpbGFibGUgdW5kZXIg
YSBsYXllclxyXG4iKTsKIAlyZXR1cm47CkBAIC0xMTA3LDcgKzExMDYsNyBAQAogI2VuZGlmCiAK
ICAgICBpZiAoIXN0cmNtcChwb3BkX3VzZXJpZCwgImFub255bW91cyIpKSB7Ci0JaWYgKGNvbmZp
Z19nZXRzd2l0Y2goImFsbG93YW5vbnltb3VzbG9naW4iLCAwKSkgeworCWlmIChjb25maWdfZ2V0
c3dpdGNoKElNQVBPUFRfQUxMT1dBTk9OWU1PVVNMT0dJTikpIHsKIAkgICAgcGFzcyA9IGJlYXV0
aWZ5X3N0cmluZyhwYXNzKTsKIAkgICAgaWYgKHN0cmxlbihwYXNzKSA+IDUwMCkgcGFzc1s1MDBd
ID0gJ1wwJzsKIAkgICAgc3lzbG9nKExPR19OT1RJQ0UsICJsb2dpbjogJXMgYW5vbnltb3VzICVz
IiwKQEAgLTExNDEsNyArMTE0MCw4IEBACiAJICAgICAgIHBvcGRfdXNlcmlkLCBwb3BkX3N0YXJ0
dGxzX2RvbmUgPyAiK1RMUyIgOiAiIiwgCiAJICAgICAgIHJlcGx5ID8gcmVwbHkgOiAiIik7CiAK
LQlpZiAoKHBsYWludGV4dGxvZ2lucGF1c2UgPSBjb25maWdfZ2V0aW50KCJwbGFpbnRleHRsb2dp
bnBhdXNlIiwgMCkpIT0wKSB7CisJaWYgKChwbGFpbnRleHRsb2dpbnBhdXNlID0gY29uZmlnX2dl
dGludChJTUFQT1BUX1BMQUlOVEVYVExPR0lOUEFVU0UpKQorCSAgICAgIT0gMCkgewogCSAgICBz
bGVlcChwbGFpbnRleHRsb2dpbnBhdXNlKTsKIAl9CiAgICAgfQpAQCAtMTE1Myw4ICsxMTUzLDgg
QEAKIHZvaWQKIGNtZF9jYXBhKCkKIHsKLSAgICBpbnQgbWlucG9sbCA9IGNvbmZpZ19nZXRpbnQo
InBvcG1pbnBvbGwiLCAwKSAqIDYwOwotICAgIGludCBleHBpcmUgPSBjb25maWdfZ2V0aW50KCJw
b3BleHBpcmV0aW1lIiwgLTEpOworICAgIGludCBtaW5wb2xsID0gY29uZmlnX2dldGludChJTUFQ
T1BUX1BPUE1JTlBPTEwpICogNjA7CisgICAgaW50IGV4cGlyZSA9IGNvbmZpZ19nZXRpbnQoSU1B
UE9QVF9QT1BFWFBJUkVUSU1FKTsKICAgICB1bnNpZ25lZCBtZWNoY291bnQ7CiAgICAgY29uc3Qg
Y2hhciAqbWVjaGxpc3Q7CiAKQEAgLTExNjksNyArMTE2OSw3IEBACiAJcHJvdF93cml0ZShwb3Bk
X291dCwgbWVjaGxpc3QsIHN0cmxlbihtZWNobGlzdCkpOwogICAgIH0KIAotICAgIGlmICh0bHNf
ZW5hYmxlZCgicG9wMyIpKSB7CisgICAgaWYgKHRsc19lbmFibGVkKCkpIHsKIAlwcm90X3ByaW50
Zihwb3BkX291dCwgIlNUTFNcclxuIik7CiAgICAgfQogICAgIGlmIChleHBpcmUgPCAwKSB7CkBA
IC0xMTg1LDcgKzExODUsOCBAQAogICAgIHByb3RfcHJpbnRmKHBvcGRfb3V0LCAiUkVTUC1DT0RF
U1xyXG4iKTsKICAgICBwcm90X3ByaW50Zihwb3BkX291dCwgIkFVVEgtUkVTUC1DT0RFXHJcbiIp
OwogCi0gICAgaWYgKGtmbGFnIHx8IHBvcGRfc3RhcnR0bHNfZG9uZSB8fCBjb25maWdfZ2V0c3dp
dGNoKCJhbGxvd3BsYWludGV4dCIsIDEpKSB7CisgICAgaWYoa2ZsYWcgfHwgcG9wZF9zdGFydHRs
c19kb25lCisgICAgfHwgY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XUExBSU5URVhUKSkg
ewogCXByb3RfcHJpbnRmKHBvcGRfb3V0LCAiVVNFUlxyXG4iKTsKICAgICB9CiAgICAgCkBAIC0x
MzgyLDcgKzEzODMsNyBAQAogCXJldHVybiAxOwogICAgIH0KIAotICAgIGlmICgobWlucG9sbCA9
IGNvbmZpZ19nZXRpbnQoInBvcG1pbnBvbGwiLCAwKSkgJiYKKyAgICBpZiAoKG1pbnBvbGwgPSBj
b25maWdfZ2V0aW50KElNQVBPUFRfUE9QTUlOUE9MTCkpICYmCiAJbWJveHN0cnVjdC5wb3AzX2xh
c3RfbG9naW4gKyA2MCptaW5wb2xsID4gcG9wZF9sb2dpbl90aW1lKSB7CiAJcHJvdF9wcmludGYo
cG9wZF9vdXQsCiAJICAgICItRVJSIFtMT0dJTi1ERUxBWV0gTG9naW5zIG11c3QgYmUgYXQgbGVh
c3QgJWQgbWludXRlJXMgYXBhcnRcclxuIiwKSW5kZXg6IGltYXAvcG9wM3Byb3h5ZC5jCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMv
aW1hcC9wb3AzcHJveHlkLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNDIKZGlmZiAtdSAtcjEu
NDIgcG9wM3Byb3h5ZC5jCi0tLSBwb3AzcHJveHlkLmMJMjAwMi8wNi8xMiAyMDowMDoxMgkxLjQy
CisrKyBwb3AzcHJveHlkLmMJMjAwMi8wNi8xOSAwMDowMTo0OApAQCAtMTczLDcgKzE3Myw3IEBA
CiAgICAgLyogY2hlY2sgaWYgcmVtb3RlIHJlYWxtICovCiAgICAgaWYgKChyZWFsbSA9IHN0cmNo
cihhdXRoX2lkZW50aXR5LCAnQCcpKSE9TlVMTCkgewogCXJlYWxtKys7Ci0JdmFsID0gY29uZmln
X2dldHN0cmluZygibG9naW5yZWFsbXMiLCAiIik7CisJdmFsID0gY29uZmlnX2dldHN0cmluZyhJ
TUFQT1BUX0xPR0lOUkVBTE1TKTsKIAl3aGlsZSAoKnZhbCkgewogCSAgICBpZiAoIXN0cm5jYXNl
Y21wKHZhbCwgcmVhbG0sIHN0cmxlbihyZWFsbSkpICYmCiAJCSghdmFsW3N0cmxlbihyZWFsbSld
IHx8IGlzc3BhY2UoKGludCkgdmFsW3N0cmxlbihyZWFsbSldKSkpIHsKQEAgLTE5MywxMyArMTkz
LDEzIEBACiAgICAgYXV0aHN0YXRlID0gYXV0aF9uZXdzdGF0ZShhdXRoX2lkZW50aXR5LCBOVUxM
KTsKIAogICAgIC8qIG9rLCBpcyBhdXRoX2lkZW50aXR5IGFuIGFkbWluPyAqLwotICAgIHVzZXJp
c2FkbWluID0gYXV0aGlzYShhdXRoc3RhdGUsICJpbWFwIiwgImFkbWlucyIpOworICAgIHVzZXJp
c2FkbWluID0gY29uZmlnX2F1dGhpc2EoYXV0aHN0YXRlLCBJTUFQT1BUX0FETUlOUyk7CiAKICAg
ICBpZiAoYWxlbiAhPSBybGVuIHx8IHN0cm5jbXAoYXV0aF9pZGVudGl0eSwgcmVxdWVzdGVkX3Vz
ZXIsIGFsZW4pKSB7CiAJLyogd2Ugd2FudCB0byBhdXRoZW50aWNhdGUgYXMgYSBkaWZmZXJlbnQg
dXNlcjsgd2UnbGwgYWxsb3cgdGhpcwogCSAgIGlmIHdlJ3JlIGFuIGFkbWluIG9yIGlmIHdlJ3Zl
IGFsbG93ZWQgQUNMIHByb3h5IGxvZ2lucyAqLwogCWlmICh1c2VyaXNhZG1pbiB8fAotCSAgICBh
dXRoaXNhKGF1dGhzdGF0ZSwgImltYXAiLCAicHJveHlzZXJ2ZXJzIikpIHsKKwkgICAgY29uZmln
X2F1dGhpc2EoYXV0aHN0YXRlLCBJTUFQT1BUX0FETUlOUykpIHsKIAogCSAgICAvKiBwcm94eSBv
ayEgKi8KIAkgICAgYXV0aF9mcmVlc3RhdGUoYXV0aHN0YXRlKTsKQEAgLTIzMSw3ICsyMzEsNiBA
QAogewogICAgIGludCByOwogCi0gICAgY29uZmlnX2NoYW5nZWlkZW50KCJwb3AzZCIpOwogICAg
IGlmIChnZXRldWlkKCkgPT0gMCkgZmF0YWwoIm11c3QgcnVuIGFzIHRoZSBDeXJ1cyB1c2VyIiwg
RUNfVVNBR0UpOwogICAgIHNldHByb2N0aXRsZV9pbml0KGFyZ2MsIGFyZ3YsIGVudnApOwogCkBA
IC0yOTIsNyArMjkxLDcgQEAKICAJICAgIGJyZWFrOwogCWNhc2UgJ3MnOiAvKiBwb3AzcyAoZG8g
c3RhcnR0bHMgcmlnaHQgYXdheSkgKi8KIAkgICAgcG9wM3MgPSAxOwotCSAgICBpZiAoIXRsc19l
bmFibGVkKCJwb3AzIikpIHsKKwkgICAgaWYgKCF0bHNfZW5hYmxlZCgpKSB7CiAJCXN5c2xvZyhM
T0dfRVJSLCAicG9wM3M6IHJlcXVpcmVkIE9wZW5TU0wgb3B0aW9ucyBub3QgcHJlc2VudCIpOwog
CQlmYXRhbCgicG9wM3M6IHJlcXVpcmVkIE9wZW5TU0wgb3B0aW9ucyBub3QgcHJlc2VudCIsCiAJ
CSAgICAgIEVDX0NPTkZJRyk7CkBAIC0zNDksNyArMzQ4LDcgQEAKICAgICBwcm9jX3JlZ2lzdGVy
KCJwb3AzZCIsIHBvcGRfY2xpZW50aG9zdCwgTlVMTCwgTlVMTCk7CiAKICAgICAvKiBTZXQgaW5h
Y3Rpdml0eSB0aW1lciAqLwotICAgIHRpbWVvdXQgPSBjb25maWdfZ2V0aW50KCJwb3B0aW1lb3V0
IiwgMTApOworICAgIHRpbWVvdXQgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfUE9QVElNRU9VVCk7
CiAgICAgaWYgKHRpbWVvdXQgPCAxMCkgdGltZW91dCA9IDEwOwogICAgIHByb3Rfc2V0dGltZW91
dChwb3BkX2luLCB0aW1lb3V0KjYwKTsKICAgICBwcm90X3NldGZsdXNob25yZWFkKHBvcGRfaW4s
IHBvcGRfb3V0KTsKQEAgLTQ4MSw3ICs0ODAsNyBAQAogCWZhdGFsKCJDYW5ub3QgZ2V0IGNsaWVu
dCdzIElQIGFkZHJlc3MiLCBFQ19PU0VSUik7CiAgICAgfQogCi0gICAgc3J2dGFiID0gY29uZmln
X2dldHN0cmluZygic3J2dGFiIiwgIiIpOworICAgIHNydnRhYiA9IGNvbmZpZ19nZXRzdHJpbmco
SU1BUE9QVF9TUlZUQUIpOwogCiAgICAgc3RyY3B5KGluc3RhbmNlLCAiKiIpOwogICAgIHIgPSBr
cmJfcmVjdmF1dGgoMEwsIDAsICZ0aWNrZXQsICJwb3AiLCBpbnN0YW5jZSwKQEAgLTU5OCw3ICs1
OTcsNyBAQAogCWVsc2UgaWYgKCFzdHJjbXAoaW5wdXRidWYsICJhdXRoIikpIHsKIAkgICAgY21k
X2F1dGgoYXJnKTsKIAl9Ci0JZWxzZSBpZiAoIXN0cmNtcChpbnB1dGJ1ZiwgInN0bHMiKSAmJiB0
bHNfZW5hYmxlZCgicG9wMyIpKSB7CisJZWxzZSBpZiAoIXN0cmNtcChpbnB1dGJ1ZiwgInN0bHMi
KSAmJiB0bHNfZW5hYmxlZCgpKSB7CiAJICAgIGlmIChhcmcpIHsKIAkJcHJvdF9wcmludGYocG9w
ZF9vdXQsCiAJCQkgICAgIi1FUlIgU1RMUyBkb2Vzbid0IHRha2UgYW55IGFyZ3VlbWVudHNcclxu
Iik7CkBAIC02MTUsNyArNjE0LDYgQEAKICNpZmRlZiBIQVZFX1NTTAogc3RhdGljIHZvaWQgY21k
X3N0YXJ0dGxzKGludCBwb3AzcykKIHsKLSAgICBjaGFyICp0bHNfY2VydCwgKnRsc19rZXk7CiAg
ICAgaW50IHJlc3VsdDsKICAgICBpbnQgKmxheWVycDsKICAgICBjaGFyICphdXRoX2lkOwpAQCAt
NjMxLDExICs2MjksNiBAQAogCXJldHVybjsKICAgICB9CiAKLSAgICB0bHNfY2VydCA9IChjaGFy
ICopY29uZmlnX2dldHN0cmluZygidGxzX3BvcDNfY2VydF9maWxlIiwKLQkJCQkJY29uZmlnX2dl
dHN0cmluZygidGxzX2NlcnRfZmlsZSIsICIiKSk7Ci0gICAgdGxzX2tleSA9IChjaGFyICopY29u
ZmlnX2dldHN0cmluZygidGxzX3BvcDNfa2V5X2ZpbGUiLAotCQkJCSAgICAgICBjb25maWdfZ2V0
c3RyaW5nKCJ0bHNfa2V5X2ZpbGUiLCAiIikpOwotCiAgICAgcmVzdWx0PXRsc19pbml0X3NlcnZl
cmVuZ2luZSgicG9wMyIsCiAJCQkJIDUsICAgICAgICAvKiBkZXB0aCB0byB2ZXJpZnkgKi8KIAkJ
CQkgIXBvcDNzLCAgIC8qIGNhbiBjbGllbnQgYXV0aD8gKi8KQEAgLTgwNCw3ICs3OTcsNyBAQAog
CiAgICAgLyogcG9zc2libHkgZGlzYWxsb3cgVVNFUiAqLwogICAgIGlmICghKGtmbGFnIHx8IHBv
cGRfc3RhcnR0bHNfZG9uZSB8fAotCSAgY29uZmlnX2dldHN3aXRjaCgiYWxsb3dwbGFpbnRleHQi
LCAxKSkpIHsKKwkgIGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV1BMQUlOVEVYVCkpKSB7
CiAJcHJvdF9wcmludGYocG9wZF9vdXQsCiAJCSAgICAiLUVSUiBbQVVUSF0gVVNFUiBjb21tYW5k
IG9ubHkgYXZhaWxhYmxlIHVuZGVyIGEgbGF5ZXJcclxuIik7CiAJcmV0dXJuOwpAQCAtODY0LDcg
Kzg1Nyw3IEBACiAjZW5kaWYKIAogICAgIGlmICghc3RyY21wKHBvcGRfdXNlcmlkLCAiYW5vbnlt
b3VzIikpIHsKLQlpZiAoY29uZmlnX2dldHN3aXRjaCgiYWxsb3dhbm9ueW1vdXNsb2dpbiIsIDAp
KSB7CisJaWYgKGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV0FOT05ZTU9VU0xPR0lOKSkg
ewogCSAgICBwYXNzID0gYmVhdXRpZnlfc3RyaW5nKHBhc3MpOwogCSAgICBpZiAoc3RybGVuKHBh
c3MpID4gNTAwKSBwYXNzWzUwMF0gPSAnXDAnOwogCSAgICBzeXNsb2coTE9HX05PVElDRSwgImxv
Z2luOiAlcyBhbm9ueW1vdXMgJXMiLApAQCAtODk4LDcgKzg5MSw3IEBACiAJICAgICAgIHBvcGRf
dXNlcmlkLCBwb3BkX3N0YXJ0dGxzX2RvbmUgPyAiK1RMUyIgOiAiIiwgCiAJICAgICAgIHJlcGx5
ID8gcmVwbHkgOiAiIik7CiAKLQlwbGFpbnRleHRsb2dpbnBhdXNlID0gY29uZmlnX2dldGludCgi
cGxhaW50ZXh0bG9naW5wYXVzZSIsIDApOworCXBsYWludGV4dGxvZ2lucGF1c2UgPSBjb25maWdf
Z2V0aW50KElNQVBPUFRfUExBSU5URVhUTE9HSU5QQVVTRSk7CiAJaWYgKHBsYWludGV4dGxvZ2lu
cGF1c2UpIHNsZWVwKHBsYWludGV4dGxvZ2lucGF1c2UpOwogICAgIH0KIApAQCAtOTExLDggKzkw
NCw4IEBACiB2b2lkCiBjbWRfY2FwYSgpCiB7Ci0gICAgaW50IG1pbnBvbGwgPSBjb25maWdfZ2V0
aW50KCJwb3BtaW5wb2xsIiwgMCkgKiA2MDsKLSAgICBpbnQgZXhwaXJlID0gY29uZmlnX2dldGlu
dCgicG9wZXhwaXJldGltZSIsIC0xKTsKKyAgICBpbnQgbWlucG9sbCA9IGNvbmZpZ19nZXRpbnQo
SU1BUE9QVF9QT1BNSU5QT0xMKSAqIDYwOworICAgIGludCBleHBpcmUgPSBjb25maWdfZ2V0aW50
KElNQVBPUFRfUE9QRVhQSVJFVElNRSk7CiAgICAgdW5zaWduZWQgbWVjaGNvdW50OwogICAgIGNv
bnN0IGNoYXIgKm1lY2hsaXN0OwogCkBAIC05MjcsNyArOTIwLDcgQEAKIAlwcm90X3dyaXRlKHBv
cGRfb3V0LCBtZWNobGlzdCwgc3RybGVuKG1lY2hsaXN0KSk7CiAgICAgfQogCi0gICAgaWYgKHRs
c19lbmFibGVkKCJwb3AzIikpIHsKKyAgICBpZiAodGxzX2VuYWJsZWQoKSkgewogCXByb3RfcHJp
bnRmKHBvcGRfb3V0LCAiU1RMU1xyXG4iKTsKICAgICB9CiAgICAgaWYgKGV4cGlyZSA8IDApIHsK
QEAgLTk0Myw3ICs5MzYsNyBAQAogICAgIHByb3RfcHJpbnRmKHBvcGRfb3V0LCAiUkVTUC1DT0RF
U1xyXG4iKTsKICAgICBwcm90X3ByaW50Zihwb3BkX291dCwgIkFVVEgtUkVTUC1DT0RFXHJcbiIp
OwogCi0gICAgaWYgKGtmbGFnIHx8IHBvcGRfc3RhcnR0bHNfZG9uZSB8fCBjb25maWdfZ2V0c3dp
dGNoKCJhbGxvd3BsYWludGV4dCIsIDEpKSB7CisgICAgaWYgKGtmbGFnIHx8IHBvcGRfc3RhcnR0
bHNfZG9uZSB8fCBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQUxMT1dQTEFJTlRFWFQpKSB7CiAJ
cHJvdF9wcmludGYocG9wZF9vdXQsICJVU0VSXHJcbiIpOwogICAgIH0KICAgICAKQEAgLTExNDgs
NiArMTE0MSw1MiBAQAogCQkJCQkgY29uc3QgY2hhciAqcGFzc3dvcmQpOwogZXh0ZXJuIHZvaWQg
ZnJlZV9jYWxsYmFja3Moc2FzbF9jYWxsYmFja190ICppbik7CiAKK3N0YXRpYyBjaGFyICpwYXJz
ZW1lY2hsaXN0KGNoYXIgKnN0cikKK3sKKyAgY2hhciAqdG1wOworICBjaGFyICpyZXQ9bWFsbG9j
KHN0cmxlbihzdHIpKzEpOworICBpZiAocmV0PT1OVUxMKSByZXR1cm4gTlVMTDsKKworICBzdHJj
cHkocmV0LCIiKTsKKworICBpZiAoKHRtcD1zdHJzdHIoc3RyLCJTQVNMICIpKSE9TlVMTCkKKyAg
eworICAgIGNoYXIgKmVuZD10bXArNTsKKyAgICB0bXArPTU7CisKKyAgICB3aGlsZSgoKCplbmQp
IT0nXG4nKSAmJiAoKCplbmQpIT0nXDAnKSkKKyAgICAgIGVuZCsrOworCisgICAgKCplbmQpPSdc
MCc7CisKKyAgICBzdHJjcHkocmV0LCB0bXApOworICB9CisKKyAgcmV0dXJuIHJldDsKK30KKwor
c3RhdGljIGNoYXIgKmFza19jYXBhYmlsaXR5KHN0cnVjdCBwcm90c3RyZWFtICpwb3V0LCBzdHJ1
Y3QgcHJvdHN0cmVhbSAqcGluKQoreworICBjaGFyIHN0clsxMDI0XTsKKyAgY2hhciAqcmV0ID0g
TlVMTDsKKworICAvKiByZXF1ZXN0IGNhcGFiaWxpdGllcyBvZiBzZXJ2ZXIgKi8KKyAgcHJvdF9w
cmludGYocG91dCwgIkNBUEFcclxuIik7CisgIHByb3RfZmx1c2gocG91dCk7CisKKyAgZG8gewor
ICAgICAgaWYgKHByb3RfZmdldHMoc3RyLHNpemVvZihzdHIpLHBpbikgPT0gTlVMTCkgeworCSAg
cmV0dXJuIE5VTEw7CisgICAgICB9CisgICAgICBwcmludGYoIlM6ICVzIiwgc3RyKTsKKyAgICAg
IGlmICghc3RybmNhc2VjbXAoc3RyLCJTQVNMICIsNSkpIHsKKwkgIHJldD1wYXJzZW1lY2hsaXN0
KHN0cik7CisgICAgICB9CisgIH0gd2hpbGUgKHN0cm5jYXNlY21wKHN0ciwgIi4iLCAxKSk7CisK
KyAgcmV0dXJuIHJldDsKK30KKwogc3RhdGljIGludCBwcm94eV9hdXRoZW50aWNhdGUoY29uc3Qg
Y2hhciAqaG9zdG5hbWUpCiB7CiAgICAgaW50IHI7CkBAIC0xMTYxLDcgKzEyMDAsOCBAQAogICAg
IGNoYXIgKmluLCAqcDsKICAgICBjb25zdCBjaGFyICpvdXQ7CiAgICAgdW5zaWduZWQgaW50IGlu
bGVuLCBvdXRsZW47Ci0gICAgY29uc3QgY2hhciAqbWVjaHVzaW5nOworICAgIGNvbnN0IGNoYXIg
Km1lY2hfY29uZiwgKm1lY2h1c2luZzsKKyAgICBjaGFyICptZWNobGlzdDsKICAgICB1bnNpZ25l
ZCBiNjRsZW47CiAgICAgY2hhciBsb2NhbGlwWzYwXSwgcmVtb3RlaXBbNjBdOwogICAgIGNvbnN0
IGNoYXIgKnBhc3M7CkBAIC0xMTcwLDEwICsxMjEwLDExIEBACiAgICAgcCA9IHN0cmNocihvcHRz
dHIsICcuJyk7CiAgICAgaWYgKHApICpwID0gJ1wwJzsKICAgICBzdHJjYXQob3B0c3RyLCAiX3Bh
c3N3b3JkIik7Ci0gICAgcGFzcyA9IGNvbmZpZ19nZXRzdHJpbmcob3B0c3RyLCBOVUxMKTsKKyAg
ICBwYXNzID0gY29uZmlnX2dldG92ZXJmbG93c3RyaW5nKG9wdHN0ciwgTlVMTCk7CisgICAgaWYo
IXBhc3MpIHBhc3MgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfUFJPWFlfUEFTU1dPUkQpOwog
ICAgIGNiID0gbXlzYXNsX2NhbGxiYWNrcyhwb3BkX3VzZXJpZCwgCi0JCQkgIGNvbmZpZ19nZXRz
dHJpbmcoInByb3h5X2F1dGhuYW1lIiwgInByb3h5IiksCi0JCQkgIGNvbmZpZ19nZXRzdHJpbmco
InByb3h5X3JlYWxtIiwgTlVMTCksCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9Y
WV9BVVRITkFNRSksCisJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QUk9YWV9SRUFMTSks
CiAJCQkgIHBhc3MpOwogCiAgICAgciA9IHNhc2xfY2xpZW50X25ldygicG9wIiwgaG9zdG5hbWUs
IE5VTEwsIE5VTEwsCkBAIC0xMjEzLDE1ICsxMjU0LDMwIEBACiAJcmV0dXJuIFNBU0xfRkFJTDsK
ICAgICB9CiAKKyAgICAvKiBHZXQgU0FTTCBtZWNoYW5pc20gbGlzdCAqLworICAgIC8qIFdlIGNh
biBmb3JjZSBhIHBhcnRpY3VsYXIgbWVjaGFuaXNtIHVzaW5nIGEgPHNob3J0aG9zdD5fbWVjaHMg
b3B0aW9uICovCiAgICAgc3RyY3B5KGJ1ZiwgaG9zdG5hbWUpOwogICAgIHAgPSBzdHJjaHIoYnVm
LCAnLicpOwogICAgICpwID0gJ1wwJzsKICAgICBzdHJjYXQoYnVmLCAiX21lY2hzIik7CisgICAg
bWVjaF9jb25mID0gY29uZmlnX2dldG92ZXJmbG93c3RyaW5nKGJ1ZiwgTlVMTCk7CisgICAgCisg
ICAgLyogSWYgd2UgZG9uJ3QgaGF2ZSBhIG1lY2hfY29uZiwgYXNrIHRoZSBzZXJ2ZXIgd2hhdCBp
dCBjYW4gZG8gKi8KKyAgICBpZighbWVjaF9jb25mKSB7CisJbWVjaGxpc3QgPSBhc2tfY2FwYWJp
bGl0eShiYWNrZW5kX291dCwgYmFja2VuZF9pbik7CisgICAgfSBlbHNlIHsKKwltZWNobGlzdCA9
IHhzdHJkdXAobWVjaF9jb25mKTsKKyAgICB9CiAKICAgICAvKiB3ZSBub3cgZG8gdGhlIGFjdHVh
bCBTQVNMIGV4Y2hhbmdlICovCiAgICAgciA9IHNhc2xfY2xpZW50X3N0YXJ0KGJhY2tlbmRfc2Fz
bGNvbm4sIAotCQkJICBjb25maWdfZ2V0c3RyaW5nKGJ1ZiwgIktFUkJFUk9TX1Y0IiksCisJCQkg
IG1lY2hsaXN0LAogCQkJICBOVUxMLCAmb3V0LCAmb3V0bGVuLCAmbWVjaHVzaW5nKTsKKworICAg
IC8qIGdhcmJhZ2UgY29sbGVjdCAqLworICAgIGZyZWUobWVjaGxpc3QpOworICAgIG1lY2hsaXN0
ID0gTlVMTDsKKwogICAgIGlmICgociAhPSBTQVNMX09LKSAmJiAociAhPSBTQVNMX0NPTlRJTlVF
KSkgewogCXJldHVybiByOwogICAgIH0KSW5kZXg6IGltYXAvcHJveHlkLmMKPT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpS
Q1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL3By
b3h5ZC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjEyOQpkaWZmIC11IC1yMS4xMjkgcHJveHlk
LmMKLS0tIHByb3h5ZC5jCTIwMDIvMDYvMTQgMTg6MTg6MzQJMS4xMjkKKysrIHByb3h5ZC5jCTIw
MDIvMDYvMTggMjM6NDY6NDQKQEAgLTY0MSw3ICs2NDEsNyBAQAogCQkgICAgIGludCBmb3JfZmlu
ZCkgCiB7CiAgICAgaW50IHRhZ2xlbiA9IHN0cmxlbih0YWcpOwotICAgIGludCBpLGM7CisgICAg
aW50IGM7CiAgICAgaW50IHIgPSBQUk9YWV9PSzsKICAgICBpbnQgZXhpc3RfcjsKICAgICBjaGFy
IG1haWxib3huYW1lW01BWF9NQUlMQk9YX1BBVEggKyAxXTsKQEAgLTEwNzEsNyArMTA3MSw3IEBA
CiAgICAgLyogY2hlY2sgaWYgcmVtb3RlIHJlYWxtICovCiAgICAgaWYgKChyZWFsbSA9IHN0cmNo
cihhdXRoX2lkZW50aXR5LCAnQCcpKSE9TlVMTCkgewogCXJlYWxtKys7Ci0JdmFsID0gY29uZmln
X2dldHN0cmluZygibG9naW5yZWFsbXMiLCAiIik7CisJdmFsID0gY29uZmlnX2dldHN0cmluZyhJ
TUFQT1BUX0xPR0lOUkVBTE1TKTsKIAl3aGlsZSAoKnZhbCkgewogCSAgICBpZiAoIXN0cm5jYXNl
Y21wKHZhbCwgcmVhbG0sIHN0cmxlbihyZWFsbSkpICYmCiAJCSghdmFsW3N0cmxlbihyZWFsbSld
IHx8IGlzc3BhY2UoKGludCkgdmFsW3N0cmxlbihyZWFsbSldKSkpIHsKQEAgLTEwOTEsMTYgKzEw
OTEsMTYgQEAKICAgICBwcm94eWRfYXV0aHN0YXRlID0gYXV0aF9uZXdzdGF0ZShhdXRoX2lkZW50
aXR5LCBOVUxMKTsKIAogICAgIC8qIG9rLCBpcyBhdXRoX2lkZW50aXR5IGFuIGFkbWluPyAqLwot
ICAgIHByb3h5ZF91c2VyaXNhZG1pbiA9IGF1dGhpc2EocHJveHlkX2F1dGhzdGF0ZSwgImltYXAi
LCAiYWRtaW5zIik7CisgICAgcHJveHlkX3VzZXJpc2FkbWluID0gY29uZmlnX2F1dGhpc2EocHJv
eHlkX2F1dGhzdGF0ZSwgSU1BUE9QVF9BRE1JTlMpOwogCiAgICAgaWYgKHN0cmNtcChhdXRoX2lk
ZW50aXR5LCByZXF1ZXN0ZWRfdXNlcikpIHsKIAkvKiB3ZSB3YW50IHRvIGF1dGhlbnRpY2F0ZSBh
cyBhIGRpZmZlcmVudCB1c2VyOyB3ZSdsbCBhbGxvdyB0aGlzCiAJICAgaWYgd2UncmUgYW4gYWRt
aW4gb3IgaWYgd2UndmUgYWxsb3dlZCBBQ0wgcHJveHkgbG9naW5zICovCi0JaW50IHVzZV9hY2wg
PSBjb25maWdfZ2V0c3dpdGNoKCJsb2dpbnVzZWFjbCIsIDApOworCWludCB1c2VfYWNsID0gY29u
ZmlnX2dldHN3aXRjaChJTUFQT1BUX0xPR0lOVVNFQUNMKTsKIAogCWlmIChwcm94eWRfdXNlcmlz
YWRtaW4gfHwKIAkgICAgKHVzZV9hY2wgJiYgYWNsX29rKHJlcXVlc3RlZF91c2VyLCBhdXRoX2lk
ZW50aXR5KSkgfHwKLQkgICAgYXV0aGlzYShwcm94eWRfYXV0aHN0YXRlLCAiaW1hcCIsICJwcm94
eXNlcnZlcnMiKSkgeworCSAgICBjb25maWdfYXV0aGlzYShwcm94eWRfYXV0aHN0YXRlLCBJTUFQ
T1BUX1BST1hZU0VSVkVSUykpIHsKIAkgICAgLyogcHJveHkgb2shICovCiAKIAkgICAgcHJveHlk
X3VzZXJpc2FkbWluID0gMDsJLyogbm8gbG9uZ2VyIGFkbWluICovCkBAIC0xMTQwLDcgKzExNDAs
NiBAQAogICAgIGludCBvcHQ7CiAgICAgaW50IHI7CiAKLSAgICBjb25maWdfY2hhbmdlaWRlbnQo
InByb3h5ZCIpOwogICAgIGlmIChnZXRldWlkKCkgPT0gMCkgZmF0YWwoIm11c3QgcnVuIGFzIHRo
ZSBDeXJ1cyB1c2VyIiwgRUNfVVNBR0UpOwogICAgIHNldHByb2N0aXRsZV9pbml0KGFyZ2MsIGFy
Z3YsIGVudnApOwogCkBAIC0xMTgwLDcgKzExNzksNyBAQAogIAkgICAgYnJlYWs7CiAJY2FzZSAn
cyc6IC8qIGltYXBzIChkbyBzdGFydHRscyByaWdodCBhd2F5KSAqLwogCSAgICBpbWFwcyA9IDE7
Ci0JICAgIGlmICghdGxzX2VuYWJsZWQoImltYXAiKSkgeworCSAgICBpZiAoIXRsc19lbmFibGVk
KCkpIHsKIAkJc3lzbG9nKExPR19FUlIsICJpbWFwczogcmVxdWlyZWQgT3BlblNTTCBvcHRpb25z
IG5vdCBwcmVzZW50Iik7CiAJCWZhdGFsKCJpbWFwczogcmVxdWlyZWQgT3BlblNTTCBvcHRpb25z
IG5vdCBwcmVzZW50IiwKIAkJICAgICAgRUNfQ09ORklHKTsKQEAgLTEzNDksNyArMTM0OCw3IEBA
CiAgICAgcHJvY19yZWdpc3RlcigicHJveHlkIiwgcHJveHlkX2NsaWVudGhvc3QsIChjaGFyICop
MCwgKGNoYXIgKikwKTsKIAogICAgIC8qIFNldCBpbmFjdGl2aXR5IHRpbWVyICovCi0gICAgdGlt
ZW91dCA9IGNvbmZpZ19nZXRpbnQoInRpbWVvdXQiLCAzMCk7CisgICAgdGltZW91dCA9IGNvbmZp
Z19nZXRpbnQoSU1BUE9QVF9USU1FT1VUKTsKICAgICBpZiAodGltZW91dCA8IDMwKSB0aW1lb3V0
ID0gMzA7CiAgICAgcHJvdF9zZXR0aW1lb3V0KHByb3h5ZF9pbiwgdGltZW91dCo2MCk7CiAgICAg
cHJvdF9zZXRmbHVzaG9ucmVhZChwcm94eWRfaW4sIHByb3h5ZF9vdXQpOwpAQCAtMTkyOCw3ICsx
OTI3LDcgQEAKIAkgICAgCiAJY2FzZSAnUyc6CiAJICAgIGlmICghc3RyY21wKGNtZC5zLCAiU3Rh
cnR0bHMiKSkgewotCQlpZiAoIXRsc19lbmFibGVkKCJpbWFwIikpIHsKKwkJaWYgKCF0bHNfZW5h
YmxlZCgpKSB7CiAJCSAgICAvKiB3ZSBkb24ndCBzdXBwb3J0IHN0YXJ0dGxzICovCiAJCSAgICBn
b3RvIGJhZGNtZDsKIAkJfQpAQCAtMjIwNCw3ICsyMjAzLDcgQEAKIAogICAgIC8qIHBvc3NpYmx5
IGRpc2FsbG93IGxvZ2luICovCiAgICAgaWYgKChwcm94eWRfc3RhcnR0bHNfZG9uZSA9PSAwKSAm
JgotCShjb25maWdfZ2V0c3dpdGNoKCJhbGxvd3BsYWludGV4dCIsIDEpID09IDApICYmCisJKGNv
bmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV1BMQUlOVEVYVCkgPT0gMCkgJiYKIAlzdHJjbXAo
Y2Fub25fdXNlciwgImFub255bW91cyIpICE9IDApIHsKIAllYXRsaW5lKHByb3h5ZF9pbiwgJyAn
KTsKIAlwcm90X3ByaW50Zihwcm94eWRfb3V0LCAiJXMgTk8gTG9naW4gb25seSBhdmFpbGFibGUg
dW5kZXIgYSBsYXllclxyXG4iLApAQCAtMjIyOCw3ICsyMjI3LDcgQEAKICAgICBwYXNzd2QgPSBw
YXNzd2RidWYuczsKIAogICAgIGlmICghc3RyY21wKGNhbm9uX3VzZXIsICJhbm9ueW1vdXMiKSkg
ewotCWlmIChjb25maWdfZ2V0c3dpdGNoKCJhbGxvd2Fub255bW91c2xvZ2luIiwgMCkpIHsKKwlp
ZiAoY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0FMTE9XQU5PTllNT1VTTE9HSU4pKSB7CiAJICAg
IHBhc3N3ZCA9IGJlYXV0aWZ5X3N0cmluZyhwYXNzd2QpOwogCSAgICBpZiAoc3RybGVuKHBhc3N3
ZCkgPiA1MDApIHBhc3N3ZFs1MDBdID0gJ1wwJzsKIAkgICAgc3lzbG9nKExPR19OT1RJQ0UsICJs
b2dpbjogJXMgYW5vbnltb3VzICVzIiwKQEAgLTIyNzQsNyArMjI3Myw3IEBACiAJICAgICAgIGNh
bm9uX3VzZXIsIHByb3h5ZF9zdGFydHRsc19kb25lID8gIitUTFMiIDogIiIsIAogCSAgICAgICBy
ZXBseSA/IHJlcGx5IDogIiIpOwogCi0JcGxhaW50ZXh0bG9naW5wYXVzZSA9IGNvbmZpZ19nZXRp
bnQoInBsYWludGV4dGxvZ2lucGF1c2UiLCAwKTsKKwlwbGFpbnRleHRsb2dpbnBhdXNlID0gY29u
ZmlnX2dldGludChJTUFQT1BUX1BMQUlOVEVYVExPR0lOUEFVU0UpOwogCWlmIChwbGFpbnRleHRs
b2dpbnBhdXNlKSB7CiAKIAkgICAgLyogQXBwbHkgcGVuYWx0eSBvbmx5IGlmIG5vdCB1bmRlciBs
YXllciAqLwpAQCAtMjI4Niw3ICsyMjg1LDcgQEAKIAogICAgIHByb3h5ZF9hdXRoc3RhdGUgPSBh
dXRoX25ld3N0YXRlKGNhbm9uX3VzZXIsIChjaGFyICopMCk7CiAKLSAgICB2YWwgPSBjb25maWdf
Z2V0c3RyaW5nKCJhZG1pbnMiLCAiIik7CisgICAgdmFsID0gY29uZmlnX2dldHN0cmluZyhJTUFQ
T1BUX0FETUlOUyk7CiAgICAgd2hpbGUgKCp2YWwpIHsKIAlmb3IgKHAgPSAoY2hhciAqKXZhbDsg
KnAgJiYgIWlzc3BhY2UoKGludCkgKnApOyBwKyspOwogCXN0cmxjcHkoYnVmLCB2YWwsIHAgLSB2
YWwpOwpAQCAtMjYxOCw3ICsyNjE3LDcgQEAKIAogICAgIC8qIHNwaXQgb3V0IG91ciBJRCBzdHJp
bmcuCiAgICAgICAgZXZlbnR1YWxseSB0aGlzIG1pZ2h0IGJlIGNvbmZpZ3VyYWJsZS4gKi8KLSAg
ICBpZiAoY29uZmlnX2dldHN3aXRjaCgiaW1hcGlkcmVzcG9uc2UiLCAxKSkgeworICAgIGlmIChj
b25maWdfZ2V0c3dpdGNoKElNQVBPUFRfSU1BUElEUkVTUE9OU0UpKSB7CiAJaWRfcmVzcG9uc2Uo
cHJveHlkX291dCk7CiAKIAkvKiBhZGQgaW5mbyBhYm91dCB0aGUgYmFja2VuZCAqLwpAQCAtMjY4
Miw3ICsyNjgxLDcgQEAKIAogICAgIC8qIGdldCBwb2xsaW5nIHBlcmlvZCAqLwogICAgIGlmIChp
ZGxlX3BlcmlvZCA9PSAtMSkgewotICAgICAgaWRsZV9wZXJpb2QgPSBjb25maWdfZ2V0aW50KCJp
bWFwaWRsZXBvbGwiLCA2MCk7CisgICAgICBpZGxlX3BlcmlvZCA9IGNvbmZpZ19nZXRpbnQoSU1B
UE9QVF9JTUFQSURMRVBPTEwpKTsKICAgICAgIGlmIChpZGxlX3BlcmlvZCA8IDEpIGlkbGVfcGVy
aW9kID0gMTsKICAgICB9CiAKQEAgLTI4ODQsMTAgKzI4ODMsMTAgQEAKICAgICBwcm90X3ByaW50
Zihwcm94eWRfb3V0LCAiIElETEUiKTsKICNlbmRpZgogCi0gICAgaWYgKHRsc19lbmFibGVkKCJp
bWFwIikpIHsKKyAgICBpZiAodGxzX2VuYWJsZWQoKSkgewogCXByb3RfcHJpbnRmKHByb3h5ZF9v
dXQsICIgU1RBUlRUTFMiKTsKICAgICB9Ci0gICAgaWYgKCFwcm94eWRfc3RhcnR0bHNfZG9uZSAm
JiAhY29uZmlnX2dldHN3aXRjaCgiYWxsb3dwbGFpbnRleHQiLCAxKSkgeworICAgIGlmICghcHJv
eHlkX3N0YXJ0dGxzX2RvbmUgJiYgIWNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9BTExPV1BMQUlO
VEVYVCkpIHsKIAlwcm90X3ByaW50Zihwcm94eWRfb3V0LCAiIExPR0lORElTQUJMRUQiKTsJCiAg
ICAgfQogCkBAIC0zOTUwLDcgKzM5NDksNyBAQAogICAgIC8qIElnbm9yZSB0aGUgcmVmZXJlbmNl
IGFyZ3VtZW50PwogICAgICAgICh0aGUgYmVoYXZpb3IgaW4gMS41LjEwICYgb2xkZXIpICovCiAg
ICAgaWYgKGlnbm9yZXJlZmVyZW5jZSA9PSAtMSkgewotCWlnbm9yZXJlZmVyZW5jZSA9IGNvbmZp
Z19nZXRzd2l0Y2goImlnbm9yZXJlZmVyZW5jZSIsIDApOworCWlnbm9yZXJlZmVyZW5jZSA9IGNv
bmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9JR05PUkVSRUZFUkVOQ0UpOwogICAgIH0KIAogICAgIC8q
IFJlc2V0IHN0YXRlIGluIG1zdHJpbmdkYXRhICovCkBAIC00NjM2LDcgKzQ2MzUsNyBAQAogCiAg
ICAgaWYgKCFyKSByID0gbWxvb2t1cChtYWlsYm94bmFtZSwgJnNlcnZlciwgTlVMTCwgTlVMTCk7
CiAgICAgaWYgKCFyICYmIHN1cHBvcnRzX3JlZmVycmFscwotCSYmIGNvbmZpZ19nZXRzd2l0Y2go
InByb3h5ZF9hbGxvd19zdGF0dXNfcmVmZXJyYWwiLDApKSB7IAorCSYmIGNvbmZpZ19nZXRzd2l0
Y2goSU1BUE9QVF9QUk9YWURfQUxMT1dfU1RBVFVTX1JFRkVSUkFMKSkgeyAKIAlwcm94eWRfcmVm
ZXIodGFnLCBzZXJ2ZXIsIG1haWxib3huYW1lKTsKIAkvKiBFYXQgdGhlIGFyZ3VtZW50ICovCiAJ
ZWF0bGluZShwcm94eWRfaW4sIHByb3RfZ2V0Yyhwcm94eWRfaW4pKTsKQEAgLTQ2ODEsOCArNDY4
MCw3IEBACiAgICAgY29uc3QgY2hhciAqdXJsOwogICAgIC8qIHNvIHRlbXB0aW5nLCBhbmQgeWV0
IC4uLiAqLwogICAgIC8qIHVybCA9ICJodHRwOi8vcmFuZG9tLnlhaG9vLmNvbS9yeWwvIjsgKi8K
LSAgICB1cmwgPSBjb25maWdfZ2V0c3RyaW5nKCJuZXRzY2FwZXVybCIsCi0JCQkgICAiaHR0cDov
L2FuZHJldzIuYW5kcmV3LmNtdS5lZHUvY3lydXMvaW1hcGQvbmV0c2NhcGUtYWRtaW4uaHRtbCIp
OworICAgIHVybCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9ORVRTQ0FQRVVSTCk7CiAKICAg
ICAvKiBJIG9ubHkga25vdyBvZiB0aHJlZSB0aGluZ3MgdG8gcmVwbHkgd2l0aDogKi8KICAgICBw
cm90X3ByaW50Zihwcm94eWRfb3V0LApJbmRleDogaW1hcC90bHMuYwo9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBm
aWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvdGxzLmMs
dgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMzgKZGlmZiAtdSAtcjEuMzggdGxzLmMKLS0tIHRscy5j
CTIwMDIvMDYvMDMgMTY6NTk6NTcJMS4zOAorKysgdGxzLmMJMjAwMi8wNi8xOCAyMDo1NDozNgpA
QCAtMTQ4LDE5ICsxNDgsMTQgQEAKIHN0YXRpYyBpbnQgZG9fZHVtcCA9IDA7CQkvKiBhY3RpdmVs
eSBkdW1waW5nIHByb3RvY29sPyAqLwogCiAKLWludCB0bHNfZW5hYmxlZChjb25zdCBjaGFyICpp
ZGVudCkKK2ludCB0bHNfZW5hYmxlZCh2b2lkKQogewotICAgIGNoYXIgYnVmWzUwXTsKICAgICBj
b25zdCBjaGFyICp2YWw7CiAKLSAgICBzcHJpbnRmKGJ1ZiwgInRsc18lc19jZXJ0X2ZpbGUiLCBp
ZGVudCk7Ci0gICAgdmFsID0gY29uZmlnX2dldHN0cmluZyhidWYsCi0JCQkgICBjb25maWdfZ2V0
c3RyaW5nKCJ0bHNfY2VydF9maWxlIiwgTlVMTCkpOworICAgIHZhbCA9IGNvbmZpZ19nZXRzdHJp
bmcoSU1BUE9QVF9UTFNfQ0VSVF9GSUxFKTsKICAgICBpZiAoIXZhbCB8fCAhc3RyY2FzZWNtcCh2
YWwsICJkaXNhYmxlZCIpKSByZXR1cm4gMDsKIAotICAgIHNwcmludGYoYnVmLCAidGxzXyVzX2tl
eV9maWxlIiwgaWRlbnQpOwotICAgIHZhbCA9IGNvbmZpZ19nZXRzdHJpbmcoYnVmLAotCQkJICAg
Y29uZmlnX2dldHN0cmluZygidGxzX2tleV9maWxlIiwgTlVMTCkpOworICAgIHZhbCA9IGNvbmZp
Z19nZXRzdHJpbmcoSU1BUE9QVF9UTFNfS0VZX0ZJTEUpOwogICAgIGlmICghdmFsIHx8ICFzdHJj
YXNlY21wKHZhbCwgImRpc2FibGVkIikpIHJldHVybiAwOwogCiAgICAgcmV0dXJuIDE7CkBAIC0y
MDksNyArMjA0LDkgQEAKIAogLyogdGFrZW4gZnJvbSBPcGVuU1NMIGFwcHMvc19jYi5jICovCiAK
LXN0YXRpYyBSU0EgKnRtcF9yc2FfY2IoU1NMICogcywgaW50IGV4cG9ydCwgaW50IGtleWxlbmd0
aCkKK3N0YXRpYyBSU0EgKnRtcF9yc2FfY2IoU1NMICogcyBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQp
KSwKKwkJICAgICAgIGludCBleHBvcnQgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisJCSAgICAg
ICBpbnQga2V5bGVuZ3RoKQogewogICAgIHN0YXRpYyBSU0EgKnJzYV90bXAgPSBOVUxMOwogCkBA
IC0zODMsNyArMzgwLDggQEAKICAqIG5lZ290aWF0ZWQgYW5kIHNlc3Npb24gY2FjaGluZyBpcyBl
bmFibGVkLiAgV2Ugc2F2ZSB0aGUgc2Vzc2lvbiBpbgogICogYSBkYXRhYmFzZSBzbyB0aGF0IHdl
IGNhbiBzaGFyZSBzZXNzaW9ucyBiZXR3ZWVuIHByb2Nlc3Nlcy4gCiAgKi8gCi1zdGF0aWMgaW50
IG5ld19zZXNzaW9uX2NiKFNTTCAqc3NsLCBTU0xfU0VTU0lPTiAqc2VzcykKK3N0YXRpYyBpbnQg
bmV3X3Nlc3Npb25fY2IoU1NMICpzc2wgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisJCQkgIFNT
TF9TRVNTSU9OICpzZXNzKQogewogICAgIGludCBsZW47CiAgICAgdW5zaWduZWQgY2hhciAqZGF0
YSA9IE5VTEwsICphc247CkBAIC00NzEsNyArNDY5LDggQEAKICAqIHJlbW92ZWQgYmVjYXVzZSBp
dCBpcyBleHBpcmVkIG9yIHdoZW4gYSBjb25uZWN0aW9uIHdhcyBub3Qgc2h1dGRvd24KICAqIGNs
ZWFubHkuCiAgKi8KLXN0YXRpYyB2b2lkIHJlbW92ZV9zZXNzaW9uX2NiKFNTTF9DVFggKmN0eCwg
U1NMX1NFU1NJT04gKnNlc3MpCitzdGF0aWMgdm9pZCByZW1vdmVfc2Vzc2lvbl9jYihTU0xfQ1RY
ICpjdHggX19hdHRyaWJ1dGVfXygodW51c2VkKSksCisJCQkgICAgICBTU0xfU0VTU0lPTiAqc2Vz
cykKIHsKICAgICBhc3NlcnQoc2Vzcyk7CiAKQEAgLTQ4NCw3ICs0ODMsOCBAQAogICogY2FsbGVk
LCBhbHNvIHdoZW4gc2Vzc2lvbiBjYWNoaW5nIHdhcyBkaXNhYmxlZC4gIFdlIGxvb2t1cCB0aGUK
ICAqIHNlc3Npb24gaW4gb3VyIGRhdGFiYXNlIGluIGNhc2UgaXQgd2FzIHN0b3JlZCBieSBhbm90
aGVyIHByb2Nlc3MuCiAgKi8KLXN0YXRpYyBTU0xfU0VTU0lPTiAqZ2V0X3Nlc3Npb25fY2IoU1NM
ICpzc2wsIHVuc2lnbmVkIGNoYXIgKmlkLCBpbnQgaWRsZW4sCitzdGF0aWMgU1NMX1NFU1NJT04g
KmdldF9zZXNzaW9uX2NiKFNTTCAqc3NsIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAorCQkJCSAg
IHVuc2lnbmVkIGNoYXIgKmlkLCBpbnQgaWRsZW4sCiAJCQkJICAgaW50ICpjb3B5KQogewogICAg
IGludCByZXQ7CkBAIC01NjYsNyArNTY2LDYgQEAKIHsKICAgICBpbnQgICAgIG9mZiA9IDA7CiAg
ICAgaW50ICAgICB2ZXJpZnlfZmxhZ3MgPSBTU0xfVkVSSUZZX05PTkU7Ci0gICAgY2hhciAgICBi
dWZbNTBdOwogICAgIGNvbnN0IGNoYXIgICAqY2lwaGVyX2xpc3Q7CiAgICAgY29uc3QgY2hhciAg
ICpDQXBhdGg7CiAgICAgY29uc3QgY2hhciAgICpDQWZpbGU7CkBAIC02MTgsNyArNjE3LDcgQEAK
IAkJCQkgICBTU0xfU0VTU19DQUNIRV9OT19JTlRFUk5BTF9MT09LVVApOwogCiAgICAgLyogR2V0
IHRoZSBzZXNzaW9uIHRpbWVvdXQgZnJvbSB0aGUgY29uZmlnIGZpbGUgKGluIG1pbnV0ZXMpICov
Ci0gICAgdGltZW91dCA9IGNvbmZpZ19nZXRpbnQoInRsc19zZXNzaW9uX3RpbWVvdXQiLCAxNDQw
KTsgLyogMjQgaG91cnMgKi8KKyAgICB0aW1lb3V0ID0gY29uZmlnX2dldGludChJTUFQT1BUX1RM
U19TRVNTSU9OX1RJTUVPVVQpOwogICAgIGlmICh0aW1lb3V0IDwgMCkgdGltZW91dCA9IDA7CiAg
ICAgaWYgKHRpbWVvdXQgPiAxNDQwKSB0aW1lb3V0ID0gMTQ0MDsgLyogMjQgaG91cnMgbWF4ICov
CiAKQEAgLTY0NCw4ICs2NDMsNyBAQAogCXIgPSBEQi0+aW5pdChkYmRpciwgMCk7CiAKIAlpZiAo
ciAhPSAwKQotCSAgICBzeXNsb2coTE9HX0VSUiwgIkRCRVJST1I6IGluaXQgJXM6ICVzIiwgYnVm
LAotCQkgICBjeXJ1c2RiX3N0cmVycm9yKHIpKTsKKwkgICAgc3lzbG9nKExPR19FUlIsICJEQkVS
Uk9SOiBpbml0OiAlcyIsIGN5cnVzZGJfc3RyZXJyb3IocikpOwogCWVsc2UgewogCSAgICAvKiBj
cmVhdGUgdGhlIG5hbWUgb2YgdGhlIGRiIGZpbGUgKi8KIAkgICAgc3RyY3B5KGRiZGlyLCBjb25m
aWdfZGlyKTsKQEAgLTY2MSwxNSArNjU5LDE1IEBACiAJfQogICAgIH0KIAotICAgIGNpcGhlcl9s
aXN0ID0gY29uZmlnX2dldHN0cmluZygidGxzX2NpcGhlcl9saXN0IiwgIkRFRkFVTFQiKTsKKyAg
ICBjaXBoZXJfbGlzdCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9UTFNfQ0lQSEVSX0xJU1Qp
OwogICAgIGlmICghU1NMX0NUWF9zZXRfY2lwaGVyX2xpc3QoY3R4LCBjaXBoZXJfbGlzdCkpIHsK
IAlzeXNsb2coTE9HX0VSUiwiVExTIGVuZ2luZTogY2Fubm90IGxvYWQgY2lwaGVyIGxpc3QgJyVz
JyIsCiAJICAgICAgIGNpcGhlcl9saXN0KTsKIAlyZXR1cm4gKC0xKTsKICAgICB9CiAKLSAgICBD
QWZpbGUgPSBjb25maWdfZ2V0c3RyaW5nKCJ0bHNfY2FfZmlsZSIsIE5VTEwpOwotICAgIENBcGF0
aCA9IGNvbmZpZ19nZXRzdHJpbmcoInRsc19jYV9wYXRoIiwgTlVMTCk7CisgICAgQ0FmaWxlID0g
Y29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1RMU19DQV9GSUxFKTsKKyAgICBDQXBhdGggPSBjb25m
aWdfZ2V0c3RyaW5nKElNQVBPUFRfVExTX0NBX1BBVEgpOwogCiAgICAgaWYgKCghU1NMX0NUWF9s
b2FkX3ZlcmlmeV9sb2NhdGlvbnMoY3R4LCBDQWZpbGUsIENBcGF0aCkpIHx8CiAJKCFTU0xfQ1RY
X3NldF9kZWZhdWx0X3ZlcmlmeV9wYXRocyhjdHgpKSkgewpAQCAtNjc3LDEzICs2NzUsOCBAQAog
CXN5c2xvZyhMT0dfTk9USUNFLCJUTFMgZW5naW5lOiBjYW5ub3QgbG9hZCBDQSBkYXRhIik7CQog
ICAgIH0KIAotICAgIHNwcmludGYoYnVmLCAidGxzXyVzX2NlcnRfZmlsZSIsIGlkZW50KTsKLSAg
ICBzX2NlcnRfZmlsZSA9IGNvbmZpZ19nZXRzdHJpbmcoYnVmLAotCQkJCSAgIGNvbmZpZ19nZXRz
dHJpbmcoInRsc19jZXJ0X2ZpbGUiLCBOVUxMKSk7Ci0KLSAgICBzcHJpbnRmKGJ1ZiwgInRsc18l
c19rZXlfZmlsZSIsIGlkZW50KTsKLSAgICBzX2tleV9maWxlID0gY29uZmlnX2dldHN0cmluZyhi
dWYsCi0JCQkJICBjb25maWdfZ2V0c3RyaW5nKCJ0bHNfa2V5X2ZpbGUiLCBOVUxMKSk7CisgICAg
c19jZXJ0X2ZpbGUgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfVExTX0NFUlRfRklMRSk7Cisg
ICAgc19rZXlfZmlsZSA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9UTFNfS0VZX0ZJTEUpOwog
CiAgICAgaWYgKCFzZXRfY2VydF9zdHVmZihjdHgsIHNfY2VydF9maWxlLCBzX2tleV9maWxlKSkg
ewogCXN5c2xvZyhMT0dfRVJSLCJUTFMgZW5naW5lOiBjYW5ub3QgbG9hZCBjZXJ0L2tleSBkYXRh
Iik7CkBAIC02OTUsOSArNjg4LDcgQEAKICAgICBpZiAoYXNrY2VydCE9MCkKIAl2ZXJpZnlfZmxh
Z3MgfD0gU1NMX1ZFUklGWV9QRUVSIHwgU1NMX1ZFUklGWV9DTElFTlRfT05DRTsKIAotICAgIHNw
cmludGYoYnVmLCAidGxzXyVzX3JlcXVpcmVfY2VydCIsIGlkZW50KTsKLSAgICByZXF1aXJlY2Vy
dCA9IGNvbmZpZ19nZXRzd2l0Y2goYnVmLAotCQkJCSAgIGNvbmZpZ19nZXRzd2l0Y2goInRsc19y
ZXF1aXJlX2NlcnQiLCAwKSk7CisgICAgcmVxdWlyZWNlcnQgPSBjb25maWdfZ2V0c3dpdGNoKElN
QVBPUFRfVExTX1JFUVVJUkVfQ0VSVCk7CiAgICAgaWYgKHJlcXVpcmVjZXJ0KQogCXZlcmlmeV9m
bGFncyB8PSBTU0xfVkVSSUZZX1BFRVIgfCBTU0xfVkVSSUZZX0ZBSUxfSUZfTk9fUEVFUl9DRVJU
CiAJICAgIHwgU1NMX1ZFUklGWV9DTElFTlRfT05DRTsKQEAgLTEwNjEsNyArMTA1Miw3IEBACiAK
ICNlbHNlCiAKLWludCB0bHNfZW5hYmxlZChjb25zdCBjaGFyICppZGVudCkKK2ludCB0bHNfZW5h
YmxlZCh2b2lkKQogewogICAgIHJldHVybiAwOwogfQpJbmRleDogaW1hcC90bHMuaAo9PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2lt
YXAvdGxzLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTUKZGlmZiAtdSAtcjEuMTUgdGxzLmgK
LS0tIHRscy5oCTIwMDIvMDYvMDIgMTU6MjU6NDMJMS4xNQorKysgdGxzLmgJMjAwMi8wNi8xOCAy
MDoxMToyNApAQCAtNDksNyArNDksNyBAQAogI2RlZmluZSBJTkNMVURFRF9UTFNfSAogCiAvKiBp
cyB0bHMgZW5hYmxlZD8gKi8KLWludCB0bHNfZW5hYmxlZChjb25zdCBjaGFyICppZGVudCk7Citp
bnQgdGxzX2VuYWJsZWQodm9pZCk7CiAKIC8qIG5hbWUgb2YgdGhlIFNTTC9UTFMgc2Vzc2lvbnMg
ZGF0YWJhc2UgKi8KICNkZWZpbmUgRk5BTUVfVExTU0VTU0lPTlMgIi90bHNfc2Vzc2lvbnMuZGIi
CkluZGV4OiBpbWFwL3VzZXIuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUu
ZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvdXNlci5jLHYKcmV0cmlldmluZyByZXZpc2lv
biAxLjEwCmRpZmYgLXUgLXIxLjEwIHVzZXIuYwotLS0gdXNlci5jCTIwMDIvMDUvMjMgMjE6MTI6
MzkJMS4xMAorKysgdXNlci5jCTIwMDIvMDYvMTggMjA6Mzk6MDQKQEAgLTEyMSwxMCArMTIxLDEw
IEBACiAgICAgc3RydWN0IGRpcmVudCAqbmV4dCA9IE5VTEw7CiAgICAgCiAgICAgLyogb2ggd2Vs
bCAqLwotICAgIGlmKGNvbmZpZ19nZXRzd2l0Y2goInNpZXZldXNlaG9tZWRpciIsIDApKSByZXR1
cm4gMDsKKyAgICBpZihjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfU0lFVkVVU0VIT01FRElSKSkg
cmV0dXJuIDA7CiAgICAgCiAgICAgc25wcmludGYoc2lldmVfcGF0aCwgc2l6ZW9mKHNpZXZlX3Bh
dGgpLCAiJXMvJWMvJXMiLAotCSAgICAgY29uZmlnX2dldHN0cmluZygic2lldmVkaXIiLCAiL3Vz
ci9zaWV2ZSIpLAorCSAgICAgY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NJRVZFRElSKSwKIAkg
ICAgIHVzZXJbMF0sIHVzZXIpOwogICAgIG1iZGlyPW9wZW5kaXIoc2lldmVfcGF0aCk7CiAKSW5k
ZXg6IG1hbi8uY3ZzaWdub3JlCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5l
ZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvbWFuLy5jdnNpZ25vcmUsdgpyZXRyaWV2aW5nIHJldmlz
aW9uIDEuMQpkaWZmIC11IC1yMS4xIC5jdnNpZ25vcmUKLS0tIC5jdnNpZ25vcmUJMjAwMi8wMS8w
NiAwMjowMzozMQkxLjEKKysrIC5jdnNpZ25vcmUJMjAwMi8wNi8xOSAwMDo1NTo1MwpAQCAtMSwy
ICsxLDMgQEAKIE1ha2VmaWxlCiBzaWV2ZXNoZWxsLjEKK2ltYXBkLmNvbmYuNQpJbmRleDogbWFu
L01ha2VmaWxlLmluCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lz
dGVtL2N2cy9zcmMvY3lydXMvbWFuL01ha2VmaWxlLmluLHYKcmV0cmlldmluZyByZXZpc2lvbiAx
LjI1CmRpZmYgLXUgLXIxLjI1IE1ha2VmaWxlLmluCi0tLSBNYWtlZmlsZS5pbgkyMDAyLzA1LzI1
IDE5OjU3OjQ3CTEuMjUKKysrIE1ha2VmaWxlLmluCTIwMDIvMDYvMTcgMjA6MDI6NTcKQEAgLTgy
LDYgKzgyLDkgQEAKIAlAZWNobyBjcmVhdGluZyBzaWV2ZXNoZWxsLjEKIAlwb2QybWFuICQoc3Jj
ZGlyKS8uLi9wZXJsL3NpZXZlL3NjcmlwdHMvc2lldmVzaGVsbC5wbCA+ICQoc3JjZGlyKS9zaWV2
ZXNoZWxsLjEKIAoraW1hcGQuY29uZi41OiAkKHNyY2RpcikvLi4vaW1hcC9pbWFwb3B0aW9ucyAk
KHNyY2RpcikvLi4vdG9vbHMvY29uZmlnMmhlYWRlcgorCSQoc3JjZGlyKS8uLi90b29scy9jb25m
aWcybWFuICQoc3JjZGlyKS8uLi9pbWFwL2ltYXBvcHRpb25zID4gaW1hcGQuY29uZi41CisKIGlu
c3RhbGw6CiAJZm9yIGZpbGUgaW4gJChNQU4xKTsgXAogCWRvIFwKSW5kZXg6IG1hbi9pbWFwZC5j
b25mLjUKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogaW1hcGQuY29uZi41CmRpZmYgLU4gaW1hcGQuY29u
Zi41Ci0tLSAvdG1wL2N2czQxZE40MglUaHUgSnVuIDIwIDEzOjU1OjEyIDIwMDIKKysrIC9kZXYv
bnVsbAlUdWUgTWF5ICA1IDE2OjMyOjI3IDE5OTgKQEAgLTEsMzYyICswLDAgQEAKLS5cIiAtKi0g
bnJvZmYgLSotCi0uVEggSU1BUEQuQ09ORiA1ICJQcm9qZWN0IEN5cnVzIiBDTVUKLS5cIiAKLS5c
IiBDb3B5cmlnaHQgKGMpIDE5OTgtMjAwMCBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eS4gIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCi0uXCIKLS5cIiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNv
dXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQKLS5cIiBtb2RpZmljYXRpb24s
IGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKLS5c
IiBhcmUgbWV0OgotLlwiCi0uXCIgMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11
c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQKLS5cIiAgICBub3RpY2UsIHRoaXMgbGlzdCBv
ZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuIAotLlwiCi0uXCIgMi4g
UmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBj
b3B5cmlnaHQKLS5cIiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUg
Zm9sbG93aW5nIGRpc2NsYWltZXIgaW4KLS5cIiAgICB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3Ig
b3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlCi0uXCIgICAgZGlzdHJpYnV0aW9uLgot
LlwiCi0uXCIgMy4gVGhlIG5hbWUgIkNhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5IiBtdXN0IG5v
dCBiZSB1c2VkIHRvCi0uXCIgICAgZW5kb3JzZSBvciBwcm9tb3RlIHByb2R1Y3RzIGRlcml2ZWQg
ZnJvbSB0aGlzIHNvZnR3YXJlIHdpdGhvdXQKLS5cIiAgICBwcmlvciB3cml0dGVuIHBlcm1pc3Np
b24uIEZvciBwZXJtaXNzaW9uIG9yIGFueSBvdGhlciBsZWdhbAotLlwiICAgIGRldGFpbHMsIHBs
ZWFzZSBjb250YWN0ICAKLS5cIiAgICAgIE9mZmljZSBvZiBUZWNobm9sb2d5IFRyYW5zZmVyCi0u
XCIgICAgICBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eQotLlwiICAgICAgNTAwMCBGb3JiZXMg
QXZlbnVlCi0uXCIgICAgICBQaXR0c2J1cmdoLCBQQSAgMTUyMTMtMzg5MAotLlwiICAgICAgKDQx
MikgMjY4LTQzODcsIGZheDogKDQxMikgMjY4LTczOTUKLS5cIiAgICAgIHRlY2gtdHJhbnNmZXJA
YW5kcmV3LmNtdS5lZHUKLS5cIgotLlwiIDQuIFJlZGlzdHJpYnV0aW9ucyBvZiBhbnkgZm9ybSB3
aGF0c29ldmVyIG11c3QgcmV0YWluIHRoZSBmb2xsb3dpbmcKLS5cIiAgICBhY2tub3dsZWRnbWVu
dDoKLS5cIiAgICAiVGhpcyBwcm9kdWN0IGluY2x1ZGVzIHNvZnR3YXJlIGRldmVsb3BlZCBieSBD
b21wdXRpbmcgU2VydmljZXMKLS5cIiAgICAgYXQgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkg
KGh0dHA6Ly93d3cuY211LmVkdS9jb21wdXRpbmcvKS4iCi0uXCIKLS5cIiBDQVJORUdJRSBNRUxM
T04gVU5JVkVSU0lUWSBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSCBSRUdBUkQgVE8KLS5c
IiBUSElTIFNPRlRXQVJFLCBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJD
SEFOVEFCSUxJVFkKLS5cIiBBTkQgRklUTkVTUywgSU4gTk8gRVZFTlQgU0hBTEwgQ0FSTkVHSUUg
TUVMTE9OIFVOSVZFUlNJVFkgQkUgTElBQkxFCi0uXCIgRk9SIEFOWSBTUEVDSUFMLCBJTkRJUkVD
VCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMKLS5cIiBXSEFUU09FVkVS
IFJFU1VMVElORyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4K
LS5cIiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1IgT1RIRVIgVE9SVElPVVMg
QUNUSU9OLCBBUklTSU5HCi0uXCIgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNF
IE9SIFBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuCi0uXCIgCi0uXCIgJElkOiBpbWFwZC5j
b25mLjUsdiAxLjY1IDIwMDIvMDYvMTIgMTc6Mzg6NTggcmpzMyBFeHAgJAotCi0uU0ggTkFNRQot
aW1hcGQuY29uZiBcLSBJTUFQIGNvbmZpZ3VyYXRpb24gZmlsZQotLlNIIERFU0NSSVBUSU9OCi1c
ZkIvZXRjL2ltYXBkLmNvbmZcZlIgCi1pcyB0aGUgY29uZmlndXJhdGlvbiBmaWxlIGZvciB0aGUg
Q3lydXMgSU1BUCBzZXJ2ZXIuICBJdCBkZWZpbmVzCi1sb2NhbCBwYXJhbWV0ZXJzIGZvciBJTUFQ
LiAKLS5QUAotRWFjaCBsaW5lIG9mIHRoZSBcZkIvZXRjL2ltYXBkLmNvbmZcZlIgZmlsZSBoYXMg
dGhlIGZvcm0KLS5JUAotXGZJb3B0aW9uXGZSOiBcZkl2YWx1ZVxmUgotLlBQCi13aGVyZSBcZklv
cHRpb25cZlIgaXMgdGhlIG5hbWUgb2YgdGhlIGNvbmZpZ3VyYXRpb24gb3B0aW9uIGJlaW5nIHNl
dAotYW5kIFxmSXZhbHVlXGZSIGlzIHRoZSB2YWx1ZSB0aGF0IHRoZSBjb25maWd1cmF0aW9uIG9w
dGlvbiBpcyBiZWluZwotc2V0IHRvLgotLlBQCi1CbGFuayBsaW5lcyBhbmQgbGluZXMgYmVnaW5u
aW5nIHdpdGggYGAjJycgYXJlIGlnbm9yZWQuCi0uUFAKLUZvciBib29sZWFuIG9wdGlvbnMsIHRo
ZSB2YWx1ZXMgYGB5ZXMnJywgYGBvbicnLCBgYHQnJywgYW5kIGBgMScnIHR1cm4gdGhlCi1vcHRp
b24gb24sIHRoZSB2YWx1ZXMgYGBubycnLCBgYG9mZicnLCBgYGYnJywgYW5kIGBgMCcnIHR1cm4g
dGhlIG9wdGlvbiBvZmYuCi0uU0ggRklFTEQgREVTQ1JJUFRJT05TCi0uUFAKLVRoZSBzZWN0aW9u
cyBiZWxvdyBkZXRhaWwgb3B0aW9ucyB0aGF0IGNhbiBiZSBwbGFjZWQgaW4gdGhlCi1cZkIvZXRj
L2ltYXBkLmNvbmZcZlIgZmlsZSwgYW5kIHNob3cgZWFjaCBvcHRpb24ncyBkZWZhdWx0IHZhbHVl
LgotU29tZSBvcHRpb25zIGhhdmUgbm8gZGVmYXVsdCB2YWx1ZSwgdGhlc2UgYXJlIGxpc3RlZCB3
aXRoCi1gYDxubyBkZWZhdWx0PicnLiAgU29tZSBvcHRpb25zIGRlZmF1bHQgdG8gdGhlIGVtcHR5
IHN0cmluZywgdGhlc2UKLWFyZSBsaXN0ZWQgd2l0aCBgYDxub25lPicnLgotLklQICJcZkJjb25m
aWdkaXJlY3Rvcnk6XGZSIDxubyBkZWZhdWx0PiIgNQotVGhlIHBhdGhuYW1lIG9mIHRoZSBJTUFQ
IGNvbmZpZ3VyYXRpb24gZGlyZWN0b3J5LiAgVGhpcyBmaWVsZCBpcyByZXF1aXJlZC4KLS5JUCAi
XGZCZGVmYXVsdHBhcnRpdGlvbjpcZlIgZGVmYXVsdCIgNQotVGhlIHBhcnRpdGlvbiBuYW1lIHVz
ZWQgYnkgZGVmYXVsdCBmb3IgbmV3IG1haWxib3hlcy4KLS5JUCAiXGZCcGFydGl0aW9uLVxmSW5h
bWVcZkI6XGZSIDxubyBkZWZhdWx0PiIgNQotVGhlIHBhdGhuYW1lIG9mIHRoZSBwYXJ0aXRpb24g
XGZJbmFtZVxmUi4gIEF0IGxlYXN0IG9uZSBmaWVsZCwgZm9yIHRoZQotcGFydGl0aW9uIG5hbWVk
IGluIHRoZSBcZkJkZWZhdWx0cGFydGl0aW9uXGZSIG9wdGlvbiwgaXMgcmVxdWlyZWQuCi1Gb3Ig
ZXhhbXBsZSwgaWYgdGhlIHZhbHVlIG9mIHRoZSBcZkJkZWZhdWx0cGFydGlvblxmUiBvcHRpb24g
aXMKLVxmQmRlZmF1bHRcZlIsIHRoZW4gdGhlIFxmQnBhcnRpdGlvbi1kZWZhdWx0XGZSIGZpZWxk
IGlzIHJlcXVpcmVkLgotLklQICJcZkJ1bml4aGllcmFyY2h5c2VwOlxmUiBubyIgNQotVXNlIHRo
ZSBVTklYIHNlcGFyYXRvciBjaGFyYWN0ZXIgJy8nIGZvciBkZWxpbWl0aW5nIGxldmVscyBvZiBt
YWlsYm94Ci1oaWVyYXJjaHkuICBUaGUgZGVmYXVsdCBpcyB0byB1c2UgdGhlIG5ldG5ld3Mgc2Vw
YXJhdG9yIGNoYXJhY3RlciAnLicuIAotLklQICJcZkJhbHRuYW1lc3BhY2U6XGZSIG5vIiA1Ci1V
c2UgdGhlIGFsdGVybmF0ZSBJTUFQIG5hbWVzcGFjZSwgd2hlcmUgcGVyc29uYWwgZm9sZGVycyBy
ZXNpZGUgYXQgdGhlCi1zYW1lIGxldmVsIGluIHRoZSBoaWVyYXJjaHkgYXMgSU5CT1guCi0uYnIK
LS5zcAotVGhpcyBvcHRpb24gT05MWSBhcHBsaWVzIHdoZXJlIGludGVyYWN0aW9uIHRha2VzIHBs
YWNlIHdpdGggdGhlCi1jbGllbnQvdXNlci4gIEN1cnJlbnRseSB0aGlzIGlzIGxpbWl0ZWQgdG8g
dGhlIElNQVAgcHJvdG9jb2wgKGltYXBkKQotYW5kIFNpZXZlIHNjcmlwdHMgKGxtdHBkKS4gIFRo
aXMgb3B0aW9uIGRvZXMgTk9UIGFwcGx5IHRvIGFkbWluIHRvb2xzCi1zdWNoIGFzIGN5cmFkbSAo
YWRtaW5zIE9OTFkpLCByZWNvbnN0cnVjdCwgcXVvdGEsIGV0Yy4sIE5PUiBkb2VzIGl0Ci1hZmZl
Y3QgTE1UUCBkZWxpdmVyeSBvZiBtZXNzYWdlcyBkaXJlY3RseSB0byBtYWlsYm94ZXMgdmlhIHBs
dXMtYWRkcmVzc2luZy4KLS5JUCAiXGZCdXNlcnByZWZpeDpcZlIgT3RoZXIgVXNlcnMiIDUKLUlm
IHVzaW5nIHRoZSBhbHRlcm5hdGUgSU1BUCBuYW1lc3BhY2UsIHRoZSBwcmVmaXggZm9yIHRoZSBv
dGhlciB1c2VycwotbmFtZXNwYWNlLiAgVGhlIGhpZXJhcmNoeSBkZWxpbWl0ZXIgd2lsbCBiZSBh
dXRvbWF0aWNhbGx5IGFwcGVuZGVkLgotLklQICJcZkJzaGFyZWRwcmVmaXg6XGZSIFNoYXJlZCBG
b2xkZXJzIiA1Ci1JZiB1c2luZyB0aGUgYWx0ZXJuYXRlIElNQVAgbmFtZXNwYWNlLCB0aGUgcHJl
Zml4IGZvciB0aGUgc2hhcmVkCi1uYW1lc3BhY2UuICBUaGUgaGllcmFyY2h5IGRlbGltaXRlciB3
aWxsIGJlIGF1dG9tYXRpY2FsbHkgYXBwZW5kZWQuCi0uSVAgIlxmQnVtYXNrOlxmUiAwNzciIDUK
LVRoZSB1bWFzayB2YWx1ZSB1c2VkIGJ5IHZhcmlvdXMgQ3lydXMgSU1BUCBwcm9ncmFtcy4KLS5J
UCAiXGZCc2VydmVybmFtZTpcZlIgPHJlc3VsdCByZXR1cm5lZCBieSBnZXRob3N0bmFtZSgyKT4i
IDUKLVRoaXMgaXMgdGhlIGhvc3RuYW1lIHZpc2libGUgaW4gdGhlIGdyZWV0aW5nIG1lc3NhZ2Vz
IG9mIHRoZSBQT1AsIElNQVAgYW5kIExNVFAKLWRhZW1vbnMuIElmIGl0IGlzIHVuc2V0LCB0aGVu
IHRoZSByZXN1bHQgcmV0dXJuZWQgZnJvbSBnZXRob3N0bmFtZSgyKSBpcyB1c2VkLgotLklQICJc
ZkJhbGxvd2Fub255bW91c2xvZ2luOlxmUiBubyIgNQotUGVybWl0IGxvZ2lucyBieSB0aGUgdXNl
ciAiYW5vbnltb3VzIiB1c2luZyBhbnkgcGFzc3dvcmQuICBBbHNvIGFsbG93cwotdXNlIG9mIHRo
ZSBTQVNMIEFOT05ZTU9VUyBtZWNoYW5pc20uCi0uSVAgIlxmQmFsbG93cGxhaW50ZXh0OlxmUiB5
ZXMiIDUKLUFsbG93IHRoZSB1c2Ugb2YgdGhlIFNBU0wgUExBSU4gbWVjaGFuaXNtLgotLklQICJc
ZkJxdW90YXdhcm46XGZSIDkwIiA1Ci1UaGUgcGVyY2VudCBvZiBxdW90YSB1dGlsaXphdGlvbiBv
dmVyIHdoaWNoIHRoZSBzZXJ2ZXIgZ2VuZXJhdGVzCi13YXJuaW5ncy4KLS5JUCAiXGZCdGltZW91
dDpcZlIgMzAiIDUKLVRoZSBsZW5ndGggb2YgdGhlIElNQVAgc2VydmVyJ3MgaW5hY3Rpdml0eSBh
dXRvbG9nb3V0IHRpbWVyLAotaW4gbWludXRlcy4gIFRoZSBtaW5pbXVtIHZhbHVlIGlzIDMwLCB0
aGUgZGVmYXVsdC4KLS5JUCAiXGZCaW1hcGlkbGVwb2xsOlxmUiA2MCIgNQotVGhlIGludGVydmFs
IChpbiBzZWNvbmRzKSBmb3IgcG9sbGluZyB0aGUgbWFpbGJveCBmb3IgY2hhbmdlcyB3aGlsZQot
cnVubmluZyB0aGUgSURMRSBjb21tYW5kLiAgVGhpcyBvcHRpb24gaXMgdXNlZCB3aGVuIGlkbGVk
IGNhbiBub3QgYmUKLWNvbnRhY3RlZCBvciB3aGVuIHBvbGxpbmcgaXMgdXNlZCBleGNsdXNpdmVs
eS4gIFRoZSBtaW5pbXVtIHZhbHVlIGlzCi0xLiAgQSB2YWx1ZSBvZiAwIHdpbGwgZGlzYWJsZSBw
b2xsaW5nIChhbmQgZGlzYWJsZSBJRExFIGlmIHBvbGxpbmcgaXMKLXRoZSBvbmx5IG1ldGhvZCBh
dmFpbGFibGUpLgotLklQICJcZkJpbWFwaWRyZXNwb25zZTpcZlIgeWVzIiA1Ci1JZiBlbmFibGVk
LCB0aGUgc2VydmVyIHJlc3BvbmRzIHRvIGFuIElEIGNvbW1hbmQgd2l0aCBhIHBhcmFtZXRlcgot
bGlzdCBjb250YWluaW5nOiB2ZXJzaW9uLCB2ZW5kb3IsIHN1cHBvcnQtdXJsLCBvcywgb3MtdmVy
c2lvbiwKLWNvbW1hbmQsIGFyZ3VtZW50cywgZW52aXJvbm1lbnQuICBPdGhlcndpc2UgdGhlIHNl
cnZlciByZXR1cm5zIE5JTC4KLS5JUCAiXGZCcG9wdGltZW91dDpcZlIgMTAiIDUKLVNldCB0aGUg
bGVuZ3RoIG9mIHRoZSBQT1Agc2VydmVyJ3MgaW5hY3Rpdml0eSBhdXRvbG9nb3V0IHRpbWVyLAot
aW4gbWludXRlcy4gIFRoZSBtaW5pbXVtIHZhbHVlIGlzIDEwLCB0aGUgZGVmYXVsdC4KLS5JUCAi
XGZCcG9wbWlucG9sbDpcZlIgMCIgNQotU2V0IHRoZSBtaW5pbXVtIGFtb3VudCBvZiB0aW1lIHRo
ZSBzZXJ2ZXIgZm9yY2VzIHVzZXJzIHRvIHdhaXQgYmV0d2Vlbgotc3VjY2Vzc2l2ZSBQT1AgbG9n
aW5zLAotaW4gbWludXRlcy4gIFRoZSBkZWZhdWx0IGlzIDAuCi0uSVAgIlxmQnBvcGV4cGlyZXRp
bWU6XGZSIDAiIDUKLVRoZSBudW1iZXIgb2YgZGF5cyBhZHZlcnRpc2VkIGFzIGJlaW5nIHRoZSBt
aW5pbXVtIGEgbWVzc2FnZSBtYXkgYmUgbGVmdCBvbgotdGhlIFBPUCBzZXJ2ZXIgYmVmb3JlIGl0
IGlzIGRlbGV0ZWQgKHZpYSB0aGUgQ0FQQSBjb21tYW5kLCBkZWZpbmVkIGluIHRoZSBQT1AzCi1F
eHRlbnNpb24gTWVjaGFuaXNtLCB3aGljaCBzb21lIGNsaWVudHMgbWF5IHN1cHBvcnQpLiAgIk5F
VkVSIiwgdGhlIGRlZmF1bHQsCi1tYXkgYmUgc3BlY2lmaWVkIHdpdGggYSBuZWdhdGl2ZSBudW1i
ZXIuICBUaGUgQ3lydXMgUE9QMyBzZXJ2ZXIgbmV2ZXIgZGVsZXRlcwotbWFpbCwgbm8gbWF0dGVy
IHdoYXQgdGhlIHZhbHVlIG9mIHRoaXMgcGFyYW1ldGVyIGlzLiAgSG93ZXZlciwgaWYgYSBzaXRl
Ci1pbXBsZW1lbnRzIGEgbGVzcyBsaWJlcmFsIHBvbGljeSwgaXQgbmVlZHMgdG8gY2hhbmdlIHRo
aXMgcGFyYW1ldGVyCi1hY2NvcmRpbmdseS4KLS5JUCAiXGZCYWRtaW5zOlxmUiA8bm9uZT4iIDUK
LVRoZSBsaXN0IG9mIHVzZXJpZHMgd2l0aCBhZG1pbmlzdHJhdGl2ZSByaWdodHMuICBTZXBhcmF0
ZSBlYWNoIHVzZXJpZAotd2l0aCBhIHNwYWNlLiAgU2l0ZXMgdXNpbmcgS2VyYmVyb3MgYXV0aGVu
dGljYXRpb24gbWF5IHVzZQotc2VwYXJhdGUgImFkbWluIiBpbnN0YW5jZXMuCi0uUFAKLU5vdGUg
dGhhdCBhY2NvdW50cyB1c2VkIGJ5IHVzZXJzIHNob3VsZCBub3QgYmUgYWRtaW5pc3RyYXRvcnMu
ICBBZG1pbmlzdHJhdGl2ZSAKLWFjY291bnRzIHNob3VsZCBub3QgcmVjZWl2ZSBtYWlsLiAgVGhh
dCBpcywgaWYgdXNlciAiamJSbyIgaXMgYSB1c2VyIHJlYWRpbmcKLW1haWwsIGhlIHNob3VsZCBu
b3QgYWxzbyBiZSBpbiB0aGUgYWRtaW5zIGxpbmUuICBTb21lIHByb2JsZW1zIG1heSBvY2N1cgot
b3RoZXJ3aXNlLCBtb3N0IG5vdGFibHkgIHRoZSBhYmlsaXR5IG9mIGFkbWluaXN0cmF0b3JzIHRv
IGNyZWF0ZSB0b3AtbGV2ZWwKLW1haWxib3hlcyB2aXNpYmxlIHRvIHVzZXJzLCBidXQgbm90IHdy
aXRhYmxlIGJ5IHVzZXJzLgotLklQICJcZkJwcm94eXNlcnZlcnM6XGZSIDxub25lPiIgNQotQSBs
aXN0IG9mIHVzZXJzIGFuZCBncm91cHMgdGhhdCBhcmUgYWxsb3dlZCB0byBwcm94eSBmb3Igb3Ro
ZXIgdXNlcnMsCi1zZXBlcmF0ZWQgYnkgc3BhY2VzLiAgQW55IHVzZXIgbGlzdGVkIGluIHRoaXMg
d2lsbCBiZSBhbGxvd2VkIHRvIGxvZ2luCi1mb3IgYW55IG90aGVyIHVzZXI6IHVzZSB3aXRoIGNh
dXRpb24uCi0uSVAgIlxmQmRlZmF1bHRhY2w6XGZSIGFueW9uZSBscnMiIDUKLVRoZSBBY2Nlc3Mg
Q29udHJvbCBMaXN0IChBQ0wpIHBsYWNlZCBvbiBhIG5ld2x5LWNyZWF0ZWQgKG5vbi11c2VyKSAK
LW1haWxib3ggdGhhdCBkb2VzIG5vdCBoYXZlIGEgcGFyZW50IG1haWxib3guCi0uSVAgIlxmQm5l
d3NzcG9vbFxmQjpcZlIgPG5vIGRlZmF1bHQ+IiA1Ci1UaGUgcGF0aG5hbWUgb2YgdGhlIG5ld3Mg
c3Bvb2wgZGlyZWN0b3J5LiAgT25seSB1c2VkIGlmIHRoZQotXGZCcGFydGl0aW9uLW5ld3NcZlIg
Y29uZmlndXJhdGlvbiBvcHRpb24gaXMgc2V0LgotLklQICJcZkJuZXdzcHJlZml4OlxmUiA8bm9u
ZT4iIDUKLVByZWZpeCB0byBiZSBwcmVwZW5kZWQgdG8gbmV3c2dyb3VwIG5hbWVzIHRvIG1ha2Ug
dGhlIGNvcnJlc3BvbmRpbmcKLUlNQVAgbWFpbGJveCBuYW1lcy4KLS5JUCAiXGZCYXV0b2NyZWF0
ZXF1b3RhOlxmUiAwIiA1Ci1JZiBub256ZXJvLCBub3JtYWwgdXNlcnMgbWF5IGNyZWF0ZSB0aGVp
ciBvd24gSU1BUCBhY2NvdW50cyBieQotY3JlYXRpbmcgdGhlIG1haWxib3ggSU5CT1guICBUaGUg
dXNlcidzIHF1b3RhIGlzIHNldCB0byB0aGUgdmFsdWUgaWYKLWl0IGlzIHBvc2l0aXZlLCBvdGhl
cndpc2UgdGhlIHVzZXIgaGFzIHVubGltaXRlZCBxdW90YS4KLS5JUCAiXGZCbG9ndGltZXN0YW1w
czpcZlIgbm8iIDUKLUluY2x1ZGUgbm90YXRpb25zIGluIHRoZSBwcm90b2NvbCB0ZWxlbWV0cnkg
bG9ncyBpbmRpY2F0aW5nIHRoZSBudW1iZXIgb2YKLXNlY29uZHMgc2luY2UgdGhlIGxhc3QgY29t
bWFuZCBvciByZXNwb25zZS4KLS5JUCAiXGZCcGxhaW50ZXh0bG9naW5wYXVzZTpcZlIgMCIgNQot
TnVtYmVyIG9mIHNlY29uZHMgdG8gcGF1c2UgYWZ0ZXIgYSBzdWNjZXNzZnVsIHBsYWludGV4dCBs
b2dpbi4gIEZvcgotc3lzdGVtcyB0aGF0IHN1cHBvcnQgc3Ryb25nIGF1dGhlbnRpY2F0aW9uLCB0
aGlzIHBlcm1pdHMgdXNlcnMgdG8KLXBlcmNlaXZlIGEgY29zdCBvZiB1c2luZyBwbGFpbnRleHQg
cGFzc3dvcmRzLiAgKFRoaXMgZG9lcyBub3QgZWZmZWN0Ci10aGUgdXNlIG9mIFBMQUlOIGluIFNB
U0wgYXV0aGVudGljYXRpb25zLikKLS5JUCAiXGZCc3J2dGFiOlxmUiAvZXRjL3NydnRhYiIgNQot
VGhlIHBhdGhuYW1lIG9mIFxmSXNydnRhYlxmUiBmaWxlIGNvbnRhaW5pbmcgdGhlIHNlcnZlcidz
IHByaXZhdGUgCi1rZXkuICBUaGlzIG9wdGlvbiBpcyBwYXNzZWQgdG8gdGhlIFNBU0wgbGlicmFy
eSBhbmQgb3ZlcnJpZGVzIGl0cwotZGVmYXVsdCBzZXR0aW5nLgotLklQICJcZkJsb2dpbnJlYWxt
czpcZlIgPG5vbmU+IiA1Ci1UaGUgbGlzdCBvZiByZW1vdGUgcmVhbG1zIHdob3NlIHVzZXJzIG1h
eSBsb2cgaW4gdXNpbmcgCi1jcm9zcy1yZWFsbSBhdXRoZW50aWNhdGlvbnMuICBTZXBlcmF0ZSBl
YWNoIHJlYWxtIG5hbWUKLWJ5IGEgc3BhY2UuICAoQSBjcm9zcy1yZWFsbSBpZGVudGl0eSBpcyBj
b25zaWRlcmVkIGFueSBpZGVudGl0eQotcmV0dXJuZWQgYnkgU0FTTCB3aXRoIGFuICJAIiBpbiBp
dC4pCi0uSVAgIlxmQmxvZ2ludXNlYWNsOlxmUiBubyIgNQotSWYgZW5hYmxlZCwgYW55IGF1dGhl
bnRpY2F0aW9uIGlkZW50aXR5IHdoaWNoIGhhcyBcZkJhXGZSIHJpZ2h0cyBvbiBhCi11c2VyJ3Mg
SU5CT1ggbWF5IGxvZyBpbiBhcyB0aGF0IHVzZXIuCi0uSVAgIlxmQnNpbmdsZWluc3RhbmNlc3Rv
cmU6XGZSIHllcyIgNQotSWYgZW5hYmxlZCwgbG10cGQgYXR0ZW1wdHMgdG8gb25seSB3cml0ZSBv
bmUgY29weSBvZiBhIG1lc3NhZ2UgcGVyCi1wYXJ0aXRpb24gYW5kIGNyZWF0ZSBoYXJkIGxpbmtz
LCByZXN1bHRpbmcgaW4gYSBwb3RlbnRpYWxseSBsYXJnZSBkaXNrCi1zYXZpbmdzLgotLklQICJc
ZkJkdXBsaWNhdGVzdXBwcmVzc2lvbjpcZlIgeWVzIiA1Ci1JZiBlbmFibGVkLCBsbXRwZCB3aWxs
IHN1cHByZXNzIGRlbGl2ZXJ5IG9mIGEgbWVzc2FnZSB0byBhIG1haWxib3ggaWYKLWEgbWVzc2Fn
ZSB3aXRoIHRoZSBzYW1lIG1lc3NhZ2UtaWQgKG9yIHJlc2VudC1tZXNzYWdlLWlkKSBpcyByZWNv
cmRlZAotYXMgaGF2aW5nIGFscmVhZHkgYmVlbiBkZWxpdmVyZWQgdG8gdGhlIG1haWxib3guICBS
ZWNvcmRzIHRoZSBtYWlsYm94Ci1hbmQgbWVzc2FnZS1pZC9yZXNlbnQtbWVzc2FnZS1pZCBvZiBh
bGwgc3VjY2Vzc2Z1bCBkZWxpdmVyaWVzLgotLklQICJcZkJyZWplY3Q4Yml0OlxmUiBubyIgNQot
SWYgZW5hYmxlZCwgbG10cGQgcmVqZWN0cyBtZXNzYWdlcyB3aXRoIDgtYml0IGNoYXJhY3RlcnMg
aW4gdGhlIGhlYWRlcnMuCi1PdGhlcndpc2UsIDgtYml0IGNoYXJhY3RlcnMgYXJlIGNoYW5nZWQg
dG8gYFgnLiAgKEEgcHJvcGVyIHNvdWx0aW9uIHRvCi1ub24tQVNDSUkgY2hhcmFjdGVycyBpbiBo
ZWFkZXJzIGlzIG9mZmVyZWQgYnkgUkZDIDIwNDcgYW5kIGl0cyBwcmVkZWNlc3NvcnMuKQotLklQ
ICJcZkJtYXhtZXNzYWdlc2l6ZTpcZlIgPHVubGltaXRlZD4iIDUKLU1heGltdW0gaW5jb21pbmcg
TE1UUCBtZXNzYWdlIHNpemUuICBJZiBzZXQsIGxtdHBkIHdpbGwKLXJlamVjdCBtZXNzYWdlcyBs
YXJnZXIgdGhhbiBcZkltYXhtZXNzYWdlc2l6ZVxmUiBieXRlcy4gIFRoZSBkZWZhdWx0Ci1pcyB0
byBhbGxvdyBtZXNzYWdlcyBvZiBhbnkgc2l6ZS4KLS5JUCAiXGZCbG10cF9vdmVycXVvdGFfcGVy
bV9mYWlsdXJlOlxmUiBubyIgNQotSWYgZW5hYmxlZCwgbG10cGQgcmV0dXJucyBhIHBlcm1hbmVu
dCBmYWlsdXJlIGNvZGUgd2hlbiBhIHVzZXIncwotbWFpbGJveCBpcyBvdmVyIHF1b3RhLiAgQnkg
ZGVmYXVsdCwgdGhlIGZhaWx1cmUgaXMgdGVtcG9yYXJ5LgotLklQICJcZkJsbXRwX2FsbG93cGxh
aW50ZXh0OlxmUiA8c2V0dGluZyBvZiBcZklhbGxvd3BsYWludGV4dFxmUj4iIDUKLUFsbG93IHRo
ZSB1c2Ugb2YgdGhlIFNBU0wgUExBSU4gbWVjaGFuaXNtIGZvciBMTVRQLgotLklQICJcZkJwb3N0
dXNlcjpcZlIgPG5vbmU+IiA1Ci1Vc2VyaWQgdXNlZCB0byBkZWxpdmVyIG1lc3NhZ2VzIHRvIHNo
YXJlZCBmb2xkZXJzLiAgRm9yIGV4YW1wbGUsIGlmCi1zZXQgdG8gImJiIiwgZW1haWwgc2VudCB0
byAiYmIrc2hhcmVkLmJsYWgiIHdvdWxkIGJlIGRlbGl2ZXJlZCB0byB0aGUKLSJzaGFyZWQuYmxh
aCIgZm9sZGVyLiAgQnkgZGVmYXVsdCwgYW4gZW1haWwgYWRkcmVzcyBvZiAiK3NoYXJlZC5ibGFo
Igotd291bGQgYmUgdXNlZC4KLS5JUCAiXGZCbmV0c2NhcGV1cmw6XGZSIDxubyBkZWZhdWx0PiIg
NQotSWYgZW5hYmxlZCBhdCBjb21waWxlIHRpbWUsIHRoaXMgc3BlY2lmaWVzIGEgVVJMIHRvIHJl
cGx5IHdoZW4KLU5ldHNjYXBlIGFza3MgdGhlIHNlcnZlciB3aGVyZSB0aGUgbWFpbCBhZG1pbmlz
dHJhdGlvbiBIVFRQIHNlcnZlciBpcy4KLUFkbWluaXN0cmF0b3JzIHNob3VsZCBzZXQgdGhpcyB0
byBhIGxvY2FsIHJlc291cmNlIHdpdGggc29tZQotdXNlZnVsIGluZm9ybWF0aW9uIGZvciBlbmQg
dXNlcnMuICBJZiBub3Qgc2V0LCBubyBVUkwgaXMgYWR2ZXJ0aXNlZC4KLS5JUCAiXGZCbWFpbG5v
dGlmaWVyOlxmUiA8bm8gZGVmYXVsdD4iIDUKLU5vdGlmeWQoOCkgbWV0aG9kIHRvIHVzZSBmb3Ig
Ik1BSUwiIG5vdGlmaWNhdGlvbnMuICBJZiBub3Qgc2V0LCAiTUFJTCIKLW5vdGlmaWNhdGlvbnMg
YXJlIGRpc2FibGVkLgotLklQICJcZkJzaWV2ZW5vdGlmaWVyOlxmUiA8bm8gZGVmYXVsdD4iIDUK
LU5vdGlmeWQoOCkgbWV0aG9kIHRvIHVzZSBmb3IgIlNJRVZFIiBub3RpZmljYXRpb25zLiAgSWYg
bm90IHNldCwgIlNJRVZFIgotbm90aWZpY2F0aW9ucyBhcmUgZGlzYWJsZWQuCi0uYnIKLS5zcAot
VGhpcyBtZXRob2QgaXMgb25seSB1c2VkIHdoZW4gbm8gbWV0aG9kIGlzIHNwZWNpZmllZCBpbiB0
aGUgc2NyaXB0LgotLklQICJcZkJzaWV2ZXVzZWhvbWVkaXI6XGZSIGZhbHNlIiA1Ci1JZiBlbmFi
bGVkLCBsbXRwZCB3aWxsIGxvb2sgZm9yIFNpZXZlIHNjcmlwdHMgaW4gdXNlcidzIGhvbWUKLWRp
cmVjdG9yaWVzOiB+dXNlci8uc2lldmUuCi0uSVAgIlxmQnNpZXZlZGlyOlxmUiAvdXNyL3NpZXZl
IiA1Ci1JZiBzaWV2ZXVzZWhvbWVkaXIgaXMgZmFsc2UsIHRoaXMgZGlyZWN0b3J5IGlzIHNlYXJj
aGVkIGZvciBTaWV2ZQotc2NyaXB0cy4KLS5JUCAiXGZCc2VuZG1haWw6XGZSIC91c3IvbGliL3Nl
bmRtYWlsIiA1Ci1UaGUgcGF0aG5hbWUgb2YgdGhlIHNlbmRtYWlsIGV4ZWN1dGFibGUuICBTaWV2
ZSB1c2VzIHNlbmRtYWlsIGZvciBzZW5kaW5nCi1yZWplY3Rpb25zLCByZWRpcmVjdHMgYW5kIHZh
Y2F0aW9uIHJlc3BvbnNlcy4KLS5JUCAiXGZCcG9zdG1hc3RlcjpcZlIgcG9zdG1hc3RlciIgNQot
VXNlcm5hbWUgdGhhdCBpcyB1c2VkIGFzIHRoZSAnRnJvbScgYWRkcmVzcyBpbiByZWplY3Rpb24g
TUROcyBwcm9kdWNlZAotYnkgc2lldmUuCi0uSVAgIlxmQmhhc2hpbWFwc3Bvb2w6XGZSIGZhbHNl
IiA1Ci1JZiBlbmFibGVkLCB0aGUgcGFydGl0aW9ucyB3aWxsIGFsc28gYmUgaGFzaGVkLCBpbiBh
ZGRpdGlvbiB0byB0aGUKLWhhc2hpbmcgZG9uZSBvbiBjb25maWd1cmF0aW9uIGRpcmVjdG9yaWVz
LiAgVGhpcyBpcyByZWNvbW1lbmRlZCBpZiBvbmUKLXBhcnRpdGlvbiBoYXMgYSB2ZXJ5IGJ1c2h5
IG1haWxib3ggdHJlZS4KLS5JUCAiXGZCc2lldmVfbWF4c2NyaXB0c2l6ZTpcZlIgMzIiIDUKLU1h
eGltdW0gc2l6ZSAoaW4ga2lsb2J5dGVzKSBhbnkgc2lldmUgc2NyaXB0IGNhbiBiZSwgZW5mb3Jj
ZWQgYXQKLXN1Ym1pc3Npb24gYnkgdGltc2lldmVkKDgpLgotLklQICJcZkJzaWV2ZV9tYXhzY3Jp
cHRzOlxmUiA1IiA1Ci1NYXhpbXVtIG51bWJlciBvZiBzaWV2ZSBzY3JpcHRzIGFueSB1c2VyIG1h
eSBoYXZlLCBlbmZvcmNlZCBhdAotc3VibWlzc2lvbiBieSB0aW1zaWV2ZWQoOCkuCi0uSVAgIlxm
QnNhc2xfbWF4aW11bV9sYXllcjpcZlIgMjU2IiA1Ci1NYXhpbXVtIFNTRiAoc2VjdXJpdHkgc3Ry
ZW5ndGggZmFjdG9yKSB0aGF0IHRoZSBzZXJ2ZXIgd2lsbCBhbGxvdyBhCi1jbGllbnQgdG8gbmVn
b3RpYXRlLgotLklQICJcZkJzYXNsX21pbmltdW1fbGF5ZXI6XGZSIDAiIDUKLVRoZSBtaW5pbXVt
IFNTRiB0aGF0IHRoZSBzZXJ2ZXIgd2lsbCBhbGxvdyBhIGNsaWVudCB0byBuZWdvdGlhdGUuICBB
Ci12YWx1ZSBvZiAxIHJlcXVpcmVzIGludGVncml0eSBwcm90ZWN0aW9uOyBhbnkgaGlnaGVyIHZh
bHVlIHJlcXVpcmVzCi1zb21lIGFtb3VudCBvZiBlbmNyeXB0aW9uLgotLklQICJcZkJzYXNsX3B3
Y2hlY2tfbWV0aG9kOlxmUiBhdXhwcm9wIiA1Ci1UaGUgbWVjaGFuaXNtIHVzZWQgYnkgdGhlIHNl
cnZlciB0byB2ZXJpZnkgcGxhaW50ZXh0IHBhc3N3b3Jkcy4KLVBvc3NpYmxlIHZhbHVlcyBhbHNv
IGluY2x1ZGUgInNhc2xhdXRoZCIgYW5kICJwd2NoZWNrIi4KLS5JUCAiXGZCc2FzbF9hdXRvX3Ry
YW5zaXRpb246XGZSIG5vIiA1Ci1JZiBlbmFibGVkLCB0aGUgU0FTTCBsaWJyYXJ5IHdpbGwgYXV0
b21hdGljYWxseSBjcmVhdGUgYXV0aGVudGljYXRpb24KLXNlY3JldHMgd2hlbiBnaXZlbiBhIHBs
YWludGV4dCBwYXNzd29yZC4gIFNlZSB0aGUgU0FTTCBkb2N1bWVudGF0aW9uLgotLklQICJcZkJz
YXNsX29wdGlvbjpcZlIiIDUKLUFueSBvdGhlciBTQVNMIG9wdGlvbiBjYW4gYmUgc2V0IGJ5IHBy
ZWNlZWRpbmcgaXQgd2l0aCAic2FzbF8iLiAgVGhpcwotZmlsZSBvdmVycmlkZXMgdGhlIFNBU0wg
Y29uZmlndXJhdGlvbiBmaWxlLgotLklQICJcZkJ0bHNfY2VydF9maWxlOlxmUiA8bm9uZT4iIDUK
LUZpbGUgY29udGFpbmluZyB0aGUgZ2xvYmFsIGNlcnRpZmljYXRlIHVzZWQgZm9yIEFMTCBzZXJ2
aWNlcyAoaW1hcCwKLXBvcDMsIGxtdHAsIHNpZXZlKS4KLS5JUCAiXGZCdGxzX2tleV9maWxlOlxm
UiA8bm9uZT4iIDUKLUZpbGUgY29udGFpbmluZyB0aGUgcHJpdmF0ZSBrZXkgYmVsb25naW5nIHRv
IHRoZSBnbG9iYWwgc2VydmVyCi1jZXJ0aWZpY2F0ZS4KLS5JUCAiXGZCdGxzX3JlcXVpcmVfY2Vy
dDpcZlIgMCIgNQotUmVxdWlyZSBhIGNsaWVudCBjZXJ0aWZpY2F0ZSBmb3IgQUxMIHNlcnZpY2Vz
IChpbWFwLCBwb3AzLCBsbXRwLCBzaWV2ZSkuCi0uSVAgIlxmQnRsc19pbWFwX2NlcnRfZmlsZTpc
ZlIgPG5vbmU+IiA1Ci1GaWxlIGNvbnRhaW5pbmcgdGhlIGNlcnRpZmljYXRlIHVzZWQgZm9yIGlt
YXAgT05MWS4gIElmIG5vdCBzcGVjaWZpZWQsCi10aGUgZ2xvYmFsIGNlcnRpZmljYXRlIGlzIHVz
ZWQuICBBIHZhbHVlIG9mICJkaXNhYmxlZCIgd2lsbCBkaXNhYmxlCi1TU0wvVExTIGZvciBpbWFw
LgotLklQICJcZkJ0bHNfaW1hcF9rZXlfZmlsZTpcZlIgPG5vbmU+IiA1Ci1GaWxlIGNvbnRhaW5p
bmcgdGhlIHByaXZhdGUga2V5IGJlbG9uZ2luZyB0byB0aGUgaW1hcC1zcGVjaWZpYyBzZXJ2ZXIK
LWNlcnRpZmljYXRlLiAgSWYgbm90IHNwZWNpZmllZCwgdGhlIGdsb2JhbCBwcml2YXRlIGtleSBp
cyB1c2VkLiAgQQotdmFsdWUgb2YgImRpc2FibGVkIiB3aWxsIGRpc2FibGUgU1NML1RMUyBmb3Ig
aW1hcC4KLS5JUCAiXGZCdGxzX2ltYXBfcmVxdWlyZV9jZXJ0OlxmUiAwIiA1Ci1SZXF1aXJlIGEg
Y2xpZW50IGNlcnRpZmljYXRlIGZvciBpbWFwIE9OTFkuCi0uSVAgIlxmQnRsc19wb3AzX2NlcnRf
ZmlsZTpcZlIgPG5vbmU+IiA1Ci1GaWxlIGNvbnRhaW5pbmcgdGhlIGNlcnRpZmljYXRlIHVzZWQg
Zm9yIHBvcDMgT05MWS4gIElmIG5vdCBzcGVjaWZpZWQsCi10aGUgZ2xvYmFsIGNlcnRpZmljYXRl
IGlzIHVzZWQuICBBIHZhbHVlIG9mICJkaXNhYmxlZCIgd2lsbCBkaXNhYmxlCi1TU0wvVExTIGZv
ciBwb3AzLgotLklQICJcZkJ0bHNfcG9wM19rZXlfZmlsZTpcZlIgPG5vbmU+IiA1Ci1GaWxlIGNv
bnRhaW5pbmcgdGhlIHByaXZhdGUga2V5IGJlbG9uZ2luZyB0byB0aGUgcG9wMy1zcGVjaWZpYyBz
ZXJ2ZXIKLWNlcnRpZmljYXRlLiAgSWYgbm90IHNwZWNpZmllZCwgdGhlIGdsb2JhbCBwcml2YXRl
IGtleSBpcyB1c2VkLiAgQQotdmFsdWUgb2YgImRpc2FibGVkIiB3aWxsIGRpc2FibGUgU1NML1RM
UyBmb3IgcG9wMy4KLS5JUCAiXGZCdGxzX3BvcDNfcmVxdWlyZV9jZXJ0OlxmUiAwIiA1Ci1SZXF1
aXJlIGEgY2xpZW50IGNlcnRpZmljYXRlIGZvciBwb3AzIE9OTFkuCi0uSVAgIlxmQnRsc19sbXRw
X2NlcnRfZmlsZTpcZlIgPG5vbmU+IiA1Ci1GaWxlIGNvbnRhaW5pbmcgdGhlIGNlcnRpZmljYXRl
IHVzZWQgZm9yIGxtdHAgT05MWS4gIElmIG5vdCBzcGVjaWZpZWQsCi10aGUgZ2xvYmFsIGNlcnRp
ZmljYXRlIGlzIHVzZWQuICBBIHZhbHVlIG9mICJkaXNhYmxlZCIgd2lsbCBkaXNhYmxlCi1UTFMg
Zm9yIGxtdHAuCi0uSVAgIlxmQnRsc19sbXRwX2tleV9maWxlOlxmUiA8bm9uZT4iIDUKLUZpbGUg
Y29udGFpbmluZyB0aGUgcHJpdmF0ZSBrZXkgYmVsb25naW5nIHRvIHRoZSBsbXRwLXNwZWNpZmlj
IHNlcnZlcgotY2VydGlmaWNhdGUuICBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgZ2xvYmFsIHByaXZh
dGUga2V5IGlzIHVzZWQuICBBCi12YWx1ZSBvZiAiZGlzYWJsZWQiIHdpbGwgZGlzYWJsZSBUTFMg
Zm9yIGxtdHAuCi0uSVAgIlxmQnRsc19sbXRwX3JlcXVpcmVfY2VydDpcZlIgMCIgNQotUmVxdWly
ZSBhIGNsaWVudCBjZXJ0aWZpY2F0ZSBmb3IgbG10cCBPTkxZLgotLklQICJcZkJ0bHNfc2lldmVf
Y2VydF9maWxlOlxmUiA8bm9uZT4iIDUKLUZpbGUgY29udGFpbmluZyB0aGUgY2VydGlmaWNhdGUg
dXNlZCBmb3Igc2lldmUgT05MWS4gIElmIG5vdCBzcGVjaWZpZWQsCi10aGUgZ2xvYmFsIGNlcnRp
ZmljYXRlIGlzIHVzZWQuICBBIHZhbHVlIG9mICJkaXNhYmxlZCIgd2lsbCBkaXNhYmxlCi1UTFMg
Zm9yIHNpZXZlLgotLklQICJcZkJ0bHNfc2lldmVfa2V5X2ZpbGU6XGZSIDxub25lPiIgNQotRmls
ZSBjb250YWluaW5nIHRoZSBwcml2YXRlIGtleSBiZWxvbmdpbmcgdG8gdGhlIHNpZXZlLXNwZWNp
ZmljIHNlcnZlcgotY2VydGlmaWNhdGUuICBJZiBub3Qgc3BlY2lmaWVkLCB0aGUgZ2xvYmFsIHBy
aXZhdGUga2V5IGlzIHVzZWQuICBBCi12YWx1ZSBvZiAiZGlzYWJsZWQiIHdpbGwgZGlzYWJsZSBU
TFMgZm9yIHNpZXZlLgotLklQICJcZkJ0bHNfc2lldmVfcmVxdWlyZV9jZXJ0OlxmUiAwIiA1Ci1S
ZXF1aXJlIGEgY2xpZW50IGNlcnRpZmljYXRlIGZvciBzaWV2ZSBPTkxZLgotLklQICJcZkJ0bHNf
Y2FfZmlsZTpcZlIgPG5vbmU+IiA1Ci1GaWxlIGNvbnRhaW5pbmcgb25lIG9yIG1vcmUgQ2VydGlm
aWNhdGUgQXV0aG9yaXR5IChDQSkgY2VydGlmaWNhdGVzLgotLklQICJcZkJ0bHNfY2FfcGF0aDpc
ZlIgPG5vbmU+IiA1Ci1QYXRoIHRvIGRpcmVjdG9yeSB3aXRoIGNlcnRpZmljYXRlcyBvZiBDQXMu
Ci0uSVAgIlxmQnRsc19zZXNzaW9uX3RpbWVvdXQ6XGZSIDE0NDAiIDUKLVRoZSBsZW5ndGggb2Yg
dGltZSAoaW4gbWludXRlcykgdGhhdCBhIFRMUyBzZXNzaW9uIHdpbGwgYmUgY2FjaGVkIGZvcgot
bGF0ZXIgcmV1c2UuICBUaGUgbWF4aW11bSB2YWx1ZSBpcyAxNDQwICgyNCBob3VycyksIHRoZSBk
ZWZhdWx0LiAgQQotdmFsdWUgb2YgMCB3aWxsIGRpc2FibGUgc2Vzc2lvbiBjYWNoaW5nLgotLklQ
ICJcZkJ0bHNfY2lwaGVyX2xpc3Q6XGZSIERFRkFVTFQiIDUKLVRoZSBsaXN0IG9mIFNTTC9UTFMg
Y2lwaGVycyB0byBhbGxvdy4gIFRoZSBmb3JtYXQgb2YgdGhlIHN0cmluZyBpcwotZGVzY3JpYmVk
IGluIGNpcGhlcnMoMSkuCi0uSVAgIlxmQmRlbGV0ZXJpZ2h0OlxmUiBjIiA1Ci1UaGUgcmlnaHQg
dGhhdCBhIHVzZXIgbmVlZHMgdG8gZGVsZXRlIGEgbWFpbGJveC4KLS5JUCAiXGZCbG10cHNvY2tl
dDpcZlIgL3Zhci9pbWFwL3NvY2tldC9sbXRwIiA1Ci1Vbml4IGRvbWFpbiBzb2NrZXQgdGhhdCBs
bXRwZCBsaXN0ZW5zIG9uLCB1c2VkIGJ5IGRlbGl2ZXIoOCkuCi0uSVAgIlxmQmlkbGVzb2NrZXQ6
XGZSIC92YXIvaW1hcC9zb2NrZXQvaWRsZSIgNQotVW5peCBkb21haW4gc29ja2V0IHRoYXQgaWRs
ZWQgbGlzdGVucyBvbi4KLS5JUCAiXGZCbm90aWZ5c29ja2V0OlxmUiAvdmFyL2ltYXAvc29ja2V0
L25vdGlmeSIgNQotVW5peCBkb21haW4gc29ja2V0IHRoYXQgdGhlIG5ldyBtYWlsIG5vdGlmaWNh
dGlvbiBkYWVtb24gbGlzdGVucyBvbi4KLS5JUCAiXGZCZGVidWdfY29tbWFuZDpcZlIgPG5vbmU+
IiA1Ci1EZWJ1ZyBjb21tYW5kIHRvIGJlIHVzZWQgYnkgcHJvY2Vzc2VzIHN0YXJ0ZWQgd2l0aCAt
RCBvcHRpb24uICBUaGUgc3RyaW5nCi1pcyBhIEMgZm9ybWF0IHN0cmluZyB0aGF0IGdldHMgMyBv
cHRpb25zOiB0aGUgZmlyc3QgaXMgdGhlIG5hbWUgb2YgdGhlCi1leGVjdXRhYmxlICh3aXRob3V0
IHBhdGgpLiAgVGhlIHNlY29uZCBpcyB0aGUgcGlkIChpbnRlZ2VyKSBhbmQgdGhlIHRoaXJkCi1p
cyB0aGUgc2VydmljZSBJRC4gIEV4YW1wbGU6IC91c3IvbG9jYWwvYmluL2dkYiAvdXNyL2N5cnVz
L2Jpbi8lcyAlZAotLklQICJcZkJwcm94eWRfYWxsb3dfc3RhdHVzX3JlZmVycmFsOlxmUiBmYWxz
ZSIgNQotU2V0IHRvIHRydWUgdG8gYWxsb3cgcHJveHlkIHRvIGlzc3VlIHJlZmVycmFscyB0byBj
bGllbnRzIHRoYXQgc3VwcG9ydCBpdAotd2hlbiBhbnN3ZXJpbmcgdGhlIFNUQVRVUyBjb21tYW5k
LiAgVGhpcyBpcyBkaXNhYmxlZCBieSBkZWZhdWx0IHNpbmNlCi1zb21lIGNsaWVudHMgaXNzdWUg
bWFueSBTVEFUVVMgY29tbWFuZHMgaW4gYSByb3csIGFuZCBkbyBub3QgY2FjaGUgdGhlCi1jb25u
ZWN0aW9ucyB0aGF0IHRoZXNlIHJlZmVycmFscyB3b3VsZCBjYXVzZSwgdGh1cyByZXN1bHRpbmcg
aW4gYSBoaWdoZXIKLWF1dGhlbnRpY2F0aW9uIGxvYWQgb24gdGhlIHJlc3BlY3RpdmUgYmFja2Vu
ZCBzZXJ2ZXIuCi0uSVAgIlxmQm11cGRhdGVfc2VydmVyOlxmUiA8bm9uZT4iIDUKLVRoZSBtdXBk
YXRlIHNlcnZlciBmb3IgdGhlIEN5cnVzIE11cmRlcgotLklQICJcZkJtdXBkYXRlX3BvcnQ6XGZS
IDxub25lPiIgNQotVGhlIHBvcnQgb2YgdGhlIG11cGRhdGUgc2VydmVyIGZvciB0aGUgQ3lydXMg
TXVyZGVyCi0uSVAgIlxmQm11cGRhdGVfdXNlcm5hbWU6XGZSIDxub25lPiIgNQotVGhlIFNBU0wg
dXNlcm5hbWUgKEF1dGhvcml6YXRpb24gTmFtZSkgdG8gdXNlIHdoZW4gYXV0aGVudGljYXRpbmcg
dG8gdGhlIG11cGRhdGUgc2VydmVyLgotLklQICJcZkJtdXBkYXRlX2F1dGhuYW1lOlxmUiA8bm9u
ZT4iIDUKLVRoZSBTQVNMIHVzZXJuYW1lIChBdXRoZW50aWNhdGlvbiBOYW1lKSB0byB1c2Ugd2hl
biBhdXRoZW50aWNhdGluZyB0byB0aGUKLW11cGRhdGUgc2VydmVyIChpZiBuZWVkZWQpLgotLklQ
ICJcZkJtdXBkYXRlX3JlYWxtOlxmUiA8bm9uZT4iIDUKLVRoZSBTQVNMIHJlYWxtIChpZiBuZWVk
ZWQpIHRvIHVzZSB3aGVuIGF1dGhlbnRpY2F0aW5nIHRvIHRoZSBtdXBkYXRlIHNlcnZlci4KLS5J
UCAiXGZCbXVwZGF0ZV9wYXNzd29yZDpcZlIgPG5vbmU+IiA1Ci1UaGUgU0FTTCBwYXNzd29yZCAo
aWYgbmVlZGVkKSB0byB1c2Ugd2hlbiBhdXRoZW50aWNhdGluZyB0byB0aGUgbXVwZGF0ZSBzZXJ2
ZXIuCi0uSVAgIlxmQm11cGRhdGVfcmV0cnlfZGVsYXk6XGZSIDIwIiA1Ci1UaGUgdGltZSB0byB3
YWl0IGJldHdlZW4gY29ubmVjdGlvbiByZXRyaWVzIHRvIHRoZSBtdXBkYXRlIHNlcnZlci4KLS5T
SCBTRUUgQUxTTwotLlBQCi1cZkJpbWFwZCg4KVxmUiwgXGZCcG9wM2QoOClcZlIsIFxmQmxtdHBk
KDgpXGZSLCBcZkJ0aW1zaWV2ZWQoOClcZlIsCi1cZkJpZGxlZCg4KVxmUiwgXGZCbm90aWZ5ZCg4
KVxmUiwgXGZCZGVsaXZlcig4KVxmUiwgXGZCbWFzdGVyKDgpXGZSLCAKLVxmQmNpcGhlcnMoMSlc
ZlIKSW5kZXg6IG5vdGlmeWQvbm90aWZ5X21haWx0by5jCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9h
ZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2cy9zcmMvY3lydXMvbm90aWZ5ZC9ub3RpZnlfbWFp
bHRvLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMwpkaWZmIC11IC1yMS4zIG5vdGlmeV9tYWls
dG8uYwotLS0gbm90aWZ5X21haWx0by5jCTIwMDIvMDMvMTggMTU6MTQ6MTcJMS4zCisrKyBub3Rp
ZnlfbWFpbHRvLmMJMjAwMi8wNi8xOSAwMDoyNDoxOApAQCAtNTksMTAgKzU5LDcgQEAKICNkZWZp
bmUgREVGQVVMVF9TRU5ETUFJTCAoIi91c3IvbGliL3NlbmRtYWlsIikKICNkZWZpbmUgREVGQVVM
VF9QT1NUTUFTVEVSICgicG9zdG1hc3RlciIpCiAKLSNkZWZpbmUgU0VORE1BSUwgKGNvbmZpZ19n
ZXRzdHJpbmcoInNlbmRtYWlsIiwgREVGQVVMVF9TRU5ETUFJTCkpCi0jZGVmaW5lIFBPU1RNQVNU
RVIgKGNvbmZpZ19nZXRzdHJpbmcoInBvc3RtYXN0ZXIiLCBERUZBVUxUX1BPU1RNQVNURVIpKQog
Ci0KIHN0YXRpYyBpbnQgZ2xvYmFsX291dGdvaW5nX2NvdW50ID0gMDsKIAogY2hhciogbm90aWZ5
X21haWx0byhjb25zdCBjaGFyICpjbGFzcyBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKQEAgLTk5
LDcgKzk2LDcgQEAKIAljbG9zZShmZHNbMV0pOwogCS8qIG1ha2UgdGhlIHBpcGUgYmUgc3RkaW4g
Ki8KIAlkdXAyKGZkc1swXSwgMCk7Ci0JZXhlY3YoU0VORE1BSUwsIChjaGFyICoqKSBzbWJ1Zik7
CisJZXhlY3YoY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NFTkRNQUlMKSwgKGNoYXIgKiopIHNt
YnVmKTsKIAogCS8qIGlmIHdlJ3JlIGhlcmUgd2Ugc3VjayAqLwogCXJldHVybiBzdHJkdXAoIk5P
IG1haWx0byBjb3VsZG4ndCBleGVjIik7CkBAIC0xMjEsNyArMTE4LDcgQEAKICAgICBmcHJpbnRm
KHNtLCAiRGF0ZTogJXNcclxuIiwgZGF0ZXN0cik7CiAgICAgCiAgICAgZnByaW50ZihzbSwgIlgt
U2lldmU6ICVzXHJcbiIsIFNJRVZFX1ZFUlNJT04pOwotICAgIGZwcmludGYoc20sICJGcm9tOiBN
YWlsIFNpZXZlIFN1YnN5c3RlbSA8JXM+XHJcbiIsIFBPU1RNQVNURVIpOworICAgIGZwcmludGYo
c20sICJGcm9tOiBNYWlsIFNpZXZlIFN1YnN5c3RlbSA8JXM+XHJcbiIsIGNvbmZpZ19nZXRzdHJp
bmcoSU1BUE9QVF9QT1NUTUFTVEVSKSk7CiAgICAgZnByaW50ZihzbSwgIlRvOiA8JXM+XHJcbiIs
IG9wdGlvbnNbMF0pOwogICAgIGZwcmludGYoc20sICJTdWJqZWN0OiBbU0lFVkVdIE5ldyBtYWls
IG5vdGlmaWNhdGlvblxyXG4iKTsKICAgICBmcHJpbnRmKHNtLCAiXHJcbiIpOwpJbmRleDogbm90
aWZ5ZC9ub3RpZnlkLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcuY211LmVkdS9z
eXN0ZW0vY3ZzL3NyYy9jeXJ1cy9ub3RpZnlkL25vdGlmeWQuYyx2CnJldHJpZXZpbmcgcmV2aXNp
b24gMS45CmRpZmYgLXUgLXIxLjkgbm90aWZ5ZC5jCi0tLSBub3RpZnlkLmMJMjAwMi8wNi8xOSAx
NDo0NTozNQkxLjkKKysrIG5vdGlmeWQuYwkyMDAyLzA2LzE5IDE0OjQ5OjMyCkBAIC0yMTIsNyAr
MjEyLDYgQEAKICAgICBpbnQgb3B0OwogICAgIGNoYXIgKm1ldGhvZCA9ICJudWxsIjsKIAotICAg
IGNvbmZpZ19jaGFuZ2VpZGVudCgibm90aWZ5ZCIpOwogICAgIGlmIChnZXRldWlkKCkgPT0gMCkg
ZmF0YWwoIm11c3QgcnVuIGFzIHRoZSBDeXJ1cyB1c2VyIiwgRUNfVVNBR0UpOwogCiAgICAgd2hp
bGUgKChvcHQgPSBnZXRvcHQoYXJnYywgYXJndiwgIkM6RG06IikpICE9IEVPRikgewpJbmRleDog
dGltc2lldmVkL2FjdGlvbnMuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUu
ZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVzL3RpbXNpZXZlZC9hY3Rpb25zLmMsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuMzAKZGlmZiAtdSAtcjEuMzAgYWN0aW9ucy5jCi0tLSBhY3Rpb25zLmMJMjAw
Mi8wMi8xOSAxODo1MDoxNQkxLjMwCisrKyBhY3Rpb25zLmMJMjAwMi8wNi8xOSAwMDoxNjozNwpA
QCAtMSw3ICsxLDYgQEAKIC8qIGFjdGlvbnMuYyAtLSBleGVjdXRlcyB0aGUgY29tbWFuZHMgZm9y
IHRpbXNpZXZlZAogICogVGltIE1hcnRpbgogICogJElkOiBhY3Rpb25zLmMsdiAxLjMwIDIwMDIv
MDIvMTkgMTg6NTA6MTUga2VuMyBFeHAgJAotICogCiAgKi8KIC8qCiAgKiBDb3B5cmlnaHQgKGMp
IDE5OTktMjAwMCBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eS4gIEFsbCByaWdodHMgcmVzZXJ2
ZWQuCkBAIC04MSwxMCArODAsMTAgQEAKIHsKICAgaW50IHNpZXZlX3VzZWhvbWVkaXIgPSAwOwog
Ci0gIHNpZXZlX3VzZWhvbWVkaXIgPSBjb25maWdfZ2V0c3dpdGNoKCJzaWV2ZXVzZWhvbWVkaXIi
LCAwKTsKKyAgc2lldmVfdXNlaG9tZWRpciA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9TSUVW
RVVTRUhPTUVESVIpOwogICAKICAgaWYgKCFzaWV2ZV91c2Vob21lZGlyKSB7Ci0gICAgICBzaWV2
ZV9kaXIgPSAoY2hhciAqKSBjb25maWdfZ2V0c3RyaW5nKCJzaWV2ZWRpciIsICIvdXNyL3NpZXZl
Iik7CisgICAgICBzaWV2ZV9kaXIgPSAoY2hhciAqKSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRf
U0lFVkVESVIpOwogICB9IGVsc2UgewogICAgICAgLyogY2FuJ3QgdXNlIGhvbWUgZGlyZWN0b3Jp
ZXMgd2l0aCB0aW1zaWV2ZWQgKi8KICAgICAgIHN5c2xvZyhMT0dfRVJSLCAiY2FuJ3QgdXNlIGhv
bWUgZGlyZWN0b3JpZXMiKTsKQEAgLTE2NSw3ICsxNjQsNyBAQAogICAgIC8qIFNpZXZlIGNhcGFi
aWxpdGllcyAqLwogICAgIHByb3RfcHJpbnRmKGNvbm4sIlwiU0lFVkVcIiBcIiVzXCJcclxuIixz
aWV2ZV9saXN0ZXh0ZW5zaW9ucygpKTsKIAotICAgIGlmICh0bHNfZW5hYmxlZCgic2lldmUiKSkg
eworICAgIGlmICh0bHNfZW5hYmxlZCgpKSB7CiAJcHJvdF9wcmludGYoY29ubiwgIlwiU1RBUlRU
TFNcIlxyXG4iKTsKICAgICB9CiAKQEAgLTI5Miw3ICsyOTEsNyBAQAogCiAgIGVsc2UgewogICAg
ICAgLyogc2VlIGlmIHRoaXMgd291bGQgcHV0IHRoZSB1c2VyIG92ZXIgcXVvdGEgKi8KLSAgICAg
IG1heHNjcmlwdHMgPSBjb25maWdfZ2V0aW50KCJzaWV2ZV9tYXhzY3JpcHRzIiw1KTsKKyAgICAg
IG1heHNjcmlwdHMgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfU0lFVkVfTUFYU0NSSVBUUyk7CiAK
ICAgICAgIGlmIChjb3VudHNjcmlwdHMoc3RyaW5nX0RBVEFQVFIobmFtZSkpKzEgPiBtYXhzY3Jp
cHRzKQogICAgICAgewpAQCAtNTU5LDcgKzU1OCw3IEBACiAgICAgfQogCiAgICAgLyogc2VlIGlm
IHRoZSBzaXplIG9mIHRoZSBzY3JpcHQgaXMgdG9vIGJpZyAqLwotICAgIG1heHNjcmlwdHNpemUg
PSBjb25maWdfZ2V0aW50KCJzaWV2ZV9tYXhzY3JpcHRzaXplIiwgMzIpOworICAgIG1heHNjcmlw
dHNpemUgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfU0lFVkVfTUFYU0NSSVBUU0laRSk7CiAgICAg
bWF4c2NyaXB0c2l6ZSAqPSAxMDI0OwogCiAgICAgaWYgKG51bSA+IG1heHNjcmlwdHNpemUpCkBA
IC01NzIsNyArNTcxLDcgQEAKICAgICB9CiAKICAgICAvKiBzZWUgaWYgdGhpcyB3b3VsZCBwdXQg
dGhlIHVzZXIgb3ZlciBxdW90YSAqLwotICAgIG1heHNjcmlwdHMgPSBjb25maWdfZ2V0aW50KCJz
aWV2ZV9tYXhzY3JpcHRzIiw1KTsKKyAgICBtYXhzY3JpcHRzID0gY29uZmlnX2dldGludChJTUFQ
T1BUX1NJRVZFX01BWFNDUklQVFMpOwogCiAgICAgaWYgKGNvdW50c2NyaXB0cyhzdHJpbmdfREFU
QVBUUihzaWV2ZV9uYW1lKSkrMSA+IG1heHNjcmlwdHMpCiAgICAgewpJbmRleDogdGltc2lldmVk
L2xleC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3LmNtdS5lZHUvc3lzdGVtL2N2
cy9zcmMvY3lydXMvdGltc2lldmVkL2xleC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjE5CmRp
ZmYgLXUgLXIxLjE5IGxleC5jCi0tLSBsZXguYwkyMDAyLzAyLzE2IDIwOjU2OjU2CTEuMTkKKysr
IGxleC5jCTIwMDIvMDYvMTkgMDA6MTg6NDQKQEAgLTYyLDcgKzYyLDcgQEAKICNpbmNsdWRlICJp
bWFwY29uZi5oIgogI2luY2x1ZGUgInhtYWxsb2MuaCIKIAotaW50IHRva2VuX2xvb2t1cCAoY2hh
ciAqc3RyLCBpbnQgbGVuKQoraW50IHRva2VuX2xvb2t1cCAoY2hhciAqc3RyLCBpbnQgbGVuIF9f
YXR0cmlidXRlX18oKHVudXNlZCkpKQogewogICAgIHN3aXRjaCAoKnN0cikgewogICAgIGNhc2Ug
J2EnOgpAQCAtOTUsNyArOTUsNyBAQAogCiAgICAgY2FzZSAncyc6CiAJaWYgKHN0cmNtcChzdHIs
ICJzZXRhY3RpdmUiKT09MCkgcmV0dXJuIFNFVEFDVElWRTsKLQlpZiAoc3RyY21wKHN0ciwgInN0
YXJ0dGxzIik9PTAgJiYgdGxzX2VuYWJsZWQoInNpZXZlIikpCisJaWYgKHN0cmNtcChzdHIsICJz
dGFydHRscyIpPT0wICYmIHRsc19lbmFibGVkKCkpCiAJICAgIHJldHVybiBTVEFSVFRMUzsKIAli
cmVhazsKICAgICB9CkBAIC0xMzYsNyArMTM2LDcgQEAKIAogaW50IGxleF9pbml0KHZvaWQpCiB7
Ci0gIG1heHNjcmlwdHNpemUgPSBjb25maWdfZ2V0aW50KCJzaWV2ZV9tYXhzY3JpcHRzaXplIiwg
MzIpOworICBtYXhzY3JpcHRzaXplID0gY29uZmlnX2dldGludChJTUFQT1BUX1NJRVZFX01BWFND
UklQVFNJWkUpOwogICBtYXhzY3JpcHRzaXplICo9IDEwMjQ7CiAKICAgYnVmZmVyID0gKGNoYXIg
KikgeG1hbGxvYyhtYXhzY3JpcHRzaXplKTsKSW5kZXg6IHRpbXNpZXZlZC9wYXJzZXIuYwo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1L3N5c3RlbS9jdnMvc3JjL2N5cnVz
L3RpbXNpZXZlZC9wYXJzZXIuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4yMApkaWZmIC11IC1y
MS4yMCBwYXJzZXIuYwotLS0gcGFyc2VyLmMJMjAwMi8wNi8wMiAxNToyNTo0NAkxLjIwCisrKyBw
YXJzZXIuYwkyMDAyLzA2LzE5IDAwOjIxOjE1CkBAIC0xMjYsNyArMTI2LDcgQEAKIAogICBpZiAo
IWF1dGhlbnRpY2F0ZWQgJiYgKHRva2VuID4gMjU1KSAmJiAodG9rZW4hPUFVVEhFTlRJQ0FURSkg
JiYKICAgICAgICh0b2tlbiE9TE9HT1VUKSAmJiAodG9rZW4hPUNBUEFCSUxJVFkpICYmCi0gICAg
ICAoIXRsc19lbmFibGVkKCJzaWV2ZSIpIHx8ICh0b2tlbiE9U1RBUlRUTFMpKSkKKyAgICAgICgh
dGxzX2VuYWJsZWQoKSB8fCAodG9rZW4hPVNUQVJUVExTKSkpCiAgIHsKICAgICBlcnJvcl9tc2cg
PSAiQXV0aGVudGljYXRlIGZpcnN0IjsKICAgICBpZiAodG9rZW4hPUVPTCkKSW5kZXg6IHRpbXNp
ZXZlZC90aW1zaWV2ZWQuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy5jbXUuZWR1
L3N5c3RlbS9jdnMvc3JjL2N5cnVzL3RpbXNpZXZlZC90aW1zaWV2ZWQuYyx2CnJldHJpZXZpbmcg
cmV2aXNpb24gMS40MApkaWZmIC11IC1yMS40MCB0aW1zaWV2ZWQuYwotLS0gdGltc2lldmVkLmMJ
MjAwMi8wNS8yNSAxOTo1Nzo1MwkxLjQwCisrKyB0aW1zaWV2ZWQuYwkyMDAyLzA2LzE5IDAwOjIw
OjI5CkBAIC0yMDYsNyArMjA2LDcgQEAKICAgICAvKiBjaGVjayBpZiByZW1vdGUgcmVhbG0gKi8K
ICAgICBpZiAoKHJlYWxtID0gc3RyY2hyKGF1dGhfaWRlbnRpdHksICdAJykpIT1OVUxMKSB7CiAJ
cmVhbG0rKzsKLQl2YWwgPSBjb25maWdfZ2V0c3RyaW5nKCJsb2dpbnJlYWxtcyIsICIiKTsKKwl2
YWwgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTE9HSU5SRUFMTVMpOwogCXdoaWxlICgqdmFs
KSB7CiAJICAgIGlmICghc3RybmNhc2VjbXAodmFsLCByZWFsbSwgc3RybGVuKHJlYWxtKSkgJiYK
IAkJKCF2YWxbc3RybGVuKHJlYWxtKV0gfHwgaXNzcGFjZSgoaW50KSB2YWxbc3RybGVuKHJlYWxt
KV0pKSkgewpAQCAtMjI2LDE2ICsyMjYsMTYgQEAKICAgICBzaWV2ZWRfYXV0aHN0YXRlID0gYXV0
aF9uZXdzdGF0ZShhdXRoX2lkZW50aXR5LCBOVUxMKTsKIAogICAgIC8qIG9rLCBpcyBhdXRoX2lk
ZW50aXR5IGFuIGFkbWluPyAqLwotICAgIHNpZXZlZF91c2VyaXNhZG1pbiA9IGF1dGhpc2Eoc2ll
dmVkX2F1dGhzdGF0ZSwgInNpZXZlIiwgImFkbWlucyIpOworICAgIHNpZXZlZF91c2VyaXNhZG1p
biA9IGNvbmZpZ19hdXRoaXNhKHNpZXZlZF9hdXRoc3RhdGUsIElNQVBPUFRfQURNSU5TKTsKIAog
ICAgIGlmIChzdHJjbXAoYXV0aF9pZGVudGl0eSwgcmVxdWVzdGVkX3VzZXIpKSB7CiAgICAgICAg
IC8qIHdlIHdhbnQgdG8gYXV0aGVudGljYXRlIGFzIGEgZGlmZmVyZW50IHVzZXI7IHdlJ2xsIGFs
bG93IHRoaXMKICAgICAgICAgICAgaWYgd2UncmUgYW4gYWRtaW4gb3IgaWYgd2UndmUgYWxsb3dl
ZCBBQ0wgcHJveHkgbG9naW5zICovCi0gICAgICAgIGludCB1c2VfYWNsID0gY29uZmlnX2dldHN3
aXRjaCgibG9naW51c2VhY2wiLCAwKTsKKyAgICAgICAgaW50IHVzZV9hY2wgPSBjb25maWdfZ2V0
c3dpdGNoKElNQVBPUFRfTE9HSU5VU0VBQ0wpOwogCiAgICAgICAgIGlmIChzaWV2ZWRfdXNlcmlz
YWRtaW4gfHwKICAgICAgICAgICAgICh1c2VfYWNsICYmIGFjbF9vayhyZXF1ZXN0ZWRfdXNlciwg
YXV0aF9pZGVudGl0eSwgc2lldmVkX2F1dGhzdGF0ZSkpIHx8Ci0gICAgICAgICAgICBhdXRoaXNh
KHNpZXZlZF9hdXRoc3RhdGUsICJzaWV2ZSIsICJwcm94eXNlcnZlcnMiKSkgeworICAgICAgICAg
ICAgY29uZmlnX2F1dGhpc2Eoc2lldmVkX2F1dGhzdGF0ZSwgSU1BUE9QVF9QUk9YWVNFUlZFUlMp
KSB7CiAgICAgICAgICAgICAvKiBwcm94eSBvayEgKi8KIAogCSAgICBzaWV2ZWRfdXNlcmlzYWRt
aW4gPSAwOyAvKiBubyBsb25nZXIgYWRtaW4gKi8KQEAgLTI4OSw4ICsyODksNyBAQAogICAgIHNp
ZXZlZF9pbiA9IHByb3RfbmV3KDAsIDApOwogICAgIHNpZXZlZF9vdXQgPSBwcm90X25ldygxLCAx
KTsKIAotICAgIGNvbmZpZ19jaGFuZ2VpZGVudCgidGltc2lldmVkIik7Ci0gICAgdGltZW91dCA9
IGNvbmZpZ19nZXRpbnQoInRpbWVvdXQiLCAxMCk7CisgICAgdGltZW91dCA9IGNvbmZpZ19nZXRp
bnQoSU1BUE9QVF9USU1FT1VUKTsKICAgICBpZiAodGltZW91dCA8IDEwKSB0aW1lb3V0ID0gMTA7
CiAgICAgcHJvdF9zZXR0aW1lb3V0KHNpZXZlZF9pbiwgdGltZW91dCAqIDYwKTsKICAgICBwcm90
X3NldGZsdXNob25yZWFkKHNpZXZlZF9pbiwgc2lldmVkX291dCk7CkBAIC0zNTAsNyArMzQ5LDcg
QEAKIAogICAgIC8qIHdpbGwgYWx3YXlzIHJldHVybiBzb21ldGhpbmcgdmFsaWQgKi8KICAgICAv
KiBzaG91bGQgYmUgY29uZmlndXJhYmxlISAqLwotICAgIGlmICghY29uZmlnX2dldHN3aXRjaCgi
YWxsb3dwbGFpbnRleHQiLCAxKSkgeworICAgIGlmICghY29uZmlnX2dldHN3aXRjaChJTUFQT1BU
X0FMTE9XUExBSU5URVhUKSkgewogCXNlY2ZsYWdzIHw9IFNBU0xfU0VDX05PUExBSU5URVhUOwog
ICAgIH0KICAgICBzZWNwcm9wcyA9IG15c2FzbF9zZWNwcm9wcyhzZWNmbGFncyk7CkBAIC0zODks
NyArMzg4LDcgQEAKIAkJCSAgIHNhc2xwcm9wcy5pcGxvY2FscG9ydCk7CiAgICAgaWYocmV0ICE9
IFNBU0xfT0spIHJldHVybiByZXQ7CiAgICAgCi0gICAgaWYgKCFjb25maWdfZ2V0c3dpdGNoKCJh
bGxvd3BsYWludGV4dCIsIDEpKSB7CisgICAgaWYgKCFjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRf
QUxMT1dQTEFJTlRFWFQpKSB7CiAJc2VjZmxhZ3MgfD0gU0FTTF9TRUNfTk9QTEFJTlRFWFQ7CiAg
ICAgfQogICAgIHNlY3Byb3BzID0gbXlzYXNsX3NlY3Byb3BzKHNlY2ZsYWdzKTsKSW5kZXg6IHRv
b2xzL2NvbmZpZzJoZWFkZXIKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogY29uZmlnMmhlYWRlcgpkaWZm
IC1OIGNvbmZpZzJoZWFkZXIKLS0tIC9kZXYvbnVsbAlUdWUgTWF5ICA1IDE2OjMyOjI3IDE5OTgK
KysrIGNvbmZpZzJoZWFkZXIJVHVlIEp1biAxOCAxMzo0OTowOSAyMDAyCkBAIC0wLDAgKzEsMTc1
IEBACisjIS9iaW4vc2gKKyMgJElkJAorIworIyBDb3B5cmlnaHQgKGMpIDIwMDEgQ2FybmVnaWUg
TWVsbG9uIFVuaXZlcnNpdHkuICBBbGwgcmlnaHRzIHJlc2VydmVkLgorIworIyBSZWRpc3RyaWJ1
dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQK
KyMgbW9kaWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2lu
ZyBjb25kaXRpb25zCisjIGFyZSBtZXQ6CisjCisjIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3Vy
Y2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0CisjICAgIG5vdGljZSwgdGhp
cyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4gCisjCisj
IDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJv
dmUgY29weXJpZ2h0CisjICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRo
ZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbgorIyAgICB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3Ig
b3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlCisjICAgIGRpc3RyaWJ1dGlvbi4KKyMK
KyMgMy4gVGhlIG5hbWUgIkNhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5IiBtdXN0IG5vdCBiZSB1
c2VkIHRvCisjICAgIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhp
cyBzb2Z0d2FyZSB3aXRob3V0CisjICAgIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi4gRm9yIHBl
cm1pc3Npb24gb3IgYW55IG90aGVyIGxlZ2FsCisjICAgIGRldGFpbHMsIHBsZWFzZSBjb250YWN0
ICAKKyMgICAgICBPZmZpY2Ugb2YgVGVjaG5vbG9neSBUcmFuc2ZlcgorIyAgICAgIENhcm5lZ2ll
IE1lbGxvbiBVbml2ZXJzaXR5CisjICAgICAgNTAwMCBGb3JiZXMgQXZlbnVlCisjICAgICAgUGl0
dHNidXJnaCwgUEEgIDE1MjEzLTM4OTAKKyMgICAgICAoNDEyKSAyNjgtNDM4NywgZmF4OiAoNDEy
KSAyNjgtNzM5NQorIyAgICAgIHRlY2gtdHJhbnNmZXJAYW5kcmV3LmNtdS5lZHUKKyMKKyMgNC4g
UmVkaXN0cmlidXRpb25zIG9mIGFueSBmb3JtIHdoYXRzb2V2ZXIgbXVzdCByZXRhaW4gdGhlIGZv
bGxvd2luZworIyAgICBhY2tub3dsZWRnbWVudDoKKyMgICAgIlRoaXMgcHJvZHVjdCBpbmNsdWRl
cyBzb2Z0d2FyZSBkZXZlbG9wZWQgYnkgQ29tcHV0aW5nIFNlcnZpY2VzCisjICAgICBhdCBDYXJu
ZWdpZSBNZWxsb24gVW5pdmVyc2l0eSAoaHR0cDovL3d3dy5jbXUuZWR1L2NvbXB1dGluZy8pLiIK
KyMKKyMgQ0FSTkVHSUUgTUVMTE9OIFVOSVZFUlNJVFkgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVT
IFdJVEggUkVHQVJEIFRPCisjIFRISVMgU09GVFdBUkUsIElOQ0xVRElORyBBTEwgSU1QTElFRCBX
QVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQorIyBBTkQgRklUTkVTUywgSU4gTk8gRVZFTlQg
U0hBTEwgQ0FSTkVHSUUgTUVMTE9OIFVOSVZFUlNJVFkgQkUgTElBQkxFCisjIEZPUiBBTlkgU1BF
Q0lBTCwgSU5ESVJFQ1QgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTCisj
IFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST00gTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywg
V0hFVEhFUiBJTgorIyBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1IgT1RIRVIg
VE9SVElPVVMgQUNUSU9OLCBBUklTSU5HCisjIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEgg
VEhFIFVTRSBPUiBQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLgorIworZXhlYyBwZXJsIC14
IC1TICQwICR7MSsiJEAifSAjIC0qLXBlcmwtKi0KKyMhcGVybCAtdworCitpZiAoJF0gIX4gL141
XC4uKi8pIHsKKyAgIyB1aC1vaC4gdGhpcyBpc24ndCBwZXJsIDUuCisgIGZvcmVhY2ggKHNwbGl0
KC86LywgJEVOVntQQVRIfSkpIHsgIyB0cnkgdG8gZmluZCAicGVybDUiLgorICAgIGV4ZWMoIiRf
L3Blcmw1IiwgIi14IiwgIi1TIiwgJDAsIEBBUkdWKSBpZiAoLXggIiRfL3Blcmw1Iik7CisgIH0K
KyAgIyB3ZSBmYWlsZWQuIGJhaWwuCisgIGRpZSAiWW91ciBwZXJsIGlzIHRvbyBvbGQ7IEkgbmVl
ZCBwZXJsIDUuXG4iOworfQorCisjIGxvYWQgdGhlIHJlYWwgc2NyaXB0LiB0aGlzIGlzIGlzb2xh
dGVkIGluIGFuICdldmFsJyBzbyBwZXJsNCB3b24ndAorIyBjaG9rZSBvbiB0aGUgcGVybDUtaXNt
cy4KK2V2YWwgam9pbigiXG4iLCA8REFUQT4pOworaWYgKCRAKSB7IGRpZSAiJEAiOyB9CisKK19f
RU5EX18KK3JlcXVpcmUgNTsKKwordXNlIHN0cmljdDsKKworbXkgJG1vZGUgPSAwOworbXkgJHNh
dmUgPSAiIjsKKworZGllICJ3cm9uZyBudW1iZXIgb2YgYXJndW1lbnRzIiBpZiAoJCNBUkdWICE9
IDEpOworbXkgKCRjZmlsZSwgJGhmaWxlKSA9IEBBUkdWOworCitvcGVuIENGSUxFLCAiPiRjZmls
ZSI7CitvcGVuIEhGSUxFLCAiPiRoZmlsZSI7CisKK215ICRibGFuayA9ICIiOworbXkgJHZlcnNp
b24gPSAiXCRSZXZpc2lvbiRibGFuayI7CiskdmVyc2lvbiA9fiBzLy5SZXZpc2lvbjogKC4qKSAv
JDEvOworcHJpbnQgSEZJTEUgIi8qIGF1dG8tZ2VuZXJhdGVkIGJ5IGNvbmZpZzJoZWFkZXIgJHZl
cnNpb24gKi9cbiI7CitwcmludCBDRklMRSAiLyogYXV0by1nZW5lcmF0ZWQgYnkgY29uZmlnMmhl
YWRlciAkdmVyc2lvbiAqL1xuIjsKKworcHJpbnQgSEZJTEUgIiNpZm5kZWYgSU5DTFVERURfSU1B
UE9QVFNfSFxuIjsKK3ByaW50IEhGSUxFICIjZGVmaW5lIElOQ0xVREVEX0lNQVBPUFRTX0hcbiI7
CitwcmludCBIRklMRSAiXG4iOworCisjIHByb3RvdHlwZXMKK215ICRvcHQ7CisKK3ByaW50IEhG
SUxFICJlbnVtIG9wdHR5cGUge1xuIjsKK2ZvcmVhY2ggJG9wdCAoIk9QVF9OT1RPUFQiLCJPUFRf
U1RSSU5HIiwiT1BUX0lOVCIsIk9QVF9TV0lUQ0giKSB7CisgICAgcHJpbnQgSEZJTEUgIiAgJG9w
dCxcbiI7Cit9CitwcmludCBIRklMRSAifTtcblxuIjsKKworcHJpbnQgSEZJTEUgPDxFT0YKK2Vu
dW0gaW1hcG9wdCB7CisgIElNQVBPUFRfWkVSTyA9IDAsCitFT0YKKyAgICA7CisKK3ByaW50IENG
SUxFIDw8RU9GCisvKiBETyBOT1QgRURJVCAqLworLyogVEhJUyBGSUxFIEFVVE9NQVRJQ0FMTFkg
R0VORVJBVEVEIEJZIGNvbmZpZzJoZWFkZXIgJHZlcnNpb24gKi8KKyNpbmNsdWRlIDxjb25maWcu
aD4KKyNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KKyNpZmRlZiBIQVZFX1VOSVNURF9ICisjaW5jbHVk
ZSA8dW5pc3RkLmg+CisjZW5kaWYKKyNpbmNsdWRlIDxzeXNsb2cuaD4KKyNpbmNsdWRlIDxjb21f
ZXJyLmg+CisjaW5jbHVkZSA8c3RkbGliLmg+CisjaW5jbHVkZSA8c3RyaW5nLmg+CisjaW5jbHVk
ZSAiaW1hcG9wdHMuaCIKKworc3RydWN0IGltYXBvcHRfcyBpbWFwb3B0c1tdID0KK3sKKyAgICB7
IElNQVBPUFRfWkVSTywgIiIsIDAsIHsgTlVMTCB9LCBPUFRfTk9UT1BUIH0sCitFT0YKKyAgICA7
CisKKyMgb3V0cHV0IGVudW1lcmF0aW9uCisKK3doaWxlICg8U1RESU4+KSB7CisgICAgbmV4dCBp
ZiAoL15cIy8pOworICAgICMgbG9vayBmb3IgeyBvcHRpb24sIGRlZmF1bHQsIHR5cGUgfQorCisg
ICAgIyBOb3RlIHRoYXQgdGhlIGNvZGUgd2Ugb3V0cHV0IGhhcyB0byBwbGF5IGludGVyZXN0aW5n
IGdhbWVzIHRvIGdldAorICAgICMgdGhlIHVuaW9uIHRvIGluaXRpbGl6ZSBpdHNlbGYgaW4gYSBz
eW50YWN0aWNseSB2YWxpZCBtYW5uZXIuCisgICAgIyBOYW1lbHksIHdlIG5lZWQgdG8gaW5pdGls
aXplIHRoZSB1bmlvbiBpdHNlbGYsIG5vdCB0aGUgbWVtYmVycyBvZgorICAgICMgdGhlIHVuaW9u
LCBhbmQgd2UgbmVlZCB0byBlbnN1cmUgd2UgYXJlIGluaXRpbGl6aW5nIHRoZSB1bmlvbiB3aXRo
CisgICAgIyBzb210aGluZyBvZiBhIHR5cGUgdGhhdCBpcyBpbiB0aGUgdW5pb24uCisgICAgaWYg
KG18e1xzKlwiKC4qPylcIlxzKixccyooXCI/Lio/XCI/KVxzKixccyooLio/KVxzKn18KSB7CisJ
bXkgJG9wdCA9ICQxOworCW15ICR2YWx1ZTsKKworCXByaW50IEhGSUxFICIgIElNQVBPUFRfIiwg
dWMoJG9wdCksICIsXG4iOworCisJaWYoJDMgZXEgIlNUUklORyIpIHsKKwkgICAgJHZhbHVlID0g
Iih1bmlvbiBjb25maWdfdmFsdWUpKChjb25zdCBjaGFyICopJDIpIjsKKwl9IGVsc2UgeworCSAg
ICAkdmFsdWUgPSAiKHVuaW9uIGNvbmZpZ192YWx1ZSkoKGludCkkMikiOworCX0KKworCXByaW50
IENGSUxFICIgIHsgSU1BUE9QVF8iLCB1Yygkb3B0KSwgIiwgXCIkMVwiLCAwLCAkdmFsdWUsIE9Q
VF8kMyB9LFxuIjsKKyAgICB9IGVsc2UgeworCSNjaG9tcDsKKwkjcHJpbnQgInJlamVjdGVkICck
XydcbiI7CisgICAgfQorfQorCitwcmludCBIRklMRSA8PEVPRgorICBJTUFQT1BUX0xBU1QKK307
CitleHRlcm4gc3RydWN0IGltYXBvcHRfcyBpbWFwb3B0c1tdOwordW5pb24gY29uZmlnX3ZhbHVl
IHsKKyAgICAgICBjb25zdCBjaGFyICpzOworICAgICAgIGludCBpOworICAgICAgIGludCBiOwor
fTsKK3N0cnVjdCBpbWFwb3B0X3MgeworICAgIGNvbnN0IGVudW0gaW1hcG9wdCBvcHQ7CisgICAg
Y29uc3QgY2hhciAqb3B0bmFtZTsKKyAgICBpbnQgc2VlbjsKKyAgICB1bmlvbiBjb25maWdfdmFs
dWUgdmFsOworICAgIGNvbnN0IGVudW0gb3B0dHlwZSB0OworfTsKKyNlbmRpZiAvKiBJTkNMVURF
RF9JTUFQT1BUSU9OU19IICovCitFT0YKKyAgICA7CisKK3ByaW50IENGSUxFIDw8RU9GCisgIHsg
SU1BUE9QVF9MQVNULCBOVUxMLCAwLCB7IE5VTEwgfSwgT1BUX05PVE9QVCB9Cit9OworCisvKiBj
IGNvZGUgZ29lcyBoZXJlICovCisKK0VPRgorOwpJbmRleDogdG9vbHMvY29uZmlnMm1hbgo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09ClJDUyBmaWxlOiBjb25maWcybWFuCmRpZmYgLU4gY29uZmlnMm1hbgotLS0gL2Rldi9u
dWxsCVR1ZSBNYXkgIDUgMTY6MzI6MjcgMTk5OAorKysgY29uZmlnMm1hbglNb24gSnVuIDE3IDE2
OjAyOjM0IDIwMDIKQEAgLTAsMCArMSwxMTEgQEAKKyMhL2Jpbi9zaAorIyAkSWQkCisjCisjIENv
cHlyaWdodCAoYykgMjAwMSBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eS4gIEFsbCByaWdodHMg
cmVzZXJ2ZWQuCisjCisjIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5h
cnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAorIyBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQg
cHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKKyMgYXJlIG1ldDoKKyMKKyMg
MS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBj
b3B5cmlnaHQKKyMgICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZv
bGxvd2luZyBkaXNjbGFpbWVyLiAKKyMKKyMgMi4gUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBm
b3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQKKyMgICAgbm90aWNlLCB0aGlz
IGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluCisjICAg
IHRoZSBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0
aGUKKyMgICAgZGlzdHJpYnV0aW9uLgorIworIyAzLiBUaGUgbmFtZSAiQ2FybmVnaWUgTWVsbG9u
IFVuaXZlcnNpdHkiIG11c3Qgbm90IGJlIHVzZWQgdG8KKyMgICAgZW5kb3JzZSBvciBwcm9tb3Rl
IHByb2R1Y3RzIGRlcml2ZWQgZnJvbSB0aGlzIHNvZnR3YXJlIHdpdGhvdXQKKyMgICAgcHJpb3Ig
d3JpdHRlbiBwZXJtaXNzaW9uLiBGb3IgcGVybWlzc2lvbiBvciBhbnkgb3RoZXIgbGVnYWwKKyMg
ICAgZGV0YWlscywgcGxlYXNlIGNvbnRhY3QgIAorIyAgICAgIE9mZmljZSBvZiBUZWNobm9sb2d5
IFRyYW5zZmVyCisjICAgICAgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkKKyMgICAgICA1MDAw
IEZvcmJlcyBBdmVudWUKKyMgICAgICBQaXR0c2J1cmdoLCBQQSAgMTUyMTMtMzg5MAorIyAgICAg
ICg0MTIpIDI2OC00Mzg3LCBmYXg6ICg0MTIpIDI2OC03Mzk1CisjICAgICAgdGVjaC10cmFuc2Zl
ckBhbmRyZXcuY211LmVkdQorIworIyA0LiBSZWRpc3RyaWJ1dGlvbnMgb2YgYW55IGZvcm0gd2hh
dHNvZXZlciBtdXN0IHJldGFpbiB0aGUgZm9sbG93aW5nCisjICAgIGFja25vd2xlZGdtZW50Ogor
IyAgICAiVGhpcyBwcm9kdWN0IGluY2x1ZGVzIHNvZnR3YXJlIGRldmVsb3BlZCBieSBDb21wdXRp
bmcgU2VydmljZXMKKyMgICAgIGF0IENhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5IChodHRwOi8v
d3d3LmNtdS5lZHUvY29tcHV0aW5nLykuIgorIworIyBDQVJORUdJRSBNRUxMT04gVU5JVkVSU0lU
WSBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lUSCBSRUdBUkQgVE8KKyMgVEhJUyBTT0ZUV0FS
RSwgSU5DTFVESU5HIEFMTCBJTVBMSUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZCisj
IEFORCBGSVRORVNTLCBJTiBOTyBFVkVOVCBTSEFMTCBDQVJORUdJRSBNRUxMT04gVU5JVkVSU0lU
WSBCRSBMSUFCTEUKKyMgRk9SIEFOWSBTUEVDSUFMLCBJTkRJUkVDVCBPUiBDT05TRVFVRU5USUFM
IERBTUFHRVMgT1IgQU5ZIERBTUFHRVMKKyMgV0hBVFNPRVZFUiBSRVNVTFRJTkcgRlJPTSBMT1NT
IE9GIFVTRSwgREFUQSBPUiBQUk9GSVRTLCBXSEVUSEVSIElOCisjIEFOIEFDVElPTiBPRiBDT05U
UkFDVCwgTkVHTElHRU5DRSBPUiBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcKKyMgT1VU
IE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SIFBFUkZPUk1BTkNFIE9GIFRISVMg
U09GVFdBUkUuCisjCitleGVjIHBlcmwgLXggLVMgJDAgJHsxKyIkQCJ9ICMgLSotcGVybC0qLQor
IyFwZXJsIC13CisKK2lmICgkXSAhfiAvXjVcLi4qLykgeworICAjIHVoLW9oLiB0aGlzIGlzbid0
IHBlcmwgNS4KKyAgZm9yZWFjaCAoc3BsaXQoLzovLCAkRU5We1BBVEh9KSkgeyAjIHRyeSB0byBm
aW5kICJwZXJsNSIuCisgICAgZXhlYygiJF8vcGVybDUiLCAiLXgiLCAiLVMiLCAkMCwgQEFSR1Yp
IGlmICgteCAiJF8vcGVybDUiKTsKKyAgfQorICAjIHdlIGZhaWxlZC4gYmFpbC4KKyAgZGllICJZ
b3VyIHBlcmwgaXMgdG9vIG9sZDsgSSBuZWVkIHBlcmwgNS5cbiI7Cit9CisKKyMgbG9hZCB0aGUg
cmVhbCBzY3JpcHQuIHRoaXMgaXMgaXNvbGF0ZWQgaW4gYW4gJ2V2YWwnIHNvIHBlcmw0IHdvbid0
CisjIGNob2tlIG9uIHRoZSBwZXJsNS1pc21zLgorZXZhbCBqb2luKCJcbiIsIDxEQVRBPik7Citp
ZiAoJEApIHsgZGllICIkQCI7IH0KKworX19FTkRfXworcmVxdWlyZSA1OworCit1c2Ugc3RyaWN0
OworCitteSAkbW9kZSA9IDA7CitteSAkc2F2ZSA9ICIiOworCitteSAkYmxhbmsgPSAiIjsKK215
ICR2ZXJzaW9uID0gIlwkUmV2aXNpb24kYmxhbmsiOworJHZlcnNpb24gPX4gcy8uUmV2aXNpb246
ICguKikgLyQxLzsKK3ByaW50ICIuXFxcIiAtKi0gbnJvZmYgLSotXG4iOworcHJpbnQgIi5cXFwi
IGF1dG8tZ2VuZXJhdGVkIGJ5IGNvbmZpZzJtYW4gJHZlcnNpb25cbiI7CisKK3doaWxlICg8Pikg
eworICAgIGlmICgkbW9kZSA9PSAwKSB7CisJIyBsb29rIGZvciB7IG9wdGlvbiwgZGVmYXVsdCwg
dHlwZSB9OyBkb24ndCBvdXRwdXQgdW50aWwgd2UKKwkjIGhpdCBhIGNvbW1lbnQKKwlpZiAobXx7
XHMqXCIoLio/KVwiXHMqLFxzKlwiPyguKj8pXCI/XHMqLFxzKiguKj8pXHMqfXwpIHsKKwkgICAg
bXkgJG9wdCA9ICQxOworCSAgICBteSAkZGVmID0gJDIgZXEgIk5VTEwiID8gIjxub25lPiIgOiAk
MjsKKwkgICAgaWYgKCRkZWYgZXEgIiIpIHsgJGRlZiA9ICI8ZW1wdHkgc3RyaW5nPiIgfQorCSAg
ICAkc2F2ZSA9ICIuSVAgXCJcXGZCJDE6XFxmUiAkZGVmXCIgNVxuIjsKKwl9CisKKwkjIGxvb2sg
Zm9yIHNpbmdsZS1saW5lIGNvbW1lbnQKKwllbHNpZiAobXwvXCpccyooLiopXHMqXCovfCkgewor
CSAgICBwcmludCAkc2F2ZTsgJHNhdmUgPSAiIjsKKwkgICAgcHJpbnQgIiQxXG4iOworCX0KKwor
CSMgbG9vayBmb3IgLyogdG8gc2hpZnQgaW50byBwYXNzdGhyb3VnaCBtb2RlOyBwcmludCBjdXJy
ZW50CisJIyBjYWNoZWQgb3B0aW9uIGhlYWRlciBpZiBhbnkKKwllbHNpZiAobXwvXCpccyooLiop
fCkgeworCSAgICBwcmludCAkc2F2ZTsgJHNhdmUgPSAiIjsKKwkgICAgcHJpbnQgJDE7CisJICAg
ICRtb2RlID0gMTsKKwl9CisJZWxzZSB7CisJICAgIGNob21wOworCSAgICAjcHJpbnQgImlnbm9y
aW5nICckXydcbiI7CisJfQorICAgIH0gZWxzaWYgKCRtb2RlID09IDEpIHsKKwkjIHBhc3N0aHJ1
OyBsb29rIGZvciAqLyB0byBlbmQKKwlpZiAobXxccyooLiopXCovfCkgeworCSAgICBwcmludCAk
MTsKKwkgICAgcHJpbnQgIlxuIjsKKwkgICAgJG1vZGUgPSAwOyAjIGJhY2sgdG8gc2VhcmNoIG1v
ZGUKKwl9IGVsc2lmIChtfFxzKiguKilccyp8KSB7CisJICAgIHByaW50ICIkMVxuIjsKKwl9Cisg
ICAgfQorfQo=
</data>        

          </attachment>
      

    </bug>

</bugzilla>