<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>2690</bug_id>
          
          <creation_ts>2005-07-07 18:19 EDT</creation_ts>
          <short_desc>integer overflow at 2^32 in quota calculations</short_desc>
          <delta_ts>2010-10-18 12:43:08 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>IMAP</component>
          <version>2.2.x</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>WONTFIX</resolution>
          
          
          
          
          <priority>P2</priority>
          <bug_severity>bug</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="James Ralston">ralston@pobox.com</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          <cc>darrell@pdx.edu</cc>
    
    <cc>mlprecords@yahoo.de</cc>
    
    <cc>wes@umich.edu</cc>
          <qa_contact name="The Cyrus Bugzilla List">cyrus-bugzilla@lists.andrew.cmu.edu</qa_contact>

      

      

      
          <long_desc isprivate="0">
            <who name="James Ralston">ralston@pobox.com</who>
            <bug_when>2005-07-07 18:19:12 EDT</bug_when>
            <thetext>The calculation of used quota is performed in units of bytes, using an unsigned
long counter.  E.g., from imap/quota.h:

struct quota {
    char *root;

    /* Information in quota entry */
    unsigned long used;
    int limit;                  /* in QUOTA_UNITS */
};

This means that any quota greater than 4GB is effectively unlimited, because due
to overflow the calculation of the quota used will always return the modulus of
the actual quota used with 4GB.

Fix: use uint64_t or uintmax_t, with fallback for non-C99 environments.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">ken@oceana.com</who>
            <bug_when>2005-07-17 19:43:18 EDT</bug_when>
            <thetext>Created an attachment (id=362)
64-bit quota patch

Also requires lib/byteorder64.[ch] from CVS:

https://bugzilla.andrew.cmu.edu/cgi-bin/cvsweb.cgi/~checkout~/src/cyrus/lib/Attic/byteorder64.c?rev=1.1.2.1&amp;content-type=text/plain&amp;hideattic=0

https://bugzilla.andrew.cmu.edu/cgi-bin/cvsweb.cgi/~checkout~/src/cyrus/lib/Attic/byteorder64.h?rev=1.1.2.2&amp;content-type=text/plain&amp;hideattic=0</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ondrej Sury">ondrej@sury.org</who>
            <bug_when>2005-08-30 06:25:59 EDT</bug_when>
            <thetext>Created an attachment (id=373)
Patch to add 64bit quotas to 2.2.12 (including byteorder64.[ch])
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Mase Barnes">mlprecords@yahoo.de</who>
            <bug_when>2005-11-02 09:30:41 EDT</bug_when>
            <thetext>Hi,

when I want to install cyrus 2.2.12 with this patch I get this error:

gcc -c -I.. -I./../lib -I../et -I./../sieve   -I/usr/lib/include -DHAVE_CONFIG_H
 -g -O2 \
append.c
gcc -c -I.. -I./../lib -I../et -I./../sieve   -I/usr/lib/include -DHAVE_CONFIG_H
 -g -O2 \
mailbox.c
mailbox.c: In function `mailbox_write_index_header&apos;:
mailbox.c:1186: error: `OFFSET_QUOTA_RESERVED_FIELD&apos; undeclared (first use in
this function)
mailbox.c:1186: error: (Each undeclared identifier is reported only once
mailbox.c:1186: error: for each function it appears in.)
make[1]: *** [mailbox.o] Error 1
make[1]: Leaving directory `/source/cyrus-imapd-2.2.12-patch/imap&apos;
make: *** [all] Error 1

compiled with: 
./configure --prefix=/usr --sysconfdir=/etc --localstatedir=/var \
--with-sasl=/usr/lib --with-perl=/usr/bin/perl \
--with-auth=unix</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">murch@andrew.cmu.edu</who>
            <bug_when>2005-11-02 10:04:41 EDT</bug_when>
            <thetext>You didn&apos;t patch mailbox.c correctly because OFFSET_QUOTA_RESERVED_FIELD is
replaced by OFFSET_QUOTA_MAILBOX_USED64 in the patch.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Mase Barnes">mlprecords@yahoo.de</who>
            <bug_when>2005-11-17 05:48:49 EDT</bug_when>
            <thetext>Sorry for my late answer, you were right, I&apos;ve played around in the source after
the origin error. The real one is (after correct patching 2.2.12):

gcc -c -I.. -I./../lib -I../et -I./../sieve    -DHAVE_CONFIG_H  -g -O2 \
mailbox.c
mailbox.c: In function `mailbox_write_index_header&apos;:
mailbox.c:1203: error: invalid operands to binary *
make[1]: *** [mailbox.o] Error 1
make[1]: Leaving directory `/cyrus-imapd-2.2.12/imap&apos;
make: *** [all] Error 1

(Only running ./configure &amp;&amp; make)

</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="jean-sebastien">jsh@interlug.net</who>
            <bug_when>2006-07-06 00:04:51 EDT</bug_when>
            <thetext>The problem is still here in the 2.2.13 version.
The patch seems to be incorrect/corrupt when applying in cyrus-imap-2.2.12.

 </thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="James Ralston">ralston@pobox.com</who>
            <bug_when>2006-08-22 12:20:37 EDT</bug_when>
            <thetext>Created an attachment (id=456)
64-bit quota patch for 2.2.12, including byteorder64.[ch]

Ondrej&apos;s combined patch doesn&apos;t seem to apply cleanly to virgin 2.2.12 sources.


This patch applies and compiles cleanly (at least on Fedora Core 5 x86_64)
against virgin 2.2.12 source; it includes the necessary byteorder64.[ch] files.


(I can&apos;t vouch for whether the server actually operates correctly once this
patch is applied, as we&apos;ve decided to move to 2.3 instead of applying the
patch.)
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Wes Craig">wes@umich.edu</who>
            <bug_when>2008-10-07 13:05:19 EDT</bug_when>
            <thetext>If this is still an issue, please open a new report against a more recent version of cyrus.  Thanks!</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="James Ralston">ralston@pobox.com</who>
            <bug_when>2008-10-07 13:43:26 EDT</bug_when>
            <thetext>I can&apos;t confirm whether the patch works for 2.2, but this problem was definitely fixed for 2.3.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>362</attachid>
            <date>2005-07-17 19:43 EDT</date>
            <desc>64-bit quota patch</desc>
            <filename>64bitquota.diff</filename>
            <type>text/plain</type>
            <size>26920</size>
            <attacher>ken@oceana.com</attacher>
            
              <data encoding="base64">LS0tLS0tLS0tLS0tLS0tLS0tLS0tClBhdGNoU2V0IDYwNDYKRGF0ZTogMjAwNC8wOC8wOSAxOTo1
MToxNQpBdXRob3I6IGtlbjMKTG9nOgpzdXBwb3J0IGZvciA2NC1iaXQgcXVvdGEgdXNhZ2UuCnF1
b3RhIGxpbWl0IGlzIHN0aWxsIDMyLWJpdCAoMUtCIHVuaXRzKSB5aWVsZGluZyAyVEIgcXVvdGEK
Ck1lbWJlcnM6IAoJY29uZmlndXJlLmluOjEuMjY4LjIuMTMtPjEuMjY4LjIuMTQgW2N5cnVzLWlt
YXBkLTJfM10KCWltYXAvYXBwZW5kLmM6MS4xMDIuMi43LT4xLjEwMi4yLjggW2N5cnVzLWltYXBk
LTJfM10KCWltYXAvaW1hcGQuYzoxLjQ0My4yLjM2LT4xLjQ0My4yLjM3IFtjeXJ1cy1pbWFwZC0y
XzNdCglpbWFwL21haWxib3guYzoxLjE0Ny4yLjE2LT4xLjE0Ny4yLjE3IFtjeXJ1cy1pbWFwZC0y
XzNdCglpbWFwL21haWxib3guaDoxLjc3LjIuNy0+MS43Ny4yLjggW2N5cnVzLWltYXBkLTJfM10K
CWltYXAvbWJkdW1wLmM6MS4yNi4yLjYtPjEuMjYuMi43IFtjeXJ1cy1pbWFwZC0yXzNdCglpbWFw
L21iZXhhbWluZS5jOjEuNS4yLjMtPjEuNS4yLjQgW2N5cnVzLWltYXBkLTJfM10KCWltYXAvbWJv
eGxpc3QuYzoxLjIyMS4yLjE3LT4xLjIyMS4yLjE4IFtjeXJ1cy1pbWFwZC0yXzNdCglpbWFwL3F1
b3RhLmM6MS40OC4yLjYtPjEuNDguMi43IFtjeXJ1cy1pbWFwZC0yXzNdCglpbWFwL3F1b3RhLmg6
MS4xLjIuMi0+MS4xLjIuMyBbY3lydXMtaW1hcGQtMl8zXQoJaW1hcC9xdW90YV9kYi5jOjEuMS4y
LjItPjEuMS4yLjMgW2N5cnVzLWltYXBkLTJfM10KCWltYXAvcmVjb25zdHJ1Y3QuYzoxLjgxLjIu
OS0+MS44MS4yLjEwIFtjeXJ1cy1pbWFwZC0yXzNdCglsaWIvTWFrZWZpbGUuaW46MS41NS4yLjUt
PjEuNTUuMi42IFtjeXJ1cy1pbWFwZC0yXzNdCglsaWIvYnl0ZW9yZGVyNjQuYzoxLjEtPjEuMS4y
LjEgW2N5cnVzLWltYXBkLTJfM10KCWxpYi9ieXRlb3JkZXI2NC5oOjEuMS0+MS4xLjIuMSBbY3ly
dXMtaW1hcGQtMl8zXQoJbGliL3Byb3QuYzoxLjgyLjIuNC0+MS44Mi4yLjUgW2N5cnVzLWltYXBk
LTJfM10KCkluZGV4OiBjb25maWd1cmUuaW4KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRy
ZXcvc3lzdGVtL2N2cy9zcmMvY3lydXMvY29uZmlndXJlLmluLHYKcmV0cmlldmluZyByZXZpc2lv
biAxLjI2OC4yLjEzCnJldHJpZXZpbmcgcmV2aXNpb24gMS4yNjguMi4xNApkaWZmIC11IC11IC1y
MS4yNjguMi4xMyAtcjEuMjY4LjIuMTQKLS0tIGNvbmZpZ3VyZS5pbgkxMiBKdWwgMjAwNCAyMDoy
NToyNSAtMDAwMAkxLjI2OC4yLjEzCisrKyBjb25maWd1cmUuaW4JOSBBdWcgMjAwNCAxODo1MTox
NSAtMDAwMAkxLjI2OC4yLjE0CkBAIC00Miw3ICs0Miw3IEBACiAKIGRubAogZG5sIGNvbmZpZ3Vy
ZS5pbiBmb3IgdGhlIEN5cnVzIGltYXBkCi1kbmwgJElkOiBjb25maWd1cmUuaW4sdiAxLjI2OC4y
LjEzIDIwMDQvMDcvMTIgMjA6MjU6MjUga2VuMyBFeHAgJAorZG5sICRJZDogY29uZmlndXJlLmlu
LHYgMS4yNjguMi4xNCAyMDA0LzA4LzA5IDE4OjUxOjE1IGtlbjMgRXhwICQKIGRubAogCiAKQEAg
LTk5LDYgKzk5LDE1IEBACiBmaQogQUNfQ19JTkxJTkUKIAorZG5sIENoZWNrIGlmIGBsb25nIGxv
bmcgaW50JyBpcyBhdmFpbGFibGUKK0FDX0NIRUNLX1NJWkVPRihsb25nIGxvbmcgaW50KQorQUNf
Q0hFQ0tfU0laRU9GKHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQpCitpZiB0ZXN0ICIkYWNfY3Zfc2l6
ZW9mX2xvbmdfbG9uZ19pbnQiIC1lcSA4IC1hIFwKKyAgICAgICAgIiRhY19jdl9zaXplb2ZfdW5z
aWduZWRfbG9uZ19sb25nX2ludCIgLWVxIDg7IHRoZW4KKyAgQUNfREVGSU5FKEhBVkVfTE9OR19M
T05HX0lOVCxbXSxbRG9lcyB0aGUgY29tcGlsZXIgc3VwcG9ydCBsb25nIGxvbmcgaW50P10pCisg
IEFDX0NfQklHRU5ESUFOCitmaQorCiBDTVVfQ19fX0FUVFJJQlVURV9fCiBDTVVfQ19GUElDCiAK
QEAgLTEwMjUsNyArMTAzNCw3IEBACiBBQ19TVUJTVChQRVJMKQogCiBBSF9UT1AoWwotLyogJElk
OiBjb25maWd1cmUuaW4sdiAxLjI2OC4yLjEzIDIwMDQvMDcvMTIgMjA6MjU6MjUga2VuMyBFeHAg
JCAqLworLyogJElkOiBjb25maWd1cmUuaW4sdiAxLjI2OC4yLjE0IDIwMDQvMDgvMDkgMTg6NTE6
MTUga2VuMyBFeHAgJCAqLwogLyogCiAgKiBDb3B5cmlnaHQgKGMpIDE5OTgtMjAwMyBDYXJuZWdp
ZSBNZWxsb24gVW5pdmVyc2l0eS4gIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAgKgpJbmRleDogaW1h
cC9hcHBlbmQuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3Ny
Yy9jeXJ1cy9pbWFwL2FwcGVuZC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjEwMi4yLjcKcmV0
cmlldmluZyByZXZpc2lvbiAxLjEwMi4yLjgKZGlmZiAtdSAtdSAtcjEuMTAyLjIuNyAtcjEuMTAy
LjIuOAotLS0gaW1hcC9hcHBlbmQuYwkxOCBKdW4gMjAwNCAxNjoxMzozOCAtMDAwMAkxLjEwMi4y
LjcKKysrIGltYXAvYXBwZW5kLmMJOSBBdWcgMjAwNCAxODo1MToxNiAtMDAwMAkxLjEwMi4yLjgK
QEAgLTEsNSArMSw1IEBACiAvKiBhcHBlbmQuYyAtLSBSb3V0aW5lcyBmb3IgYXBwZW5kaW5nIG1l
c3NhZ2VzIHRvIGEgbWFpbGJveAotICogJElkOiBhcHBlbmQuYyx2IDEuMTAyLjIuNyAyMDA0LzA2
LzE4IDE2OjEzOjM4IGtlbjMgRXhwICQKKyAqICRJZDogYXBwZW5kLmMsdiAxLjEwMi4yLjggMjAw
NC8wOC8wOSAxODo1MToxNiBrZW4zIEV4cCAkCiAgKgogICogQ29weXJpZ2h0IChjKTE5OTgsIDIw
MDAgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkuICBBbGwgcmlnaHRzIHJlc2VydmVkLgogICoK
QEAgLTE0MCw3ICsxNDAsNyBAQAogICAgIGlmICghcikgewogCWlmIChtLnF1b3RhLmxpbWl0ID49
IDAgJiYgcXVvdGFjaGVjayA+PSAwICYmCiAJICAgIG0ucXVvdGEudXNlZCArIHF1b3RhY2hlY2sg
PiAKLQkgICAgKCh1bnNpZ25lZCkgbS5xdW90YS5saW1pdCAqIFFVT1RBX1VOSVRTKSkgeworCSAg
ICAoKHVxdW90YV90KSBtLnF1b3RhLmxpbWl0ICogUVVPVEFfVU5JVFMpKSB7CiAJICAgIHIgPSBJ
TUFQX1FVT1RBX0VYQ0VFREVEOwogCX0KICAgICB9CkBAIC0yMDgsNyArMjA4LDcgQEAKICAgICBp
ZiAoIXIpIHsKIAlpZiAoYXMtPm0ucXVvdGEubGltaXQgPj0gMCAmJiBxdW90YWNoZWNrID49IDAg
JiYKIAkgICAgYXMtPm0ucXVvdGEudXNlZCArIHF1b3RhY2hlY2sgPiAKLQkgICAgKCh1bnNpZ25l
ZCkgYXMtPm0ucXVvdGEubGltaXQgKiBRVU9UQV9VTklUUykpIHsKKwkgICAgKCh1cXVvdGFfdCkg
YXMtPm0ucXVvdGEubGltaXQgKiBRVU9UQV9VTklUUykpIHsKIAkgICAgcXVvdGFfYWJvcnQoJmFz
LT50aWQpOwogCSAgICBtYWlsYm94X2Nsb3NlKCZhcy0+bSk7CiAJICAgIHIgPSBJTUFQX1FVT1RB
X0VYQ0VFREVEOwpJbmRleDogaW1hcC9pbWFwZC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMv
YW5kcmV3L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvaW1hcGQuYyx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMS40NDMuMi4zNgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNDQzLjIuMzcKZGlmZiAtdSAt
dSAtcjEuNDQzLjIuMzYgLXIxLjQ0My4yLjM3Ci0tLSBpbWFwL2ltYXBkLmMJNSBBdWcgMjAwNCAx
NjoyMzozMSAtMDAwMAkxLjQ0My4yLjM2CisrKyBpbWFwL2ltYXBkLmMJOSBBdWcgMjAwNCAxODo1
MToxNiAtMDAwMAkxLjQ0My4yLjM3CkBAIC0zOCw3ICszOCw3IEBACiAgKiBPVVQgT0YgT1IgSU4g
Q09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1IgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4K
ICAqLwogCi0vKiAkSWQ6IGltYXBkLmMsdiAxLjQ0My4yLjM2IDIwMDQvMDgvMDUgMTY6MjM6MzEg
a2VuMyBFeHAgJCAqLworLyogJElkOiBpbWFwZC5jLHYgMS40NDMuMi4zNyAyMDA0LzA4LzA5IDE4
OjUxOjE2IGtlbjMgRXhwICQgKi8KIAogI2luY2x1ZGUgPGNvbmZpZy5oPgogCkBAIC0yOTQxLDEw
ICsyOTQxLDEwIEBACiAgCSAgICAgKi8KICAJICAgIGludCB3YXJuc2l6ZSA9IGNvbmZpZ19nZXRp
bnQoSU1BUE9QVF9RVU9UQVdBUk5LQik7CiAgCSAgICBpZiAod2FybnNpemUgPD0gMCB8fCB3YXJu
c2l6ZSA+PSBpbWFwZF9tYWlsYm94LT5xdW90YS5saW1pdCB8fAotIAkgICAgICAgIChpbnQpKChp
bWFwZF9tYWlsYm94LT5xdW90YS5saW1pdCAqIFFVT1RBX1VOSVRTKSAtCi0JCSAgICAgIGltYXBk
X21haWxib3gtPnF1b3RhLnVzZWQpIDwgKHdhcm5zaXplICogUVVPVEFfVU5JVFMpKSB7CisgCSAg
ICAgICAgKCh1cXVvdGFfdCkgKGltYXBkX21haWxib3gtPnF1b3RhLmxpbWl0IC0gd2FybnNpemUp
KSAqIFFVT1RBX1VOSVRTIDwgCisJCWltYXBkX21haWxib3gtPnF1b3RhLnVzZWQpIHsKIAkJdXNh
Z2UgPSAoKGRvdWJsZSkgaW1hcGRfbWFpbGJveC0+cXVvdGEudXNlZCAqIDEwMC4wKSAvIChkb3Vi
bGUpCi0JCSAgICAoaW1hcGRfbWFpbGJveC0+cXVvdGEubGltaXQgKiBRVU9UQV9VTklUUyk7CisJ
CSAgICAoKHVxdW90YV90KSBpbWFwZF9tYWlsYm94LT5xdW90YS5saW1pdCAqIFFVT1RBX1VOSVRT
KTsKIAkJaWYgKHVzYWdlID49IDEwMC4wKSB7CiAJCSAgICBwcm90X3ByaW50ZihpbWFwZF9vdXQs
ICIqIE5PIFtBTEVSVF0gJXNcclxuIiwKIAkJCQllcnJvcl9tZXNzYWdlKElNQVBfTk9fT1ZFUlFV
T1RBKSk7CkBAIC01NTkyLDcgKzU1OTIsNyBAQAogCXByaW50YXN0cmluZyhuYW1lKTsKIAlwcm90
X3ByaW50ZihpbWFwZF9vdXQsICIgKCIpOwogCWlmIChxdW90YS5saW1pdCA+PSAwKSB7Ci0JICAg
IHByb3RfcHJpbnRmKGltYXBkX291dCwgIlNUT1JBR0UgJWx1ICVkIiwKKwkgICAgcHJvdF9wcmlu
dGYoaW1hcGRfb3V0LCAiU1RPUkFHRSAiIFVRVU9UQV9UX0ZNVCAiICVkIiwKIAkJCXF1b3RhLnVz
ZWQvUVVPVEFfVU5JVFMsIHF1b3RhLmxpbWl0KTsKIAl9CiAJcHJvdF9wcmludGYoaW1hcGRfb3V0
LCAiKVxyXG4iKTsKQEAgLTU2OTUsNyArNTY5NSw3IEBACiAJCXByaW50YXN0cmluZyhtYWlsYm94
bmFtZSk7CiAJCXByb3RfcHJpbnRmKGltYXBkX291dCwgIiAoIik7CiAJCWlmIChtYWlsYm94LnF1
b3RhLmxpbWl0ID49IDApIHsKLQkJICAgIHByb3RfcHJpbnRmKGltYXBkX291dCwgIlNUT1JBR0Ug
JWx1ICVkIiwKKwkJICAgIHByb3RfcHJpbnRmKGltYXBkX291dCwgIlNUT1JBR0UgIiBVUVVPVEFf
VF9GTVQgIiAlZCIsCiAJCQkJbWFpbGJveC5xdW90YS51c2VkL1FVT1RBX1VOSVRTLAogCQkJCW1h
aWxib3gucXVvdGEubGltaXQpOwogCQl9CkluZGV4OiBpbWFwL21haWxib3guYwo9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL21haWxib3gu
Yyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xNDcuMi4xNgpyZXRyaWV2aW5nIHJldmlzaW9uIDEu
MTQ3LjIuMTcKZGlmZiAtdSAtdSAtcjEuMTQ3LjIuMTYgLXIxLjE0Ny4yLjE3Ci0tLSBpbWFwL21h
aWxib3guYwk1IEF1ZyAyMDA0IDE2OjIzOjQ0IC0wMDAwCTEuMTQ3LjIuMTYKKysrIGltYXAvbWFp
bGJveC5jCTkgQXVnIDIwMDQgMTg6NTE6MTkgLTAwMDAJMS4xNDcuMi4xNwpAQCAtMzgsNyArMzgs
NyBAQAogICogQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SIE9USEVSIFRPUlRJ
T1VTIEFDVElPTiwgQVJJU0lORwogICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUg
VVNFIE9SIFBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuCiAgKgotICogJElkOiBtYWlsYm94
LmMsdiAxLjE0Ny4yLjE2IDIwMDQvMDgvMDUgMTY6MjM6NDQga2VuMyBFeHAgJAorICogJElkOiBt
YWlsYm94LmMsdiAxLjE0Ny4yLjE3IDIwMDQvMDgvMDkgMTg6NTE6MTkga2VuMyBFeHAgJAogICoK
ICAqLwogCkBAIC04NCw2ICs4NCw3IEBACiAjaW5jbHVkZSAic2Vlbi5oIgogI2luY2x1ZGUgInV0
aWwuaCIKICNpbmNsdWRlICJ4bWFsbG9jLmgiCisjaW5jbHVkZSAiYnl0ZW9yZGVyNjQuaCIKIAog
c3RhdGljIGludCBtYWlsYm94X2RvaW5nX3JlY29uc3RydWN0ID0gMDsKICNkZWZpbmUgemVyb21h
aWxib3gobSkgeyBtZW1zZXQoJm0sIDAsIHNpemVvZihzdHJ1Y3QgbWFpbGJveCkpOyBcCkBAIC04
NzcsOCArODc4LDE2IEBACiAgICAgbWFpbGJveC0+bGFzdF91aWQgPQogCW50b2hsKCooKGJpdDMy
ICopKG1haWxib3gtPmluZGV4X2Jhc2UrT0ZGU0VUX0xBU1RfVUlEKSkpOwogCisjaWZkZWYgSEFW
RV9MT05HX0xPTkdfSU5UCisgICAgaWYgKG1haWxib3gtPm1pbm9yX3ZlcnNpb24gPiA1KSB7CisJ
LyogbmV3ZXIgdmVyc2lvbnMgbWF5IHVzZSA2NGJpdCBxdW90YXMgbm93ICovCisgICAgICAgIG1h
aWxib3gtPnF1b3RhX21haWxib3hfdXNlZCA9CisgICAgICAgICAgICBudG9obGwoKigoYml0NjQg
KikobWFpbGJveC0+aW5kZXhfYmFzZStPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VENjQpKSk7Cisg
ICAgfSBlbHNlCisjZWxzZQogICAgIG1haWxib3gtPnF1b3RhX21haWxib3hfdXNlZCA9CiAJbnRv
aGwoKigoYml0MzIgKikobWFpbGJveC0+aW5kZXhfYmFzZStPRkZTRVRfUVVPVEFfTUFJTEJPWF9V
U0VELXF1b3RhX3VwZ3JhZGVfb2Zmc2V0KSkpOworI2VuZGlmCiAKICAgICBpZiAobWFpbGJveC0+
c3RhcnRfb2Zmc2V0IDwgT0ZGU0VUX1BPUDNfTEFTVF9MT0dJTi1xdW90YV91cGdyYWRlX29mZnNl
dCtzaXplb2YoYml0MzIpKSB7CiAJbWFpbGJveC0+cG9wM19sYXN0X2xvZ2luID0gMDsKQEAgLTEy
ODAsOSArMTI4OSwxOCBAQAogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfRVhJU1RTKSkgPSBo
dG9ubChtYWlsYm94LT5leGlzdHMpOwogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfTEFTVF9B
UFBFTkREQVRFKSkgPSBodG9ubChtYWlsYm94LT5sYXN0X2FwcGVuZGRhdGUpOwogICAgICooKGJp
dDMyICopKGJ1ZitPRkZTRVRfTEFTVF9VSUQpKSA9IGh0b25sKG1haWxib3gtPmxhc3RfdWlkKTsK
LSAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1FVT1RBX1JFU0VSVkVEX0ZJRUxEKSkgPSBodG9u
bCgwKTsgLyogUkVTRVJWRUQgKi8KKworICAgIC8qIHF1b3RhcyBtYXkgYmUgNjRiaXQgbm93ICov
CisjaWZkZWYgSEFWRV9MT05HX0xPTkdfSU5UCisgICAgKigoYml0NjQgKikoYnVmK09GRlNFVF9R
VU9UQV9NQUlMQk9YX1VTRUQ2NCkpID0KKwlodG9ubGwobWFpbGJveC0+cXVvdGFfbWFpbGJveF91
c2VkKTsKKyNlbHNlCQorICAgIC8qIHplcm8gdGhlIHVudXNlZCAzMmJpdHMgKi8KKyAgICAqKChi
aXQzMiAqKShidWYrT0ZGU0VUX1FVT1RBX01BSUxCT1hfVVNFRDY0KSkgPSBodG9ubCgwKQogICAg
ICooKGJpdDMyICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VEKSkgPQogCWh0b25sKG1h
aWxib3gtPnF1b3RhX21haWxib3hfdXNlZCk7CisjZW5kaWYKKwogICAgICooKGJpdDMyICopKGJ1
ZitPRkZTRVRfUE9QM19MQVNUX0xPR0lOKSkgPSBodG9ubChtYWlsYm94LT5wb3AzX2xhc3RfbG9n
aW4pOwogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfVUlEVkFMSURJVFkpKSA9IGh0b25sKG1h
aWxib3gtPnVpZHZhbGlkaXR5KTsKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX0RFTEVURUQp
KSA9IGh0b25sKG1haWxib3gtPmRlbGV0ZWQpOwpAQCAtMTUzNSw5ICsxNTUzLDE4IEBACiAgICAg
KigoYml0MzIgKikoYnVmK09GRlNFVF9FWElTVFMpKSA9IGh0b25sKG1haWxib3gtPmV4aXN0cyk7
CiAgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9MQVNUX0FQUEVORERBVEUpKSA9IGh0b25sKG1h
aWxib3gtPmxhc3RfYXBwZW5kZGF0ZSk7CiAgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9MQVNU
X1VJRCkpID0gaHRvbmwobWFpbGJveC0+bGFzdF91aWQpOwotICAgIC8qIE9GRlNFVF9RVU9UQV9S
RVNFUlZFRF9GSUVMRCBsZWZ0IGFzIHplcm8gKi8KKworICAgIC8qIG5ld2VyIHZlcnNpb25zIG1h
eSB1c2UgNjRiaXQgcXVvdGFzICovCisjaWZkZWYgSEFWRV9MT05HX0xPTkdfSU5UCisgICAgKigo
Yml0NjQgKikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9YX1VTRUQ2NCkpID0KKwlodG9ubGwobWFp
bGJveC0+cXVvdGFfbWFpbGJveF91c2VkKTsKKyNlbHNlCQorICAgIC8qIHplcm8gdGhlIHVudXNl
ZCAzMmJpdHMgKi8KKyAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1FVT1RBX01BSUxCT1hfVVNF
RDY0KSkgPSBodG9ubCgwKTsKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1FVT1RBX01BSUxC
T1hfVVNFRCkpID0KIAlodG9ubChtYWlsYm94LT5xdW90YV9tYWlsYm94X3VzZWQpOworI2VuZGlm
CisKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1BPUDNfTEFTVF9MT0dJTikpID0gaHRvbmwo
bWFpbGJveC0+cG9wM19sYXN0X2xvZ2luKTsKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1VJ
RFZBTElESVRZKSkgPSBodG9ubChtYWlsYm94LT51aWR2YWxpZGl0eSk7CiAgICAgKigoYml0MzIg
KikoYnVmK09GRlNFVF9ERUxFVEVEKSkgPSBodG9ubChtYWlsYm94LT5kZWxldGVkKTsKQEAgLTE3
MTQsNyArMTc0MSw3IEBACiBzdGF0aWMgaW50IHByb2Nlc3NfcmVjb3JkcyhzdHJ1Y3QgbWFpbGJv
eCAqbWFpbGJveCwgRklMRSAqbmV3aW5kZXgsCiAJCQkgICBjb25zdCBjaGFyICppbmRleF9iYXNl
LCB1bnNpZ25lZCBsb25nIGV4aXN0cywKIAkJCSAgIHVuc2lnbmVkIGxvbmcgKmRlbGV0ZWQsIHVu
c2lnbmVkICpudW1kZWxldGVkLAotCQkJICAgdW5zaWduZWQgKnF1b3RhZGVsZXRlZCwgdW5zaWdu
ZWQgKm51bWFuc3dlcmVkZmxhZywKKwkJCSAgIHVxdW90YV90ICpxdW90YWRlbGV0ZWQsIHVuc2ln
bmVkICpudW1hbnN3ZXJlZGZsYWcsCiAJCQkgICB1bnNpZ25lZCAqbnVtZGVsZXRlZGZsYWcsIHVu
c2lnbmVkICpudW1mbGFnZ2VkZmxhZywKIAkJCSAgIEZJTEUgKm5ld2NhY2hlLCBzaXplX3QgKm5l
d19jYWNoZV90b3RhbF9zaXplLAogCQkJICAgaW50IGV4cHVuZ2VfZmQsIGxvbmcgbGFzdF9vZmZz
ZXQsCkBAIC0xODQwLDggKzE4NjcsMTMgQEAKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX0ZM
QUdHRUQpKSA9IGh0b25sKG5ld2ZsYWdnZWQpOwogCiAgICAgLyogRml4IHVwIHF1b3RhX21haWxi
b3hfdXNlZCAqLworI2lmZGVmIEhBVkVfTE9OR19MT05HX0lOVAorICAgICooKGJpdDY0ICopKGJ1
ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VENjQpKSA9CisJaHRvbmxsKG50b2hsbCgqKChiaXQ2
NCAqKShidWYrT0ZGU0VUX1FVT1RBX01BSUxCT1hfVVNFRDY0KSkpIC0gKnF1b3RhZGVsZXRlZCk7
CisjZWxzZQogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VEKSkg
PQogCWh0b25sKG50b2hsKCooKGJpdDMyICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VE
KSkpIC0gKnF1b3RhZGVsZXRlZCk7CisjZW5kaWYKIAogICAgIC8qIEZpeCB1cCBzdGFydCBvZmZz
ZXQgaWYgbmVjZXNzYXJ5ICovCiAgICAgaWYgKG1haWxib3gtPnN0YXJ0X29mZnNldCA8IElOREVY
X0hFQURFUl9TSVpFKSB7CkBAIC0xODgxLDcgKzE5MTMsOCBAQAogICAgIGNoYXIgZm5hbWVidWZu
ZXdbTUFYX01BSUxCT1hfUEFUSCsxXTsKICAgICBGSUxFICpuZXdpbmRleCA9IE5VTEwsICpuZXdj
YWNoZSA9IE5VTEwsICpuZXdleHB1bmdlaW5kZXggPSBOVUxMOwogICAgIHVuc2lnbmVkIGxvbmcg
KmRlbGV0ZWQgPSAwOwotICAgIHVuc2lnbmVkIG51bWRlbGV0ZWQgPSAwLCBxdW90YWRlbGV0ZWQg
PSAwOworICAgIHVuc2lnbmVkIG51bWRlbGV0ZWQgPSAwOworICAgIHVxdW90YV90IHF1b3RhZGVs
ZXRlZCA9IDA7CiAgICAgdW5zaWduZWQgbnVtYW5zd2VyZWRmbGFnID0gMDsKICAgICB1bnNpZ25l
ZCBudW1kZWxldGVkZmxhZyA9IDA7CiAgICAgdW5zaWduZWQgbnVtZmxhZ2dlZGZsYWcgPSAwOwpA
QCAtMjA0MSw3ICsyMDc0LDE2IEBACiAJCSooKGJpdDMyICopKGJ1ZitPRkZTRVRfQU5TV0VSRUQp
KSA9IGh0b25sKDApOwogCQkqKChiaXQzMiAqKShidWYrT0ZGU0VUX0RFTEVURUQpKSA9IGh0b25s
KDApOwogCQkqKChiaXQzMiAqKShidWYrT0ZGU0VUX0ZMQUdHRUQpKSA9IGh0b25sKDApOworCisJ
CS8qIHF1b3RhcyBtYXkgYmUgNjRiaXQgbm93ICovCisjaWZkZWYgSEFWRV9MT05HX0xPTkdfSU5U
CisJCSooKGJpdDY0ICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VENjQpKSA9IGh0b25s
bCgwKTsKKyNlbHNlCisJCS8qIHplcm8gdGhlIHVudXNlZCAzMmJpdHMgKi8KKwkJKigoYml0MzIg
KikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9YX1VTRUQ2NCkpID0gaHRvbmwoMCk7CiAJCSooKGJp
dDMyICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VEKSkgPSBodG9ubCgwKTsKKyNlbmRp
ZgorCiAJCSooKGJpdDMyICopKGJ1ZitPRkZTRVRfTEVBS0VEX0NBQ0hFKSkgPSBodG9ubCgwKTsK
IAogCQluID0gcmV0cnlfd3JpdGUoZXhwdW5nZV9mZCwgYnVmLCBtYWlsYm94LT5zdGFydF9vZmZz
ZXQpOwpAQCAtMjEyNyw3ICsyMTY5LDcgQEAKIAlpZiAoIXIpIHF1b3RhX2NvbW1pdCgmdGlkKTsK
IAllbHNlIHsKIAkgICAgc3lzbG9nKExPR19FUlIsCi0JCSAgICJMT1NUUVVPVEE6IHVuYWJsZSB0
byByZWNvcmQgZnJlZSBvZiAldSBieXRlcyBpbiBxdW90YSAlcyIsCisJCSAgICJMT1NUUVVPVEE6
IHVuYWJsZSB0byByZWNvcmQgZnJlZSBvZiAiIFVRVU9UQV9UX0ZNVCAiIGJ5dGVzIGluIHF1b3Rh
ICVzIiwKIAkJICAgcXVvdGFkZWxldGVkLCBtYWlsYm94LT5xdW90YS5yb290KTsKIAl9CiAgICAg
fQpAQCAtMjE4OCw4ICsyMjMwLDE0IEBACiAJKigoYml0MzIgKikoYnVmK09GRlNFVF9GTEFHR0VE
KSkgPSBodG9ubChuZXdmbGFnZ2VkKTsKIAogCS8qIEZpeCB1cCBxdW90YV9tYWlsYm94X3VzZWQg
Ki8KKyNpZmRlZiBIQVZFX0xPTkdfTE9OR19JTlQKKwkqKChiaXQ2NCAqKShidWYrT0ZGU0VUX1FV
T1RBX01BSUxCT1hfVVNFRDY0KSkgPQorCSAgICBodG9ubGwobnRvaGxsKCooKGJpdDY0ICopKGJ1
ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VENjQpKSkrcXVvdGFkZWxldGVkKTsKKyNlbHNlCiAJ
KigoYml0MzIgKikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9YX1VTRUQpKSA9CiAJICAgIGh0b25s
KG50b2hsKCooKGJpdDMyICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VEKSkpK3F1b3Rh
ZGVsZXRlZCk7CisjZW5kaWYKKwogCS8qIEZpeCB1cCBzdGFydCBvZmZzZXQgaWYgbmVjZXNzYXJ5
ICovCiAJaWYgKG1haWxib3gtPnN0YXJ0X29mZnNldCA8IElOREVYX0hFQURFUl9TSVpFKSB7CiAJ
ICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfU1RBUlRfT0ZGU0VUKSkgPSBodG9ubChJTkRFWF9I
RUFERVJfU0laRSk7CkBAIC0yNTM4LDcgKzI1ODYsNyBAQAogCXIgPSBxdW90YV93cml0ZSgmbWFp
bGJveC0+cXVvdGEsICZ0aWQpOwogCWlmIChyKSB7CiAJICAgIHN5c2xvZyhMT0dfRVJSLAotCQkg
ICAiTE9TVFFVT1RBOiB1bmFibGUgdG8gcmVjb3JkIGZyZWUgb2YgJWx1IGJ5dGVzIGluIHF1b3Rh
ICVzIiwKKwkJICAgIkxPU1RRVU9UQTogdW5hYmxlIHRvIHJlY29yZCBmcmVlIG9mICIgVVFVT1RB
X1RfRk1UICIgYnl0ZXMgaW4gcXVvdGEgJXMiLAogCQkgICBtYWlsYm94LT5xdW90YV9tYWlsYm94
X3VzZWQsIG1haWxib3gtPnF1b3RhLnJvb3QpOwogCX0KIAllbHNlCkBAIC0yNjUzLDcgKzI3MDEs
NyBAQAogCSAgICBzdHJjbXAob2xkbWFpbGJveC0+cXVvdGEucm9vdCwgbmV3bWFpbGJveC0+cXVv
dGEucm9vdCkgIT0gMCkgewogCSAgICBpZiAoIXIgJiYgbmV3bWFpbGJveC0+cXVvdGEubGltaXQg
Pj0gMCAmJgogCQluZXdtYWlsYm94LT5xdW90YS51c2VkICsgb2xkbWFpbGJveC0+cXVvdGFfbWFp
bGJveF91c2VkID4KLQkJKCh1bnNpZ25lZCkgbmV3bWFpbGJveC0+cXVvdGEubGltaXQgKiBRVU9U
QV9VTklUUykpIHsKKwkJKCh1cXVvdGFfdCkgbmV3bWFpbGJveC0+cXVvdGEubGltaXQgKiBRVU9U
QV9VTklUUykpIHsKIAkJciA9IElNQVBfUVVPVEFfRVhDRUVERUQ7CiAJICAgIH0KIAl9CkBAIC0y
ODc3LDcgKzI5MjUsNyBAQAogCSAgICBzdHJjbXAob2xkbWFpbGJveC5xdW90YS5yb290LCBuZXdt
YWlsYm94LnF1b3RhLnJvb3QpICE9IDApIHsKIAkgICAgaWYgKCFyICYmIG5ld21haWxib3gucXVv
dGEubGltaXQgPj0gMCAmJgogCQluZXdtYWlsYm94LnF1b3RhLnVzZWQgKyBvbGRtYWlsYm94LnF1
b3RhX21haWxib3hfdXNlZCA+Ci0JCSgodW5zaWduZWQpIG5ld21haWxib3gucXVvdGEubGltaXQg
KiBRVU9UQV9VTklUUykpIHsKKwkJKCh1cXVvdGFfdCkgbmV3bWFpbGJveC5xdW90YS5saW1pdCAq
IFFVT1RBX1VOSVRTKSkgewogCQlyID0gSU1BUF9RVU9UQV9FWENFRURFRDsKIAkgICAgfQogCX0K
QEAgLTMwMzAsNyArMzA3OCw3IEBACiAJZWxzZSBpZiAocjIgPT0gSU1BUF9RVU9UQVJPT1RfTk9O
RVhJU1RFTlQpIHIyID0gMDsKIAlpZiAocjIpIHsKIAkgICAgc3lzbG9nKExPR19FUlIsCi0JICAg
ICAgIkxPU1RRVU9UQTogdW5hYmxlIHRvIHJlY29yZCB1c2Ugb2YgJWx1IGJ5dGVzIGluIHF1b3Rh
ICVzIiwKKwkgICAgICAiTE9TVFFVT1RBOiB1bmFibGUgdG8gcmVjb3JkIHVzZSBvZiAiIFVRVU9U
QV9UX0ZNVCAiIGJ5dGVzIGluIHF1b3RhICVzIiwKIAkJICAgbmV3bWFpbGJveC5xdW90YV9tYWls
Ym94X3VzZWQsIG5ld21haWxib3gucXVvdGEucm9vdCk7CiAJfQogICAgIH0KSW5kZXg6IGltYXAv
bWFpbGJveC5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3Jj
L2N5cnVzL2ltYXAvbWFpbGJveC5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjc3LjIuNwpyZXRy
aWV2aW5nIHJldmlzaW9uIDEuNzcuMi44CmRpZmYgLXUgLXUgLXIxLjc3LjIuNyAtcjEuNzcuMi44
Ci0tLSBpbWFwL21haWxib3guaAk4IEFwciAyMDA0IDIxOjEzOjA1IC0wMDAwCTEuNzcuMi43Cisr
KyBpbWFwL21haWxib3guaAk5IEF1ZyAyMDA0IDE4OjUxOjE5IC0wMDAwCTEuNzcuMi44CkBAIC0x
LDUgKzEsNSBAQAogLyogbWFpbGJveC5oIC0tIE1haWxib3ggZm9ybWF0IGRlZmluaXRpb25zCi0g
KiAkSWQ6IG1haWxib3guaCx2IDEuNzcuMi43IDIwMDQvMDQvMDggMjE6MTM6MDUga2VuMyBFeHAg
JAorICogJElkOiBtYWlsYm94LmgsdiAxLjc3LjIuOCAyMDA0LzA4LzA5IDE4OjUxOjE5IGtlbjMg
RXhwICQKICAqCiAgKiBDb3B5cmlnaHQgKGMpIDE5OTgtMjAwMyBDYXJuZWdpZSBNZWxsb24gVW5p
dmVyc2l0eS4gIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAgKgpAQCAtNDUsNiArNDUsNyBAQAogI2lu
Y2x1ZGUgPHN5cy90eXBlcy5oPgogI2luY2x1ZGUgPHN5cy9zdGF0Lmg+CiAjaW5jbHVkZSA8bGlt
aXRzLmg+CisjaW5jbHVkZSA8Y29uZmlnLmg+CiAKICNpbmNsdWRlICJhdXRoLmgiCiAjaW5jbHVk
ZSAicXVvdGEuaCIKQEAgLTYxLDYgKzYyLDEwIEBACiAjZXJyb3IgZG9udCBrbm93IHdoYXQgdG8g
dXNlIGZvciBiaXQzMgogI2VuZGlmCiAKKyNpZmRlZiBIQVZFX0xPTkdfTE9OR19JTlQKK3R5cGVk
ZWYgdW5zaWduZWQgbG9uZyBsb25nIGludCBiaXQ2NDsKKyNlbmRpZgorCiAjZGVmaW5lIE1BWF9N
QUlMQk9YX05BTUUgNDkwCiAjZGVmaW5lIE1BWF9NQUlMQk9YX1BBVEggNDA5NgogCkBAIC0xMjgs
NyArMTMzLDcgQEAKICAgICB1bnNpZ25lZCBsb25nIGV4aXN0czsKICAgICB0aW1lX3QgbGFzdF9h
cHBlbmRkYXRlOwogICAgIHVuc2lnbmVkIGxvbmcgbGFzdF91aWQ7Ci0gICAgdW5zaWduZWQgbG9u
ZyBxdW90YV9tYWlsYm94X3VzZWQ7CisgICAgdXF1b3RhX3QgcXVvdGFfbWFpbGJveF91c2VkOwog
ICAgIHVuc2lnbmVkIGxvbmcgcG9wM19sYXN0X2xvZ2luOwogICAgIHVuc2lnbmVkIGxvbmcgdWlk
dmFsaWRpdHk7CiAKQEAgLTE3MCw4ICsxNzUsOCBAQAogI2RlZmluZSBPRkZTRVRfRVhJU1RTIDIw
CiAjZGVmaW5lIE9GRlNFVF9MQVNUX0FQUEVORERBVEUgMjQKICNkZWZpbmUgT0ZGU0VUX0xBU1Rf
VUlEIDI4Ci0jZGVmaW5lIE9GRlNFVF9RVU9UQV9SRVNFUlZFRF9GSUVMRCAzMiAgLyogUmVzZXJ2
ZWQgZm9yIDY0Yml0IHF1b3RhcyAqLwotI2RlZmluZSBPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VE
IDM2CisjZGVmaW5lIE9GRlNFVF9RVU9UQV9NQUlMQk9YX1VTRUQ2NCAzMiAgLyogb2Zmc2V0IGZv
ciA2NGJpdCBxdW90YXMgKi8KKyNkZWZpbmUgT0ZGU0VUX1FVT1RBX01BSUxCT1hfVVNFRCAzNiAg
ICAvKiBvZmZzZXQgZm9yIDMyYml0IHF1b3RhcyAqLwogI2RlZmluZSBPRkZTRVRfUE9QM19MQVNU
X0xPR0lOIDQwCiAjZGVmaW5lIE9GRlNFVF9VSURWQUxJRElUWSA0NAogI2RlZmluZSBPRkZTRVRf
REVMRVRFRCA0OCAgICAgIC8qIGFkZGVkIGZvciBBQ0FQICovCkluZGV4OiBpbWFwL21iZHVtcC5j
Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2lt
YXAvbWJkdW1wLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjYuMi42CnJldHJpZXZpbmcgcmV2
aXNpb24gMS4yNi4yLjcKZGlmZiAtdSAtdSAtcjEuMjYuMi42IC1yMS4yNi4yLjcKLS0tIGltYXAv
bWJkdW1wLmMJMjUgTWF5IDIwMDQgMDE6Mjg6MDkgLTAwMDAJMS4yNi4yLjYKKysrIGltYXAvbWJk
dW1wLmMJOSBBdWcgMjAwNCAxODo1MToxOSAtMDAwMAkxLjI2LjIuNwpAQCAtMSw1ICsxLDUgQEAK
IC8qIG1iZHVtcC5jIC0tIE1haWxib3ggZHVtcCByb3V0aW5lcwotICogJElkOiBtYmR1bXAuYyx2
IDEuMjYuMi42IDIwMDQvMDUvMjUgMDE6Mjg6MDkga2VuMyBFeHAgJAorICogJElkOiBtYmR1bXAu
Yyx2IDEuMjYuMi43IDIwMDQvMDgvMDkgMTg6NTE6MTkga2VuMyBFeHAgJAogICogQ29weXJpZ2h0
IChjKSAxOTk4LTIwMDMgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkuICBBbGwgcmlnaHRzIHJl
c2VydmVkLgogICoKICAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5h
cnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dApAQCAtNTM2LDcgKzUzNiw3IEBACiB7CiAgICAgc3Ry
dWN0IGJ1ZiBmaWxlLCBkYXRhOwogICAgIGNoYXIgYzsKLSAgICBpbnQgcXVvdGF1c2VkID0gMDsK
KyAgICB1cXVvdGFfdCBxdW90YXVzZWQgPSAwOwogICAgIGludCByID0gMDsKICAgICBpbnQgY3Vy
ZmlsZSA9IC0xOwogICAgIGNvbnN0IGNoYXIgKnVzZXJpZCA9IE5VTEw7CkluZGV4OiBpbWFwL21i
ZXhhbWluZS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3Jj
L2N5cnVzL2ltYXAvbWJleGFtaW5lLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNS4yLjMKcmV0
cmlldmluZyByZXZpc2lvbiAxLjUuMi40CmRpZmYgLXUgLXUgLXIxLjUuMi4zIC1yMS41LjIuNAot
LS0gaW1hcC9tYmV4YW1pbmUuYwkyNCBKdW4gMjAwNCAxNToxNjoyNyAtMDAwMAkxLjUuMi4zCisr
KyBpbWFwL21iZXhhbWluZS5jCTkgQXVnIDIwMDQgMTg6NTE6MjAgLTAwMDAJMS41LjIuNApAQCAt
MzksNyArMzksNyBAQAogICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9S
IFBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuCiAgKi8KIAotLyogJElkOiBtYmV4YW1pbmUu
Yyx2IDEuNS4yLjMgMjAwNC8wNi8yNCAxNToxNjoyNyBrZW4zIEV4cCAkICovCisvKiAkSWQ6IG1i
ZXhhbWluZS5jLHYgMS41LjIuNCAyMDA0LzA4LzA5IDE4OjUxOjIwIGtlbjMgRXhwICQgKi8KIAog
I2luY2x1ZGUgPGNvbmZpZy5oPgogCkBAIC0yNjYsNyArMjY2LDggQEAKICAgICBwcmludGYoIiAg
TWlub3IgVmVyc2lvbjogJWRcbiIsIG1haWxib3gubWlub3JfdmVyc2lvbik7CiAgICAgcHJpbnRm
KCIgIEhlYWRlciBTaXplOiAlbGQgYnl0ZXMgIFJlY29yZCBTaXplOiAlbGQgYnl0ZXNcbiIsCiAJ
ICAgbWFpbGJveC5zdGFydF9vZmZzZXQsIG1haWxib3gucmVjb3JkX3NpemUpOwotICAgIHByaW50
ZigiICBOdW1iZXIgb2YgTWVzc2FnZXM6ICVsZFxuIiwgbWFpbGJveC5leGlzdHMpOworICAgIHBy
aW50ZigiICBOdW1iZXIgb2YgTWVzc2FnZXM6ICVsdSAgTWFpbGJveCBTaXplOiAiIFVRVU9UQV9U
X0ZNVCAiIGJ5dGVzXG4iLAorCSAgIG1haWxib3guZXhpc3RzLCBtYWlsYm94LnF1b3RhX21haWxi
b3hfdXNlZCk7CiAgICAgcHJpbnRmKCIgIExhc3QgQXBwZW5kIERhdGU6ICglbGQpICVzIiwgbWFp
bGJveC5sYXN0X2FwcGVuZGRhdGUsCiAJICAgY3RpbWUoJm1haWxib3gubGFzdF9hcHBlbmRkYXRl
KSk7CiAgICAgcHJpbnRmKCIgIFVJRFZhbGlkaXR5OiAlbGQgIExhc3QgVUlEOiAlbGRcbiIsIG1h
aWxib3gudWlkdmFsaWRpdHksCkluZGV4OiBpbWFwL21ib3hsaXN0LmMKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvY3lydXMvaW1hcC9tYm94bGlzdC5jLHYK
cmV0cmlldmluZyByZXZpc2lvbiAxLjIyMS4yLjE3CnJldHJpZXZpbmcgcmV2aXNpb24gMS4yMjEu
Mi4xOApkaWZmIC11IC11IC1yMS4yMjEuMi4xNyAtcjEuMjIxLjIuMTgKLS0tIGltYXAvbWJveGxp
c3QuYwk1IEF1ZyAyMDA0IDE2OjIzOjQ0IC0wMDAwCTEuMjIxLjIuMTcKKysrIGltYXAvbWJveGxp
c3QuYwk5IEF1ZyAyMDA0IDE4OjUxOjIwIC0wMDAwCTEuMjIxLjIuMTgKQEAgLTQwLDcgKzQwLDcg
QEAKICAqCiAgKi8KIC8qCi0gKiAkSWQ6IG1ib3hsaXN0LmMsdiAxLjIyMS4yLjE3IDIwMDQvMDgv
MDUgMTY6MjM6NDQga2VuMyBFeHAgJAorICogJElkOiBtYm94bGlzdC5jLHYgMS4yMjEuMi4xOCAy
MDA0LzA4LzA5IDE4OjUxOjIwIGtlbjMgRXhwICQKICAqLwogCiAjaW5jbHVkZSA8Y29uZmlnLmg+
CkBAIC0yNTM1LDcgKzI1MzUsNyBAQAogCXIgPSBxdW90YV93cml0ZSgmbWFpbGJveC5xdW90YSwg
dGlkKTsKIAlpZiAocikgewogCSAgICBzeXNsb2coTE9HX0VSUiwKLQkJICAgIkxPU1RRVU9UQTog
dW5hYmxlIHRvIHJlY29yZCBmcmVlIG9mICVsdSBieXRlcyBpbiBxdW90YSAlcyIsCisJCSAgICJM
T1NUUVVPVEE6IHVuYWJsZSB0byByZWNvcmQgZnJlZSBvZiAiIFVRVU9UQV9UX0ZNVCAiIGJ5dGVz
IGluIHF1b3RhICVzIiwKIAkJICAgbWFpbGJveC5xdW90YV9tYWlsYm94X3VzZWQsIG1haWxib3gu
cXVvdGEucm9vdCk7CiAJfQogCWZyZWUobWFpbGJveC5xdW90YS5yb290KTsKSW5kZXg6IGltYXAv
cXVvdGEuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9j
eXJ1cy9pbWFwL3F1b3RhLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNDguMi42CnJldHJpZXZp
bmcgcmV2aXNpb24gMS40OC4yLjcKZGlmZiAtdSAtdSAtcjEuNDguMi42IC1yMS40OC4yLjcKLS0t
IGltYXAvcXVvdGEuYwkzMCBKdW4gMjAwNCAxOTo0MToyMSAtMDAwMAkxLjQ4LjIuNgorKysgaW1h
cC9xdW90YS5jCTkgQXVnIDIwMDQgMTg6NTE6MjAgLTAwMDAJMS40OC4yLjcKQEAgLTQwLDcgKzQw
LDcgQEAKICAqCiAgKi8KIAotLyogJElkOiBxdW90YS5jLHYgMS40OC4yLjYgMjAwNC8wNi8zMCAx
OTo0MToyMSBrZW4zIEV4cCAkICovCisvKiAkSWQ6IHF1b3RhLmMsdiAxLjQ4LjIuNyAyMDA0LzA4
LzA5IDE4OjUxOjIwIGtlbjMgRXhwICQgKi8KIAogCiAjaW5jbHVkZSA8Y29uZmlnLmg+CkBAIC0x
MjAsNyArMTIwLDcgQEAKICAgICBzdHJ1Y3QgcXVvdGEgcXVvdGE7CiAgICAgaW50IHJlZmNvdW50
OwogICAgIGludCBkZWxldGVkOwotICAgIHVuc2lnbmVkIGxvbmcgbmV3dXNlZDsKKyAgICB1cXVv
dGFfdCBuZXd1c2VkOwogfTsKIAogI2RlZmluZSBRVU9UQUdST1cgMzAwCkBAIC0yNTEsNyArMjUx
LDcgQEAKICAgICB9CiAgICAgbWVtc2V0KCZxdW90YVtxdW90YV9udW1dLCAwLCBzaXplb2Yoc3Ry
dWN0IHF1b3RhZW50cnkpKTsKICAgICBxdW90YVtxdW90YV9udW1dLnF1b3RhLnJvb3QgPSB4c3Ry
bmR1cChrZXksIGtleWxlbik7Ci0gICAgc3NjYW5mKGRhdGEsICIlbHUgJWQiLAorICAgIHNzY2Fu
ZihkYXRhLCBVUVVPVEFfVF9GTVQgIiAlZCIsCiAJICAgJnF1b3RhW3F1b3RhX251bV0ucXVvdGEu
dXNlZCwgJnF1b3RhW3F1b3RhX251bV0ucXVvdGEubGltaXQpOwogICAKICAgICBxdW90YV9udW0r
KzsKQEAgLTQyMiw3ICs0MjIsNyBAQAogCSgqY291bnQpKys7CiAgICAgfQogICAgIGlmIChxdW90
YVt0aGlzcXVvdGFdLnF1b3RhLnVzZWQgIT0gcXVvdGFbdGhpc3F1b3RhXS5uZXd1c2VkKSB7Ci0J
cHJpbnRmKCIlczogdXNhZ2Ugd2FzICVsdSwgbm93ICVsdVxuIiwgcXVvdGFbdGhpc3F1b3RhXS5x
dW90YS5yb290LAorCXByaW50ZigiJXM6IHVzYWdlIHdhcyAiIFVRVU9UQV9UX0ZNVCAiLCBub3cg
IiBVUVVPVEFfVF9GTVQgIlxuIiwgcXVvdGFbdGhpc3F1b3RhXS5xdW90YS5yb290LAogCSAgICAg
ICBxdW90YVt0aGlzcXVvdGFdLnF1b3RhLnVzZWQsIHF1b3RhW3RoaXNxdW90YV0ubmV3dXNlZCk7
CiAJcXVvdGFbdGhpc3F1b3RhXS5xdW90YS51c2VkID0gcXVvdGFbdGhpc3F1b3RhXS5uZXd1c2Vk
OwogCXIgPSBxdW90YV93cml0ZSgmcXVvdGFbdGhpc3F1b3RhXS5xdW90YSwgdGlkKTsKQEAgLTQ4
OSwxMiArNDg5LDEyIEBACiAgICAgaW50IGk7CiAgICAgY2hhciBidWZbTUFYX01BSUxCT1hfUEFU
SCsxXTsKIAotICAgIHByaW50ZigiICAgUXVvdGEgICUlIFVzZWQgICAgVXNlZCBSb290XG4iKTsK
KyAgICBwcmludGYoIiAgIFF1b3RhICAgJSUgVXNlZCAgICAgVXNlZCBSb290XG4iKTsKIAogICAg
IGZvciAoaSA9IDA7IGkgPCBxdW90YV9udW07IGkrKykgewogCWlmIChxdW90YVtpXS5kZWxldGVk
KSBjb250aW51ZTsKIAlpZiAocXVvdGFbaV0ucXVvdGEubGltaXQgPiAwKSB7Ci0JICAgIHByaW50
ZigiICU3ZCAlN2xkIiwgcXVvdGFbaV0ucXVvdGEubGltaXQsCisJICAgIHByaW50ZigiICU3ZCAi
IFFVT1RBX1JFUE9SVF9GTVQgLCBxdW90YVtpXS5xdW90YS5saW1pdCwKIAkJICAgKChxdW90YVtp
XS5xdW90YS51c2VkIC8gUVVPVEFfVU5JVFMpICogMTAwKSAvIHF1b3RhW2ldLnF1b3RhLmxpbWl0
KTsKIAl9CiAJZWxzZSBpZiAocXVvdGFbaV0ucXVvdGEubGltaXQgPT0gMCkgewpAQCAtNTA3LDYg
KzUwNyw2IEBACiAJKCpxdW90YV9uYW1lc3BhY2UubWJveG5hbWVfdG9leHRlcm5hbCkoJnF1b3Rh
X25hbWVzcGFjZSwKIAkJCQkJICAgICAgIHF1b3RhW2ldLnF1b3RhLnJvb3QsCiAJCQkJCSAgICAg
ICAiY3lydXMiLCBidWYpOwotCXByaW50ZigiICU3bGQgJXNcbiIsIHF1b3RhW2ldLnF1b3RhLnVz
ZWQgLyBRVU9UQV9VTklUUywgYnVmKTsKKwlwcmludGYoIiAiIFFVT1RBX1JFUE9SVF9GTVQgIiAl
c1xuIiwgcXVvdGFbaV0ucXVvdGEudXNlZCAvIFFVT1RBX1VOSVRTLCBidWYpOwogICAgIH0KIH0K
SW5kZXg6IGltYXAvcXVvdGEuaAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0
ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL3F1b3RhLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMS4y
LjIKcmV0cmlldmluZyByZXZpc2lvbiAxLjEuMi4zCmRpZmYgLXUgLXUgLXIxLjEuMi4yIC1yMS4x
LjIuMwotLS0gaW1hcC9xdW90YS5oCTI3IEZlYiAyMDA0IDIxOjE3OjM1IC0wMDAwCTEuMS4yLjIK
KysrIGltYXAvcXVvdGEuaAk5IEF1ZyAyMDA0IDE4OjUxOjIxIC0wMDAwCTEuMS4yLjMKQEAgLTM4
LDI1ICszOCw0NCBAQAogICogQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SIE9U
SEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORwogICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04g
V0lUSCBUSEUgVVNFIE9SIFBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuCiAgKgotICogJElk
OiBxdW90YS5oLHYgMS4xLjIuMiAyMDA0LzAyLzI3IDIxOjE3OjM1IGtlbjMgRXhwICQKKyAqICRJ
ZDogcXVvdGEuaCx2IDEuMS4yLjMgMjAwNC8wOC8wOSAxODo1MToyMSBrZW4zIEV4cCAkCiAgKi8K
IAogI2lmbmRlZiBJTkNMVURFRF9RVU9UQV9ICiAjZGVmaW5lIElOQ0xVREVEX1FVT1RBX0gKIAog
I2luY2x1ZGUgImN5cnVzZGIuaCIKKyNpbmNsdWRlIDxjb25maWcuaD4KIAogI2RlZmluZSBGTkFN
RV9RVU9UQURCICIvcXVvdGFzLmRiIgogCiAjZGVmaW5lIFFVT1RBX1VOSVRTICgxMDI0KQogCisv
KiBEZWZpbmUgdGhlIHByb3BlciBxdW90YSB0eXBlLCBpdCBzaG91bGQgZWl0aGVyIGJlIGEKKyAq
IGxvbmcgb3IgYSBsb25nIGxvbmcgaW50IGRlcGVuZGluZyB1cG9uIHdoYXQgdGhlCisgKiB0aGUg
Y29tcGlsZXIgc3VwcG9ydHMuCisgKi8KKyNpZmRlZiBIQVZFX0xPTkdfTE9OR19JTlQKK3R5cGVk
ZWYgdW5zaWduZWQgbG9uZyBsb25nIGludCB1cXVvdGFfdDsKK3R5cGVkZWYgbG9uZyBsb25nIGlu
dCBxdW90YV90OworI2RlZmluZSBVUVVPVEFfVF9GTVQgICAgICIlbGx1IgorI2RlZmluZSBRVU9U
QV9UX0ZNVCAgICAgICIlbGxkIgorI2RlZmluZSBRVU9UQV9SRVBPUlRfRk1UICIlOGxsdSIKKyNl
bHNlCit0eXBlZGVmIHVuc2lnbmVkIGxvbmcgdXF1b3RhX3Q7Cit0eXBlZGVmIGxvbmcgcXVvdGFf
dDsKKyNkZWZpbmUgVVFVT1RBX1RfRk1UICAgICAiJWx1IgorI2RlZmluZSBRVU9UQV9UX0ZNVCAg
ICAgICIlbGQiCisjZGVmaW5lIFFVT1RBX1JFUE9SVF9GTVQgIiU4bHUiCisjZW5kaWYKKwogZXh0
ZXJuIHN0cnVjdCBkYiAqcWRiOwogCiBzdHJ1Y3QgcXVvdGEgewogICAgIGNoYXIgKnJvb3Q7CiAK
ICAgICAvKiBJbmZvcm1hdGlvbiBpbiBxdW90YSBlbnRyeSAqLwotICAgIHVuc2lnbmVkIGxvbmcg
dXNlZDsKKyAgICB1cXVvdGFfdCB1c2VkOwogICAgIGludCBsaW1pdDsJCQkvKiBpbiBRVU9UQV9V
TklUUyAqLwogfTsKIApJbmRleDogaW1hcC9xdW90YV9kYi5jCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6
IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvcXVvdGFfZGIuYyx2CnJldHJp
ZXZpbmcgcmV2aXNpb24gMS4xLjIuMgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMS4yLjMKZGlmZiAt
dSAtdSAtcjEuMS4yLjIgLXIxLjEuMi4zCi0tLSBpbWFwL3F1b3RhX2RiLmMJMjUgTWF5IDIwMDQg
MDE6Mjg6MTMgLTAwMDAJMS4xLjIuMgorKysgaW1hcC9xdW90YV9kYi5jCTkgQXVnIDIwMDQgMTg6
NTE6MjEgLTAwMDAJMS4xLjIuMwpAQCAtMzgsNyArMzgsNyBAQAogICogQU4gQUNUSU9OIE9GIENP
TlRSQUNULCBORUdMSUdFTkNFIE9SIE9USEVSIFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORwogICog
T1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SIFBFUkZPUk1BTkNFIE9GIFRI
SVMgU09GVFdBUkUuCiAgKgotICogJElkOiBxdW90YV9kYi5jLHYgMS4xLjIuMiAyMDA0LzA1LzI1
IDAxOjI4OjEzIGtlbjMgRXhwICQKKyAqICRJZDogcXVvdGFfZGIuYyx2IDEuMS4yLjMgMjAwNC8w
OC8wOSAxODo1MToyMSBrZW4zIEV4cCAkCiAgKgogICovCiAKQEAgLTg5LDcgKzg5LDcgQEAKIAog
ICAgIHN3aXRjaCAocikgewogICAgIGNhc2UgQ1lSVVNEQl9PSzoKLQlzc2NhbmYoZGF0YSwgIiVs
dSAlZCIsICZxdW90YS0+dXNlZCwgJnF1b3RhLT5saW1pdCk7CisJc3NjYW5mKGRhdGEsIFVRVU9U
QV9UX0ZNVCAiICVkIiwgJnF1b3RhLT51c2VkLCAmcXVvdGEtPmxpbWl0KTsKIAlicmVhazsKIAog
ICAgIGNhc2UgQ1lSVVNEQl9BR0FJTjoKQEAgLTE1MSw3ICsxNTEsNyBAQAogICAgIGlmICghcXJs
ZW4pIHJldHVybiBJTUFQX1FVT1RBUk9PVF9OT05FWElTVEVOVDsKIAogICAgIGxlbiA9IHNucHJp
bnRmKGJ1Ziwgc2l6ZW9mKGJ1ZikgLSAxLAotCQkgICAiJWx1ICVkIiwgcXVvdGEtPnVzZWQsIHF1
b3RhLT5saW1pdCk7CisJCSAgIFVRVU9UQV9UX0ZNVCAiICVkIiwgcXVvdGEtPnVzZWQsIHF1b3Rh
LT5saW1pdCk7CiAgICAgciA9IFFEQi0+c3RvcmUocWRiLCBxdW90YS0+cm9vdCwgcXJsZW4sIGJ1
ZiwgbGVuLCB0aWQpOwogICAgIAogICAgIHN3aXRjaCAocikgewpJbmRleDogaW1hcC9yZWNvbnN0
cnVjdC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL2N5
cnVzL2ltYXAvcmVjb25zdHJ1Y3QuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS44MS4yLjkKcmV0
cmlldmluZyByZXZpc2lvbiAxLjgxLjIuMTAKZGlmZiAtdSAtdSAtcjEuODEuMi45IC1yMS44MS4y
LjEwCi0tLSBpbWFwL3JlY29uc3RydWN0LmMJNSBBdWcgMjAwNCAxNjoyMzo0NyAtMDAwMAkxLjgx
LjIuOQorKysgaW1hcC9yZWNvbnN0cnVjdC5jCTkgQXVnIDIwMDQgMTg6NTE6MjEgLTAwMDAJMS44
MS4yLjEwCkBAIC0zOSw3ICszOSw3IEBACiAgKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRI
IFRIRSBVU0UgT1IgUEVSRk9STUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KICAqLwogCi0vKiAkSWQ6
IHJlY29uc3RydWN0LmMsdiAxLjgxLjIuOSAyMDA0LzA4LzA1IDE2OjIzOjQ3IGtlbjMgRXhwICQg
Ki8KKy8qICRJZDogcmVjb25zdHJ1Y3QuYyx2IDEuODEuMi4xMCAyMDA0LzA4LzA5IDE4OjUxOjIx
IGtlbjMgRXhwICQgKi8KIAogI2luY2x1ZGUgPGNvbmZpZy5oPgogCkBAIC05NCw2ICs5NCw3IEBA
CiAjaW5jbHVkZSAicmV0cnkuaCIKICNpbmNsdWRlICJjb252ZXJ0X2NvZGUuaCIKICNpbmNsdWRl
ICJ1dGlsLmgiCisjaW5jbHVkZSAiYnl0ZW9yZGVyNjQuaCIKIAogZXh0ZXJuIGludCBvcHRpbmQ7
CiBleHRlcm4gY2hhciAqb3B0YXJnOwpAQCAtNDQxLDcgKzQ0Miw3IEBACiAgICAgY2hhciAqbGlz
dF9hY2wsICpsaXN0X3BhcnQ7CiAgICAgaW50IGxpc3RfdHlwZTsKIAotICAgIHVuc2lnbmVkIGxv
bmcgbmV3X3F1b3RhID0gMDsKKyAgICB1cXVvdGFfdCBuZXdfcXVvdGEgPSAwOwogCiAgICAgc3Ry
dWN0IGluZGV4X3JlY29yZCBtZXNzYWdlX2luZGV4LCBvbGRfaW5kZXg7CiAgICAgc3RhdGljIHN0
cnVjdCBpbmRleF9yZWNvcmQgemVyb19pbmRleDsKQEAgLTc3NCw3ICs3NzUsMTQgQEAKICAgICAq
KChiaXQzMiAqKShidWYrT0ZGU0VUX0VYSVNUUykpID0gaHRvbmwobmV3X2V4aXN0cyk7CiAgICAg
KigoYml0MzIgKikoYnVmK09GRlNFVF9MQVNUX0FQUEVORERBVEUpKSA9IGh0b25sKG1haWxib3gu
bGFzdF9hcHBlbmRkYXRlKTsKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX0xBU1RfVUlEKSkg
PSBodG9ubChtYWlsYm94Lmxhc3RfdWlkKTsKLSAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1FV
T1RBX01BSUxCT1hfVVNFRCkpID0gaHRvbmwobmV3X3F1b3RhKTsKKworICAgIC8qIHF1b3RhcyBt
YXkgYmUgNjRiaXQgbm93ICovCisjaWZkZWYgSEFWRV9MT05HX0xPTkdfSU5UCisgICAgKigoYml0
NjQgKikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9YX1VTRUQ2NCkpID0gaHRvbmxsKG5ld19xdW90
YSk7CisjZWxzZQorICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VE
MzIpKSA9IGh0b25sKG5ld19xdW90YSk7CisjZW5kaWYKKwogICAgICooKGJpdDMyICopKGJ1ZitP
RkZTRVRfUE9QM19MQVNUX0xPR0lOKSkgPSBodG9ubChtYWlsYm94LnBvcDNfbGFzdF9sb2dpbik7
CiAgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9VSURWQUxJRElUWSkpID0gaHRvbmwobWFpbGJv
eC51aWR2YWxpZGl0eSk7CiAgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9ERUxFVEVEKSkgPSBo
dG9ubChuZXdfZGVsZXRlZCk7CkluZGV4OiBsaWIvTWFrZWZpbGUuaW4KPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvY3lydXMvbGliL01ha2VmaWxlLmluLHYK
cmV0cmlldmluZyByZXZpc2lvbiAxLjU1LjIuNQpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNTUuMi42
CmRpZmYgLXUgLXUgLXIxLjU1LjIuNSAtcjEuNTUuMi42Ci0tLSBsaWIvTWFrZWZpbGUuaW4JMzEg
TWF5IDIwMDQgMTg6MjI6NTggLTAwMDAJMS41NS4yLjUKKysrIGxpYi9NYWtlZmlsZS5pbgk5IEF1
ZyAyMDA0IDE4OjUxOjIxIC0wMDAwCTEuNTUuMi42CkBAIC00MCw3ICs0MCw3IEBACiAjIEFOIEFD
VElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUiBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFS
SVNJTkcKICMgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUgVVNFIE9SIFBFUkZPUk1B
TkNFIE9GIFRISVMgU09GVFdBUkUuCiAKLSMgJElkOiBNYWtlZmlsZS5pbix2IDEuNTUuMi41IDIw
MDQvMDUvMzEgMTg6MjI6NTgga2VuMyBFeHAgJAorIyAkSWQ6IE1ha2VmaWxlLmluLHYgMS41NS4y
LjYgMjAwNC8wOC8wOSAxODo1MToyMSBrZW4zIEV4cCAkCiAKICMgQXV0aG9yaXphdGlvbiBuYW1l
c3BhY2UuCiBBVVRIPWF1dGhfQFdJVEhfQVVUSEAubwpAQCAtODUsNyArODUsNyBAQAogCSQoc3Jj
ZGlyKS9sc29ydC5oICQoc3JjZGlyKS9zdHJpc3RyLmggXAogCSQoc3JjZGlyKS91dGlsLmggJChz
cmNkaXIpL3htYWxsb2MuaCAkKHNyY2RpcikvaW1hcHVybC5oIFwKIAkkKHNyY2RpcikvY3lydXNk
Yi5oICQoc3JjZGlyKS9pcHRvc3RyaW5nLmggJChzcmNkaXIpL3JmYzgyMmRhdGUuaCBcCi0JJChz
cmNkaXIpL2xpYmN5cl9jZmcuaAorCSQoc3JjZGlyKS9saWJjeXJfY2ZnLmggJChzcmNkaXIpL2J5
dGVvcmRlcjY0LmgKIAogTElCQ1lSX09CSlMgPSBhY2wubyBic2VhcmNoLm8gY2hhcnNldC5vIGds
b2IubyByZXRyeS5vIHV0aWwubyBcCiAJbGliY3lyX2NmZy5vIG1rZ210aW1lLm8gcHJvdC5vIHBh
cnNlYWRkci5vIGltY2xpZW50Lm8gaW1wYXJzZS5vIFwKQEAgLTkzLDcgKzkzLDcgQEAKIAljaGFy
dGFibGUubyBpbWFwdXJsLm8gbm9uYmxvY2tfQFdJVEhfTk9OQkxPQ0tALm8gbG9ja19AV0lUSF9M
T0NLQC5vIFwKIAlnbXRvZmZfQFdJVEhfR01UT0ZGQC5vIG1hcF9AV0lUSF9NQVBALm8gJChBQ0wp
ICQoQVVUSCkgXAogCUBMSUJPQkpTQCBAQ1lSVVNEQl9PQkpTQCBcCi0JaXB0b3N0cmluZy5vIHht
YWxsb2MubyB3aWxkbWF0Lm8KKwlpcHRvc3RyaW5nLm8geG1hbGxvYy5vIHdpbGRtYXQubyBieXRl
b3JkZXI2NC5vCiAKIExJQkNZUk1fSERSUyA9ICQoc3JjZGlyKS9oYXNoLmggJChzcmNkaXIpL21w
b29sLmggJChzcmNkaXIpL3htYWxsb2MuaCBcCiAJJChzcmNkaXIpL3N0cmhhc2gubyAkKHNyY2Rp
cikvbGliY29uZmlnLmggJChzcmNkaXIpL2Fzc2VydC5oIFwKSW5kZXg6IGxpYi9wcm90LmMKPT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvY3lydXMvbGliL3By
b3QuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS44Mi4yLjQKcmV0cmlldmluZyByZXZpc2lvbiAx
LjgyLjIuNQpkaWZmIC11IC11IC1yMS44Mi4yLjQgLXIxLjgyLjIuNQotLS0gbGliL3Byb3QuYwkx
IE1hciAyMDA0IDE0OjMwOjIxIC0wMDAwCTEuODIuMi40CisrKyBsaWIvcHJvdC5jCTkgQXVnIDIw
MDQgMTg6NTE6MjIgLTAwMDAJMS44Mi4yLjUKQEAgLTQxLDcgKzQxLDcgQEAKICAqCiAgKi8KIC8q
Ci0gKiAkSWQ6IHByb3QuYyx2IDEuODIuMi40IDIwMDQvMDMvMDEgMTQ6MzA6MjEga2VuMyBFeHAg
JAorICogJElkOiBwcm90LmMsdiAxLjgyLjIuNSAyMDA0LzA4LzA5IDE4OjUxOjIyIGtlbjMgRXhw
ICQKICAqLwogCiAjaW5jbHVkZSA8Y29uZmlnLmg+CkBAIC04NzEsNiArODcxLDExIEBACiAgICAg
Y2hhciBidWZbMzBdOwogICAgIHZhX3N0YXJ0KHB2YXIsIGZtdCk7CiAKKyNpZmRlZiBIQVZFX0xP
TkdfTE9OR19JTlQKKyAgICBsb25nIGxvbmcgaW50IGxsOworICAgIHVuc2lnbmVkIGxvbmcgbG9u
ZyBpbnQgdWxsOworI2VuZGlmCisKICAgICBhc3NlcnQocy0+d3JpdGUpOwogCiAgICAgd2hpbGUg
KChwZXJjZW50ID0gc3RyY2hyKGZtdCwgJyUnKSkgIT0gMCkgewpAQCAtODkzLDYgKzg5OCwyNyBA
QAogCQlzbnByaW50ZihidWYsIHNpemVvZihidWYpLCAiJWx1IiwgdWwpOwogCQlwcm90X3dyaXRl
KHMsIGJ1Ziwgc3RybGVuKGJ1ZikpOwogCQlicmVhazsKKworI2lmZGVmIEhBVkVfTE9OR19MT05H
X0lOVAorICAgICAgICAgICAgY2FzZSAnbCc6CisJICAgICAgICBzd2l0Y2ggKCorK3BlcmNlbnQp
IHsKKwkJY2FzZSAnZCc6CisJCSAgICBsbCA9IHZhX2FyZyhwdmFyLCBsb25nIGxvbmcgaW50KTsK
KwkJICAgIHNucHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1ZiksICIlbGxkIiwgbGwpOworCQkgICAgcHJv
dF93cml0ZShzLCBidWYsIHN0cmxlbihidWYpKTsKKwkJICAgIGJyZWFrOworCisJCWNhc2UgJ3Un
OgorCQkgICAgdWxsID0gdmFfYXJnKHB2YXIsIHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQpOworCQkg
ICAgc25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwgIiVsbHUiLCB1bGwpOworCQkgICAgcHJvdF93
cml0ZShzLCBidWYsIHN0cmxlbihidWYpKTsKKwkJICAgIGJyZWFrOworCisJICAgICAgICBkZWZh
dWx0OgorCQkgICAgYWJvcnQoKTsKKwkJfQorCQlicmVhazsKKyNlbmRpZgogCiAJICAgIGRlZmF1
bHQ6CiAJCWFib3J0KCk7Cg==
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>373</attachid>
            <date>2005-08-30 06:25 EDT</date>
            <desc>Patch to add 64bit quotas to 2.2.12 (including byteorder64.[ch])</desc>
            <filename>64bit-quota.patch</filename>
            <type>text/plain</type>
            <size>24887</size>
            <attacher>ondrej@sury.org</attacher>
            
              <data encoding="base64">ZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMn4vY29uZmlndXJlLmluIGN5cnVzLWltYXBkLTIu
Mi4xMi9jb25maWd1cmUuaW4KLS0tIGN5cnVzLWltYXBkLTIuMi4xMn4vY29uZmlndXJlLmluCTIw
MDUtMDEtMTkgMDA6NDY6MDAuMDAwMDAwMDAwICswMTAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIv
Y29uZmlndXJlLmluCTIwMDUtMDgtMzAgMTI6MDk6MjguMDAwMDAwMDAwICswMjAwCkBAIC0xMDAs
NiArMTAwLDE1IEBACiBmaQogQUNfQ19JTkxJTkUKIAorZG5sIENoZWNrIGlmIGBsb25nIGxvbmcg
aW50JyBpcyBhdmFpbGFibGUKK0FDX0NIRUNLX1NJWkVPRihsb25nIGxvbmcgaW50KQorQUNfQ0hF
Q0tfU0laRU9GKHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQpCitpZiB0ZXN0ICIkYWNfY3Zfc2l6ZW9m
X2xvbmdfbG9uZ19pbnQiIC1lcSA4IC1hIFwKKyAgICAgICAgIiRhY19jdl9zaXplb2ZfdW5zaWdu
ZWRfbG9uZ19sb25nX2ludCIgLWVxIDg7IHRoZW4KKyAgQUNfREVGSU5FKEhBVkVfTE9OR19MT05H
X0lOVCxbXSxbRG9lcyB0aGUgY29tcGlsZXIgc3VwcG9ydCBsb25nIGxvbmcgaW50P10pCisgIEFD
X0NfQklHRU5ESUFOCitmaQorCiBDTVVfQ19fX0FUVFJJQlVURV9fCiBDTVVfQ19GUElDCiAKZGlm
ZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMn4vaW1hcC9hcHBlbmQuYyBjeXJ1cy1pbWFwZC0yLjIu
MTIvaW1hcC9hcHBlbmQuYwotLS0gY3lydXMtaW1hcGQtMi4yLjEyfi9pbWFwL2FwcGVuZC5jCTIw
MDQtMDUtMjIgMDU6NDU6NDguMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIv
aW1hcC9hcHBlbmQuYwkyMDA1LTA4LTMwIDEyOjA5OjI4LjAwMDAwMDAwMCArMDIwMApAQCAtMTQw
LDcgKzE0MCw3IEBACiAgICAgaWYgKCFyKSB7CiAJaWYgKG0ucXVvdGEubGltaXQgPj0gMCAmJiBx
dW90YWNoZWNrID49IDAgJiYKIAkgICAgbS5xdW90YS51c2VkICsgcXVvdGFjaGVjayA+IAotCSAg
ICAoKHVuc2lnbmVkKSBtLnF1b3RhLmxpbWl0ICogUVVPVEFfVU5JVFMpKSB7CisJICAgICgodXF1
b3RhX3QpIG0ucXVvdGEubGltaXQgKiBRVU9UQV9VTklUUykpIHsKIAkgICAgciA9IElNQVBfUVVP
VEFfRVhDRUVERUQ7CiAJfQogICAgIH0KQEAgLTIwOCw3ICsyMDgsNyBAQAogICAgIGlmICghcikg
ewogCWlmIChhcy0+bS5xdW90YS5saW1pdCA+PSAwICYmIHF1b3RhY2hlY2sgPj0gMCAmJgogCSAg
ICBhcy0+bS5xdW90YS51c2VkICsgcXVvdGFjaGVjayA+IAotCSAgICAoKHVuc2lnbmVkKSBhcy0+
bS5xdW90YS5saW1pdCAqIFFVT1RBX1VOSVRTKSkgeworCSAgICAoKHVxdW90YV90KSBhcy0+bS5x
dW90YS5saW1pdCAqIFFVT1RBX1VOSVRTKSkgewogCSAgICBxdW90YV9hYm9ydCgmYXMtPnRpZCk7
CiAJICAgIG1haWxib3hfY2xvc2UoJmFzLT5tKTsKIAkgICAgciA9IElNQVBfUVVPVEFfRVhDRUVE
RUQ7CmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTJ+L2ltYXAvaW1hcGQuYyBjeXJ1cy1pbWFw
ZC0yLjIuMTIvaW1hcC9pbWFwZC5jCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTJ+L2ltYXAvaW1hcGQu
YwkyMDA1LTAyLTE0IDA3OjM5OjU1LjAwMDAwMDAwMCArMDEwMAorKysgY3lydXMtaW1hcGQtMi4y
LjEyL2ltYXAvaW1hcGQuYwkyMDA1LTA4LTMwIDEyOjA5OjI4LjAwMDAwMDAwMCArMDIwMApAQCAt
MjYyNiwxMCArMjYyNiwxMCBAQAogIAkgICAgICovCiAgCSAgICBpbnQgd2FybnNpemUgPSBjb25m
aWdfZ2V0aW50KElNQVBPUFRfUVVPVEFXQVJOS0IpOwogIAkgICAgaWYgKHdhcm5zaXplIDw9IDAg
fHwgd2FybnNpemUgPj0gaW1hcGRfbWFpbGJveC0+cXVvdGEubGltaXQgfHwKLSAJICAgICAgICAo
aW50KSgoaW1hcGRfbWFpbGJveC0+cXVvdGEubGltaXQgKiBRVU9UQV9VTklUUykgLQotCQkgICAg
ICBpbWFwZF9tYWlsYm94LT5xdW90YS51c2VkKSA8ICh3YXJuc2l6ZSAqIFFVT1RBX1VOSVRTKSkg
eworIAkgICAgICAgICgodXF1b3RhX3QpIChpbWFwZF9tYWlsYm94LT5xdW90YS5saW1pdCAtIHdh
cm5zaXplKSkgKiBRVU9UQV9VTklUUyA8IAorCQlpbWFwZF9tYWlsYm94LT5xdW90YS51c2VkKSB7
CiAJCXVzYWdlID0gKChkb3VibGUpIGltYXBkX21haWxib3gtPnF1b3RhLnVzZWQgKiAxMDAuMCkg
LyAoZG91YmxlKQotCQkgICAgKGltYXBkX21haWxib3gtPnF1b3RhLmxpbWl0ICogUVVPVEFfVU5J
VFMpOworCQkgICAgKCh1cXVvdGFfdCkgaW1hcGRfbWFpbGJveC0+cXVvdGEubGltaXQgKiBRVU9U
QV9VTklUUyk7CiAJCWlmICh1c2FnZSA+PSAxMDAuMCkgewogCQkgICAgcHJvdF9wcmludGYoaW1h
cGRfb3V0LCAiKiBOTyBbQUxFUlRdICVzXHJcbiIsCiAJCQkJZXJyb3JfbWVzc2FnZShJTUFQX05P
X09WRVJRVU9UQSkpOwpAQCAtNDYyNiw3ICs0NjI2LDcgQEAKIAlwcmludGFzdHJpbmcobmFtZSk7
CiAJcHJvdF9wcmludGYoaW1hcGRfb3V0LCAiICgiKTsKIAlpZiAocXVvdGEubGltaXQgPj0gMCkg
ewotCSAgICBwcm90X3ByaW50ZihpbWFwZF9vdXQsICJTVE9SQUdFICVsdSAlZCIsCisJICAgIHBy
b3RfcHJpbnRmKGltYXBkX291dCwgIlNUT1JBR0UgIiBVUVVPVEFfVF9GTVQgIiAlZCIsCiAJCQlx
dW90YS51c2VkL1FVT1RBX1VOSVRTLCBxdW90YS5saW1pdCk7CiAJfQogCXByb3RfcHJpbnRmKGlt
YXBkX291dCwgIilcclxuIik7CkBAIC00Njg4LDcgKzQ2ODgsNyBAQAogCQlwcmludGFzdHJpbmco
bWFpbGJveG5hbWUpOwogCQlwcm90X3ByaW50ZihpbWFwZF9vdXQsICIgKCIpOwogCQlpZiAobWFp
bGJveC5xdW90YS5saW1pdCA+PSAwKSB7Ci0JCSAgICBwcm90X3ByaW50ZihpbWFwZF9vdXQsICJT
VE9SQUdFICVsdSAlZCIsCisJCSAgICBwcm90X3ByaW50ZihpbWFwZF9vdXQsICJTVE9SQUdFICIg
VVFVT1RBX1RfRk1UICIgJWQiLAogCQkJCW1haWxib3gucXVvdGEudXNlZC9RVU9UQV9VTklUUywK
IAkJCQltYWlsYm94LnF1b3RhLmxpbWl0KTsKIAkJfQpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4y
LjEyfi9pbWFwL21haWxib3guYyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9tYWlsYm94LmMKLS0t
IGN5cnVzLWltYXBkLTIuMi4xMn4vaW1hcC9tYWlsYm94LmMJMjAwNS0wMi0xNCAwNzozOTo1Ny4w
MDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL21haWxib3guYwkyMDA1
LTA4LTMwIDEyOjEzOjM0LjAwMDAwMDAwMCArMDIwMApAQCAtODQsNiArODQsNyBAQAogI2luY2x1
ZGUgInNlZW4uaCIKICNpbmNsdWRlICJ1dGlsLmgiCiAjaW5jbHVkZSAieG1hbGxvYy5oIgorI2lu
Y2x1ZGUgImJ5dGVvcmRlcjY0LmgiCiAKIHN0YXRpYyBpbnQgbWFpbGJveF9kb2luZ19yZWNvbnN0
cnVjdCA9IDA7CiAjZGVmaW5lIHplcm9tYWlsYm94KG0pIHsgbWVtc2V0KCZtLCAwLCBzaXplb2Yo
c3RydWN0IG1haWxib3gpKTsgXApAQCAtNzg4LDggKzc4OSwxNiBAQAogICAgIG1haWxib3gtPmxh
c3RfdWlkID0KIAludG9obCgqKChiaXQzMiAqKShtYWlsYm94LT5pbmRleF9iYXNlK09GRlNFVF9M
QVNUX1VJRCkpKTsKIAorI2lmZGVmIEhBVkVfTE9OR19MT05HX0lOVAorICAgIGlmIChtYWlsYm94
LT5taW5vcl92ZXJzaW9uID4gNSkgeworCS8qIG5ld2VyIHZlcnNpb25zIG1heSB1c2UgNjRiaXQg
cXVvdGFzIG5vdyAqLworICAgICAgICBtYWlsYm94LT5xdW90YV9tYWlsYm94X3VzZWQgPQorICAg
ICAgICAgICAgbnRvaGxsKCooKGJpdDY0ICopKG1haWxib3gtPmluZGV4X2Jhc2UrT0ZGU0VUX1FV
T1RBX01BSUxCT1hfVVNFRDY0KSkpOworICAgIH0gZWxzZQorI2Vsc2UKICAgICBtYWlsYm94LT5x
dW90YV9tYWlsYm94X3VzZWQgPQogCW50b2hsKCooKGJpdDMyICopKG1haWxib3gtPmluZGV4X2Jh
c2UrT0ZGU0VUX1FVT1RBX01BSUxCT1hfVVNFRC1xdW90YV91cGdyYWRlX29mZnNldCkpKTsKKyNl
bmRpZgogCiAgICAgaWYgKG1haWxib3gtPnN0YXJ0X29mZnNldCA8IE9GRlNFVF9QT1AzX0xBU1Rf
TE9HSU4tcXVvdGFfdXBncmFkZV9vZmZzZXQrc2l6ZW9mKGJpdDMyKSkgewogCW1haWxib3gtPnBv
cDNfbGFzdF9sb2dpbiA9IDA7CkBAIC0xMTgzLDkgKzExOTIsMTggQEAKICAgICAqKChiaXQzMiAq
KShidWYrT0ZGU0VUX0VYSVNUUykpID0gaHRvbmwobWFpbGJveC0+ZXhpc3RzKTsKICAgICAqKChi
aXQzMiAqKShidWYrT0ZGU0VUX0xBU1RfQVBQRU5EREFURSkpID0gaHRvbmwobWFpbGJveC0+bGFz
dF9hcHBlbmRkYXRlKTsKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX0xBU1RfVUlEKSkgPSBo
dG9ubChtYWlsYm94LT5sYXN0X3VpZCk7Ci0gICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9RVU9U
QV9SRVNFUlZFRF9GSUVMRCkpID0gaHRvbmwoMCk7IC8qIFJFU0VSVkVEICovCisKKyAgICAvKiBx
dW90YXMgbWF5IGJlIDY0Yml0IG5vdyAqLworI2lmZGVmIEhBVkVfTE9OR19MT05HX0lOVAorICAg
ICooKGJpdDY0ICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VENjQpKSA9CisJaHRvbmxs
KG1haWxib3gtPnF1b3RhX21haWxib3hfdXNlZCk7CisjZWxzZQkKKyAgICAvKiB6ZXJvIHRoZSB1
bnVzZWQgMzJiaXRzICovCisgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9Y
X1VTRUQ2NCkpID0gaHRvbmwoMCkKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1FVT1RBX01B
SUxCT1hfVVNFRCkpID0KIAlodG9ubChtYWlsYm94LT5xdW90YV9tYWlsYm94X3VzZWQpOworI2Vu
ZGlmCisKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1BPUDNfTEFTVF9MT0dJTikpID0gaHRv
bmwobWFpbGJveC0+cG9wM19sYXN0X2xvZ2luKTsKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VU
X1VJRFZBTElESVRZKSkgPSBodG9ubChtYWlsYm94LT51aWR2YWxpZGl0eSk7CiAgICAgKigoYml0
MzIgKikoYnVmK09GRlNFVF9ERUxFVEVEKSkgPSBodG9ubChtYWlsYm94LT5kZWxldGVkKTsKQEAg
LTE0MzAsOSArMTQ0OCwxOCBAQAogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfRVhJU1RTKSkg
PSBodG9ubChtYWlsYm94LT5leGlzdHMpOwogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfTEFT
VF9BUFBFTkREQVRFKSkgPSBodG9ubChtYWlsYm94LT5sYXN0X2FwcGVuZGRhdGUpOwogICAgICoo
KGJpdDMyICopKGJ1ZitPRkZTRVRfTEFTVF9VSUQpKSA9IGh0b25sKG1haWxib3gtPmxhc3RfdWlk
KTsKLSAgICAvKiBPRkZTRVRfUVVPVEFfUkVTRVJWRURfRklFTEQgbGVmdCBhcyB6ZXJvICovCisK
KyAgICAvKiBuZXdlciB2ZXJzaW9ucyBtYXkgdXNlIDY0Yml0IHF1b3RhcyAqLworI2lmZGVmIEhB
VkVfTE9OR19MT05HX0lOVAorICAgICooKGJpdDY0ICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJP
WF9VU0VENjQpKSA9CisJaHRvbmxsKG1haWxib3gtPnF1b3RhX21haWxib3hfdXNlZCk7CisjZWxz
ZQkKKyAgICAvKiB6ZXJvIHRoZSB1bnVzZWQgMzJiaXRzICovCisgICAgKigoYml0MzIgKikoYnVm
K09GRlNFVF9RVU9UQV9NQUlMQk9YX1VTRUQ2NCkpID0gaHRvbmwoMCk7CiAgICAgKigoYml0MzIg
KikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9YX1VTRUQpKSA9CiAJaHRvbmwobWFpbGJveC0+cXVv
dGFfbWFpbGJveF91c2VkKTsKKyNlbmRpZgorCiAgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9Q
T1AzX0xBU1RfTE9HSU4pKSA9IGh0b25sKG1haWxib3gtPnBvcDNfbGFzdF9sb2dpbik7CiAgICAg
KigoYml0MzIgKikoYnVmK09GRlNFVF9VSURWQUxJRElUWSkpID0gaHRvbmwobWFpbGJveC0+dWlk
dmFsaWRpdHkpOwogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfREVMRVRFRCkpID0gaHRvbmwo
bWFpbGJveC0+ZGVsZXRlZCk7CkBAIC0xNjA4LDcgKzE2MzUsOCBAQAogICAgIHNpemVfdCBmbmFt
ZWJ1Zl9sZW47CiAgICAgRklMRSAqbmV3aW5kZXggPSBOVUxMLCAqbmV3Y2FjaGUgPSBOVUxMOwog
ICAgIHVuc2lnbmVkIGxvbmcgKmRlbGV0ZWQ7Ci0gICAgdW5zaWduZWQgbnVtZGVsZXRlZCA9IDAs
IHF1b3RhZGVsZXRlZCA9IDA7CisgICAgdW5zaWduZWQgbnVtZGVsZXRlZCA9IDA7CisgICAgdXF1
b3RhX3QgcXVvdGFkZWxldGVkID0gMDsKICAgICB1bnNpZ25lZCBudW1hbnN3ZXJlZGZsYWcgPSAw
OwogICAgIHVuc2lnbmVkIG51bWRlbGV0ZWRmbGFnID0gMDsKICAgICB1bnNpZ25lZCBudW1mbGFn
Z2VkZmxhZyA9IDA7CkBAIC0xODI5LDggKzE4NTcsMTMgQEAKICAgICAqKChiaXQzMiAqKShidWYr
T0ZGU0VUX0ZMQUdHRUQpKSA9IGh0b25sKG5ld2ZsYWdnZWQpOwogCiAgICAgLyogRml4IHVwIHF1
b3RhX21haWxib3hfdXNlZCAqLworI2lmZGVmIEhBVkVfTE9OR19MT05HX0lOVAorICAgICooKGJp
dDY0ICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VENjQpKSA9CisJaHRvbmxsKG50b2hs
bCgqKChiaXQ2NCAqKShidWYrT0ZGU0VUX1FVT1RBX01BSUxCT1hfVVNFRDY0KSkpLXF1b3RhZGVs
ZXRlZCk7CisjZWxzZQogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9V
U0VEKSkgPQogICAgICAgaHRvbmwobnRvaGwoKigoYml0MzIgKikoYnVmK09GRlNFVF9RVU9UQV9N
QUlMQk9YX1VTRUQpKSktcXVvdGFkZWxldGVkKTsKKyNlbmRpZgogICAgIC8qIEZpeCB1cCBzdGFy
dCBvZmZzZXQgaWYgbmVjZXNzYXJ5ICovCiAgICAgaWYgKG1haWxib3gtPnN0YXJ0X29mZnNldCA8
IElOREVYX0hFQURFUl9TSVpFKSB7CiAJKigoYml0MzIgKikoYnVmK09GRlNFVF9TVEFSVF9PRkZT
RVQpKSA9IGh0b25sKElOREVYX0hFQURFUl9TSVpFKTsKQEAgLTE4NjIsNyArMTg5NSw3IEBACiAJ
aWYgKCFyKSBxdW90YV9jb21taXQoJnRpZCk7CiAJZWxzZSB7CiAJICAgIHN5c2xvZyhMT0dfRVJS
LAotCQkgICAiTE9TVFFVT1RBOiB1bmFibGUgdG8gcmVjb3JkIGZyZWUgb2YgJXUgYnl0ZXMgaW4g
cXVvdGEgJXMiLAorCQkgICAiTE9TVFFVT1RBOiB1bmFibGUgdG8gcmVjb3JkIGZyZWUgb2YgIiBV
UVVPVEFfVF9GTVQgIiBieXRlcyBpbiBxdW90YSAlcyIsCiAJCSAgIHF1b3RhZGVsZXRlZCwgbWFp
bGJveC0+cXVvdGEucm9vdCk7CiAJfQogICAgIH0KQEAgLTIxMzIsNyArMjE2NSw3IEBACiAJciA9
IHF1b3RhX3dyaXRlKCZtYWlsYm94LT5xdW90YSwgJnRpZCk7CiAJaWYgKHIpIHsKIAkgICAgc3lz
bG9nKExPR19FUlIsCi0JCSAgICJMT1NUUVVPVEE6IHVuYWJsZSB0byByZWNvcmQgZnJlZSBvZiAl
bHUgYnl0ZXMgaW4gcXVvdGEgJXMiLAorCQkgICAiTE9TVFFVT1RBOiB1bmFibGUgdG8gcmVjb3Jk
IGZyZWUgb2YgIiBVUVVPVEFfVF9GTVQgIiBieXRlcyBpbiBxdW90YSAlcyIsCiAJCSAgIG1haWxi
b3gtPnF1b3RhX21haWxib3hfdXNlZCwgbWFpbGJveC0+cXVvdGEucm9vdCk7CiAJfQogCWVsc2UK
QEAgLTIyNTAsNyArMjI4Myw3IEBACiAJICAgIHN0cmNtcChvbGRtYWlsYm94LT5xdW90YS5yb290
LCBuZXdtYWlsYm94LT5xdW90YS5yb290KSAhPSAwKSB7CiAJICAgIGlmICghciAmJiBuZXdtYWls
Ym94LT5xdW90YS5saW1pdCA+PSAwICYmCiAJCW5ld21haWxib3gtPnF1b3RhLnVzZWQgKyBvbGRt
YWlsYm94LT5xdW90YV9tYWlsYm94X3VzZWQgPgotCQkoKHVuc2lnbmVkKSBuZXdtYWlsYm94LT5x
dW90YS5saW1pdCAqIFFVT1RBX1VOSVRTKSkgeworCQkoKHVxdW90YV90KSBuZXdtYWlsYm94LT5x
dW90YS5saW1pdCAqIFFVT1RBX1VOSVRTKSkgewogCQlyID0gSU1BUF9RVU9UQV9FWENFRURFRDsK
IAkgICAgfQogCX0KQEAgLTI0NjQsNyArMjQ5Nyw3IEBACiAJICAgIHN0cmNtcChvbGRtYWlsYm94
LnF1b3RhLnJvb3QsIG5ld21haWxib3gucXVvdGEucm9vdCkgIT0gMCkgewogCSAgICBpZiAoIXIg
JiYgbmV3bWFpbGJveC5xdW90YS5saW1pdCA+PSAwICYmCiAJCW5ld21haWxib3gucXVvdGEudXNl
ZCArIG9sZG1haWxib3gucXVvdGFfbWFpbGJveF91c2VkID4KLQkJKCh1bnNpZ25lZCkgbmV3bWFp
bGJveC5xdW90YS5saW1pdCAqIFFVT1RBX1VOSVRTKSkgeworCQkoKHVxdW90YV90KSBuZXdtYWls
Ym94LnF1b3RhLmxpbWl0ICogUVVPVEFfVU5JVFMpKSB7CiAJCXIgPSBJTUFQX1FVT1RBX0VYQ0VF
REVEOwogCSAgICB9CiAJfQpAQCAtMjYxNyw3ICsyNjUwLDcgQEAKIAllbHNlIGlmIChyMiA9PSBJ
TUFQX1FVT1RBUk9PVF9OT05FWElTVEVOVCkgcjIgPSAwOwogCWlmIChyMikgewogCSAgICBzeXNs
b2coTE9HX0VSUiwKLQkgICAgICAiTE9TVFFVT1RBOiB1bmFibGUgdG8gcmVjb3JkIHVzZSBvZiAl
bHUgYnl0ZXMgaW4gcXVvdGEgJXMiLAorCSAgICAgICJMT1NUUVVPVEE6IHVuYWJsZSB0byByZWNv
cmQgdXNlIG9mICIgVVFVT1RBX1RfRk1UICIgYnl0ZXMgaW4gcXVvdGEgJXMiLAogCQkgICBuZXdt
YWlsYm94LnF1b3RhX21haWxib3hfdXNlZCwgbmV3bWFpbGJveC5xdW90YS5yb290KTsKIAl9CiAg
ICAgfQpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyfi9pbWFwL21haWxib3guaCBjeXJ1cy1p
bWFwZC0yLjIuMTIvaW1hcC9tYWlsYm94LmgKLS0tIGN5cnVzLWltYXBkLTIuMi4xMn4vaW1hcC9t
YWlsYm94LmgJMjAwNC0wMS0yMiAyMjoxNzowOS4wMDAwMDAwMDAgKzAxMDAKKysrIGN5cnVzLWlt
YXBkLTIuMi4xMi9pbWFwL21haWxib3guaAkyMDA1LTA4LTMwIDEyOjA5OjI4LjAwMDAwMDAwMCAr
MDIwMApAQCAtNDUsNiArNDUsNyBAQAogI2luY2x1ZGUgPHN5cy90eXBlcy5oPgogI2luY2x1ZGUg
PHN5cy9zdGF0Lmg+CiAjaW5jbHVkZSA8bGltaXRzLmg+CisjaW5jbHVkZSA8Y29uZmlnLmg+CiAK
ICNpbmNsdWRlICJhdXRoLmgiCiAjaW5jbHVkZSAicXVvdGEuaCIKQEAgLTYxLDYgKzYyLDEwIEBA
CiAjZXJyb3IgZG9udCBrbm93IHdoYXQgdG8gdXNlIGZvciBiaXQzMgogI2VuZGlmCiAKKyNpZmRl
ZiBIQVZFX0xPTkdfTE9OR19JTlQKK3R5cGVkZWYgdW5zaWduZWQgbG9uZyBsb25nIGludCBiaXQ2
NDsKKyNlbmRpZgorCiAjZGVmaW5lIE1BWF9NQUlMQk9YX05BTUUgNDkwCiAjZGVmaW5lIE1BWF9N
QUlMQk9YX1BBVEggNDA5NgogCkBAIC0xMjYsNyArMTMxLDcgQEAKICAgICB1bnNpZ25lZCBsb25n
IGV4aXN0czsKICAgICB0aW1lX3QgbGFzdF9hcHBlbmRkYXRlOwogICAgIHVuc2lnbmVkIGxvbmcg
bGFzdF91aWQ7Ci0gICAgdW5zaWduZWQgbG9uZyBxdW90YV9tYWlsYm94X3VzZWQ7CisgICAgdXF1
b3RhX3QgcXVvdGFfbWFpbGJveF91c2VkOwogICAgIHVuc2lnbmVkIGxvbmcgcG9wM19sYXN0X2xv
Z2luOwogICAgIHVuc2lnbmVkIGxvbmcgdWlkdmFsaWRpdHk7CiAKQEAgLTE2OCw4ICsxNzMsOCBA
QAogI2RlZmluZSBPRkZTRVRfRVhJU1RTIDIwCiAjZGVmaW5lIE9GRlNFVF9MQVNUX0FQUEVORERB
VEUgMjQKICNkZWZpbmUgT0ZGU0VUX0xBU1RfVUlEIDI4Ci0jZGVmaW5lIE9GRlNFVF9RVU9UQV9S
RVNFUlZFRF9GSUVMRCAzMiAgLyogUmVzZXJ2ZWQgZm9yIDY0Yml0IHF1b3RhcyAqLwotI2RlZmlu
ZSBPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VEIDM2CisjZGVmaW5lIE9GRlNFVF9RVU9UQV9NQUlM
Qk9YX1VTRUQ2NCAzMiAgLyogb2Zmc2V0IGZvciA2NGJpdCBxdW90YXMgKi8KKyNkZWZpbmUgT0ZG
U0VUX1FVT1RBX01BSUxCT1hfVVNFRCAzNiAgICAvKiBvZmZzZXQgZm9yIDMyYml0IHF1b3RhcyAq
LwogI2RlZmluZSBPRkZTRVRfUE9QM19MQVNUX0xPR0lOIDQwCiAjZGVmaW5lIE9GRlNFVF9VSURW
QUxJRElUWSA0NAogI2RlZmluZSBPRkZTRVRfREVMRVRFRCA0OCAgICAgIC8qIGFkZGVkIGZvciBB
Q0FQICovCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTJ+L2ltYXAvbWJkdW1wLmMgY3lydXMt
aW1hcGQtMi4yLjEyL2ltYXAvbWJkdW1wLmMKLS0tIGN5cnVzLWltYXBkLTIuMi4xMn4vaW1hcC9t
YmR1bXAuYwkyMDA0LTA1LTIyIDA1OjQ1OjUxLjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtaW1h
cGQtMi4yLjEyL2ltYXAvbWJkdW1wLmMJMjAwNS0wOC0zMCAxMjowOToyOC4wMDAwMDAwMDAgKzAy
MDAKQEAgLTUwNyw3ICs1MDcsNyBAQAogewogICAgIHN0cnVjdCBidWYgZmlsZSwgZGF0YTsKICAg
ICBjaGFyIGM7Ci0gICAgaW50IHF1b3RhdXNlZCA9IDA7CisgICAgdXF1b3RhX3QgcXVvdGF1c2Vk
ID0gMDsKICAgICBpbnQgciA9IDA7CiAgICAgaW50IGN1cmZpbGUgPSAtMTsKICAgICBjb25zdCBj
aGFyICp1c2VyaWQgPSBOVUxMOwpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyfi9pbWFwL21i
ZXhhbWluZS5jIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL21iZXhhbWluZS5jCi0tLSBjeXJ1cy1p
bWFwZC0yLjIuMTJ+L2ltYXAvbWJleGFtaW5lLmMJMjAwNC0xMi0xNyAxNzozMjoxNi4wMDAwMDAw
MDAgKzAxMDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL21iZXhhbWluZS5jCTIwMDUtMDgt
MzAgMTI6MTE6MjMuMDAwMDAwMDAwICswMjAwCkBAIC0yNjYsNyArMjY2LDcgQEAKICAgICBwcmlu
dGYoIiAgTWlub3IgVmVyc2lvbjogJWRcbiIsIG1haWxib3gubWlub3JfdmVyc2lvbik7CiAgICAg
cHJpbnRmKCIgIEhlYWRlciBTaXplOiAlbGQgYnl0ZXMgIFJlY29yZCBTaXplOiAlbGQgYnl0ZXNc
biIsCiAJICAgbWFpbGJveC5zdGFydF9vZmZzZXQsIG1haWxib3gucmVjb3JkX3NpemUpOwotICAg
IHByaW50ZigiICBOdW1iZXIgb2YgTWVzc2FnZXM6ICVsdSAgTWFpbGJveCBTaXplOiAlbHUgYnl0
ZXNcbiIsCisgICAgcHJpbnRmKCIgIE51bWJlciBvZiBNZXNzYWdlczogJWx1ICBNYWlsYm94IFNp
emU6ICIgVVFVT1RBX1RfRk1UICIgYnl0ZXNcbiIsCiAJICAgbWFpbGJveC5leGlzdHMsIG1haWxi
b3gucXVvdGFfbWFpbGJveF91c2VkKTsKICAgICBwcmludGYoIiAgTGFzdCBBcHBlbmQgRGF0ZTog
KCVsZCkgJXMiLCBtYWlsYm94Lmxhc3RfYXBwZW5kZGF0ZSwKIAkgICBjdGltZSgmbWFpbGJveC5s
YXN0X2FwcGVuZGRhdGUpKTsKZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMn4vaW1hcC9tYm94
bGlzdC5jIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL21ib3hsaXN0LmMKLS0tIGN5cnVzLWltYXBk
LTIuMi4xMn4vaW1hcC9tYm94bGlzdC5jCTIwMDQtMDctMjYgMjA6MDg6MDMuMDAwMDAwMDAwICsw
MjAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9tYm94bGlzdC5jCTIwMDUtMDgtMzAgMTI6
MDk6MjguMDAwMDAwMDAwICswMjAwCkBAIC0yNTQwLDcgKzI1NDAsNyBAQAogCXIgPSBxdW90YV93
cml0ZSgmbWFpbGJveC5xdW90YSwgdGlkKTsKIAlpZiAocikgewogCSAgICBzeXNsb2coTE9HX0VS
UiwKLQkJICAgIkxPU1RRVU9UQTogdW5hYmxlIHRvIHJlY29yZCBmcmVlIG9mICVsdSBieXRlcyBp
biBxdW90YSAlcyIsCisJCSAgICJMT1NUUVVPVEE6IHVuYWJsZSB0byByZWNvcmQgZnJlZSBvZiAi
IFVRVU9UQV9UX0ZNVCAiIGJ5dGVzIGluIHF1b3RhICVzIiwKIAkJICAgbWFpbGJveC5xdW90YV9t
YWlsYm94X3VzZWQsIG1haWxib3gucXVvdGEucm9vdCk7CiAJfQogCWZyZWUobWFpbGJveC5xdW90
YS5yb290KTsKZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMn4vaW1hcC9xdW90YS5jIGN5cnVz
LWltYXBkLTIuMi4xMi9pbWFwL3F1b3RhLmMKLS0tIGN5cnVzLWltYXBkLTIuMi4xMn4vaW1hcC9x
dW90YS5jCTIwMDQtMDYtMzAgMjE6MjM6MjYuMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1cy1pbWFw
ZC0yLjIuMTIvaW1hcC9xdW90YS5jCTIwMDUtMDgtMzAgMTI6MDk6MjguMDAwMDAwMDAwICswMjAw
CkBAIC0xMjAsNyArMTIwLDcgQEAKICAgICBzdHJ1Y3QgcXVvdGEgcXVvdGE7CiAgICAgaW50IHJl
ZmNvdW50OwogICAgIGludCBkZWxldGVkOwotICAgIHVuc2lnbmVkIGxvbmcgbmV3dXNlZDsKKyAg
ICB1cXVvdGFfdCBuZXd1c2VkOwogfTsKIAogI2RlZmluZSBRVU9UQUdST1cgMzAwCkBAIC0yNTEs
NyArMjUxLDcgQEAKICAgICB9CiAgICAgbWVtc2V0KCZxdW90YVtxdW90YV9udW1dLCAwLCBzaXpl
b2Yoc3RydWN0IHF1b3RhZW50cnkpKTsKICAgICBxdW90YVtxdW90YV9udW1dLnF1b3RhLnJvb3Qg
PSB4c3RybmR1cChrZXksIGtleWxlbik7Ci0gICAgc3NjYW5mKGRhdGEsICIlbHUgJWQiLAorICAg
IHNzY2FuZihkYXRhLCBVUVVPVEFfVF9GTVQgIiAlZCIsCiAJICAgJnF1b3RhW3F1b3RhX251bV0u
cXVvdGEudXNlZCwgJnF1b3RhW3F1b3RhX251bV0ucXVvdGEubGltaXQpOwogICAKICAgICBxdW90
YV9udW0rKzsKQEAgLTQyMiw3ICs0MjIsNyBAQAogCSgqY291bnQpKys7CiAgICAgfQogICAgIGlm
IChxdW90YVt0aGlzcXVvdGFdLnF1b3RhLnVzZWQgIT0gcXVvdGFbdGhpc3F1b3RhXS5uZXd1c2Vk
KSB7Ci0JcHJpbnRmKCIlczogdXNhZ2Ugd2FzICVsdSwgbm93ICVsdVxuIiwgcXVvdGFbdGhpc3F1
b3RhXS5xdW90YS5yb290LAorCXByaW50ZigiJXM6IHVzYWdlIHdhcyAiIFVRVU9UQV9UX0ZNVCAi
LCBub3cgIiBVUVVPVEFfVF9GTVQgIlxuIiwgcXVvdGFbdGhpc3F1b3RhXS5xdW90YS5yb290LAog
CSAgICAgICBxdW90YVt0aGlzcXVvdGFdLnF1b3RhLnVzZWQsIHF1b3RhW3RoaXNxdW90YV0ubmV3
dXNlZCk7CiAJcXVvdGFbdGhpc3F1b3RhXS5xdW90YS51c2VkID0gcXVvdGFbdGhpc3F1b3RhXS5u
ZXd1c2VkOwogCXIgPSBxdW90YV93cml0ZSgmcXVvdGFbdGhpc3F1b3RhXS5xdW90YSwgdGlkKTsK
QEAgLTQ4OSwxMiArNDg5LDEyIEBACiAgICAgaW50IGk7CiAgICAgY2hhciBidWZbTUFYX01BSUxC
T1hfUEFUSCsxXTsKIAotICAgIHByaW50ZigiICAgUXVvdGEgICUlIFVzZWQgICAgVXNlZCBSb290
XG4iKTsKKyAgICBwcmludGYoIiAgIFF1b3RhICAgJSUgVXNlZCAgICAgVXNlZCBSb290XG4iKTsK
IAogICAgIGZvciAoaSA9IDA7IGkgPCBxdW90YV9udW07IGkrKykgewogCWlmIChxdW90YVtpXS5k
ZWxldGVkKSBjb250aW51ZTsKIAlpZiAocXVvdGFbaV0ucXVvdGEubGltaXQgPiAwKSB7Ci0JICAg
IHByaW50ZigiICU3ZCAlN2xkIiwgcXVvdGFbaV0ucXVvdGEubGltaXQsCisJICAgIHByaW50Zigi
ICU3ZCAiIFFVT1RBX1JFUE9SVF9GTVQgLCBxdW90YVtpXS5xdW90YS5saW1pdCwKIAkJICAgKChx
dW90YVtpXS5xdW90YS51c2VkIC8gUVVPVEFfVU5JVFMpICogMTAwKSAvIHF1b3RhW2ldLnF1b3Rh
LmxpbWl0KTsKIAl9CiAJZWxzZSBpZiAocXVvdGFbaV0ucXVvdGEubGltaXQgPT0gMCkgewpAQCAt
NTA3LDYgKzUwNyw2IEBACiAJKCpxdW90YV9uYW1lc3BhY2UubWJveG5hbWVfdG9leHRlcm5hbCko
JnF1b3RhX25hbWVzcGFjZSwKIAkJCQkJICAgICAgIHF1b3RhW2ldLnF1b3RhLnJvb3QsCiAJCQkJ
CSAgICAgICAiY3lydXMiLCBidWYpOwotCXByaW50ZigiICU3bGQgJXNcbiIsIHF1b3RhW2ldLnF1
b3RhLnVzZWQgLyBRVU9UQV9VTklUUywgYnVmKTsKKwlwcmludGYoIiAiIFFVT1RBX1JFUE9SVF9G
TVQgIiAlc1xuIiwgcXVvdGFbaV0ucXVvdGEudXNlZCAvIFFVT1RBX1VOSVRTLCBidWYpOwogICAg
IH0KIH0KZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMn4vaW1hcC9xdW90YV9kYi5jIGN5cnVz
LWltYXBkLTIuMi4xMi9pbWFwL3F1b3RhX2RiLmMKLS0tIGN5cnVzLWltYXBkLTIuMi4xMn4vaW1h
cC9xdW90YV9kYi5jCTIwMDQtMDUtMjIgMDU6NDU6NTIuMDAwMDAwMDAwICswMjAwCisrKyBjeXJ1
cy1pbWFwZC0yLjIuMTIvaW1hcC9xdW90YV9kYi5jCTIwMDUtMDgtMzAgMTI6MDk6MjguMDAwMDAw
MDAwICswMjAwCkBAIC04OSw3ICs4OSw3IEBACiAKICAgICBzd2l0Y2ggKHIpIHsKICAgICBjYXNl
IENZUlVTREJfT0s6Ci0Jc3NjYW5mKGRhdGEsICIlbHUgJWQiLCAmcXVvdGEtPnVzZWQsICZxdW90
YS0+bGltaXQpOworCXNzY2FuZihkYXRhLCBVUVVPVEFfVF9GTVQgIiAlZCIsICZxdW90YS0+dXNl
ZCwgJnF1b3RhLT5saW1pdCk7CiAJYnJlYWs7CiAKICAgICBjYXNlIENZUlVTREJfQUdBSU46CkBA
IC0xNTEsNyArMTUxLDcgQEAKICAgICBpZiAoIXFybGVuKSByZXR1cm4gSU1BUF9RVU9UQVJPT1Rf
Tk9ORVhJU1RFTlQ7CiAKICAgICBsZW4gPSBzbnByaW50ZihidWYsIHNpemVvZihidWYpIC0gMSwK
LQkJICAgIiVsdSAlZCIsIHF1b3RhLT51c2VkLCBxdW90YS0+bGltaXQpOworCQkgICBVUVVPVEFf
VF9GTVQgIiAlZCIsIHF1b3RhLT51c2VkLCBxdW90YS0+bGltaXQpOwogICAgIHIgPSBRREItPnN0
b3JlKHFkYiwgcXVvdGEtPnJvb3QsIHFybGVuLCBidWYsIGxlbiwgdGlkKTsKICAgICAKICAgICBz
d2l0Y2ggKHIpIHsKZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMn4vaW1hcC9xdW90YS5oIGN5
cnVzLWltYXBkLTIuMi4xMi9pbWFwL3F1b3RhLmgKLS0tIGN5cnVzLWltYXBkLTIuMi4xMn4vaW1h
cC9xdW90YS5oCTIwMDQtMDItMjcgMTg6NDQ6NTYuMDAwMDAwMDAwICswMTAwCisrKyBjeXJ1cy1p
bWFwZC0yLjIuMTIvaW1hcC9xdW90YS5oCTIwMDUtMDgtMzAgMTI6MTA6MzcuMDAwMDAwMDAwICsw
MjAwCkBAIC00NSwxOCArNDUsMzcgQEAKICNkZWZpbmUgSU5DTFVERURfUVVPVEFfSAogCiAjaW5j
bHVkZSAiY3lydXNkYi5oIgorI2luY2x1ZGUgPGNvbmZpZy5oPgogCiAjZGVmaW5lIEZOQU1FX1FV
T1RBREIgIi9xdW90YXMuZGIiCiAKICNkZWZpbmUgUVVPVEFfVU5JVFMgKDEwMjQpCiAKKy8qIERl
ZmluZSB0aGUgcHJvcGVyIHF1b3RhIHR5cGUsIGl0IHNob3VsZCBlaXRoZXIgYmUgYQorICogbG9u
ZyBvciBhIGxvbmcgbG9uZyBpbnQgZGVwZW5kaW5nIHVwb24gd2hhdCB0aGUKKyAqIHRoZSBjb21w
aWxlciBzdXBwb3J0cy4KKyAqLworI2lmZGVmIEhBVkVfTE9OR19MT05HX0lOVAordHlwZWRlZiB1
bnNpZ25lZCBsb25nIGxvbmcgaW50IHVxdW90YV90OwordHlwZWRlZiBsb25nIGxvbmcgaW50IHF1
b3RhX3Q7CisjZGVmaW5lIFVRVU9UQV9UX0ZNVCAgICAgIiVsbHUiCisjZGVmaW5lIFFVT1RBX1Rf
Rk1UICAgICAgIiVsbGQiCisjZGVmaW5lIFFVT1RBX1JFUE9SVF9GTVQgIiU4bGx1IgorI2Vsc2UK
K3R5cGVkZWYgdW5zaWduZWQgbG9uZyB1cXVvdGFfdDsKK3R5cGVkZWYgbG9uZyBxdW90YV90Owor
I2RlZmluZSBVUVVPVEFfVF9GTVQgICAgICIlbHUiCisjZGVmaW5lIFFVT1RBX1RfRk1UICAgICAg
IiVsZCIKKyNkZWZpbmUgUVVPVEFfUkVQT1JUX0ZNVCAiJThsdSIKKyNlbmRpZgorCiBleHRlcm4g
c3RydWN0IGRiICpxZGI7CiAKIHN0cnVjdCBxdW90YSB7CiAgICAgY2hhciAqcm9vdDsKIAogICAg
IC8qIEluZm9ybWF0aW9uIGluIHF1b3RhIGVudHJ5ICovCi0gICAgdW5zaWduZWQgbG9uZyB1c2Vk
OworICAgIHVxdW90YV90IHVzZWQ7CiAgICAgaW50IGxpbWl0OwkJCS8qIGluIFFVT1RBX1VOSVRT
ICovCiB9OwogCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTJ+L2ltYXAvcmVjb25zdHJ1Y3Qu
YyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9yZWNvbnN0cnVjdC5jCi0tLSBjeXJ1cy1pbWFwZC0y
LjIuMTJ+L2ltYXAvcmVjb25zdHJ1Y3QuYwkyMDA0LTEwLTExIDE2OjAxOjI0LjAwMDAwMDAwMCAr
MDIwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvcmVjb25zdHJ1Y3QuYwkyMDA1LTA4LTMw
IDEyOjA5OjI4LjAwMDAwMDAwMCArMDIwMApAQCAtOTMsNiArOTMsNyBAQAogI2luY2x1ZGUgInJl
dHJ5LmgiCiAjaW5jbHVkZSAiY29udmVydF9jb2RlLmgiCiAjaW5jbHVkZSAidXRpbC5oIgorI2lu
Y2x1ZGUgImJ5dGVvcmRlcjY0LmgiCiAKIGV4dGVybiBpbnQgb3B0aW5kOwogZXh0ZXJuIGNoYXIg
Km9wdGFyZzsKQEAgLTQzNCw3ICs0MzUsNyBAQAogICAgIGNoYXIgKmxpc3RfYWNsLCAqbGlzdF9w
YXJ0OwogICAgIGludCBsaXN0X3R5cGU7CiAKLSAgICB1bnNpZ25lZCBsb25nIG5ld19xdW90YSA9
IDA7CisgICAgdXF1b3RhX3QgbmV3X3F1b3RhID0gMDsKIAogICAgIHN0cnVjdCBpbmRleF9yZWNv
cmQgbWVzc2FnZV9pbmRleCwgb2xkX2luZGV4OwogICAgIHN0YXRpYyBzdHJ1Y3QgaW5kZXhfcmVj
b3JkIHplcm9faW5kZXg7CkBAIC02OTAsNyArNjkxLDE0IEBACiAgICAgKigoYml0MzIgKikoYnVm
K09GRlNFVF9FWElTVFMpKSA9IGh0b25sKG5ld19leGlzdHMpOwogICAgICooKGJpdDMyICopKGJ1
ZitPRkZTRVRfTEFTVF9BUFBFTkREQVRFKSkgPSBodG9ubChtYWlsYm94Lmxhc3RfYXBwZW5kZGF0
ZSk7CiAgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9MQVNUX1VJRCkpID0gaHRvbmwobWFpbGJv
eC5sYXN0X3VpZCk7Ci0gICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9YX1VT
RUQpKSA9IGh0b25sKG5ld19xdW90YSk7CisKKyAgICAvKiBxdW90YXMgbWF5IGJlIDY0Yml0IG5v
dyAqLworI2lmZGVmIEhBVkVfTE9OR19MT05HX0lOVAorICAgICooKGJpdDY0ICopKGJ1ZitPRkZT
RVRfUVVPVEFfTUFJTEJPWF9VU0VENjQpKSA9IGh0b25sbChuZXdfcXVvdGEpOworI2Vsc2UKKyAg
ICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1FVT1RBX01BSUxCT1hfVVNFRDMyKSkgPSBodG9ubChu
ZXdfcXVvdGEpOworI2VuZGlmCisKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1BPUDNfTEFT
VF9MT0dJTikpID0gaHRvbmwobWFpbGJveC5wb3AzX2xhc3RfbG9naW4pOwogICAgICooKGJpdDMy
ICopKGJ1ZitPRkZTRVRfVUlEVkFMSURJVFkpKSA9IGh0b25sKG1haWxib3gudWlkdmFsaWRpdHkp
OwogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfREVMRVRFRCkpID0gaHRvbmwobmV3X2RlbGV0
ZWQpOwpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyfi9saWIvYnl0ZW9yZGVyNjQuYyBjeXJ1
cy1pbWFwZC0yLjIuMTIvbGliL2J5dGVvcmRlcjY0LmMKLS0tIGN5cnVzLWltYXBkLTIuMi4xMn4v
bGliL2J5dGVvcmRlcjY0LmMJMTk3MC0wMS0wMSAwMTowMDowMC4wMDAwMDAwMDAgKzAxMDAKKysr
IGN5cnVzLWltYXBkLTIuMi4xMi9saWIvYnl0ZW9yZGVyNjQuYwkyMDA1LTA4LTMwIDEyOjE5OjQ5
LjAwMDAwMDAwMCArMDIwMApAQCAtMCwwICsxLDk1IEBACisvKiBieXRlb3JkZXI2NC5jIC0tIGNv
bnZlcnQgNjQtYml0IHZhbHVlcyBiZXR3ZWVuIGhvc3QgYW5kIG5ldHdvcmsgYnl0ZSBvcmRlcgor
ICogCisgKiBDb3B5cmlnaHQgKGMpIDIwMDQgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkuICBB
bGwgcmlnaHRzIHJlc2VydmVkLgorICoKKyAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291
cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAorICogbW9kaWZpY2F0aW9uLCBh
cmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zCisgKiBh
cmUgbWV0OgorICoKKyAqIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJl
dGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0CisgKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25k
aXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuIAorICoKKyAqIDIuIFJlZGlzdHJp
YnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0
CisgKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5n
IGRpc2NsYWltZXIgaW4KKyAqICAgIHRoZSBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRl
cmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUKKyAqICAgIGRpc3RyaWJ1dGlvbi4KKyAqCisgKiAzLiBU
aGUgbmFtZSAiQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkiIG11c3Qgbm90IGJlIHVzZWQgdG8K
KyAqICAgIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0
d2FyZSB3aXRob3V0CisgKiAgICBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uIEZvciBwZXJtaXNz
aW9uIG9yIGFueSBvdGhlciBsZWdhbAorICogICAgZGV0YWlscywgcGxlYXNlIGNvbnRhY3QgIAor
ICogICAgICBPZmZpY2Ugb2YgVGVjaG5vbG9neSBUcmFuc2ZlcgorICogICAgICBDYXJuZWdpZSBN
ZWxsb24gVW5pdmVyc2l0eQorICogICAgICA1MDAwIEZvcmJlcyBBdmVudWUKKyAqICAgICAgUGl0
dHNidXJnaCwgUEEgIDE1MjEzLTM4OTAKKyAqICAgICAgKDQxMikgMjY4LTQzODcsIGZheDogKDQx
MikgMjY4LTczOTUKKyAqICAgICAgdGVjaC10cmFuc2ZlckBhbmRyZXcuY211LmVkdQorICoKKyAq
IDQuIFJlZGlzdHJpYnV0aW9ucyBvZiBhbnkgZm9ybSB3aGF0c29ldmVyIG11c3QgcmV0YWluIHRo
ZSBmb2xsb3dpbmcKKyAqICAgIGFja25vd2xlZGdtZW50OgorICogICAgIlRoaXMgcHJvZHVjdCBp
bmNsdWRlcyBzb2Z0d2FyZSBkZXZlbG9wZWQgYnkgQ29tcHV0aW5nIFNlcnZpY2VzCisgKiAgICAg
YXQgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkgKGh0dHA6Ly93d3cuY211LmVkdS9jb21wdXRp
bmcvKS4iCisgKgorICogQ0FSTkVHSUUgTUVMTE9OIFVOSVZFUlNJVFkgRElTQ0xBSU1TIEFMTCBX
QVJSQU5USUVTIFdJVEggUkVHQVJEIFRPCisgKiBUSElTIFNPRlRXQVJFLCBJTkNMVURJTkcgQUxM
IElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkKKyAqIEFORCBGSVRORVNTLCBJ
TiBOTyBFVkVOVCBTSEFMTCBDQVJORUdJRSBNRUxMT04gVU5JVkVSU0lUWSBCRSBMSUFCTEUKKyAq
IEZPUiBBTlkgU1BFQ0lBTCwgSU5ESVJFQ1QgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFO
WSBEQU1BR0VTCisgKiBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NIExPU1MgT0YgVVNFLCBEQVRB
IE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4KKyAqIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElH
RU5DRSBPUiBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcKKyAqIE9VVCBPRiBPUiBJTiBD
T05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUiBQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLgor
ICoKKyAqICRJZDogYnl0ZW9yZGVyNjQuYyx2IDEuMS4yLjEgMjAwNC8wOC8wOSAxODo1MToyMSBr
ZW4zIEV4cCAkCisgKi8KKworI2luY2x1ZGUgPGNvbmZpZy5oPgorCisjaWYgZGVmaW5lZChIQVZF
X0xPTkdfTE9OR19JTlQpICYmICFkZWZpbmVkKFdPUkRTX0JJR0VORElBTikKKworI2luY2x1ZGUg
PG5ldGluZXQvaW4uaD4KKworLyogU3RydWN0dXJlIHVzZWQgdG8gc3dhcCB0aGUgYnl0ZXMgaW4g
YSA2NC1iaXQgdW5zaWduZWQgbG9uZyBsb25nLiAqLwordW5pb24gYnl0ZXN3YXBfNjRfdSB7Cisg
ICAgdW5zaWduZWQgbG9uZyBsb25nIGE7CisgICAgdWludDMyX3QgYlsyXTsKK307CisKKy8qIEZ1
bmN0aW9uIHRvIGJ5dGVzd2FwIDY0Yml0IHVuc2lnbmVkIGludGVnZXJzIG9uCisgKiBsaXR0bGUg
ZW5kaWFuIG1hY2hpbmVzIHRvIGJpZyBlbmRpYW4gbmV0d29yayBvcmRlci4gCisgKiBPbiBiaWcg
ZW5kaWFuIG1hY2hpbmVzIHRoaXMgd2lsbCBiZSBhIG51bGwgbWFjcm8uCisgKiBUaGUgbWFjcm8g
aHRvbmxsKCkgaXMgZGVmaW5lZCBpbiBieXRlb3JkZXI2NC5oLAorICogYW5kIGlmIG5lZWRlZCBy
ZWZlcnMgdG8gX2h0b25sbCgpIGhlcmUuCisgKi8KK3Vuc2lnbmVkIGxvbmcgbG9uZyBfaHRvbmxs
KHVuc2lnbmVkIGxvbmcgbG9uZyB4KQoreworICAgIHVuaW9uIGJ5dGVzd2FwXzY0X3UgdTE7Cisg
ICAgdW5pb24gYnl0ZXN3YXBfNjRfdSB1MjsKKworICAgIHUxLmEgPSB4OworCisgICAgdTIuYlsw
XSA9IGh0b25sKHUxLmJbMV0pOworICAgIHUyLmJbMV0gPSBodG9ubCh1MS5iWzBdKTsKKworICAg
IHJldHVybiB1Mi5hOworfQorCisKKy8qIEZ1bmN0aW9uIHRvIGJ5dGVzd2FwIGJpZyBlbmRpYW4g
NjRiaXQgdW5zaWduZWQgaW50ZWdlcnMKKyAqIGJhY2sgdG8gbGl0dGxlIGVuZGlhbiBob3N0IG9y
ZGVyIG9uIGxpdHRsZSBlbmRpYW4gbWFjaGluZXMuIAorICogQXMgYWJvdmUsIG9uIGJpZyBlbmRp
YW4gbWFjaGluZXMgdGhpcyB3aWxsIGJlIGEgbnVsbCBtYWNyby4KKyAqIFRoZSBtYWNybyBudG9o
bGwoKSBpcyBkZWZpbmVkIGluIGJ5dGVvcmRlcjY0LmgsIGFuZCBpZiBuZWVkZWQsCisgKiByZWZl
cnMgdG8gX250b2hsbCgpIGhlcmUuCisgKi8KK3Vuc2lnbmVkIGxvbmcgbG9uZyBfbnRvaGxsKHVu
c2lnbmVkIGxvbmcgbG9uZyB4KQoreworICAgIHVuaW9uIGJ5dGVzd2FwXzY0X3UgdTE7CisgICAg
dW5pb24gYnl0ZXN3YXBfNjRfdSB1MjsKKworICAgIHUxLmEgPSB4OworCisgICAgdTIuYlsxXSA9
IG50b2hsKHUxLmJbMF0pOworICAgIHUyLmJbMF0gPSBudG9obCh1MS5iWzFdKTsKKworICAgIHJl
dHVybiB1Mi5hOworfQorCisjZW5kaWYgLyogZGVmaW5lZChIQVZFX0xPTkdfTE9OR19JTlQpICYm
ICFkZWZpbmVkKFdPUkRTX0JJR0VORElBTikgKi8KZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4x
Mn4vbGliL2J5dGVvcmRlcjY0LmggY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9ieXRlb3JkZXI2NC5o
Ci0tLSBjeXJ1cy1pbWFwZC0yLjIuMTJ+L2xpYi9ieXRlb3JkZXI2NC5oCTE5NzAtMDEtMDEgMDE6
MDA6MDAuMDAwMDAwMDAwICswMTAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2J5dGVvcmRl
cjY0LmgJMjAwNS0wOC0zMCAxMjoxOToxMy4wMDAwMDAwMDAgKzAyMDAKQEAgLTAsMCArMSw2NSBA
QAorLyogYnl0ZW9yZGVyNjQuaCAtLSBjb252ZXJ0IDY0LWJpdCB2YWx1ZXMgYmV0d2VlbiBob3N0
IGFuZCBuZXR3b3JrIGJ5dGUgb3JkZXIKKyAqCisgKiBDb3B5cmlnaHQgKGMpIDIwMDQgQ2FybmVn
aWUgTWVsbG9uIFVuaXZlcnNpdHkuICBBbGwgcmlnaHRzIHJlc2VydmVkLgorICoKKyAqIFJlZGlz
dHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0
aG91dAorICogbW9kaWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZv
bGxvd2luZyBjb25kaXRpb25zCisgKiBhcmUgbWV0OgorICoKKyAqIDEuIFJlZGlzdHJpYnV0aW9u
cyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0CisgKiAgICBu
b3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWlt
ZXIuIAorICoKKyAqIDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJv
ZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0CisgKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25k
aXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4KKyAqICAgIHRoZSBkb2N1bWVu
dGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUKKyAqICAgIGRp
c3RyaWJ1dGlvbi4KKyAqCisgKiAzLiBUaGUgbmFtZSAiQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNp
dHkiIG11c3Qgbm90IGJlIHVzZWQgdG8KKyAqICAgIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0
cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0CisgKiAgICBwcmlvciB3cml0dGVu
IHBlcm1pc3Npb24uIEZvciBwZXJtaXNzaW9uIG9yIGFueSBvdGhlciBsZWdhbAorICogICAgZGV0
YWlscywgcGxlYXNlIGNvbnRhY3QgIAorICogICAgICBPZmZpY2Ugb2YgVGVjaG5vbG9neSBUcmFu
c2ZlcgorICogICAgICBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eQorICogICAgICA1MDAwIEZv
cmJlcyBBdmVudWUKKyAqICAgICAgUGl0dHNidXJnaCwgUEEgIDE1MjEzLTM4OTAKKyAqICAgICAg
KDQxMikgMjY4LTQzODcsIGZheDogKDQxMikgMjY4LTczOTUKKyAqICAgICAgdGVjaC10cmFuc2Zl
ckBhbmRyZXcuY211LmVkdQorICoKKyAqIDQuIFJlZGlzdHJpYnV0aW9ucyBvZiBhbnkgZm9ybSB3
aGF0c29ldmVyIG11c3QgcmV0YWluIHRoZSBmb2xsb3dpbmcKKyAqICAgIGFja25vd2xlZGdtZW50
OgorICogICAgIlRoaXMgcHJvZHVjdCBpbmNsdWRlcyBzb2Z0d2FyZSBkZXZlbG9wZWQgYnkgQ29t
cHV0aW5nIFNlcnZpY2VzCisgKiAgICAgYXQgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkgKGh0
dHA6Ly93d3cuY211LmVkdS9jb21wdXRpbmcvKS4iCisgKgorICogQ0FSTkVHSUUgTUVMTE9OIFVO
SVZFUlNJVFkgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEggUkVHQVJEIFRPCisgKiBUSElT
IFNPRlRXQVJFLCBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFC
SUxJVFkKKyAqIEFORCBGSVRORVNTLCBJTiBOTyBFVkVOVCBTSEFMTCBDQVJORUdJRSBNRUxMT04g
VU5JVkVSU0lUWSBCRSBMSUFCTEUKKyAqIEZPUiBBTlkgU1BFQ0lBTCwgSU5ESVJFQ1QgT1IgQ09O
U0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTCisgKiBXSEFUU09FVkVSIFJFU1VMVElO
RyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4KKyAqIEFOIEFD
VElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUiBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFS
SVNJTkcKKyAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUiBQRVJGT1JN
QU5DRSBPRiBUSElTIFNPRlRXQVJFLgorICoKKyAqICRJZDogYnl0ZW9yZGVyNjQuaCx2IDEuMS4y
LjIgMjAwNC8wOC8xNiAxMTo0NDozNCBrZW4zIEV4cCAkCisgKi8KKworI2lmbmRlZiBfQllURU9S
REVSNjRfSAorI2RlZmluZSBfQllURU9SREVSNjRfSAorCisjaW5jbHVkZSA8Y29uZmlnLmg+CisK
KyNpZmRlZiBIQVZFX0xPTkdfTE9OR19JTlQKKworLyogNjQtYml0IGhvc3QvbmV0d29yayBieXRl
LW9yZGVyIHN3YXAgbWFjcm9zICovCisjaWZkZWYgV09SRFNfQklHRU5ESUFOCisjZGVmaW5lIGh0
b25sbCh4KSAoeCkKKyNkZWZpbmUgbnRvaGxsKHgpICh4KQorI2Vsc2UKKyNkZWZpbmUgaHRvbmxs
KHgpIF9odG9ubGwoeCkKKyNkZWZpbmUgbnRvaGxsKHgpIF9udG9obGwoeCkKKworLyogbGl0dGxl
LWVuZGlhbiA2NC1iaXQgaG9zdC9uZXR3b3JrIGJ5dGUtb3JkZXIgc3dhcCBmdW5jdGlvbnMgKi8K
K2V4dGVybiB1bnNpZ25lZCBsb25nIGxvbmcgX2h0b25sbCh1bnNpZ25lZCBsb25nIGxvbmcpOwor
ZXh0ZXJuIHVuc2lnbmVkIGxvbmcgbG9uZyBfbnRvaGxsKHVuc2lnbmVkIGxvbmcgbG9uZyk7CisK
KyNlbmRpZiAvKiBXT1JEU19CSUdFTkRJQU4gKi8KKyNlbmRpZiAvKiBIQVZFX0xPTkdfTE9OR19J
TlQgKi8KKyNlbmRpZiAvKiBfQllURU9SREVSNjRfSCAqLwpkaWZmIC11ck4gY3lydXMtaW1hcGQt
Mi4yLjEyfi9saWIvTWFrZWZpbGUuaW4gY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9NYWtlZmlsZS5p
bgotLS0gY3lydXMtaW1hcGQtMi4yLjEyfi9saWIvTWFrZWZpbGUuaW4JMjAwNC0wNS0yOCAyMDow
MzowNC4wMDAwMDAwMDAgKzAyMDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9saWIvTWFrZWZpbGUu
aW4JMjAwNS0wOC0zMCAxMjowOToyOC4wMDAwMDAwMDAgKzAyMDAKQEAgLTg1LDcgKzg1LDcgQEAK
IAkkKHNyY2RpcikvbHNvcnQuaCAkKHNyY2Rpcikvc3RyaXN0ci5oIFwKIAkkKHNyY2RpcikvdXRp
bC5oICQoc3JjZGlyKS94bWFsbG9jLmggJChzcmNkaXIpL2ltYXB1cmwuaCBcCiAJJChzcmNkaXIp
L2N5cnVzZGIuaCAkKHNyY2RpcikvaXB0b3N0cmluZy5oICQoc3JjZGlyKS9yZmM4MjJkYXRlLmgg
XAotCSQoc3JjZGlyKS9saWJjeXJfY2ZnLmgKKwkkKHNyY2RpcikvbGliY3lyX2NmZy5oICQoc3Jj
ZGlyKS9ieXRlb3JkZXI2NC5oCiAKIExJQkNZUl9PQkpTID0gYWNsLm8gYnNlYXJjaC5vIGNoYXJz
ZXQubyBnbG9iLm8gcmV0cnkubyB1dGlsLm8gXAogCWxpYmN5cl9jZmcubyBta2dtdGltZS5vIHBy
b3QubyBwYXJzZWFkZHIubyBpbWNsaWVudC5vIGltcGFyc2UubyBcCkBAIC05Myw3ICs5Myw3IEBA
CiAJY2hhcnRhYmxlLm8gaW1hcHVybC5vIG5vbmJsb2NrX0BXSVRIX05PTkJMT0NLQC5vIGxvY2tf
QFdJVEhfTE9DS0AubyBcCiAJZ210b2ZmX0BXSVRIX0dNVE9GRkAubyBtYXBfQFdJVEhfTUFQQC5v
ICQoQUNMKSAkKEFVVEgpIFwKIAlATElCT0JKU0AgQENZUlVTREJfT0JKU0AgXAotCWlwdG9zdHJp
bmcubyB4bWFsbG9jLm8gd2lsZG1hdC5vCisJaXB0b3N0cmluZy5vIHhtYWxsb2MubyB3aWxkbWF0
Lm8gYnl0ZW9yZGVyNjQubwogCiBMSUJDWVJNX0hEUlMgPSAkKHNyY2RpcikvaGFzaC5oICQoc3Jj
ZGlyKS9tcG9vbC5oICQoc3JjZGlyKS94bWFsbG9jLmggXAogCSQoc3JjZGlyKS9zdHJoYXNoLm8g
JChzcmNkaXIpL2xpYmNvbmZpZy5oICQoc3JjZGlyKS9hc3NlcnQuaCBcCmRpZmYgLXVyTiBjeXJ1
cy1pbWFwZC0yLjIuMTJ+L2xpYi9wcm90LmMgY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9wcm90LmMK
LS0tIGN5cnVzLWltYXBkLTIuMi4xMn4vbGliL3Byb3QuYwkyMDA0LTAyLTI3IDIzOjA4OjU2LjAw
MDAwMDAwMCArMDEwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9wcm90LmMJMjAwNS0wOC0z
MCAxMjowOToyOC4wMDAwMDAwMDAgKzAyMDAKQEAgLTg3MSw2ICs4NzEsMTEgQEAKICAgICBjaGFy
IGJ1ZlszMF07CiAgICAgdmFfc3RhcnQocHZhciwgZm10KTsKIAorI2lmZGVmIEhBVkVfTE9OR19M
T05HX0lOVAorICAgIGxvbmcgbG9uZyBpbnQgbGw7CisgICAgdW5zaWduZWQgbG9uZyBsb25nIGlu
dCB1bGw7CisjZW5kaWYKKwogICAgIGFzc2VydChzLT53cml0ZSk7CiAKICAgICB3aGlsZSAoKHBl
cmNlbnQgPSBzdHJjaHIoZm10LCAnJScpKSAhPSAwKSB7CkBAIC04OTQsNiArODk5LDI3IEBACiAJ
CXByb3Rfd3JpdGUocywgYnVmLCBzdHJsZW4oYnVmKSk7CiAJCWJyZWFrOwogCisjaWZkZWYgSEFW
RV9MT05HX0xPTkdfSU5UCisgICAgICAgICAgICBjYXNlICdsJzoKKwkgICAgICAgIHN3aXRjaCAo
KisrcGVyY2VudCkgeworCQljYXNlICdkJzoKKwkJICAgIGxsID0gdmFfYXJnKHB2YXIsIGxvbmcg
bG9uZyBpbnQpOworCQkgICAgc25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwgIiVsbGQiLCBsbCk7
CisJCSAgICBwcm90X3dyaXRlKHMsIGJ1Ziwgc3RybGVuKGJ1ZikpOworCQkgICAgYnJlYWs7CisK
KwkJY2FzZSAndSc6CisJCSAgICB1bGwgPSB2YV9hcmcocHZhciwgdW5zaWduZWQgbG9uZyBsb25n
IGludCk7CisJCSAgICBzbnByaW50ZihidWYsIHNpemVvZihidWYpLCAiJWxsdSIsIHVsbCk7CisJ
CSAgICBwcm90X3dyaXRlKHMsIGJ1Ziwgc3RybGVuKGJ1ZikpOworCQkgICAgYnJlYWs7CisKKwkg
ICAgICAgIGRlZmF1bHQ6CisJCSAgICBhYm9ydCgpOworCQl9CisJCWJyZWFrOworI2VuZGlmCisK
IAkgICAgZGVmYXVsdDoKIAkJYWJvcnQoKTsKIAkgICAgfQo=
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>456</attachid>
            <date>2006-08-22 12:20 EDT</date>
            <desc>64-bit quota patch for 2.2.12, including byteorder64.[ch]</desc>
            <filename>cyrus-imapd-2.2.12-64bit-quotas.patch</filename>
            <type>text/plain</type>
            <size>23321</size>
            <attacher>ralston@pobox.com</attacher>
            
              <data encoding="base64">LS0tIGN5cnVzLWltYXBkLTIuMi4xMi9saWIvYnl0ZW9yZGVyNjQuYy42NGJpdC1xdW90YXMJMjAw
Ni0wOC0yMiAxMjowMjowNi4wMDAwMDAwMDAgLTA0MDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9s
aWIvYnl0ZW9yZGVyNjQuYwkyMDA2LTA4LTIyIDEyOjAyOjA2LjAwMDAwMDAwMCAtMDQwMApAQCAt
MCwwICsxLDk1IEBACisvKiBieXRlb3JkZXI2NC5jIC0tIGNvbnZlcnQgNjQtYml0IHZhbHVlcyBi
ZXR3ZWVuIGhvc3QgYW5kIG5ldHdvcmsgYnl0ZSBvcmRlcgorICogCisgKiBDb3B5cmlnaHQgKGMp
IDIwMDQgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkuICBBbGwgcmlnaHRzIHJlc2VydmVkLgor
ICoKKyAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMs
IHdpdGggb3Igd2l0aG91dAorICogbW9kaWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVk
IHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zCisgKiBhcmUgbWV0OgorICoKKyAqIDEuIFJl
ZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJp
Z2h0CisgKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93
aW5nIGRpc2NsYWltZXIuIAorICoKKyAqIDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9y
bSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0CisgKiAgICBub3RpY2UsIHRoaXMg
bGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4KKyAqICAg
IHRoZSBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0
aGUKKyAqICAgIGRpc3RyaWJ1dGlvbi4KKyAqCisgKiAzLiBUaGUgbmFtZSAiQ2FybmVnaWUgTWVs
bG9uIFVuaXZlcnNpdHkiIG11c3Qgbm90IGJlIHVzZWQgdG8KKyAqICAgIGVuZG9yc2Ugb3IgcHJv
bW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0CisgKiAgICBw
cmlvciB3cml0dGVuIHBlcm1pc3Npb24uIEZvciBwZXJtaXNzaW9uIG9yIGFueSBvdGhlciBsZWdh
bAorICogICAgZGV0YWlscywgcGxlYXNlIGNvbnRhY3QgIAorICogICAgICBPZmZpY2Ugb2YgVGVj
aG5vbG9neSBUcmFuc2ZlcgorICogICAgICBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eQorICog
ICAgICA1MDAwIEZvcmJlcyBBdmVudWUKKyAqICAgICAgUGl0dHNidXJnaCwgUEEgIDE1MjEzLTM4
OTAKKyAqICAgICAgKDQxMikgMjY4LTQzODcsIGZheDogKDQxMikgMjY4LTczOTUKKyAqICAgICAg
dGVjaC10cmFuc2ZlckBhbmRyZXcuY211LmVkdQorICoKKyAqIDQuIFJlZGlzdHJpYnV0aW9ucyBv
ZiBhbnkgZm9ybSB3aGF0c29ldmVyIG11c3QgcmV0YWluIHRoZSBmb2xsb3dpbmcKKyAqICAgIGFj
a25vd2xlZGdtZW50OgorICogICAgIlRoaXMgcHJvZHVjdCBpbmNsdWRlcyBzb2Z0d2FyZSBkZXZl
bG9wZWQgYnkgQ29tcHV0aW5nIFNlcnZpY2VzCisgKiAgICAgYXQgQ2FybmVnaWUgTWVsbG9uIFVu
aXZlcnNpdHkgKGh0dHA6Ly93d3cuY211LmVkdS9jb21wdXRpbmcvKS4iCisgKgorICogQ0FSTkVH
SUUgTUVMTE9OIFVOSVZFUlNJVFkgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEggUkVHQVJE
IFRPCisgKiBUSElTIFNPRlRXQVJFLCBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBP
RiBNRVJDSEFOVEFCSUxJVFkKKyAqIEFORCBGSVRORVNTLCBJTiBOTyBFVkVOVCBTSEFMTCBDQVJO
RUdJRSBNRUxMT04gVU5JVkVSU0lUWSBCRSBMSUFCTEUKKyAqIEZPUiBBTlkgU1BFQ0lBTCwgSU5E
SVJFQ1QgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTCisgKiBXSEFUU09F
VkVSIFJFU1VMVElORyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIg
SU4KKyAqIEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUiBPVEhFUiBUT1JUSU9V
UyBBQ1RJT04sIEFSSVNJTkcKKyAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVT
RSBPUiBQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLgorICoKKyAqICRJZDogYnl0ZW9yZGVy
NjQuYyx2IDEuMS4yLjEgMjAwNC8wOC8wOSAxODo1MToyMSBrZW4zIEV4cCAkCisgKi8KKworI2lu
Y2x1ZGUgPGNvbmZpZy5oPgorCisjaWYgZGVmaW5lZChIQVZFX0xPTkdfTE9OR19JTlQpICYmICFk
ZWZpbmVkKFdPUkRTX0JJR0VORElBTikKKworI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4KKworLyog
U3RydWN0dXJlIHVzZWQgdG8gc3dhcCB0aGUgYnl0ZXMgaW4gYSA2NC1iaXQgdW5zaWduZWQgbG9u
ZyBsb25nLiAqLwordW5pb24gYnl0ZXN3YXBfNjRfdSB7CisgICAgdW5zaWduZWQgbG9uZyBsb25n
IGE7CisgICAgdWludDMyX3QgYlsyXTsKK307CisKKy8qIEZ1bmN0aW9uIHRvIGJ5dGVzd2FwIDY0
Yml0IHVuc2lnbmVkIGludGVnZXJzIG9uCisgKiBsaXR0bGUgZW5kaWFuIG1hY2hpbmVzIHRvIGJp
ZyBlbmRpYW4gbmV0d29yayBvcmRlci4gCisgKiBPbiBiaWcgZW5kaWFuIG1hY2hpbmVzIHRoaXMg
d2lsbCBiZSBhIG51bGwgbWFjcm8uCisgKiBUaGUgbWFjcm8gaHRvbmxsKCkgaXMgZGVmaW5lZCBp
biBieXRlb3JkZXI2NC5oLAorICogYW5kIGlmIG5lZWRlZCByZWZlcnMgdG8gX2h0b25sbCgpIGhl
cmUuCisgKi8KK3Vuc2lnbmVkIGxvbmcgbG9uZyBfaHRvbmxsKHVuc2lnbmVkIGxvbmcgbG9uZyB4
KQoreworICAgIHVuaW9uIGJ5dGVzd2FwXzY0X3UgdTE7CisgICAgdW5pb24gYnl0ZXN3YXBfNjRf
dSB1MjsKKworICAgIHUxLmEgPSB4OworCisgICAgdTIuYlswXSA9IGh0b25sKHUxLmJbMV0pOwor
ICAgIHUyLmJbMV0gPSBodG9ubCh1MS5iWzBdKTsKKworICAgIHJldHVybiB1Mi5hOworfQorCisK
Ky8qIEZ1bmN0aW9uIHRvIGJ5dGVzd2FwIGJpZyBlbmRpYW4gNjRiaXQgdW5zaWduZWQgaW50ZWdl
cnMKKyAqIGJhY2sgdG8gbGl0dGxlIGVuZGlhbiBob3N0IG9yZGVyIG9uIGxpdHRsZSBlbmRpYW4g
bWFjaGluZXMuIAorICogQXMgYWJvdmUsIG9uIGJpZyBlbmRpYW4gbWFjaGluZXMgdGhpcyB3aWxs
IGJlIGEgbnVsbCBtYWNyby4KKyAqIFRoZSBtYWNybyBudG9obGwoKSBpcyBkZWZpbmVkIGluIGJ5
dGVvcmRlcjY0LmgsIGFuZCBpZiBuZWVkZWQsCisgKiByZWZlcnMgdG8gX250b2hsbCgpIGhlcmUu
CisgKi8KK3Vuc2lnbmVkIGxvbmcgbG9uZyBfbnRvaGxsKHVuc2lnbmVkIGxvbmcgbG9uZyB4KQor
eworICAgIHVuaW9uIGJ5dGVzd2FwXzY0X3UgdTE7CisgICAgdW5pb24gYnl0ZXN3YXBfNjRfdSB1
MjsKKworICAgIHUxLmEgPSB4OworCisgICAgdTIuYlsxXSA9IG50b2hsKHUxLmJbMF0pOworICAg
IHUyLmJbMF0gPSBudG9obCh1MS5iWzFdKTsKKworICAgIHJldHVybiB1Mi5hOworfQorCisjZW5k
aWYgLyogZGVmaW5lZChIQVZFX0xPTkdfTE9OR19JTlQpICYmICFkZWZpbmVkKFdPUkRTX0JJR0VO
RElBTikgKi8KLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9saWIvYnl0ZW9yZGVyNjQuaC42NGJpdC1x
dW90YXMJMjAwNi0wOC0yMiAxMjowMjowNi4wMDAwMDAwMDAgLTA0MDAKKysrIGN5cnVzLWltYXBk
LTIuMi4xMi9saWIvYnl0ZW9yZGVyNjQuaAkyMDA2LTA4LTIyIDEyOjAyOjA2LjAwMDAwMDAwMCAt
MDQwMApAQCAtMCwwICsxLDY1IEBACisvKiBieXRlb3JkZXI2NC5oIC0tIGNvbnZlcnQgNjQtYml0
IHZhbHVlcyBiZXR3ZWVuIGhvc3QgYW5kIG5ldHdvcmsgYnl0ZSBvcmRlcgorICoKKyAqIENvcHly
aWdodCAoYykgMjAwNCBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eS4gIEFsbCByaWdodHMgcmVz
ZXJ2ZWQuCisgKgorICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJpbmFy
eSBmb3Jtcywgd2l0aCBvciB3aXRob3V0CisgKiBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQg
cHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKKyAqIGFyZSBtZXQ6CisgKgor
ICogMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92
ZSBjb3B5cmlnaHQKKyAqICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRo
ZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4gCisgKgorICogMi4gUmVkaXN0cmlidXRpb25zIGluIGJp
bmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQKKyAqICAgIG5vdGlj
ZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBp
bgorICogICAgdGhlIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRl
ZCB3aXRoIHRoZQorICogICAgZGlzdHJpYnV0aW9uLgorICoKKyAqIDMuIFRoZSBuYW1lICJDYXJu
ZWdpZSBNZWxsb24gVW5pdmVyc2l0eSIgbXVzdCBub3QgYmUgdXNlZCB0bworICogICAgZW5kb3Jz
ZSBvciBwcm9tb3RlIHByb2R1Y3RzIGRlcml2ZWQgZnJvbSB0aGlzIHNvZnR3YXJlIHdpdGhvdXQK
KyAqICAgIHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi4gRm9yIHBlcm1pc3Npb24gb3IgYW55IG90
aGVyIGxlZ2FsCisgKiAgICBkZXRhaWxzLCBwbGVhc2UgY29udGFjdCAgCisgKiAgICAgIE9mZmlj
ZSBvZiBUZWNobm9sb2d5IFRyYW5zZmVyCisgKiAgICAgIENhcm5lZ2llIE1lbGxvbiBVbml2ZXJz
aXR5CisgKiAgICAgIDUwMDAgRm9yYmVzIEF2ZW51ZQorICogICAgICBQaXR0c2J1cmdoLCBQQSAg
MTUyMTMtMzg5MAorICogICAgICAoNDEyKSAyNjgtNDM4NywgZmF4OiAoNDEyKSAyNjgtNzM5NQor
ICogICAgICB0ZWNoLXRyYW5zZmVyQGFuZHJldy5jbXUuZWR1CisgKgorICogNC4gUmVkaXN0cmli
dXRpb25zIG9mIGFueSBmb3JtIHdoYXRzb2V2ZXIgbXVzdCByZXRhaW4gdGhlIGZvbGxvd2luZwor
ICogICAgYWNrbm93bGVkZ21lbnQ6CisgKiAgICAiVGhpcyBwcm9kdWN0IGluY2x1ZGVzIHNvZnR3
YXJlIGRldmVsb3BlZCBieSBDb21wdXRpbmcgU2VydmljZXMKKyAqICAgICBhdCBDYXJuZWdpZSBN
ZWxsb24gVW5pdmVyc2l0eSAoaHR0cDovL3d3dy5jbXUuZWR1L2NvbXB1dGluZy8pLiIKKyAqCisg
KiBDQVJORUdJRSBNRUxMT04gVU5JVkVSU0lUWSBESVNDTEFJTVMgQUxMIFdBUlJBTlRJRVMgV0lU
SCBSRUdBUkQgVE8KKyAqIFRISVMgU09GVFdBUkUsIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJS
QU5USUVTIE9GIE1FUkNIQU5UQUJJTElUWQorICogQU5EIEZJVE5FU1MsIElOIE5PIEVWRU5UIFNI
QUxMIENBUk5FR0lFIE1FTExPTiBVTklWRVJTSVRZIEJFIExJQUJMRQorICogRk9SIEFOWSBTUEVD
SUFMLCBJTkRJUkVDVCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgT1IgQU5ZIERBTUFHRVMKKyAq
IFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZST00gTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywg
V0hFVEhFUiBJTgorICogQU4gQUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SIE9USEVS
IFRPUlRJT1VTIEFDVElPTiwgQVJJU0lORworICogT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lU
SCBUSEUgVVNFIE9SIFBFUkZPUk1BTkNFIE9GIFRISVMgU09GVFdBUkUuCisgKgorICogJElkOiBi
eXRlb3JkZXI2NC5oLHYgMS4xLjIuMiAyMDA0LzA4LzE2IDExOjQ0OjM0IGtlbjMgRXhwICQKKyAq
LworCisjaWZuZGVmIF9CWVRFT1JERVI2NF9ICisjZGVmaW5lIF9CWVRFT1JERVI2NF9ICisKKyNp
bmNsdWRlIDxjb25maWcuaD4KKworI2lmZGVmIEhBVkVfTE9OR19MT05HX0lOVAorCisvKiA2NC1i
aXQgaG9zdC9uZXR3b3JrIGJ5dGUtb3JkZXIgc3dhcCBtYWNyb3MgKi8KKyNpZmRlZiBXT1JEU19C
SUdFTkRJQU4KKyNkZWZpbmUgaHRvbmxsKHgpICh4KQorI2RlZmluZSBudG9obGwoeCkgKHgpCisj
ZWxzZQorI2RlZmluZSBodG9ubGwoeCkgX2h0b25sbCh4KQorI2RlZmluZSBudG9obGwoeCkgX250
b2hsbCh4KQorCisvKiBsaXR0bGUtZW5kaWFuIDY0LWJpdCBob3N0L25ldHdvcmsgYnl0ZS1vcmRl
ciBzd2FwIGZ1bmN0aW9ucyAqLworZXh0ZXJuIHVuc2lnbmVkIGxvbmcgbG9uZyBfaHRvbmxsKHVu
c2lnbmVkIGxvbmcgbG9uZyk7CitleHRlcm4gdW5zaWduZWQgbG9uZyBsb25nIF9udG9obGwodW5z
aWduZWQgbG9uZyBsb25nKTsKKworI2VuZGlmIC8qIFdPUkRTX0JJR0VORElBTiAqLworI2VuZGlm
IC8qIEhBVkVfTE9OR19MT05HX0lOVCAqLworI2VuZGlmIC8qIF9CWVRFT1JERVI2NF9IICovCi0t
LSBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL01ha2VmaWxlLmluLjY0Yml0LXF1b3RhcwkyMDA0LTA1
LTI4IDE0OjAzOjA0LjAwMDAwMDAwMCAtMDQwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9N
YWtlZmlsZS5pbgkyMDA2LTA4LTIyIDEyOjAyOjA2LjAwMDAwMDAwMCAtMDQwMApAQCAtODUsNyAr
ODUsNyBAQAogCSQoc3JjZGlyKS9sc29ydC5oICQoc3JjZGlyKS9zdHJpc3RyLmggXAogCSQoc3Jj
ZGlyKS91dGlsLmggJChzcmNkaXIpL3htYWxsb2MuaCAkKHNyY2RpcikvaW1hcHVybC5oIFwKIAkk
KHNyY2RpcikvY3lydXNkYi5oICQoc3JjZGlyKS9pcHRvc3RyaW5nLmggJChzcmNkaXIpL3JmYzgy
MmRhdGUuaCBcCi0JJChzcmNkaXIpL2xpYmN5cl9jZmcuaAorCSQoc3JjZGlyKS9saWJjeXJfY2Zn
LmggJChzcmNkaXIpL2J5dGVvcmRlcjY0LmgKIAogTElCQ1lSX09CSlMgPSBhY2wubyBic2VhcmNo
Lm8gY2hhcnNldC5vIGdsb2IubyByZXRyeS5vIHV0aWwubyBcCiAJbGliY3lyX2NmZy5vIG1rZ210
aW1lLm8gcHJvdC5vIHBhcnNlYWRkci5vIGltY2xpZW50Lm8gaW1wYXJzZS5vIFwKQEAgLTkzLDcg
KzkzLDcgQEAKIAljaGFydGFibGUubyBpbWFwdXJsLm8gbm9uYmxvY2tfQFdJVEhfTk9OQkxPQ0tA
Lm8gbG9ja19AV0lUSF9MT0NLQC5vIFwKIAlnbXRvZmZfQFdJVEhfR01UT0ZGQC5vIG1hcF9AV0lU
SF9NQVBALm8gJChBQ0wpICQoQVVUSCkgXAogCUBMSUJPQkpTQCBAQ1lSVVNEQl9PQkpTQCBcCi0J
aXB0b3N0cmluZy5vIHhtYWxsb2MubyB3aWxkbWF0Lm8KKwlpcHRvc3RyaW5nLm8geG1hbGxvYy5v
IHdpbGRtYXQubyBieXRlb3JkZXI2NC5vCiAKIExJQkNZUk1fSERSUyA9ICQoc3JjZGlyKS9oYXNo
LmggJChzcmNkaXIpL21wb29sLmggJChzcmNkaXIpL3htYWxsb2MuaCBcCiAJJChzcmNkaXIpL3N0
cmhhc2gubyAkKHNyY2RpcikvbGliY29uZmlnLmggJChzcmNkaXIpL2Fzc2VydC5oIFwKLS0tIGN5
cnVzLWltYXBkLTIuMi4xMi9saWIvcHJvdC5jLjY0Yml0LXF1b3RhcwkyMDA0LTAyLTI3IDE3OjA4
OjU2LjAwMDAwMDAwMCAtMDUwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9wcm90LmMJMjAw
Ni0wOC0yMiAxMjowMjowNi4wMDAwMDAwMDAgLTA0MDAKQEAgLTg3MSw2ICs4NzEsMTEgQEAKICAg
ICBjaGFyIGJ1ZlszMF07CiAgICAgdmFfc3RhcnQocHZhciwgZm10KTsKIAorI2lmZGVmIEhBVkVf
TE9OR19MT05HX0lOVAorICAgIGxvbmcgbG9uZyBpbnQgbGw7CisgICAgdW5zaWduZWQgbG9uZyBs
b25nIGludCB1bGw7CisjZW5kaWYKKwogICAgIGFzc2VydChzLT53cml0ZSk7CiAKICAgICB3aGls
ZSAoKHBlcmNlbnQgPSBzdHJjaHIoZm10LCAnJScpKSAhPSAwKSB7CkBAIC04OTQsNiArODk5LDI3
IEBACiAJCXByb3Rfd3JpdGUocywgYnVmLCBzdHJsZW4oYnVmKSk7CiAJCWJyZWFrOwogCisjaWZk
ZWYgSEFWRV9MT05HX0xPTkdfSU5UCisgICAgICAgICAgICBjYXNlICdsJzoKKwkgICAgICAgIHN3
aXRjaCAoKisrcGVyY2VudCkgeworCQljYXNlICdkJzoKKwkJICAgIGxsID0gdmFfYXJnKHB2YXIs
IGxvbmcgbG9uZyBpbnQpOworCQkgICAgc25wcmludGYoYnVmLCBzaXplb2YoYnVmKSwgIiVsbGQi
LCBsbCk7CisJCSAgICBwcm90X3dyaXRlKHMsIGJ1Ziwgc3RybGVuKGJ1ZikpOworCQkgICAgYnJl
YWs7CisKKwkJY2FzZSAndSc6CisJCSAgICB1bGwgPSB2YV9hcmcocHZhciwgdW5zaWduZWQgbG9u
ZyBsb25nIGludCk7CisJCSAgICBzbnByaW50ZihidWYsIHNpemVvZihidWYpLCAiJWxsdSIsIHVs
bCk7CisJCSAgICBwcm90X3dyaXRlKHMsIGJ1Ziwgc3RybGVuKGJ1ZikpOworCQkgICAgYnJlYWs7
CisKKwkgICAgICAgIGRlZmF1bHQ6CisJCSAgICBhYm9ydCgpOworCQl9CisJCWJyZWFrOworI2Vu
ZGlmCisKIAkgICAgZGVmYXVsdDoKIAkJYWJvcnQoKTsKIAkgICAgfQotLS0gY3lydXMtaW1hcGQt
Mi4yLjEyL2NvbmZpZ3VyZS5pbi42NGJpdC1xdW90YXMJMjAwNS0wMS0xOCAxODo0NjowMC4wMDAw
MDAwMDAgLTA1MDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9jb25maWd1cmUuaW4JMjAwNi0wOC0y
MiAxMjowMjowNi4wMDAwMDAwMDAgLTA0MDAKQEAgLTEwMCw2ICsxMDAsMTUgQEAKIGZpCiBBQ19D
X0lOTElORQogCitkbmwgQ2hlY2sgaWYgYGxvbmcgbG9uZyBpbnQnIGlzIGF2YWlsYWJsZQorQUNf
Q0hFQ0tfU0laRU9GKGxvbmcgbG9uZyBpbnQpCitBQ19DSEVDS19TSVpFT0YodW5zaWduZWQgbG9u
ZyBsb25nIGludCkKK2lmIHRlc3QgIiRhY19jdl9zaXplb2ZfbG9uZ19sb25nX2ludCIgLWVxIDgg
LWEgXAorICAgICAgICAiJGFjX2N2X3NpemVvZl91bnNpZ25lZF9sb25nX2xvbmdfaW50IiAtZXEg
ODsgdGhlbgorICBBQ19ERUZJTkUoSEFWRV9MT05HX0xPTkdfSU5ULFtdLFtEb2VzIHRoZSBjb21w
aWxlciBzdXBwb3J0IGxvbmcgbG9uZyBpbnQ/XSkKKyAgQUNfQ19CSUdFTkRJQU4KK2ZpCisKIENN
VV9DX19fQVRUUklCVVRFX18KIENNVV9DX0ZQSUMKIAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2lt
YXAvcmVjb25zdHJ1Y3QuYy42NGJpdC1xdW90YXMJMjAwNC0xMC0xMSAxMDowMToyNC4wMDAwMDAw
MDAgLTA0MDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL3JlY29uc3RydWN0LmMJMjAwNi0w
OC0yMiAxMjowMjowNi4wMDAwMDAwMDAgLTA0MDAKQEAgLTkzLDYgKzkzLDcgQEAKICNpbmNsdWRl
ICJyZXRyeS5oIgogI2luY2x1ZGUgImNvbnZlcnRfY29kZS5oIgogI2luY2x1ZGUgInV0aWwuaCIK
KyNpbmNsdWRlICJieXRlb3JkZXI2NC5oIgogCiBleHRlcm4gaW50IG9wdGluZDsKIGV4dGVybiBj
aGFyICpvcHRhcmc7CkBAIC00MzQsNyArNDM1LDcgQEAKICAgICBjaGFyICpsaXN0X2FjbCwgKmxp
c3RfcGFydDsKICAgICBpbnQgbGlzdF90eXBlOwogCi0gICAgdW5zaWduZWQgbG9uZyBuZXdfcXVv
dGEgPSAwOworICAgIHVxdW90YV90IG5ld19xdW90YSA9IDA7CiAKICAgICBzdHJ1Y3QgaW5kZXhf
cmVjb3JkIG1lc3NhZ2VfaW5kZXgsIG9sZF9pbmRleDsKICAgICBzdGF0aWMgc3RydWN0IGluZGV4
X3JlY29yZCB6ZXJvX2luZGV4OwpAQCAtNjkwLDcgKzY5MSwxNCBAQAogICAgICooKGJpdDMyICop
KGJ1ZitPRkZTRVRfRVhJU1RTKSkgPSBodG9ubChuZXdfZXhpc3RzKTsKICAgICAqKChiaXQzMiAq
KShidWYrT0ZGU0VUX0xBU1RfQVBQRU5EREFURSkpID0gaHRvbmwobWFpbGJveC5sYXN0X2FwcGVu
ZGRhdGUpOwogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfTEFTVF9VSUQpKSA9IGh0b25sKG1h
aWxib3gubGFzdF91aWQpOwotICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJP
WF9VU0VEKSkgPSBodG9ubChuZXdfcXVvdGEpOworCisgICAgLyogcXVvdGFzIG1heSBiZSA2NGJp
dCBub3cgKi8KKyNpZmRlZiBIQVZFX0xPTkdfTE9OR19JTlQKKyAgICAqKChiaXQ2NCAqKShidWYr
T0ZGU0VUX1FVT1RBX01BSUxCT1hfVVNFRDY0KSkgPSBodG9ubGwobmV3X3F1b3RhKTsKKyNlbHNl
CisgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9YX1VTRUQzMikpID0gaHRv
bmwobmV3X3F1b3RhKTsKKyNlbmRpZgorCiAgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9QT1Az
X0xBU1RfTE9HSU4pKSA9IGh0b25sKG1haWxib3gucG9wM19sYXN0X2xvZ2luKTsKICAgICAqKChi
aXQzMiAqKShidWYrT0ZGU0VUX1VJRFZBTElESVRZKSkgPSBodG9ubChtYWlsYm94LnVpZHZhbGlk
aXR5KTsKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX0RFTEVURUQpKSA9IGh0b25sKG5ld19k
ZWxldGVkKTsKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2FwcGVuZC5jLjY0Yml0LXF1b3Rh
cwkyMDA0LTA1LTIxIDIzOjQ1OjQ4LjAwMDAwMDAwMCAtMDQwMAorKysgY3lydXMtaW1hcGQtMi4y
LjEyL2ltYXAvYXBwZW5kLmMJMjAwNi0wOC0yMiAxMjowMjowNi4wMDAwMDAwMDAgLTA0MDAKQEAg
LTE0MCw3ICsxNDAsNyBAQAogICAgIGlmICghcikgewogCWlmIChtLnF1b3RhLmxpbWl0ID49IDAg
JiYgcXVvdGFjaGVjayA+PSAwICYmCiAJICAgIG0ucXVvdGEudXNlZCArIHF1b3RhY2hlY2sgPiAK
LQkgICAgKCh1bnNpZ25lZCkgbS5xdW90YS5saW1pdCAqIFFVT1RBX1VOSVRTKSkgeworCSAgICAo
KHVxdW90YV90KSBtLnF1b3RhLmxpbWl0ICogUVVPVEFfVU5JVFMpKSB7CiAJICAgIHIgPSBJTUFQ
X1FVT1RBX0VYQ0VFREVEOwogCX0KICAgICB9CkBAIC0yMDgsNyArMjA4LDcgQEAKICAgICBpZiAo
IXIpIHsKIAlpZiAoYXMtPm0ucXVvdGEubGltaXQgPj0gMCAmJiBxdW90YWNoZWNrID49IDAgJiYK
IAkgICAgYXMtPm0ucXVvdGEudXNlZCArIHF1b3RhY2hlY2sgPiAKLQkgICAgKCh1bnNpZ25lZCkg
YXMtPm0ucXVvdGEubGltaXQgKiBRVU9UQV9VTklUUykpIHsKKwkgICAgKCh1cXVvdGFfdCkgYXMt
Pm0ucXVvdGEubGltaXQgKiBRVU9UQV9VTklUUykpIHsKIAkgICAgcXVvdGFfYWJvcnQoJmFzLT50
aWQpOwogCSAgICBtYWlsYm94X2Nsb3NlKCZhcy0+bSk7CiAJICAgIHIgPSBJTUFQX1FVT1RBX0VY
Q0VFREVEOwotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJleGFtaW5lLmMuNjRiaXQtcXVv
dGFzCTIwMDQtMTItMTcgMTE6MzI6MTYuMDAwMDAwMDAwIC0wNTAwCisrKyBjeXJ1cy1pbWFwZC0y
LjIuMTIvaW1hcC9tYmV4YW1pbmUuYwkyMDA2LTA4LTIyIDEyOjAyOjA2LjAwMDAwMDAwMCAtMDQw
MApAQCAtMjY2LDcgKzI2Niw3IEBACiAgICAgcHJpbnRmKCIgIE1pbm9yIFZlcnNpb246ICVkXG4i
LCBtYWlsYm94Lm1pbm9yX3ZlcnNpb24pOwogICAgIHByaW50ZigiICBIZWFkZXIgU2l6ZTogJWxk
IGJ5dGVzICBSZWNvcmQgU2l6ZTogJWxkIGJ5dGVzXG4iLAogCSAgIG1haWxib3guc3RhcnRfb2Zm
c2V0LCBtYWlsYm94LnJlY29yZF9zaXplKTsKLSAgICBwcmludGYoIiAgTnVtYmVyIG9mIE1lc3Nh
Z2VzOiAlbHUgIE1haWxib3ggU2l6ZTogJWx1IGJ5dGVzXG4iLAorICAgIHByaW50ZigiICBOdW1i
ZXIgb2YgTWVzc2FnZXM6ICVsdSAgTWFpbGJveCBTaXplOiAiIFVRVU9UQV9UX0ZNVCAiIGJ5dGVz
XG4iLAogCSAgIG1haWxib3guZXhpc3RzLCBtYWlsYm94LnF1b3RhX21haWxib3hfdXNlZCk7CiAg
ICAgcHJpbnRmKCIgIExhc3QgQXBwZW5kIERhdGU6ICglbGQpICVzIiwgbWFpbGJveC5sYXN0X2Fw
cGVuZGRhdGUsCiAJICAgY3RpbWUoJm1haWxib3gubGFzdF9hcHBlbmRkYXRlKSk7Ci0tLSBjeXJ1
cy1pbWFwZC0yLjIuMTIvaW1hcC9xdW90YS5oLjY0Yml0LXF1b3RhcwkyMDA0LTAyLTI3IDEyOjQ0
OjU2LjAwMDAwMDAwMCAtMDUwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvcXVvdGEuaAky
MDA2LTA4LTIyIDEyOjAyOjA2LjAwMDAwMDAwMCAtMDQwMApAQCAtNDUsMTggKzQ1LDM3IEBACiAj
ZGVmaW5lIElOQ0xVREVEX1FVT1RBX0gKIAogI2luY2x1ZGUgImN5cnVzZGIuaCIKKyNpbmNsdWRl
IDxjb25maWcuaD4KIAogI2RlZmluZSBGTkFNRV9RVU9UQURCICIvcXVvdGFzLmRiIgogCiAjZGVm
aW5lIFFVT1RBX1VOSVRTICgxMDI0KQogCisvKiBEZWZpbmUgdGhlIHByb3BlciBxdW90YSB0eXBl
LCBpdCBzaG91bGQgZWl0aGVyIGJlIGEKKyAqIGxvbmcgb3IgYSBsb25nIGxvbmcgaW50IGRlcGVu
ZGluZyB1cG9uIHdoYXQgdGhlCisgKiB0aGUgY29tcGlsZXIgc3VwcG9ydHMuCisgKi8KKyNpZmRl
ZiBIQVZFX0xPTkdfTE9OR19JTlQKK3R5cGVkZWYgdW5zaWduZWQgbG9uZyBsb25nIGludCB1cXVv
dGFfdDsKK3R5cGVkZWYgbG9uZyBsb25nIGludCBxdW90YV90OworI2RlZmluZSBVUVVPVEFfVF9G
TVQgICAgICIlbGx1IgorI2RlZmluZSBRVU9UQV9UX0ZNVCAgICAgICIlbGxkIgorI2RlZmluZSBR
VU9UQV9SRVBPUlRfRk1UICIlOGxsdSIKKyNlbHNlCit0eXBlZGVmIHVuc2lnbmVkIGxvbmcgdXF1
b3RhX3Q7Cit0eXBlZGVmIGxvbmcgcXVvdGFfdDsKKyNkZWZpbmUgVVFVT1RBX1RfRk1UICAgICAi
JWx1IgorI2RlZmluZSBRVU9UQV9UX0ZNVCAgICAgICIlbGQiCisjZGVmaW5lIFFVT1RBX1JFUE9S
VF9GTVQgIiU4bHUiCisjZW5kaWYKKwogZXh0ZXJuIHN0cnVjdCBkYiAqcWRiOwogCiBzdHJ1Y3Qg
cXVvdGEgewogICAgIGNoYXIgKnJvb3Q7CiAKICAgICAvKiBJbmZvcm1hdGlvbiBpbiBxdW90YSBl
bnRyeSAqLwotICAgIHVuc2lnbmVkIGxvbmcgdXNlZDsKKyAgICB1cXVvdGFfdCB1c2VkOwogICAg
IGludCBsaW1pdDsJCQkvKiBpbiBRVU9UQV9VTklUUyAqLwogfTsKIAotLS0gY3lydXMtaW1hcGQt
Mi4yLjEyL2ltYXAvbWFpbGJveC5jLjY0Yml0LXF1b3RhcwkyMDA1LTAyLTE0IDAxOjM5OjU3LjAw
MDAwMDAwMCAtMDUwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWFpbGJveC5jCTIwMDYt
MDgtMjIgMTI6MDM6NTguMDAwMDAwMDAwIC0wNDAwCkBAIC04NCw2ICs4NCw3IEBACiAjaW5jbHVk
ZSAic2Vlbi5oIgogI2luY2x1ZGUgInV0aWwuaCIKICNpbmNsdWRlICJ4bWFsbG9jLmgiCisjaW5j
bHVkZSAiYnl0ZW9yZGVyNjQuaCIKIAogc3RhdGljIGludCBtYWlsYm94X2RvaW5nX3JlY29uc3Ry
dWN0ID0gMDsKICNkZWZpbmUgemVyb21haWxib3gobSkgeyBtZW1zZXQoJm0sIDAsIHNpemVvZihz
dHJ1Y3QgbWFpbGJveCkpOyBcCkBAIC03ODgsOCArNzg5LDE2IEBACiAgICAgbWFpbGJveC0+bGFz
dF91aWQgPQogCW50b2hsKCooKGJpdDMyICopKG1haWxib3gtPmluZGV4X2Jhc2UrT0ZGU0VUX0xB
U1RfVUlEKSkpOwogCisjaWZkZWYgSEFWRV9MT05HX0xPTkdfSU5UCisgICAgaWYgKG1haWxib3gt
Pm1pbm9yX3ZlcnNpb24gPiA1KSB7CisJLyogbmV3ZXIgdmVyc2lvbnMgbWF5IHVzZSA2NGJpdCBx
dW90YXMgbm93ICovCisgICAgICAgIG1haWxib3gtPnF1b3RhX21haWxib3hfdXNlZCA9CisgICAg
ICAgICAgICBudG9obGwoKigoYml0NjQgKikobWFpbGJveC0+aW5kZXhfYmFzZStPRkZTRVRfUVVP
VEFfTUFJTEJPWF9VU0VENjQpKSk7CisgICAgfSBlbHNlCisjZWxzZQogICAgIG1haWxib3gtPnF1
b3RhX21haWxib3hfdXNlZCA9CiAJbnRvaGwoKigoYml0MzIgKikobWFpbGJveC0+aW5kZXhfYmFz
ZStPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VELXF1b3RhX3VwZ3JhZGVfb2Zmc2V0KSkpOworI2Vu
ZGlmCiAKICAgICBpZiAobWFpbGJveC0+c3RhcnRfb2Zmc2V0IDwgT0ZGU0VUX1BPUDNfTEFTVF9M
T0dJTi1xdW90YV91cGdyYWRlX29mZnNldCtzaXplb2YoYml0MzIpKSB7CiAJbWFpbGJveC0+cG9w
M19sYXN0X2xvZ2luID0gMDsKQEAgLTExODMsOSArMTE5MiwxOCBAQAogICAgICooKGJpdDMyICop
KGJ1ZitPRkZTRVRfRVhJU1RTKSkgPSBodG9ubChtYWlsYm94LT5leGlzdHMpOwogICAgICooKGJp
dDMyICopKGJ1ZitPRkZTRVRfTEFTVF9BUFBFTkREQVRFKSkgPSBodG9ubChtYWlsYm94LT5sYXN0
X2FwcGVuZGRhdGUpOwogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfTEFTVF9VSUQpKSA9IGh0
b25sKG1haWxib3gtPmxhc3RfdWlkKTsKLSAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1FVT1RB
X1JFU0VSVkVEX0ZJRUxEKSkgPSBodG9ubCgwKTsgLyogUkVTRVJWRUQgKi8KKworICAgIC8qIHF1
b3RhcyBtYXkgYmUgNjRiaXQgbm93ICovCisjaWZkZWYgSEFWRV9MT05HX0xPTkdfSU5UCisgICAg
KigoYml0NjQgKikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9YX1VTRUQ2NCkpID0KKwlodG9ubGwo
bWFpbGJveC0+cXVvdGFfbWFpbGJveF91c2VkKTsKKyNlbHNlCQorICAgIC8qIHplcm8gdGhlIHVu
dXNlZCAzMmJpdHMgKi8KKyAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1FVT1RBX01BSUxCT1hf
VVNFRDY0KSkgPSBodG9ubCgwKQogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJ
TEJPWF9VU0VEKSkgPQogCWh0b25sKG1haWxib3gtPnF1b3RhX21haWxib3hfdXNlZCk7CisjZW5k
aWYKKwogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRfUE9QM19MQVNUX0xPR0lOKSkgPSBodG9u
bChtYWlsYm94LT5wb3AzX2xhc3RfbG9naW4pOwogICAgICooKGJpdDMyICopKGJ1ZitPRkZTRVRf
VUlEVkFMSURJVFkpKSA9IGh0b25sKG1haWxib3gtPnVpZHZhbGlkaXR5KTsKICAgICAqKChiaXQz
MiAqKShidWYrT0ZGU0VUX0RFTEVURUQpKSA9IGh0b25sKG1haWxib3gtPmRlbGV0ZWQpOwpAQCAt
MTQzMCw5ICsxNDQ4LDE4IEBACiAgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9FWElTVFMpKSA9
IGh0b25sKG1haWxib3gtPmV4aXN0cyk7CiAgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9MQVNU
X0FQUEVORERBVEUpKSA9IGh0b25sKG1haWxib3gtPmxhc3RfYXBwZW5kZGF0ZSk7CiAgICAgKigo
Yml0MzIgKikoYnVmK09GRlNFVF9MQVNUX1VJRCkpID0gaHRvbmwobWFpbGJveC0+bGFzdF91aWQp
OwotICAgIC8qIE9GRlNFVF9RVU9UQV9SRVNFUlZFRF9GSUVMRCBsZWZ0IGFzIHplcm8gKi8KKwor
ICAgIC8qIG5ld2VyIHZlcnNpb25zIG1heSB1c2UgNjRiaXQgcXVvdGFzICovCisjaWZkZWYgSEFW
RV9MT05HX0xPTkdfSU5UCisgICAgKigoYml0NjQgKikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9Y
X1VTRUQ2NCkpID0KKwlodG9ubGwobWFpbGJveC0+cXVvdGFfbWFpbGJveF91c2VkKTsKKyNlbHNl
CQorICAgIC8qIHplcm8gdGhlIHVudXNlZCAzMmJpdHMgKi8KKyAgICAqKChiaXQzMiAqKShidWYr
T0ZGU0VUX1FVT1RBX01BSUxCT1hfVVNFRDY0KSkgPSBodG9ubCgwKTsKICAgICAqKChiaXQzMiAq
KShidWYrT0ZGU0VUX1FVT1RBX01BSUxCT1hfVVNFRCkpID0KIAlodG9ubChtYWlsYm94LT5xdW90
YV9tYWlsYm94X3VzZWQpOworI2VuZGlmCisKICAgICAqKChiaXQzMiAqKShidWYrT0ZGU0VUX1BP
UDNfTEFTVF9MT0dJTikpID0gaHRvbmwobWFpbGJveC0+cG9wM19sYXN0X2xvZ2luKTsKICAgICAq
KChiaXQzMiAqKShidWYrT0ZGU0VUX1VJRFZBTElESVRZKSkgPSBodG9ubChtYWlsYm94LT51aWR2
YWxpZGl0eSk7CiAgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9ERUxFVEVEKSkgPSBodG9ubCht
YWlsYm94LT5kZWxldGVkKTsKQEAgLTE2MDgsNyArMTYzNSw4IEBACiAgICAgc2l6ZV90IGZuYW1l
YnVmX2xlbjsKICAgICBGSUxFICpuZXdpbmRleCA9IE5VTEwsICpuZXdjYWNoZSA9IE5VTEw7CiAg
ICAgdW5zaWduZWQgbG9uZyAqZGVsZXRlZDsKLSAgICB1bnNpZ25lZCBudW1kZWxldGVkID0gMCwg
cXVvdGFkZWxldGVkID0gMDsKKyAgICB1bnNpZ25lZCBudW1kZWxldGVkID0gMDsKKyAgICB1cXVv
dGFfdCBxdW90YWRlbGV0ZWQgPSAwOwogICAgIHVuc2lnbmVkIG51bWFuc3dlcmVkZmxhZyA9IDA7
CiAgICAgdW5zaWduZWQgbnVtZGVsZXRlZGZsYWcgPSAwOwogICAgIHVuc2lnbmVkIG51bWZsYWdn
ZWRmbGFnID0gMDsKQEAgLTE4MjksOCArMTg1NywxMyBAQAogICAgICooKGJpdDMyICopKGJ1ZitP
RkZTRVRfRkxBR0dFRCkpID0gaHRvbmwobmV3ZmxhZ2dlZCk7CiAKICAgICAvKiBGaXggdXAgcXVv
dGFfbWFpbGJveF91c2VkICovCisjaWZkZWYgSEFWRV9MT05HX0xPTkdfSU5UCisgICAgKigoYml0
NjQgKikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9YX1VTRUQ2NCkpID0KKwlodG9ubGwobnRvaGxs
KCooKGJpdDY0ICopKGJ1ZitPRkZTRVRfUVVPVEFfTUFJTEJPWF9VU0VENjQpKSktcXVvdGFkZWxl
dGVkKTsKKyNlbHNlCiAgICAgKigoYml0MzIgKikoYnVmK09GRlNFVF9RVU9UQV9NQUlMQk9YX1VT
RUQpKSA9CiAgICAgICBodG9ubChudG9obCgqKChiaXQzMiAqKShidWYrT0ZGU0VUX1FVT1RBX01B
SUxCT1hfVVNFRCkpKS1xdW90YWRlbGV0ZWQpOworI2VuZGlmCiAgICAgLyogRml4IHVwIHN0YXJ0
IG9mZnNldCBpZiBuZWNlc3NhcnkgKi8KICAgICBpZiAobWFpbGJveC0+c3RhcnRfb2Zmc2V0IDwg
SU5ERVhfSEVBREVSX1NJWkUpIHsKIAkqKChiaXQzMiAqKShidWYrT0ZGU0VUX1NUQVJUX09GRlNF
VCkpID0gaHRvbmwoSU5ERVhfSEVBREVSX1NJWkUpOwpAQCAtMTg2Miw3ICsxODk1LDcgQEAKIAlp
ZiAoIXIpIHF1b3RhX2NvbW1pdCgmdGlkKTsKIAllbHNlIHsKIAkgICAgc3lzbG9nKExPR19FUlIs
Ci0JCSAgICJMT1NUUVVPVEE6IHVuYWJsZSB0byByZWNvcmQgZnJlZSBvZiAldSBieXRlcyBpbiBx
dW90YSAlcyIsCisJCSAgICJMT1NUUVVPVEE6IHVuYWJsZSB0byByZWNvcmQgZnJlZSBvZiAiIFVR
VU9UQV9UX0ZNVCAiIGJ5dGVzIGluIHF1b3RhICVzIiwKIAkJICAgcXVvdGFkZWxldGVkLCBtYWls
Ym94LT5xdW90YS5yb290KTsKIAl9CiAgICAgfQpAQCAtMjEzMiw3ICsyMTY1LDcgQEAKIAlyID0g
cXVvdGFfd3JpdGUoJm1haWxib3gtPnF1b3RhLCAmdGlkKTsKIAlpZiAocikgewogCSAgICBzeXNs
b2coTE9HX0VSUiwKLQkJICAgIkxPU1RRVU9UQTogdW5hYmxlIHRvIHJlY29yZCBmcmVlIG9mICVs
dSBieXRlcyBpbiBxdW90YSAlcyIsCisJCSAgICJMT1NUUVVPVEE6IHVuYWJsZSB0byByZWNvcmQg
ZnJlZSBvZiAiIFVRVU9UQV9UX0ZNVCAiIGJ5dGVzIGluIHF1b3RhICVzIiwKIAkJICAgbWFpbGJv
eC0+cXVvdGFfbWFpbGJveF91c2VkLCBtYWlsYm94LT5xdW90YS5yb290KTsKIAl9CiAJZWxzZQpA
QCAtMjI1MCw3ICsyMjgzLDcgQEAKIAkgICAgc3RyY21wKG9sZG1haWxib3gtPnF1b3RhLnJvb3Qs
IG5ld21haWxib3gtPnF1b3RhLnJvb3QpICE9IDApIHsKIAkgICAgaWYgKCFyICYmIG5ld21haWxi
b3gtPnF1b3RhLmxpbWl0ID49IDAgJiYKIAkJbmV3bWFpbGJveC0+cXVvdGEudXNlZCArIG9sZG1h
aWxib3gtPnF1b3RhX21haWxib3hfdXNlZCA+Ci0JCSgodW5zaWduZWQpIG5ld21haWxib3gtPnF1
b3RhLmxpbWl0ICogUVVPVEFfVU5JVFMpKSB7CisJCSgodXF1b3RhX3QpIG5ld21haWxib3gtPnF1
b3RhLmxpbWl0ICogUVVPVEFfVU5JVFMpKSB7CiAJCXIgPSBJTUFQX1FVT1RBX0VYQ0VFREVEOwog
CSAgICB9CiAJfQpAQCAtMjQ2NCw3ICsyNDk3LDcgQEAKIAkgICAgc3RyY21wKG9sZG1haWxib3gu
cXVvdGEucm9vdCwgbmV3bWFpbGJveC5xdW90YS5yb290KSAhPSAwKSB7CiAJICAgIGlmICghciAm
JiBuZXdtYWlsYm94LnF1b3RhLmxpbWl0ID49IDAgJiYKIAkJbmV3bWFpbGJveC5xdW90YS51c2Vk
ICsgb2xkbWFpbGJveC5xdW90YV9tYWlsYm94X3VzZWQgPgotCQkoKHVuc2lnbmVkKSBuZXdtYWls
Ym94LnF1b3RhLmxpbWl0ICogUVVPVEFfVU5JVFMpKSB7CisJCSgodXF1b3RhX3QpIG5ld21haWxi
b3gucXVvdGEubGltaXQgKiBRVU9UQV9VTklUUykpIHsKIAkJciA9IElNQVBfUVVPVEFfRVhDRUVE
RUQ7CiAJICAgIH0KIAl9CkBAIC0yNjE3LDcgKzI2NTAsNyBAQAogCWVsc2UgaWYgKHIyID09IElN
QVBfUVVPVEFST09UX05PTkVYSVNURU5UKSByMiA9IDA7CiAJaWYgKHIyKSB7CiAJICAgIHN5c2xv
ZyhMT0dfRVJSLAotCSAgICAgICJMT1NUUVVPVEE6IHVuYWJsZSB0byByZWNvcmQgdXNlIG9mICVs
dSBieXRlcyBpbiBxdW90YSAlcyIsCisJICAgICAgIkxPU1RRVU9UQTogdW5hYmxlIHRvIHJlY29y
ZCB1c2Ugb2YgIiBVUVVPVEFfVF9GTVQgIiBieXRlcyBpbiBxdW90YSAlcyIsCiAJCSAgIG5ld21h
aWxib3gucXVvdGFfbWFpbGJveF91c2VkLCBuZXdtYWlsYm94LnF1b3RhLnJvb3QpOwogCX0KICAg
ICB9Ci0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9xdW90YS5jLjY0Yml0LXF1b3RhcwkyMDA0
LTA2LTMwIDE1OjIzOjI2LjAwMDAwMDAwMCAtMDQwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2lt
YXAvcXVvdGEuYwkyMDA2LTA4LTIyIDEyOjAyOjA2LjAwMDAwMDAwMCAtMDQwMApAQCAtMTIwLDcg
KzEyMCw3IEBACiAgICAgc3RydWN0IHF1b3RhIHF1b3RhOwogICAgIGludCByZWZjb3VudDsKICAg
ICBpbnQgZGVsZXRlZDsKLSAgICB1bnNpZ25lZCBsb25nIG5ld3VzZWQ7CisgICAgdXF1b3RhX3Qg
bmV3dXNlZDsKIH07CiAKICNkZWZpbmUgUVVPVEFHUk9XIDMwMApAQCAtMjUxLDcgKzI1MSw3IEBA
CiAgICAgfQogICAgIG1lbXNldCgmcXVvdGFbcXVvdGFfbnVtXSwgMCwgc2l6ZW9mKHN0cnVjdCBx
dW90YWVudHJ5KSk7CiAgICAgcXVvdGFbcXVvdGFfbnVtXS5xdW90YS5yb290ID0geHN0cm5kdXAo
a2V5LCBrZXlsZW4pOwotICAgIHNzY2FuZihkYXRhLCAiJWx1ICVkIiwKKyAgICBzc2NhbmYoZGF0
YSwgVVFVT1RBX1RfRk1UICIgJWQiLAogCSAgICZxdW90YVtxdW90YV9udW1dLnF1b3RhLnVzZWQs
ICZxdW90YVtxdW90YV9udW1dLnF1b3RhLmxpbWl0KTsKICAgCiAgICAgcXVvdGFfbnVtKys7CkBA
IC00MjIsNyArNDIyLDcgQEAKIAkoKmNvdW50KSsrOwogICAgIH0KICAgICBpZiAocXVvdGFbdGhp
c3F1b3RhXS5xdW90YS51c2VkICE9IHF1b3RhW3RoaXNxdW90YV0ubmV3dXNlZCkgewotCXByaW50
ZigiJXM6IHVzYWdlIHdhcyAlbHUsIG5vdyAlbHVcbiIsIHF1b3RhW3RoaXNxdW90YV0ucXVvdGEu
cm9vdCwKKwlwcmludGYoIiVzOiB1c2FnZSB3YXMgIiBVUVVPVEFfVF9GTVQgIiwgbm93ICIgVVFV
T1RBX1RfRk1UICJcbiIsIHF1b3RhW3RoaXNxdW90YV0ucXVvdGEucm9vdCwKIAkgICAgICAgcXVv
dGFbdGhpc3F1b3RhXS5xdW90YS51c2VkLCBxdW90YVt0aGlzcXVvdGFdLm5ld3VzZWQpOwogCXF1
b3RhW3RoaXNxdW90YV0ucXVvdGEudXNlZCA9IHF1b3RhW3RoaXNxdW90YV0ubmV3dXNlZDsKIAly
ID0gcXVvdGFfd3JpdGUoJnF1b3RhW3RoaXNxdW90YV0ucXVvdGEsIHRpZCk7CkBAIC00ODksMTIg
KzQ4OSwxMiBAQAogICAgIGludCBpOwogICAgIGNoYXIgYnVmW01BWF9NQUlMQk9YX1BBVEgrMV07
CiAKLSAgICBwcmludGYoIiAgIFF1b3RhICAlJSBVc2VkICAgIFVzZWQgUm9vdFxuIik7CisgICAg
cHJpbnRmKCIgICBRdW90YSAgICUlIFVzZWQgICAgIFVzZWQgUm9vdFxuIik7CiAKICAgICBmb3Ig
KGkgPSAwOyBpIDwgcXVvdGFfbnVtOyBpKyspIHsKIAlpZiAocXVvdGFbaV0uZGVsZXRlZCkgY29u
dGludWU7CiAJaWYgKHF1b3RhW2ldLnF1b3RhLmxpbWl0ID4gMCkgewotCSAgICBwcmludGYoIiAl
N2QgJTdsZCIsIHF1b3RhW2ldLnF1b3RhLmxpbWl0LAorCSAgICBwcmludGYoIiAlN2QgIiBRVU9U
QV9SRVBPUlRfRk1UICwgcXVvdGFbaV0ucXVvdGEubGltaXQsCiAJCSAgICgocXVvdGFbaV0ucXVv
dGEudXNlZCAvIFFVT1RBX1VOSVRTKSAqIDEwMCkgLyBxdW90YVtpXS5xdW90YS5saW1pdCk7CiAJ
fQogCWVsc2UgaWYgKHF1b3RhW2ldLnF1b3RhLmxpbWl0ID09IDApIHsKQEAgLTUwNyw2ICs1MDcs
NiBAQAogCSgqcXVvdGFfbmFtZXNwYWNlLm1ib3huYW1lX3RvZXh0ZXJuYWwpKCZxdW90YV9uYW1l
c3BhY2UsCiAJCQkJCSAgICAgICBxdW90YVtpXS5xdW90YS5yb290LAogCQkJCQkgICAgICAgImN5
cnVzIiwgYnVmKTsKLQlwcmludGYoIiAlN2xkICVzXG4iLCBxdW90YVtpXS5xdW90YS51c2VkIC8g
UVVPVEFfVU5JVFMsIGJ1Zik7CisJcHJpbnRmKCIgIiBRVU9UQV9SRVBPUlRfRk1UICIgJXNcbiIs
IHF1b3RhW2ldLnF1b3RhLnVzZWQgLyBRVU9UQV9VTklUUywgYnVmKTsKICAgICB9CiB9Ci0tLSBj
eXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9pbWFwZC5jLjY0Yml0LXF1b3RhcwkyMDA1LTAyLTE0IDAx
OjM5OjU1LjAwMDAwMDAwMCAtMDUwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvaW1hcGQu
YwkyMDA2LTA4LTIyIDEyOjAyOjA2LjAwMDAwMDAwMCAtMDQwMApAQCAtMjYyNiwxMCArMjYyNiwx
MCBAQAogIAkgICAgICovCiAgCSAgICBpbnQgd2FybnNpemUgPSBjb25maWdfZ2V0aW50KElNQVBP
UFRfUVVPVEFXQVJOS0IpOwogIAkgICAgaWYgKHdhcm5zaXplIDw9IDAgfHwgd2FybnNpemUgPj0g
aW1hcGRfbWFpbGJveC0+cXVvdGEubGltaXQgfHwKLSAJICAgICAgICAoaW50KSgoaW1hcGRfbWFp
bGJveC0+cXVvdGEubGltaXQgKiBRVU9UQV9VTklUUykgLQotCQkgICAgICBpbWFwZF9tYWlsYm94
LT5xdW90YS51c2VkKSA8ICh3YXJuc2l6ZSAqIFFVT1RBX1VOSVRTKSkgeworIAkgICAgICAgICgo
dXF1b3RhX3QpIChpbWFwZF9tYWlsYm94LT5xdW90YS5saW1pdCAtIHdhcm5zaXplKSkgKiBRVU9U
QV9VTklUUyA8IAorCQlpbWFwZF9tYWlsYm94LT5xdW90YS51c2VkKSB7CiAJCXVzYWdlID0gKChk
b3VibGUpIGltYXBkX21haWxib3gtPnF1b3RhLnVzZWQgKiAxMDAuMCkgLyAoZG91YmxlKQotCQkg
ICAgKGltYXBkX21haWxib3gtPnF1b3RhLmxpbWl0ICogUVVPVEFfVU5JVFMpOworCQkgICAgKCh1
cXVvdGFfdCkgaW1hcGRfbWFpbGJveC0+cXVvdGEubGltaXQgKiBRVU9UQV9VTklUUyk7CiAJCWlm
ICh1c2FnZSA+PSAxMDAuMCkgewogCQkgICAgcHJvdF9wcmludGYoaW1hcGRfb3V0LCAiKiBOTyBb
QUxFUlRdICVzXHJcbiIsCiAJCQkJZXJyb3JfbWVzc2FnZShJTUFQX05PX09WRVJRVU9UQSkpOwpA
QCAtNDYyNiw3ICs0NjI2LDcgQEAKIAlwcmludGFzdHJpbmcobmFtZSk7CiAJcHJvdF9wcmludGYo
aW1hcGRfb3V0LCAiICgiKTsKIAlpZiAocXVvdGEubGltaXQgPj0gMCkgewotCSAgICBwcm90X3By
aW50ZihpbWFwZF9vdXQsICJTVE9SQUdFICVsdSAlZCIsCisJICAgIHByb3RfcHJpbnRmKGltYXBk
X291dCwgIlNUT1JBR0UgIiBVUVVPVEFfVF9GTVQgIiAlZCIsCiAJCQlxdW90YS51c2VkL1FVT1RB
X1VOSVRTLCBxdW90YS5saW1pdCk7CiAJfQogCXByb3RfcHJpbnRmKGltYXBkX291dCwgIilcclxu
Iik7CkBAIC00Njg4LDcgKzQ2ODgsNyBAQAogCQlwcmludGFzdHJpbmcobWFpbGJveG5hbWUpOwog
CQlwcm90X3ByaW50ZihpbWFwZF9vdXQsICIgKCIpOwogCQlpZiAobWFpbGJveC5xdW90YS5saW1p
dCA+PSAwKSB7Ci0JCSAgICBwcm90X3ByaW50ZihpbWFwZF9vdXQsICJTVE9SQUdFICVsdSAlZCIs
CisJCSAgICBwcm90X3ByaW50ZihpbWFwZF9vdXQsICJTVE9SQUdFICIgVVFVT1RBX1RfRk1UICIg
JWQiLAogCQkJCW1haWxib3gucXVvdGEudXNlZC9RVU9UQV9VTklUUywKIAkJCQltYWlsYm94LnF1
b3RhLmxpbWl0KTsKIAkJfQotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvcXVvdGFfZGIuYy42
NGJpdC1xdW90YXMJMjAwNC0wNS0yMSAyMzo0NTo1Mi4wMDAwMDAwMDAgLTA0MDAKKysrIGN5cnVz
LWltYXBkLTIuMi4xMi9pbWFwL3F1b3RhX2RiLmMJMjAwNi0wOC0yMiAxMjowMjowNi4wMDAwMDAw
MDAgLTA0MDAKQEAgLTg5LDcgKzg5LDcgQEAKIAogICAgIHN3aXRjaCAocikgewogICAgIGNhc2Ug
Q1lSVVNEQl9PSzoKLQlzc2NhbmYoZGF0YSwgIiVsdSAlZCIsICZxdW90YS0+dXNlZCwgJnF1b3Rh
LT5saW1pdCk7CisJc3NjYW5mKGRhdGEsIFVRVU9UQV9UX0ZNVCAiICVkIiwgJnF1b3RhLT51c2Vk
LCAmcXVvdGEtPmxpbWl0KTsKIAlicmVhazsKIAogICAgIGNhc2UgQ1lSVVNEQl9BR0FJTjoKQEAg
LTE1MSw3ICsxNTEsNyBAQAogICAgIGlmICghcXJsZW4pIHJldHVybiBJTUFQX1FVT1RBUk9PVF9O
T05FWElTVEVOVDsKIAogICAgIGxlbiA9IHNucHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1ZikgLSAxLAot
CQkgICAiJWx1ICVkIiwgcXVvdGEtPnVzZWQsIHF1b3RhLT5saW1pdCk7CisJCSAgIFVRVU9UQV9U
X0ZNVCAiICVkIiwgcXVvdGEtPnVzZWQsIHF1b3RhLT5saW1pdCk7CiAgICAgciA9IFFEQi0+c3Rv
cmUocWRiLCBxdW90YS0+cm9vdCwgcXJsZW4sIGJ1ZiwgbGVuLCB0aWQpOwogICAgIAogICAgIHN3
aXRjaCAocikgewotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJkdW1wLmMuNjRiaXQtcXVv
dGFzCTIwMDQtMDUtMjEgMjM6NDU6NTEuMDAwMDAwMDAwIC0wNDAwCisrKyBjeXJ1cy1pbWFwZC0y
LjIuMTIvaW1hcC9tYmR1bXAuYwkyMDA2LTA4LTIyIDEyOjAyOjA2LjAwMDAwMDAwMCAtMDQwMApA
QCAtNTA3LDcgKzUwNyw3IEBACiB7CiAgICAgc3RydWN0IGJ1ZiBmaWxlLCBkYXRhOwogICAgIGNo
YXIgYzsKLSAgICBpbnQgcXVvdGF1c2VkID0gMDsKKyAgICB1cXVvdGFfdCBxdW90YXVzZWQgPSAw
OwogICAgIGludCByID0gMDsKICAgICBpbnQgY3VyZmlsZSA9IC0xOwogICAgIGNvbnN0IGNoYXIg
KnVzZXJpZCA9IE5VTEw7Ci0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9tYWlsYm94LmguNjRi
aXQtcXVvdGFzCTIwMDQtMDEtMjIgMTY6MTc6MDkuMDAwMDAwMDAwIC0wNTAwCisrKyBjeXJ1cy1p
bWFwZC0yLjIuMTIvaW1hcC9tYWlsYm94LmgJMjAwNi0wOC0yMiAxMjowMjowNi4wMDAwMDAwMDAg
LTA0MDAKQEAgLTQ1LDYgKzQ1LDcgQEAKICNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KICNpbmNsdWRl
IDxzeXMvc3RhdC5oPgogI2luY2x1ZGUgPGxpbWl0cy5oPgorI2luY2x1ZGUgPGNvbmZpZy5oPgog
CiAjaW5jbHVkZSAiYXV0aC5oIgogI2luY2x1ZGUgInF1b3RhLmgiCkBAIC02MSw2ICs2MiwxMCBA
QAogI2Vycm9yIGRvbnQga25vdyB3aGF0IHRvIHVzZSBmb3IgYml0MzIKICNlbmRpZgogCisjaWZk
ZWYgSEFWRV9MT05HX0xPTkdfSU5UCit0eXBlZGVmIHVuc2lnbmVkIGxvbmcgbG9uZyBpbnQgYml0
NjQ7CisjZW5kaWYKKwogI2RlZmluZSBNQVhfTUFJTEJPWF9OQU1FIDQ5MAogI2RlZmluZSBNQVhf
TUFJTEJPWF9QQVRIIDQwOTYKIApAQCAtMTI2LDcgKzEzMSw3IEBACiAgICAgdW5zaWduZWQgbG9u
ZyBleGlzdHM7CiAgICAgdGltZV90IGxhc3RfYXBwZW5kZGF0ZTsKICAgICB1bnNpZ25lZCBsb25n
IGxhc3RfdWlkOwotICAgIHVuc2lnbmVkIGxvbmcgcXVvdGFfbWFpbGJveF91c2VkOworICAgIHVx
dW90YV90IHF1b3RhX21haWxib3hfdXNlZDsKICAgICB1bnNpZ25lZCBsb25nIHBvcDNfbGFzdF9s
b2dpbjsKICAgICB1bnNpZ25lZCBsb25nIHVpZHZhbGlkaXR5OwogCkBAIC0xNjgsOCArMTczLDgg
QEAKICNkZWZpbmUgT0ZGU0VUX0VYSVNUUyAyMAogI2RlZmluZSBPRkZTRVRfTEFTVF9BUFBFTkRE
QVRFIDI0CiAjZGVmaW5lIE9GRlNFVF9MQVNUX1VJRCAyOAotI2RlZmluZSBPRkZTRVRfUVVPVEFf
UkVTRVJWRURfRklFTEQgMzIgIC8qIFJlc2VydmVkIGZvciA2NGJpdCBxdW90YXMgKi8KLSNkZWZp
bmUgT0ZGU0VUX1FVT1RBX01BSUxCT1hfVVNFRCAzNgorI2RlZmluZSBPRkZTRVRfUVVPVEFfTUFJ
TEJPWF9VU0VENjQgMzIgIC8qIG9mZnNldCBmb3IgNjRiaXQgcXVvdGFzICovCisjZGVmaW5lIE9G
RlNFVF9RVU9UQV9NQUlMQk9YX1VTRUQgMzYgICAgLyogb2Zmc2V0IGZvciAzMmJpdCBxdW90YXMg
Ki8KICNkZWZpbmUgT0ZGU0VUX1BPUDNfTEFTVF9MT0dJTiA0MAogI2RlZmluZSBPRkZTRVRfVUlE
VkFMSURJVFkgNDQKICNkZWZpbmUgT0ZGU0VUX0RFTEVURUQgNDggICAgICAvKiBhZGRlZCBmb3Ig
QUNBUCAqLwo=
</data>        

          </attachment>
      

    </bug>

</bugzilla>