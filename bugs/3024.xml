<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>3024</bug_id>
          
          <creation_ts>2008-01-08 16:25 EDT</creation_ts>
          <short_desc>Cyrus is not 64-bit clean</short_desc>
          <delta_ts>2010-10-25 18:46:44 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>IMAP</component>
          <version>2.3.x</version>
          <rep_platform>PC</rep_platform>
          <op_sys>Linux</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          <priority>P5</priority>
          <bug_severity>blocker</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Gabor Gombas">gombasg@sztaki.hu</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          <cc>wes@umich.edu</cc>
          

      

      

      
          <long_desc isprivate="0">
            <who name="Gabor Gombas">gombasg@sztaki.hu</who>
            <bug_when>2008-01-08 16:25:16 EDT</bug_when>
            <thetext>When sizeof(size_t) != sizeof(int), a lot of places use a 64-bit argument for printf-like functions expecting just 32 bits</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Gabor Gombas">gombasg@sztaki.hu</who>
            <bug_when>2008-01-08 16:26:33 EDT</bug_when>
            <thetext>Created an attachment (id=976)
Patch #1

</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Gabor Gombas">gombasg@sztaki.hu</who>
            <bug_when>2008-01-08 16:27:18 EDT</bug_when>
            <thetext>Created an attachment (id=977)
Patch #2

</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Wes Craig">wes@umich.edu</who>
            <bug_when>2008-10-07 14:48:12 EDT</bug_when>
            <thetext>We&apos;re not planning to use these patches verbatim, but they offer a good roadmap.  Instead of the printf z modifier and casts, we&apos;re going to use, e.g., MODSEQ_FMT and definitions for strtol(), e.g., strtosizet().  Feel free to help out.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">murch@andrew.cmu.edu</who>
            <bug_when>2008-10-08 11:49:25 EDT</bug_when>
            <thetext>Applied SIZE_T_FMT fix instead of %z fix</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Gabor Gombas">gombasg@sztaki.hu</who>
            <bug_when>2008-10-09 08:26:17 EDT</bug_when>
            <thetext>I don&apos;t mind the SIZE_T_FMT approach. I&apos;ve also tried it but then I thought it&apos;s ugly and makes the code harder to read. Adding explict casts everywhere was even more ugly. On the other hand, the &quot;%z&quot; modifier looked nice and clean.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Wes Craig">wes@umich.edu</who>
            <bug_when>2008-10-09 09:58:50 EDT</bug_when>
            <thetext>Sure, %z has a certain elegance, but there are so many bit-size sensitive arguments, none of which has to be related to size_t.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>976</attachid>
            <date>2008-01-08 16:26 EDT</date>
            <desc>Patch #1</desc>
            <filename>0001-Add-support-for-the-z-size-modifier-to-prot_printf.patch</filename>
            <type>text/plain</type>
            <size>21567</size>
            <attacher>gombasg@sztaki.hu</attacher>
            
              <data encoding="base64">RnJvbSBkYmNiNzBjODk0MmZmNmI4OTcyZGUwZGMzNDk4YTBkZTQyODVlYWJlIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiA9P3V0Zi04P3E/Rz1DMz1BMWJvcj0yMEdvbWI9QzM9QTFzPz0g
PGdvbWJhc2dAc3p0YWtpLmh1PgpEYXRlOiBUdWUsIDggSmFuIDIwMDggMjE6Mzc6MTAgKzAxMDAK
U3ViamVjdDogW1BBVENIXSBBZGQgc3VwcG9ydCBmb3IgdGhlICJ6IiBzaXplIG1vZGlmaWVyIHRv
IHByb3RfcHJpbnRmKCkKClRoZSAieiIgbW9kaWZpZXIgbWVhbnMgdGhhdCB0aGUgbmV4dCBvcGVy
YW5kIGlzIG9mIHR5cGUgc2l6ZV90LCB3aGljaAptYXkgYmUgZGlmZmVyZW50IG9uIDMyIGFuZCA2
NC1iaXQgaG9zdHMuIFVzZSB0aGlzIG1vZGlmaWVyIHdoZW5ldmVyCnRoZSByZXN1bHQgb2Ygc3Ry
bGVuKCkgaXMgcGFzc2VkIHRvIHByb3RfcHJpbnRmKCkuCi0tLQogaW1hcC9pbWFwX3Byb3h5LmMg
ICAgIHwgICAgNCArLQogaW1hcC9pbWFwZC5jICAgICAgICAgIHwgICA2MCArKysrKysrKysrKysr
KysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KIGltYXAvbWJkdW1wLmMgICAgICAg
ICB8ICAgIDYgKystLQogaW1hcC9tdXBkYXRlLWNsaWVudC5jIHwgICAxMiArKysrKy0tLS0tCiBp
bWFwL211cGRhdGUuYyAgICAgICAgfCAgIDEwICsrKystLS0tCiBpbWFwL3Nhc2xjbGllbnQuYyAg
ICAgfCAgICAyICstCiBpbWFwL3NtbWFwZC5jICAgICAgICAgfCAgIDEwICsrKystLS0tCiBpbWFw
L3N5bmNfc3VwcG9ydC5jICAgfCAgICA0ICstCiBpbXRlc3QvaW10ZXN0LmMgICAgICAgfCAgICAy
ICstCiBsaWIvcHJvdC5jICAgICAgICAgICAgfCAgIDIzICsrKysrKysrKysrKysrKysrLQogdGlt
c2lldmVkL2FjdGlvbnMuYyAgIHwgICAgMiArLQogMTEgZmlsZXMgY2hhbmdlZCwgNzcgaW5zZXJ0
aW9ucygrKSwgNTggZGVsZXRpb25zKC0pCgpkaWZmIC0tZ2l0IGEvaW1hcC9pbWFwX3Byb3h5LmMg
Yi9pbWFwL2ltYXBfcHJveHkuYwppbmRleCAwNmY2MzE2Li42Y2VlZGZiIDEwMDY0NAotLS0gYS9p
bWFwL2ltYXBfcHJveHkuYworKysgYi9pbWFwL2ltYXBfcHJveHkuYwpAQCAtODY0LDcgKzg2NCw3
IEBAIHZvaWQgcHJveHlfY29weShjb25zdCBjaGFyICp0YWcsIGNoYXIgKnNlcXVlbmNlLCBjaGFy
ICpuYW1lLCBpbnQgbXlyaWdodHMsCiAgICAgfQogCiAgICAgLyogc3RhcnQgdGhlIGFwcGVuZCAq
LwotICAgIHByb3RfcHJpbnRmKHMtPm91dCwgIiVzIEFwcGVuZCB7JWQrfVxyXG4lcyIsIHRhZywg
c3RybGVuKG5hbWUpLCBuYW1lKTsKKyAgICBwcm90X3ByaW50ZihzLT5vdXQsICIlcyBBcHBlbmQg
eyV6dSt9XHJcbiVzIiwgdGFnLCBzdHJsZW4obmFtZSksIG5hbWUpOwogICAgIHByb3RfcHJpbnRm
KGJhY2tlbmRfY3VycmVudC0+b3V0LCAiJXMgJXMgJXMgKFJmYzgyMi5wZWVrKVxyXG4iLAogCQlt
eXRhZywgdXNpbmd1aWQgPyAiVWlkIEZldGNoIiA6ICJGZXRjaCIsIHNlcXVlbmNlKTsKICAgICBm
b3IgKC8qIGVhY2ggRkVUQ0ggcmVzcG9uc2UgKi87OykgewpAQCAtMTA1OCw3ICsxMDU4LDcgQEAg
aW50IHByb3h5X2NhdGVuYXRlX3VybChzdHJ1Y3QgYmFja2VuZCAqcywgc3RydWN0IGltYXB1cmwg
KnVybCwgRklMRSAqZiwKIAogICAgIC8qIHNlbGVjdCB0aGUgbWFpbGJveCAocmVhZC1vbmx5KSAq
LwogICAgIHByb3h5X2dlbnRhZyhteXRhZywgc2l6ZW9mKG15dGFnKSk7Ci0gICAgcHJvdF9wcmlu
dGYocy0+b3V0LCAiJXMgRXhhbWluZSB7JWQrfVxyXG4lc1xyXG4iLAorICAgIHByb3RfcHJpbnRm
KHMtPm91dCwgIiVzIEV4YW1pbmUgeyV6dSt9XHJcbiVzXHJcbiIsCiAJCW15dGFnLCBzdHJsZW4o
dXJsLT5tYWlsYm94KSwgdXJsLT5tYWlsYm94KTsKICAgICBmb3IgKC8qIGVhY2ggZXhhbWluZSBy
ZXNwb25zZSAqLzs7KSB7CiAJLyogcmVhZCBhIGxpbmUgKi8KZGlmZiAtLWdpdCBhL2ltYXAvaW1h
cGQuYyBiL2ltYXAvaW1hcGQuYwppbmRleCBmZGFlNzk5Li42ZGJhZDE3IDEwMDY0NAotLS0gYS9p
bWFwL2ltYXBkLmMKKysrIGIvaW1hcC9pbWFwZC5jCkBAIC0yOTk5LDExICsyOTk5LDExIEBAIHZv
aWQgY21kX2FwcGVuZChjaGFyICp0YWcsIGNoYXIgKm5hbWUsIGNvbnN0IGNoYXIgKmN1cl9uYW1l
KQogCSAgICBpbnQgaXNfYWN0aXZlID0gMTsKIAkgICAgcy0+Y29udGV4dCA9ICh2b2lkKikgJmlz
X2FjdGl2ZTsKIAkgICAgaWYgKGltYXBkX21haWxib3gpIHsKLQkJcHJvdF9wcmludGYocy0+b3V0
LCAiJXMgTG9jYWxhcHBlbmQgeyVkK31cclxuJXMgeyVkK31cclxuJXMgIiwKKwkJcHJvdF9wcmlu
dGYocy0+b3V0LCAiJXMgTG9jYWxhcHBlbmQgeyV6dSt9XHJcbiVzIHslenUrfVxyXG4lcyAiLAog
CQkJICAgIHRhZywgc3RybGVuKG5hbWUpLCBuYW1lLAogCQkJICAgIHN0cmxlbihpbWFwZF9tYWls
Ym94LT5uYW1lKSwgaW1hcGRfbWFpbGJveC0+bmFtZSk7CiAJICAgIH0gZWxzZSB7Ci0JCXByb3Rf
cHJpbnRmKHMtPm91dCwgIiVzIExvY2FsYXBwZW5kIHslZCt9XHJcbiVzIHslZCt9XHJcbiVzICIs
CisJCXByb3RfcHJpbnRmKHMtPm91dCwgIiVzIExvY2FsYXBwZW5kIHslenUrfVxyXG4lcyB7JWQr
fVxyXG4lcyAiLAogCQkJICAgIHRhZywgc3RybGVuKG5hbWUpLCBuYW1lLCAwLCAiIik7CiAJICAg
IH0KIAkgICAgaWYgKCEociA9IHBpcGVfY29tbWFuZChzLCAxNjM4NCkpKSB7CkBAIC0zMzY3LDcg
KzMzNjcsNyBAQCB2b2lkIGNtZF9zZWxlY3QoY2hhciAqdGFnLCBjaGFyICpjbWQsIGNoYXIgKm5h
bWUpCiAJICAgIHJldHVybjsKIAl9CiAKLQlwcm90X3ByaW50ZihiYWNrZW5kX2N1cnJlbnQtPm91
dCwgIiVzICVzIHslZCt9XHJcbiVzJXNcclxuIiwgdGFnLCBjbWQsIAorCXByb3RfcHJpbnRmKGJh
Y2tlbmRfY3VycmVudC0+b3V0LCAiJXMgJXMgeyV6dSt9XHJcbiVzJXNcclxuIiwgdGFnLCBjbWQs
IAogCQkgICAgc3RybGVuKG5hbWUpLCBuYW1lLAogCQkgICAgaW1hcGRfY29uZHN0b3JlX2NsaWVu
dCA/ICIgKENPTkRTVE9SRSkiIDogIiIpOwogCXN3aXRjaCAocGlwZV9pbmNsdWRpbmdfdGFnKGJh
Y2tlbmRfY3VycmVudCwgdGFnLCAwKSkgewpAQCAtNDY5NCw3ICs0Njk0LDcgQEAgdm9pZCBjbWRf
Y29weShjaGFyICp0YWcsIGNoYXIgKnNlcXVlbmNlLCBjaGFyICpuYW1lLCBpbnQgdXNpbmd1aWQp
CiAJLyogeHh4ICBlbmQgb2Ygc2VwYXJhdGUgcHJveHktb25seSBjb2RlICovCiAKIAkvKiBzaW1w
bHkgc2VuZCB0aGUgQ09QWSB0byB0aGUgYmFja2VuZCAqLwotCXByb3RfcHJpbnRmKGJhY2tlbmRf
Y3VycmVudC0+b3V0LCAiJXMgJXMgJXMgeyVkK31cclxuJXNcclxuIiwKKwlwcm90X3ByaW50Zihi
YWNrZW5kX2N1cnJlbnQtPm91dCwgIiVzICVzICVzIHslenUrfVxyXG4lc1xyXG4iLAogCQkgICAg
dGFnLCB1c2luZ3VpZCA/ICJVSUQgQ29weSIgOiAiQ29weSIsCiAJCSAgICBzZXF1ZW5jZSwgc3Ry
bGVuKG5hbWUpLCBuYW1lKTsKIAlwaXBlX2luY2x1ZGluZ190YWcoYmFja2VuZF9jdXJyZW50LCB0
YWcsIDApOwpAQCAtNDcyNSw3ICs0NzI1LDcgQEAgdm9pZCBjbWRfY29weShjaGFyICp0YWcsIGNo
YXIgKnNlcXVlbmNlLCBjaGFyICpuYW1lLCBpbnQgdXNpbmd1aWQpCiAJaWYgKHIpIGdvdG8gZG9u
ZTsKIAogCS8qIHN0YXJ0IHRoZSBhcHBlbmQgKi8KLQlwcm90X3ByaW50ZihzLT5vdXQsICIlcyBB
cHBlbmQgeyVkK31cclxuJXMiLCB0YWcsIHN0cmxlbihuYW1lKSwgbmFtZSk7CisJcHJvdF9wcmlu
dGYocy0+b3V0LCAiJXMgQXBwZW5kIHslenUrfVxyXG4lcyIsIHRhZywgc3RybGVuKG5hbWUpLCBu
YW1lKTsKIAogCS8qIGFwcGVuZCB0aGUgbWVzc2FnZXMgKi8KIAlyID0gaW5kZXhfY29weV9yZW1v
dGUoaW1hcGRfbWFpbGJveCwgc2VxdWVuY2UsIHVzaW5ndWlkLCBzLT5vdXQpOwpAQCAtNDkxMSwx
MSArNDkxMSwxMSBAQCB2b2lkIGNtZF9jcmVhdGUoY2hhciAqdGFnLCBjaGFyICpuYW1lLCBjaGFy
ICpwYXJ0aXRpb24sIGludCBsb2NhbG9ubHkpCiAJCWlmIChwYXJ0aXRpb24pIHsKIAkJICAgIC8q
IFNlbmQgcGFydGl0aW9uIGFzIGFuIGF0b20sIHNpbmNlIGl0cyBhbGwgd2UgYWNjZXB0ICovCiAJ
CSAgICBwcm90X3ByaW50ZihzLT5vdXQsCi0JCQkJIiVzIENSRUFURSB7JWQrfVxyXG4lcyAlc1xy
XG4iLCAKKwkJCQkiJXMgQ1JFQVRFIHslenUrfVxyXG4lcyAlc1xyXG4iLCAKIAkJCQl0YWcsIHN0
cmxlbihuYW1lKSwgbmFtZSwgcGFydGl0aW9uKTsKIAkJfQogCQllbHNlCi0JCSAgICBwcm90X3By
aW50ZihzLT5vdXQsICIlcyBDUkVBVEUgeyVkK31cclxuJXNcclxuIiwgCisJCSAgICBwcm90X3By
aW50ZihzLT5vdXQsICIlcyBDUkVBVEUgeyV6dSt9XHJcbiVzXHJcbiIsIAogCQkJCXRhZywgc3Ry
bGVuKG5hbWUpLCBuYW1lKTsKIAkJcmVzID0gcGlwZV91bnRpbF90YWcocywgdGFnLCAwKTsKIAkK
QEAgLTUwNjQsNyArNTA2NCw3IEBAIHZvaWQgY21kX2RlbGV0ZShjaGFyICp0YWcsIGNoYXIgKm5h
bWUsIGludCBsb2NhbG9ubHksIGludCBmb3JjZSkKIAlpZiAoIXMpIHIgPSBJTUFQX1NFUlZFUl9V
TkFWQUlMQUJMRTsKIAogCWlmICghcikgewotCSAgICBwcm90X3ByaW50ZihzLT5vdXQsICIlcyBE
RUxFVEUgeyVkK31cclxuJXNcclxuIiwgCisJICAgIHByb3RfcHJpbnRmKHMtPm91dCwgIiVzIERF
TEVURSB7JXp1K31cclxuJXNcclxuIiwgCiAJCQl0YWcsIHN0cmxlbihuYW1lKSwgbmFtZSk7CiAJ
ICAgIHJlcyA9IHBpcGVfdW50aWxfdGFnKHMsIHRhZywgMCk7CiAKQEAgLTUzMTksNyArNTMxOSw3
IEBAIHZvaWQgY21kX3JlbmFtZShjaGFyICp0YWcsIGNoYXIgKm9sZG5hbWUsIGNoYXIgKm5ld25h
bWUsIGNoYXIgKnBhcnRpdGlvbikKIAkJICAgIC8qIENyb3NzIFNlcnZlciAqLwogCQkgICAgLyog
PHRhZz4gWEZFUiA8bmFtZT4gPGRlc3Qgc2VydmVyPiA8ZGVzdCBwYXJ0aXRpb24+ICovCiAJCSAg
ICBwcm90X3ByaW50ZihzLT5vdXQsCi0JCQkJIiVzIFhGRVIgeyVkK31cclxuJXMgeyVkK31cclxu
JXMgeyVkK31cclxuJXNcclxuIiwgCisJCQkJIiVzIFhGRVIgeyV6dSt9XHJcbiVzIHslenUrfVxy
XG4lcyB7JXp1K31cclxuJXNcclxuIiwgCiAJCQkJdGFnLCBzdHJsZW4ob2xkbmFtZSksIG9sZG5h
bWUsCiAJCQkJc3RybGVuKG5ld3NlcnZlciksIG5ld3NlcnZlciwKIAkJCQlzdHJsZW4oZGVzdHBh
cnQpLCBkZXN0cGFydCk7CkBAIC01MzI3LDcgKzUzMjcsNyBAQCB2b2lkIGNtZF9yZW5hbWUoY2hh
ciAqdGFnLCBjaGFyICpvbGRuYW1lLCBjaGFyICpuZXduYW1lLCBjaGFyICpwYXJ0aXRpb24pCiAJ
ICAgIAogCSAgICB9IGVsc2UgewogCQkvKiA8dGFnPiBYRkVSIDxuYW1lPiA8ZGVzdCBzZXJ2ZXI+
ICovCi0JCXByb3RfcHJpbnRmKHMtPm91dCwgIiVzIFhGRVIgeyVkK31cclxuJXMgeyVkK31cclxu
JXNcclxuIiwgCisJCXByb3RfcHJpbnRmKHMtPm91dCwgIiVzIFhGRVIgeyV6dSt9XHJcbiVzIHsl
enUrfVxyXG4lc1xyXG4iLCAKIAkJCSAgICB0YWcsIHN0cmxlbihvbGRuYW1lKSwgb2xkbmFtZSwK
IAkJCSAgICBzdHJsZW4ocGFydGl0aW9uKSwgcGFydGl0aW9uKTsKIAkgICAgfQpAQCAtNTM0Niw3
ICs1MzQ2LDcgQEAgdm9pZCBjbWRfcmVuYW1lKGNoYXIgKnRhZywgY2hhciAqb2xkbmFtZSwgY2hh
ciAqbmV3bmFtZSwgY2hhciAqcGFydGl0aW9uKQogCQkvKiBkbyBNVVBEQVRFIGNyZWF0ZSBvcGVy
YXRpb25zIGZvciBuZXcgbWFpbGJveCAqLwogCSAgICB9CiAKLQkgICAgcHJvdF9wcmludGYocy0+
b3V0LCAiJXMgUkVOQU1FIHslZCt9XHJcbiVzIHslZCt9XHJcbiVzXHJcbiIsIAorCSAgICBwcm90
X3ByaW50ZihzLT5vdXQsICIlcyBSRU5BTUUgeyV6dSt9XHJcbiVzIHslenUrfVxyXG4lc1xyXG4i
LCAKIAkJCXRhZywgc3RybGVuKG9sZG5hbWUpLCBvbGRuYW1lLAogCQkJc3RybGVuKG5ld25hbWUp
LCBuZXduYW1lKTsKIAkgICAgcmVzID0gcGlwZV91bnRpbF90YWcocywgdGFnLCAwKTsKQEAgLTU3
MDYsNyArNTcwNiw3IEBAIHZvaWQgY21kX2ZpbmQoY2hhciAqdGFnLCBjaGFyICpuYW1lc3BhY2Us
IGNoYXIgKnBhdHRlcm4pCiAJaWYgKGJhY2tlbmRfaW5ib3ggfHwgKGJhY2tlbmRfaW5ib3ggPSBw
cm94eV9maW5kaW5ib3hzZXJ2ZXIoKSkpIHsKIAkgICAgLyogcmVtb3RlIElOQk9YICovCiAJICAg
IHByb3RfcHJpbnRmKGJhY2tlbmRfaW5ib3gtPm91dCwgCi0JCQkiJXMgTHN1YiBcIlwiIHslZCt9
XHJcbiVzXHJcbiIsCisJCQkiJXMgTHN1YiBcIlwiIHslenUrfVxyXG4lc1xyXG4iLAogCQkJdGFn
LCBzdHJsZW4ocGF0dGVybiksIHBhdHRlcm4pOwogCSAgICBwaXBlX2xzdWIoYmFja2VuZF9pbmJv
eCwgdGFnLCAwLCAiTUFJTEJPWCIpOwogCX0gZWxzZSB7CkBAIC01ODAxLDcgKzU4MDEsNyBAQCB2
b2lkIGNtZF9saXN0KGNoYXIgKnRhZywgaW50IGxpc3RvcHRzLCBjaGFyICpyZWZlcmVuY2UsIGNo
YXIgKnBhdHRlcm4pCiAJICAgIHByb3RfcHJpbnRmKGJhY2tlbmRfaW5ib3gtPm91dCwgIiVzIExz
dWIgIiwgdGFnKTsKIAl9CiAJcHJvdF9wcmludGYoYmFja2VuZF9pbmJveC0+b3V0LCAKLQkJICAg
ICJ7JWQrfVxyXG4lcyB7JWQrfVxyXG4lc1xyXG4iLAorCQkgICAgInslenUrfVxyXG4lcyB7JXp1
K31cclxuJXNcclxuIiwKIAkJICAgIHN0cmxlbihyZWZlcmVuY2UpLCByZWZlcmVuY2UsCiAJCSAg
ICBzdHJsZW4ocGF0dGVybiksIHBhdHRlcm4pOwogCXBpcGVfbHN1YihiYWNrZW5kX2luYm94LCB0
YWcsIDAsIChsaXN0b3B0cyAmIExJU1RfTFNVQikgPyAiTFNVQiIgOiAiTElTVCIpOwpAQCAtNTkw
NiwxMiArNTkwNiwxMiBAQCB2b2lkIGNtZF9jaGFuZ2VzdWIoY2hhciAqdGFnLCBjaGFyICpuYW1l
c3BhY2UsIGNoYXIgKm5hbWUsIGludCBhZGQpCiAJaWYgKCFyKSB7CiAJICAgIGlmIChuYW1lc3Bh
Y2UpIHsKIAkJcHJvdF9wcmludGYoYmFja2VuZF9pbmJveC0+b3V0LCAKLQkJCSAgICAiJXMgJXMg
eyVkK31cclxuJXMgeyVkK31cclxuJXNcclxuIiwgCisJCQkgICAgIiVzICVzIHslenUrfVxyXG4l
cyB7JXp1K31cclxuJXNcclxuIiwgCiAJCQkgICAgdGFnLCBjbWQsIAogCQkJICAgIHN0cmxlbihu
YW1lc3BhY2UpLCBuYW1lc3BhY2UsCiAJCQkgICAgc3RybGVuKG5hbWUpLCBuYW1lKTsKIAkgICAg
fSBlbHNlIHsKLQkJcHJvdF9wcmludGYoYmFja2VuZF9pbmJveC0+b3V0LCAiJXMgJXMgeyVkK31c
clxuJXNcclxuIiwgCisJCXByb3RfcHJpbnRmKGJhY2tlbmRfaW5ib3gtPm91dCwgIiVzICVzIHsl
enUrfVxyXG4lc1xyXG4iLCAKIAkJCSAgICB0YWcsIGNtZCwgCiAJCQkgICAgc3RybGVuKG5hbWUp
LCBuYW1lKTsKIAkgICAgfQpAQCAtNjIxMCwxMyArNjIxMCwxMyBAQCB2b2lkIGNtZF9zZXRhY2wo
Y2hhciAqdGFnLCBjb25zdCBjaGFyICpuYW1lLAogCX0gZWxzZSBpZiAoIXIpIHsKIAkgICAgaWYg
KHJpZ2h0cykgewogCQlwcm90X3ByaW50ZihzLT5vdXQsIAotCQkJICAgICIlcyBTZXRhY2wgeyVk
K31cclxuJXMgeyVkK31cclxuJXMgeyVkK31cclxuJXNcclxuIiwKKwkJCSAgICAiJXMgU2V0YWNs
IHslenUrfVxyXG4lcyB7JXp1K31cclxuJXMgeyV6dSt9XHJcbiVzXHJcbiIsCiAJCQkgICAgdGFn
LCBzdHJsZW4obmFtZSksIG5hbWUsCiAJCQkgICAgc3RybGVuKGlkZW50aWZpZXIpLCBpZGVudGlm
aWVyLAogCQkJICAgIHN0cmxlbihyaWdodHMpLCByaWdodHMpOwogCSAgICB9IGVsc2UgewogCQlw
cm90X3ByaW50ZihzLT5vdXQsIAotCQkJICAgICIlcyBEZWxldGVhY2wgeyVkK31cclxuJXMgeyVk
K31cclxuJXNcclxuIiwKKwkJCSAgICAiJXMgRGVsZXRlYWNsIHslenUrfVxyXG4lcyB7JXp1K31c
clxuJXNcclxuIiwKIAkJCSAgICB0YWcsIHN0cmxlbihuYW1lKSwgbmFtZSwKIAkJCSAgICBzdHJs
ZW4oaWRlbnRpZmllciksIGlkZW50aWZpZXIpOwogCSAgICB9CkBAIC02Mzk5LDcgKzYzOTksNyBA
QCB2b2lkIGNtZF9nZXRxdW90YXJvb3QoY29uc3QgY2hhciAqdGFnLCBjb25zdCBjaGFyICpuYW1l
KQogCSAgICBpbWFwZF9jaGVjayhzLCAwLCAwKTsKIAogCSAgICBpZiAoIXIpIHsKLQkJcHJvdF9w
cmludGYocy0+b3V0LCAiJXMgR2V0cXVvdGFyb290IHslZCt9XHJcbiVzXHJcbiIsCisJCXByb3Rf
cHJpbnRmKHMtPm91dCwgIiVzIEdldHF1b3Rhcm9vdCB7JXp1K31cclxuJXNcclxuIiwKIAkJCSAg
ICB0YWcsIHN0cmxlbihuYW1lKSwgbmFtZSk7CiAJCXBpcGVfaW5jbHVkaW5nX3RhZyhzLCB0YWcs
IDApOwogCSAgICB9IGVsc2UgewpAQCAtNjcyOSw3ICs2NzI5LDcgQEAgdm9pZCBjbWRfc3RhdHVz
KGNoYXIgKnRhZywgY2hhciAqbmFtZSkKIAkgICAgaW1hcGRfY2hlY2socywgMCwgMCk7CiAKIAkg
ICAgaWYgKCFyKSB7Ci0JCXByb3RfcHJpbnRmKHMtPm91dCwgIiVzIFN0YXR1cyB7JWQrfVxyXG4l
cyAiLCB0YWcsCisJCXByb3RfcHJpbnRmKHMtPm91dCwgIiVzIFN0YXR1cyB7JXp1K31cclxuJXMg
IiwgdGFnLAogCQkJICAgIHN0cmxlbihuYW1lKSwgbmFtZSk7CiAJCWlmICghcGlwZV9jb21tYW5k
KHMsIDY1NTM2KSkgewogCQkgICAgcGlwZV9pbmNsdWRpbmdfdGFnKHMsIHRhZywgMCk7CkBAIC03
OTIyLDcgKzc5MjIsNyBAQCBzdGF0aWMgaW50IHRyYXNoYWNsKHN0cnVjdCBwcm90c3RyZWFtICpw
aW4sIHN0cnVjdCBwcm90c3RyZWFtICpwb3V0LAogICAgIG1lbXNldCgmdG1wLCAwLCBzaXplb2Yo
c3RydWN0IGJ1ZikpOwogICAgIG1lbXNldCgmdXNlciwgMCwgc2l6ZW9mKHN0cnVjdCBidWYpKTsK
IAotICAgIHByb3RfcHJpbnRmKHBvdXQsICJBQ0wwIEdFVEFDTCB7JWQrfVxyXG4lc1xyXG4iLAor
ICAgIHByb3RfcHJpbnRmKHBvdXQsICJBQ0wwIEdFVEFDTCB7JXp1K31cclxuJXNcclxuIiwKIAkJ
c3RybGVuKG1haWxib3gpLCBtYWlsYm94KTsKIAogICAgIHdoaWxlKDEpIHsKQEAgLTc5NzMsNyAr
Nzk3Myw3IEBAIHN0YXRpYyBpbnQgdHJhc2hhY2woc3RydWN0IHByb3RzdHJlYW0gKnBpbiwgc3Ry
dWN0IHByb3RzdHJlYW0gKnBvdXQsCiAKIAkJc25wcmludGYodGFnYnVmLCBzaXplb2YodGFnYnVm
KSwgIkFDTCVkIiwgKytpKTsKIAkJCi0JCXByb3RfcHJpbnRmKHBvdXQsICIlcyBERUxFVEVBQ0wg
eyVkK31cclxuJXMgeyVkK31cclxuJXNcclxuIiwKKwkJcHJvdF9wcmludGYocG91dCwgIiVzIERF
TEVURUFDTCB7JXp1K31cclxuJXMgeyV6dSt9XHJcbiVzXHJcbiIsCiAJCQkgICAgdGFnYnVmLCBz
dHJsZW4obWFpbGJveCksIG1haWxib3gsCiAJCQkgICAgc3RybGVuKHVzZXIucyksIHVzZXIucyk7
CiAJCWlmKGMgPT0gJ1xyJykgewpAQCAtODA1MCw3ICs4MDUwLDcgQEAgc3RhdGljIGludCBkdW1w
YWNsKHN0cnVjdCBwcm90c3RyZWFtICpwaW4sIHN0cnVjdCBwcm90c3RyZWFtICpwb3V0LAogCiAJ
c25wcmludGYodGFnLCBzaXplb2YodGFnKSwgIlNBQ0wlZCIsIHRhZ251bSsrKTsKIAkKLQlwcm90
X3ByaW50Zihwb3V0LCAiJXMgU0VUQUNMIHslZCt9XHJcbiVzIHslZCt9XHJcbiVzIHslZCt9XHJc
biVzXHJcbiIsCisJcHJvdF9wcmludGYocG91dCwgIiVzIFNFVEFDTCB7JWQrfVxyXG4lcyB7JXp1
K31cclxuJXMgeyV6dSt9XHJcbiVzXHJcbiIsCiAJCSAgICB0YWcsCiAJCSAgICBtYWlsYm94bGVu
LCBtYWlsYm94LAogCQkgICAgc3RybGVuKGFjbCksIGFjbCwKQEAgLTgxNjksMTAgKzgxNjksMTAg
QEAgc3RhdGljIGludCBkb194ZmVyX3NpbmdsZShjaGFyICp0b3NlcnZlciwgY2hhciAqdG9wYXJ0
LAogICAgIGlmKCFyKSB7CiAJaWYodG9wYXJ0KSB7CiAJICAgIC8qIG5lZWQgdG8gc2VuZCBwYXJ0
aXRpb24gYXMgYW4gYXRvbSAqLwotCSAgICBwcm90X3ByaW50ZihiZS0+b3V0LCAiTEMxIExPQ0FM
Q1JFQVRFIHslZCt9XHJcbiVzICVzXHJcbiIsCisJICAgIHByb3RfcHJpbnRmKGJlLT5vdXQsICJM
QzEgTE9DQUxDUkVBVEUgeyV6dSt9XHJcbiVzICVzXHJcbiIsCiAJCQlzdHJsZW4obmFtZSksIG5h
bWUsIHRvcGFydCk7CiAJfSBlbHNlIHsKLQkgICAgcHJvdF9wcmludGYoYmUtPm91dCwgIkxDMSBM
T0NBTENSRUFURSB7JWQrfVxyXG4lc1xyXG4iLAorCSAgICBwcm90X3ByaW50ZihiZS0+b3V0LCAi
TEMxIExPQ0FMQ1JFQVRFIHslenUrfVxyXG4lc1xyXG4iLAogCQkJc3RybGVuKG5hbWUpLCBuYW1l
KTsKIAl9CiAJciA9IGdldHJlc3VsdChiZS0+aW4sICJMQzEiKTsKQEAgLTgyMDcsNyArODIwNyw3
IEBAIHN0YXRpYyBpbnQgZG9feGZlcl9zaW5nbGUoY2hhciAqdG9zZXJ2ZXIsIGNoYXIgKnRvcGFy
dCwKICAgICBpZighcikgewogCWJhY2tvdXRfbXVwZGF0ZSA9IDE7CiAKLQlwcm90X3ByaW50Zihi
ZS0+b3V0LCAiRDAxIFVORFVNUCB7JWQrfVxyXG4lcyAiLCBzdHJsZW4obmFtZSksIG5hbWUpOwor
CXByb3RfcHJpbnRmKGJlLT5vdXQsICJEMDEgVU5EVU1QIHslenUrfVxyXG4lcyAiLCBzdHJsZW4o
bmFtZSksIG5hbWUpOwogCiAJciA9IGR1bXBfbWFpbGJveChOVUxMLCBtYWlsYm94bmFtZSwgcGF0
aCwgbXBhdGgsIGFjbCwKIAkJCSAwLCBiZS0+aW4sIGJlLT5vdXQsIGltYXBkX2F1dGhzdGF0ZSk7
CkBAIC04MjUzLDcgKzgyNTMsNyBAQCBzdGF0aWMgaW50IGRvX3hmZXJfc2luZ2xlKGNoYXIgKnRv
c2VydmVyLCBjaGFyICp0b3BhcnQsCiAJLyogNi41KSBLaWNrIHJlbW90ZSBzZXJ2ZXIgdG8gY29y
cmVjdCBtdXBkYXRlIGVudHJ5ICovCiAJLyogTm90ZSB0aGF0IHdlIGRvbid0IHJlYWxseSBjYXJl
IGlmIHRoaXMgc3VjY2VlZHMgb3Igbm90ICovCiAJaWYgKG11cGRhdGVfaCkgewotCSAgICBwcm90
X3ByaW50ZihiZS0+b3V0LCAiTVAxIE1VUERBVEVQVVNIIHslZCt9XHJcbiVzXHJcbiIsCisJICAg
IHByb3RfcHJpbnRmKGJlLT5vdXQsICJNUDEgTVVQREFURVBVU0ggeyV6dSt9XHJcbiVzXHJcbiIs
CiAJCQlzdHJsZW4obmFtZSksIG5hbWUpOwogCSAgICByZXJyID0gZ2V0cmVzdWx0KGJlLT5pbiwg
Ik1QMSIpOwogCSAgICBpZihyZXJyKSB7CkBAIC04MzE3LDcgKzgzMTcsNyBAQCBkb25lOgogICAg
IH0KICAgICBpZihyICYmIGJhY2tvdXRfcmVtb3RlYm94KSB7CiAJcmVyciA9IDA7Ci0JcHJvdF9w
cmludGYoYmUtPm91dCwgIkxEMSBMT0NBTERFTEVURSB7JWQrfVxyXG4lc1xyXG4iLAorCXByb3Rf
cHJpbnRmKGJlLT5vdXQsICJMRDEgTE9DQUxERUxFVEUgeyV6dSt9XHJcbiVzXHJcbiIsCiAJCSAg
ICBzdHJsZW4obmFtZSksIG5hbWUpOwogCXJlcnIgPSBnZXRyZXN1bHQoYmUtPmluLCAiTEQxIik7
CiAgCWlmKHJlcnIpIHsKQEAgLTg1MjAsNyArODUyMCw3IEBAIHZvaWQgY21kX3hmZXIoY2hhciAq
dGFnLCBjaGFyICpuYW1lLCBjaGFyICp0b3NlcnZlciwgY2hhciAqdG9wYXJ0KQogCSAgICBpZigh
cikgewogCQkvKiBub3RlIHVzZSBvZiArIHRvIGZvcmNlIHRoZSBzZXR0aW5nIG9mIGEgbm9uZXhp
c3RhbnQKIAkJICogcXVvdGFyb290ICovCi0JCXByb3RfcHJpbnRmKGJlLT5vdXQsICJRMDEgU0VU
UVVPVEEgeyVkK31cclxuIiBcCisJCXByb3RfcHJpbnRmKGJlLT5vdXQsICJRMDEgU0VUUVVPVEEg
eyV6dSt9XHJcbiIgXAogCQkJICAgICIrJXMgKFNUT1JBR0UgJWQpXHJcbiIsCiAJCQkgICAgc3Ry
bGVuKG5hbWUpKzEsIG5hbWUsIHF1b3RhLmxpbWl0KTsKIAkJciA9IGdldHJlc3VsdChiZS0+aW4s
ICJRMDEiKTsKQEAgLTkwNzMsNyArOTA3Myw3IEBAIGNvbnN0IGNoYXIgKnM7CiAKICAgICAvKiBp
ZiBpdCdzIHRvbyBsb25nLCBsaXRlcmFsIGl0ICovCiAgICAgaWYgKCpwIHx8IGxlbiA+PSAxMDI0
KSB7Ci0JcHJvdF9wcmludGYoaW1hcGRfb3V0LCAieyV1fVxyXG4lcyIsIHN0cmxlbihzKSwgcyk7
CisJcHJvdF9wcmludGYoaW1hcGRfb3V0LCAieyV6dX1cclxuJXMiLCBzdHJsZW4ocyksIHMpOwog
ICAgIH0gZWxzZSB7CiAJcHJvdF9wcmludGYoaW1hcGRfb3V0LCAiXCIlc1wiIiwgcyk7CiAgICAg
fQpAQCAtOTEwMyw3ICs5MTAzLDcgQEAgY29uc3QgY2hhciAqczsKIAogICAgIC8qIGlmIGl0J3Mg
dG9vIGxvbmcsIGxpdGVyYWwgaXQgKi8KICAgICBpZiAoKnAgfHwgbGVuID49IDEwMjQpIHsKLQlw
cm90X3ByaW50ZihpbWFwZF9vdXQsICJ7JXV9XHJcbiVzIiwgc3RybGVuKHMpLCBzKTsKKwlwcm90
X3ByaW50ZihpbWFwZF9vdXQsICJ7JXp1fVxyXG4lcyIsIHN0cmxlbihzKSwgcyk7CiAgICAgfSBl
bHNlIHsKIAlwcm90X3ByaW50ZihpbWFwZF9vdXQsICJcIiVzXCIiLCBzKTsKICAgICB9CmRpZmYg
LS1naXQgYS9pbWFwL21iZHVtcC5jIGIvaW1hcC9tYmR1bXAuYwppbmRleCA0MThiOTEwLi4zNzlh
M2M1IDEwMDY0NAotLS0gYS9pbWFwL21iZHVtcC5jCisrKyBiL2ltYXAvbWJkdW1wLmMKQEAgLTEz
NCw3ICsxMzQsNyBAQCBzdGF0aWMgaW50IGR1bXBfYW5ub3RhdGlvbnMoY29uc3QgY2hhciAqbWFp
bGJveCBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKICAgICAvKiBUcmFuc2ZlciBhbGwgYXR0cmli
dXRlcyBmb3IgdGhpcyBhbm5vdGF0aW9uLCBkb24ndCB0cmFuc2ZlciBzaXplCiAgICAgICogc2Vw
YXJhdGVseSBzaW5jZSB0aGF0IGNhbiBiZSBpbXBsaWNpdGx5IGRldGVybWluZWQgKi8KICAgICBw
cm90X3ByaW50ZihjdHgtPnBvdXQsCi0JCSIgeyVsZCVzfVxyXG5BLSVzJXMgKCVsZCB7JWQlc31c
clxuJXMgeyVkJXN9XHJcbiVzKSIsCisJCSIgeyVsZCVzfVxyXG5BLSVzJXMgKCVsZCB7JXp1JXN9
XHJcbiVzIHslenUlc31cclxuJXMpIiwKIAkJZW5hbWVfc2l6ZSwgKCFjdHgtPnRhZyA/ICIrIiA6
ICIiKSwKIAkJdXNlcmlkLCBlbnRyeSwKIAkJYXR0cmliLT5tb2RpZmllZHNpbmNlLApAQCAtMTc4
LDcgKzE3OCw3IEBAIHN0YXRpYyBpbnQgZHVtcF9maWxlKGludCBmaXJzdCwgaW50IHN5bmMsCiAK
ICAgICAvKiBzZW5kOiBuYW1lLCBzaXplLCBhbmQgY29udGVudHMgKi8KICAgICBpZiAoZmlyc3Qp
IHsKLQlwcm90X3ByaW50Zihwb3V0LCAiIHslZH1cclxuIiwgc3RybGVuKGZ0YWcpKTsKKwlwcm90
X3ByaW50Zihwb3V0LCAiIHslenV9XHJcbiIsIHN0cmxlbihmdGFnKSk7CiAKIAlpZiAoc3luYykg
ewogCSAgICAvKiBzeW5jaHJvbml6ZSAqLwpAQCAtMTk0LDcgKzE5NCw3IEBAIHN0YXRpYyBpbnQg
ZHVtcF9maWxlKGludCBmaXJzdCwgaW50IHN5bmMsCiAJcHJvdF9wcmludGYocG91dCwgIiVzIHsl
bHUlc31cclxuIiwKIAkJICAgIGZ0YWcsIGxlbiwgKHN5bmMgPyAiKyIgOiAiIikpOwogICAgIH0g
ZWxzZSB7Ci0JcHJvdF9wcmludGYocG91dCwgIiB7JWQlc31cclxuJXMgeyVsdSVzfVxyXG4iLAor
CXByb3RfcHJpbnRmKHBvdXQsICIgeyV6dSVzfVxyXG4lcyB7JWx1JXN9XHJcbiIsCiAJCSAgICBz
dHJsZW4oZnRhZyksIChzeW5jID8gIisiIDogIiIpLAogCQkgICAgZnRhZywgbGVuLCAoc3luYyA/
ICIrIiA6ICIiKSk7CiAgICAgfQpkaWZmIC0tZ2l0IGEvaW1hcC9tdXBkYXRlLWNsaWVudC5jIGIv
aW1hcC9tdXBkYXRlLWNsaWVudC5jCmluZGV4IDI1YWZjZDcuLmZmNjcxY2EgMTAwNjQ0Ci0tLSBh
L2ltYXAvbXVwZGF0ZS1jbGllbnQuYworKysgYi9pbWFwL211cGRhdGUtY2xpZW50LmMKQEAgLTE4
MSw3ICsxODEsNyBAQCBpbnQgbXVwZGF0ZV9hY3RpdmF0ZShtdXBkYXRlX2hhbmRsZSAqaGFuZGxl
LAogICAgIH0KIAogICAgIHByb3RfcHJpbnRmKGhhbmRsZS0+Y29ubi0+b3V0LAotCQkiWCV1IEFD
VElWQVRFIHslZCt9XHJcbiVzIHslZCt9XHJcbiVzIHslZCt9XHJcbiVzXHJcbiIsIAorCQkiWCV1
IEFDVElWQVRFIHslenUrfVxyXG4lcyB7JXp1K31cclxuJXMgeyV6dSt9XHJcbiVzXHJcbiIsIAog
CQloYW5kbGUtPnRhZ24rKywgc3RybGVuKG1haWxib3gpLCBtYWlsYm94LCAKIAkJc3RybGVuKHNl
cnZlciksIHNlcnZlciwgc3RybGVuKGFjbCksIGFjbCk7CiAKQEAgLTIxMyw3ICsyMTMsNyBAQCBp
bnQgbXVwZGF0ZV9yZXNlcnZlKG11cGRhdGVfaGFuZGxlICpoYW5kbGUsCiAgICAgfQogCiAgICAg
cHJvdF9wcmludGYoaGFuZGxlLT5jb25uLT5vdXQsCi0JCSJYJXUgUkVTRVJWRSB7JWQrfVxyXG4l
cyB7JWQrfVxyXG4lc1xyXG4iLAorCQkiWCV1IFJFU0VSVkUgeyV6dSt9XHJcbiVzIHslenUrfVxy
XG4lc1xyXG4iLAogCQloYW5kbGUtPnRhZ24rKywgc3RybGVuKG1haWxib3gpLCBtYWlsYm94LCAK
IAkJc3RybGVuKHNlcnZlciksIHNlcnZlcik7CiAKQEAgLTI0NSw3ICsyNDUsNyBAQCBpbnQgbXVw
ZGF0ZV9kZWFjdGl2YXRlKG11cGRhdGVfaGFuZGxlICpoYW5kbGUsCiAgICAgfQogCiAgICAgcHJv
dF9wcmludGYoaGFuZGxlLT5jb25uLT5vdXQsCi0JCSJYJXUgREVBQ1RJVkFURSB7JWQrfVxyXG4l
cyB7JWQrfVxyXG4lc1xyXG4iLAorCQkiWCV1IERFQUNUSVZBVEUgeyV6dSt9XHJcbiVzIHslenUr
fVxyXG4lc1xyXG4iLAogCQloYW5kbGUtPnRhZ24rKywgc3RybGVuKG1haWxib3gpLCBtYWlsYm94
LCAKIAkJc3RybGVuKHNlcnZlciksIHNlcnZlcik7CiAKQEAgLTI3MCw3ICsyNzAsNyBAQCBpbnQg
bXVwZGF0ZV9kZWxldGUobXVwZGF0ZV9oYW5kbGUgKmhhbmRsZSwKICAgICBpZiAoIWhhbmRsZS0+
c2FzbGNvbXBsZXRlZCkgcmV0dXJuIE1VUERBVEVfTk9BVVRIOwogCiAgICAgcHJvdF9wcmludGYo
aGFuZGxlLT5jb25uLT5vdXQsCi0JCSJYJXUgREVMRVRFIHslZCt9XHJcbiVzXHJcbiIsIGhhbmRs
ZS0+dGFnbisrLCAKKwkJIlgldSBERUxFVEUgeyV6dSt9XHJcbiVzXHJcbiIsIGhhbmRsZS0+dGFn
bisrLCAKIAkJc3RybGVuKG1haWxib3gpLCBtYWlsYm94KTsKIAogICAgIHJldCA9IG11cGRhdGVf
c2NhcmYoaGFuZGxlLCBtdXBkYXRlX3NjYXJmX29uZSwgTlVMTCwgMSwgJnJlc3BvbnNlKTsKQEAg
LTMzOSw3ICszMzksNyBAQCBpbnQgbXVwZGF0ZV9maW5kKG11cGRhdGVfaGFuZGxlICpoYW5kbGUs
IGNvbnN0IGNoYXIgKm1haWxib3gsCiAgICAgaWYoIWhhbmRsZSB8fCAhbWFpbGJveCB8fCAhdGFy
Z2V0KSByZXR1cm4gTVVQREFURV9CQURQQVJBTTsKIAogICAgIHByb3RfcHJpbnRmKGhhbmRsZS0+
Y29ubi0+b3V0LAotCQkiWCV1IEZJTkQgeyVkK31cclxuJXNcclxuIiwgaGFuZGxlLT50YWduKyss
IAorCQkiWCV1IEZJTkQgeyV6dSt9XHJcbiVzXHJcbiIsIGhhbmRsZS0+dGFnbisrLCAKIAkJc3Ry
bGVuKG1haWxib3gpLCBtYWlsYm94KTsKIAogICAgIG1lbXNldCgmKGhhbmRsZS0+bWFpbGJveGRh
dGFfYnVmKSwgMCwgc2l6ZW9mKGhhbmRsZS0+bWFpbGJveGRhdGFfYnVmKSk7CkBAIC0zNzIsNyAr
MzcyLDcgQEAgaW50IG11cGRhdGVfbGlzdChtdXBkYXRlX2hhbmRsZSAqaGFuZGxlLCBtdXBkYXRl
X2NhbGxiYWNrIGNhbGxiYWNrLAogCiAgICAgaWYocHJlZml4KSB7CiAJcHJvdF9wcmludGYoaGFu
ZGxlLT5jb25uLT5vdXQsCi0JCSAgICAiWCV1IExJU1QgeyVkK31cclxuJXNcclxuIiwgaGFuZGxl
LT50YWduKyssCisJCSAgICAiWCV1IExJU1QgeyV6dSt9XHJcbiVzXHJcbiIsIGhhbmRsZS0+dGFn
bisrLAogCQkgICAgc3RybGVuKHByZWZpeCksIHByZWZpeCk7CiAgICAgfSBlbHNlIHsKIAlwcm90
X3ByaW50ZihoYW5kbGUtPmNvbm4tPm91dCwKZGlmZiAtLWdpdCBhL2ltYXAvbXVwZGF0ZS5jIGIv
aW1hcC9tdXBkYXRlLmMKaW5kZXggNzIxZThmNy4uYTA2Yzg5ZiAxMDA2NDQKLS0tIGEvaW1hcC9t
dXBkYXRlLmMKKysrIGIvaW1hcC9tdXBkYXRlLmMKQEAgLTE3MTEsMTkgKzE3MTEsMTkgQEAgdm9p
ZCBjbWRfZmluZChzdHJ1Y3QgY29ubiAqQywgY29uc3QgY2hhciAqdGFnLCBjb25zdCBjaGFyICpt
YWlsYm94LAogICAgIHB0aHJlYWRfbXV0ZXhfdW5sb2NrKCZtYWlsYm94ZXNfbXV0ZXgpOyAvKiBV
TkxPQ0sgKi8KIAogICAgIGlmIChtICYmIG0tPnQgPT0gU0VUX0FDVElWRSkgewotCXByb3RfcHJp
bnRmKEMtPnBvdXQsICIlcyBNQUlMQk9YIHslZCt9XHJcbiVzIHslZCt9XHJcbiVzIHslZCt9XHJc
biVzXHJcbiIsCisJcHJvdF9wcmludGYoQy0+cG91dCwgIiVzIE1BSUxCT1ggeyV6dSt9XHJcbiVz
IHslenUrfVxyXG4lcyB7JXp1K31cclxuJXNcclxuIiwKIAkJICAgIHRhZywKIAkJICAgIHN0cmxl
bihtLT5tYWlsYm94KSwgbS0+bWFpbGJveCwKIAkJICAgIHN0cmxlbihtLT5zZXJ2ZXIpLCBtLT5z
ZXJ2ZXIsCiAJCSAgICBzdHJsZW4obS0+YWNsKSwgbS0+YWNsKTsKICAgICB9IGVsc2UgaWYgKG0g
JiYgbS0+dCA9PSBTRVRfUkVTRVJWRSkgewotCXByb3RfcHJpbnRmKEMtPnBvdXQsICIlcyBSRVNF
UlZFIHslZCt9XHJcbiVzIHslZCt9XHJcbiVzXHJcbiIsCisJcHJvdF9wcmludGYoQy0+cG91dCwg
IiVzIFJFU0VSVkUgeyV6dSt9XHJcbiVzIHslenUrfVxyXG4lc1xyXG4iLAogCQkgICAgdGFnLAog
CQkgICAgc3RybGVuKG0tPm1haWxib3gpLCBtLT5tYWlsYm94LAogCQkgICAgc3RybGVuKG0tPnNl
cnZlciksIG0tPnNlcnZlcik7CiAgICAgfSBlbHNlIGlmIChzZW5kX2RlbGV0ZSkgewogCS8qIG5v
dCBmb3VuZCwgaWYgbmVlZGVkLCBzZW5kIGEgZGVsZXRlICovCi0JcHJvdF9wcmludGYoQy0+cG91
dCwgIiVzIERFTEVURSB7JWQrfVxyXG4lc1xyXG4iLAorCXByb3RfcHJpbnRmKEMtPnBvdXQsICIl
cyBERUxFVEUgeyV6dSt9XHJcbiVzXHJcbiIsCiAJCSAgICB0YWcsIHN0cmxlbihtYWlsYm94KSwg
bWFpbGJveCk7CiAgICAgfQogICAgIApAQCAtMTc2NiwxNCArMTc2NiwxNCBAQCBzdGF0aWMgaW50
IHNlbmR1cGRhdGUoY2hhciAqbmFtZSwKIAkgICAgc3dpdGNoIChtLT50KSB7CiAJICAgIGNhc2Ug
U0VUX0FDVElWRToKIAkJcHJvdF9wcmludGYoQy0+cG91dCwKLQkJCSAgICAiJXMgTUFJTEJPWCB7
JWQrfVxyXG4lcyB7JWQrfVxyXG4lcyB7JWQrfVxyXG4lc1xyXG4iLAorCQkJICAgICIlcyBNQUlM
Qk9YIHslenUrfVxyXG4lcyB7JXp1K31cclxuJXMgeyV6dSt9XHJcbiVzXHJcbiIsCiAJCQkgICAg
Qy0+c3RyZWFtaW5nLAogCQkJICAgIHN0cmxlbihtLT5tYWlsYm94KSwgbS0+bWFpbGJveCwKIAkJ
CSAgICBzdHJsZW4obS0+c2VydmVyKSwgbS0+c2VydmVyLAogCQkJICAgIHN0cmxlbihtLT5hY2wp
LCBtLT5hY2wpOwogCQlicmVhazsKIAkgICAgY2FzZSBTRVRfUkVTRVJWRToKLQkJcHJvdF9wcmlu
dGYoQy0+cG91dCwgIiVzIFJFU0VSVkUgeyVkK31cclxuJXMgeyVkK31cclxuJXNcclxuIiwKKwkJ
cHJvdF9wcmludGYoQy0+cG91dCwgIiVzIFJFU0VSVkUgeyV6dSt9XHJcbiVzIHslenUrfVxyXG4l
c1xyXG4iLAogCQkJICAgIEMtPnN0cmVhbWluZywKIAkJCSAgICBzdHJsZW4obS0+bWFpbGJveCks
IG0tPm1haWxib3gsCiAJCQkgICAgc3RybGVuKG0tPnNlcnZlciksIG0tPnNlcnZlcik7CmRpZmYg
LS1naXQgYS9pbWFwL3Nhc2xjbGllbnQuYyBiL2ltYXAvc2FzbGNsaWVudC5jCmluZGV4IGUzNWYx
NjYuLmM1MDJkN2EgMTAwNjQ0Ci0tLSBhL2ltYXAvc2FzbGNsaWVudC5jCisrKyBiL2ltYXAvc2Fz
bGNsaWVudC5jCkBAIC0yNTEsNyArMjUxLDcgQEAgaW50IHNhc2xjbGllbnQoc2FzbF9jb25uX3Qg
KmNvbm4sIHN0cnVjdCBzYXNsX2NtZF90ICpzYXNsX2NtZCwKIAogCS8qIHNlbmQgdG8gc2VydmVy
ICovCiAJaWYgKHNlbmRsaXRlcmFsKSB7Ci0JICAgIHByb3RfcHJpbnRmKHBvdXQsICJ7JWQrfVxy
XG4iLCBzdHJsZW4oYmFzZTY0KSk7CisJICAgIHByb3RfcHJpbnRmKHBvdXQsICJ7JXp1K31cclxu
Iiwgc3RybGVuKGJhc2U2NCkpOwogCSAgICBwcm90X2ZsdXNoKHBvdXQpOwogCX0KIAlwcm90X3By
aW50Zihwb3V0LCAiJXMiLCBiYXNlNjQpOwpkaWZmIC0tZ2l0IGEvaW1hcC9zbW1hcGQuYyBiL2lt
YXAvc21tYXBkLmMKaW5kZXggMjkzOGUyMS4uZmVhZDdmYyAxMDA2NDQKLS0tIGEvaW1hcC9zbW1h
cGQuYworKysgYi9pbWFwL3NtbWFwZC5jCkBAIC00NDgsMTcgKzQ0OCwxNyBAQCBpbnQgYmVnaW5f
aGFuZGxpbmcodm9pZCkKICAgICAgICAgICAgIGJyZWFrOwogCiAJY2FzZSAwOgotCSAgICBwcm90
X3ByaW50ZihtYXBfb3V0LCAiJWQ6T0sgJXMsIiwgMytzdHJsZW4oa2V5KSwga2V5KTsKKwkgICAg
cHJvdF9wcmludGYobWFwX291dCwgIiV6dTpPSyAlcywiLCAzK3N0cmxlbihrZXkpLCBrZXkpOwog
CSAgICBicmVhazsKIAogCWNhc2UgSU1BUF9NQUlMQk9YX05PTkVYSVNURU5UOgotCSAgICBwcm90
X3ByaW50ZihtYXBfb3V0LCAiJWQ6Tk9URk9VTkQgJXMsIiwKKwkgICAgcHJvdF9wcmludGYobWFw
X291dCwgIiV6dTpOT1RGT1VORCAlcywiLAogCQkJOStzdHJsZW4oZXJyb3JfbWVzc2FnZShyKSks
IGVycm9yX21lc3NhZ2UocikpOwogCSAgICBicmVhazsKIAogCWNhc2UgSU1BUF9RVU9UQV9FWENF
RURFRDoKIAkgICAgaWYgKCFjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfTE1UUF9PVkVSX1FVT1RB
X1BFUk1fRkFJTFVSRSkpIHsKLQkJcHJvdF9wcmludGYobWFwX291dCwgIiVkOlRFTVAgJXMsIiwg
c3RybGVuKGVycm9yX21lc3NhZ2UocikpKzUsCisJCXByb3RfcHJpbnRmKG1hcF9vdXQsICIlenU6
VEVNUCAlcywiLCBzdHJsZW4oZXJyb3JfbWVzc2FnZShyKSkrNSwKIAkJCSAgICBlcnJvcl9tZXNz
YWdlKHIpKTsKIAkJYnJlYWs7CiAJICAgIH0KQEAgLTQ2NiwxMSArNDY2LDExIEBAIGludCBiZWdp
bl9oYW5kbGluZyh2b2lkKQogCiAJZGVmYXVsdDoKIAkgICAgaWYgKGVycnN0cmluZykKLQkJcHJv
dF9wcmludGYobWFwX291dCwgIiVkOlBFUk0gJXMgKCVzKSwiLAorCQlwcm90X3ByaW50ZihtYXBf
b3V0LCAiJXp1OlBFUk0gJXMgKCVzKSwiLAogCQkJICAgIDUrc3RybGVuKGVycm9yX21lc3NhZ2Uo
cikpKzMrc3RybGVuKGVycnN0cmluZyksCiAJCQkgICAgZXJyb3JfbWVzc2FnZShyKSwgZXJyc3Ry
aW5nKTsKIAkgICAgZWxzZQotCQlwcm90X3ByaW50ZihtYXBfb3V0LCAiJWQ6UEVSTSAlcywiLAor
CQlwcm90X3ByaW50ZihtYXBfb3V0LCAiJXp1OlBFUk0gJXMsIiwKIAkJCSAgICA1K3N0cmxlbihl
cnJvcl9tZXNzYWdlKHIpKSwgZXJyb3JfbWVzc2FnZShyKSk7CiAJICAgIGJyZWFrOwogCX0KZGlm
ZiAtLWdpdCBhL2ltYXAvc3luY19zdXBwb3J0LmMgYi9pbWFwL3N5bmNfc3VwcG9ydC5jCmluZGV4
IGIzYmMzMjkuLjI0MTNiMzAgMTAwNjQ0Ci0tLSBhL2ltYXAvc3luY19zdXBwb3J0LmMKKysrIGIv
aW1hcC9zeW5jX3N1cHBvcnQuYwpAQCAtMTg3LDcgKzE4Nyw3IEBAIHZvaWQgc3luY19wcmludHN0
cmluZyhzdHJ1Y3QgcHJvdHN0cmVhbSAqb3V0LCBjb25zdCBjaGFyICpzKQogCiAgICAgLyogaWYg
aXQncyB0b28gbG9uZywgbGl0ZXJhbCBpdCAqLwogICAgIGlmICgqcCB8fCBsZW4gPj0gMTAyNCkg
ewotCXByb3RfcHJpbnRmKG91dCwgInsldSt9XHJcbiVzIiwgc3RybGVuKHMpLCBzKTsKKwlwcm90
X3ByaW50ZihvdXQsICJ7JXp1K31cclxuJXMiLCBzdHJsZW4ocyksIHMpOwogICAgIH0gZWxzZSB7
CiAJcHJvdF9wcmludGYob3V0LCAiXCIlc1wiIiwgcyk7CiAgICAgfQpAQCAtMjIwLDcgKzIyMCw3
IEBAIHZvaWQgc3luY19wcmludGFzdHJpbmcoc3RydWN0IHByb3RzdHJlYW0gKm91dCwgY29uc3Qg
Y2hhciAqcykKIAogICAgIC8qIGlmIGl0J3MgdG9vIGxvbmcsIGxpdGVyYWwgaXQgKi8KICAgICBp
ZiAoKnAgfHwgbGVuID49IDEwMjQpIHsKLQlwcm90X3ByaW50ZihvdXQsICJ7JXUrfVxyXG4lcyIs
IHN0cmxlbihzKSwgcyk7CisJcHJvdF9wcmludGYob3V0LCAieyV6dSt9XHJcbiVzIiwgc3RybGVu
KHMpLCBzKTsKICAgICB9IGVsc2UgewogCXByb3RfcHJpbnRmKG91dCwgIlwiJXNcIiIsIHMpOwog
ICAgIH0KZGlmZiAtLWdpdCBhL2ltdGVzdC9pbXRlc3QuYyBiL2ltdGVzdC9pbXRlc3QuYwppbmRl
eCBkMWNiNmI2Li5iMjNmOTQ2IDEwMDY0NAotLS0gYS9pbXRlc3QvaW10ZXN0LmMKKysrIGIvaW10
ZXN0L2ltdGVzdC5jCkBAIC0xNzgwLDcgKzE3ODAsNyBAQCBzdGF0aWMgaW50IGFwcGVuZF9tc2co
Y2hhciAqbWJveCwgaW50IHNpemUpCiB7CiAgICAgaW50IGx1cDsKICAgICAKLSAgICBwcm90X3By
aW50Zihwb3V0LCJBMDAzIEFQUEVORCAlcyAoXFxTZWVuKSB7JXV9XHJcbiIsbWJveCxzaXplK3N0
cmxlbihIRUFERVJTKSk7CisgICAgcHJvdF9wcmludGYocG91dCwiQTAwMyBBUFBFTkQgJXMgKFxc
U2VlbikgeyV6dX1cclxuIixtYm94LHNpemUrc3RybGVuKEhFQURFUlMpKTsKICAgICAvKiBkbyBu
b3JtYWwgaGVhZGVyIGZvbyAqLwogICAgIHByb3RfcHJpbnRmKHBvdXQsSEVBREVSUyk7CiAgICAg
CmRpZmYgLS1naXQgYS9saWIvcHJvdC5jIGIvbGliL3Byb3QuYwppbmRleCA4MzYzMWU1Li4zOTM3
MjVhIDEwMDY0NAotLS0gYS9saWIvcHJvdC5jCisrKyBiL2xpYi9wcm90LmMKQEAgLTg3Niw4ICs4
NzYsOCBAQCBpbnQgcHJvdF93cml0ZShzdHJ1Y3QgcHJvdHN0cmVhbSAqcywgY29uc3QgY2hhciAq
YnVmLCB1bnNpZ25lZCBsZW4pCiAKIC8qCiAgKiBTdHJpcHBlZC1kb3duIHZlcnNpb24gb2YgcHJp
bnRmKCkgdGhhdCB3b3JrcyBvbiBwcm90ZWN0aW9uIHN0cmVhbXMKLSAqIE9ubHkgdW5kZXJzdGFu
ZHMgJyVsbGQnLCAnJWxsdScsICclbGQnLCAnJWx1JywgJyVkJywgJXUnLCAnJXMnLAotICogJyVj
JywgYW5kICclJScgaW4gdGhlIGZvcm1hdCBzdHJpbmcuCisgKiBPbmx5IHVuZGVyc3RhbmRzICcl
bGxkJywgJyVsbHUnLCAnJWxkJywgJyVsdScsICclemQnLCAnJXp1JywKKyAqICclZCcsICV1Jywg
JyVzJywgJyVjJywgYW5kICclJScgaW4gdGhlIGZvcm1hdCBzdHJpbmcuCiAgKi8KIGludCBwcm90
X3ByaW50ZihzdHJ1Y3QgcHJvdHN0cmVhbSAqcywgY29uc3QgY2hhciAqZm10LCAuLi4pCiB7CkBA
IC05NDMsNiArOTQzLDI1IEBAIGludCBwcm90X3ByaW50ZihzdHJ1Y3QgcHJvdHN0cmVhbSAqcywg
Y29uc3QgY2hhciAqZm10LCAuLi4pCiAJICAgIH0KIAkgICAgYnJlYWs7CiAKKwljYXNlICd6JzoK
KwkgICAgc3dpdGNoICgqKytwZXJjZW50KSB7CisJICAgIGNhc2UgJ2QnOgorCQlsID0gdmFfYXJn
KHB2YXIsIHNzaXplX3QpOworCQlzbnByaW50ZihidWYsIHNpemVvZihidWYpLCAiJWxkIiwgbCk7
CisJCXByb3Rfd3JpdGUocywgYnVmLCBzdHJsZW4oYnVmKSk7CisJCWJyZWFrOworCisJICAgIGNh
c2UgJ3UnOgorCQl1bCA9IHZhX2FyZyhwdmFyLCBzaXplX3QpOworCQlzbnByaW50ZihidWYsIHNp
emVvZihidWYpLCAiJWx1IiwgdWwpOworCQlwcm90X3dyaXRlKHMsIGJ1Ziwgc3RybGVuKGJ1Zikp
OworCQlicmVhazsKKworCSAgICBkZWZhdWx0OgorCQlhYm9ydCgpOworCSAgICB9CisJICAgIGJy
ZWFrOworCiAJY2FzZSAnZCc6CiAJICAgIGkgPSB2YV9hcmcocHZhciwgaW50KTsKIAkgICAgc25w
cmludGYoYnVmLCBzaXplb2YoYnVmKSwgIiVkIiwgaSk7CmRpZmYgLS1naXQgYS90aW1zaWV2ZWQv
YWN0aW9ucy5jIGIvdGltc2lldmVkL2FjdGlvbnMuYwppbmRleCAyOTk2YzllLi41MDcwODg3IDEw
MDY0NAotLS0gYS90aW1zaWV2ZWQvYWN0aW9ucy5jCisrKyBiL3RpbXNpZXZlZC9hY3Rpb25zLmMK
QEAgLTM3Myw3ICszNzMsNyBAQCBpbnQgcHV0c2NyaXB0KHN0cnVjdCBwcm90c3RyZWFtICpjb25u
LCBteXN0cmluZ190ICpuYW1lLCBteXN0cmluZ190ICpkYXRhLAogCiAgIGlmIChyZXN1bHQgIT0g
VElNU0lFVkVfT0spIHsKICAgICAgIGlmIChlcnJzdHIgJiYgKmVycnN0cikgeyAKLQkgIHByb3Rf
cHJpbnRmKGNvbm4sICJOTyB7JWR9XHJcbiVzXHJcbiIsIHN0cmxlbihlcnJzdHIpLCBlcnJzdHIp
OworCSAgcHJvdF9wcmludGYoY29ubiwgIk5PIHslenV9XHJcbiVzXHJcbiIsIHN0cmxlbihlcnJz
dHIpLCBlcnJzdHIpOwogCSAgZnJlZShlcnJzdHIpOwogICAgICAgfSBlbHNlIHsKIAkgIGlmIChl
cnJzdHIpIGZyZWUoZXJyc3RyKTsK
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>977</attachid>
            <date>2008-01-08 16:27 EDT</date>
            <desc>Patch #2</desc>
            <filename>0002-Make-the-code-more-64-bit-clean.patch</filename>
            <type>text/plain</type>
            <size>12465</size>
            <attacher>gombasg@sztaki.hu</attacher>
            
              <data encoding="base64">RnJvbSAxNDUxMjFkOWI1YmZhMGQwM2JiYjE5YTdlZmMxNDQyOTM1OThjZTY5IE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiA9P3V0Zi04P3E/Rz1DMz1BMWJvcj0yMEdvbWI9QzM9QTFzPz0g
PGdvbWJhc2dAc3p0YWtpLmh1PgpEYXRlOiBTYXQsIDI5IERlYyAyMDA3IDE2OjQzOjE3ICswMTAw
ClN1YmplY3Q6IFtQQVRDSF0gTWFrZSB0aGUgY29kZSBtb3JlIDY0LWJpdCBjbGVhbi4KCkZpeCBi
dWdzIHdoZW4gdGhlIHZhcmlhYmxlIHNpemUgZXhwZWN0ZWQgYnkgdGhlIHByaW50ZiBmb3JtYXQg
YXJndW1lbnQKZG9lcyBub3QgbWF0Y2ggdGhlIHNpemUgb2YgdGhlIHZhcmlhYmxlIHRoYXQgaXMg
YWN0dWFsbHkgcGFzc2VkLgoKSXQgd291bGQgYmUgbmljZSB0byB1c2UgdGhlICJ6IiBtb2RpZmll
ciBmb3IgdGhlICpwcmludGYoKSBhcyB3ZWxsIGJ1dAp0aGF0J3Mgbm90IHBvcnRhYmxlLiBTbyB3
ZSBoYXZlIHRvIHVzZSBjYXN0cy4KLS0tCiBpbWFwL2Fubm90YXRlLmMgICAgICAgIHwgICAgNCAr
Ky0tCiBpbWFwL2RlbGl2ZXIuYyAgICAgICAgIHwgICAgMiArLQogaW1hcC9pbWFwZC5jICAgICAg
ICAgICB8ICAgIDYgKysrLS0tCiBpbWFwL2xtdHBlbmdpbmUuYyAgICAgIHwgICAgMiArLQogaW1h
cC9tYWlsYm94LmMgICAgICAgICB8ICAgIDQgKystLQogaW1hcC9tYm94bGlzdC5jICAgICAgICB8
ICAgIDYgKysrLS0tCiBpbWFwL21ib3huYW1lLmMgICAgICAgIHwgICAgNiArKystLS0KIGltYXAv
bWVzc2FnZS5jICAgICAgICAgfCAgICAyICstCiBpbWFwL25udHBkLmMgICAgICAgICAgIHwgICAg
NiArKystLS0KIGltYXAvc21tYXBkLmMgICAgICAgICAgfCAgICAyICstCiBsaWIvY3lydXNkYl9z
a2lwbGlzdC5jIHwgICAgNiArKystLS0KIGxpYi9saWJjb25maWcuYyAgICAgICAgfCAgICA0ICsr
LS0KIGxpYi9saWJjeXJfY2ZnLmMgICAgICAgfCAgICA0ICsrLS0KIDEzIGZpbGVzIGNoYW5nZWQs
IDI3IGluc2VydGlvbnMoKyksIDI3IGRlbGV0aW9ucygtKQoKZGlmZiAtLWdpdCBhL2ltYXAvYW5u
b3RhdGUuYyBiL2ltYXAvYW5ub3RhdGUuYwppbmRleCAxOTAzNmE5Li5hYjhkZWUxIDEwMDY0NAot
LS0gYS9pbWFwL2Fubm90YXRlLmMKKysrIGIvaW1hcC9hbm5vdGF0ZS5jCkBAIC01NjQsNyArNTY0
LDcgQEAgc3RhdGljIHZvaWQgb3V0cHV0X2VudHJ5YXR0KGNvbnN0IGNoYXIgKm1ib3huYW1lLCBj
b25zdCBjaGFyICplbnRyeSwKIAkvKiBCYXNlIHRoZSByZXR1cm4gb2YgdGhlIHNpemUgYXR0cmli
dXRlIG9uIHdoZXRoZXIgb3Igbm90IHRoZXJlIGlzCiAJICogYW4gYXR0cmlidXRlLCBub3Qgd2hl
dGhlciBzaXplIGlzIG5vbnplcm8uICovCiAJaWYgKChmZGF0YS0+YXR0cmlicyAmIEFUVFJJQl9T
SVpFX1NIQVJFRCkgJiYgYXR0cmliLT52YWx1ZSkgewotCSAgICBzbnByaW50ZihidWYsIHNpemVv
ZihidWYpLCAiJXUiLCBhdHRyaWItPnNpemUpOworCSAgICBzbnByaW50ZihidWYsIHNpemVvZihi
dWYpLCAiJXUiLCAodW5zaWduZWQpYXR0cmliLT5zaXplKTsKIAkgICAgYXBwZW5kYXR0dmFsdWUo
JmF0dHZhbHVlcywgInNpemUuc2hhcmVkIiwgYnVmKTsKIAl9CiAKQEAgLTU5MCw3ICs1OTAsNyBA
QCBzdGF0aWMgdm9pZCBvdXRwdXRfZW50cnlhdHQoY29uc3QgY2hhciAqbWJveG5hbWUsIGNvbnN0
IGNoYXIgKmVudHJ5LAogCS8qIEJhc2UgdGhlIHJldHVybiBvZiB0aGUgc2l6ZSBhdHRyaWJ1dGUg
b24gd2hldGhlciBvciBub3QgdGhlcmUgaXMKIAkgKiBhbiBhdHRyaWJ1dGUsIG5vdCB3aGV0aGVy
IHNpemUgaXMgbm9uemVyby4gKi8KIAlpZiAoKGZkYXRhLT5hdHRyaWJzICYgQVRUUklCX1NJWkVf
UFJJVikgJiYgYXR0cmliLT52YWx1ZSkgewotCSAgICBzbnByaW50ZihidWYsIHNpemVvZihidWYp
LCAiJXUiLCBhdHRyaWItPnNpemUpOworCSAgICBzbnByaW50ZihidWYsIHNpemVvZihidWYpLCAi
JXUiLCAodW5zaWduZWQpYXR0cmliLT5zaXplKTsKIAkgICAgYXBwZW5kYXR0dmFsdWUoJmF0dHZh
bHVlcywgInNpemUucHJpdiIsIGJ1Zik7CiAJfQogCmRpZmYgLS1naXQgYS9pbWFwL2RlbGl2ZXIu
YyBiL2ltYXAvZGVsaXZlci5jCmluZGV4IDk5NmQwNWIuLjI0MjJhNGMgMTAwNjQ0Ci0tLSBhL2lt
YXAvZGVsaXZlci5jCisrKyBiL2ltYXAvZGVsaXZlci5jCkBAIC0zMzksNyArMzM5LDcgQEAgc3Rh
dGljIGludCBkZWxpdmVyX21zZyhjaGFyICpyZXR1cm5fcGF0aCwgY2hhciAqYXV0aHVzZXIsIGlu
dCBpZ25vcmVxdW90YSwKIAkvKiBzZXR1cCBlYWNoIHJlY2lwaWVudCAqLwogCWZvciAoaiA9IDA7
IGogPCBudW11c2VyczsgaisrKSB7CiAJICAgIGlmIChtYWlsYm94KSB7Ci0JCXNpemVfdCB1bGVu
OworCQl1bnNpZ25lZCB1bGVuOwogCiAJCS8qIHdlIGxldCBpdCBsZWFrICEgKi8KIAkJdHhuLT5y
Y3B0W2pdLmFkZHIgPSAKZGlmZiAtLWdpdCBhL2ltYXAvaW1hcGQuYyBiL2ltYXAvaW1hcGQuYwpp
bmRleCA2ZGJhZDE3Li4yOGZlNzc3IDEwMDY0NAotLS0gYS9pbWFwL2ltYXBkLmMKKysrIGIvaW1h
cC9pbWFwZC5jCkBAIC01MDM3LDcgKzUwMzcsNyBAQCB2b2lkIGNtZF9kZWxldGUoY2hhciAqdGFn
LCBjaGFyICpuYW1lLCBpbnQgbG9jYWxvbmx5LCBpbnQgZm9yY2UpCiAgICAgaW50IG1idHlwZTsK
ICAgICBjaGFyICpzZXJ2ZXI7CiAgICAgY2hhciAqcDsKLSAgICBzaXplX3QgZG9tYWlubGVuID0g
MDsKKyAgICB1bnNpZ25lZCBkb21haW5sZW4gPSAwOwogCiAgICAgciA9ICgqaW1hcGRfbmFtZXNw
YWNlLm1ib3huYW1lX3RvaW50ZXJuYWwpKCZpbWFwZF9uYW1lc3BhY2UsIG5hbWUsCiAJCQkJCSAg
ICAgICBpbWFwZF91c2VyaWQsIG1haWxib3huYW1lKTsKQEAgLTU0NDUsNyArNTQ0NSw3IEBAIHZv
aWQgY21kX3JlbmFtZShjaGFyICp0YWcsIGNoYXIgKm9sZG5hbWUsIGNoYXIgKm5ld25hbWUsIGNo
YXIgKnBhcnRpdGlvbikKIAlzdHJjcHkob2xkdXNlciwgZG9tYWluID8gZG9tYWluKzYgOiBvbGRt
YWlsYm94bmFtZSs1KTsKIAlpZiAoZG9tYWluKQogCSAgICBzcHJpbnRmKG9sZHVzZXIrc3RybGVu
KG9sZHVzZXIpLCAiQCUuKnMiLAotCQkgICAgZG9tYWluIC0gb2xkbWFpbGJveG5hbWUsIG9sZG1h
aWxib3huYW1lKTsKKwkJICAgIChpbnQpKGRvbWFpbiAtIG9sZG1haWxib3huYW1lKSwgb2xkbWFp
bGJveG5hbWUpOwogCXN0cmNweShhY2xfb2xkdXNlciwgb2xkdXNlcik7CiAKIAkvKiBUcmFuc2xh
dGUgYW55IHNlcGFyYXRvcnMgaW4gc291cmNlIG9sZCB1c2VyaWQgKGZvciBBQ0xzKSAqLwpAQCAt
NTQ1Nyw3ICs1NDU3LDcgQEAgdm9pZCBjbWRfcmVuYW1lKGNoYXIgKnRhZywgY2hhciAqb2xkbmFt
ZSwgY2hhciAqbmV3bmFtZSwgY2hhciAqcGFydGl0aW9uKQogCXN0cmNweShuZXd1c2VyLCBkb21h
aW4gPyBkb21haW4rNiA6IG5ld21haWxib3huYW1lKzUpOwogCWlmIChkb21haW4pCiAJICAgIHNw
cmludGYobmV3dXNlcitzdHJsZW4obmV3dXNlciksICJAJS4qcyIsCi0JCSAgICBkb21haW4gLSBu
ZXdtYWlsYm94bmFtZSwgbmV3bWFpbGJveG5hbWUpOworCQkgICAgKGludCkoZG9tYWluIC0gbmV3
bWFpbGJveG5hbWUpLCBuZXdtYWlsYm94bmFtZSk7CiAJc3RyY3B5KGFjbF9uZXd1c2VyLCBuZXd1
c2VyKTsKIAogCS8qIFRyYW5zbGF0ZSBhbnkgc2VwYXJhdG9ycyBpbiBkZXN0aW5hdGlvbiBuZXcg
dXNlcmlkIChmb3IgQUNMcykgKi8KZGlmZiAtLWdpdCBhL2ltYXAvbG10cGVuZ2luZS5jIGIvaW1h
cC9sbXRwZW5naW5lLmMKaW5kZXggNmZkOGZiZC4uMjI3NzA2YSAxMDA2NDQKLS0tIGEvaW1hcC9s
bXRwZW5naW5lLmMKKysrIGIvaW1hcC9sbXRwZW5naW5lLmMKQEAgLTY5OSw3ICs2OTksNyBAQCBz
dGF0aWMgaW50IHNhdmVtc2coc3RydWN0IGNsaWVudGRhdGEgKmNkLAogIAogICAgIGZwcmludGYo
ZiwgIlJlY2VpdmVkOiAiKTsKICAgICBmb3IgKGkgPSAwLCBwID0gYWRkYm9keTsgaSA8IG5mb2xk
OyBwID0gZm9sZFtpXSwgaSsrKSB7Ci0JZnByaW50ZihmLCAiJS4qc1xyXG5cdCIsIGZvbGRbaV0g
LSBwLCBwKTsKKwlmcHJpbnRmKGYsICIlLipzXHJcblx0IiwgKGludCkoZm9sZFtpXSAtIHApLCBw
KTsKICAgICB9CiAgICAgZnByaW50ZihmLCAiJXNcclxuIiwgcCk7CiAgICAgc3Bvb2xfY2FjaGVf
aGVhZGVyKHhzdHJkdXAoIlJlY2VpdmVkIiksIGFkZGJvZHksIG0tPmhkcmNhY2hlKTsKZGlmZiAt
LWdpdCBhL2ltYXAvbWFpbGJveC5jIGIvaW1hcC9tYWlsYm94LmMKaW5kZXggNDY5MjQ0OS4uZmU1
YTA3MCAxMDA2NDQKLS0tIGEvaW1hcC9tYWlsYm94LmMKKysrIGIvaW1hcC9tYWlsYm94LmMKQEAg
LTE1OTksNyArMTU5OSw3IEBAIHN0YXRpYyB2b2lkIG1haWxib3hfdXBncmFkZV9pbmRleF93b3Jr
KHN0cnVjdCBtYWlsYm94ICptYWlsYm94LAogICAgICAgICBjaGFyICplcnIgPSB4bWFsbG9jKE1B
WF9NQUlMQk9YX05BTUUrMTI4KTsKICAgICAgICAgc25wcmludGYoZXJyLCBNQVhfTUFJTEJPWF9O
QU1FKzEyOCwKICAgICAgICAgICAgICAgICAgIk1haWxib3ggJXMgbmVlZHMgcmVjb25zdHJ1Y3Q6
IFJlY29yZCBzaXplICVkID4gJWQiLAotICAgICAgICAgICAgICAgICBtYWlsYm94LT5uYW1lLCBv
bGRyZWNvcmRfc2l6ZSwgSU5ERVhfUkVDT1JEX1NJWkUpOworICAgICAgICAgICAgICAgICBtYWls
Ym94LT5uYW1lLCAoaW50KW9sZHJlY29yZF9zaXplLCAoaW50KUlOREVYX1JFQ09SRF9TSVpFKTsK
ICAgICAgICAgZmF0YWwoZXJyLCBFQ19TT0ZUV0FSRSk7CiAgICAgfQogCkBAIC0xOTg4LDcgKzE5
ODgsNyBAQCBzdGF0aWMgaW50IHByb2Nlc3NfcmVjb3JkcyhzdHJ1Y3QgbWFpbGJveCAqbWFpbGJv
eCwgRklMRSAqbmV3aW5kZXgsCiAJCQkgICAiSU9FUlJPUjogcmVhZGluZyBjYWNoZSByZWNvcmQg
Zm9yICVzOiIKIAkJCSAgICIgZ290IGJvZ3VzIG9mZnNldCAlZCBmb3IgJXUvJWx1OyB0cnkgcmVj
b25zdHJ1Y3QiLAogCQkJICAgbWFpbGJveC0+bmFtZSwKLQkJCSAgIGNhY2hlaXRlbSAtIChtYWls
Ym94LT5jYWNoZV9iYXNlICsgY2FjaGVfb2Zmc2V0KSwKKwkJCSAgIChpbnQpKGNhY2hlaXRlbSAt
IChtYWlsYm94LT5jYWNoZV9iYXNlICsgY2FjaGVfb2Zmc2V0KSksCiAJCQkgICBtc2dubywgbWFp
bGJveC0+ZXhpc3RzKTsKIAkJICAgIHJldHVybiBJTUFQX0lPRVJST1I7CiAJCX0KZGlmZiAtLWdp
dCBhL2ltYXAvbWJveGxpc3QuYyBiL2ltYXAvbWJveGxpc3QuYwppbmRleCA5YWFlZDYxLi42MmUx
MDEyIDEwMDY0NAotLS0gYS9pbWFwL21ib3hsaXN0LmMKKysrIGIvaW1hcC9tYm94bGlzdC5jCkBA
IC01MDYsNyArNTA2LDcgQEAgbWJveGxpc3RfbXljcmVhdGVtYWlsYm94Y2hlY2soY2hhciAqbmFt
ZSwKIAkgICAgaWYgKG1ib3ggIT0gbmFtZSkgewogCQkvKiBhZGQgZG9tYWluIHRvIGlkZW50aWZp
ZXIgKi8KIAkJc3ByaW50ZihpZGVudGlmaWVyK3N0cmxlbihpZGVudGlmaWVyKSwKLQkJCSJAJS4q
cyIsIG1ib3ggLSBuYW1lIC0gMSwgbmFtZSk7CisJCQkiQCUuKnMiLCAoaW50KShtYm94IC0gbmFt
ZSAtIDEpLCBuYW1lKTsKIAkgICAgfQogCSAgICBjeXJ1c19hY2xfc2V0KCZhY2wsIGlkZW50aWZp
ZXIsIEFDTF9NT0RFX1NFVCwgQUNMX0FMTCwKIAkJICAgIChjeXJ1c19hY2xfY2Fub25wcm9jX3Qg
KikwLCAodm9pZCAqKTApOwpAQCAtMTU3MCw3ICsxNTcwLDcgQEAgaW50IG1ib3hsaXN0X3NldGFj
bChjb25zdCBjaGFyICpuYW1lLCBjb25zdCBjaGFyICppZGVudGlmaWVyLAogCQkhc3RyY21wKGlk
ZW50aWZpZXIsICJhbm9ueW1vdXMiKSB8fAogCQkhc3RyY21wKGlkZW50aWZpZXIsICJhbnlvbmUi
KSkgewogCQlzbnByaW50ZihpZGVudCwgc2l6ZW9mKGlkZW50KSwKLQkJCSAiJS4qcyIsIGNwIC0g
aWRlbnRpZmllciwgaWRlbnRpZmllcik7CisJCQkgIiUuKnMiLCAoaW50KShjcCAtIGlkZW50aWZp
ZXIpLCBpZGVudGlmaWVyKTsKIAkgICAgfSBlbHNlIHsKIAkJc3RybGNweShpZGVudCwgaWRlbnRp
Zmllciwgc2l6ZW9mKGlkZW50KSk7CiAJICAgIH0KQEAgLTIxNjksNyArMjE2OSw3IEBAIGludCBt
Ym94bGlzdF9maW5kYWxsKHN0cnVjdCBuYW1lc3BhY2UgKm5hbWVzcGFjZSBfX2F0dHJpYnV0ZV9f
KCh1bnVzZWQpKSwKIAkJZG9tYWlubGVuID0gc3RybGVuKHApOwogCSAgICB9CiAJICAgIHNucHJp
bnRmKGRvbWFpbnBhdCtkb21haW5sZW4sIHNpemVvZihkb21haW5wYXQpLWRvbWFpbmxlbiwKLQkJ
ICAgICAiJS4qcyIsIHAgLSBwYXR0ZXJuLCBwYXR0ZXJuKTsKKwkJICAgICAiJS4qcyIsIChpbnQp
KHAgLSBwYXR0ZXJuKSwgcGF0dGVybik7CiAJfQogICAgIH0KIApkaWZmIC0tZ2l0IGEvaW1hcC9t
Ym94bmFtZS5jIGIvaW1hcC9tYm94bmFtZS5jCmluZGV4IGJjOGE3YjAuLmU2ZTc2ZDYgMTAwNjQ0
Ci0tLSBhL2ltYXAvbWJveG5hbWUuYworKysgYi9pbWFwL21ib3huYW1lLmMKQEAgLTM3Niw3ICsz
NzYsNyBAQCBzdGF0aWMgaW50IG1ib3huYW1lX3RvZXh0ZXJuYWwoc3RydWN0IG5hbWVzcGFjZSAq
bmFtZXNwYWNlLCBjb25zdCBjaGFyICpuYW1lLAogCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JB
RE5BTUU7CiAKIAlzbnByaW50ZihyZXN1bHQrcmVzdWx0bGVuLCBNQVhfTUFJTEJPWF9OQU1FKzEt
cmVzdWx0bGVuLCAKLQkJICJAJS4qcyIsIGRvbWFpbmxlbiwgZG9tYWluKTsKKwkJICJAJS4qcyIs
IChpbnQpZG9tYWlubGVuLCBkb21haW4pOwogICAgIH0KIAogICAgIHJldHVybiAwOwpAQCAtNDM5
LDcgKzQzOSw3IEBAIHN0YXRpYyBpbnQgbWJveG5hbWVfdG9leHRlcm5hbF9hbHQoc3RydWN0IG5h
bWVzcGFjZSAqbmFtZXNwYWNlLCBjb25zdCBjaGFyICpuYW1lCiAJICAgIHJldHVybiBJTUFQX01B
SUxCT1hfQkFETkFNRTsKIAogCXNwcmludGYocmVzdWx0LCAiJS4qcyIsCi0JCXByZWZpeGxlbi0x
LCBuYW1lc3BhY2UtPnByZWZpeFtOQU1FU1BBQ0VfVVNFUl0pOworCQkoaW50KXByZWZpeGxlbi0x
LCBuYW1lc3BhY2UtPnByZWZpeFtOQU1FU1BBQ0VfVVNFUl0pOwogCXJlc3VsdGxlbiA9IHN0cmxl
bihyZXN1bHQpOwogCWlmIChuYW1lWzRdID09ICcuJykgewogCSAgICBzcHJpbnRmKHJlc3VsdCty
ZXN1bHRsZW4sICIlYyVzIiwgbmFtZXNwYWNlLT5oaWVyX3NlcCwgbmFtZSs1KTsKQEAgLTY2NSw3
ICs2NjUsNyBAQCBjaGFyICptYm94bmFtZV9pbmJveF90b3VzZXJpZChjb25zdCBjaGFyICppbmJv
eG5hbWUpCiAgICAgaWYgKGRvbWFpbikgewogCS8qIGFwcGVuZCBkb21haW4gKi8KIAlzcHJpbnRm
KHVzZXJpZCtzdHJsZW4odXNlcmlkKSwgIkAlLipzIiwKLQkJZG9tYWlubGVuLCBkb21haW4pOwor
CQkoaW50KWRvbWFpbmxlbiwgZG9tYWluKTsKICAgICB9CiAKICAgICByZXR1cm4odXNlcmlkKTsK
ZGlmZiAtLWdpdCBhL2ltYXAvbWVzc2FnZS5jIGIvaW1hcC9tZXNzYWdlLmMKaW5kZXggMmMyODVk
NS4uMGJiZTEyMSAxMDA2NDQKLS0tIGEvaW1hcC9tZXNzYWdlLmMKKysrIGIvaW1hcC9tZXNzYWdl
LmMKQEAgLTIyOTQsNyArMjI5NCw3IEBAIGNoYXIgKnM7CiAgICAgaWYgKCpwIHx8IGxlbiA+PSAx
MDI0KSB7CiAJLyogV3JpdGUgb3V0IGFzIGxpdGVyYWwgKi8KIAljaGFyIGJ1ZlsxMDBdOwotCXNu
cHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1ZiksICJ7JXV9XHJcbiIsIHN0cmxlbihzKSk7CisJc25wcmlu
dGYoYnVmLCBzaXplb2YoYnVmKSwgInsldX1cclxuIiwgKHVuc2lnbmVkKXN0cmxlbihzKSk7CiAJ
bWVzc2FnZV9pYnVmX2Vuc3VyZShpYnVmLCBzdHJsZW4ocykrc3RybGVuKGJ1ZikpOwogCWZvciAo
cCA9IGJ1ZjsgKnA7IHArKykgKihpYnVmLT5lbmQpKysgPSAqcDsKIAlmb3IgKHAgPSBzOyAqcDsg
cCsrKSAqKGlidWYtPmVuZCkrKyA9ICpwOwpkaWZmIC0tZ2l0IGEvaW1hcC9ubnRwZC5jIGIvaW1h
cC9ubnRwZC5jCmluZGV4IDljM2IyOWUuLjA2ZDU1MDggMTAwNjQ0Ci0tLSBhL2ltYXAvbm50cGQu
YworKysgYi9pbWFwL25udHBkLmMKQEAgLTI4ODAsNyArMjg4MCw3IEBAIHN0YXRpYyBpbnQgcGFy
c2VfZ3JvdXBzKGNvbnN0IGNoYXIgKmdyb3VwcywgbWVzc2FnZV9kYXRhX3QgKm1zZykKIHsKICAg
ICBjb25zdCBjaGFyICpwOwogICAgIGNoYXIgKnJjcHQgPSBOVUxMOwotICAgIHNpemVfdCBuOwor
ICAgIHVuc2lnbmVkIG47CiAKICAgICBmb3IgKHAgPSBncm91cHM7OyBwICs9IG4pIHsKIAkvKiBz
a2lwIHdoaXRlc3BhY2UgKi8KQEAgLTMwMjUsNyArMzAyNSw3IEBAIHN0YXRpYyBpbnQgc2F2ZW1z
ZyhtZXNzYWdlX2RhdGFfdCAqbSwgRklMRSAqZikKIAkJaWYgKGJvZHkgfHwgbmV3c3Bvc3R1c2Vy
KSB7CiAJCSAgICBjb25zdCBjaGFyICoqcG9zdHRvLCAqcDsKIAkJICAgIGNoYXIgKnJlcGx5dG8s
ICpyLCAqZm9sZCA9IE5VTEwsICpzZXAgPSAiIjsKLQkJICAgIHNpemVfdCBuOworCQkgICAgdW5z
aWduZWQgbjsKIAogCQkgICAgaWYgKG5ld3Nwb3N0dXNlcikgewogCQkJLyogYWRkICJwb3N0IiBl
bWFpbCBhZGRyZXNzZXMgYmFzZWQgb24gbmV3c2dyb3VwICovCkBAIC0zMDg4LDcgKzMwODgsNyBA
QCBzdGF0aWMgaW50IHNhdmVtc2cobWVzc2FnZV9kYXRhX3QgKm0sIEZJTEUgKmYpCiAJCSAgICBm
cHJpbnRmKGYsICJSZXBseS1UbzogIik7CiAJCSAgICByID0gcmVwbHl0bzsKIAkJICAgIGlmIChm
b2xkKSB7Ci0JCQlmcHJpbnRmKGYsICIlLipzXHJcblx0IiwgZm9sZCAtIHIsIHIpOworCQkJZnBy
aW50ZihmLCAiJS4qc1xyXG5cdCIsIChpbnQpKGZvbGQgLSByKSwgcik7CiAJCQlyID0gZm9sZDsK
IAkJICAgIH0KIAkJICAgIGZwcmludGYoZiwgIiVzXHJcbiIsIHIpOwpkaWZmIC0tZ2l0IGEvaW1h
cC9zbW1hcGQuYyBiL2ltYXAvc21tYXBkLmMKaW5kZXggZmVhZDdmYy4uOWQ2MDM3ZCAxMDA2NDQK
LS0tIGEvaW1hcC9zbW1hcGQuYworKysgYi9pbWFwL3NtbWFwZC5jCkBAIC0zNTMsNyArMzUzLDcg
QEAgaW50IHZlcmlmeV91c2VyKGNvbnN0IGNoYXIgKmtleSwgbG9uZyBxdW90YWNoZWNrLAogICAg
ICAgICAgICAgICAgcmV0dXJuIHI7CiAgICAgICAgICAgICB9CiAKLSAgICAgICAgICAgIHNwcmlu
dGYoYnVmLCIlZDpjeXJ1cyAlcywlYyIsc3RybGVuKGtleSkrNixrZXksNCk7CisgICAgICAgICAg
ICBzcHJpbnRmKGJ1ZiwiJWQ6Y3lydXMgJXMsJWMiLChpbnQpc3RybGVuKGtleSkrNixrZXksNCk7
CiAgICAgICAgICAgICBzZW5kdG8oc29jLGJ1ZixzdHJsZW4oYnVmKSwwLChzdHJ1Y3Qgc29ja2Fk
ZHIgKikmc2luLHNpemVvZihzaW4pKTsKIAogICAgICAgICAgICAgeCA9IHNpemVvZihzZnJvbSk7
CmRpZmYgLS1naXQgYS9saWIvY3lydXNkYl9za2lwbGlzdC5jIGIvbGliL2N5cnVzZGJfc2tpcGxp
c3QuYwppbmRleCBlOWU3ZjMwLi4wNjZkNThmIDEwMDY0NAotLS0gYS9saWIvY3lydXNkYl9za2lw
bGlzdC5jCisrKyBiL2xpYi9jeXJ1c2RiX3NraXBsaXN0LmMKQEAgLTE3NjksNyArMTc2OSw3IEBA
IHN0YXRpYyBpbnQgZHVtcChzdHJ1Y3QgZGIgKmRiLCBpbnQgZGV0YWlsIF9fYXR0cmlidXRlX18o
KHVudXNlZCkpKQogICAgIHB0ciA9IGRiLT5tYXBfYmFzZSArIERVTU1ZX09GRlNFVChkYik7CiAg
ICAgZW5kID0gZGItPm1hcF9iYXNlICsgZGItPm1hcF9zaXplOwogICAgIHdoaWxlIChwdHIgPCBl
bmQpIHsKLQlwcmludGYoIiUwNFg6ICIsIHB0ciAtIGRiLT5tYXBfYmFzZSk7CisJcHJpbnRmKCIl
MDRYOiAiLCAodW5zaWduZWQgaW50KShwdHIgLSBkYi0+bWFwX2Jhc2UpKTsKIAlzd2l0Y2ggKFRZ
UEUocHRyKSkgewogCWNhc2UgRFVNTVk6CiAJICAgIHByaW50ZigiRFVNTVkgIik7CkBAIC0xODQ0
LDcgKzE4NDQsNyBAQCBzdGF0aWMgaW50IG15Y29uc2lzdGVudChzdHJ1Y3QgZGIgKmRiLCBzdHJ1
Y3QgdHhuICp0aWQsIGludCBsb2NrZWQpCiAJCWZwcmludGYoc3Rkb3V0LCAKIAkJCSJza2lwbGlz
dCBpbmNvbnNpc3RlbnQ6ICUwNFg6IHB0ciAlZCBpcyAlMDRYOyAiCiAJCQkiZW9mIGlzICUwNFhc
biIsIAotCQkJcHRyIC0gZGItPm1hcF9iYXNlLAorCQkJKHVuc2lnbmVkIGludCkgKHB0ciAtIGRi
LT5tYXBfYmFzZSksCiAJCQlpLCBvZmZzZXQsICh1bnNpZ25lZCBpbnQpIGRiLT5tYXBfc2l6ZSk7
CiAJCXJldHVybiBDWVJVU0RCX0lOVEVSTkFMOwogCSAgICB9CkBAIC0xODU5LDcgKzE4NTksNyBA
QCBzdGF0aWMgaW50IG15Y29uc2lzdGVudChzdHJ1Y3QgZGIgKmRiLCBzdHJ1Y3QgdHhuICp0aWQs
IGludCBsb2NrZWQpCiAJCSAgICBmcHJpbnRmKHN0ZG91dCwgCiAJCQkgICAgInNraXBsaXN0IGlu
Y29uc2lzdGVudDogJTA0WDogcHRyICVkIGlzICUwNFg7ICIKIAkJCSAgICAiZGItPmNvbXBhcigp
ID0gJWRcbiIsIAotCQkJICAgIHB0ciAtIGRiLT5tYXBfYmFzZSwKKwkJCSAgICAodW5zaWduZWQg
aW50KSAocHRyIC0gZGItPm1hcF9iYXNlKSwKIAkJCSAgICBpLAogCQkJICAgIG9mZnNldCwgY21w
KTsKIAkJICAgIHJldHVybiBDWVJVU0RCX0lOVEVSTkFMOwpkaWZmIC0tZ2l0IGEvbGliL2xpYmNv
bmZpZy5jIGIvbGliL2xpYmNvbmZpZy5jCmluZGV4IDM4NDczMjEuLjI3ZWYzOGQgMTAwNjQ0Ci0t
LSBhL2xpYi9saWJjb25maWcuYworKysgYi9saWIvbGliY29uZmlnLmMKQEAgLTEwMiw3ICsxMDIs
NyBAQCBpbnQgY29uZmlnX2dldGludChlbnVtIGltYXBvcHQgb3B0KQogI2lmIChTSVpFT0ZfTE9O
RyAhPSA0KQogICAgIGlmICgoaW1hcG9wdHNbb3B0XS52YWwuaSA+IDB4N2ZmZmZmZmYpfHwKIAko
aW1hcG9wdHNbb3B0XS52YWwuaSA8IC0weDdmZmZmZmZmKSkgewotCXN5c2xvZyhMT0dfRVJSLCAi
Y29uZmlnX2dldGludDogJXM6ICVsbGQgdG9vIGxhcmdlIGZvciB0eXBlIiwKKwlzeXNsb2coTE9H
X0VSUiwgImNvbmZpZ19nZXRpbnQ6ICVzOiAlbGQgdG9vIGxhcmdlIGZvciB0eXBlIiwKIAkgICAg
ICAgaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBpbWFwb3B0c1tvcHRdLnZhbC5pKTsKICAgICB9CiAj
ZW5kaWYgICAgCkBAIC0xMTYsNyArMTE2LDcgQEAgaW50IGNvbmZpZ19nZXRzd2l0Y2goZW51bSBp
bWFwb3B0IG9wdCkKICNpZiAoU0laRU9GX0xPTkcgIT0gNCkKICAgICBpZiAoKGltYXBvcHRzW29w
dF0udmFsLmIgPiAweDdmZmZmZmZmKXx8CiAJKGltYXBvcHRzW29wdF0udmFsLmIgPCAtMHg3ZmZm
ZmZmZikpIHsKLQlzeXNsb2coTE9HX0VSUiwgImNvbmZpZ19nZXRzd2l0Y2g6ICVzOiAlbGxkIHRv
byBsYXJnZSBmb3IgdHlwZSIsIAorCXN5c2xvZyhMT0dfRVJSLCAiY29uZmlnX2dldHN3aXRjaDog
JXM6ICVsZCB0b28gbGFyZ2UgZm9yIHR5cGUiLCAKIAkgICAgICAgaW1hcG9wdHNbb3B0XS5vcHRu
YW1lLCBpbWFwb3B0c1tvcHRdLnZhbC5iKTsKICAgICB9CiAjZW5kaWYgICAgCmRpZmYgLS1naXQg
YS9saWIvbGliY3lyX2NmZy5jIGIvbGliL2xpYmN5cl9jZmcuYwppbmRleCAzODQxMjhhLi4zYWY0
NzMxIDEwMDY0NAotLS0gYS9saWIvbGliY3lyX2NmZy5jCisrKyBiL2xpYi9saWJjeXJfY2ZnLmMK
QEAgLTE0Niw3ICsxNDYsNyBAQCBpbnQgbGliY3lydXNfY29uZmlnX2dldGludChlbnVtIGN5cnVz
X29wdCBvcHQpCiAgICAgYXNzZXJ0KGN5cnVzX29wdGlvbnNbb3B0XS50ID09IENZUlVTX09QVF9J
TlQpOwogI2lmIChTSVpFT0ZfTE9ORyAhPSA0KQogICAgIGlmICgoY3lydXNfb3B0aW9uc1tvcHRd
LnZhbC5pID4gMHg3ZmZmZmZmZil8fChjeXJ1c19vcHRpb25zW29wdF0udmFsLmkgPCAtMHg3ZmZm
ZmZmZikpIHsKLQlzeXNsb2coTE9HX0VSUiwgImxpYmN5cnVzX2NvbmZpZ19nZXRpbnQ6IG9wdGlv
biAlZDogJWxsZCB0b28gbGFyZ2UgZm9yIHR5cGUiLCBjeXJ1c19vcHRpb25zW29wdF0ub3B0LCBj
eXJ1c19vcHRpb25zW29wdF0udmFsLmkpOworCXN5c2xvZyhMT0dfRVJSLCAibGliY3lydXNfY29u
ZmlnX2dldGludDogb3B0aW9uICVkOiAlbGQgdG9vIGxhcmdlIGZvciB0eXBlIiwgY3lydXNfb3B0
aW9uc1tvcHRdLm9wdCwgY3lydXNfb3B0aW9uc1tvcHRdLnZhbC5pKTsKICAgICB9CiAjZW5kaWYg
ICAgCiAgICAgcmV0dXJuIGN5cnVzX29wdGlvbnNbb3B0XS52YWwuaTsKQEAgLTE1OSw3ICsxNTks
NyBAQCBpbnQgbGliY3lydXNfY29uZmlnX2dldHN3aXRjaChlbnVtIGN5cnVzX29wdCBvcHQpCiAg
ICAgYXNzZXJ0KGN5cnVzX29wdGlvbnNbb3B0XS50ID09IENZUlVTX09QVF9TV0lUQ0gpOwogI2lm
IChTSVpFT0ZfTE9ORyAhPSA0KQogICAgIGlmICgoY3lydXNfb3B0aW9uc1tvcHRdLnZhbC5iID4g
MHg3ZmZmZmZmZil8fChjeXJ1c19vcHRpb25zW29wdF0udmFsLmIgPCAtMHg3ZmZmZmZmZikpIHsK
LQlzeXNsb2coTE9HX0VSUiwgImxpYmN5cnVzX2NvbmZpZ19nZXRzd2l0Y2g6IG9wdGlvbiAlZDog
JWxsZCB0b28gbGFyZ2UgZm9yIHR5cGUiLCBjeXJ1c19vcHRpb25zW29wdF0ub3B0LCBjeXJ1c19v
cHRpb25zW29wdF0udmFsLmIpOworCXN5c2xvZyhMT0dfRVJSLCAibGliY3lydXNfY29uZmlnX2dl
dHN3aXRjaDogb3B0aW9uICVkOiAlbGQgdG9vIGxhcmdlIGZvciB0eXBlIiwgY3lydXNfb3B0aW9u
c1tvcHRdLm9wdCwgY3lydXNfb3B0aW9uc1tvcHRdLnZhbC5iKTsKICAgICB9CiAjZW5kaWYgICAg
CiAgICAgcmV0dXJuIGN5cnVzX29wdGlvbnNbb3B0XS52YWwuYjsK
</data>        

          </attachment>
      

    </bug>

</bugzilla>