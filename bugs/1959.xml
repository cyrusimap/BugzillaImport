<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>1959</bug_id>
          
          <creation_ts>2003-03-19 12:18 EDT</creation_ts>
          <short_desc>SASL needs strcpy, strcat, sprintf -&gt; strlcpy, strlcat, snprintf</short_desc>
          <delta_ts>2012-06-11 07:34:52 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus SASL</product>
          <component>SASL</component>
          <version>2.1.x</version>
          <rep_platform>Other</rep_platform>
          <op_sys>other</op_sys>
          <bug_status>NEW</bug_status>
          
          
          
          
          
          <priority>P3</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Rob Siemborski">rjs3@andrew.cmu.edu</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          <cc>Alexey.Melnikov@isode.com</cc>
          <qa_contact name="The Cyrus Bugzilla List">cyrus-bugzilla@lists.andrew.cmu.edu</qa_contact>

      

      

      
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-03-19 12:18:07 EDT</bug_when>
            <thetext>These are safer.  we probably want to use _sasl_* versions for portability</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">ken@oceana.com</who>
            <bug_when>2003-06-27 14:02:29 EDT</bug_when>
            <thetext>Created an attachment (id=196)
strcpy(), strcat(), sprintf() patch

patch to convert strcpy(), strcat() and sprintf() to strlcpy(), strlcat(),
snprintf() when used on a static buffer</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-07-23 13:09:00 EDT</bug_when>
            <thetext>oops, didn&apos;t realize work had been done on this.

saslauthd has a significant amount of this done.

I don&apos;t think the patch is fully correct for the plugins, since you can&apos;t call
into the main library.  I suspect we&apos;ll need to write the replacements into
plugin_common in addition to being in strlcat(cpy).c</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Derrick">shadow@andrew.cmu.edu</who>
            <bug_when>2005-04-11 01:18:43 EDT</bug_when>
            <thetext>Does it make sense to inline these? Probably not. While I find the practice sort of vile, what about putting 
the code in a header and then including it in one library file and in plugin_common.c?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2005-04-11 01:24:51 EDT</bug_when>
            <thetext>I do not believe there is a strong reason to inline them.

It&apos;d be nicer to find a way to just make them link correctly.  Note that we
almost certainly want to ensure that these symbols don&apos;t get imported by
whatever the calling program is (so we probably want to have _sasl_foo symbols).</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>196</attachid>
            <date>2003-06-27 14:02 EDT</date>
            <desc>strcpy(), strcat(), sprintf() patch</desc>
            <filename>strlcpy.patch</filename>
            <type>text/plain</type>
            <size>33586</size>
            <attacher>ken@oceana.com</attacher>
            
              <data encoding="base64">SW5kZXg6IGFjY29uZmlnLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVt
L2N2cy9zcmMvc2FzbC9hY2NvbmZpZy5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjQ1CmRpZmYg
LXUgLXIxLjQ1IGFjY29uZmlnLmgKLS0tIGFjY29uZmlnLmgJMTUgQXByIDIwMDMgMTY6MjQ6MDQg
LTAwMDAJMS40NQorKysgYWNjb25maWcuaAkyNyBKdW4gMjAwMyAxNzo1ODo1MSAtMDAwMApAQCAt
MTIxLDYgKzEyMSwxMiBAQAogLyogRG9lcyB5b3VyIHN5c3RlbSBoYXZlIHRoZSB2c25wcmludGYo
KSBjYWxsPyAqLwogI3VuZGVmIEhBVkVfVlNOUFJJTlRGCiAKKy8qIERvZXMgeW91ciBzeXN0ZW0g
aGF2ZSB0aGUgc3RybGNweSgpIGNhbGw/ICovCisjdW5kZWYgSEFWRV9TVFJMQ1BZCisKKy8qIERv
ZXMgeW91ciBzeXN0ZW0gaGF2ZSB0aGUgc3RybGNhdCgpIGNhbGw/ICovCisjdW5kZWYgSEFWRV9T
VFJMQ0FUCisKIC8qIGRvZXMgeW91ciBzeXN0ZW0gaGF2ZSBnZXR0aW1lb2ZkYXkoKT8gKi8KICN1
bmRlZiBIQVZFX0dFVFRJTUVPRkRBWQogCkBAIC0zMjMsNiArMzI5LDE2IEBACiAjIGVsc2UKICMg
IGluY2x1ZGUgPHRpbWUuaD4KICMgZW5kaWYKKyNlbmRpZgorCisjaWZuZGVmIEhBVkVfU1RSTENQ
WQorI2RlZmluZSBzdHJsY3B5KHgseSx6KSBzYXNsX3N0cmxjcHkoKHgpLCh5KSwoeikpCitzaXpl
X3Qgc2FzbF9zdHJsY3B5KGNoYXIgKmRzdCwgY29uc3QgY2hhciAqc3JjLCBzaXplX3QgZHN0c2l6
ZSk7CisjZW5kaWYKKworI2lmbmRlZiBIQVZFX1NUUkxDQVQKKyNkZWZpbmUgc3RybGNhdCh4LHks
eikgc2FzbF9zdHJsY2F0KCh4KSwoeSksKHopKQorc2l6ZV90IHNhc2xfc3RybGNhdChjaGFyICpk
c3QsIGNvbnN0IGNoYXIgKnNyYywgc2l6ZV90IGRzdHNpemUpOwogI2VuZGlmCiAKICNlbmRpZiAv
KiBDT05GSUdfSCAqLwpJbmRleDogY29uZmlndXJlLmluCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9h
ZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3Nhc2wvY29uZmlndXJlLmluLHYKcmV0cmlldmluZyBy
ZXZpc2lvbiAxLjE2NQpkaWZmIC11IC1yMS4xNjUgY29uZmlndXJlLmluCi0tLSBjb25maWd1cmUu
aW4JMjYgSnVuIDIwMDMgMTQ6MjI6MDAgLTAwMDAJMS4xNjUKKysrIGNvbmZpZ3VyZS5pbgkyNyBK
dW4gMjAwMyAxNzo1ODo1MSAtMDAwMApAQCAtNzgzLDYgKzc4MywzMCBAQAogQUNfU1VCU1QoU05Q
UklOVEZPQkpTKQogQUNfU1VCU1QoTFRTTlBSSU5URk9CSlMpCiAKK2RubCBDaGVjayBmb3Igc3Ry
bGNweQorc2FzbF9jdl9zdHJsY3B5PW5vCitTVFJMQ1BZT0JKUz0iIgorQUNfQ0hFQ0tfRlVOQyhz
dHJsY3B5LCBbQUNfREVGSU5FKEhBVkVfU1RSTENQWSldLCBbc2FzbF9jdl9zdHJsY3B5PXllc10p
CitpZiB0ZXN0ICRzYXNsX2N2X3N0cmxjcHkgPSB5ZXM7IHRoZW4KKwlMSUJPQkpTPSIkTElCT0JK
UyBzdHJsY3B5Lm8iCisgICAgICAgIFNUUkxDUFlPQkpTPSJzdHJsY3B5Lm8iCisgICAgICAgIExU
U1RSTENQWU9CSlM9InN0cmxjcHkubG8iCitmaQorQUNfU1VCU1QoU1RSTENQWU9CSlMpCitBQ19T
VUJTVChMVFNUUkxDUFlPQkpTKQorCitkbmwgQ2hlY2sgZm9yIHN0cmxjYXQKK3Nhc2xfY3Zfc3Ry
bGNhdD1ubworU1RSTENBVE9CSlM9IiIKK0FDX0NIRUNLX0ZVTkMoc3RybGNhdCwgW0FDX0RFRklO
RShIQVZFX1NUUkxDQVQpXSwgW3Nhc2xfY3Zfc3RybGNhdD15ZXNdKQoraWYgdGVzdCAkc2FzbF9j
dl9zdHJsY2F0ID0geWVzOyB0aGVuCisJTElCT0JKUz0iJExJQk9CSlMgc3RybGNhdC5vIgorICAg
ICAgICBTVFJMQ0FUT0JKUz0ic3RybGNhdC5vIgorICAgICAgICBMVFNUUkxDQVRPQkpTPSJzdHJs
Y2F0LmxvIgorZmkKK0FDX1NVQlNUKFNUUkxDQVRPQkpTKQorQUNfU1VCU1QoTFRTVFJMQ0FUT0JK
UykKKwogZG5sIGRvIHdlIG5lZWQgdG8gbGluayBpbiAtbHJlc29sdj8KIEFDX0NIRUNLX0xJQihy
ZXNvbHYsIGluZXRfYXRvbikKIApJbmRleDogbGliL2F1eHByb3AuYwo9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBm
aWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zYXNsL2xpYi9hdXhwcm9wLmMsdgpyZXRy
aWV2aW5nIHJldmlzaW9uIDEuMTAKZGlmZiAtdSAtcjEuMTAgYXV4cHJvcC5jCi0tLSBsaWIvYXV4
cHJvcC5jCTE5IE1hciAyMDAzIDE4OjI1OjI3IC0wMDAwCTEuMTAKKysrIGxpYi9hdXhwcm9wLmMJ
MjcgSnVuIDIwMDMgMTc6NTg6NTIgLTAwMDAKQEAgLTUwMSw3ICs1MDEsNyBAQAogCX0gZWxzZSB7
CiAJICAgIGZsYWcgPSAxOwogCX0KLQlzdHJjYXQob3V0YnVmLCB2YWwtPm5hbWUpOworCXN0cmxj
YXQob3V0YnVmLCB2YWwtPm5hbWUsIG91dG1heCk7CiAgICAgfQogICAgIAogICAgIHJldHVybiBT
QVNMX09LOwpJbmRleDogbGliL2NoZWNrcHcuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2Fu
ZHJldy9zeXN0ZW0vY3ZzL3NyYy9zYXNsL2xpYi9jaGVja3B3LmMsdgpyZXRyaWV2aW5nIHJldmlz
aW9uIDEuNjIKZGlmZiAtdSAtcjEuNjIgY2hlY2twdy5jCi0tLSBsaWIvY2hlY2twdy5jCTE5IE1h
ciAyMDAzIDE4OjI1OjI3IC0wMDAwCTEuNjIKKysrIGxpYi9jaGVja3B3LmMJMjcgSnVuIDIwMDMg
MTc6NTg6NTMgLTAwMDAKQEAgLTI3Miw3ICsyNzIsNyBAQAogCiAgICAgLyogY29udmVydCBkaWdl
c3QgZnJvbSBiaW5hcnkgdG8gQVNDSUkgaGV4ICovCiAgICAgZm9yIChpID0gMDsgaSA8IDE2OyBp
KyspCi0gICAgICBzcHJpbnRmKGRpZ2VzdHN0ciArIChpKjIpLCAiJTAyeCIsIGRpZ2VzdFtpXSk7
CisgICAgICBzbnByaW50ZihkaWdlc3RzdHIgKyAoaSoyKSwgc2l6ZW9mKGRpZ2VzdHN0ciktKGkq
MiksICIlMDJ4IiwgZGlnZXN0W2ldKTsKIAogICAgIGlmICghc3RybmNhc2VjbXAoZGlnZXN0c3Ry
LCByZXNwb25zZSwgMzIpKSB7CiAgICAgICAvKiBwYXNzd29yZCB2ZXJpZmllZCEgKi8KQEAgLTM2
OSw4ICszNjksOCBAQAogCiAgICAgaWYgKHN0cmxlbihQV0NIRUNLRElSKSs4KzEgPiBzaXplb2Yo
cHdwYXRoKSkgcmV0dXJuIFNBU0xfRkFJTDsKIAotICAgIHN0cmNweShwd3BhdGgsIFBXQ0hFQ0tE
SVIpOwotICAgIHN0cmNhdChwd3BhdGgsICIvcHdjaGVjayIpOworICAgIHN0cmxjcHkocHdwYXRo
LCBQV0NIRUNLRElSLCBzaXplb2YocHdwYXRoKSk7CisgICAgc3RybGNhdChwd3BhdGgsICIvcHdj
aGVjayIsIHNpemVvZihwd3BhdGgpKTsKIAogICAgIHMgPSBzb2NrZXQoQUZfVU5JWCwgU09DS19T
VFJFQU0sIDApOwogICAgIGlmIChzID09IC0xKSByZXR1cm4gZXJybm87CkBAIC00NzEsOCArNDcx
LDggQEAKIAlpZiAoc3RybGVuKFBBVEhfU0FTTEFVVEhEX1JVTkRJUikgKyA0ICsgMSA+IHNpemVv
Zihwd3BhdGgpKQogCSAgICByZXR1cm4gU0FTTF9GQUlMOwogCi0Jc3RyY3B5KHB3cGF0aCwgUEFU
SF9TQVNMQVVUSERfUlVORElSKTsKLQlzdHJjYXQocHdwYXRoLCAiL211eCIpOworCXN0cmxjcHko
cHdwYXRoLCBQQVRIX1NBU0xBVVRIRF9SVU5ESVIsIHNpemVvZihwd3BhdGgpKTsKKwlzdHJsY2F0
KHB3cGF0aCwgIi9tdXgiLCBzaXplb2YocHdwYXRoKSk7CiAgICAgfQogCiAgICAgLyoKSW5kZXg6
IGxpYi9jb21tb24uYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3Zz
L3NyYy9zYXNsL2xpYi9jb21tb24uYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS45MgpkaWZmIC11
IC1yMS45MiBjb21tb24uYwotLS0gbGliL2NvbW1vbi5jCTE2IEFwciAyMDAzIDE5OjM2OjAwIC0w
MDAwCTEuOTIKKysrIGxpYi9jb21tb24uYwkyNyBKdW4gMjAwMyAxNzo1ODo1MyAtMDAwMApAQCAt
NzI3LDcgKzcyNyw3IEBACiAJICBzYXNsX3NldGVycm9yKGNvbm4sIDAsICJCYWQgSVBSRU1PVEVQ
T1JUIHZhbHVlIik7CiAJICBSRVRVUk4oY29ubiwgU0FTTF9CQURQQVJBTSk7CiAgICAgICB9IGVs
c2UgewotCSAgc3RyY3B5KGNvbm4tPmlwcmVtb3RlcG9ydCwgaXByZW1vdGVwb3J0KTsKKwkgIHN0
cmxjcHkoY29ubi0+aXByZW1vdGVwb3J0LCBpcHJlbW90ZXBvcnQsIHNpemVvZihjb25uLT5pcHJl
bW90ZXBvcnQpKTsKIAkgIGNvbm4tPmdvdF9pcF9yZW1vdGUgPSAxOwogICAgICAgfQogICAgICAg
CkBAIC03NjgsNyArNzY4LDcgQEAKIAkgIHNhc2xfc2V0ZXJyb3IoY29ubiwgMCwgIkJhZCBJUExP
Q0FMUE9SVCB2YWx1ZSIpOwogCSAgUkVUVVJOKGNvbm4sIFNBU0xfQkFEUEFSQU0pOwogICAgICAg
fSBlbHNlIHsKLQkgIHN0cmNweShjb25uLT5pcGxvY2FscG9ydCwgaXBsb2NhbHBvcnQpOworCSAg
c3RybGNweShjb25uLT5pcGxvY2FscG9ydCwgaXBsb2NhbHBvcnQsIHNpemVvZihjb25uLT5pcGxv
Y2FscG9ydCkpOwogCSAgY29ubi0+Z290X2lwX2xvY2FsID0gMTsKICAgICAgIH0KIApJbmRleDog
bGliL2Rsb3Blbi5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMv
c3JjL3Nhc2wvbGliL2Rsb3Blbi5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjQ0CmRpZmYgLXUg
LXIxLjQ0IGRsb3Blbi5jCi0tLSBsaWIvZGxvcGVuLmMJMTMgRmViIDIwMDMgMTk6NTU6NTQgLTAw
MDAJMS40NAorKysgbGliL2Rsb3Blbi5jCTI3IEp1biAyMDAzIDE3OjU4OjUzIC0wMDAwCkBAIC0y
MzgsNyArMjM4LDggQEAKIC8qIFdlJ2xsIHVzZSBhIHN0YXRpYyBidWZmZXIgZm9yIHNwZWVkIHVu
bGVzcyBzb21lb25lIGNvbXBsYWlucyAqLwogI2RlZmluZSBNQVhfTElORSAyMDQ4CiAKLXN0YXRp
YyBpbnQgX3BhcnNlX2xhKGNvbnN0IGNoYXIgKnByZWZpeCwgY29uc3QgY2hhciAqaW4sIGNoYXIg
Km91dCkgCitzdGF0aWMgaW50IF9wYXJzZV9sYShjb25zdCBjaGFyICpwcmVmaXgsIGNvbnN0IGNo
YXIgKmluLAorCQkgICAgIGNoYXIgKm91dCwgc2l6ZV90IHNpemUpIAogewogICAgIEZJTEUgKmZp
bGU7CiAgICAgc2l6ZV90IGxlbmd0aDsKQEAgLTI1NSwxMSArMjU2LDExIEBACiAgICAgaWYgKHN0
cmNtcChpbiArIChsZW5ndGggLSBzdHJsZW4oTEFfU1VGRklYKSksIExBX1NVRkZJWCkpIHsKIAlp
Zighc3RyY21wKGluICsgKGxlbmd0aCAtIHN0cmxlbihTT19TVUZGSVgpKSxTT19TVUZGSVgpKSB7
CiAJICAgIC8qIGNoZWNrIGZvciBhIC5sYSBmaWxlICovCi0JICAgIHN0cmNweShsaW5lLCBwcmVm
aXgpOwotCSAgICBzdHJjYXQobGluZSwgaW4pOworCSAgICBzdHJsY3B5KGxpbmUsIHByZWZpeCwg
c2l6ZW9mKGxpbmUpKTsKKwkgICAgc3RybGNhdChsaW5lLCBpbiwgc2l6ZW9mKGxpbmUpKTsKIAkg
ICAgbGVuZ3RoID0gc3RybGVuKGxpbmUpOwogCSAgICAqKGxpbmUgKyAobGVuZ3RoIC0gc3RybGVu
KFNPX1NVRkZJWCkpKSA9ICdcMCc7Ci0JICAgIHN0cmNhdChsaW5lLCBMQV9TVUZGSVgpOworCSAg
ICBzdHJsY2F0KGxpbmUsIExBX1NVRkZJWCwgc2l6ZW9mKGxpbmUpKTsKIAkgICAgZmlsZSA9IGZv
cGVuKGxpbmUsICJyIik7CiAJICAgIGlmKGZpbGUpIHsKIAkJLyogV2UnbGwgZ2V0IGl0IG9uIHRo
ZSAubGEgb3BlbiAqLwpAQCAtMjY3LDEzICsyNjgsMTMgQEAKIAkJcmV0dXJuIFNBU0xfRkFJTDsK
IAkgICAgfQogCX0KLQlzdHJjcHkob3V0LCBwcmVmaXgpOwotCXN0cmNhdChvdXQsIGluKTsKKwlz
dHJsY3B5KG91dCwgcHJlZml4LCBzaXplKTsKKwlzdHJsY2F0KG91dCwgaW4sIHNpemUpOwogCXJl
dHVybiBTQVNMX09LOwogICAgIH0KIAotICAgIHN0cmNweShsaW5lLCBwcmVmaXgpOwotICAgIHN0
cmNhdChsaW5lLCBpbik7CisgICAgc3RybGNweShsaW5lLCBwcmVmaXgsIHNpemVvZihsaW5lKSk7
CisgICAgc3RybGNhdChsaW5lLCBpbiwgc2l6ZW9mKGxpbmUpKTsKIAogICAgIGZpbGUgPSBmb3Bl
bihsaW5lLCAiciIpOwogICAgIGlmKCFmaWxlKSB7CkBAIC0zMDgsOCArMzA5LDggQEAKIAkJCSAg
ICAgICJkbG5hbWUgaXMgZW1wdHkgaW4gLmxhIGZpbGU6ICVzIiwgaW4pOwogCQkgICAgcmV0dXJu
IFNBU0xfRkFJTDsKIAkJfQotCQlzdHJjcHkob3V0LCBwcmVmaXgpOwotCQlzdHJjYXQob3V0LCBu
dG1wKTsKKwkJc3RybGNweShvdXQsIHByZWZpeCwgc2l6ZSk7CisJCXN0cmxjYXQob3V0LCBudG1w
LCBzaXplKTsKIAkgICAgfQogCSAgICBicmVhazsKIAl9CkBAIC00NjMsOCArNDY0LDggQEAKIAl9
IHdoaWxlICgoYyE9JzonKSAmJiAoYyE9Jz0nKSAmJiAoYyE9MCkpOwogCXN0cltwb3MtMV09J1ww
JzsKIAotCXN0cmNweShwcmVmaXgsc3RyKTsKLQlzdHJjYXQocHJlZml4LCIvIik7CisJc3RybGNw
eShwcmVmaXgsc3RyLHNpemVvZihwcmVmaXgpKTsKKwlzdHJsY2F0KHByZWZpeCwiLyIsc2l6ZW9m
KHByZWZpeCkpOwogCiAJaWYgKChkcD1vcGVuZGlyKHN0cikpICE9TlVMTCkgLyogaWdub3JlIGVy
cm9ycyAqLyAgICAKIAl7CkBAIC00OTEsMTMgKzQ5MiwxMyBAQAogCQltZW1jcHkobmFtZSxkaXIt
PmRfbmFtZSxsZW5ndGgpOwogCQluYW1lW2xlbmd0aF09J1wwJzsKIAotCQlyZXN1bHQgPSBfcGFy
c2VfbGEocHJlZml4LCBuYW1lLCB0bXApOworCQlyZXN1bHQgPSBfcGFyc2VfbGEocHJlZml4LCBu
YW1lLCB0bXAsIHNpemVvZih0bXApKTsKIAkJaWYocmVzdWx0ICE9IFNBU0xfT0spCiAJCSAgICBj
b250aW51ZTsKIAkJCiAJCS8qIHNraXAgImxpYiIgYW5kIGN1dCBvZmYgc3VmZml4IC0tCiAJCSAg
IHRoaXMgb25seSBuZWVkIGJlIGFwcHJveGltYXRlICovCi0JCXN0cmNweShwbHVnbmFtZSwgbmFt
ZSArIDMpOworCQlzdHJsY3B5KHBsdWduYW1lLCBuYW1lICsgMywgc2l6ZW9mKHBsdWduYW1lKSk7
CiAJCWMgPSBzdHJjaHIocGx1Z25hbWUsIChpbnQpJy4nKTsKIAkJaWYoYykgKmMgPSAnXDAnOwog
CkluZGV4OiBsaWIvZ2V0bmFtZWluZm8uYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJl
dy9zeXN0ZW0vY3ZzL3NyYy9zYXNsL2xpYi9nZXRuYW1laW5mby5jLHYKcmV0cmlldmluZyByZXZp
c2lvbiAxLjUKZGlmZiAtdSAtcjEuNSBnZXRuYW1laW5mby5jCi0tLSBsaWIvZ2V0bmFtZWluZm8u
YwkxMyBGZWIgMjAwMyAxOTo1NTo1NCAtMDAwMAkxLjUKKysrIGxpYi9nZXRuYW1laW5mby5jCTI3
IEp1biAyMDAzIDE3OjU4OjUzIC0wMDAwCkBAIC03NCwxOCArNzQsMTggQEAKICAgICBjaGFyIHRt
cHNlcnZbMTZdOwogICAKICAgICBpZiAoc2VydikgewotCXNwcmludGYodG1wc2VydiwgIiVkIiwg
bnRvaHMoc2luLT5zaW5fcG9ydCkpOworCXNucHJpbnRmKHRtcHNlcnYsIHNpemVvZih0bXBzZXJ2
KSwgIiVkIiwgbnRvaHMoc2luLT5zaW5fcG9ydCkpOwogCWlmIChzdHJsZW4odG1wc2VydikgPiBz
ZXJ2bGVuKQogCSAgICByZXR1cm4gRUFJX01FTU9SWTsKIAllbHNlCi0JICAgIHN0cmNweShzZXJ2
LCB0bXBzZXJ2KTsKKwkgICAgc3RybGNweShzZXJ2LCB0bXBzZXJ2LCBzZXJ2bGVuKTsKICAgICB9
CiAgICAgaWYgKGhvc3QpIHsKIAlpZiAoZmxhZ3MgJiBOSV9OVU1FUklDSE9TVCkgewogCSAgICBp
ZiAoc3RybGVuKGluZXRfbnRvYShzaW4tPnNpbl9hZGRyKSkgPj0gaG9zdGxlbikKIAkJcmV0dXJu
IEVBSV9NRU1PUlk7CiAJICAgIGVsc2UgewotCQlzdHJjcHkoaG9zdCwgaW5ldF9udG9hKHNpbi0+
c2luX2FkZHIpKTsKKwkJc3RybGNweShob3N0LCBpbmV0X250b2Eoc2luLT5zaW5fYWRkciksIGhv
c3RsZW4pOwogCQlyZXR1cm4gMDsKIAkgICAgfQogCX0gZWxzZSB7CkBAIC05NSw3ICs5NSw3IEBA
CiAJCWlmIChzdHJsZW4oaHAtPmhfbmFtZSkgPj0gaG9zdGxlbikKIAkJICAgIHJldHVybiBFQUlf
TUVNT1JZOwogCQllbHNlIHsKLQkJICAgIHN0cmNweShob3N0LCBocC0+aF9uYW1lKTsKKwkJICAg
IHN0cmxjcHkoaG9zdCwgaHAtPmhfbmFtZSwgaG9zdGxlbik7CiAJCSAgICByZXR1cm4gMDsKIAkJ
fQogCSAgICB9CkluZGV4OiBsaWIvc3RybGNhdC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IGxpYi9z
dHJsY2F0LmMKZGlmZiAtTiBsaWIvc3RybGNhdC5jCi0tLSAvZGV2L251bGwJMSBKYW4gMTk3MCAw
MDowMDowMCAtMDAwMAorKysgbGliL3N0cmxjYXQuYwkyNyBKdW4gMjAwMyAxNzo1ODo1MyAtMDAw
MApAQCAtMCwwICsxLDY2IEBACisvKgorICogQ29weXJpZ2h0IChjKSAxOTk4LTIwMDMgQ2FybmVn
aWUgTWVsbG9uIFVuaXZlcnNpdHkuICBBbGwgcmlnaHRzIHJlc2VydmVkLgorICoKKyAqIFJlZGlz
dHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0
aG91dAorICogbW9kaWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZv
bGxvd2luZyBjb25kaXRpb25zCisgKiBhcmUgbWV0OgorICoKKyAqIDEuIFJlZGlzdHJpYnV0aW9u
cyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0CisgKiAgICBu
b3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWlt
ZXIuIAorICoKKyAqIDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJv
ZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0CisgKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25k
aXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4KKyAqICAgIHRoZSBkb2N1bWVu
dGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUKKyAqICAgIGRp
c3RyaWJ1dGlvbi4KKyAqCisgKiAzLiBUaGUgbmFtZSAiQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNp
dHkiIG11c3Qgbm90IGJlIHVzZWQgdG8KKyAqICAgIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0
cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0CisgKiAgICBwcmlvciB3cml0dGVu
IHBlcm1pc3Npb24uIEZvciBwZXJtaXNzaW9uIG9yIGFueSBvdGhlciBsZWdhbAorICogICAgZGV0
YWlscywgcGxlYXNlIGNvbnRhY3QgIAorICogICAgICBPZmZpY2Ugb2YgVGVjaG5vbG9neSBUcmFu
c2ZlcgorICogICAgICBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eQorICogICAgICA1MDAwIEZv
cmJlcyBBdmVudWUKKyAqICAgICAgUGl0dHNidXJnaCwgUEEgIDE1MjEzLTM4OTAKKyAqICAgICAg
KDQxMikgMjY4LTQzODcsIGZheDogKDQxMikgMjY4LTczOTUKKyAqICAgICAgdGVjaC10cmFuc2Zl
ckBhbmRyZXcuY211LmVkdQorICoKKyAqIDQuIFJlZGlzdHJpYnV0aW9ucyBvZiBhbnkgZm9ybSB3
aGF0c29ldmVyIG11c3QgcmV0YWluIHRoZSBmb2xsb3dpbmcKKyAqICAgIGFja25vd2xlZGdtZW50
OgorICogICAgIlRoaXMgcHJvZHVjdCBpbmNsdWRlcyBzb2Z0d2FyZSBkZXZlbG9wZWQgYnkgQ29t
cHV0aW5nIFNlcnZpY2VzCisgKiAgICAgYXQgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkgKGh0
dHA6Ly93d3cuY211LmVkdS9jb21wdXRpbmcvKS4iCisgKgorICogQ0FSTkVHSUUgTUVMTE9OIFVO
SVZFUlNJVFkgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEggUkVHQVJEIFRPCisgKiBUSElT
IFNPRlRXQVJFLCBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFC
SUxJVFkKKyAqIEFORCBGSVRORVNTLCBJTiBOTyBFVkVOVCBTSEFMTCBDQVJORUdJRSBNRUxMT04g
VU5JVkVSU0lUWSBCRSBMSUFCTEUKKyAqIEZPUiBBTlkgU1BFQ0lBTCwgSU5ESVJFQ1QgT1IgQ09O
U0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTCisgKiBXSEFUU09FVkVSIFJFU1VMVElO
RyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4KKyAqIEFOIEFD
VElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUiBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFS
SVNJTkcKKyAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUiBQRVJGT1JN
QU5DRSBPRiBUSElTIFNPRlRXQVJFLgorICoKKyAqICRJZCQKKyAqLworCisjaW5jbHVkZSA8Y29u
ZmlnLmg+CisKKyNpZm5kZWYgSEFWRV9TVFJMQ0FUCisjaW5jbHVkZSA8c3RyaW5nLmg+CisKK3Np
emVfdCBzYXNsX3N0cmxjYXQoY2hhciAqZHN0LCBjb25zdCBjaGFyICpzcmMsIHNpemVfdCBsZW4p
Cit7CisgICAgc2l6ZV90IGksIGosIG87CisgICAgCisgICAgbyA9IHN0cmxlbihkc3QpOworICAg
IGlmIChsZW4gPCBvICsgMSkKKwlyZXR1cm4gbyArIHN0cmxlbihzcmMpOworICAgIGxlbiAtPSBv
ICsgMTsKKyAgICBmb3IgKGkgPSAwLCBqID0gbzsgaSA8IGxlbjsgaSsrLCBqKyspIHsKKwlpZiAo
KGRzdFtqXSA9IHNyY1tpXSkgPT0gJ1wwJykgYnJlYWs7CisgICAgfQorICAgIGRzdFtqXSA9ICdc
MCc7CisgICAgaWYgKHNyY1tpXSA9PSAnXDAnKSB7CisJcmV0dXJuIGo7CisgICAgfSBlbHNlIHsK
KwlyZXR1cm4gaiArIHN0cmxlbihzcmMgKyBpKTsKKyAgICB9Cit9CisjZW5kaWYgLyogSEFWRV9T
VFJMQ0FUICovCkluZGV4OiBsaWIvc3RybGNweS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IGxpYi9z
dHJsY3B5LmMKZGlmZiAtTiBsaWIvc3RybGNweS5jCi0tLSAvZGV2L251bGwJMSBKYW4gMTk3MCAw
MDowMDowMCAtMDAwMAorKysgbGliL3N0cmxjcHkuYwkyNyBKdW4gMjAwMyAxNzo1ODo1MyAtMDAw
MApAQCAtMCwwICsxLDcyIEBACisvKgorICogQ29weXJpZ2h0IChjKSAxOTk4LTIwMDMgQ2FybmVn
aWUgTWVsbG9uIFVuaXZlcnNpdHkuICBBbGwgcmlnaHRzIHJlc2VydmVkLgorICoKKyAqIFJlZGlz
dHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0
aG91dAorICogbW9kaWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZv
bGxvd2luZyBjb25kaXRpb25zCisgKiBhcmUgbWV0OgorICoKKyAqIDEuIFJlZGlzdHJpYnV0aW9u
cyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0CisgKiAgICBu
b3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWlt
ZXIuIAorICoKKyAqIDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJv
ZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0CisgKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25k
aXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4KKyAqICAgIHRoZSBkb2N1bWVu
dGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUKKyAqICAgIGRp
c3RyaWJ1dGlvbi4KKyAqCisgKiAzLiBUaGUgbmFtZSAiQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNp
dHkiIG11c3Qgbm90IGJlIHVzZWQgdG8KKyAqICAgIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0
cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0CisgKiAgICBwcmlvciB3cml0dGVu
IHBlcm1pc3Npb24uIEZvciBwZXJtaXNzaW9uIG9yIGFueSBvdGhlciBsZWdhbAorICogICAgZGV0
YWlscywgcGxlYXNlIGNvbnRhY3QgIAorICogICAgICBPZmZpY2Ugb2YgVGVjaG5vbG9neSBUcmFu
c2ZlcgorICogICAgICBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eQorICogICAgICA1MDAwIEZv
cmJlcyBBdmVudWUKKyAqICAgICAgUGl0dHNidXJnaCwgUEEgIDE1MjEzLTM4OTAKKyAqICAgICAg
KDQxMikgMjY4LTQzODcsIGZheDogKDQxMikgMjY4LTczOTUKKyAqICAgICAgdGVjaC10cmFuc2Zl
ckBhbmRyZXcuY211LmVkdQorICoKKyAqIDQuIFJlZGlzdHJpYnV0aW9ucyBvZiBhbnkgZm9ybSB3
aGF0c29ldmVyIG11c3QgcmV0YWluIHRoZSBmb2xsb3dpbmcKKyAqICAgIGFja25vd2xlZGdtZW50
OgorICogICAgIlRoaXMgcHJvZHVjdCBpbmNsdWRlcyBzb2Z0d2FyZSBkZXZlbG9wZWQgYnkgQ29t
cHV0aW5nIFNlcnZpY2VzCisgKiAgICAgYXQgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkgKGh0
dHA6Ly93d3cuY211LmVkdS9jb21wdXRpbmcvKS4iCisgKgorICogQ0FSTkVHSUUgTUVMTE9OIFVO
SVZFUlNJVFkgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEggUkVHQVJEIFRPCisgKiBUSElT
IFNPRlRXQVJFLCBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFC
SUxJVFkKKyAqIEFORCBGSVRORVNTLCBJTiBOTyBFVkVOVCBTSEFMTCBDQVJORUdJRSBNRUxMT04g
VU5JVkVSU0lUWSBCRSBMSUFCTEUKKyAqIEZPUiBBTlkgU1BFQ0lBTCwgSU5ESVJFQ1QgT1IgQ09O
U0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTCisgKiBXSEFUU09FVkVSIFJFU1VMVElO
RyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4KKyAqIEFOIEFD
VElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUiBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFS
SVNJTkcKKyAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUiBQRVJGT1JN
QU5DRSBPRiBUSElTIFNPRlRXQVJFLgorICoKKyAqICRJZCQKKyAqLworCisjaW5jbHVkZSA8Y29u
ZmlnLmg+CisKKyNpZm5kZWYgSEFWRV9TVFJMQ1BZCisjaW5jbHVkZSA8c3RyaW5nLmg+CisKKy8q
IHN0cmxjcHkgLS0gY29weSBzdHJpbmcgc21hcnRseS4KKyAqCisgKiBpIGJlbGlldmUvaG9wZSB0
aGlzIGlzIGNvbXBhdGlibGUgd2l0aCB0aGUgQlNEIHN0cmxjcHkoKS4gCisgKi8KK3NpemVfdCBz
YXNsX3N0cmxjcHkoY2hhciAqZHN0LCBjb25zdCBjaGFyICpzcmMsIHNpemVfdCBsZW4pCit7Cisg
ICAgc2l6ZV90IG47CisKKyAgICBpZiAobGVuIDw9IDApIHsKKyAgICAgICAgLyogd2UgY2FuJ3Qg
ZG8gYW55dGhpbmcgISAqLworICAgICAgICByZXR1cm4gc3RybGVuKHNyYyk7CisgICAgfQorCisg
ICAgLyogYXNzZXJ0KGxlbiA+PSAxKTsgKi8KKyAgICBmb3IgKG4gPSAwOyBuIDwgbGVuLTE7IG4r
KykgeworCWlmICgoZHN0W25dID0gc3JjW25dKSA9PSAnXDAnKSBicmVhazsKKyAgICB9CisgICAg
aWYgKG4gPj0gbGVuLTEpIHsKKwkvKiByYW4gb3V0IG9mIHNwYWNlICovCisJZHN0W25dID0gJ1ww
JzsKKwl3aGlsZShzcmNbbl0pIG4rKzsKKyAgICB9CisgICAgcmV0dXJuIG47Cit9CisjZW5kaWYg
LyogSEFWRV9TVFJMQ1BZICovCkluZGV4OiBsaWIvd2luZGxvcGVuLmMKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvc2FzbC9saWIvd2luZGxvcGVuLmMsdgpy
ZXRyaWV2aW5nIHJldmlzaW9uIDEuMTUKZGlmZiAtdSAtcjEuMTUgd2luZGxvcGVuLmMKLS0tIGxp
Yi93aW5kbG9wZW4uYwkxMyBGZWIgMjAwMyAxOTo1NTo1NSAtMDAwMAkxLjE1CisrKyBsaWIvd2lu
ZGxvcGVuLmMJMjcgSnVuIDIwMDMgMTc6NTg6NTMgLTAwMDAKQEAgLTIxMSwxMiArMjExLDEyIEBA
CiAJICAgIGNvbnRpbnVlOwogCX0KIAotCXN0cmNweSAocHJlZml4LCBjdXJfZGlyKTsKKwlzdHJs
Y3B5IChwcmVmaXgsIGN1cl9kaXIsIHNpemVvZihwcmVmaXgpKTsKIAlwcmVmaXhfbGVuID0gc3Ry
bGVuIChwcmVmaXgpOwogCiAvKiA6IERvbid0IGFwcGVuZCB0cmFpbGluZyBcIHVubGVzcyByZXF1
aXJlZCAqLwogCWlmIChwcmVmaXhbcHJlZml4X2xlbi0xXSAhPSAnXFwnKSB7Ci0JICAgIHN0cmNh
dCAocHJlZml4LCJcXCIpOworCSAgICBzdHJsY2F0IChwcmVmaXgsIlxcIixzaXplb2YocHJlZml4
KSk7CiAJICAgIHByZWZpeF9sZW4rKzsKIAl9CiAKQEAgLTIyOCw3ICsyMjgsNyBAQAogICAgICAg
ICAgICAgY29udGludWU7CiAJfQogCi0Jc3RyY2F0IChwcmVmaXggKyBwcmVmaXhfbGVuLCAiKiIg
RExMX1NVRkZJWCk7CisJc3RybGNhdCAocHJlZml4ICsgcHJlZml4X2xlbiwgIioiIERMTF9TVUZG
SVgsIHNpemVvZihwcmVmaXgpLXByZWZpeF9sZW4pOwogCiAgICAgICAgIGZoYW5kbGUgPSBfZmlu
ZGZpcnN0IChwYXR0ZXJuLCAmZmluZGRhdGEpOwogICAgICAgICBpZiAoZmhhbmRsZSA9PSAtMSkg
ewkvKiBubyBtYXRjaGluZyBmaWxlcyAqLwpAQCAtMjYzLDExICsyNjMsMTEgQEAKIAogLyogOiBD
b25zdHJ1Y3QgZnVsbCBuYW1lIGZyb20gcHJlZml4IGFuZCBuYW1lICovCiAKLQkgICAgc3RyY3B5
IChmdWxsX25hbWUsIHByZWZpeCk7Ci0JICAgIHN0cmNhdCAoZnVsbF9uYW1lLCBmaW5kZGF0YS5u
YW1lKTsKKwkgICAgc3RybGNweSAoZnVsbF9uYW1lLCBwcmVmaXgsIHNpemVvZihmdWxsX25hbWUp
KTsKKwkgICAgc3RybGNhdCAoZnVsbF9uYW1lLCBmaW5kZGF0YS5uYW1lLCBzaXplb2YoZnVsbF9u
YW1lKSk7CiAJCQogLyogY3V0IG9mZiAuZGxsIHN1ZmZpeCAtLSB0aGlzIG9ubHkgbmVlZCBiZSBh
cHByb3hpbWF0ZSAqLwotCSAgICBzdHJjcHkgKHBsdWduYW1lLCBmaW5kZGF0YS5uYW1lKTsKKwkg
ICAgc3RybGNweSAocGx1Z25hbWUsIGZpbmRkYXRhLm5hbWUsIHNpemVvZihwbHVnbmFtZSkpOwog
CSAgICBjID0gc3RycmNocihwbHVnbmFtZSwgJy4nKTsKIAkgICAgaWYgKGMgIT0gTlVMTCkgKmMg
PSAnXDAnOwogCkluZGV4OiBwbHVnaW5zL2RpZ2VzdG1kNS5jCj09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6
IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3Nhc2wvcGx1Z2lucy9kaWdlc3RtZDUuYyx2CnJl
dHJpZXZpbmcgcmV2aXNpb24gMS4xNTMKZGlmZiAtdSAtcjEuMTUzIGRpZ2VzdG1kNS5jCi0tLSBw
bHVnaW5zL2RpZ2VzdG1kNS5jCTMwIE1hciAyMDAzIDIyOjE3OjA2IC0wMDAwCTEuMTUzCisrKyBw
bHVnaW5zL2RpZ2VzdG1kNS5jCTI3IEp1biAyMDAzIDE3OjU4OjU5IC0wMDAwCkBAIC0zNDEsNyAr
MzQxLDcgQEAKICAgICB1dGlscy0+TUQ1VXBkYXRlKCZNZDVDdHgsIHBzek5vbmNlLCBzdHJsZW4o
KGNoYXIgKikgcHN6Tm9uY2UpKTsKICAgICB1dGlscy0+TUQ1VXBkYXRlKCZNZDVDdHgsIENPTE9O
LCAxKTsKICAgICBpZiAoKnBzelFvcCkgewotCXNwcmludGYobmN2YWx1ZSwgIiUwOHgiLCBwc3pO
b25jZUNvdW50KTsKKwlzbnByaW50ZihuY3ZhbHVlLCBzaXplb2YobmN2YWx1ZSksICIlMDh4Iiwg
cHN6Tm9uY2VDb3VudCk7CiAJdXRpbHMtPk1ENVVwZGF0ZSgmTWQ1Q3R4LCBuY3ZhbHVlLCBzdHJs
ZW4obmN2YWx1ZSkpOwogCXV0aWxzLT5NRDVVcGRhdGUoJk1kNUN0eCwgQ09MT04sIDEpOwogCXV0
aWxzLT5NRDVVcGRhdGUoJk1kNUN0eCwgcHN6Q05vbmNlLCBzdHJsZW4oKGNoYXIgKikgcHN6Q05v
bmNlKSk7CkluZGV4OiBwbHVnaW5zL290cC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5k
cmV3L3N5c3RlbS9jdnMvc3JjL3Nhc2wvcGx1Z2lucy9vdHAuYyx2CnJldHJpZXZpbmcgcmV2aXNp
b24gMS4yNwpkaWZmIC11IC1yMS4yNyBvdHAuYwotLS0gcGx1Z2lucy9vdHAuYwkxMyBGZWIgMjAw
MyAxOTo1NjowNCAtMDAwMAkxLjI3CisrKyBwbHVnaW5zL290cC5jCTI3IEp1biAyMDAzIDE3OjU4
OjU5IC0wMDAwCkBAIC01OTYsOSArNTk2LDkgQEAKIAogc3RhdGljIGludCBwYXJzZV9zZWNyZXQo
Y29uc3Qgc2FzbF91dGlsc190ICp1dGlscywKIAkJCWNoYXIgKnNlY3JldCwgc2l6ZV90IHNlY2xl
biwKLQkJCWNoYXIgKmFsZywgdW5zaWduZWQgKnNlcSwgY2hhciAqc2VlZCwKLQkJCXVuc2lnbmVk
IGNoYXIgKm90cCwKLQkJCXRpbWVfdCAqdGltZW91dCkKKwkJCWNoYXIgKmFsZywgc2l6ZV90IGFs
Z2xlbiwgdW5zaWduZWQgKnNlcSwKKwkJCWNoYXIgKnNlZWQsIHNpemVfdCBzZWVkbGVuLAorCQkJ
dW5zaWduZWQgY2hhciAqb3RwLCB0aW1lX3QgKnRpbWVvdXQpCiB7CiAgICAgdW5zaWduZWQgY2hh
ciAqYzsKICAgICAKQEAgLTYxNiwxMyArNjE2LDEzIEBACiAgICAgCiAgICAgYyA9IHNlY3JldDsK
ICAgICAKLSAgICBzdHJjcHkoYWxnLCAoY2hhciopIGMpOworICAgIHN0cmxjcHkoYWxnLCAoY2hh
ciopIGMsIGFsZ2xlbik7CiAgICAgYyArPSBzdHJsZW4oYWxnKSsxOwogICAgIAogICAgICpzZXEg
PSBzdHJ0b3VsKGMsIE5VTEwsIDEwKTsKICAgICBjICs9IDU7CiAgICAgCi0gICAgc3RyY3B5KHNl
ZWQsIChjaGFyKikgYyk7CisgICAgc3RybGNweShzZWVkLCAoY2hhciopIGMsIHNlZWRsZW4pOwog
ICAgIGMgKz0gc3RybGVuKHNlZWQpKzE7CiAgICAgCiAgICAgbWVtY3B5KG90cCwgYywgT1RQX0hB
U0hfU0laRSk7CkBAIC02ODIsNyArNjgyLDcgQEAKICAgICBpbnQgYWx0X2RpY3QgPSAwOwogICAg
IAogICAgIC8qIHRoaXMgaXMgYSBkZXN0cnVjdGl2ZSBvcGVyYXRpb24sIHNvIG1ha2UgYSB3b3Jr
IGNvcHkgKi8KLSAgICBzdHJjcHkoYnVmLCB3b3Jkcyk7CisgICAgc3RybGNweShidWYsIHdvcmRz
LCBzaXplb2YoYnVmKSk7CiAgICAgbWVtc2V0KGJpdHMsIDAsIDkpOwogICAgIAogICAgIGZvciAo
YyA9IGJ1ZiwgYml0ID0gMCwgaSA9IDA7IGkgPCA2OyBpKyssIGMrKywgYml0Kz0xMSkgewpAQCAt
ODg1LDcgKzg4NSw3IEBACiAJICAgIC8qIHNldHVwIGZvciBuZXcgc2VjcmV0ICovCiAJICAgIHRl
eHQtPmFsZyA9IGFsZzsKIAkgICAgdGV4dC0+c2VxID0gc2VxOwotCSAgICBzdHJjcHkodGV4dC0+
c2VlZCwgc2VlZCk7CisJICAgIHN0cmxjcHkodGV4dC0+c2VlZCwgc2VlZCwgc2l6ZW9mKHRleHQt
PnNlZWQpKTsKIAkgICAgbWVtY3B5KHRleHQtPm90cCwgbmV3X290cCwgT1RQX0hBU0hfU0laRSk7
CiAJfQogICAgIH0KQEAgLTk5Miw4ICs5OTIsOSBAQAogCSAgICByZXN1bHQgPSBwYXJzZV9zZWNy
ZXQocGFyYW1zLT51dGlscywKIAkJCQkgIChjaGFyKikgYXV4cHJvcF92YWx1ZXNbMF0udmFsdWVz
WzBdLAogCQkJCSAgYXV4cHJvcF92YWx1ZXNbMF0udmFsc2l6ZSwKLQkJCQkgIG1kYSwgJnRleHQt
PnNlcSwgdGV4dC0+c2VlZCwgdGV4dC0+b3RwLAotCQkJCSAgJnRpbWVvdXQpOworCQkJCSAgbWRh
LCBzaXplb2YobWRhKSwgJnRleHQtPnNlcSwKKwkJCQkgIHRleHQtPnNlZWQsIHNpemVvZih0ZXh0
LT5zZWVkKSwKKwkJCQkgIHRleHQtPm90cCwgJnRpbWVvdXQpOwogCSAgICAKIAkgICAgaWYgKHJl
c3VsdCAhPSBTQVNMX09LKSByZXR1cm4gcmVzdWx0OwogCX0gZWxzZSB7CkBAIC0xMDY5LDggKzEw
NzAsOCBAQAogICAgIGlmIChyZXN1bHQgIT0gU0FTTF9PSykgcmV0dXJuIHJlc3VsdDsKICAgICAK
ICAgICAvKiBjcmVhdGUgY2hhbGxlbmdlICovCi0gICAgc3ByaW50Zih0ZXh0LT5vdXRfYnVmLCAi
b3RwLSVzICV1ICVzIGV4dCIsCi0JICAgIHRleHQtPmFsZy0+bmFtZSwgdGV4dC0+c2VxLTEsIHRl
eHQtPnNlZWQpOworICAgIHNucHJpbnRmKHRleHQtPm91dF9idWYsIE9UUF9DSEFMTEVOR0VfTUFY
KzEsICJvdHAtJXMgJXUgJXMgZXh0IiwKKwkgICAgIHRleHQtPmFsZy0+bmFtZSwgdGV4dC0+c2Vx
LTEsIHRleHQtPnNlZWQpOwogICAgIAogICAgICpzZXJ2ZXJvdXQgPSB0ZXh0LT5vdXRfYnVmOwog
ICAgICpzZXJ2ZXJvdXRsZW4gPSBzdHJsZW4odGV4dC0+b3V0X2J1Zik7CkBAIC0xMjgxLDcgKzEy
ODIsOCBAQAogCQogCXNwYXJhbXMtPnV0aWxzLT5yYW5kKHNwYXJhbXMtPnV0aWxzLT5ycG9vbCwK
IAkJCSAgICAgKGNoYXIqKSAmcmFuZG51bSwgc2l6ZW9mKHJhbmRudW0pKTsKLQlzcHJpbnRmKHNl
ZWQsICIlLjJzJTA0dSIsIHNwYXJhbXMtPnNlcnZlckZRRE4sIChyYW5kbnVtICUgOTk5OSkgKyAx
KTsKKwlzbnByaW50ZihzZWVkLCBzaXplb2Yoc2VlZCksCisJCSAiJS4ycyUwNHUiLCBzcGFyYW1z
LT5zZXJ2ZXJGUUROLCAocmFuZG51bSAlIDk5OTkpICsgMSk7CiAJCiAJciA9IGdlbmVyYXRlX290
cChzcGFyYW1zLT51dGlscywgYWxncywgT1RQX1NFUVVFTkNFX0RFRkFVTFQsCiAJCQkgc2VlZCwg
KGNoYXIqKSBwYXNzLCBvdHApOwpAQCAtMTYzMSw4ICsxNjMzLDggQEAKIAkgICAgZG8gewogCQlw
YXJhbXMtPnV0aWxzLT5yYW5kKHBhcmFtcy0+dXRpbHMtPnJwb29sLAogCQkJCSAgICAoY2hhciop
ICZyYW5kbnVtLCBzaXplb2YocmFuZG51bSkpOwotCQlzcHJpbnRmKG5ld19zZWVkLCAiJS4ycyUw
NHUiLCBwYXJhbXMtPnNlcnZlckZRRE4sCi0JCQkocmFuZG51bSAlIDk5OTkpICsgMSk7CisJCXNu
cHJpbnRmKG5ld19zZWVkLCBzaXplb2YobmV3X3NlZWQpLAorCQkJICIlLjJzJTA0dSIsIHBhcmFt
cy0+c2VydmVyRlFETiwgKHJhbmRudW0gJSA5OTk5KSArIDEpOwogCSAgICB9IHdoaWxlICghc3Ry
Y2FzZWNtcChzZWVkLCBuZXdfc2VlZCkpOwogCSAgICAKIAkgICAgcmVzdWx0ID0gZ2VuZXJhdGVf
b3RwKHBhcmFtcy0+dXRpbHMsIGFsZywgT1RQX1NFUVVFTkNFX0RFRkFVTFQsCkBAIC0xNjQwLDEw
ICsxNjQyLDEyIEBACiAJICAgIAogCSAgICBpZiAocmVzdWx0ID09IFNBU0xfT0spIHsKIAkJLyog
Y3JlYXRlIGFuIGluaXQtaGV4IHJlc3BvbnNlICovCi0JCXN0cmNweSh0ZXh0LT5vdXRfYnVmLCBP
VFBfSU5JVF9IRVhfVFlQRSk7CisJCXN0cmxjcHkodGV4dC0+b3V0X2J1ZiwgT1RQX0lOSVRfSEVY
X1RZUEUsIE9UUF9SRVNQT05TRV9NQVgrMSk7CiAJCWJpbjJoZXgob3RwLCBPVFBfSEFTSF9TSVpF
LAogCQkJdGV4dC0+b3V0X2J1ZitzdHJsZW4odGV4dC0+b3V0X2J1ZikpOwotCQlzcHJpbnRmKHRl
eHQtPm91dF9idWYrc3RybGVuKHRleHQtPm91dF9idWYpLCAiOiVzICV1ICVzOiIsCisJCXNucHJp
bnRmKHRleHQtPm91dF9idWYrc3RybGVuKHRleHQtPm91dF9idWYpLAorCQkJIE9UUF9SRVNQT05T
RV9NQVgrMSAtIHN0cmxlbih0ZXh0LT5vdXRfYnVmKSwKKwkJCSAiOiVzICV1ICVzOiIsCiAJCQlh
bGctPm5hbWUsIE9UUF9TRVFVRU5DRV9ERUZBVUxULCBuZXdfc2VlZCk7CiAJCWJpbjJoZXgobmV3
X290cCwgT1RQX0hBU0hfU0laRSwKIAkJCXRleHQtPm91dF9idWYrc3RybGVuKHRleHQtPm91dF9i
dWYpKTsKQEAgLTE2NTYsNyArMTY2MCw3IEBACiAJCiAJaWYgKCFpbml0X2RvbmUpIHsKIAkgICAg
LyogY3JlYXRlZCBoZXggcmVzcG9uc2UgKi8KLQkgICAgc3RyY3B5KHRleHQtPm91dF9idWYsIE9U
UF9IRVhfVFlQRSk7CisJICAgIHN0cmxjcHkodGV4dC0+b3V0X2J1ZiwgT1RQX0hFWF9UWVBFLCBP
VFBfUkVTUE9OU0VfTUFYKzEpOwogCSAgICBiaW4yaGV4KG90cCwgT1RQX0hBU0hfU0laRSwgdGV4
dC0+b3V0X2J1ZitzdHJsZW4odGV4dC0+b3V0X2J1ZikpOwogCX0KIAkKSW5kZXg6IHNhc2xhdXRo
ZC9NYWtlZmlsZS5hbQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3Zz
L3NyYy9zYXNsL3Nhc2xhdXRoZC9NYWtlZmlsZS5hbSx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4z
MwpkaWZmIC11IC1yMS4zMyBNYWtlZmlsZS5hbQotLS0gc2FzbGF1dGhkL01ha2VmaWxlLmFtCTI4
IE1hciAyMDAzIDE5OjU5OjIzIC0wMDAwCTEuMzMKKysrIHNhc2xhdXRoZC9NYWtlZmlsZS5hbQky
NyBKdW4gMjAwMyAxNzo1ODo1OSAtMDAwMApAQCAtMTAsNyArMTAsNyBAQAogCQkgICAgYXV0aF9s
ZGFwLmMgYXV0aF9sZGFwLmggY2FjaGUuYyBjYWNoZS5oIHV0aWxzLmMgdXRpbHMuaCBcCiAgICAg
ICAgICAgICAgICAgICAgIGlwY191bml4LmMgaXBjX2Rvb3JzLmMgc2FzbGF1dGhkLW1haW4uYyBz
YXNsYXV0aGQtbWFpbi5oIFwKIAkJICAgIG1kNS5jIHNhc2xhdXRoZF9tZDUuaCBtZDVnbG9iYWwu
aAotRVhUUkFfc2FzbGF1dGhkX3NvdXJjZXMgPSBnZXRhZGRyaW5mby5jIGdldG5hbWVpbmZvLmMK
K0VYVFJBX3Nhc2xhdXRoZF9zb3VyY2VzID0gZ2V0YWRkcmluZm8uYyBnZXRuYW1laW5mby5jIHN0
cmxjYXQuYyBzdHJsY3B5LmMKIHNhc2xhdXRoZF9ERVBFTkRFTkNJRVMgPSBzYXNsYXV0aGQtbWFp
bi5vIEBDT01QQVRfT0JKQAogc2FzbGF1dGhkX0xEQURECT0gQENPTVBBVF9PQkpAIEBTQVNMX0tS
Ql9MSUJAIFwKIAkJICBAR1NTQVBJQkFTRV9MSUJTQCBAR1NTQVBJX0xJQlNAIEBMSUJfQ1JZUFRA
IEBMSUJfU0lBQCBcCkBAIC0yNSw3ICsyNSw4IEBACiBzYXNsY2FjaGVfTERBREQgPSBAQ09NUEFU
X09CSkAKIAogRVhUUkFfRElTVAk9IHNhc2xhdXRoZC44IHNhc2xhdXRoZC5tZG9jIGNvbmZpZyBp
bmNsdWRlIFwKLQkJICBnZXRuYW1laW5mby5jIGdldGFkZHJpbmZvLmMgTERBUF9TQVNMQVVUSEQK
KwkJICBnZXRuYW1laW5mby5jIGdldGFkZHJpbmZvLmMgc3RybGNhdC5jIHN0cmxjcHkuYyBcCisJ
CSAgTERBUF9TQVNMQVVUSEQKIElOQ0xVREVTCT0gLUkkKHRvcF9zcmNkaXIpL2luY2x1ZGUgLUku
Li9pbmNsdWRlCiBERUZTICAgICAgICAgICAgPSBAREVGU0AgLURTQVNMQVVUSERfQ09ORl9GSUxF
X0RFRkFVTFQ9XCJAc3lzY29uZmRpckAvc2FzbGF1dGhkLmNvbmZcIiAtSS4gLUkkKHNyY2Rpcikg
LUkuLgogCkluZGV4OiBzYXNsYXV0aGQvYWNjb25maWcuaAo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAv
YWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zYXNsL3Nhc2xhdXRoZC9hY2NvbmZpZy5oLHYKcmV0
cmlldmluZyByZXZpc2lvbiAxLjE1CmRpZmYgLXUgLXIxLjE1IGFjY29uZmlnLmgKLS0tIHNhc2xh
dXRoZC9hY2NvbmZpZy5oCTI4IE1hciAyMDAzIDE5OjU5OjIzIC0wMDAwCTEuMTUKKysrIHNhc2xh
dXRoZC9hY2NvbmZpZy5oCTI3IEp1biAyMDAzIDE3OjU4OjU5IC0wMDAwCkBAIC03Myw2ICs3Mywx
MiBAQAogI3VuZGVmIFNBU0xfTkRCTQogI3VuZGVmIFNUQVRJQ19TQVNMREIKIAorLyogRG9lcyB5
b3VyIHN5c3RlbSBoYXZlIHRoZSBzdHJsY3B5KCkgY2FsbD8gKi8KKyN1bmRlZiBIQVZFX1NUUkxD
UFkKKworLyogRG9lcyB5b3VyIHN5c3RlbSBoYXZlIHRoZSBzdHJsY2F0KCkgY2FsbD8gKi8KKyN1
bmRlZiBIQVZFX1NUUkxDQVQKKwogLyogZGVmaW5lIGlmIHlvdXIgc3lzdGVtIGhhcyBnZXRuYW1l
aW5mbygpICovCiAjdW5kZWYgSEFWRV9HRVRBRERSSU5GTwogIApAQCAtMTU4LDYgKzE2NCwxNiBA
QAogCiAjaWZuZGVmIE5JX1dJVEhTQ09QRUlECiAjZGVmaW5lIE5JX1dJVEhTQ09QRUlEICAwCisj
ZW5kaWYKKworI2lmbmRlZiBIQVZFX1NUUkxDUFkKKyNkZWZpbmUgc3RybGNweSh4LHkseikgc2Fz
bF9zdHJsY3B5KCh4KSwoeSksKHopKQorc2l6ZV90IHNhc2xfc3RybGNweShjaGFyICpkc3QsIGNv
bnN0IGNoYXIgKnNyYywgc2l6ZV90IGRzdHNpemUpOworI2VuZGlmCisKKyNpZm5kZWYgSEFWRV9T
VFJMQ0FUCisjZGVmaW5lIHN0cmxjYXQoeCx5LHopIHNhc2xfc3RybGNhdCgoeCksKHkpLCh6KSkK
K3NpemVfdCBzYXNsX3N0cmxjYXQoY2hhciAqZHN0LCBjb25zdCBjaGFyICpzcmMsIHNpemVfdCBk
c3RzaXplKTsKICNlbmRpZgogCiAjZW5kaWYKSW5kZXg6IHNhc2xhdXRoZC9hdXRoX2tyYjQuYwo9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zYXNsL3Nhc2xh
dXRoZC9hdXRoX2tyYjQuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS45CmRpZmYgLXUgLXIxLjkg
YXV0aF9rcmI0LmMKLS0tIHNhc2xhdXRoZC9hdXRoX2tyYjQuYwkzIEZlYiAyMDAzIDE3OjA5OjEx
IC0wMDAwCTEuOQorKysgc2FzbGF1dGhkL2F1dGhfa3JiNC5jCTI3IEp1biAyMDAzIDE3OjU4OjU5
IC0wMDAwCkBAIC0yMTIsOSArMjEyLDkgQEAKICAgICAgIHJldHVybiBzdHJkdXAoIk5PIHNhc2xh
dXRoZCBpbnRlcm5hbCBlcnJvciIpOwogICAgIH0KIAotICAgIHN0cmNweSh0Zl9uYW1lLCB0Zl9k
aXIpOwotICAgIHN0cmNhdCh0Zl9uYW1lLCBsb2dpbik7Ci0gICAgc3RyY2F0KHRmX25hbWUsIHBp
ZHN0cik7CisgICAgc3RybGNweSh0Zl9uYW1lLCB0Zl9kaXIsIHNpemVvZih0Zl9uYW1lKSk7Cisg
ICAgc3RybGNhdCh0Zl9uYW1lLCBsb2dpbiwgc2l6ZW9mKHRmX25hbWUpKTsKKyAgICBzdHJsY2F0
KHRmX25hbWUsIHBpZHN0ciwgc2l6ZW9mKHRmX25hbWUpKTsKICAgICBrcmJfc2V0X3RrdF9zdHJp
bmcodGZfbmFtZSk7CiAgICAgCiAgICAgc3RybmNweShhbmFtZSwgbG9naW4sIEFOQU1FX1NaLTEp
OwpJbmRleDogc2FzbGF1dGhkL2NhY2hlLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRy
ZXcvc3lzdGVtL2N2cy9zcmMvc2FzbC9zYXNsYXV0aGQvY2FjaGUuYyx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMS40CmRpZmYgLXUgLXIxLjQgY2FjaGUuYwotLS0gc2FzbGF1dGhkL2NhY2hlLmMJMjEg
TWF5IDIwMDMgMTc6Mzc6MTggLTAwMDAJMS40CisrKyBzYXNsYXV0aGQvY2FjaGUuYwkyNyBKdW4g
MjAwMyAxNzo1ODo1OSAtMDAwMApAQCAtODYsNyArODYsNyBAQAogCQlyZXR1cm4gMDsKIAogCW1l
bXNldChjYWNoZV9tYWdpYywgMCwgNjQpOwotCXN0cmNweShjYWNoZV9tYWdpYywgQ0FDSEVfQ0FD
SEVfTUFHSUMpOworCXN0cmxjcHkoY2FjaGVfbWFnaWMsIENBQ0hFX0NBQ0hFX01BR0lDLCBzaXpl
b2YoY2FjaGVfbWFnaWMpKTsKIAogCS8qKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKgogCSAqIENvbXB1dGUgdGhlIHNpemUgb2YgdGhl
IGhhc2ggdGFibGUuIFRoaXMgYW5kIGEgc3RhdHMgCkBAIC0yMDQsOSArMjA0LDkgQEAKIAkgKiB0
aGUgcGFzc3dvcmQuCiAJICoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqLwogCi0Jc3RyY3B5KHVzZXJyZWFsbXNlcnYsIHVzZXIpOwot
CXN0cmNhdCh1c2VycmVhbG1zZXJ2LCByZWFsbSk7Ci0Jc3RyY2F0KHVzZXJyZWFsbXNlcnYsIHNl
cnZpY2UpOworCXN0cmxjcHkodXNlcnJlYWxtc2VydiwgdXNlciwgc2l6ZW9mKHVzZXJyZWFsbXNl
cnYpKTsKKwlzdHJsY2F0KHVzZXJyZWFsbXNlcnYsIHJlYWxtLCBzaXplb2YodXNlcnJlYWxtc2Vy
dikpOworCXN0cmxjYXQodXNlcnJlYWxtc2Vydiwgc2VydmljZSwgc2l6ZW9mKHVzZXJyZWFsbXNl
cnYpKTsKIAogCWhhc2hfb2Zmc2V0ID0gY2FjaGVfcGp3aGFzaCh1c2VycmVhbG1zZXJ2KTsKIApA
QCAtMjkwLDkgKzI5MCwxMiBAQAogCXJlc3VsdC0+YnVja2V0LnJlYWxtX29mZnQgPSB1c2VyX2xl
bmd0aDsKIAlyZXN1bHQtPmJ1Y2tldC5zZXJ2aWNlX29mZnQgPSB1c2VyX2xlbmd0aCArIHJlYWxt
X2xlbmd0aDsKIAotCXN0cmNweShyZXN1bHQtPmJ1Y2tldC5jcmVkcyArIHJlc3VsdC0+YnVja2V0
LnVzZXJfb2ZmdCwgdXNlcik7CQotCXN0cmNweShyZXN1bHQtPmJ1Y2tldC5jcmVkcyArIHJlc3Vs
dC0+YnVja2V0LnJlYWxtX29mZnQsIHJlYWxtKTsJCi0Jc3RyY3B5KHJlc3VsdC0+YnVja2V0LmNy
ZWRzICsgcmVzdWx0LT5idWNrZXQuc2VydmljZV9vZmZ0LCBzZXJ2aWNlKTsJCisJc3RybGNweShy
ZXN1bHQtPmJ1Y2tldC5jcmVkcyArIHJlc3VsdC0+YnVja2V0LnVzZXJfb2ZmdCwgdXNlciwKKwkJ
c2l6ZW9mKHJlc3VsdC0+YnVja2V0LmNyZWRzKSAtIHJlc3VsdC0+YnVja2V0LnVzZXJfb2ZmdCk7
CisJc3RybGNweShyZXN1bHQtPmJ1Y2tldC5jcmVkcyArIHJlc3VsdC0+YnVja2V0LnJlYWxtX29m
ZnQsIHJlYWxtLAorCQlzaXplb2YocmVzdWx0LT5idWNrZXQuY3JlZHMpIC0gcmVzdWx0LT5idWNr
ZXQucmVhbG1fb2ZmdCk7CisJc3RybGNweShyZXN1bHQtPmJ1Y2tldC5jcmVkcyArIHJlc3VsdC0+
YnVja2V0LnNlcnZpY2Vfb2ZmdCwgc2VydmljZSwKKwkJc2l6ZW9mKHJlc3VsdC0+YnVja2V0LmNy
ZWRzKSAtIHJlc3VsdC0+YnVja2V0LnNlcnZpY2Vfb2ZmdCk7CiAKIAltZW1jcHkocmVzdWx0LT5i
dWNrZXQucHdkX2RpZ2VzdCwgcHdkX2RpZ2VzdCwgMTYpOwogCXJlc3VsdC0+YnVja2V0LmNyZWF0
ZWQgPSBlcG9jaDsKSW5kZXg6IHNhc2xhdXRoZC9jb25maWd1cmUuaW4KPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvc2FzbC9zYXNsYXV0aGQvY29uZmlndXJl
LmluLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjQzCmRpZmYgLXUgLXIxLjQzIGNvbmZpZ3VyZS5p
bgotLS0gc2FzbGF1dGhkL2NvbmZpZ3VyZS5pbgkyNiBKdW4gMjAwMyAxMzo1MDoyNiAtMDAwMAkx
LjQzCisrKyBzYXNsYXV0aGQvY29uZmlndXJlLmluCTI3IEp1biAyMDAzIDE3OjU4OjU5IC0wMDAw
CkBAIC0xODUsNiArMTg1LDIwIEBACiBBQ19DSEVDS19GVU5DUyhnZXRob3N0bmFtZSBta2RpciBz
b2NrZXQgc3RyZHVwKQogQUNfQ0hFQ0tfRlVOQ1MoZ2V0c3BuYW0gZ2V0dXNlcnB3LCBicmVhaykK
IAorZG5sIENoZWNrIGZvciBzdHJsY3B5CitzYXNsX2N2X3N0cmxjcHk9bm8KK0FDX0NIRUNLX0ZV
TkMoc3RybGNweSwgW0FDX0RFRklORShIQVZFX1NUUkxDUFkpXSwgW3Nhc2xfY3Zfc3RybGNweT15
ZXNdKQoraWYgdGVzdCAkc2FzbF9jdl9zdHJsY3B5ID0geWVzOyB0aGVuCisJQ09NUEFUX09CSj0i
JENPTVBBVF9PQkogc3RybGNweS5vIgorZmkKKworZG5sIENoZWNrIGZvciBzdHJsY2F0CitzYXNs
X2N2X3N0cmxjYXQ9bm8KK0FDX0NIRUNLX0ZVTkMoc3RybGNhdCwgW0FDX0RFRklORShIQVZFX1NU
UkxDQVQpXSwgW3Nhc2xfY3Zfc3RybGNhdD15ZXNdKQoraWYgdGVzdCAkc2FzbF9jdl9zdHJsY2F0
ID0geWVzOyB0aGVuCisJQ09NUEFUX09CSj0iJENPTVBBVF9PQkogc3RybGNhdC5vIgorZmkKKwog
ZG5sIENoZWNrIGZvciBnZXRhZGRyaW5mbwogR0VUQUREUklORk9PQkpTPSIiCiBzYXNsX2N2X2dl
dGFkZHJpbmZvPW5vCkluZGV4OiBzYXNsYXV0aGQvZ2V0bmFtZWluZm8uYwo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJD
UyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zYXNsL3Nhc2xhdXRoZC9nZXRuYW1l
aW5mby5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjIKZGlmZiAtdSAtcjEuMiBnZXRuYW1laW5m
by5jCi0tLSBzYXNsYXV0aGQvZ2V0bmFtZWluZm8uYwkxMyBGZWIgMjAwMyAxOTo1NjowNyAtMDAw
MAkxLjIKKysrIHNhc2xhdXRoZC9nZXRuYW1laW5mby5jCTI3IEp1biAyMDAzIDE3OjU4OjU5IC0w
MDAwCkBAIC03MiwxOCArNzIsMTggQEAKICAgICBjaGFyIHRtcHNlcnZbMTZdOwogICAKICAgICBp
ZiAoc2VydikgewotCXNwcmludGYodG1wc2VydiwgIiVkIiwgbnRvaHMoc2luLT5zaW5fcG9ydCkp
OworCXNucHJpbnRmKHRtcHNlcnYsIHNpemVvZih0bXBzZXJ2KSwgIiVkIiwgbnRvaHMoc2luLT5z
aW5fcG9ydCkpOwogCWlmIChzdHJsZW4odG1wc2VydikgPiBzZXJ2bGVuKQogCSAgICByZXR1cm4g
RUFJX01FTU9SWTsKIAllbHNlCi0JICAgIHN0cmNweShzZXJ2LCB0bXBzZXJ2KTsKKwkgICAgc3Ry
bGNweShzZXJ2LCB0bXBzZXJ2LCBzaXplb2YodG1wc2VydikpOwogICAgIH0KICAgICBpZiAoaG9z
dCkgewogCWlmIChmbGFncyAmIE5JX05VTUVSSUNIT1NUKSB7CiAJICAgIGlmIChzdHJsZW4oaW5l
dF9udG9hKHNpbi0+c2luX2FkZHIpKSA+PSBob3N0bGVuKQogCQlyZXR1cm4gRUFJX01FTU9SWTsK
IAkgICAgZWxzZSB7Ci0JCXN0cmNweShob3N0LCBpbmV0X250b2Eoc2luLT5zaW5fYWRkcikpOwor
CQlzdHJsY3B5KGhvc3QsIGluZXRfbnRvYShzaW4tPnNpbl9hZGRyKSwgaG9zdGxlbik7CiAJCXJl
dHVybiAwOwogCSAgICB9CiAJfSBlbHNlIHsKQEAgLTkzLDcgKzkzLDcgQEAKIAkJaWYgKHN0cmxl
bihocC0+aF9uYW1lKSA+PSBob3N0bGVuKQogCQkgICAgcmV0dXJuIEVBSV9NRU1PUlk7CiAJCWVs
c2UgewotCQkgICAgc3RyY3B5KGhvc3QsIGhwLT5oX25hbWUpOworCQkgICAgc3RybGNweShob3N0
LCBocC0+aF9uYW1lLCBob3N0bGVuKTsKIAkJICAgIHJldHVybiAwOwogCQl9CiAJICAgIGVsc2UK
SW5kZXg6IHNhc2xhdXRoZC9pcGNfdW5peC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5k
cmV3L3N5c3RlbS9jdnMvc3JjL3Nhc2wvc2FzbGF1dGhkL2lwY191bml4LmMsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuNApkaWZmIC11IC1yMS40IGlwY191bml4LmMKLS0tIHNhc2xhdXRoZC9pcGNf
dW5peC5jCTIxIE1heSAyMDAzIDEyOjU4OjU5IC0wMDAwCTEuNAorKysgc2FzbGF1dGhkL2lwY191
bml4LmMJMjcgSnVuIDIwMDMgMTc6NTg6NTkgLTAwMDAKQEAgLTE1Miw3ICsxNTIsNyBAQAogCiAJ
dW5saW5rKHNvY2tfZmlsZSk7CiAJbWVtc2V0KCZzZXJ2ZXIsIDAsIHNpemVvZihzZXJ2ZXIpKTsK
LQlzdHJjcHkoc2VydmVyLnN1bl9wYXRoLCBzb2NrX2ZpbGUpOwkKKwlzdHJsY3B5KHNlcnZlci5z
dW5fcGF0aCwgc29ja19maWxlLCBzaXplb2Yoc2VydmVyLnN1bl9wYXRoKSk7CiAJc2VydmVyLnN1
bl9mYW1pbHkgPSBBRl9VTklYOwogCQogCWlmICgoc29ja19mZCA9IHNvY2tldChBRl9VTklYLCBT
T0NLX1NUUkVBTSwgMCkpID09IC0xKSB7CkluZGV4OiBzYXNsYXV0aGQvc3RybGNhdC5jCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IHNhc2xhdXRoZC9zdHJsY2F0LmMKZGlmZiAtTiBzYXNsYXV0aGQvc3Ry
bGNhdC5jCi0tLSAvZGV2L251bGwJMSBKYW4gMTk3MCAwMDowMDowMCAtMDAwMAorKysgc2FzbGF1
dGhkL3N0cmxjYXQuYwkyNyBKdW4gMjAwMyAxNzo1ODo1OSAtMDAwMApAQCAtMCwwICsxLDY2IEBA
CisvKgorICogQ29weXJpZ2h0IChjKSAxOTk4LTIwMDMgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNp
dHkuICBBbGwgcmlnaHRzIHJlc2VydmVkLgorICoKKyAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2Ug
aW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAorICogbW9kaWZpY2F0
aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25z
CisgKiBhcmUgbWV0OgorICoKKyAqIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBt
dXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0CisgKiAgICBub3RpY2UsIHRoaXMgbGlzdCBv
ZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuIAorICoKKyAqIDIuIFJl
ZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29w
eXJpZ2h0CisgKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9s
bG93aW5nIGRpc2NsYWltZXIgaW4KKyAqICAgIHRoZSBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhl
ciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUKKyAqICAgIGRpc3RyaWJ1dGlvbi4KKyAqCisg
KiAzLiBUaGUgbmFtZSAiQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkiIG11c3Qgbm90IGJlIHVz
ZWQgdG8KKyAqICAgIGVuZG9yc2Ugb3IgcHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhp
cyBzb2Z0d2FyZSB3aXRob3V0CisgKiAgICBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uIEZvciBw
ZXJtaXNzaW9uIG9yIGFueSBvdGhlciBsZWdhbAorICogICAgZGV0YWlscywgcGxlYXNlIGNvbnRh
Y3QgIAorICogICAgICBPZmZpY2Ugb2YgVGVjaG5vbG9neSBUcmFuc2ZlcgorICogICAgICBDYXJu
ZWdpZSBNZWxsb24gVW5pdmVyc2l0eQorICogICAgICA1MDAwIEZvcmJlcyBBdmVudWUKKyAqICAg
ICAgUGl0dHNidXJnaCwgUEEgIDE1MjEzLTM4OTAKKyAqICAgICAgKDQxMikgMjY4LTQzODcsIGZh
eDogKDQxMikgMjY4LTczOTUKKyAqICAgICAgdGVjaC10cmFuc2ZlckBhbmRyZXcuY211LmVkdQor
ICoKKyAqIDQuIFJlZGlzdHJpYnV0aW9ucyBvZiBhbnkgZm9ybSB3aGF0c29ldmVyIG11c3QgcmV0
YWluIHRoZSBmb2xsb3dpbmcKKyAqICAgIGFja25vd2xlZGdtZW50OgorICogICAgIlRoaXMgcHJv
ZHVjdCBpbmNsdWRlcyBzb2Z0d2FyZSBkZXZlbG9wZWQgYnkgQ29tcHV0aW5nIFNlcnZpY2VzCisg
KiAgICAgYXQgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkgKGh0dHA6Ly93d3cuY211LmVkdS9j
b21wdXRpbmcvKS4iCisgKgorICogQ0FSTkVHSUUgTUVMTE9OIFVOSVZFUlNJVFkgRElTQ0xBSU1T
IEFMTCBXQVJSQU5USUVTIFdJVEggUkVHQVJEIFRPCisgKiBUSElTIFNPRlRXQVJFLCBJTkNMVURJ
TkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkKKyAqIEFORCBGSVRO
RVNTLCBJTiBOTyBFVkVOVCBTSEFMTCBDQVJORUdJRSBNRUxMT04gVU5JVkVSU0lUWSBCRSBMSUFC
TEUKKyAqIEZPUiBBTlkgU1BFQ0lBTCwgSU5ESVJFQ1QgT1IgQ09OU0VRVUVOVElBTCBEQU1BR0VT
IE9SIEFOWSBEQU1BR0VTCisgKiBXSEFUU09FVkVSIFJFU1VMVElORyBGUk9NIExPU1MgT0YgVVNF
LCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4KKyAqIEFOIEFDVElPTiBPRiBDT05UUkFDVCwg
TkVHTElHRU5DRSBPUiBPVEhFUiBUT1JUSU9VUyBBQ1RJT04sIEFSSVNJTkcKKyAqIE9VVCBPRiBP
UiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUiBQRVJGT1JNQU5DRSBPRiBUSElTIFNPRlRX
QVJFLgorICoKKyAqICRJZCQKKyAqLworCisjaW5jbHVkZSA8Y29uZmlnLmg+CisKKyNpZm5kZWYg
SEFWRV9TVFJMQ0FUCisjaW5jbHVkZSA8c3RyaW5nLmg+CisKK3NpemVfdCBzYXNsX3N0cmxjYXQo
Y2hhciAqZHN0LCBjb25zdCBjaGFyICpzcmMsIHNpemVfdCBsZW4pCit7CisgICAgc2l6ZV90IGks
IGosIG87CisgICAgCisgICAgbyA9IHN0cmxlbihkc3QpOworICAgIGlmIChsZW4gPCBvICsgMSkK
KwlyZXR1cm4gbyArIHN0cmxlbihzcmMpOworICAgIGxlbiAtPSBvICsgMTsKKyAgICBmb3IgKGkg
PSAwLCBqID0gbzsgaSA8IGxlbjsgaSsrLCBqKyspIHsKKwlpZiAoKGRzdFtqXSA9IHNyY1tpXSkg
PT0gJ1wwJykgYnJlYWs7CisgICAgfQorICAgIGRzdFtqXSA9ICdcMCc7CisgICAgaWYgKHNyY1tp
XSA9PSAnXDAnKSB7CisJcmV0dXJuIGo7CisgICAgfSBlbHNlIHsKKwlyZXR1cm4gaiArIHN0cmxl
bihzcmMgKyBpKTsKKyAgICB9Cit9CisjZW5kaWYgLyogSEFWRV9TVFJMQ0FUICovCkluZGV4OiBz
YXNsYXV0aGQvc3RybGNweS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IHNhc2xhdXRoZC9zdHJsY3B5
LmMKZGlmZiAtTiBzYXNsYXV0aGQvc3RybGNweS5jCi0tLSAvZGV2L251bGwJMSBKYW4gMTk3MCAw
MDowMDowMCAtMDAwMAorKysgc2FzbGF1dGhkL3N0cmxjcHkuYwkyNyBKdW4gMjAwMyAxNzo1ODo1
OSAtMDAwMApAQCAtMCwwICsxLDcyIEBACisvKgorICogQ29weXJpZ2h0IChjKSAxOTk4LTIwMDMg
Q2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkuICBBbGwgcmlnaHRzIHJlc2VydmVkLgorICoKKyAq
IFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGgg
b3Igd2l0aG91dAorICogbW9kaWZpY2F0aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQg
dGhlIGZvbGxvd2luZyBjb25kaXRpb25zCisgKiBhcmUgbWV0OgorICoKKyAqIDEuIFJlZGlzdHJp
YnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0Cisg
KiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRp
c2NsYWltZXIuIAorICoKKyAqIDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBtdXN0
IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0CisgKiAgICBub3RpY2UsIHRoaXMgbGlzdCBv
ZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4KKyAqICAgIHRoZSBk
b2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0aGUKKyAq
ICAgIGRpc3RyaWJ1dGlvbi4KKyAqCisgKiAzLiBUaGUgbmFtZSAiQ2FybmVnaWUgTWVsbG9uIFVu
aXZlcnNpdHkiIG11c3Qgbm90IGJlIHVzZWQgdG8KKyAqICAgIGVuZG9yc2Ugb3IgcHJvbW90ZSBw
cm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0CisgKiAgICBwcmlvciB3
cml0dGVuIHBlcm1pc3Npb24uIEZvciBwZXJtaXNzaW9uIG9yIGFueSBvdGhlciBsZWdhbAorICog
ICAgZGV0YWlscywgcGxlYXNlIGNvbnRhY3QgIAorICogICAgICBPZmZpY2Ugb2YgVGVjaG5vbG9n
eSBUcmFuc2ZlcgorICogICAgICBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eQorICogICAgICA1
MDAwIEZvcmJlcyBBdmVudWUKKyAqICAgICAgUGl0dHNidXJnaCwgUEEgIDE1MjEzLTM4OTAKKyAq
ICAgICAgKDQxMikgMjY4LTQzODcsIGZheDogKDQxMikgMjY4LTczOTUKKyAqICAgICAgdGVjaC10
cmFuc2ZlckBhbmRyZXcuY211LmVkdQorICoKKyAqIDQuIFJlZGlzdHJpYnV0aW9ucyBvZiBhbnkg
Zm9ybSB3aGF0c29ldmVyIG11c3QgcmV0YWluIHRoZSBmb2xsb3dpbmcKKyAqICAgIGFja25vd2xl
ZGdtZW50OgorICogICAgIlRoaXMgcHJvZHVjdCBpbmNsdWRlcyBzb2Z0d2FyZSBkZXZlbG9wZWQg
YnkgQ29tcHV0aW5nIFNlcnZpY2VzCisgKiAgICAgYXQgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNp
dHkgKGh0dHA6Ly93d3cuY211LmVkdS9jb21wdXRpbmcvKS4iCisgKgorICogQ0FSTkVHSUUgTUVM
TE9OIFVOSVZFUlNJVFkgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEggUkVHQVJEIFRPCisg
KiBUSElTIFNPRlRXQVJFLCBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJD
SEFOVEFCSUxJVFkKKyAqIEFORCBGSVRORVNTLCBJTiBOTyBFVkVOVCBTSEFMTCBDQVJORUdJRSBN
RUxMT04gVU5JVkVSU0lUWSBCRSBMSUFCTEUKKyAqIEZPUiBBTlkgU1BFQ0lBTCwgSU5ESVJFQ1Qg
T1IgQ09OU0VRVUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTCisgKiBXSEFUU09FVkVSIFJF
U1VMVElORyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4KKyAq
IEFOIEFDVElPTiBPRiBDT05UUkFDVCwgTkVHTElHRU5DRSBPUiBPVEhFUiBUT1JUSU9VUyBBQ1RJ
T04sIEFSSVNJTkcKKyAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUiBQ
RVJGT1JNQU5DRSBPRiBUSElTIFNPRlRXQVJFLgorICoKKyAqICRJZCQKKyAqLworCisjaW5jbHVk
ZSA8Y29uZmlnLmg+CisKKyNpZm5kZWYgSEFWRV9TVFJMQ1BZCisjaW5jbHVkZSA8c3RyaW5nLmg+
CisKKy8qIHN0cmxjcHkgLS0gY29weSBzdHJpbmcgc21hcnRseS4KKyAqCisgKiBpIGJlbGlldmUv
aG9wZSB0aGlzIGlzIGNvbXBhdGlibGUgd2l0aCB0aGUgQlNEIHN0cmxjcHkoKS4gCisgKi8KK3Np
emVfdCBzYXNsX3N0cmxjcHkoY2hhciAqZHN0LCBjb25zdCBjaGFyICpzcmMsIHNpemVfdCBsZW4p
Cit7CisgICAgc2l6ZV90IG47CisKKyAgICBpZiAobGVuIDw9IDApIHsKKyAgICAgICAgLyogd2Ug
Y2FuJ3QgZG8gYW55dGhpbmcgISAqLworICAgICAgICByZXR1cm4gc3RybGVuKHNyYyk7CisgICAg
fQorCisgICAgLyogYXNzZXJ0KGxlbiA+PSAxKTsgKi8KKyAgICBmb3IgKG4gPSAwOyBuIDwgbGVu
LTE7IG4rKykgeworCWlmICgoZHN0W25dID0gc3JjW25dKSA9PSAnXDAnKSBicmVhazsKKyAgICB9
CisgICAgaWYgKG4gPj0gbGVuLTEpIHsKKwkvKiByYW4gb3V0IG9mIHNwYWNlICovCisJZHN0W25d
ID0gJ1wwJzsKKwl3aGlsZShzcmNbbl0pIG4rKzsKKyAgICB9CisgICAgcmV0dXJuIG47Cit9Cisj
ZW5kaWYgLyogSEFWRV9TVFJMQ1BZICovCkluZGV4OiBzYXNsYXV0aGQvdGVzdHNhc2xhdXRoZC5j
Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3Nhc2wvc2Fz
bGF1dGhkL3Rlc3RzYXNsYXV0aGQuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xMgpkaWZmIC11
IC1yMS4xMiB0ZXN0c2FzbGF1dGhkLmMKLS0tIHNhc2xhdXRoZC90ZXN0c2FzbGF1dGhkLmMJMjgg
TWFyIDIwMDMgMTk6NTk6MjQgLTAwMDAJMS4xMgorKysgc2FzbGF1dGhkL3Rlc3RzYXNsYXV0aGQu
YwkyNyBKdW4gMjAwMyAxNzo1ODo1OSAtMDAwMApAQCAtMTI0LDggKzEyNCw4IEBACiAJaWYgKHN0
cmxlbihQQVRIX1NBU0xBVVRIRF9SVU5ESVIpICsgNCArIDEgPiBzaXplb2YocHdwYXRoKSkKIAkg
ICAgcmV0dXJuIC0xOwogCi0Jc3RyY3B5KHB3cGF0aCwgUEFUSF9TQVNMQVVUSERfUlVORElSKTsK
LQlzdHJjYXQocHdwYXRoLCAiL211eCIpOworCXN0cmxjcHkocHdwYXRoLCBQQVRIX1NBU0xBVVRI
RF9SVU5ESVIsIHNpemVvZihwd3BhdGgpKTsKKwlzdHJsY2F0KHB3cGF0aCwgIi9tdXgiLCBzaXpl
b2YocHdwYXRoKSk7CiAgICAgfQogCiAgICAgLyoKSW5kZXg6IHNhc2xkYi9kYl90ZXN0dzMyLmMK
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvc2FzbC9zYXNs
ZGIvZGJfdGVzdHczMi5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjMKZGlmZiAtdSAtcjEuMyBk
Yl90ZXN0dzMyLmMKLS0tIHNhc2xkYi9kYl90ZXN0dzMyLmMJMTMgRmViIDIwMDMgMTk6NTY6MTQg
LTAwMDAJMS4zCisrKyBzYXNsZGIvZGJfdGVzdHczMi5jCTI3IEp1biAyMDAzIDE3OjU5OjAwIC0w
MDAwCkBAIC04NCw3ICs4NCw3IEBACiAgIGlmICghYXV0aF9pZGVudGl0eSB8fCAhc2VjcmV0KQog
ICAgIHJldHVybiBTQVNMX0ZBSUw7CiAKLSAgc3RyY3B5KGZpbGVuYW1lLCAiYzpcXHRtcFxcc2Fz
bGRhdGEudHh0Iik7CisgIHN0cmxjcHkoZmlsZW5hbWUsICJjOlxcdG1wXFxzYXNsZGF0YS50eHQi
LCBzaXplb2YoZmlsZW5hbWUpKTsKICAgZGIgPSBmb3BlbihmaWxlbmFtZSwgInJiIik7CiAKICAg
aWYgKCEgZGIpIHsKQEAgLTEzNiw3ICsxMzYsNyBAQAogICBpZiAoIWF1dGhfaWRlbnRpdHkpCiAg
ICAgICByZXR1cm4gU0FTTF9GQUlMOwogCi0gIHN0cmNweShmaWxlbmFtZSwgImM6XFx0bXBcXHNh
c2xkYXRhLnR4dCIpOworICBzdHJsY3B5KGZpbGVuYW1lLCAiYzpcXHRtcFxcc2FzbGRhdGEudHh0
Iiwgc2l6ZW9mKGZpbGVuYW1lKSk7CiAgIGRiID0gZm9wZW4oZmlsZW5hbWUsICJ3YiIpOwogCiAg
IGlmICghIGRiKSB7Cg==
</data>        

          </attachment>
      

    </bug>

</bugzilla>