<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>2726</bug_id>
          
          <creation_ts>2005-10-12 20:55 EDT</creation_ts>
          <short_desc>create BDB hash backend for cyrusdb</short_desc>
          <delta_ts>2010-10-18 12:43:09 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>lib</component>
          <version>2.2.x</version>
          <rep_platform>Other</rep_platform>
          <op_sys>other</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          <priority>P2</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Ken Murchison">murch@andrew.cmu.edu</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          
          <qa_contact name="The Cyrus Bugzilla List">cyrus-bugzilla@lists.andrew.cmu.edu</qa_contact>

      

      

      
          <long_desc isprivate="0">
            <who name="Ken Murchison">murch@andrew.cmu.edu</who>
            <bug_when>2005-10-12 20:55:44 EDT</bug_when>
            <thetext>deliver.db gets excessively large and has multiple locks on pages.  Using
DB_HASH rather than DB_BTREE might be a better alternative.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">murch@andrew.cmu.edu</who>
            <bug_when>2005-10-12 20:59:22 EDT</bug_when>
            <thetext>Created an attachment (id=384)
DB_HASH implementation for cyrusdb
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">murch@andrew.cmu.edu</who>
            <bug_when>2006-01-03 21:14:49 EDT</bug_when>
            <thetext>committed to both 2.2 and 2.3</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>384</attachid>
            <date>2005-10-12 20:59 EDT</date>
            <desc>DB_HASH implementation for cyrusdb</desc>
            <filename>cyrusdb_berkeley_hash.patch</filename>
            <type>text/plain</type>
            <size>6878</size>
            <attacher>murch@andrew.cmu.edu</attacher>
            
              <data encoding="base64">SW5kZXg6IGN5cnVzZGIuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0v
Y3ZzL3NyYy9jeXJ1cy9saWIvY3lydXNkYi5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjkKZGlm
ZiAtdSAtcjEuOSBjeXJ1c2RiLmMKLS0tIGN5cnVzZGIuYwkyMCBKYW4gMjAwNCAwMToxMTowMyAt
MDAwMAkxLjkKKysrIGN5cnVzZGIuYwkxMyBPY3QgMjAwNSAwMDo1NjozMCAtMDAwMApAQCAtNjUs
NiArNjUsOCBAQAogI2lmZGVmIEhBVkVfQkRCCiAgICAgJmN5cnVzZGJfYmVya2VsZXksCiAgICAg
JmN5cnVzZGJfYmVya2VsZXlfbm9zeW5jLAorICAgICZjeXJ1c2RiX2JlcmtlbGV5X2hhc2gsCisg
ICAgJmN5cnVzZGJfYmVya2VsZXlfaGFzaF9ub3N5bmMsCiAjZW5kaWYKICAgICAmY3lydXNkYl9m
bGF0LAogICAgICZjeXJ1c2RiX3NraXBsaXN0LApJbmRleDogY3lydXNkYi5oCj09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0K
UkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2xpYi9jeXJ1c2RiLmgs
dgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjkKZGlmZiAtdSAtcjEuMjkgY3lydXNkYi5oCi0tLSBj
eXJ1c2RiLmgJMTEgTWFyIDIwMDQgMTg6MzY6NDQgLTAwMDAJMS4yOQorKysgY3lydXNkYi5oCTEz
IE9jdCAyMDA1IDAwOjU2OjMwIC0wMDAwCkBAIC0xODMsNiArMTgzLDggQEAKICAqIGlmIGxpYmN5
cnVzIHdhcyBub3QgYnVpbHQgd2l0aCBzdXBwb3J0IGZvciB0aGVtICovCiBleHRlcm4gc3RydWN0
IGN5cnVzZGJfYmFja2VuZCBjeXJ1c2RiX2JlcmtlbGV5OwogZXh0ZXJuIHN0cnVjdCBjeXJ1c2Ri
X2JhY2tlbmQgY3lydXNkYl9iZXJrZWxleV9ub3N5bmM7CitleHRlcm4gc3RydWN0IGN5cnVzZGJf
YmFja2VuZCBjeXJ1c2RiX2JlcmtlbGV5X2hhc2g7CitleHRlcm4gc3RydWN0IGN5cnVzZGJfYmFj
a2VuZCBjeXJ1c2RiX2JlcmtlbGV5X2hhc2hfbm9zeW5jOwogZXh0ZXJuIHN0cnVjdCBjeXJ1c2Ri
X2JhY2tlbmQgY3lydXNkYl9mbGF0OwogZXh0ZXJuIHN0cnVjdCBjeXJ1c2RiX2JhY2tlbmQgY3ly
dXNkYl9za2lwbGlzdDsKIGV4dGVybiBzdHJ1Y3QgY3lydXNkYl9iYWNrZW5kIGN5cnVzZGJfcXVv
dGFsZWdhY3k7CkluZGV4OiBjeXJ1c2RiX2JlcmtlbGV5LmMKPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
L2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvY3lydXMvbGliL2N5cnVzZGJfYmVya2VsZXkuYyx2
CnJldHJpZXZpbmcgcmV2aXNpb24gMS45CmRpZmYgLXUgLXIxLjkgY3lydXNkYl9iZXJrZWxleS5j
Ci0tLSBjeXJ1c2RiX2JlcmtlbGV5LmMJMTcgTm92IDIwMDQgMTU6NDE6MzEgLTAwMDAJMS45Cisr
KyBjeXJ1c2RiX2JlcmtlbGV5LmMJMTMgT2N0IDIwMDUgMDA6NTY6MzAgLTAwMDAKQEAgLTM2Miw3
ICszNjIsMTcgQEAKICAgICByZXR1cm4gMDsKIH0KIAotc3RhdGljIGludCBteW9wZW4oY29uc3Qg
Y2hhciAqZm5hbWUsIGludCBmbGFncywgc3RydWN0IGRiICoqcmV0KQorc3RhdGljIGludCBvcGVu
X2J0cmVlKGNvbnN0IGNoYXIgKmZuYW1lLCBpbnQgZmxhZ3MsIHN0cnVjdCBkYiAqKnJldCkKK3sK
KyAgICByZXR1cm4gbXlvcGVuKGZuYW1lLCBEQl9CVFJFRSwgZmxhZ3MsIHJldCk7Cit9CisKK3N0
YXRpYyBpbnQgb3Blbl9oYXNoKGNvbnN0IGNoYXIgKmZuYW1lLCBpbnQgZmxhZ3MsIHN0cnVjdCBk
YiAqKnJldCkKK3sKKyAgICByZXR1cm4gbXlvcGVuKGZuYW1lLCBEQl9IQVNILCBmbGFncywgcmV0
KTsKK30KKworc3RhdGljIGludCBteW9wZW4oY29uc3QgY2hhciAqZm5hbWUsIERCVFlQRSB0eXBl
LCBpbnQgZmxhZ3MsIHN0cnVjdCBkYiAqKnJldCkKIHsKICAgICBEQiAqZGIgPSBOVUxMOwogICAg
IGludCByOwpAQCAtMzgwLDkgKzM5MCw5IEBACiAgICAgLyogeHh4IHNldCBjb21wYXJhdG9yISAq
LwogCiAjaWYgREJfVkVSU0lPTl9NQUpPUiA9PSA0ICYmIERCX1ZFUlNJT05fTUlOT1IgPj0gMQot
ICAgIHIgPSBkYi0+b3BlbihkYiwgTlVMTCwgZm5hbWUsIE5VTEwsIERCX0JUUkVFLCBkYmZsYWdz
IHwgREJfQVVUT19DT01NSVQsIDA2NjQpOworICAgIHIgPSBkYi0+b3BlbihkYiwgTlVMTCwgZm5h
bWUsIE5VTEwsIHR5cGUsIGRiZmxhZ3MgfCBEQl9BVVRPX0NPTU1JVCwgMDY2NCk7CiAjZWxzZQot
ICAgIHIgPSBkYi0+b3BlbihkYiwgZm5hbWUsIE5VTEwsIERCX0JUUkVFLCBkYmZsYWdzLCAwNjY0
KTsKKyAgICByID0gZGItPm9wZW4oZGIsIGZuYW1lLCBOVUxMLCB0eXBlLCBkYmZsYWdzLCAwNjY0
KTsKICNlbmRpZgogCiAgICAgaWYgKHIgIT0gMCkgewpAQCAtOTU3LDcgKzk2Nyw3IEBACiAgICAg
Jm15c3luYywKICAgICAmbXlhcmNoaXZlLAogCi0gICAgJm15b3BlbiwKKyAgICAmb3Blbl9oYXNo
LAogICAgICZteWNsb3NlLAogCiAgICAgJmZldGNoLApAQCAtOTgzLDcgKzk5Myw1OSBAQAogICAg
ICZteXN5bmMsCiAgICAgJm15YXJjaGl2ZSwKIAotICAgICZteW9wZW4sCisgICAgJm9wZW5faGFz
aCwKKyAgICAmbXljbG9zZSwKKworICAgICZmZXRjaCwKKyAgICAmZmV0Y2hsb2NrLAorICAgICZm
b3JlYWNoLAorICAgICZjcmVhdGVfbm9zeW5jLAorICAgICZzdG9yZV9ub3N5bmMsCisgICAgJmRl
bGV0ZV9ub3N5bmMsCisKKyAgICAmY29tbWl0X25vc3luYywKKyAgICAmYWJvcnRfdHhuLAorCisg
ICAgTlVMTCwKKyAgICBOVUxMCit9OworCitzdHJ1Y3QgY3lydXNkYl9iYWNrZW5kIGN5cnVzZGJf
aGFzaF9iZXJrZWxleSA9IAoreworICAgICJiZXJrZWxleV9oYXNoIiwJCS8qIG5hbWUgKi8KKwor
ICAgICZpbml0LAorICAgICZkb25lLAorICAgICZteXN5bmMsCisgICAgJm15YXJjaGl2ZSwKKwor
ICAgICZvcGVuX2hhc2gsCisgICAgJm15Y2xvc2UsCisKKyAgICAmZmV0Y2gsCisgICAgJmZldGNo
bG9jaywKKyAgICAmZm9yZWFjaCwKKyAgICAmY3JlYXRlLAorICAgICZzdG9yZSwKKyAgICAmZGVs
ZXRlLAorCisgICAgJmNvbW1pdF90eG4sCisgICAgJmFib3J0X3R4biwKKyAgICAKKyAgICBOVUxM
LAorICAgIE5VTEwKK307CisKK3N0cnVjdCBjeXJ1c2RiX2JhY2tlbmQgY3lydXNkYl9iZXJrZWxl
eV9oYXNoX25vc3luYyA9IAoreworICAgICJiZXJrZWxleS1oYXNoLW5vc3luYyIsCS8qIG5hbWUg
Ki8KKworICAgICZpbml0LAorICAgICZkb25lLAorICAgICZteXN5bmMsCisgICAgJm15YXJjaGl2
ZSwKKworICAgICZvcGVuX2hhc2gsCiAgICAgJm15Y2xvc2UsCiAKICAgICAmZmV0Y2gsCkluZGV4
OiBpbWFwb3B0aW9ucwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3Zz
L3NyYy9jeXJ1cy9saWIvaW1hcG9wdGlvbnMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMzMKZGlm
ZiAtdSAtcjEuMzMgaW1hcG9wdGlvbnMKLS0tIGltYXBvcHRpb25zCTIgSnVuIDIwMDUgMTU6NDc6
NTkgLTAwMDAJMS4zMworKysgaW1hcG9wdGlvbnMJMTMgT2N0IDIwMDUgMDA6NTY6MzAgLTAwMDAK
QEAgLTE0NCw3ICsxNDQsNyBAQAogICAgYWZmZWN0IExNVFAgZGVsaXZlcnkgb2YgbWVzc2FnZXMg
ZGlyZWN0bHkgdG8gbWFpbGJveGVzIHZpYQogICAgcGx1cy1hZGRyZXNzaW5nLiAqLwogCi17ICJh
bm5vdGF0aW9uX2RiIiwgInNraXBsaXN0IiwgU1RSSU5HTElTVCgiYmVya2VsZXkiLCAic2tpcGxp
c3QiKX0KK3sgImFubm90YXRpb25fZGIiLCAic2tpcGxpc3QiLCBTVFJJTkdMSVNUKCJiZXJrZWxl
eSIsICJiZXJrZWxleS1oYXNoIiwgInNraXBsaXN0Iil9CiAvKiBUaGUgY3lydXNkYiBiYWNrZW5k
IHRvIHVzZSBmb3IgbWFpbGJveCBhbm5vdGF0aW9ucy4gKi8KIAogeyAiYXV0aF9tZWNoIiwgInVu
aXgiLCBTVFJJTkdMSVNUKCJ1bml4IiwgInB0cyIsICJrcmIiLCAia3JiNSIpfQpAQCAtMTk1LDcg
KzE5NSw3IEBACiB7ICJkZWxldGVyaWdodCIsICJjIiwgU1RSSU5HIH0KIC8qIFRoZSByaWdodCB0
aGF0IGEgdXNlciBuZWVkcyB0byBkZWxldGUgYSBtYWlsYm94LiAqLwogCi17ICJkdXBsaWNhdGVf
ZGIiLCAiYmVya2VsZXktbm9zeW5jIiwgU1RSSU5HTElTVCgiYmVya2VsZXkiLCAiYmVya2VsZXkt
bm9zeW5jIiwgInNraXBsaXN0Iil9Cit7ICJkdXBsaWNhdGVfZGIiLCAiYmVya2VsZXktbm9zeW5j
IiwgU1RSSU5HTElTVCgiYmVya2VsZXkiLCAiYmVya2VsZXktbm9zeW5jIiwgImJlcmtlbGV5LWhh
c2giLCAiYmVya2VsZXktaGFzaC1ub3N5bmMiLCAic2tpcGxpc3QiKX0KIC8qIFRoZSBjeXJ1c2Ri
IGJhY2tlbmQgdG8gdXNlIGZvciB0aGUgZHVwbGljYXRlIGRlbGl2ZXJ5IHN1cHByZXNzaW9uCiAg
ICBhbmQgc2lldmUuICovCiAKQEAgLTQ1OSw3ICs0NTksNyBAQAogICAgbWVzc2FnZXMgbGFyZ2Vy
IHRoYW4gXGZJbWF4bWVzc2FnZXNpemVcZlIgYnl0ZXMuICBJZiBzZXQgdG8gMCwgdGhpcwogICAg
d2lsbCBhbGxvdyBtZXNzYWdlcyBvZiBhbnkgc2l6ZSAodGhlIGRlZmF1bHQpLiAqLwogCi17ICJt
Ym94bGlzdF9kYiIsICJza2lwbGlzdCIsIFNUUklOR0xJU1QoImZsYXQiLCAiYmVya2VsZXkiLCAi
c2tpcGxpc3QiKX0KK3sgIm1ib3hsaXN0X2RiIiwgInNraXBsaXN0IiwgU1RSSU5HTElTVCgiZmxh
dCIsICJiZXJrZWxleSIsICJiZXJrZWxleS1oYXNoIiwgInNraXBsaXN0Iil9CiAvKiBUaGUgY3ly
dXNkYiBiYWNrZW5kIHRvIHVzZSBmb3IgdGhlIG1haWxib3ggbGlzdC4gKi8KIAogIyB4eHggYmFk
bHkgd29yZGVkCkBAIC02NjIsNyArNjYyLDcgQEAKIC8qIFVuaXggZG9tYWluIHNvY2tldCB0aGF0
IHB0bG9hZGVyIGxpc3RlbnMgb24uCiAgICAoZGVmYXVsdHMgdG8gY29uZmlnZGlyL3B0Y2xpZW50
L3B0c29jaykgKi8KIAoteyAicHRzY2FjaGVfZGIiLCAiYmVya2VsZXkiLCBTVFJJTkdMSVNUKCJi
ZXJrZWxleSIsICJza2lwbGlzdCIpfQoreyAicHRzY2FjaGVfZGIiLCAiYmVya2VsZXkiLCBTVFJJ
TkdMSVNUKCJiZXJrZWxleSIsICJiZXJrZWxleS1oYXNoIiwgInNraXBsaXN0Iil9CiAvKiBUaGUg
Y3lydXNkYiBiYWNrZW5kIHRvIHVzZSBmb3IgdGhlIHB0cyBjYWNoZS4gKi8KIAogeyAicHRzY2Fj
aGVfdGltZW91dCIsIDEwODAwLCBJTlQgfQpAQCAtNjc5LDcgKzY3OSw3IEBACiAgICBzdHJpcCB0
aGUgZGVmYXVsdCByZWFsbSBmcm9tIHRoZSB1c2VyaWQgKHRoaXMgZG9lcyBub3QgYWZmZWN0IHRo
ZSBzdHJpcHBpbmcKICAgIG9mIHJlYWxtcyBzcGVjaWZpZWQgYnkgdGhlIGFmc3B0c19sb2NhbHJl
YWxtcyBvcHRpb24pICovCiAKLXsgInF1b3RhX2RiIiwgInF1b3RhbGVnYWN5IiwgU1RSSU5HTElT
VCgiZmxhdCIsICJiZXJrZWxleSIsICJza2lwbGlzdCIsICJxdW90YWxlZ2FjeSIpfQoreyAicXVv
dGFfZGIiLCAicXVvdGFsZWdhY3kiLCBTVFJJTkdMSVNUKCJmbGF0IiwgImJlcmtlbGV5IiwgImJl
cmtlbGV5LWhhc2giLCAic2tpcGxpc3QiLCAicXVvdGFsZWdhY3kiKX0KIC8qIFRoZSBjeXJ1c2Ri
IGJhY2tlbmQgdG8gdXNlIGZvciBxdW90YXMuICovCiAKIHsgInF1b3Rhd2FybiIsIDkwLCBJTlQg
fQpAQCAtNzM3LDcgKzczNyw3IEBACiAvKiBUaGUgbWVjaGFuaXNtIHVzZWQgYnkgdGhlIHNlcnZl
ciB0byB2ZXJpZnkgcGxhaW50ZXh0IHBhc3N3b3Jkcy4gCiAgICBQb3NzaWJsZSB2YWx1ZXMgaW5j
bHVkZSAiYXV4cHJvcCIsICJzYXNsYXV0aGQiLCBhbmQgInB3Y2hlY2siLiAqLwogCi17ICJzZWVu
c3RhdGVfZGIiLCAic2tpcGxpc3QiLCBTVFJJTkdMSVNUKCJmbGF0IiwgImJlcmtlbGV5IiwgInNr
aXBsaXN0Iil9Cit7ICJzZWVuc3RhdGVfZGIiLCAic2tpcGxpc3QiLCBTVFJJTkdMSVNUKCJmbGF0
IiwgImJlcmtlbGV5IiwgImJlcmtlbGV5LWhhc2giLCAic2tpcGxpc3QiKX0KIC8qIFRoZSBjeXJ1
c2RiIGJhY2tlbmQgdG8gdXNlIGZvciB0aGUgc2VlbiBzdGF0ZS4gKi8KIAogeyAic2VuZG1haWwi
LCAiL3Vzci9saWIvc2VuZG1haWwiLCBTVFJJTkcgfQpAQCAtNzk0LDcgKzc5NCw3IEBACiAgICBr
ZXkuICBUaGlzIG9wdGlvbiBpcyBwYXNzZWQgdG8gdGhlIFNBU0wgbGlicmFyeSBhbmQgb3ZlcnJp
ZGVzIGl0cwogICAgZGVmYXVsdCBzZXR0aW5nLiAqLwogCi17ICJzdWJzY3JpcHRpb25fZGIiLCAi
ZmxhdCIsIFNUUklOR0xJU1QoImZsYXQiLCAiYmVya2VsZXkiLCAic2tpcGxpc3QiKX0KK3sgInN1
YnNjcmlwdGlvbl9kYiIsICJmbGF0IiwgU1RSSU5HTElTVCgiZmxhdCIsICJiZXJrZWxleSIsICJi
ZXJrZWxleS1oYXNoIiwgInNraXBsaXN0Iil9CiAvKiBUaGUgY3lydXNkYiBiYWNrZW5kIHRvIHVz
ZSBmb3IgdGhlIHN1YnNjcmlwdGlvbnMgbGlzdC4gKi8KIAogeyAic3lzbG9nX3ByZWZpeCIsIE5V
TEwsIFNUUklORyB9CkBAIC04MTUsNyArODE1LDcgQEAKICAgIGhhdmUgZmlsZW5hbWVzIHdpdGgg
dGhlIGhhc2hlZCB2YWx1ZSBvZiB0aGUgY2VydGlmaWNhdGUgKHNlZQogICAgb3BlbnNzbChYWFgp
KS4gKi8KIAoteyAidGxzY2FjaGVfZGIiLCAiYmVya2VsZXktbm9zeW5jIiwgU1RSSU5HTElTVCgi
YmVya2VsZXkiLCAiYmVya2VsZXktbm9zeW5jIiwgInNraXBsaXN0Iil9Cit7ICJ0bHNjYWNoZV9k
YiIsICJiZXJrZWxleS1ub3N5bmMiLCBTVFJJTkdMSVNUKCJiZXJrZWxleSIsICJiZXJrZWxleS1u
b3N5bmMiLCAiYmVya2VsZXktaGFzaCIsICJiZXJrZWxleS1oYXNoLW5vc3luYyIsICJza2lwbGlz
dCIpfQogLyogVGhlIGN5cnVzZGIgYmFja2VuZCB0byB1c2UgZm9yIHRoZSBUTFMgY2FjaGUuICov
CiAKIHsgInRsc19jZXJ0X2ZpbGUiLCBOVUxMLCBTVFJJTkcgfQo=
</data>        

          </attachment>
      

    </bug>

</bugzilla>