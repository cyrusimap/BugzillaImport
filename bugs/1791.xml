<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>1791</bug_id>
          
          <creation_ts>2003-01-29 16:38 EDT</creation_ts>
          <short_desc>auth_ldap should use the service name</short_desc>
          <delta_ts>2010-10-25 18:46:31 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus SASL</product>
          <component>saslauthd</component>
          <version>2.1.x</version>
          <rep_platform>Other</rep_platform>
          <op_sys>other</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          <priority>P1</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Rob Siemborski">rjs3@andrew.cmu.edu</reporter>
          <assigned_to name="Rob Siemborski">rjs3@andrew.cmu.edu</assigned_to>
          <cc>igor@ipass.net</cc>
    
    <cc>psacha@blue-cable.net</cc>
          

      

      

      
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-01-29 16:38:22 EDT</bug_when>
            <thetext>Philipp Sacha Writes&gt;&gt;

I am using pam_ldap to authenticate user for a cyrus mailserver to 
distinguish between users which may use only the POP3 service or both 
the POP3 and IMAP services. pam_ldap offers this possibilty in using a 
triple (uid, password, service) for authentication.

Therefor i have an LDAPFilter (imap=y) for users who are allowed to use 
POP3 and IMAP service. But as far as i have seen the saslauthd ldap 
module does not make use of the service (imap or pop). If there should 
be an upcoming implementation regarding the service for the ldap module 
i could do some testing.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-01-29 17:14:37 EDT</bug_when>
            <thetext>Rob, are you handling this one?  I can take care of this one in the next few 
days.  Most changes will be in lak.c.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-01-29 17:15:25 EDT</bug_when>
            <thetext>I&apos;d rather leave it to you... I just posted it to bugzilla so it wouldn&apos;t be
forgotton after Phillip suggested it.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-01-29 17:16:46 EDT</bug_when>
            <thetext>I&apos;ll work on it.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-01-31 14:19:56 EDT</bug_when>
            <thetext>Created an attachment (id=107)
Patched file
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-01-31 14:20:32 EDT</bug_when>
            <thetext>Created an attachment (id=108)
lak.h
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-01-31 14:21:37 EDT</bug_when>
            <thetext>Created an attachment (id=109)
auth_ldap.c
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-01-31 14:43:00 EDT</bug_when>
            <thetext>Created an attachment (id=110)
lak.c
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-01-31 14:44:29 EDT</bug_when>
            <thetext>Rob,

I attached lak.[ch] and auth_ldap.c.
This patch includes:

- Group support as suggected by Andreas F. Bobak &lt;bobak@abstrakt.ch&gt;
  Added support for users associated with groups. This is done by
  adding two new configuration parameters, &apos;ldap_group_dn&apos; and
  &apos;ldap_group_attribute&apos;. If the &apos;ldap_group_dn&apos; parameter is set,
  auth_ldap will do a compare on the group attribute (defaults to
  &apos;uniqueMember&apos;) in the given group dn with the user dn.
  This way the behaviour is similar to the Apache LDAP auth module in
  conjunction with the parameter &quot;require group&quot;.
  
  (I enhanced his patch to make it work with all ldap_auth_methods (not tested))

- new config param ldap_password_attr.  This parameter specifies an attribute
  used for password verification.  Default is userPassword.
- new tokens for ldap_filter and ldap_group_dn: %s - service name, %d - domain
  name (derived from %u host portion), %U - username (derived from %u user
  portion)
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-02-05 16:58:37 EDT</bug_when>
            <thetext>Are there documentation patches to go with this?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-05 17:04:38 EDT</bug_when>
            <thetext>No.  More fixes and enhancements are coming up so I&apos;ll update docs once I 
finish up with everything.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-02-05 17:37:36 EDT</bug_when>
            <thetext>In that case I&apos;m inclined to wait until all the changes are together.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-07 18:31:19 EDT</bug_when>
            <thetext>Created an attachment (id=113)
lak.c
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-07 18:31:46 EDT</bug_when>
            <thetext>Created an attachment (id=114)
LDAP_SASLAUTHD
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-07 20:13:48 EDT</bug_when>
            <thetext>- Group support as suggected by Andreas F. Bobak &lt;bobak@abstrakt.ch&gt;  Added 
support for users associated with groups. This is done by adding two new 
configuration parameters, &apos;ldap_group_dn&apos; and &apos;ldap_group_attribute&apos;. If 
the &apos;ldap_group_dn&apos; parameter is set, auth_ldap will do a compare on the group 
attribute (defaults to &apos;uniqueMember&apos;) in the given group dn with the user dn. 
This way the behaviour is similar to the Apache LDAP auth module in 
conjunction with the parameter &quot;require group&quot;. (I enhanced his patch to make 
it work with all ldap_auth_methods (not tested)) 

- new config param ldap_password_attr.  This parameter specifies an attribute 
used for password verification.  Default is userPassword.

- new substitution tokens available:
  %U   = user part of %u
  %d   = domain part of %u if available
  %1-9 = domain tokens (%1 = tld, %2 = domain when %d = domain.tld)
  %s   = service

- token substitution can now used in ldap_filter, ldap_search_base and 
ldap_group_dn parameters (Kervin L. Pierre &lt;kervin@blueprint-tech.com&gt; asked 
for ldap_search_base substitution)

- Some poeple reported that after LDAP_TIMEOUT, saslauthd stop 
authenticating.  auth_ldap will now reset ldap connection after LDAP_TIMEOUT.

- fix for bug #1804

Can you look thru the code and let me know if you see something funny 
(lak_domtok() was a challange).</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-02-10 13:03:49 EDT</bug_when>
            <thetext>I think there&apos;s a problem with the second strncat in lak_escape.

If we escape one character, but then strpbrk() returns null on a susequent loop,
we&apos;ll break out of the loop, and we&apos;ll use n for what is passed to strncat and not  
the actual number of characters left in the buffer, which I believe is end-ptr.

Personally I find the use of strncat to prevent buffer overflows tremendouly
confusing, so if this isn&apos;t your goal here let me know.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-02-10 13:08:00 EDT</bug_when>
            <thetext>more problems... lak_domtok() uses strtok() which is not threadsafe.

I know we&apos;re not confident the lak api is threadsafe anyway, but we shouldn&apos;t be
causing ourselves problems ;)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-10 13:41:07 EDT</bug_when>
            <thetext>if (ptr&lt;end)
         strncat(buf, ptr, end-ptr);

is more appropriate in lak_escape().  I&apos;ll make the change and submit.

I wanted lak_escape() to escape n characters rather than the whole string.  
This is why I needed to use strncat.  I guess I could have built the string 
before it was passed to lak_escape.

Plz let me know if you know of a better way.  Poeple want to do strange things, 
so token management is becoming more complicated.  I wonder if there is an api 
somewhere which deals with this stuff better.
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-10 13:44:12 EDT</bug_when>
            <thetext>How about strtok_r?  I can proly rewrite it to use strchr.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-02-10 14:20:35 EDT</bug_when>
            <thetext>This got posted to another bug first, argh.

Hmm, I wonder if what we really want is

(n * 5 + 1) - strlen(buf)

i.e. (size of buffer) - (used buffer)
---

strtok_r is fine.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-10 15:21:02 EDT</bug_when>
            <thetext>I think this will cause problems.

If you have a very long buf (char *s in this case) and you only want to escape 
a first few chars, we will proly run into buffer overflow.  We can count the 
number of characters we need to escape and then calculate the buffer size.  
(n*5+1) is generous but safe.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-02-10 15:33:07 EDT</bug_when>
            <thetext>but if the first few characters are already used, then using 5*n+1 will allow
strncat to overflow.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-10 15:59:47 EDT</bug_when>
            <thetext>Hmmm,

lets say
*s = &apos;igor@do*a&amp;n.tld&apos;
n = 8;

We&apos;ll have:
buf = malloc(8*5+1);
*ptr will point to &apos;i&apos;
*end will point to &apos;*&apos;

resulting string will be: igor@do\2a

Am I missing something?  I guess the problem is if n &gt; the strlen(s).</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-02-10 16:03:46 EDT</bug_when>
            <thetext>Hmmmm.  Actually I didn&apos;t quite put together that n was much smaller than the
buffer&apos;s real size.

The original code is probably fine, actually.  As is end-ptr (which I think is
clearer)

I hate strncat.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-10 16:41:33 EDT</bug_when>
            <thetext>Created an attachment (id=115)
lak.c

Here is another update.  

- I added a sanity check in lak_escape (n must be smaller or equal to
strlen(s)).
- renamed a few functions to better describe what they do
- strtok =&gt; strtok_r (Are we going to have protability issues here?)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-02-13 11:31:47 EDT</bug_when>
            <thetext>applied.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Philipp Sacha">psacha@blue-cable.net</who>
            <bug_when>2003-02-26 02:16:45 EDT</bug_when>
            <thetext>Created an attachment (id=125)
Patched lak.h

I tried to compile sasl 2.1.12 with lak.c (Attachment 115) and auth_ldap.c
(Attachment 109).
Compiling failed because something in lak.h (included in sasl-2.1.12) seems to
be missing. 

Got errors like:

lak.c:497: warning: `MAX&apos; redefined
/usr/include/sys/param.h:57: warning: this is the location of the previous
definition
lak.c: In function `lak_config_read&apos;:
lak.c:186: structure has no member named `group_dn&apos;
lak.c:186: structure has no member named `group_dn&apos;
lak.c:193: structure has no member named `group_attr&apos;
lak.c:200: structure has no member named `password_attr&apos;

After modifying lak.h i could compile saslauthd successfully.

I am now in the state of testing saslauthd and it seems to be quite stable.
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-26 02:55:38 EDT</bug_when>
            <thetext>Philipp, you do not have the latest lak.h.  Try 
http://bugzilla.andrew.cmu.edu/cgi-bin/cvsweb.cgi/src/sasl/saslauthd/lak.h?
rev=1.9&amp;content-type=text/x-cvsweb-markup and recompile.

I sent Rob another fix for Openldap 2.1.13 and removal of ldap_cache stuff.  
Rob, do you want me to attach the new modules here, open another bug, or?  I 
do need to fix MAX macro.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-02-26 09:00:05 EDT</bug_when>
            <thetext>new bug, please.

I&apos;ve been a bit busy over the past two days.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>107</attachid>
            <date>2003-01-31 14:19 EDT</date>
            <desc>lak.c</desc>
            <filename>lak.c</filename>
            <type>text/plain</type>
            <size>30781</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogQ09QWVJJR0hUCiAqIENvcHlyaWdodCAoYykgMjAwMi0yMDAyIElnb3IgQnJlemFjCiAqIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNl
IGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAogKiBtb2RpZmljYXRpb24sIGFyZSBw
ZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKICogYXJlIG1l
dDoKICogMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBh
Ym92ZSBjb3B5cmlnaHQKICogICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQg
dGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgogKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5
IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAogKiAgICBub3RpY2UsIHRo
aXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhl
CiAqICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRo
IHRoZSBkaXN0cmlidXRpb24uCiAqCiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgSUdP
UiBCUkVaQUMuIGBgQVMgSVMnJyBBTkQgQU5ZCiAqIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5U
SUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFCiAqIElNUExJRUQgV0FSUkFO
VElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUgogKiBQ
VVJQT1NFIEFSRSBESVNDTEFJTUVELiAgSU4gTk8gRVZFTlQgU0hBTEwgSUdPUiBCUkVaQUMgT1IK
ICogSVRTIEVNUExPWUVFUyBPUiBBR0VOVFMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJ
UkVDVCwKICogSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFM
IERBTUFHRVMgKElOQ0xVRElORywKICogQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBP
RiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTCiAqIE9GIFVTRSwgREFUQSwgT1Ig
UFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQKICog
T04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBM
SUFCSUxJVFksIE9SCiAqIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkg
QVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUKICogVVNFIE9GIFRISVMgU09GVFdBUkUsIEVW
RU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSAogKiBEQU1BR0UuCiAqIEVO
RCBDT1BZUklHSFQgKi8KCiNpbmNsdWRlICJtZWNoYW5pc21zLmgiCgojaWZkZWYgQVVUSF9MREFQ
CgojaW5jbHVkZSA8c3lzL3RpbWUuaD4KI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRs
aWIuaD4KI2luY2x1ZGUgPHN0cmluZ3MuaD4KI2luY2x1ZGUgPHN5c2xvZy5oPgojaW5jbHVkZSA8
Y3R5cGUuaD4KCiNpZmRlZiBIQVZFX0NSWVBUX0gKI2luY2x1ZGUgPGNyeXB0Lmg+CiNlbmRpZgoK
I2lmZGVmIEhBVkVfVU5JU1REX0gKI2luY2x1ZGUgPHVuaXN0ZC5oPgojZW5kaWYKCiNpZmRlZiBI
QVZFX09QRU5TU0wKI2luY2x1ZGUgPG9wZW5zc2wvZXZwLmg+CiNlbmRpZgoKI2luY2x1ZGUgPGxk
YXAuaD4KI2luY2x1ZGUgPGxiZXIuaD4KI2luY2x1ZGUgImxhay5oIgoKc3RydWN0IHBhc3N3b3Jk
X3NjaGVtZSB7CgljaGFyICpoYXNoOwoJaW50ICgqY2hlY2spIChjb25zdCBjaGFyICpjcmVkLCBj
b25zdCBjaGFyICpwYXNzd2QsIHZvaWQgKnJvY2spOwoJdm9pZCAqcm9jazsKfTsKCnN0YXRpYyBp
bnQgbGFrX2NvbmZpZ19yZWFkKExBS19DT05GICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQg
bGFrX2NvbmZpZ19pbnQoY29uc3QgY2hhciAqKTsKc3RhdGljIGludCBsYWtfY29uZmlnX3N3aXRj
aChjb25zdCBjaGFyICopOwpzdGF0aWMgdm9pZCBsYWtfY29uZmlnX2ZyZWUoTEFLX0NPTkYgKik7
CnN0YXRpYyBpbnQgbGFrX2NvbmZpZyhjb25zdCBjaGFyICosIExBS19DT05GICoqKTsKc3RhdGlj
IGludCBsYWtfZXNjYXBlKGNvbnN0IGNoYXIgKiwgY29uc3QgdW5zaWduZWQgaW50LCBjaGFyICoq
KTsKc3RhdGljIGludCBsYWtfZmlsdGVyKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY2hhciAqKik7CnN0YXRpYyBpbnQgbGFrX2Nvbm5lY3Qo
TEFLICopOwpzdGF0aWMgaW50IGxha19iaW5kKExBSyAqLCBjaGFyLCBjb25zdCBjaGFyICosIGNv
bnN0IGNoYXIgKik7CnN0YXRpYyBpbnQgbGFrX3NlYXJjaChMQUsgKiwgY29uc3QgY2hhciAqLCBj
b25zdCBjaGFyICoqLCBMREFQTWVzc2FnZSAqKik7CnN0YXRpYyBpbnQgbGFrX2F1dGhfY3VzdG9t
KExBSyAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBj
aGFyICopOwpzdGF0aWMgaW50IGxha19hdXRoX2JpbmQoTEFLICosIGNvbnN0IGNoYXIgKiwgY29u
c3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQgbGFrX2F1
dGhfZmFzdGJpbmQoTEFLICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFy
ICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQgbGFrX2dyb3VwX21lbWJlcihMQUsgKiwgY29u
c3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKc3Rh
dGljIGludCBsYWtfcmVzdWx0X2FkZChMQUsgKmxhaywgY29uc3QgY2hhciAqLCBjb25zdCBjaGFy
ICosIExBS19SRVNVTFQgKiopOwpzdGF0aWMgaW50IGxha19jaGVja19wYXNzd29yZChjb25zdCBj
aGFyICosIGNvbnN0IGNoYXIgKiwgdm9pZCAqKTsKc3RhdGljIGludCBsYWtfY2hlY2tfY3J5cHQo
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIHZvaWQgKik7CiNpZmRlZiBIQVZFX09QRU5TU0wK
c3RhdGljIGludCBsYWtfYmFzZTY0X2RlY29kZShjb25zdCBjaGFyICosIGNoYXIgKiosIGludCAq
KTsKc3RhdGljIGludCBsYWtfY2hlY2tfaGFzaGVkKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAq
LCB2b2lkICopOwojZW5kaWYKCnN0YXRpYyBzdHJ1Y3QgaGFzaF9yb2NrIHsKCWNvbnN0IGNoYXIg
Km1kYTsKCWludCBzYWx0ZWQ7Cn0gaGFzaF9yb2NrW10gPSB7Cgl7ICJtZDUiLCAwIH0sCgl7ICJt
ZDUiLCAxIH0sCgl7ICJzaGExIiwgMCB9LAoJeyAic2hhMSIsIDEgfQp9OwoKc3RhdGljIGNvbnN0
IHN0cnVjdCBwYXNzd29yZF9zY2hlbWUgcGFzc3dvcmRfc2NoZW1lW10gPSB7Cgl7ICJ7Q1JZUFR9
IiwgbGFrX2NoZWNrX2NyeXB0LCBOVUxMIH0sCgl7ICJ7VU5JWH0iLCBsYWtfY2hlY2tfY3J5cHQs
IE5VTEwgfSwKI2lmZGVmIEhBVkVfT1BFTlNTTAoJeyAie01ENX0iLCBsYWtfY2hlY2tfaGFzaGVk
LCAmaGFzaF9yb2NrWzBdIH0sCgl7ICJ7U01ENX0iLCBsYWtfY2hlY2tfaGFzaGVkLCAmaGFzaF9y
b2NrWzFdIH0sCgl7ICJ7U0hBfSIsIGxha19jaGVja19oYXNoZWQsICZoYXNoX3JvY2tbMl0gfSwK
CXsgIntTU0hBfSIsIGxha19jaGVja19oYXNoZWQsICZoYXNoX3JvY2tbM10gfSwKI2VuZGlmCgl7
IE5VTEwsIE5VTEwgfQp9OwoKc3RhdGljIGludCBsYWtfY29uZmlnX3JlYWQoTEFLX0NPTkYgKmNv
bmYsIGNvbnN0IGNoYXIgKmNvbmZpZ2ZpbGUpCnsKCUZJTEUgKmluZmlsZTsKCWludCBsaW5lbm8g
PSAwOwoJY2hhciBidWZbNDA5Nl07CgljaGFyICpwLCAqa2V5OwoKCWluZmlsZSA9IGZvcGVuKGNv
bmZpZ2ZpbGUsICJyIik7CglpZiAoIWluZmlsZSkgewoJICAgIHN5c2xvZyhMT0dfRVJSfExPR19B
VVRILAoJCSAgICJDb3VsZCBub3Qgb3BlbiBMREFQIGNvbmZpZyBmaWxlOiAlcyAoJW0pIiwKCQkg
ICBjb25maWdmaWxlKTsKCSAgICByZXR1cm4gTEFLX0ZBSUw7Cgl9CiAgICAKCXdoaWxlIChmZ2V0
cyhidWYsIHNpemVvZihidWYpLCBpbmZpbGUpKSB7CgkJbGluZW5vKys7CgoJCWlmIChidWZbc3Ry
bGVuKGJ1ZiktMV0gPT0gJ1xuJykgCgkJCWJ1ZltzdHJsZW4oYnVmKS0xXSA9ICdcMCc7CgkJZm9y
IChwID0gYnVmOyAqcCAmJiBpc3NwYWNlKChpbnQpICpwKTsgcCsrKTsKCQkJaWYgKCEqcCB8fCAq
cCA9PSAnIycpIAoJCQkJY29udGludWU7CgoJCWtleSA9IHA7CgkJd2hpbGUgKCpwICYmIChpc2Fs
bnVtKChpbnQpICpwKSB8fCAqcCA9PSAnLScgfHwgKnAgPT0gJ18nKSkgewoJCQlpZiAoaXN1cHBl
cigoaW50KSAqcCkpIAoJCQkJKnAgPSB0b2xvd2VyKCpwKTsKCQkJcCsrOwoJCX0KCQlpZiAoKnAg
IT0gJzonKSB7CgkJCXJldHVybiBMQUtfRkFJTDsKCQl9CgkJKnArKyA9ICdcMCc7CgoJCXdoaWxl
ICgqcCAmJiBpc3NwYWNlKChpbnQpICpwKSkgCgkJCXArKzsKCgkJaWYgKCEqcCkgewoJCQlyZXR1
cm4gTEFLX0ZBSUw7CgkJfQoKCQlpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9zZXJ2ZXJzIikp
IHsKCQkJY29uZi0+c2VydmVycyA9IHN0cmR1cChwKTsKCQkJaWYgKGNvbmYtPnNlcnZlcnMgPT0g
TlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFLX05PTUVNOwoJCQl9CgkJ
fSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX2JpbmRfZG4iKSkgewoJCQljb25mLT5i
aW5kX2RuID0gc3RyZHVwKHApOwoJCQlpZiAoY29uZi0+YmluZF9kbiA9PSBOVUxMKSB7CgkJCQlm
Y2xvc2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFz
dHJjYXNlY21wKGtleSwgImxkYXBfYmluZF9wdyIpKSB7CgkJCWNvbmYtPmJpbmRfcHcgPSBzdHJk
dXAocCk7CgkJCWlmIChjb25mLT5iaW5kX3B3ID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZpbGUp
OwoJCQkJcmV0dXJuIExBS19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5
LCAibGRhcF92ZXJzaW9uIikpIHsKCQkJY29uZi0+dmVyc2lvbiA9IGxha19jb25maWdfaW50KHAp
OwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9zZWFyY2hfYmFzZSIpKSB7CgkJ
CWNvbmYtPnNlYXJjaF9iYXNlID0gc3RyZHVwKHApOwoJCQlpZiAoY29uZi0+c2VhcmNoX2Jhc2Ug
PT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFLX05PTUVNOwoJCQl9
CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX2ZpbHRlciIpKSB7CgkJCWNvbmYt
PmZpbHRlciA9IHN0cmR1cChwKTsKCQkJaWYgKGNvbmYtPmZpbHRlciA9PSBOVUxMKSB7CgkJCQlm
Y2xvc2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFz
dHJjYXNlY21wKGtleSwgImxkYXBfZ3JvdXBfZG4iKSkgewoJCQljb25mLT5ncm91cF9kbiA9IHN0
cmR1cChwKTsKCQkJaWYgKGNvbmYtPmdyb3VwX2RuID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZp
bGUpOwoJCQkJcmV0dXJuIExBS19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAo
a2V5LCAibGRhcF9ncm91cF9hdHRyIikpIHsKCQkJY29uZi0+Z3JvdXBfYXR0ciA9IHN0cmR1cChw
KTsKCQkJaWYgKGNvbmYtPmdyb3VwX2F0dHIgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7
CgkJCQlyZXR1cm4gTEFLX05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXks
ICJsZGFwX3Bhc3N3b3JkX2F0dHIiKSkgewoJCQljb25mLT5wYXNzd29yZF9hdHRyID0gc3RyZHVw
KHApOwoJCQlpZiAoY29uZi0+cGFzc3dvcmRfYXR0ciA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5m
aWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21w
KGtleSwgImxkYXBfYXV0aF9tZXRob2QiKSkgewoJCQlpZiAoIXN0cmNhc2VjbXAocCwgImN1c3Rv
bSIpKSB7CgkJCQljb25mLT5hdXRoX21ldGhvZCA9IExBS19BVVRIX01FVEhPRF9DVVNUT007CgkJ
CX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAocCwgImZhc3RiaW5kIikpIHsKCQkJCWNvbmYtPmF1dGhf
bWV0aG9kID0gTEFLX0FVVEhfTUVUSE9EX0ZBU1RCSU5EOwoJCQl9CgkJfSBlbHNlIGlmICghc3Ry
Y2FzZWNtcChrZXksICJsZGFwX3RpbWVvdXQiKSkgewoJCQljb25mLT50aW1lb3V0LnR2X3NlYyA9
IGxha19jb25maWdfaW50KHApOwoJCQljb25mLT50aW1lb3V0LnR2X3VzZWMgPSAwOwoJCX0gZWxz
ZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9zaXplX2xpbWl0IikpIHsKCQkJY29uZi0+c2l6
ZV9saW1pdCA9IGxha19jb25maWdfaW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5
LCAibGRhcF90aW1lX2xpbWl0IikpIHsKCQkJY29uZi0+dGltZV9saW1pdCA9IGxha19jb25maWdf
aW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9kZXJlZiIpKSB7CgkJ
CWlmICghc3RyY2FzZWNtcChwLCAic2VhcmNoIikpIHsKCQkJCWNvbmYtPmRlcmVmID0gTERBUF9E
RVJFRl9TRUFSQ0hJTkc7CgkJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAocCwgImZpbmQiKSkgewoJ
CQkJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVGX0ZJTkRJTkc7CgkJCX0gZWxzZSBpZiAoIXN0cmNh
c2VjbXAocCwgImFsd2F5cyIpKSB7CgkJCQljb25mLT5kZXJlZiA9IExEQVBfREVSRUZfQUxXQVlT
OwoJCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKHAsICJuZXZlciIpKSB7CgkJCQljb25mLT5kZXJl
ZiA9IExEQVBfREVSRUZfTkVWRVI7CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwg
ImxkYXBfcmVmZXJyYWxzIikpIHsKCQkJY29uZi0+cmVmZXJyYWxzID0gbGFrX2NvbmZpZ19zd2l0
Y2gocCk7CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Jlc3RhcnQiKSkgewoJ
CQljb25mLT5yZXN0YXJ0ID0gbGFrX2NvbmZpZ19zd2l0Y2gocCk7CgkJfSBlbHNlIGlmICghc3Ry
Y2FzZWNtcChrZXksICJsZGFwX2NhY2hlX3R0bCIpKSB7CgkJCWNvbmYtPmNhY2hlX3R0bCA9IGxh
a19jb25maWdfaW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9jYWNo
ZV9tZW0iKSkgewoJCQljb25mLT5jYWNoZV9tZW0gPSBsYWtfY29uZmlnX2ludChwKTsKCQl9IGVs
c2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBfc2NvcGUiKSkgewoJCQlpZiAoIXN0cmNhc2Vj
bXAocCwgIm9uZSIpKSB7CgkJCQljb25mLT5zY29wZSA9IExEQVBfU0NPUEVfT05FTEVWRUw7CgkJ
CX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAocCwgImJhc2UiKSkgewoJCQkJY29uZi0+c2NvcGUgPSBM
REFQX1NDT1BFX0JBU0U7CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBf
dGxzX2NoZWNrX3BlZXIiKSkgewoJCQljb25mLT50bHNfY2hlY2tfcGVlciA9IGxha19jb25maWdf
c3dpdGNoKHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF90bHNfY2FjZXJ0
X2ZpbGUiKSkgewoJCQljb25mLT50bHNfY2FjZXJ0X2ZpbGUgPSBzdHJkdXAocCk7CgkJfSBlbHNl
IGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Rsc19jYWNlcnRfZGlyIikpIHsKCQkJY29uZi0+
dGxzX2NhY2VydF9kaXIgPSBzdHJkdXAocCk7CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXks
ICJsZGFwX3Rsc19jaXBoZXJzIikpIHsKCQkJY29uZi0+dGxzX2NpcGhlcnMgPSBzdHJkdXAocCk7
CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Rsc19jZXJ0IikpIHsKCQkJY29u
Zi0+dGxzX2NlcnQgPSBzdHJkdXAocCk7CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJs
ZGFwX3Rsc19rZXkiKSkgewoJCQljb25mLT50bHNfa2V5ID0gc3RyZHVwKHApOwoJCX0gZWxzZSBp
ZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9kZWJ1ZyIpKSB7CgkJCWNvbmYtPmRlYnVnID0gbGFr
X2NvbmZpZ19pbnQocCk7CgkJfQoJfQoKCWZjbG9zZShpbmZpbGUpOwoKCXJldHVybiBMQUtfT0s7
Cn0KCnN0YXRpYyBpbnQgbGFrX2NvbmZpZ19pbnQoY29uc3QgY2hhciAqdmFsKQp7CiAgICBpZiAo
IXZhbCkgcmV0dXJuIDA7CgogICAgaWYgKCFpc2RpZ2l0KChpbnQpICp2YWwpICYmICgqdmFsICE9
ICctJyB8fCAhaXNkaWdpdCgoaW50KSB2YWxbMV0pKSkgcmV0dXJuIDA7CgogICAgcmV0dXJuIGF0
b2kodmFsKTsKfQoKc3RhdGljIGludCBsYWtfY29uZmlnX3N3aXRjaChjb25zdCBjaGFyICp2YWwp
CnsKICAgIGlmICghdmFsKSByZXR1cm4gMDsKICAgIAogICAgaWYgKCp2YWwgPT0gJzAnIHx8ICp2
YWwgPT0gJ24nIHx8CgkoKnZhbCA9PSAnbycgJiYgdmFsWzFdID09ICdmJykgfHwgKnZhbCA9PSAn
ZicpIHsKCXJldHVybiAwOwogICAgfSBlbHNlIGlmICgqdmFsID09ICcxJyB8fCAqdmFsID09ICd5
JyB8fAoJICAgICAoKnZhbCA9PSAnbycgJiYgdmFsWzFdID09ICduJykgfHwgKnZhbCA9PSAndCcp
IHsKCXJldHVybiAxOwogICAgfQogICAgcmV0dXJuIDA7Cn0KCnN0YXRpYyB2b2lkIGxha19jb25m
aWdfZnJlZShMQUtfQ09ORiAqY29uZikgCnsKCWlmIChjb25mID09IE5VTEwpIHsKCQlyZXR1cm47
Cgl9CgoJaWYgKGNvbmYtPnNlcnZlcnMgIT0gTlVMTCkgewoJCW1lbXNldChjb25mLT5zZXJ2ZXJz
LCAwLCBzdHJsZW4oY29uZi0+c2VydmVycykpOwoJCWZyZWUoY29uZi0+c2VydmVycyk7Cgl9Cglp
ZiAoY29uZi0+YmluZF9kbiAhPSBOVUxMKSB7CgkJbWVtc2V0KGNvbmYtPmJpbmRfZG4sIDAsIHN0
cmxlbihjb25mLT5iaW5kX2RuKSk7CgkJZnJlZShjb25mLT5iaW5kX2RuKTsKCX0KCWlmIChjb25m
LT5iaW5kX3B3ICE9IE5VTEwpIHsKCQltZW1zZXQoY29uZi0+YmluZF9wdywgMCwgc3RybGVuKGNv
bmYtPmJpbmRfcHcpKTsKCQlmcmVlKGNvbmYtPmJpbmRfcHcpOwoJfQoJaWYgKGNvbmYtPnNlYXJj
aF9iYXNlICE9IE5VTEwpCgkJZnJlZShjb25mLT5zZWFyY2hfYmFzZSk7CglpZiAoY29uZi0+Zmls
dGVyICE9IE5VTEwpCgkJZnJlZShjb25mLT5maWx0ZXIpOwoJaWYgKGNvbmYtPmdyb3VwX2RuICE9
IE5VTEwpCgkJZnJlZShjb25mLT5ncm91cF9kbik7CglpZiAoY29uZi0+Z3JvdXBfYXR0ciAhPSBO
VUxMKQoJCWZyZWUoY29uZi0+Z3JvdXBfYXR0cik7CglpZiAoY29uZi0+cGFzc3dvcmRfYXR0ciAh
PSBOVUxMKQoJCWZyZWUoY29uZi0+cGFzc3dvcmRfYXR0cik7CglpZiAoY29uZi0+dGxzX2NhY2Vy
dF9maWxlICE9IE5VTEwpCgkJZnJlZShjb25mLT50bHNfY2FjZXJ0X2ZpbGUpOwoJaWYgKGNvbmYt
PnRsc19jYWNlcnRfZGlyICE9IE5VTEwpCgkJZnJlZShjb25mLT50bHNfY2FjZXJ0X2Rpcik7Cglp
ZiAoY29uZi0+dGxzX2NpcGhlcnMgIT0gTlVMTCkKCQlmcmVlKGNvbmYtPnRsc19jaXBoZXJzKTsK
CWlmIChjb25mLT50bHNfY2VydCAhPSBOVUxMKQoJCWZyZWUoY29uZi0+dGxzX2NlcnQpOwoJaWYg
KGNvbmYtPnRsc19rZXkgIT0gTlVMTCkKCQlmcmVlKGNvbmYtPnRsc19rZXkpOwoJaWYgKGNvbmYt
PnBhdGggIT0gTlVMTCkKCQlmcmVlKGNvbmYtPnBhdGgpOwoKCWZyZWUgKGNvbmYpOwoKCXJldHVy
bjsKfQoKc3RhdGljIGludCBsYWtfY29uZmlnKGNvbnN0IGNoYXIgKmNvbmZpZ2ZpbGUsIExBS19D
T05GICoqcmV0KQp7CglMQUtfQ09ORiAqY29uZjsKCWludCByYyA9IDA7CgoJY29uZiA9IG1hbGxv
Yyggc2l6ZW9mKExBS19DT05GKSApOwoJaWYgKGNvbmYgPT0gTlVMTCkgewoJCXJldHVybiBMQUtf
Tk9NRU07Cgl9CgoJbWVtc2V0KGNvbmYsIDAsIHNpemVvZihMQUtfQ09ORikpOwoKCWNvbmYtPnNl
cnZlcnMgPSAibGRhcDovL2xvY2FsaG9zdC8iOwoJY29uZi0+YmluZF9kbiA9ICIiOwoJY29uZi0+
YmluZF9wdyA9ICIiOwoJY29uZi0+dmVyc2lvbiA9IExEQVBfVkVSU0lPTjM7Cgljb25mLT5zZWFy
Y2hfYmFzZSA9ICIiOwoJY29uZi0+ZmlsdGVyID0gInVpZD0ldSI7Cgljb25mLT5ncm91cF9kbiA9
IE5VTEw7Cgljb25mLT5ncm91cF9hdHRyID0gInVuaXF1ZW1lbWJlciI7Cgljb25mLT5wYXNzd29y
ZF9hdHRyID0gInVzZXJQYXNzd29yZCI7Cgljb25mLT5hdXRoX21ldGhvZCA9IExBS19BVVRIX01F
VEhPRF9CSU5EOwoJY29uZi0+dGltZW91dC50dl9zZWMgPSA1OwoJY29uZi0+dGltZW91dC50dl91
c2VjID0gMDsKCWNvbmYtPnNpemVfbGltaXQgPSAxOwoJY29uZi0+dGltZV9saW1pdCA9IDU7Cglj
b25mLT5kZXJlZiA9IExEQVBfREVSRUZfTkVWRVI7Cgljb25mLT5yZXN0YXJ0ID0gMTsKCWNvbmYt
PnNjb3BlID0gTERBUF9TQ09QRV9TVUJUUkVFOwoKCWNvbmYtPnBhdGggPSBzdHJkdXAoY29uZmln
ZmlsZSk7CglpZiAoY29uZi0+cGF0aCA9PSBOVUxMKSB7CgkJbGFrX2NvbmZpZ19mcmVlKGNvbmYp
OwoJCXJldHVybiBMQUtfTk9NRU07Cgl9CgoJcmMgPSBsYWtfY29uZmlnX3JlYWQoY29uZiwgY29u
Zi0+cGF0aCk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJbGFrX2NvbmZpZ19mcmVlKGNvbmYpOwoJ
CXJldHVybiByYzsKCX0KCgkqcmV0ID0gY29uZjsKCXJldHVybiBMQUtfT0s7Cn0KCi8qCiAqIE5v
dGU6IGNhbGxpbmcgZnVuY3Rpb24gbXVzdCBmcmVlIG1lbW9yeS4KICovCnN0YXRpYyBpbnQgbGFr
X2VzY2FwZShjb25zdCBjaGFyICpzLCBjb25zdCB1bnNpZ25lZCBpbnQgbiwgY2hhciAqKnJlc3Vs
dCkgCnsKCWNoYXIgKmJ1ZjsKCWNoYXIgKmVuZCwgKnB0ciwgKnRlbXA7CgoJYnVmID0gbWFsbG9j
KG4gKiA1ICsgMSk7CglpZiAoYnVmID09IE5VTEwpIHsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoK
CWJ1ZlswXSA9ICdcMCc7CglwdHIgPSAoY2hhciAqKXM7CgllbmQgPSBwdHIgKyBuOwoKCXdoaWxl
ICgoKHRlbXAgPSBzdHJwYnJrKHB0ciwgIiooKVxcXDAiKSkhPU5VTEwpICYmICh0ZW1wPGVuZCkp
IHsKCgkJaWYgKHRlbXA+cHRyKQoJCQlzdHJuY2F0KGJ1ZiwgcHRyLCB0ZW1wLXB0cik7CgoJCXN3
aXRjaCAoKnRlbXApIHsKCQkJY2FzZSAnKic6CgkJCQlzdHJjYXQoYnVmLCAiXFwyYSIpOwoJCQkJ
YnJlYWs7CgkJCWNhc2UgJygnOgoJCQkJc3RyY2F0KGJ1ZiwgIlxcMjgiKTsKCQkJCWJyZWFrOwoJ
CQljYXNlICcpJzoKCQkJCXN0cmNhdChidWYsICJcXDI5Iik7CgkJCQlicmVhazsKCQkJY2FzZSAn
XFwnOgoJCQkJc3RyY2F0KGJ1ZiwgIlxcNWMiKTsKCQkJCWJyZWFrOwoJCQljYXNlICdcMCc6CgkJ
CQlzdHJjYXQoYnVmLCAiXFwwMCIpOwoJCQkJYnJlYWs7CgkJfQoJCXB0cj10ZW1wKzE7Cgl9Cglp
ZiAodGVtcDxlbmQpCgkJc3RybmNhdChidWYsIHB0ciwgKHRlbXAgPyBlbmQtdGVtcCA6IG4pKTsK
CgkqcmVzdWx0ID0gYnVmOwoKCXJldHVybiBMQUtfT0s7Cn0KCgojZGVmaW5lIE1BWChhLGIsYykg
KGE+Yj8oYT5jP2E6Yyk6KGI+Yz9iOmMpKQoKLyoKICogbGFrX2ZpbHRlcgogKiBQYXJ0cyB3aXRo
IHRoZSBzdHJpbmdzIHByb3ZpZGVkLgogKiAgICUlID0gJQogKiAgICV1ID0gdXNlcgogKiAgICVV
ID0gdXNlciBwYXJ0IG9mICV1CiAqICAgJWQgPSBkb21haW4gcGFydCBvZiAldSBpZiBhdmFpbGFi
bGUKICogICAlcyA9IHNlcnZpY2UKICogICAlciA9IHJlYWxtCiAqIE5vdGU6IGNhbGxpbmcgZnVu
Y3Rpb24gbXVzdCBmcmVlIG1lbW9yeS4KICovCnN0YXRpYyBpbnQgbGFrX2ZpbHRlcihjb25zdCBj
aGFyICpwYXR0ZXJuLCBjb25zdCBjaGFyICp1c2VybmFtZSwgY29uc3QgY2hhciAqc2VydmljZSwg
Y29uc3QgY2hhciAqcmVhbG0sIGNoYXIgKipyZXN1bHQpIAp7CgljaGFyICpidWY7IAoJY2hhciAq
ZW5kLCAqcHRyLCAqdGVtcDsKCWNoYXIgKmVidWY7CgljaGFyICpkb21haW47CglpbnQgcmM7CgoJ
LyogdG8gcGVybWl0IG11bHRpcGxlIG9jY3VyZW5jZXMgb2YgdXNlcm5hbWUgYW5kL29yIHJlYWxt
IGluIGZpbHRlciAqLwoJLyogYW5kIGF2b2lkIG1lbW9yeSBvdmVyZmxvdyBpbiBmaWx0ZXIgYnVp
bGQgW2VnOiAofCh1aWQ9JXUpKHVzZXJpZD0ldSkpIF0gKi8KCWludCBwZXJjZW50cywgc2Vydmlj
ZV9sZW4sIHJlYWxtX2xlbiwgdXNlcl9sZW4sIG1heHBhcmFtbGVuZ3RoOwoJCglpZiAocGF0dGVy
biA9PSBOVUxMKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiZmlsdGVyIHBhdHRl
cm4gbm90IHNldHVwIik7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCS8qIGZpbmQgdGhlIGxvbmdl
c3QgcGFyYW0gb2YgdXNlcm5hbWUgYW5kIHJlYWxtLCAKCSAgIGRvIG5vdCB3b3JyeSBhYm91dCBk
b21haW4gYmVjYXVzZSBpdCBpcyBhbHdheXMgc2hvcnRlciAKCSAgIHRoZW4gdXNlcm5hbWUgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KCXVzZXJfbGVuPXN0cmxl
bih1c2VybmFtZSk7CglzZXJ2aWNlX2xlbj1zdHJsZW4oc2VydmljZSk7CglyZWFsbV9sZW49c3Ry
bGVuKHJlYWxtKTsKCgltYXhwYXJhbWxlbmd0aCA9IE1BWCh1c2VyX2xlbiwgc2VydmljZV9sZW4s
IHJlYWxtX2xlbik7CgoJLyogZmluZCB0aGUgbnVtYmVyIG9mIG9jY3VyZW5jZXMgb2YgcGVyY2Vu
dCBzaWduIGluIGZpbHRlciAqLwoJZm9yKCBwZXJjZW50cz0wLCBidWY9KGNoYXIgKilwYXR0ZXJu
OyAqYnVmOyBidWYrKyApIHsKCQlpZiggKmJ1ZiA9PSAnJScgKSBwZXJjZW50cysrOwoJfQoKCS8q
IHBlcmNlbnRzICogMyAqIG1heHBhcmFtbGVuZ3RoIGJlY2F1c2Ugd2UgbmVlZCB0byBhY2NvdW50
IGZvcgogICAgICAgICAqIGFuIGVudGlyZWx5LWVzY2FwZWQgd29yc3QtY2FzZS1sZW5ndGggcGFy
YW1ldGVyICovCglidWY9bWFsbG9jKHN0cmxlbihwYXR0ZXJuKSArIChwZXJjZW50cyAqIDMgKiBt
YXhwYXJhbWxlbmd0aCkgKzEpOwoJaWYoYnVmID09IE5VTEwpIHsKCQlzeXNsb2coTE9HX0VSUnxM
T0dfQVVUSCwgIkNhbm5vdCBhbGxvY2F0ZSBtZW1vcnkiKTsKCQlyZXR1cm4gTEFLX05PTUVNOwoJ
fQoJYnVmWzBdID0gJ1wwJzsKCQoJcHRyID0gKGNoYXIgKilwYXR0ZXJuOwoJZW5kID0gcHRyICsg
c3RybGVuKHB0cik7CgoJd2hpbGUgKCh0ZW1wPXN0cmNocihwdHIsJyUnKSkhPU5VTEwgKSB7CgoJ
CWlmICgodGVtcC1wdHIpID4gMCkKCQkJc3RybmNhdChidWYsIHB0ciwgdGVtcC1wdHIpOwoKCQlp
ZiAoKHRlbXArMSkgPj0gZW5kKSB7CgkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIklu
Y29tcGxldGUgbG9va3VwIHN1YnN0aXR1dGlvbiBmb3JtYXQiKTsKCQkJYnJlYWs7CgkJfQoKCQlz
d2l0Y2ggKCoodGVtcCsxKSkgewoJCQljYXNlICclJzoKCQkJCXN0cm5jYXQoYnVmLHRlbXArMSwx
KTsKCQkJCWJyZWFrOwoJCQljYXNlICd1JzoKCQkJCWlmICh1c2VybmFtZSE9TlVMTCkgewoJCQkJ
CXJjPWxha19lc2NhcGUodXNlcm5hbWUsIHN0cmxlbih1c2VybmFtZSksICZlYnVmKTsKCQkJCQlp
ZiAocmMgPT0gTEFLX09LKSB7CgkJCQkJCXN0cmNhdChidWYsZWJ1Zik7CgkJCQkJCWZyZWUoZWJ1
Zik7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgs
ICJVc2VybmFtZSBub3QgYXZhaWxhYmxlLiIpOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgJ1Un
OgoJCQkJaWYgKHVzZXJuYW1lIT1OVUxMKSB7CgkJCQkJCgkJCQkJc3lzbG9nKExPR19XQVJOSU5H
fExPR19BVVRILCAiSUdPUjogJWQiLCBzdHJjaHIodXNlcm5hbWUsICdAJykgLSB1c2VybmFtZSk7
CgkJCQkJcmM9bGFrX2VzY2FwZSh1c2VybmFtZSwgKHN0cmNocih1c2VybmFtZSwgJ0AnKSAtIHVz
ZXJuYW1lKSwgJmVidWYpOwoJCQkJCWlmIChyYyA9PSBMQUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1
ZixlYnVmKTsKCQkJCQkJZnJlZShlYnVmKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xv
ZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVzZXJuYW1lIG5vdCBhdmFpbGFibGUuIik7CgkJCQl9
CgkJCQlicmVhazsKCQkJY2FzZSAnZCc6CgkJCQlpZiAodXNlcm5hbWUhPU5VTEwgJiYgKGRvbWFp
biA9IHN0cmNocih1c2VybmFtZSwgJ0AnKSkgJiYgZG9tYWluWzFdIT0nXDAnKSB7CgkJCQkJcmM9
bGFrX2VzY2FwZShkb21haW4rMSwgc3RybGVuKGRvbWFpbisxKSwgJmVidWYpOwoJCQkJCWlmIChy
YyA9PSBMQUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShlYnVmKTsK
CQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIkRv
bWFpbiBub3QgYXZhaWxhYmxlLiIpOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgJ3InOgoJCQkJ
aWYgKHJlYWxtIT1OVUxMKSB7CgkJCQkJcmMgPSBsYWtfZXNjYXBlKHJlYWxtLCBzdHJsZW4ocmVh
bG0pLCAmZWJ1Zik7CgkJCQkJaWYgKHJjID09IExBS19PSykgewoJCQkJCQlzdHJjYXQoYnVmLGVi
dWYpOwoJCQkJCQlmcmVlKGVidWYpOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJc3lzbG9nKExP
R19XQVJOSU5HfExPR19BVVRILCAiUmVhbG0gbm90IGF2YWlsYWJsZS4iKTsKCQkJCX0KCQkJCWJy
ZWFrOwoJCQljYXNlICdzJzoKCQkJCWlmIChzZXJ2aWNlIT1OVUxMKSB7CgkJCQkJcmMgPSBsYWtf
ZXNjYXBlKHNlcnZpY2UsIHN0cmxlbihzZXJ2aWNlKSwgJmVidWYpOwoJCQkJCWlmIChyYyA9PSBM
QUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShlYnVmKTsKCQkJCQl9
CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlNlcnZpY2Ug
bm90IGF2YWlsYWJsZS4iKTsKCQkJCX0KCQkJCWJyZWFrOwoJCQlkZWZhdWx0OgoJCQkJYnJlYWs7
CgkJfQoJCXB0cj10ZW1wKzI7Cgl9CglpZiAodGVtcDxlbmQpCgkJc3RyY2F0KGJ1ZiwgcHRyKTsK
CgkqcmVzdWx0ID0gYnVmOwoKc3lzbG9nKExPR19ERUJVR3xMT0dfQVVUSCwgImxha19maWx0ZXIo
KSByZXR1cm5zICVzLiIsIGJ1Zik7CglyZXR1cm4gTEFLX09LOwp9CgppbnQgbGFrX2luaXQoY29u
c3QgY2hhciAqY29uZmlnZmlsZSwgTEFLICoqcmV0KSAKewoJTEFLICpsYWs7CglpbnQgcmM7CgoJ
bGFrID0gKnJldDsKCglpZiAobGFrICE9IE5VTEwpIHsKCQlyZXR1cm4gTEFLX09LOwoJfQoKCWxh
ayA9IChMQUsgKiltYWxsb2Moc2l6ZW9mKExBSykpOwoJaWYgKGxhayA9PSBOVUxMKSB7CgkJc3lz
bG9nKExPR19FUlJ8TE9HX0FVVEgsICJDYW5ub3QgYWxsb2NhdGUgbWVtb3J5Iik7CgkJcmV0dXJu
IExBS19OT01FTTsKCX0KCglsYWstPmJpbmRfc3RhdHVzPUxBS19OT1RfQk9VTkQ7CglsYWstPmxk
PU5VTEw7CglsYWstPmNvbmY9TlVMTDsKCglyYyA9IGxha19jb25maWcoY29uZmlnZmlsZSwgJmxh
ay0+Y29uZik7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJZnJlZShsYWspOwoJCXJldHVybiByYzsK
CX0KCiNpZmRlZiBIQVZFX09QRU5TU0wKCU9wZW5TU0xfYWRkX2FsbF9kaWdlc3RzKCk7CiNlbmRp
ZgoKCSpyZXQ9bGFrOwoJcmV0dXJuIExBS19PSzsKfQoKdm9pZCBsYWtfY2xvc2UoTEFLICpsYWsp
IHsKCglpZiAobGFrID09IE5VTEwpCgkJcmV0dXJuOwoKCWlmIChsYWstPmxkICE9IE5VTEwpIHsK
CQlpZiAobGFrLT5jb25mLT5jYWNoZV90dGwpCgkJCWxkYXBfZGVzdHJveV9jYWNoZShsYWstPmxk
KTsKCQlsZGFwX3VuYmluZF9zKGxhay0+bGQpOwoJfQoKCWxha19jb25maWdfZnJlZShsYWstPmNv
bmYpOwoKCWZyZWUobGFrKTsKCiNpZmRlZiBIQVZFX09QRU5TU0wKCUVWUF9jbGVhbnVwKCk7CiNl
bmRpZgoKCXJldHVybjsKfQoKc3RhdGljIGludCBsYWtfY29ubmVjdChMQUsgKmxhaykKewoJaW50
ICAgICByYyA9IDA7CgoJaWYgKGxhay0+Y29uZi0+dGxzX2NhY2VydF9maWxlICE9IE5VTEwpIHsK
CQlyYyA9IGxkYXBfc2V0X29wdGlvbiAoTlVMTCwgTERBUF9PUFRfWF9UTFNfQ0FDRVJURklMRSwg
bGFrLT5jb25mLT50bHNfY2FjZXJ0X2ZpbGUpOwoJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsK
CQkJc3lzbG9nIChMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERBUF9PUFRf
WF9UTFNfQ0FDRVJURklMRSAoJXMpLiIsIGxkYXBfZXJyMnN0cmluZyAocmMpKTsKCQl9Cgl9CgoJ
aWYgKGxhay0+Y29uZi0+dGxzX2NhY2VydF9kaXIgIT0gTlVMTCkgewoJCXJjID0gbGRhcF9zZXRf
b3B0aW9uIChOVUxMLCBMREFQX09QVF9YX1RMU19DQUNFUlRESVIsIGxhay0+Y29uZi0+dGxzX2Nh
Y2VydF9kaXIpOwoJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJc3lzbG9nIChMT0dfV0FS
TklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERBUF9PUFRfWF9UTFNfQ0FDRVJURElSICgl
cykuIiwgbGRhcF9lcnIyc3RyaW5nIChyYykpOwoJCX0KCX0KCglpZiAobGFrLT5jb25mLT50bHNf
Y2hlY2tfcGVlciAhPSAwKSB7CgkJcmMgPSBsZGFwX3NldF9vcHRpb24oTlVMTCwgTERBUF9PUFRf
WF9UTFNfUkVRVUlSRV9DRVJULCAmbGFrLT5jb25mLT50bHNfY2hlY2tfcGVlcik7CgkJaWYgKHJj
ICE9IExEQVBfU1VDQ0VTUykgewoJCQlzeXNsb2cgKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5h
YmxlIHRvIHNldCBMREFQX09QVF9YX1RMU19SRVFVSVJFX0NFUlQgKCVzKS4iLCBsZGFwX2VycjJz
dHJpbmcgKHJjKSk7CgkJfQoJfQoKCWlmIChsYWstPmNvbmYtPnRsc19jaXBoZXJzICE9IE5VTEwp
IHsKCQkvKiBzZXQgY2lwaGVyIHN1aXRlLCBjZXJ0aWZpY2F0ZSBhbmQgcHJpdmF0ZSBrZXk6ICov
CgkJcmMgPSBsZGFwX3NldF9vcHRpb24oTlVMTCwgTERBUF9PUFRfWF9UTFNfQ0lQSEVSX1NVSVRF
LCBsYWstPmNvbmYtPnRsc19jaXBoZXJzKTsKCQlpZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7CgkJ
CXN5c2xvZyAoTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0IExEQVBfT1BUX1hf
VExTX0NJUEhFUl9TVUlURSAoJXMpLiIsIGxkYXBfZXJyMnN0cmluZyAocmMpKTsKCQl9Cgl9CgoJ
aWYgKGxhay0+Y29uZi0+dGxzX2NlcnQgIT0gTlVMTCkgewoJCXJjID0gbGRhcF9zZXRfb3B0aW9u
KE5VTEwsIExEQVBfT1BUX1hfVExTX0NFUlRGSUxFLCBsYWstPmNvbmYtPnRsc19jZXJ0KTsKCQlp
ZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7CgkJCXN5c2xvZyAoTE9HX1dBUk5JTkd8TE9HX0FVVEgs
ICJVbmFibGUgdG8gc2V0IExEQVBfT1BUX1hfVExTX0NFUlRGSUxFICglcykuIiwgbGRhcF9lcnIy
c3RyaW5nIChyYykpOwoJCX0KCX0KCglpZiAobGFrLT5jb25mLT50bHNfa2V5ICE9IE5VTEwpIHsK
CQlyYyA9IGxkYXBfc2V0X29wdGlvbihOVUxMLCBMREFQX09QVF9YX1RMU19LRVlGSUxFLCBsYWst
PmNvbmYtPnRsc19rZXkpOwoJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJc3lzbG9nIChM
T0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERBUF9PUFRfWF9UTFNfS0VZRklM
RSAoJXMpLiIsIGxkYXBfZXJyMnN0cmluZyAocmMpKTsKCQl9Cgl9CgoJcmMgPSBsZGFwX2luaXRp
YWxpemUoJmxhay0+bGQsIGxhay0+Y29uZi0+c2VydmVycyk7CglpZiAocmMgIT0gTERBUF9TVUND
RVNTKSB7CgkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICJsZGFwX2luaXRpYWxpemUgZmFpbGVk
ICglcykiLCBsYWstPmNvbmYtPnNlcnZlcnMpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglpZiAo
bGFrLT5jb25mLT5kZWJ1ZykgewoJCXJjID0gbGRhcF9zZXRfb3B0aW9uKE5VTEwsIExEQVBfT1BU
X0RFQlVHX0xFVkVMLCAmKGxhay0+Y29uZi0+ZGVidWcpKTsKCQlpZiAocmMgIT0gTERBUF9PUFRf
U1VDQ0VTUykKCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBM
REFQX09QVF9ERUJVR19MRVZFTCAleC4iLCBsYWstPmNvbmYtPmRlYnVnKTsKCX0KCglyYyA9IGxk
YXBfc2V0X29wdGlvbihsYWstPmxkLCBMREFQX09QVF9QUk9UT0NPTF9WRVJTSU9OLCAmKGxhay0+
Y29uZi0+dmVyc2lvbikpOwoJaWYgKHJjICE9IExEQVBfT1BUX1NVQ0NFU1MpIHsKCQlzeXNsb2co
TE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0IExEQVBfT1BUX1BST1RPQ09MX1ZF
UlNJT04gJWQuIiwgbGFrLT5jb25mLT52ZXJzaW9uKTsKCQlsYWstPmNvbmYtPnZlcnNpb24gPSBM
REFQX1ZFUlNJT04yOwoJfQoKCXJjID0gbGRhcF9zZXRfb3B0aW9uKGxhay0+bGQsIExEQVBfT1BU
X05FVFdPUktfVElNRU9VVCwgJihsYWstPmNvbmYtPnRpbWVvdXQpKTsKCWlmIChyYyAhPSBMREFQ
X09QVF9TVUNDRVNTKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRv
IHNldCBMREFQX09QVF9ORVRXT1JLX1RJTUVPVVQgJWQuJWQuIiwgbGFrLT5jb25mLT50aW1lb3V0
LnR2X3NlYywgbGFrLT5jb25mLT50aW1lb3V0LnR2X3VzZWMpOwoJfQoKCXJjID0gbGRhcF9zZXRf
b3B0aW9uKGxhay0+bGQsIExEQVBfT1BUX1RJTUVMSU1JVCwgJihsYWstPmNvbmYtPnRpbWVfbGlt
aXQpKTsKCWlmIChyYyAhPSBMREFQX09QVF9TVUNDRVNTKSB7CgkJc3lzbG9nKExPR19XQVJOSU5H
fExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9USU1FTElNSVQgJWQuIiwgbGFrLT5j
b25mLT50aW1lX2xpbWl0KTsKCX0KCglyYyA9IGxkYXBfc2V0X29wdGlvbihsYWstPmxkLCBMREFQ
X09QVF9ERVJFRiwgJihsYWstPmNvbmYtPmRlcmVmKSk7CglpZiAocmMgIT0gTERBUF9PUFRfU1VD
Q0VTUykgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERB
UF9PUFRfREVSRUYgJWQuIiwgbGFrLT5jb25mLT5kZXJlZik7Cgl9CgoJcmMgPSBsZGFwX3NldF9v
cHRpb24obGFrLT5sZCwgTERBUF9PUFRfUkVGRVJSQUxTLCBsYWstPmNvbmYtPnJlZmVycmFscyA/
IExEQVBfT1BUX09OIDogTERBUF9PUFRfT0ZGKTsKCWlmIChyYyAhPSBMREFQX09QVF9TVUNDRVNT
KSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09Q
VF9SRUZFUlJBTFMuIik7Cgl9CgoJcmMgPSBsZGFwX3NldF9vcHRpb24obGFrLT5sZCwgTERBUF9P
UFRfU0laRUxJTUlULCAmKGxhay0+Y29uZi0+c2l6ZV9saW1pdCkpOwoJaWYgKHJjICE9IExEQVBf
T1BUX1NVQ0NFU1MpCgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNl
dCBMREFQX09QVF9TSVpFTElNSVQgJWQuIiwgbGFrLT5jb25mLT5zaXplX2xpbWl0KTsKCglyYyA9
IGxkYXBfc2V0X29wdGlvbihsYWstPmxkLCBMREFQX09QVF9SRVNUQVJULCBsYWstPmNvbmYtPnJl
c3RhcnQgPyBMREFQX09QVF9PTiA6IExEQVBfT1BUX09GRik7CglpZiAocmMgIT0gTERBUF9PUFRf
U1VDQ0VTUykgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQg
TERBUF9PUFRfUkVTVEFSVC4iKTsKCX0KCgkvKgoJICogU2V0IHVwIGNsaWVudC1zaWRlIGNhY2hp
bmcKCSAqLwoJaWYgKGxhay0+Y29uZi0+Y2FjaGVfdHRsKSB7CgkJcmMgPSBsZGFwX2VuYWJsZV9j
YWNoZShsYWstPmxkLCBsYWstPmNvbmYtPmNhY2hlX3R0bCwgbGFrLT5jb25mLT5jYWNoZV9tZW0p
OwoJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19B
VVRILCAiVW5hYmxlIHRvIGVuYWJsZSBjYWNoZSAtLSBjb250aW51aW5nICglcykiLCBsZGFwX2Vy
cjJzdHJpbmcocmMpKTsKCQl9Cgl9CgoJcmV0dXJuIExBS19PSzsKfQoKCnN0YXRpYyBpbnQgbGFr
X2JpbmQoTEFLICpsYWssIGNoYXIgZmxhZywgY29uc3QgY2hhciAqYmluZF9kbiwgY29uc3QgY2hh
ciAqcGFzc3dvcmQpIAp7CglpbnQgcmM7CgoJaWYgKGxhay0+YmluZF9zdGF0dXMgPT0gTEFLX0JJ
TkRfQU5PTllNT1VTICYmCgkgICAgZmxhZyA9PSBMQUtfQklORF9BTk9OWU1PVVMpIHsKCSAgICBy
ZXR1cm4gTEFLX09LOwoJfQoKCWlmIChsYWstPmJpbmRfc3RhdHVzID09IExBS19OT1RfQk9VTkQp
IHsKCQlpZiAobGFrLT5sZCAhPSBOVUxMKSB7CgkJCWlmIChsYWstPmNvbmYtPmNhY2hlX3R0bCkK
CQkJCWxkYXBfZGVzdHJveV9jYWNoZShsYWstPmxkKTsKCQkJbGRhcF91bmJpbmRfcyhsYWstPmxk
KTsKCQkJbGFrLT5sZCA9IE5VTEw7CgkJfQoKCQlyYyA9IGxha19jb25uZWN0KGxhayk7CgkJaWYg
KHJjICE9IExBS19PSykgewoJCQlyZXR1cm4gcmM7CgkJfQoJfSBlbHNlIHsKCQlpZiAobGFrLT5j
b25mLT52ZXJzaW9uID09IExEQVBfVkVSU0lPTjIpIHsKCgkJCWxhay0+YmluZF9zdGF0dXMgPSBM
QUtfTk9UX0JPVU5EOwoKCQkJaWYgKGxhay0+bGQgIT0gTlVMTCkgewoJCQkJaWYgKGxhay0+Y29u
Zi0+Y2FjaGVfdHRsKQoJCQkJCWxkYXBfZGVzdHJveV9jYWNoZShsYWstPmxkKTsKCQkJCWxkYXBf
dW5iaW5kX3MobGFrLT5sZCk7CgoJCQkJbGFrLT5sZCA9IE5VTEw7CgkJCX0KCQkJcmMgPSBsYWtf
Y29ubmVjdChsYWspOwoJCQlpZiAocmMgIT0gTEFLX09LKSB7CgkJCQlyZXR1cm4gcmM7CgkJCX0K
CQl9Cgl9CgoJcmMgPSBsZGFwX3NpbXBsZV9iaW5kX3MobGFrLT5sZCwgYmluZF9kbiwgcGFzc3dv
cmQpOwoJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJICAgIHN5c2xvZygoZmxhZyA9PSBMQUtf
QklORF9BTk9OWU1PVVMgPyBMT0dfV0FSTklORyA6IExPR19ERUJVRyl8TE9HX0FVVEgsCgkJICAg
ImxkYXBfc2ltcGxlX2JpbmQoKSBmYWlsZWQgYXMgJXMgKCVzKSIsCgkJICAgKCFiaW5kX2RuIHx8
IGJpbmRfZG5bMF0gPT0gJ1wwJykgPyAiYW5vbnltb3VzIiA6IGJpbmRfZG4sCgkJICAgbGRhcF9l
cnIyc3RyaW5nKHJjKSk7CgkgICAgbGFrLT5iaW5kX3N0YXR1cyA9IExBS19OT1RfQk9VTkQ7Cgkg
ICAgcmV0dXJuIExBS19GQUlMOwoJfQoKCWxhay0+YmluZF9zdGF0dXMgPSBmbGFnOwoJcmV0dXJu
IExBS19PSzsKfQoKCnN0YXRpYyBpbnQgbGFrX3NlYXJjaChMQUsgKmxhaywgY29uc3QgY2hhciAq
ZmlsdGVyLCBjb25zdCBjaGFyICoqYXR0cnMsIExEQVBNZXNzYWdlICoqcmVzKQp7CglpbnQgcmMg
PSAwOwoJaW50IHJldHJ5ID0gMTsKCgkqcmVzID0gTlVMTDsKCnJldHJ5OgoJcmMgPSBsYWtfYmlu
ZChsYWssIExBS19CSU5EX0FOT05ZTU9VUywgbGFrLT5jb25mLT5iaW5kX2RuLCBsYWstPmNvbmYt
PmJpbmRfcHcpOwoJaWYgKHJjICE9IExBS19PSykgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0df
QVVUSCwgImxha19iaW5kKCkgZmFpbGVkIik7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCXJjID0g
bGRhcF9zZWFyY2hfc3QobGFrLT5sZCwgbGFrLT5jb25mLT5zZWFyY2hfYmFzZSwgbGFrLT5jb25m
LT5zY29wZSwgZmlsdGVyLCAoY2hhciAqKikgYXR0cnMsIDAsICYobGFrLT5jb25mLT50aW1lb3V0
KSwgcmVzKTsKCXN3aXRjaCAocmMpIHsKCQljYXNlIExEQVBfU1VDQ0VTUzoKCQljYXNlIExEQVBf
Tk9fU1VDSF9PQkpFQ1Q6CgkJCWJyZWFrOwoJCWNhc2UgTERBUF9USU1FT1VUOgoJCWNhc2UgTERB
UF9USU1FTElNSVRfRVhDRUVERUQ6CgkJY2FzZSBMREFQX0JVU1k6CgkJY2FzZSBMREFQX1VOQVZB
SUxBQkxFOgoJCWNhc2UgTERBUF9JTlNVRkZJQ0lFTlRfQUNDRVNTOgoJCQkvKiAgV2UgZG8gbm90
IG5lZWQgdG8gcmUtY29ubmVjdCB0byB0aGUgTERBUCBzZXJ2ZXIgCgkJCSAgICB1bmRlciB0aGVz
ZSBjb25kaXRpb25zICovCgkJCXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAibGRhcF9zZWFyY2hf
c3QoKSBmYWlsZWQ6ICVzIiwgbGRhcF9lcnIyc3RyaW5nKHJjKSk7CgkJCWxkYXBfbXNnZnJlZSgq
cmVzKTsKCQkJcmV0dXJuIExBS19GQUlMOwoJCWNhc2UgTERBUF9TRVJWRVJfRE9XTjoKCQkJaWYg
KHJldHJ5KSB7CgkJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJsZGFwX3NlYXJjaF9z
dCgpIGZhaWxlZDogJXMuIFRyeWluZyB0byByZWNvbm5lY3QuIiwgbGRhcF9lcnIyc3RyaW5nKHJj
KSk7CgkJCQlsZGFwX21zZ2ZyZWUoKnJlcyk7CgkJCQlsYWstPmJpbmRfc3RhdHVzID0gTEFLX05P
VF9CT1VORDsKCQkJCXJldHJ5LS07CgkJCQlnb3RvIHJldHJ5OwoJCQl9CgkJZGVmYXVsdDoKCQkJ
c3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICJsZGFwX3NlYXJjaF9zdCgpIGZhaWxlZDogJXMiLCBs
ZGFwX2VycjJzdHJpbmcocmMpKTsKCQkJbGRhcF9tc2dmcmVlKCpyZXMpOwoJCQlsYWstPmJpbmRf
c3RhdHVzID0gTEFLX05PVF9CT1VORDsKCQkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWlmICgobGRh
cF9jb3VudF9lbnRyaWVzKGxhay0+bGQsICpyZXMpKSAhPSAxKSB7CgkJc3lzbG9nKExPR19ERUJV
R3xMT0dfQVVUSCwgIkVudHJ5IG5vdCBmb3VuZCBvciBtb3JlIHRoYW4gb25lIGVudHJpZXMgZm91
bmQgKCVzKS4iLCBmaWx0ZXIpOwoJCWxkYXBfbXNnZnJlZSgqcmVzKTsKCQlyZXR1cm4gTEFLX0ZB
SUw7Cgl9CgoJcmV0dXJuIExBS19PSzsKfQoKLyogCiAqIGxha19yZXRyaWV2ZSAtIHJldHJpZXZl
IHVzZXJAcmVhbG0gdmFsdWVzIHNwZWNpZmllZCBieSAnYXR0cnMnCiAqLwppbnQgbGFrX3JldHJp
ZXZlKExBSyAqbGFrLCBjb25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25z
dCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqKmF0dHJzLCBMQUtfUkVTVUxUICoqcmV0KQp7Cglp
bnQgcmMgPSAwLCBpOwoJY2hhciAqZmlsdGVyID0gTlVMTDsKCUxEQVBNZXNzYWdlICpyZXM7CglM
REFQTWVzc2FnZSAqZW50cnk7CglCZXJFbGVtZW50ICpiZXI7CgljaGFyICphdHRyLCAqKnZhbHM7
CiAgICAKICAgIAkqcmV0ID0gTlVMTDsKCglpZiAobGFrID09IE5VTEwpIHsKCQlzeXNsb2coTE9H
X0VSUnxMT0dfQVVUSCwgImxha19pbml0IGRpZCBub3QgcnVuLiIpOwoJCXJldHVybiBMQUtfRkFJ
TDsKCX0KCglpZiAodXNlciA9PSBOVUxMIHx8IHVzZXJbMF0gPT0gJ1wwJykgewoJCXJldHVybiBM
QUtfRkFJTDsKCX0KCglyYyA9IGxha19maWx0ZXIobGFrLT5jb25mLT5maWx0ZXIsIHVzZXIsIHNl
cnZpY2UsIHJlYWxtLCAmZmlsdGVyKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlyZXR1cm4gTEFL
X0ZBSUw7Cgl9CgoJcmMgPSBsYWtfc2VhcmNoKGxhaywgZmlsdGVyLCBhdHRycywgJnJlcyk7Cglp
ZiAocmMgIT0gTEFLX09LKSB7CgkJZnJlZShmaWx0ZXIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0K
CgllbnRyeSA9IGxkYXBfZmlyc3RfZW50cnkobGFrLT5sZCwgcmVzKTsgCglpZiAoZW50cnkgPT0g
TlVMTCkgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgImxkYXBfZmlyc3RfZW50cnko
KSBmYWlsZWQuIik7CgkJZnJlZShmaWx0ZXIpOwoJCWxkYXBfbXNnZnJlZShyZXMpOwoJCXJldHVy
biBMQUtfRkFJTDsKCX0KCglyYyA9IExBS19PSzsKCWZvciAoYXR0ciA9IGxkYXBfZmlyc3RfYXR0
cmlidXRlKGxhay0+bGQsIGVudHJ5LCAmYmVyKTsgYXR0ciAhPSBOVUxMOyAKCQlhdHRyID0gbGRh
cF9uZXh0X2F0dHJpYnV0ZShsYWstPmxkLCBlbnRyeSwgYmVyKSkgewoKCQl2YWxzID0gbGRhcF9n
ZXRfdmFsdWVzKGxhay0+bGQsIGVudHJ5LCBhdHRyKTsKCQlpZiAodmFscyA9PSBOVUxMKSB7CgkJ
CWNvbnRpbnVlOwoJCX0KCgkJZm9yIChpID0gMDsgdmFsc1tpXSAhPSBOVUxMOyBpKyspIHsKCQkJ
cmMgPSBsYWtfcmVzdWx0X2FkZChsYWssIGF0dHIsIHZhbHNbaV0sIHJldCk7CgkJCWlmIChyYyAh
PSBMQUtfT0spIHsKCQkJCWJyZWFrOwoJCQl9CgkJfQoKCQlsZGFwX3ZhbHVlX2ZyZWUodmFscyk7
CgkJbGRhcF9tZW1mcmVlKGF0dHIpOwoKCQlpZiAocmMgIT0gTEFLX09LKSB7CgkJCWxha19yZXN1
bHRfZnJlZSgqcmV0KTsKCQkJKnJldCA9IE5VTEw7CgkJCWJyZWFrOwoJCX0KCX0KCglpZiAoYmVy
ICE9IE5VTEwpCgkJYmVyX2ZyZWUoYmVyLCAwKTsKCWxkYXBfbXNnZnJlZShyZXMpOwoJZnJlZShm
aWx0ZXIpOwoKCWlmICgqcmV0ID09IE5VTEwpCgkJcmV0dXJuIExBS19OT0VOVDsKCglyZXR1cm4g
TEFLX09LOwp9CgoKc3RhdGljIGludCBsYWtfZ3JvdXBfbWVtYmVyKExBSyAqbGFrLCBjb25zdCBj
aGFyICp1c2VyLCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFsbSwgY29uc3Qg
Y2hhciAqZG4pCnsKCWNoYXIgKmdyb3VwOwoJaW50IHJjOwoKCXJjID0gbGFrX2ZpbHRlcihsYWst
PmNvbmYtPmdyb3VwX2RuLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgJmdyb3VwKTsKCWlmIChyYyAh
PSBMQUtfT0spIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJsYWtfZmlsdGVyIGZh
aWxlZC4iKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmMgPSBsZGFwX2NvbXBhcmVfcyhsYWst
PmxkLCBncm91cCwgbGFrLT5jb25mLT5ncm91cF9hdHRyLCBkbik7CglmcmVlKGdyb3VwKTsKCWlm
IChyYyAhPSBMREFQX0NPTVBBUkVfVFJVRSkgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVU
SCwgImxkYXBfY29tcGFyZV9zKCkgZm9yIGdyb3VwIGZhaWxlZC4iKTsKCQlyYyA9IExBS19GQUlM
OwoJfQoKCXJldHVybiBMQUtfT0s7Cn0KCnN0YXRpYyBpbnQgbGFrX2F1dGhfY3VzdG9tKExBSyAq
bGFrLCBjb25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpy
ZWFsbSwgY29uc3QgY2hhciAqcGFzc3dvcmQpIAp7CglMQUtfUkVTVUxUICpscmVzLCAqcHRyOwoJ
aW50IHJjOwoJc3RydWN0IHBhc3N3b3JkX2NoZWNrICpwYzsKCWNvbnN0IGNoYXIgKmF0dHJzW10g
PSB7ImRuIiwgbGFrLT5jb25mLT5wYXNzd29yZF9hdHRyLCBOVUxMfTsKCWNoYXIgKmRuOwoKCXJj
ID0gbGFrX3JldHJpZXZlKGxhaywgdXNlciwgc2VydmljZSwgcmVhbG0sIGF0dHJzLCAmbHJlcyk7
CglpZiAocmMgIT0gTEFLX09LKSB7CgkJcmV0dXJuIHJjOwoJfQoKCXJjID0gTEFLX0ZBSUw7CgoJ
Zm9yIChwdHIgPSBscmVzOyBwdHIgIT0gTlVMTDsgcHRyID0gcHRyLT5uZXh0KSB7CgkJCgkJaWYg
KHN0cmNhc2VjbXAocHRyLT5hdHRyaWJ1dGUsIGxhay0+Y29uZi0+cGFzc3dvcmRfYXR0cikpCgkJ
CWNvbnRpbnVlOwoKCQlyYyA9IGxha19jaGVja19wYXNzd29yZChwdHItPnZhbHVlLCBwYXNzd29y
ZCwgTlVMTCk7CgkJaWYgKHJjID09IExBS19PSykgewoJCQlicmVhazsKCQl9Cgl9CgoJaWYgKHJj
ID09IExBS19PSyAmJgoJICAgIGxhay0+Y29uZi0+Z3JvdXBfZG4gIT0gTlVMTCAmJiAqKGxhay0+
Y29uZi0+Z3JvdXBfZG4pICE9ICdcMCcpIHsKCgkJcmMgPSBMQUtfRkFJTDsKCgkJZm9yIChwdHIg
PSBscmVzOyBwdHIgIT0gTlVMTDsgcHRyID0gcHRyLT5uZXh0KQoJCQlpZiAoIXN0cmNhc2VjbXAo
cHRyLT5hdHRyaWJ1dGUsICJkbiIpKSB7CgkJCQlyYyA9IGxha19ncm91cF9tZW1iZXIobGFrLCB1
c2VyLCBzZXJ2aWNlLCByZWFsbSwgZG4pOwoJCQkJYnJlYWs7CgkJCX0KCgkJc3lzbG9nKExPR19X
QVJOSU5HfExPR19BVVRILCAiR3JvdXAgY2hlY2sgZmFpbGVkIChkbiB1bmtub3duKS4iKTsKCX0K
CQoJbGFrX3Jlc3VsdF9mcmVlKGxyZXMpOwoKCXJldHVybihyYyk7Cn0KCnN0YXRpYyBpbnQgbGFr
X2F1dGhfYmluZChMQUsgKmxhaywgY29uc3QgY2hhciAqdXNlciwgY29uc3QgY2hhciAqc2Vydmlj
ZSwgY29uc3QgY2hhciAqcmVhbG0sIGNvbnN0IGNoYXIgKnBhc3N3b3JkKSAKewoJY2hhciAqZmls
dGVyOwoJaW50IHJjOwoJY2hhciAqZG47CglMREFQTWVzc2FnZSAqcmVzLCAqZW50cnk7CgoJcmMg
PSBsYWtfZmlsdGVyKGxhay0+Y29uZi0+ZmlsdGVyLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgJmZp
bHRlcik7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRI
LCAibGFrX2ZpbHRlciBmYWlsZWQuIik7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCXJjID0gbGFr
X3NlYXJjaChsYWssIGZpbHRlciwgTlVMTCwgJnJlcyk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJ
ZnJlZShmaWx0ZXIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCgllbnRyeSA9IGxkYXBfZmlyc3Rf
ZW50cnkobGFrLT5sZCwgcmVzKTsgCglpZiAoZW50cnkgPT0gTlVMTCkgewoJCXN5c2xvZyhMT0df
V0FSTklOR3xMT0dfQVVUSCwgImxkYXBfZmlyc3RfZW50cnkoKS4iKTsKCQlmcmVlKGZpbHRlcik7
CgkJbGRhcF9tc2dmcmVlKHJlcyk7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWRuID0gbGRhcF9n
ZXRfZG4obGFrLT5sZCwgcmVzKTsKCWlmIChkbiA9PSBOVUxMKSB7CgkJc3lzbG9nKExPR19FUlJ8
TE9HX0FVVEgsICJsZGFwX2dldF9kbigpIGZhaWxlZC4iKTsKCQlmcmVlKGZpbHRlcik7CgkJbGRh
cF9tc2dmcmVlIChyZXMpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglmcmVlKGZpbHRlcik7Cgls
ZGFwX21zZ2ZyZWUocmVzKTsKCglyYyA9IGxha19iaW5kKGxhaywgTEFLX0JJTkRfQVNfVVNFUiwg
ZG4sIHBhc3N3b3JkKTsKCglpZiAocmMgPT0gTEFLX09LICYmCgkgICAgbGFrLT5jb25mLT5ncm91
cF9kbiAhPSBOVUxMICYmICoobGFrLT5jb25mLT5ncm91cF9kbikgIT0gJ1wwJykKCQlyYyA9IGxh
a19ncm91cF9tZW1iZXIobGFrLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgZG4pOwoKCWxkYXBfbWVt
ZnJlZShkbik7CgoJbGFrX2JpbmQobGFrLCBMQUtfQklORF9BTk9OWU1PVVMsIGxhay0+Y29uZi0+
YmluZF9kbiwgbGFrLT5jb25mLT5iaW5kX3B3KTsKCgoJcmV0dXJuIHJjOwp9CgoKc3RhdGljIGlu
dCBsYWtfYXV0aF9mYXN0YmluZChMQUsgKmxhaywgY29uc3QgY2hhciAqdXNlciwgY29uc3QgY2hh
ciAqc2VydmljZSwgY29uc3QgY2hhciAqcmVhbG0sIGNvbnN0IGNoYXIgKnBhc3N3b3JkKSAKewoJ
aW50IHJjOwoJY2hhciAqZG4gPSBOVUxMOwoKCXJjID0gbGFrX2ZpbHRlcihsYWstPmNvbmYtPmZp
bHRlciwgdXNlciwgc2VydmljZSwgcmVhbG0sICZkbik7CglpZiAocmMgIT0gTEFLX09LIHx8IGRu
ID09IE5VTEwpIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJsYWtfZmlsdGVyIGZh
aWxlZC4iKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmMgPSBsYWtfYmluZChsYWssIExBS19C
SU5EX0FTX1VTRVIsIGRuLCBwYXNzd29yZCk7CglmcmVlKGRuKTsKCglpZiAocmMgPT0gTEFLX09L
ICYmCgkgICAgbGFrLT5jb25mLT5ncm91cF9kbiAhPSBOVUxMICYmICoobGFrLT5jb25mLT5ncm91
cF9kbikgIT0gJ1wwJykKCQlyYyA9IGxha19ncm91cF9tZW1iZXIobGFrLCB1c2VyLCBzZXJ2aWNl
LCByZWFsbSwgZG4pOwoKCXJldHVybiByYzsKfQoKaW50IGxha19hdXRoZW50aWNhdGUoTEFLICps
YWssIGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnNlcnZpY2UsIGNvbnN0IGNoYXIgKnJl
YWxtLCBjb25zdCBjaGFyICpwYXNzd29yZCkgCnsKCWludCByYzsKCglpZiAobGFrID09IE5VTEwp
IHsKCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgImxha19pbml0IGRpZCBub3QgcnVuLiIpOwoJ
CXJldHVybiBMQUtfRkFJTDsKCX0KCglpZiAodXNlciA9PSBOVUxMIHx8IHVzZXJbMF0gPT0gJ1ww
JykKCQlyZXR1cm4gTEFLX0ZBSUw7CgoJaWYgKGxhay0+Y29uZi0+YXV0aF9tZXRob2QgPT0gTEFL
X0FVVEhfTUVUSE9EX0JJTkQpCgkJcmMgPSBsYWtfYXV0aF9iaW5kKGxhaywgdXNlciwgc2Vydmlj
ZSwgcmVhbG0sIHBhc3N3b3JkKTsKCWVsc2UgaWYgKGxhay0+Y29uZi0+YXV0aF9tZXRob2QgPT0g
TEFLX0FVVEhfTUVUSE9EX0NVU1RPTSkKCQlyYyA9IGxha19hdXRoX2N1c3RvbShsYWssIHVzZXIs
IHNlcnZpY2UsIHJlYWxtLCBwYXNzd29yZCk7CgllbHNlCgkJcmMgPSBsYWtfYXV0aF9mYXN0Ymlu
ZChsYWssIHVzZXIsIHNlcnZpY2UsIHJlYWxtLCBwYXNzd29yZCk7CgoJcmV0dXJuIHJjOwp9CgoK
c3RhdGljIGludCBsYWtfcmVzdWx0X2FkZChMQUsgKmxhaywgY29uc3QgY2hhciAqYXR0ciwgY29u
c3QgY2hhciAqdmFsLCBMQUtfUkVTVUxUICoqcmV0KSAgCnsKCUxBS19SRVNVTFQgKmxyZXM7CgkK
CWxyZXMgPSAoTEFLX1JFU1VMVCAqKSBtYWxsb2Moc2l6ZW9mKExBS19SRVNVTFQpKTsKCWlmIChs
cmVzID09IE5VTEwpIHsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoKCWxyZXMtPm5leHQgPSBOVUxM
OwoKCWxyZXMtPmF0dHJpYnV0ZSA9IHN0cmR1cChhdHRyKTsKCWlmIChscmVzLT5hdHRyaWJ1dGUg
PT0gTlVMTCkgewoJCWxha19yZXN1bHRfZnJlZShscmVzKTsKCQlyZXR1cm4gTEFLX05PTUVNOwoJ
fQoKCWxyZXMtPnZhbHVlID0gc3RyZHVwKHZhbCk7CglpZiAobHJlcy0+dmFsdWUgPT0gTlVMTCkg
ewoJCWxha19yZXN1bHRfZnJlZShscmVzKTsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoJbHJlcy0+
bGVuID0gc3RybGVuKGxyZXMtPnZhbHVlKTsKCglscmVzLT5uZXh0ID0gKnJldDsKCgkqcmV0ID0g
bHJlczsKCXJldHVybiBMQUtfT0s7Cn0KCgp2b2lkIGxha19yZXN1bHRfZnJlZShMQUtfUkVTVUxU
ICpyZXMpIAp7CglMQUtfUkVTVUxUICpscmVzLCAqcHRyID0gcmVzOwoKCWlmIChwdHIgPT0gTlVM
TCkKCQlyZXR1cm47CgoJZm9yIChscmVzID0gcHRyOyBscmVzICE9IE5VTEw7IGxyZXMgPSBwdHIp
IHsKCgkJcHRyID0gbHJlcy0+bmV4dDsKCgkJaWYgKGxyZXMtPmF0dHJpYnV0ZSAhPSBOVUxMKSB7
CgkJCW1lbXNldChscmVzLT5hdHRyaWJ1dGUsIDAsIHN0cmxlbihscmVzLT52YWx1ZSkpOwoJCQlm
cmVlKGxyZXMtPmF0dHJpYnV0ZSk7CQoJCX0KCgkJaWYgKGxyZXMtPnZhbHVlICE9IE5VTEwpIHsK
CQkJbWVtc2V0KGxyZXMtPnZhbHVlLCAwLCBzdHJsZW4obHJlcy0+dmFsdWUpKTsKCQkJZnJlZShs
cmVzLT52YWx1ZSk7CQoJCX0KCgkJbHJlcy0+bmV4dCA9IE5VTEw7CgoJCWZyZWUobHJlcyk7Cgl9
CgoJcmV0dXJuOwp9CgpzdGF0aWMgaW50IGxha19jaGVja19wYXNzd29yZChjb25zdCBjaGFyICpo
YXNoLCBjb25zdCBjaGFyICpwYXNzd2QsIHZvaWQgKnJvY2spIAp7CglpbnQgaSwgaGxlbjsKCWlu
dCByYzsKCglpZiAoaGFzaCA9PSBOVUxMIHx8IGhhc2hbMF0gPT0gJ1wwJykgewoJCXJldHVybiBM
QUtfRkFJTDsKCX0KCglpZiAocGFzc3dkID09IE5VTEwgfHwgcGFzc3dkWzBdID09ICdcMCcpIHsK
CQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJZm9yIChpID0gMDsgcGFzc3dvcmRfc2NoZW1lW2ldLmhh
c2ggIT0gTlVMTDsgaSsrKSB7CgoJCWhsZW4gPSBzdHJsZW4ocGFzc3dvcmRfc2NoZW1lW2ldLmhh
c2gpOwoJCWlmICghc3RybmNhc2VjbXAocGFzc3dvcmRfc2NoZW1lW2ldLmhhc2gsIGhhc2gsIGhs
ZW4pKSB7CgkJCWlmIChwYXNzd29yZF9zY2hlbWVbaV0uY2hlY2spIHsKCQkJCXJjID0gKHBhc3N3
b3JkX3NjaGVtZVtpXS5jaGVjaykoaGFzaCtobGVuLCBwYXNzd2QsCgkJCQkJCQkJcGFzc3dvcmRf
c2NoZW1lW2ldLnJvY2spOwoJCQl9CgkJCXJldHVybiByYzsKCQl9Cgl9CgoJcmV0dXJuIHN0cmNt
cChoYXNoLCBwYXNzd2QpID8gTEFLX0ZBSUwgOiBMQUtfT0s7Cn0KCiNpZmRlZiBIQVZFX09QRU5T
U0wKCnN0YXRpYyBpbnQgbGFrX2Jhc2U2NF9kZWNvZGUoY29uc3QgY2hhciAqc3JjLCBjaGFyICoq
cmV0LCBpbnQgKnJsZW4pIHsKCglpbnQgcmMsIGksIHRsZW4gPSAwOwoJY2hhciAqdGV4dDsKCUVW
UF9FTkNPREVfQ1RYIEVWUF9jdHg7CgoJdGV4dCA9IChjaGFyICopbWFsbG9jKCgoc3RybGVuKHNy
YykrMykvNCAqIDMpICsgMSk7CglpZiAodGV4dCA9PSBOVUxMKSB7CgkJcmV0dXJuIExBS19OT01F
TTsKCX0KCglFVlBfRGVjb2RlSW5pdCgmRVZQX2N0eCk7CglyYyA9IEVWUF9EZWNvZGVVcGRhdGUo
JkVWUF9jdHgsIHRleHQsICZpLCAoY2hhciAqKXNyYywgc3RybGVuKHNyYykpOwoJaWYgKHJjIDwg
MCkgewoJCWZyZWUodGV4dCk7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoJdGxlbiArPSBpOwoJRVZQ
X0RlY29kZUZpbmFsKCZFVlBfY3R4LCB0ZXh0LCAmaSk7IAoKCSpyZXQgPSB0ZXh0OwoJaWYgKHJs
ZW4gIT0gTlVMTCkgewoJCSpybGVuID0gdGxlbjsKCX0KCglyZXR1cm4gTEFLX09LOwp9CgpzdGF0
aWMgaW50IGxha19jaGVja19oYXNoZWQoY29uc3QgY2hhciAqaGFzaCwgY29uc3QgY2hhciAqcGFz
c3dkLCB2b2lkICpyb2NrKQp7CglpbnQgcmMsIGNsZW47CglzdHJ1Y3QgaGFzaF9yb2NrICpocm9j
ayA9IChzdHJ1Y3QgaGFzaF9yb2NrICopIHJvY2s7CglFVlBfTURfQ1RYIG1kY3R4OwoJY29uc3Qg
RVZQX01EICptZDsKCXVuc2lnbmVkIGNoYXIgZGlnZXN0W0VWUF9NQVhfTURfU0laRV07CgljaGFy
ICpjcmVkOwoKCW1kID0gRVZQX2dldF9kaWdlc3RieW5hbWUoaHJvY2stPm1kYSk7CglpZiAoIW1k
KSB7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCXJjID0gbGFrX2Jhc2U2NF9kZWNvZGUoaGFzaCwg
JmNyZWQsICZjbGVuKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlyZXR1cm4gcmM7Cgl9CgoJRVZQ
X0RpZ2VzdEluaXQoJm1kY3R4LCBtZCk7CglFVlBfRGlnZXN0VXBkYXRlKCZtZGN0eCwgcGFzc3dk
LCBzdHJsZW4ocGFzc3dkKSk7CglpZiAoaHJvY2stPnNhbHRlZCkgewoJCUVWUF9EaWdlc3RVcGRh
dGUoJm1kY3R4LCAmY3JlZFtFVlBfTURfc2l6ZShtZCldLAoJCQkJIGNsZW4gLSBFVlBfTURfc2l6
ZShtZCkpOwoJfQoJRVZQX0RpZ2VzdEZpbmFsKCZtZGN0eCwgZGlnZXN0LCBOVUxMKTsKCglyYyA9
IG1lbWNtcCgoY2hhciAqKWNyZWQsIChjaGFyICopZGlnZXN0LCBFVlBfTURfc2l6ZShtZCkpOwoJ
ZnJlZShjcmVkKTsKCXJldHVybiByYyA/IExBS19GQUlMIDogTEFLX09LOwp9CgojZW5kaWYgLyog
SEFWRV9PUEVOU1NMICovCgpzdGF0aWMgaW50IGxha19jaGVja19jcnlwdChjb25zdCBjaGFyICpo
YXNoLCBjb25zdCBjaGFyICpwYXNzd2QsIHZvaWQgKnJvY2spIAp7CgljaGFyICpjcmVkOwoKCWlm
IChoYXNoID09IE5VTEwgfHwgaGFzaFswXSA9PSAnXDAnKSB7CgkJcmV0dXJuIExBS19GQUlMOwoJ
fQoKCWlmIChwYXNzd2QgPT0gTlVMTCB8fCBwYXNzd2RbMF0gPT0gJ1wwJykgewoJCXJldHVybiBM
QUtfRkFJTDsKCX0KCglpZiAoc3RybGVuKGhhc2gpIDwgMiApIHsKCQlyZXR1cm4gTEFLX0ZBSUw7
Cgl9CgoJY3JlZCA9IGNyeXB0KHBhc3N3ZCwgaGFzaCk7CglpZiggY3JlZCA9PSBOVUxMIHx8IGNy
ZWRbMF0gPT0gJ1wwJyApIHsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmV0dXJuIHN0cmNtcCho
YXNoLCBjcmVkKSA/IExBS19GQUlMIDogTEFLX09LOwp9CgojZW5kaWYgLyogQVVUSF9MREFQICov
Cg==
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>108</attachid>
            <date>2003-01-31 14:20 EDT</date>
            <desc>lak.h</desc>
            <filename>lak.h</filename>
            <type>text/plain</type>
            <size>3090</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogQ09QWVJJR0hUCiAqIENvcHlyaWdodCAoYykgMjAwMi0yMDAyIElnb3IgQnJlemFjCiAqIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNl
IGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAogKiBtb2RpZmljYXRpb24sIGFyZSBw
ZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKICogYXJlIG1l
dDoKICogMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBh
Ym92ZSBjb3B5cmlnaHQKICogICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQg
dGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgogKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5
IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAogKiAgICBub3RpY2UsIHRo
aXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhl
CiAqICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRo
IHRoZSBkaXN0cmlidXRpb24uCiAqCiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgSUdP
UiBCUkVaQUMuIGBgQVMgSVMnJyBBTkQgQU5ZCiAqIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5U
SUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFCiAqIElNUExJRUQgV0FSUkFO
VElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUgogKiBQ
VVJQT1NFIEFSRSBESVNDTEFJTUVELiAgSU4gTk8gRVZFTlQgU0hBTEwgSUdPUiBCUkVaQUMgT1IK
ICogSVRTIEVNUExPWUVFUyBPUiBBR0VOVFMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJ
UkVDVCwKICogSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFM
IERBTUFHRVMgKElOQ0xVRElORywKICogQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBP
RiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTCiAqIE9GIFVTRSwgREFUQSwgT1Ig
UFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQKICog
T04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBM
SUFCSUxJVFksIE9SCiAqIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkg
QVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUKICogVVNFIE9GIFRISVMgU09GVFdBUkUsIEVW
RU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSAogKiBEQU1BR0UuCiAqIEVO
RCBDT1BZUklHSFQgKi8KCiNpZm5kZWYgX0xBS19ICiNkZWZpbmUgX0xBS19ICgojaW5jbHVkZSA8
bGRhcC5oPgojaW5jbHVkZSA8bGJlci5oPgoKI2lmIFRJTUVfV0lUSF9TWVNfVElNRQojIGluY2x1
ZGUgPHN5cy90aW1lLmg+CiMgaW5jbHVkZSA8dGltZS5oPgojZWxzZQojIGlmIEhBVkVfU1lTX1RJ
TUVfSAojICBpbmNsdWRlIDxzeXMvdGltZS5oPgojIGVsc2UKIyAgaW5jbHVkZSA8dGltZS5oPgoj
IGVuZGlmCiNlbmRpZgoKI2RlZmluZSBMQUtfT0sgMAojZGVmaW5lIExBS19GQUlMIC0xCiNkZWZp
bmUgTEFLX05PRU5UIC0yCiNkZWZpbmUgTEFLX05PTUVNIC0zCgojZGVmaW5lIExBS19OT1RfQk9V
TkQgMAojZGVmaW5lIExBS19CSU5EX0FOT05ZTU9VUyAxCiNkZWZpbmUgTEFLX0JJTkRfQVNfVVNF
UiAyCgojZGVmaW5lIExBS19BVVRIX01FVEhPRF9CSU5EIDAKI2RlZmluZSBMQUtfQVVUSF9NRVRI
T0RfQ1VTVE9NIDEKI2RlZmluZSBMQUtfQVVUSF9NRVRIT0RfRkFTVEJJTkQgMgoKdHlwZWRlZiBz
dHJ1Y3QgbGFrX2NvbmYgewogICAgY2hhciAgICpwYXRoOwogICAgY2hhciAgICpzZXJ2ZXJzOwog
ICAgY2hhciAgICpiaW5kX2RuOwogICAgY2hhciAgICpiaW5kX3B3OwogICAgaW50ICAgICB2ZXJz
aW9uOwogICAgc3RydWN0ICB0aW1ldmFsIHRpbWVvdXQ7CiAgICBpbnQgICAgIHNpemVfbGltaXQ7
CiAgICBpbnQgICAgIHRpbWVfbGltaXQ7CiAgICBpbnQgICAgIGRlcmVmOwogICAgaW50ICAgICBy
ZWZlcnJhbHM7CiAgICBpbnQgICAgIHJlc3RhcnQ7CiAgICBsb25nICAgIGNhY2hlX3R0bDsKICAg
IGxvbmcgICAgY2FjaGVfbWVtOwogICAgaW50ICAgICBzY29wZTsKICAgIGNoYXIgICAqc2VhcmNo
X2Jhc2U7CiAgICBjaGFyICAgKmZpbHRlcjsKICAgIGNoYXIgICAqZ3JvdXBfZG47CiAgICBjaGFy
ICAgKmdyb3VwX2F0dHI7CiAgICBjaGFyICAgKnBhc3N3b3JkX2F0dHI7CiAgICBjaGFyICAgIGF1
dGhfbWV0aG9kOwogICAgaW50ICAgICB0bHNfY2hlY2tfcGVlcjsKICAgIGNoYXIgICAqdGxzX2Nh
Y2VydF9maWxlOwogICAgY2hhciAgICp0bHNfY2FjZXJ0X2RpcjsKICAgIGNoYXIgICAqdGxzX2Np
cGhlcnM7CiAgICBjaGFyICAgKnRsc19jZXJ0OwogICAgY2hhciAgICp0bHNfa2V5OwogICAgaW50
ICAgICBkZWJ1ZzsKfSBMQUtfQ09ORjsKCnR5cGVkZWYgc3RydWN0IGxhayB7CiAgICBMREFQICAg
ICAqbGQ7CiAgICBjaGFyICAgICAgYmluZF9zdGF0dXM7CiAgICBMQUtfQ09ORiAqY29uZjsKfSBM
QUs7Cgp0eXBlZGVmIHN0cnVjdCBsYWtfcmVzdWx0IHsKICAgIGNoYXIgICAgICAgICAgICAgICph
dHRyaWJ1dGU7CiAgICBjaGFyICAgICAgICAgICAgICAqdmFsdWU7CiAgICBzaXplX3QgICAgICAg
ICAgICAgbGVuOwogICAgc3RydWN0IGxha19yZXN1bHQgKm5leHQ7Cn0gTEFLX1JFU1VMVDsKCmlu
dCBsYWtfaW5pdChjb25zdCBjaGFyICosIExBSyAqKik7CnZvaWQgbGFrX2Nsb3NlKExBSyAqKTsK
aW50IGxha19hdXRoZW50aWNhdGUoTEFLICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBj
b25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CmludCBsYWtfcmV0cmlldmUoTEFLICosIGNvbnN0
IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiosIExBS19S
RVNVTFQgKiopOwp2b2lkIGxha19yZXN1bHRfZnJlZShMQUtfUkVTVUxUICopOwoKI2VuZGlmICAv
KiBfTEFLX0ggKi8K
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>109</attachid>
            <date>2003-01-31 14:21 EDT</date>
            <desc>auth_ldap.c</desc>
            <filename>auth_ldap.c</filename>
            <type>text/plain</type>
            <size>3258</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogTU9EVUxFOiBhdXRoX2xkYXAgKi8KLyogQ09QWVJJR0hUCiAqIENvcHlyaWdodCAoYykgMjAw
Mi0yMDAyIElnb3IgQnJlemFjCiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIFJlZGlzdHJp
YnV0aW9uIGFuZCB1c2UgaW4gc291cmNlIGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91
dAogKiBtb2RpZmljYXRpb24sIGFyZSBwZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93
aW5nIGNvbmRpdGlvbnMKICogYXJlIG1ldDoKICogMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJj
ZSBjb2RlIG11c3QgcmV0YWluIHRoZSBhYm92ZSBjb3B5cmlnaHQKICogICAgbm90aWNlLCB0aGlz
IGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgogKiAyLiBS
ZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNv
cHlyaWdodAogKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9s
bG93aW5nIGRpc2NsYWltZXIgaW4gdGhlCiAqICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVy
IG1hdGVyaWFscyBwcm92aWRlZCB3aXRoIHRoZSBkaXN0cmlidXRpb24uCiAqCiAqIFRISVMgU09G
VFdBUkUgSVMgUFJPVklERUQgQlkgSUdPUiBCUkVaQUMuIGBgQVMgSVMnJyBBTkQgQU5ZCiAqIEVY
UFJFU1MgT1IgSU1QTElFRCBXQVJSQU5USUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBU
TywgVEhFCiAqIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5F
U1MgRk9SIEEgUEFSVElDVUxBUgogKiBQVVJQT1NFIEFSRSBESVNDTEFJTUVELiAgSU4gTk8gRVZF
TlQgU0hBTEwgSUdPUiBCUkVaQUMgT1IKICogSVRTIEVNUExPWUVFUyBPUiBBR0VOVFMgQkUgTElB
QkxFIEZPUiBBTlkgRElSRUNULCBJTkRJUkVDVCwKICogSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhF
TVBMQVJZLCBPUiBDT05TRVFVRU5USUFMIERBTUFHRVMgKElOQ0xVRElORywKICogQlVUIE5PVCBM
SU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBPRiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBM
T1NTCiAqIE9GIFVTRSwgREFUQSwgT1IgUFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9O
KSBIT1dFVkVSIENBVVNFRCBBTkQKICogT04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRI
RVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBMSUFCSUxJVFksIE9SCiAqIFRPUlQgKElOQ0xVRElORyBO
RUdMSUdFTkNFIE9SIE9USEVSV0lTRSkgQVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUKICog
VVNFIE9GIFRISVMgU09GVFdBUkUsIEVWRU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkg
T0YgU1VDSAogKiBEQU1BR0UuCiAqIEVORCBDT1BZUklHSFQgKi8KCi8qIFNZTk9QU0lTCiAqIEF1
dGhlbnRpY2F0ZSBhZ2FpbnN0IExEQVAuCiAqIEVORCBTWU5PUFNJUyAqLwoKI2lmZGVmIF9fR05V
Q19fCiNpZGVudCAiJElkOiBhdXRoX2xkYXAuYyx2IDEuMTUgMjAwMi8xMC8xOCAxOToxNjoyOSBy
anMzIEV4cCAkIgojZW5kaWYKCi8qIFBVQkxJQyBERVBFTkRFTkNJRVMgKi8KI2luY2x1ZGUgPHN0
ZGxpYi5oPgojaW5jbHVkZSA8c3RyaW5nLmg+CiNpbmNsdWRlIDxzeXNsb2cuaD4KI2luY2x1ZGUg
PGN0eXBlLmg+CiNpbmNsdWRlICJtZWNoYW5pc21zLmgiCgovKiBFTkQgUFVCTElDIERFUEVOREVO
Q0lFUyAqLwoKIyBkZWZpbmUgUkVUVVJOKHgpIHtyZXR1cm4gc3RyZHVwKHgpO30KDAovKiBGVU5D
VElPTjogYXV0aF9sZGFwICovCgojaWZkZWYgQVVUSF9MREFQCgojaW5jbHVkZSAibGFrLmgiCiNp
bmNsdWRlICJnbG9iYWxzLmgiCgpjb25zdCBjaGFyICpTQVNMQVVUSERfQ09ORl9GSUxFID0gU0FT
TEFVVEhEX0NPTkZfRklMRV9ERUZBVUxUOwoKY2hhciAqCQkJCQkvKiBSOiBhbGxvY2F0ZWQgcmVz
cG9uc2Ugc3RyaW5nICovCmF1dGhfbGRhcCgKICAvKiBQQVJBTUVURVJTICovCiAgY29uc3QgY2hh
ciAqbG9naW4sCQkJLyogSTogcGxhaW50ZXh0IGF1dGhlbnRpY2F0b3IgKi8KICBjb25zdCBjaGFy
ICpwYXNzd29yZCwJCQkvKiBJOiBwbGFpbnRleHQgcGFzc3dvcmQgKi8KICBjb25zdCBjaGFyICpz
ZXJ2aWNlLAogIGNvbnN0IGNoYXIgKnJlYWxtCiAgLyogRU5EIFBBUkFNRVRFUlMgKi8KICApCnsK
CXN0YXRpYyBMQUsgKmxhayA9IE5VTEw7CglpbnQgcmMgPSAwOwoKCWlmIChsYWsgPT0gTlVMTCkg
ewoJCXJjID0gbGFrX2luaXQoU0FTTEFVVEhEX0NPTkZfRklMRSwgJmxhayk7CgkJaWYgKHJjICE9
IExBS19PSykgewoJCQlsYWsgPSBOVUxMOwoJCQlSRVRVUk4oIk5PIik7CgkJfQoJfQoKCXJjID0g
bGFrX2F1dGhlbnRpY2F0ZShsYWssIGxvZ2luLCBzZXJ2aWNlLCByZWFsbSwgcGFzc3dvcmQpOwog
ICAgCWlmIChyYyA9PSBMQUtfT0spIHsKCQlSRVRVUk4oIk9LIik7Cgl9IGVsc2UgewoJCVJFVFVS
TigiTk8iKTsKCX0KfQoKLyogRlVOQ1RJT046IGF1dGhfcmltYXBfaW5pdCAqLwoKLyogU1lOT1BT
SVMKICogVmFsaWRhdGUgdGhlIGhvc3QgYW5kIHNlcnZpY2UgbmFtZXMgZm9yIHRoZSByZW1vdGUg
c2VydmVyLgogKiBFTkQgU1lOT1BTSVMgKi8KCmludAphdXRoX2xkYXBfaW5pdCAoCiAgLyogUEFS
QU1FVEVSUyAqLwogIHZvaWQJCQkJCS8qIG5vIHBhcmFtZXRlcnMgKi8KICAvKiBFTkQgUEFSQU1F
VEVSUyAqLwogICkKewogICAgLyogVkFSSUFCTEVTICovCiAgICBzdHJ1Y3QgYWRkcmluZm8gaGlu
dHM7CiAgICBpbnQgZXJyOwogICAgY2hhciAqYzsJCQkJLyogc2NyYXRjaCBwb2ludGVyICAgICAg
ICAgICAgICAgKi8KICAgIC8qIEVORCBWQVJJQUJMRVMgKi8KCiAgICBpZiAobWVjaF9vcHRpb24g
IT0gTlVMTCkgewoJU0FTTEFVVEhEX0NPTkZfRklMRSA9IG1lY2hfb3B0aW9uOwogICAgfQoKICAg
IHJldHVybiAwOwp9CgojZWxzZSAvKiAhQVVUSF9MREFQICovCgpjaGFyICoKYXV0aF9sZGFwKAog
IGNvbnN0IGNoYXIgKmxvZ2luIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAogIGNvbnN0IGNoYXIg
KnBhc3N3b3JkIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAogIGNvbnN0IGNoYXIgKnNlcnZpY2Ug
X19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgY29uc3QgY2hhciAqcmVhbG0gX19hdHRyaWJ1dGVf
XygodW51c2VkKSkKICApCnsKICAgICByZXR1cm4gTlVMTDsKfQoKI2VuZGlmIC8qICFBVVRIX0xE
QVAgKi8KCi8qIEVORCBGVU5DVElPTjogYXV0aF9sZGFwICovCgovKiBFTkQgTU9EVUxFOiBhdXRo
X2xkYXAgKi8K
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>110</attachid>
            <date>2003-01-31 14:43 EDT</date>
            <desc>lak.c</desc>
            <filename>lak.c</filename>
            <type>text/plain</type>
            <size>30678</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogQ09QWVJJR0hUCiAqIENvcHlyaWdodCAoYykgMjAwMi0yMDAyIElnb3IgQnJlemFjCiAqIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNl
IGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAogKiBtb2RpZmljYXRpb24sIGFyZSBw
ZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKICogYXJlIG1l
dDoKICogMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBh
Ym92ZSBjb3B5cmlnaHQKICogICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQg
dGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgogKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5
IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAogKiAgICBub3RpY2UsIHRo
aXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhl
CiAqICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRo
IHRoZSBkaXN0cmlidXRpb24uCiAqCiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgSUdP
UiBCUkVaQUMuIGBgQVMgSVMnJyBBTkQgQU5ZCiAqIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5U
SUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFCiAqIElNUExJRUQgV0FSUkFO
VElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUgogKiBQ
VVJQT1NFIEFSRSBESVNDTEFJTUVELiAgSU4gTk8gRVZFTlQgU0hBTEwgSUdPUiBCUkVaQUMgT1IK
ICogSVRTIEVNUExPWUVFUyBPUiBBR0VOVFMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJ
UkVDVCwKICogSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFM
IERBTUFHRVMgKElOQ0xVRElORywKICogQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBP
RiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTCiAqIE9GIFVTRSwgREFUQSwgT1Ig
UFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQKICog
T04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBM
SUFCSUxJVFksIE9SCiAqIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkg
QVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUKICogVVNFIE9GIFRISVMgU09GVFdBUkUsIEVW
RU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSAogKiBEQU1BR0UuCiAqIEVO
RCBDT1BZUklHSFQgKi8KCiNpbmNsdWRlICJtZWNoYW5pc21zLmgiCgojaWZkZWYgQVVUSF9MREFQ
CgojaW5jbHVkZSA8c3lzL3RpbWUuaD4KI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRs
aWIuaD4KI2luY2x1ZGUgPHN0cmluZ3MuaD4KI2luY2x1ZGUgPHN5c2xvZy5oPgojaW5jbHVkZSA8
Y3R5cGUuaD4KCiNpZmRlZiBIQVZFX0NSWVBUX0gKI2luY2x1ZGUgPGNyeXB0Lmg+CiNlbmRpZgoK
I2lmZGVmIEhBVkVfVU5JU1REX0gKI2luY2x1ZGUgPHVuaXN0ZC5oPgojZW5kaWYKCiNpZmRlZiBI
QVZFX09QRU5TU0wKI2luY2x1ZGUgPG9wZW5zc2wvZXZwLmg+CiNlbmRpZgoKI2luY2x1ZGUgPGxk
YXAuaD4KI2luY2x1ZGUgPGxiZXIuaD4KI2luY2x1ZGUgImxhay5oIgoKc3RydWN0IHBhc3N3b3Jk
X3NjaGVtZSB7CgljaGFyICpoYXNoOwoJaW50ICgqY2hlY2spIChjb25zdCBjaGFyICpjcmVkLCBj
b25zdCBjaGFyICpwYXNzd2QsIHZvaWQgKnJvY2spOwoJdm9pZCAqcm9jazsKfTsKCnN0YXRpYyBp
bnQgbGFrX2NvbmZpZ19yZWFkKExBS19DT05GICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQg
bGFrX2NvbmZpZ19pbnQoY29uc3QgY2hhciAqKTsKc3RhdGljIGludCBsYWtfY29uZmlnX3N3aXRj
aChjb25zdCBjaGFyICopOwpzdGF0aWMgdm9pZCBsYWtfY29uZmlnX2ZyZWUoTEFLX0NPTkYgKik7
CnN0YXRpYyBpbnQgbGFrX2NvbmZpZyhjb25zdCBjaGFyICosIExBS19DT05GICoqKTsKc3RhdGlj
IGludCBsYWtfZXNjYXBlKGNvbnN0IGNoYXIgKiwgY29uc3QgdW5zaWduZWQgaW50LCBjaGFyICoq
KTsKc3RhdGljIGludCBsYWtfZmlsdGVyKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY2hhciAqKik7CnN0YXRpYyBpbnQgbGFrX2Nvbm5lY3Qo
TEFLICopOwpzdGF0aWMgaW50IGxha19iaW5kKExBSyAqLCBjaGFyLCBjb25zdCBjaGFyICosIGNv
bnN0IGNoYXIgKik7CnN0YXRpYyBpbnQgbGFrX3NlYXJjaChMQUsgKiwgY29uc3QgY2hhciAqLCBj
b25zdCBjaGFyICoqLCBMREFQTWVzc2FnZSAqKik7CnN0YXRpYyBpbnQgbGFrX2F1dGhfY3VzdG9t
KExBSyAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBj
aGFyICopOwpzdGF0aWMgaW50IGxha19hdXRoX2JpbmQoTEFLICosIGNvbnN0IGNoYXIgKiwgY29u
c3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQgbGFrX2F1
dGhfZmFzdGJpbmQoTEFLICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFy
ICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQgbGFrX2dyb3VwX21lbWJlcihMQUsgKiwgY29u
c3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKc3Rh
dGljIGludCBsYWtfcmVzdWx0X2FkZChMQUsgKmxhaywgY29uc3QgY2hhciAqLCBjb25zdCBjaGFy
ICosIExBS19SRVNVTFQgKiopOwpzdGF0aWMgaW50IGxha19jaGVja19wYXNzd29yZChjb25zdCBj
aGFyICosIGNvbnN0IGNoYXIgKiwgdm9pZCAqKTsKc3RhdGljIGludCBsYWtfY2hlY2tfY3J5cHQo
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIHZvaWQgKik7CiNpZmRlZiBIQVZFX09QRU5TU0wK
c3RhdGljIGludCBsYWtfYmFzZTY0X2RlY29kZShjb25zdCBjaGFyICosIGNoYXIgKiosIGludCAq
KTsKc3RhdGljIGludCBsYWtfY2hlY2tfaGFzaGVkKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAq
LCB2b2lkICopOwojZW5kaWYKCnN0YXRpYyBzdHJ1Y3QgaGFzaF9yb2NrIHsKCWNvbnN0IGNoYXIg
Km1kYTsKCWludCBzYWx0ZWQ7Cn0gaGFzaF9yb2NrW10gPSB7Cgl7ICJtZDUiLCAwIH0sCgl7ICJt
ZDUiLCAxIH0sCgl7ICJzaGExIiwgMCB9LAoJeyAic2hhMSIsIDEgfQp9OwoKc3RhdGljIGNvbnN0
IHN0cnVjdCBwYXNzd29yZF9zY2hlbWUgcGFzc3dvcmRfc2NoZW1lW10gPSB7Cgl7ICJ7Q1JZUFR9
IiwgbGFrX2NoZWNrX2NyeXB0LCBOVUxMIH0sCgl7ICJ7VU5JWH0iLCBsYWtfY2hlY2tfY3J5cHQs
IE5VTEwgfSwKI2lmZGVmIEhBVkVfT1BFTlNTTAoJeyAie01ENX0iLCBsYWtfY2hlY2tfaGFzaGVk
LCAmaGFzaF9yb2NrWzBdIH0sCgl7ICJ7U01ENX0iLCBsYWtfY2hlY2tfaGFzaGVkLCAmaGFzaF9y
b2NrWzFdIH0sCgl7ICJ7U0hBfSIsIGxha19jaGVja19oYXNoZWQsICZoYXNoX3JvY2tbMl0gfSwK
CXsgIntTU0hBfSIsIGxha19jaGVja19oYXNoZWQsICZoYXNoX3JvY2tbM10gfSwKI2VuZGlmCgl7
IE5VTEwsIE5VTEwgfQp9OwoKc3RhdGljIGludCBsYWtfY29uZmlnX3JlYWQoTEFLX0NPTkYgKmNv
bmYsIGNvbnN0IGNoYXIgKmNvbmZpZ2ZpbGUpCnsKCUZJTEUgKmluZmlsZTsKCWludCBsaW5lbm8g
PSAwOwoJY2hhciBidWZbNDA5Nl07CgljaGFyICpwLCAqa2V5OwoKCWluZmlsZSA9IGZvcGVuKGNv
bmZpZ2ZpbGUsICJyIik7CglpZiAoIWluZmlsZSkgewoJICAgIHN5c2xvZyhMT0dfRVJSfExPR19B
VVRILAoJCSAgICJDb3VsZCBub3Qgb3BlbiBMREFQIGNvbmZpZyBmaWxlOiAlcyAoJW0pIiwKCQkg
ICBjb25maWdmaWxlKTsKCSAgICByZXR1cm4gTEFLX0ZBSUw7Cgl9CiAgICAKCXdoaWxlIChmZ2V0
cyhidWYsIHNpemVvZihidWYpLCBpbmZpbGUpKSB7CgkJbGluZW5vKys7CgoJCWlmIChidWZbc3Ry
bGVuKGJ1ZiktMV0gPT0gJ1xuJykgCgkJCWJ1ZltzdHJsZW4oYnVmKS0xXSA9ICdcMCc7CgkJZm9y
IChwID0gYnVmOyAqcCAmJiBpc3NwYWNlKChpbnQpICpwKTsgcCsrKTsKCQkJaWYgKCEqcCB8fCAq
cCA9PSAnIycpIAoJCQkJY29udGludWU7CgoJCWtleSA9IHA7CgkJd2hpbGUgKCpwICYmIChpc2Fs
bnVtKChpbnQpICpwKSB8fCAqcCA9PSAnLScgfHwgKnAgPT0gJ18nKSkgewoJCQlpZiAoaXN1cHBl
cigoaW50KSAqcCkpIAoJCQkJKnAgPSB0b2xvd2VyKCpwKTsKCQkJcCsrOwoJCX0KCQlpZiAoKnAg
IT0gJzonKSB7CgkJCXJldHVybiBMQUtfRkFJTDsKCQl9CgkJKnArKyA9ICdcMCc7CgoJCXdoaWxl
ICgqcCAmJiBpc3NwYWNlKChpbnQpICpwKSkgCgkJCXArKzsKCgkJaWYgKCEqcCkgewoJCQlyZXR1
cm4gTEFLX0ZBSUw7CgkJfQoKCQlpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9zZXJ2ZXJzIikp
IHsKCQkJY29uZi0+c2VydmVycyA9IHN0cmR1cChwKTsKCQkJaWYgKGNvbmYtPnNlcnZlcnMgPT0g
TlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFLX05PTUVNOwoJCQl9CgkJ
fSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX2JpbmRfZG4iKSkgewoJCQljb25mLT5i
aW5kX2RuID0gc3RyZHVwKHApOwoJCQlpZiAoY29uZi0+YmluZF9kbiA9PSBOVUxMKSB7CgkJCQlm
Y2xvc2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFz
dHJjYXNlY21wKGtleSwgImxkYXBfYmluZF9wdyIpKSB7CgkJCWNvbmYtPmJpbmRfcHcgPSBzdHJk
dXAocCk7CgkJCWlmIChjb25mLT5iaW5kX3B3ID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZpbGUp
OwoJCQkJcmV0dXJuIExBS19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5
LCAibGRhcF92ZXJzaW9uIikpIHsKCQkJY29uZi0+dmVyc2lvbiA9IGxha19jb25maWdfaW50KHAp
OwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9zZWFyY2hfYmFzZSIpKSB7CgkJ
CWNvbmYtPnNlYXJjaF9iYXNlID0gc3RyZHVwKHApOwoJCQlpZiAoY29uZi0+c2VhcmNoX2Jhc2Ug
PT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFLX05PTUVNOwoJCQl9
CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX2ZpbHRlciIpKSB7CgkJCWNvbmYt
PmZpbHRlciA9IHN0cmR1cChwKTsKCQkJaWYgKGNvbmYtPmZpbHRlciA9PSBOVUxMKSB7CgkJCQlm
Y2xvc2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFz
dHJjYXNlY21wKGtleSwgImxkYXBfZ3JvdXBfZG4iKSkgewoJCQljb25mLT5ncm91cF9kbiA9IHN0
cmR1cChwKTsKCQkJaWYgKGNvbmYtPmdyb3VwX2RuID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZp
bGUpOwoJCQkJcmV0dXJuIExBS19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAo
a2V5LCAibGRhcF9ncm91cF9hdHRyIikpIHsKCQkJY29uZi0+Z3JvdXBfYXR0ciA9IHN0cmR1cChw
KTsKCQkJaWYgKGNvbmYtPmdyb3VwX2F0dHIgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7
CgkJCQlyZXR1cm4gTEFLX05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXks
ICJsZGFwX3Bhc3N3b3JkX2F0dHIiKSkgewoJCQljb25mLT5wYXNzd29yZF9hdHRyID0gc3RyZHVw
KHApOwoJCQlpZiAoY29uZi0+cGFzc3dvcmRfYXR0ciA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5m
aWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21w
KGtleSwgImxkYXBfYXV0aF9tZXRob2QiKSkgewoJCQlpZiAoIXN0cmNhc2VjbXAocCwgImN1c3Rv
bSIpKSB7CgkJCQljb25mLT5hdXRoX21ldGhvZCA9IExBS19BVVRIX01FVEhPRF9DVVNUT007CgkJ
CX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAocCwgImZhc3RiaW5kIikpIHsKCQkJCWNvbmYtPmF1dGhf
bWV0aG9kID0gTEFLX0FVVEhfTUVUSE9EX0ZBU1RCSU5EOwoJCQl9CgkJfSBlbHNlIGlmICghc3Ry
Y2FzZWNtcChrZXksICJsZGFwX3RpbWVvdXQiKSkgewoJCQljb25mLT50aW1lb3V0LnR2X3NlYyA9
IGxha19jb25maWdfaW50KHApOwoJCQljb25mLT50aW1lb3V0LnR2X3VzZWMgPSAwOwoJCX0gZWxz
ZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9zaXplX2xpbWl0IikpIHsKCQkJY29uZi0+c2l6
ZV9saW1pdCA9IGxha19jb25maWdfaW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5
LCAibGRhcF90aW1lX2xpbWl0IikpIHsKCQkJY29uZi0+dGltZV9saW1pdCA9IGxha19jb25maWdf
aW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9kZXJlZiIpKSB7CgkJ
CWlmICghc3RyY2FzZWNtcChwLCAic2VhcmNoIikpIHsKCQkJCWNvbmYtPmRlcmVmID0gTERBUF9E
RVJFRl9TRUFSQ0hJTkc7CgkJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAocCwgImZpbmQiKSkgewoJ
CQkJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVGX0ZJTkRJTkc7CgkJCX0gZWxzZSBpZiAoIXN0cmNh
c2VjbXAocCwgImFsd2F5cyIpKSB7CgkJCQljb25mLT5kZXJlZiA9IExEQVBfREVSRUZfQUxXQVlT
OwoJCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKHAsICJuZXZlciIpKSB7CgkJCQljb25mLT5kZXJl
ZiA9IExEQVBfREVSRUZfTkVWRVI7CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwg
ImxkYXBfcmVmZXJyYWxzIikpIHsKCQkJY29uZi0+cmVmZXJyYWxzID0gbGFrX2NvbmZpZ19zd2l0
Y2gocCk7CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Jlc3RhcnQiKSkgewoJ
CQljb25mLT5yZXN0YXJ0ID0gbGFrX2NvbmZpZ19zd2l0Y2gocCk7CgkJfSBlbHNlIGlmICghc3Ry
Y2FzZWNtcChrZXksICJsZGFwX2NhY2hlX3R0bCIpKSB7CgkJCWNvbmYtPmNhY2hlX3R0bCA9IGxh
a19jb25maWdfaW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9jYWNo
ZV9tZW0iKSkgewoJCQljb25mLT5jYWNoZV9tZW0gPSBsYWtfY29uZmlnX2ludChwKTsKCQl9IGVs
c2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBfc2NvcGUiKSkgewoJCQlpZiAoIXN0cmNhc2Vj
bXAocCwgIm9uZSIpKSB7CgkJCQljb25mLT5zY29wZSA9IExEQVBfU0NPUEVfT05FTEVWRUw7CgkJ
CX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAocCwgImJhc2UiKSkgewoJCQkJY29uZi0+c2NvcGUgPSBM
REFQX1NDT1BFX0JBU0U7CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBf
dGxzX2NoZWNrX3BlZXIiKSkgewoJCQljb25mLT50bHNfY2hlY2tfcGVlciA9IGxha19jb25maWdf
c3dpdGNoKHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF90bHNfY2FjZXJ0
X2ZpbGUiKSkgewoJCQljb25mLT50bHNfY2FjZXJ0X2ZpbGUgPSBzdHJkdXAocCk7CgkJfSBlbHNl
IGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Rsc19jYWNlcnRfZGlyIikpIHsKCQkJY29uZi0+
dGxzX2NhY2VydF9kaXIgPSBzdHJkdXAocCk7CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXks
ICJsZGFwX3Rsc19jaXBoZXJzIikpIHsKCQkJY29uZi0+dGxzX2NpcGhlcnMgPSBzdHJkdXAocCk7
CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Rsc19jZXJ0IikpIHsKCQkJY29u
Zi0+dGxzX2NlcnQgPSBzdHJkdXAocCk7CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJs
ZGFwX3Rsc19rZXkiKSkgewoJCQljb25mLT50bHNfa2V5ID0gc3RyZHVwKHApOwoJCX0gZWxzZSBp
ZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9kZWJ1ZyIpKSB7CgkJCWNvbmYtPmRlYnVnID0gbGFr
X2NvbmZpZ19pbnQocCk7CgkJfQoJfQoKCWZjbG9zZShpbmZpbGUpOwoKCXJldHVybiBMQUtfT0s7
Cn0KCnN0YXRpYyBpbnQgbGFrX2NvbmZpZ19pbnQoY29uc3QgY2hhciAqdmFsKQp7CiAgICBpZiAo
IXZhbCkgcmV0dXJuIDA7CgogICAgaWYgKCFpc2RpZ2l0KChpbnQpICp2YWwpICYmICgqdmFsICE9
ICctJyB8fCAhaXNkaWdpdCgoaW50KSB2YWxbMV0pKSkgcmV0dXJuIDA7CgogICAgcmV0dXJuIGF0
b2kodmFsKTsKfQoKc3RhdGljIGludCBsYWtfY29uZmlnX3N3aXRjaChjb25zdCBjaGFyICp2YWwp
CnsKICAgIGlmICghdmFsKSByZXR1cm4gMDsKICAgIAogICAgaWYgKCp2YWwgPT0gJzAnIHx8ICp2
YWwgPT0gJ24nIHx8CgkoKnZhbCA9PSAnbycgJiYgdmFsWzFdID09ICdmJykgfHwgKnZhbCA9PSAn
ZicpIHsKCXJldHVybiAwOwogICAgfSBlbHNlIGlmICgqdmFsID09ICcxJyB8fCAqdmFsID09ICd5
JyB8fAoJICAgICAoKnZhbCA9PSAnbycgJiYgdmFsWzFdID09ICduJykgfHwgKnZhbCA9PSAndCcp
IHsKCXJldHVybiAxOwogICAgfQogICAgcmV0dXJuIDA7Cn0KCnN0YXRpYyB2b2lkIGxha19jb25m
aWdfZnJlZShMQUtfQ09ORiAqY29uZikgCnsKCWlmIChjb25mID09IE5VTEwpIHsKCQlyZXR1cm47
Cgl9CgoJaWYgKGNvbmYtPnNlcnZlcnMgIT0gTlVMTCkgewoJCW1lbXNldChjb25mLT5zZXJ2ZXJz
LCAwLCBzdHJsZW4oY29uZi0+c2VydmVycykpOwoJCWZyZWUoY29uZi0+c2VydmVycyk7Cgl9Cglp
ZiAoY29uZi0+YmluZF9kbiAhPSBOVUxMKSB7CgkJbWVtc2V0KGNvbmYtPmJpbmRfZG4sIDAsIHN0
cmxlbihjb25mLT5iaW5kX2RuKSk7CgkJZnJlZShjb25mLT5iaW5kX2RuKTsKCX0KCWlmIChjb25m
LT5iaW5kX3B3ICE9IE5VTEwpIHsKCQltZW1zZXQoY29uZi0+YmluZF9wdywgMCwgc3RybGVuKGNv
bmYtPmJpbmRfcHcpKTsKCQlmcmVlKGNvbmYtPmJpbmRfcHcpOwoJfQoJaWYgKGNvbmYtPnNlYXJj
aF9iYXNlICE9IE5VTEwpCgkJZnJlZShjb25mLT5zZWFyY2hfYmFzZSk7CglpZiAoY29uZi0+Zmls
dGVyICE9IE5VTEwpCgkJZnJlZShjb25mLT5maWx0ZXIpOwoJaWYgKGNvbmYtPmdyb3VwX2RuICE9
IE5VTEwpCgkJZnJlZShjb25mLT5ncm91cF9kbik7CglpZiAoY29uZi0+Z3JvdXBfYXR0ciAhPSBO
VUxMKQoJCWZyZWUoY29uZi0+Z3JvdXBfYXR0cik7CglpZiAoY29uZi0+cGFzc3dvcmRfYXR0ciAh
PSBOVUxMKQoJCWZyZWUoY29uZi0+cGFzc3dvcmRfYXR0cik7CglpZiAoY29uZi0+dGxzX2NhY2Vy
dF9maWxlICE9IE5VTEwpCgkJZnJlZShjb25mLT50bHNfY2FjZXJ0X2ZpbGUpOwoJaWYgKGNvbmYt
PnRsc19jYWNlcnRfZGlyICE9IE5VTEwpCgkJZnJlZShjb25mLT50bHNfY2FjZXJ0X2Rpcik7Cglp
ZiAoY29uZi0+dGxzX2NpcGhlcnMgIT0gTlVMTCkKCQlmcmVlKGNvbmYtPnRsc19jaXBoZXJzKTsK
CWlmIChjb25mLT50bHNfY2VydCAhPSBOVUxMKQoJCWZyZWUoY29uZi0+dGxzX2NlcnQpOwoJaWYg
KGNvbmYtPnRsc19rZXkgIT0gTlVMTCkKCQlmcmVlKGNvbmYtPnRsc19rZXkpOwoJaWYgKGNvbmYt
PnBhdGggIT0gTlVMTCkKCQlmcmVlKGNvbmYtPnBhdGgpOwoKCWZyZWUgKGNvbmYpOwoKCXJldHVy
bjsKfQoKc3RhdGljIGludCBsYWtfY29uZmlnKGNvbnN0IGNoYXIgKmNvbmZpZ2ZpbGUsIExBS19D
T05GICoqcmV0KQp7CglMQUtfQ09ORiAqY29uZjsKCWludCByYyA9IDA7CgoJY29uZiA9IG1hbGxv
Yyggc2l6ZW9mKExBS19DT05GKSApOwoJaWYgKGNvbmYgPT0gTlVMTCkgewoJCXJldHVybiBMQUtf
Tk9NRU07Cgl9CgoJbWVtc2V0KGNvbmYsIDAsIHNpemVvZihMQUtfQ09ORikpOwoKCWNvbmYtPnNl
cnZlcnMgPSAibGRhcDovL2xvY2FsaG9zdC8iOwoJY29uZi0+YmluZF9kbiA9ICIiOwoJY29uZi0+
YmluZF9wdyA9ICIiOwoJY29uZi0+dmVyc2lvbiA9IExEQVBfVkVSU0lPTjM7Cgljb25mLT5zZWFy
Y2hfYmFzZSA9ICIiOwoJY29uZi0+ZmlsdGVyID0gInVpZD0ldSI7Cgljb25mLT5ncm91cF9kbiA9
IE5VTEw7Cgljb25mLT5ncm91cF9hdHRyID0gInVuaXF1ZW1lbWJlciI7Cgljb25mLT5wYXNzd29y
ZF9hdHRyID0gInVzZXJQYXNzd29yZCI7Cgljb25mLT5hdXRoX21ldGhvZCA9IExBS19BVVRIX01F
VEhPRF9CSU5EOwoJY29uZi0+dGltZW91dC50dl9zZWMgPSA1OwoJY29uZi0+dGltZW91dC50dl91
c2VjID0gMDsKCWNvbmYtPnNpemVfbGltaXQgPSAxOwoJY29uZi0+dGltZV9saW1pdCA9IDU7Cglj
b25mLT5kZXJlZiA9IExEQVBfREVSRUZfTkVWRVI7Cgljb25mLT5yZXN0YXJ0ID0gMTsKCWNvbmYt
PnNjb3BlID0gTERBUF9TQ09QRV9TVUJUUkVFOwoKCWNvbmYtPnBhdGggPSBzdHJkdXAoY29uZmln
ZmlsZSk7CglpZiAoY29uZi0+cGF0aCA9PSBOVUxMKSB7CgkJbGFrX2NvbmZpZ19mcmVlKGNvbmYp
OwoJCXJldHVybiBMQUtfTk9NRU07Cgl9CgoJcmMgPSBsYWtfY29uZmlnX3JlYWQoY29uZiwgY29u
Zi0+cGF0aCk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJbGFrX2NvbmZpZ19mcmVlKGNvbmYpOwoJ
CXJldHVybiByYzsKCX0KCgkqcmV0ID0gY29uZjsKCXJldHVybiBMQUtfT0s7Cn0KCi8qCiAqIE5v
dGU6IGNhbGxpbmcgZnVuY3Rpb24gbXVzdCBmcmVlIG1lbW9yeS4KICovCnN0YXRpYyBpbnQgbGFr
X2VzY2FwZShjb25zdCBjaGFyICpzLCBjb25zdCB1bnNpZ25lZCBpbnQgbiwgY2hhciAqKnJlc3Vs
dCkgCnsKCWNoYXIgKmJ1ZjsKCWNoYXIgKmVuZCwgKnB0ciwgKnRlbXA7CgoJYnVmID0gbWFsbG9j
KG4gKiA1ICsgMSk7CglpZiAoYnVmID09IE5VTEwpIHsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoK
CWJ1ZlswXSA9ICdcMCc7CglwdHIgPSAoY2hhciAqKXM7CgllbmQgPSBwdHIgKyBuOwoKCXdoaWxl
ICgoKHRlbXAgPSBzdHJwYnJrKHB0ciwgIiooKVxcXDAiKSkhPU5VTEwpICYmICh0ZW1wPGVuZCkp
IHsKCgkJaWYgKHRlbXA+cHRyKQoJCQlzdHJuY2F0KGJ1ZiwgcHRyLCB0ZW1wLXB0cik7CgoJCXN3
aXRjaCAoKnRlbXApIHsKCQkJY2FzZSAnKic6CgkJCQlzdHJjYXQoYnVmLCAiXFwyYSIpOwoJCQkJ
YnJlYWs7CgkJCWNhc2UgJygnOgoJCQkJc3RyY2F0KGJ1ZiwgIlxcMjgiKTsKCQkJCWJyZWFrOwoJ
CQljYXNlICcpJzoKCQkJCXN0cmNhdChidWYsICJcXDI5Iik7CgkJCQlicmVhazsKCQkJY2FzZSAn
XFwnOgoJCQkJc3RyY2F0KGJ1ZiwgIlxcNWMiKTsKCQkJCWJyZWFrOwoJCQljYXNlICdcMCc6CgkJ
CQlzdHJjYXQoYnVmLCAiXFwwMCIpOwoJCQkJYnJlYWs7CgkJfQoJCXB0cj10ZW1wKzE7Cgl9Cglp
ZiAodGVtcDxlbmQpCgkJc3RybmNhdChidWYsIHB0ciwgKHRlbXAgPyBlbmQtdGVtcCA6IG4pKTsK
CgkqcmVzdWx0ID0gYnVmOwoKCXJldHVybiBMQUtfT0s7Cn0KCgojZGVmaW5lIE1BWChhLGIsYykg
KGE+Yj8oYT5jP2E6Yyk6KGI+Yz9iOmMpKQoKLyoKICogbGFrX2ZpbHRlcgogKiBQYXJ0cyB3aXRo
IHRoZSBzdHJpbmdzIHByb3ZpZGVkLgogKiAgICUlID0gJQogKiAgICV1ID0gdXNlcgogKiAgICVV
ID0gdXNlciBwYXJ0IG9mICV1CiAqICAgJWQgPSBkb21haW4gcGFydCBvZiAldSBpZiBhdmFpbGFi
bGUKICogICAlcyA9IHNlcnZpY2UKICogICAlciA9IHJlYWxtCiAqIE5vdGU6IGNhbGxpbmcgZnVu
Y3Rpb24gbXVzdCBmcmVlIG1lbW9yeS4KICovCnN0YXRpYyBpbnQgbGFrX2ZpbHRlcihjb25zdCBj
aGFyICpwYXR0ZXJuLCBjb25zdCBjaGFyICp1c2VybmFtZSwgY29uc3QgY2hhciAqc2VydmljZSwg
Y29uc3QgY2hhciAqcmVhbG0sIGNoYXIgKipyZXN1bHQpIAp7CgljaGFyICpidWY7IAoJY2hhciAq
ZW5kLCAqcHRyLCAqdGVtcDsKCWNoYXIgKmVidWYsICpzOwoJY2hhciAqZG9tYWluOwoJaW50IHJj
OwoKCS8qIHRvIHBlcm1pdCBtdWx0aXBsZSBvY2N1cmVuY2VzIG9mIHVzZXJuYW1lIGFuZC9vciBy
ZWFsbSBpbiBmaWx0ZXIgKi8KCS8qIGFuZCBhdm9pZCBtZW1vcnkgb3ZlcmZsb3cgaW4gZmlsdGVy
IGJ1aWxkIFtlZzogKHwodWlkPSV1KSh1c2VyaWQ9JXUpKSBdICovCglpbnQgcGVyY2VudHMsIHNl
cnZpY2VfbGVuLCByZWFsbV9sZW4sIHVzZXJfbGVuLCBtYXhwYXJhbWxlbmd0aDsKCQoJaWYgKHBh
dHRlcm4gPT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgImZpbHRlciBw
YXR0ZXJuIG5vdCBzZXR1cCIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCgkvKiBmaW5kIHRoZSBs
b25nZXN0IHBhcmFtIG9mIHVzZXJuYW1lIGFuZCByZWFsbSwgCgkgICBkbyBub3Qgd29ycnkgYWJv
dXQgZG9tYWluIGJlY2F1c2UgaXQgaXMgYWx3YXlzIHNob3J0ZXIgCgkgICB0aGVuIHVzZXJuYW1l
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICovCgl1c2VyX2xlbj1z
dHJsZW4odXNlcm5hbWUpOwoJc2VydmljZV9sZW49c3RybGVuKHNlcnZpY2UpOwoJcmVhbG1fbGVu
PXN0cmxlbihyZWFsbSk7CgoJbWF4cGFyYW1sZW5ndGggPSBNQVgodXNlcl9sZW4sIHNlcnZpY2Vf
bGVuLCByZWFsbV9sZW4pOwoKCS8qIGZpbmQgdGhlIG51bWJlciBvZiBvY2N1cmVuY2VzIG9mIHBl
cmNlbnQgc2lnbiBpbiBmaWx0ZXIgKi8KCWZvciggcGVyY2VudHM9MCwgYnVmPShjaGFyICopcGF0
dGVybjsgKmJ1ZjsgYnVmKysgKSB7CgkJaWYoICpidWYgPT0gJyUnICkgcGVyY2VudHMrKzsKCX0K
CgkvKiBwZXJjZW50cyAqIDMgKiBtYXhwYXJhbWxlbmd0aCBiZWNhdXNlIHdlIG5lZWQgdG8gYWNj
b3VudCBmb3IKICAgICAgICAgKiBhbiBlbnRpcmVseS1lc2NhcGVkIHdvcnN0LWNhc2UtbGVuZ3Ro
IHBhcmFtZXRlciAqLwoJYnVmPW1hbGxvYyhzdHJsZW4ocGF0dGVybikgKyAocGVyY2VudHMgKiAz
ICogbWF4cGFyYW1sZW5ndGgpICsxKTsKCWlmKGJ1ZiA9PSBOVUxMKSB7CgkJc3lzbG9nKExPR19F
UlJ8TE9HX0FVVEgsICJDYW5ub3QgYWxsb2NhdGUgbWVtb3J5Iik7CgkJcmV0dXJuIExBS19OT01F
TTsKCX0KCWJ1ZlswXSA9ICdcMCc7CgkKCXB0ciA9IChjaGFyICopcGF0dGVybjsKCWVuZCA9IHB0
ciArIHN0cmxlbihwdHIpOwoKCXdoaWxlICgodGVtcD1zdHJjaHIocHRyLCclJykpIT1OVUxMICkg
ewoKCQlpZiAoKHRlbXAtcHRyKSA+IDApCgkJCXN0cm5jYXQoYnVmLCBwdHIsIHRlbXAtcHRyKTsK
CgkJaWYgKCh0ZW1wKzEpID49IGVuZCkgewoJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgs
ICJJbmNvbXBsZXRlIGxvb2t1cCBzdWJzdGl0dXRpb24gZm9ybWF0Iik7CgkJCWJyZWFrOwoJCX0K
CgkJc3dpdGNoICgqKHRlbXArMSkpIHsKCQkJY2FzZSAnJSc6CgkJCQlzdHJuY2F0KGJ1Zix0ZW1w
KzEsMSk7CgkJCQlicmVhazsKCQkJY2FzZSAndSc6CgkJCQlpZiAodXNlcm5hbWUhPU5VTEwpIHsK
CQkJCQlyYz1sYWtfZXNjYXBlKHVzZXJuYW1lLCBzdHJsZW4odXNlcm5hbWUpLCAmZWJ1Zik7CgkJ
CQkJaWYgKHJjID09IExBS19PSykgewoJCQkJCQlzdHJjYXQoYnVmLGVidWYpOwoJCQkJCQlmcmVl
KGVidWYpOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19B
VVRILCAiVXNlcm5hbWUgbm90IGF2YWlsYWJsZS4iKTsKCQkJCX0KCQkJCWJyZWFrOwoJCQljYXNl
ICdVJzoKCQkJCWlmICh1c2VybmFtZSE9TlVMTCkgewoJCQkJCQoJCQkJCXMgPSBzdHJjaHIodXNl
cm5hbWUsICdAJyk7CgkJCQkJcmM9bGFrX2VzY2FwZSh1c2VybmFtZSwgKHMgPyBzIC0gdXNlcm5h
bWUgOiBzdHJsZW4odXNlcm5hbWUpKSwgJmVidWYpOwoJCQkJCWlmIChyYyA9PSBMQUtfT0spIHsK
CQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShlYnVmKTsKCQkJCQl9CgkJCQl9IGVs
c2UgewoJCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVzZXJuYW1lIG5vdCBhdmFp
bGFibGUuIik7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAnZCc6CgkJCQlpZiAodXNlcm5hbWUh
PU5VTEwgJiYgKGRvbWFpbiA9IHN0cmNocih1c2VybmFtZSwgJ0AnKSkgJiYgZG9tYWluWzFdIT0n
XDAnKSB7CgkJCQkJcmM9bGFrX2VzY2FwZShkb21haW4rMSwgc3RybGVuKGRvbWFpbisxKSwgJmVi
dWYpOwoJCQkJCWlmIChyYyA9PSBMQUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJ
CQkJZnJlZShlYnVmKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xvZyhMT0dfV0FSTklO
R3xMT0dfQVVUSCwgIkRvbWFpbiBub3QgYXZhaWxhYmxlLiIpOwoJCQkJfQoJCQkJYnJlYWs7CgkJ
CWNhc2UgJ3InOgoJCQkJaWYgKHJlYWxtIT1OVUxMKSB7CgkJCQkJcmMgPSBsYWtfZXNjYXBlKHJl
YWxtLCBzdHJsZW4ocmVhbG0pLCAmZWJ1Zik7CgkJCQkJaWYgKHJjID09IExBS19PSykgewoJCQkJ
CQlzdHJjYXQoYnVmLGVidWYpOwoJCQkJCQlmcmVlKGVidWYpOwoJCQkJCX0KCQkJCX0gZWxzZSB7
CgkJCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiUmVhbG0gbm90IGF2YWlsYWJsZS4i
KTsKCQkJCX0KCQkJCWJyZWFrOwoJCQljYXNlICdzJzoKCQkJCWlmIChzZXJ2aWNlIT1OVUxMKSB7
CgkJCQkJcmMgPSBsYWtfZXNjYXBlKHNlcnZpY2UsIHN0cmxlbihzZXJ2aWNlKSwgJmVidWYpOwoJ
CQkJCWlmIChyYyA9PSBMQUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJl
ZShlYnVmKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0df
QVVUSCwgIlNlcnZpY2Ugbm90IGF2YWlsYWJsZS4iKTsKCQkJCX0KCQkJCWJyZWFrOwoJCQlkZWZh
dWx0OgoJCQkJYnJlYWs7CgkJfQoJCXB0cj10ZW1wKzI7Cgl9CglpZiAodGVtcDxlbmQpCgkJc3Ry
Y2F0KGJ1ZiwgcHRyKTsKCgkqcmVzdWx0ID0gYnVmOwoKCXJldHVybiBMQUtfT0s7Cn0KCmludCBs
YWtfaW5pdChjb25zdCBjaGFyICpjb25maWdmaWxlLCBMQUsgKipyZXQpIAp7CglMQUsgKmxhazsK
CWludCByYzsKCglsYWsgPSAqcmV0OwoKCWlmIChsYWsgIT0gTlVMTCkgewoJCXJldHVybiBMQUtf
T0s7Cgl9CgoJbGFrID0gKExBSyAqKW1hbGxvYyhzaXplb2YoTEFLKSk7CglpZiAobGFrID09IE5V
TEwpIHsKCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgIkNhbm5vdCBhbGxvY2F0ZSBtZW1vcnki
KTsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoKCWxhay0+YmluZF9zdGF0dXM9TEFLX05PVF9CT1VO
RDsKCWxhay0+bGQ9TlVMTDsKCWxhay0+Y29uZj1OVUxMOwoKCXJjID0gbGFrX2NvbmZpZyhjb25m
aWdmaWxlLCAmbGFrLT5jb25mKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlmcmVlKGxhayk7CgkJ
cmV0dXJuIHJjOwoJfQoKI2lmZGVmIEhBVkVfT1BFTlNTTAoJT3BlblNTTF9hZGRfYWxsX2RpZ2Vz
dHMoKTsKI2VuZGlmCgoJKnJldD1sYWs7CglyZXR1cm4gTEFLX09LOwp9Cgp2b2lkIGxha19jbG9z
ZShMQUsgKmxhaykgewoKCWlmIChsYWsgPT0gTlVMTCkKCQlyZXR1cm47CgoJaWYgKGxhay0+bGQg
IT0gTlVMTCkgewoJCWlmIChsYWstPmNvbmYtPmNhY2hlX3R0bCkKCQkJbGRhcF9kZXN0cm95X2Nh
Y2hlKGxhay0+bGQpOwoJCWxkYXBfdW5iaW5kX3MobGFrLT5sZCk7Cgl9CgoJbGFrX2NvbmZpZ19m
cmVlKGxhay0+Y29uZik7CgoJZnJlZShsYWspOwoKI2lmZGVmIEhBVkVfT1BFTlNTTAoJRVZQX2Ns
ZWFudXAoKTsKI2VuZGlmCgoJcmV0dXJuOwp9CgpzdGF0aWMgaW50IGxha19jb25uZWN0KExBSyAq
bGFrKQp7CglpbnQgICAgIHJjID0gMDsKCglpZiAobGFrLT5jb25mLT50bHNfY2FjZXJ0X2ZpbGUg
IT0gTlVMTCkgewoJCXJjID0gbGRhcF9zZXRfb3B0aW9uIChOVUxMLCBMREFQX09QVF9YX1RMU19D
QUNFUlRGSUxFLCBsYWstPmNvbmYtPnRsc19jYWNlcnRfZmlsZSk7CgkJaWYgKHJjICE9IExEQVBf
U1VDQ0VTUykgewoJCQlzeXNsb2cgKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNl
dCBMREFQX09QVF9YX1RMU19DQUNFUlRGSUxFICglcykuIiwgbGRhcF9lcnIyc3RyaW5nIChyYykp
OwoJCX0KCX0KCglpZiAobGFrLT5jb25mLT50bHNfY2FjZXJ0X2RpciAhPSBOVUxMKSB7CgkJcmMg
PSBsZGFwX3NldF9vcHRpb24gKE5VTEwsIExEQVBfT1BUX1hfVExTX0NBQ0VSVERJUiwgbGFrLT5j
b25mLT50bHNfY2FjZXJ0X2Rpcik7CgkJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJCQlzeXNs
b2cgKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9YX1RMU19D
QUNFUlRESVIgKCVzKS4iLCBsZGFwX2VycjJzdHJpbmcgKHJjKSk7CgkJfQoJfQoKCWlmIChsYWst
PmNvbmYtPnRsc19jaGVja19wZWVyICE9IDApIHsKCQlyYyA9IGxkYXBfc2V0X29wdGlvbihOVUxM
LCBMREFQX09QVF9YX1RMU19SRVFVSVJFX0NFUlQsICZsYWstPmNvbmYtPnRsc19jaGVja19wZWVy
KTsKCQlpZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7CgkJCXN5c2xvZyAoTE9HX1dBUk5JTkd8TE9H
X0FVVEgsICJVbmFibGUgdG8gc2V0IExEQVBfT1BUX1hfVExTX1JFUVVJUkVfQ0VSVCAoJXMpLiIs
IGxkYXBfZXJyMnN0cmluZyAocmMpKTsKCQl9Cgl9CgoJaWYgKGxhay0+Y29uZi0+dGxzX2NpcGhl
cnMgIT0gTlVMTCkgewoJCS8qIHNldCBjaXBoZXIgc3VpdGUsIGNlcnRpZmljYXRlIGFuZCBwcml2
YXRlIGtleTogKi8KCQlyYyA9IGxkYXBfc2V0X29wdGlvbihOVUxMLCBMREFQX09QVF9YX1RMU19D
SVBIRVJfU1VJVEUsIGxhay0+Y29uZi0+dGxzX2NpcGhlcnMpOwoJCWlmIChyYyAhPSBMREFQX1NV
Q0NFU1MpIHsKCQkJc3lzbG9nIChMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQg
TERBUF9PUFRfWF9UTFNfQ0lQSEVSX1NVSVRFICglcykuIiwgbGRhcF9lcnIyc3RyaW5nIChyYykp
OwoJCX0KCX0KCglpZiAobGFrLT5jb25mLT50bHNfY2VydCAhPSBOVUxMKSB7CgkJcmMgPSBsZGFw
X3NldF9vcHRpb24oTlVMTCwgTERBUF9PUFRfWF9UTFNfQ0VSVEZJTEUsIGxhay0+Y29uZi0+dGxz
X2NlcnQpOwoJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJc3lzbG9nIChMT0dfV0FSTklO
R3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERBUF9PUFRfWF9UTFNfQ0VSVEZJTEUgKCVzKS4i
LCBsZGFwX2VycjJzdHJpbmcgKHJjKSk7CgkJfQoJfQoKCWlmIChsYWstPmNvbmYtPnRsc19rZXkg
IT0gTlVMTCkgewoJCXJjID0gbGRhcF9zZXRfb3B0aW9uKE5VTEwsIExEQVBfT1BUX1hfVExTX0tF
WUZJTEUsIGxhay0+Y29uZi0+dGxzX2tleSk7CgkJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJ
CQlzeXNsb2cgKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9Y
X1RMU19LRVlGSUxFICglcykuIiwgbGRhcF9lcnIyc3RyaW5nIChyYykpOwoJCX0KCX0KCglyYyA9
IGxkYXBfaW5pdGlhbGl6ZSgmbGFrLT5sZCwgbGFrLT5jb25mLT5zZXJ2ZXJzKTsKCWlmIChyYyAh
PSBMREFQX1NVQ0NFU1MpIHsKCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgImxkYXBfaW5pdGlh
bGl6ZSBmYWlsZWQgKCVzKSIsIGxhay0+Y29uZi0+c2VydmVycyk7CgkJcmV0dXJuIExBS19GQUlM
OwoJfQoKCWlmIChsYWstPmNvbmYtPmRlYnVnKSB7CgkJcmMgPSBsZGFwX3NldF9vcHRpb24oTlVM
TCwgTERBUF9PUFRfREVCVUdfTEVWRUwsICYobGFrLT5jb25mLT5kZWJ1ZykpOwoJCWlmIChyYyAh
PSBMREFQX09QVF9TVUNDRVNTKQoJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFi
bGUgdG8gc2V0IExEQVBfT1BUX0RFQlVHX0xFVkVMICV4LiIsIGxhay0+Y29uZi0+ZGVidWcpOwoJ
fQoKCXJjID0gbGRhcF9zZXRfb3B0aW9uKGxhay0+bGQsIExEQVBfT1BUX1BST1RPQ09MX1ZFUlNJ
T04sICYobGFrLT5jb25mLT52ZXJzaW9uKSk7CglpZiAocmMgIT0gTERBUF9PUFRfU1VDQ0VTUykg
ewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERBUF9PUFRf
UFJPVE9DT0xfVkVSU0lPTiAlZC4iLCBsYWstPmNvbmYtPnZlcnNpb24pOwoJCWxhay0+Y29uZi0+
dmVyc2lvbiA9IExEQVBfVkVSU0lPTjI7Cgl9CgoJcmMgPSBsZGFwX3NldF9vcHRpb24obGFrLT5s
ZCwgTERBUF9PUFRfTkVUV09SS19USU1FT1VULCAmKGxhay0+Y29uZi0+dGltZW91dCkpOwoJaWYg
KHJjICE9IExEQVBfT1BUX1NVQ0NFU1MpIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgs
ICJVbmFibGUgdG8gc2V0IExEQVBfT1BUX05FVFdPUktfVElNRU9VVCAlZC4lZC4iLCBsYWstPmNv
bmYtPnRpbWVvdXQudHZfc2VjLCBsYWstPmNvbmYtPnRpbWVvdXQudHZfdXNlYyk7Cgl9CgoJcmMg
PSBsZGFwX3NldF9vcHRpb24obGFrLT5sZCwgTERBUF9PUFRfVElNRUxJTUlULCAmKGxhay0+Y29u
Zi0+dGltZV9saW1pdCkpOwoJaWYgKHJjICE9IExEQVBfT1BUX1NVQ0NFU1MpIHsKCQlzeXNsb2co
TE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0IExEQVBfT1BUX1RJTUVMSU1JVCAl
ZC4iLCBsYWstPmNvbmYtPnRpbWVfbGltaXQpOwoJfQoKCXJjID0gbGRhcF9zZXRfb3B0aW9uKGxh
ay0+bGQsIExEQVBfT1BUX0RFUkVGLCAmKGxhay0+Y29uZi0+ZGVyZWYpKTsKCWlmIChyYyAhPSBM
REFQX09QVF9TVUNDRVNTKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxl
IHRvIHNldCBMREFQX09QVF9ERVJFRiAlZC4iLCBsYWstPmNvbmYtPmRlcmVmKTsKCX0KCglyYyA9
IGxkYXBfc2V0X29wdGlvbihsYWstPmxkLCBMREFQX09QVF9SRUZFUlJBTFMsIGxhay0+Y29uZi0+
cmVmZXJyYWxzID8gTERBUF9PUFRfT04gOiBMREFQX09QVF9PRkYpOwoJaWYgKHJjICE9IExEQVBf
T1BUX1NVQ0NFU1MpIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8g
c2V0IExEQVBfT1BUX1JFRkVSUkFMUy4iKTsKCX0KCglyYyA9IGxkYXBfc2V0X29wdGlvbihsYWst
PmxkLCBMREFQX09QVF9TSVpFTElNSVQsICYobGFrLT5jb25mLT5zaXplX2xpbWl0KSk7CglpZiAo
cmMgIT0gTERBUF9PUFRfU1VDQ0VTUykKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJV
bmFibGUgdG8gc2V0IExEQVBfT1BUX1NJWkVMSU1JVCAlZC4iLCBsYWstPmNvbmYtPnNpemVfbGlt
aXQpOwoKCXJjID0gbGRhcF9zZXRfb3B0aW9uKGxhay0+bGQsIExEQVBfT1BUX1JFU1RBUlQsIGxh
ay0+Y29uZi0+cmVzdGFydCA/IExEQVBfT1BUX09OIDogTERBUF9PUFRfT0ZGKTsKCWlmIChyYyAh
PSBMREFQX09QVF9TVUNDRVNTKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5h
YmxlIHRvIHNldCBMREFQX09QVF9SRVNUQVJULiIpOwoJfQoKCS8qCgkgKiBTZXQgdXAgY2xpZW50
LXNpZGUgY2FjaGluZwoJICovCglpZiAobGFrLT5jb25mLT5jYWNoZV90dGwpIHsKCQlyYyA9IGxk
YXBfZW5hYmxlX2NhY2hlKGxhay0+bGQsIGxhay0+Y29uZi0+Y2FjaGVfdHRsLCBsYWstPmNvbmYt
PmNhY2hlX21lbSk7CgkJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJCQlzeXNsb2coTE9HX1dB
Uk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gZW5hYmxlIGNhY2hlIC0tIGNvbnRpbnVpbmcgKCVz
KSIsIGxkYXBfZXJyMnN0cmluZyhyYykpOwoJCX0KCX0KCglyZXR1cm4gTEFLX09LOwp9CgoKc3Rh
dGljIGludCBsYWtfYmluZChMQUsgKmxhaywgY2hhciBmbGFnLCBjb25zdCBjaGFyICpiaW5kX2Ru
LCBjb25zdCBjaGFyICpwYXNzd29yZCkgCnsKCWludCByYzsKCglpZiAobGFrLT5iaW5kX3N0YXR1
cyA9PSBMQUtfQklORF9BTk9OWU1PVVMgJiYKCSAgICBmbGFnID09IExBS19CSU5EX0FOT05ZTU9V
UykgewoJICAgIHJldHVybiBMQUtfT0s7Cgl9CgoJaWYgKGxhay0+YmluZF9zdGF0dXMgPT0gTEFL
X05PVF9CT1VORCkgewoJCWlmIChsYWstPmxkICE9IE5VTEwpIHsKCQkJaWYgKGxhay0+Y29uZi0+
Y2FjaGVfdHRsKQoJCQkJbGRhcF9kZXN0cm95X2NhY2hlKGxhay0+bGQpOwoJCQlsZGFwX3VuYmlu
ZF9zKGxhay0+bGQpOwoJCQlsYWstPmxkID0gTlVMTDsKCQl9CgoJCXJjID0gbGFrX2Nvbm5lY3Qo
bGFrKTsKCQlpZiAocmMgIT0gTEFLX09LKSB7CgkJCXJldHVybiByYzsKCQl9Cgl9IGVsc2UgewoJ
CWlmIChsYWstPmNvbmYtPnZlcnNpb24gPT0gTERBUF9WRVJTSU9OMikgewoKCQkJbGFrLT5iaW5k
X3N0YXR1cyA9IExBS19OT1RfQk9VTkQ7CgoJCQlpZiAobGFrLT5sZCAhPSBOVUxMKSB7CgkJCQlp
ZiAobGFrLT5jb25mLT5jYWNoZV90dGwpCgkJCQkJbGRhcF9kZXN0cm95X2NhY2hlKGxhay0+bGQp
OwoJCQkJbGRhcF91bmJpbmRfcyhsYWstPmxkKTsKCgkJCQlsYWstPmxkID0gTlVMTDsKCQkJfQoJ
CQlyYyA9IGxha19jb25uZWN0KGxhayk7CgkJCWlmIChyYyAhPSBMQUtfT0spIHsKCQkJCXJldHVy
biByYzsKCQkJfQoJCX0KCX0KCglyYyA9IGxkYXBfc2ltcGxlX2JpbmRfcyhsYWstPmxkLCBiaW5k
X2RuLCBwYXNzd29yZCk7CglpZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7CgkgICAgc3lzbG9nKChm
bGFnID09IExBS19CSU5EX0FOT05ZTU9VUyA/IExPR19XQVJOSU5HIDogTE9HX0RFQlVHKXxMT0df
QVVUSCwKCQkgICAibGRhcF9zaW1wbGVfYmluZCgpIGZhaWxlZCBhcyAlcyAoJXMpIiwKCQkgICAo
IWJpbmRfZG4gfHwgYmluZF9kblswXSA9PSAnXDAnKSA/ICJhbm9ueW1vdXMiIDogYmluZF9kbiwK
CQkgICBsZGFwX2VycjJzdHJpbmcocmMpKTsKCSAgICBsYWstPmJpbmRfc3RhdHVzID0gTEFLX05P
VF9CT1VORDsKCSAgICByZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJbGFrLT5iaW5kX3N0YXR1cyA9IGZs
YWc7CglyZXR1cm4gTEFLX09LOwp9CgoKc3RhdGljIGludCBsYWtfc2VhcmNoKExBSyAqbGFrLCBj
b25zdCBjaGFyICpmaWx0ZXIsIGNvbnN0IGNoYXIgKiphdHRycywgTERBUE1lc3NhZ2UgKipyZXMp
CnsKCWludCByYyA9IDA7CglpbnQgcmV0cnkgPSAxOwoKCSpyZXMgPSBOVUxMOwoKcmV0cnk6Cgly
YyA9IGxha19iaW5kKGxhaywgTEFLX0JJTkRfQU5PTllNT1VTLCBsYWstPmNvbmYtPmJpbmRfZG4s
IGxhay0+Y29uZi0+YmluZF9wdyk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJc3lzbG9nKExPR19X
QVJOSU5HfExPR19BVVRILCAibGFrX2JpbmQoKSBmYWlsZWQiKTsKCQlyZXR1cm4gTEFLX0ZBSUw7
Cgl9CgoJcmMgPSBsZGFwX3NlYXJjaF9zdChsYWstPmxkLCBsYWstPmNvbmYtPnNlYXJjaF9iYXNl
LCBsYWstPmNvbmYtPnNjb3BlLCBmaWx0ZXIsIChjaGFyICoqKSBhdHRycywgMCwgJihsYWstPmNv
bmYtPnRpbWVvdXQpLCByZXMpOwoJc3dpdGNoIChyYykgewoJCWNhc2UgTERBUF9TVUNDRVNTOgoJ
CWNhc2UgTERBUF9OT19TVUNIX09CSkVDVDoKCQkJYnJlYWs7CgkJY2FzZSBMREFQX1RJTUVPVVQ6
CgkJY2FzZSBMREFQX1RJTUVMSU1JVF9FWENFRURFRDoKCQljYXNlIExEQVBfQlVTWToKCQljYXNl
IExEQVBfVU5BVkFJTEFCTEU6CgkJY2FzZSBMREFQX0lOU1VGRklDSUVOVF9BQ0NFU1M6CgkJCS8q
ICBXZSBkbyBub3QgbmVlZCB0byByZS1jb25uZWN0IHRvIHRoZSBMREFQIHNlcnZlciAKCQkJICAg
IHVuZGVyIHRoZXNlIGNvbmRpdGlvbnMgKi8KCQkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICJs
ZGFwX3NlYXJjaF9zdCgpIGZhaWxlZDogJXMiLCBsZGFwX2VycjJzdHJpbmcocmMpKTsKCQkJbGRh
cF9tc2dmcmVlKCpyZXMpOwoJCQlyZXR1cm4gTEFLX0ZBSUw7CgkJY2FzZSBMREFQX1NFUlZFUl9E
T1dOOgoJCQlpZiAocmV0cnkpIHsKCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgImxk
YXBfc2VhcmNoX3N0KCkgZmFpbGVkOiAlcy4gVHJ5aW5nIHRvIHJlY29ubmVjdC4iLCBsZGFwX2Vy
cjJzdHJpbmcocmMpKTsKCQkJCWxkYXBfbXNnZnJlZSgqcmVzKTsKCQkJCWxhay0+YmluZF9zdGF0
dXMgPSBMQUtfTk9UX0JPVU5EOwoJCQkJcmV0cnktLTsKCQkJCWdvdG8gcmV0cnk7CgkJCX0KCQlk
ZWZhdWx0OgoJCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgImxkYXBfc2VhcmNoX3N0KCkgZmFp
bGVkOiAlcyIsIGxkYXBfZXJyMnN0cmluZyhyYykpOwoJCQlsZGFwX21zZ2ZyZWUoKnJlcyk7CgkJ
CWxhay0+YmluZF9zdGF0dXMgPSBMQUtfTk9UX0JPVU5EOwoJCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9
CgoJaWYgKChsZGFwX2NvdW50X2VudHJpZXMobGFrLT5sZCwgKnJlcykpICE9IDEpIHsKCQlzeXNs
b2coTE9HX0RFQlVHfExPR19BVVRILCAiRW50cnkgbm90IGZvdW5kIG9yIG1vcmUgdGhhbiBvbmUg
ZW50cmllcyBmb3VuZCAoJXMpLiIsIGZpbHRlcik7CgkJbGRhcF9tc2dmcmVlKCpyZXMpOwoJCXJl
dHVybiBMQUtfRkFJTDsKCX0KCglyZXR1cm4gTEFLX09LOwp9CgovKiAKICogbGFrX3JldHJpZXZl
IC0gcmV0cmlldmUgdXNlckByZWFsbSB2YWx1ZXMgc3BlY2lmaWVkIGJ5ICdhdHRycycKICovCmlu
dCBsYWtfcmV0cmlldmUoTEFLICpsYWssIGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnNl
cnZpY2UsIGNvbnN0IGNoYXIgKnJlYWxtLCBjb25zdCBjaGFyICoqYXR0cnMsIExBS19SRVNVTFQg
KipyZXQpCnsKCWludCByYyA9IDAsIGk7CgljaGFyICpmaWx0ZXIgPSBOVUxMOwoJTERBUE1lc3Nh
Z2UgKnJlczsKCUxEQVBNZXNzYWdlICplbnRyeTsKCUJlckVsZW1lbnQgKmJlcjsKCWNoYXIgKmF0
dHIsICoqdmFsczsKICAgIAogICAgCSpyZXQgPSBOVUxMOwoKCWlmIChsYWsgPT0gTlVMTCkgewoJ
CXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAibGFrX2luaXQgZGlkIG5vdCBydW4uIik7CgkJcmV0
dXJuIExBS19GQUlMOwoJfQoKCWlmICh1c2VyID09IE5VTEwgfHwgdXNlclswXSA9PSAnXDAnKSB7
CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCXJjID0gbGFrX2ZpbHRlcihsYWstPmNvbmYtPmZpbHRl
ciwgdXNlciwgc2VydmljZSwgcmVhbG0sICZmaWx0ZXIpOwoJaWYgKHJjICE9IExBS19PSykgewoJ
CXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxha19zZWFyY2gobGFrLCBmaWx0ZXIsIGF0dHJz
LCAmcmVzKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlmcmVlKGZpbHRlcik7CgkJcmV0dXJuIExB
S19GQUlMOwoJfQoKCWVudHJ5ID0gbGRhcF9maXJzdF9lbnRyeShsYWstPmxkLCByZXMpOyAKCWlm
IChlbnRyeSA9PSBOVUxMKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAibGRhcF9m
aXJzdF9lbnRyeSgpIGZhaWxlZC4iKTsKCQlmcmVlKGZpbHRlcik7CgkJbGRhcF9tc2dmcmVlKHJl
cyk7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCXJjID0gTEFLX09LOwoJZm9yIChhdHRyID0gbGRh
cF9maXJzdF9hdHRyaWJ1dGUobGFrLT5sZCwgZW50cnksICZiZXIpOyBhdHRyICE9IE5VTEw7IAoJ
CWF0dHIgPSBsZGFwX25leHRfYXR0cmlidXRlKGxhay0+bGQsIGVudHJ5LCBiZXIpKSB7CgoJCXZh
bHMgPSBsZGFwX2dldF92YWx1ZXMobGFrLT5sZCwgZW50cnksIGF0dHIpOwoJCWlmICh2YWxzID09
IE5VTEwpIHsKCQkJY29udGludWU7CgkJfQoKCQlmb3IgKGkgPSAwOyB2YWxzW2ldICE9IE5VTEw7
IGkrKykgewoJCQlyYyA9IGxha19yZXN1bHRfYWRkKGxhaywgYXR0ciwgdmFsc1tpXSwgcmV0KTsK
CQkJaWYgKHJjICE9IExBS19PSykgewoJCQkJYnJlYWs7CgkJCX0KCQl9CgoJCWxkYXBfdmFsdWVf
ZnJlZSh2YWxzKTsKCQlsZGFwX21lbWZyZWUoYXR0cik7CgoJCWlmIChyYyAhPSBMQUtfT0spIHsK
CQkJbGFrX3Jlc3VsdF9mcmVlKCpyZXQpOwoJCQkqcmV0ID0gTlVMTDsKCQkJYnJlYWs7CgkJfQoJ
fQoKCWlmIChiZXIgIT0gTlVMTCkKCQliZXJfZnJlZShiZXIsIDApOwoJbGRhcF9tc2dmcmVlKHJl
cyk7CglmcmVlKGZpbHRlcik7CgoJaWYgKCpyZXQgPT0gTlVMTCkKCQlyZXR1cm4gTEFLX05PRU5U
OwoKCXJldHVybiBMQUtfT0s7Cn0KCgpzdGF0aWMgaW50IGxha19ncm91cF9tZW1iZXIoTEFLICps
YWssIGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnNlcnZpY2UsIGNvbnN0IGNoYXIgKnJl
YWxtLCBjb25zdCBjaGFyICpkbikKewoJY2hhciAqZ3JvdXA7CglpbnQgcmM7CgoJcmMgPSBsYWtf
ZmlsdGVyKGxhay0+Y29uZi0+Z3JvdXBfZG4sIHVzZXIsIHNlcnZpY2UsIHJlYWxtLCAmZ3JvdXAp
OwoJaWYgKHJjICE9IExBS19PSykgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgImxh
a19maWx0ZXIgZmFpbGVkLiIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxkYXBfY29t
cGFyZV9zKGxhay0+bGQsIGdyb3VwLCBsYWstPmNvbmYtPmdyb3VwX2F0dHIsIGRuKTsKCWZyZWUo
Z3JvdXApOwoJaWYgKHJjICE9IExEQVBfQ09NUEFSRV9UUlVFKSB7CgkJc3lzbG9nKExPR19XQVJO
SU5HfExPR19BVVRILCAibGRhcF9jb21wYXJlX3MoKSBmb3IgZ3JvdXAgZmFpbGVkLiIpOwoJCXJj
ID0gTEFLX0ZBSUw7Cgl9CgoJcmV0dXJuIExBS19PSzsKfQoKc3RhdGljIGludCBsYWtfYXV0aF9j
dXN0b20oTEFLICpsYWssIGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnNlcnZpY2UsIGNv
bnN0IGNoYXIgKnJlYWxtLCBjb25zdCBjaGFyICpwYXNzd29yZCkgCnsKCUxBS19SRVNVTFQgKmxy
ZXMsICpwdHI7CglpbnQgcmM7CglzdHJ1Y3QgcGFzc3dvcmRfY2hlY2sgKnBjOwoJY29uc3QgY2hh
ciAqYXR0cnNbXSA9IHsiZG4iLCBsYWstPmNvbmYtPnBhc3N3b3JkX2F0dHIsIE5VTEx9OwoJY2hh
ciAqZG47CgoJcmMgPSBsYWtfcmV0cmlldmUobGFrLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgYXR0
cnMsICZscmVzKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlyZXR1cm4gcmM7Cgl9CgoJcmMgPSBM
QUtfRkFJTDsKCglmb3IgKHB0ciA9IGxyZXM7IHB0ciAhPSBOVUxMOyBwdHIgPSBwdHItPm5leHQp
IHsKCQkKCQlpZiAoc3RyY2FzZWNtcChwdHItPmF0dHJpYnV0ZSwgbGFrLT5jb25mLT5wYXNzd29y
ZF9hdHRyKSkKCQkJY29udGludWU7CgoJCXJjID0gbGFrX2NoZWNrX3Bhc3N3b3JkKHB0ci0+dmFs
dWUsIHBhc3N3b3JkLCBOVUxMKTsKCQlpZiAocmMgPT0gTEFLX09LKSB7CgkJCWJyZWFrOwoJCX0K
CX0KCglpZiAocmMgPT0gTEFLX09LICYmCgkgICAgbGFrLT5jb25mLT5ncm91cF9kbiAhPSBOVUxM
ICYmICoobGFrLT5jb25mLT5ncm91cF9kbikgIT0gJ1wwJykgewoKCQlyYyA9IExBS19GQUlMOwoK
CQlmb3IgKHB0ciA9IGxyZXM7IHB0ciAhPSBOVUxMOyBwdHIgPSBwdHItPm5leHQpCgkJCWlmICgh
c3RyY2FzZWNtcChwdHItPmF0dHJpYnV0ZSwgImRuIikpIHsKCQkJCXJjID0gbGFrX2dyb3VwX21l
bWJlcihsYWssIHVzZXIsIHNlcnZpY2UsIHJlYWxtLCBkbik7CgkJCQlicmVhazsKCQkJfQoKCQlz
eXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJHcm91cCBjaGVjayBmYWlsZWQgKGRuIHVua25v
d24pLiIpOwoJfQoJCglsYWtfcmVzdWx0X2ZyZWUobHJlcyk7CgoJcmV0dXJuKHJjKTsKfQoKc3Rh
dGljIGludCBsYWtfYXV0aF9iaW5kKExBSyAqbGFrLCBjb25zdCBjaGFyICp1c2VyLCBjb25zdCBj
aGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqcGFzc3dvcmQpIAp7
CgljaGFyICpmaWx0ZXI7CglpbnQgcmM7CgljaGFyICpkbjsKCUxEQVBNZXNzYWdlICpyZXMsICpl
bnRyeTsKCglyYyA9IGxha19maWx0ZXIobGFrLT5jb25mLT5maWx0ZXIsIHVzZXIsIHNlcnZpY2Us
IHJlYWxtLCAmZmlsdGVyKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlzeXNsb2coTE9HX1dBUk5J
Tkd8TE9HX0FVVEgsICJsYWtfZmlsdGVyIGZhaWxlZC4iKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9
CgoJcmMgPSBsYWtfc2VhcmNoKGxhaywgZmlsdGVyLCBOVUxMLCAmcmVzKTsKCWlmIChyYyAhPSBM
QUtfT0spIHsKCQlmcmVlKGZpbHRlcik7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWVudHJ5ID0g
bGRhcF9maXJzdF9lbnRyeShsYWstPmxkLCByZXMpOyAKCWlmIChlbnRyeSA9PSBOVUxMKSB7CgkJ
c3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAibGRhcF9maXJzdF9lbnRyeSgpLiIpOwoJCWZy
ZWUoZmlsdGVyKTsKCQlsZGFwX21zZ2ZyZWUocmVzKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJ
ZG4gPSBsZGFwX2dldF9kbihsYWstPmxkLCByZXMpOwoJaWYgKGRuID09IE5VTEwpIHsKCQlzeXNs
b2coTE9HX0VSUnxMT0dfQVVUSCwgImxkYXBfZ2V0X2RuKCkgZmFpbGVkLiIpOwoJCWZyZWUoZmls
dGVyKTsKCQlsZGFwX21zZ2ZyZWUgKHJlcyk7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWZyZWUo
ZmlsdGVyKTsKCWxkYXBfbXNnZnJlZShyZXMpOwoKCXJjID0gbGFrX2JpbmQobGFrLCBMQUtfQklO
RF9BU19VU0VSLCBkbiwgcGFzc3dvcmQpOwoKCWlmIChyYyA9PSBMQUtfT0sgJiYKCSAgICBsYWst
PmNvbmYtPmdyb3VwX2RuICE9IE5VTEwgJiYgKihsYWstPmNvbmYtPmdyb3VwX2RuKSAhPSAnXDAn
KQoJCXJjID0gbGFrX2dyb3VwX21lbWJlcihsYWssIHVzZXIsIHNlcnZpY2UsIHJlYWxtLCBkbik7
CgoJbGRhcF9tZW1mcmVlKGRuKTsKCglsYWtfYmluZChsYWssIExBS19CSU5EX0FOT05ZTU9VUywg
bGFrLT5jb25mLT5iaW5kX2RuLCBsYWstPmNvbmYtPmJpbmRfcHcpOwoKCglyZXR1cm4gcmM7Cn0K
CgpzdGF0aWMgaW50IGxha19hdXRoX2Zhc3RiaW5kKExBSyAqbGFrLCBjb25zdCBjaGFyICp1c2Vy
LCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqcGFz
c3dvcmQpIAp7CglpbnQgcmM7CgljaGFyICpkbiA9IE5VTEw7CgoJcmMgPSBsYWtfZmlsdGVyKGxh
ay0+Y29uZi0+ZmlsdGVyLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgJmRuKTsKCWlmIChyYyAhPSBM
QUtfT0sgfHwgZG4gPT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgImxh
a19maWx0ZXIgZmFpbGVkLiIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxha19iaW5k
KGxhaywgTEFLX0JJTkRfQVNfVVNFUiwgZG4sIHBhc3N3b3JkKTsKCWZyZWUoZG4pOwoKCWlmIChy
YyA9PSBMQUtfT0sgJiYKCSAgICBsYWstPmNvbmYtPmdyb3VwX2RuICE9IE5VTEwgJiYgKihsYWst
PmNvbmYtPmdyb3VwX2RuKSAhPSAnXDAnKQoJCXJjID0gbGFrX2dyb3VwX21lbWJlcihsYWssIHVz
ZXIsIHNlcnZpY2UsIHJlYWxtLCBkbik7CgoJcmV0dXJuIHJjOwp9CgppbnQgbGFrX2F1dGhlbnRp
Y2F0ZShMQUsgKmxhaywgY29uc3QgY2hhciAqdXNlciwgY29uc3QgY2hhciAqc2VydmljZSwgY29u
c3QgY2hhciAqcmVhbG0sIGNvbnN0IGNoYXIgKnBhc3N3b3JkKSAKewoJaW50IHJjOwoKCWlmIChs
YWsgPT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAibGFrX2luaXQgZGlkIG5v
dCBydW4uIik7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWlmICh1c2VyID09IE5VTEwgfHwgdXNl
clswXSA9PSAnXDAnKQoJCXJldHVybiBMQUtfRkFJTDsKCglpZiAobGFrLT5jb25mLT5hdXRoX21l
dGhvZCA9PSBMQUtfQVVUSF9NRVRIT0RfQklORCkKCQlyYyA9IGxha19hdXRoX2JpbmQobGFrLCB1
c2VyLCBzZXJ2aWNlLCByZWFsbSwgcGFzc3dvcmQpOwoJZWxzZSBpZiAobGFrLT5jb25mLT5hdXRo
X21ldGhvZCA9PSBMQUtfQVVUSF9NRVRIT0RfQ1VTVE9NKQoJCXJjID0gbGFrX2F1dGhfY3VzdG9t
KGxhaywgdXNlciwgc2VydmljZSwgcmVhbG0sIHBhc3N3b3JkKTsKCWVsc2UKCQlyYyA9IGxha19h
dXRoX2Zhc3RiaW5kKGxhaywgdXNlciwgc2VydmljZSwgcmVhbG0sIHBhc3N3b3JkKTsKCglyZXR1
cm4gcmM7Cn0KCgpzdGF0aWMgaW50IGxha19yZXN1bHRfYWRkKExBSyAqbGFrLCBjb25zdCBjaGFy
ICphdHRyLCBjb25zdCBjaGFyICp2YWwsIExBS19SRVNVTFQgKipyZXQpICAKewoJTEFLX1JFU1VM
VCAqbHJlczsKCQoJbHJlcyA9IChMQUtfUkVTVUxUICopIG1hbGxvYyhzaXplb2YoTEFLX1JFU1VM
VCkpOwoJaWYgKGxyZXMgPT0gTlVMTCkgewoJCXJldHVybiBMQUtfTk9NRU07Cgl9CgoJbHJlcy0+
bmV4dCA9IE5VTEw7CgoJbHJlcy0+YXR0cmlidXRlID0gc3RyZHVwKGF0dHIpOwoJaWYgKGxyZXMt
PmF0dHJpYnV0ZSA9PSBOVUxMKSB7CgkJbGFrX3Jlc3VsdF9mcmVlKGxyZXMpOwoJCXJldHVybiBM
QUtfTk9NRU07Cgl9CgoJbHJlcy0+dmFsdWUgPSBzdHJkdXAodmFsKTsKCWlmIChscmVzLT52YWx1
ZSA9PSBOVUxMKSB7CgkJbGFrX3Jlc3VsdF9mcmVlKGxyZXMpOwoJCXJldHVybiBMQUtfTk9NRU07
Cgl9CglscmVzLT5sZW4gPSBzdHJsZW4obHJlcy0+dmFsdWUpOwoKCWxyZXMtPm5leHQgPSAqcmV0
OwoKCSpyZXQgPSBscmVzOwoJcmV0dXJuIExBS19PSzsKfQoKCnZvaWQgbGFrX3Jlc3VsdF9mcmVl
KExBS19SRVNVTFQgKnJlcykgCnsKCUxBS19SRVNVTFQgKmxyZXMsICpwdHIgPSByZXM7CgoJaWYg
KHB0ciA9PSBOVUxMKQoJCXJldHVybjsKCglmb3IgKGxyZXMgPSBwdHI7IGxyZXMgIT0gTlVMTDsg
bHJlcyA9IHB0cikgewoKCQlwdHIgPSBscmVzLT5uZXh0OwoKCQlpZiAobHJlcy0+YXR0cmlidXRl
ICE9IE5VTEwpIHsKCQkJbWVtc2V0KGxyZXMtPmF0dHJpYnV0ZSwgMCwgc3RybGVuKGxyZXMtPnZh
bHVlKSk7CgkJCWZyZWUobHJlcy0+YXR0cmlidXRlKTsJCgkJfQoKCQlpZiAobHJlcy0+dmFsdWUg
IT0gTlVMTCkgewoJCQltZW1zZXQobHJlcy0+dmFsdWUsIDAsIHN0cmxlbihscmVzLT52YWx1ZSkp
OwoJCQlmcmVlKGxyZXMtPnZhbHVlKTsJCgkJfQoKCQlscmVzLT5uZXh0ID0gTlVMTDsKCgkJZnJl
ZShscmVzKTsKCX0KCglyZXR1cm47Cn0KCnN0YXRpYyBpbnQgbGFrX2NoZWNrX3Bhc3N3b3JkKGNv
bnN0IGNoYXIgKmhhc2gsIGNvbnN0IGNoYXIgKnBhc3N3ZCwgdm9pZCAqcm9jaykgCnsKCWludCBp
LCBobGVuOwoJaW50IHJjOwoKCWlmIChoYXNoID09IE5VTEwgfHwgaGFzaFswXSA9PSAnXDAnKSB7
CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWlmIChwYXNzd2QgPT0gTlVMTCB8fCBwYXNzd2RbMF0g
PT0gJ1wwJykgewoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglmb3IgKGkgPSAwOyBwYXNzd29yZF9z
Y2hlbWVbaV0uaGFzaCAhPSBOVUxMOyBpKyspIHsKCgkJaGxlbiA9IHN0cmxlbihwYXNzd29yZF9z
Y2hlbWVbaV0uaGFzaCk7CgkJaWYgKCFzdHJuY2FzZWNtcChwYXNzd29yZF9zY2hlbWVbaV0uaGFz
aCwgaGFzaCwgaGxlbikpIHsKCQkJaWYgKHBhc3N3b3JkX3NjaGVtZVtpXS5jaGVjaykgewoJCQkJ
cmMgPSAocGFzc3dvcmRfc2NoZW1lW2ldLmNoZWNrKShoYXNoK2hsZW4sIHBhc3N3ZCwKCQkJCQkJ
CQlwYXNzd29yZF9zY2hlbWVbaV0ucm9jayk7CgkJCX0KCQkJcmV0dXJuIHJjOwoJCX0KCX0KCgly
ZXR1cm4gc3RyY21wKGhhc2gsIHBhc3N3ZCkgPyBMQUtfRkFJTCA6IExBS19PSzsKfQoKI2lmZGVm
IEhBVkVfT1BFTlNTTAoKc3RhdGljIGludCBsYWtfYmFzZTY0X2RlY29kZShjb25zdCBjaGFyICpz
cmMsIGNoYXIgKipyZXQsIGludCAqcmxlbikgewoKCWludCByYywgaSwgdGxlbiA9IDA7CgljaGFy
ICp0ZXh0OwoJRVZQX0VOQ09ERV9DVFggRVZQX2N0eDsKCgl0ZXh0ID0gKGNoYXIgKiltYWxsb2Mo
KChzdHJsZW4oc3JjKSszKS80ICogMykgKyAxKTsKCWlmICh0ZXh0ID09IE5VTEwpIHsKCQlyZXR1
cm4gTEFLX05PTUVNOwoJfQoKCUVWUF9EZWNvZGVJbml0KCZFVlBfY3R4KTsKCXJjID0gRVZQX0Rl
Y29kZVVwZGF0ZSgmRVZQX2N0eCwgdGV4dCwgJmksIChjaGFyICopc3JjLCBzdHJsZW4oc3JjKSk7
CglpZiAocmMgPCAwKSB7CgkJZnJlZSh0ZXh0KTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9Cgl0bGVu
ICs9IGk7CglFVlBfRGVjb2RlRmluYWwoJkVWUF9jdHgsIHRleHQsICZpKTsgCgoJKnJldCA9IHRl
eHQ7CglpZiAocmxlbiAhPSBOVUxMKSB7CgkJKnJsZW4gPSB0bGVuOwoJfQoKCXJldHVybiBMQUtf
T0s7Cn0KCnN0YXRpYyBpbnQgbGFrX2NoZWNrX2hhc2hlZChjb25zdCBjaGFyICpoYXNoLCBjb25z
dCBjaGFyICpwYXNzd2QsIHZvaWQgKnJvY2spCnsKCWludCByYywgY2xlbjsKCXN0cnVjdCBoYXNo
X3JvY2sgKmhyb2NrID0gKHN0cnVjdCBoYXNoX3JvY2sgKikgcm9jazsKCUVWUF9NRF9DVFggbWRj
dHg7Cgljb25zdCBFVlBfTUQgKm1kOwoJdW5zaWduZWQgY2hhciBkaWdlc3RbRVZQX01BWF9NRF9T
SVpFXTsKCWNoYXIgKmNyZWQ7CgoJbWQgPSBFVlBfZ2V0X2RpZ2VzdGJ5bmFtZShocm9jay0+bWRh
KTsKCWlmICghbWQpIHsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmMgPSBsYWtfYmFzZTY0X2Rl
Y29kZShoYXNoLCAmY3JlZCwgJmNsZW4pOwoJaWYgKHJjICE9IExBS19PSykgewoJCXJldHVybiBy
YzsKCX0KCglFVlBfRGlnZXN0SW5pdCgmbWRjdHgsIG1kKTsKCUVWUF9EaWdlc3RVcGRhdGUoJm1k
Y3R4LCBwYXNzd2QsIHN0cmxlbihwYXNzd2QpKTsKCWlmIChocm9jay0+c2FsdGVkKSB7CgkJRVZQ
X0RpZ2VzdFVwZGF0ZSgmbWRjdHgsICZjcmVkW0VWUF9NRF9zaXplKG1kKV0sCgkJCQkgY2xlbiAt
IEVWUF9NRF9zaXplKG1kKSk7Cgl9CglFVlBfRGlnZXN0RmluYWwoJm1kY3R4LCBkaWdlc3QsIE5V
TEwpOwoKCXJjID0gbWVtY21wKChjaGFyICopY3JlZCwgKGNoYXIgKilkaWdlc3QsIEVWUF9NRF9z
aXplKG1kKSk7CglmcmVlKGNyZWQpOwoJcmV0dXJuIHJjID8gTEFLX0ZBSUwgOiBMQUtfT0s7Cn0K
CiNlbmRpZiAvKiBIQVZFX09QRU5TU0wgKi8KCnN0YXRpYyBpbnQgbGFrX2NoZWNrX2NyeXB0KGNv
bnN0IGNoYXIgKmhhc2gsIGNvbnN0IGNoYXIgKnBhc3N3ZCwgdm9pZCAqcm9jaykgCnsKCWNoYXIg
KmNyZWQ7CgoJaWYgKGhhc2ggPT0gTlVMTCB8fCBoYXNoWzBdID09ICdcMCcpIHsKCQlyZXR1cm4g
TEFLX0ZBSUw7Cgl9CgoJaWYgKHBhc3N3ZCA9PSBOVUxMIHx8IHBhc3N3ZFswXSA9PSAnXDAnKSB7
CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWlmIChzdHJsZW4oaGFzaCkgPCAyICkgewoJCXJldHVy
biBMQUtfRkFJTDsKCX0KCgljcmVkID0gY3J5cHQocGFzc3dkLCBoYXNoKTsKCWlmKCBjcmVkID09
IE5VTEwgfHwgY3JlZFswXSA9PSAnXDAnICkgewoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyZXR1
cm4gc3RyY21wKGhhc2gsIGNyZWQpID8gTEFLX0ZBSUwgOiBMQUtfT0s7Cn0KCiNlbmRpZiAvKiBB
VVRIX0xEQVAgKi8K
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>113</attachid>
            <date>2003-02-07 18:31 EDT</date>
            <desc>lak.c</desc>
            <filename>lak.c</filename>
            <type>text/plain</type>
            <size>33613</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogQ09QWVJJR0hUCiAqIENvcHlyaWdodCAoYykgMjAwMi0yMDAyIElnb3IgQnJlemFjCiAqIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNl
IGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAogKiBtb2RpZmljYXRpb24sIGFyZSBw
ZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKICogYXJlIG1l
dDoKICogMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBh
Ym92ZSBjb3B5cmlnaHQKICogICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQg
dGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgogKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5
IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAogKiAgICBub3RpY2UsIHRo
aXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhl
CiAqICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRo
IHRoZSBkaXN0cmlidXRpb24uCiAqCiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgSUdP
UiBCUkVaQUMuIGBgQVMgSVMnJyBBTkQgQU5ZCiAqIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5U
SUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFCiAqIElNUExJRUQgV0FSUkFO
VElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUgogKiBQ
VVJQT1NFIEFSRSBESVNDTEFJTUVELiAgSU4gTk8gRVZFTlQgU0hBTEwgSUdPUiBCUkVaQUMgT1IK
ICogSVRTIEVNUExPWUVFUyBPUiBBR0VOVFMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJ
UkVDVCwKICogSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFM
IERBTUFHRVMgKElOQ0xVRElORywKICogQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBP
RiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTCiAqIE9GIFVTRSwgREFUQSwgT1Ig
UFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQKICog
T04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBM
SUFCSUxJVFksIE9SCiAqIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkg
QVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUKICogVVNFIE9GIFRISVMgU09GVFdBUkUsIEVW
RU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSAogKiBEQU1BR0UuCiAqIEVO
RCBDT1BZUklHSFQgKi8KCiNpbmNsdWRlICJtZWNoYW5pc21zLmgiCgojaWZkZWYgQVVUSF9MREFQ
CgojaW5jbHVkZSA8c3lzL3RpbWUuaD4KI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRs
aWIuaD4KI2luY2x1ZGUgPHN0cmluZ3MuaD4KI2luY2x1ZGUgPHN5c2xvZy5oPgojaW5jbHVkZSA8
Y3R5cGUuaD4KCiNpZmRlZiBIQVZFX0NSWVBUX0gKI2luY2x1ZGUgPGNyeXB0Lmg+CiNlbmRpZgoK
I2lmZGVmIEhBVkVfVU5JU1REX0gKI2luY2x1ZGUgPHVuaXN0ZC5oPgojZW5kaWYKCiNpZmRlZiBI
QVZFX09QRU5TU0wKI2luY2x1ZGUgPG9wZW5zc2wvZXZwLmg+CiNlbmRpZgoKI2luY2x1ZGUgPGxk
YXAuaD4KI2luY2x1ZGUgPGxiZXIuaD4KI2luY2x1ZGUgImxhay5oIgoKc3RydWN0IHBhc3N3b3Jk
X3NjaGVtZSB7CgljaGFyICpoYXNoOwoJaW50ICgqY2hlY2spIChjb25zdCBjaGFyICpjcmVkLCBj
b25zdCBjaGFyICpwYXNzd2QsIHZvaWQgKnJvY2spOwoJdm9pZCAqcm9jazsKfTsKCnN0YXRpYyBp
bnQgbGFrX2NvbmZpZ19yZWFkKExBS19DT05GICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQg
bGFrX2NvbmZpZ19pbnQoY29uc3QgY2hhciAqKTsKc3RhdGljIGludCBsYWtfY29uZmlnX3N3aXRj
aChjb25zdCBjaGFyICopOwpzdGF0aWMgdm9pZCBsYWtfY29uZmlnX2ZyZWUoTEFLX0NPTkYgKik7
CnN0YXRpYyBpbnQgbGFrX2NvbmZpZyhjb25zdCBjaGFyICosIExBS19DT05GICoqKTsKc3RhdGlj
IGludCBsYWtfZXNjYXBlKGNvbnN0IGNoYXIgKiwgY29uc3QgdW5zaWduZWQgaW50LCBjaGFyICoq
KTsKc3RhdGljIGludCBsYWtfZG9tdG9rKGNvbnN0IGNoYXIgKiwgaW50LCBjaGFyICoqKTsKc3Rh
dGljIGludCBsYWtfZmlsdGVyKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFy
ICosIGNvbnN0IGNoYXIgKiwgY2hhciAqKik7CnN0YXRpYyBpbnQgbGFrX2Nvbm5lY3QoTEFLICop
OwpzdGF0aWMgaW50IGxha19iaW5kKExBSyAqLCBjaGFyLCBjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKik7CnN0YXRpYyBpbnQgbGFrX3NlYXJjaChMQUsgKiwgY29uc3QgY2hhciAqLCBjb25zdCBj
aGFyICosIGNvbnN0IGNoYXIgKiosIExEQVBNZXNzYWdlICoqKTsKc3RhdGljIGludCBsYWtfYXV0
aF9jdXN0b20oTEFLICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICos
IGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQgbGFrX2F1dGhfYmluZChMQUsgKiwgY29uc3QgY2hh
ciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKc3RhdGljIGlu
dCBsYWtfYXV0aF9mYXN0YmluZChMQUsgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNv
bnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKc3RhdGljIGludCBsYWtfZ3JvdXBfbWVtYmVyKExB
SyAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFy
ICopOwpzdGF0aWMgaW50IGxha19yZXN1bHRfYWRkKExBSyAqbGFrLCBjb25zdCBjaGFyICosIGNv
bnN0IGNoYXIgKiwgTEFLX1JFU1VMVCAqKik7CnN0YXRpYyBpbnQgbGFrX2NoZWNrX3Bhc3N3b3Jk
KGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCB2b2lkICopOwpzdGF0aWMgaW50IGxha19jaGVj
a19jcnlwdChjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgdm9pZCAqKTsKI2lmZGVmIEhBVkVf
T1BFTlNTTApzdGF0aWMgaW50IGxha19iYXNlNjRfZGVjb2RlKGNvbnN0IGNoYXIgKiwgY2hhciAq
KiwgaW50ICopOwpzdGF0aWMgaW50IGxha19jaGVja19oYXNoZWQoY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICosIHZvaWQgKik7CiNlbmRpZgoKc3RhdGljIHN0cnVjdCBoYXNoX3JvY2sgewoJY29u
c3QgY2hhciAqbWRhOwoJaW50IHNhbHRlZDsKfSBoYXNoX3JvY2tbXSA9IHsKCXsgIm1kNSIsIDAg
fSwKCXsgIm1kNSIsIDEgfSwKCXsgInNoYTEiLCAwIH0sCgl7ICJzaGExIiwgMSB9Cn07CgpzdGF0
aWMgY29uc3Qgc3RydWN0IHBhc3N3b3JkX3NjaGVtZSBwYXNzd29yZF9zY2hlbWVbXSA9IHsKCXsg
IntDUllQVH0iLCBsYWtfY2hlY2tfY3J5cHQsIE5VTEwgfSwKCXsgIntVTklYfSIsIGxha19jaGVj
a19jcnlwdCwgTlVMTCB9LAojaWZkZWYgSEFWRV9PUEVOU1NMCgl7ICJ7TUQ1fSIsIGxha19jaGVj
a19oYXNoZWQsICZoYXNoX3JvY2tbMF0gfSwKCXsgIntTTUQ1fSIsIGxha19jaGVja19oYXNoZWQs
ICZoYXNoX3JvY2tbMV0gfSwKCXsgIntTSEF9IiwgbGFrX2NoZWNrX2hhc2hlZCwgJmhhc2hfcm9j
a1syXSB9LAoJeyAie1NTSEF9IiwgbGFrX2NoZWNrX2hhc2hlZCwgJmhhc2hfcm9ja1szXSB9LAoj
ZW5kaWYKCXsgTlVMTCwgTlVMTCB9Cn07CgpzdGF0aWMgaW50IGxha19jb25maWdfcmVhZChMQUtf
Q09ORiAqY29uZiwgY29uc3QgY2hhciAqY29uZmlnZmlsZSkKewoJRklMRSAqaW5maWxlOwoJaW50
IGxpbmVubyA9IDA7CgljaGFyIGJ1Zls0MDk2XTsKCWNoYXIgKnAsICprZXk7CgoJaW5maWxlID0g
Zm9wZW4oY29uZmlnZmlsZSwgInIiKTsKCWlmICghaW5maWxlKSB7CgkgICAgc3lzbG9nKExPR19F
UlJ8TE9HX0FVVEgsCgkJICAgIkNvdWxkIG5vdCBvcGVuIHNhc2xhdXRoZCBjb25maWcgZmlsZTog
JXMgKCVtKSIsCgkJICAgY29uZmlnZmlsZSk7CgkgICAgcmV0dXJuIExBS19GQUlMOwoJfQogICAg
Cgl3aGlsZSAoZmdldHMoYnVmLCBzaXplb2YoYnVmKSwgaW5maWxlKSkgewoJCWxpbmVubysrOwoK
CQlpZiAoYnVmW3N0cmxlbihidWYpLTFdID09ICdcbicpIAoJCQlidWZbc3RybGVuKGJ1ZiktMV0g
PSAnXDAnOwoJCWZvciAocCA9IGJ1ZjsgKnAgJiYgaXNzcGFjZSgoaW50KSAqcCk7IHArKyk7CgkJ
CWlmICghKnAgfHwgKnAgPT0gJyMnKSAKCQkJCWNvbnRpbnVlOwoKCQlrZXkgPSBwOwoJCXdoaWxl
ICgqcCAmJiAoaXNhbG51bSgoaW50KSAqcCkgfHwgKnAgPT0gJy0nIHx8ICpwID09ICdfJykpIHsK
CQkJaWYgKGlzdXBwZXIoKGludCkgKnApKSAKCQkJCSpwID0gdG9sb3dlcigqcCk7CgkJCXArKzsK
CQl9CgkJaWYgKCpwICE9ICc6JykgewoJCQlyZXR1cm4gTEFLX0ZBSUw7CgkJfQoJCSpwKysgPSAn
XDAnOwoKCQl3aGlsZSAoKnAgJiYgaXNzcGFjZSgoaW50KSAqcCkpIAoJCQlwKys7CgoJCWlmICgh
KnApIHsKCQkJcmV0dXJuIExBS19GQUlMOwoJCX0KCgkJaWYgKCFzdHJjYXNlY21wKGtleSwgImxk
YXBfc2VydmVycyIpKSB7CgkJCWlmIChjb25mLT5zZXJ2ZXJzKSBmcmVlKGNvbmYtPnNlcnZlcnMp
OwoJCQljb25mLT5zZXJ2ZXJzID0gc3RyZHVwKHApOwoJCQlpZiAoY29uZi0+c2VydmVycyA9PSBO
VUxMKSB7CgkJCQlmY2xvc2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9
IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBfYmluZF9kbiIpKSB7CgkJCWlmIChjb25m
LT5iaW5kX2RuKSBmcmVlKGNvbmYtPmJpbmRfZG4pOwoJCQljb25mLT5iaW5kX2RuID0gc3RyZHVw
KHApOwoJCQlpZiAoY29uZi0+YmluZF9kbiA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5maWxlKTsK
CQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwg
ImxkYXBfYmluZF9wdyIpKSB7CgkJCWlmIChjb25mLT5iaW5kX3B3KSBmcmVlKGNvbmYtPmJpbmRf
cHcpOwoJCQljb25mLT5iaW5kX3B3ID0gc3RyZHVwKHApOwoJCQlpZiAoY29uZi0+YmluZF9wdyA9
PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0K
CQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBfdmVyc2lvbiIpKSB7CgkJCWNvbmYt
PnZlcnNpb24gPSBsYWtfY29uZmlnX2ludChwKTsKCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtl
eSwgImxkYXBfc2VhcmNoX2Jhc2UiKSkgewoJCQlpZiAoY29uZi0+c2VhcmNoX2Jhc2UpIGZyZWUo
Y29uZi0+c2VhcmNoX2Jhc2UpOwoJCQljb25mLT5zZWFyY2hfYmFzZSA9IHN0cmR1cChwKTsKCQkJ
aWYgKGNvbmYtPnNlYXJjaF9iYXNlID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZpbGUpOwoJCQkJ
cmV0dXJuIExBS19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRh
cF9maWx0ZXIiKSkgewoJCQlpZiAoY29uZi0+ZmlsdGVyKSBmcmVlKGNvbmYtPmZpbHRlcik7CgkJ
CWNvbmYtPmZpbHRlciA9IHN0cmR1cChwKTsKCQkJaWYgKGNvbmYtPmZpbHRlciA9PSBOVUxMKSB7
CgkJCQlmY2xvc2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2Ug
aWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBfZ3JvdXBfZG4iKSkgewoJCQlpZiAoY29uZi0+Z3Jv
dXBfZG4pIGZyZWUoY29uZi0+Z3JvdXBfZG4pOwoJCQljb25mLT5ncm91cF9kbiA9IHN0cmR1cChw
KTsKCQkJaWYgKGNvbmYtPmdyb3VwX2RuID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZpbGUpOwoJ
CQkJcmV0dXJuIExBS19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAi
bGRhcF9ncm91cF9hdHRyIikpIHsKCQkJaWYgKGNvbmYtPmdyb3VwX2F0dHIpIGZyZWUoY29uZi0+
Z3JvdXBfYXR0cik7CgkJCWNvbmYtPmdyb3VwX2F0dHIgPSBzdHJkdXAocCk7CgkJCWlmIChjb25m
LT5ncm91cF9hdHRyID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZpbGUpOwoJCQkJcmV0dXJuIExB
S19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9wYXNzd29y
ZF9hdHRyIikpIHsKCQkJaWYgKGNvbmYtPnBhc3N3b3JkX2F0dHIpIGZyZWUoY29uZi0+cGFzc3dv
cmRfYXR0cik7CgkJCWNvbmYtPnBhc3N3b3JkX2F0dHIgPSBzdHJkdXAocCk7CgkJCWlmIChjb25m
LT5wYXNzd29yZF9hdHRyID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZpbGUpOwoJCQkJcmV0dXJu
IExBS19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9hdXRo
X21ldGhvZCIpKSB7CgkJCWlmICghc3RyY2FzZWNtcChwLCAiY3VzdG9tIikpIHsKCQkJCWNvbmYt
PmF1dGhfbWV0aG9kID0gTEFLX0FVVEhfTUVUSE9EX0NVU1RPTTsKCQkJfSBlbHNlIGlmICghc3Ry
Y2FzZWNtcChwLCAiZmFzdGJpbmQiKSkgewoJCQkJY29uZi0+YXV0aF9tZXRob2QgPSBMQUtfQVVU
SF9NRVRIT0RfRkFTVEJJTkQ7CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxk
YXBfdGltZW91dCIpKSB7CgkJCWNvbmYtPnRpbWVvdXQudHZfc2VjID0gbGFrX2NvbmZpZ19pbnQo
cCk7CgkJCWNvbmYtPnRpbWVvdXQudHZfdXNlYyA9IDA7CgkJfSBlbHNlIGlmICghc3RyY2FzZWNt
cChrZXksICJsZGFwX3NpemVfbGltaXQiKSkgewoJCQljb25mLT5zaXplX2xpbWl0ID0gbGFrX2Nv
bmZpZ19pbnQocCk7CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3RpbWVfbGlt
aXQiKSkgewoJCQljb25mLT50aW1lX2xpbWl0ID0gbGFrX2NvbmZpZ19pbnQocCk7CgkJfSBlbHNl
IGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX2RlcmVmIikpIHsKCQkJaWYgKCFzdHJjYXNlY21w
KHAsICJzZWFyY2giKSkgewoJCQkJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVGX1NFQVJDSElORzsK
CQkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChwLCAiZmluZCIpKSB7CgkJCQljb25mLT5kZXJlZiA9
IExEQVBfREVSRUZfRklORElORzsKCQkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChwLCAiYWx3YXlz
IikpIHsKCQkJCWNvbmYtPmRlcmVmID0gTERBUF9ERVJFRl9BTFdBWVM7CgkJCX0gZWxzZSBpZiAo
IXN0cmNhc2VjbXAocCwgIm5ldmVyIikpIHsKCQkJCWNvbmYtPmRlcmVmID0gTERBUF9ERVJFRl9O
RVZFUjsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9yZWZlcnJhbHMi
KSkgewoJCQljb25mLT5yZWZlcnJhbHMgPSBsYWtfY29uZmlnX3N3aXRjaChwKTsKCQl9IGVsc2Ug
aWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBfcmVzdGFydCIpKSB7CgkJCWNvbmYtPnJlc3RhcnQg
PSBsYWtfY29uZmlnX3N3aXRjaChwKTsKCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxk
YXBfY2FjaGVfdHRsIikpIHsKCQkJY29uZi0+Y2FjaGVfdHRsID0gbGFrX2NvbmZpZ19pbnQocCk7
CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX2NhY2hlX21lbSIpKSB7CgkJCWNv
bmYtPmNhY2hlX21lbSA9IGxha19jb25maWdfaW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2Vj
bXAoa2V5LCAibGRhcF9zY29wZSIpKSB7CgkJCWlmICghc3RyY2FzZWNtcChwLCAib25lIikpIHsK
CQkJCWNvbmYtPnNjb3BlID0gTERBUF9TQ09QRV9PTkVMRVZFTDsKCQkJfSBlbHNlIGlmICghc3Ry
Y2FzZWNtcChwLCAiYmFzZSIpKSB7CgkJCQljb25mLT5zY29wZSA9IExEQVBfU0NPUEVfQkFTRTsK
CQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF90bHNfY2hlY2tfcGVlciIp
KSB7CgkJCWNvbmYtPnRsc19jaGVja19wZWVyID0gbGFrX2NvbmZpZ19zd2l0Y2gocCk7CgkJfSBl
bHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Rsc19jYWNlcnRfZmlsZSIpKSB7CgkJCWlm
IChjb25mLT50bHNfY2FjZXJ0X2ZpbGUpIGZyZWUoY29uZi0+dGxzX2NhY2VydF9maWxlKTsKCQkJ
Y29uZi0+dGxzX2NhY2VydF9maWxlID0gc3RyZHVwKHApOwoJCQlpZiAoY29uZi0+dGxzX2NhY2Vy
dF9maWxlID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZpbGUpOwoJCQkJcmV0dXJuIExBS19OT01F
TTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF90bHNfY2FjZXJ0X2Rp
ciIpKSB7CgkJCWlmIChjb25mLT50bHNfY2FjZXJ0X2RpcikgZnJlZShjb25mLT50bHNfY2FjZXJ0
X2Rpcik7CgkJCWNvbmYtPnRsc19jYWNlcnRfZGlyID0gc3RyZHVwKHApOwoJCQlpZiAoY29uZi0+
dGxzX2NhY2VydF9kaXIgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4g
TEFLX05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Rsc19j
aXBoZXJzIikpIHsKCQkJaWYgKGNvbmYtPnRsc19jaXBoZXJzKSBmcmVlKGNvbmYtPnRsc19jaXBo
ZXJzKTsKCQkJY29uZi0+dGxzX2NpcGhlcnMgPSBzdHJkdXAocCk7CgkJCWlmIChjb25mLT50bHNf
Y2lwaGVycyA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9N
RU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBfdGxzX2NlcnQiKSkg
ewoJCQlpZiAoY29uZi0+dGxzX2NlcnQpIGZyZWUoY29uZi0+dGxzX2NlcnQpOwoJCQljb25mLT50
bHNfY2VydCA9IHN0cmR1cChwKTsKCQkJaWYgKGNvbmYtPnRsc19jZXJ0ID09IE5VTEwpIHsKCQkJ
CWZjbG9zZShpbmZpbGUpOwoJCQkJcmV0dXJuIExBS19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAo
IXN0cmNhc2VjbXAoa2V5LCAibGRhcF90bHNfa2V5IikpIHsKCQkJaWYgKGNvbmYtPnRsc19rZXkp
IGZyZWUoY29uZi0+dGxzX2tleSk7CgkJCWNvbmYtPnRsc19rZXkgPSBzdHJkdXAocCk7CgkJCWlm
IChjb25mLT50bHNfa2V5ID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZpbGUpOwoJCQkJcmV0dXJu
IExBS19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9kZWJ1
ZyIpKSB7CgkJCWNvbmYtPmRlYnVnID0gbGFrX2NvbmZpZ19pbnQocCk7CgkJfQoJfQoKCWZjbG9z
ZShpbmZpbGUpOwoKCXJldHVybiBMQUtfT0s7Cn0KCnN0YXRpYyBpbnQgbGFrX2NvbmZpZ19pbnQo
Y29uc3QgY2hhciAqdmFsKQp7CiAgICBpZiAoIXZhbCkgcmV0dXJuIDA7CgogICAgaWYgKCFpc2Rp
Z2l0KChpbnQpICp2YWwpICYmICgqdmFsICE9ICctJyB8fCAhaXNkaWdpdCgoaW50KSB2YWxbMV0p
KSkgcmV0dXJuIDA7CgogICAgcmV0dXJuIGF0b2kodmFsKTsKfQoKc3RhdGljIGludCBsYWtfY29u
ZmlnX3N3aXRjaChjb25zdCBjaGFyICp2YWwpCnsKICAgIGlmICghdmFsKSByZXR1cm4gMDsKICAg
IAogICAgaWYgKCp2YWwgPT0gJzAnIHx8ICp2YWwgPT0gJ24nIHx8CgkoKnZhbCA9PSAnbycgJiYg
dmFsWzFdID09ICdmJykgfHwgKnZhbCA9PSAnZicpIHsKCXJldHVybiAwOwogICAgfSBlbHNlIGlm
ICgqdmFsID09ICcxJyB8fCAqdmFsID09ICd5JyB8fAoJICAgICAoKnZhbCA9PSAnbycgJiYgdmFs
WzFdID09ICduJykgfHwgKnZhbCA9PSAndCcpIHsKCXJldHVybiAxOwogICAgfQogICAgcmV0dXJu
IDA7Cn0KCnN0YXRpYyB2b2lkIGxha19jb25maWdfZnJlZShMQUtfQ09ORiAqY29uZikgCnsKCWlm
IChjb25mID09IE5VTEwpIHsKCQlyZXR1cm47Cgl9CgoJaWYgKGNvbmYtPnNlcnZlcnMgIT0gTlVM
TCkgewoJCW1lbXNldChjb25mLT5zZXJ2ZXJzLCAwLCBzdHJsZW4oY29uZi0+c2VydmVycykpOwoJ
CWZyZWUoY29uZi0+c2VydmVycyk7Cgl9CglpZiAoY29uZi0+YmluZF9kbiAhPSBOVUxMKSB7CgkJ
bWVtc2V0KGNvbmYtPmJpbmRfZG4sIDAsIHN0cmxlbihjb25mLT5iaW5kX2RuKSk7CgkJZnJlZShj
b25mLT5iaW5kX2RuKTsKCX0KCWlmIChjb25mLT5iaW5kX3B3ICE9IE5VTEwpIHsKCQltZW1zZXQo
Y29uZi0+YmluZF9wdywgMCwgc3RybGVuKGNvbmYtPmJpbmRfcHcpKTsKCQlmcmVlKGNvbmYtPmJp
bmRfcHcpOwoJfQoJaWYgKGNvbmYtPnNlYXJjaF9iYXNlICE9IE5VTEwpCgkJZnJlZShjb25mLT5z
ZWFyY2hfYmFzZSk7CglpZiAoY29uZi0+ZmlsdGVyICE9IE5VTEwpCgkJZnJlZShjb25mLT5maWx0
ZXIpOwoJaWYgKGNvbmYtPmdyb3VwX2RuICE9IE5VTEwpCgkJZnJlZShjb25mLT5ncm91cF9kbik7
CglpZiAoY29uZi0+Z3JvdXBfYXR0ciAhPSBOVUxMKQoJCWZyZWUoY29uZi0+Z3JvdXBfYXR0cik7
CglpZiAoY29uZi0+cGFzc3dvcmRfYXR0ciAhPSBOVUxMKQoJCWZyZWUoY29uZi0+cGFzc3dvcmRf
YXR0cik7CglpZiAoY29uZi0+dGxzX2NhY2VydF9maWxlICE9IE5VTEwpCgkJZnJlZShjb25mLT50
bHNfY2FjZXJ0X2ZpbGUpOwoJaWYgKGNvbmYtPnRsc19jYWNlcnRfZGlyICE9IE5VTEwpCgkJZnJl
ZShjb25mLT50bHNfY2FjZXJ0X2Rpcik7CglpZiAoY29uZi0+dGxzX2NpcGhlcnMgIT0gTlVMTCkK
CQlmcmVlKGNvbmYtPnRsc19jaXBoZXJzKTsKCWlmIChjb25mLT50bHNfY2VydCAhPSBOVUxMKQoJ
CWZyZWUoY29uZi0+dGxzX2NlcnQpOwoJaWYgKGNvbmYtPnRsc19rZXkgIT0gTlVMTCkKCQlmcmVl
KGNvbmYtPnRsc19rZXkpOwoJaWYgKGNvbmYtPnBhdGggIT0gTlVMTCkKCQlmcmVlKGNvbmYtPnBh
dGgpOwoKCWZyZWUgKGNvbmYpOwoKCXJldHVybjsKfQoKc3RhdGljIGludCBsYWtfY29uZmlnKGNv
bnN0IGNoYXIgKmNvbmZpZ2ZpbGUsIExBS19DT05GICoqcmV0KQp7CglMQUtfQ09ORiAqY29uZjsK
CWludCByYyA9IDA7CgoJY29uZiA9IG1hbGxvYyggc2l6ZW9mKExBS19DT05GKSApOwoJaWYgKGNv
bmYgPT0gTlVMTCkgewoJCXJldHVybiBMQUtfTk9NRU07Cgl9CgoJbWVtc2V0KGNvbmYsIDAsIHNp
emVvZihMQUtfQ09ORikpOwoKCWNvbmYtPnNlcnZlcnMgPSBzdHJkdXAoImxkYXA6Ly9sb2NhbGhv
c3QvIik7Cgljb25mLT5iaW5kX2RuID0gc3RyZHVwKCIiKTsKCWNvbmYtPmJpbmRfcHcgPSBzdHJk
dXAoIiIpOwoJY29uZi0+dmVyc2lvbiA9IExEQVBfVkVSU0lPTjM7Cgljb25mLT5zZWFyY2hfYmFz
ZSA9IHN0cmR1cCgiIik7Cgljb25mLT5maWx0ZXIgPSBzdHJkdXAoIih1aWQ9JXUpIik7Cgljb25m
LT5ncm91cF9kbiA9IE5VTEw7Cgljb25mLT5ncm91cF9hdHRyID0gc3RyZHVwKCJ1bmlxdWVNZW1i
ZXIiKTsKCWNvbmYtPnBhc3N3b3JkX2F0dHIgPSBzdHJkdXAoInVzZXJQYXNzd29yZCIpOwoJY29u
Zi0+YXV0aF9tZXRob2QgPSBMQUtfQVVUSF9NRVRIT0RfQklORDsKCWNvbmYtPnRpbWVvdXQudHZf
c2VjID0gNTsKCWNvbmYtPnRpbWVvdXQudHZfdXNlYyA9IDA7Cgljb25mLT5zaXplX2xpbWl0ID0g
MTsKCWNvbmYtPnRpbWVfbGltaXQgPSA1OwoJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVGX05FVkVS
OwoJY29uZi0+cmVzdGFydCA9IDE7Cgljb25mLT5zY29wZSA9IExEQVBfU0NPUEVfU1VCVFJFRTsK
Cgljb25mLT5wYXRoID0gc3RyZHVwKGNvbmZpZ2ZpbGUpOwoJaWYgKGNvbmYtPnBhdGggPT0gTlVM
TCkgewoJCWxha19jb25maWdfZnJlZShjb25mKTsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoKCXJj
ID0gbGFrX2NvbmZpZ19yZWFkKGNvbmYsIGNvbmYtPnBhdGgpOwoJaWYgKHJjICE9IExBS19PSykg
ewoJCWxha19jb25maWdfZnJlZShjb25mKTsKCQlyZXR1cm4gcmM7Cgl9CgoJKnJldCA9IGNvbmY7
CglyZXR1cm4gTEFLX09LOwp9CgovKgogKiBOb3RlOiBjYWxsaW5nIGZ1bmN0aW9uIG11c3QgZnJl
ZSBtZW1vcnkuCiAqLwpzdGF0aWMgaW50IGxha19lc2NhcGUoY29uc3QgY2hhciAqcywgY29uc3Qg
dW5zaWduZWQgaW50IG4sIGNoYXIgKipyZXN1bHQpIAp7CgljaGFyICpidWY7CgljaGFyICplbmQs
ICpwdHIsICp0ZW1wOwoKCWJ1ZiA9IG1hbGxvYyhuICogNSArIDEpOwoJaWYgKGJ1ZiA9PSBOVUxM
KSB7CgkJcmV0dXJuIExBS19OT01FTTsKCX0KCglidWZbMF0gPSAnXDAnOwoJcHRyID0gKGNoYXIg
KilzOwoJZW5kID0gcHRyICsgbjsKCgl3aGlsZSAoKCh0ZW1wID0gc3RycGJyayhwdHIsICIqKClc
XFwwIikpIT1OVUxMKSAmJiAodGVtcDxlbmQpKSB7CgoJCWlmICh0ZW1wPnB0cikKCQkJc3RybmNh
dChidWYsIHB0ciwgdGVtcC1wdHIpOwoKCQlzd2l0Y2ggKCp0ZW1wKSB7CgkJCWNhc2UgJyonOgoJ
CQkJc3RyY2F0KGJ1ZiwgIlxcMmEiKTsKCQkJCWJyZWFrOwoJCQljYXNlICcoJzoKCQkJCXN0cmNh
dChidWYsICJcXDI4Iik7CgkJCQlicmVhazsKCQkJY2FzZSAnKSc6CgkJCQlzdHJjYXQoYnVmLCAi
XFwyOSIpOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ1xcJzoKCQkJCXN0cmNhdChidWYsICJcXDVjIik7
CgkJCQlicmVhazsKCQkJY2FzZSAnXDAnOgoJCQkJc3RyY2F0KGJ1ZiwgIlxcMDAiKTsKCQkJCWJy
ZWFrOwoJCX0KCQlwdHI9dGVtcCsxOwoJfQoJaWYgKHRlbXA8ZW5kKQoJCXN0cm5jYXQoYnVmLCBw
dHIsICh0ZW1wID8gZW5kLXRlbXAgOiBuKSk7CgoJKnJlc3VsdCA9IGJ1ZjsKCglyZXR1cm4gTEFL
X09LOwp9CgpzdGF0aWMgaW50IGxha19kb210b2soY29uc3QgY2hhciAqZCwgaW50IG4sIGNoYXIg
KipyZXN1bHQpCnsKCWNoYXIgKnMsICpzMTsKCWludCBudCwgaTsKCgkqcmVzdWx0ID0gTlVMTDsK
CglpZiAoZCA9PSBOVUxMIHx8IChuIDwgMSAmJiBuID4gOSkpCgkJcmV0dXJuIExBS19GQUlMOwoK
CXMgPSBzdHJkdXAoZCk7CglpZiAocyA9PSBOVUxMKQoJCXJldHVybiBMQUtfTk9NRU07CgoJZm9y
KCBudD0wLCBzMT1zOyAqczE7IHMxKysgKQoJCWlmKCAqczEgPT0gJy4nICkgbnQrKzsKCW50Kys7
CgoJaWYgKG4gPiBudCkgewoJCWZyZWUocyk7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWkgPSBu
dCAtIG47CglzMSA9IHN0cnRvayhzLCAiLiIpOwoJd2hpbGUoczEpIHsKCQlpZiAoaSA9PSAwKSB7
CgkJCSpyZXN1bHQgPSBzdHJkdXAoczEpOwoJCQlmcmVlKHMpOwoJCQlyZXR1cm4gKCpyZXN1bHQg
PT0gTlVMTCA/IExBS19OT01FTSA6IExBS19PSyk7CgkJfQoJCXMxID0gc3RydG9rKE5VTEwsICIu
Iik7CgkJaS0tOwoJfQoKCWZyZWUocyk7CglyZXR1cm4gTEFLX0ZBSUw7Cn0KCiNkZWZpbmUgTUFY
KGEsYixjKSAoYT5iPyhhPmM/YTpjKTooYj5jP2I6YykpCgovKgogKiBsYWtfZmlsdGVyCiAqIFBh
cnRzIHdpdGggdGhlIHN0cmluZ3MgcHJvdmlkZWQuCiAqICAgJSUgICA9ICUKICogICAldSAgID0g
dXNlcgogKiAgICVVICAgPSB1c2VyIHBhcnQgb2YgJXUKICogICAlZCAgID0gZG9tYWluIHBhcnQg
b2YgJXUgaWYgYXZhaWxhYmxlCiAqICAgJTEtOSA9IGRvbWFpbiB0b2tlbnMgKCUxID0gdGxkLCAl
MiA9IGRvbWFpbiB3aGVuICVkID0gZG9tYWluLnRsZCkKICogICAlcyAgID0gc2VydmljZQogKiAg
ICVyICAgPSByZWFsbQogKiBOb3RlOiBjYWxsaW5nIGZ1bmN0aW9uIG11c3QgZnJlZSBtZW1vcnku
CiAqLwpzdGF0aWMgaW50IGxha19maWx0ZXIoY29uc3QgY2hhciAqcGF0dGVybiwgY29uc3QgY2hh
ciAqdXNlcm5hbWUsIGNvbnN0IGNoYXIgKnNlcnZpY2UsIGNvbnN0IGNoYXIgKnJlYWxtLCBjaGFy
ICoqcmVzdWx0KSAKewoJY2hhciAqYnVmOyAKCWNoYXIgKmVuZCwgKnB0ciwgKnRlbXA7CgljaGFy
ICplYnVmLCAqdXNlcjsKCWNoYXIgKmRvbWFpbjsKCWludCByYzsKCgkvKiB0byBwZXJtaXQgbXVs
dGlwbGUgb2NjdXJlbmNlcyBvZiB1c2VybmFtZSBhbmQvb3IgcmVhbG0gaW4gZmlsdGVyICovCgkv
KiBhbmQgYXZvaWQgbWVtb3J5IG92ZXJmbG93IGluIGZpbHRlciBidWlsZCBbZWc6ICh8KHVpZD0l
dSkodXNlcmlkPSV1KSkgXSAqLwoJaW50IHBlcmNlbnRzLCBzZXJ2aWNlX2xlbiwgcmVhbG1fbGVu
LCB1c2VyX2xlbiwgbWF4cGFyYW1sZW5ndGg7CgkKCWlmIChwYXR0ZXJuID09IE5VTEwpIHsKCQlz
eXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJmaWx0ZXIgcGF0dGVybiBub3Qgc2V0dXAiKTsK
CQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJLyogZmluZCB0aGUgbG9uZ2VzdCBwYXJhbSBvZiB1c2Vy
bmFtZSBhbmQgcmVhbG0sIAoJICAgZG8gbm90IHdvcnJ5IGFib3V0IGRvbWFpbiBiZWNhdXNlIGl0
IGlzIGFsd2F5cyBzaG9ydGVyIAoJICAgdGhlbiB1c2VybmFtZSAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAqLwoJdXNlcl9sZW49c3RybGVuKHVzZXJuYW1lKTsKCXNl
cnZpY2VfbGVuPXN0cmxlbihzZXJ2aWNlKTsKCXJlYWxtX2xlbj1zdHJsZW4ocmVhbG0pOwoKCW1h
eHBhcmFtbGVuZ3RoID0gTUFYKHVzZXJfbGVuLCBzZXJ2aWNlX2xlbiwgcmVhbG1fbGVuKTsKCgkv
KiBmaW5kIHRoZSBudW1iZXIgb2Ygb2NjdXJlbmNlcyBvZiBwZXJjZW50IHNpZ24gaW4gZmlsdGVy
ICovCglmb3IoIHBlcmNlbnRzPTAsIGJ1Zj0oY2hhciAqKXBhdHRlcm47ICpidWY7IGJ1ZisrICkg
ewoJCWlmKCAqYnVmID09ICclJyApIHBlcmNlbnRzKys7Cgl9CgoJLyogcGVyY2VudHMgKiAzICog
bWF4cGFyYW1sZW5ndGggYmVjYXVzZSB3ZSBuZWVkIHRvIGFjY291bnQgZm9yCiAgICAgICAgICog
YW4gZW50aXJlbHktZXNjYXBlZCB3b3JzdC1jYXNlLWxlbmd0aCBwYXJhbWV0ZXIgKi8KCWJ1Zj1t
YWxsb2Moc3RybGVuKHBhdHRlcm4pICsgKHBlcmNlbnRzICogMyAqIG1heHBhcmFtbGVuZ3RoKSAr
MSk7CglpZihidWYgPT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAiQ2Fubm90
IGFsbG9jYXRlIG1lbW9yeSIpOwoJCXJldHVybiBMQUtfTk9NRU07Cgl9CglidWZbMF0gPSAnXDAn
OwoJCglwdHIgPSAoY2hhciAqKXBhdHRlcm47CgllbmQgPSBwdHIgKyBzdHJsZW4ocHRyKTsKCgl3
aGlsZSAoKHRlbXA9c3RyY2hyKHB0ciwnJScpKSE9TlVMTCApIHsKCgkJaWYgKCh0ZW1wLXB0cikg
PiAwKQoJCQlzdHJuY2F0KGJ1ZiwgcHRyLCB0ZW1wLXB0cik7CgoJCWlmICgodGVtcCsxKSA+PSBl
bmQpIHsKCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiSW5jb21wbGV0ZSBsb29rdXAg
c3Vic3RpdHV0aW9uIGZvcm1hdCIpOwoJCQlicmVhazsKCQl9CgoJCXN3aXRjaCAoKih0ZW1wKzEp
KSB7CgkJCWNhc2UgJyUnOgoJCQkJc3RybmNhdChidWYsdGVtcCsxLDEpOwoJCQkJYnJlYWs7CgkJ
CWNhc2UgJ3UnOgoJCQkJaWYgKHVzZXJuYW1lIT1OVUxMKSB7CgkJCQkJcmM9bGFrX2VzY2FwZSh1
c2VybmFtZSwgc3RybGVuKHVzZXJuYW1lKSwgJmVidWYpOwoJCQkJCWlmIChyYyA9PSBMQUtfT0sp
IHsKCQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShlYnVmKTsKCQkJCQl9CgkJCQl9
IGVsc2UgewoJCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVzZXJuYW1lIG5vdCBh
dmFpbGFibGUuIik7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAnVSc6CgkJCQlpZiAodXNlcm5h
bWUhPU5VTEwpIHsKCQkJCQkKCQkJCQl1c2VyID0gc3RyY2hyKHVzZXJuYW1lLCAnQCcpOwoJCQkJ
CXJjPWxha19lc2NhcGUodXNlcm5hbWUsICh1c2VyID8gdXNlciAtIHVzZXJuYW1lIDogc3RybGVu
KHVzZXJuYW1lKSksICZlYnVmKTsKCQkJCQlpZiAocmMgPT0gTEFLX09LKSB7CgkJCQkJCXN0cmNh
dChidWYsZWJ1Zik7CgkJCQkJCWZyZWUoZWJ1Zik7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQlz
eXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVc2VybmFtZSBub3QgYXZhaWxhYmxlLiIpOwoJ
CQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgJ2QnOgoJCQkJaWYgKHVzZXJuYW1lIT1OVUxMICYmIChk
b21haW4gPSBzdHJjaHIodXNlcm5hbWUsICdAJykpICYmIGRvbWFpblsxXSE9J1wwJykgewoJCQkJ
CXJjPWxha19lc2NhcGUoZG9tYWluKzEsIHN0cmxlbihkb21haW4rMSksICZlYnVmKTsKCQkJCQlp
ZiAocmMgPT0gTEFLX09LKSB7CgkJCQkJCXN0cmNhdChidWYsZWJ1Zik7CgkJCQkJCWZyZWUoZWJ1
Zik7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgs
ICJEb21haW4gbm90IGF2YWlsYWJsZS4iKTsKCQkJCX0KCQkJCWJyZWFrOwoJCQljYXNlICcxJzoK
CQkJY2FzZSAnMic6CgkJCWNhc2UgJzMnOgoJCQljYXNlICc0JzoKCQkJY2FzZSAnNSc6CgkJCWNh
c2UgJzYnOgoJCQljYXNlICc3JzoKCQkJY2FzZSAnOCc6CgkJCWNhc2UgJzknOgoJCQkJaWYgKHVz
ZXJuYW1lIT1OVUxMICYmIChkb21haW4gPSBzdHJjaHIodXNlcm5hbWUsICdAJykpICYmIGRvbWFp
blsxXSE9J1wwJykgewoJCQkJCXJjPWxha19kb210b2soZG9tYWluKzEsIChpbnQpICoodGVtcCsx
KS00OCwgJmVidWYpOwoJCQkJCWlmIChyYyA9PSBMQUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1Zixl
YnVmKTsKCQkJCQkJZnJlZShlYnVmKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xvZyhM
T0dfV0FSTklOR3xMT0dfQVVUSCwgIkRvbWFpbiB0b2tlbnMgbm90IGF2YWlsYWJsZS4iKTsKCQkJ
CX0KCQkJCWJyZWFrOwoJCQljYXNlICdyJzoKCQkJCWlmIChyZWFsbSE9TlVMTCkgewoJCQkJCXJj
ID0gbGFrX2VzY2FwZShyZWFsbSwgc3RybGVuKHJlYWxtKSwgJmVidWYpOwoJCQkJCWlmIChyYyA9
PSBMQUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShlYnVmKTsKCQkJ
CQl9CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlJlYWxt
IG5vdCBhdmFpbGFibGUuIik7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAncyc6CgkJCQlpZiAo
c2VydmljZSE9TlVMTCkgewoJCQkJCXJjID0gbGFrX2VzY2FwZShzZXJ2aWNlLCBzdHJsZW4oc2Vy
dmljZSksICZlYnVmKTsKCQkJCQlpZiAocmMgPT0gTEFLX09LKSB7CgkJCQkJCXN0cmNhdChidWYs
ZWJ1Zik7CgkJCQkJCWZyZWUoZWJ1Zik7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQlzeXNsb2co
TE9HX1dBUk5JTkd8TE9HX0FVVEgsICJTZXJ2aWNlIG5vdCBhdmFpbGFibGUuIik7CgkJCQl9CgkJ
CQlicmVhazsKCQkJZGVmYXVsdDoKCQkJCWJyZWFrOwoJCX0KCQlwdHI9dGVtcCsyOwoJfQoJaWYg
KHRlbXA8ZW5kKQoJCXN0cmNhdChidWYsIHB0cik7CgoJKnJlc3VsdCA9IGJ1ZjsKCglyZXR1cm4g
TEFLX09LOwp9CgppbnQgbGFrX2luaXQoY29uc3QgY2hhciAqY29uZmlnZmlsZSwgTEFLICoqcmV0
KSAKewoJTEFLICpsYWs7CglpbnQgcmM7CgoJbGFrID0gKnJldDsKCglpZiAobGFrICE9IE5VTEwp
IHsKCQlyZXR1cm4gTEFLX09LOwoJfQoKCWxhayA9IChMQUsgKiltYWxsb2Moc2l6ZW9mKExBSykp
OwoJaWYgKGxhayA9PSBOVUxMKSB7CgkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICJDYW5ub3Qg
YWxsb2NhdGUgbWVtb3J5Iik7CgkJcmV0dXJuIExBS19OT01FTTsKCX0KCglsYWstPmJpbmRfc3Rh
dHVzPUxBS19OT1RfQk9VTkQ7CglsYWstPmxkPU5VTEw7CglsYWstPmNvbmY9TlVMTDsKCglyYyA9
IGxha19jb25maWcoY29uZmlnZmlsZSwgJmxhay0+Y29uZik7CglpZiAocmMgIT0gTEFLX09LKSB7
CgkJZnJlZShsYWspOwoJCXJldHVybiByYzsKCX0KCiNpZmRlZiBIQVZFX09QRU5TU0wKCU9wZW5T
U0xfYWRkX2FsbF9kaWdlc3RzKCk7CiNlbmRpZgoKCSpyZXQ9bGFrOwoJcmV0dXJuIExBS19PSzsK
fQoKdm9pZCBsYWtfY2xvc2UoTEFLICpsYWspIHsKCglpZiAobGFrID09IE5VTEwpCgkJcmV0dXJu
OwoKCWlmIChsYWstPmxkICE9IE5VTEwpIHsKCQlpZiAobGFrLT5jb25mLT5jYWNoZV90dGwpCgkJ
CWxkYXBfZGVzdHJveV9jYWNoZShsYWstPmxkKTsKCQlsZGFwX3VuYmluZF9zKGxhay0+bGQpOwoJ
fQoKCWxha19jb25maWdfZnJlZShsYWstPmNvbmYpOwoKCWZyZWUobGFrKTsKCiNpZmRlZiBIQVZF
X09QRU5TU0wKCUVWUF9jbGVhbnVwKCk7CiNlbmRpZgoKCXJldHVybjsKfQoKc3RhdGljIGludCBs
YWtfY29ubmVjdChMQUsgKmxhaykKewoJaW50ICAgICByYyA9IDA7CgoJaWYgKGxhay0+Y29uZi0+
dGxzX2NhY2VydF9maWxlICE9IE5VTEwpIHsKCQlyYyA9IGxkYXBfc2V0X29wdGlvbiAoTlVMTCwg
TERBUF9PUFRfWF9UTFNfQ0FDRVJURklMRSwgbGFrLT5jb25mLT50bHNfY2FjZXJ0X2ZpbGUpOwoJ
CWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJc3lzbG9nIChMT0dfV0FSTklOR3xMT0dfQVVU
SCwgIlVuYWJsZSB0byBzZXQgTERBUF9PUFRfWF9UTFNfQ0FDRVJURklMRSAoJXMpLiIsIGxkYXBf
ZXJyMnN0cmluZyAocmMpKTsKCQl9Cgl9CgoJaWYgKGxhay0+Y29uZi0+dGxzX2NhY2VydF9kaXIg
IT0gTlVMTCkgewoJCXJjID0gbGRhcF9zZXRfb3B0aW9uIChOVUxMLCBMREFQX09QVF9YX1RMU19D
QUNFUlRESVIsIGxhay0+Y29uZi0+dGxzX2NhY2VydF9kaXIpOwoJCWlmIChyYyAhPSBMREFQX1NV
Q0NFU1MpIHsKCQkJc3lzbG9nIChMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQg
TERBUF9PUFRfWF9UTFNfQ0FDRVJURElSICglcykuIiwgbGRhcF9lcnIyc3RyaW5nIChyYykpOwoJ
CX0KCX0KCglpZiAobGFrLT5jb25mLT50bHNfY2hlY2tfcGVlciAhPSAwKSB7CgkJcmMgPSBsZGFw
X3NldF9vcHRpb24oTlVMTCwgTERBUF9PUFRfWF9UTFNfUkVRVUlSRV9DRVJULCAmbGFrLT5jb25m
LT50bHNfY2hlY2tfcGVlcik7CgkJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJCQlzeXNsb2cg
KExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9YX1RMU19SRVFV
SVJFX0NFUlQgKCVzKS4iLCBsZGFwX2VycjJzdHJpbmcgKHJjKSk7CgkJfQoJfQoKCWlmIChsYWst
PmNvbmYtPnRsc19jaXBoZXJzICE9IE5VTEwpIHsKCQkvKiBzZXQgY2lwaGVyIHN1aXRlLCBjZXJ0
aWZpY2F0ZSBhbmQgcHJpdmF0ZSBrZXk6ICovCgkJcmMgPSBsZGFwX3NldF9vcHRpb24oTlVMTCwg
TERBUF9PUFRfWF9UTFNfQ0lQSEVSX1NVSVRFLCBsYWstPmNvbmYtPnRsc19jaXBoZXJzKTsKCQlp
ZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7CgkJCXN5c2xvZyAoTE9HX1dBUk5JTkd8TE9HX0FVVEgs
ICJVbmFibGUgdG8gc2V0IExEQVBfT1BUX1hfVExTX0NJUEhFUl9TVUlURSAoJXMpLiIsIGxkYXBf
ZXJyMnN0cmluZyAocmMpKTsKCQl9Cgl9CgoJaWYgKGxhay0+Y29uZi0+dGxzX2NlcnQgIT0gTlVM
TCkgewoJCXJjID0gbGRhcF9zZXRfb3B0aW9uKE5VTEwsIExEQVBfT1BUX1hfVExTX0NFUlRGSUxF
LCBsYWstPmNvbmYtPnRsc19jZXJ0KTsKCQlpZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7CgkJCXN5
c2xvZyAoTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0IExEQVBfT1BUX1hfVExT
X0NFUlRGSUxFICglcykuIiwgbGRhcF9lcnIyc3RyaW5nIChyYykpOwoJCX0KCX0KCglpZiAobGFr
LT5jb25mLT50bHNfa2V5ICE9IE5VTEwpIHsKCQlyYyA9IGxkYXBfc2V0X29wdGlvbihOVUxMLCBM
REFQX09QVF9YX1RMU19LRVlGSUxFLCBsYWstPmNvbmYtPnRsc19rZXkpOwoJCWlmIChyYyAhPSBM
REFQX1NVQ0NFU1MpIHsKCQkJc3lzbG9nIChMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0
byBzZXQgTERBUF9PUFRfWF9UTFNfS0VZRklMRSAoJXMpLiIsIGxkYXBfZXJyMnN0cmluZyAocmMp
KTsKCQl9Cgl9CgoJcmMgPSBsZGFwX2luaXRpYWxpemUoJmxhay0+bGQsIGxhay0+Y29uZi0+c2Vy
dmVycyk7CglpZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7CgkJc3lzbG9nKExPR19FUlJ8TE9HX0FV
VEgsICJsZGFwX2luaXRpYWxpemUgZmFpbGVkICglcykiLCBsYWstPmNvbmYtPnNlcnZlcnMpOwoJ
CXJldHVybiBMQUtfRkFJTDsKCX0KCglpZiAobGFrLT5jb25mLT5kZWJ1ZykgewoJCXJjID0gbGRh
cF9zZXRfb3B0aW9uKE5VTEwsIExEQVBfT1BUX0RFQlVHX0xFVkVMLCAmKGxhay0+Y29uZi0+ZGVi
dWcpKTsKCQlpZiAocmMgIT0gTERBUF9PUFRfU1VDQ0VTUykKCQkJc3lzbG9nKExPR19XQVJOSU5H
fExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9ERUJVR19MRVZFTCAleC4iLCBsYWst
PmNvbmYtPmRlYnVnKTsKCX0KCglyYyA9IGxkYXBfc2V0X29wdGlvbihsYWstPmxkLCBMREFQX09Q
VF9QUk9UT0NPTF9WRVJTSU9OLCAmKGxhay0+Y29uZi0+dmVyc2lvbikpOwoJaWYgKHJjICE9IExE
QVBfT1BUX1NVQ0NFU1MpIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUg
dG8gc2V0IExEQVBfT1BUX1BST1RPQ09MX1ZFUlNJT04gJWQuIiwgbGFrLT5jb25mLT52ZXJzaW9u
KTsKCQlsYWstPmNvbmYtPnZlcnNpb24gPSBMREFQX1ZFUlNJT04yOwoJfQoKCXJjID0gbGRhcF9z
ZXRfb3B0aW9uKGxhay0+bGQsIExEQVBfT1BUX05FVFdPUktfVElNRU9VVCwgJihsYWstPmNvbmYt
PnRpbWVvdXQpKTsKCWlmIChyYyAhPSBMREFQX09QVF9TVUNDRVNTKSB7CgkJc3lzbG9nKExPR19X
QVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9ORVRXT1JLX1RJTUVPVVQg
JWQuJWQuIiwgbGFrLT5jb25mLT50aW1lb3V0LnR2X3NlYywgbGFrLT5jb25mLT50aW1lb3V0LnR2
X3VzZWMpOwoJfQoKCXJjID0gbGRhcF9zZXRfb3B0aW9uKGxhay0+bGQsIExEQVBfT1BUX1RJTUVM
SU1JVCwgJihsYWstPmNvbmYtPnRpbWVfbGltaXQpKTsKCWlmIChyYyAhPSBMREFQX09QVF9TVUND
RVNTKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQ
X09QVF9USU1FTElNSVQgJWQuIiwgbGFrLT5jb25mLT50aW1lX2xpbWl0KTsKCX0KCglyYyA9IGxk
YXBfc2V0X29wdGlvbihsYWstPmxkLCBMREFQX09QVF9ERVJFRiwgJihsYWstPmNvbmYtPmRlcmVm
KSk7CglpZiAocmMgIT0gTERBUF9PUFRfU1VDQ0VTUykgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xM
T0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERBUF9PUFRfREVSRUYgJWQuIiwgbGFrLT5jb25mLT5k
ZXJlZik7Cgl9CgoJcmMgPSBsZGFwX3NldF9vcHRpb24obGFrLT5sZCwgTERBUF9PUFRfUkVGRVJS
QUxTLCBsYWstPmNvbmYtPnJlZmVycmFscyA/IExEQVBfT1BUX09OIDogTERBUF9PUFRfT0ZGKTsK
CWlmIChyYyAhPSBMREFQX09QVF9TVUNDRVNTKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19B
VVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9SRUZFUlJBTFMuIik7Cgl9CgoJcmMgPSBsZGFw
X3NldF9vcHRpb24obGFrLT5sZCwgTERBUF9PUFRfU0laRUxJTUlULCAmKGxhay0+Y29uZi0+c2l6
ZV9saW1pdCkpOwoJaWYgKHJjICE9IExEQVBfT1BUX1NVQ0NFU1MpCgkJc3lzbG9nKExPR19XQVJO
SU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9TSVpFTElNSVQgJWQuIiwgbGFr
LT5jb25mLT5zaXplX2xpbWl0KTsKCglyYyA9IGxkYXBfc2V0X29wdGlvbihsYWstPmxkLCBMREFQ
X09QVF9SRVNUQVJULCBsYWstPmNvbmYtPnJlc3RhcnQgPyBMREFQX09QVF9PTiA6IExEQVBfT1BU
X09GRik7CglpZiAocmMgIT0gTERBUF9PUFRfU1VDQ0VTUykgewoJCXN5c2xvZyhMT0dfV0FSTklO
R3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERBUF9PUFRfUkVTVEFSVC4iKTsKCX0KCgkvKgoJ
ICogU2V0IHVwIGNsaWVudC1zaWRlIGNhY2hpbmcKCSAqLwoJaWYgKGxhay0+Y29uZi0+Y2FjaGVf
dHRsKSB7CgkJcmMgPSBsZGFwX2VuYWJsZV9jYWNoZShsYWstPmxkLCBsYWstPmNvbmYtPmNhY2hl
X3R0bCwgbGFrLT5jb25mLT5jYWNoZV9tZW0pOwoJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsK
CQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIGVuYWJsZSBjYWNoZSAt
LSBjb250aW51aW5nICglcykiLCBsZGFwX2VycjJzdHJpbmcocmMpKTsKCQl9Cgl9CgoJcmV0dXJu
IExBS19PSzsKfQoKCnN0YXRpYyBpbnQgbGFrX2JpbmQoTEFLICpsYWssIGNoYXIgZmxhZywgY29u
c3QgY2hhciAqYmluZF9kbiwgY29uc3QgY2hhciAqcGFzc3dvcmQpIAp7CglpbnQgcmM7CgoJaWYg
KGxhay0+YmluZF9zdGF0dXMgPT0gTEFLX0JJTkRfQU5PTllNT1VTICYmCgkgICAgZmxhZyA9PSBM
QUtfQklORF9BTk9OWU1PVVMpIHsKCSAgICByZXR1cm4gTEFLX09LOwoJfQoKCWlmIChsYWstPmJp
bmRfc3RhdHVzID09IExBS19OT1RfQk9VTkQpIHsKCQlpZiAobGFrLT5sZCAhPSBOVUxMKSB7CgkJ
CWlmIChsYWstPmNvbmYtPmNhY2hlX3R0bCkKCQkJCWxkYXBfZGVzdHJveV9jYWNoZShsYWstPmxk
KTsKCQkJbGRhcF91bmJpbmRfcyhsYWstPmxkKTsKCQkJbGFrLT5sZCA9IE5VTEw7CgkJfQoKCQly
YyA9IGxha19jb25uZWN0KGxhayk7CgkJaWYgKHJjICE9IExBS19PSykgewoJCQlyZXR1cm4gcmM7
CgkJfQoJfSBlbHNlIHsKCQlpZiAobGFrLT5jb25mLT52ZXJzaW9uID09IExEQVBfVkVSU0lPTjIp
IHsKCgkJCWxhay0+YmluZF9zdGF0dXMgPSBMQUtfTk9UX0JPVU5EOwoKCQkJaWYgKGxhay0+bGQg
IT0gTlVMTCkgewoJCQkJaWYgKGxhay0+Y29uZi0+Y2FjaGVfdHRsKQoJCQkJCWxkYXBfZGVzdHJv
eV9jYWNoZShsYWstPmxkKTsKCQkJCWxkYXBfdW5iaW5kX3MobGFrLT5sZCk7CgoJCQkJbGFrLT5s
ZCA9IE5VTEw7CgkJCX0KCQkJcmMgPSBsYWtfY29ubmVjdChsYWspOwoJCQlpZiAocmMgIT0gTEFL
X09LKSB7CgkJCQlyZXR1cm4gcmM7CgkJCX0KCQl9Cgl9CgoJcmMgPSBsZGFwX3NpbXBsZV9iaW5k
X3MobGFrLT5sZCwgYmluZF9kbiwgcGFzc3dvcmQpOwoJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykg
ewoJICAgIHN5c2xvZygoZmxhZyA9PSBMQUtfQklORF9BTk9OWU1PVVMgPyBMT0dfV0FSTklORyA6
IExPR19ERUJVRyl8TE9HX0FVVEgsCgkJICAgImxkYXBfc2ltcGxlX2JpbmQoKSBmYWlsZWQgYXMg
JXMgKCVzKSIsCgkJICAgKCFiaW5kX2RuIHx8IGJpbmRfZG5bMF0gPT0gJ1wwJykgPyAiYW5vbnlt
b3VzIiA6IGJpbmRfZG4sCgkJICAgbGRhcF9lcnIyc3RyaW5nKHJjKSk7CgkgICAgbGFrLT5iaW5k
X3N0YXR1cyA9IExBS19OT1RfQk9VTkQ7CgkgICAgcmV0dXJuIExBS19GQUlMOwoJfQoKCWxhay0+
YmluZF9zdGF0dXMgPSBmbGFnOwoJcmV0dXJuIExBS19PSzsKfQoKCnN0YXRpYyBpbnQgbGFrX3Nl
YXJjaChMQUsgKmxhaywgY29uc3QgY2hhciAqc2VhcmNoX2Jhc2UsIGNvbnN0IGNoYXIgKmZpbHRl
ciwgY29uc3QgY2hhciAqKmF0dHJzLCBMREFQTWVzc2FnZSAqKnJlcykKewoJaW50IHJjID0gMDsK
CWludCByZXRyeSA9IDE7CgoJKnJlcyA9IE5VTEw7CgpyZXRyeToKCXJjID0gbGFrX2JpbmQobGFr
LCBMQUtfQklORF9BTk9OWU1PVVMsIGxhay0+Y29uZi0+YmluZF9kbiwgbGFrLT5jb25mLT5iaW5k
X3B3KTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgs
ICJsYWtfYmluZCgpIGZhaWxlZCIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxkYXBf
c2VhcmNoX3N0KGxhay0+bGQsIHNlYXJjaF9iYXNlLCBsYWstPmNvbmYtPnNjb3BlLCBmaWx0ZXIs
IChjaGFyICoqKSBhdHRycywgMCwgJihsYWstPmNvbmYtPnRpbWVvdXQpLCByZXMpOwoJc3dpdGNo
IChyYykgewoJCWNhc2UgTERBUF9TVUNDRVNTOgoJCWNhc2UgTERBUF9OT19TVUNIX09CSkVDVDoK
CQkJYnJlYWs7CgkJY2FzZSBMREFQX1RJTUVMSU1JVF9FWENFRURFRDoKCQljYXNlIExEQVBfQlVT
WToKCQljYXNlIExEQVBfVU5BVkFJTEFCTEU6CgkJY2FzZSBMREFQX0lOU1VGRklDSUVOVF9BQ0NF
U1M6CgkJCS8qICBXZSBkbyBub3QgbmVlZCB0byByZS1jb25uZWN0IHRvIHRoZSBMREFQIHNlcnZl
ciAKCQkJICAgIHVuZGVyIHRoZXNlIGNvbmRpdGlvbnMgKi8KCQkJc3lzbG9nKExPR19FUlJ8TE9H
X0FVVEgsICJsZGFwX3NlYXJjaF9zdCgpIGZhaWxlZDogJXMiLCBsZGFwX2VycjJzdHJpbmcocmMp
KTsKCQkJbGRhcF9tc2dmcmVlKCpyZXMpOwoJCQlyZXR1cm4gTEFLX0ZBSUw7CgkJY2FzZSBMREFQ
X1RJTUVPVVQ6CgkJY2FzZSBMREFQX1NFUlZFUl9ET1dOOgoJCQlpZiAocmV0cnkpIHsKCQkJCXN5
c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgImxkYXBfc2VhcmNoX3N0KCkgZmFpbGVkOiAlcy4g
VHJ5aW5nIHRvIHJlY29ubmVjdC4iLCBsZGFwX2VycjJzdHJpbmcocmMpKTsKCQkJCWxkYXBfbXNn
ZnJlZSgqcmVzKTsKCQkJCWxhay0+YmluZF9zdGF0dXMgPSBMQUtfTk9UX0JPVU5EOwoJCQkJcmV0
cnktLTsKCQkJCWdvdG8gcmV0cnk7CgkJCX0KCQlkZWZhdWx0OgoJCQlzeXNsb2coTE9HX0VSUnxM
T0dfQVVUSCwgImxkYXBfc2VhcmNoX3N0KCkgZmFpbGVkOiAlcyIsIGxkYXBfZXJyMnN0cmluZyhy
YykpOwoJCQlsZGFwX21zZ2ZyZWUoKnJlcyk7CgkJCWxhay0+YmluZF9zdGF0dXMgPSBMQUtfTk9U
X0JPVU5EOwoJCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJaWYgKChsZGFwX2NvdW50X2VudHJpZXMo
bGFrLT5sZCwgKnJlcykpICE9IDEpIHsKCQlzeXNsb2coTE9HX0RFQlVHfExPR19BVVRILCAiRW50
cnkgbm90IGZvdW5kIG9yIG1vcmUgdGhhbiBvbmUgZW50cmllcyBmb3VuZCAoJXMpLiIsIGZpbHRl
cik7CgkJbGRhcF9tc2dmcmVlKCpyZXMpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCQoJcmV0dXJu
IExBS19PSzsKfQoKLyogCiAqIGxha19yZXRyaWV2ZSAtIHJldHJpZXZlIHVzZXJAcmVhbG0gdmFs
dWVzIHNwZWNpZmllZCBieSAnYXR0cnMnCiAqLwppbnQgbGFrX3JldHJpZXZlKExBSyAqbGFrLCBj
b25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFsbSwg
Y29uc3QgY2hhciAqKmF0dHJzLCBMQUtfUkVTVUxUICoqcmV0KQp7CglpbnQgcmMgPSAwLCBpOwoJ
Y2hhciAqZmlsdGVyID0gTlVMTDsKCWNoYXIgKnNlYXJjaF9iYXNlID0gTlVMTDsKCUxEQVBNZXNz
YWdlICpyZXM7CglMREFQTWVzc2FnZSAqZW50cnk7CglCZXJFbGVtZW50ICpiZXI7CgljaGFyICph
dHRyLCAqKnZhbHM7CiAgICAKICAgIAkqcmV0ID0gTlVMTDsKCglpZiAobGFrID09IE5VTEwpIHsK
CQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgImxha19pbml0IGRpZCBub3QgcnVuLiIpOwoJCXJl
dHVybiBMQUtfRkFJTDsKCX0KCglpZiAodXNlciA9PSBOVUxMIHx8IHVzZXJbMF0gPT0gJ1wwJykg
ewoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxha19maWx0ZXIobGFrLT5jb25mLT5maWx0
ZXIsIHVzZXIsIHNlcnZpY2UsIHJlYWxtLCAmZmlsdGVyKTsKCWlmIChyYyAhPSBMQUtfT0spIHsK
CQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJsYWtfZmlsdGVyKGZpbHRlcikgZmFpbGVk
LiIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxha19maWx0ZXIobGFrLT5jb25mLT5z
ZWFyY2hfYmFzZSwgdXNlciwgc2VydmljZSwgcmVhbG0sICZzZWFyY2hfYmFzZSk7CglpZiAocmMg
IT0gTEFLX09LKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAibGFrX2ZpbHRlcihz
ZWFyY2hfYmFzZSkgZmFpbGVkLiIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxha19z
ZWFyY2gobGFrLCBzZWFyY2hfYmFzZSwgZmlsdGVyLCBhdHRycywgJnJlcyk7CglpZiAocmMgIT0g
TEFLX09LKSB7CgkJZnJlZShmaWx0ZXIpOwoJCWZyZWUoc2VhcmNoX2Jhc2UpOwoJCXJldHVybiBM
QUtfRkFJTDsKCX0KCgllbnRyeSA9IGxkYXBfZmlyc3RfZW50cnkobGFrLT5sZCwgcmVzKTsgCglp
ZiAoZW50cnkgPT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgImxkYXBf
Zmlyc3RfZW50cnkoKSBmYWlsZWQuIik7CgkJZnJlZShmaWx0ZXIpOwoJCWZyZWUoc2VhcmNoX2Jh
c2UpOwoJCWxkYXBfbXNnZnJlZShyZXMpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IExB
S19PSzsKCWZvciAoYXR0ciA9IGxkYXBfZmlyc3RfYXR0cmlidXRlKGxhay0+bGQsIGVudHJ5LCAm
YmVyKTsgYXR0ciAhPSBOVUxMOyAKCQlhdHRyID0gbGRhcF9uZXh0X2F0dHJpYnV0ZShsYWstPmxk
LCBlbnRyeSwgYmVyKSkgewoKCQl2YWxzID0gbGRhcF9nZXRfdmFsdWVzKGxhay0+bGQsIGVudHJ5
LCBhdHRyKTsKCQlpZiAodmFscyA9PSBOVUxMKSB7CgkJCWNvbnRpbnVlOwoJCX0KCgkJZm9yIChp
ID0gMDsgdmFsc1tpXSAhPSBOVUxMOyBpKyspIHsKCQkJcmMgPSBsYWtfcmVzdWx0X2FkZChsYWss
IGF0dHIsIHZhbHNbaV0sIHJldCk7CgkJCWlmIChyYyAhPSBMQUtfT0spIHsKCQkJCWJyZWFrOwoJ
CQl9CgkJfQoKCQlsZGFwX3ZhbHVlX2ZyZWUodmFscyk7CgkJbGRhcF9tZW1mcmVlKGF0dHIpOwoK
CQlpZiAocmMgIT0gTEFLX09LKSB7CgkJCWxha19yZXN1bHRfZnJlZSgqcmV0KTsKCQkJKnJldCA9
IE5VTEw7CgkJCWJyZWFrOwoJCX0KCX0KCglpZiAoYmVyICE9IE5VTEwpCgkJYmVyX2ZyZWUoYmVy
LCAwKTsKCWxkYXBfbXNnZnJlZShyZXMpOwoJZnJlZShmaWx0ZXIpOwoJZnJlZShzZWFyY2hfYmFz
ZSk7CgoJaWYgKCpyZXQgPT0gTlVMTCkKCQlyZXR1cm4gTEFLX05PRU5UOwoKCXJldHVybiBMQUtf
T0s7Cn0KCgpzdGF0aWMgaW50IGxha19ncm91cF9tZW1iZXIoTEFLICpsYWssIGNvbnN0IGNoYXIg
KnVzZXIsIGNvbnN0IGNoYXIgKnNlcnZpY2UsIGNvbnN0IGNoYXIgKnJlYWxtLCBjb25zdCBjaGFy
ICpkbikKewoJY2hhciAqZ3JvdXA7CglpbnQgcmM7CgoJcmMgPSBsYWtfZmlsdGVyKGxhay0+Y29u
Zi0+Z3JvdXBfZG4sIHVzZXIsIHNlcnZpY2UsIHJlYWxtLCAmZ3JvdXApOwoJaWYgKHJjICE9IExB
S19PSykgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgImxha19maWx0ZXIoZ3JvdXAp
IGZhaWxlZC4iKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmMgPSBsZGFwX2NvbXBhcmVfcyhs
YWstPmxkLCBncm91cCwgbGFrLT5jb25mLT5ncm91cF9hdHRyLCBkbik7CglmcmVlKGdyb3VwKTsK
CWlmIChyYyAhPSBMREFQX0NPTVBBUkVfVFJVRSkgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0df
QVVUSCwgImxkYXBfY29tcGFyZV9zKCkgZm9yIGdyb3VwIGZhaWxlZC4iKTsKCQlyYyA9IExBS19G
QUlMOwoJfQoKCXJldHVybiBMQUtfT0s7Cn0KCnN0YXRpYyBpbnQgbGFrX2F1dGhfY3VzdG9tKExB
SyAqbGFrLCBjb25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFy
ICpyZWFsbSwgY29uc3QgY2hhciAqcGFzc3dvcmQpIAp7CglMQUtfUkVTVUxUICpscmVzLCAqcHRy
OwoJaW50IHJjOwoJc3RydWN0IHBhc3N3b3JkX2NoZWNrICpwYzsKCWNvbnN0IGNoYXIgKmF0dHJz
W10gPSB7ImRuIiwgbGFrLT5jb25mLT5wYXNzd29yZF9hdHRyLCBOVUxMfTsKCWNoYXIgKmRuOwoK
CXJjID0gbGFrX3JldHJpZXZlKGxhaywgdXNlciwgc2VydmljZSwgcmVhbG0sIGF0dHJzLCAmbHJl
cyk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJcmV0dXJuIHJjOwoJfQoKCXJjID0gTEFLX0ZBSUw7
CgoJZm9yIChwdHIgPSBscmVzOyBwdHIgIT0gTlVMTDsgcHRyID0gcHRyLT5uZXh0KSB7CgkJCgkJ
aWYgKHN0cmNhc2VjbXAocHRyLT5hdHRyaWJ1dGUsIGxhay0+Y29uZi0+cGFzc3dvcmRfYXR0cikp
CgkJCWNvbnRpbnVlOwoKCQlyYyA9IGxha19jaGVja19wYXNzd29yZChwdHItPnZhbHVlLCBwYXNz
d29yZCwgTlVMTCk7CgkJaWYgKHJjID09IExBS19PSykgewoJCQlicmVhazsKCQl9Cgl9CgoJaWYg
KHJjID09IExBS19PSyAmJgoJICAgIGxhay0+Y29uZi0+Z3JvdXBfZG4gIT0gTlVMTCAmJiAqKGxh
ay0+Y29uZi0+Z3JvdXBfZG4pICE9ICdcMCcpIHsKCgkJcmMgPSBMQUtfRkFJTDsKCgkJZm9yIChw
dHIgPSBscmVzOyBwdHIgIT0gTlVMTDsgcHRyID0gcHRyLT5uZXh0KQoJCQlpZiAoIXN0cmNhc2Vj
bXAocHRyLT5hdHRyaWJ1dGUsICJkbiIpKSB7CgkJCQlyYyA9IGxha19ncm91cF9tZW1iZXIobGFr
LCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgZG4pOwoJCQkJYnJlYWs7CgkJCX0KCgkJc3lzbG9nKExP
R19XQVJOSU5HfExPR19BVVRILCAiR3JvdXAgY2hlY2sgZmFpbGVkIChkbiB1bmtub3duKS4iKTsK
CX0KCQoJbGFrX3Jlc3VsdF9mcmVlKGxyZXMpOwoKCXJldHVybihyYyk7Cn0KCnN0YXRpYyBpbnQg
bGFrX2F1dGhfYmluZChMQUsgKmxhaywgY29uc3QgY2hhciAqdXNlciwgY29uc3QgY2hhciAqc2Vy
dmljZSwgY29uc3QgY2hhciAqcmVhbG0sIGNvbnN0IGNoYXIgKnBhc3N3b3JkKSAKewoJY2hhciAq
ZmlsdGVyOwoJY2hhciAqc2VhcmNoX2Jhc2U7CglpbnQgcmM7CgljaGFyICpkbjsKCUxEQVBNZXNz
YWdlICpyZXMsICplbnRyeTsKCglyYyA9IGxha19maWx0ZXIobGFrLT5jb25mLT5maWx0ZXIsIHVz
ZXIsIHNlcnZpY2UsIHJlYWxtLCAmZmlsdGVyKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlzeXNs
b2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJsYWtfZmlsdGVyKGZpbHRlcikgZmFpbGVkLiIpOwoJ
CXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxha19maWx0ZXIobGFrLT5jb25mLT5zZWFyY2hf
YmFzZSwgdXNlciwgc2VydmljZSwgcmVhbG0sICZzZWFyY2hfYmFzZSk7CglpZiAocmMgIT0gTEFL
X09LKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAibGFrX2ZpbHRlcihzZWFyY2hf
YmFzZSkgZmFpbGVkLiIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxha19zZWFyY2go
bGFrLCBzZWFyY2hfYmFzZSwgZmlsdGVyLCBOVUxMLCAmcmVzKTsKCWlmIChyYyAhPSBMQUtfT0sp
IHsKCQlmcmVlKGZpbHRlcik7CgkJZnJlZShzZWFyY2hfYmFzZSk7CgkJcmV0dXJuIExBS19GQUlM
OwoJfQoKCWVudHJ5ID0gbGRhcF9maXJzdF9lbnRyeShsYWstPmxkLCByZXMpOyAKCWlmIChlbnRy
eSA9PSBOVUxMKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAibGRhcF9maXJzdF9l
bnRyeSgpLiIpOwoJCWZyZWUoZmlsdGVyKTsKCQlmcmVlKHNlYXJjaF9iYXNlKTsKCQlsZGFwX21z
Z2ZyZWUocmVzKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJZG4gPSBsZGFwX2dldF9kbihsYWst
PmxkLCByZXMpOwoJaWYgKGRuID09IE5VTEwpIHsKCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwg
ImxkYXBfZ2V0X2RuKCkgZmFpbGVkLiIpOwoJCWZyZWUoZmlsdGVyKTsKCQlmcmVlKHNlYXJjaF9i
YXNlKTsKCQlsZGFwX21zZ2ZyZWUgKHJlcyk7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWZyZWUo
ZmlsdGVyKTsKCWZyZWUoc2VhcmNoX2Jhc2UpOwoJbGRhcF9tc2dmcmVlKHJlcyk7CgoJcmMgPSBs
YWtfYmluZChsYWssIExBS19CSU5EX0FTX1VTRVIsIGRuLCBwYXNzd29yZCk7CgoJaWYgKHJjID09
IExBS19PSyAmJgoJICAgIGxhay0+Y29uZi0+Z3JvdXBfZG4gIT0gTlVMTCAmJiAqKGxhay0+Y29u
Zi0+Z3JvdXBfZG4pICE9ICdcMCcpCgkJcmMgPSBsYWtfZ3JvdXBfbWVtYmVyKGxhaywgdXNlciwg
c2VydmljZSwgcmVhbG0sIGRuKTsKCglsZGFwX21lbWZyZWUoZG4pOwoKCWxha19iaW5kKGxhaywg
TEFLX0JJTkRfQU5PTllNT1VTLCBsYWstPmNvbmYtPmJpbmRfZG4sIGxhay0+Y29uZi0+YmluZF9w
dyk7CgoKCXJldHVybiByYzsKfQoKCnN0YXRpYyBpbnQgbGFrX2F1dGhfZmFzdGJpbmQoTEFLICps
YWssIGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnNlcnZpY2UsIGNvbnN0IGNoYXIgKnJl
YWxtLCBjb25zdCBjaGFyICpwYXNzd29yZCkgCnsKCWludCByYzsKCWNoYXIgKmRuID0gTlVMTDsK
CglyYyA9IGxha19maWx0ZXIobGFrLT5jb25mLT5maWx0ZXIsIHVzZXIsIHNlcnZpY2UsIHJlYWxt
LCAmZG4pOwoJaWYgKHJjICE9IExBS19PSyB8fCBkbiA9PSBOVUxMKSB7CgkJc3lzbG9nKExPR19X
QVJOSU5HfExPR19BVVRILCAibGFrX2ZpbHRlcihmaWx0ZXIpIGZhaWxlZC4iKTsKCQlyZXR1cm4g
TEFLX0ZBSUw7Cgl9CgoJcmMgPSBsYWtfYmluZChsYWssIExBS19CSU5EX0FTX1VTRVIsIGRuLCBw
YXNzd29yZCk7CglmcmVlKGRuKTsKCglpZiAocmMgPT0gTEFLX09LICYmCgkgICAgbGFrLT5jb25m
LT5ncm91cF9kbiAhPSBOVUxMICYmICoobGFrLT5jb25mLT5ncm91cF9kbikgIT0gJ1wwJykKCQly
YyA9IGxha19ncm91cF9tZW1iZXIobGFrLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgZG4pOwoKCXJl
dHVybiByYzsKfQoKaW50IGxha19hdXRoZW50aWNhdGUoTEFLICpsYWssIGNvbnN0IGNoYXIgKnVz
ZXIsIGNvbnN0IGNoYXIgKnNlcnZpY2UsIGNvbnN0IGNoYXIgKnJlYWxtLCBjb25zdCBjaGFyICpw
YXNzd29yZCkgCnsKCWludCByYzsKCglpZiAobGFrID09IE5VTEwpIHsKCQlzeXNsb2coTE9HX0VS
UnxMT0dfQVVUSCwgImxha19pbml0IGRpZCBub3QgcnVuLiIpOwoJCXJldHVybiBMQUtfRkFJTDsK
CX0KCglpZiAodXNlciA9PSBOVUxMIHx8IHVzZXJbMF0gPT0gJ1wwJykKCQlyZXR1cm4gTEFLX0ZB
SUw7CgoJaWYgKGxhay0+Y29uZi0+YXV0aF9tZXRob2QgPT0gTEFLX0FVVEhfTUVUSE9EX0JJTkQp
CgkJcmMgPSBsYWtfYXV0aF9iaW5kKGxhaywgdXNlciwgc2VydmljZSwgcmVhbG0sIHBhc3N3b3Jk
KTsKCWVsc2UgaWYgKGxhay0+Y29uZi0+YXV0aF9tZXRob2QgPT0gTEFLX0FVVEhfTUVUSE9EX0NV
U1RPTSkKCQlyYyA9IGxha19hdXRoX2N1c3RvbShsYWssIHVzZXIsIHNlcnZpY2UsIHJlYWxtLCBw
YXNzd29yZCk7CgllbHNlCgkJcmMgPSBsYWtfYXV0aF9mYXN0YmluZChsYWssIHVzZXIsIHNlcnZp
Y2UsIHJlYWxtLCBwYXNzd29yZCk7CgoJcmV0dXJuIHJjOwp9CgoKc3RhdGljIGludCBsYWtfcmVz
dWx0X2FkZChMQUsgKmxhaywgY29uc3QgY2hhciAqYXR0ciwgY29uc3QgY2hhciAqdmFsLCBMQUtf
UkVTVUxUICoqcmV0KSAgCnsKCUxBS19SRVNVTFQgKmxyZXM7CgkKCWxyZXMgPSAoTEFLX1JFU1VM
VCAqKSBtYWxsb2Moc2l6ZW9mKExBS19SRVNVTFQpKTsKCWlmIChscmVzID09IE5VTEwpIHsKCQly
ZXR1cm4gTEFLX05PTUVNOwoJfQoKCWxyZXMtPm5leHQgPSBOVUxMOwoKCWxyZXMtPmF0dHJpYnV0
ZSA9IHN0cmR1cChhdHRyKTsKCWlmIChscmVzLT5hdHRyaWJ1dGUgPT0gTlVMTCkgewoJCWxha19y
ZXN1bHRfZnJlZShscmVzKTsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoKCWxyZXMtPnZhbHVlID0g
c3RyZHVwKHZhbCk7CglpZiAobHJlcy0+dmFsdWUgPT0gTlVMTCkgewoJCWxha19yZXN1bHRfZnJl
ZShscmVzKTsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoJbHJlcy0+bGVuID0gc3RybGVuKGxyZXMt
PnZhbHVlKTsKCglscmVzLT5uZXh0ID0gKnJldDsKCgkqcmV0ID0gbHJlczsKCXJldHVybiBMQUtf
T0s7Cn0KCgp2b2lkIGxha19yZXN1bHRfZnJlZShMQUtfUkVTVUxUICpyZXMpIAp7CglMQUtfUkVT
VUxUICpscmVzLCAqcHRyID0gcmVzOwoKCWlmIChwdHIgPT0gTlVMTCkKCQlyZXR1cm47CgoJZm9y
IChscmVzID0gcHRyOyBscmVzICE9IE5VTEw7IGxyZXMgPSBwdHIpIHsKCgkJcHRyID0gbHJlcy0+
bmV4dDsKCgkJaWYgKGxyZXMtPmF0dHJpYnV0ZSAhPSBOVUxMKSB7CgkJCW1lbXNldChscmVzLT5h
dHRyaWJ1dGUsIDAsIHN0cmxlbihscmVzLT52YWx1ZSkpOwoJCQlmcmVlKGxyZXMtPmF0dHJpYnV0
ZSk7CQoJCX0KCgkJaWYgKGxyZXMtPnZhbHVlICE9IE5VTEwpIHsKCQkJbWVtc2V0KGxyZXMtPnZh
bHVlLCAwLCBzdHJsZW4obHJlcy0+dmFsdWUpKTsKCQkJZnJlZShscmVzLT52YWx1ZSk7CQoJCX0K
CgkJbHJlcy0+bmV4dCA9IE5VTEw7CgoJCWZyZWUobHJlcyk7Cgl9CgoJcmV0dXJuOwp9CgpzdGF0
aWMgaW50IGxha19jaGVja19wYXNzd29yZChjb25zdCBjaGFyICpoYXNoLCBjb25zdCBjaGFyICpw
YXNzd2QsIHZvaWQgKnJvY2spIAp7CglpbnQgaSwgaGxlbjsKCWludCByYzsKCglpZiAoaGFzaCA9
PSBOVUxMIHx8IGhhc2hbMF0gPT0gJ1wwJykgewoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglpZiAo
cGFzc3dkID09IE5VTEwgfHwgcGFzc3dkWzBdID09ICdcMCcpIHsKCQlyZXR1cm4gTEFLX0ZBSUw7
Cgl9CgoJZm9yIChpID0gMDsgcGFzc3dvcmRfc2NoZW1lW2ldLmhhc2ggIT0gTlVMTDsgaSsrKSB7
CgoJCWhsZW4gPSBzdHJsZW4ocGFzc3dvcmRfc2NoZW1lW2ldLmhhc2gpOwoJCWlmICghc3RybmNh
c2VjbXAocGFzc3dvcmRfc2NoZW1lW2ldLmhhc2gsIGhhc2gsIGhsZW4pKSB7CgkJCWlmIChwYXNz
d29yZF9zY2hlbWVbaV0uY2hlY2spIHsKCQkJCXJjID0gKHBhc3N3b3JkX3NjaGVtZVtpXS5jaGVj
aykoaGFzaCtobGVuLCBwYXNzd2QsCgkJCQkJCQkJcGFzc3dvcmRfc2NoZW1lW2ldLnJvY2spOwoJ
CQl9CgkJCXJldHVybiByYzsKCQl9Cgl9CgoJcmV0dXJuIHN0cmNtcChoYXNoLCBwYXNzd2QpID8g
TEFLX0ZBSUwgOiBMQUtfT0s7Cn0KCiNpZmRlZiBIQVZFX09QRU5TU0wKCnN0YXRpYyBpbnQgbGFr
X2Jhc2U2NF9kZWNvZGUoY29uc3QgY2hhciAqc3JjLCBjaGFyICoqcmV0LCBpbnQgKnJsZW4pIHsK
CglpbnQgcmMsIGksIHRsZW4gPSAwOwoJY2hhciAqdGV4dDsKCUVWUF9FTkNPREVfQ1RYIEVWUF9j
dHg7CgoJdGV4dCA9IChjaGFyICopbWFsbG9jKCgoc3RybGVuKHNyYykrMykvNCAqIDMpICsgMSk7
CglpZiAodGV4dCA9PSBOVUxMKSB7CgkJcmV0dXJuIExBS19OT01FTTsKCX0KCglFVlBfRGVjb2Rl
SW5pdCgmRVZQX2N0eCk7CglyYyA9IEVWUF9EZWNvZGVVcGRhdGUoJkVWUF9jdHgsIHRleHQsICZp
LCAoY2hhciAqKXNyYywgc3RybGVuKHNyYykpOwoJaWYgKHJjIDwgMCkgewoJCWZyZWUodGV4dCk7
CgkJcmV0dXJuIExBS19GQUlMOwoJfQoJdGxlbiArPSBpOwoJRVZQX0RlY29kZUZpbmFsKCZFVlBf
Y3R4LCB0ZXh0LCAmaSk7IAoKCSpyZXQgPSB0ZXh0OwoJaWYgKHJsZW4gIT0gTlVMTCkgewoJCSpy
bGVuID0gdGxlbjsKCX0KCglyZXR1cm4gTEFLX09LOwp9CgpzdGF0aWMgaW50IGxha19jaGVja19o
YXNoZWQoY29uc3QgY2hhciAqaGFzaCwgY29uc3QgY2hhciAqcGFzc3dkLCB2b2lkICpyb2NrKQp7
CglpbnQgcmMsIGNsZW47CglzdHJ1Y3QgaGFzaF9yb2NrICpocm9jayA9IChzdHJ1Y3QgaGFzaF9y
b2NrICopIHJvY2s7CglFVlBfTURfQ1RYIG1kY3R4OwoJY29uc3QgRVZQX01EICptZDsKCXVuc2ln
bmVkIGNoYXIgZGlnZXN0W0VWUF9NQVhfTURfU0laRV07CgljaGFyICpjcmVkOwoKCW1kID0gRVZQ
X2dldF9kaWdlc3RieW5hbWUoaHJvY2stPm1kYSk7CglpZiAoIW1kKSB7CgkJcmV0dXJuIExBS19G
QUlMOwoJfQoKCXJjID0gbGFrX2Jhc2U2NF9kZWNvZGUoaGFzaCwgJmNyZWQsICZjbGVuKTsKCWlm
IChyYyAhPSBMQUtfT0spIHsKCQlyZXR1cm4gcmM7Cgl9CgoJRVZQX0RpZ2VzdEluaXQoJm1kY3R4
LCBtZCk7CglFVlBfRGlnZXN0VXBkYXRlKCZtZGN0eCwgcGFzc3dkLCBzdHJsZW4ocGFzc3dkKSk7
CglpZiAoaHJvY2stPnNhbHRlZCkgewoJCUVWUF9EaWdlc3RVcGRhdGUoJm1kY3R4LCAmY3JlZFtF
VlBfTURfc2l6ZShtZCldLAoJCQkJIGNsZW4gLSBFVlBfTURfc2l6ZShtZCkpOwoJfQoJRVZQX0Rp
Z2VzdEZpbmFsKCZtZGN0eCwgZGlnZXN0LCBOVUxMKTsKCglyYyA9IG1lbWNtcCgoY2hhciAqKWNy
ZWQsIChjaGFyICopZGlnZXN0LCBFVlBfTURfc2l6ZShtZCkpOwoJZnJlZShjcmVkKTsKCXJldHVy
biByYyA/IExBS19GQUlMIDogTEFLX09LOwp9CgojZW5kaWYgLyogSEFWRV9PUEVOU1NMICovCgpz
dGF0aWMgaW50IGxha19jaGVja19jcnlwdChjb25zdCBjaGFyICpoYXNoLCBjb25zdCBjaGFyICpw
YXNzd2QsIHZvaWQgKnJvY2spIAp7CgljaGFyICpjcmVkOwoKCWlmIChoYXNoID09IE5VTEwgfHwg
aGFzaFswXSA9PSAnXDAnKSB7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWlmIChwYXNzd2QgPT0g
TlVMTCB8fCBwYXNzd2RbMF0gPT0gJ1wwJykgewoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglpZiAo
c3RybGVuKGhhc2gpIDwgMiApIHsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJY3JlZCA9IGNyeXB0
KHBhc3N3ZCwgaGFzaCk7CglpZiggY3JlZCA9PSBOVUxMIHx8IGNyZWRbMF0gPT0gJ1wwJyApIHsK
CQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmV0dXJuIHN0cmNtcChoYXNoLCBjcmVkKSA/IExBS19G
QUlMIDogTEFLX09LOwp9CgojZW5kaWYgLyogQVVUSF9MREFQICovCg==
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>114</attachid>
            <date>2003-02-07 18:31 EDT</date>
            <desc>LDAP_SASLAUTHD</desc>
            <filename>LDAP_SASLAUTHD</filename>
            <type>text/plain</type>
            <size>7732</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">YXV0aF9sZGFwIG1vZHVsZSBmb3Igc2FzbGF1dGhkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQoKU2FzbGF1dGhkIGNhbiB1c2UgYW4gTERBUCBkaXJlY3RvcnkgZm9yIGF1dGhlbnRpY2F0
aW9uL2F1dGhvcml6YXRpb24uCgpTZWN0aW9uczoKMS4gQnVpbGQgc2FzbGF1dGhkIHdpdGggbGRh
cCBzdXBwb3J0CjIuIFN0YXJ0IHNhc2xhdXRoZCB3aXRoIGxkYXAKMy4gVGVzdGluZwo0LiBQYXJh
bWV0ZXJzCjUuIEV4YW1wbGVzCjYuIE5vdGVzCjcuIFRvZG8KOC4gRmVlZGJhY2sKOC4gQXV0aG9y
CgoKMS4gQlVJTEQgU0FTTEFVVEhEIFdJVEggTERBUCBTVVBQT1JUCi0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQoKRW5zdXJlIHRoYXQgeW91IGhhdmUgdGhlIE9wZW5MREFQICho
dHRwOi8vd3d3Lm9wZW5sZGFwLm9yZykgbGlicmFyaWVzIDIuMCBvcgpoaWdoZXIuICBGZXRjaCB0
aGUgbGF0ZXN0IGN5cnVzLXNhc2wgcGFja2FnZSwgMi4xLjEyIG9yIGhpZ2hlciwKZnRwOi8vZnRw
LmFuZHJldy5jbXUuZWR1L3B1Yi9jeXJ1cy1tYWlsLy4KClVucGFjayBjeXJ1cy1zYXNsOgpnemlw
IC1kYyBjeXJ1cy1zYXNsLTIuMS4xMi50YXIuZ3ogfCB0YXIgeGYgLQpvcgp0YXIgenhmIGN5cnVz
LXNhc2wtMi4xLjEyLnRhci5neiAoaWYgeW91ciB0YXIgc3VwcG9ydHogZ3ppcCkKCmNkIGN5cnVz
LXNhc2wtMi4xLjEyCi4vY29uZmlndXJlIC0td2l0aC1sZGFwICAoeW91IG1heSBuZWVkIHRvIGFk
ZCBvdGhlciBvcHRpb25zLCBjaGVjayBkb2MvaW5kZXguaHRtbCBmb3IgbW9yZSkKbWFrZQptYWtl
IGluc3RhbGwKCgoyLiBTVEFSVCBTQVNMQVVUSEQgV0lUSCBMREFQCi0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0KCkNyZWF0ZSAvdXNyL2xvY2FsL2V0Yy9zYXNsYXV0aGQuY29uZiBhbmQgYWRk
IHRoZSBmb2xsb3dpbmcgKG1vZGlmeSB0byBmaXQgeW91cgplbnZpcm9ubWVudCk6CmxkYXBfc2Vy
dmVyczogbGRhcDovLzEwLjEuMS4xNS8gbGRhcDovLzEwLjEuMS4yNS8KbGRhcF9iaW5kX2RuOiBj
bj1vcGVyYXRvcixvdT1Qcm9maWxlLG89Zm9vLmNvbQpsZGFwX2JpbmRfcHc6IHNlY3JldAoKRG8g
bm90IHNwZWNpZnkgbGRhcF9iaW5kXyogaWYgeW91IHdhbnQgdG8gYmluZCBhbm9ueW1vdXNseSB0
byB5b3VyIGxkYXAgc2VydmVyKHMpLiAKClJ1biBzYXNsYXV0aGQ6CnNhc2xhdXRoZCAtYSBsZGFw
CgpJZiB5b3Ugd2FudCB0byBzcGVjaWZ5IGEgZGlmZmVyZW50IGNvbmZpZ3VyYXRpb24gZmlsZSwg
eW91IGNhbiBkbyBzb21ldGhpbmcKbGlrZToKc2FzbGF1dGhkIC1hIGxkYXAgLU8gL2V0Yy9zYXNs
YXV0aGQuY29uZgoKRm9yIG1vcmUsIGNoZWNrICdtYW4gc2FzbGF1dGhkJwoKCjMuIFRFU1RJTkcK
LS0tLS0tLS0tLQoKRmlyc3QgYnVpbGQgdGVzdHNhc2xhdXRoZDoKY2QgJHNhc2xfc3JjL3Nhc2xh
dXRoZAptYWtlIHRlc3RzYXNsYXV0aGQKClJ1biB0ZXN0IHV0aWxpdHk6Ci4vdGVzdHNhc2xhdXRo
ZCAtdSBpZ29yIC1wIHNlY3JldAowOiBPSyAiU3VjY2Vzcy4iCgpJZiB5b3UgZ2V0IG91dHB1dCBv
dGhlciB0aGVuIFN1Y2Nlc3MsIGNoZWNrIHRoZSBhdXRoLiogc3lzbG9nIGZhY2lsaXR5LgpIb3Bl
ZnVsbHkgdGhpcyB3aWxsIGdpdmUgeW91IGVub3VnaCBpbmZvcm1hdGlvbiB0byBtYWtlIGFkanVz
dGVtZW50cyBpbiB0aGUKc3RhcnR1cCBhbmQvb3IgY29uZmlndXJhdGlvbiBmaWxlcy4gIAoKCjQu
IFBBUkFNRVRFUlMKLS0tLS0tLS0tLS0tLQoKVGhlIGZvbGxvd2luZyBhcmUgYXZhaWxhYmxlIGxk
YXAgcGFyYW1ldGVycy4gIFRoZXJlIGFyZSBxdWl0ZSBhIGZldyBvZiB0aG9zZSwKYnV0IG9ubHkg
bGRhcF9zZXJ2ZXJzIG1heSBuZWVkIHRvIGJlIHNwZWNpZmllZC4gVGhlIGRlZmF1bHRzIGZvciBh
bGwgb3RoZXIKcGFyYW1ldGVycyBhcmUgYWRlcXVhdGUgZm9yIG1vc3QgaW5zdGFsbGF0aW9ucy4g
IAoKRG8gbm90IHVzZSBxdW90ZXMgKFwiXCcpIGluIHRoZSBwYXJhbWV0ZXIgdmFsdWVzLiAgVGhl
IGRlZmF1bHRzIGFyZSBzcGVjaWZpZWQKd2l0aGluIHRoZSBmaXJzdCBzZXQgb2YgPD4uICBUaGVy
ZSBtYXkgYmUgYSBzZWNvbmQgc2V0IG9mIDw+IHdoaWNoIHByb3ZpZGUKYXZhaWxhYmxlIHZhbHVl
cy4KCmxkYXBfc2VydmVyczogPGxkYXA6Ly9sb2NhbGhvc3QvPgoJU3BlY2lmeSBVUkkocykgcmVm
ZXJpbmcgdG8gTERBUCBzZXJ2ZXIocyksIGUuZy4gbGRhcHM6Ly8xMC4xLjEuMjo5OTkvLgoJWW91
IGNhbiBzcGVjaWZ5IG11bHRpcGxlIHNlcnZlcnMgc2VwYXJhdGVkIGJ5IGEgc3BhY2UuCgpsZGFw
X2JpbmRfZG46IDxub25lPgoJU3BlY2lmeSBETiAoZGlzdGluZ3Vpc2hlZCBuYW1lKSB0byBiaW5k
IHRvIHRoZSBMREFQIGRpcmVjdG9yeS4gIERvIG5vdAoJc3BlY2lmeSB0aGlzIHBhcmFtZXRlciBm
b3IgdGhlIGFub255bW91cyBiaW5kLgoKbGRhcF9iaW5kX3B3OiA8bm9uZT4KCVNwZWNpZnkgdGhl
IHBhc3N3b3JkIGZvciBsZGFwX2JpbmRfZG4uICBEbyBub3Qgc3BlY2lmeSB0aGlzIHBhcmFtZXRl
cgoJZm9yIHRoZSBhbm9ueW1vdXMgYmluZC4KCmxkYXBfdmVyc2lvbjogPDM+IDwyfDM+CglTcGVj
aWZ5IHRoZSBMREFQIHByb3RvY29sIHZlcnNpb24gdG8gdXNlLgoKbGRhcF90aW1lb3V0OiA8NT4K
CVNwZWNpZnkgYSBudW1iZXIgb2Ygc2Vjb25kcyBhIHNlYXJjaCBjYW4gdGFrZSBiZWZvcmUgdGlt
aW5nIG91dC4KCmxkYXBfdGltZV9saW1pdDogPDU+CglTcGVjaWZ5IGEgbnVtYmVyIG9mIHNlY29u
ZHMgZm9yIGEgc2VhcmNoIHJlcXVlc3QgdG8gY29tcGxldGUuCgpsZGFwX2RlcmVmOiA8bm9uZT4g
PHNlYXJjaHxmaW5kfGFsd2F5c3xuZXZlcj4KCVNwZWNpZnkgaG93IGFsaWFzZXMgZGVyZWZlcmVu
Y2luZyBpcyBoYW5kbGVkIGR1cmluZyBhIHNlYXJjaC4KCmxkYXBfcmVmZXJyYWxzOiA8bm8+CglT
cGVjaWZ5IHdoZXRoZXIgb3Igbm90IHRoZSBjbGllbnQgc2hvdWxkIGZvbGxvdyByZWZlcnJhbHMu
CgpsZGFwX3Jlc3RhcnQ6IDx5ZXM+CglTcGVjaWZ5IHdoZXRoZXIgb3Igbm90IExEQVAgSS9PIG9w
ZXJhdGlvbnMgYXJlIGF1dG9tYXRpY2FsbHkgcmVzdGFydGVkCglpZiB0aGV5IGFib3J0IHByZW1h
dHVyZWx5LgoKbGRhcF9jYWNoZV90dGw6IDwwPgoJTm9uIHplcm8gZW5hYmxlcyBjbGllbnQgc2lk
ZSBjYWNoaW5nLiAgQ2FjaGVkIHJlc3VsdHMgd2lsbCBleHBpcmUgYWZ0ZXIKCXNwZWNpZmllZCBu
dW1iZXIgc2Vjb25kcywgZS5nLiAzMC4gIFVzZSB0aGlzIG9wdGlvbiB3aXRoIGNhcmUuCglPcGVu
TERBUCBmb2xrcyBjb25zaWRlciB0aGlzIGZlYXR1cmUgZXhwZXJpbWVudGFsLgoKbGRhcF9jYWNo
ZV9tZW06IDwwPgoJSWYgY2xpZW50IHNpZGUgY2FjaGluZyBpcyBlbmFibGVkLCB0aGUgdmFsdWUg
c3BlY2lmaWVzIHRoZSBjYWNoZSBzaXplCglpbiBieXRlcywgIGUuZy4gMzI3NjguCgkKbGRhcF9z
Y29wZTogPHN1Yj4gPHN1YnxvbmV8YmFzZT4KCVNlYXJjaCBzY29wZS4KCmxkYXBfc2VhcmNoX2Jh
c2U6IDxub25lPgoJU3BlY2lmeSBhIHN0YXJ0aW5nIHBvaW50IGZvciB0aGUgc2VhcmNoOiBlLmcu
IGRjPWZvbyxkYz1jb20uICBUb2tlbnMKCWRlc2NyaWJlZCBpbiAnbGRhcF9maWx0ZXInIChzZWUg
YmVsb3cpIGNhbiBiZSB1c2VkIGZvciBzdWJzdGl0dXRpb24uCgpsZGFwX2F1dGhfbWV0aG9kOiA8
YmluZD4gPGJpbmR8Y3VzdG9tfGZhc3RiaW5kPgoJU3BlY2lmeSBhbiBhdXRoZW50aWNhdGlvbiBt
ZXRob2QuCgoJVGhlIGJpbmQgbWV0aG9kIHVzZXMgdGhlIExEQVAgc2ltcGxlIGJpbmQgZmFjaWxp
dHkgdG8gdmVyaWZ5IHRoZQoJcGFzc3dvcmQuICBUaGlzIGlzIHRoZSBkZWZhdWx0LgoKCVRoZSBj
dXN0b20gbWV0aG9kIHVzZXMgdXNlclBhc3N3b3JkIGF0dHJpYnV0ZSB0byB2ZXJpZnkgdGhlIHBh
c3N3b3JkLiAgCglTdXBwb3JlZCBoYXNoZXM6IGNyeXB0LCBtZDUsIHNtZDUsIHNoYSBhbmQgc3No
YS4gIENsZWFydGV4dCBpcyBzdXBwb3J0ZWQgCglhcyB3ZWxsLgoKCVRoZSBmYXN0YmluZCBtZXRo
b2QgZG9lcyBhd2F5IHdpdGggdGhlIHNlYXJjaCBhbmQgZXh0cmEgYW5vbnltb3VzIGJpbmQKCWlu
IGF1dGhfYmluZCwgYnV0IG1ha2VzIHR3byBhc3N1bXB0aW9uczoKCSAgMS4gRXhwYW5kaW5nIHRo
ZSBsZGFwX2ZpbHRlciBleHByZXNzaW9uIGdpdmVzIHRoZSBmdWxseS1xdWFsaWZpZWQgRE4KCSAg
Mi4gVGhlcmUgaXMgbm8gY29zdCB0byBzdGF5aW5nIGJvdW5kIGFzIGEgbmFtZWQgdXNlcgoKbGRh
cF9maWx0ZXI6IDx1aWQ9JXU+CglTcGVjaWZ5IGEgZmlsdGVyLiAgVGhlIGZvbGxvd2luZyB0b2tl
bnMgY2FuIGJlIHVzZWQgaW4gdGhlIGZpbHRlciBzdHJpbmc6CgoJJSUgICA9ICUKCSV1ICAgPSB1
c2VyCgklVSAgID0gdXNlciBwb3J0aW9uIG9mICV1ICglVSA9IHRlc3Qgd2hlbiAldSA9IHRlc3RA
ZG9tYWluLnRsZCkKCSVkICAgPSBkb21haW4gcG9ydGlvbiBvZiAldSAoJWQgPSBkb21haW4udGxk
IHdoZW4gJXUgPSB0ZXN0QGRvbWFpbi50bGQpCgklMS05ID0gZG9tYWluIHRva2VucyAoJTEgPSB0
bGQsICUyID0gZG9tYWluIHdoZW4gJWQgPSBkb21haW4udGxkKQoJJXMgICA9IHNlcnZpY2UKCSVy
ICAgPSByZWFsbQoJCglUaGUgJXUgdG9rZW4gaGFzIHRvIGJlIHVzZWQgYXQgbWluaW11bSBmb3Ig
dGhlIGZpbHRlciB0byBiZSB1c2VmdWwuICBJZgoJbGRhcF9hdXRoX21ldGhvZCBpcyAnYmluZCcs
IHRoZSBmaWx0ZXIgd2lsbCBzZWFyY2ggZm9yIHRoZSBETgoJKGRpc3Rpbmd1aXNoZWQgbmFtZSkg
YXR0cmlidXRlLiAgT3RoZXJ3aXNlLCB0aGUgc2VhcmNoIHdpbGwgbG9vayBmb3IKCXRoZSAnbGRh
cF9wYXNzd29yZF9hdHRyJyAoc2VlIGJlbG93KSBhdHRyaWJ1dGUuCgpsZGFwX2dyb3VwX2RuOiA8
bm9uZT4KCVNwZWNpZnkgYSBncm91cCBETi4gSWYgc3BlY2lmaWVkLCB0aGUgdXNlciBETiBoYXMg
dG8gYmUgcGFydCBvZiB0aGUKCWdyb3VwIGluIG9yZGVyIHRvIGF1dGhlbnRpY2F0ZSBzdWNjZXNz
ZnVsbHkuICBUb2tlbnMgZGVzY3JpYmVkIGluCgknbGRhcF9maWx0ZXInIChzZWUgYWJvdmUpIGNh
biBiZSB1c2VkIGZvciBzdWJzdGl0dXRpb24uICBUaGUgdXNlciBETiBpcwoJY29tcGFyZWQgYWdh
aW5zdCB0aGUgJ2xkYXBfZ3JvdXBfYXR0cicgKHNlZSBiZWxvdykgYXR0cmlidXRlIG9mIHRoZQoJ
Z3JvdXAuCgpsZGFwX2dyb3VwX2F0dHI6IDx1bmlxdWVNZW1iZXI+CiAgICAgICAgU3BlY2lmeSB3
aGF0IGF0dHJpYnV0ZSB0byBjb21wYXJlIHRoZSB1c2VyIEROIGFnYWluc3QgaW4gdGhlIGdyb3Vw
LiBJZgogICAgICAgIGxkYXBfZ3JvdXBfZG4gaXMgbm90IHNwZWNpZmllZCwgdGhpcyBwYXJhbWV0
ZXIgaXMgaWdub3JlZC4KIApsZGFwX3Bhc3N3b3JkX2F0dHI6IDx1c2VyUGFzc3dvcmQ+CiAgICAg
ICAgU3BlY2lmeSB3aGF0IHBhc3N3b3JkIGF0dHJpYnV0ZSB0byB1c2UgZm9yIHBhc3N3b3JkIHZl
cmlmaWNhdGlvbi4KIApsZGFwX2RlYnVnOiA8MD4KCVNwZWNpZnkgYSBkZWJ1Z2dpbmcgbGV2ZWwg
aW4gdGhlIE9wZW5MREFQIGxpYnJhcmllcy4gIFNlZQoJbGRhcF9zZXRfb3B0aW9uKDMpIGZvciBt
b3JlIChMREFQX09QVF9ERUJVR19MRVZFTCkuCgpsZGFwX3Rsc19jaGVja19wZWVyOiA8bm8+IDx5
ZXN8bm8+CglSZXF1aXJlIGFuZCB2ZXJpZnkgc2VydmVyIGNlcnRpZmljYXRlLiAgSWYgdGhpcyBv
cHRpb24gaXMgeWVzLAoJeW91IG11c3Qgc3BlY2lmeSBsZGFwX3Rsc19jYWNlcnRfZmlsZSBvciBs
ZGFwX3Rsc19jYWNlcnRfZGlyLgoKbGRhcF90bHNfY2FjZXJ0X2ZpbGU6IDxub25lPgoJRmlsZSBj
b250YWluaW5nIENBIChDZXJ0aWZpY2F0ZSBBdXRob3JpdHkpIGNlcnRpZmljYXRlKHMpLgoKbGRh
cF90bHNfY2FjZXJ0X2RpcjogPG5vbmU+CglQYXRoIHRvIGRpcmVjdG9yeSB3aXRoIENBIChDZXJ0
aWZpY2F0ZSBBdXRob3JpdHkpIGNlcnRpZmljYXRlcy4KCmxkYXBfdGxzX2NpcGhlcnM6IDxERUZB
VUxUPgoJTGlzdCBvZiBTU0wvVExTIGNpcGhlcnMgdG8gYWxsb3cuICBUaGUgZm9ybWF0IG9mIHRo
ZSBzdHJpbmcgaXMKCWRlc2NyaWJlZCBpbiBjaXBoZXJzKDEpLgoKbGRhcF90bHNfY2VydDogPG5v
bmU+CglGaWxlIGNvbnRhaW5pbmcgdGhlIGNsaWVudCBjZXJ0aWZpY2F0ZS4KCmxkYXBfdGxzX2tl
eTogPG5vbmU+CglGaWxlIGNvbnRhaW5pbmcgdGhlIHByaXZhdGUgY2xpZW50IGtleS4KCgo1LiBO
T1RFUwotLS0tLS0tLQoKRm9yIGJldHRlciBwZXJmb3JtYW5jZSBlbnN1cmUgdGhhdCB0aGUgYXR0
cmlidXRlcyBzcGVjaWZpZWQgaW4gbGRhcF9maWx0ZXIgYXJlCmluZGV4ZWQuICBZb3UgY2FuIGFs
c28gZXhwZXJpbWVudCB3aXRoIGNsaWVudCBzaWRlIGNhY2hpbmcuICBUaGlzIGNhbiBiZSBhCnNp
Z25pZmljYW50IHBlcmZvcm1hbmNlIGdhaW4uICBVc2UgY2xpZW50IHNpZGUgY2FjaGluZyB3aXRo
IGNhdXRpb24gYmVjYXVzZSBpdAppcyBzdGlsbCBhbiBleHBlcmltZW50YWwgT3BlbkxEQVAgY2Fs
bC4KClRoZSBmb2xsb3dpbmcgY29uZmlndXJhdGlvbiBzZXR0aW5nIGVuYWJsZXMgY2xpZW50IHNp
ZGUgY2FjaGluZyBhbmQgaXQKc2V0cyB0aGUgY2FjaGUgc2l6ZSB0byAzMms6CgpsZGFwX2NhY2hl
X3R0bDogMzAKbGRhcF9jYWNoZV9tZW06IDMyNzY4CgpNeSB0ZXN0aW5nIHNob3dzIHRoYXQgJ2N1
c3RvbScgaXMgMi0zIHRpbWVzIGZhc3RlciB0aGFuICdiaW5kJwpsZGFwX2F1dGhfbWV0aG9kLiAg
VGhpcyBpcyBjYXVzZWQgYmVjYXVzZSBvZiB0d28gZXh0cmEgYmluZHMgcGVyZm9ybWVkIGR1cmlu
Zwp0aGUgJ2JpbmQnIGF1dGhlbnRpY2F0aW9uIG1ldGhvZC4gIE9uIHRoZSBvdGhlciBoYW5kLCB0
aGUgJ2JpbmQnIGF1dGhlbnRpY2F0aW9uCm1ldGhvZCBpcyBtb3JlIHNlY3VyZSBiZWNhdXNlIGxk
YXBfYmluZF9wdyBpcyBub3QgZXhwb3NlZC4gCgo2LiBUT0RPCi0tLS0tLS0KCi0gUG9ydCB0byBv
dGhlciBsZGFwIGxpYnJhcmllcwotIFRoZXJlIG1heSBiZSBiaW5kIHByb2JsZW1zIHdoZW4gZm9s
bG93aW5nIHJlZmVycmFscy4gIE5vcm1hbGx5IHRoaXMgaXMgbm90IGFuCiAgaXNzdWUuICBGaXgu
Ci0gQWxsb3cgdG8gc3BlY2lmeSBhbiBhdHRyaWJ1dGUgb3RoZXIgdGhhbiB1c2VyUGFzc3dvcmQg
Zm9yIHVzZSBpbiB0aGUgY3VzdG9tCiAgYXV0aGVudGljYXRpb24gbWV0aG9kLiAoRG9uZSkKLSBB
ZGQgbW9yZSBwYXNzd29yZCBoYXNoZXMgc3VjaCBhcyBtZDUsIHNoYSBldGMgKERvbmUpCi0gTWFr
ZSBhIHN1Z2dlc3Rpb24gKHBvc3NpYmx5IGFub3RoZXIgYXV0aGVudGljYXRpb24gbWV0aG9kPykg
KGFkZGVkIGZhc3RiaW5kKQoKCjcuIEZFRURCQUNLCi0tLS0tLS0tLS0tCgpGZWVkYmFjayBpcyBt
dWNoIGFwcHJlY2lhdGVkISAgUGxlYXNlIGRyb3AgbWUgYSBub3RlIGlmIHlvdSBhcmUgc3VjY2Vz
c2Z1bGx5CnVzaW5nIGxkYXAtZW5hYmxlZCBzYXNsYXV0aGQuICBBbnkgY29kZSBpbXByb3ZlbWVu
dHMgYW5kL29yIHN1Z2dlc3Rpb24gYXJlIHdlbGNvbWUuCgpJZiB5b3UgaGF2ZSBxdWVzdGlvbnMs
IHNlbmQgZW1haWwgdG8gY3lydXMtc2FzbEBsaXN0cy5hbmRyZXcuY211LmVkdS4gIFBsZWFzZQpp
bmNsdWRlIHJlbGV2YW50IGluZm9ybWF0aW9uIGFib3V0IHlvdXIgc2FzbGF1dGhkIHNldHVwOiBh
dCBtaW5pbXVtIHByb3ZpZGUKeW91ciBzYXNsYXV0aC5jb25mLCBvdXRwdXQgZnJvbSBzeXNsb2cg
YW5kIHdoaWNoIGRpcmVjdG9yeSBzZXJ2ZXIgeW91J3JlIHVzaW5nLgoKCjguIEFVVEhPUgotLS0t
LS0tLS0KCklnb3IgQnJlemFjIDxpZ29yQGlwYXNzLm5ldD4uCg==
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>115</attachid>
            <date>2003-02-10 16:41 EDT</date>
            <desc>lak.c</desc>
            <filename>lak.c</filename>
            <type>text/plain</type>
            <size>33853</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogQ09QWVJJR0hUCiAqIENvcHlyaWdodCAoYykgMjAwMi0yMDAyIElnb3IgQnJlemFjCiAqIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNl
IGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAogKiBtb2RpZmljYXRpb24sIGFyZSBw
ZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKICogYXJlIG1l
dDoKICogMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBh
Ym92ZSBjb3B5cmlnaHQKICogICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQg
dGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgogKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5
IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAogKiAgICBub3RpY2UsIHRo
aXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhl
CiAqICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRo
IHRoZSBkaXN0cmlidXRpb24uCiAqCiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgSUdP
UiBCUkVaQUMuIGBgQVMgSVMnJyBBTkQgQU5ZCiAqIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5U
SUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFCiAqIElNUExJRUQgV0FSUkFO
VElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUgogKiBQ
VVJQT1NFIEFSRSBESVNDTEFJTUVELiAgSU4gTk8gRVZFTlQgU0hBTEwgSUdPUiBCUkVaQUMgT1IK
ICogSVRTIEVNUExPWUVFUyBPUiBBR0VOVFMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJ
UkVDVCwKICogSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFM
IERBTUFHRVMgKElOQ0xVRElORywKICogQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBP
RiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTCiAqIE9GIFVTRSwgREFUQSwgT1Ig
UFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQKICog
T04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBM
SUFCSUxJVFksIE9SCiAqIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkg
QVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUKICogVVNFIE9GIFRISVMgU09GVFdBUkUsIEVW
RU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSAogKiBEQU1BR0UuCiAqIEVO
RCBDT1BZUklHSFQgKi8KCiNpbmNsdWRlICJtZWNoYW5pc21zLmgiCgojaWZkZWYgQVVUSF9MREFQ
CgojaW5jbHVkZSA8c3lzL3RpbWUuaD4KI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRs
aWIuaD4KI2luY2x1ZGUgPHN0cmluZ3MuaD4KI2luY2x1ZGUgPHN5c2xvZy5oPgojaW5jbHVkZSA8
Y3R5cGUuaD4KCiNpZmRlZiBIQVZFX0NSWVBUX0gKI2luY2x1ZGUgPGNyeXB0Lmg+CiNlbmRpZgoK
I2lmZGVmIEhBVkVfVU5JU1REX0gKI2luY2x1ZGUgPHVuaXN0ZC5oPgojZW5kaWYKCiNpZmRlZiBI
QVZFX09QRU5TU0wKI2luY2x1ZGUgPG9wZW5zc2wvZXZwLmg+CiNlbmRpZgoKI2luY2x1ZGUgPGxk
YXAuaD4KI2luY2x1ZGUgPGxiZXIuaD4KI2luY2x1ZGUgImxhay5oIgoKc3RydWN0IHBhc3N3b3Jk
X3NjaGVtZSB7CgljaGFyICpoYXNoOwoJaW50ICgqY2hlY2spIChjb25zdCBjaGFyICpjcmVkLCBj
b25zdCBjaGFyICpwYXNzd2QsIHZvaWQgKnJvY2spOwoJdm9pZCAqcm9jazsKfTsKCnN0YXRpYyBp
bnQgbGFrX2NvbmZpZ19yZWFkKExBS19DT05GICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQg
bGFrX2NvbmZpZ19pbnQoY29uc3QgY2hhciAqKTsKc3RhdGljIGludCBsYWtfY29uZmlnX3N3aXRj
aChjb25zdCBjaGFyICopOwpzdGF0aWMgdm9pZCBsYWtfY29uZmlnX2ZyZWUoTEFLX0NPTkYgKik7
CnN0YXRpYyBpbnQgbGFrX2NvbmZpZyhjb25zdCBjaGFyICosIExBS19DT05GICoqKTsKc3RhdGlj
IGludCBsYWtfZXNjYXBlKGNvbnN0IGNoYXIgKiwgY29uc3QgdW5zaWduZWQgaW50LCBjaGFyICoq
KTsKc3RhdGljIGludCBsYWtfdG9rZW5pemVfZG9tYWluKGNvbnN0IGNoYXIgKiwgaW50LCBjaGFy
ICoqKTsKc3RhdGljIGludCBsYWtfZXhwYW5kX3Rva2Vucyhjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNoYXIgKiopOwpzdGF0aWMgaW50IGxh
a19jb25uZWN0KExBSyAqKTsKc3RhdGljIGludCBsYWtfYmluZChMQUsgKiwgY2hhciwgY29uc3Qg
Y2hhciAqLCBjb25zdCBjaGFyICopOwpzdGF0aWMgaW50IGxha19zZWFyY2goTEFLICosIGNvbnN0
IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICoqLCBMREFQTWVzc2FnZSAqKik7CnN0
YXRpYyBpbnQgbGFrX2F1dGhfY3VzdG9tKExBSyAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIg
KiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOwpzdGF0aWMgaW50IGxha19hdXRoX2JpbmQo
TEFLICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKik7CnN0YXRpYyBpbnQgbGFrX2F1dGhfZmFzdGJpbmQoTEFLICosIGNvbnN0IGNoYXIgKiwg
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQgbGFr
X2dyb3VwX21lbWJlcihMQUsgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKiwgY29uc3QgY2hhciAqKTsKc3RhdGljIGludCBsYWtfcmVzdWx0X2FkZChMQUsgKmxhaywg
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIExBS19SRVNVTFQgKiopOwpzdGF0aWMgaW50IGxh
a19jaGVja19wYXNzd29yZChjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgdm9pZCAqKTsKc3Rh
dGljIGludCBsYWtfY2hlY2tfY3J5cHQoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIHZvaWQg
Kik7CiNpZmRlZiBIQVZFX09QRU5TU0wKc3RhdGljIGludCBsYWtfYmFzZTY0X2RlY29kZShjb25z
dCBjaGFyICosIGNoYXIgKiosIGludCAqKTsKc3RhdGljIGludCBsYWtfY2hlY2tfaGFzaGVkKGNv
bnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCB2b2lkICopOwojZW5kaWYKCnN0YXRpYyBzdHJ1Y3Qg
aGFzaF9yb2NrIHsKCWNvbnN0IGNoYXIgKm1kYTsKCWludCBzYWx0ZWQ7Cn0gaGFzaF9yb2NrW10g
PSB7Cgl7ICJtZDUiLCAwIH0sCgl7ICJtZDUiLCAxIH0sCgl7ICJzaGExIiwgMCB9LAoJeyAic2hh
MSIsIDEgfQp9OwoKc3RhdGljIGNvbnN0IHN0cnVjdCBwYXNzd29yZF9zY2hlbWUgcGFzc3dvcmRf
c2NoZW1lW10gPSB7Cgl7ICJ7Q1JZUFR9IiwgbGFrX2NoZWNrX2NyeXB0LCBOVUxMIH0sCgl7ICJ7
VU5JWH0iLCBsYWtfY2hlY2tfY3J5cHQsIE5VTEwgfSwKI2lmZGVmIEhBVkVfT1BFTlNTTAoJeyAi
e01ENX0iLCBsYWtfY2hlY2tfaGFzaGVkLCAmaGFzaF9yb2NrWzBdIH0sCgl7ICJ7U01ENX0iLCBs
YWtfY2hlY2tfaGFzaGVkLCAmaGFzaF9yb2NrWzFdIH0sCgl7ICJ7U0hBfSIsIGxha19jaGVja19o
YXNoZWQsICZoYXNoX3JvY2tbMl0gfSwKCXsgIntTU0hBfSIsIGxha19jaGVja19oYXNoZWQsICZo
YXNoX3JvY2tbM10gfSwKI2VuZGlmCgl7IE5VTEwsIE5VTEwgfQp9OwoKc3RhdGljIGludCBsYWtf
Y29uZmlnX3JlYWQoTEFLX0NPTkYgKmNvbmYsIGNvbnN0IGNoYXIgKmNvbmZpZ2ZpbGUpCnsKCUZJ
TEUgKmluZmlsZTsKCWludCBsaW5lbm8gPSAwOwoJY2hhciBidWZbNDA5Nl07CgljaGFyICpwLCAq
a2V5OwoKCWluZmlsZSA9IGZvcGVuKGNvbmZpZ2ZpbGUsICJyIik7CglpZiAoIWluZmlsZSkgewoJ
ICAgIHN5c2xvZyhMT0dfRVJSfExPR19BVVRILAoJCSAgICJDb3VsZCBub3Qgb3BlbiBzYXNsYXV0
aGQgY29uZmlnIGZpbGU6ICVzICglbSkiLAoJCSAgIGNvbmZpZ2ZpbGUpOwoJICAgIHJldHVybiBM
QUtfRkFJTDsKCX0KICAgIAoJd2hpbGUgKGZnZXRzKGJ1Ziwgc2l6ZW9mKGJ1ZiksIGluZmlsZSkp
IHsKCQlsaW5lbm8rKzsKCgkJaWYgKGJ1ZltzdHJsZW4oYnVmKS0xXSA9PSAnXG4nKSAKCQkJYnVm
W3N0cmxlbihidWYpLTFdID0gJ1wwJzsKCQlmb3IgKHAgPSBidWY7ICpwICYmIGlzc3BhY2UoKGlu
dCkgKnApOyBwKyspOwoJCQlpZiAoISpwIHx8ICpwID09ICcjJykgCgkJCQljb250aW51ZTsKCgkJ
a2V5ID0gcDsKCQl3aGlsZSAoKnAgJiYgKGlzYWxudW0oKGludCkgKnApIHx8ICpwID09ICctJyB8
fCAqcCA9PSAnXycpKSB7CgkJCWlmIChpc3VwcGVyKChpbnQpICpwKSkgCgkJCQkqcCA9IHRvbG93
ZXIoKnApOwoJCQlwKys7CgkJfQoJCWlmICgqcCAhPSAnOicpIHsKCQkJcmV0dXJuIExBS19GQUlM
OwoJCX0KCQkqcCsrID0gJ1wwJzsKCgkJd2hpbGUgKCpwICYmIGlzc3BhY2UoKGludCkgKnApKSAK
CQkJcCsrOwoKCQlpZiAoISpwKSB7CgkJCXJldHVybiBMQUtfRkFJTDsKCQl9CgoJCWlmICghc3Ry
Y2FzZWNtcChrZXksICJsZGFwX3NlcnZlcnMiKSkgewoJCQlpZiAoY29uZi0+c2VydmVycykgZnJl
ZShjb25mLT5zZXJ2ZXJzKTsKCQkJY29uZi0+c2VydmVycyA9IHN0cmR1cChwKTsKCQkJaWYgKGNv
bmYtPnNlcnZlcnMgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFL
X05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX2JpbmRfZG4i
KSkgewoJCQlpZiAoY29uZi0+YmluZF9kbikgZnJlZShjb25mLT5iaW5kX2RuKTsKCQkJY29uZi0+
YmluZF9kbiA9IHN0cmR1cChwKTsKCQkJaWYgKGNvbmYtPmJpbmRfZG4gPT0gTlVMTCkgewoJCQkJ
ZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFLX05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICgh
c3RyY2FzZWNtcChrZXksICJsZGFwX2JpbmRfcHciKSkgewoJCQlpZiAoY29uZi0+YmluZF9wdykg
ZnJlZShjb25mLT5iaW5kX3B3KTsKCQkJY29uZi0+YmluZF9wdyA9IHN0cmR1cChwKTsKCQkJaWYg
KGNvbmYtPmJpbmRfcHcgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4g
TEFLX05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3ZlcnNp
b24iKSkgewoJCQljb25mLT52ZXJzaW9uID0gbGFrX2NvbmZpZ19pbnQocCk7CgkJfSBlbHNlIGlm
ICghc3RyY2FzZWNtcChrZXksICJsZGFwX3NlYXJjaF9iYXNlIikpIHsKCQkJaWYgKGNvbmYtPnNl
YXJjaF9iYXNlKSBmcmVlKGNvbmYtPnNlYXJjaF9iYXNlKTsKCQkJY29uZi0+c2VhcmNoX2Jhc2Ug
PSBzdHJkdXAocCk7CgkJCWlmIChjb25mLT5zZWFyY2hfYmFzZSA9PSBOVUxMKSB7CgkJCQlmY2xv
c2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJj
YXNlY21wKGtleSwgImxkYXBfZmlsdGVyIikpIHsKCQkJaWYgKGNvbmYtPmZpbHRlcikgZnJlZShj
b25mLT5maWx0ZXIpOwoJCQljb25mLT5maWx0ZXIgPSBzdHJkdXAocCk7CgkJCWlmIChjb25mLT5m
aWx0ZXIgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFLX05PTUVN
OwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX2dyb3VwX2RuIikpIHsK
CQkJaWYgKGNvbmYtPmdyb3VwX2RuKSBmcmVlKGNvbmYtPmdyb3VwX2RuKTsKCQkJY29uZi0+Z3Jv
dXBfZG4gPSBzdHJkdXAocCk7CgkJCWlmIChjb25mLT5ncm91cF9kbiA9PSBOVUxMKSB7CgkJCQlm
Y2xvc2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFz
dHJjYXNlY21wKGtleSwgImxkYXBfZ3JvdXBfYXR0ciIpKSB7CgkJCWlmIChjb25mLT5ncm91cF9h
dHRyKSBmcmVlKGNvbmYtPmdyb3VwX2F0dHIpOwoJCQljb25mLT5ncm91cF9hdHRyID0gc3RyZHVw
KHApOwoJCQlpZiAoY29uZi0+Z3JvdXBfYXR0ciA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5maWxl
KTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtl
eSwgImxkYXBfcGFzc3dvcmRfYXR0ciIpKSB7CgkJCWlmIChjb25mLT5wYXNzd29yZF9hdHRyKSBm
cmVlKGNvbmYtPnBhc3N3b3JkX2F0dHIpOwoJCQljb25mLT5wYXNzd29yZF9hdHRyID0gc3RyZHVw
KHApOwoJCQlpZiAoY29uZi0+cGFzc3dvcmRfYXR0ciA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5m
aWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21w
KGtleSwgImxkYXBfYXV0aF9tZXRob2QiKSkgewoJCQlpZiAoIXN0cmNhc2VjbXAocCwgImN1c3Rv
bSIpKSB7CgkJCQljb25mLT5hdXRoX21ldGhvZCA9IExBS19BVVRIX01FVEhPRF9DVVNUT007CgkJ
CX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAocCwgImZhc3RiaW5kIikpIHsKCQkJCWNvbmYtPmF1dGhf
bWV0aG9kID0gTEFLX0FVVEhfTUVUSE9EX0ZBU1RCSU5EOwoJCQl9CgkJfSBlbHNlIGlmICghc3Ry
Y2FzZWNtcChrZXksICJsZGFwX3RpbWVvdXQiKSkgewoJCQljb25mLT50aW1lb3V0LnR2X3NlYyA9
IGxha19jb25maWdfaW50KHApOwoJCQljb25mLT50aW1lb3V0LnR2X3VzZWMgPSAwOwoJCX0gZWxz
ZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9zaXplX2xpbWl0IikpIHsKCQkJY29uZi0+c2l6
ZV9saW1pdCA9IGxha19jb25maWdfaW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5
LCAibGRhcF90aW1lX2xpbWl0IikpIHsKCQkJY29uZi0+dGltZV9saW1pdCA9IGxha19jb25maWdf
aW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9kZXJlZiIpKSB7CgkJ
CWlmICghc3RyY2FzZWNtcChwLCAic2VhcmNoIikpIHsKCQkJCWNvbmYtPmRlcmVmID0gTERBUF9E
RVJFRl9TRUFSQ0hJTkc7CgkJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAocCwgImZpbmQiKSkgewoJ
CQkJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVGX0ZJTkRJTkc7CgkJCX0gZWxzZSBpZiAoIXN0cmNh
c2VjbXAocCwgImFsd2F5cyIpKSB7CgkJCQljb25mLT5kZXJlZiA9IExEQVBfREVSRUZfQUxXQVlT
OwoJCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKHAsICJuZXZlciIpKSB7CgkJCQljb25mLT5kZXJl
ZiA9IExEQVBfREVSRUZfTkVWRVI7CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwg
ImxkYXBfcmVmZXJyYWxzIikpIHsKCQkJY29uZi0+cmVmZXJyYWxzID0gbGFrX2NvbmZpZ19zd2l0
Y2gocCk7CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Jlc3RhcnQiKSkgewoJ
CQljb25mLT5yZXN0YXJ0ID0gbGFrX2NvbmZpZ19zd2l0Y2gocCk7CgkJfSBlbHNlIGlmICghc3Ry
Y2FzZWNtcChrZXksICJsZGFwX2NhY2hlX3R0bCIpKSB7CgkJCWNvbmYtPmNhY2hlX3R0bCA9IGxh
a19jb25maWdfaW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9jYWNo
ZV9tZW0iKSkgewoJCQljb25mLT5jYWNoZV9tZW0gPSBsYWtfY29uZmlnX2ludChwKTsKCQl9IGVs
c2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBfc2NvcGUiKSkgewoJCQlpZiAoIXN0cmNhc2Vj
bXAocCwgIm9uZSIpKSB7CgkJCQljb25mLT5zY29wZSA9IExEQVBfU0NPUEVfT05FTEVWRUw7CgkJ
CX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAocCwgImJhc2UiKSkgewoJCQkJY29uZi0+c2NvcGUgPSBM
REFQX1NDT1BFX0JBU0U7CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBf
dGxzX2NoZWNrX3BlZXIiKSkgewoJCQljb25mLT50bHNfY2hlY2tfcGVlciA9IGxha19jb25maWdf
c3dpdGNoKHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF90bHNfY2FjZXJ0
X2ZpbGUiKSkgewoJCQlpZiAoY29uZi0+dGxzX2NhY2VydF9maWxlKSBmcmVlKGNvbmYtPnRsc19j
YWNlcnRfZmlsZSk7CgkJCWNvbmYtPnRsc19jYWNlcnRfZmlsZSA9IHN0cmR1cChwKTsKCQkJaWYg
KGNvbmYtPnRsc19jYWNlcnRfZmlsZSA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5maWxlKTsKCQkJ
CXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxk
YXBfdGxzX2NhY2VydF9kaXIiKSkgewoJCQlpZiAoY29uZi0+dGxzX2NhY2VydF9kaXIpIGZyZWUo
Y29uZi0+dGxzX2NhY2VydF9kaXIpOwoJCQljb25mLT50bHNfY2FjZXJ0X2RpciA9IHN0cmR1cChw
KTsKCQkJaWYgKGNvbmYtPnRsc19jYWNlcnRfZGlyID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZp
bGUpOwoJCQkJcmV0dXJuIExBS19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAo
a2V5LCAibGRhcF90bHNfY2lwaGVycyIpKSB7CgkJCWlmIChjb25mLT50bHNfY2lwaGVycykgZnJl
ZShjb25mLT50bHNfY2lwaGVycyk7CgkJCWNvbmYtPnRsc19jaXBoZXJzID0gc3RyZHVwKHApOwoJ
CQlpZiAoY29uZi0+dGxzX2NpcGhlcnMgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJ
CQlyZXR1cm4gTEFLX05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJs
ZGFwX3Rsc19jZXJ0IikpIHsKCQkJaWYgKGNvbmYtPnRsc19jZXJ0KSBmcmVlKGNvbmYtPnRsc19j
ZXJ0KTsKCQkJY29uZi0+dGxzX2NlcnQgPSBzdHJkdXAocCk7CgkJCWlmIChjb25mLT50bHNfY2Vy
dCA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJ
CX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBfdGxzX2tleSIpKSB7CgkJCWlm
IChjb25mLT50bHNfa2V5KSBmcmVlKGNvbmYtPnRsc19rZXkpOwoJCQljb25mLT50bHNfa2V5ID0g
c3RyZHVwKHApOwoJCQlpZiAoY29uZi0+dGxzX2tleSA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5m
aWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21w
KGtleSwgImxkYXBfZGVidWciKSkgewoJCQljb25mLT5kZWJ1ZyA9IGxha19jb25maWdfaW50KHAp
OwoJCX0KCX0KCglmY2xvc2UoaW5maWxlKTsKCglyZXR1cm4gTEFLX09LOwp9CgpzdGF0aWMgaW50
IGxha19jb25maWdfaW50KGNvbnN0IGNoYXIgKnZhbCkKewogICAgaWYgKCF2YWwpIHJldHVybiAw
OwoKICAgIGlmICghaXNkaWdpdCgoaW50KSAqdmFsKSAmJiAoKnZhbCAhPSAnLScgfHwgIWlzZGln
aXQoKGludCkgdmFsWzFdKSkpIHJldHVybiAwOwoKICAgIHJldHVybiBhdG9pKHZhbCk7Cn0KCnN0
YXRpYyBpbnQgbGFrX2NvbmZpZ19zd2l0Y2goY29uc3QgY2hhciAqdmFsKQp7CiAgICBpZiAoIXZh
bCkgcmV0dXJuIDA7CiAgICAKICAgIGlmICgqdmFsID09ICcwJyB8fCAqdmFsID09ICduJyB8fAoJ
KCp2YWwgPT0gJ28nICYmIHZhbFsxXSA9PSAnZicpIHx8ICp2YWwgPT0gJ2YnKSB7CglyZXR1cm4g
MDsKICAgIH0gZWxzZSBpZiAoKnZhbCA9PSAnMScgfHwgKnZhbCA9PSAneScgfHwKCSAgICAgKCp2
YWwgPT0gJ28nICYmIHZhbFsxXSA9PSAnbicpIHx8ICp2YWwgPT0gJ3QnKSB7CglyZXR1cm4gMTsK
ICAgIH0KICAgIHJldHVybiAwOwp9CgpzdGF0aWMgdm9pZCBsYWtfY29uZmlnX2ZyZWUoTEFLX0NP
TkYgKmNvbmYpIAp7CglpZiAoY29uZiA9PSBOVUxMKSB7CgkJcmV0dXJuOwoJfQoKCWlmIChjb25m
LT5zZXJ2ZXJzICE9IE5VTEwpIHsKCQltZW1zZXQoY29uZi0+c2VydmVycywgMCwgc3RybGVuKGNv
bmYtPnNlcnZlcnMpKTsKCQlmcmVlKGNvbmYtPnNlcnZlcnMpOwoJfQoJaWYgKGNvbmYtPmJpbmRf
ZG4gIT0gTlVMTCkgewoJCW1lbXNldChjb25mLT5iaW5kX2RuLCAwLCBzdHJsZW4oY29uZi0+Ymlu
ZF9kbikpOwoJCWZyZWUoY29uZi0+YmluZF9kbik7Cgl9CglpZiAoY29uZi0+YmluZF9wdyAhPSBO
VUxMKSB7CgkJbWVtc2V0KGNvbmYtPmJpbmRfcHcsIDAsIHN0cmxlbihjb25mLT5iaW5kX3B3KSk7
CgkJZnJlZShjb25mLT5iaW5kX3B3KTsKCX0KCWlmIChjb25mLT5zZWFyY2hfYmFzZSAhPSBOVUxM
KQoJCWZyZWUoY29uZi0+c2VhcmNoX2Jhc2UpOwoJaWYgKGNvbmYtPmZpbHRlciAhPSBOVUxMKQoJ
CWZyZWUoY29uZi0+ZmlsdGVyKTsKCWlmIChjb25mLT5ncm91cF9kbiAhPSBOVUxMKQoJCWZyZWUo
Y29uZi0+Z3JvdXBfZG4pOwoJaWYgKGNvbmYtPmdyb3VwX2F0dHIgIT0gTlVMTCkKCQlmcmVlKGNv
bmYtPmdyb3VwX2F0dHIpOwoJaWYgKGNvbmYtPnBhc3N3b3JkX2F0dHIgIT0gTlVMTCkKCQlmcmVl
KGNvbmYtPnBhc3N3b3JkX2F0dHIpOwoJaWYgKGNvbmYtPnRsc19jYWNlcnRfZmlsZSAhPSBOVUxM
KQoJCWZyZWUoY29uZi0+dGxzX2NhY2VydF9maWxlKTsKCWlmIChjb25mLT50bHNfY2FjZXJ0X2Rp
ciAhPSBOVUxMKQoJCWZyZWUoY29uZi0+dGxzX2NhY2VydF9kaXIpOwoJaWYgKGNvbmYtPnRsc19j
aXBoZXJzICE9IE5VTEwpCgkJZnJlZShjb25mLT50bHNfY2lwaGVycyk7CglpZiAoY29uZi0+dGxz
X2NlcnQgIT0gTlVMTCkKCQlmcmVlKGNvbmYtPnRsc19jZXJ0KTsKCWlmIChjb25mLT50bHNfa2V5
ICE9IE5VTEwpCgkJZnJlZShjb25mLT50bHNfa2V5KTsKCWlmIChjb25mLT5wYXRoICE9IE5VTEwp
CgkJZnJlZShjb25mLT5wYXRoKTsKCglmcmVlIChjb25mKTsKCglyZXR1cm47Cn0KCnN0YXRpYyBp
bnQgbGFrX2NvbmZpZyhjb25zdCBjaGFyICpjb25maWdmaWxlLCBMQUtfQ09ORiAqKnJldCkKewoJ
TEFLX0NPTkYgKmNvbmY7CglpbnQgcmMgPSAwOwoKCWNvbmYgPSBtYWxsb2MoIHNpemVvZihMQUtf
Q09ORikgKTsKCWlmIChjb25mID09IE5VTEwpIHsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoKCW1l
bXNldChjb25mLCAwLCBzaXplb2YoTEFLX0NPTkYpKTsKCgljb25mLT5zZXJ2ZXJzID0gc3RyZHVw
KCJsZGFwOi8vbG9jYWxob3N0LyIpOwoJY29uZi0+YmluZF9kbiA9IHN0cmR1cCgiIik7Cgljb25m
LT5iaW5kX3B3ID0gc3RyZHVwKCIiKTsKCWNvbmYtPnZlcnNpb24gPSBMREFQX1ZFUlNJT04zOwoJ
Y29uZi0+c2VhcmNoX2Jhc2UgPSBzdHJkdXAoIiIpOwoJY29uZi0+ZmlsdGVyID0gc3RyZHVwKCIo
dWlkPSV1KSIpOwoJY29uZi0+Z3JvdXBfZG4gPSBOVUxMOwoJY29uZi0+Z3JvdXBfYXR0ciA9IHN0
cmR1cCgidW5pcXVlTWVtYmVyIik7Cgljb25mLT5wYXNzd29yZF9hdHRyID0gc3RyZHVwKCJ1c2Vy
UGFzc3dvcmQiKTsKCWNvbmYtPmF1dGhfbWV0aG9kID0gTEFLX0FVVEhfTUVUSE9EX0JJTkQ7Cglj
b25mLT50aW1lb3V0LnR2X3NlYyA9IDU7Cgljb25mLT50aW1lb3V0LnR2X3VzZWMgPSAwOwoJY29u
Zi0+c2l6ZV9saW1pdCA9IDE7Cgljb25mLT50aW1lX2xpbWl0ID0gNTsKCWNvbmYtPmRlcmVmID0g
TERBUF9ERVJFRl9ORVZFUjsKCWNvbmYtPnJlc3RhcnQgPSAxOwoJY29uZi0+c2NvcGUgPSBMREFQ
X1NDT1BFX1NVQlRSRUU7CgoJY29uZi0+cGF0aCA9IHN0cmR1cChjb25maWdmaWxlKTsKCWlmIChj
b25mLT5wYXRoID09IE5VTEwpIHsKCQlsYWtfY29uZmlnX2ZyZWUoY29uZik7CgkJcmV0dXJuIExB
S19OT01FTTsKCX0KCglyYyA9IGxha19jb25maWdfcmVhZChjb25mLCBjb25mLT5wYXRoKTsKCWlm
IChyYyAhPSBMQUtfT0spIHsKCQlsYWtfY29uZmlnX2ZyZWUoY29uZik7CgkJcmV0dXJuIHJjOwoJ
fQoKCSpyZXQgPSBjb25mOwoJcmV0dXJuIExBS19PSzsKfQoKLyoKICogTm90ZTogY2FsbGluZyBm
dW5jdGlvbiBtdXN0IGZyZWUgbWVtb3J5LgogKi8Kc3RhdGljIGludCBsYWtfZXNjYXBlKGNvbnN0
IGNoYXIgKnMsIGNvbnN0IHVuc2lnbmVkIGludCBuLCBjaGFyICoqcmVzdWx0KSAKewoJY2hhciAq
YnVmOwoJY2hhciAqZW5kLCAqcHRyLCAqdGVtcDsKCglpZiAobiA+IHN0cmxlbihzKSkgIC8vIFNh
bml0eSBjaGVjaywganVzdCBpbiBjYXNlCgkJcmV0dXJuIExBS19GQUlMOwoKCWJ1ZiA9IG1hbGxv
YyhuICogNSArIDEpOwoJaWYgKGJ1ZiA9PSBOVUxMKSB7CgkJcmV0dXJuIExBS19OT01FTTsKCX0K
CglidWZbMF0gPSAnXDAnOwoJcHRyID0gKGNoYXIgKilzOwoJZW5kID0gcHRyICsgbjsKCgl3aGls
ZSAoKCh0ZW1wID0gc3RycGJyayhwdHIsICIqKClcXFwwIikpIT1OVUxMKSAmJiAodGVtcDxlbmQp
KSB7CgoJCWlmICh0ZW1wPnB0cikKCQkJc3RybmNhdChidWYsIHB0ciwgdGVtcC1wdHIpOwoKCQlz
d2l0Y2ggKCp0ZW1wKSB7CgkJCWNhc2UgJyonOgoJCQkJc3RyY2F0KGJ1ZiwgIlxcMmEiKTsKCQkJ
CWJyZWFrOwoJCQljYXNlICcoJzoKCQkJCXN0cmNhdChidWYsICJcXDI4Iik7CgkJCQlicmVhazsK
CQkJY2FzZSAnKSc6CgkJCQlzdHJjYXQoYnVmLCAiXFwyOSIpOwoJCQkJYnJlYWs7CgkJCWNhc2Ug
J1xcJzoKCQkJCXN0cmNhdChidWYsICJcXDVjIik7CgkJCQlicmVhazsKCQkJY2FzZSAnXDAnOgoJ
CQkJc3RyY2F0KGJ1ZiwgIlxcMDAiKTsKCQkJCWJyZWFrOwoJCX0KCQlwdHI9dGVtcCsxOwoJfQoJ
aWYgKHB0cjxlbmQpCgkJc3RybmNhdChidWYsIHB0ciwgZW5kLXB0cik7CgoJKnJlc3VsdCA9IGJ1
ZjsKCglyZXR1cm4gTEFLX09LOwp9CgpzdGF0aWMgaW50IGxha190b2tlbml6ZV9kb21haW5zKGNv
bnN0IGNoYXIgKmQsIGludCBuLCBjaGFyICoqcmVzdWx0KQp7CgljaGFyICpzLCAqczE7CgljaGFy
ICpsYXN0czsKCWludCBudCwgaTsKCgkqcmVzdWx0ID0gTlVMTDsKCglpZiAoZCA9PSBOVUxMIHx8
IChuIDwgMSAmJiBuID4gOSkpCgkJcmV0dXJuIExBS19GQUlMOwoKCXMgPSBzdHJkdXAoZCk7Cglp
ZiAocyA9PSBOVUxMKQoJCXJldHVybiBMQUtfTk9NRU07CgoJZm9yKCBudD0wLCBzMT1zOyAqczE7
IHMxKysgKQoJCWlmKCAqczEgPT0gJy4nICkgbnQrKzsKCW50Kys7CgoJaWYgKG4gPiBudCkgewoJ
CWZyZWUocyk7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWkgPSBudCAtIG47CglzMSA9IChjaGFy
ICopc3RydG9rX3IocywgIi4iLCAmbGFzdHMpOwoJd2hpbGUoczEpIHsKCQlpZiAoaSA9PSAwKSB7
CgkJCSpyZXN1bHQgPSBzdHJkdXAoczEpOwoJCQlmcmVlKHMpOwoJCQlyZXR1cm4gKCpyZXN1bHQg
PT0gTlVMTCA/IExBS19OT01FTSA6IExBS19PSyk7CgkJfQoJCXMxID0gKGNoYXIgKilzdHJ0b2tf
cihOVUxMLCAiLiIsICZsYXN0cyk7CgkJaS0tOwoJfQoKCWZyZWUocyk7CglyZXR1cm4gTEFLX0ZB
SUw7Cn0KCiNkZWZpbmUgTUFYKGEsYixjKSAoYT5iPyhhPmM/YTpjKTooYj5jP2I6YykpCgovKgog
KiBsYWtfZXhhcGRuX3Rva2VucwogKiBQYXJ0cyB3aXRoIHRoZSBzdHJpbmdzIHByb3ZpZGVkLgog
KiAgICUlICAgPSAlCiAqICAgJXUgICA9IHVzZXIKICogICAlVSAgID0gdXNlciBwYXJ0IG9mICV1
CiAqICAgJWQgICA9IGRvbWFpbiBwYXJ0IG9mICV1IGlmIGF2YWlsYWJsZQogKiAgICUxLTkgPSBk
b21haW4gdG9rZW5zICglMSA9IHRsZCwgJTIgPSBkb21haW4gd2hlbiAlZCA9IGRvbWFpbi50bGQp
CiAqICAgJXMgICA9IHNlcnZpY2UKICogICAlciAgID0gcmVhbG0KICogTm90ZTogY2FsbGluZyBm
dW5jdGlvbiBtdXN0IGZyZWUgbWVtb3J5LgogKi8Kc3RhdGljIGludCBsYWtfZXhwYW5kX3Rva2Vu
cyhjb25zdCBjaGFyICpwYXR0ZXJuLCBjb25zdCBjaGFyICp1c2VybmFtZSwgY29uc3QgY2hhciAq
c2VydmljZSwgY29uc3QgY2hhciAqcmVhbG0sIGNoYXIgKipyZXN1bHQpIAp7CgljaGFyICpidWY7
IAoJY2hhciAqZW5kLCAqcHRyLCAqdGVtcDsKCWNoYXIgKmVidWYsICp1c2VyOwoJY2hhciAqZG9t
YWluOwoJaW50IHJjOwoKCS8qIHRvIHBlcm1pdCBtdWx0aXBsZSBvY2N1cmVuY2VzIG9mIHVzZXJu
YW1lIGFuZC9vciByZWFsbSBpbiBmaWx0ZXIgKi8KCS8qIGFuZCBhdm9pZCBtZW1vcnkgb3ZlcmZs
b3cgaW4gZmlsdGVyIGJ1aWxkIFtlZzogKHwodWlkPSV1KSh1c2VyaWQ9JXUpKSBdICovCglpbnQg
cGVyY2VudHMsIHNlcnZpY2VfbGVuLCByZWFsbV9sZW4sIHVzZXJfbGVuLCBtYXhwYXJhbWxlbmd0
aDsKCQoJaWYgKHBhdHRlcm4gPT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVU
SCwgImZpbHRlciBwYXR0ZXJuIG5vdCBzZXR1cCIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCgkv
KiBmaW5kIHRoZSBsb25nZXN0IHBhcmFtIG9mIHVzZXJuYW1lIGFuZCByZWFsbSwgCgkgICBkbyBu
b3Qgd29ycnkgYWJvdXQgZG9tYWluIGJlY2F1c2UgaXQgaXMgYWx3YXlzIHNob3J0ZXIgCgkgICB0
aGVuIHVzZXJuYW1lICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICov
Cgl1c2VyX2xlbj1zdHJsZW4odXNlcm5hbWUpOwoJc2VydmljZV9sZW49c3RybGVuKHNlcnZpY2Up
OwoJcmVhbG1fbGVuPXN0cmxlbihyZWFsbSk7CgoJbWF4cGFyYW1sZW5ndGggPSBNQVgodXNlcl9s
ZW4sIHNlcnZpY2VfbGVuLCByZWFsbV9sZW4pOwoKCS8qIGZpbmQgdGhlIG51bWJlciBvZiBvY2N1
cmVuY2VzIG9mIHBlcmNlbnQgc2lnbiBpbiBmaWx0ZXIgKi8KCWZvciggcGVyY2VudHM9MCwgYnVm
PShjaGFyICopcGF0dGVybjsgKmJ1ZjsgYnVmKysgKSB7CgkJaWYoICpidWYgPT0gJyUnICkgcGVy
Y2VudHMrKzsKCX0KCgkvKiBwZXJjZW50cyAqIDMgKiBtYXhwYXJhbWxlbmd0aCBiZWNhdXNlIHdl
IG5lZWQgdG8gYWNjb3VudCBmb3IKICAgICAgICAgKiBhbiBlbnRpcmVseS1lc2NhcGVkIHdvcnN0
LWNhc2UtbGVuZ3RoIHBhcmFtZXRlciAqLwoJYnVmPW1hbGxvYyhzdHJsZW4ocGF0dGVybikgKyAo
cGVyY2VudHMgKiAzICogbWF4cGFyYW1sZW5ndGgpICsxKTsKCWlmKGJ1ZiA9PSBOVUxMKSB7CgkJ
c3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICJDYW5ub3QgYWxsb2NhdGUgbWVtb3J5Iik7CgkJcmV0
dXJuIExBS19OT01FTTsKCX0KCWJ1ZlswXSA9ICdcMCc7CgkKCXB0ciA9IChjaGFyICopcGF0dGVy
bjsKCWVuZCA9IHB0ciArIHN0cmxlbihwdHIpOwoKCXdoaWxlICgodGVtcD1zdHJjaHIocHRyLCcl
JykpIT1OVUxMICkgewoKCQlpZiAoKHRlbXAtcHRyKSA+IDApCgkJCXN0cm5jYXQoYnVmLCBwdHIs
IHRlbXAtcHRyKTsKCgkJaWYgKCh0ZW1wKzEpID49IGVuZCkgewoJCQlzeXNsb2coTE9HX1dBUk5J
Tkd8TE9HX0FVVEgsICJJbmNvbXBsZXRlIGxvb2t1cCBzdWJzdGl0dXRpb24gZm9ybWF0Iik7CgkJ
CWJyZWFrOwoJCX0KCgkJc3dpdGNoICgqKHRlbXArMSkpIHsKCQkJY2FzZSAnJSc6CgkJCQlzdHJu
Y2F0KGJ1Zix0ZW1wKzEsMSk7CgkJCQlicmVhazsKCQkJY2FzZSAndSc6CgkJCQlpZiAodXNlcm5h
bWUhPU5VTEwpIHsKCQkJCQlyYz1sYWtfZXNjYXBlKHVzZXJuYW1lLCBzdHJsZW4odXNlcm5hbWUp
LCAmZWJ1Zik7CgkJCQkJaWYgKHJjID09IExBS19PSykgewoJCQkJCQlzdHJjYXQoYnVmLGVidWYp
OwoJCQkJCQlmcmVlKGVidWYpOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJc3lzbG9nKExPR19X
QVJOSU5HfExPR19BVVRILCAiVXNlcm5hbWUgbm90IGF2YWlsYWJsZS4iKTsKCQkJCX0KCQkJCWJy
ZWFrOwoJCQljYXNlICdVJzoKCQkJCWlmICh1c2VybmFtZSE9TlVMTCkgewoJCQkJCQoJCQkJCXVz
ZXIgPSBzdHJjaHIodXNlcm5hbWUsICdAJyk7CgkJCQkJcmM9bGFrX2VzY2FwZSh1c2VybmFtZSwg
KHVzZXIgPyB1c2VyIC0gdXNlcm5hbWUgOiBzdHJsZW4odXNlcm5hbWUpKSwgJmVidWYpOwoJCQkJ
CWlmIChyYyA9PSBMQUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShl
YnVmKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVU
SCwgIlVzZXJuYW1lIG5vdCBhdmFpbGFibGUuIik7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAn
ZCc6CgkJCQlpZiAodXNlcm5hbWUhPU5VTEwgJiYgKGRvbWFpbiA9IHN0cmNocih1c2VybmFtZSwg
J0AnKSkgJiYgZG9tYWluWzFdIT0nXDAnKSB7CgkJCQkJcmM9bGFrX2VzY2FwZShkb21haW4rMSwg
c3RybGVuKGRvbWFpbisxKSwgJmVidWYpOwoJCQkJCWlmIChyYyA9PSBMQUtfT0spIHsKCQkJCQkJ
c3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShlYnVmKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJ
CQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIkRvbWFpbiBub3QgYXZhaWxhYmxlLiIp
OwoJCQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgJzEnOgoJCQljYXNlICcyJzoKCQkJY2FzZSAnMyc6
CgkJCWNhc2UgJzQnOgoJCQljYXNlICc1JzoKCQkJY2FzZSAnNic6CgkJCWNhc2UgJzcnOgoJCQlj
YXNlICc4JzoKCQkJY2FzZSAnOSc6CgkJCQlpZiAodXNlcm5hbWUhPU5VTEwgJiYgKGRvbWFpbiA9
IHN0cmNocih1c2VybmFtZSwgJ0AnKSkgJiYgZG9tYWluWzFdIT0nXDAnKSB7CgkJCQkJcmM9bGFr
X3Rva2VuaXplX2RvbWFpbnMoZG9tYWluKzEsIChpbnQpICoodGVtcCsxKS00OCwgJmVidWYpOwoJ
CQkJCWlmIChyYyA9PSBMQUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJl
ZShlYnVmKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0df
QVVUSCwgIkRvbWFpbiB0b2tlbnMgbm90IGF2YWlsYWJsZS4iKTsKCQkJCX0KCQkJCWJyZWFrOwoJ
CQljYXNlICdyJzoKCQkJCWlmIChyZWFsbSE9TlVMTCkgewoJCQkJCXJjID0gbGFrX2VzY2FwZShy
ZWFsbSwgc3RybGVuKHJlYWxtKSwgJmVidWYpOwoJCQkJCWlmIChyYyA9PSBMQUtfT0spIHsKCQkJ
CQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShlYnVmKTsKCQkJCQl9CgkJCQl9IGVsc2Ug
ewoJCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlJlYWxtIG5vdCBhdmFpbGFibGUu
Iik7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAncyc6CgkJCQlpZiAoc2VydmljZSE9TlVMTCkg
ewoJCQkJCXJjID0gbGFrX2VzY2FwZShzZXJ2aWNlLCBzdHJsZW4oc2VydmljZSksICZlYnVmKTsK
CQkJCQlpZiAocmMgPT0gTEFLX09LKSB7CgkJCQkJCXN0cmNhdChidWYsZWJ1Zik7CgkJCQkJCWZy
ZWUoZWJ1Zik7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9H
X0FVVEgsICJTZXJ2aWNlIG5vdCBhdmFpbGFibGUuIik7CgkJCQl9CgkJCQlicmVhazsKCQkJZGVm
YXVsdDoKCQkJCWJyZWFrOwoJCX0KCQlwdHI9dGVtcCsyOwoJfQoJaWYgKHRlbXA8ZW5kKQoJCXN0
cmNhdChidWYsIHB0cik7CgoJKnJlc3VsdCA9IGJ1ZjsKCglyZXR1cm4gTEFLX09LOwp9CgppbnQg
bGFrX2luaXQoY29uc3QgY2hhciAqY29uZmlnZmlsZSwgTEFLICoqcmV0KSAKewoJTEFLICpsYWs7
CglpbnQgcmM7CgoJbGFrID0gKnJldDsKCglpZiAobGFrICE9IE5VTEwpIHsKCQlyZXR1cm4gTEFL
X09LOwoJfQoKCWxhayA9IChMQUsgKiltYWxsb2Moc2l6ZW9mKExBSykpOwoJaWYgKGxhayA9PSBO
VUxMKSB7CgkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICJDYW5ub3QgYWxsb2NhdGUgbWVtb3J5
Iik7CgkJcmV0dXJuIExBS19OT01FTTsKCX0KCglsYWstPmJpbmRfc3RhdHVzPUxBS19OT1RfQk9V
TkQ7CglsYWstPmxkPU5VTEw7CglsYWstPmNvbmY9TlVMTDsKCglyYyA9IGxha19jb25maWcoY29u
ZmlnZmlsZSwgJmxhay0+Y29uZik7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJZnJlZShsYWspOwoJ
CXJldHVybiByYzsKCX0KCiNpZmRlZiBIQVZFX09QRU5TU0wKCU9wZW5TU0xfYWRkX2FsbF9kaWdl
c3RzKCk7CiNlbmRpZgoKCSpyZXQ9bGFrOwoJcmV0dXJuIExBS19PSzsKfQoKdm9pZCBsYWtfY2xv
c2UoTEFLICpsYWspIHsKCglpZiAobGFrID09IE5VTEwpCgkJcmV0dXJuOwoKCWlmIChsYWstPmxk
ICE9IE5VTEwpIHsKCQlpZiAobGFrLT5jb25mLT5jYWNoZV90dGwpCgkJCWxkYXBfZGVzdHJveV9j
YWNoZShsYWstPmxkKTsKCQlsZGFwX3VuYmluZF9zKGxhay0+bGQpOwoJfQoKCWxha19jb25maWdf
ZnJlZShsYWstPmNvbmYpOwoKCWZyZWUobGFrKTsKCiNpZmRlZiBIQVZFX09QRU5TU0wKCUVWUF9j
bGVhbnVwKCk7CiNlbmRpZgoKCXJldHVybjsKfQoKc3RhdGljIGludCBsYWtfY29ubmVjdChMQUsg
KmxhaykKewoJaW50ICAgICByYyA9IDA7CgoJaWYgKGxhay0+Y29uZi0+dGxzX2NhY2VydF9maWxl
ICE9IE5VTEwpIHsKCQlyYyA9IGxkYXBfc2V0X29wdGlvbiAoTlVMTCwgTERBUF9PUFRfWF9UTFNf
Q0FDRVJURklMRSwgbGFrLT5jb25mLT50bHNfY2FjZXJ0X2ZpbGUpOwoJCWlmIChyYyAhPSBMREFQ
X1NVQ0NFU1MpIHsKCQkJc3lzbG9nIChMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBz
ZXQgTERBUF9PUFRfWF9UTFNfQ0FDRVJURklMRSAoJXMpLiIsIGxkYXBfZXJyMnN0cmluZyAocmMp
KTsKCQl9Cgl9CgoJaWYgKGxhay0+Y29uZi0+dGxzX2NhY2VydF9kaXIgIT0gTlVMTCkgewoJCXJj
ID0gbGRhcF9zZXRfb3B0aW9uIChOVUxMLCBMREFQX09QVF9YX1RMU19DQUNFUlRESVIsIGxhay0+
Y29uZi0+dGxzX2NhY2VydF9kaXIpOwoJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJc3lz
bG9nIChMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERBUF9PUFRfWF9UTFNf
Q0FDRVJURElSICglcykuIiwgbGRhcF9lcnIyc3RyaW5nIChyYykpOwoJCX0KCX0KCglpZiAobGFr
LT5jb25mLT50bHNfY2hlY2tfcGVlciAhPSAwKSB7CgkJcmMgPSBsZGFwX3NldF9vcHRpb24oTlVM
TCwgTERBUF9PUFRfWF9UTFNfUkVRVUlSRV9DRVJULCAmbGFrLT5jb25mLT50bHNfY2hlY2tfcGVl
cik7CgkJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJCQlzeXNsb2cgKExPR19XQVJOSU5HfExP
R19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9YX1RMU19SRVFVSVJFX0NFUlQgKCVzKS4i
LCBsZGFwX2VycjJzdHJpbmcgKHJjKSk7CgkJfQoJfQoKCWlmIChsYWstPmNvbmYtPnRsc19jaXBo
ZXJzICE9IE5VTEwpIHsKCQkvKiBzZXQgY2lwaGVyIHN1aXRlLCBjZXJ0aWZpY2F0ZSBhbmQgcHJp
dmF0ZSBrZXk6ICovCgkJcmMgPSBsZGFwX3NldF9vcHRpb24oTlVMTCwgTERBUF9PUFRfWF9UTFNf
Q0lQSEVSX1NVSVRFLCBsYWstPmNvbmYtPnRsc19jaXBoZXJzKTsKCQlpZiAocmMgIT0gTERBUF9T
VUNDRVNTKSB7CgkJCXN5c2xvZyAoTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0
IExEQVBfT1BUX1hfVExTX0NJUEhFUl9TVUlURSAoJXMpLiIsIGxkYXBfZXJyMnN0cmluZyAocmMp
KTsKCQl9Cgl9CgoJaWYgKGxhay0+Y29uZi0+dGxzX2NlcnQgIT0gTlVMTCkgewoJCXJjID0gbGRh
cF9zZXRfb3B0aW9uKE5VTEwsIExEQVBfT1BUX1hfVExTX0NFUlRGSUxFLCBsYWstPmNvbmYtPnRs
c19jZXJ0KTsKCQlpZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7CgkJCXN5c2xvZyAoTE9HX1dBUk5J
Tkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0IExEQVBfT1BUX1hfVExTX0NFUlRGSUxFICglcyku
IiwgbGRhcF9lcnIyc3RyaW5nIChyYykpOwoJCX0KCX0KCglpZiAobGFrLT5jb25mLT50bHNfa2V5
ICE9IE5VTEwpIHsKCQlyYyA9IGxkYXBfc2V0X29wdGlvbihOVUxMLCBMREFQX09QVF9YX1RMU19L
RVlGSUxFLCBsYWstPmNvbmYtPnRsc19rZXkpOwoJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsK
CQkJc3lzbG9nIChMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERBUF9PUFRf
WF9UTFNfS0VZRklMRSAoJXMpLiIsIGxkYXBfZXJyMnN0cmluZyAocmMpKTsKCQl9Cgl9CgoJcmMg
PSBsZGFwX2luaXRpYWxpemUoJmxhay0+bGQsIGxhay0+Y29uZi0+c2VydmVycyk7CglpZiAocmMg
IT0gTERBUF9TVUNDRVNTKSB7CgkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICJsZGFwX2luaXRp
YWxpemUgZmFpbGVkICglcykiLCBsYWstPmNvbmYtPnNlcnZlcnMpOwoJCXJldHVybiBMQUtfRkFJ
TDsKCX0KCglpZiAobGFrLT5jb25mLT5kZWJ1ZykgewoJCXJjID0gbGRhcF9zZXRfb3B0aW9uKE5V
TEwsIExEQVBfT1BUX0RFQlVHX0xFVkVMLCAmKGxhay0+Y29uZi0+ZGVidWcpKTsKCQlpZiAocmMg
IT0gTERBUF9PUFRfU1VDQ0VTUykKCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5h
YmxlIHRvIHNldCBMREFQX09QVF9ERUJVR19MRVZFTCAleC4iLCBsYWstPmNvbmYtPmRlYnVnKTsK
CX0KCglyYyA9IGxkYXBfc2V0X29wdGlvbihsYWstPmxkLCBMREFQX09QVF9QUk9UT0NPTF9WRVJT
SU9OLCAmKGxhay0+Y29uZi0+dmVyc2lvbikpOwoJaWYgKHJjICE9IExEQVBfT1BUX1NVQ0NFU1Mp
IHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0IExEQVBfT1BU
X1BST1RPQ09MX1ZFUlNJT04gJWQuIiwgbGFrLT5jb25mLT52ZXJzaW9uKTsKCQlsYWstPmNvbmYt
PnZlcnNpb24gPSBMREFQX1ZFUlNJT04yOwoJfQoKCXJjID0gbGRhcF9zZXRfb3B0aW9uKGxhay0+
bGQsIExEQVBfT1BUX05FVFdPUktfVElNRU9VVCwgJihsYWstPmNvbmYtPnRpbWVvdXQpKTsKCWlm
IChyYyAhPSBMREFQX09QVF9TVUNDRVNTKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRI
LCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9ORVRXT1JLX1RJTUVPVVQgJWQuJWQuIiwgbGFrLT5j
b25mLT50aW1lb3V0LnR2X3NlYywgbGFrLT5jb25mLT50aW1lb3V0LnR2X3VzZWMpOwoJfQoKCXJj
ID0gbGRhcF9zZXRfb3B0aW9uKGxhay0+bGQsIExEQVBfT1BUX1RJTUVMSU1JVCwgJihsYWstPmNv
bmYtPnRpbWVfbGltaXQpKTsKCWlmIChyYyAhPSBMREFQX09QVF9TVUNDRVNTKSB7CgkJc3lzbG9n
KExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9USU1FTElNSVQg
JWQuIiwgbGFrLT5jb25mLT50aW1lX2xpbWl0KTsKCX0KCglyYyA9IGxkYXBfc2V0X29wdGlvbihs
YWstPmxkLCBMREFQX09QVF9ERVJFRiwgJihsYWstPmNvbmYtPmRlcmVmKSk7CglpZiAocmMgIT0g
TERBUF9PUFRfU1VDQ0VTUykgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJs
ZSB0byBzZXQgTERBUF9PUFRfREVSRUYgJWQuIiwgbGFrLT5jb25mLT5kZXJlZik7Cgl9CgoJcmMg
PSBsZGFwX3NldF9vcHRpb24obGFrLT5sZCwgTERBUF9PUFRfUkVGRVJSQUxTLCBsYWstPmNvbmYt
PnJlZmVycmFscyA/IExEQVBfT1BUX09OIDogTERBUF9PUFRfT0ZGKTsKCWlmIChyYyAhPSBMREFQ
X09QVF9TVUNDRVNTKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRv
IHNldCBMREFQX09QVF9SRUZFUlJBTFMuIik7Cgl9CgoJcmMgPSBsZGFwX3NldF9vcHRpb24obGFr
LT5sZCwgTERBUF9PUFRfU0laRUxJTUlULCAmKGxhay0+Y29uZi0+c2l6ZV9saW1pdCkpOwoJaWYg
KHJjICE9IExEQVBfT1BUX1NVQ0NFU1MpCgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAi
VW5hYmxlIHRvIHNldCBMREFQX09QVF9TSVpFTElNSVQgJWQuIiwgbGFrLT5jb25mLT5zaXplX2xp
bWl0KTsKCglyYyA9IGxkYXBfc2V0X29wdGlvbihsYWstPmxkLCBMREFQX09QVF9SRVNUQVJULCBs
YWstPmNvbmYtPnJlc3RhcnQgPyBMREFQX09QVF9PTiA6IExEQVBfT1BUX09GRik7CglpZiAocmMg
IT0gTERBUF9PUFRfU1VDQ0VTUykgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVu
YWJsZSB0byBzZXQgTERBUF9PUFRfUkVTVEFSVC4iKTsKCX0KCgkvKgoJICogU2V0IHVwIGNsaWVu
dC1zaWRlIGNhY2hpbmcKCSAqLwoJaWYgKGxhay0+Y29uZi0+Y2FjaGVfdHRsKSB7CgkJcmMgPSBs
ZGFwX2VuYWJsZV9jYWNoZShsYWstPmxkLCBsYWstPmNvbmYtPmNhY2hlX3R0bCwgbGFrLT5jb25m
LT5jYWNoZV9tZW0pOwoJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJc3lzbG9nKExPR19X
QVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIGVuYWJsZSBjYWNoZSAtLSBjb250aW51aW5nICgl
cykiLCBsZGFwX2VycjJzdHJpbmcocmMpKTsKCQl9Cgl9CgoJcmV0dXJuIExBS19PSzsKfQoKCnN0
YXRpYyBpbnQgbGFrX2JpbmQoTEFLICpsYWssIGNoYXIgZmxhZywgY29uc3QgY2hhciAqYmluZF9k
biwgY29uc3QgY2hhciAqcGFzc3dvcmQpIAp7CglpbnQgcmM7CgoJaWYgKGxhay0+YmluZF9zdGF0
dXMgPT0gTEFLX0JJTkRfQU5PTllNT1VTICYmCgkgICAgZmxhZyA9PSBMQUtfQklORF9BTk9OWU1P
VVMpIHsKCSAgICByZXR1cm4gTEFLX09LOwoJfQoKCWlmIChsYWstPmJpbmRfc3RhdHVzID09IExB
S19OT1RfQk9VTkQpIHsKCQlpZiAobGFrLT5sZCAhPSBOVUxMKSB7CgkJCWlmIChsYWstPmNvbmYt
PmNhY2hlX3R0bCkKCQkJCWxkYXBfZGVzdHJveV9jYWNoZShsYWstPmxkKTsKCQkJbGRhcF91bmJp
bmRfcyhsYWstPmxkKTsKCQkJbGFrLT5sZCA9IE5VTEw7CgkJfQoKCQlyYyA9IGxha19jb25uZWN0
KGxhayk7CgkJaWYgKHJjICE9IExBS19PSykgewoJCQlyZXR1cm4gcmM7CgkJfQoJfSBlbHNlIHsK
CQlpZiAobGFrLT5jb25mLT52ZXJzaW9uID09IExEQVBfVkVSU0lPTjIpIHsKCgkJCWxhay0+Ymlu
ZF9zdGF0dXMgPSBMQUtfTk9UX0JPVU5EOwoKCQkJaWYgKGxhay0+bGQgIT0gTlVMTCkgewoJCQkJ
aWYgKGxhay0+Y29uZi0+Y2FjaGVfdHRsKQoJCQkJCWxkYXBfZGVzdHJveV9jYWNoZShsYWstPmxk
KTsKCQkJCWxkYXBfdW5iaW5kX3MobGFrLT5sZCk7CgoJCQkJbGFrLT5sZCA9IE5VTEw7CgkJCX0K
CQkJcmMgPSBsYWtfY29ubmVjdChsYWspOwoJCQlpZiAocmMgIT0gTEFLX09LKSB7CgkJCQlyZXR1
cm4gcmM7CgkJCX0KCQl9Cgl9CgoJcmMgPSBsZGFwX3NpbXBsZV9iaW5kX3MobGFrLT5sZCwgYmlu
ZF9kbiwgcGFzc3dvcmQpOwoJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJICAgIHN5c2xvZygo
ZmxhZyA9PSBMQUtfQklORF9BTk9OWU1PVVMgPyBMT0dfV0FSTklORyA6IExPR19ERUJVRyl8TE9H
X0FVVEgsCgkJICAgImxkYXBfc2ltcGxlX2JpbmQoKSBmYWlsZWQgYXMgJXMgKCVzKSIsCgkJICAg
KCFiaW5kX2RuIHx8IGJpbmRfZG5bMF0gPT0gJ1wwJykgPyAiYW5vbnltb3VzIiA6IGJpbmRfZG4s
CgkJICAgbGRhcF9lcnIyc3RyaW5nKHJjKSk7CgkgICAgbGFrLT5iaW5kX3N0YXR1cyA9IExBS19O
T1RfQk9VTkQ7CgkgICAgcmV0dXJuIExBS19GQUlMOwoJfQoKCWxhay0+YmluZF9zdGF0dXMgPSBm
bGFnOwoJcmV0dXJuIExBS19PSzsKfQoKCnN0YXRpYyBpbnQgbGFrX3NlYXJjaChMQUsgKmxhaywg
Y29uc3QgY2hhciAqc2VhcmNoX2Jhc2UsIGNvbnN0IGNoYXIgKmZpbHRlciwgY29uc3QgY2hhciAq
KmF0dHJzLCBMREFQTWVzc2FnZSAqKnJlcykKewoJaW50IHJjID0gMDsKCWludCByZXRyeSA9IDE7
CgoJKnJlcyA9IE5VTEw7CgpyZXRyeToKCXJjID0gbGFrX2JpbmQobGFrLCBMQUtfQklORF9BTk9O
WU1PVVMsIGxhay0+Y29uZi0+YmluZF9kbiwgbGFrLT5jb25mLT5iaW5kX3B3KTsKCWlmIChyYyAh
PSBMQUtfT0spIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJsYWtfYmluZCgpIGZh
aWxlZCIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxkYXBfc2VhcmNoX3N0KGxhay0+
bGQsIHNlYXJjaF9iYXNlLCBsYWstPmNvbmYtPnNjb3BlLCBmaWx0ZXIsIChjaGFyICoqKSBhdHRy
cywgMCwgJihsYWstPmNvbmYtPnRpbWVvdXQpLCByZXMpOwoJc3dpdGNoIChyYykgewoJCWNhc2Ug
TERBUF9TVUNDRVNTOgoJCWNhc2UgTERBUF9OT19TVUNIX09CSkVDVDoKCQkJYnJlYWs7CgkJY2Fz
ZSBMREFQX1RJTUVMSU1JVF9FWENFRURFRDoKCQljYXNlIExEQVBfQlVTWToKCQljYXNlIExEQVBf
VU5BVkFJTEFCTEU6CgkJY2FzZSBMREFQX0lOU1VGRklDSUVOVF9BQ0NFU1M6CgkJCS8qICBXZSBk
byBub3QgbmVlZCB0byByZS1jb25uZWN0IHRvIHRoZSBMREFQIHNlcnZlciAKCQkJICAgIHVuZGVy
IHRoZXNlIGNvbmRpdGlvbnMgKi8KCQkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICJsZGFwX3Nl
YXJjaF9zdCgpIGZhaWxlZDogJXMiLCBsZGFwX2VycjJzdHJpbmcocmMpKTsKCQkJbGRhcF9tc2dm
cmVlKCpyZXMpOwoJCQlyZXR1cm4gTEFLX0ZBSUw7CgkJY2FzZSBMREFQX1RJTUVPVVQ6CgkJY2Fz
ZSBMREFQX1NFUlZFUl9ET1dOOgoJCQlpZiAocmV0cnkpIHsKCQkJCXN5c2xvZyhMT0dfV0FSTklO
R3xMT0dfQVVUSCwgImxkYXBfc2VhcmNoX3N0KCkgZmFpbGVkOiAlcy4gVHJ5aW5nIHRvIHJlY29u
bmVjdC4iLCBsZGFwX2VycjJzdHJpbmcocmMpKTsKCQkJCWxkYXBfbXNnZnJlZSgqcmVzKTsKCQkJ
CWxhay0+YmluZF9zdGF0dXMgPSBMQUtfTk9UX0JPVU5EOwoJCQkJcmV0cnktLTsKCQkJCWdvdG8g
cmV0cnk7CgkJCX0KCQlkZWZhdWx0OgoJCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgImxkYXBf
c2VhcmNoX3N0KCkgZmFpbGVkOiAlcyIsIGxkYXBfZXJyMnN0cmluZyhyYykpOwoJCQlsZGFwX21z
Z2ZyZWUoKnJlcyk7CgkJCWxhay0+YmluZF9zdGF0dXMgPSBMQUtfTk9UX0JPVU5EOwoJCQlyZXR1
cm4gTEFLX0ZBSUw7Cgl9CgoJaWYgKChsZGFwX2NvdW50X2VudHJpZXMobGFrLT5sZCwgKnJlcykp
ICE9IDEpIHsKCQlzeXNsb2coTE9HX0RFQlVHfExPR19BVVRILCAiRW50cnkgbm90IGZvdW5kIG9y
IG1vcmUgdGhhbiBvbmUgZW50cmllcyBmb3VuZCAoJXMpLiIsIGZpbHRlcik7CgkJbGRhcF9tc2dm
cmVlKCpyZXMpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCQoJcmV0dXJuIExBS19PSzsKfQoKLyog
CiAqIGxha19yZXRyaWV2ZSAtIHJldHJpZXZlIHVzZXJAcmVhbG0gdmFsdWVzIHNwZWNpZmllZCBi
eSAnYXR0cnMnCiAqLwppbnQgbGFrX3JldHJpZXZlKExBSyAqbGFrLCBjb25zdCBjaGFyICp1c2Vy
LCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqKmF0
dHJzLCBMQUtfUkVTVUxUICoqcmV0KQp7CglpbnQgcmMgPSAwLCBpOwoJY2hhciAqZmlsdGVyID0g
TlVMTDsKCWNoYXIgKnNlYXJjaF9iYXNlID0gTlVMTDsKCUxEQVBNZXNzYWdlICpyZXM7CglMREFQ
TWVzc2FnZSAqZW50cnk7CglCZXJFbGVtZW50ICpiZXI7CgljaGFyICphdHRyLCAqKnZhbHM7CiAg
ICAKICAgIAkqcmV0ID0gTlVMTDsKCglpZiAobGFrID09IE5VTEwpIHsKCQlzeXNsb2coTE9HX0VS
UnxMT0dfQVVUSCwgImxha19pbml0IGRpZCBub3QgcnVuLiIpOwoJCXJldHVybiBMQUtfRkFJTDsK
CX0KCglpZiAodXNlciA9PSBOVUxMIHx8IHVzZXJbMF0gPT0gJ1wwJykgewoJCXJldHVybiBMQUtf
RkFJTDsKCX0KCglyYyA9IGxha19leHBhbmRfdG9rZW5zKGxhay0+Y29uZi0+ZmlsdGVyLCB1c2Vy
LCBzZXJ2aWNlLCByZWFsbSwgJmZpbHRlcik7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJc3lzbG9n
KExPR19XQVJOSU5HfExPR19BVVRILCAibGFrX2V4cGFuZF90b2tlbnMoZmlsdGVyKSBmYWlsZWQu
Iik7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCXJjID0gbGFrX2V4cGFuZF90b2tlbnMobGFrLT5j
b25mLT5zZWFyY2hfYmFzZSwgdXNlciwgc2VydmljZSwgcmVhbG0sICZzZWFyY2hfYmFzZSk7Cglp
ZiAocmMgIT0gTEFLX09LKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAibGFrX2V4
cGFuZF90b2tlbnMoc2VhcmNoX2Jhc2UpIGZhaWxlZC4iKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9
CgoJcmMgPSBsYWtfc2VhcmNoKGxhaywgc2VhcmNoX2Jhc2UsIGZpbHRlciwgYXR0cnMsICZyZXMp
OwoJaWYgKHJjICE9IExBS19PSykgewoJCWZyZWUoZmlsdGVyKTsKCQlmcmVlKHNlYXJjaF9iYXNl
KTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJZW50cnkgPSBsZGFwX2ZpcnN0X2VudHJ5KGxhay0+
bGQsIHJlcyk7IAoJaWYgKGVudHJ5ID09IE5VTEwpIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9H
X0FVVEgsICJsZGFwX2ZpcnN0X2VudHJ5KCkgZmFpbGVkLiIpOwoJCWZyZWUoZmlsdGVyKTsKCQlm
cmVlKHNlYXJjaF9iYXNlKTsKCQlsZGFwX21zZ2ZyZWUocmVzKTsKCQlyZXR1cm4gTEFLX0ZBSUw7
Cgl9CgoJcmMgPSBMQUtfT0s7Cglmb3IgKGF0dHIgPSBsZGFwX2ZpcnN0X2F0dHJpYnV0ZShsYWst
PmxkLCBlbnRyeSwgJmJlcik7IGF0dHIgIT0gTlVMTDsgCgkJYXR0ciA9IGxkYXBfbmV4dF9hdHRy
aWJ1dGUobGFrLT5sZCwgZW50cnksIGJlcikpIHsKCgkJdmFscyA9IGxkYXBfZ2V0X3ZhbHVlcyhs
YWstPmxkLCBlbnRyeSwgYXR0cik7CgkJaWYgKHZhbHMgPT0gTlVMTCkgewoJCQljb250aW51ZTsK
CQl9CgoJCWZvciAoaSA9IDA7IHZhbHNbaV0gIT0gTlVMTDsgaSsrKSB7CgkJCXJjID0gbGFrX3Jl
c3VsdF9hZGQobGFrLCBhdHRyLCB2YWxzW2ldLCByZXQpOwoJCQlpZiAocmMgIT0gTEFLX09LKSB7
CgkJCQlicmVhazsKCQkJfQoJCX0KCgkJbGRhcF92YWx1ZV9mcmVlKHZhbHMpOwoJCWxkYXBfbWVt
ZnJlZShhdHRyKTsKCgkJaWYgKHJjICE9IExBS19PSykgewoJCQlsYWtfcmVzdWx0X2ZyZWUoKnJl
dCk7CgkJCSpyZXQgPSBOVUxMOwoJCQlicmVhazsKCQl9Cgl9CgoJaWYgKGJlciAhPSBOVUxMKQoJ
CWJlcl9mcmVlKGJlciwgMCk7CglsZGFwX21zZ2ZyZWUocmVzKTsKCWZyZWUoZmlsdGVyKTsKCWZy
ZWUoc2VhcmNoX2Jhc2UpOwoKCWlmICgqcmV0ID09IE5VTEwpCgkJcmV0dXJuIExBS19OT0VOVDsK
CglyZXR1cm4gTEFLX09LOwp9CgoKc3RhdGljIGludCBsYWtfZ3JvdXBfbWVtYmVyKExBSyAqbGFr
LCBjb25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFs
bSwgY29uc3QgY2hhciAqZG4pCnsKCWNoYXIgKmdyb3VwOwoJaW50IHJjOwoKCXJjID0gbGFrX2V4
cGFuZF90b2tlbnMobGFrLT5jb25mLT5ncm91cF9kbiwgdXNlciwgc2VydmljZSwgcmVhbG0sICZn
cm91cCk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRI
LCAibGFrX2V4cGFuZF90b2tlbnMoZ3JvdXApIGZhaWxlZC4iKTsKCQlyZXR1cm4gTEFLX0ZBSUw7
Cgl9CgoJcmMgPSBsZGFwX2NvbXBhcmVfcyhsYWstPmxkLCBncm91cCwgbGFrLT5jb25mLT5ncm91
cF9hdHRyLCBkbik7CglmcmVlKGdyb3VwKTsKCWlmIChyYyAhPSBMREFQX0NPTVBBUkVfVFJVRSkg
ewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgImxkYXBfY29tcGFyZV9zKCkgZm9yIGdy
b3VwIGZhaWxlZC4iKTsKCQlyYyA9IExBS19GQUlMOwoJfQoKCXJldHVybiBMQUtfT0s7Cn0KCnN0
YXRpYyBpbnQgbGFrX2F1dGhfY3VzdG9tKExBSyAqbGFrLCBjb25zdCBjaGFyICp1c2VyLCBjb25z
dCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqcGFzc3dvcmQp
IAp7CglMQUtfUkVTVUxUICpscmVzLCAqcHRyOwoJaW50IHJjOwoJc3RydWN0IHBhc3N3b3JkX2No
ZWNrICpwYzsKCWNvbnN0IGNoYXIgKmF0dHJzW10gPSB7ImRuIiwgbGFrLT5jb25mLT5wYXNzd29y
ZF9hdHRyLCBOVUxMfTsKCWNoYXIgKmRuOwoKCXJjID0gbGFrX3JldHJpZXZlKGxhaywgdXNlciwg
c2VydmljZSwgcmVhbG0sIGF0dHJzLCAmbHJlcyk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJcmV0
dXJuIHJjOwoJfQoKCXJjID0gTEFLX0ZBSUw7CgoJZm9yIChwdHIgPSBscmVzOyBwdHIgIT0gTlVM
TDsgcHRyID0gcHRyLT5uZXh0KSB7CgkJCgkJaWYgKHN0cmNhc2VjbXAocHRyLT5hdHRyaWJ1dGUs
IGxhay0+Y29uZi0+cGFzc3dvcmRfYXR0cikpCgkJCWNvbnRpbnVlOwoKCQlyYyA9IGxha19jaGVj
a19wYXNzd29yZChwdHItPnZhbHVlLCBwYXNzd29yZCwgTlVMTCk7CgkJaWYgKHJjID09IExBS19P
SykgewoJCQlicmVhazsKCQl9Cgl9CgoJaWYgKHJjID09IExBS19PSyAmJgoJICAgIGxhay0+Y29u
Zi0+Z3JvdXBfZG4gIT0gTlVMTCAmJiAqKGxhay0+Y29uZi0+Z3JvdXBfZG4pICE9ICdcMCcpIHsK
CgkJcmMgPSBMQUtfRkFJTDsKCgkJZm9yIChwdHIgPSBscmVzOyBwdHIgIT0gTlVMTDsgcHRyID0g
cHRyLT5uZXh0KQoJCQlpZiAoIXN0cmNhc2VjbXAocHRyLT5hdHRyaWJ1dGUsICJkbiIpKSB7CgkJ
CQlyYyA9IGxha19ncm91cF9tZW1iZXIobGFrLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgZG4pOwoJ
CQkJYnJlYWs7CgkJCX0KCgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiR3JvdXAgY2hl
Y2sgZmFpbGVkIChkbiB1bmtub3duKS4iKTsKCX0KCQoJbGFrX3Jlc3VsdF9mcmVlKGxyZXMpOwoK
CXJldHVybihyYyk7Cn0KCnN0YXRpYyBpbnQgbGFrX2F1dGhfYmluZChMQUsgKmxhaywgY29uc3Qg
Y2hhciAqdXNlciwgY29uc3QgY2hhciAqc2VydmljZSwgY29uc3QgY2hhciAqcmVhbG0sIGNvbnN0
IGNoYXIgKnBhc3N3b3JkKSAKewoJY2hhciAqZmlsdGVyOwoJY2hhciAqc2VhcmNoX2Jhc2U7Cglp
bnQgcmM7CgljaGFyICpkbjsKCUxEQVBNZXNzYWdlICpyZXMsICplbnRyeTsKCglyYyA9IGxha19l
eHBhbmRfdG9rZW5zKGxhay0+Y29uZi0+ZmlsdGVyLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgJmZp
bHRlcik7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRI
LCAibGFrX2V4cGFuZF90b2tlbnMoZmlsdGVyKSBmYWlsZWQuIik7CgkJcmV0dXJuIExBS19GQUlM
OwoJfQoKCXJjID0gbGFrX2V4cGFuZF90b2tlbnMobGFrLT5jb25mLT5zZWFyY2hfYmFzZSwgdXNl
ciwgc2VydmljZSwgcmVhbG0sICZzZWFyY2hfYmFzZSk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJ
c3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAibGFrX2V4cGFuZF90b2tlbnMoc2VhcmNoX2Jh
c2UpIGZhaWxlZC4iKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmMgPSBsYWtfc2VhcmNoKGxh
aywgc2VhcmNoX2Jhc2UsIGZpbHRlciwgTlVMTCwgJnJlcyk7CglpZiAocmMgIT0gTEFLX09LKSB7
CgkJZnJlZShmaWx0ZXIpOwoJCWZyZWUoc2VhcmNoX2Jhc2UpOwoJCXJldHVybiBMQUtfRkFJTDsK
CX0KCgllbnRyeSA9IGxkYXBfZmlyc3RfZW50cnkobGFrLT5sZCwgcmVzKTsgCglpZiAoZW50cnkg
PT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgImxkYXBfZmlyc3RfZW50
cnkoKS4iKTsKCQlmcmVlKGZpbHRlcik7CgkJZnJlZShzZWFyY2hfYmFzZSk7CgkJbGRhcF9tc2dm
cmVlKHJlcyk7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWRuID0gbGRhcF9nZXRfZG4obGFrLT5s
ZCwgcmVzKTsKCWlmIChkbiA9PSBOVUxMKSB7CgkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICJs
ZGFwX2dldF9kbigpIGZhaWxlZC4iKTsKCQlmcmVlKGZpbHRlcik7CgkJZnJlZShzZWFyY2hfYmFz
ZSk7CgkJbGRhcF9tc2dmcmVlIChyZXMpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglmcmVlKGZp
bHRlcik7CglmcmVlKHNlYXJjaF9iYXNlKTsKCWxkYXBfbXNnZnJlZShyZXMpOwoKCXJjID0gbGFr
X2JpbmQobGFrLCBMQUtfQklORF9BU19VU0VSLCBkbiwgcGFzc3dvcmQpOwoKCWlmIChyYyA9PSBM
QUtfT0sgJiYKCSAgICBsYWstPmNvbmYtPmdyb3VwX2RuICE9IE5VTEwgJiYgKihsYWstPmNvbmYt
Pmdyb3VwX2RuKSAhPSAnXDAnKQoJCXJjID0gbGFrX2dyb3VwX21lbWJlcihsYWssIHVzZXIsIHNl
cnZpY2UsIHJlYWxtLCBkbik7CgoJbGRhcF9tZW1mcmVlKGRuKTsKCglsYWtfYmluZChsYWssIExB
S19CSU5EX0FOT05ZTU9VUywgbGFrLT5jb25mLT5iaW5kX2RuLCBsYWstPmNvbmYtPmJpbmRfcHcp
OwoKCglyZXR1cm4gcmM7Cn0KCgpzdGF0aWMgaW50IGxha19hdXRoX2Zhc3RiaW5kKExBSyAqbGFr
LCBjb25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFs
bSwgY29uc3QgY2hhciAqcGFzc3dvcmQpIAp7CglpbnQgcmM7CgljaGFyICpkbiA9IE5VTEw7CgoJ
cmMgPSBsYWtfZXhwYW5kX3Rva2VucyhsYWstPmNvbmYtPmZpbHRlciwgdXNlciwgc2VydmljZSwg
cmVhbG0sICZkbik7CglpZiAocmMgIT0gTEFLX09LIHx8IGRuID09IE5VTEwpIHsKCQlzeXNsb2co
TE9HX1dBUk5JTkd8TE9HX0FVVEgsICJsYWtfZXhwYW5kX3Rva2VucyhmaWx0ZXIpIGZhaWxlZC4i
KTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmMgPSBsYWtfYmluZChsYWssIExBS19CSU5EX0FT
X1VTRVIsIGRuLCBwYXNzd29yZCk7CglmcmVlKGRuKTsKCglpZiAocmMgPT0gTEFLX09LICYmCgkg
ICAgbGFrLT5jb25mLT5ncm91cF9kbiAhPSBOVUxMICYmICoobGFrLT5jb25mLT5ncm91cF9kbikg
IT0gJ1wwJykKCQlyYyA9IGxha19ncm91cF9tZW1iZXIobGFrLCB1c2VyLCBzZXJ2aWNlLCByZWFs
bSwgZG4pOwoKCXJldHVybiByYzsKfQoKaW50IGxha19hdXRoZW50aWNhdGUoTEFLICpsYWssIGNv
bnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnNlcnZpY2UsIGNvbnN0IGNoYXIgKnJlYWxtLCBj
b25zdCBjaGFyICpwYXNzd29yZCkgCnsKCWludCByYzsKCglpZiAobGFrID09IE5VTEwpIHsKCQlz
eXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgImxha19pbml0IGRpZCBub3QgcnVuLiIpOwoJCXJldHVy
biBMQUtfRkFJTDsKCX0KCglpZiAodXNlciA9PSBOVUxMIHx8IHVzZXJbMF0gPT0gJ1wwJykKCQly
ZXR1cm4gTEFLX0ZBSUw7CgoJaWYgKGxhay0+Y29uZi0+YXV0aF9tZXRob2QgPT0gTEFLX0FVVEhf
TUVUSE9EX0JJTkQpCgkJcmMgPSBsYWtfYXV0aF9iaW5kKGxhaywgdXNlciwgc2VydmljZSwgcmVh
bG0sIHBhc3N3b3JkKTsKCWVsc2UgaWYgKGxhay0+Y29uZi0+YXV0aF9tZXRob2QgPT0gTEFLX0FV
VEhfTUVUSE9EX0NVU1RPTSkKCQlyYyA9IGxha19hdXRoX2N1c3RvbShsYWssIHVzZXIsIHNlcnZp
Y2UsIHJlYWxtLCBwYXNzd29yZCk7CgllbHNlCgkJcmMgPSBsYWtfYXV0aF9mYXN0YmluZChsYWss
IHVzZXIsIHNlcnZpY2UsIHJlYWxtLCBwYXNzd29yZCk7CgoJcmV0dXJuIHJjOwp9CgoKc3RhdGlj
IGludCBsYWtfcmVzdWx0X2FkZChMQUsgKmxhaywgY29uc3QgY2hhciAqYXR0ciwgY29uc3QgY2hh
ciAqdmFsLCBMQUtfUkVTVUxUICoqcmV0KSAgCnsKCUxBS19SRVNVTFQgKmxyZXM7CgkKCWxyZXMg
PSAoTEFLX1JFU1VMVCAqKSBtYWxsb2Moc2l6ZW9mKExBS19SRVNVTFQpKTsKCWlmIChscmVzID09
IE5VTEwpIHsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoKCWxyZXMtPm5leHQgPSBOVUxMOwoKCWxy
ZXMtPmF0dHJpYnV0ZSA9IHN0cmR1cChhdHRyKTsKCWlmIChscmVzLT5hdHRyaWJ1dGUgPT0gTlVM
TCkgewoJCWxha19yZXN1bHRfZnJlZShscmVzKTsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoKCWxy
ZXMtPnZhbHVlID0gc3RyZHVwKHZhbCk7CglpZiAobHJlcy0+dmFsdWUgPT0gTlVMTCkgewoJCWxh
a19yZXN1bHRfZnJlZShscmVzKTsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoJbHJlcy0+bGVuID0g
c3RybGVuKGxyZXMtPnZhbHVlKTsKCglscmVzLT5uZXh0ID0gKnJldDsKCgkqcmV0ID0gbHJlczsK
CXJldHVybiBMQUtfT0s7Cn0KCgp2b2lkIGxha19yZXN1bHRfZnJlZShMQUtfUkVTVUxUICpyZXMp
IAp7CglMQUtfUkVTVUxUICpscmVzLCAqcHRyID0gcmVzOwoKCWlmIChwdHIgPT0gTlVMTCkKCQly
ZXR1cm47CgoJZm9yIChscmVzID0gcHRyOyBscmVzICE9IE5VTEw7IGxyZXMgPSBwdHIpIHsKCgkJ
cHRyID0gbHJlcy0+bmV4dDsKCgkJaWYgKGxyZXMtPmF0dHJpYnV0ZSAhPSBOVUxMKSB7CgkJCW1l
bXNldChscmVzLT5hdHRyaWJ1dGUsIDAsIHN0cmxlbihscmVzLT52YWx1ZSkpOwoJCQlmcmVlKGxy
ZXMtPmF0dHJpYnV0ZSk7CQoJCX0KCgkJaWYgKGxyZXMtPnZhbHVlICE9IE5VTEwpIHsKCQkJbWVt
c2V0KGxyZXMtPnZhbHVlLCAwLCBzdHJsZW4obHJlcy0+dmFsdWUpKTsKCQkJZnJlZShscmVzLT52
YWx1ZSk7CQoJCX0KCgkJbHJlcy0+bmV4dCA9IE5VTEw7CgoJCWZyZWUobHJlcyk7Cgl9CgoJcmV0
dXJuOwp9CgpzdGF0aWMgaW50IGxha19jaGVja19wYXNzd29yZChjb25zdCBjaGFyICpoYXNoLCBj
b25zdCBjaGFyICpwYXNzd2QsIHZvaWQgKnJvY2spIAp7CglpbnQgaSwgaGxlbjsKCWludCByYzsK
CglpZiAoaGFzaCA9PSBOVUxMIHx8IGhhc2hbMF0gPT0gJ1wwJykgewoJCXJldHVybiBMQUtfRkFJ
TDsKCX0KCglpZiAocGFzc3dkID09IE5VTEwgfHwgcGFzc3dkWzBdID09ICdcMCcpIHsKCQlyZXR1
cm4gTEFLX0ZBSUw7Cgl9CgoJZm9yIChpID0gMDsgcGFzc3dvcmRfc2NoZW1lW2ldLmhhc2ggIT0g
TlVMTDsgaSsrKSB7CgoJCWhsZW4gPSBzdHJsZW4ocGFzc3dvcmRfc2NoZW1lW2ldLmhhc2gpOwoJ
CWlmICghc3RybmNhc2VjbXAocGFzc3dvcmRfc2NoZW1lW2ldLmhhc2gsIGhhc2gsIGhsZW4pKSB7
CgkJCWlmIChwYXNzd29yZF9zY2hlbWVbaV0uY2hlY2spIHsKCQkJCXJjID0gKHBhc3N3b3JkX3Nj
aGVtZVtpXS5jaGVjaykoaGFzaCtobGVuLCBwYXNzd2QsCgkJCQkJCQkJcGFzc3dvcmRfc2NoZW1l
W2ldLnJvY2spOwoJCQl9CgkJCXJldHVybiByYzsKCQl9Cgl9CgoJcmV0dXJuIHN0cmNtcChoYXNo
LCBwYXNzd2QpID8gTEFLX0ZBSUwgOiBMQUtfT0s7Cn0KCiNpZmRlZiBIQVZFX09QRU5TU0wKCnN0
YXRpYyBpbnQgbGFrX2Jhc2U2NF9kZWNvZGUoY29uc3QgY2hhciAqc3JjLCBjaGFyICoqcmV0LCBp
bnQgKnJsZW4pIHsKCglpbnQgcmMsIGksIHRsZW4gPSAwOwoJY2hhciAqdGV4dDsKCUVWUF9FTkNP
REVfQ1RYIEVWUF9jdHg7CgoJdGV4dCA9IChjaGFyICopbWFsbG9jKCgoc3RybGVuKHNyYykrMykv
NCAqIDMpICsgMSk7CglpZiAodGV4dCA9PSBOVUxMKSB7CgkJcmV0dXJuIExBS19OT01FTTsKCX0K
CglFVlBfRGVjb2RlSW5pdCgmRVZQX2N0eCk7CglyYyA9IEVWUF9EZWNvZGVVcGRhdGUoJkVWUF9j
dHgsIHRleHQsICZpLCAoY2hhciAqKXNyYywgc3RybGVuKHNyYykpOwoJaWYgKHJjIDwgMCkgewoJ
CWZyZWUodGV4dCk7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoJdGxlbiArPSBpOwoJRVZQX0RlY29k
ZUZpbmFsKCZFVlBfY3R4LCB0ZXh0LCAmaSk7IAoKCSpyZXQgPSB0ZXh0OwoJaWYgKHJsZW4gIT0g
TlVMTCkgewoJCSpybGVuID0gdGxlbjsKCX0KCglyZXR1cm4gTEFLX09LOwp9CgpzdGF0aWMgaW50
IGxha19jaGVja19oYXNoZWQoY29uc3QgY2hhciAqaGFzaCwgY29uc3QgY2hhciAqcGFzc3dkLCB2
b2lkICpyb2NrKQp7CglpbnQgcmMsIGNsZW47CglzdHJ1Y3QgaGFzaF9yb2NrICpocm9jayA9IChz
dHJ1Y3QgaGFzaF9yb2NrICopIHJvY2s7CglFVlBfTURfQ1RYIG1kY3R4OwoJY29uc3QgRVZQX01E
ICptZDsKCXVuc2lnbmVkIGNoYXIgZGlnZXN0W0VWUF9NQVhfTURfU0laRV07CgljaGFyICpjcmVk
OwoKCW1kID0gRVZQX2dldF9kaWdlc3RieW5hbWUoaHJvY2stPm1kYSk7CglpZiAoIW1kKSB7CgkJ
cmV0dXJuIExBS19GQUlMOwoJfQoKCXJjID0gbGFrX2Jhc2U2NF9kZWNvZGUoaGFzaCwgJmNyZWQs
ICZjbGVuKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlyZXR1cm4gcmM7Cgl9CgoJRVZQX0RpZ2Vz
dEluaXQoJm1kY3R4LCBtZCk7CglFVlBfRGlnZXN0VXBkYXRlKCZtZGN0eCwgcGFzc3dkLCBzdHJs
ZW4ocGFzc3dkKSk7CglpZiAoaHJvY2stPnNhbHRlZCkgewoJCUVWUF9EaWdlc3RVcGRhdGUoJm1k
Y3R4LCAmY3JlZFtFVlBfTURfc2l6ZShtZCldLAoJCQkJIGNsZW4gLSBFVlBfTURfc2l6ZShtZCkp
OwoJfQoJRVZQX0RpZ2VzdEZpbmFsKCZtZGN0eCwgZGlnZXN0LCBOVUxMKTsKCglyYyA9IG1lbWNt
cCgoY2hhciAqKWNyZWQsIChjaGFyICopZGlnZXN0LCBFVlBfTURfc2l6ZShtZCkpOwoJZnJlZShj
cmVkKTsKCXJldHVybiByYyA/IExBS19GQUlMIDogTEFLX09LOwp9CgojZW5kaWYgLyogSEFWRV9P
UEVOU1NMICovCgpzdGF0aWMgaW50IGxha19jaGVja19jcnlwdChjb25zdCBjaGFyICpoYXNoLCBj
b25zdCBjaGFyICpwYXNzd2QsIHZvaWQgKnJvY2spIAp7CgljaGFyICpjcmVkOwoKCWlmIChoYXNo
ID09IE5VTEwgfHwgaGFzaFswXSA9PSAnXDAnKSB7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWlm
IChwYXNzd2QgPT0gTlVMTCB8fCBwYXNzd2RbMF0gPT0gJ1wwJykgewoJCXJldHVybiBMQUtfRkFJ
TDsKCX0KCglpZiAoc3RybGVuKGhhc2gpIDwgMiApIHsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJ
Y3JlZCA9IGNyeXB0KHBhc3N3ZCwgaGFzaCk7CglpZiggY3JlZCA9PSBOVUxMIHx8IGNyZWRbMF0g
PT0gJ1wwJyApIHsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmV0dXJuIHN0cmNtcChoYXNoLCBj
cmVkKSA/IExBS19GQUlMIDogTEFLX09LOwp9CgojZW5kaWYgLyogQVVUSF9MREFQICovCg==
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>125</attachid>
            <date>2003-02-26 02:16 EDT</date>
            <desc>Patched lak.h</desc>
            <filename>lak.h</filename>
            <type>text/plain</type>
            <size>3304</size>
            <attacher>psacha@blue-cable.net</attacher>
            
              <data encoding="base64">LyogQ09QWVJJR0hUCiAqIENvcHlyaWdodCAoYykgMjAwMi0yMDAyIElnb3IgQnJlemFjCiAqIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNl
IGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAogKiBtb2RpZmljYXRpb24sIGFyZSBw
ZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKICogYXJlIG1l
dDoKICogMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBh
Ym92ZSBjb3B5cmlnaHQKICogICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQg
dGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgogKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5
IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAogKiAgICBub3RpY2UsIHRo
aXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhl
CiAqICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRo
IHRoZSBkaXN0cmlidXRpb24uCiAqCiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgSUdP
UiBCUkVaQUMuIGBgQVMgSVMnJyBBTkQgQU5ZCiAqIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5U
SUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFCiAqIElNUExJRUQgV0FSUkFO
VElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUgogKiBQ
VVJQT1NFIEFSRSBESVNDTEFJTUVELiAgSU4gTk8gRVZFTlQgU0hBTEwgSUdPUiBCUkVaQUMgT1IK
ICogSVRTIEVNUExPWUVFUyBPUiBBR0VOVFMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJ
UkVDVCwKICogSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFM
IERBTUFHRVMgKElOQ0xVRElORywKICogQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBP
RiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTCiAqIE9GIFVTRSwgREFUQSwgT1Ig
UFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQKICog
T04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBM
SUFCSUxJVFksIE9SCiAqIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkg
QVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUKICogVVNFIE9GIFRISVMgU09GVFdBUkUsIEVW
RU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSAogKiBEQU1BR0UuCiAqIEVO
RCBDT1BZUklHSFQgKi8KCiNpZm5kZWYgX0xBS19ICiNkZWZpbmUgX0xBS19ICgojaW5jbHVkZSA8
bGRhcC5oPgojaW5jbHVkZSA8bGJlci5oPgoKI2lmIFRJTUVfV0lUSF9TWVNfVElNRQojIGluY2x1
ZGUgPHN5cy90aW1lLmg+CiMgaW5jbHVkZSA8dGltZS5oPgojZWxzZQojIGlmIEhBVkVfU1lTX1RJ
TUVfSAojICBpbmNsdWRlIDxzeXMvdGltZS5oPgojIGVsc2UKIyAgaW5jbHVkZSA8dGltZS5oPgoj
IGVuZGlmCiNlbmRpZgoKI2RlZmluZSBMQUtfT0sgMAojZGVmaW5lIExBS19GQUlMIC0xCiNkZWZp
bmUgTEFLX05PRU5UIC0yCiNkZWZpbmUgTEFLX05PTUVNIC0zCgojZGVmaW5lIExBS19OT1RfQk9V
TkQgMAojZGVmaW5lIExBS19CSU5EX0FOT05ZTU9VUyAxCiNkZWZpbmUgTEFLX0JJTkRfQVNfVVNF
UiAyCgojZGVmaW5lIExBS19BVVRIX01FVEhPRF9CSU5EIDAKI2RlZmluZSBMQUtfQVVUSF9NRVRI
T0RfQ1VTVE9NIDEKI2RlZmluZSBMQUtfQVVUSF9NRVRIT0RfRkFTVEJJTkQgMgoKdHlwZWRlZiBz
dHJ1Y3QgbGFrX2NvbmYgewogICAgY2hhciAgICpwYXRoOwogICAgY2hhciAgICpzZXJ2ZXJzOwog
ICAgY2hhciAgICpiaW5kX2RuOwogICAgY2hhciAgICpiaW5kX3B3OwogICAgaW50ICAgICB2ZXJz
aW9uOwogICAgc3RydWN0ICB0aW1ldmFsIHRpbWVvdXQ7CiAgICBpbnQgICAgIHNpemVfbGltaXQ7
CiAgICBpbnQgICAgIHRpbWVfbGltaXQ7CiAgICBpbnQgICAgIGRlcmVmOwogICAgaW50ICAgICBy
ZWZlcnJhbHM7CiAgICBpbnQgICAgIHJlc3RhcnQ7CiAgICBsb25nICAgIGNhY2hlX3R0bDsKICAg
IGxvbmcgICAgY2FjaGVfbWVtOwogICAgaW50ICAgICBzY29wZTsKICAgIGNoYXIgICAqc2VhcmNo
X2Jhc2U7CiAgICBjaGFyICAgKmZpbHRlcjsKICAgIGNoYXIgICAqZ3JvdXBfZG47CiAgICBjaGFy
ICAgKmdyb3VwX2F0dHI7CiAgICBjaGFyICAgKnBhc3N3b3JkX2F0dHI7CiAgICBjaGFyICAgIGF1
dGhfbWV0aG9kOwogICAgaW50ICAgICB0bHNfY2hlY2tfcGVlcjsKICAgIGNoYXIgICAqdGxzX2Nh
Y2VydF9maWxlOwogICAgY2hhciAgICp0bHNfY2FjZXJ0X2RpcjsKICAgIGNoYXIgICAqdGxzX2Np
cGhlcnM7CiAgICBjaGFyICAgKnRsc19jZXJ0OwogICAgY2hhciAgICp0bHNfa2V5OwogICAgaW50
ICAgICBkZWJ1ZzsKfSBMQUtfQ09ORjsKCnR5cGVkZWYgc3RydWN0IGxhayB7CiAgICBMREFQICAg
ICAqbGQ7CiAgICBjaGFyICAgICAgYmluZF9zdGF0dXM7CiAgICBMQUtfQ09ORiAqY29uZjsKfSBM
QUs7Cgp0eXBlZGVmIHN0cnVjdCBsYWtfcmVzdWx0IHsKICAgIGNoYXIgICAgICAgICAgICAgICph
dHRyaWJ1dGU7CiAgICBjaGFyICAgICAgICAgICAgICAqdmFsdWU7CiAgICBzaXplX3QgICAgICAg
ICAgICAgbGVuOwogICAgc3RydWN0IGxha19yZXN1bHQgKm5leHQ7Cn0gTEFLX1JFU1VMVDsKCmlu
dCBsYWtfaW5pdChjb25zdCBjaGFyICosIExBSyAqKik7CnZvaWQgbGFrX2Nsb3NlKExBSyAqKTsK
LyogaW50IGxha19hdXRoZW50aWNhdGUoTEFLICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAq
LCBjb25zdCBjaGFyICopOwppbnQgbGFrX3JldHJpZXZlKExBSyAqLCBjb25zdCBjaGFyICosIGNv
bnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKiwgTEFLX1JFU1VMVCAqKik7ICovCmludCBsYWtfYXV0
aGVudGljYXRlKExBSyAqbGFrLCBjb25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpzZXJ2aWNl
LCBjb25zdCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqcGFzc3dvcmQpOwppbnQgbGFrX3JldHJp
ZXZlKExBSyAqbGFrLCBjb25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpzZXJ2aWNlLCBjb25z
dCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqKmF0dHJzLCBMQUtfUkVTVUxUICoqcmV0KTsKdm9p
ZCBsYWtfcmVzdWx0X2ZyZWUoTEFLX1JFU1VMVCAqKTsKCiNlbmRpZiAgLyogX0xBS19IICovCg==
</data>        

          </attachment>
      

    </bug>

</bugzilla>