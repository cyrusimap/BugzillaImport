<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>3222</bug_id>
          
          <creation_ts>2010-05-20 12:08 EDT</creation_ts>
          <short_desc>add verbose logging (-l) to sync_server and some additional logging in client</short_desc>
          <delta_ts>2010-05-20 12:08:33 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>Replication</component>
          <version>2.3.x</version>
          <rep_platform>PC</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>NEW</bug_status>
          
          
          
          
          
          <priority>P5</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Brian Awood">bawood@umich.edu</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          <cc>wes@umich.edu</cc>
          

      

      

      
          <long_desc isprivate="0">
            <who name="Brian Awood">bawood@umich.edu</who>
            <bug_when>2010-05-20 12:08:33 EDT</bug_when>
            <thetext>Created an attachment (id=1274)
patch to add better sync logging

Lets face it, sync_server&apos;s logging sucks.  This is Paul&apos;s patch to add a -l, verbose logging to sync_server, similar to sync_client.  It also adds some extra logging to sync_client that logs what messages are being uploaded to which mailbox.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1274</attachid>
            <date>2010-05-20 12:08 EDT</date>
            <desc>patch to add better sync logging</desc>
            <filename>0001-Add-verbose-logging-to-sync_server-additional-logs-t.patch</filename>
            <type>text/plain</type>
            <size>9599</size>
            <attacher>bawood@umich.edu</attacher>
            
              <data encoding="base64">RnJvbSA2ZmY2MmE0N2VlZDU5NTczMzc0NDdhOTA5YjFiYzk2Y2NlNWZmMjgwIE1vbiBTZXAgMTcg
MDA6MDA6MDAgMjAwMQpGcm9tOiBQYXVsIFR1cmd5YW4gPHB0dXJneWFuQHVtaWNoLmVkdT4KRGF0
ZTogTW9uLCAxMCBBdWcgMjAwOSAxMTozMTozNSAtMDQwMApTdWJqZWN0OiBbUEFUQ0hdIEFkZCB2
ZXJib3NlIGxvZ2dpbmcgdG8gc3luY19zZXJ2ZXIgJiBhZGRpdGlvbmFsIGxvZ3MgdG8gc3luY19j
bGllbnQKClRoaXMgcGF0Y2ggYWRkcyBhIHZlcmJvc2UgIi1sIiBsb2dnaW5nIG9wdGlvbiB0byBz
eW5jX3NlcnZlci4gIEl0CmFsc28gYWRkcyBhZGRpdGlvbmFsIGxvZ2dpbmcgdG8gc3luY19jbGll
bnQgdG8gbG9nIG1vcmUgZGV0YWlsZWQKbWFpbGJveC9tZXNzYWdlIGluZm8uIEFsc28gZGlzYWJs
ZXMgcHJldHR5IHVzZWxlc3MgVW5sb2NrZWQKZGVidWcgbG9nIG1lc3NhZ2UuCi0tLQogaW1hcC9z
eW5jX2NsaWVudC5jIHwgICAzNSArKysrKysrKysrKysrKysrCiBpbWFwL3N5bmNfc2VydmVyLmMg
fCAgMTEzICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKystLS0t
LQogMiBmaWxlcyBjaGFuZ2VkLCAxMzcgaW5zZXJ0aW9ucygrKSwgMTEgZGVsZXRpb25zKC0pCgpk
aWZmIC0tZ2l0IGEvaW1hcC9zeW5jX2NsaWVudC5jIGIvaW1hcC9zeW5jX2NsaWVudC5jCmluZGV4
IDRkY2I4NjIuLmExMGUxNjAgMTAwNjQ0Ci0tLSBhL2ltYXAvc3luY19jbGllbnQuYworKysgYi9p
bWFwL3N5bmNfY2xpZW50LmMKQEAgLTkxLDYgKzkxLDggQEAKICNpbmNsdWRlICJzaWduYWxzLmgi
CiAjaW5jbHVkZSAiY3lydXNkYi5oIgogCisjZGVmaW5lIE1BWFNZU0xPR0JVRiA0MDk2CisKIC8q
IHNpZ25hbCB0byBjb25maWcuYyAqLwogY29uc3QgaW50IGNvbmZpZ19uZWVkX2RhdGEgPSAwOyAg
LyogWVlZICovCiAKQEAgLTEzMzYsOCArMTMzOCwxNiBAQCBzdGF0aWMgaW50IGluZGV4X2xpc3Rf
d29yayhzdHJ1Y3QgbWFpbGJveCAqbWFpbGJveCwKICAgICBpbnQgYyA9ICcgJzsKICAgICBzdGF0
aWMgc3RydWN0IGJ1ZiB0b2tlbjsgICAvKiBCU1MgKi8KIAorICAgIGludCB0b3RhbGJ1ZmxlbjsK
KyAgICBjaGFyIHN5c2xvZ2J1ZltNQVhTWVNMT0dCVUZdOyAKKyAgICBpbnQgcGVuZGluZ19sb2c7
CisgICAgaW50IGxlbjsKKwogICAgIGlmIChpbmRleF9saXN0LT5jb3VudCA9PSAwKSByZXR1cm4o
MCk7CiAKKyAgICBpZiAodmVyYm9zZV9sb2dnaW5nICkgeworCXN5c2xvZyAoTE9HX0lORk8sICJV
UExPQUQgbWFpbGJveDogJXMgJWxkIG1lc3NhZ2UgZmlsZXMiLCBtYWlsYm94LT5uYW1lLCBpbmRl
eF9saXN0LT5jb3VudCk7CisgICAgfQogICAgIHByb3RfcHJpbnRmKHRvc2VydmVyLCAiVVBMT0FE
ICVsdSAlbHUiLAogICAgICAgICAgICAgICAgIGluZGV4X2xpc3QtPmxhc3RfdWlkLCBtYWlsYm94
LT5sYXN0X2FwcGVuZGRhdGUpOyAKIApAQCAtMTM3Miw2ICsxMzgyLDI4IEBAIHN0YXRpYyBpbnQg
aW5kZXhfbGlzdF93b3JrKHN0cnVjdCBtYWlsYm94ICptYWlsYm94LAogCiAgICAgICAgIHN5c2xv
ZyhMT0dfSU5GTywgIlVQTE9BRDogcmVjZWl2ZWQgUkVTVEFSVCIpOwogICAgIH0KKyAgICBpZiAo
dmVyYm9zZV9sb2dnaW5nICkgeworCXRvdGFsYnVmbGVuID0gc25wcmludGYgKHN5c2xvZ2J1Ziwg
TUFYU1lTTE9HQlVGLAorICAgICAgICAgICAgICAgICJVUExPQUQgbWFpbGJveDogJXMgbWVzc2Fn
ZSBmaWxlOiIsIG1haWxib3gtPm5hbWUpOworCXBlbmRpbmdfbG9nID0gMDsKKworCWZvciAoaW5k
ZXggPSBpbmRleF9saXN0LT5oZWFkOyBpbmRleDsgaW5kZXggPSBpbmRleC0+bmV4dCkgeworCSAg
ICBpZiAoIHRvdGFsYnVmbGVuICsgMTAgPiBNQVhTWVNMT0dCVUYgKSB7CisJCXN5c2xvZyAoTE9H
X0lORk8sICIlcyIsIHN5c2xvZ2J1Zik7CisJCXRvdGFsYnVmbGVuID0gc25wcmludGYgKHN5c2xv
Z2J1ZiwgTUFYU1lTTE9HQlVGLAorCQkJIlVQTE9BRCBtYWlsYm94OiAlcyBtZXNzYWdlIGZpbGU6
IiwgbWFpbGJveC0+bmFtZSk7IAorCQlwZW5kaW5nX2xvZyA9IDA7CisJICAgIH0KKwkgICAgbGVu
ID0gc25wcmludGYgKCZzeXNsb2didWZbdG90YWxidWZsZW5dLAorCQkJCU1BWFNZU0xPR0JVRiAt
IHRvdGFsYnVmbGVuLAorCQkJCSIgJWx1LiIsICh1bnNpZ25lZCBsb25nKWluZGV4LT5yZWNvcmQu
dWlkKTsKKwkgICAgdG90YWxidWZsZW4gPSB0b3RhbGJ1ZmxlbiArIGxlbjsKKwkgICAgcGVuZGlu
Z19sb2cgPSAxOworCX0KKwlpZiAocGVuZGluZ19sb2cpIHsKKwkgICAgc3lzbG9nIChMT0dfSU5G
TywgIiVzIiwgc3lzbG9nYnVmKTsKKwl9CisgICAgfQogCiAgICAgcmV0dXJuKDApOwogfQpAQCAt
MjQyNCw2ICsyNDU2LDkgQEAgc3RhdGljIGludCBkb191c2VyX3NlZW4oY2hhciAqdXNlcikKICAg
ICBjbG9zZShmaWxlZmQpOwogICAgIGZyZWUoc2Vlbl9maWxlKTsKIAorICAgIGlmICh2ZXJib3Nl
X2xvZ2dpbmcpIHsKKwlzeXNsb2coTE9HX0lORk8sICJTRVRTRUVOX0FMTCAlcyIsIHVzZXIpOwor
ICAgIH0KICAgICAvKiBVcGRhdGUgc2VlbiBkYiAqLwogICAgIHByb3RfcHJpbnRmKHRvc2VydmVy
LCAiU0VUU0VFTl9BTEwgIik7CiAgICAgc3luY19wcmludGFzdHJpbmcodG9zZXJ2ZXIsIHVzZXIp
OwpkaWZmIC0tZ2l0IGEvaW1hcC9zeW5jX3NlcnZlci5jIGIvaW1hcC9zeW5jX3NlcnZlci5jCmlu
ZGV4IGIyZjBhN2IuLmU2Nzk4ZGEgMTAwNjQ0Ci0tLSBhL2ltYXAvc3luY19zZXJ2ZXIuYworKysg
Yi9pbWFwL3N5bmNfc2VydmVyLmMKQEAgLTEwNSw2ICsxMDUsOCBAQAogI2luY2x1ZGUgInN5bmNf
Y29tbWl0LmgiCiAvKiNpbmNsdWRlICJjZGIuaCIqLwogCisjZGVmaW5lIE1BWFNZU0xPR0JVRiA0
MDk2CisKIGV4dGVybiBpbnQgb3B0aW5kOwogZXh0ZXJuIGNoYXIgKm9wdGFyZzsKIGV4dGVybiBp
bnQgb3B0ZXJyOwpAQCAtMTEzLDYgKzExNSw3IEBAIGV4dGVybiBpbnQgb3B0ZXJyOwogY29uc3Qg
aW50IGNvbmZpZ19uZWVkX2RhdGEgPSAwOwogCiBzdGF0aWMgc2FzbF9zc2ZfdCBleHRwcm9wc19z
c2YgPSAwOworaW50ICAgIHZlcmJvc2VfbG9nZ2luZzsKIAogLyogU3R1ZmYgdG8gbWFrZSBpbmRl
eC5jIGxpbmsgKi8KIGludCBpbWFwZF9leGlzdHM7CkBAIC0zMTIsMTEgKzMxNSwxNCBAQCBpbnQg
c2VydmljZV9pbml0KGludCBhcmdjIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAogICAgIC8qIGxv
YWQgdGhlIFNBU0wgcGx1Z2lucyAqLwogICAgIGdsb2JhbF9zYXNsX2luaXQoMSwgMSwgbXlzYXNs
X2NiKTsKIAotICAgIHdoaWxlICgob3B0ID0gZ2V0b3B0KGFyZ2MsIGFyZ3YsICJwOiIpKSAhPSBF
T0YpIHsKKyAgICB3aGlsZSAoKG9wdCA9IGdldG9wdChhcmdjLCBhcmd2LCAicDpsIikpICE9IEVP
RikgewogCXN3aXRjaChvcHQpIHsKIAljYXNlICdwJzogLyogZXh0ZXJuYWwgcHJvdGVjdGlvbiAq
LwogCSAgICBleHRwcm9wc19zc2YgPSBhdG9pKG9wdGFyZyk7CiAJICAgIGJyZWFrOworCWNhc2Ug
J2wnOiAvKiB2ZXJib3NlIExvZ2dpbmcgKi8KKwkgICAgdmVyYm9zZV9sb2dnaW5nKys7CisJICAg
IGJyZWFrOwogCWRlZmF1bHQ6CiAJICAgIHVzYWdlKCk7CiAJfQpAQCAtMTQxNywxMCArMTQyMywx
NCBAQCBzdGF0aWMgdm9pZCBjbWRfdW5sb2NrKHN0cnVjdCBzeW5jX2xvY2sgKmxvY2ssIGludCBy
ZXN0YXJ0KQogCQkgICAgZXJyb3JfbWVzc2FnZShyKSk7CiAgICAgfSBlbHNlIGlmIChyZXN0YXJ0
KSB7CiAgICAgICAgIHByb3RfcHJpbnRmKHN5bmNfb3V0LCAiT0sgW1JFU1RBUlRdIFVubG9ja2Vk
XHJcbiIpOworI2lmIDAKICAgICAgICAgc3lzbG9nKExPR19ERUJVRywgIlVubG9ja2VkIFtSRVNU
QVJUXSIpOworI2VuZGlmCiAgICAgfSBlbHNlIHsKICAgICAgICAgcHJvdF9wcmludGYoc3luY19v
dXQsICJPSyBbQ09OVElOVUVdIFVubG9ja2VkXHJcbiIpOworI2lmIDAKICAgICAgICAgc3lzbG9n
KExPR19ERUJVRywgIlVubG9ja2VkIik7CisjZW5kaWYKICAgICB9CiB9CiAKQEAgLTE2MTksMTEg
KzE2MjksMTggQEAgc3RhdGljIHZvaWQgY21kX3NldHF1b3RhKGNoYXIgKnJvb3QsIGludCBsaW1p
dCkKICAgICAvKiBOQjogTWluaW1hbCBpbnRlcmZhY2Ugd2l0aG91dCB0d28gcGhhc2UgZXhwdW5n
ZSAqLwogICAgIHIgPSBtYm94bGlzdF9zZXRxdW90YShyb290LCBsaW1pdCwgMSk7CiAKLSAgICBp
ZiAocikKKyAgICBpZiAocikgewogICAgICAgICBwcm90X3ByaW50ZihzeW5jX291dCwgIk5PIFNl
dFF1b3RhIGZhaWxlZCAlczogJXNcclxuIiwKICAgICAgICAgICAgICAgICAgcm9vdCwgZXJyb3Jf
bWVzc2FnZShyKSk7Ci0gICAgZWxzZQorCWlmICh2ZXJib3NlX2xvZ2dpbmcpIHsKKwkgICAgc3lz
bG9nKExPR19JTkZPLCAiU0VUUVVPVEE6ICVzIGxpbWl0OiAlZCBGYWlsZWQiLCByb290LCBsaW1p
dCk7CisJfQorICAgIH0gZWxzZSB7CiAgICAgICAgIHByb3RfcHJpbnRmKHN5bmNfb3V0LCAiT0sg
U2V0UXVvdGEgc3VjY2VlZGVkXHJcbiIpOworCWlmICh2ZXJib3NlX2xvZ2dpbmcpIHsKKwkgICAg
c3lzbG9nKExPR19JTkZPLCAiU0VUUVVPVEE6ICVzIGxpbWl0OiAlZCBTdWNjZWVkZWQiLCByb290
LCBsaW1pdCk7CisJfQorICAgIH0KIH0KIAogLyogPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PSAqLwpAQCAtMTg3NSw2
ICsxODkyLDExIEBAIHN0YXRpYyB2b2lkIGNtZF91cGxvYWQoc3RydWN0IG1haWxib3ggKm1haWxi
b3gsCiAgICAgaW50ICAgciA9IDA7CiAgICAgY2hhciAqZXJyOwogCisgICAgaW50IHRvdGFsYnVm
bGVuOworICAgIGNoYXIgc3lzbG9nYnVmW01BWFNZU0xPR0JVRl07CisgICAgaW50IHBlbmRpbmdf
bG9nOworICAgIGludCBsZW47CisKICAgICAqcmVzdGFydCA9IDA7CiAKICAgICBpZiAoIW1haWxi
b3gpIHsKQEAgLTE4ODgsNiArMTkxMCw5IEBAIHN0YXRpYyB2b2lkIGNtZF91cGxvYWQoc3RydWN0
IG1haWxib3ggKm1haWxib3gsCiAJcHJvdF9wcmludGYoc3luY19vdXQsICJOTyAlc1xyXG4iLCBl
cnJvcl9tZXNzYWdlKHIpKTsKIAlyZXR1cm47CiAgICAgfQorICAgIGlmICh2ZXJib3NlX2xvZ2dp
bmcgKSB7CisJc3lzbG9nIChMT0dfSU5GTywgIlVQTE9BRCBtYWlsYm94OiAlcyBzdGFydGluZyIs
IG1haWxib3gtPm5hbWUpOworICAgIH0KIAogICAgIHVwbG9hZF9saXN0ID0gc3luY191cGxvYWRf
bGlzdF9jcmVhdGUobmV3X2xhc3RfdWlkLCBtYWlsYm94LT5mbGFnbmFtZSk7CiAKQEAgLTIwNjIs
NiArMjA4NywyOCBAQCBzdGF0aWMgdm9pZCBjbWRfdXBsb2FkKHN0cnVjdCBtYWlsYm94ICptYWls
Ym94LAogICAgICAgICBwcm90X3ByaW50ZihzeW5jX291dCwgIk5PIEZhaWxlZCB0byBjb21taXQg
bWVzc2FnZSB1cGxvYWQgdG8gJXM6ICVzXHJcbiIsCiAgICAgICAgICAgICAgICAgIG1haWxib3gt
Pm5hbWUsIGVycm9yX21lc3NhZ2UocikpOwogICAgIH0gZWxzZSB7CisJaWYgKHZlcmJvc2VfbG9n
Z2luZyApIHsKKworCSAgICB0b3RhbGJ1ZmxlbiA9IHNucHJpbnRmIChzeXNsb2didWYsIE1BWFNZ
U0xPR0JVRiwKKwkJIlVQTE9BRCBtYWlsYm94OiAlcyBtZXNzYWdlIGZpbGU6IiwgbWFpbGJveC0+
bmFtZSk7CisJICAgIHBlbmRpbmdfbG9nID0gMDsKKwkgICAgZm9yIChpdGVtID0gdXBsb2FkX2xp
c3QtPmhlYWQgOyBpdGVtIDsgaXRlbSA9IGl0ZW0tPm5leHQpIHsKKwkJaWYgKCB0b3RhbGJ1Zmxl
biArIDEwID4gTUFYU1lTTE9HQlVGICkgeworCQkgICAgc3lzbG9nIChMT0dfSU5GTywgIiVzIiwg
c3lzbG9nYnVmKTsKKwkJICAgIHRvdGFsYnVmbGVuID0gc25wcmludGYgKHN5c2xvZ2J1ZiwgTUFY
U1lTTE9HQlVGLAorCQkJIlVQTE9BRCBtYWlsYm94OiAlcyBtZXNzYWdlIGZpbGU6IiwgbWFpbGJv
eC0+bmFtZSk7CisJICAgIAkgICAgcGVuZGluZ19sb2cgPSAwOworCQl9CisJCWxlbiA9IHNucHJp
bnRmICgmc3lzbG9nYnVmW3RvdGFsYnVmbGVuXSwgCisJCQkJTUFYU1lTTE9HQlVGIC0gdG90YWxi
dWZsZW4sCisJCQkJIiAlbHUuIiwgKHVuc2lnbmVkIGxvbmcpaXRlbS0+dWlkKTsKKwkJdG90YWxi
dWZsZW4gPSB0b3RhbGJ1ZmxlbiArIGxlbjsKKwkJcGVuZGluZ19sb2cgPSAxOworCSAgICB9CisJ
ICAgIGlmIChwZW5kaW5nX2xvZykgeworCQlzeXNsb2cgKExPR19JTkZPLCAiJXMiLCBzeXNsb2di
dWYpOworCSAgICB9CisJfQogCWlmICgoKnJlc3RhcnQgPSBzeW5jX21lc3NhZ2VfbGlzdF9uZWVk
X3Jlc3RhcnQobWVzc2FnZV9saXN0KSkpCiAJICAgIHN5c2xvZyhMT0dfSU5GTywgIlVQTE9BRDog
aXNzdWluZyBSRVNUQVJUIik7CiAKQEAgLTIyMTAsMTEgKzIyNTcsMjAgQEAgc3RhdGljIHZvaWQg
Y21kX3NldHNlZW4oc3RydWN0IG1haWxib3ggKiptYWlsYm94cCwgY2hhciAqdXNlciwgY2hhciAq
bWJveG5hbWUsCiAgICAgICAgIHIgPSBzZWVuX3dyaXRlKHNlZW5kYiwgbGFzdHJlYWQsIGxhc3Rf
cmVjZW50X3VpZCwgbGFzdGNoYW5nZSwgc2VlbnVpZCk7CiAgICAgc2Vlbl9jbG9zZShzZWVuZGIp
OwogCi0gICAgaWYgKHIpCisgICAgaWYgKHIpIHsKICAgICAgICAgcHJvdF9wcmludGYoc3luY19v
dXQsICJOTyBTZXRzZWVuIEZhaWxlZCBvbiAlcyAlczogJXNcclxuIiwKICAgICAgICAgICAgICAg
ICAgdXNlciwgbWFpbGJveC0+bmFtZSwgZXJyb3JfbWVzc2FnZShyKSk7Ci0gICAgZWxzZQorCWlm
ICh2ZXJib3NlX2xvZ2dpbmcpIHsKKyAgICAgICAgICAgIHN5c2xvZyAoTE9HX0lORk8sICJTRVRT
RUVOIEZhaWxlZCBvbiAlcyAlczogJXNcclxuIiwKKyAgICAgICAgICAgICAgICAgdXNlciwgbWFp
bGJveC0+bmFtZSwgZXJyb3JfbWVzc2FnZShyKSk7CisJfQorICAgIH0gZWxzZSB7CiAgICAgICAg
IHByb3RfcHJpbnRmKHN5bmNfb3V0LCAiT0sgU2V0c2VlbiBTdWNlZWRlZFxyXG4iKTsKKyAgICAg
ICAgaWYgKHZlcmJvc2VfbG9nZ2luZykgeworCSAgICBzeXNsb2cgKExPR19JTkZPLCAiU0VUU0VF
TiBTdWNjZWVkZWQgb24gJXMgJXNcclxuIiwKKyAgICAgICAgICAgICAgICAgdXNlciwgbWFpbGJv
eC0+bmFtZSk7CisJfQorICAgIH0KIAogICAgIGZyZWUoc2VlbnVpZDApOwogfQpAQCAtMjI1Niwy
MiArMjMxMiwzOCBAQCBzdGF0aWMgdm9pZCBjbWRfc2V0c2Vlbl9hbGwoY2hhciAqdXNlciwgc3Ry
dWN0IGJ1ZiAqZGF0YSkKIAogICAgIGZyZWUoc2Vlbl9maWxlKTsKIAotICAgIGlmIChyKQorICAg
IGlmIChyKSB7CiAgICAgICAgIHByb3RfcHJpbnRmKHN5bmNfb3V0LCAiTk8gU2V0c2Vlbl9hbGwg
RmFpbGVkIG9uICVzOiAlc1xyXG4iLAogICAgICAgICAgICAgICAgICB1c2VyLCBlcnJvcl9tZXNz
YWdlKHIpKTsKLSAgICBlbHNlCisJaWYgKHZlcmJvc2VfbG9nZ2luZykgeworICAgICAgICAgICAg
c3lzbG9nIChMT0dfSU5GTywgIlNFVFNFRU5fQUxMIEZhaWxlZCBvbiAlczogJXNcclxuIiwKKyAg
ICAgICAgICAgICAgICAgdXNlciwgIGVycm9yX21lc3NhZ2UocikpOworCX0KKyAgICB9IGVsc2Ug
ewogICAgICAgICBwcm90X3ByaW50ZihzeW5jX291dCwgIk9LIFNldHNlZW5fYWxsIFN1Y2VlZGVk
XHJcbiIpOworICAgICAgICBpZiAodmVyYm9zZV9sb2dnaW5nKSB7CisJICAgIHN5c2xvZyAoTE9H
X0lORk8sICJTRVRTRUVOX0FMTCBTdWNjZWVkZWQgb24gJXNcclxuIiwKKyAgICAgICAgICAgICAg
ICAgdXNlcik7CisJfQorICAgfQogfQogCiBzdGF0aWMgdm9pZCBjbWRfc2V0YWNsKGNoYXIgKm5h
bWUsIGNoYXIgKmFjbCkKIHsKICAgICBpbnQgciA9IG1ib3hsaXN0X3N5bmNfc2V0YWNscyhuYW1l
LCBhY2wpOwogCi0gICAgaWYgKHIpCisgICAgaWYgKHIpIHsKICAgICAgICAgcHJvdF9wcmludGYo
c3luY19vdXQsCiAgICAgICAgICAgICAgICAgICJOTyBTZXRBY2wgRmFpbGVkIGZvciAlczogJXNc
clxuIiwgbmFtZSwgZXJyb3JfbWVzc2FnZShyKSk7Ci0gICAgZWxzZQorCWlmICh2ZXJib3NlX2xv
Z2dpbmcpIHsKKwkgICAgc3lzbG9nKExPR19JTkZPLCAiU0VUQUNMOiAlcyBhY2w6ICVzIEZBSUxF
RCIsIG5hbWUsIGFjbCk7CisJfQorICAgIH0gZWxzZSB7CiAgICAgICAgIHByb3RfcHJpbnRmKHN5
bmNfb3V0LCAiT0sgU2V0QWNsIFN1Y2VlZGVkXHJcbiIpOworCWlmICh2ZXJib3NlX2xvZ2dpbmcp
IHsKKwkgICAgc3lzbG9nKExPR19JTkZPLCAiU0VUQUNMOiAlcyBhY2w6ICVzIFN1Y2NlZGVkIiwg
bmFtZSwgYWNsKTsKKwl9CisgICAgfQogfQogCiAvKiA9PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICovCkBAIC0yNTg4
LDcgKzI2NjAsMTIgQEAgc3RhdGljIHZvaWQgY21kX21haWxib3hlcygpCiAKICAgICBwcm90X3By
aW50ZihzeW5jX291dCwgIk9LIE1haWxib3hlcyBmaW5pc2hlZFxyXG4iKTsKIAotICAgIGZvciAo
aSA9IDAgOyBpIDwgY291bnQ7IGkrKykgZnJlZShmb2xkZXJfbmFtZVtpXSk7CisgICAgZm9yIChp
ID0gMCA7IGkgPCBjb3VudDsgaSsrKSB7CisJaWYgKHZlcmJvc2VfbG9nZ2luZykgeworCSAgICBz
eXNsb2cgKExPR19JTkZPLCAiTUFJTEJPWDogJXMiLCBmb2xkZXJfbmFtZVtpXSk7CisJfQorCWZy
ZWUoZm9sZGVyX25hbWVbaV0pOworICAgIH0KICAgICBmcmVlKGZvbGRlcl9uYW1lKTsKICAgICBy
ZXR1cm47CiAKQEAgLTI3MDUsNiArMjc4Miw5IEBAIHN0YXRpYyB2b2lkIGNtZF91c2VyKGNoYXIg
KnVzZXJpZCkKICAgICB9CiAKICAgICBwcm90X3ByaW50ZihzeW5jX291dCwgIk9LIFVzZXIgY29t
cGxldGVkXHJcbiIpOworICAgIGlmICh2ZXJib3NlX2xvZ2dpbmcpIHsKKwlzeXNsb2cgKExPR19J
TkZPLCAiVVNFUiAlcyIsIHVzZXJpZCk7CisgICAgfQogfQogCiAvKiA9PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ICov
CkBAIC0yODI3LDkgKzI5MDcsMjAgQEAgc3RhdGljIHZvaWQgY21kX2NoYW5nZXN1YihjaGFyICp1
c2VyLCBjaGFyICpuYW1lLCBpbnQgYWRkKQogICAgICAgICBwcm90X3ByaW50ZihzeW5jX291dCwg
Ik5PICVzICVzICVzIGZhaWxlZDogJXNcclxuIiwKIAkJICAgIGFkZCA/ICJBZGRzdWIiIDogIkRl
bHN1YiIsCiAJCSAgICB1c2VyLCBuYW1lLCBlcnJvcl9tZXNzYWdlKHIpKTsKLSAgICB9IGVsc2UK
KwlpZiAodmVyYm9zZV9sb2dnaW5nKSB7CisJICAgIHN5c2xvZyAoTE9HX0lORk8sICIlcyAlcyAl
cyBGYWlsZWQ6ICVzIiwKKwkJICAgIGFkZCA/ICJBRERTVUIiIDogIkRFTFNVQiIsCisJCSAgICB1
c2VyLCBuYW1lLCBlcnJvcl9tZXNzYWdlKHIpKTsKKwl9CisgICAgfSBlbHNlIHsKICAgICAgICAg
cHJvdF9wcmludGYoc3luY19vdXQsICJPSyAlcyBjb21wbGV0ZWRcclxuIiwKIAkJICAgIGFkZCA/
ICJBZGRzdWIiIDogIkRlbHN1YiIpOworCWlmICh2ZXJib3NlX2xvZ2dpbmcpIHsKKwkgICAgc3lz
bG9nIChMT0dfSU5GTywgIiVzICVzICVzIFN1Y2Nlc3MiLAorCQkgICAgYWRkID8gIkFERFNVQiIg
OiAiREVMU1VCIiwKKwkJICAgIHVzZXIsIG5hbWUpOworCX0KKyAgICB9CiB9CiAKIC8qID09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0gKi8KLS0gCjEuNy4xCgo=
</data>        

          </attachment>
      

    </bug>

</bugzilla>