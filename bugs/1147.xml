<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>1147</bug_id>
          
          <creation_ts>2002-02-14 17:18 EDT</creation_ts>
          <short_desc>sieve could use an &quot;include&quot; statement</short_desc>
          <delta_ts>2010-10-18 12:42:54 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>Sieve</component>
          <version>2.1.x</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          <priority>P2</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Chaskiel Grundman">cg2v+bugz@andrew.cmu.edu</reporter>
          <assigned_to name="Rob Siemborski">rjs3@andrew.cmu.edu</assigned_to>
          <cc>ken@oceana.com</cc>
    
    <cc>rjs3@andrew.cmu.edu</cc>
          

      

      

      
          <long_desc isprivate="0">
            <who name="Chaskiel Grundman">cg2v+bugz@andrew.cmu.edu</who>
            <bug_when>2002-02-14 17:18:21 EDT</bug_when>
            <thetext>It would be nice if I could include one seive script from another, so that
individual features could be self-contained in their own files.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">ken@oceana.com</who>
            <bug_when>2003-03-31 13:35:57 EDT</bug_when>
            <thetext>Created an attachment (id=160)
bytecode implementation of draft-daboo-sieve-include-00
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">ken@oceana.com</who>
            <bug_when>2003-03-31 13:45:06 EDT</bug_when>
            <thetext>Created an attachment (id=161)
bytecode implementation of draft-daboo-sieve-include-00
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Larry Greenfield">leg+cyrus@andrew.cmu.edu</who>
            <bug_when>2003-03-31 14:35:40 EDT</bug_when>
            <thetext>i will flame about why this isn&apos;t a sufficient solution when i have time to read
Cyrus&apos;s doc and criticize it more clearly.
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">ken@oceana.com</who>
            <bug_when>2003-03-31 14:37:55 EDT</bug_when>
            <thetext>Rob had already alerted me to put on my Nomex suit :)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">ken@oceana.com</who>
            <bug_when>2003-07-07 16:15:54 EDT</bug_when>
            <thetext>Created an attachment (id=201)
bytecode implementation of draft-daboo-sieve-include-00

updated against latest CVS</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">ken@oceana.com</who>
            <bug_when>2004-07-02 16:16:07 EDT</bug_when>
            <thetext>Created an attachment (id=291)
bytecode implementation of draft-daboo-sieve-include-01

Patch is against 2.3 branch.  Also modifies timsieved so that admins can manage
global scripts.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">ken@oceana.com</who>
            <bug_when>2004-07-16 10:50:38 EDT</bug_when>
            <thetext>Implemented in 2.3</thetext>
          </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>160</attachid>
            <date>2003-03-31 13:35 EDT</date>
            <desc>bytecode implementation of draft-daboo-sieve-include-00</desc>
            <filename>sieve-include.patch.gz</filename>
            <type>application/x-gzip</type>
            <size>6690</size>
            <attacher>ken@oceana.com</attacher>
            
              <data encoding="base64">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
ZvEB6fjyn6L+WYp6BQ4OvSNVZQAA
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>161</attachid>
            <date>2003-03-31 13:45 EDT</date>
            <desc>bytecode implementation of draft-daboo-sieve-include-00</desc>
            <filename>sieve-include.patch</filename>
            <type>text/plain</type>
            <size>25941</size>
            <attacher>ken@oceana.com</attacher>
            
              <data encoding="base64">SW5kZXg6IGltYXAvbG10cGQuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0
ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL2xtdHBkLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuOTku
Mi4yOQpkaWZmIC11IC1yMS45OS4yLjI5IGxtdHBkLmMKLS0tIGltYXAvbG10cGQuYwkzMSBNYXIg
MjAwMyAwMToxOTozMSAtMDAwMAkxLjk5LjIuMjkKKysrIGltYXAvbG10cGQuYwkzMSBNYXIgMjAw
MyAxODoxODo0MyAtMDAwMApAQCAtMzU4LDYgKzM1OCwzMiBAQAogICAgIH0KIH0KIAorI2RlZmlu
ZSBQRVJTT05BTF9QUkVGSVgJIi9wZXJzb25hbC8iCisjZGVmaW5lIEdMT0JBTF9QUkVGSVgJIi9n
bG9iYWwvIgorCitzdGF0aWMgaW50IHNpZXZlX2ZpbmRfc2NyaXB0KGNvbnN0IGNoYXIgKnVzZXIs
IGNvbnN0IGNoYXIgKnNjcmlwdCwKKwkJCSAgICAgY2hhciAqZm5hbWUsIHNpemVfdCBzaXplKTsK
Kworc3RhdGljIGludCBnZXRpbmNsdWRlKHZvaWQgKnNjLCBjb25zdCBjaGFyICpzY3JpcHQsCisJ
CSAgICAgIGNoYXIgKmZuYW1lLCBzaXplX3Qgc2l6ZSkKK3sKKyAgICBzY3JpcHRfZGF0YV90ICpz
ZGF0YSA9IChzY3JpcHRfZGF0YV90ICopIHNjOworCisgICAgaWYgKCFzdHJuY21wKHNjcmlwdCwg
UEVSU09OQUxfUFJFRklYLCBzdHJsZW4oUEVSU09OQUxfUFJFRklYKSkpIHsKKwlzY3JpcHQgKz0g
c3RybGVuKFBFUlNPTkFMX1BSRUZJWCk7CisJcmV0dXJuIHNpZXZlX2ZpbmRfc2NyaXB0KHNkYXRh
LT51c2VybmFtZSwgc2NyaXB0LCBmbmFtZSwgc2l6ZSk7CisgICAgfQorICAgIGVsc2UgaWYgKCFz
dHJuY21wKHNjcmlwdCwgR0xPQkFMX1BSRUZJWCwgc3RybGVuKEdMT0JBTF9QUkVGSVgpKSkgewor
CXNjcmlwdCArPSBzdHJsZW4oR0xPQkFMX1BSRUZJWCk7CisJcmV0dXJuIHNpZXZlX2ZpbmRfc2Ny
aXB0KE5VTEwsIHNjcmlwdCwgZm5hbWUsIHNpemUpOworICAgIH0KKworICAgIHN5c2xvZyhMT0df
Tk9USUNFLCAiZmFpbGVkIHRvIGdldCBzaWV2ZSBzY3JpcHQgJyVzJyBmb3IgdXNlciAnJXMnIiwK
KwkgICBzY3JpcHQsIHNkYXRhLT51c2VybmFtZSk7CisKKyAgICByZXR1cm4gU0lFVkVfRkFJTDsK
K30KKwogc3RhdGljIGludCBnbG9iYWxfb3V0Z29pbmdfY291bnQgPSAwOwogCiBwaWRfdCBvcGVu
X3NlbmRtYWlsKGNvbnN0IGNoYXIgKmFyZ3ZbXSwgRklMRSAqKnNtKQpAQCAtOTg0LDYgKzEwMTAs
MTIgQEAKIAlmYXRhbCgic2lldmVfcmVnaXN0ZXJfZW52ZWxvcGUoKSIsIEVDX1NPRlRXQVJFKTsK
ICAgICB9CiAgICAgCisgICAgcmVzID0gc2lldmVfcmVnaXN0ZXJfaW5jbHVkZShzaWV2ZV9pbnRl
cnAsICZnZXRpbmNsdWRlKTsKKyAgICBpZiAocmVzICE9IFNJRVZFX09LKSB7CisJc3lzbG9nKExP
R19FUlIsInNpZXZlX3JlZ2lzdGVyX2luY2x1ZGUoKSByZXR1cm5zICVkXG4iLCByZXMpOworCWZh
dGFsKCJzaWV2ZV9yZWdpc3Rlcl9pbmNsdWRlKCkiLCBFQ19TT0ZUV0FSRSk7CisgICAgfQorICAg
IAogICAgIHJlcyA9IHNpZXZlX3JlZ2lzdGVyX3ZhY2F0aW9uKHNpZXZlX2ludGVycCwgJnZhY2F0
aW9uKTsKICAgICBpZiAocmVzICE9IFNJRVZFX09LKSB7CiAJc3lzbG9nKExPR19FUlIsICJzaWV2
ZV9yZWdpc3Rlcl92YWNhdGlvbigpIHJldHVybnMgJWRcbiIsIHJlcyk7CkBAIC0xMDA1LDU2ICsx
MDM3LDc3IEBACiB9CiAKIC8qIHJldHVybnMgdHJ1ZSBpZiB1c2VyIGhhcyBhIHNpZXZlIGZpbGUg
Ki8KLXN0YXRpYyBpbnQgc2lldmVfZmluZF9zY3JpcHQoY29uc3QgY2hhciAqdXNlciwgY2hhciAq
Zm5hbWUsIHNpemVfdCBzaXplKQorc3RhdGljIGludCBzaWV2ZV9maW5kX3NjcmlwdChjb25zdCBj
aGFyICp1c2VyLCBjb25zdCBjaGFyICpzY3JpcHQsCisJCQkgICAgIGNoYXIgKmZuYW1lLCBzaXpl
X3Qgc2l6ZSkKIHsKLSAgICBpZiAoc3RybGVuKHVzZXIpID4gOTAwKSB7CisgICAgaWYgKCF1c2Vy
ICYmICFzY3JpcHQpIHsKIAlyZXR1cm4gLTE7CiAgICAgfQogICAgIAorICAgIGlmICh1c2VyICYm
IHN0cmxlbih1c2VyKSA+IDkwMCkgeworCXJldHVybiAtMTsKKyAgICB9CisKICAgICBpZiAoIWhh
dmVfZHVwZGIpIHsKIAkvKiBkdXBsaWNhdGUgZGVsaXZlcnkgZGF0YWJhc2UgaXMgbmVlZGVkIGZv
ciBzaWV2ZSAqLwogCXJldHVybiAtMTsKICAgICB9CiAKICAgICBpZiAoc2lldmVfdXNlaG9tZWRp
cikgeyAvKiBsb29rIGluIGhvbWVkaXIgKi8KLQlzdHJ1Y3QgcGFzc3dkICpwZW50ID0gZ2V0cHdu
YW0odXNlcik7Ci0KLQlpZiAocGVudCA9PSBOVUxMKSB7CisJaWYgKCF1c2VyKSB7IC8qIGdsb2Jh
bCBzY3JpcHQgKi8KKwkgICAgLyogWFhYIHdoZXJlIGFyZSBnbG9iYWwgc2NyaXB0cz8gKi8KIAkg
ICAgcmV0dXJuIC0xOwogCX0KKwllbHNlIHsKKwkgICAgc3RydWN0IHBhc3N3ZCAqcGVudCA9IGdl
dHB3bmFtKHVzZXIpOwogCi0JLyogY2hlY2sgflVTRVJOQU1FLy5zaWV2ZSAqLwotCXNucHJpbnRm
KGZuYW1lLCBzaXplLCAiJXMvJXMiLCBwZW50LT5wd19kaXIsICIuc2lldmUiKTsKKwkgICAgaWYg
KHBlbnQgPT0gTlVMTCkgeworCQlyZXR1cm4gLTE7CisJICAgIH0KKworCSAgICAvKiBjaGVjayB+
VVNFUk5BTUUvLnNpZXZlICovCisJICAgIHNucHJpbnRmKGZuYW1lLCBzaXplLCAiJXMvJXMiLCBw
ZW50LT5wd19kaXIsCisJCSAgICAgc2NyaXB0ID8gc2NyaXB0IDogIi5zaWV2ZSIpOworCX0KICAg
ICB9IGVsc2UgeyAvKiBsb29rIGluIHNpZXZlX2RpciAqLwotCWNoYXIgaGFzaCwgKmRvbWFpbjsK
LQljaGFyIGJ1ZnVzZXJbTUFYX01BSUxCT1hfTkFNRSsxXTsKLQotCXN0cmxjcHkoYnVmdXNlciwg
dXNlciwgc2l6ZW9mKGJ1ZnVzZXIpKTsKLQotCW1ib3huYW1lX2hpZXJzZXBfdG9pbnRlcm5hbCgm
bG10cGRfbmFtZXNwYWNlLCBidWZ1c2VyLAotCQkJCSAgICBjb25maWdfdmlydGRvbWFpbnMgPwot
CQkJCSAgICBzdHJjc3BuKGJ1ZnVzZXIsICJAIikgOiAwKTsKLQotCWlmIChjb25maWdfdmlydGRv
bWFpbnMgJiYgKGRvbWFpbiA9IHN0cmNocihidWZ1c2VyLCAnQCcpKSkgewotCSAgICBjaGFyIGQg
PSAoY2hhcikgZGlyX2hhc2hfYyhkb21haW4rMSk7Ci0JICAgICpkb21haW4gPSAnXDAnOyAgLyog
c3BsaXQgdXNlckBkb21haW4gKi8KLQkgICAgaGFzaCA9IChjaGFyKSBkaXJfaGFzaF9jKHVzZXIp
OwotCSAgICBzbnByaW50ZihmbmFtZSwgc2l6ZSwgIiVzJXMlYy8lcy8lYy8lcy9kZWZhdWx0LmJj
IiwKLQkJICAgICBzaWV2ZV9kaXIsIEZOQU1FX0RPTUFJTkRJUiwgZCwgZG9tYWluKzEsCi0JCSAg
ICAgaGFzaCwgYnVmdXNlcik7CisJaWYgKCF1c2VyKSB7IC8qIGdsb2JhbCBzY3JpcHQgKi8KKwkg
ICAgc25wcmludGYoZm5hbWUsIHNpemUsICIlcy8iLCBzaWV2ZV9kaXIpOwogCX0KIAllbHNlIHsK
LQkgICAgaGFzaCA9IChjaGFyKSBkaXJfaGFzaF9jKGJ1ZnVzZXIpOworCSAgICBjaGFyIGhhc2gs
ICpkb21haW47CisJICAgIGNoYXIgYnVmdXNlcltNQVhfTUFJTEJPWF9OQU1FKzFdOworCisJICAg
IHN0cmxjcHkoYnVmdXNlciwgdXNlciwgc2l6ZW9mKGJ1ZnVzZXIpKTsKIAotCSAgICBzbnByaW50
ZihmbmFtZSwgc2l6ZSwgIiVzLyVjLyVzL2RlZmF1bHQuYmMiLAotCQkgICAgIHNpZXZlX2Rpciwg
aGFzaCwgdXNlcik7CisJICAgIG1ib3huYW1lX2hpZXJzZXBfdG9pbnRlcm5hbCgmbG10cGRfbmFt
ZXNwYWNlLCBidWZ1c2VyLAorCQkJCQljb25maWdfdmlydGRvbWFpbnMgPworCQkJCQlzdHJjc3Bu
KGJ1ZnVzZXIsICJAIikgOiAwKTsKKworCSAgICBpZiAoY29uZmlnX3ZpcnRkb21haW5zICYmIChk
b21haW4gPSBzdHJjaHIoYnVmdXNlciwgJ0AnKSkpIHsKKwkJY2hhciBkID0gKGNoYXIpIGRpcl9o
YXNoX2MoZG9tYWluKzEpOworCQkqZG9tYWluID0gJ1wwJzsgIC8qIHNwbGl0IHVzZXJAZG9tYWlu
ICovCisJCWhhc2ggPSAoY2hhcikgZGlyX2hhc2hfYyh1c2VyKTsKKwkJc25wcmludGYoZm5hbWUs
IHNpemUsICIlcyVzJWMvJXMvJWMvJXMvIiwKKwkJCSBzaWV2ZV9kaXIsIEZOQU1FX0RPTUFJTkRJ
UiwgZCwgZG9tYWluKzEsCisJCQkgaGFzaCwgYnVmdXNlcik7CisJICAgIH0KKwkgICAgZWxzZSB7
CisJCWhhc2ggPSAoY2hhcikgZGlyX2hhc2hfYyhidWZ1c2VyKTsKKworCQlzbnByaW50ZihmbmFt
ZSwgc2l6ZSwgIiVzLyVjLyVzLyIsCisJCQkgc2lldmVfZGlyLCBoYXNoLCB1c2VyKTsKKwkgICAg
fQogCX0KKworCXN0cmxjYXQoZm5hbWUsIHNjcmlwdCA/IHNjcmlwdCA6ICJkZWZhdWx0Iiwgc2l6
ZSk7CisJc3RybGNhdChmbmFtZSwgIi5iYyIsIHNpemUpOwogICAgIH0KIAkKICAgICByZXR1cm4g
MDsKIH0KICNlbHNlIC8qIFVTRV9TSUVWRSAqLwotc3RhdGljIGludCBzaWV2ZV9maW5kX3Njcmlw
dChjb25zdCBjaGFyICp1c2VyLCBjaGFyICpmbmFtZSwgc2l6ZV90IHNpemUpCitzdGF0aWMgaW50
IHNpZXZlX2ZpbmRfc2NyaXB0KGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnNjcmlwdCwK
KwkJCSAgICAgY2hhciAqZm5hbWUsIHNpemVfdCBzaXplKQogewogICAgIHJldHVybiAtMTsKIH0K
QEAgLTEyMDIsOSArMTI1NSw5IEBACiAJICAgIGlmIChkb21haW4pIHNwcmludGYodXNlcitzdHJs
ZW4odXNlciksICJAJXMiLCBkb21haW4pOwogCiAjaWZkZWYgVVNFX1NJRVZFCi0JICAgIGlmIChz
aWV2ZV9maW5kX3NjcmlwdCh1c2VyLCBmbmFtZSwgc2l6ZW9mKGZuYW1lKSkgIT0gLTEpIHsKKwkg
ICAgaWYgKHNpZXZlX2ZpbmRfc2NyaXB0KHVzZXIsIE5VTEwsIGZuYW1lLCBzaXplb2YoZm5hbWUp
KSAhPSAtMSkgewogCQlzY3JpcHRfZGF0YV90ICpzZGF0YSA9IE5VTEw7Ci0JCXNpZXZlX2J5dGVj
b2RlX3QgKmJjID0gTlVMTDsKKwkJc2lldmVfZXhlY3V0ZV90ICpiYyA9IE5VTEw7CiAKIAkJc2Rh
dGEgPSAoc2NyaXB0X2RhdGFfdCAqKSB4bWFsbG9jKHNpemVvZihzY3JpcHRfZGF0YV90KSk7CiAK
SW5kZXg6IHNpZXZlL2JjX2R1bXAuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9z
eXN0ZW0vY3ZzL3NyYy9zaWV2ZS9BdHRpYy9iY19kdW1wLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuMS40LjEKZGlmZiAtdSAtcjEuMS40LjEgYmNfZHVtcC5jCi0tLSBzaWV2ZS9iY19kdW1wLmMJ
MjcgRmViIDIwMDMgMTg6MTM6NTEgLTAwMDAJMS4xLjQuMQorKysgc2lldmUvYmNfZHVtcC5jCTMx
IE1hciAyMDAzIDE4OjE4OjQ2IC0wMDAwCkBAIC0yOTMsNiArMjkzLDE3IEBACiAJY2FzZSBCX05V
TEw6CiAJICAgIHByaW50ZigiJWQ6IE5VTExcbiIsaSk7CiAJICAgIGJyZWFrOworCisJY2FzZSBC
X0lOQ0xVREU6CisJICAgIHByaW50ZigiJWQ6IElOQ0xVREUgeyVkfSVzXG4iLGksCisJCSAgIGQt
PmRhdGFbaSsxXS5sZW4sZC0+ZGF0YVtpKzJdLnN0cik7CisJICAgIGkrPTI7CisJICAgIGJyZWFr
OworCisJY2FzZSBCX1JFVFVSTjoKKwkgICAgcHJpbnRmKCIlZDogUkVUVVJOXG4iLGkpOworCSAg
ICBicmVhazsKKwogCWRlZmF1bHQ6CiAJICAgIHByaW50ZigiJWQ6ICVkXG4iLGksZC0+ZGF0YVtp
XS5vcCk7CiAJICAgIGJyZWFrOwpJbmRleDogc2lldmUvYmNfZW1pdC5jCj09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL0F0dGljL2JjX2VtaXQuYyx2
CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xLjQuMQpkaWZmIC11IC1yMS4xLjQuMSBiY19lbWl0LmMK
LS0tIHNpZXZlL2JjX2VtaXQuYwkyNyBGZWIgMjAwMyAxODoxMzo1MSAtMDAwMAkxLjEuNC4xCisr
KyBzaWV2ZS9iY19lbWl0LmMJMzEgTWFyIDIwMDMgMTg6MTg6NDYgLTAwMDAKQEAgLTQ0Miw2ICs0
NDIsNyBAQAogCWNhc2UgQl9SRUpFQ1Q6CiAJY2FzZSBCX0ZJTEVJTlRPOgogCWNhc2UgQl9SRURJ
UkVDVDoKKwljYXNlIEJfSU5DTFVERToKIAkgICAgLypqdXN0IGEgc3RyaW5nKi8KIAkgICAgbGVu
ID0gYmMtPmRhdGFbY29kZXArK10ubGVuOwogCSAgICBpZih3cml0ZShmZCwmbGVuLHNpemVvZihs
ZW4pKSA9PSAtMSkKQEAgLTYyMSw2ICs2MjIsNyBAQAogCWNhc2UgQl9LRUVQOgogCWNhc2UgQl9N
QVJLOgogCWNhc2UgQl9VTk1BUks6CisJY2FzZSBCX1JFVFVSTjoKIAkgICAgLyogTm8gUGFyYW1l
dGVycyEgKi8KIAkgICAgYnJlYWs7CiAKSW5kZXg6IHNpZXZlL2JjX2V2YWwuYwo9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zaWV2ZS9BdHRpYy9iY19ldmFs
LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMS40LjkKZGlmZiAtdSAtcjEuMS40LjkgYmNfZXZh
bC5jCi0tLSBzaWV2ZS9iY19ldmFsLmMJMjkgTWFyIDIwMDMgMDE6MjY6NDQgLTAwMDAJMS4xLjQu
OQorKysgc2lldmUvYmNfZXZhbC5jCTMxIE1hciAyMDAzIDE4OjE4OjQ2IC0wMDAwCkBAIC0zMSw2
ICszMSw3IEBACiAjaW5jbHVkZSAic2lldmVfaW50ZXJmYWNlLmgiCiAjaW5jbHVkZSAiaW50ZXJw
LmgiCiAjaW5jbHVkZSAibWVzc2FnZS5oIgorI2luY2x1ZGUgInNjcmlwdC5oIgogCiAjaW5jbHVk
ZSAiYnl0ZWNvZGUuaCIKIApAQCAtNjY2LDI0ICs2NjcsMzEgQEAKIH0KIAogLyogVGhlIGVudHJ5
cG9pbnQgZm9yIGJ5dGVjb2RlIGV2YWx1YXRpb24gKi8KLWludCBzaWV2ZV9ldmFsX2JjKHNpZXZl
X2ludGVycF90ICppLCBjb25zdCB2b2lkICpiY19pbiwgdW5zaWduZWQgaW50IGJjX2xlbiwKLQkJ
ICB2b2lkICptLCBzaWV2ZV9pbWFwZmxhZ3NfdCAqIGltYXBmbGFncywKK2ludCBzaWV2ZV9ldmFs
X2JjKHNpZXZlX2V4ZWN1dGVfdCAqZXhlLCBpbnQgaXNfaW5jbCwgc2lldmVfaW50ZXJwX3QgKmks
CisJCSAgdm9pZCAqc2MsIHZvaWQgKm0sIHNpZXZlX2ltYXBmbGFnc190ICogaW1hcGZsYWdzLAog
CQkgIGFjdGlvbl9saXN0X3QgKmFjdGlvbnMsCiAJCSAgbm90aWZ5X2xpc3RfdCAqbm90aWZ5X2xp
c3QsCiAJCSAgY29uc3QgY2hhciAqKmVycm1zZykgCiB7CiAgICAgY29uc3QgY2hhciAqZGF0YTsK
LSAgICB1bnNpZ25lZCBpbnQgaXAgPSAwLCBpcF9tYXggPSAoYmNfbGVuL3NpemVvZihieXRlY29k
ZV9pbnB1dF90KSk7CiAgICAgaW50IHJlcz0wOwogICAgCi0gICAgYnl0ZWNvZGVfaW5wdXRfdCAq
YmMgPSAoYnl0ZWNvZGVfaW5wdXRfdCAqKWJjX2luOwotICAgIAorICAgIHNpZXZlX2J5dGVjb2Rl
X3QgKmJjX2N1ciA9IGV4ZS0+YmNfY3VyOworICAgIGJ5dGVjb2RlX2lucHV0X3QgKmJjID0gKGJ5
dGVjb2RlX2lucHV0X3QgKikgYmNfY3VyLT5kYXRhOworICAgIHVuc2lnbmVkIGludCBpcCA9IDAs
IGlwX21heCA9IChiY19jdXItPmxlbi9zaXplb2YoYnl0ZWNvZGVfaW5wdXRfdCkpOworCisgICAg
aWYgKGJjX2N1ci0+aXNfZXhlY3V0aW5nKSB7CisJKmVycm1zZyA9ICJSZWN1cnNpdmUgSW5jbHVk
ZSI7CisJcmV0dXJuIFNJRVZFX1JVTl9FUlJPUjsKKyAgICB9CisgICAgYmNfY3VyLT5pc19leGVj
dXRpbmcgPSAxOworCiAgICAgLyogQ2hlY2sgdGhhdCB3ZQogICAgICAqIGEpIGhhdmUgYnl0ZWNv
ZGUKICAgICAgKiBiKSBpdCBpcyBhdGxlYXN0IGxvbmcgZW5vdWdoIGZvciB0aGUgbWFnaWMgbnVt
YmVyLCB0aGUgdmVyc2lvbgogICAgICAqICAgIGFuZCBvbmUgb3Bjb2RlICovCiAgICAgaWYoIWJj
KSByZXR1cm4gU0lFVkVfRkFJTDsKLSAgICBpZihiY19sZW4gPCAoQllURUNPREVfTUFHSUNfTEVO
ICsgMipzaXplb2YoYnl0ZWNvZGVfaW5wdXRfdCkpKQorICAgIGlmKGJjX2N1ci0+bGVuIDwgKEJZ
VEVDT0RFX01BR0lDX0xFTiArIDIqc2l6ZW9mKGJ5dGVjb2RlX2lucHV0X3QpKSkKICAgICAgICBy
ZXR1cm4gU0lFVkVfRkFJTDsKIAogICAgIGlmKG1lbWNtcChiYywgQllURUNPREVfTUFHSUMsIEJZ
VEVDT0RFX01BR0lDX0xFTikpIHsKQEAgLTEwNDAsNiArMTA0OCwzNiBAQAogCSAgICBpcD0gYmNb
aXArMV0uanVtcDsKIAkgICAgYnJlYWs7CiAJICAgIAorCWNhc2UgQl9JTkNMVURFOi8qMTcqLwor
CXsKKwkgICAgY2hhciBmbmFtZVs0MDk2XTsKKworCSAgICBpcCA9IHVud3JhcF9zdHJpbmcoYmMs
IGlwKzEsICZkYXRhLCBOVUxMKTsKKworCSAgICByZXMgPSBpLT5nZXRpbmNsdWRlKHNjLCBkYXRh
LCBmbmFtZSwgc2l6ZW9mKGZuYW1lKSk7CisJICAgIGlmIChyZXMgIT0gU0lFVkVfT0spCisJCSpl
cnJtc2cgPSAiSW5jbHVkZSBjYW4gbm90IGZpbmQgc2NyaXB0IjsKKworCSAgICBpZiAoIXJlcykg
eworCQlyZXMgPSBzaWV2ZV9zY3JpcHRfbG9hZChmbmFtZSwgJmV4ZSk7CisJCWlmIChyZXMgIT0g
U0lFVkVfT0spCisJCSplcnJtc2cgPSAiSW5jbHVkZSBjYW4gbm90IGxvYWQgc2NyaXB0IjsKKwkg
ICAgfQorCisJICAgIGlmICghcmVzKQorCQlyZXMgPSBzaWV2ZV9ldmFsX2JjKGV4ZSwgMSwgaSwg
c2MsIG0sIGltYXBmbGFncywgYWN0aW9ucywKKwkJCQkgICAgbm90aWZ5X2xpc3QsIGVycm1zZyk7
CisKKwkgICAgYnJlYWs7CisJfQorCisJY2FzZSBCX1JFVFVSTjovKjE4Ki8KKwkgICAgaWYgKGlz
X2luY2wpCisJCWdvdG8gZG9uZTsKKwkgICAgZWxzZQorCQlyZXM9MTsKKwkgICAgYnJlYWs7CisK
IAlkZWZhdWx0OgogCSAgICBpZihlcnJtc2cpICplcnJtc2cgPSAiSW52YWxpZCBzaWV2ZSBieXRl
Y29kZSI7CiAJICAgIHJldHVybiBTSUVWRV9GQUlMOwpAQCAtMTA0OCw1ICsxMDg2LDkgQEAKIAlp
ZiAocmVzKSAvKiB3ZSd2ZSBlaXRoZXIgZW5jb3VudGVyZWQgYW4gZXJyb3Igb3IgYSBzdG9wICov
CiAJICAgIGJyZWFrOwogICAgIH0KKworICBkb25lOgorICAgIGJjX2N1ci0+aXNfZXhlY3V0aW5n
ID0gMDsKKwogICAgIHJldHVybiByZXM7ICAgICAgCiB9CkluZGV4OiBzaWV2ZS9iY19nZW5lcmF0
ZS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZl
L0F0dGljL2JjX2dlbmVyYXRlLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMS40LjMKZGlmZiAt
dSAtcjEuMS40LjMgYmNfZ2VuZXJhdGUuYwotLS0gc2lldmUvYmNfZ2VuZXJhdGUuYwk1IE1hciAy
MDAzIDE3OjUzOjAxIC0wMDAwCTEuMS40LjMKKysrIHNpZXZlL2JjX2dlbmVyYXRlLmMJMzEgTWFy
IDIwMDMgMTg6MTg6NDYgLTAwMDAKQEAgLTQwNyw2ICs0MDcsMTMgQEAKIAkJaWYoIWF0bGVhc3Qo
cmV0dmFsLGNvZGVwKzEpKSByZXR1cm4gLTE7CiAJCXJldHZhbC0+ZGF0YVtjb2RlcCsrXS5vcCA9
IEJfVU5NQVJLOwogCQlicmVhazsKKworCSAgICBjYXNlIFJFVFVSTjoKKwkJLyogUkVUVVJOIChu
byBhcmd1bWVudHMpICovCisJCWlmKCFhdGxlYXN0KHJldHZhbCxjb2RlcCsxKSkgcmV0dXJuIC0x
OworCQlyZXR2YWwtPmRhdGFbY29kZXArK10ub3AgPSBCX1JFVFVSTjsKKwkJYnJlYWs7CisKIAkg
ICAgY2FzZSBERU5PVElGWToKIAkJLyogREVOT1RJRlkgICovCiAJCWlmKCFhdGxlYXN0KHJldHZh
bCxjb2RlcCs2KSkgcmV0dXJuIC0xOwpAQCAtNDgxLDYgKzQ4OCwxNSBAQAogCQlyZXR2YWwtPmRh
dGFbY29kZXArK10ubGVuID0gc3RybGVuKGMtPnUuc3RyKTsKIAkJcmV0dmFsLT5kYXRhW2NvZGVw
KytdLnN0ciA9IGMtPnUuc3RyOwogCQlicmVhazsKKworCSAgICBjYXNlIElOQ0xVREU6CisJCS8q
IElOQ0xVREUgKFNUUklORzogbGVuICsgZGF0YXB0cikgKi8KKwkJaWYoIWF0bGVhc3QocmV0dmFs
LGNvZGVwKzMpKSByZXR1cm4gLTE7CisJCXJldHZhbC0+ZGF0YVtjb2RlcCsrXS5vcCA9IEJfSU5D
TFVERTsKKwkJcmV0dmFsLT5kYXRhW2NvZGVwKytdLmxlbiA9IHN0cmxlbihjLT51LnN0cik7CisJ
CXJldHZhbC0+ZGF0YVtjb2RlcCsrXS5zdHIgPSBjLT51LnN0cjsKKwkJYnJlYWs7CisKIAkgICAg
Y2FzZSBBRERGTEFHOgogCQkvKiBBRERGTEFHIHN0cmluZ2xpc3QgKi8KIAkJaWYoIWF0bGVhc3Qo
cmV0dmFsLGNvZGVwKzEpKSByZXR1cm4gLTE7CkluZGV4OiBzaWV2ZS9ieXRlY29kZS5oCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL0F0dGljL2J5
dGVjb2RlLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMS40LjEKZGlmZiAtdSAtcjEuMS40LjEg
Ynl0ZWNvZGUuaAotLS0gc2lldmUvYnl0ZWNvZGUuaAkyNyBGZWIgMjAwMyAxODoxMzo1MiAtMDAw
MAkxLjEuNC4xCisrKyBzaWV2ZS9ieXRlY29kZS5oCTMxIE1hciAyMDAzIDE4OjE4OjQ2IC0wMDAw
CkBAIC05OSw3ICs5OSwxMCBAQAogCiAgICAgQl9WQUNBVElPTiwvKiByZXF1aXJlIHZhY2F0aW9u
Ki8KICAgICBCX05VTEwsCi0gICAgQl9KVU1QCisgICAgQl9KVU1QLAorCisgICAgQl9JTkNMVURF
LC8qIHJlcXVpcmUgaW5jbHVkZSAqLworICAgIEJfUkVUVVJOLyogcmVxdWlyZSBpbmNsdWRlICov
CiB9OwogCiBlbnVtIGJ5dGVjb2RlX2NvbXBzIHsKSW5kZXg6IHNpZXZlL2ludGVycC5jCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL2ludGVycC5j
LHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjIyLjQuMQpkaWZmIC11IC1yMS4yMi40LjEgaW50ZXJw
LmMKLS0tIHNpZXZlL2ludGVycC5jCTI3IEZlYiAyMDAzIDE4OjEzOjUyIC0wMDAwCTEuMjIuNC4x
CisrKyBzaWV2ZS9pbnRlcnAuYwkzMSBNYXIgMjAwMyAxODoxODo0NiAtMDAwMApAQCAtNTcsNiAr
NTcsOCBAQAogICAgIGktPmdldHNpemUgPSBOVUxMOwogICAgIGktPmdldGhlYWRlciA9IE5VTEw7
CiAgICAgaS0+Z2V0ZW52ZWxvcGUgPSBOVUxMOworICAgIGktPmdldGluY2x1ZGUgPSBOVUxMOwor
CiAgICAgaS0+dmFjYXRpb24gPSBOVUxMOwogICAgIGktPm5vdGlmeSA9IE5VTEw7CiAKQEAgLTcx
LDYgKzczLDcgQEAKIAogc3RhdGljIGNvbnN0IGNoYXIgKnNpZXZlX2V4dGVuc2lvbnMgPSAiZmls
ZWludG8gcmVqZWN0IGVudmVsb3BlIHZhY2F0aW9uIgogICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAiIGltYXBmbGFncyBub3RpZnkgc3ViYWRkcmVzcyByZWxhdGlvbmFsIgor
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiIGluY2x1ZGUiCiAjaWZkZWYg
RU5BQkxFX1JFR0VYCiAiIHJlZ2V4IjsKICNlbHNlCkBAIC0xNjAsNiArMTYzLDEyIEBACiBpbnQg
c2lldmVfcmVnaXN0ZXJfZW52ZWxvcGUoc2lldmVfaW50ZXJwX3QgKmludGVycCwgc2lldmVfZ2V0
X2VudmVsb3BlICpmKQogewogICAgIGludGVycC0+Z2V0ZW52ZWxvcGUgPSBmOworICAgIHJldHVy
biBTSUVWRV9PSzsKK30KKworaW50IHNpZXZlX3JlZ2lzdGVyX2luY2x1ZGUoc2lldmVfaW50ZXJw
X3QgKmludGVycCwgc2lldmVfZ2V0X2luY2x1ZGUgKmYpCit7CisgICAgaW50ZXJwLT5nZXRpbmNs
dWRlID0gZjsKICAgICByZXR1cm4gU0lFVkVfT0s7CiB9CiAKSW5kZXg6IHNpZXZlL2ludGVycC5o
Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL2lu
dGVycC5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjcuNC4xCmRpZmYgLXUgLXIxLjcuNC4xIGlu
dGVycC5oCi0tLSBzaWV2ZS9pbnRlcnAuaAkyNyBGZWIgMjAwMyAxODoxMzo1MiAtMDAwMAkxLjcu
NC4xCisrKyBzaWV2ZS9pbnRlcnAuaAkzMSBNYXIgMjAwMyAxODoxODo0NiAtMDAwMApAQCAtMzks
NiArMzksNyBAQAogICAgIHNpZXZlX2dldF9zaXplICpnZXRzaXplOwogICAgIHNpZXZlX2dldF9o
ZWFkZXIgKmdldGhlYWRlcjsKICAgICBzaWV2ZV9nZXRfZW52ZWxvcGUgKmdldGVudmVsb3BlOwor
ICAgIHNpZXZlX2dldF9pbmNsdWRlICpnZXRpbmNsdWRlOwogCiAgICAgc2lldmVfcGFyc2VfZXJy
b3IgKmVycjsKIApJbmRleDogc2lldmUvc2NyaXB0LmMKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fm
cy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvc2lldmUvc2NyaXB0LmMsdgpyZXRyaWV2aW5nIHJldmlz
aW9uIDEuNTQuNC40CmRpZmYgLXUgLXIxLjU0LjQuNCBzY3JpcHQuYwotLS0gc2lldmUvc2NyaXB0
LmMJMjkgTWFyIDIwMDMgMDE6MjY6NDQgLTAwMDAJMS41NC40LjQKKysrIHNpZXZlL3NjcmlwdC5j
CTMxIE1hciAyMDAzIDE4OjE4OjQ2IC0wMDAwCkBAIC0xMTMsNiArMTEzLDEzIEBACiAgICAgfSBl
bHNlIGlmICghc3RyY21wKCJjb21wYXJhdG9yLWk7YXNjaWktbnVtZXJpYyIsIHJlcSkpIHsKIAlz
LT5zdXBwb3J0LmlfYXNjaWlfbnVtZXJpYyA9IDE7CiAJcmV0dXJuIDE7CisgICAgfSBlbHNlIGlm
ICghc3RyY21wKCJpbmNsdWRlIiwgcmVxKSkgeworCWlmIChzLT5pbnRlcnAuZ2V0aW5jbHVkZSkg
eworCSAgICBzLT5zdXBwb3J0LmluY2x1ZGUgPSAxOworCSAgICByZXR1cm4gMTsKKwl9IGVsc2Ug
eworCSAgICByZXR1cm4gMDsKKwl9CiAgICAgfQogICAgIHJldHVybiAwOwogfQpAQCAtNDE1LDEx
ICs0MjIsMTEgQEAKICAqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKi8KIAogLyogTG9hZCBhIGNvbXBpbGVk
IHNjcmlwdCAqLwotaW50IHNpZXZlX3NjcmlwdF9sb2FkKGNvbnN0IGNoYXIgKmZuYW1lLCBzaWV2
ZV9ieXRlY29kZV90ICoqcmV0KSAKK2ludCBzaWV2ZV9zY3JpcHRfbG9hZChjb25zdCBjaGFyICpm
bmFtZSwgc2lldmVfZXhlY3V0ZV90ICoqcmV0KSAKIHsKICAgICBzdHJ1Y3Qgc3RhdCBzYnVmOwot
ICAgIHNpZXZlX2J5dGVjb2RlX3QgKnI7Ci0gICAgaW50IGZkOworICAgIHNpZXZlX2V4ZWN1dGVf
dCAqcjsKKyAgICBzaWV2ZV9ieXRlY29kZV90ICpiYzsKICAgIAogICAgIGlmICghZm5hbWUgfHwg
IXJldCkgcmV0dXJuIFNJRVZFX0ZBSUw7CiAgICAgCkBAIC00MjgsMjkgKzQzNSw2MiBAQAogCXJl
dHVybiBTSUVWRV9GQUlMOwogICAgIH0KIAotICAgIGZkID0gb3BlbihmbmFtZSwgT19SRE9OTFkp
OwotICAgIGlmIChmZCA9PSAtMSkgewotCXN5c2xvZyhMT0dfRVJSLCAiSU9FUlJPUjogY2FuIG5v
dCBvcGVuIHNpZXZlIHNjcmlwdCAlczogJW0iLCBmbmFtZSk7Ci0JcmV0dXJuIFNJRVZFX0ZBSUw7
CisgICAgaWYgKCEqcmV0KSB7CisJLyogbmV3IHNpZXZlX2J5dGVjb2RlX3QgKi8KKwlyID0gKHNp
ZXZlX2V4ZWN1dGVfdCAqKSB4em1hbGxvYyhzaXplb2Yoc2lldmVfZXhlY3V0ZV90KSk7CisgICAg
fSBlbHNlIHsKKwkvKiBleGlzdGluZyBzaWV2ZV9leGVjdXRlX3QgKElOQ0xVREUpICovCisJciA9
ICpyZXQ7CisgICAgfQorICAKKyAgICAvKiBzZWUgaWYgd2UgYWxyZWFkeSBoYXZlIHRoaXMgc2Ny
aXB0IGxvYWRlZCAqLworICAgIGJjID0gci0+YmNfbGlzdDsKKyAgICB3aGlsZSAoYmMpIHsKKwlp
ZiAoc2J1Zi5zdF9pbm8gPT0gYmMtPmlub2RlKSBicmVhazsKKwliYyA9IGJjLT5uZXh0OwogICAg
IH0KIAotICAgIHIgPSAoc2lldmVfYnl0ZWNvZGVfdCAqKSB4em1hbGxvYyhzaXplb2Yoc2lldmVf
Ynl0ZWNvZGVfdCkpOworICAgIGlmICghYmMpIHsKKwlpbnQgZmQ7CisKKwkvKiBuZXcgc2NyaXB0
IC0tIGxvYWQgaXQgKi8KKwlmZCA9IG9wZW4oZm5hbWUsIE9fUkRPTkxZKTsKKwlpZiAoZmQgPT0g
LTEpIHsKKwkgICAgc3lzbG9nKExPR19FUlIsICJJT0VSUk9SOiBjYW4gbm90IG9wZW4gc2lldmUg
c2NyaXB0ICVzOiAlbSIsIGZuYW1lKTsKKwkgICAgcmV0dXJuIFNJRVZFX0ZBSUw7CisJfQogCi0g
ICAgci0+ZmQgPSBmZDsKKwliYyA9IChzaWV2ZV9ieXRlY29kZV90ICopIHh6bWFsbG9jKHNpemVv
ZihzaWV2ZV9ieXRlY29kZV90KSk7CisKKwliYy0+ZmQgPSBmZDsKKwliYy0+aW5vZGUgPSBzYnVm
LnN0X2lubzsKICAgICAKLSAgICBtYXBfcmVmcmVzaChmZCwgMSwgJnItPmRhdGEsICZyLT5sZW4s
IHNidWYuc3Rfc2l6ZSwgZm5hbWUsICJzaWV2ZXNjcmlwdCIpOworCW1hcF9yZWZyZXNoKGZkLCAx
LCAmYmMtPmRhdGEsICZiYy0+bGVuLCBzYnVmLnN0X3NpemUsCisJCSAgICBmbmFtZSwgInNpZXZl
c2NyaXB0Iik7CisKKwkvKiBhZGQgYnVmZmVyIHRvIGxpc3QgKi8KKwliYy0+bmV4dCA9IHItPmJj
X2xpc3Q7CisJci0+YmNfbGlzdCA9IGJjOworICAgIH0KIAorICAgIHItPmJjX2N1ciA9IGJjOwog
ICAgICpyZXQgPSByOwogICAgIHJldHVybiBTSUVWRV9PSzsKIH0KIAogCiAKLWludCBzaWV2ZV9z
Y3JpcHRfdW5sb2FkKHNpZXZlX2J5dGVjb2RlX3QgKipzKSAKK2ludCBzaWV2ZV9zY3JpcHRfdW5s
b2FkKHNpZXZlX2V4ZWN1dGVfdCAqKnMpIAogewogICAgIGlmKHMgJiYgKnMpIHsKLQltYXBfZnJl
ZSgmKCgqcyktPmRhdGEpLCAmKCgqcyktPmxlbikpOwotCWNsb3NlKCgqcyktPmZkKTsKKwlzaWV2
ZV9ieXRlY29kZV90ICpiYyA9ICgqcyktPmJjX2xpc3Q7CisKKwkvKiBmcmVlIGVhY2ggYnl0ZWNv
ZGUgYnVmZmVyIGluIHRoZSBsaW5rZWQgbGlzdCAqLworCXdoaWxlIChiYykgeworCSAgICBtYXBf
ZnJlZSgmKGJjLT5kYXRhKSwgJihiYy0+bGVuKSk7CisJICAgIGNsb3NlKGJjLT5mZCk7CisJICAg
IGJjID0gYmMtPm5leHQ7CisJfQogCWZyZWUoKnMpOwogCSpzID0gTlVMTDsKICAgICB9IApAQCAt
NzU4LDEzICs3OTgsMTMgQEAKIAogCiAvKiBleGVjdXRlIHNvbWUgYnl0ZWNvZGUgKi8KLWludCBz
aWV2ZV9ldmFsX2JjKHNpZXZlX2ludGVycF90ICppLCBjb25zdCB2b2lkICpiY19pbiwgdW5zaWdu
ZWQgaW50IGJjX2xlbiwKLQkJICB2b2lkICptLCBzaWV2ZV9pbWFwZmxhZ3NfdCAqIGltYXBmbGFn
cywKK2ludCBzaWV2ZV9ldmFsX2JjKHNpZXZlX2V4ZWN1dGVfdCAqZXhlLCBpbnQgaXNfaW5jbCwg
c2lldmVfaW50ZXJwX3QgKmksCisJCSAgdm9pZCAqc2MsIHZvaWQgKm0sIHNpZXZlX2ltYXBmbGFn
c190ICogaW1hcGZsYWdzLAogCQkgIGFjdGlvbl9saXN0X3QgKmFjdGlvbnMsCiAJCSAgbm90aWZ5
X2xpc3RfdCAqbm90aWZ5X2xpc3QsCiAJCSAgY29uc3QgY2hhciAqKmVycm1zZyk7CiAKLWludCBz
aWV2ZV9leGVjdXRlX2J5dGVjb2RlKHNpZXZlX2J5dGVjb2RlX3QgKmJjLCBzaWV2ZV9pbnRlcnBf
dCAqaW50ZXJwLAoraW50IHNpZXZlX2V4ZWN1dGVfYnl0ZWNvZGUoc2lldmVfZXhlY3V0ZV90ICpl
eGUsIHNpZXZlX2ludGVycF90ICppbnRlcnAsCiAJCQkgICB2b2lkICpzY3JpcHRfY29udGV4dCwg
dm9pZCAqbWVzc2FnZV9jb250ZXh0KSAKIHsKICAgICBhY3Rpb25fbGlzdF90ICphY3Rpb25zID0g
TlVMTDsKQEAgLTc5OCw3ICs4MzgsNyBAQAogCQkJICAgICAgYWN0aW9uc19zdHJpbmcsIGVycm1z
Zyk7CiAgICAgfQogICAgIAotICAgIGlmIChzaWV2ZV9ldmFsX2JjKGludGVycCwgYmMtPmRhdGEs
IGJjLT5sZW4sIG1lc3NhZ2VfY29udGV4dCwgCisgICAgaWYgKHNpZXZlX2V2YWxfYmMoZXhlLCAw
LCBpbnRlcnAsIHNjcmlwdF9jb250ZXh0LCBtZXNzYWdlX2NvbnRleHQsIAogCQkgICAgICAmaW1h
cGZsYWdzLCBhY3Rpb25zLCBub3RpZnlfbGlzdCwgJmVycm1zZykgPCAwKQogCXJldHVybiBTSUVW
RV9SVU5fRVJST1I7ICAKICAgICAKSW5kZXg6IHNpZXZlL3NjcmlwdC5oCj09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL3NjcmlwdC5oLHYKcmV0cmll
dmluZyByZXZpc2lvbiAxLjcuNC4zCmRpZmYgLXUgLXIxLjcuNC4zIHNjcmlwdC5oCi0tLSBzaWV2
ZS9zY3JpcHQuaAkyNyBNYXIgMjAwMyAxOToyODozNSAtMDAwMAkxLjcuNC4zCisrKyBzaWV2ZS9z
Y3JpcHQuaAkzMSBNYXIgMjAwMyAxODoxODo0NiAtMDAwMApAQCAtMjgsNiArMjgsOCBAQAogI2lm
bmRlZiBTSUVWRV9TQ1JJUFRfSAogI2RlZmluZSBTSUVWRV9TQ1JJUFRfSAogCisjaW5jbHVkZSA8
c3lzL3R5cGVzLmg+CisKICNpbmNsdWRlICJzaWV2ZV9pbnRlcmZhY2UuaCIKICNpbmNsdWRlICJp
bnRlcnAuaCIKICNpbmNsdWRlICJ0cmVlLmgiCkBAIC00OSw2ICs1MSw3IEBACiAJaW50IHN1YmFk
ZHJlc3MgICAgIDogMTsKIAlpbnQgcmVsYXRpb25hbCAgICAgOiAxOwogCWludCBpX2FzY2lpX251
bWVyaWM6IDE7CisJaW50IGluY2x1ZGUgICAgICAgIDogMTsKICAgICB9IHN1cHBvcnQ7CiAKICAg
ICB2b2lkICpzY3JpcHRfY29udGV4dDsKQEAgLTU3LDE0ICs2MCwyMiBAQAogICAgIGludCBlcnI7
CiB9OwogCi1zdHJ1Y3Qgc2lldmVfYnl0ZWNvZGUKLXsKLSAgICBzaWV2ZV9pbnRlcnBfdCAqaW50
ZXJwOwotICAgIHZvaWQgKnNjcmlwdF9jb250ZXh0OwordHlwZWRlZiBzdHJ1Y3Qgc2lldmVfYnl0
ZWNvZGUgc2lldmVfYnl0ZWNvZGVfdDsKIAorc3RydWN0IHNpZXZlX2J5dGVjb2RlIHsKKyAgICBp
bm9fdCBpbm9kZTsJCS8qIHVzZWQgdG8gcHJldmVudCBtbWFwcGluZyB0aGUgc2FtZSBzY3JpcHQg
Ki8KICAgICBjb25zdCBjaGFyICpkYXRhOwogICAgIHVuc2lnbmVkIGxvbmcgbGVuOwogICAgIGlu
dCBmZDsKKworICAgIGludCBpc19leGVjdXRpbmc7CQkvKiB1c2VkIHRvIHByZXZlbnQgcmVjdXJz
aXZlIElOQ0xVREVzICovCisKKyAgICBzaWV2ZV9ieXRlY29kZV90ICpuZXh0OworfTsKKworc3Ry
dWN0IHNpZXZlX2V4ZWN1dGUgeworICAgIHNpZXZlX2J5dGVjb2RlX3QgKmJjX2xpc3Q7CS8qIGxp
c3Qgb2YgbG9hZGVkIGJ5dGVjb2RlIGJ1ZmZlcnMgKi8KKyAgICBzaWV2ZV9ieXRlY29kZV90ICpi
Y19jdXI7CS8qIGN1cnJlbnRseSBhY3RpdmUgYnl0ZWNvZGUgYnVmZmVyICovCiB9OwogCiAvKiBn
ZW5lcmF0ZWQgYnkgdGhlIHlhY2Mgc2NyaXB0ICovCkluZGV4OiBzaWV2ZS9zaWV2ZS1sZXgubAo9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zaWV2ZS9zaWV2
ZS1sZXgubCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4yMC40LjEKZGlmZiAtdSAtcjEuMjAuNC4x
IHNpZXZlLWxleC5sCi0tLSBzaWV2ZS9zaWV2ZS1sZXgubAkyNyBGZWIgMjAwMyAxODoxMzo1MyAt
MDAwMAkxLjIwLjQuMQorKysgc2lldmUvc2lldmUtbGV4LmwJMzEgTWFyIDIwMDMgMTg6MTg6NDYg
LTAwMDAKQEAgLTc4LDYgKzc4LDggQEAKIDxJTklUSUFMPlwiICAgICAgICB7IEJFR0lOIFFTVFJJ
Tkc7CiAgICAgICAgICAgICAgICAgICAgIG1sY3VyID0gMDsgbWxidWZzeiA9IDA7IG1sYnVmID0g
TlVMTDsgfQogPElOSVRJQUw+WzAtOV0rW0tNR10/CXsgeXlsdmFsLm52YWwgPSB0b251bSh5eXRl
eHQpOyByZXR1cm4gTlVNQkVSOyB9Cis8SU5JVElBTD5pbmNsdWRlCXJldHVybiBJTkNMVURFOwor
PElOSVRJQUw+cmV0dXJuCQlyZXR1cm4gUkVUVVJOOwogPElOSVRJQUw+aWYJCXJldHVybiBJRjsK
IDxJTklUSUFMPmVsc2lmCQlyZXR1cm4gRUxTSUY7CiA8SU5JVElBTD5lbHNlCQlyZXR1cm4gRUxT
RTsKSW5kZXg6IHNpZXZlL3NpZXZlLnkKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcv
c3lzdGVtL2N2cy9zcmMvc2lldmUvc2lldmUueSx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xOS40
LjYKZGlmZiAtdSAtcjEuMTkuNC42IHNpZXZlLnkKLS0tIHNpZXZlL3NpZXZlLnkJMjQgTWFyIDIw
MDMgMTk6MDE6NDIgLTAwMDAJMS4xOS40LjYKKysrIHNpZXZlL3NpZXZlLnkJMzEgTWFyIDIwMDMg
MTg6MTg6NDYgLTAwMDAKQEAgLTE1MSw2ICsxNTEsNyBAQAogJXRva2VuIEFMTCBMT0NBTFBBUlQg
RE9NQUlOIFVTRVIgREVUQUlMCiAldG9rZW4gREFZUyBBRERSRVNTRVMgU1VCSkVDVCBNSU1FCiAl
dG9rZW4gTUVUSE9EIElEIE9QVElPTlMgTE9XIE5PUk1BTCBISUdIIEFOWSBNRVNTQUdFCisldG9r
ZW4gSU5DTFVERSBSRVRVUk4KIAogJXR5cGUgPGNsPiBjb21tYW5kcyBjb21tYW5kIGFjdGlvbiBl
bHNpZiBibG9jawogJXR5cGUgPHNsPiBzdHJpbmdsaXN0IHN0cmluZ3MKQEAgLTI3OSw2ICsyODAs
MTggQEAKIAkJCQkJaWYgKCQkID09IE5VTEwpIHsgCiAJCQl5eWVycm9yKCJ1bmFibGUgdG8gZmlu
ZCBhIGNvbXBhdGlibGUgY29tcGFyYXRvciIpOwogCQkJWVlFUlJPUjsgfSB9IH0KKworCSB8IElO
Q0xVREUgU1RSSU5HCSB7IGlmICghcGFyc2Vfc2NyaXB0LT5zdXBwb3J0LmluY2x1ZGUpIHsKKwkJ
CQkgICAgIHl5ZXJyb3IoImluY2x1ZGUgbm90IHJlcXVpcmVkIik7CisJICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICBZWUVSUk9SOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICB9CisJICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQgPSBuZXdfY29tbWFuZChJTkNMVURF
KTsgCisJCQkJICAgJCQtPnUuc3RyID0gJDI7IH0KKyAgICAgICAgIHwgUkVUVVJOCQkgeyBpZiAo
IXBhcnNlX3NjcmlwdC0+c3VwcG9ydC5pbmNsdWRlKSB7CisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB5eWVycm9yKCJpbmNsdWRlIG5vdCByZXF1aXJlZCIpOworICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgWVlFUlJPUjsKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICB9CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkID0g
bmV3X2NvbW1hbmQoUkVUVVJOKTsgfQogCTsKIAogbnRhZ3M6IC8qIGVtcHR5ICovCQkgeyAkJCA9
IG5ld19udGFncygpOyB9CkluZGV4OiBzaWV2ZS9zaWV2ZV9pbnRlcmZhY2UuaAo9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zaWV2ZS9zaWV2ZV9pbnRlcmZh
Y2UuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xNy40LjQKZGlmZiAtdSAtcjEuMTcuNC40IHNp
ZXZlX2ludGVyZmFjZS5oCi0tLSBzaWV2ZS9zaWV2ZV9pbnRlcmZhY2UuaAkyOSBNYXIgMjAwMyAw
MToyNjo0NCAtMDAwMAkxLjE3LjQuNAorKysgc2lldmUvc2lldmVfaW50ZXJmYWNlLmgJMzEgTWFy
IDIwMDMgMTg6MTg6NDYgLTAwMDAKQEAgLTI5LDcgKzI5LDcgQEAKIAogI2luY2x1ZGUgPHN0ZGlv
Lmg+CiAKLSNkZWZpbmUgU0lFVkVfVkVSU0lPTiAiQ01VIFNpZXZlIDIuMiIKKyNkZWZpbmUgU0lF
VkVfVkVSU0lPTiAiQ01VIFNpZXZlIDIuMyIKIAogLyogZXJyb3IgY29kZXMgKi8KICNkZWZpbmUg
U0lFVkVfT0sgKDApCkBAIC0zOSw3ICszOSw3IEBACiAvKiBleHRlcm5hbCBzaWV2ZSB0eXBlcyAq
LwogdHlwZWRlZiBzdHJ1Y3Qgc2lldmVfaW50ZXJwIHNpZXZlX2ludGVycF90OwogdHlwZWRlZiBz
dHJ1Y3Qgc2lldmVfc2NyaXB0IHNpZXZlX3NjcmlwdF90OwotdHlwZWRlZiBzdHJ1Y3Qgc2lldmVf
Ynl0ZWNvZGUgc2lldmVfYnl0ZWNvZGVfdDsKK3R5cGVkZWYgc3RydWN0IHNpZXZlX2V4ZWN1dGUg
c2lldmVfZXhlY3V0ZV90OwogdHlwZWRlZiBzdHJ1Y3QgYnl0ZWNvZGVfaW5mbyBieXRlY29kZV9p
bmZvX3Q7CiAKIHR5cGVkZWYgaW50IHNpZXZlX2NhbGxiYWNrKHZvaWQgKmFjdGlvbl9jb250ZXh0
LCB2b2lkICppbnRlcnBfY29udGV4dCwgCkBAIC01Miw2ICs1Miw4IEBACiB0eXBlZGVmIGludCBz
aWV2ZV9nZXRfZW52ZWxvcGUodm9pZCAqbWVzc2FnZV9jb250ZXh0LCAKIAkJCSAgICAgICBjb25z
dCBjaGFyICpmaWVsZCwKIAkJCSAgICAgICBjb25zdCBjaGFyICoqKmNvbnRlbnRzKTsKK3R5cGVk
ZWYgaW50IHNpZXZlX2dldF9pbmNsdWRlKHZvaWQgKnNjcmlwdF9jb250ZXh0LCBjb25zdCBjaGFy
ICpzY3JpcHQsCisJCQkgICAgICBjaGFyICpmbmFtZSwgc2l6ZV90IHNpemUpOwogCiB0eXBlZGVm
IHN0cnVjdCBzaWV2ZV92YWNhdGlvbiB7CiAgICAgaW50IG1pbl9yZXNwb25zZTsJCS8qIDAgLT4g
ZGVmYXVsdHMgdG8gMyAqLwpAQCAtMTI5LDYgKzEzMSw3IEBACiBpbnQgc2lldmVfcmVnaXN0ZXJf
c2l6ZShzaWV2ZV9pbnRlcnBfdCAqaW50ZXJwLCBzaWV2ZV9nZXRfc2l6ZSAqZik7CiBpbnQgc2ll
dmVfcmVnaXN0ZXJfaGVhZGVyKHNpZXZlX2ludGVycF90ICppbnRlcnAsIHNpZXZlX2dldF9oZWFk
ZXIgKmYpOwogaW50IHNpZXZlX3JlZ2lzdGVyX2VudmVsb3BlKHNpZXZlX2ludGVycF90ICppbnRl
cnAsIHNpZXZlX2dldF9lbnZlbG9wZSAqZik7CitpbnQgc2lldmVfcmVnaXN0ZXJfaW5jbHVkZShz
aWV2ZV9pbnRlcnBfdCAqaW50ZXJwLCBzaWV2ZV9nZXRfaW5jbHVkZSAqZik7CiAKIHR5cGVkZWYg
aW50IHNpZXZlX3BhcnNlX2Vycm9yKGludCBsaW5lbm8sIGNvbnN0IGNoYXIgKm1zZywgCiAJCQkg
ICAgICB2b2lkICppbnRlcnBfY29udGV4dCwKQEAgLTE0NCwxNyArMTQ3LDE3IEBACiBpbnQgc2ll
dmVfc2NyaXB0X3BhcnNlKHNpZXZlX2ludGVycF90ICppbnRlcnAsIEZJTEUgKnNjcmlwdCwKIAkJ
ICAgICAgIHZvaWQgKnNjcmlwdF9jb250ZXh0LCBzaWV2ZV9zY3JpcHRfdCAqKnJldCk7CiAKLS8q
IGdpdmVuIGEgYnl0ZWNvZGUgZmlsZSBkZXNjcmlwdG9yLCBzZXR1cCB0aGUgc2lldmVfYnl0ZWNv
ZGVfdCAqLwotaW50IHNpZXZlX3NjcmlwdF9sb2FkKGNvbnN0IGNoYXIgKmZuYW1lLCBzaWV2ZV9i
eXRlY29kZV90ICoqcmV0KTsKKy8qIGdpdmVuIGEgYnl0ZWNvZGUgZmlsZSBkZXNjcmlwdG9yLCBs
b2FkIGl0IGludG8gdGhlIHNpZXZlX2V4ZWN1dGVfdCAqLworaW50IHNpZXZlX3NjcmlwdF9sb2Fk
KGNvbnN0IGNoYXIgKmZuYW1lLCBzaWV2ZV9leGVjdXRlX3QgKipyZXQpOwogCiAvKiBVbmxvYWQg
YSBzaWV2ZV9ieXRlY29kZV90ICovCi1pbnQgc2lldmVfc2NyaXB0X3VubG9hZChzaWV2ZV9ieXRl
Y29kZV90ICoqcyk7CitpbnQgc2lldmVfc2NyaXB0X3VubG9hZChzaWV2ZV9leGVjdXRlX3QgKipz
KTsKIAogLyogRnJlZSBhIHNpZXZlX3NjcmlwdF90ICovCiBpbnQgc2lldmVfc2NyaXB0X2ZyZWUo
c2lldmVfc2NyaXB0X3QgKipzKTsKIAogLyogZXhlY3V0ZSBieXRlY29kZSBvbiBhIG1lc3NhZ2Ug
Ki8KLWludCBzaWV2ZV9leGVjdXRlX2J5dGVjb2RlKHNpZXZlX2J5dGVjb2RlX3QgKnNjcmlwdCwg
c2lldmVfaW50ZXJwX3QgKmludGVycCwKK2ludCBzaWV2ZV9leGVjdXRlX2J5dGVjb2RlKHNpZXZl
X2V4ZWN1dGVfdCAqc2NyaXB0LCBzaWV2ZV9pbnRlcnBfdCAqaW50ZXJwLAogCQkJICAgdm9pZCAq
c2NyaXB0X2NvbnRleHQsIHZvaWQgKm1lc3NhZ2VfY29udGV4dCk7CiAKIC8qIEdldCBzcGFjZSBz
ZXBhcmF0ZWQgbGlzdCBvZiBleHRlbnNpb25zIHN1cHBvcnRlZCBieSB0aGUgaW1wbGVtZW50YXRp
b24gKi8KSW5kZXg6IHNpZXZlL3NpZXZlYy5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5k
cmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL0F0dGljL3NpZXZlYy5jLHYKcmV0cmlldmluZyByZXZp
c2lvbiAxLjEuNC4xCmRpZmYgLXUgLXIxLjEuNC4xIHNpZXZlYy5jCi0tLSBzaWV2ZS9zaWV2ZWMu
YwkyNyBGZWIgMjAwMyAxODoxMzo1NCAtMDAwMAkxLjEuNC4xCisrKyBzaWV2ZS9zaWV2ZWMuYwkz
MSBNYXIgMjAwMyAxODoxODo0NiAtMDAwMApAQCAtMjI3LDYgKzIyNywxMiBAQAogCXJldHVybiBU
SU1TSUVWRV9GQUlMOwogICAgIH0KICAgCisgICAgcmVzID0gc2lldmVfcmVnaXN0ZXJfaW5jbHVk
ZShpLCAoc2lldmVfZ2V0X2luY2x1ZGUgKikgJmZvbyk7CisgICAgaWYgKHJlcyAhPSBTSUVWRV9P
SykgeworCXN5c2xvZyhMT0dfRVJSLCAic2lldmVfcmVnaXN0ZXJfaW5jbHVkZSgpIHJldHVybnMg
JWRcbiIsIHJlcyk7CisJcmV0dXJuIFRJTVNJRVZFX0ZBSUw7CisgICAgfQorICAKICAgICByZXMg
PSBzaWV2ZV9yZWdpc3Rlcl92YWNhdGlvbihpLCAmdmFjYXRpb24pOwogICAgIGlmIChyZXMgIT0g
U0lFVkVfT0spIHsKIAlzeXNsb2coTE9HX0VSUiwgInNpZXZlX3JlZ2lzdGVyX3ZhY2F0aW9uKCkg
cmV0dXJucyAlZFxuIiwgcmVzKTsKSW5kZXg6IHNpZXZlL3NpZXZlZC5jCj09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL0F0dGljL3NpZXZlZC5jLHYK
cmV0cmlldmluZyByZXZpc2lvbiAxLjEuNC4xCmRpZmYgLXUgLXIxLjEuNC4xIHNpZXZlZC5jCi0t
LSBzaWV2ZS9zaWV2ZWQuYwkyNyBGZWIgMjAwMyAxODoxMzo1NCAtMDAwMAkxLjEuNC4xCisrKyBz
aWV2ZS9zaWV2ZWQuYwkzMSBNYXIgMjAwMyAxODoxODo0NiAtMDAwMApAQCAtNDM1LDYgKzQzNSwx
NyBAQAogCSAgICBwcmludGYoIiVkOkpVTVAgJWRcbiIsaSwgZFtpKzFdLmp1bXApOwogCSAgICBp
Kz0yOwogCSAgICBicmVhazsJCSAgCisKKwljYXNlIEJfSU5DTFVERTovKjE3Ki8KKwkgICAgaSA9
IHVud3JhcF9zdHJpbmcoZCwgaSsxLCAmZGF0YSwgJmxlbik7CisJICAgIHByaW50ZigiJWQ6IElO
Q0xVREUgeyVkfSVzXG4iLCBpLCBsZW4sIGRhdGEpOworCSAgICBicmVhazsKKworCWNhc2UgQl9S
RVRVUk46LyoxOCovCisJICAgIHByaW50ZigiJWQ6IFJFVFVSTlxuIixpKTsKKwkgICAgaSsrOwor
CSAgICBicmVhazsKKwkgICAgCiAJZGVmYXVsdDoKIAkgICAgcHJpbnRmKCIlZDogJWQgKE5PVCBB
TiBPUClcbiIsaSxkW2ldLm9wKTsKIAkgICAgZXhpdCgxKTsKSW5kZXg6IHNpZXZlL3Rlc3QuYwo9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zaWV2ZS90ZXN0
LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTkuNC40CmRpZmYgLXUgLXIxLjE5LjQuNCB0ZXN0
LmMKLS0tIHNpZXZlL3Rlc3QuYwkyOSBNYXIgMjAwMyAwMToyNjo0NCAtMDAwMAkxLjE5LjQuNAor
Kysgc2lldmUvdGVzdC5jCTMxIE1hciAyMDAzIDE4OjE4OjQ2IC0wMDAwCkBAIC0zMjUsNiArMzI1
LDI2IEBACiAgICAgcmV0dXJuIFNJRVZFX09LOwogfQogCisjZGVmaW5lIFBFUlNPTkFMX1BSRUZJ
WAkiL3BlcnNvbmFsLyIKKyNkZWZpbmUgR0xPQkFMX1BSRUZJWAkiL2dsb2JhbC8iCisKK2ludCBn
ZXRpbmNsdWRlKHZvaWQgKnYsIGNvbnN0IGNoYXIgKnNjcmlwdCwgY2hhciAqZm5hbWUsIHNpemVf
dCBzaXplKQoreworICAgIGlmICghc3RybmNtcChzY3JpcHQsIFBFUlNPTkFMX1BSRUZJWCwgc3Ry
bGVuKFBFUlNPTkFMX1BSRUZJWCkpKSB7CisJc2NyaXB0ICs9IHN0cmxlbihQRVJTT05BTF9QUkVG
SVgpOworICAgIH0gZWxzZSBpZiAoIXN0cm5jbXAoc2NyaXB0LCBHTE9CQUxfUFJFRklYLCBzdHJs
ZW4oR0xPQkFMX1BSRUZJWCkpKSB7CisJc2NyaXB0ICs9IHN0cmxlbihHTE9CQUxfUFJFRklYKTsK
KyAgICB9IGVsc2UgeworCXByaW50ZigidW5rbm93biBzY3JpcHQgbmFtZXNwYWNlICVzXG4iLCBz
Y3JpcHQpOworCXJldHVybiAtMTsKKyAgICB9CisKKyAgICAvKiBhc3N1bWUgZXZlcnl0aGluZyBh
ZnRlciB0aGUgcHJlZml4IGlzIHRoZSBwYXRoICovCisgICAgc3RyY3B5KGZuYW1lLCBzY3JpcHQp
OworCisgICAgcmV0dXJuIFNJRVZFX09LOworfQorCiBpbnQgcmVkaXJlY3Qodm9pZCAqYWMsIHZv
aWQgKmljLCB2b2lkICpzYywgdm9pZCAqbWMsIGNvbnN0IGNoYXIgKiplcnJtc2cpCiB7CiAgICAg
c2lldmVfcmVkaXJlY3RfY29udGV4dF90ICpyYyA9IChzaWV2ZV9yZWRpcmVjdF9jb250ZXh0X3Qg
KikgYWM7CkBAIC02NzIsNyArNjkyLDcgQEAKIGludCBtYWluKGludCBhcmdjLCBjaGFyICphcmd2
W10pCiB7CiAgICAgc2lldmVfaW50ZXJwX3QgKmk7Ci0gICAgc2lldmVfYnl0ZWNvZGVfdCAqYmM7
CisgICAgc2lldmVfZXhlY3V0ZV90ICpleGUgPSBOVUxMOwogICAgIG1lc3NhZ2VfZGF0YV90ICpt
OwogICAgIGNoYXIgKnNjcmlwdCA9IE5VTEwsICptZXNzYWdlID0gTlVMTDsKICAgICBpbnQgYywg
Zm9yY2VfZmFpbCA9IDAsIHVzYWdlX2Vycm9yID0gMDsKQEAgLTc2NCw2ICs3ODQsMTIgQEAKIAll
eGl0KDEpOwogICAgIH0KIAorICAgIHJlcyA9IHNpZXZlX3JlZ2lzdGVyX2luY2x1ZGUoaSwgJmdl
dGluY2x1ZGUpOworICAgIGlmIChyZXMgIT0gU0lFVkVfT0spIHsKKwlwcmludGYoInNpZXZlX3Jl
Z2lzdGVyX2luY2x1ZGUoKSByZXR1cm5zICVkXG4iLCByZXMpOworCWV4aXQoMSk7CisgICAgfQor
CiAgICAgcmVzID0gc2lldmVfcmVnaXN0ZXJfdmFjYXRpb24oaSwgJnZhY2F0aW9uKTsKICAgICBp
ZiAocmVzICE9IFNJRVZFX09LKSB7CiAJcHJpbnRmKCJzaWV2ZV9yZWdpc3Rlcl92YWNhdGlvbigp
IHJldHVybnMgJWRcbiIsIHJlcyk7CkBAIC03OTUsNyArODIxLDcgQEAKICAgICAgICAgZXhpdCgx
KTsKICAgICB9ICAgCiAKLSAgICByZXMgPSBzaWV2ZV9zY3JpcHRfbG9hZChhcmd2WzJdLCAmYmMp
OworICAgIHJlcyA9IHNpZXZlX3NjcmlwdF9sb2FkKGFyZ3ZbMl0sICZleGUpOwogICAgIGlmIChy
ZXMgIT0gU0lFVkVfT0spIHsKIAlleGl0KDEpOwogICAgIH0KQEAgLTgxNCw3ICs4NDAsNyBAQAog
CSAgICBleGl0KDEpOwogCX0KIAotCXJlcyA9IHNpZXZlX2V4ZWN1dGVfYnl0ZWNvZGUoYmMsIGks
IE5VTEwsIG0pOworCXJlcyA9IHNpZXZlX2V4ZWN1dGVfYnl0ZWNvZGUoZXhlLCBpLCBOVUxMLCBt
KTsKIAlpZiAocmVzICE9IFNJRVZFX09LKSB7CiAJICAgIHByaW50Zigic2lldmVfZXhlY3V0ZV9i
eXRlY29kZSgpIHJldHVybnMgJWRcbiIsIHJlcyk7CiAJICAgIGV4aXQoMSk7CkBAIC04MjMsNyAr
ODQ5LDcgQEAKIAljbG9zZShmZCk7CiAgICAgfQogICAgIC8qdXNlZCB0byBiZSBzaWV2ZV9zY3Jp
cHRfZnJlZSovCi0gICAgcmVzID0gc2lldmVfc2NyaXB0X3VubG9hZCgmYmMpOworICAgIHJlcyA9
IHNpZXZlX3NjcmlwdF91bmxvYWQoJmV4ZSk7CiAgICAgaWYgKHJlcyAhPSBTSUVWRV9PSykgewog
CXByaW50Zigic2lldmVfc2NyaXB0X3VubG9hZCgpIHJldHVybnMgJWRcbiIsIHJlcyk7CiAJZXhp
dCgxKTsKSW5kZXg6IHRpbXNpZXZlZC9zY3JpcHR0ZXN0LmMKPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
L2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvY3lydXMvdGltc2lldmVkL3NjcmlwdHRlc3QuYyx2
CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xOC4xNi4yCmRpZmYgLXUgLXIxLjE4LjE2LjIgc2NyaXB0
dGVzdC5jCi0tLSB0aW1zaWV2ZWQvc2NyaXB0dGVzdC5jCTI3IEZlYiAyMDAzIDE4OjE0OjE2IC0w
MDAwCTEuMTguMTYuMgorKysgdGltc2lldmVkL3NjcmlwdHRlc3QuYwkzMSBNYXIgMjAwMyAxODox
ODo0NyAtMDAwMApAQCAtMTU5LDYgKzE1OSwxMiBAQAogCXJldHVybiBUSU1TSUVWRV9GQUlMOwog
ICAgIH0KICAgCisgICAgcmVzID0gc2lldmVfcmVnaXN0ZXJfaW5jbHVkZShpLCAoc2lldmVfZ2V0
X2luY2x1ZGUgKikgJmZvbyk7CisgICAgaWYgKHJlcyAhPSBTSUVWRV9PSykgeworCXN5c2xvZyhM
T0dfRVJSLCAic2lldmVfcmVnaXN0ZXJfaW5jbHVkZSgpIHJldHVybnMgJWRcbiIsIHJlcyk7CisJ
cmV0dXJuIFRJTVNJRVZFX0ZBSUw7CisgICAgfQorICAKICAgICByZXMgPSBzaWV2ZV9yZWdpc3Rl
cl92YWNhdGlvbihpLCAmdmFjYXRpb24pOwogICAgIGlmIChyZXMgIT0gU0lFVkVfT0spIHsKIAlz
eXNsb2coTE9HX0VSUiwgInNpZXZlX3JlZ2lzdGVyX3ZhY2F0aW9uKCkgcmV0dXJucyAlZFxuIiwg
cmVzKTsK
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>201</attachid>
            <date>2003-07-07 16:15 EDT</date>
            <desc>bytecode implementation of draft-daboo-sieve-include-00</desc>
            <filename>sieve-include.patch</filename>
            <type>text/plain</type>
            <size>26022</size>
            <attacher>ken@oceana.com</attacher>
            
              <data encoding="base64">SW5kZXg6IGltYXAvbG10cGQuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0
ZW0vY3ZzL3NyYy9jeXJ1cy9pbWFwL2xtdHBkLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuOTku
Mi4zNwpkaWZmIC11IC1yMS45OS4yLjM3IGxtdHBkLmMKLS0tIGltYXAvbG10cGQuYwkyNCBKdW4g
MjAwMyAyMDozMzoxMiAtMDAwMAkxLjk5LjIuMzcKKysrIGltYXAvbG10cGQuYwk3IEp1bCAyMDAz
IDIwOjA4OjUxIC0wMDAwCkBAIC0zNTcsNiArMzU3LDMyIEBACiAgICAgfQogfQogCisjZGVmaW5l
IFBFUlNPTkFMX1BSRUZJWAkiL3BlcnNvbmFsLyIKKyNkZWZpbmUgR0xPQkFMX1BSRUZJWAkiL2ds
b2JhbC8iCisKK3N0YXRpYyBpbnQgc2lldmVfZmluZF9zY3JpcHQoY29uc3QgY2hhciAqdXNlciwg
Y29uc3QgY2hhciAqc2NyaXB0LAorCQkJICAgICBjaGFyICpmbmFtZSwgc2l6ZV90IHNpemUpOwor
CitzdGF0aWMgaW50IGdldGluY2x1ZGUodm9pZCAqc2MsIGNvbnN0IGNoYXIgKnNjcmlwdCwKKwkJ
ICAgICAgY2hhciAqZm5hbWUsIHNpemVfdCBzaXplKQoreworICAgIHNjcmlwdF9kYXRhX3QgKnNk
YXRhID0gKHNjcmlwdF9kYXRhX3QgKikgc2M7CisKKyAgICBpZiAoIXN0cm5jbXAoc2NyaXB0LCBQ
RVJTT05BTF9QUkVGSVgsIHN0cmxlbihQRVJTT05BTF9QUkVGSVgpKSkgeworCXNjcmlwdCArPSBz
dHJsZW4oUEVSU09OQUxfUFJFRklYKTsKKwlyZXR1cm4gc2lldmVfZmluZF9zY3JpcHQoc2RhdGEt
PnVzZXJuYW1lLCBzY3JpcHQsIGZuYW1lLCBzaXplKTsKKyAgICB9CisgICAgZWxzZSBpZiAoIXN0
cm5jbXAoc2NyaXB0LCBHTE9CQUxfUFJFRklYLCBzdHJsZW4oR0xPQkFMX1BSRUZJWCkpKSB7CisJ
c2NyaXB0ICs9IHN0cmxlbihHTE9CQUxfUFJFRklYKTsKKwlyZXR1cm4gc2lldmVfZmluZF9zY3Jp
cHQoTlVMTCwgc2NyaXB0LCBmbmFtZSwgc2l6ZSk7CisgICAgfQorCisgICAgc3lzbG9nKExPR19O
T1RJQ0UsICJmYWlsZWQgdG8gZ2V0IHNpZXZlIHNjcmlwdCAnJXMnIGZvciB1c2VyICclcyciLAor
CSAgIHNjcmlwdCwgc2RhdGEtPnVzZXJuYW1lKTsKKworICAgIHJldHVybiBTSUVWRV9GQUlMOwor
fQorCiBzdGF0aWMgaW50IGdsb2JhbF9vdXRnb2luZ19jb3VudCA9IDA7CiAKIGludCBzZW5kX3Jl
amVjdGlvbihjb25zdCBjaGFyICpvcmlnaWQsCkBAIC05MzAsNiArOTU2LDEyIEBACiAJZmF0YWwo
InNpZXZlX3JlZ2lzdGVyX2VudmVsb3BlKCkiLCBFQ19TT0ZUV0FSRSk7CiAgICAgfQogICAgIAor
ICAgIHJlcyA9IHNpZXZlX3JlZ2lzdGVyX2luY2x1ZGUoc2lldmVfaW50ZXJwLCAmZ2V0aW5jbHVk
ZSk7CisgICAgaWYgKHJlcyAhPSBTSUVWRV9PSykgeworCXN5c2xvZyhMT0dfRVJSLCJzaWV2ZV9y
ZWdpc3Rlcl9pbmNsdWRlKCkgcmV0dXJucyAlZFxuIiwgcmVzKTsKKwlmYXRhbCgic2lldmVfcmVn
aXN0ZXJfaW5jbHVkZSgpIiwgRUNfU09GVFdBUkUpOworICAgIH0KKyAgICAKICAgICByZXMgPSBz
aWV2ZV9yZWdpc3Rlcl92YWNhdGlvbihzaWV2ZV9pbnRlcnAsICZ2YWNhdGlvbik7CiAgICAgaWYg
KHJlcyAhPSBTSUVWRV9PSykgewogCXN5c2xvZyhMT0dfRVJSLCAic2lldmVfcmVnaXN0ZXJfdmFj
YXRpb24oKSByZXR1cm5zICVkXG4iLCByZXMpOwpAQCAtOTUxLDU4ICs5ODMsNzcgQEAKIH0KIAog
LyogcmV0dXJucyB0cnVlIGlmIHVzZXIgaGFzIGEgc2lldmUgZmlsZSAqLwotc3RhdGljIGludCBz
aWV2ZV9maW5kX3NjcmlwdChjb25zdCBjaGFyICp1c2VyLCBjaGFyICpmbmFtZSwgc2l6ZV90IHNp
emUpCitzdGF0aWMgaW50IHNpZXZlX2ZpbmRfc2NyaXB0KGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0
IGNoYXIgKnNjcmlwdCwKKwkJCSAgICAgY2hhciAqZm5hbWUsIHNpemVfdCBzaXplKQogewotICAg
IGlmIChzdHJsZW4odXNlcikgPiA5MDApIHsKKyAgICBpZiAoIXVzZXIgJiYgIXNjcmlwdCkgewog
CXJldHVybiAtMTsKICAgICB9CiAgICAgCisgICAgaWYgKHVzZXIgJiYgc3RybGVuKHVzZXIpID4g
OTAwKSB7CisJcmV0dXJuIC0xOworICAgIH0KKwogICAgIGlmICghaGF2ZV9kdXBkYikgewogCS8q
IGR1cGxpY2F0ZSBkZWxpdmVyeSBkYXRhYmFzZSBpcyBuZWVkZWQgZm9yIHNpZXZlICovCiAJcmV0
dXJuIC0xOwogICAgIH0KIAogICAgIGlmIChzaWV2ZV91c2Vob21lZGlyKSB7IC8qIGxvb2sgaW4g
aG9tZWRpciAqLwotCXN0cnVjdCBwYXNzd2QgKnBlbnQgPSBnZXRwd25hbSh1c2VyKTsKLQotCWlm
IChwZW50ID09IE5VTEwpIHsKKwlpZiAoIXVzZXIpIHsgLyogZ2xvYmFsIHNjcmlwdCAqLworCSAg
ICAvKiBYWFggd2hlcmUgYXJlIGdsb2JhbCBzY3JpcHRzPyAqLwogCSAgICByZXR1cm4gLTE7CiAJ
fQorCWVsc2UgeworCSAgICBzdHJ1Y3QgcGFzc3dkICpwZW50ID0gZ2V0cHduYW0odXNlcik7CiAK
LQkvKiBjaGVjayB+VVNFUk5BTUUvLnNpZXZlICovCi0Jc25wcmludGYoZm5hbWUsIHNpemUsICIl
cy8lcyIsIHBlbnQtPnB3X2RpciwgIi5zaWV2ZSIpOworCSAgICBpZiAocGVudCA9PSBOVUxMKSB7
CisJCXJldHVybiAtMTsKKwkgICAgfQorCisJICAgIC8qIGNoZWNrIH5VU0VSTkFNRS8uc2lldmUg
Ki8KKwkgICAgc25wcmludGYoZm5hbWUsIHNpemUsICIlcy8lcyIsIHBlbnQtPnB3X2RpciwKKwkJ
ICAgICBzY3JpcHQgPyBzY3JpcHQgOiAiLnNpZXZlIik7CisJfQogICAgIH0gZWxzZSB7IC8qIGxv
b2sgaW4gc2lldmVfZGlyICovCi0JY2hhciBoYXNoLCAqZG9tYWluID0gTlVMTDsKLQljaGFyIGJ1
ZnVzZXJbTUFYX01BSUxCT1hfTkFNRSsxXTsKLQotCXN0cmxjcHkoYnVmdXNlciwgdXNlciwgc2l6
ZW9mKGJ1ZnVzZXIpKTsKKwlpZiAoIXVzZXIpIHsgLyogZ2xvYmFsIHNjcmlwdCAqLworCSAgICBz
bnByaW50ZihmbmFtZSwgc2l6ZSwgIiVzLyIsIHNpZXZlX2Rpcik7CisJfQorCWVsc2UgeworCSAg
ICBjaGFyIGhhc2gsICpkb21haW47CisJICAgIGNoYXIgYnVmdXNlcltNQVhfTUFJTEJPWF9OQU1F
KzFdOwogCi0JbWJveG5hbWVfaGllcnNlcF90b2ludGVybmFsKCZsbXRwZF9uYW1lc3BhY2UsIGJ1
ZnVzZXIsCi0JCQkJICAgIGNvbmZpZ192aXJ0ZG9tYWlucyA/Ci0JCQkJICAgIHN0cmNzcG4oYnVm
dXNlciwgIkAiKSA6IDApOworCSAgICBzdHJsY3B5KGJ1ZnVzZXIsIHVzZXIsIHNpemVvZihidWZ1
c2VyKSk7CiAKLQlpZiAoY29uZmlnX3ZpcnRkb21haW5zICYmIChkb21haW4gPSBzdHJjaHIoYnVm
dXNlciwgJ0AnKSkpIHsKLQkgICAgKmRvbWFpbisrID0gJ1wwJzsgIC8qIHNwbGl0IHVzZXJAZG9t
YWluICovCisJICAgIG1ib3huYW1lX2hpZXJzZXBfdG9pbnRlcm5hbCgmbG10cGRfbmFtZXNwYWNl
LCBidWZ1c2VyLAorCQkJCQljb25maWdfdmlydGRvbWFpbnMgPworCQkJCQlzdHJjc3BuKGJ1ZnVz
ZXIsICJAIikgOiAwKTsKKworCSAgICBpZiAoY29uZmlnX3ZpcnRkb21haW5zICYmIChkb21haW4g
PSBzdHJjaHIoYnVmdXNlciwgJ0AnKSkpIHsKKwkJY2hhciBkID0gKGNoYXIpIGRpcl9oYXNoX2Mo
ZG9tYWluKzEpOworCQkqZG9tYWluID0gJ1wwJzsgIC8qIHNwbGl0IHVzZXJAZG9tYWluICovCisJ
CWhhc2ggPSAoY2hhcikgZGlyX2hhc2hfYyh1c2VyKTsKKwkJc25wcmludGYoZm5hbWUsIHNpemUs
ICIlcyVzJWMvJXMvJWMvJXMvIiwKKwkJCSBzaWV2ZV9kaXIsIEZOQU1FX0RPTUFJTkRJUiwgZCwg
ZG9tYWluKzEsCisJCQkgaGFzaCwgYnVmdXNlcik7CisJICAgIH0KKwkgICAgZWxzZSB7CisJCWhh
c2ggPSAoY2hhcikgZGlyX2hhc2hfYyhidWZ1c2VyKTsKKworCQlzbnByaW50ZihmbmFtZSwgc2l6
ZSwgIiVzLyVjLyVzLyIsCisJCQkgc2lldmVfZGlyLCBoYXNoLCB1c2VyKTsKKwkgICAgfQogCX0K
IAotCWhhc2ggPSAoY2hhcikgZGlyX2hhc2hfYyhidWZ1c2VyKTsKLQlpZiAoZG9tYWluICYmCi0J
ICAgICEoY29uZmlnX2RlZmRvbWFpbiAmJiAhc3RyY2FzZWNtcChjb25maWdfZGVmZG9tYWluLCBk
b21haW4pKSkgewotCSAgICBjaGFyIGQgPSAoY2hhcikgZGlyX2hhc2hfYyhkb21haW4pOwotCSAg
ICBzbnByaW50ZihmbmFtZSwgc2l6ZSwgIiVzJXMlYy8lcy8lYy8lcy9kZWZhdWx0LmJjIiwKLQkJ
ICAgICBzaWV2ZV9kaXIsIEZOQU1FX0RPTUFJTkRJUiwgZCwgZG9tYWluLAotCQkgICAgIGhhc2gs
IGJ1ZnVzZXIpOwotCX0KLQllbHNlIHsKLQkgICAgc25wcmludGYoZm5hbWUsIHNpemUsICIlcy8l
Yy8lcy9kZWZhdWx0LmJjIiwKLQkJICAgICBzaWV2ZV9kaXIsIGhhc2gsIGJ1ZnVzZXIpOwotCX0K
KwlzdHJsY2F0KGZuYW1lLCBzY3JpcHQgPyBzY3JpcHQgOiAiZGVmYXVsdCIsIHNpemUpOworCXN0
cmxjYXQoZm5hbWUsICIuYmMiLCBzaXplKTsKICAgICB9CiAJCiAgICAgcmV0dXJuIDA7CiB9CiAj
ZWxzZSAvKiBVU0VfU0lFVkUgKi8KLXN0YXRpYyBpbnQgc2lldmVfZmluZF9zY3JpcHQoY29uc3Qg
Y2hhciAqdXNlciwgY2hhciAqZm5hbWUsIHNpemVfdCBzaXplKQorc3RhdGljIGludCBzaWV2ZV9m
aW5kX3NjcmlwdChjb25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpzY3JpcHQsCisJCQkgICAg
IGNoYXIgKmZuYW1lLCBzaXplX3Qgc2l6ZSkKIHsKICAgICByZXR1cm4gLTE7CiB9CkBAIC0xMTUz
LDkgKzEyMDQsOSBAQAogCSAgICBpZiAoZG9tYWluKSBzcHJpbnRmKHVzZXIrc3RybGVuKHVzZXIp
LCAiQCVzIiwgZG9tYWluKTsKIAogI2lmZGVmIFVTRV9TSUVWRQotCSAgICBpZiAoc2lldmVfZmlu
ZF9zY3JpcHQodXNlciwgZm5hbWUsIHNpemVvZihmbmFtZSkpICE9IC0xKSB7CisJICAgIGlmIChz
aWV2ZV9maW5kX3NjcmlwdCh1c2VyLCBOVUxMLCBmbmFtZSwgc2l6ZW9mKGZuYW1lKSkgIT0gLTEp
IHsKIAkJc2NyaXB0X2RhdGFfdCAqc2RhdGEgPSBOVUxMOwotCQlzaWV2ZV9ieXRlY29kZV90ICpi
YyA9IE5VTEw7CisJCXNpZXZlX2V4ZWN1dGVfdCAqYmMgPSBOVUxMOwogCiAJCXNkYXRhID0gKHNj
cmlwdF9kYXRhX3QgKikgeG1hbGxvYyhzaXplb2Yoc2NyaXB0X2RhdGFfdCkpOwogCkluZGV4OiBz
aWV2ZS9iY19kdW1wLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2
cy9zcmMvc2lldmUvQXR0aWMvYmNfZHVtcC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjEuNC4x
CmRpZmYgLXUgLXIxLjEuNC4xIGJjX2R1bXAuYwotLS0gc2lldmUvYmNfZHVtcC5jCTI3IEZlYiAy
MDAzIDE4OjEzOjUxIC0wMDAwCTEuMS40LjEKKysrIHNpZXZlL2JjX2R1bXAuYwk3IEp1bCAyMDAz
IDIwOjA4OjU0IC0wMDAwCkBAIC0yOTMsNiArMjkzLDE3IEBACiAJY2FzZSBCX05VTEw6CiAJICAg
IHByaW50ZigiJWQ6IE5VTExcbiIsaSk7CiAJICAgIGJyZWFrOworCisJY2FzZSBCX0lOQ0xVREU6
CisJICAgIHByaW50ZigiJWQ6IElOQ0xVREUgeyVkfSVzXG4iLGksCisJCSAgIGQtPmRhdGFbaSsx
XS5sZW4sZC0+ZGF0YVtpKzJdLnN0cik7CisJICAgIGkrPTI7CisJICAgIGJyZWFrOworCisJY2Fz
ZSBCX1JFVFVSTjoKKwkgICAgcHJpbnRmKCIlZDogUkVUVVJOXG4iLGkpOworCSAgICBicmVhazsK
KwogCWRlZmF1bHQ6CiAJICAgIHByaW50ZigiJWQ6ICVkXG4iLGksZC0+ZGF0YVtpXS5vcCk7CiAJ
ICAgIGJyZWFrOwpJbmRleDogc2lldmUvYmNfZW1pdC5jCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9h
ZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL0F0dGljL2JjX2VtaXQuYyx2CnJldHJpZXZp
bmcgcmV2aXNpb24gMS4xLjQuNgpkaWZmIC11IC1yMS4xLjQuNiBiY19lbWl0LmMKLS0tIHNpZXZl
L2JjX2VtaXQuYwkyNCBKdW4gMjAwMyAwMDozMTowMSAtMDAwMAkxLjEuNC42CisrKyBzaWV2ZS9i
Y19lbWl0LmMJNyBKdWwgMjAwMyAyMDowODo1NCAtMDAwMApAQCAtNDQzLDYgKzQ0Myw3IEBACiAJ
Y2FzZSBCX1JFSkVDVDoKIAljYXNlIEJfRklMRUlOVE86CiAJY2FzZSBCX1JFRElSRUNUOgorCWNh
c2UgQl9JTkNMVURFOgogCSAgICAvKmp1c3QgYSBzdHJpbmcqLwogCSAgICBsZW4gPSBiYy0+ZGF0
YVtjb2RlcCsrXS5sZW47CiAJICAgIGlmKHdyaXRlX2ludChmZCxsZW4pID09IC0xKQpAQCAtNjI3
LDYgKzYyOCw3IEBACiAJY2FzZSBCX0tFRVA6CiAJY2FzZSBCX01BUks6CiAJY2FzZSBCX1VOTUFS
SzoKKwljYXNlIEJfUkVUVVJOOgogCSAgICAvKiBObyBQYXJhbWV0ZXJzISAqLwogCSAgICBicmVh
azsKIApJbmRleDogc2lldmUvYmNfZXZhbC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5k
cmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL0F0dGljL2JjX2V2YWwuYyx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMS4xLjQuMTUKZGlmZiAtdSAtcjEuMS40LjE1IGJjX2V2YWwuYwotLS0gc2lldmUvYmNf
ZXZhbC5jCTMwIEp1biAyMDAzIDE5OjA0OjI4IC0wMDAwCTEuMS40LjE1CisrKyBzaWV2ZS9iY19l
dmFsLmMJNyBKdWwgMjAwMyAyMDowODo1NCAtMDAwMApAQCAtMzEsNiArMzEsNyBAQAogI2luY2x1
ZGUgInNpZXZlX2ludGVyZmFjZS5oIgogI2luY2x1ZGUgImludGVycC5oIgogI2luY2x1ZGUgIm1l
c3NhZ2UuaCIKKyNpbmNsdWRlICJzY3JpcHQuaCIKIAogI2luY2x1ZGUgImJ5dGVjb2RlLmgiCiAK
QEAgLTY4MSwyNiArNjgyLDMzIEBACiB9CiAKIC8qIFRoZSBlbnRyeXBvaW50IGZvciBieXRlY29k
ZSBldmFsdWF0aW9uICovCi1pbnQgc2lldmVfZXZhbF9iYyhzaWV2ZV9pbnRlcnBfdCAqaSwgY29u
c3Qgdm9pZCAqYmNfaW4sIHVuc2lnbmVkIGludCBiY19sZW4sCi0JCSAgdm9pZCAqbSwgc2lldmVf
aW1hcGZsYWdzX3QgKiBpbWFwZmxhZ3MsCitpbnQgc2lldmVfZXZhbF9iYyhzaWV2ZV9leGVjdXRl
X3QgKmV4ZSwgaW50IGlzX2luY2wsIHNpZXZlX2ludGVycF90ICppLAorCQkgIHZvaWQgKnNjLCB2
b2lkICptLCBzaWV2ZV9pbWFwZmxhZ3NfdCAqIGltYXBmbGFncywKIAkJICBhY3Rpb25fbGlzdF90
ICphY3Rpb25zLAogCQkgIG5vdGlmeV9saXN0X3QgKm5vdGlmeV9saXN0LAogCQkgIGNvbnN0IGNo
YXIgKiplcnJtc2cpIAogewogICAgIGNvbnN0IGNoYXIgKmRhdGE7Ci0gICAgdW5zaWduZWQgaW50
IGlwID0gMCwgaXBfbWF4ID0gKGJjX2xlbi9zaXplb2YoYnl0ZWNvZGVfaW5wdXRfdCkpOwogICAg
IGludCByZXM9MDsKICAgICBpbnQgb3A7CiAgICAgaW50IHZlcnNpb247CiAgICAgCi0gICAgYnl0
ZWNvZGVfaW5wdXRfdCAqYmMgPSAoYnl0ZWNvZGVfaW5wdXRfdCAqKWJjX2luOwotICAgIAorICAg
IHNpZXZlX2J5dGVjb2RlX3QgKmJjX2N1ciA9IGV4ZS0+YmNfY3VyOworICAgIGJ5dGVjb2RlX2lu
cHV0X3QgKmJjID0gKGJ5dGVjb2RlX2lucHV0X3QgKikgYmNfY3VyLT5kYXRhOworICAgIHVuc2ln
bmVkIGludCBpcCA9IDAsIGlwX21heCA9IChiY19jdXItPmxlbi9zaXplb2YoYnl0ZWNvZGVfaW5w
dXRfdCkpOworCisgICAgaWYgKGJjX2N1ci0+aXNfZXhlY3V0aW5nKSB7CisJKmVycm1zZyA9ICJS
ZWN1cnNpdmUgSW5jbHVkZSI7CisJcmV0dXJuIFNJRVZFX1JVTl9FUlJPUjsKKyAgICB9CisgICAg
YmNfY3VyLT5pc19leGVjdXRpbmcgPSAxOworCiAgICAgLyogQ2hlY2sgdGhhdCB3ZQogICAgICAq
IGEpIGhhdmUgYnl0ZWNvZGUKICAgICAgKiBiKSBpdCBpcyBhdGxlYXN0IGxvbmcgZW5vdWdoIGZv
ciB0aGUgbWFnaWMgbnVtYmVyLCB0aGUgdmVyc2lvbgogICAgICAqICAgIGFuZCBvbmUgb3Bjb2Rl
ICovCiAgICAgaWYoIWJjKSByZXR1cm4gU0lFVkVfRkFJTDsKLSAgICBpZihiY19sZW4gPCAoQllU
RUNPREVfTUFHSUNfTEVOICsgMipzaXplb2YoYnl0ZWNvZGVfaW5wdXRfdCkpKQorICAgIGlmKGJj
X2N1ci0+bGVuIDwgKEJZVEVDT0RFX01BR0lDX0xFTiArIDIqc2l6ZW9mKGJ5dGVjb2RlX2lucHV0
X3QpKSkKICAgICAgICByZXR1cm4gU0lFVkVfRkFJTDsKIAogICAgIGlmKG1lbWNtcChiYywgQllU
RUNPREVfTUFHSUMsIEJZVEVDT0RFX01BR0lDX0xFTikpIHsKQEAgLTEwOTAsNiArMTA5OCwzNiBA
QAogCSAgICBpcD0gbnRvaGwoYmNbaXArMV0uanVtcCk7CiAJICAgIGJyZWFrOwogCSAgICAKKwlj
YXNlIEJfSU5DTFVERTovKjE3Ki8KKwl7CisJICAgIGNoYXIgZm5hbWVbNDA5Nl07CisKKwkgICAg
aXAgPSB1bndyYXBfc3RyaW5nKGJjLCBpcCsxLCAmZGF0YSwgTlVMTCk7CisKKwkgICAgcmVzID0g
aS0+Z2V0aW5jbHVkZShzYywgZGF0YSwgZm5hbWUsIHNpemVvZihmbmFtZSkpOworCSAgICBpZiAo
cmVzICE9IFNJRVZFX09LKQorCQkqZXJybXNnID0gIkluY2x1ZGUgY2FuIG5vdCBmaW5kIHNjcmlw
dCI7CisKKwkgICAgaWYgKCFyZXMpIHsKKwkJcmVzID0gc2lldmVfc2NyaXB0X2xvYWQoZm5hbWUs
ICZleGUpOworCQlpZiAocmVzICE9IFNJRVZFX09LKQorCQkqZXJybXNnID0gIkluY2x1ZGUgY2Fu
IG5vdCBsb2FkIHNjcmlwdCI7CisJICAgIH0KKworCSAgICBpZiAoIXJlcykKKwkJcmVzID0gc2ll
dmVfZXZhbF9iYyhleGUsIDEsIGksIHNjLCBtLCBpbWFwZmxhZ3MsIGFjdGlvbnMsCisJCQkJICAg
IG5vdGlmeV9saXN0LCBlcnJtc2cpOworCisJICAgIGJyZWFrOworCX0KKworCWNhc2UgQl9SRVRV
Uk46LyoxOCovCisJICAgIGlmIChpc19pbmNsKQorCQlnb3RvIGRvbmU7CisJICAgIGVsc2UKKwkJ
cmVzPTE7CisJICAgIGJyZWFrOworCiAJZGVmYXVsdDoKIAkgICAgaWYoZXJybXNnKSAqZXJybXNn
ID0gIkludmFsaWQgc2lldmUgYnl0ZWNvZGUiOwogCSAgICByZXR1cm4gU0lFVkVfRkFJTDsKQEAg
LTEwOTgsNSArMTEzNiw5IEBACiAJaWYgKHJlcykgLyogd2UndmUgZWl0aGVyIGVuY291bnRlcmVk
IGFuIGVycm9yIG9yIGEgc3RvcCAqLwogCSAgICBicmVhazsKICAgICB9CisKKyAgZG9uZToKKyAg
ICBiY19jdXItPmlzX2V4ZWN1dGluZyA9IDA7CisKICAgICByZXR1cm4gcmVzOyAgICAgIAogfQpJ
bmRleDogc2lldmUvYmNfZ2VuZXJhdGUuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJl
dy9zeXN0ZW0vY3ZzL3NyYy9zaWV2ZS9BdHRpYy9iY19nZW5lcmF0ZS5jLHYKcmV0cmlldmluZyBy
ZXZpc2lvbiAxLjEuNC40CmRpZmYgLXUgLXIxLjEuNC40IGJjX2dlbmVyYXRlLmMKLS0tIHNpZXZl
L2JjX2dlbmVyYXRlLmMJMjMgSnVuIDIwMDMgMTY6MzE6NDIgLTAwMDAJMS4xLjQuNAorKysgc2ll
dmUvYmNfZ2VuZXJhdGUuYwk3IEp1bCAyMDAzIDIwOjA4OjU1IC0wMDAwCkBAIC00MDcsNiArNDA3
LDEzIEBACiAJCWlmKCFhdGxlYXN0KHJldHZhbCxjb2RlcCsxKSkgcmV0dXJuIC0xOwogCQlyZXR2
YWwtPmRhdGFbY29kZXArK10ub3AgPSBCX1VOTUFSSzsKIAkJYnJlYWs7CisKKwkgICAgY2FzZSBS
RVRVUk46CisJCS8qIFJFVFVSTiAobm8gYXJndW1lbnRzKSAqLworCQlpZighYXRsZWFzdChyZXR2
YWwsY29kZXArMSkpIHJldHVybiAtMTsKKwkJcmV0dmFsLT5kYXRhW2NvZGVwKytdLm9wID0gQl9S
RVRVUk47CisJCWJyZWFrOworCiAJICAgIGNhc2UgREVOT1RJRlk6CiAJCS8qIERFTk9USUZZICAq
LwogCQlpZighYXRsZWFzdChyZXR2YWwsY29kZXArNikpIHJldHVybiAtMTsKQEAgLTQ4MSw2ICs0
ODgsMTUgQEAKIAkJcmV0dmFsLT5kYXRhW2NvZGVwKytdLmxlbiA9IHN0cmxlbihjLT51LnN0cik7
CiAJCXJldHZhbC0+ZGF0YVtjb2RlcCsrXS5zdHIgPSBjLT51LnN0cjsKIAkJYnJlYWs7CisKKwkg
ICAgY2FzZSBJTkNMVURFOgorCQkvKiBJTkNMVURFIChTVFJJTkc6IGxlbiArIGRhdGFwdHIpICov
CisJCWlmKCFhdGxlYXN0KHJldHZhbCxjb2RlcCszKSkgcmV0dXJuIC0xOworCQlyZXR2YWwtPmRh
dGFbY29kZXArK10ub3AgPSBCX0lOQ0xVREU7CisJCXJldHZhbC0+ZGF0YVtjb2RlcCsrXS5sZW4g
PSBzdHJsZW4oYy0+dS5zdHIpOworCQlyZXR2YWwtPmRhdGFbY29kZXArK10uc3RyID0gYy0+dS5z
dHI7CisJCWJyZWFrOworCiAJICAgIGNhc2UgQURERkxBRzoKIAkJLyogQURERkxBRyBzdHJpbmds
aXN0ICovCiAJCWlmKCFhdGxlYXN0KHJldHZhbCxjb2RlcCsxKSkgcmV0dXJuIC0xOwpJbmRleDog
c2lldmUvYnl0ZWNvZGUuaAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0v
Y3ZzL3NyYy9zaWV2ZS9BdHRpYy9ieXRlY29kZS5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjEu
NC4yCmRpZmYgLXUgLXIxLjEuNC4yIGJ5dGVjb2RlLmgKLS0tIHNpZXZlL2J5dGVjb2RlLmgJMzAg
SnVuIDIwMDMgMTk6MDQ6MjggLTAwMDAJMS4xLjQuMgorKysgc2lldmUvYnl0ZWNvZGUuaAk3IEp1
bCAyMDAzIDIwOjA4OjU1IC0wMDAwCkBAIC0xMDMsNyArMTAzLDEwIEBACiAKICAgICBCX1ZBQ0FU
SU9OLC8qIHJlcXVpcmUgdmFjYXRpb24qLwogICAgIEJfTlVMTCwKLSAgICBCX0pVTVAKKyAgICBC
X0pVTVAsCisKKyAgICBCX0lOQ0xVREUsLyogcmVxdWlyZSBpbmNsdWRlICovCisgICAgQl9SRVRV
Uk4vKiByZXF1aXJlIGluY2x1ZGUgKi8KIH07CiAKIGVudW0gYnl0ZWNvZGVfY29tcHMgewpJbmRl
eDogc2lldmUvaW50ZXJwLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVt
L2N2cy9zcmMvc2lldmUvaW50ZXJwLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjIuNC4xCmRp
ZmYgLXUgLXIxLjIyLjQuMSBpbnRlcnAuYwotLS0gc2lldmUvaW50ZXJwLmMJMjcgRmViIDIwMDMg
MTg6MTM6NTIgLTAwMDAJMS4yMi40LjEKKysrIHNpZXZlL2ludGVycC5jCTcgSnVsIDIwMDMgMjA6
MDg6NTUgLTAwMDAKQEAgLTU3LDYgKzU3LDggQEAKICAgICBpLT5nZXRzaXplID0gTlVMTDsKICAg
ICBpLT5nZXRoZWFkZXIgPSBOVUxMOwogICAgIGktPmdldGVudmVsb3BlID0gTlVMTDsKKyAgICBp
LT5nZXRpbmNsdWRlID0gTlVMTDsKKwogICAgIGktPnZhY2F0aW9uID0gTlVMTDsKICAgICBpLT5u
b3RpZnkgPSBOVUxMOwogCkBAIC03MSw2ICs3Myw3IEBACiAKIHN0YXRpYyBjb25zdCBjaGFyICpz
aWV2ZV9leHRlbnNpb25zID0gImZpbGVpbnRvIHJlamVjdCBlbnZlbG9wZSB2YWNhdGlvbiIKICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIiBpbWFwZmxhZ3Mgbm90aWZ5IHN1
YmFkZHJlc3MgcmVsYXRpb25hbCIKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIiBpbmNsdWRlIgogI2lmZGVmIEVOQUJMRV9SRUdFWAogIiByZWdleCI7CiAjZWxzZQpAQCAt
MTYwLDYgKzE2MywxMiBAQAogaW50IHNpZXZlX3JlZ2lzdGVyX2VudmVsb3BlKHNpZXZlX2ludGVy
cF90ICppbnRlcnAsIHNpZXZlX2dldF9lbnZlbG9wZSAqZikKIHsKICAgICBpbnRlcnAtPmdldGVu
dmVsb3BlID0gZjsKKyAgICByZXR1cm4gU0lFVkVfT0s7Cit9CisKK2ludCBzaWV2ZV9yZWdpc3Rl
cl9pbmNsdWRlKHNpZXZlX2ludGVycF90ICppbnRlcnAsIHNpZXZlX2dldF9pbmNsdWRlICpmKQor
eworICAgIGludGVycC0+Z2V0aW5jbHVkZSA9IGY7CiAgICAgcmV0dXJuIFNJRVZFX09LOwogfQog
CkluZGV4OiBzaWV2ZS9pbnRlcnAuaAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9z
eXN0ZW0vY3ZzL3NyYy9zaWV2ZS9pbnRlcnAuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS43LjQu
MQpkaWZmIC11IC1yMS43LjQuMSBpbnRlcnAuaAotLS0gc2lldmUvaW50ZXJwLmgJMjcgRmViIDIw
MDMgMTg6MTM6NTIgLTAwMDAJMS43LjQuMQorKysgc2lldmUvaW50ZXJwLmgJNyBKdWwgMjAwMyAy
MDowODo1NSAtMDAwMApAQCAtMzksNiArMzksNyBAQAogICAgIHNpZXZlX2dldF9zaXplICpnZXRz
aXplOwogICAgIHNpZXZlX2dldF9oZWFkZXIgKmdldGhlYWRlcjsKICAgICBzaWV2ZV9nZXRfZW52
ZWxvcGUgKmdldGVudmVsb3BlOworICAgIHNpZXZlX2dldF9pbmNsdWRlICpnZXRpbmNsdWRlOwog
CiAgICAgc2lldmVfcGFyc2VfZXJyb3IgKmVycjsKIApJbmRleDogc2lldmUvc2NyaXB0LmMKPT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvc2lldmUvc2NyaXB0
LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNTQuNC45CmRpZmYgLXUgLXIxLjU0LjQuOSBzY3Jp
cHQuYwotLS0gc2lldmUvc2NyaXB0LmMJMTggTWF5IDIwMDMgMTM6NTI6MTYgLTAwMDAJMS41NC40
LjkKKysrIHNpZXZlL3NjcmlwdC5jCTcgSnVsIDIwMDMgMjA6MDg6NTUgLTAwMDAKQEAgLTExMyw2
ICsxMTMsMTMgQEAKICAgICB9IGVsc2UgaWYgKCFzdHJjbXAoImNvbXBhcmF0b3ItaTthc2NpaS1u
dW1lcmljIiwgcmVxKSkgewogCXMtPnN1cHBvcnQuaV9hc2NpaV9udW1lcmljID0gMTsKIAlyZXR1
cm4gMTsKKyAgICB9IGVsc2UgaWYgKCFzdHJjbXAoImluY2x1ZGUiLCByZXEpKSB7CisJaWYgKHMt
PmludGVycC5nZXRpbmNsdWRlKSB7CisJICAgIHMtPnN1cHBvcnQuaW5jbHVkZSA9IDE7CisJICAg
IHJldHVybiAxOworCX0gZWxzZSB7CisJICAgIHJldHVybiAwOworCX0KICAgICB9CiAgICAgcmV0
dXJuIDA7CiB9CkBAIC00MTQsMTEgKzQyMSwxMSBAQAogICoqKioqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqLwog
CiAvKiBMb2FkIGEgY29tcGlsZWQgc2NyaXB0ICovCi1pbnQgc2lldmVfc2NyaXB0X2xvYWQoY29u
c3QgY2hhciAqZm5hbWUsIHNpZXZlX2J5dGVjb2RlX3QgKipyZXQpIAoraW50IHNpZXZlX3Njcmlw
dF9sb2FkKGNvbnN0IGNoYXIgKmZuYW1lLCBzaWV2ZV9leGVjdXRlX3QgKipyZXQpIAogewogICAg
IHN0cnVjdCBzdGF0IHNidWY7Ci0gICAgc2lldmVfYnl0ZWNvZGVfdCAqcjsKLSAgICBpbnQgZmQ7
CisgICAgc2lldmVfZXhlY3V0ZV90ICpyOworICAgIHNpZXZlX2J5dGVjb2RlX3QgKmJjOwogICAg
CiAgICAgaWYgKCFmbmFtZSB8fCAhcmV0KSByZXR1cm4gU0lFVkVfRkFJTDsKICAgICAKQEAgLTQy
NywyOSArNDM0LDYyIEBACiAJcmV0dXJuIFNJRVZFX0ZBSUw7CiAgICAgfQogCi0gICAgZmQgPSBv
cGVuKGZuYW1lLCBPX1JET05MWSk7Ci0gICAgaWYgKGZkID09IC0xKSB7Ci0Jc3lzbG9nKExPR19F
UlIsICJJT0VSUk9SOiBjYW4gbm90IG9wZW4gc2lldmUgc2NyaXB0ICVzOiAlbSIsIGZuYW1lKTsK
LQlyZXR1cm4gU0lFVkVfRkFJTDsKKyAgICBpZiAoISpyZXQpIHsKKwkvKiBuZXcgc2lldmVfYnl0
ZWNvZGVfdCAqLworCXIgPSAoc2lldmVfZXhlY3V0ZV90ICopIHh6bWFsbG9jKHNpemVvZihzaWV2
ZV9leGVjdXRlX3QpKTsKKyAgICB9IGVsc2UgeworCS8qIGV4aXN0aW5nIHNpZXZlX2V4ZWN1dGVf
dCAoSU5DTFVERSkgKi8KKwlyID0gKnJldDsKKyAgICB9CisgIAorICAgIC8qIHNlZSBpZiB3ZSBh
bHJlYWR5IGhhdmUgdGhpcyBzY3JpcHQgbG9hZGVkICovCisgICAgYmMgPSByLT5iY19saXN0Owor
ICAgIHdoaWxlIChiYykgeworCWlmIChzYnVmLnN0X2lubyA9PSBiYy0+aW5vZGUpIGJyZWFrOwor
CWJjID0gYmMtPm5leHQ7CiAgICAgfQogCi0gICAgciA9IChzaWV2ZV9ieXRlY29kZV90ICopIHh6
bWFsbG9jKHNpemVvZihzaWV2ZV9ieXRlY29kZV90KSk7CisgICAgaWYgKCFiYykgeworCWludCBm
ZDsKKworCS8qIG5ldyBzY3JpcHQgLS0gbG9hZCBpdCAqLworCWZkID0gb3BlbihmbmFtZSwgT19S
RE9OTFkpOworCWlmIChmZCA9PSAtMSkgeworCSAgICBzeXNsb2coTE9HX0VSUiwgIklPRVJST1I6
IGNhbiBub3Qgb3BlbiBzaWV2ZSBzY3JpcHQgJXM6ICVtIiwgZm5hbWUpOworCSAgICByZXR1cm4g
U0lFVkVfRkFJTDsKKwl9CiAKLSAgICByLT5mZCA9IGZkOworCWJjID0gKHNpZXZlX2J5dGVjb2Rl
X3QgKikgeHptYWxsb2Moc2l6ZW9mKHNpZXZlX2J5dGVjb2RlX3QpKTsKKworCWJjLT5mZCA9IGZk
OworCWJjLT5pbm9kZSA9IHNidWYuc3RfaW5vOwogICAgIAotICAgIG1hcF9yZWZyZXNoKGZkLCAx
LCAmci0+ZGF0YSwgJnItPmxlbiwgc2J1Zi5zdF9zaXplLCBmbmFtZSwgInNpZXZlc2NyaXB0Iik7
CisJbWFwX3JlZnJlc2goZmQsIDEsICZiYy0+ZGF0YSwgJmJjLT5sZW4sIHNidWYuc3Rfc2l6ZSwK
KwkJICAgIGZuYW1lLCAic2lldmVzY3JpcHQiKTsKKworCS8qIGFkZCBidWZmZXIgdG8gbGlzdCAq
LworCWJjLT5uZXh0ID0gci0+YmNfbGlzdDsKKwlyLT5iY19saXN0ID0gYmM7CisgICAgfQogCisg
ICAgci0+YmNfY3VyID0gYmM7CiAgICAgKnJldCA9IHI7CiAgICAgcmV0dXJuIFNJRVZFX09LOwog
fQogCiAKIAotaW50IHNpZXZlX3NjcmlwdF91bmxvYWQoc2lldmVfYnl0ZWNvZGVfdCAqKnMpIAor
aW50IHNpZXZlX3NjcmlwdF91bmxvYWQoc2lldmVfZXhlY3V0ZV90ICoqcykgCiB7CiAgICAgaWYo
cyAmJiAqcykgewotCW1hcF9mcmVlKCYoKCpzKS0+ZGF0YSksICYoKCpzKS0+bGVuKSk7Ci0JY2xv
c2UoKCpzKS0+ZmQpOworCXNpZXZlX2J5dGVjb2RlX3QgKmJjID0gKCpzKS0+YmNfbGlzdDsKKwor
CS8qIGZyZWUgZWFjaCBieXRlY29kZSBidWZmZXIgaW4gdGhlIGxpbmtlZCBsaXN0ICovCisJd2hp
bGUgKGJjKSB7CisJICAgIG1hcF9mcmVlKCYoYmMtPmRhdGEpLCAmKGJjLT5sZW4pKTsKKwkgICAg
Y2xvc2UoYmMtPmZkKTsKKwkgICAgYmMgPSBiYy0+bmV4dDsKKwl9CiAJZnJlZSgqcyk7CiAJKnMg
PSBOVUxMOwogICAgIH0gCkBAIC03NTcsMTMgKzc5NywxMyBAQAogCiAKIC8qIGV4ZWN1dGUgc29t
ZSBieXRlY29kZSAqLwotaW50IHNpZXZlX2V2YWxfYmMoc2lldmVfaW50ZXJwX3QgKmksIGNvbnN0
IHZvaWQgKmJjX2luLCB1bnNpZ25lZCBpbnQgYmNfbGVuLAotCQkgIHZvaWQgKm0sIHNpZXZlX2lt
YXBmbGFnc190ICogaW1hcGZsYWdzLAoraW50IHNpZXZlX2V2YWxfYmMoc2lldmVfZXhlY3V0ZV90
ICpleGUsIGludCBpc19pbmNsLCBzaWV2ZV9pbnRlcnBfdCAqaSwKKwkJICB2b2lkICpzYywgdm9p
ZCAqbSwgc2lldmVfaW1hcGZsYWdzX3QgKiBpbWFwZmxhZ3MsCiAJCSAgYWN0aW9uX2xpc3RfdCAq
YWN0aW9ucywKIAkJICBub3RpZnlfbGlzdF90ICpub3RpZnlfbGlzdCwKIAkJICBjb25zdCBjaGFy
ICoqZXJybXNnKTsKIAotaW50IHNpZXZlX2V4ZWN1dGVfYnl0ZWNvZGUoc2lldmVfYnl0ZWNvZGVf
dCAqYmMsIHNpZXZlX2ludGVycF90ICppbnRlcnAsCitpbnQgc2lldmVfZXhlY3V0ZV9ieXRlY29k
ZShzaWV2ZV9leGVjdXRlX3QgKmV4ZSwgc2lldmVfaW50ZXJwX3QgKmludGVycCwKIAkJCSAgIHZv
aWQgKnNjcmlwdF9jb250ZXh0LCB2b2lkICptZXNzYWdlX2NvbnRleHQpIAogewogICAgIGFjdGlv
bl9saXN0X3QgKmFjdGlvbnMgPSBOVUxMOwpAQCAtODAzLDcgKzg0Myw3IEBACiAJCQkgICAgICBh
Y3Rpb25zX3N0cmluZywgZXJybXNnKTsKICAgICB9CiAgICAgCi0gICAgaWYgKHNpZXZlX2V2YWxf
YmMoaW50ZXJwLCBiYy0+ZGF0YSwgYmMtPmxlbiwgbWVzc2FnZV9jb250ZXh0LCAKKyAgICBpZiAo
c2lldmVfZXZhbF9iYyhleGUsIDAsIGludGVycCwgc2NyaXB0X2NvbnRleHQsIG1lc3NhZ2VfY29u
dGV4dCwgCiAJCSAgICAgICZpbWFwZmxhZ3MsIGFjdGlvbnMsIG5vdGlmeV9saXN0LCAmZXJybXNn
KSA8IDApCiAgICAgewogCXJldCA9IFNJRVZFX1JVTl9FUlJPUjsKSW5kZXg6IHNpZXZlL3Njcmlw
dC5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZl
L3NjcmlwdC5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjcuNC4zCmRpZmYgLXUgLXIxLjcuNC4z
IHNjcmlwdC5oCi0tLSBzaWV2ZS9zY3JpcHQuaAkyNyBNYXIgMjAwMyAxOToyODozNSAtMDAwMAkx
LjcuNC4zCisrKyBzaWV2ZS9zY3JpcHQuaAk3IEp1bCAyMDAzIDIwOjA4OjU1IC0wMDAwCkBAIC0y
OCw2ICsyOCw4IEBACiAjaWZuZGVmIFNJRVZFX1NDUklQVF9ICiAjZGVmaW5lIFNJRVZFX1NDUklQ
VF9ICiAKKyNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KKwogI2luY2x1ZGUgInNpZXZlX2ludGVyZmFj
ZS5oIgogI2luY2x1ZGUgImludGVycC5oIgogI2luY2x1ZGUgInRyZWUuaCIKQEAgLTQ5LDYgKzUx
LDcgQEAKIAlpbnQgc3ViYWRkcmVzcyAgICAgOiAxOwogCWludCByZWxhdGlvbmFsICAgICA6IDE7
CiAJaW50IGlfYXNjaWlfbnVtZXJpYzogMTsKKwlpbnQgaW5jbHVkZSAgICAgICAgOiAxOwogICAg
IH0gc3VwcG9ydDsKIAogICAgIHZvaWQgKnNjcmlwdF9jb250ZXh0OwpAQCAtNTcsMTQgKzYwLDIy
IEBACiAgICAgaW50IGVycjsKIH07CiAKLXN0cnVjdCBzaWV2ZV9ieXRlY29kZQotewotICAgIHNp
ZXZlX2ludGVycF90ICppbnRlcnA7Ci0gICAgdm9pZCAqc2NyaXB0X2NvbnRleHQ7Cit0eXBlZGVm
IHN0cnVjdCBzaWV2ZV9ieXRlY29kZSBzaWV2ZV9ieXRlY29kZV90OwogCitzdHJ1Y3Qgc2lldmVf
Ynl0ZWNvZGUgeworICAgIGlub190IGlub2RlOwkJLyogdXNlZCB0byBwcmV2ZW50IG1tYXBwaW5n
IHRoZSBzYW1lIHNjcmlwdCAqLwogICAgIGNvbnN0IGNoYXIgKmRhdGE7CiAgICAgdW5zaWduZWQg
bG9uZyBsZW47CiAgICAgaW50IGZkOworCisgICAgaW50IGlzX2V4ZWN1dGluZzsJCS8qIHVzZWQg
dG8gcHJldmVudCByZWN1cnNpdmUgSU5DTFVERXMgKi8KKworICAgIHNpZXZlX2J5dGVjb2RlX3Qg
Km5leHQ7Cit9OworCitzdHJ1Y3Qgc2lldmVfZXhlY3V0ZSB7CisgICAgc2lldmVfYnl0ZWNvZGVf
dCAqYmNfbGlzdDsJLyogbGlzdCBvZiBsb2FkZWQgYnl0ZWNvZGUgYnVmZmVycyAqLworICAgIHNp
ZXZlX2J5dGVjb2RlX3QgKmJjX2N1cjsJLyogY3VycmVudGx5IGFjdGl2ZSBieXRlY29kZSBidWZm
ZXIgKi8KIH07CiAKIC8qIGdlbmVyYXRlZCBieSB0aGUgeWFjYyBzY3JpcHQgKi8KSW5kZXg6IHNp
ZXZlL3NpZXZlLWxleC5sCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9j
dnMvc3JjL3NpZXZlL3NpZXZlLWxleC5sLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjIwLjQuMQpk
aWZmIC11IC1yMS4yMC40LjEgc2lldmUtbGV4LmwKLS0tIHNpZXZlL3NpZXZlLWxleC5sCTI3IEZl
YiAyMDAzIDE4OjEzOjUzIC0wMDAwCTEuMjAuNC4xCisrKyBzaWV2ZS9zaWV2ZS1sZXgubAk3IEp1
bCAyMDAzIDIwOjA4OjU1IC0wMDAwCkBAIC03OCw2ICs3OCw4IEBACiA8SU5JVElBTD5cIiAgICAg
ICAgeyBCRUdJTiBRU1RSSU5HOwogICAgICAgICAgICAgICAgICAgICBtbGN1ciA9IDA7IG1sYnVm
c3ogPSAwOyBtbGJ1ZiA9IE5VTEw7IH0KIDxJTklUSUFMPlswLTldK1tLTUddPwl7IHl5bHZhbC5u
dmFsID0gdG9udW0oeXl0ZXh0KTsgcmV0dXJuIE5VTUJFUjsgfQorPElOSVRJQUw+aW5jbHVkZQly
ZXR1cm4gSU5DTFVERTsKKzxJTklUSUFMPnJldHVybgkJcmV0dXJuIFJFVFVSTjsKIDxJTklUSUFM
PmlmCQlyZXR1cm4gSUY7CiA8SU5JVElBTD5lbHNpZgkJcmV0dXJuIEVMU0lGOwogPElOSVRJQUw+
ZWxzZQkJcmV0dXJuIEVMU0U7CkluZGV4OiBzaWV2ZS9zaWV2ZS55Cj09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZp
bGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL3NpZXZlLnksdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuMTkuNC43CmRpZmYgLXUgLXIxLjE5LjQuNyBzaWV2ZS55Ci0tLSBzaWV2ZS9z
aWV2ZS55CTI4IEp1biAyMDAzIDIyOjE0OjAxIC0wMDAwCTEuMTkuNC43CisrKyBzaWV2ZS9zaWV2
ZS55CTcgSnVsIDIwMDMgMjA6MDg6NTUgLTAwMDAKQEAgLTE1MSw2ICsxNTEsNyBAQAogJXRva2Vu
IEFMTCBMT0NBTFBBUlQgRE9NQUlOIFVTRVIgREVUQUlMCiAldG9rZW4gREFZUyBBRERSRVNTRVMg
U1VCSkVDVCBNSU1FCiAldG9rZW4gTUVUSE9EIElEIE9QVElPTlMgTE9XIE5PUk1BTCBISUdIIEFO
WSBNRVNTQUdFCisldG9rZW4gSU5DTFVERSBSRVRVUk4KIAogJXR5cGUgPGNsPiBjb21tYW5kcyBj
b21tYW5kIGFjdGlvbiBlbHNpZiBibG9jawogJXR5cGUgPHNsPiBzdHJpbmdsaXN0IHN0cmluZ3MK
QEAgLTI3OSw2ICsyODAsMTggQEAKIAkJCQkJaWYgKCQkID09IE5VTEwpIHsgCiAJCQl5eWVycm9y
KCJ1bmFibGUgdG8gZmluZCBhIGNvbXBhdGlibGUgY29tcGFyYXRvciIpOwogCQkJWVlFUlJPUjsg
fSB9IH0KKworCSB8IElOQ0xVREUgU1RSSU5HCSB7IGlmICghcGFyc2Vfc2NyaXB0LT5zdXBwb3J0
LmluY2x1ZGUpIHsKKwkJCQkgICAgIHl5ZXJyb3IoImluY2x1ZGUgbm90IHJlcXVpcmVkIik7CisJ
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICBZWUVSUk9SOworICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICB9CisJICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQgPSBuZXdf
Y29tbWFuZChJTkNMVURFKTsgCisJCQkJICAgJCQtPnUuc3RyID0gJDI7IH0KKyAgICAgICAgIHwg
UkVUVVJOCQkgeyBpZiAoIXBhcnNlX3NjcmlwdC0+c3VwcG9ydC5pbmNsdWRlKSB7CisgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB5eWVycm9yKCJpbmNsdWRlIG5vdCByZXF1aXJl
ZCIpOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWVlFUlJPUjsKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9CisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICQkID0gbmV3X2NvbW1hbmQoUkVUVVJOKTsgfQogCTsKIAogbnRhZ3M6IC8qIGVt
cHR5ICovCQkgeyAkJCA9IG5ld19udGFncygpOyB9CkluZGV4OiBzaWV2ZS9zaWV2ZV9pbnRlcmZh
Y2UuaAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zaWV2
ZS9zaWV2ZV9pbnRlcmZhY2UuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xNy40LjQKZGlmZiAt
dSAtcjEuMTcuNC40IHNpZXZlX2ludGVyZmFjZS5oCi0tLSBzaWV2ZS9zaWV2ZV9pbnRlcmZhY2Uu
aAkyOSBNYXIgMjAwMyAwMToyNjo0NCAtMDAwMAkxLjE3LjQuNAorKysgc2lldmUvc2lldmVfaW50
ZXJmYWNlLmgJNyBKdWwgMjAwMyAyMDowODo1NSAtMDAwMApAQCAtMjksNyArMjksNyBAQAogCiAj
aW5jbHVkZSA8c3RkaW8uaD4KIAotI2RlZmluZSBTSUVWRV9WRVJTSU9OICJDTVUgU2lldmUgMi4y
IgorI2RlZmluZSBTSUVWRV9WRVJTSU9OICJDTVUgU2lldmUgMi4zIgogCiAvKiBlcnJvciBjb2Rl
cyAqLwogI2RlZmluZSBTSUVWRV9PSyAoMCkKQEAgLTM5LDcgKzM5LDcgQEAKIC8qIGV4dGVybmFs
IHNpZXZlIHR5cGVzICovCiB0eXBlZGVmIHN0cnVjdCBzaWV2ZV9pbnRlcnAgc2lldmVfaW50ZXJw
X3Q7CiB0eXBlZGVmIHN0cnVjdCBzaWV2ZV9zY3JpcHQgc2lldmVfc2NyaXB0X3Q7Ci10eXBlZGVm
IHN0cnVjdCBzaWV2ZV9ieXRlY29kZSBzaWV2ZV9ieXRlY29kZV90OwordHlwZWRlZiBzdHJ1Y3Qg
c2lldmVfZXhlY3V0ZSBzaWV2ZV9leGVjdXRlX3Q7CiB0eXBlZGVmIHN0cnVjdCBieXRlY29kZV9p
bmZvIGJ5dGVjb2RlX2luZm9fdDsKIAogdHlwZWRlZiBpbnQgc2lldmVfY2FsbGJhY2sodm9pZCAq
YWN0aW9uX2NvbnRleHQsIHZvaWQgKmludGVycF9jb250ZXh0LCAKQEAgLTUyLDYgKzUyLDggQEAK
IHR5cGVkZWYgaW50IHNpZXZlX2dldF9lbnZlbG9wZSh2b2lkICptZXNzYWdlX2NvbnRleHQsIAog
CQkJICAgICAgIGNvbnN0IGNoYXIgKmZpZWxkLAogCQkJICAgICAgIGNvbnN0IGNoYXIgKioqY29u
dGVudHMpOwordHlwZWRlZiBpbnQgc2lldmVfZ2V0X2luY2x1ZGUodm9pZCAqc2NyaXB0X2NvbnRl
eHQsIGNvbnN0IGNoYXIgKnNjcmlwdCwKKwkJCSAgICAgIGNoYXIgKmZuYW1lLCBzaXplX3Qgc2l6
ZSk7CiAKIHR5cGVkZWYgc3RydWN0IHNpZXZlX3ZhY2F0aW9uIHsKICAgICBpbnQgbWluX3Jlc3Bv
bnNlOwkJLyogMCAtPiBkZWZhdWx0cyB0byAzICovCkBAIC0xMjksNiArMTMxLDcgQEAKIGludCBz
aWV2ZV9yZWdpc3Rlcl9zaXplKHNpZXZlX2ludGVycF90ICppbnRlcnAsIHNpZXZlX2dldF9zaXpl
ICpmKTsKIGludCBzaWV2ZV9yZWdpc3Rlcl9oZWFkZXIoc2lldmVfaW50ZXJwX3QgKmludGVycCwg
c2lldmVfZ2V0X2hlYWRlciAqZik7CiBpbnQgc2lldmVfcmVnaXN0ZXJfZW52ZWxvcGUoc2lldmVf
aW50ZXJwX3QgKmludGVycCwgc2lldmVfZ2V0X2VudmVsb3BlICpmKTsKK2ludCBzaWV2ZV9yZWdp
c3Rlcl9pbmNsdWRlKHNpZXZlX2ludGVycF90ICppbnRlcnAsIHNpZXZlX2dldF9pbmNsdWRlICpm
KTsKIAogdHlwZWRlZiBpbnQgc2lldmVfcGFyc2VfZXJyb3IoaW50IGxpbmVubywgY29uc3QgY2hh
ciAqbXNnLCAKIAkJCSAgICAgIHZvaWQgKmludGVycF9jb250ZXh0LApAQCAtMTQ0LDE3ICsxNDcs
MTcgQEAKIGludCBzaWV2ZV9zY3JpcHRfcGFyc2Uoc2lldmVfaW50ZXJwX3QgKmludGVycCwgRklM
RSAqc2NyaXB0LAogCQkgICAgICAgdm9pZCAqc2NyaXB0X2NvbnRleHQsIHNpZXZlX3NjcmlwdF90
ICoqcmV0KTsKIAotLyogZ2l2ZW4gYSBieXRlY29kZSBmaWxlIGRlc2NyaXB0b3IsIHNldHVwIHRo
ZSBzaWV2ZV9ieXRlY29kZV90ICovCi1pbnQgc2lldmVfc2NyaXB0X2xvYWQoY29uc3QgY2hhciAq
Zm5hbWUsIHNpZXZlX2J5dGVjb2RlX3QgKipyZXQpOworLyogZ2l2ZW4gYSBieXRlY29kZSBmaWxl
IGRlc2NyaXB0b3IsIGxvYWQgaXQgaW50byB0aGUgc2lldmVfZXhlY3V0ZV90ICovCitpbnQgc2ll
dmVfc2NyaXB0X2xvYWQoY29uc3QgY2hhciAqZm5hbWUsIHNpZXZlX2V4ZWN1dGVfdCAqKnJldCk7
CiAKIC8qIFVubG9hZCBhIHNpZXZlX2J5dGVjb2RlX3QgKi8KLWludCBzaWV2ZV9zY3JpcHRfdW5s
b2FkKHNpZXZlX2J5dGVjb2RlX3QgKipzKTsKK2ludCBzaWV2ZV9zY3JpcHRfdW5sb2FkKHNpZXZl
X2V4ZWN1dGVfdCAqKnMpOwogCiAvKiBGcmVlIGEgc2lldmVfc2NyaXB0X3QgKi8KIGludCBzaWV2
ZV9zY3JpcHRfZnJlZShzaWV2ZV9zY3JpcHRfdCAqKnMpOwogCiAvKiBleGVjdXRlIGJ5dGVjb2Rl
IG9uIGEgbWVzc2FnZSAqLwotaW50IHNpZXZlX2V4ZWN1dGVfYnl0ZWNvZGUoc2lldmVfYnl0ZWNv
ZGVfdCAqc2NyaXB0LCBzaWV2ZV9pbnRlcnBfdCAqaW50ZXJwLAoraW50IHNpZXZlX2V4ZWN1dGVf
Ynl0ZWNvZGUoc2lldmVfZXhlY3V0ZV90ICpzY3JpcHQsIHNpZXZlX2ludGVycF90ICppbnRlcnAs
CiAJCQkgICB2b2lkICpzY3JpcHRfY29udGV4dCwgdm9pZCAqbWVzc2FnZV9jb250ZXh0KTsKIAog
LyogR2V0IHNwYWNlIHNlcGFyYXRlZCBsaXN0IG9mIGV4dGVuc2lvbnMgc3VwcG9ydGVkIGJ5IHRo
ZSBpbXBsZW1lbnRhdGlvbiAqLwpJbmRleDogc2lldmUvc2lldmVjLmMKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvc2lldmUvQXR0aWMvc2lldmVjLmMsdgpy
ZXRyaWV2aW5nIHJldmlzaW9uIDEuMS40LjEKZGlmZiAtdSAtcjEuMS40LjEgc2lldmVjLmMKLS0t
IHNpZXZlL3NpZXZlYy5jCTI3IEZlYiAyMDAzIDE4OjEzOjU0IC0wMDAwCTEuMS40LjEKKysrIHNp
ZXZlL3NpZXZlYy5jCTcgSnVsIDIwMDMgMjA6MDg6NTUgLTAwMDAKQEAgLTIyNyw2ICsyMjcsMTIg
QEAKIAlyZXR1cm4gVElNU0lFVkVfRkFJTDsKICAgICB9CiAgIAorICAgIHJlcyA9IHNpZXZlX3Jl
Z2lzdGVyX2luY2x1ZGUoaSwgKHNpZXZlX2dldF9pbmNsdWRlICopICZmb28pOworICAgIGlmIChy
ZXMgIT0gU0lFVkVfT0spIHsKKwlzeXNsb2coTE9HX0VSUiwgInNpZXZlX3JlZ2lzdGVyX2luY2x1
ZGUoKSByZXR1cm5zICVkXG4iLCByZXMpOworCXJldHVybiBUSU1TSUVWRV9GQUlMOworICAgIH0K
KyAgCiAgICAgcmVzID0gc2lldmVfcmVnaXN0ZXJfdmFjYXRpb24oaSwgJnZhY2F0aW9uKTsKICAg
ICBpZiAocmVzICE9IFNJRVZFX09LKSB7CiAJc3lzbG9nKExPR19FUlIsICJzaWV2ZV9yZWdpc3Rl
cl92YWNhdGlvbigpIHJldHVybnMgJWRcbiIsIHJlcyk7CkluZGV4OiBzaWV2ZS9zaWV2ZWQuYwo9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zaWV2ZS9BdHRp
Yy9zaWV2ZWQuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xLjQuMgpkaWZmIC11IC1yMS4xLjQu
MiBzaWV2ZWQuYwotLS0gc2lldmUvc2lldmVkLmMJMjggSnVuIDIwMDMgMjI6MTU6MDcgLTAwMDAJ
MS4xLjQuMgorKysgc2lldmUvc2lldmVkLmMJNyBKdWwgMjAwMyAyMDowODo1NSAtMDAwMApAQCAt
NDM2LDYgKzQzNiwxNyBAQAogCSAgICBwcmludGYoIiVkOkpVTVAgJWRcbiIsaSwgbnRvaGwoZFtp
KzFdLmp1bXApKTsKIAkgICAgaSs9MjsKIAkgICAgYnJlYWs7CQkgIAorCisJY2FzZSBCX0lOQ0xV
REU6LyoxNyovCisJICAgIGkgPSB1bndyYXBfc3RyaW5nKGQsIGkrMSwgJmRhdGEsICZsZW4pOwor
CSAgICBwcmludGYoIiVkOiBJTkNMVURFIHslZH0lc1xuIiwgaSwgbGVuLCBkYXRhKTsKKwkgICAg
YnJlYWs7CisKKwljYXNlIEJfUkVUVVJOOi8qMTgqLworCSAgICBwcmludGYoIiVkOiBSRVRVUk5c
biIsaSk7CisJICAgIGkrKzsKKwkgICAgYnJlYWs7CisJICAgIAogCWRlZmF1bHQ6CiAJICAgIHBy
aW50ZigiJWQ6ICVkIChOT1QgQU4gT1ApXG4iLGksbnRvaGwoZFtpXS5vcCkpOwogCSAgICBleGl0
KDEpOwpJbmRleDogc2lldmUvdGVzdC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3
L3N5c3RlbS9jdnMvc3JjL3NpZXZlL3Rlc3QuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xOS40
LjQKZGlmZiAtdSAtcjEuMTkuNC40IHRlc3QuYwotLS0gc2lldmUvdGVzdC5jCTI5IE1hciAyMDAz
IDAxOjI2OjQ0IC0wMDAwCTEuMTkuNC40CisrKyBzaWV2ZS90ZXN0LmMJNyBKdWwgMjAwMyAyMDow
ODo1NSAtMDAwMApAQCAtMzI1LDYgKzMyNSwyNiBAQAogICAgIHJldHVybiBTSUVWRV9PSzsKIH0K
IAorI2RlZmluZSBQRVJTT05BTF9QUkVGSVgJIi9wZXJzb25hbC8iCisjZGVmaW5lIEdMT0JBTF9Q
UkVGSVgJIi9nbG9iYWwvIgorCitpbnQgZ2V0aW5jbHVkZSh2b2lkICp2LCBjb25zdCBjaGFyICpz
Y3JpcHQsIGNoYXIgKmZuYW1lLCBzaXplX3Qgc2l6ZSkKK3sKKyAgICBpZiAoIXN0cm5jbXAoc2Ny
aXB0LCBQRVJTT05BTF9QUkVGSVgsIHN0cmxlbihQRVJTT05BTF9QUkVGSVgpKSkgeworCXNjcmlw
dCArPSBzdHJsZW4oUEVSU09OQUxfUFJFRklYKTsKKyAgICB9IGVsc2UgaWYgKCFzdHJuY21wKHNj
cmlwdCwgR0xPQkFMX1BSRUZJWCwgc3RybGVuKEdMT0JBTF9QUkVGSVgpKSkgeworCXNjcmlwdCAr
PSBzdHJsZW4oR0xPQkFMX1BSRUZJWCk7CisgICAgfSBlbHNlIHsKKwlwcmludGYoInVua25vd24g
c2NyaXB0IG5hbWVzcGFjZSAlc1xuIiwgc2NyaXB0KTsKKwlyZXR1cm4gLTE7CisgICAgfQorCisg
ICAgLyogYXNzdW1lIGV2ZXJ5dGhpbmcgYWZ0ZXIgdGhlIHByZWZpeCBpcyB0aGUgcGF0aCAqLwor
ICAgIHN0cmNweShmbmFtZSwgc2NyaXB0KTsKKworICAgIHJldHVybiBTSUVWRV9PSzsKK30KKwog
aW50IHJlZGlyZWN0KHZvaWQgKmFjLCB2b2lkICppYywgdm9pZCAqc2MsIHZvaWQgKm1jLCBjb25z
dCBjaGFyICoqZXJybXNnKQogewogICAgIHNpZXZlX3JlZGlyZWN0X2NvbnRleHRfdCAqcmMgPSAo
c2lldmVfcmVkaXJlY3RfY29udGV4dF90ICopIGFjOwpAQCAtNjcyLDcgKzY5Miw3IEBACiBpbnQg
bWFpbihpbnQgYXJnYywgY2hhciAqYXJndltdKQogewogICAgIHNpZXZlX2ludGVycF90ICppOwot
ICAgIHNpZXZlX2J5dGVjb2RlX3QgKmJjOworICAgIHNpZXZlX2V4ZWN1dGVfdCAqZXhlID0gTlVM
TDsKICAgICBtZXNzYWdlX2RhdGFfdCAqbTsKICAgICBjaGFyICpzY3JpcHQgPSBOVUxMLCAqbWVz
c2FnZSA9IE5VTEw7CiAgICAgaW50IGMsIGZvcmNlX2ZhaWwgPSAwLCB1c2FnZV9lcnJvciA9IDA7
CkBAIC03NjQsNiArNzg0LDEyIEBACiAJZXhpdCgxKTsKICAgICB9CiAKKyAgICByZXMgPSBzaWV2
ZV9yZWdpc3Rlcl9pbmNsdWRlKGksICZnZXRpbmNsdWRlKTsKKyAgICBpZiAocmVzICE9IFNJRVZF
X09LKSB7CisJcHJpbnRmKCJzaWV2ZV9yZWdpc3Rlcl9pbmNsdWRlKCkgcmV0dXJucyAlZFxuIiwg
cmVzKTsKKwlleGl0KDEpOworICAgIH0KKwogICAgIHJlcyA9IHNpZXZlX3JlZ2lzdGVyX3ZhY2F0
aW9uKGksICZ2YWNhdGlvbik7CiAgICAgaWYgKHJlcyAhPSBTSUVWRV9PSykgewogCXByaW50Zigi
c2lldmVfcmVnaXN0ZXJfdmFjYXRpb24oKSByZXR1cm5zICVkXG4iLCByZXMpOwpAQCAtNzk1LDcg
KzgyMSw3IEBACiAgICAgICAgIGV4aXQoMSk7CiAgICAgfSAgIAogCi0gICAgcmVzID0gc2lldmVf
c2NyaXB0X2xvYWQoYXJndlsyXSwgJmJjKTsKKyAgICByZXMgPSBzaWV2ZV9zY3JpcHRfbG9hZChh
cmd2WzJdLCAmZXhlKTsKICAgICBpZiAocmVzICE9IFNJRVZFX09LKSB7CiAJZXhpdCgxKTsKICAg
ICB9CkBAIC04MTQsNyArODQwLDcgQEAKIAkgICAgZXhpdCgxKTsKIAl9CiAKLQlyZXMgPSBzaWV2
ZV9leGVjdXRlX2J5dGVjb2RlKGJjLCBpLCBOVUxMLCBtKTsKKwlyZXMgPSBzaWV2ZV9leGVjdXRl
X2J5dGVjb2RlKGV4ZSwgaSwgTlVMTCwgbSk7CiAJaWYgKHJlcyAhPSBTSUVWRV9PSykgewogCSAg
ICBwcmludGYoInNpZXZlX2V4ZWN1dGVfYnl0ZWNvZGUoKSByZXR1cm5zICVkXG4iLCByZXMpOwog
CSAgICBleGl0KDEpOwpAQCAtODIzLDcgKzg0OSw3IEBACiAJY2xvc2UoZmQpOwogICAgIH0KICAg
ICAvKnVzZWQgdG8gYmUgc2lldmVfc2NyaXB0X2ZyZWUqLwotICAgIHJlcyA9IHNpZXZlX3Njcmlw
dF91bmxvYWQoJmJjKTsKKyAgICByZXMgPSBzaWV2ZV9zY3JpcHRfdW5sb2FkKCZleGUpOwogICAg
IGlmIChyZXMgIT0gU0lFVkVfT0spIHsKIAlwcmludGYoInNpZXZlX3NjcmlwdF91bmxvYWQoKSBy
ZXR1cm5zICVkXG4iLCByZXMpOwogCWV4aXQoMSk7CkluZGV4OiB0aW1zaWV2ZWQvc2NyaXB0dGVz
dC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL2N5cnVz
L3RpbXNpZXZlZC9zY3JpcHR0ZXN0LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTguMTYuMgpk
aWZmIC11IC1yMS4xOC4xNi4yIHNjcmlwdHRlc3QuYwotLS0gdGltc2lldmVkL3NjcmlwdHRlc3Qu
YwkyNyBGZWIgMjAwMyAxODoxNDoxNiAtMDAwMAkxLjE4LjE2LjIKKysrIHRpbXNpZXZlZC9zY3Jp
cHR0ZXN0LmMJNyBKdWwgMjAwMyAyMDowODo1NyAtMDAwMApAQCAtMTU5LDYgKzE1OSwxMiBAQAog
CXJldHVybiBUSU1TSUVWRV9GQUlMOwogICAgIH0KICAgCisgICAgcmVzID0gc2lldmVfcmVnaXN0
ZXJfaW5jbHVkZShpLCAoc2lldmVfZ2V0X2luY2x1ZGUgKikgJmZvbyk7CisgICAgaWYgKHJlcyAh
PSBTSUVWRV9PSykgeworCXN5c2xvZyhMT0dfRVJSLCAic2lldmVfcmVnaXN0ZXJfaW5jbHVkZSgp
IHJldHVybnMgJWRcbiIsIHJlcyk7CisJcmV0dXJuIFRJTVNJRVZFX0ZBSUw7CisgICAgfQorICAK
ICAgICByZXMgPSBzaWV2ZV9yZWdpc3Rlcl92YWNhdGlvbihpLCAmdmFjYXRpb24pOwogICAgIGlm
IChyZXMgIT0gU0lFVkVfT0spIHsKIAlzeXNsb2coTE9HX0VSUiwgInNpZXZlX3JlZ2lzdGVyX3Zh
Y2F0aW9uKCkgcmV0dXJucyAlZFxuIiwgcmVzKTsK
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>291</attachid>
            <date>2004-07-02 16:16 EDT</date>
            <desc>bytecode implementation of draft-daboo-sieve-include-01</desc>
            <filename>sieve_include.patch</filename>
            <type>text/plain</type>
            <size>31285</size>
            <attacher>ken@oceana.com</attacher>
            
              <data encoding="base64">SW5kZXg6IGltYXAvbG10cF9zaWV2ZS5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3
L3N5c3RlbS9jdnMvc3JjL2N5cnVzL2ltYXAvbG10cF9zaWV2ZS5jLHYKcmV0cmlldmluZyByZXZp
c2lvbiAxLjEuMi4xMApkaWZmIC11IC1yMS4xLjIuMTAgbG10cF9zaWV2ZS5jCi0tLSBpbWFwL2xt
dHBfc2lldmUuYwkyNCBKdW4gMjAwNCAxNToxNjoyNyAtMDAwMAkxLjEuMi4xMAorKysgaW1hcC9s
bXRwX3NpZXZlLmMJMiBKdWwgMjAwNCAyMDowMjo0MCAtMDAwMApAQCAtMTg2LDYgKzE4Niw0MyBA
QAogfQogCiAKK3N0YXRpYyBpbnQgc2lldmVfZmluZF9zY3JpcHQoY29uc3QgY2hhciAqdXNlciwg
Y29uc3QgY2hhciAqZG9tYWluLAorCQkJICAgICBjb25zdCBjaGFyICpzY3JpcHQsIGNoYXIgKmZu
YW1lLCBzaXplX3Qgc2l6ZSk7CisKK3N0YXRpYyBpbnQgZ2V0aW5jbHVkZSh2b2lkICpzYywgY29u
c3QgY2hhciAqc2NyaXB0LCBpbnQgaXNnbG9iYWwsCisJCSAgICAgIGNoYXIgKmZuYW1lLCBzaXpl
X3Qgc2l6ZSkKK3sKKyAgICBzY3JpcHRfZGF0YV90ICpzZGF0YSA9IChzY3JpcHRfZGF0YV90ICop
IHNjOworICAgIGNoYXIgdXNlcmJ1ZltNQVhfTUFJTEJPWF9OQU1FKzFdLCAqdXNlciwgKmRvbWFp
biA9IE5VTEw7CisgICAgc3RydWN0IHN0YXQgc2J1ZjsKKyAgICBpbnQgcjsKKworICAgIGlmIChz
dHJzdHIoc2NyaXB0LCAiLi4vIikpIHsKKwlzeXNsb2coTE9HX05PVElDRSwgIklsbGVnYWwgc2Ny
aXB0IG5hbWUgJyVzJyBmb3IgdXNlciAnJXMnIiwKKwkgICAgICAgc2NyaXB0LCBzZGF0YS0+dXNl
cm5hbWUpOworCXJldHVybiBTSUVWRV9GQUlMOworICAgIH0KKworICAgIHVzZXIgPSAoY2hhciAq
KSBzZGF0YS0+dXNlcm5hbWU7CisgICAgaWYgKGNvbmZpZ192aXJ0ZG9tYWlucyAmJiBzdHJjaHIo
dXNlciwgJ0AnKSkgeworCS8qIHNwbGl0IHRoZSB1c2VyIGFuZCBkb21haW4gKi8KKwlzdHJsY3B5
KHVzZXJidWYsIHNkYXRhLT51c2VybmFtZSwgc2l6ZW9mKHVzZXJidWYpKTsKKwl1c2VyID0gdXNl
cmJ1ZjsKKwlpZiAoKGRvbWFpbiA9IHN0cnJjaHIodXNlciwgJ0AnKSkpICpkb21haW4rKyA9ICdc
MCc7CisgICAgfQorCisgICAgciA9IHNpZXZlX2ZpbmRfc2NyaXB0KGlzZ2xvYmFsID8gTlVMTCA6
IHVzZXIsIGRvbWFpbiwgc2NyaXB0LAorCQkJICBmbmFtZSwgc2l6ZSk7CisKKyAgICBpZiAoIXIg
JiYgaXNnbG9iYWwgJiYgZG9tYWluICYmIHN0YXQoZm5hbWUsICZzYnVmKSAhPSAwKSB7CisJLyog
aWYgdGhlIGRvbWFpbi1zcGVjaWZpYyBnbG9iYWwgc2NyaXB0IGRvZXNuJ3QgZXhpc3QsCisJICAg
dHJ5IGEgc2VydmVyLXdpZGUgZ2xvYmFsIHNjcmlwdCAqLworCXIgPSBzaWV2ZV9maW5kX3Njcmlw
dChOVUxMLCBOVUxMLCBzY3JpcHQsIGZuYW1lLCBzaXplKTsKKyAgICB9CisKKyAgICByZXR1cm4g
cjsKK30KKwogc3RhdGljIGludCBnbG9iYWxfb3V0Z29pbmdfY291bnQgPSAwOwogCiBzdGF0aWMg
aW50IHNlbmRfcmVqZWN0aW9uKGNvbnN0IGNoYXIgKm9yaWdpZCwKQEAgLTgwOCw2ICs4NDUsMTIg
QEAKIAlmYXRhbCgic2lldmVfcmVnaXN0ZXJfYm9keSgpIiwgRUNfU09GVFdBUkUpOwogICAgIH0K
ICAgICAKKyAgICByZXMgPSBzaWV2ZV9yZWdpc3Rlcl9pbmNsdWRlKGludGVycCwgJmdldGluY2x1
ZGUpOworICAgIGlmIChyZXMgIT0gU0lFVkVfT0spIHsKKwlzeXNsb2coTE9HX0VSUiwic2lldmVf
cmVnaXN0ZXJfaW5jbHVkZSgpIHJldHVybnMgJWRcbiIsIHJlcyk7CisJZmF0YWwoInNpZXZlX3Jl
Z2lzdGVyX2luY2x1ZGUoKSIsIEVDX1NPRlRXQVJFKTsKKyAgICB9CisKICAgICByZXMgPSBzaWV2
ZV9yZWdpc3Rlcl92YWNhdGlvbihpbnRlcnAsICZ2YWNhdGlvbik7CiAgICAgaWYgKHJlcyAhPSBT
SUVWRV9PSykgewogCXN5c2xvZyhMT0dfRVJSLCAic2lldmVfcmVnaXN0ZXJfdmFjYXRpb24oKSBy
ZXR1cm5zICVkXG4iLCByZXMpOwpAQCAtODMxLDEzICs4NzQsMTcgQEAKIH0KIAogc3RhdGljIGlu
dCBzaWV2ZV9maW5kX3NjcmlwdChjb25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpkb21haW4s
Ci0JCQkgICAgIGNoYXIgKmZuYW1lLCBzaXplX3Qgc2l6ZSkKKwkJCSAgICAgY29uc3QgY2hhciAq
c2NyaXB0LCBjaGFyICpmbmFtZSwgc2l6ZV90IHNpemUpCiB7Ci0gICAgaWYgKHN0cmxlbih1c2Vy
KSA+IDkwMCkgeworICAgIGlmICghdXNlciAmJiAhc2NyaXB0KSB7CisJcmV0dXJuIC0xOworICAg
IH0KKworICAgIGlmICh1c2VyICYmIHN0cmxlbih1c2VyKSA+IDkwMCkgewogCXJldHVybiAtMTsK
ICAgICB9CiAgICAgCi0gICAgaWYgKHNpZXZlX3VzZWhvbWVkaXIpIHsgLyogbG9vayBpbiBob21l
ZGlyICovCisgICAgaWYgKHNpZXZlX3VzZWhvbWVkaXIgJiYgdXNlcikgeyAvKiBsb29rIGluIGhv
bWVkaXIgKi8KIAlzdHJ1Y3QgcGFzc3dkICpwZW50ID0gZ2V0cHduYW0odXNlcik7CiAKIAlpZiAo
cGVudCA9PSBOVUxMKSB7CkBAIC04NDUsMTcgKzg5MiwzMCBAQAogCX0KIAogCS8qIGNoZWNrIH5V
U0VSTkFNRS8uc2lldmUgKi8KLQlzbnByaW50ZihmbmFtZSwgc2l6ZSwgIiVzLyVzIiwgcGVudC0+
cHdfZGlyLCAiLnNpZXZlIik7CisJc25wcmludGYoZm5hbWUsIHNpemUsICIlcy8lcyIsIHBlbnQt
PnB3X2Rpciwgc2NyaXB0ID8gc2NyaXB0IDogIi5zaWV2ZSIpOwogICAgIH0gZWxzZSB7IC8qIGxv
b2sgaW4gc2lldmVfZGlyICovCi0JY2hhciBoYXNoID0gKGNoYXIpIGRpcl9oYXNoX2ModXNlcik7
CisJc2l6ZV90IGxlbiA9IHN0cmxjcHkoZm5hbWUsIHNpZXZlX2Rpciwgc2l6ZSk7CiAKIAlpZiAo
ZG9tYWluKSB7CiAJICAgIGNoYXIgZGhhc2ggPSAoY2hhcikgZGlyX2hhc2hfYyhkb21haW4pOwot
CSAgICBzbnByaW50ZihmbmFtZSwgc2l6ZSwgIiVzJXMlYy8lcy8lYy8lcy9kZWZhdWx0YmMiLAot
CQkgICAgIHNpZXZlX2RpciwgRk5BTUVfRE9NQUlORElSLCBkaGFzaCwgZG9tYWluLCBoYXNoLCB1
c2VyKTsKLQl9IGVsc2UgewotCSAgICBzbnByaW50ZihmbmFtZSwgc2l6ZSwgIiVzLyVjLyVzL2Rl
ZmF1bHRiYyIsIHNpZXZlX2RpciwgaGFzaCwgdXNlcik7CisJICAgIGxlbiArPSBzbnByaW50Zihm
bmFtZStsZW4sIHNpemUtbGVuLCAiJXMlYy8lcyIsCisJCQkgICAgRk5BTUVfRE9NQUlORElSLCBk
aGFzaCwgZG9tYWluKTsKIAl9CisKKwlpZiAoIXVzZXIpIHsgLyogZ2xvYmFsIHNjcmlwdCAqLwor
CSAgICBsZW4gPSBzdHJsY2F0KGZuYW1lLCAiL2dsb2JhbC8iLCBzaXplKTsKKwl9CisJZWxzZSB7
CisJICAgIGNoYXIgaGFzaCA9IChjaGFyKSBkaXJfaGFzaF9jKHVzZXIpOworCSAgICBsZW4gKz0g
c25wcmludGYoZm5hbWUrbGVuLCBzaXplLWxlbiwgIi8lYy8lcy8iLCBoYXNoLCB1c2VyKTsKKwor
CSAgICBpZiAoIXNjcmlwdCkgeyAvKiBkZWZhdWx0IHNjcmlwdCAqLworCQlzdHJsY2F0KGZuYW1l
LCAiZGVmYXVsdGJjIiwgc2l6ZSk7CisJCXJldHVybiAwOworCSAgICB9CisJfQorCisJc25wcmlu
dGYoZm5hbWUrbGVuLCBzaXplLWxlbiwgIiVzLmJjIiwgc2NyaXB0KTsKICAgICB9CiAJCiAgICAg
cmV0dXJuIDA7CkBAIC04NjcsOSArOTI3LDkgQEAKICAgICBjaGFyIGZuYW1lW01BWF9NQUlMQk9Y
X1BBVEgrMV07CiAgICAgaW50IHIgPSAwOwogCi0gICAgaWYgKHNpZXZlX2ZpbmRfc2NyaXB0KHVz
ZXIsIGRvbWFpbiwgZm5hbWUsIHNpemVvZihmbmFtZSkpICE9IC0xKSB7CisgICAgaWYgKHNpZXZl
X2ZpbmRfc2NyaXB0KHVzZXIsIGRvbWFpbiwgTlVMTCwgZm5hbWUsIHNpemVvZihmbmFtZSkpICE9
IC0xKSB7CiAJc2NyaXB0X2RhdGFfdCAqc2RhdGEgPSBOVUxMOwotCXNpZXZlX2J5dGVjb2RlX3Qg
KmJjID0gTlVMTDsKKwlzaWV2ZV9leGVjdXRlX3QgKmJjID0gTlVMTDsKIAljaGFyIHVzZXJidWZb
TUFYX01BSUxCT1hfTkFNRSsxXTsKIAljaGFyIGF1dGh1c2VyYnVmW01BWF9NQUlMQk9YX05BTUUr
MV07CiAKSW5kZXg6IHNpZXZlL2JjX2R1bXAuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2Fu
ZHJldy9zeXN0ZW0vY3ZzL3NyYy9zaWV2ZS9iY19kdW1wLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuMi4yLjEKZGlmZiAtdSAtcjEuMi4yLjEgYmNfZHVtcC5jCi0tLSBzaWV2ZS9iY19kdW1wLmMJ
MjMgSnVuIDIwMDQgMjA6MTU6MTcgLTAwMDAJMS4yLjIuMQorKysgc2lldmUvYmNfZHVtcC5jCTIg
SnVsIDIwMDQgMjA6MDI6NDMgLTAwMDAKQEAgLTMxMyw2ICszMTMsMTcgQEAKIAljYXNlIEJfTlVM
TDoKIAkgICAgcHJpbnRmKCIlZDogTlVMTFxuIixpKTsKIAkgICAgYnJlYWs7CisKKwljYXNlIEJf
SU5DTFVERToKKwkgICAgcHJpbnRmKCIlZDogSU5DTFVERSBMT0NBVElPTjolZCB7JWR9JXNcbiIs
aSwKKwkJICAgZC0+ZGF0YVtpKzFdLnZhbHVlLGQtPmRhdGFbaSsyXS5sZW4sZC0+ZGF0YVtpKzNd
LnN0cik7CisJICAgIGkrPTM7CisJICAgIGJyZWFrOworCisJY2FzZSBCX1JFVFVSTjoKKwkgICAg
cHJpbnRmKCIlZDogUkVUVVJOXG4iLGkpOworCSAgICBicmVhazsKKwogCWRlZmF1bHQ6CiAJICAg
IHByaW50ZigiJWQ6ICVkXG4iLGksZC0+ZGF0YVtpXS5vcCk7CiAJICAgIGJyZWFrOwpJbmRleDog
c2lldmUvYmNfZW1pdC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9j
dnMvc3JjL3NpZXZlL2JjX2VtaXQuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4yLjIuMQpkaWZm
IC11IC1yMS4yLjIuMSBiY19lbWl0LmMKLS0tIHNpZXZlL2JjX2VtaXQuYwkyMyBKdW4gMjAwNCAy
MDoxNToxNyAtMDAwMAkxLjIuMi4xCisrKyBzaWV2ZS9iY19lbWl0LmMJMiBKdWwgMjAwNCAyMDow
Mjo0MyAtMDAwMApAQCAtNjczLDEyICs2NzMsMzYgQEAKIAkgICAgZmlsZWxlbiArPSBzaXplb2Yo
aW50KTsKIAkgICAgCiAJICAgIGJyZWFrOworCWNhc2UgQl9JTkNMVURFOgorCSAgICAvKiBMb2Nh
dGlvbiAod29yZCksIEZpbGVuYW1lIFN0cmluZyAqLyAKKworCSAgICAvKiBMb2NhdGlvbiAqLwor
CSAgICBpZih3cml0ZV9pbnQoZmQsIGJjLT5kYXRhW2NvZGVwXS52YWx1ZSkgPT0gLTEpCisJCXJl
dHVybiAtMTsKKwkgICAgZmlsZWxlbiArPSBzaXplb2YoaW50KTsKKwkgICAgY29kZXArKzsKKwkg
ICAgLyogRmlsZW5hbWUgKi8KKwkgICAgbGVuID0gYmMtPmRhdGFbY29kZXArK10ubGVuOworCSAg
ICBpZih3cml0ZV9pbnQoZmQsbGVuKSA9PSAtMSkKKwkJcmV0dXJuIC0xOworCisJICAgIGZpbGVs
ZW4gKz0gc2l6ZW9mKGludCk7CisJICAgIAorCSAgICBpZih3cml0ZShmZCxiYy0+ZGF0YVtjb2Rl
cCsrXS5zdHIsbGVuKSA9PSAtMSkKKwkJcmV0dXJuIC0xOworCQkKKwkgICAgcmV0ID0gYWxpZ25f
c3RyaW5nKGZkLCBsZW4pOworCSAgICBpZihyZXQgPT0gLTEpIHJldHVybiAtMTsKKwkJCisJICAg
IGZpbGVsZW4gKz0gbGVuICsgcmV0OworCSAgICBicmVhazsKIAljYXNlIEJfTlVMTDoKIAljYXNl
IEJfU1RPUDoKIAljYXNlIEJfRElTQ0FSRDoKIAljYXNlIEJfS0VFUDoKIAljYXNlIEJfTUFSSzoK
IAljYXNlIEJfVU5NQVJLOgorCWNhc2UgQl9SRVRVUk46CiAJICAgIC8qIE5vIFBhcmFtZXRlcnMh
ICovCiAJICAgIGJyZWFrOwogCkluZGV4OiBzaWV2ZS9iY19ldmFsLmMKPT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1Mg
ZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvc2lldmUvYmNfZXZhbC5jLHYKcmV0cmll
dmluZyByZXZpc2lvbiAxLjIuMi41CmRpZmYgLXUgLXIxLjIuMi41IGJjX2V2YWwuYwotLS0gc2ll
dmUvYmNfZXZhbC5jCTI4IEp1biAyMDA0IDE5OjQ5OjAyIC0wMDAwCTEuMi4yLjUKKysrIHNpZXZl
L2JjX2V2YWwuYwkyIEp1bCAyMDA0IDIwOjAyOjQzIC0wMDAwCkBAIC0zMSw2ICszMSw3IEBACiAj
aW5jbHVkZSAic2lldmVfaW50ZXJmYWNlLmgiCiAjaW5jbHVkZSAiaW50ZXJwLmgiCiAjaW5jbHVk
ZSAibWVzc2FnZS5oIgorI2luY2x1ZGUgInNjcmlwdC5oIgogCiAjaW5jbHVkZSAiYnl0ZWNvZGUu
aCIKIApAQCAtODc2LDI1ICs4NzcsMzIgQEAKIH0KIAogLyogVGhlIGVudHJ5cG9pbnQgZm9yIGJ5
dGVjb2RlIGV2YWx1YXRpb24gKi8KLWludCBzaWV2ZV9ldmFsX2JjKHNpZXZlX2ludGVycF90ICpp
LCBjb25zdCB2b2lkICpiY19pbiwgdW5zaWduZWQgaW50IGJjX2xlbiwKLQkJICBzdHJ1Y3QgaGFz
aF90YWJsZSAqYm9keV9jYWNoZSwgdm9pZCAqbSwKK2ludCBzaWV2ZV9ldmFsX2JjKHNpZXZlX2V4
ZWN1dGVfdCAqZXhlLCBpbnQgaXNfaW5jbCwgc2lldmVfaW50ZXJwX3QgKmksCisJCSAgc3RydWN0
IGhhc2hfdGFibGUgKmJvZHlfY2FjaGUsIHZvaWQgKnNjLCB2b2lkICptLAogCQkgIHNpZXZlX2lt
YXBmbGFnc190ICogaW1hcGZsYWdzLCBhY3Rpb25fbGlzdF90ICphY3Rpb25zLAogCQkgIG5vdGlm
eV9saXN0X3QgKm5vdGlmeV9saXN0LCBjb25zdCBjaGFyICoqZXJybXNnKSAKIHsKICAgICBjb25z
dCBjaGFyICpkYXRhOwotICAgIHVuc2lnbmVkIGludCBpcCA9IDAsIGlwX21heCA9IChiY19sZW4v
c2l6ZW9mKGJ5dGVjb2RlX2lucHV0X3QpKTsKICAgICBpbnQgcmVzPTA7CiAgICAgaW50IG9wOwog
ICAgIGludCB2ZXJzaW9uOwotICAgIAotICAgIGJ5dGVjb2RlX2lucHV0X3QgKmJjID0gKGJ5dGVj
b2RlX2lucHV0X3QgKiliY19pbjsKKyAgCisgICAgc2lldmVfYnl0ZWNvZGVfdCAqYmNfY3VyID0g
ZXhlLT5iY19jdXI7CisgICAgYnl0ZWNvZGVfaW5wdXRfdCAqYmMgPSAoYnl0ZWNvZGVfaW5wdXRf
dCAqKSBiY19jdXItPmRhdGE7CisgICAgdW5zaWduZWQgaW50IGlwID0gMCwgaXBfbWF4ID0gKGJj
X2N1ci0+bGVuL3NpemVvZihieXRlY29kZV9pbnB1dF90KSk7CisKKyAgICBpZiAoYmNfY3VyLT5p
c19leGVjdXRpbmcpIHsKKwkqZXJybXNnID0gIlJlY3Vyc2l2ZSBJbmNsdWRlIjsKKwlyZXR1cm4g
U0lFVkVfUlVOX0VSUk9SOworICAgIH0KKyAgICBiY19jdXItPmlzX2V4ZWN1dGluZyA9IDE7CiAg
ICAgCiAgICAgLyogQ2hlY2sgdGhhdCB3ZQogICAgICAqIGEpIGhhdmUgYnl0ZWNvZGUKICAgICAg
KiBiKSBpdCBpcyBhdGxlYXN0IGxvbmcgZW5vdWdoIGZvciB0aGUgbWFnaWMgbnVtYmVyLCB0aGUg
dmVyc2lvbgogICAgICAqICAgIGFuZCBvbmUgb3Bjb2RlICovCiAgICAgaWYoIWJjKSByZXR1cm4g
U0lFVkVfRkFJTDsKLSAgICBpZihiY19sZW4gPCAoQllURUNPREVfTUFHSUNfTEVOICsgMipzaXpl
b2YoYnl0ZWNvZGVfaW5wdXRfdCkpKQorICAgIGlmKGJjX2N1ci0+bGVuIDwgKEJZVEVDT0RFX01B
R0lDX0xFTiArIDIqc2l6ZW9mKGJ5dGVjb2RlX2lucHV0X3QpKSkKICAgICAgICByZXR1cm4gU0lF
VkVfRkFJTDsKIAogICAgIGlmKG1lbWNtcChiYywgQllURUNPREVfTUFHSUMsIEJZVEVDT0RFX01B
R0lDX0xFTikpIHsKQEAgLTEyODMsNiArMTI5MSwzOCBAQAogCSAgICBpcD0gbnRvaGwoYmNbaXAr
MV0uanVtcCk7CiAJICAgIGJyZWFrOwogCSAgICAKKwljYXNlIEJfSU5DTFVERTovKjE3Ki8KKwl7
CisJICAgIGludCBpc2dsb2JhbCA9IChudG9obChiY1tpcCsxXS52YWx1ZSkgPT0gQl9HTE9CQUwp
OworCSAgICBjaGFyIGZwYXRoWzQwOTZdOworCisJICAgIGlwID0gdW53cmFwX3N0cmluZyhiYywg
aXArMiwgJmRhdGEsIE5VTEwpOworCisJICAgIHJlcyA9IGktPmdldGluY2x1ZGUoc2MsIGRhdGEs
IGlzZ2xvYmFsLCBmcGF0aCwgc2l6ZW9mKGZwYXRoKSk7CisJICAgIGlmIChyZXMgIT0gU0lFVkVf
T0spCisJCSplcnJtc2cgPSAiSW5jbHVkZSBjYW4gbm90IGZpbmQgc2NyaXB0IjsKKworCSAgICBp
ZiAoIXJlcykgeworCQlyZXMgPSBzaWV2ZV9zY3JpcHRfbG9hZChmcGF0aCwgJmV4ZSk7CisJCWlm
IChyZXMgIT0gU0lFVkVfT0spCisJCSplcnJtc2cgPSAiSW5jbHVkZSBjYW4gbm90IGxvYWQgc2Ny
aXB0IjsKKwkgICAgfQorCisJICAgIGlmICghcmVzKQorCQlyZXMgPSBzaWV2ZV9ldmFsX2JjKGV4
ZSwgMSwgaSwgYm9keV9jYWNoZSwKKwkJCQkgICAgc2MsIG0sIGltYXBmbGFncywgYWN0aW9ucywK
KwkJCQkgICAgbm90aWZ5X2xpc3QsIGVycm1zZyk7CisKKwkgICAgYnJlYWs7CisJfQorCisJY2Fz
ZSBCX1JFVFVSTjovKjE4Ki8KKwkgICAgaWYgKGlzX2luY2wpCisJCWdvdG8gZG9uZTsKKwkgICAg
ZWxzZQorCQlyZXM9MTsKKwkgICAgYnJlYWs7CisKIAlkZWZhdWx0OgogCSAgICBpZihlcnJtc2cp
ICplcnJtc2cgPSAiSW52YWxpZCBzaWV2ZSBieXRlY29kZSI7CiAJICAgIHJldHVybiBTSUVWRV9G
QUlMOwpAQCAtMTI5MSw1ICsxMzMxLDkgQEAKIAlpZiAocmVzKSAvKiB3ZSd2ZSBlaXRoZXIgZW5j
b3VudGVyZWQgYW4gZXJyb3Igb3IgYSBzdG9wICovCiAJICAgIGJyZWFrOwogICAgIH0KKworICBk
b25lOgorICAgIGJjX2N1ci0+aXNfZXhlY3V0aW5nID0gMDsKKwogICAgIHJldHVybiByZXM7ICAg
ICAgCiB9CkluZGV4OiBzaWV2ZS9iY19nZW5lcmF0ZS5jCj09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9h
ZnMvYW5kcmV3L3N5c3RlbS9jdnMvc3JjL3NpZXZlL2JjX2dlbmVyYXRlLmMsdgpyZXRyaWV2aW5n
IHJldmlzaW9uIDEuMi4yLjEKZGlmZiAtdSAtcjEuMi4yLjEgYmNfZ2VuZXJhdGUuYwotLS0gc2ll
dmUvYmNfZ2VuZXJhdGUuYwkyMyBKdW4gMjAwNCAyMDoxNToxNyAtMDAwMAkxLjIuMi4xCisrKyBz
aWV2ZS9iY19nZW5lcmF0ZS5jCTIgSnVsIDIwMDQgMjA6MDI6NDMgLTAwMDAKQEAgLTQ1NCw2ICs0
NTQsMTMgQEAKIAkJaWYoIWF0bGVhc3QocmV0dmFsLGNvZGVwKzEpKSByZXR1cm4gLTE7CiAJCXJl
dHZhbC0+ZGF0YVtjb2RlcCsrXS5vcCA9IEJfVU5NQVJLOwogCQlicmVhazsKKworCSAgICBjYXNl
IFJFVFVSTjoKKwkJLyogUkVUVVJOIChubyBhcmd1bWVudHMpICovCisJCWlmKCFhdGxlYXN0KHJl
dHZhbCxjb2RlcCsxKSkgcmV0dXJuIC0xOworCQlyZXR2YWwtPmRhdGFbY29kZXArK10ub3AgPSBC
X1JFVFVSTjsKKwkJYnJlYWs7CisKIAkgICAgY2FzZSBERU5PVElGWToKIAkJLyogREVOT1RJRlkg
ICovCiAJCWlmKCFhdGxlYXN0KHJldHZhbCxjb2RlcCs2KSkgcmV0dXJuIC0xOwpAQCAtNTI4LDYg
KzUzNSw3IEBACiAJCXJldHZhbC0+ZGF0YVtjb2RlcCsrXS5sZW4gPSBzdHJsZW4oYy0+dS5zdHIp
OwogCQlyZXR2YWwtPmRhdGFbY29kZXArK10uc3RyID0gYy0+dS5zdHI7CiAJCWJyZWFrOworCiAJ
ICAgIGNhc2UgQURERkxBRzoKIAkJLyogQURERkxBRyBzdHJpbmdsaXN0ICovCiAJCWlmKCFhdGxl
YXN0KHJldHZhbCxjb2RlcCsxKSkgcmV0dXJuIC0xOwpAQCAtNjQzLDYgKzY1MSwyNyBAQAogCSAg
ICAKIAogCQlpZihjb2RlcCA9PSAtMSkgcmV0dXJuIC0xOworCQlicmVhazsKKwkgICAgY2FzZSBJ
TkNMVURFOgorCQkvKiBJTkNMVURFCisJCSAgIFZBTFVFIGxvY2F0aW9uCisJCSAgIFNUUklORyBm
aWxlbmFtZSAqLworCQlpZighYXRsZWFzdChyZXR2YWwsY29kZXArNCkpIHJldHVybiAtMTsKKwkJ
cmV0dmFsLT5kYXRhW2NvZGVwKytdLm9wID0gQl9JTkNMVURFOworCisJCXN3aXRjaChjLT51Lmlu
Yy5sb2NhdGlvbikgeworCQljYXNlIFBFUlNPTkFMOgorCQkgICAgcmV0dmFsLT5kYXRhW2NvZGVw
KytdLnZhbHVlID0gQl9QRVJTT05BTDsKKwkJICAgIGJyZWFrOworCQljYXNlIEdMT0JBTDoKKwkJ
ICAgIHJldHZhbC0+ZGF0YVtjb2RlcCsrXS52YWx1ZSA9IEJfR0xPQkFMOworCQkgICAgYnJlYWs7
CisJCWRlZmF1bHQ6CisJCSAgICByZXR1cm4gLTE7CisJCX0KKwkJCisJCXJldHZhbC0+ZGF0YVtj
b2RlcCsrXS5sZW4gPSBzdHJsZW4oYy0+dS5pbmMuc2NyaXB0KTsKKwkJcmV0dmFsLT5kYXRhW2Nv
ZGVwKytdLnN0ciA9IGMtPnUuaW5jLnNjcmlwdDsKIAkJYnJlYWs7CiAJICAgIGNhc2UgSUY6CiAJ
ICAgIHsKSW5kZXg6IHNpZXZlL2J5dGVjb2RlLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9h
bmRyZXcvc3lzdGVtL2N2cy9zcmMvc2lldmUvYnl0ZWNvZGUuaCx2CnJldHJpZXZpbmcgcmV2aXNp
b24gMS4yLjIuMQpkaWZmIC11IC1yMS4yLjIuMSBieXRlY29kZS5oCi0tLSBzaWV2ZS9ieXRlY29k
ZS5oCTIzIEp1biAyMDA0IDIwOjE1OjE4IC0wMDAwCTEuMi4yLjEKKysrIHNpZXZlL2J5dGVjb2Rl
LmgJMiBKdWwgMjAwNCAyMDowMjo0MyAtMDAwMApAQCAtMTAzLDcgKzEwMywxMCBAQAogCiAgICAg
Ql9WQUNBVElPTiwJCS8qIHJlcXVpcmUgdmFjYXRpb24gKi8KICAgICBCX05VTEwsCi0gICAgQl9K
VU1QCisgICAgQl9KVU1QLAorCisgICAgQl9JTkNMVURFLAkJLyogcmVxdWlyZSBpbmNsdWRlICov
CisgICAgQl9SRVRVUk4JCS8qIHJlcXVpcmUgaW5jbHVkZSAqLwogfTsKIAogZW51bSBieXRlY29k
ZV9jb21wcyB7CkBAIC0xOTYsNyArMTk5LDE2IEBACiAgICAgQl9UUkFOU0ZPUk1fUExBQ0VIT0xE
RVJfMSwKICAgICBCX1RSQU5TRk9STV9QTEFDRUhPTERFUl8yLAogICAgIEJfVFJBTlNGT1JNX1BM
QUNFSE9MREVSXzMsCi0gICAgQl9UUkFOU0ZPUk1fUExBQ0VIT0xERVJfNAorICAgIEJfVFJBTlNG
T1JNX1BMQUNFSE9MREVSXzQsCisKKyAgICAvKiBTY3JpcHQgbG9jYXRpb25zICovCisgICAgQl9Q
RVJTT05BTCwJCS8qIHJlcXVpcmUgaW5jbHVkZSAqLworICAgIEJfR0xPQkFMLAkJLyogcmVxdWly
ZSBpbmNsdWRlICovCisKKyAgICBCX0xPQ0FUSU9OX1BMQUNFSE9MREVSXzEsCisgICAgQl9MT0NB
VElPTl9QTEFDRUhPTERFUl8yLAorICAgIEJfTE9DQVRJT05fUExBQ0VIT0xERVJfMywKKyAgICBC
X0xPQ0FUSU9OX1BMQUNFSE9MREVSXzQKICAgCiB9OwogCkluZGV4OiBzaWV2ZS9pbnRlcnAuYwo9
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zaWV2ZS9pbnRl
cnAuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4yMi44LjIKZGlmZiAtdSAtcjEuMjIuOC4yIGlu
dGVycC5jCi0tLSBzaWV2ZS9pbnRlcnAuYwkyMyBKdW4gMjAwNCAyMDoxNToxOCAtMDAwMAkxLjIy
LjguMgorKysgc2lldmUvaW50ZXJwLmMJMiBKdWwgMjAwNCAyMDowMjo0MyAtMDAwMApAQCAtNTks
NiArNTksNyBAQAogICAgIGktPmdldGhlYWRlciA9IE5VTEw7CiAgICAgaS0+Z2V0ZW52ZWxvcGUg
PSBOVUxMOwogICAgIGktPmdldGJvZHkgPSBOVUxMOworICAgIGktPmdldGluY2x1ZGUgPSBOVUxM
OwogICAgIGktPnZhY2F0aW9uID0gTlVMTDsKICAgICBpLT5ub3RpZnkgPSBOVUxMOwogCkBAIC04
MSw2ICs4Miw4IEBACiAJc3RybGNhdChleHRlbnNpb25zLCAiY29tcGFyYXRvci1pO2FzY2lpLW51
bWVyaWMiLCBzaXplb2YoZXh0ZW5zaW9ucykpOwogCiAJLyogYWRkIGFjdGlvbnMgKi8KKwlpZiAo
aS0+Z2V0aW5jbHVkZSkKKwkgICAgc3RybGNhdChleHRlbnNpb25zLCAiIGluY2x1ZGUiLCBzaXpl
b2YoZXh0ZW5zaW9ucykpOwogCWlmIChpLT5maWxlaW50bykKIAkgICAgc3RybGNhdChleHRlbnNp
b25zLCAiIGZpbGVpbnRvIiwgc2l6ZW9mKGV4dGVuc2lvbnMpKTsKIAlpZiAoaS0+cmVqZWN0KQpA
QCAtMTkwLDYgKzE5MywxMiBAQAogaW50IHNpZXZlX3JlZ2lzdGVyX2VudmVsb3BlKHNpZXZlX2lu
dGVycF90ICppbnRlcnAsIHNpZXZlX2dldF9lbnZlbG9wZSAqZikKIHsKICAgICBpbnRlcnAtPmdl
dGVudmVsb3BlID0gZjsKKyAgICByZXR1cm4gU0lFVkVfT0s7Cit9CisKK2ludCBzaWV2ZV9yZWdp
c3Rlcl9pbmNsdWRlKHNpZXZlX2ludGVycF90ICppbnRlcnAsIHNpZXZlX2dldF9pbmNsdWRlICpm
KQoreworICAgIGludGVycC0+Z2V0aW5jbHVkZSA9IGY7CiAgICAgcmV0dXJuIFNJRVZFX09LOwog
fQogCkluZGV4OiBzaWV2ZS9pbnRlcnAuaAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJl
dy9zeXN0ZW0vY3ZzL3NyYy9zaWV2ZS9pbnRlcnAuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS43
LjguMQpkaWZmIC11IC1yMS43LjguMSBpbnRlcnAuaAotLS0gc2lldmUvaW50ZXJwLmgJMTggSnVu
IDIwMDQgMTY6MTM6NDEgLTAwMDAJMS43LjguMQorKysgc2lldmUvaW50ZXJwLmgJMiBKdWwgMjAw
NCAyMDowMjo0MyAtMDAwMApAQCAtNDAsNiArNDAsNyBAQAogICAgIHNpZXZlX2dldF9oZWFkZXIg
KmdldGhlYWRlcjsKICAgICBzaWV2ZV9nZXRfZW52ZWxvcGUgKmdldGVudmVsb3BlOwogICAgIHNp
ZXZlX2dldF9ib2R5ICpnZXRib2R5OworICAgIHNpZXZlX2dldF9pbmNsdWRlICpnZXRpbmNsdWRl
OwogCiAgICAgc2lldmVfcGFyc2VfZXJyb3IgKmVycjsKIApJbmRleDogc2lldmUvc2NyaXB0LmMK
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvc2lldmUvc2Ny
aXB0LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNTkuMi42CmRpZmYgLXUgLXIxLjU5LjIuNiBz
Y3JpcHQuYwotLS0gc2lldmUvc2NyaXB0LmMJMjggSnVuIDIwMDQgMjA6MDE6MjIgLTAwMDAJMS41
OS4yLjYKKysrIHNpZXZlL3NjcmlwdC5jCTIgSnVsIDIwMDQgMjA6MDI6NDMgLTAwMDAKQEAgLTEy
NSw2ICsxMjUsMTMgQEAKICAgICB9IGVsc2UgaWYgKCFzdHJjbXAoImNvbXBhcmF0b3ItaTthc2Np
aS1udW1lcmljIiwgcmVxKSkgewogCXMtPnN1cHBvcnQuaV9hc2NpaV9udW1lcmljID0gMTsKIAly
ZXR1cm4gMTsKKyAgICB9IGVsc2UgaWYgKCFzdHJjbXAoImluY2x1ZGUiLCByZXEpKSB7CisJaWYg
KHMtPmludGVycC5nZXRpbmNsdWRlKSB7CisJICAgIHMtPnN1cHBvcnQuaW5jbHVkZSA9IDE7CisJ
ICAgIHJldHVybiAxOworCX0gZWxzZSB7CisJICAgIHJldHVybiAwOworCX0KICAgICB9CiAgICAg
cmV0dXJuIDA7CiB9CkBAIC00OTgsMTEgKzUwNSwxMSBAQAogICoqKioqKioqKioqKioqKioqKioq
KioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioq
LwogCiAvKiBMb2FkIGEgY29tcGlsZWQgc2NyaXB0ICovCi1pbnQgc2lldmVfc2NyaXB0X2xvYWQo
Y29uc3QgY2hhciAqZm5hbWUsIHNpZXZlX2J5dGVjb2RlX3QgKipyZXQpIAoraW50IHNpZXZlX3Nj
cmlwdF9sb2FkKGNvbnN0IGNoYXIgKmZuYW1lLCBzaWV2ZV9leGVjdXRlX3QgKipyZXQpIAogewog
ICAgIHN0cnVjdCBzdGF0IHNidWY7Ci0gICAgc2lldmVfYnl0ZWNvZGVfdCAqcjsKLSAgICBpbnQg
ZmQ7CisgICAgc2lldmVfZXhlY3V0ZV90ICpyOworICAgIHNpZXZlX2J5dGVjb2RlX3QgKmJjOwog
ICAgCiAgICAgaWYgKCFmbmFtZSB8fCAhcmV0KSByZXR1cm4gU0lFVkVfRkFJTDsKICAgICAKQEAg
LTUxMSwzNiArNTE4LDYyIEBACiAJcmV0dXJuIFNJRVZFX0ZBSUw7CiAgICAgfQogCi0gICAgZmQg
PSBvcGVuKGZuYW1lLCBPX1JET05MWSk7Ci0gICAgaWYgKGZkID09IC0xKSB7Ci0Jc3lzbG9nKExP
R19FUlIsICJJT0VSUk9SOiBjYW4gbm90IG9wZW4gc2lldmUgc2NyaXB0ICVzOiAlbSIsIGZuYW1l
KTsKLQlyZXR1cm4gU0lFVkVfRkFJTDsKKyAgICBpZiAoISpyZXQpIHsKKwkvKiBuZXcgc2lldmVf
Ynl0ZWNvZGVfdCAqLworCXIgPSAoc2lldmVfZXhlY3V0ZV90ICopIHh6bWFsbG9jKHNpemVvZihz
aWV2ZV9leGVjdXRlX3QpKTsKKyAgICB9IGVsc2UgeworCS8qIGV4aXN0aW5nIHNpZXZlX2V4ZWN1
dGVfdCAoSU5DTFVERSkgKi8KKwlyID0gKnJldDsKICAgICB9CiAKLSAgICByID0gKHNpZXZlX2J5
dGVjb2RlX3QgKikgeHptYWxsb2Moc2l6ZW9mKHNpZXZlX2J5dGVjb2RlX3QpKTsKKyAgICAvKiBz
ZWUgaWYgd2UgYWxyZWFkeSBoYXZlIHRoaXMgc2NyaXB0IGxvYWRlZCAqLworICAgIGJjID0gci0+
YmNfbGlzdDsKKyAgICB3aGlsZSAoYmMpIHsKKwlpZiAoc2J1Zi5zdF9pbm8gPT0gYmMtPmlub2Rl
KSBicmVhazsKKwliYyA9IGJjLT5uZXh0OworICAgIH0KIAotICAgIHItPmZkID0gZmQ7Ci0gICAg
Ci0gICAgbWFwX3JlZnJlc2goZmQsIDEsICZyLT5kYXRhLCAmci0+bGVuLCBzYnVmLnN0X3NpemUs
IGZuYW1lLCAic2lldmVzY3JpcHQiKTsKKyAgICBpZiAoIWJjKSB7CisJaW50IGZkOwogCi0gICAg
aWYgKChyLT5sZW4gPCAoQllURUNPREVfTUFHSUNfTEVOICsgMipzaXplb2YoYnl0ZWNvZGVfaW5w
dXRfdCkpKSB8fAotCW1lbWNtcChyLT5kYXRhLCBCWVRFQ09ERV9NQUdJQywgQllURUNPREVfTUFH
SUNfTEVOKSkgewotCXN5c2xvZyhMT0dfRVJSLCAiSU9FUlJPUjogbm90IGEgc2lldmUgYnl0ZWNv
ZGUgZmlsZSAlcyIsIGZuYW1lKTsKLQlzaWV2ZV9zY3JpcHRfdW5sb2FkKCZyKTsKLQlyZXR1cm4g
U0lFVkVfRkFJTDsKKwkvKiBuZXcgc2NyaXB0IC0tIGxvYWQgaXQgKi8KKwlmZCA9IG9wZW4oZm5h
bWUsIE9fUkRPTkxZKTsKKwlpZiAoZmQgPT0gLTEpIHsKKwkgICAgc3lzbG9nKExPR19FUlIsICJJ
T0VSUk9SOiBjYW4gbm90IG9wZW4gc2lldmUgc2NyaXB0ICVzOiAlbSIsIGZuYW1lKTsKKwkgICAg
cmV0dXJuIFNJRVZFX0ZBSUw7CisJfQorCisJYmMgPSAoc2lldmVfYnl0ZWNvZGVfdCAqKSB4em1h
bGxvYyhzaXplb2Yoc2lldmVfYnl0ZWNvZGVfdCkpOworCisJYmMtPmZkID0gZmQ7CisJYmMtPmlu
b2RlID0gc2J1Zi5zdF9pbm87CisKKwltYXBfcmVmcmVzaChmZCwgMSwgJmJjLT5kYXRhLCAmYmMt
Pmxlbiwgc2J1Zi5zdF9zaXplLAorCQkgICAgZm5hbWUsICJzaWV2ZXNjcmlwdCIpOworCisJLyog
YWRkIGJ1ZmZlciB0byBsaXN0ICovCisJYmMtPm5leHQgPSByLT5iY19saXN0OworCXItPmJjX2xp
c3QgPSBiYzsKICAgICB9CiAKKyAgICByLT5iY19jdXIgPSBiYzsKICAgICAqcmV0ID0gcjsKICAg
ICByZXR1cm4gU0lFVkVfT0s7CiB9CiAKIAogCi1pbnQgc2lldmVfc2NyaXB0X3VubG9hZChzaWV2
ZV9ieXRlY29kZV90ICoqcykgCitpbnQgc2lldmVfc2NyaXB0X3VubG9hZChzaWV2ZV9leGVjdXRl
X3QgKipzKSAKIHsKICAgICBpZihzICYmICpzKSB7Ci0JbWFwX2ZyZWUoJigoKnMpLT5kYXRhKSwg
JigoKnMpLT5sZW4pKTsKLQljbG9zZSgoKnMpLT5mZCk7CisJc2lldmVfYnl0ZWNvZGVfdCAqYmMg
PSAoKnMpLT5iY19saXN0OworCisJLyogZnJlZSBlYWNoIGJ5dGVjb2RlIGJ1ZmZlciBpbiB0aGUg
bGlua2VkIGxpc3QgKi8KKwl3aGlsZSAoYmMpIHsKKwkgICAgbWFwX2ZyZWUoJihiYy0+ZGF0YSks
ICYoYmMtPmxlbikpOworCSAgICBjbG9zZShiYy0+ZmQpOworCSAgICBiYyA9IGJjLT5uZXh0Owor
CX0KIAlmcmVlKCpzKTsKIAkqcyA9IE5VTEw7CiAgICAgfSAKQEAgLTg1NCwxMiArODg3LDEyIEBA
CiAKIAogLyogZXhlY3V0ZSBzb21lIGJ5dGVjb2RlICovCi1pbnQgc2lldmVfZXZhbF9iYyhzaWV2
ZV9pbnRlcnBfdCAqaSwgY29uc3Qgdm9pZCAqYmNfaW4sIHVuc2lnbmVkIGludCBiY19sZW4sCi0J
CSAgc3RydWN0IGhhc2hfdGFibGUgKmJvZHlfY2FjaGUsIHZvaWQgKm0sCitpbnQgc2lldmVfZXZh
bF9iYyhzaWV2ZV9leGVjdXRlX3QgKmV4ZSwgaW50IGlzX2luY2wsIHNpZXZlX2ludGVycF90ICpp
LAorCQkgIHN0cnVjdCBoYXNoX3RhYmxlICpib2R5X2NhY2hlLCB2b2lkICpzYywgdm9pZCAqbSwK
IAkJICBzaWV2ZV9pbWFwZmxhZ3NfdCAqIGltYXBmbGFncywgYWN0aW9uX2xpc3RfdCAqYWN0aW9u
cywKIAkJICBub3RpZnlfbGlzdF90ICpub3RpZnlfbGlzdCwgY29uc3QgY2hhciAqKmVycm1zZyk7
CiAKLWludCBzaWV2ZV9leGVjdXRlX2J5dGVjb2RlKHNpZXZlX2J5dGVjb2RlX3QgKmJjLCBzaWV2
ZV9pbnRlcnBfdCAqaW50ZXJwLAoraW50IHNpZXZlX2V4ZWN1dGVfYnl0ZWNvZGUoc2lldmVfZXhl
Y3V0ZV90ICpleGUsIHNpZXZlX2ludGVycF90ICppbnRlcnAsCiAJCQkgICB2b2lkICpzY3JpcHRf
Y29udGV4dCwgdm9pZCAqbWVzc2FnZV9jb250ZXh0KSAKIHsKICAgICBhY3Rpb25fbGlzdF90ICph
Y3Rpb25zID0gTlVMTDsKQEAgLTg5OCw4ICs5MzEsOCBAQAogCQkJICAgICBhY3Rpb25zX3N0cmlu
ZywgZXJybXNnKTsKICAgICB9CiAgICAgZWxzZSB7Ci0JcmV0ID0gc2lldmVfZXZhbF9iYyhpbnRl
cnAsIGJjLT5kYXRhLCBiYy0+bGVuLAotCQkJICAgICZib2R5X2NhY2hlLCBtZXNzYWdlX2NvbnRl
eHQsCisJcmV0ID0gc2lldmVfZXZhbF9iYyhleGUsIDAsIGludGVycCwgJmJvZHlfY2FjaGUsCisJ
CQkgICAgc2NyaXB0X2NvbnRleHQsIG1lc3NhZ2VfY29udGV4dCwKIAkJCSAgICAmaW1hcGZsYWdz
LCBhY3Rpb25zLCBub3RpZnlfbGlzdCwgJmVycm1zZyk7CiAKIAlpZiAocmV0IDwgMCkgewpJbmRl
eDogc2lldmUvc2NyaXB0LmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVt
L2N2cy9zcmMvc2lldmUvc2NyaXB0LmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTEuMi4xCmRp
ZmYgLXUgLXIxLjExLjIuMSBzY3JpcHQuaAotLS0gc2lldmUvc2NyaXB0LmgJMjMgSnVuIDIwMDQg
MjA6MTU6MTkgLTAwMDAJMS4xMS4yLjEKKysrIHNpZXZlL3NjcmlwdC5oCTIgSnVsIDIwMDQgMjA6
MDI6NDMgLTAwMDAKQEAgLTI4LDYgKzI4LDggQEAKICNpZm5kZWYgU0lFVkVfU0NSSVBUX0gKICNk
ZWZpbmUgU0lFVkVfU0NSSVBUX0gKIAorI2luY2x1ZGUgPHN5cy90eXBlcy5oPgorCiAjaW5jbHVk
ZSAic2lldmVfaW50ZXJmYWNlLmgiCiAjaW5jbHVkZSAiaW50ZXJwLmgiCiAjaW5jbHVkZSAidHJl
ZS5oIgpAQCAtNTAsNiArNTIsNyBAQAogCWludCBzdWJhZGRyZXNzICAgICA6IDE7CiAJaW50IHJl
bGF0aW9uYWwgICAgIDogMTsKIAlpbnQgaV9hc2NpaV9udW1lcmljOiAxOworCWludCBpbmNsdWRl
ICAgICAgICA6IDE7CiAgICAgfSBzdXBwb3J0OwogCiAgICAgdm9pZCAqc2NyaXB0X2NvbnRleHQ7
CkBAIC01OCwxNCArNjEsMjIgQEAKICAgICBpbnQgZXJyOwogfTsKIAotc3RydWN0IHNpZXZlX2J5
dGVjb2RlCi17Ci0gICAgc2lldmVfaW50ZXJwX3QgKmludGVycDsKLSAgICB2b2lkICpzY3JpcHRf
Y29udGV4dDsKK3R5cGVkZWYgc3RydWN0IHNpZXZlX2J5dGVjb2RlIHNpZXZlX2J5dGVjb2RlX3Q7
CiAKK3N0cnVjdCBzaWV2ZV9ieXRlY29kZSB7CisgICAgaW5vX3QgaW5vZGU7CQkvKiB1c2VkIHRv
IHByZXZlbnQgbW1hcHBpbmcgdGhlIHNhbWUgc2NyaXB0ICovCiAgICAgY29uc3QgY2hhciAqZGF0
YTsKICAgICB1bnNpZ25lZCBsb25nIGxlbjsKICAgICBpbnQgZmQ7CisKKyAgICBpbnQgaXNfZXhl
Y3V0aW5nOwkJLyogdXNlZCB0byBwcmV2ZW50IHJlY3Vyc2l2ZSBJTkNMVURFcyAqLworCisgICAg
c2lldmVfYnl0ZWNvZGVfdCAqbmV4dDsKK307CisKK3N0cnVjdCBzaWV2ZV9leGVjdXRlIHsKKyAg
ICBzaWV2ZV9ieXRlY29kZV90ICpiY19saXN0OwkvKiBsaXN0IG9mIGxvYWRlZCBieXRlY29kZSBi
dWZmZXJzICovCisgICAgc2lldmVfYnl0ZWNvZGVfdCAqYmNfY3VyOwkvKiBjdXJyZW50bHkgYWN0
aXZlIGJ5dGVjb2RlIGJ1ZmZlciAqLwogfTsKIAogLyogZ2VuZXJhdGVkIGJ5IHRoZSB5YWNjIHNj
cmlwdCAqLwpJbmRleDogc2lldmUvc2lldmUtbGV4LmwKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fm
cy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvc2lldmUvc2lldmUtbGV4LmwsdgpyZXRyaWV2aW5nIHJl
dmlzaW9uIDEuMjAuOC4xCmRpZmYgLXUgLXIxLjIwLjguMSBzaWV2ZS1sZXgubAotLS0gc2lldmUv
c2lldmUtbGV4LmwJMjMgSnVuIDIwMDQgMjA6MTU6MTkgLTAwMDAJMS4yMC44LjEKKysrIHNpZXZl
L3NpZXZlLWxleC5sCTIgSnVsIDIwMDQgMjA6MDI6NDMgLTAwMDAKQEAgLTEzNyw2ICsxMzcsMTAg
QEAKIDxJTklUSUFMPjpjb250ZW50CXJldHVybiBDT05URU5UOwogPElOSVRJQUw+OmJpbmFyeQly
ZXR1cm4gQklOQVJZOwogPElOSVRJQUw+Om9mZnNldAlyZXR1cm4gT0ZGU0VUOworPElOSVRJQUw+
aW5jbHVkZQlyZXR1cm4gSU5DTFVERTsKKzxJTklUSUFMPjpwZXJzb25hbAlyZXR1cm4gUEVSU09O
QUw7Cis8SU5JVElBTD46Z2xvYmFsCXJldHVybiBHTE9CQUw7Cis8SU5JVElBTD5yZXR1cm4JCXJl
dHVybiBSRVRVUk47CiA8SU5JVElBTD5bIFx0XG5ccl0gOwkvKiBpZ25vcmUgd2hpdGVzcGFjZSAq
LwogPElOSVRJQUw+Iy4qIDsJCS8qIGlnbm9yZSBoYXNoIGNvbW1lbnRzICovCiA8SU5JVElBTD4i
LyoiKFteXCpdfFwqW15cL10pKlwqPyIqLyIgOwkvKiBpZ25vcmUgYnJhY2tldCBjb21tZW50cyAq
LwpJbmRleDogc2lldmUvc2lldmUueQo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9z
eXN0ZW0vY3ZzL3NyYy9zaWV2ZS9zaWV2ZS55LHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjIzLjIu
OApkaWZmIC11IC1yMS4yMy4yLjggc2lldmUueQotLS0gc2lldmUvc2lldmUueQkyOSBKdW4gMjAw
NCAyMDozMDozMyAtMDAwMAkxLjIzLjIuOAorKysgc2lldmUvc2lldmUueQkyIEp1bCAyMDA0IDIw
OjAyOjQzIC0wMDAwCkBAIC0xNzAsMTEgKzE3MCwxMiBAQAogJXRva2VuIFJBVyBURVhUIENPTlRF
TlQgQklOQVJZIE9GRlNFVAogJXRva2VuIERBWVMgQUREUkVTU0VTIFNVQkpFQ1QgTUlNRQogJXRv
a2VuIE1FVEhPRCBJRCBPUFRJT05TIExPVyBOT1JNQUwgSElHSCBBTlkgTUVTU0FHRQorJXRva2Vu
IElOQ0xVREUgUEVSU09OQUwgR0xPQkFMIFJFVFVSTgogCiAldHlwZSA8Y2w+IGNvbW1hbmRzIGNv
bW1hbmQgYWN0aW9uIGVsc2lmIGJsb2NrCiAldHlwZSA8c2w+IHN0cmluZ2xpc3Qgc3RyaW5ncwog
JXR5cGUgPHRlc3Q+IHRlc3QKLSV0eXBlIDxudmFsPiBjb21wdGFnIHJlbGNvbXAgc2l6ZXRhZyBh
ZGRycGFydHRhZyBhZGRyb3JlbnYgb2Zmc2V0CisldHlwZSA8bnZhbD4gY29tcHRhZyByZWxjb21w
IHNpemV0YWcgYWRkcnBhcnR0YWcgYWRkcm9yZW52IG9mZnNldCBsb2NhdGlvbgogJXR5cGUgPHRl
c3RsPiB0ZXN0bGlzdCB0ZXN0cwogJXR5cGUgPGh0YWc+IGh0YWdzCiAldHlwZSA8YWV0YWc+IGFl
dGFncwpAQCAtMzA0LDYgKzMwNSwyNCBAQAogCQkJCQlpZiAoJCQgPT0gTlVMTCkgeyAKIAkJCXl5
ZXJyb3IoInVuYWJsZSB0byBmaW5kIGEgY29tcGF0aWJsZSBjb21wYXJhdG9yIik7CiAJCQlZWUVS
Uk9SOyB9IH0gfQorCisJIHwgSU5DTFVERSBsb2NhdGlvbiBTVFJJTkcgeyBpZiAoIXBhcnNlX3Nj
cmlwdC0+c3VwcG9ydC5pbmNsdWRlKSB7CisJCQkJICAgICB5eWVycm9yKCJpbmNsdWRlIG5vdCBy
ZXF1aXJlZCIpOworCSAgICAgICAgICAgICAgICAgICAgICAgICAgICAgWVlFUlJPUjsKKyAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQorCSAgICAgICAgICAgICAgICAgICAgICAg
ICAgICQkID0gbmV3X2NvbW1hbmQoSU5DTFVERSk7CisJCQkJICAgJCQtPnUuaW5jLmxvY2F0aW9u
ID0gJDI7CisJCQkJICAgJCQtPnUuaW5jLnNjcmlwdCA9ICQzOyB9CisgICAgICAgICB8IFJFVFVS
TgkJIHsgaWYgKCFwYXJzZV9zY3JpcHQtPnN1cHBvcnQuaW5jbHVkZSkgeworICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgeXllcnJvcigiaW5jbHVkZSBub3QgcmVxdWlyZWQiKTsK
KyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFlZRVJST1I7CisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgfQorICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAkJCA9IG5ld19jb21tYW5kKFJFVFVSTik7IH0KKwk7CisKK2xvY2F0aW9uOiAvKiBlbXB0
eSAqLwkJIHsgJCQgPSBQRVJTT05BTDsgfQorCXwgUEVSU09OQUwJCSB7ICQkID0gUEVSU09OQUw7
IH0KKwl8IEdMT0JBTAkJIHsgJCQgPSBHTE9CQUw7IH0KIAk7CiAKIG50YWdzOiAvKiBlbXB0eSAq
LwkJIHsgJCQgPSBuZXdfbnRhZ3MoKTsgfQpJbmRleDogc2lldmUvc2lldmVfaW50ZXJmYWNlLmgK
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMvc2lldmUvc2ll
dmVfaW50ZXJmYWNlLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTkuMi4zCmRpZmYgLXUgLXIx
LjE5LjIuMyBzaWV2ZV9pbnRlcmZhY2UuaAotLS0gc2lldmUvc2lldmVfaW50ZXJmYWNlLmgJMjgg
SnVuIDIwMDQgMTg6NDQ6MzAgLTAwMDAJMS4xOS4yLjMKKysrIHNpZXZlL3NpZXZlX2ludGVyZmFj
ZS5oCTIgSnVsIDIwMDQgMjA6MDI6NDMgLTAwMDAKQEAgLTM5LDcgKzM5LDcgQEAKIC8qIGV4dGVy
bmFsIHNpZXZlIHR5cGVzICovCiB0eXBlZGVmIHN0cnVjdCBzaWV2ZV9pbnRlcnAgc2lldmVfaW50
ZXJwX3Q7CiB0eXBlZGVmIHN0cnVjdCBzaWV2ZV9zY3JpcHQgc2lldmVfc2NyaXB0X3Q7Ci10eXBl
ZGVmIHN0cnVjdCBzaWV2ZV9ieXRlY29kZSBzaWV2ZV9ieXRlY29kZV90OwordHlwZWRlZiBzdHJ1
Y3Qgc2lldmVfZXhlY3V0ZSBzaWV2ZV9leGVjdXRlX3Q7CiB0eXBlZGVmIHN0cnVjdCBieXRlY29k
ZV9pbmZvIGJ5dGVjb2RlX2luZm9fdDsKIAogdHlwZWRlZiBpbnQgc2lldmVfY2FsbGJhY2sodm9p
ZCAqYWN0aW9uX2NvbnRleHQsIHZvaWQgKmludGVycF9jb250ZXh0LCAKQEAgLTUyLDYgKzUyLDgg
QEAKIHR5cGVkZWYgaW50IHNpZXZlX2dldF9lbnZlbG9wZSh2b2lkICptZXNzYWdlX2NvbnRleHQs
IAogCQkJICAgICAgIGNvbnN0IGNoYXIgKmZpZWxkLAogCQkJICAgICAgIGNvbnN0IGNoYXIgKioq
Y29udGVudHMpOwordHlwZWRlZiBpbnQgc2lldmVfZ2V0X2luY2x1ZGUodm9pZCAqc2NyaXB0X2Nv
bnRleHQsIGNvbnN0IGNoYXIgKnNjcmlwdCwKKwkJCSAgICAgIGludCBpc2dsb2JhbCwgY2hhciAq
ZnBhdGgsIHNpemVfdCBzaXplKTsKIAogLyogTVVTVCBrZWVwIHRoaXMgc3RydWN0IHN5bmMnZCB3
aXRoIGJvZHlwYXJ0IGluIGltYXAvbWVzc2FnZS5oICovCiB0eXBlZGVmIHN0cnVjdCBzaWV2ZV9i
b2R5cGFydCB7CkBAIC0xMzQsNiArMTM2LDcgQEAKIGludCBzaWV2ZV9yZWdpc3Rlcl92YWNhdGlv
bihzaWV2ZV9pbnRlcnBfdCAqaW50ZXJwLCBzaWV2ZV92YWNhdGlvbl90ICp2KTsKIGludCBzaWV2
ZV9yZWdpc3Rlcl9pbWFwZmxhZ3Moc2lldmVfaW50ZXJwX3QgKmludGVycCwgc2lldmVfaW1hcGZs
YWdzX3QgKm1hcmspOwogaW50IHNpZXZlX3JlZ2lzdGVyX25vdGlmeShzaWV2ZV9pbnRlcnBfdCAq
aW50ZXJwLCBzaWV2ZV9jYWxsYmFjayAqZik7CitpbnQgc2lldmVfcmVnaXN0ZXJfaW5jbHVkZShz
aWV2ZV9pbnRlcnBfdCAqaW50ZXJwLCBzaWV2ZV9nZXRfaW5jbHVkZSAqZik7CiAKIC8qIGFkZCB0
aGUgY2FsbGJhY2tzIGZvciBtZXNzYWdlcy4gYWdhaW4sIHVuZGVmaW5lZCBpZiB1c2VkIGFmdGVy
CiAgICBzaWV2ZV9zY3JpcHRfcGFyc2UgKi8KQEAgLTE1NiwxNyArMTU5LDE3IEBACiBpbnQgc2ll
dmVfc2NyaXB0X3BhcnNlKHNpZXZlX2ludGVycF90ICppbnRlcnAsIEZJTEUgKnNjcmlwdCwKIAkJ
ICAgICAgIHZvaWQgKnNjcmlwdF9jb250ZXh0LCBzaWV2ZV9zY3JpcHRfdCAqKnJldCk7CiAKLS8q
IGdpdmVuIGEgYnl0ZWNvZGUgZmlsZSBkZXNjcmlwdG9yLCBzZXR1cCB0aGUgc2lldmVfYnl0ZWNv
ZGVfdCAqLwotaW50IHNpZXZlX3NjcmlwdF9sb2FkKGNvbnN0IGNoYXIgKmZuYW1lLCBzaWV2ZV9i
eXRlY29kZV90ICoqcmV0KTsKKy8qIGdpdmVuIGEgcGF0aCB0byBhIGJ5dGVjb2RlIGZpbGUsIGxv
YWQgaXQgaW50byB0aGUgc2lldmVfZXhlY3V0ZV90ICovCitpbnQgc2lldmVfc2NyaXB0X2xvYWQo
Y29uc3QgY2hhciAqZnBhdGgsIHNpZXZlX2V4ZWN1dGVfdCAqKnJldCk7CiAKIC8qIFVubG9hZCBh
IHNpZXZlX2J5dGVjb2RlX3QgKi8KLWludCBzaWV2ZV9zY3JpcHRfdW5sb2FkKHNpZXZlX2J5dGVj
b2RlX3QgKipzKTsKK2ludCBzaWV2ZV9zY3JpcHRfdW5sb2FkKHNpZXZlX2V4ZWN1dGVfdCAqKnMp
OwogCiAvKiBGcmVlIGEgc2lldmVfc2NyaXB0X3QgKi8KIGludCBzaWV2ZV9zY3JpcHRfZnJlZShz
aWV2ZV9zY3JpcHRfdCAqKnMpOwogCiAvKiBleGVjdXRlIGJ5dGVjb2RlIG9uIGEgbWVzc2FnZSAq
LwotaW50IHNpZXZlX2V4ZWN1dGVfYnl0ZWNvZGUoc2lldmVfYnl0ZWNvZGVfdCAqc2NyaXB0LCBz
aWV2ZV9pbnRlcnBfdCAqaW50ZXJwLAoraW50IHNpZXZlX2V4ZWN1dGVfYnl0ZWNvZGUoc2lldmVf
ZXhlY3V0ZV90ICpzY3JpcHQsIHNpZXZlX2ludGVycF90ICppbnRlcnAsCiAJCQkgICB2b2lkICpz
Y3JpcHRfY29udGV4dCwgdm9pZCAqbWVzc2FnZV9jb250ZXh0KTsKIAogLyogR2V0IHNwYWNlIHNl
cGFyYXRlZCBsaXN0IG9mIGV4dGVuc2lvbnMgc3VwcG9ydGVkIGJ5IHRoZSBpbXBsZW1lbnRhdGlv
biAqLwpJbmRleDogc2lldmUvc2lldmVjLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRy
ZXcvc3lzdGVtL2N2cy9zcmMvc2lldmUvc2lldmVjLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEu
Mi4yLjUKZGlmZiAtdSAtcjEuMi4yLjUgc2lldmVjLmMKLS0tIHNpZXZlL3NpZXZlYy5jCTI1IEp1
biAyMDA0IDEzOjU1OjI1IC0wMDAwCTEuMi4yLjUKKysrIHNpZXZlL3NpZXZlYy5jCTIgSnVsIDIw
MDQgMjA6MDI6NDMgLTAwMDAKQEAgLTI1NSw2ICsyNTUsMTIgQEAKIAlyZXR1cm4gVElNU0lFVkVf
RkFJTDsKICAgICB9CiAgIAorICAgIHJlcyA9IHNpZXZlX3JlZ2lzdGVyX2luY2x1ZGUoaSwgKHNp
ZXZlX2dldF9pbmNsdWRlICopICZmb28pOworICAgIGlmIChyZXMgIT0gU0lFVkVfT0spIHsKKwlz
eXNsb2coTE9HX0VSUiwgInNpZXZlX3JlZ2lzdGVyX2luY2x1ZGUoKSByZXR1cm5zICVkXG4iLCBy
ZXMpOworCXJldHVybiBUSU1TSUVWRV9GQUlMOworICAgIH0KKyAgCiAgICAgcmVzID0gc2lldmVf
cmVnaXN0ZXJfdmFjYXRpb24oaSwgJnZhY2F0aW9uKTsKICAgICBpZiAocmVzICE9IFNJRVZFX09L
KSB7CiAJc3lzbG9nKExPR19FUlIsICJzaWV2ZV9yZWdpc3Rlcl92YWNhdGlvbigpIHJldHVybnMg
JWRcbiIsIHJlcyk7CkluZGV4OiBzaWV2ZS9zaWV2ZWQuYwo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAv
YWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zaWV2ZS9zaWV2ZWQuYyx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMS4yLjIuNApkaWZmIC11IC1yMS4yLjIuNCBzaWV2ZWQuYwotLS0gc2lldmUvc2lldmVk
LmMJMjkgSnVuIDIwMDQgMjA6MTQ6MTMgLTAwMDAJMS4yLjIuNAorKysgc2lldmUvc2lldmVkLmMJ
MiBKdWwgMjAwNCAyMDowMjo0MyAtMDAwMApAQCAtNDIsNiArNDIsOSBAQAogCiAjaW5jbHVkZSAi
bWFwLmgiCiAKKy8qIGNvbmZpZy5jIHN0dWZmICovCitjb25zdCBpbnQgY29uZmlnX25lZWRfZGF0
YSA9IDA7CisKIHZvaWQgZHVtcDIoYnl0ZWNvZGVfaW5wdXRfdCAqZCwgaW50IGxlbik7CiBpbnQg
ZHVtcDJfdGVzdChieXRlY29kZV9pbnB1dF90ICogZCwgaW50IGkpOwogIApAQCAtNDU0LDYgKzQ1
NywyMiBAQAogCSAgICBwcmludGYoIiVkOkpVTVAgJWRcbiIsaSwgbnRvaGwoZFtpKzFdLmp1bXAp
KTsKIAkgICAgaSs9MjsKIAkgICAgYnJlYWs7CQkgIAorCisJY2FzZSBCX0lOQ0xVREU6LyoxNyov
CisJICAgIHByaW50ZigiJWQ6IElOQ0xVREUgIiwgaSk7CisJICAgIHN3aXRjaCAobnRvaGwoZFtp
KzFdLnZhbHVlKSkgeworCSAgICBjYXNlIEJfUEVSU09OQUw6IHByaW50ZigiUGVyc29uYWwiKTsg
YnJlYWs7CisJICAgIGNhc2UgQl9HTE9CQUw6IHByaW50ZigiR2xvYmFsIik7IGJyZWFrOworCSAg
ICB9CisJICAgIGkgPSB1bndyYXBfc3RyaW5nKGQsIGkrMiwgJmRhdGEsICZsZW4pOworCSAgICBw
cmludGYoIiB7JWR9JXNcbiIsIGxlbiwgZGF0YSk7CisJICAgIGJyZWFrOworCisJY2FzZSBCX1JF
VFVSTjovKjE4Ki8KKwkgICAgcHJpbnRmKCIlZDogUkVUVVJOXG4iLGkpOworCSAgICBpKys7CisJ
ICAgIGJyZWFrOworCSAgICAKIAlkZWZhdWx0OgogCSAgICBwcmludGYoIiVkOiAlZCAoTk9UIEFO
IE9QKVxuIixpLG50b2hsKGRbaV0ub3ApKTsKIAkgICAgZXhpdCgxKTsKSW5kZXg6IHNpZXZlL3Rl
c3QuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zaWV2
ZS90ZXN0LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjEuMi4zCmRpZmYgLXUgLXIxLjIxLjIu
MyB0ZXN0LmMKLS0tIHNpZXZlL3Rlc3QuYwkyMyBKdW4gMjAwNCAyMDoxNToxOSAtMDAwMAkxLjIx
LjIuMworKysgc2lldmUvdGVzdC5jCTIgSnVsIDIwMDQgMjA6MDI6NDMgLTAwMDAKQEAgLTM1Miw2
ICszNTIsMTUgQEAKICAgICByZXR1cm4gKCFyID8gU0lFVkVfT0sgOiBTSUVWRV9GQUlMKTsKIH0K
IAoraW50IGdldGluY2x1ZGUodm9pZCAqc2MsIGNvbnN0IGNoYXIgKnNjcmlwdCwgaW50IGlzZ2xv
YmFsLAorCSAgICAgICBjaGFyICpmcGF0aCwgc2l6ZV90IHNpemUpCit7CisgICAgc3RybGNweShm
cGF0aCwgc2NyaXB0LCBzaXplKTsKKyAgICBzdHJsY2F0KGZwYXRoLCAiLmJjIiwgc2l6ZSk7CisK
KyAgICByZXR1cm4gU0lFVkVfT0s7Cit9CisKIGludCByZWRpcmVjdCh2b2lkICphYywgdm9pZCAq
aWMsIHZvaWQgKnNjLCB2b2lkICptYywgY29uc3QgY2hhciAqKmVycm1zZykKIHsKICAgICBzaWV2
ZV9yZWRpcmVjdF9jb250ZXh0X3QgKnJjID0gKHNpZXZlX3JlZGlyZWN0X2NvbnRleHRfdCAqKSBh
YzsKQEAgLTcxNCw3ICs3MjMsNyBAQAogaW50IG1haW4oaW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSkK
IHsKICAgICBzaWV2ZV9pbnRlcnBfdCAqaTsKLSAgICBzaWV2ZV9ieXRlY29kZV90ICpiYzsKKyAg
ICBzaWV2ZV9leGVjdXRlX3QgKmV4ZSA9IE5VTEw7CiAgICAgbWVzc2FnZV9kYXRhX3QgKm07CiAg
ICAgY2hhciAqc2NyaXB0ID0gTlVMTCwgKm1lc3NhZ2UgPSBOVUxMOwogICAgIGludCBjLCBmb3Jj
ZV9mYWlsID0gMCwgdXNhZ2VfZXJyb3IgPSAwOwpAQCAtODEyLDYgKzgyMSwxMiBAQAogCWV4aXQo
MSk7CiAgICAgfQogCisgICAgcmVzID0gc2lldmVfcmVnaXN0ZXJfaW5jbHVkZShpLCAmZ2V0aW5j
bHVkZSk7CisgICAgaWYgKHJlcyAhPSBTSUVWRV9PSykgeworCXByaW50Zigic2lldmVfcmVnaXN0
ZXJfaW5jbHVkZSgpIHJldHVybnMgJWRcbiIsIHJlcyk7CisJZXhpdCgxKTsKKyAgICB9CisKICAg
ICByZXMgPSBzaWV2ZV9yZWdpc3Rlcl92YWNhdGlvbihpLCAmdmFjYXRpb24pOwogICAgIGlmIChy
ZXMgIT0gU0lFVkVfT0spIHsKIAlwcmludGYoInNpZXZlX3JlZ2lzdGVyX3ZhY2F0aW9uKCkgcmV0
dXJucyAlZFxuIiwgcmVzKTsKQEAgLTg0Myw3ICs4NTgsNyBAQAogICAgICAgICBleGl0KDEpOwog
ICAgIH0gICAKIAotICAgIHJlcyA9IHNpZXZlX3NjcmlwdF9sb2FkKGFyZ3ZbMl0sICZiYyk7Cisg
ICAgcmVzID0gc2lldmVfc2NyaXB0X2xvYWQoYXJndlsyXSwgJmV4ZSk7CiAgICAgaWYgKHJlcyAh
PSBTSUVWRV9PSykgewogCXByaW50Zigic2lldmVfc2NyaXB0X2xvYWQoKSByZXR1cm5zICVkXG4i
LCByZXMpOwogCWV4aXQoMSk7CkBAIC04NjMsNyArODc4LDcgQEAKIAkgICAgZXhpdCgxKTsKIAl9
CiAKLQlyZXMgPSBzaWV2ZV9leGVjdXRlX2J5dGVjb2RlKGJjLCBpLCBOVUxMLCBtKTsKKwlyZXMg
PSBzaWV2ZV9leGVjdXRlX2J5dGVjb2RlKGV4ZSwgaSwgTlVMTCwgbSk7CiAJaWYgKHJlcyAhPSBT
SUVWRV9PSykgewogCSAgICBwcmludGYoInNpZXZlX2V4ZWN1dGVfYnl0ZWNvZGUoKSByZXR1cm5z
ICVkXG4iLCByZXMpOwogCSAgICBleGl0KDEpOwpAQCAtODcyLDcgKzg4Nyw3IEBACiAJY2xvc2Uo
ZmQpOwogICAgIH0KICAgICAvKnVzZWQgdG8gYmUgc2lldmVfc2NyaXB0X2ZyZWUqLwotICAgIHJl
cyA9IHNpZXZlX3NjcmlwdF91bmxvYWQoJmJjKTsKKyAgICByZXMgPSBzaWV2ZV9zY3JpcHRfdW5s
b2FkKCZleGUpOwogICAgIGlmIChyZXMgIT0gU0lFVkVfT0spIHsKIAlwcmludGYoInNpZXZlX3Nj
cmlwdF91bmxvYWQoKSByZXR1cm5zICVkXG4iLCByZXMpOwogCWV4aXQoMSk7CkluZGV4OiBzaWV2
ZS90cmVlLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2Fmcy9hbmRyZXcvc3lzdGVtL2N2cy9zcmMv
c2lldmUvdHJlZS5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjExLjIuMQpkaWZmIC11IC1yMS4x
MS4yLjEgdHJlZS5jCi0tLSBzaWV2ZS90cmVlLmMJMjMgSnVuIDIwMDQgMjA6MTU6MTkgLTAwMDAJ
MS4xMS4yLjEKKysrIHNpZXZlL3RyZWUuYwkyIEp1bCAyMDA0IDIwOjAyOjQzIC0wMDAwCkBAIC0x
ODEsNiArMTgxLDEwIEBACiAJICAgIGZyZWVfdHJlZShjbC0+dS5pLmRvX2Vsc2UpOwogCSAgICBi
cmVhazsKIAorCWNhc2UgSU5DTFVERToKKwkgICAgaWYgKGNsLT51LmluYy5zY3JpcHQpIGZyZWUo
Y2wtPnUuaW5jLnNjcmlwdCk7CisJICAgIGJyZWFrOworCiAJY2FzZSBGSUxFSU5UTzoKIAljYXNl
IFJFRElSRUNUOgogCWNhc2UgUkVKQ1Q6CkBAIC0yMDIsNiArMjA2LDcgQEAKIAljYXNlIEtFRVA6
CiAJY2FzZSBTVE9QOgogCWNhc2UgRElTQ0FSRDoKKwljYXNlIFJFVFVSTjoKIAkgICAgYnJlYWs7
CiAKIAljYXNlIE5PVElGWToKSW5kZXg6IHNpZXZlL3RyZWUuaAo9PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxl
OiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9zaWV2ZS90cmVlLmgsdgpyZXRyaWV2aW5nIHJl
dmlzaW9uIDEuOC4yLjEKZGlmZiAtdSAtcjEuOC4yLjEgdHJlZS5oCi0tLSBzaWV2ZS90cmVlLmgJ
MjMgSnVuIDIwMDQgMjA6MTU6MjAgLTAwMDAJMS44LjIuMQorKysgc2lldmUvdHJlZS5oCTIgSnVs
IDIwMDQgMjA6MDI6NDMgLTAwMDAKQEAgLTEwOSw2ICsxMDksMTAgQEAKIAkgICAgY29tbWFuZGxp
c3RfdCAqZG9fdGhlbjsKIAkgICAgY29tbWFuZGxpc3RfdCAqZG9fZWxzZTsKIAl9IGk7CisJc3Ry
dWN0IHsgLyogaXQncyBhbiBpbmNsdWRlIGFjdGlvbiAqLworCSAgICBpbnQgbG9jYXRpb247CisJ
ICAgIGNoYXIgKnNjcmlwdDsKKwl9IGluYzsKIAlzdHJ1Y3QgeyAvKiBpdCdzIGEgdmFjYXRpb24g
YWN0aW9uICovCiAJICAgIGNoYXIgKnN1YmplY3Q7CiAJICAgIGludCBkYXlzOwpJbmRleDogdGlt
c2lldmVkL2FjdGlvbnMuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0v
Y3ZzL3NyYy9jeXJ1cy90aW1zaWV2ZWQvYWN0aW9ucy5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAx
LjM2LjIuMQpkaWZmIC11IC1yMS4zNi4yLjEgYWN0aW9ucy5jCi0tLSB0aW1zaWV2ZWQvYWN0aW9u
cy5jCTIzIEp1biAyMDA0IDIwOjE1OjIwIC0wMDAwCTEuMzYuMi4xCisrKyB0aW1zaWV2ZWQvYWN0
aW9ucy5jCTIgSnVsIDIwMDQgMjA6MDI6NDUgLTAwMDAKQEAgLTc3LDYgKzc3LDcgQEAKIC8qIGFm
dGVyIGEgdXNlciBoYXMgYXV0aGVudGljYXRpb24sIG91ciBjdXJyZW50IGRpcmVjdG9yeSBpcyB0
aGVpciBTaWV2ZSAKICAgIGRpcmVjdG9yeSEgKi8KIAorZXh0ZXJuIGludCBzaWV2ZWRfdXNlcmlz
YWRtaW47CiBjaGFyICpzaWV2ZV9kaXIgPSBOVUxMOwogCiBpbnQgYWN0aW9uc19pbml0KHZvaWQp
CkBAIC05OSwyNSArMTAwLDM1IEBACiAKIGludCBhY3Rpb25zX3NldHVzZXIoY29uc3QgY2hhciAq
dXNlcmlkKQogewotICBjaGFyIGhhc2gsICpkb21haW47Ci0gIGNoYXIgKmZvbz1zaWV2ZV9kaXI7
CisgIGNoYXIgdXNlcmJ1ZlsxMDI0XSwgKnVzZXIsICpkb21haW4gPSBOVUxMOworICBjaGFyICpm
b28gPSBzaWV2ZV9kaXI7CisgIHNpemVfdCBzaXplID0gMTAyNCwgbGVuOwogICBpbnQgcmVzdWx0
OyAgCiAKLSAgc2lldmVfZGlyPShjaGFyICopIHhtYWxsb2MoMTAyNCk7CisgIHNpZXZlX2RpciA9
IChjaGFyICopIHh6bWFsbG9jKHNpemUrMSk7CiAgIAotICBpZiAoY29uZmlnX3ZpcnRkb21haW5z
ICYmIChkb21haW4gPSBzdHJjaHIodXNlcmlkLCAnQCcpKSkgewotICAgICAgY2hhciBkID0gKGNo
YXIpIGRpcl9oYXNoX2MoZG9tYWluKzEpOwotICAgICAgKmRvbWFpbiA9ICdcMCc7ICAvKiBzcGxp
dCB1c2VyQGRvbWFpbiAqLwotICAgICAgaGFzaCA9IChjaGFyKSBkaXJfaGFzaF9jKHVzZXJpZCk7
Ci0gICAgICBzbnByaW50ZihzaWV2ZV9kaXIsIDEwMjMsICIlcyVzJWMvJXMvJWMvJXMiLAotCSAg
ICAgICBmb28sIEZOQU1FX0RPTUFJTkRJUiwgZCwgZG9tYWluKzEsCi0JICAgICAgIGhhc2gsIHVz
ZXJpZCk7Ci0gICAgICAqZG9tYWluID0gJ0AnOyAgLyogcmVhc3NlbWJsZSB1c2VyQGRvbWFpbiAq
LworICB1c2VyID0gKGNoYXIgKikgdXNlcmlkOworICBpZiAoY29uZmlnX3ZpcnRkb21haW5zICYm
IHN0cmNocih1c2VyLCAnQCcpKSB7CisgICAgICAvKiBzcGxpdCB0aGUgdXNlciBhbmQgZG9tYWlu
ICovCisgICAgICBzdHJsY3B5KHVzZXJidWYsIHVzZXJpZCwgc2l6ZW9mKHVzZXJidWYpKTsKKyAg
ICAgIHVzZXIgPSB1c2VyYnVmOworICAgICAgaWYgKChkb21haW4gPSBzdHJyY2hyKHVzZXIsICdA
JykpKSAqZG9tYWluKysgPSAnXDAnOworICB9CisKKyAgbGVuID0gc3RybGNweShzaWV2ZV9kaXIs
IGZvbywgc2l6ZSk7CisKKyAgaWYgKGRvbWFpbikgeworICAgICAgY2hhciBkaGFzaCA9IChjaGFy
KSBkaXJfaGFzaF9jKGRvbWFpbik7CisgICAgICBsZW4gKz0gc25wcmludGYoc2lldmVfZGlyK2xl
biwgc2l6ZS1sZW4sICIlcyVjLyVzIiwKKwkJICAgICAgRk5BTUVfRE9NQUlORElSLCBkaGFzaCwg
ZG9tYWluKTsKKyAgfQorCisgIGlmIChzaWV2ZWRfdXNlcmlzYWRtaW4pIHsKKyAgICAgIHN0cmxj
YXQoc2lldmVfZGlyLCAiL2dsb2JhbCIsIHNpemUpOwogICB9CiAgIGVsc2UgewotICAgICAgaGFz
aCA9IChjaGFyKSBkaXJfaGFzaF9jKHVzZXJpZCk7Ci0gICAgCi0gICAgICBzbnByaW50ZihzaWV2
ZV9kaXIsIDEwMjMsICIlcy8lYy8lcyIsIGZvbywgaGFzaCx1c2VyaWQpOworICAgICAgY2hhciBo
YXNoID0gKGNoYXIpIGRpcl9oYXNoX2ModXNlcik7CisgICAgICBzbnByaW50ZihzaWV2ZV9kaXIr
bGVuLCBzaXplLWxlbiwgIi8lYy8lcyIsIGhhc2gsIHVzZXIpOwogICB9CiAKICAgcmVzdWx0ID0g
Y2hkaXIoc2lldmVfZGlyKTsKSW5kZXg6IHRpbXNpZXZlZC9wYXJzZXIuYwo9PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJD
UyBmaWxlOiAvYWZzL2FuZHJldy9zeXN0ZW0vY3ZzL3NyYy9jeXJ1cy90aW1zaWV2ZWQvcGFyc2Vy
LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMzMuMi41CmRpZmYgLXUgLXIxLjMzLjIuNSBwYXJz
ZXIuYwotLS0gdGltc2lldmVkL3BhcnNlci5jCTI1IE1heSAyMDA0IDAxOjI4OjIyIC0wMDAwCTEu
MzMuMi41CisrKyB0aW1zaWV2ZWQvcGFyc2VyLmMJMiBKdWwgMjAwNCAyMDowMjo0NSAtMDAwMApA
QCAtNzIsNiArNzIsNyBAQAogCiBleHRlcm4gY2hhciBzaWV2ZWRfY2xpZW50aG9zdFsyNTBdOwog
ZXh0ZXJuIGludCBzaWV2ZWRfZG9tYWluZnJvbWlwOworZXh0ZXJuIGludCBzaWV2ZWRfdXNlcmlz
YWRtaW47CiAKIC8qIHh4eCB0aGVzZSBhcmUgYm90aCBsZWFrZWQsIGJ1dCB3ZSBvbmx5IGhhbmRs
ZSBvbmUgY29ubmVjdGlvbiBhdCBhCiAgKiB0aW1lLi4uICovCkBAIC02NDgsNyArNjQ5LDcgQEAK
ICAgICAgIHN0cnVjdCBuYW1lc3BhY2Ugc2lldmVkX25hbWVzcGFjZTsKICAgICAgIGNoYXIgaW5i
b3huYW1lW01BWF9NQUlMQk9YX05BTUVdOwogICAgICAgY2hhciAqc2VydmVyOwotICAgICAgaW50
IHR5cGUsIHI7CisgICAgICBpbnQgdHlwZSA9IDAsIHI7CiAgICAgICAKICAgICAgIC8qIFNldCBu
YW1lc3BhY2UgKi8KICAgICAgIGlmICgociA9IG1ib3huYW1lX2luaXRfbmFtZXNwYWNlKCZzaWV2
ZWRfbmFtZXNwYWNlLCAwKSkgIT0gMCkgewpAQCAtNjY2LDcgKzY2Nyw3IEBACiAKICAgICAgIHIg
PSBtYm94bGlzdF9kZXRhaWwoaW5ib3huYW1lLCAmdHlwZSwgJnNlcnZlciwgTlVMTCwgTlVMTCwg
TlVMTCwgTlVMTCk7CiAgICAgICAKLSAgICAgIGlmKHIpIHsKKyAgICAgIGlmKHIgJiYgIXNpZXZl
ZF91c2VyaXNhZG1pbikgewogCSAgLyogbWJveGxpc3RfZGV0YWlsIGVycm9yICovCiAJICAqZXJy
bXNnID0gIm1haWxib3ggdW5rbm93biI7CiAJICByZXR1cm4gRkFMU0U7CkluZGV4OiB0aW1zaWV2
ZWQvc2NyaXB0dGVzdC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9hZnMvYW5kcmV3L3N5c3RlbS9j
dnMvc3JjL2N5cnVzL3RpbXNpZXZlZC9zY3JpcHR0ZXN0LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuMjEuMi4zCmRpZmYgLXUgLXIxLjIxLjIuMyBzY3JpcHR0ZXN0LmMKLS0tIHRpbXNpZXZlZC9z
Y3JpcHR0ZXN0LmMJMjMgSnVuIDIwMDQgMjA6MTU6MjAgLTAwMDAJMS4yMS4yLjMKKysrIHRpbXNp
ZXZlZC9zY3JpcHR0ZXN0LmMJMiBKdWwgMjAwNCAyMDowMjo0NSAtMDAwMApAQCAtMTY1LDYgKzE2
NSwxMiBAQAogCXJldHVybiBUSU1TSUVWRV9GQUlMOwogICAgIH0KICAgCisgICAgcmVzID0gc2ll
dmVfcmVnaXN0ZXJfaW5jbHVkZShpbnRlcnAsIChzaWV2ZV9nZXRfaW5jbHVkZSAqKSAmZm9vKTsK
KyAgICBpZiAocmVzICE9IFNJRVZFX09LKSB7CisJc3lzbG9nKExPR19FUlIsICJzaWV2ZV9yZWdp
c3Rlcl9pbmNsdWRlKCkgcmV0dXJucyAlZFxuIiwgcmVzKTsKKwlyZXR1cm4gVElNU0lFVkVfRkFJ
TDsKKyAgICB9CisgIAogICAgIHJlcyA9IHNpZXZlX3JlZ2lzdGVyX3ZhY2F0aW9uKGludGVycCwg
JnZhY2F0aW9uKTsKICAgICBpZiAocmVzICE9IFNJRVZFX09LKSB7CiAJc3lzbG9nKExPR19FUlIs
ICJzaWV2ZV9yZWdpc3Rlcl92YWNhdGlvbigpIHJldHVybnMgJWRcbiIsIHJlcyk7Cg==
</data>        

          </attachment>
      

    </bug>

</bugzilla>