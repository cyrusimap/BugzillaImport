<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>1897</bug_id>
          
          <creation_ts>2003-02-27 16:29 EDT</creation_ts>
          <short_desc>Remove ldap_cache patch</short_desc>
          <delta_ts>2010-10-25 18:46:32 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus SASL</product>
          <component>saslauthd</component>
          <version>2.1.x</version>
          <rep_platform>Other</rep_platform>
          <op_sys>other</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          <priority>P2</priority>
          <bug_severity>bug</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Igor Brezac">igor@ipass.net</reporter>
          <assigned_to name="Rob Siemborski">rjs3@andrew.cmu.edu</assigned_to>
          
          

      

      

      
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-27 16:29:22 EDT</bug_when>
            <thetext>- Remove ldap_cache stuff.  The ldap_cache does not work properly in the 
versions of openldap 2.1.12 or less.  Openldap 2.1.13, and I suspect newer 
versions, no longer includes client side caching. The patch fixes compile 
issues with openldap 2.1.13. 

- Renamed MAX macro to LAK_MAX, apparently some unix distros define the macro 
which causes compile errors/warnings</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-27 16:29:40 EDT</bug_when>
            <thetext>Created an attachment (id=129)
lak.c
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-27 16:30:02 EDT</bug_when>
            <thetext>Created an attachment (id=130)
lak.h
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2003-02-27 16:30:21 EDT</bug_when>
            <thetext>Created an attachment (id=131)
LDAP_SASLAUTHD
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-02-27 16:30:38 EDT</bug_when>
            <thetext>Sorry Igor, I&apos;ve been busy with bytecode stuff, I&apos;ll get to this as soon as I can.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2003-03-06 12:27:24 EDT</bug_when>
            <thetext>updated</thetext>
          </long_desc>
      
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>129</attachid>
            <date>2003-02-27 16:29 EDT</date>
            <desc>lak.c</desc>
            <filename>lak.c</filename>
            <type>text/plain</type>
            <size>33204</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogQ09QWVJJR0hUCiAqIENvcHlyaWdodCAoYykgMjAwMi0yMDAyIElnb3IgQnJlemFjCiAqIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNl
IGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAogKiBtb2RpZmljYXRpb24sIGFyZSBw
ZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKICogYXJlIG1l
dDoKICogMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBh
Ym92ZSBjb3B5cmlnaHQKICogICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQg
dGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgogKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5
IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAogKiAgICBub3RpY2UsIHRo
aXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhl
CiAqICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRo
IHRoZSBkaXN0cmlidXRpb24uCiAqCiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgSUdP
UiBCUkVaQUMuIGBgQVMgSVMnJyBBTkQgQU5ZCiAqIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5U
SUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFCiAqIElNUExJRUQgV0FSUkFO
VElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUgogKiBQ
VVJQT1NFIEFSRSBESVNDTEFJTUVELiAgSU4gTk8gRVZFTlQgU0hBTEwgSUdPUiBCUkVaQUMgT1IK
ICogSVRTIEVNUExPWUVFUyBPUiBBR0VOVFMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJ
UkVDVCwKICogSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFM
IERBTUFHRVMgKElOQ0xVRElORywKICogQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBP
RiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTCiAqIE9GIFVTRSwgREFUQSwgT1Ig
UFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQKICog
T04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBM
SUFCSUxJVFksIE9SCiAqIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkg
QVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUKICogVVNFIE9GIFRISVMgU09GVFdBUkUsIEVW
RU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSAogKiBEQU1BR0UuCiAqIEVO
RCBDT1BZUklHSFQgKi8KCiNpbmNsdWRlICJtZWNoYW5pc21zLmgiCgojaWZkZWYgQVVUSF9MREFQ
CgojaW5jbHVkZSA8c3lzL3RpbWUuaD4KI2luY2x1ZGUgPHN0ZGlvLmg+CiNpbmNsdWRlIDxzdGRs
aWIuaD4KI2luY2x1ZGUgPHN0cmluZ3MuaD4KI2luY2x1ZGUgPHN5c2xvZy5oPgojaW5jbHVkZSA8
Y3R5cGUuaD4KCiNpZmRlZiBIQVZFX0NSWVBUX0gKI2luY2x1ZGUgPGNyeXB0Lmg+CiNlbmRpZgoK
I2lmZGVmIEhBVkVfVU5JU1REX0gKI2luY2x1ZGUgPHVuaXN0ZC5oPgojZW5kaWYKCiNpZmRlZiBI
QVZFX09QRU5TU0wKI2luY2x1ZGUgPG9wZW5zc2wvZXZwLmg+CiNlbmRpZgoKI2luY2x1ZGUgPGxk
YXAuaD4KI2luY2x1ZGUgPGxiZXIuaD4KI2luY2x1ZGUgImxhay5oIgoKc3RydWN0IHBhc3N3b3Jk
X3NjaGVtZSB7CgljaGFyICpoYXNoOwoJaW50ICgqY2hlY2spIChjb25zdCBjaGFyICpjcmVkLCBj
b25zdCBjaGFyICpwYXNzd2QsIHZvaWQgKnJvY2spOwoJdm9pZCAqcm9jazsKfTsKCnN0YXRpYyBp
bnQgbGFrX2NvbmZpZ19yZWFkKExBS19DT05GICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQg
bGFrX2NvbmZpZ19pbnQoY29uc3QgY2hhciAqKTsKc3RhdGljIGludCBsYWtfY29uZmlnX3N3aXRj
aChjb25zdCBjaGFyICopOwpzdGF0aWMgdm9pZCBsYWtfY29uZmlnX2ZyZWUoTEFLX0NPTkYgKik7
CnN0YXRpYyBpbnQgbGFrX2NvbmZpZyhjb25zdCBjaGFyICosIExBS19DT05GICoqKTsKc3RhdGlj
IGludCBsYWtfZXNjYXBlKGNvbnN0IGNoYXIgKiwgY29uc3QgdW5zaWduZWQgaW50LCBjaGFyICoq
KTsKc3RhdGljIGludCBsYWtfdG9rZW5pemVfZG9tYWluKGNvbnN0IGNoYXIgKiwgaW50LCBjaGFy
ICoqKTsKc3RhdGljIGludCBsYWtfZXhwYW5kX3Rva2Vucyhjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNoYXIgKiopOwpzdGF0aWMgaW50IGxh
a19jb25uZWN0KExBSyAqKTsKc3RhdGljIGludCBsYWtfYmluZChMQUsgKiwgY2hhciwgY29uc3Qg
Y2hhciAqLCBjb25zdCBjaGFyICopOwpzdGF0aWMgaW50IGxha19zZWFyY2goTEFLICosIGNvbnN0
IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICoqLCBMREFQTWVzc2FnZSAqKik7CnN0
YXRpYyBpbnQgbGFrX2F1dGhfY3VzdG9tKExBSyAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIg
KiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICopOwpzdGF0aWMgaW50IGxha19hdXRoX2JpbmQo
TEFLICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKik7CnN0YXRpYyBpbnQgbGFrX2F1dGhfZmFzdGJpbmQoTEFLICosIGNvbnN0IGNoYXIgKiwg
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQgbGFr
X2dyb3VwX21lbWJlcihMQUsgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNo
YXIgKiwgY29uc3QgY2hhciAqKTsKc3RhdGljIGludCBsYWtfcmVzdWx0X2FkZChMQUsgKmxhaywg
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIExBS19SRVNVTFQgKiopOwpzdGF0aWMgaW50IGxh
a19jaGVja19wYXNzd29yZChjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgdm9pZCAqKTsKc3Rh
dGljIGludCBsYWtfY2hlY2tfY3J5cHQoY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIHZvaWQg
Kik7CiNpZmRlZiBIQVZFX09QRU5TU0wKc3RhdGljIGludCBsYWtfYmFzZTY0X2RlY29kZShjb25z
dCBjaGFyICosIGNoYXIgKiosIGludCAqKTsKc3RhdGljIGludCBsYWtfY2hlY2tfaGFzaGVkKGNv
bnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCB2b2lkICopOwojZW5kaWYKCnN0YXRpYyBzdHJ1Y3Qg
aGFzaF9yb2NrIHsKCWNvbnN0IGNoYXIgKm1kYTsKCWludCBzYWx0ZWQ7Cn0gaGFzaF9yb2NrW10g
PSB7Cgl7ICJtZDUiLCAwIH0sCgl7ICJtZDUiLCAxIH0sCgl7ICJzaGExIiwgMCB9LAoJeyAic2hh
MSIsIDEgfQp9OwoKc3RhdGljIGNvbnN0IHN0cnVjdCBwYXNzd29yZF9zY2hlbWUgcGFzc3dvcmRf
c2NoZW1lW10gPSB7Cgl7ICJ7Q1JZUFR9IiwgbGFrX2NoZWNrX2NyeXB0LCBOVUxMIH0sCgl7ICJ7
VU5JWH0iLCBsYWtfY2hlY2tfY3J5cHQsIE5VTEwgfSwKI2lmZGVmIEhBVkVfT1BFTlNTTAoJeyAi
e01ENX0iLCBsYWtfY2hlY2tfaGFzaGVkLCAmaGFzaF9yb2NrWzBdIH0sCgl7ICJ7U01ENX0iLCBs
YWtfY2hlY2tfaGFzaGVkLCAmaGFzaF9yb2NrWzFdIH0sCgl7ICJ7U0hBfSIsIGxha19jaGVja19o
YXNoZWQsICZoYXNoX3JvY2tbMl0gfSwKCXsgIntTU0hBfSIsIGxha19jaGVja19oYXNoZWQsICZo
YXNoX3JvY2tbM10gfSwKI2VuZGlmCgl7IE5VTEwsIE5VTEwgfQp9OwoKc3RhdGljIGludCBsYWtf
Y29uZmlnX3JlYWQoTEFLX0NPTkYgKmNvbmYsIGNvbnN0IGNoYXIgKmNvbmZpZ2ZpbGUpCnsKCUZJ
TEUgKmluZmlsZTsKCWludCBsaW5lbm8gPSAwOwoJY2hhciBidWZbNDA5Nl07CgljaGFyICpwLCAq
a2V5OwoKCWluZmlsZSA9IGZvcGVuKGNvbmZpZ2ZpbGUsICJyIik7CglpZiAoIWluZmlsZSkgewoJ
ICAgIHN5c2xvZyhMT0dfRVJSfExPR19BVVRILAoJCSAgICJDb3VsZCBub3Qgb3BlbiBzYXNsYXV0
aGQgY29uZmlnIGZpbGU6ICVzICglbSkiLAoJCSAgIGNvbmZpZ2ZpbGUpOwoJICAgIHJldHVybiBM
QUtfRkFJTDsKCX0KICAgIAoJd2hpbGUgKGZnZXRzKGJ1Ziwgc2l6ZW9mKGJ1ZiksIGluZmlsZSkp
IHsKCQlsaW5lbm8rKzsKCgkJaWYgKGJ1ZltzdHJsZW4oYnVmKS0xXSA9PSAnXG4nKSAKCQkJYnVm
W3N0cmxlbihidWYpLTFdID0gJ1wwJzsKCQlmb3IgKHAgPSBidWY7ICpwICYmIGlzc3BhY2UoKGlu
dCkgKnApOyBwKyspOwoJCQlpZiAoISpwIHx8ICpwID09ICcjJykgCgkJCQljb250aW51ZTsKCgkJ
a2V5ID0gcDsKCQl3aGlsZSAoKnAgJiYgKGlzYWxudW0oKGludCkgKnApIHx8ICpwID09ICctJyB8
fCAqcCA9PSAnXycpKSB7CgkJCWlmIChpc3VwcGVyKChpbnQpICpwKSkgCgkJCQkqcCA9IHRvbG93
ZXIoKnApOwoJCQlwKys7CgkJfQoJCWlmICgqcCAhPSAnOicpIHsKCQkJcmV0dXJuIExBS19GQUlM
OwoJCX0KCQkqcCsrID0gJ1wwJzsKCgkJd2hpbGUgKCpwICYmIGlzc3BhY2UoKGludCkgKnApKSAK
CQkJcCsrOwoKCQlpZiAoISpwKSB7CgkJCXJldHVybiBMQUtfRkFJTDsKCQl9CgoJCWlmICghc3Ry
Y2FzZWNtcChrZXksICJsZGFwX3NlcnZlcnMiKSkgewoJCQlpZiAoY29uZi0+c2VydmVycykgZnJl
ZShjb25mLT5zZXJ2ZXJzKTsKCQkJY29uZi0+c2VydmVycyA9IHN0cmR1cChwKTsKCQkJaWYgKGNv
bmYtPnNlcnZlcnMgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFL
X05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX2JpbmRfZG4i
KSkgewoJCQlpZiAoY29uZi0+YmluZF9kbikgZnJlZShjb25mLT5iaW5kX2RuKTsKCQkJY29uZi0+
YmluZF9kbiA9IHN0cmR1cChwKTsKCQkJaWYgKGNvbmYtPmJpbmRfZG4gPT0gTlVMTCkgewoJCQkJ
ZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFLX05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICgh
c3RyY2FzZWNtcChrZXksICJsZGFwX2JpbmRfcHciKSkgewoJCQlpZiAoY29uZi0+YmluZF9wdykg
ZnJlZShjb25mLT5iaW5kX3B3KTsKCQkJY29uZi0+YmluZF9wdyA9IHN0cmR1cChwKTsKCQkJaWYg
KGNvbmYtPmJpbmRfcHcgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4g
TEFLX05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3ZlcnNp
b24iKSkgewoJCQljb25mLT52ZXJzaW9uID0gbGFrX2NvbmZpZ19pbnQocCk7CgkJfSBlbHNlIGlm
ICghc3RyY2FzZWNtcChrZXksICJsZGFwX3NlYXJjaF9iYXNlIikpIHsKCQkJaWYgKGNvbmYtPnNl
YXJjaF9iYXNlKSBmcmVlKGNvbmYtPnNlYXJjaF9iYXNlKTsKCQkJY29uZi0+c2VhcmNoX2Jhc2Ug
PSBzdHJkdXAocCk7CgkJCWlmIChjb25mLT5zZWFyY2hfYmFzZSA9PSBOVUxMKSB7CgkJCQlmY2xv
c2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJj
YXNlY21wKGtleSwgImxkYXBfZmlsdGVyIikpIHsKCQkJaWYgKGNvbmYtPmZpbHRlcikgZnJlZShj
b25mLT5maWx0ZXIpOwoJCQljb25mLT5maWx0ZXIgPSBzdHJkdXAocCk7CgkJCWlmIChjb25mLT5m
aWx0ZXIgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFLX05PTUVN
OwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX2dyb3VwX2RuIikpIHsK
CQkJaWYgKGNvbmYtPmdyb3VwX2RuKSBmcmVlKGNvbmYtPmdyb3VwX2RuKTsKCQkJY29uZi0+Z3Jv
dXBfZG4gPSBzdHJkdXAocCk7CgkJCWlmIChjb25mLT5ncm91cF9kbiA9PSBOVUxMKSB7CgkJCQlm
Y2xvc2UoaW5maWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFz
dHJjYXNlY21wKGtleSwgImxkYXBfZ3JvdXBfYXR0ciIpKSB7CgkJCWlmIChjb25mLT5ncm91cF9h
dHRyKSBmcmVlKGNvbmYtPmdyb3VwX2F0dHIpOwoJCQljb25mLT5ncm91cF9hdHRyID0gc3RyZHVw
KHApOwoJCQlpZiAoY29uZi0+Z3JvdXBfYXR0ciA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5maWxl
KTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtl
eSwgImxkYXBfcGFzc3dvcmRfYXR0ciIpKSB7CgkJCWlmIChjb25mLT5wYXNzd29yZF9hdHRyKSBm
cmVlKGNvbmYtPnBhc3N3b3JkX2F0dHIpOwoJCQljb25mLT5wYXNzd29yZF9hdHRyID0gc3RyZHVw
KHApOwoJCQlpZiAoY29uZi0+cGFzc3dvcmRfYXR0ciA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5m
aWxlKTsKCQkJCXJldHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21w
KGtleSwgImxkYXBfYXV0aF9tZXRob2QiKSkgewoJCQlpZiAoIXN0cmNhc2VjbXAocCwgImN1c3Rv
bSIpKSB7CgkJCQljb25mLT5hdXRoX21ldGhvZCA9IExBS19BVVRIX01FVEhPRF9DVVNUT007CgkJ
CX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAocCwgImZhc3RiaW5kIikpIHsKCQkJCWNvbmYtPmF1dGhf
bWV0aG9kID0gTEFLX0FVVEhfTUVUSE9EX0ZBU1RCSU5EOwoJCQl9CgkJfSBlbHNlIGlmICghc3Ry
Y2FzZWNtcChrZXksICJsZGFwX3RpbWVvdXQiKSkgewoJCQljb25mLT50aW1lb3V0LnR2X3NlYyA9
IGxha19jb25maWdfaW50KHApOwoJCQljb25mLT50aW1lb3V0LnR2X3VzZWMgPSAwOwoJCX0gZWxz
ZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9zaXplX2xpbWl0IikpIHsKCQkJY29uZi0+c2l6
ZV9saW1pdCA9IGxha19jb25maWdfaW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5
LCAibGRhcF90aW1lX2xpbWl0IikpIHsKCQkJY29uZi0+dGltZV9saW1pdCA9IGxha19jb25maWdf
aW50KHApOwoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF9kZXJlZiIpKSB7CgkJ
CWlmICghc3RyY2FzZWNtcChwLCAic2VhcmNoIikpIHsKCQkJCWNvbmYtPmRlcmVmID0gTERBUF9E
RVJFRl9TRUFSQ0hJTkc7CgkJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAocCwgImZpbmQiKSkgewoJ
CQkJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVGX0ZJTkRJTkc7CgkJCX0gZWxzZSBpZiAoIXN0cmNh
c2VjbXAocCwgImFsd2F5cyIpKSB7CgkJCQljb25mLT5kZXJlZiA9IExEQVBfREVSRUZfQUxXQVlT
OwoJCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKHAsICJuZXZlciIpKSB7CgkJCQljb25mLT5kZXJl
ZiA9IExEQVBfREVSRUZfTkVWRVI7CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwg
ImxkYXBfcmVmZXJyYWxzIikpIHsKCQkJY29uZi0+cmVmZXJyYWxzID0gbGFrX2NvbmZpZ19zd2l0
Y2gocCk7CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Jlc3RhcnQiKSkgewoJ
CQljb25mLT5yZXN0YXJ0ID0gbGFrX2NvbmZpZ19zd2l0Y2gocCk7CgkJfSBlbHNlIGlmICghc3Ry
Y2FzZWNtcChrZXksICJsZGFwX3Njb3BlIikpIHsKCQkJaWYgKCFzdHJjYXNlY21wKHAsICJvbmUi
KSkgewoJCQkJY29uZi0+c2NvcGUgPSBMREFQX1NDT1BFX09ORUxFVkVMOwoJCQl9IGVsc2UgaWYg
KCFzdHJjYXNlY21wKHAsICJiYXNlIikpIHsKCQkJCWNvbmYtPnNjb3BlID0gTERBUF9TQ09QRV9C
QVNFOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Rsc19jaGVja19w
ZWVyIikpIHsKCQkJY29uZi0+dGxzX2NoZWNrX3BlZXIgPSBsYWtfY29uZmlnX3N3aXRjaChwKTsK
CQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBfdGxzX2NhY2VydF9maWxlIikpIHsK
CQkJaWYgKGNvbmYtPnRsc19jYWNlcnRfZmlsZSkgZnJlZShjb25mLT50bHNfY2FjZXJ0X2ZpbGUp
OwoJCQljb25mLT50bHNfY2FjZXJ0X2ZpbGUgPSBzdHJkdXAocCk7CgkJCWlmIChjb25mLT50bHNf
Y2FjZXJ0X2ZpbGUgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFL
X05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Rsc19jYWNl
cnRfZGlyIikpIHsKCQkJaWYgKGNvbmYtPnRsc19jYWNlcnRfZGlyKSBmcmVlKGNvbmYtPnRsc19j
YWNlcnRfZGlyKTsKCQkJY29uZi0+dGxzX2NhY2VydF9kaXIgPSBzdHJkdXAocCk7CgkJCWlmIChj
b25mLT50bHNfY2FjZXJ0X2RpciA9PSBOVUxMKSB7CgkJCQlmY2xvc2UoaW5maWxlKTsKCQkJCXJl
dHVybiBMQUtfTk9NRU07CgkJCX0KCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKGtleSwgImxkYXBf
dGxzX2NpcGhlcnMiKSkgewoJCQlpZiAoY29uZi0+dGxzX2NpcGhlcnMpIGZyZWUoY29uZi0+dGxz
X2NpcGhlcnMpOwoJCQljb25mLT50bHNfY2lwaGVycyA9IHN0cmR1cChwKTsKCQkJaWYgKGNvbmYt
PnRsc19jaXBoZXJzID09IE5VTEwpIHsKCQkJCWZjbG9zZShpbmZpbGUpOwoJCQkJcmV0dXJuIExB
S19OT01FTTsKCQkJfQoJCX0gZWxzZSBpZiAoIXN0cmNhc2VjbXAoa2V5LCAibGRhcF90bHNfY2Vy
dCIpKSB7CgkJCWlmIChjb25mLT50bHNfY2VydCkgZnJlZShjb25mLT50bHNfY2VydCk7CgkJCWNv
bmYtPnRsc19jZXJ0ID0gc3RyZHVwKHApOwoJCQlpZiAoY29uZi0+dGxzX2NlcnQgPT0gTlVMTCkg
ewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQlyZXR1cm4gTEFLX05PTUVNOwoJCQl9CgkJfSBlbHNl
IGlmICghc3RyY2FzZWNtcChrZXksICJsZGFwX3Rsc19rZXkiKSkgewoJCQlpZiAoY29uZi0+dGxz
X2tleSkgZnJlZShjb25mLT50bHNfa2V5KTsKCQkJY29uZi0+dGxzX2tleSA9IHN0cmR1cChwKTsK
CQkJaWYgKGNvbmYtPnRsc19rZXkgPT0gTlVMTCkgewoJCQkJZmNsb3NlKGluZmlsZSk7CgkJCQly
ZXR1cm4gTEFLX05PTUVNOwoJCQl9CgkJfSBlbHNlIGlmICghc3RyY2FzZWNtcChrZXksICJsZGFw
X2RlYnVnIikpIHsKCQkJY29uZi0+ZGVidWcgPSBsYWtfY29uZmlnX2ludChwKTsKCQl9Cgl9CgoJ
ZmNsb3NlKGluZmlsZSk7CgoJcmV0dXJuIExBS19PSzsKfQoKc3RhdGljIGludCBsYWtfY29uZmln
X2ludChjb25zdCBjaGFyICp2YWwpCnsKICAgIGlmICghdmFsKSByZXR1cm4gMDsKCiAgICBpZiAo
IWlzZGlnaXQoKGludCkgKnZhbCkgJiYgKCp2YWwgIT0gJy0nIHx8ICFpc2RpZ2l0KChpbnQpIHZh
bFsxXSkpKSByZXR1cm4gMDsKCiAgICByZXR1cm4gYXRvaSh2YWwpOwp9CgpzdGF0aWMgaW50IGxh
a19jb25maWdfc3dpdGNoKGNvbnN0IGNoYXIgKnZhbCkKewogICAgaWYgKCF2YWwpIHJldHVybiAw
OwogICAgCiAgICBpZiAoKnZhbCA9PSAnMCcgfHwgKnZhbCA9PSAnbicgfHwKCSgqdmFsID09ICdv
JyAmJiB2YWxbMV0gPT0gJ2YnKSB8fCAqdmFsID09ICdmJykgewoJcmV0dXJuIDA7CiAgICB9IGVs
c2UgaWYgKCp2YWwgPT0gJzEnIHx8ICp2YWwgPT0gJ3knIHx8CgkgICAgICgqdmFsID09ICdvJyAm
JiB2YWxbMV0gPT0gJ24nKSB8fCAqdmFsID09ICd0JykgewoJcmV0dXJuIDE7CiAgICB9CiAgICBy
ZXR1cm4gMDsKfQoKc3RhdGljIHZvaWQgbGFrX2NvbmZpZ19mcmVlKExBS19DT05GICpjb25mKSAK
ewoJaWYgKGNvbmYgPT0gTlVMTCkgewoJCXJldHVybjsKCX0KCglpZiAoY29uZi0+c2VydmVycyAh
PSBOVUxMKSB7CgkJbWVtc2V0KGNvbmYtPnNlcnZlcnMsIDAsIHN0cmxlbihjb25mLT5zZXJ2ZXJz
KSk7CgkJZnJlZShjb25mLT5zZXJ2ZXJzKTsKCX0KCWlmIChjb25mLT5iaW5kX2RuICE9IE5VTEwp
IHsKCQltZW1zZXQoY29uZi0+YmluZF9kbiwgMCwgc3RybGVuKGNvbmYtPmJpbmRfZG4pKTsKCQlm
cmVlKGNvbmYtPmJpbmRfZG4pOwoJfQoJaWYgKGNvbmYtPmJpbmRfcHcgIT0gTlVMTCkgewoJCW1l
bXNldChjb25mLT5iaW5kX3B3LCAwLCBzdHJsZW4oY29uZi0+YmluZF9wdykpOwoJCWZyZWUoY29u
Zi0+YmluZF9wdyk7Cgl9CglpZiAoY29uZi0+c2VhcmNoX2Jhc2UgIT0gTlVMTCkKCQlmcmVlKGNv
bmYtPnNlYXJjaF9iYXNlKTsKCWlmIChjb25mLT5maWx0ZXIgIT0gTlVMTCkKCQlmcmVlKGNvbmYt
PmZpbHRlcik7CglpZiAoY29uZi0+Z3JvdXBfZG4gIT0gTlVMTCkKCQlmcmVlKGNvbmYtPmdyb3Vw
X2RuKTsKCWlmIChjb25mLT5ncm91cF9hdHRyICE9IE5VTEwpCgkJZnJlZShjb25mLT5ncm91cF9h
dHRyKTsKCWlmIChjb25mLT5wYXNzd29yZF9hdHRyICE9IE5VTEwpCgkJZnJlZShjb25mLT5wYXNz
d29yZF9hdHRyKTsKCWlmIChjb25mLT50bHNfY2FjZXJ0X2ZpbGUgIT0gTlVMTCkKCQlmcmVlKGNv
bmYtPnRsc19jYWNlcnRfZmlsZSk7CglpZiAoY29uZi0+dGxzX2NhY2VydF9kaXIgIT0gTlVMTCkK
CQlmcmVlKGNvbmYtPnRsc19jYWNlcnRfZGlyKTsKCWlmIChjb25mLT50bHNfY2lwaGVycyAhPSBO
VUxMKQoJCWZyZWUoY29uZi0+dGxzX2NpcGhlcnMpOwoJaWYgKGNvbmYtPnRsc19jZXJ0ICE9IE5V
TEwpCgkJZnJlZShjb25mLT50bHNfY2VydCk7CglpZiAoY29uZi0+dGxzX2tleSAhPSBOVUxMKQoJ
CWZyZWUoY29uZi0+dGxzX2tleSk7CglpZiAoY29uZi0+cGF0aCAhPSBOVUxMKQoJCWZyZWUoY29u
Zi0+cGF0aCk7CgoJZnJlZSAoY29uZik7CgoJcmV0dXJuOwp9CgpzdGF0aWMgaW50IGxha19jb25m
aWcoY29uc3QgY2hhciAqY29uZmlnZmlsZSwgTEFLX0NPTkYgKipyZXQpCnsKCUxBS19DT05GICpj
b25mOwoJaW50IHJjID0gMDsKCgljb25mID0gbWFsbG9jKCBzaXplb2YoTEFLX0NPTkYpICk7Cglp
ZiAoY29uZiA9PSBOVUxMKSB7CgkJcmV0dXJuIExBS19OT01FTTsKCX0KCgltZW1zZXQoY29uZiwg
MCwgc2l6ZW9mKExBS19DT05GKSk7CgoJY29uZi0+c2VydmVycyA9IHN0cmR1cCgibGRhcDovL2xv
Y2FsaG9zdC8iKTsKCWNvbmYtPmJpbmRfZG4gPSBzdHJkdXAoIiIpOwoJY29uZi0+YmluZF9wdyA9
IHN0cmR1cCgiIik7Cgljb25mLT52ZXJzaW9uID0gTERBUF9WRVJTSU9OMzsKCWNvbmYtPnNlYXJj
aF9iYXNlID0gc3RyZHVwKCIiKTsKCWNvbmYtPmZpbHRlciA9IHN0cmR1cCgiKHVpZD0ldSkiKTsK
CWNvbmYtPmdyb3VwX2RuID0gTlVMTDsKCWNvbmYtPmdyb3VwX2F0dHIgPSBzdHJkdXAoInVuaXF1
ZU1lbWJlciIpOwoJY29uZi0+cGFzc3dvcmRfYXR0ciA9IHN0cmR1cCgidXNlclBhc3N3b3JkIik7
Cgljb25mLT5hdXRoX21ldGhvZCA9IExBS19BVVRIX01FVEhPRF9CSU5EOwoJY29uZi0+dGltZW91
dC50dl9zZWMgPSA1OwoJY29uZi0+dGltZW91dC50dl91c2VjID0gMDsKCWNvbmYtPnNpemVfbGlt
aXQgPSAxOwoJY29uZi0+dGltZV9saW1pdCA9IDU7Cgljb25mLT5kZXJlZiA9IExEQVBfREVSRUZf
TkVWRVI7Cgljb25mLT5yZXN0YXJ0ID0gMTsKCWNvbmYtPnNjb3BlID0gTERBUF9TQ09QRV9TVUJU
UkVFOwoKCWNvbmYtPnBhdGggPSBzdHJkdXAoY29uZmlnZmlsZSk7CglpZiAoY29uZi0+cGF0aCA9
PSBOVUxMKSB7CgkJbGFrX2NvbmZpZ19mcmVlKGNvbmYpOwoJCXJldHVybiBMQUtfTk9NRU07Cgl9
CgoJcmMgPSBsYWtfY29uZmlnX3JlYWQoY29uZiwgY29uZi0+cGF0aCk7CglpZiAocmMgIT0gTEFL
X09LKSB7CgkJbGFrX2NvbmZpZ19mcmVlKGNvbmYpOwoJCXJldHVybiByYzsKCX0KCgkqcmV0ID0g
Y29uZjsKCXJldHVybiBMQUtfT0s7Cn0KCi8qCiAqIE5vdGU6IGNhbGxpbmcgZnVuY3Rpb24gbXVz
dCBmcmVlIG1lbW9yeS4KICovCnN0YXRpYyBpbnQgbGFrX2VzY2FwZShjb25zdCBjaGFyICpzLCBj
b25zdCB1bnNpZ25lZCBpbnQgbiwgY2hhciAqKnJlc3VsdCkgCnsKCWNoYXIgKmJ1ZjsKCWNoYXIg
KmVuZCwgKnB0ciwgKnRlbXA7CgoJaWYgKG4gPiBzdHJsZW4ocykpICAvLyBTYW5pdHkgY2hlY2ss
IGp1c3QgaW4gY2FzZQoJCXJldHVybiBMQUtfRkFJTDsKCglidWYgPSBtYWxsb2MobiAqIDUgKyAx
KTsKCWlmIChidWYgPT0gTlVMTCkgewoJCXJldHVybiBMQUtfTk9NRU07Cgl9CgoJYnVmWzBdID0g
J1wwJzsKCXB0ciA9IChjaGFyICopczsKCWVuZCA9IHB0ciArIG47CgoJd2hpbGUgKCgodGVtcCA9
IHN0cnBicmsocHRyLCAiKigpXFxcMCIpKSE9TlVMTCkgJiYgKHRlbXA8ZW5kKSkgewoKCQlpZiAo
dGVtcD5wdHIpCgkJCXN0cm5jYXQoYnVmLCBwdHIsIHRlbXAtcHRyKTsKCgkJc3dpdGNoICgqdGVt
cCkgewoJCQljYXNlICcqJzoKCQkJCXN0cmNhdChidWYsICJcXDJhIik7CgkJCQlicmVhazsKCQkJ
Y2FzZSAnKCc6CgkJCQlzdHJjYXQoYnVmLCAiXFwyOCIpOwoJCQkJYnJlYWs7CgkJCWNhc2UgJykn
OgoJCQkJc3RyY2F0KGJ1ZiwgIlxcMjkiKTsKCQkJCWJyZWFrOwoJCQljYXNlICdcXCc6CgkJCQlz
dHJjYXQoYnVmLCAiXFw1YyIpOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ1wwJzoKCQkJCXN0cmNhdChi
dWYsICJcXDAwIik7CgkJCQlicmVhazsKCQl9CgkJcHRyPXRlbXArMTsKCX0KCWlmIChwdHI8ZW5k
KQoJCXN0cm5jYXQoYnVmLCBwdHIsIGVuZC1wdHIpOwoKCSpyZXN1bHQgPSBidWY7CgoJcmV0dXJu
IExBS19PSzsKfQoKc3RhdGljIGludCBsYWtfdG9rZW5pemVfZG9tYWlucyhjb25zdCBjaGFyICpk
LCBpbnQgbiwgY2hhciAqKnJlc3VsdCkKewoJY2hhciAqcywgKnMxOwoJY2hhciAqbGFzdHM7Cglp
bnQgbnQsIGk7CgoJKnJlc3VsdCA9IE5VTEw7CgoJaWYgKGQgPT0gTlVMTCB8fCAobiA8IDEgJiYg
biA+IDkpKQoJCXJldHVybiBMQUtfRkFJTDsKCglzID0gc3RyZHVwKGQpOwoJaWYgKHMgPT0gTlVM
TCkKCQlyZXR1cm4gTEFLX05PTUVNOwoKCWZvciggbnQ9MCwgczE9czsgKnMxOyBzMSsrICkKCQlp
ZiggKnMxID09ICcuJyApIG50Kys7CgludCsrOwoKCWlmIChuID4gbnQpIHsKCQlmcmVlKHMpOwoJ
CXJldHVybiBMQUtfRkFJTDsKCX0KCglpID0gbnQgLSBuOwoJczEgPSAoY2hhciAqKXN0cnRva19y
KHMsICIuIiwgJmxhc3RzKTsKCXdoaWxlKHMxKSB7CgkJaWYgKGkgPT0gMCkgewoJCQkqcmVzdWx0
ID0gc3RyZHVwKHMxKTsKCQkJZnJlZShzKTsKCQkJcmV0dXJuICgqcmVzdWx0ID09IE5VTEwgPyBM
QUtfTk9NRU0gOiBMQUtfT0spOwoJCX0KCQlzMSA9IChjaGFyICopc3RydG9rX3IoTlVMTCwgIi4i
LCAmbGFzdHMpOwoJCWktLTsKCX0KCglmcmVlKHMpOwoJcmV0dXJuIExBS19GQUlMOwp9CgojZGVm
aW5lIExBS19NQVgoYSxiLGMpIChhPmI/KGE+Yz9hOmMpOihiPmM/YjpjKSkKCi8qCiAqIGxha19l
eGFwZG5fdG9rZW5zCiAqIFBhcnRzIHdpdGggdGhlIHN0cmluZ3MgcHJvdmlkZWQuCiAqICAgJSUg
ICA9ICUKICogICAldSAgID0gdXNlcgogKiAgICVVICAgPSB1c2VyIHBhcnQgb2YgJXUKICogICAl
ZCAgID0gZG9tYWluIHBhcnQgb2YgJXUgaWYgYXZhaWxhYmxlCiAqICAgJTEtOSA9IGRvbWFpbiB0
b2tlbnMgKCUxID0gdGxkLCAlMiA9IGRvbWFpbiB3aGVuICVkID0gZG9tYWluLnRsZCkKICogICAl
cyAgID0gc2VydmljZQogKiAgICVyICAgPSByZWFsbQogKiBOb3RlOiBjYWxsaW5nIGZ1bmN0aW9u
IG11c3QgZnJlZSBtZW1vcnkuCiAqLwpzdGF0aWMgaW50IGxha19leHBhbmRfdG9rZW5zKGNvbnN0
IGNoYXIgKnBhdHRlcm4sIGNvbnN0IGNoYXIgKnVzZXJuYW1lLCBjb25zdCBjaGFyICpzZXJ2aWNl
LCBjb25zdCBjaGFyICpyZWFsbSwgY2hhciAqKnJlc3VsdCkgCnsKCWNoYXIgKmJ1ZjsgCgljaGFy
ICplbmQsICpwdHIsICp0ZW1wOwoJY2hhciAqZWJ1ZiwgKnVzZXI7CgljaGFyICpkb21haW47Cglp
bnQgcmM7CgoJLyogdG8gcGVybWl0IG11bHRpcGxlIG9jY3VyZW5jZXMgb2YgdXNlcm5hbWUgYW5k
L29yIHJlYWxtIGluIGZpbHRlciAqLwoJLyogYW5kIGF2b2lkIG1lbW9yeSBvdmVyZmxvdyBpbiBm
aWx0ZXIgYnVpbGQgW2VnOiAofCh1aWQ9JXUpKHVzZXJpZD0ldSkpIF0gKi8KCWludCBwZXJjZW50
cywgc2VydmljZV9sZW4sIHJlYWxtX2xlbiwgdXNlcl9sZW4sIG1heHBhcmFtbGVuZ3RoOwoJCglp
ZiAocGF0dGVybiA9PSBOVUxMKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiZmls
dGVyIHBhdHRlcm4gbm90IHNldHVwIik7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCS8qIGZpbmQg
dGhlIGxvbmdlc3QgcGFyYW0gb2YgdXNlcm5hbWUgYW5kIHJlYWxtLCAKCSAgIGRvIG5vdCB3b3Jy
eSBhYm91dCBkb21haW4gYmVjYXVzZSBpdCBpcyBhbHdheXMgc2hvcnRlciAKCSAgIHRoZW4gdXNl
cm5hbWUgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgKi8KCXVzZXJf
bGVuPXN0cmxlbih1c2VybmFtZSk7CglzZXJ2aWNlX2xlbj1zdHJsZW4oc2VydmljZSk7CglyZWFs
bV9sZW49c3RybGVuKHJlYWxtKTsKCgltYXhwYXJhbWxlbmd0aCA9IExBS19NQVgodXNlcl9sZW4s
IHNlcnZpY2VfbGVuLCByZWFsbV9sZW4pOwoKCS8qIGZpbmQgdGhlIG51bWJlciBvZiBvY2N1cmVu
Y2VzIG9mIHBlcmNlbnQgc2lnbiBpbiBmaWx0ZXIgKi8KCWZvciggcGVyY2VudHM9MCwgYnVmPShj
aGFyICopcGF0dGVybjsgKmJ1ZjsgYnVmKysgKSB7CgkJaWYoICpidWYgPT0gJyUnICkgcGVyY2Vu
dHMrKzsKCX0KCgkvKiBwZXJjZW50cyAqIDMgKiBtYXhwYXJhbWxlbmd0aCBiZWNhdXNlIHdlIG5l
ZWQgdG8gYWNjb3VudCBmb3IKICAgICAgICAgKiBhbiBlbnRpcmVseS1lc2NhcGVkIHdvcnN0LWNh
c2UtbGVuZ3RoIHBhcmFtZXRlciAqLwoJYnVmPW1hbGxvYyhzdHJsZW4ocGF0dGVybikgKyAocGVy
Y2VudHMgKiAzICogbWF4cGFyYW1sZW5ndGgpICsxKTsKCWlmKGJ1ZiA9PSBOVUxMKSB7CgkJc3lz
bG9nKExPR19FUlJ8TE9HX0FVVEgsICJDYW5ub3QgYWxsb2NhdGUgbWVtb3J5Iik7CgkJcmV0dXJu
IExBS19OT01FTTsKCX0KCWJ1ZlswXSA9ICdcMCc7CgkKCXB0ciA9IChjaGFyICopcGF0dGVybjsK
CWVuZCA9IHB0ciArIHN0cmxlbihwdHIpOwoKCXdoaWxlICgodGVtcD1zdHJjaHIocHRyLCclJykp
IT1OVUxMICkgewoKCQlpZiAoKHRlbXAtcHRyKSA+IDApCgkJCXN0cm5jYXQoYnVmLCBwdHIsIHRl
bXAtcHRyKTsKCgkJaWYgKCh0ZW1wKzEpID49IGVuZCkgewoJCQlzeXNsb2coTE9HX1dBUk5JTkd8
TE9HX0FVVEgsICJJbmNvbXBsZXRlIGxvb2t1cCBzdWJzdGl0dXRpb24gZm9ybWF0Iik7CgkJCWJy
ZWFrOwoJCX0KCgkJc3dpdGNoICgqKHRlbXArMSkpIHsKCQkJY2FzZSAnJSc6CgkJCQlzdHJuY2F0
KGJ1Zix0ZW1wKzEsMSk7CgkJCQlicmVhazsKCQkJY2FzZSAndSc6CgkJCQlpZiAodXNlcm5hbWUh
PU5VTEwpIHsKCQkJCQlyYz1sYWtfZXNjYXBlKHVzZXJuYW1lLCBzdHJsZW4odXNlcm5hbWUpLCAm
ZWJ1Zik7CgkJCQkJaWYgKHJjID09IExBS19PSykgewoJCQkJCQlzdHJjYXQoYnVmLGVidWYpOwoJ
CQkJCQlmcmVlKGVidWYpOwoJCQkJCX0KCQkJCX0gZWxzZSB7CgkJCQkJc3lzbG9nKExPR19XQVJO
SU5HfExPR19BVVRILCAiVXNlcm5hbWUgbm90IGF2YWlsYWJsZS4iKTsKCQkJCX0KCQkJCWJyZWFr
OwoJCQljYXNlICdVJzoKCQkJCWlmICh1c2VybmFtZSE9TlVMTCkgewoJCQkJCQoJCQkJCXVzZXIg
PSBzdHJjaHIodXNlcm5hbWUsICdAJyk7CgkJCQkJcmM9bGFrX2VzY2FwZSh1c2VybmFtZSwgKHVz
ZXIgPyB1c2VyIC0gdXNlcm5hbWUgOiBzdHJsZW4odXNlcm5hbWUpKSwgJmVidWYpOwoJCQkJCWlm
IChyYyA9PSBMQUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShlYnVm
KTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwg
IlVzZXJuYW1lIG5vdCBhdmFpbGFibGUuIik7CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAnZCc6
CgkJCQlpZiAodXNlcm5hbWUhPU5VTEwgJiYgKGRvbWFpbiA9IHN0cmNocih1c2VybmFtZSwgJ0An
KSkgJiYgZG9tYWluWzFdIT0nXDAnKSB7CgkJCQkJcmM9bGFrX2VzY2FwZShkb21haW4rMSwgc3Ry
bGVuKGRvbWFpbisxKSwgJmVidWYpOwoJCQkJCWlmIChyYyA9PSBMQUtfT0spIHsKCQkJCQkJc3Ry
Y2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShlYnVmKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJ
CXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIkRvbWFpbiBub3QgYXZhaWxhYmxlLiIpOwoJ
CQkJfQoJCQkJYnJlYWs7CgkJCWNhc2UgJzEnOgoJCQljYXNlICcyJzoKCQkJY2FzZSAnMyc6CgkJ
CWNhc2UgJzQnOgoJCQljYXNlICc1JzoKCQkJY2FzZSAnNic6CgkJCWNhc2UgJzcnOgoJCQljYXNl
ICc4JzoKCQkJY2FzZSAnOSc6CgkJCQlpZiAodXNlcm5hbWUhPU5VTEwgJiYgKGRvbWFpbiA9IHN0
cmNocih1c2VybmFtZSwgJ0AnKSkgJiYgZG9tYWluWzFdIT0nXDAnKSB7CgkJCQkJcmM9bGFrX3Rv
a2VuaXplX2RvbWFpbnMoZG9tYWluKzEsIChpbnQpICoodGVtcCsxKS00OCwgJmVidWYpOwoJCQkJ
CWlmIChyYyA9PSBMQUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShl
YnVmKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVU
SCwgIkRvbWFpbiB0b2tlbnMgbm90IGF2YWlsYWJsZS4iKTsKCQkJCX0KCQkJCWJyZWFrOwoJCQlj
YXNlICdyJzoKCQkJCWlmIChyZWFsbSE9TlVMTCkgewoJCQkJCXJjID0gbGFrX2VzY2FwZShyZWFs
bSwgc3RybGVuKHJlYWxtKSwgJmVidWYpOwoJCQkJCWlmIChyYyA9PSBMQUtfT0spIHsKCQkJCQkJ
c3RyY2F0KGJ1ZixlYnVmKTsKCQkJCQkJZnJlZShlYnVmKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJ
CQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlJlYWxtIG5vdCBhdmFpbGFibGUuIik7
CgkJCQl9CgkJCQlicmVhazsKCQkJY2FzZSAncyc6CgkJCQlpZiAoc2VydmljZSE9TlVMTCkgewoJ
CQkJCXJjID0gbGFrX2VzY2FwZShzZXJ2aWNlLCBzdHJsZW4oc2VydmljZSksICZlYnVmKTsKCQkJ
CQlpZiAocmMgPT0gTEFLX09LKSB7CgkJCQkJCXN0cmNhdChidWYsZWJ1Zik7CgkJCQkJCWZyZWUo
ZWJ1Zik7CgkJCQkJfQoJCQkJfSBlbHNlIHsKCQkJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FV
VEgsICJTZXJ2aWNlIG5vdCBhdmFpbGFibGUuIik7CgkJCQl9CgkJCQlicmVhazsKCQkJZGVmYXVs
dDoKCQkJCWJyZWFrOwoJCX0KCQlwdHI9dGVtcCsyOwoJfQoJaWYgKHRlbXA8ZW5kKQoJCXN0cmNh
dChidWYsIHB0cik7CgoJKnJlc3VsdCA9IGJ1ZjsKCglyZXR1cm4gTEFLX09LOwp9CgppbnQgbGFr
X2luaXQoY29uc3QgY2hhciAqY29uZmlnZmlsZSwgTEFLICoqcmV0KSAKewoJTEFLICpsYWs7Cglp
bnQgcmM7CgoJbGFrID0gKnJldDsKCglpZiAobGFrICE9IE5VTEwpIHsKCQlyZXR1cm4gTEFLX09L
OwoJfQoKCWxhayA9IChMQUsgKiltYWxsb2Moc2l6ZW9mKExBSykpOwoJaWYgKGxhayA9PSBOVUxM
KSB7CgkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICJDYW5ub3QgYWxsb2NhdGUgbWVtb3J5Iik7
CgkJcmV0dXJuIExBS19OT01FTTsKCX0KCglsYWstPmJpbmRfc3RhdHVzPUxBS19OT1RfQk9VTkQ7
CglsYWstPmxkPU5VTEw7CglsYWstPmNvbmY9TlVMTDsKCglyYyA9IGxha19jb25maWcoY29uZmln
ZmlsZSwgJmxhay0+Y29uZik7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJZnJlZShsYWspOwoJCXJl
dHVybiByYzsKCX0KCiNpZmRlZiBIQVZFX09QRU5TU0wKCU9wZW5TU0xfYWRkX2FsbF9kaWdlc3Rz
KCk7CiNlbmRpZgoKCSpyZXQ9bGFrOwoJcmV0dXJuIExBS19PSzsKfQoKdm9pZCBsYWtfY2xvc2Uo
TEFLICpsYWspIHsKCglpZiAobGFrID09IE5VTEwpCgkJcmV0dXJuOwoKCWlmIChsYWstPmxkICE9
IE5VTEwpCgkJbGRhcF91bmJpbmRfcyhsYWstPmxkKTsKCglsYWtfY29uZmlnX2ZyZWUobGFrLT5j
b25mKTsKCglmcmVlKGxhayk7CgojaWZkZWYgSEFWRV9PUEVOU1NMCglFVlBfY2xlYW51cCgpOwoj
ZW5kaWYKCglyZXR1cm47Cn0KCnN0YXRpYyBpbnQgbGFrX2Nvbm5lY3QoTEFLICpsYWspCnsKCWlu
dCAgICAgcmMgPSAwOwoKCWlmIChsYWstPmNvbmYtPnRsc19jYWNlcnRfZmlsZSAhPSBOVUxMKSB7
CgkJcmMgPSBsZGFwX3NldF9vcHRpb24gKE5VTEwsIExEQVBfT1BUX1hfVExTX0NBQ0VSVEZJTEUs
IGxhay0+Y29uZi0+dGxzX2NhY2VydF9maWxlKTsKCQlpZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7
CgkJCXN5c2xvZyAoTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0IExEQVBfT1BU
X1hfVExTX0NBQ0VSVEZJTEUgKCVzKS4iLCBsZGFwX2VycjJzdHJpbmcgKHJjKSk7CgkJfQoJfQoK
CWlmIChsYWstPmNvbmYtPnRsc19jYWNlcnRfZGlyICE9IE5VTEwpIHsKCQlyYyA9IGxkYXBfc2V0
X29wdGlvbiAoTlVMTCwgTERBUF9PUFRfWF9UTFNfQ0FDRVJURElSLCBsYWstPmNvbmYtPnRsc19j
YWNlcnRfZGlyKTsKCQlpZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7CgkJCXN5c2xvZyAoTE9HX1dB
Uk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0IExEQVBfT1BUX1hfVExTX0NBQ0VSVERJUiAo
JXMpLiIsIGxkYXBfZXJyMnN0cmluZyAocmMpKTsKCQl9Cgl9CgoJaWYgKGxhay0+Y29uZi0+dGxz
X2NoZWNrX3BlZXIgIT0gMCkgewoJCXJjID0gbGRhcF9zZXRfb3B0aW9uKE5VTEwsIExEQVBfT1BU
X1hfVExTX1JFUVVJUkVfQ0VSVCwgJmxhay0+Y29uZi0+dGxzX2NoZWNrX3BlZXIpOwoJCWlmIChy
YyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJc3lzbG9nIChMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVu
YWJsZSB0byBzZXQgTERBUF9PUFRfWF9UTFNfUkVRVUlSRV9DRVJUICglcykuIiwgbGRhcF9lcnIy
c3RyaW5nIChyYykpOwoJCX0KCX0KCglpZiAobGFrLT5jb25mLT50bHNfY2lwaGVycyAhPSBOVUxM
KSB7CgkJLyogc2V0IGNpcGhlciBzdWl0ZSwgY2VydGlmaWNhdGUgYW5kIHByaXZhdGUga2V5OiAq
LwoJCXJjID0gbGRhcF9zZXRfb3B0aW9uKE5VTEwsIExEQVBfT1BUX1hfVExTX0NJUEhFUl9TVUlU
RSwgbGFrLT5jb25mLT50bHNfY2lwaGVycyk7CgkJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJ
CQlzeXNsb2cgKExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9Y
X1RMU19DSVBIRVJfU1VJVEUgKCVzKS4iLCBsZGFwX2VycjJzdHJpbmcgKHJjKSk7CgkJfQoJfQoK
CWlmIChsYWstPmNvbmYtPnRsc19jZXJ0ICE9IE5VTEwpIHsKCQlyYyA9IGxkYXBfc2V0X29wdGlv
bihOVUxMLCBMREFQX09QVF9YX1RMU19DRVJURklMRSwgbGFrLT5jb25mLT50bHNfY2VydCk7CgkJ
aWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJCQlzeXNsb2cgKExPR19XQVJOSU5HfExPR19BVVRI
LCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9YX1RMU19DRVJURklMRSAoJXMpLiIsIGxkYXBfZXJy
MnN0cmluZyAocmMpKTsKCQl9Cgl9CgoJaWYgKGxhay0+Y29uZi0+dGxzX2tleSAhPSBOVUxMKSB7
CgkJcmMgPSBsZGFwX3NldF9vcHRpb24oTlVMTCwgTERBUF9PUFRfWF9UTFNfS0VZRklMRSwgbGFr
LT5jb25mLT50bHNfa2V5KTsKCQlpZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7CgkJCXN5c2xvZyAo
TE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0IExEQVBfT1BUX1hfVExTX0tFWUZJ
TEUgKCVzKS4iLCBsZGFwX2VycjJzdHJpbmcgKHJjKSk7CgkJfQoJfQoKCXJjID0gbGRhcF9pbml0
aWFsaXplKCZsYWstPmxkLCBsYWstPmNvbmYtPnNlcnZlcnMpOwoJaWYgKHJjICE9IExEQVBfU1VD
Q0VTUykgewoJCXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAibGRhcF9pbml0aWFsaXplIGZhaWxl
ZCAoJXMpIiwgbGFrLT5jb25mLT5zZXJ2ZXJzKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJaWYg
KGxhay0+Y29uZi0+ZGVidWcpIHsKCQlyYyA9IGxkYXBfc2V0X29wdGlvbihOVUxMLCBMREFQX09Q
VF9ERUJVR19MRVZFTCwgJihsYWstPmNvbmYtPmRlYnVnKSk7CgkJaWYgKHJjICE9IExEQVBfT1BU
X1NVQ0NFU1MpCgkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQg
TERBUF9PUFRfREVCVUdfTEVWRUwgJXguIiwgbGFrLT5jb25mLT5kZWJ1Zyk7Cgl9CgoJcmMgPSBs
ZGFwX3NldF9vcHRpb24obGFrLT5sZCwgTERBUF9PUFRfUFJPVE9DT0xfVkVSU0lPTiwgJihsYWst
PmNvbmYtPnZlcnNpb24pKTsKCWlmIChyYyAhPSBMREFQX09QVF9TVUNDRVNTKSB7CgkJc3lzbG9n
KExPR19XQVJOSU5HfExPR19BVVRILCAiVW5hYmxlIHRvIHNldCBMREFQX09QVF9QUk9UT0NPTF9W
RVJTSU9OICVkLiIsIGxhay0+Y29uZi0+dmVyc2lvbik7CgkJbGFrLT5jb25mLT52ZXJzaW9uID0g
TERBUF9WRVJTSU9OMjsKCX0KCglyYyA9IGxkYXBfc2V0X29wdGlvbihsYWstPmxkLCBMREFQX09Q
VF9ORVRXT1JLX1RJTUVPVVQsICYobGFrLT5jb25mLT50aW1lb3V0KSk7CglpZiAocmMgIT0gTERB
UF9PUFRfU1VDQ0VTUykgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0
byBzZXQgTERBUF9PUFRfTkVUV09SS19USU1FT1VUICVkLiVkLiIsIGxhay0+Y29uZi0+dGltZW91
dC50dl9zZWMsIGxhay0+Y29uZi0+dGltZW91dC50dl91c2VjKTsKCX0KCglyYyA9IGxkYXBfc2V0
X29wdGlvbihsYWstPmxkLCBMREFQX09QVF9USU1FTElNSVQsICYobGFrLT5jb25mLT50aW1lX2xp
bWl0KSk7CglpZiAocmMgIT0gTERBUF9PUFRfU1VDQ0VTUykgewoJCXN5c2xvZyhMT0dfV0FSTklO
R3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERBUF9PUFRfVElNRUxJTUlUICVkLiIsIGxhay0+
Y29uZi0+dGltZV9saW1pdCk7Cgl9CgoJcmMgPSBsZGFwX3NldF9vcHRpb24obGFrLT5sZCwgTERB
UF9PUFRfREVSRUYsICYobGFrLT5jb25mLT5kZXJlZikpOwoJaWYgKHJjICE9IExEQVBfT1BUX1NV
Q0NFU1MpIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0IExE
QVBfT1BUX0RFUkVGICVkLiIsIGxhay0+Y29uZi0+ZGVyZWYpOwoJfQoKCXJjID0gbGRhcF9zZXRf
b3B0aW9uKGxhay0+bGQsIExEQVBfT1BUX1JFRkVSUkFMUywgbGFrLT5jb25mLT5yZWZlcnJhbHMg
PyBMREFQX09QVF9PTiA6IExEQVBfT1BUX09GRik7CglpZiAocmMgIT0gTERBUF9PUFRfU1VDQ0VT
UykgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBzZXQgTERBUF9P
UFRfUkVGRVJSQUxTLiIpOwoJfQoKCXJjID0gbGRhcF9zZXRfb3B0aW9uKGxhay0+bGQsIExEQVBf
T1BUX1NJWkVMSU1JVCwgJihsYWstPmNvbmYtPnNpemVfbGltaXQpKTsKCWlmIChyYyAhPSBMREFQ
X09QVF9TVUNDRVNTKQoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIlVuYWJsZSB0byBz
ZXQgTERBUF9PUFRfU0laRUxJTUlUICVkLiIsIGxhay0+Y29uZi0+c2l6ZV9saW1pdCk7CgoJcmMg
PSBsZGFwX3NldF9vcHRpb24obGFrLT5sZCwgTERBUF9PUFRfUkVTVEFSVCwgbGFrLT5jb25mLT5y
ZXN0YXJ0ID8gTERBUF9PUFRfT04gOiBMREFQX09QVF9PRkYpOwoJaWYgKHJjICE9IExEQVBfT1BU
X1NVQ0NFU1MpIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJVbmFibGUgdG8gc2V0
IExEQVBfT1BUX1JFU1RBUlQuIik7Cgl9CgoJcmV0dXJuIExBS19PSzsKfQoKCnN0YXRpYyBpbnQg
bGFrX2JpbmQoTEFLICpsYWssIGNoYXIgZmxhZywgY29uc3QgY2hhciAqYmluZF9kbiwgY29uc3Qg
Y2hhciAqcGFzc3dvcmQpIAp7CglpbnQgcmM7CgoJaWYgKGxhay0+YmluZF9zdGF0dXMgPT0gTEFL
X0JJTkRfQU5PTllNT1VTICYmCgkgICAgZmxhZyA9PSBMQUtfQklORF9BTk9OWU1PVVMpIHsKCSAg
ICByZXR1cm4gTEFLX09LOwoJfQoKCWlmIChsYWstPmJpbmRfc3RhdHVzID09IExBS19OT1RfQk9V
TkQpIHsKCQlpZiAobGFrLT5sZCAhPSBOVUxMKSB7CgkJCWxkYXBfdW5iaW5kX3MobGFrLT5sZCk7
CgkJCWxhay0+bGQgPSBOVUxMOwoJCX0KCgkJcmMgPSBsYWtfY29ubmVjdChsYWspOwoJCWlmIChy
YyAhPSBMQUtfT0spIHsKCQkJcmV0dXJuIHJjOwoJCX0KCX0gZWxzZSB7CgkJaWYgKGxhay0+Y29u
Zi0+dmVyc2lvbiA9PSBMREFQX1ZFUlNJT04yKSB7CgoJCQlsYWstPmJpbmRfc3RhdHVzID0gTEFL
X05PVF9CT1VORDsKCgkJCWlmIChsYWstPmxkICE9IE5VTEwpIHsKCQkJCWxkYXBfdW5iaW5kX3Mo
bGFrLT5sZCk7CgkJCQlsYWstPmxkID0gTlVMTDsKCQkJfQoJCQlyYyA9IGxha19jb25uZWN0KGxh
ayk7CgkJCWlmIChyYyAhPSBMQUtfT0spIHsKCQkJCXJldHVybiByYzsKCQkJfQoJCX0KCX0KCgly
YyA9IGxkYXBfc2ltcGxlX2JpbmRfcyhsYWstPmxkLCBiaW5kX2RuLCBwYXNzd29yZCk7CglpZiAo
cmMgIT0gTERBUF9TVUNDRVNTKSB7CgkgICAgc3lzbG9nKChmbGFnID09IExBS19CSU5EX0FOT05Z
TU9VUyA/IExPR19XQVJOSU5HIDogTE9HX0RFQlVHKXxMT0dfQVVUSCwKCQkgICAibGRhcF9zaW1w
bGVfYmluZCgpIGZhaWxlZCBhcyAlcyAoJXMpIiwKCQkgICAoIWJpbmRfZG4gfHwgYmluZF9kblsw
XSA9PSAnXDAnKSA/ICJhbm9ueW1vdXMiIDogYmluZF9kbiwKCQkgICBsZGFwX2VycjJzdHJpbmco
cmMpKTsKCSAgICBsYWstPmJpbmRfc3RhdHVzID0gTEFLX05PVF9CT1VORDsKCSAgICByZXR1cm4g
TEFLX0ZBSUw7Cgl9CgoJbGFrLT5iaW5kX3N0YXR1cyA9IGZsYWc7CglyZXR1cm4gTEFLX09LOwp9
CgoKc3RhdGljIGludCBsYWtfc2VhcmNoKExBSyAqbGFrLCBjb25zdCBjaGFyICpzZWFyY2hfYmFz
ZSwgY29uc3QgY2hhciAqZmlsdGVyLCBjb25zdCBjaGFyICoqYXR0cnMsIExEQVBNZXNzYWdlICoq
cmVzKQp7CglpbnQgcmMgPSAwOwoJaW50IHJldHJ5ID0gMTsKCgkqcmVzID0gTlVMTDsKCnJldHJ5
OgoJcmMgPSBsYWtfYmluZChsYWssIExBS19CSU5EX0FOT05ZTU9VUywgbGFrLT5jb25mLT5iaW5k
X2RuLCBsYWstPmNvbmYtPmJpbmRfcHcpOwoJaWYgKHJjICE9IExBS19PSykgewoJCXN5c2xvZyhM
T0dfV0FSTklOR3xMT0dfQVVUSCwgImxha19iaW5kKCkgZmFpbGVkIik7CgkJcmV0dXJuIExBS19G
QUlMOwoJfQoKCXJjID0gbGRhcF9zZWFyY2hfc3QobGFrLT5sZCwgc2VhcmNoX2Jhc2UsIGxhay0+
Y29uZi0+c2NvcGUsIGZpbHRlciwgKGNoYXIgKiopIGF0dHJzLCAwLCAmKGxhay0+Y29uZi0+dGlt
ZW91dCksIHJlcyk7Cglzd2l0Y2ggKHJjKSB7CgkJY2FzZSBMREFQX1NVQ0NFU1M6CgkJY2FzZSBM
REFQX05PX1NVQ0hfT0JKRUNUOgoJCQlicmVhazsKCQljYXNlIExEQVBfVElNRUxJTUlUX0VYQ0VF
REVEOgoJCWNhc2UgTERBUF9CVVNZOgoJCWNhc2UgTERBUF9VTkFWQUlMQUJMRToKCQljYXNlIExE
QVBfSU5TVUZGSUNJRU5UX0FDQ0VTUzoKCQkJLyogIFdlIGRvIG5vdCBuZWVkIHRvIHJlLWNvbm5l
Y3QgdG8gdGhlIExEQVAgc2VydmVyIAoJCQkgICAgdW5kZXIgdGhlc2UgY29uZGl0aW9ucyAqLwoJ
CQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgImxkYXBfc2VhcmNoX3N0KCkgZmFpbGVkOiAlcyIs
IGxkYXBfZXJyMnN0cmluZyhyYykpOwoJCQlsZGFwX21zZ2ZyZWUoKnJlcyk7CgkJCXJldHVybiBM
QUtfRkFJTDsKCQljYXNlIExEQVBfVElNRU9VVDoKCQljYXNlIExEQVBfU0VSVkVSX0RPV046CgkJ
CWlmIChyZXRyeSkgewoJCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAibGRhcF9zZWFy
Y2hfc3QoKSBmYWlsZWQ6ICVzLiBUcnlpbmcgdG8gcmVjb25uZWN0LiIsIGxkYXBfZXJyMnN0cmlu
ZyhyYykpOwoJCQkJbGRhcF9tc2dmcmVlKCpyZXMpOwoJCQkJbGFrLT5iaW5kX3N0YXR1cyA9IExB
S19OT1RfQk9VTkQ7CgkJCQlyZXRyeS0tOwoJCQkJZ290byByZXRyeTsKCQkJfQoJCWRlZmF1bHQ6
CgkJCXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAibGRhcF9zZWFyY2hfc3QoKSBmYWlsZWQ6ICVz
IiwgbGRhcF9lcnIyc3RyaW5nKHJjKSk7CgkJCWxkYXBfbXNnZnJlZSgqcmVzKTsKCQkJbGFrLT5i
aW5kX3N0YXR1cyA9IExBS19OT1RfQk9VTkQ7CgkJCXJldHVybiBMQUtfRkFJTDsKCX0KCglpZiAo
KGxkYXBfY291bnRfZW50cmllcyhsYWstPmxkLCAqcmVzKSkgIT0gMSkgewoJCXN5c2xvZyhMT0df
REVCVUd8TE9HX0FVVEgsICJFbnRyeSBub3QgZm91bmQgb3IgbW9yZSB0aGFuIG9uZSBlbnRyaWVz
IGZvdW5kICglcykuIiwgZmlsdGVyKTsKCQlsZGFwX21zZ2ZyZWUoKnJlcyk7CgkJcmV0dXJuIExB
S19GQUlMOwoJfQoJCglyZXR1cm4gTEFLX09LOwp9CgovKiAKICogbGFrX3JldHJpZXZlIC0gcmV0
cmlldmUgdXNlckByZWFsbSB2YWx1ZXMgc3BlY2lmaWVkIGJ5ICdhdHRycycKICovCmludCBsYWtf
cmV0cmlldmUoTEFLICpsYWssIGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnNlcnZpY2Us
IGNvbnN0IGNoYXIgKnJlYWxtLCBjb25zdCBjaGFyICoqYXR0cnMsIExBS19SRVNVTFQgKipyZXQp
CnsKCWludCByYyA9IDAsIGk7CgljaGFyICpmaWx0ZXIgPSBOVUxMOwoJY2hhciAqc2VhcmNoX2Jh
c2UgPSBOVUxMOwoJTERBUE1lc3NhZ2UgKnJlczsKCUxEQVBNZXNzYWdlICplbnRyeTsKCUJlckVs
ZW1lbnQgKmJlcjsKCWNoYXIgKmF0dHIsICoqdmFsczsKICAgIAogICAgCSpyZXQgPSBOVUxMOwoK
CWlmIChsYWsgPT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAibGFrX2luaXQg
ZGlkIG5vdCBydW4uIik7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWlmICh1c2VyID09IE5VTEwg
fHwgdXNlclswXSA9PSAnXDAnKSB7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCXJjID0gbGFrX2V4
cGFuZF90b2tlbnMobGFrLT5jb25mLT5maWx0ZXIsIHVzZXIsIHNlcnZpY2UsIHJlYWxtLCAmZmls
dGVyKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgs
ICJsYWtfZXhwYW5kX3Rva2VucyhmaWx0ZXIpIGZhaWxlZC4iKTsKCQlyZXR1cm4gTEFLX0ZBSUw7
Cgl9CgoJcmMgPSBsYWtfZXhwYW5kX3Rva2VucyhsYWstPmNvbmYtPnNlYXJjaF9iYXNlLCB1c2Vy
LCBzZXJ2aWNlLCByZWFsbSwgJnNlYXJjaF9iYXNlKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlz
eXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJsYWtfZXhwYW5kX3Rva2VucyhzZWFyY2hfYmFz
ZSkgZmFpbGVkLiIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxha19zZWFyY2gobGFr
LCBzZWFyY2hfYmFzZSwgZmlsdGVyLCBhdHRycywgJnJlcyk7CglpZiAocmMgIT0gTEFLX09LKSB7
CgkJZnJlZShmaWx0ZXIpOwoJCWZyZWUoc2VhcmNoX2Jhc2UpOwoJCXJldHVybiBMQUtfRkFJTDsK
CX0KCgllbnRyeSA9IGxkYXBfZmlyc3RfZW50cnkobGFrLT5sZCwgcmVzKTsgCglpZiAoZW50cnkg
PT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgImxkYXBfZmlyc3RfZW50
cnkoKSBmYWlsZWQuIik7CgkJZnJlZShmaWx0ZXIpOwoJCWZyZWUoc2VhcmNoX2Jhc2UpOwoJCWxk
YXBfbXNnZnJlZShyZXMpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IExBS19PSzsKCWZv
ciAoYXR0ciA9IGxkYXBfZmlyc3RfYXR0cmlidXRlKGxhay0+bGQsIGVudHJ5LCAmYmVyKTsgYXR0
ciAhPSBOVUxMOyAKCQlhdHRyID0gbGRhcF9uZXh0X2F0dHJpYnV0ZShsYWstPmxkLCBlbnRyeSwg
YmVyKSkgewoKCQl2YWxzID0gbGRhcF9nZXRfdmFsdWVzKGxhay0+bGQsIGVudHJ5LCBhdHRyKTsK
CQlpZiAodmFscyA9PSBOVUxMKSB7CgkJCWNvbnRpbnVlOwoJCX0KCgkJZm9yIChpID0gMDsgdmFs
c1tpXSAhPSBOVUxMOyBpKyspIHsKCQkJcmMgPSBsYWtfcmVzdWx0X2FkZChsYWssIGF0dHIsIHZh
bHNbaV0sIHJldCk7CgkJCWlmIChyYyAhPSBMQUtfT0spIHsKCQkJCWJyZWFrOwoJCQl9CgkJfQoK
CQlsZGFwX3ZhbHVlX2ZyZWUodmFscyk7CgkJbGRhcF9tZW1mcmVlKGF0dHIpOwoKCQlpZiAocmMg
IT0gTEFLX09LKSB7CgkJCWxha19yZXN1bHRfZnJlZSgqcmV0KTsKCQkJKnJldCA9IE5VTEw7CgkJ
CWJyZWFrOwoJCX0KCX0KCglpZiAoYmVyICE9IE5VTEwpCgkJYmVyX2ZyZWUoYmVyLCAwKTsKCWxk
YXBfbXNnZnJlZShyZXMpOwoJZnJlZShmaWx0ZXIpOwoJZnJlZShzZWFyY2hfYmFzZSk7CgoJaWYg
KCpyZXQgPT0gTlVMTCkKCQlyZXR1cm4gTEFLX05PRU5UOwoKCXJldHVybiBMQUtfT0s7Cn0KCgpz
dGF0aWMgaW50IGxha19ncm91cF9tZW1iZXIoTEFLICpsYWssIGNvbnN0IGNoYXIgKnVzZXIsIGNv
bnN0IGNoYXIgKnNlcnZpY2UsIGNvbnN0IGNoYXIgKnJlYWxtLCBjb25zdCBjaGFyICpkbikKewoJ
Y2hhciAqZ3JvdXA7CglpbnQgcmM7CgoJcmMgPSBsYWtfZXhwYW5kX3Rva2VucyhsYWstPmNvbmYt
Pmdyb3VwX2RuLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgJmdyb3VwKTsKCWlmIChyYyAhPSBMQUtf
T0spIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJsYWtfZXhwYW5kX3Rva2Vucyhn
cm91cCkgZmFpbGVkLiIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyYyA9IGxkYXBfY29tcGFy
ZV9zKGxhay0+bGQsIGdyb3VwLCBsYWstPmNvbmYtPmdyb3VwX2F0dHIsIGRuKTsKCWZyZWUoZ3Jv
dXApOwoJaWYgKHJjICE9IExEQVBfQ09NUEFSRV9UUlVFKSB7CgkJc3lzbG9nKExPR19XQVJOSU5H
fExPR19BVVRILCAibGRhcF9jb21wYXJlX3MoKSBmb3IgZ3JvdXAgZmFpbGVkLiIpOwoJCXJjID0g
TEFLX0ZBSUw7Cgl9CgoJcmV0dXJuIExBS19PSzsKfQoKc3RhdGljIGludCBsYWtfYXV0aF9jdXN0
b20oTEFLICpsYWssIGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnNlcnZpY2UsIGNvbnN0
IGNoYXIgKnJlYWxtLCBjb25zdCBjaGFyICpwYXNzd29yZCkgCnsKCUxBS19SRVNVTFQgKmxyZXMs
ICpwdHI7CglpbnQgcmM7CglzdHJ1Y3QgcGFzc3dvcmRfY2hlY2sgKnBjOwoJY29uc3QgY2hhciAq
YXR0cnNbXSA9IHsiZG4iLCBsYWstPmNvbmYtPnBhc3N3b3JkX2F0dHIsIE5VTEx9OwoJY2hhciAq
ZG47CgoJcmMgPSBsYWtfcmV0cmlldmUobGFrLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgYXR0cnMs
ICZscmVzKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlyZXR1cm4gcmM7Cgl9CgoJcmMgPSBMQUtf
RkFJTDsKCglmb3IgKHB0ciA9IGxyZXM7IHB0ciAhPSBOVUxMOyBwdHIgPSBwdHItPm5leHQpIHsK
CQkKCQlpZiAoc3RyY2FzZWNtcChwdHItPmF0dHJpYnV0ZSwgbGFrLT5jb25mLT5wYXNzd29yZF9h
dHRyKSkKCQkJY29udGludWU7CgoJCXJjID0gbGFrX2NoZWNrX3Bhc3N3b3JkKHB0ci0+dmFsdWUs
IHBhc3N3b3JkLCBOVUxMKTsKCQlpZiAocmMgPT0gTEFLX09LKSB7CgkJCWJyZWFrOwoJCX0KCX0K
CglpZiAocmMgPT0gTEFLX09LICYmCgkgICAgbGFrLT5jb25mLT5ncm91cF9kbiAhPSBOVUxMICYm
ICoobGFrLT5jb25mLT5ncm91cF9kbikgIT0gJ1wwJykgewoKCQlyYyA9IExBS19GQUlMOwoKCQlm
b3IgKHB0ciA9IGxyZXM7IHB0ciAhPSBOVUxMOyBwdHIgPSBwdHItPm5leHQpCgkJCWlmICghc3Ry
Y2FzZWNtcChwdHItPmF0dHJpYnV0ZSwgImRuIikpIHsKCQkJCXJjID0gbGFrX2dyb3VwX21lbWJl
cihsYWssIHVzZXIsIHNlcnZpY2UsIHJlYWxtLCBkbik7CgkJCQlicmVhazsKCQkJfQoKCQlzeXNs
b2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJHcm91cCBjaGVjayBmYWlsZWQgKGRuIHVua25vd24p
LiIpOwoJfQoJCglsYWtfcmVzdWx0X2ZyZWUobHJlcyk7CgoJcmV0dXJuKHJjKTsKfQoKc3RhdGlj
IGludCBsYWtfYXV0aF9iaW5kKExBSyAqbGFrLCBjb25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFy
ICpzZXJ2aWNlLCBjb25zdCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqcGFzc3dvcmQpIAp7Cglj
aGFyICpmaWx0ZXI7CgljaGFyICpzZWFyY2hfYmFzZTsKCWludCByYzsKCWNoYXIgKmRuOwoJTERB
UE1lc3NhZ2UgKnJlcywgKmVudHJ5OwoKCXJjID0gbGFrX2V4cGFuZF90b2tlbnMobGFrLT5jb25m
LT5maWx0ZXIsIHVzZXIsIHNlcnZpY2UsIHJlYWxtLCAmZmlsdGVyKTsKCWlmIChyYyAhPSBMQUtf
T0spIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJsYWtfZXhwYW5kX3Rva2Vucyhm
aWx0ZXIpIGZhaWxlZC4iKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmMgPSBsYWtfZXhwYW5k
X3Rva2VucyhsYWstPmNvbmYtPnNlYXJjaF9iYXNlLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgJnNl
YXJjaF9iYXNlKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9H
X0FVVEgsICJsYWtfZXhwYW5kX3Rva2VucyhzZWFyY2hfYmFzZSkgZmFpbGVkLiIpOwoJCXJldHVy
biBMQUtfRkFJTDsKCX0KCglyYyA9IGxha19zZWFyY2gobGFrLCBzZWFyY2hfYmFzZSwgZmlsdGVy
LCBOVUxMLCAmcmVzKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlmcmVlKGZpbHRlcik7CgkJZnJl
ZShzZWFyY2hfYmFzZSk7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWVudHJ5ID0gbGRhcF9maXJz
dF9lbnRyeShsYWstPmxkLCByZXMpOyAKCWlmIChlbnRyeSA9PSBOVUxMKSB7CgkJc3lzbG9nKExP
R19XQVJOSU5HfExPR19BVVRILCAibGRhcF9maXJzdF9lbnRyeSgpLiIpOwoJCWZyZWUoZmlsdGVy
KTsKCQlmcmVlKHNlYXJjaF9iYXNlKTsKCQlsZGFwX21zZ2ZyZWUocmVzKTsKCQlyZXR1cm4gTEFL
X0ZBSUw7Cgl9CgoJZG4gPSBsZGFwX2dldF9kbihsYWstPmxkLCByZXMpOwoJaWYgKGRuID09IE5V
TEwpIHsKCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgImxkYXBfZ2V0X2RuKCkgZmFpbGVkLiIp
OwoJCWZyZWUoZmlsdGVyKTsKCQlmcmVlKHNlYXJjaF9iYXNlKTsKCQlsZGFwX21zZ2ZyZWUgKHJl
cyk7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWZyZWUoZmlsdGVyKTsKCWZyZWUoc2VhcmNoX2Jh
c2UpOwoJbGRhcF9tc2dmcmVlKHJlcyk7CgoJcmMgPSBsYWtfYmluZChsYWssIExBS19CSU5EX0FT
X1VTRVIsIGRuLCBwYXNzd29yZCk7CgoJaWYgKHJjID09IExBS19PSyAmJgoJICAgIGxhay0+Y29u
Zi0+Z3JvdXBfZG4gIT0gTlVMTCAmJiAqKGxhay0+Y29uZi0+Z3JvdXBfZG4pICE9ICdcMCcpCgkJ
cmMgPSBsYWtfZ3JvdXBfbWVtYmVyKGxhaywgdXNlciwgc2VydmljZSwgcmVhbG0sIGRuKTsKCgls
ZGFwX21lbWZyZWUoZG4pOwoKCWxha19iaW5kKGxhaywgTEFLX0JJTkRfQU5PTllNT1VTLCBsYWst
PmNvbmYtPmJpbmRfZG4sIGxhay0+Y29uZi0+YmluZF9wdyk7CgoKCXJldHVybiByYzsKfQoKCnN0
YXRpYyBpbnQgbGFrX2F1dGhfZmFzdGJpbmQoTEFLICpsYWssIGNvbnN0IGNoYXIgKnVzZXIsIGNv
bnN0IGNoYXIgKnNlcnZpY2UsIGNvbnN0IGNoYXIgKnJlYWxtLCBjb25zdCBjaGFyICpwYXNzd29y
ZCkgCnsKCWludCByYzsKCWNoYXIgKmRuID0gTlVMTDsKCglyYyA9IGxha19leHBhbmRfdG9rZW5z
KGxhay0+Y29uZi0+ZmlsdGVyLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgJmRuKTsKCWlmIChyYyAh
PSBMQUtfT0sgfHwgZG4gPT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwg
Imxha19leHBhbmRfdG9rZW5zKGZpbHRlcikgZmFpbGVkLiIpOwoJCXJldHVybiBMQUtfRkFJTDsK
CX0KCglyYyA9IGxha19iaW5kKGxhaywgTEFLX0JJTkRfQVNfVVNFUiwgZG4sIHBhc3N3b3JkKTsK
CWZyZWUoZG4pOwoKCWlmIChyYyA9PSBMQUtfT0sgJiYKCSAgICBsYWstPmNvbmYtPmdyb3VwX2Ru
ICE9IE5VTEwgJiYgKihsYWstPmNvbmYtPmdyb3VwX2RuKSAhPSAnXDAnKQoJCXJjID0gbGFrX2dy
b3VwX21lbWJlcihsYWssIHVzZXIsIHNlcnZpY2UsIHJlYWxtLCBkbik7CgoJcmV0dXJuIHJjOwp9
CgppbnQgbGFrX2F1dGhlbnRpY2F0ZShMQUsgKmxhaywgY29uc3QgY2hhciAqdXNlciwgY29uc3Qg
Y2hhciAqc2VydmljZSwgY29uc3QgY2hhciAqcmVhbG0sIGNvbnN0IGNoYXIgKnBhc3N3b3JkKSAK
ewoJaW50IHJjOwoKCWlmIChsYWsgPT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfRVJSfExPR19BVVRI
LCAibGFrX2luaXQgZGlkIG5vdCBydW4uIik7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWlmICh1
c2VyID09IE5VTEwgfHwgdXNlclswXSA9PSAnXDAnKQoJCXJldHVybiBMQUtfRkFJTDsKCglpZiAo
bGFrLT5jb25mLT5hdXRoX21ldGhvZCA9PSBMQUtfQVVUSF9NRVRIT0RfQklORCkKCQlyYyA9IGxh
a19hdXRoX2JpbmQobGFrLCB1c2VyLCBzZXJ2aWNlLCByZWFsbSwgcGFzc3dvcmQpOwoJZWxzZSBp
ZiAobGFrLT5jb25mLT5hdXRoX21ldGhvZCA9PSBMQUtfQVVUSF9NRVRIT0RfQ1VTVE9NKQoJCXJj
ID0gbGFrX2F1dGhfY3VzdG9tKGxhaywgdXNlciwgc2VydmljZSwgcmVhbG0sIHBhc3N3b3JkKTsK
CWVsc2UKCQlyYyA9IGxha19hdXRoX2Zhc3RiaW5kKGxhaywgdXNlciwgc2VydmljZSwgcmVhbG0s
IHBhc3N3b3JkKTsKCglyZXR1cm4gcmM7Cn0KCgpzdGF0aWMgaW50IGxha19yZXN1bHRfYWRkKExB
SyAqbGFrLCBjb25zdCBjaGFyICphdHRyLCBjb25zdCBjaGFyICp2YWwsIExBS19SRVNVTFQgKipy
ZXQpICAKewoJTEFLX1JFU1VMVCAqbHJlczsKCQoJbHJlcyA9IChMQUtfUkVTVUxUICopIG1hbGxv
YyhzaXplb2YoTEFLX1JFU1VMVCkpOwoJaWYgKGxyZXMgPT0gTlVMTCkgewoJCXJldHVybiBMQUtf
Tk9NRU07Cgl9CgoJbHJlcy0+bmV4dCA9IE5VTEw7CgoJbHJlcy0+YXR0cmlidXRlID0gc3RyZHVw
KGF0dHIpOwoJaWYgKGxyZXMtPmF0dHJpYnV0ZSA9PSBOVUxMKSB7CgkJbGFrX3Jlc3VsdF9mcmVl
KGxyZXMpOwoJCXJldHVybiBMQUtfTk9NRU07Cgl9CgoJbHJlcy0+dmFsdWUgPSBzdHJkdXAodmFs
KTsKCWlmIChscmVzLT52YWx1ZSA9PSBOVUxMKSB7CgkJbGFrX3Jlc3VsdF9mcmVlKGxyZXMpOwoJ
CXJldHVybiBMQUtfTk9NRU07Cgl9CglscmVzLT5sZW4gPSBzdHJsZW4obHJlcy0+dmFsdWUpOwoK
CWxyZXMtPm5leHQgPSAqcmV0OwoKCSpyZXQgPSBscmVzOwoJcmV0dXJuIExBS19PSzsKfQoKCnZv
aWQgbGFrX3Jlc3VsdF9mcmVlKExBS19SRVNVTFQgKnJlcykgCnsKCUxBS19SRVNVTFQgKmxyZXMs
ICpwdHIgPSByZXM7CgoJaWYgKHB0ciA9PSBOVUxMKQoJCXJldHVybjsKCglmb3IgKGxyZXMgPSBw
dHI7IGxyZXMgIT0gTlVMTDsgbHJlcyA9IHB0cikgewoKCQlwdHIgPSBscmVzLT5uZXh0OwoKCQlp
ZiAobHJlcy0+YXR0cmlidXRlICE9IE5VTEwpIHsKCQkJbWVtc2V0KGxyZXMtPmF0dHJpYnV0ZSwg
MCwgc3RybGVuKGxyZXMtPnZhbHVlKSk7CgkJCWZyZWUobHJlcy0+YXR0cmlidXRlKTsJCgkJfQoK
CQlpZiAobHJlcy0+dmFsdWUgIT0gTlVMTCkgewoJCQltZW1zZXQobHJlcy0+dmFsdWUsIDAsIHN0
cmxlbihscmVzLT52YWx1ZSkpOwoJCQlmcmVlKGxyZXMtPnZhbHVlKTsJCgkJfQoKCQlscmVzLT5u
ZXh0ID0gTlVMTDsKCgkJZnJlZShscmVzKTsKCX0KCglyZXR1cm47Cn0KCnN0YXRpYyBpbnQgbGFr
X2NoZWNrX3Bhc3N3b3JkKGNvbnN0IGNoYXIgKmhhc2gsIGNvbnN0IGNoYXIgKnBhc3N3ZCwgdm9p
ZCAqcm9jaykgCnsKCWludCBpLCBobGVuOwoJaW50IHJjOwoKCWlmIChoYXNoID09IE5VTEwgfHwg
aGFzaFswXSA9PSAnXDAnKSB7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWlmIChwYXNzd2QgPT0g
TlVMTCB8fCBwYXNzd2RbMF0gPT0gJ1wwJykgewoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglmb3Ig
KGkgPSAwOyBwYXNzd29yZF9zY2hlbWVbaV0uaGFzaCAhPSBOVUxMOyBpKyspIHsKCgkJaGxlbiA9
IHN0cmxlbihwYXNzd29yZF9zY2hlbWVbaV0uaGFzaCk7CgkJaWYgKCFzdHJuY2FzZWNtcChwYXNz
d29yZF9zY2hlbWVbaV0uaGFzaCwgaGFzaCwgaGxlbikpIHsKCQkJaWYgKHBhc3N3b3JkX3NjaGVt
ZVtpXS5jaGVjaykgewoJCQkJcmMgPSAocGFzc3dvcmRfc2NoZW1lW2ldLmNoZWNrKShoYXNoK2hs
ZW4sIHBhc3N3ZCwKCQkJCQkJCQlwYXNzd29yZF9zY2hlbWVbaV0ucm9jayk7CgkJCX0KCQkJcmV0
dXJuIHJjOwoJCX0KCX0KCglyZXR1cm4gc3RyY21wKGhhc2gsIHBhc3N3ZCkgPyBMQUtfRkFJTCA6
IExBS19PSzsKfQoKI2lmZGVmIEhBVkVfT1BFTlNTTAoKc3RhdGljIGludCBsYWtfYmFzZTY0X2Rl
Y29kZShjb25zdCBjaGFyICpzcmMsIGNoYXIgKipyZXQsIGludCAqcmxlbikgewoKCWludCByYywg
aSwgdGxlbiA9IDA7CgljaGFyICp0ZXh0OwoJRVZQX0VOQ09ERV9DVFggRVZQX2N0eDsKCgl0ZXh0
ID0gKGNoYXIgKiltYWxsb2MoKChzdHJsZW4oc3JjKSszKS80ICogMykgKyAxKTsKCWlmICh0ZXh0
ID09IE5VTEwpIHsKCQlyZXR1cm4gTEFLX05PTUVNOwoJfQoKCUVWUF9EZWNvZGVJbml0KCZFVlBf
Y3R4KTsKCXJjID0gRVZQX0RlY29kZVVwZGF0ZSgmRVZQX2N0eCwgdGV4dCwgJmksIChjaGFyICop
c3JjLCBzdHJsZW4oc3JjKSk7CglpZiAocmMgPCAwKSB7CgkJZnJlZSh0ZXh0KTsKCQlyZXR1cm4g
TEFLX0ZBSUw7Cgl9Cgl0bGVuICs9IGk7CglFVlBfRGVjb2RlRmluYWwoJkVWUF9jdHgsIHRleHQs
ICZpKTsgCgoJKnJldCA9IHRleHQ7CglpZiAocmxlbiAhPSBOVUxMKSB7CgkJKnJsZW4gPSB0bGVu
OwoJfQoKCXJldHVybiBMQUtfT0s7Cn0KCnN0YXRpYyBpbnQgbGFrX2NoZWNrX2hhc2hlZChjb25z
dCBjaGFyICpoYXNoLCBjb25zdCBjaGFyICpwYXNzd2QsIHZvaWQgKnJvY2spCnsKCWludCByYywg
Y2xlbjsKCXN0cnVjdCBoYXNoX3JvY2sgKmhyb2NrID0gKHN0cnVjdCBoYXNoX3JvY2sgKikgcm9j
azsKCUVWUF9NRF9DVFggbWRjdHg7Cgljb25zdCBFVlBfTUQgKm1kOwoJdW5zaWduZWQgY2hhciBk
aWdlc3RbRVZQX01BWF9NRF9TSVpFXTsKCWNoYXIgKmNyZWQ7CgoJbWQgPSBFVlBfZ2V0X2RpZ2Vz
dGJ5bmFtZShocm9jay0+bWRhKTsKCWlmICghbWQpIHsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJ
cmMgPSBsYWtfYmFzZTY0X2RlY29kZShoYXNoLCAmY3JlZCwgJmNsZW4pOwoJaWYgKHJjICE9IExB
S19PSykgewoJCXJldHVybiByYzsKCX0KCglFVlBfRGlnZXN0SW5pdCgmbWRjdHgsIG1kKTsKCUVW
UF9EaWdlc3RVcGRhdGUoJm1kY3R4LCBwYXNzd2QsIHN0cmxlbihwYXNzd2QpKTsKCWlmIChocm9j
ay0+c2FsdGVkKSB7CgkJRVZQX0RpZ2VzdFVwZGF0ZSgmbWRjdHgsICZjcmVkW0VWUF9NRF9zaXpl
KG1kKV0sCgkJCQkgY2xlbiAtIEVWUF9NRF9zaXplKG1kKSk7Cgl9CglFVlBfRGlnZXN0RmluYWwo
Jm1kY3R4LCBkaWdlc3QsIE5VTEwpOwoKCXJjID0gbWVtY21wKChjaGFyICopY3JlZCwgKGNoYXIg
KilkaWdlc3QsIEVWUF9NRF9zaXplKG1kKSk7CglmcmVlKGNyZWQpOwoJcmV0dXJuIHJjID8gTEFL
X0ZBSUwgOiBMQUtfT0s7Cn0KCiNlbmRpZiAvKiBIQVZFX09QRU5TU0wgKi8KCnN0YXRpYyBpbnQg
bGFrX2NoZWNrX2NyeXB0KGNvbnN0IGNoYXIgKmhhc2gsIGNvbnN0IGNoYXIgKnBhc3N3ZCwgdm9p
ZCAqcm9jaykgCnsKCWNoYXIgKmNyZWQ7CgoJaWYgKGhhc2ggPT0gTlVMTCB8fCBoYXNoWzBdID09
ICdcMCcpIHsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJaWYgKHBhc3N3ZCA9PSBOVUxMIHx8IHBh
c3N3ZFswXSA9PSAnXDAnKSB7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCWlmIChzdHJsZW4oaGFz
aCkgPCAyICkgewoJCXJldHVybiBMQUtfRkFJTDsKCX0KCgljcmVkID0gY3J5cHQocGFzc3dkLCBo
YXNoKTsKCWlmKCBjcmVkID09IE5VTEwgfHwgY3JlZFswXSA9PSAnXDAnICkgewoJCXJldHVybiBM
QUtfRkFJTDsKCX0KCglyZXR1cm4gc3RyY21wKGhhc2gsIGNyZWQpID8gTEFLX0ZBSUwgOiBMQUtf
T0s7Cn0KCiNlbmRpZiAvKiBBVVRIX0xEQVAgKi8K
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>130</attachid>
            <date>2003-02-27 16:30 EDT</date>
            <desc>lak.h</desc>
            <filename>lak.h</filename>
            <type>text/plain</type>
            <size>3044</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogQ09QWVJJR0hUCiAqIENvcHlyaWdodCAoYykgMjAwMi0yMDAyIElnb3IgQnJlemFjCiAqIEFs
bCByaWdodHMgcmVzZXJ2ZWQuCiAqCiAqIFJlZGlzdHJpYnV0aW9uIGFuZCB1c2UgaW4gc291cmNl
IGFuZCBiaW5hcnkgZm9ybXMsIHdpdGggb3Igd2l0aG91dAogKiBtb2RpZmljYXRpb24sIGFyZSBw
ZXJtaXR0ZWQgcHJvdmlkZWQgdGhhdCB0aGUgZm9sbG93aW5nIGNvbmRpdGlvbnMKICogYXJlIG1l
dDoKICogMS4gUmVkaXN0cmlidXRpb25zIG9mIHNvdXJjZSBjb2RlIG11c3QgcmV0YWluIHRoZSBh
Ym92ZSBjb3B5cmlnaHQKICogICAgbm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQg
dGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyLgogKiAyLiBSZWRpc3RyaWJ1dGlvbnMgaW4gYmluYXJ5
IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAogKiAgICBub3RpY2UsIHRo
aXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIgaW4gdGhl
CiAqICAgIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBwcm92aWRlZCB3aXRo
IHRoZSBkaXN0cmlidXRpb24uCiAqCiAqIFRISVMgU09GVFdBUkUgSVMgUFJPVklERUQgQlkgSUdP
UiBCUkVaQUMuIGBgQVMgSVMnJyBBTkQgQU5ZCiAqIEVYUFJFU1MgT1IgSU1QTElFRCBXQVJSQU5U
SUVTLCBJTkNMVURJTkcsIEJVVCBOT1QgTElNSVRFRCBUTywgVEhFCiAqIElNUExJRUQgV0FSUkFO
VElFUyBPRiBNRVJDSEFOVEFCSUxJVFkgQU5EIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUgogKiBQ
VVJQT1NFIEFSRSBESVNDTEFJTUVELiAgSU4gTk8gRVZFTlQgU0hBTEwgSUdPUiBCUkVaQUMgT1IK
ICogSVRTIEVNUExPWUVFUyBPUiBBR0VOVFMgQkUgTElBQkxFIEZPUiBBTlkgRElSRUNULCBJTkRJ
UkVDVCwKICogSU5DSURFTlRBTCwgU1BFQ0lBTCwgRVhFTVBMQVJZLCBPUiBDT05TRVFVRU5USUFM
IERBTUFHRVMgKElOQ0xVRElORywKICogQlVUIE5PVCBMSU1JVEVEIFRPLCBQUk9DVVJFTUVOVCBP
RiBTVUJTVElUVVRFIEdPT0RTIE9SIFNFUlZJQ0VTOyBMT1NTCiAqIE9GIFVTRSwgREFUQSwgT1Ig
UFJPRklUUzsgT1IgQlVTSU5FU1MgSU5URVJSVVBUSU9OKSBIT1dFVkVSIENBVVNFRCBBTkQKICog
T04gQU5ZIFRIRU9SWSBPRiBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQ09OVFJBQ1QsIFNUUklDVCBM
SUFCSUxJVFksIE9SCiAqIFRPUlQgKElOQ0xVRElORyBORUdMSUdFTkNFIE9SIE9USEVSV0lTRSkg
QVJJU0lORyBJTiBBTlkgV0FZIE9VVCBPRiBUSEUKICogVVNFIE9GIFRISVMgU09GVFdBUkUsIEVW
RU4gSUYgQURWSVNFRCBPRiBUSEUgUE9TU0lCSUxJVFkgT0YgU1VDSAogKiBEQU1BR0UuCiAqIEVO
RCBDT1BZUklHSFQgKi8KCiNpZm5kZWYgX0xBS19ICiNkZWZpbmUgX0xBS19ICgojaW5jbHVkZSA8
bGRhcC5oPgojaW5jbHVkZSA8bGJlci5oPgoKI2lmIFRJTUVfV0lUSF9TWVNfVElNRQojIGluY2x1
ZGUgPHN5cy90aW1lLmg+CiMgaW5jbHVkZSA8dGltZS5oPgojZWxzZQojIGlmIEhBVkVfU1lTX1RJ
TUVfSAojICBpbmNsdWRlIDxzeXMvdGltZS5oPgojIGVsc2UKIyAgaW5jbHVkZSA8dGltZS5oPgoj
IGVuZGlmCiNlbmRpZgoKI2RlZmluZSBMQUtfT0sgMAojZGVmaW5lIExBS19GQUlMIC0xCiNkZWZp
bmUgTEFLX05PRU5UIC0yCiNkZWZpbmUgTEFLX05PTUVNIC0zCgojZGVmaW5lIExBS19OT1RfQk9V
TkQgMAojZGVmaW5lIExBS19CSU5EX0FOT05ZTU9VUyAxCiNkZWZpbmUgTEFLX0JJTkRfQVNfVVNF
UiAyCgojZGVmaW5lIExBS19BVVRIX01FVEhPRF9CSU5EIDAKI2RlZmluZSBMQUtfQVVUSF9NRVRI
T0RfQ1VTVE9NIDEKI2RlZmluZSBMQUtfQVVUSF9NRVRIT0RfRkFTVEJJTkQgMgoKdHlwZWRlZiBz
dHJ1Y3QgbGFrX2NvbmYgewogICAgY2hhciAgICpwYXRoOwogICAgY2hhciAgICpzZXJ2ZXJzOwog
ICAgY2hhciAgICpiaW5kX2RuOwogICAgY2hhciAgICpiaW5kX3B3OwogICAgaW50ICAgICB2ZXJz
aW9uOwogICAgc3RydWN0ICB0aW1ldmFsIHRpbWVvdXQ7CiAgICBpbnQgICAgIHNpemVfbGltaXQ7
CiAgICBpbnQgICAgIHRpbWVfbGltaXQ7CiAgICBpbnQgICAgIGRlcmVmOwogICAgaW50ICAgICBy
ZWZlcnJhbHM7CiAgICBpbnQgICAgIHJlc3RhcnQ7CiAgICBpbnQgICAgIHNjb3BlOwogICAgY2hh
ciAgICpzZWFyY2hfYmFzZTsKICAgIGNoYXIgICAqZmlsdGVyOwogICAgY2hhciAgICpncm91cF9k
bjsKICAgIGNoYXIgICAqZ3JvdXBfYXR0cjsKICAgIGNoYXIgICAqcGFzc3dvcmRfYXR0cjsKICAg
IGNoYXIgICAgYXV0aF9tZXRob2Q7CiAgICBpbnQgICAgIHRsc19jaGVja19wZWVyOwogICAgY2hh
ciAgICp0bHNfY2FjZXJ0X2ZpbGU7CiAgICBjaGFyICAgKnRsc19jYWNlcnRfZGlyOwogICAgY2hh
ciAgICp0bHNfY2lwaGVyczsKICAgIGNoYXIgICAqdGxzX2NlcnQ7CiAgICBjaGFyICAgKnRsc19r
ZXk7CiAgICBpbnQgICAgIGRlYnVnOwp9IExBS19DT05GOwoKdHlwZWRlZiBzdHJ1Y3QgbGFrIHsK
ICAgIExEQVAgICAgICpsZDsKICAgIGNoYXIgICAgICBiaW5kX3N0YXR1czsKICAgIExBS19DT05G
ICpjb25mOwp9IExBSzsKCnR5cGVkZWYgc3RydWN0IGxha19yZXN1bHQgewogICAgY2hhciAgICAg
ICAgICAgICAgKmF0dHJpYnV0ZTsKICAgIGNoYXIgICAgICAgICAgICAgICp2YWx1ZTsKICAgIHNp
emVfdCAgICAgICAgICAgICBsZW47CiAgICBzdHJ1Y3QgbGFrX3Jlc3VsdCAqbmV4dDsKfSBMQUtf
UkVTVUxUOwoKaW50IGxha19pbml0KGNvbnN0IGNoYXIgKiwgTEFLICoqKTsKdm9pZCBsYWtfY2xv
c2UoTEFLICopOwppbnQgbGFrX2F1dGhlbnRpY2F0ZShMQUsgKiwgY29uc3QgY2hhciAqLCBjb25z
dCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKaW50IGxha19yZXRyaWV2ZShM
QUsgKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hh
ciAqKiwgTEFLX1JFU1VMVCAqKik7CnZvaWQgbGFrX3Jlc3VsdF9mcmVlKExBS19SRVNVTFQgKik7
CgojZW5kaWYgIC8qIF9MQUtfSCAqLwo=
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>131</attachid>
            <date>2003-02-27 16:30 EDT</date>
            <desc>LDAP_SASLAUTHD</desc>
            <filename>LDAP_SASLAUTHD</filename>
            <type>text/plain</type>
            <size>6174</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">YXV0aF9sZGFwIG1vZHVsZSBmb3Igc2FzbGF1dGhkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQoKU2FzbGF1dGhkIGNhbiB1c2UgYW4gTERBUCBkaXJlY3RvcnkgZm9yIGF1dGhlbnRpY2F0
aW9uL2F1dGhvcml6YXRpb24uCgpTZWN0aW9uczoKMS4gQnVpbGQgc2FzbGF1dGhkIHdpdGggbGRh
cCBzdXBwb3J0CjIuIFN0YXJ0IHNhc2xhdXRoZCB3aXRoIGxkYXAKMy4gVGVzdGluZwo0LiBQYXJh
bWV0ZXJzCjUuIEV4YW1wbGVzCjYuIE5vdGVzCjcuIFRvZG8KOC4gRmVlZGJhY2sKOC4gQXV0aG9y
CgoKMS4gQlVJTEQgU0FTTEFVVEhEIFdJVEggTERBUCBTVVBQT1JUCi0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQoKRW5zdXJlIHRoYXQgeW91IGhhdmUgdGhlIE9wZW5MREFQICho
dHRwOi8vd3d3Lm9wZW5sZGFwLm9yZykgbGlicmFyaWVzIDIuMCBvcgpoaWdoZXIuICBGZXRjaCB0
aGUgbGF0ZXN0IGN5cnVzLXNhc2wgcGFja2FnZSwgMi4xLjYgb3IgaGlnaGVyLApmdHA6Ly9mdHAu
YW5kcmV3LmNtdS5lZHUvcHViL2N5cnVzLW1haWwvLgoKVW5wYWNrIGN5cnVzLXNhc2w6Cmd6aXAg
LWRjIGN5cnVzLXNhc2wtMi4xLjYudGFyLmd6IHwgdGFyIHhmIC0Kb3IKdGFyIHp4ZiBjeXJ1cy1z
YXNsLTIuMS42LnRhci5neiAoaWYgeW91ciB0YXIgc3VwcG9ydHogZ3ppcCkKCmNkIGN5cnVzLXNh
c2wtMi4xLjYKLi9jb25maWd1cmUgLS13aXRoLWxkYXAgICh5b3UgbWF5IG5lZWQgdG8gYWRkIG90
aGVyIG9wdGlvbnMsIGNoZWNrIGRvYy9pbmRleC5odG1sIGZvciBtb3JlKQptYWtlCm1ha2UgaW5z
dGFsbAoKCjIuIFNUQVJUIFNBU0xBVVRIRCBXSVRIIExEQVAKLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQoKQ3JlYXRlIC91c3IvbG9jYWwvZXRjL3Nhc2xhdXRoZC5jb25mIGFuZCBhZGQgdGhl
IGZvbGxvd2luZyAobW9kaWZ5IHRvIGZpdCB5b3VyCmVudmlyb25tZW50KToKbGRhcF9zZXJ2ZXJz
OiBsZGFwOi8vMTAuMS4xLjE1LyBsZGFwOi8vMTAuMS4xLjI1LwpsZGFwX2JpbmRfZG46IGNuPW9w
ZXJhdG9yLG91PVByb2ZpbGUsbz1mb28uY29tCmxkYXBfYmluZF9wdzogc2VjcmV0CgpEbyBub3Qg
c3BlY2lmeSBsZGFwX2JpbmRfKiBpZiB5b3Ugd2FudCB0byBiaW5kIGFub255bW91c2x5IHRvIHlv
dXIgbGRhcCBzZXJ2ZXIocykuIAoKUnVuIHNhc2xhdXRoZDoKc2FzbGF1dGhkIC1hIGxkYXAKCklm
IHlvdSB3YW50IHRvIHNwZWNpZnkgYSBkaWZmZXJlbnQgY29uZmlndXJhdGlvbiBmaWxlLCB5b3Ug
Y2FuIGRvIHNvbWV0aGluZwpsaWtlOgpzYXNsYXV0aGQgLWEgbGRhcCAtTyAvZXRjL3Nhc2xhdXRo
ZC5jb25mCgpGb3IgbW9yZSwgY2hlY2sgJ21hbiBzYXNsYXV0aGQnCgoKMy4gVEVTVElORwotLS0t
LS0tLS0tCgpGaXJzdCBidWlsZCB0ZXN0c2FzbGF1dGhkOgpjZCAkc2FzbF9zcmMvc2FzbGF1dGhk
Cm1ha2UgdGVzdHNhc2xhdXRoZAoKUnVuIHRlc3QgdXRpbGl0eToKLi90ZXN0c2FzbGF1dGhkIC11
IGlnb3IgLXAgc2VjcmV0CjA6IE9LICJTdWNjZXNzLiIKCklmIHlvdSBnZXQgb3V0cHV0IG90aGVy
IHRoZW4gU3VjY2VzcywgY2hlY2sgdGhlIGF1dGguKiBzeXNsb2cgZmFjaWxpdHkuCkhvcGVmdWxs
eSB0aGlzIHdpbGwgZ2l2ZSB5b3UgZW5vdWdoIGluZm9ybWF0aW9uIHRvIG1ha2UgYWRqdXN0ZW1l
bnRzIGluIHRoZQpzdGFydHVwIGFuZC9vciBjb25maWd1cmF0aW9uIGZpbGVzLiAgCgoKNC4gUEFS
QU1FVEVSUwotLS0tLS0tLS0tLS0tCgpUaGUgZm9sbG93aW5nIGFyZSBhdmFpbGFibGUgbGRhcCBw
YXJhbWV0ZXJzLiAgVGhlcmUgYXJlIHF1aXRlIGEgZmV3IG9mIHRob3NlLApidXQgb25seSBsZGFw
X3NlcnZlcnMgbWF5IG5lZWQgdG8gYmUgc3BlY2lmaWVkLiBUaGUgZGVmYXVsdHMgZm9yIGFsbCBv
dGhlcgpwYXJhbWV0ZXJzIGFyZSBhZGVxdWF0ZSBmb3IgbW9zdCBpbnN0YWxsYXRpb25zLiAgCgpE
byBub3QgdXNlIHF1b3RlcyAoXCJcJykgaW4gdGhlIHBhcmFtZXRlciB2YWx1ZXMuICBUaGUgZGVm
YXVsdHMgYXJlIHNwZWNpZmllZAp3aXRoaW4gdGhlIGZpcnN0IHNldCBvZiA8Pi4gIFRoZXJlIG1h
eSBiZSBhIHNlY29uZCBzZXQgb2YgPD4gd2hpY2ggcHJvdmlkZQphdmFpbGFibGUgdmFsdWVzLgoK
bGRhcF9zZXJ2ZXJzOiA8bGRhcDovL2xvY2FsaG9zdC8+CglTcGVjaWZ5IFVSSShzKSByZWZlcmlu
ZyB0byBMREFQIHNlcnZlcihzKSwgZS5nLiBsZGFwczovLzEwLjEuMS4yOjk5OS8uCglZb3UgY2Fu
IHNwZWNpZnkgbXVsdGlwbGUgc2VydmVycyBzZXBhcmF0ZWQgYnkgYSBzcGFjZS4KCmxkYXBfYmlu
ZF9kbjogPG5vbmU+CglTcGVjaWZ5IEROIChkaXN0aW5ndWlzaGVkIG5hbWUpIHRvIGJpbmQgdG8g
dGhlIExEQVAgZGlyZWN0b3J5LiAgRG8gbm90CglzcGVjaWZ5IHRoaXMgcGFyYW1ldGVyIGZvciB0
aGUgYW5vbnltb3VzIGJpbmQuCgpsZGFwX2JpbmRfcHc6IDxub25lPgoJU3BlY2lmeSB0aGUgcGFz
c3dvcmQgZm9yIGxkYXBfYmluZF9kbi4gIERvIG5vdCBzcGVjaWZ5IHRoaXMgcGFyYW1ldGVyCglm
b3IgdGhlIGFub255bW91cyBiaW5kLgoKbGRhcF92ZXJzaW9uOiA8Mz4gPDJ8Mz4KCVNwZWNpZnkg
dGhlIExEQVAgcHJvdG9jb2wgdmVyc2lvbiB0byB1c2UuCgpsZGFwX3RpbWVvdXQ6IDw1PgoJU3Bl
Y2lmeSBhIG51bWJlciBvZiBzZWNvbmRzIGEgc2VhcmNoIGNhbiB0YWtlIGJlZm9yZSB0aW1pbmcg
b3V0LgoKbGRhcF90aW1lX2xpbWl0OiA8NT4KCVNwZWNpZnkgYSBudW1iZXIgb2Ygc2Vjb25kcyBm
b3IgYSBzZWFyY2ggcmVxdWVzdCB0byBjb21wbGV0ZS4KCmxkYXBfZGVyZWY6IDxub25lPiA8c2Vh
cmNofGZpbmR8YWx3YXlzfG5ldmVyPgoJU3BlY2lmeSBob3cgYWxpYXNlcyBkZXJlZmVyZW5jaW5n
IGlzIGhhbmRsZWQgZHVyaW5nIGEgc2VhcmNoLgoKbGRhcF9yZWZlcnJhbHM6IDxubz4KCVNwZWNp
Znkgd2hldGhlciBvciBub3QgdGhlIGNsaWVudCBzaG91bGQgZm9sbG93IHJlZmVycmFscy4KCmxk
YXBfcmVzdGFydDogPHllcz4KCVNwZWNpZnkgd2hldGhlciBvciBub3QgTERBUCBJL08gb3BlcmF0
aW9ucyBhcmUgYXV0b21hdGljYWxseSByZXN0YXJ0ZWQKCWlmIHRoZXkgYWJvcnQgcHJlbWF0dXJl
bHkuCgpsZGFwX3Njb3BlOiA8c3ViPiA8c3VifG9uZXxiYXNlPgoJU2VhcmNoIHNjb3BlLgoKbGRh
cF9zZWFyY2hfYmFzZTogPG5vbmU+CglTcGVjaWZ5IGEgc3RhcnRpbmcgcG9pbnQgZm9yIHRoZSBz
ZWFyY2guICBlLmcuIGRjPWZvbyxkYz1jb20KCmxkYXBfYXV0aF9tZXRob2Q6IDxiaW5kPiA8Ymlu
ZHxjdXN0b218ZmFzdGJpbmQ+CglTcGVjaWZ5IGFuIGF1dGhlbnRpY2F0aW9uIG1ldGhvZC4KCglU
aGUgYmluZCBtZXRob2QgdXNlcyB0aGUgTERBUCBzaW1wbGUgYmluZCBmYWNpbGl0eSB0byB2ZXJp
ZnkgdGhlCglwYXNzd29yZC4gIFRoaXMgaXMgdGhlIGRlZmF1bHQuCgoJVGhlIGN1c3RvbSBtZXRo
b2QgdXNlcyB1c2VyUGFzc3dvcmQgYXR0cmlidXRlIHRvIHZlcmlmeSB0aGUgcGFzc3dvcmQuICAK
CUN1cnJlbnRseSwge0NSWVBUfSBoYXNoIGlzIHN1cHBvcnRlZC4KCglUaGUgZmFzdGJpbmQgbWV0
aG9kIGRvZXMgYXdheSB3aXRoIHRoZSBzZWFyY2ggYW5kIGV4dHJhIGFub255bW91cyBiaW5kCglp
biBhdXRoX2JpbmQsIGJ1dCBtYWtlcyB0d28gYXNzdW1wdGlvbnM6CgkgIDEuIEV4cGFuZGluZyB0
aGUgbGRhcF9maWx0ZXIgZXhwcmVzc2lvbiBnaXZlcyB0aGUgZnVsbHktcXVhbGlmaWVkIEROCgkg
IDIuIFRoZXJlIGlzIG5vIGNvc3QgdG8gc3RheWluZyBib3VuZCBhcyBhIG5hbWVkIHVzZXIKCmxk
YXBfZmlsdGVyOiA8dWlkPSV1PgoJU3BlY2lmeSBhIGZpbHRlci4gIFVzZSB0aGUgJXUgYW5kICVy
IHRva2VucyBmb3IgdGhlIHVzZXJuYW1lIGFuZCByZWFsbQoJc3Vic3RpdHV0aW9uLiAgVGhlICV1
IHRva2VuIGhhcyB0byBiZSB1c2VkIGF0IG1pbmltdW0gZm9yIHRoZSBmaWx0ZXIgdG8KCWJlIHVz
ZWZ1bC4gIElmIGxkYXBfYXV0aF9tZXRob2QgaXMgJ2JpbmQnLCB0aGUgZmlsdGVyIHdpbGwgc2Vh
cmNoIGZvcgoJdGhlIEROIChkaXN0aW5ndWlzaGVkIG5hbWUpIGF0dHJpYnV0ZS4gIE90aGVyd2lz
ZSwgdGhlIHNlYXJjaCB3aWxsIGxvb2sKCWZvciB0aGUgdXNlclBhc3N3b3JkIGF0dHJpYnV0ZS4K
CmxkYXBfZGVidWc6IDwwPgoJU3BlY2lmeSBhIGRlYnVnZ2luZyBsZXZlbCBpbiB0aGUgT3BlbkxE
QVAgbGlicmFyaWVzLiAgU2VlCglsZGFwX3NldF9vcHRpb24oMykgZm9yIG1vcmUgKExEQVBfT1BU
X0RFQlVHX0xFVkVMKS4KCmxkYXBfdGxzX2NoZWNrX3BlZXI6IDxubz4gPHllc3xubz4KCVJlcXVp
cmUgYW5kIHZlcmlmeSBzZXJ2ZXIgY2VydGlmaWNhdGUuICBJZiB0aGlzIG9wdGlvbiBpcyB5ZXMs
Cgl5b3UgbXVzdCBzcGVjaWZ5IGxkYXBfdGxzX2NhY2VydF9maWxlIG9yIGxkYXBfdGxzX2NhY2Vy
dF9kaXIuCgpsZGFwX3Rsc19jYWNlcnRfZmlsZTogPG5vbmU+CglGaWxlIGNvbnRhaW5pbmcgQ0Eg
KENlcnRpZmljYXRlIEF1dGhvcml0eSkgY2VydGlmaWNhdGUocykuCgpsZGFwX3Rsc19jYWNlcnRf
ZGlyOiA8bm9uZT4KCVBhdGggdG8gZGlyZWN0b3J5IHdpdGggQ0EgKENlcnRpZmljYXRlIEF1dGhv
cml0eSkgY2VydGlmaWNhdGVzLgoKbGRhcF90bHNfY2lwaGVyczogPERFRkFVTFQ+CglMaXN0IG9m
IFNTTC9UTFMgY2lwaGVycyB0byBhbGxvdy4gIFRoZSBmb3JtYXQgb2YgdGhlIHN0cmluZyBpcwoJ
ZGVzY3JpYmVkIGluIGNpcGhlcnMoMSkuCgpsZGFwX3Rsc19jZXJ0OiA8bm9uZT4KCUZpbGUgY29u
dGFpbmluZyB0aGUgY2xpZW50IGNlcnRpZmljYXRlLgoKbGRhcF90bHNfa2V5OiA8bm9uZT4KCUZp
bGUgY29udGFpbmluZyB0aGUgcHJpdmF0ZSBjbGllbnQga2V5LgoKCjUuIE5PVEVTCi0tLS0tLS0t
CgpGb3IgYmV0dGVyIHBlcmZvcm1hbmNlIGVuc3VyZSB0aGF0IHRoZSBhdHRyaWJ1dGVzIHNwZWNp
ZmllZCBpbiBsZGFwX2ZpbHRlciBhcmUKaW5kZXhlZC4gIAoKTXkgdGVzdGluZyBzaG93cyB0aGF0
ICdjdXN0b20nIGlzIDItMyB0aW1lcyBmYXN0ZXIgdGhhbiAnYmluZCcKbGRhcF9hdXRoX21ldGhv
ZC4gIFRoaXMgaXMgYmVjYXVzZSBvZiB0d28gZXh0cmEgbGRhcCBiaW5kcy9zZWFyY2hlcyBwZXJm
b3JtZWQKZHVyaW5nIHRoZSAnYmluZCcgYXV0aGVudGljYXRpb24gbWV0aG9kLiAgT24gdGhlIG90
aGVyIGhhbmQsIHRoZSAnYmluZCcKYXV0aGVudGljYXRpb24gbWV0aG9kIGlzIG1vcmUgc2VjdXJl
IGJlY2F1c2UgbGRhcF9iaW5kX3B3IGlzIG5vdCBleHBvc2VkLiAKCjYuIFRPRE8KLS0tLS0tLQoK
LSBQb3J0IHRvIG90aGVyIGxkYXAgbGlicmFyaWVzCi0gVGhlcmUgbWF5IGJlIGJpbmQgcHJvYmxl
bXMgd2hlbiBmb2xsb3dpbmcgcmVmZXJyYWxzLiAgTm9ybWFsbHkgdGhpcyBpcyBub3QgYW4KICBp
c3N1ZS4gIEZpeC4KLSBBbGxvdyB0byBzcGVjaWZ5IGFuIGF0dHJpYnV0ZSBvdGhlciB0aGFuIHVz
ZXJQYXNzd29yZCBmb3IgdXNlIGluIHRoZSBjdXN0b20KICBhdXRoZW50aWNhdGlvbiBtZXRob2Qu
IChkb25lIC0gc2VlIGxkYXBfcGFzc3dvcmRfYXR0cikKLSBBZGQgbW9yZSBwYXNzd29yZCBoYXNo
ZXMgc3VjaCBhcyBtZDUsIHNoYSBldGMgKGRvbmUpCi0gTWFrZSBhIHN1Z2dlc3Rpb24gKHBvc3Np
Ymx5IGFub3RoZXIgYXV0aGVudGljYXRpb24gbWV0aG9kPykgKGFkZGVkCiAgbGRhcF9hdXRoX2Zh
c3RiaW5kIG1ldGhvZCAtIFNpbW9uIEJyYWR5IDxzaW1vbi5icmFkeUBvdGFnby5hYy5uej4pCgoK
Ny4gRkVFREJBQ0sKLS0tLS0tLS0tLS0KCkZlZWRiYWNrIGlzIG11Y2ggYXBwcmVjaWF0ZWQhICBQ
bGVhc2UgZHJvcCBtZSBhIG5vdGUgaWYgeW91IGFyZSBzdWNjZXNzZnVsbHkKdXNpbmcgbGRhcC1l
bmFibGVkIHNhc2xhdXRoZC4gIEFueSBjb2RlIGltcHJvdmVtZW50cyBhbmQvb3Igc3VnZ2VzdGlv
biBhcmUgd2VsY29tZS4KCklmIHlvdSBoYXZlIHF1ZXN0aW9ucywgc2VuZCBlbWFpbCB0byBjeXJ1
cy1zYXNsQGxpc3RzLmFuZHJldy5jbXUuZWR1LiAgUGxlYXNlCmluY2x1ZGUgcmVsZXZhbnQgaW5m
b3JtYXRpb24gYWJvdXQgeW91ciBzYXNsYXV0aGQgc2V0dXA6IGF0IG1pbmltdW0gcHJvdmlkZQp5
b3VyIHNhc2xhdXRoLmNvbmYsIG91dHB1dCBmcm9tIHN5c2xvZyBhbmQgd2hpY2ggZGlyZWN0b3J5
IHNlcnZlciB5b3UncmUgdXNpbmcuCgoKOC4gQVVUSE9SCi0tLS0tLS0tLQoKSWdvciBCcmV6YWMg
PGlnb3JAaXBhc3MubmV0Pi4K
</data>        

          </attachment>
      

    </bug>

</bugzilla>