<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>2750</bug_id>
          
          <creation_ts>2005-11-03 11:09 EDT</creation_ts>
          <short_desc>Ability to hide real userids in &quot;Other Users&quot; namespace</short_desc>
          <delta_ts>2005-12-30 07:33:24 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>IMAP</component>
          <version>2.2.x</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>NEW</bug_status>
          
          
          
          
          
          <priority>P2</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>Future</target_milestone>
          <dependson>2749</dependson>
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Alexander Drozdov">dzal_mail@mtu-net.ru</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          <cc>kvk@elbrus.ru</cc>
    
    <cc>sorcerer@elbrus.ru</cc>
          <qa_contact name="The Cyrus Bugzilla List">cyrus-bugzilla@lists.andrew.cmu.edu</qa_contact>

      

      

      
          <long_desc isprivate="0">
            <who name="Alexander Drozdov">dzal_mail@mtu-net.ru</who>
            <bug_when>2005-11-03 11:09:04 EDT</bug_when>
            <thetext>My current (non-tested) patch adds ability to the server to hide real userids in
&quot;Other Users&quot; namespace. Instead, the server shows usernames which are fetched
from LDAP. You must have libredblack library to compile the server
(http://sourceforge.net/projects/libredblack). I am also using charset encoding
functions which was taken from PHP. The patch depends on my patch from bugreport
2749.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Alexander Drozdov">dzal_mail@mtu-net.ru</who>
            <bug_when>2005-11-03 11:10:26 EDT</bug_when>
            <thetext>Created an attachment (id=392)
A patch
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Alexander Drozdov">dzal_mail@mtu-net.ru</who>
            <bug_when>2005-11-15 04:16:20 EDT</bug_when>
            <thetext>Created an attachment (id=399)
Update

This is update of the previous patch. Some bugs are fixed, documentation on the
new config options is added.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Alexander Drozdov">dzal_mail@mtu-net.ru</who>
            <bug_when>2005-11-24 08:34:03 EDT</bug_when>
            <thetext>Created an attachment (id=400)
Update

Some functionality was changed/added, documentation was updated. Main changes:
1. Now it is possible to return an internal userid if LDAP server has no
information about that identifier or if LDAP server is not accessible;
2. Significally increased speed of processing IMAP queries if there are many
users registered on the IMAP server (see changes in imap/mboxlist.c:find_p() ).</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Alexander Drozdov">dzal_mail@mtu-net.ru</who>
            <bug_when>2005-12-08 11:49:51 EDT</bug_when>
            <thetext>Created an attachment (id=402)
Update

Some bugs is fixed, documentation is updated. New imapd.conf options is added.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Alexander Drozdov">dzal_mail@mtu-net.ru</who>
            <bug_when>2005-12-30 07:33:24 EDT</bug_when>
            <thetext>Created an attachment (id=409)
Update

Changes:
1. Added virtdomains support (see convertuserid_ldap_attr_domain and
convertuserid_ldap_query_domains config options);
2. Added local cache of queried names (see convertuserid_cache_db and
convertuserid_actual_timeout config options);
3. Minor fixes.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>392</attachid>
            <date>2005-11-03 11:10 EDT</date>
            <desc>A patch</desc>
            <filename>cur.diff</filename>
            <type>text/plain</type>
            <size>74808</size>
            <attacher>dzal_mail@mtu-net.ru</attacher>
            
              <data encoding="base64">ZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvY29uZmlnLmguaW4gY3lydXMt
aW1hcGQtMi4yLjEyL2NvbmZpZy5oLmluCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2NvbmZp
Zy5oLmluCTIwMDUtMDItMTQgMjA6NTk6NDEgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9j
b25maWcuaC5pbgkyMDA1LTExLTAzIDE3OjUzOjA2ICswMzAwCioqKioqKioqKioqKioqKgoqKiog
NjQsNjkgKioqKgotLS0gNjQsNzIgLS0tLQogIC8qIERvIHdlIGhhdmUgYSBkZWNlbnQgcmVnZXgg
bGlicmFyeT8gKi8KICAjdW5kZWYgRU5BQkxFX1JFR0VYCiAgCisgLyogRW5hYmxlIGNvbnZlcnRp
bmcgdXNlcmlkcyB2aWEgTERBUCBzdXBwb3J0PyAqLworICN1bmRlZiBFTkFCTEVfQ09OVkVSVF9V
U0VSSUQKKyAKICAvKiBFbmFibGUgTmV0c2NhcGUgTWVudSBPcHRpb24gSGFjaz8gKi8KICAjdW5k
ZWYgRU5BQkxFX1hfTkVUU0NBUEVfSEFDSwogIApkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQt
Mi4yLjEyLm9sZC9jb25maWd1cmUgY3lydXMtaW1hcGQtMi4yLjEyL2NvbmZpZ3VyZQoqKiogY3ly
dXMtaW1hcGQtMi4yLjEyLm9sZC9jb25maWd1cmUJMjAwNS0wMi0xNCAyMDo1OTo0NiArMDMwMAot
LS0gY3lydXMtaW1hcGQtMi4yLjEyL2NvbmZpZ3VyZQkyMDA1LTExLTAzIDE3OjUzOjA3ICswMzAw
CioqKioqKioqKioqKioqKgoqKiogODUyLDg1NyAqKioqCi0tLSA4NTIsODU4IC0tLS0KICAgIC0t
ZW5hYmxlLWNtdWxvY2FsICAgICAgIGVuYWJsZSBDTVUtc3BlY2lmaWMgbG9jYWwgc3VwcG9ydAog
ICAgLS1lbmFibGUtb2xkc2lldmVuYW1lICAgZW5hYmxlIHRoZSB1c2Ugb2YgJ2ltYXAnIGFzIHRo
ZSBzaWV2ZSBzZXJ2aWNlIG5hbWUKICAgIC0tZW5hYmxlLWxpc3RleHQgICAgICAgIGVuYWJsZSBJ
TUFQIExpc3QgZXh0ZW5zaW9ucworICAgLS1lbmFibGUtY29udmVydHVzZXJpZCAgZW5hYmxlIGNv
bnZlcnRpbmcgdXNlcmlkcyB2aWEgTERBUCBzdXBwb3J0CiAgICAtLWVuYWJsZS1uZXRzY2FwZWhh
Y2sgICBlbmFibGUgTmV0c2NhcGUgaGFjayBmb3IgdGhlIG1lbnUgb3B0aW9uCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpbiBDb21tdW5pY2F0b3IgdG8gQWRtaW5pc3RyYXRlIE1haWwKICAg
IC0tZW5hYmxlLWdzc2FwaT08RElSPiAgIGVuYWJsZSBHU1NBUEkgYXV0aGVudGljYXRpb24geWVz
CioqKioqKioqKioqKioqKgoqKiogMTExODAsMTExODUgKioqKgotLS0gMTExODEsMTExOTggLS0t
LQogIAlmaQogIGZpOwogIAorICMgQ2hlY2sgd2hldGhlciAtLWVuYWJsZS1jb252ZXJ0dXNlcmlk
IG9yIC0tZGlzYWJsZS1jb252ZXJ0dXNlcmlkIHdhcyBnaXZlbi4KKyBpZiB0ZXN0ICIke2VuYWJs
ZV9jb252ZXJ0dXNlcmlkK3NldH0iID0gc2V0OyB0aGVuCisgICBlbmFibGV2YWw9IiRlbmFibGVf
Y29udmVydHVzZXJpZCIKKyAgIGlmIHRlc3QgIiRlbmFibGV2YWwiID0geWVzOyB0aGVuCisgCisg
Y2F0ID4+Y29uZmRlZnMuaCA8PFxfQUNFT0YKKyAjZGVmaW5lIEVOQUJMRV9DT05WRVJUX1VTRVJJ
RAorIF9BQ0VPRgorIAlJTUFQX1BST0dTPSIkSU1BUF9QUk9HUyBsZGFwZCIKKyAJZmkKKyBmaTsK
KyAKICAjIENoZWNrIHdoZXRoZXIgLS1lbmFibGUtbmV0c2NhcGVoYWNrIG9yIC0tZGlzYWJsZS1u
ZXRzY2FwZWhhY2sgd2FzIGdpdmVuLgogIGlmIHRlc3QgIiR7ZW5hYmxlX25ldHNjYXBlaGFjaytz
ZXR9IiA9IHNldDsgdGhlbgogICAgZW5hYmxldmFsPSIkZW5hYmxlX25ldHNjYXBlaGFjayIKZGlm
ZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvY29uZmlndXJlLmluIGN5cnVzLWlt
YXBkLTIuMi4xMi9jb25maWd1cmUuaW4KKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvY29uZmln
dXJlLmluCTIwMDUtMDEtMTkgMDI6NDY6MDAgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9j
b25maWd1cmUuaW4JMjAwNS0xMS0wMyAxNzo1MzowNyArMDMwMAoqKioqKioqKioqKioqKioKKioq
IDkxNyw5MjIgKioqKgotLS0gOTE3LDkyOSAtLS0tCiAgCQlBQ19ERUZJTkUoRU5BQkxFX0xJU1RF
WFQsW10sW0VuYWJsZSB0aGUgTElTVEVYVCBleHRlbnNpb24/XSkKICAJZmkpCiAgCisgQUNfQVJH
X0VOQUJMRShjb252ZXJ0dXNlcmlkLAorIAlbICAtLWVuYWJsZS1jb252ZXJ0dXNlcmlkICBlbmFi
bGUgY29udmVydGluZyB1c2VyaWRzIHZpYSBMREFQIHN1cHBvcnRdLAorIAlpZiB0ZXN0ICIkZW5h
YmxldmFsIiA9IHllczsgdGhlbgorIAkJQUNfREVGSU5FKEVOQUJMRV9DT05WRVJUX1VTRVJJRCxb
XSxbRW5hYmxlIGNvbnZlcnRpbmcgdXNlcmlkcyB2aWEgTERBUCBzdXBwb3J0P10pCisgCQlJTUFQ
X1BST0dTPSIkSU1BUF9QUk9HUyBsZGFwZCIKKyAJZmkpCisgCiAgQUNfQVJHX0VOQUJMRShuZXRz
Y2FwZWhhY2ssCiAgCVsgIC0tZW5hYmxlLW5ldHNjYXBlaGFjayAgIGVuYWJsZSBOZXRzY2FwZSBo
YWNrIGZvciB0aGUgbWVudSBvcHRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIENv
bW11bmljYXRvciB0byBBZG1pbmlzdHJhdGUgTWFpbF0sCmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1p
bWFwZC0yLjIuMTIub2xkL2ltYXAvY2hhcnNldF9jb252ZXJ0LmMgY3lydXMtaW1hcGQtMi4yLjEy
L2ltYXAvY2hhcnNldF9jb252ZXJ0LmMKKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9j
aGFyc2V0X2NvbnZlcnQuYwkxOTcwLTAxLTAxIDAzOjAwOjAwICswMzAwCi0tLSBjeXJ1cy1pbWFw
ZC0yLjIuMTIvaW1hcC9jaGFyc2V0X2NvbnZlcnQuYwkyMDA1LTExLTAzIDE3OjUzOjQwICswMzAw
CioqKioqKioqKioqKioqKgoqKiogMCAqKioqCi0tLSAxLDU0NCAtLS0tCisgI2luY2x1ZGUgPHN0
ZGxpYi5oPgorIAorICNpbmNsdWRlICJjaGFyc2V0X2NvbnZlcnQuaCIKKyAKKyAvKiBobW0uLi4g
bWF5YmUgMHg3RkZGRkZGRlUgPyAqLworICNkZWZpbmUgVUNTNE1BWCAweDcwMDAwMDAwVQorIAor
ICNkZWZpbmUgVUNTMk1BWCAweDAwMDEwMDAwVQorICNkZWZpbmUgU1VQTUlOICAweDAwMDEwMDAw
VQorICNkZWZpbmUgU1VQTUFYICAweDAwMjAwMDAwVQorIAorICNkZWZpbmUgTUFTSyAgICAweGZm
ZmZmZlUKKyAjZGVmaW5lIFRIUk9VR0ggMHg3ODAwMDAwMFUgICAgICAgICAgICAgIC8qIDAwMDAw
MGggLSBGRkZGRkZoICovCisgCisgdHlwZWRlZiB1bnNpZ25lZCBpbnQgdWludDsKKyAKKyB0eXBl
ZGVmIHN0cnVjdCBfY29udmVydF9zdGF0ZSB7CisgICAgIGludCBjYWNoZTsKKyAgICAgaW50IHN0
YXR1czsKKyB9IGNvbnZlcnRfc3RhdGU7CisgCisgdHlwZWRlZiBpbnQgKCpjb252ZXJ0ZWRfb3V0
X2NiX3QpKHVpbnQgYywgdm9pZCAqKTsKKyB0eXBlZGVmIGludCAoKmNvbnZlcnRfY2JfdCkodWlu
dCBjLCBjb252ZXJ0X3N0YXRlICosIGNvbnZlcnRlZF9vdXRfY2JfdCwgdm9pZCAqKTsKKyB0eXBl
ZGVmIGludCAoKmZsdXNoX2NiX3QpKGNvbnZlcnRfc3RhdGUgKiwgY29udmVydGVkX291dF9jYl90
LCB2b2lkICopOworIAorICNkZWZpbmUgQ0soc3RhdGVtZW50KQlkbyB7IGlmICgoc3RhdGVtZW50
KSkgcmV0dXJuICgtMSk7IH0gd2hpbGUgKDApCisgCisgc3RhdGljIGludCB1dGY4X2VuY29kZSh1
aW50IGMsIGNvbnZlcnRfc3RhdGUgKmZpbHRlciwgY29udmVydGVkX291dF9jYl90IG91dF9jYiwg
dm9pZCAqb3V0X2NiX3BhcmFtKQorIHsKKyAgICAgLyogc2tpcCB3cm9uZyBzeW1ib2xzICovCisg
ICAgIGlmIChjID4gVUNTNE1BWCkKKyAJcmV0dXJuIDA7CisgICAgIAorICAgICBpZiAoYyA8IDB4
ODApIHsKKyAJQ0sob3V0X2NiKGMsIG91dF9jYl9wYXJhbSkpOworICAgICB9IGVsc2UgaWYgKGMg
PCAweDgwMCkgeworIAlDSyhvdXRfY2IoKChjID4+IDYpICYgMHgxZikgfCAweGMwLCBvdXRfY2Jf
cGFyYW0pKTsKKyAJQ0sob3V0X2NiKChjICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsK
KyAgICAgfSBlbHNlIGlmIChjIDwgMHgxMDAwMCkgeworIAlDSyhvdXRfY2IoKChjID4+IDEyKSAm
IDB4MGYpIHwgMHhlMCwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigoKGMgPj4gNikgJiAw
eDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoKGMgJiAweDNmKSB8IDB4
ODAsIG91dF9jYl9wYXJhbSkpOworICAgICB9IGVsc2UgaWYgKGMgPCAweDIwMDAwMCkgeworIAlD
SyhvdXRfY2IoKChjID4+IDE4KSAmIDB4MDcpIHwgMHhmMCwgb3V0X2NiX3BhcmFtKSk7CisgCUNL
KG91dF9jYigoKGMgPj4gMTIpICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0so
b3V0X2NiKCgoYyA+PiA2KSAmIDB4M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91
dF9jYigoYyAmIDB4M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisgICAgIH0gZWxzZSBpZiAo
YyA8IDB4NDAwMDAwMCkgeworIAlDSyhvdXRfY2IoKChjID4+IDI0KSAmIDB4MDMpIHwgMHhmOCwg
b3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigoKGMgPj4gMTgpICYgMHgzZikgfCAweDgwLCBv
dXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKCgoYyA+PiAxMikgJiAweDNmKSB8IDB4ODAsIG91
dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoKChjID4+IDYpICYgMHgzZikgfCAweDgwLCBvdXRf
Y2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKChjICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0p
KTsKKyAgICAgfSBlbHNlIHsKKyAJQ0sob3V0X2NiKCgoYyA+PiAzMCkgJiAweDAxKSB8IDB4ZmMs
IG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoKChjID4+IDI0KSAmIDB4M2YpIHwgMHg4MCwg
b3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigoKGMgPj4gMTgpICYgMHgzZikgfCAweDgwLCBv
dXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKCgoYyA+PiAxMikgJiAweDNmKSB8IDB4ODAsIG91
dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoKChjID4+IDYpICYgMHgzZikgfCAweDgwLCBvdXRf
Y2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKChjICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0p
KTsKKyAgICAgfQorIAorICAgICByZXR1cm4gMDsKKyB9CisgCisgc3RhdGljIGludCB1dGY4X2Rl
Y29kZSh1aW50IGMsIGNvbnZlcnRfc3RhdGUgKmZpbHRlciwgY29udmVydGVkX291dF9jYl90IG91
dF9jYiwgdm9pZCAqb3V0X2NiX3BhcmFtKQorIHsKKyAgICAgaWYgKGMgPCAweDgwKSB7CisgCUNL
KG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKyAJZmlsdGVyLT5zdGF0dXMgPSAwOworICAgICB9
IGVsc2UgaWYgKGMgPCAweGMwKSB7CisgCXVpbnQgczsKKyAKKyAJc3dpdGNoIChmaWx0ZXItPnN0
YXR1cyAmIDB4ZmYpIHsKKyAJY2FzZSAweDEwOiAvKiAyYnl0ZSBjb2RlIDJuZCBjaGFyICovCisg
CWNhc2UgMHgyMTogLyogM2J5dGUgY29kZSAzcmQgY2hhciAqLworIAljYXNlIDB4MzI6IC8qIDRi
eXRlIGNvZGUgNHRoIGNoYXIgKi8KKyAJY2FzZSAweDQzOiAvKiA1Ynl0ZSBjb2RlIDV0aCBjaGFy
ICovCisgCWNhc2UgMHg1NDogLyogNmJ5dGUgY29kZSA2dGggY2hhciAqLworIAkgICAgZmlsdGVy
LT5zdGF0dXMgPSAwOworIAkgICAgcyA9IGZpbHRlci0+Y2FjaGUgfCAoYyAmIDB4M2YpOworIAkg
ICAgaWYgKHMgPj0gMHg4MCkKKyAJCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAg
IGJyZWFrOworIAljYXNlIDB4MjA6IC8qIDNieXRlIGNvZGUgMm5kIGNoYXIgKi8KKyAJY2FzZSAw
eDMxOiAvKiA0Ynl0ZSBjb2RlIDNyZCBjaGFyICovCisgCWNhc2UgMHg0MjogLyogNWJ5dGUgY29k
ZSA0dGggY2hhciAqLworIAljYXNlIDB4NTM6IC8qIDZieXRlIGNvZGUgNXRoIGNoYXIgKi8KKyAJ
ICAgIGZpbHRlci0+Y2FjaGUgfD0gKChjICYgMHgzZikgPDwgNik7CisgCSAgICBmaWx0ZXItPnN0
YXR1cysrOworIAkgICAgYnJlYWs7CisgCWNhc2UgMHgzMDogLyogNGJ5dGUgY29kZSAybmQgY2hh
ciAqLworIAljYXNlIDB4NDE6IC8qIDVieXRlIGNvZGUgM3JkIGNoYXIgKi8KKyAJY2FzZSAweDUy
OiAvKiA2Ynl0ZSBjb2RlIDR0aCBjaGFyICovCisgCSAgICBmaWx0ZXItPmNhY2hlIHw9ICgoYyAm
IDB4M2YpIDw8IDEyKTsKKyAJICAgIGZpbHRlci0+c3RhdHVzKys7CisgCSAgICBicmVhazsKKyAJ
Y2FzZSAweDQwOiAvKiA1Ynl0ZSBjb2RlIDJuZCBjaGFyICovCisgCWNhc2UgMHg1MTogLyogNmJ5
dGUgY29kZSAzcmQgY2hhciAqLworIAkgICAgZmlsdGVyLT5jYWNoZSB8PSAoKGMgJiAweDNmKSA8
PCAxOCk7CisgCSAgICBmaWx0ZXItPnN0YXR1cysrOworIAkgICAgYnJlYWs7CisgCWNhc2UgMHg1
MDogLyogNmJ5dGUgY29kZSAybmQgY2hhciAqLworIAkgICAgZmlsdGVyLT5jYWNoZSB8PSAoKGMg
JiAweDNmKSA8PCAyNCk7CisgCSAgICBmaWx0ZXItPnN0YXR1cysrOworIAkgICAgYnJlYWs7Cisg
CWRlZmF1bHQ6CisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDA7CisgCSAgICBicmVhazsKKyAJfQor
ICAgICB9IGVsc2UgaWYgKGMgPCAweGUwKSB7IC8qIDJieXRlIGNvZGUgZmlyc3QgY2hhciAqLwor
IAlmaWx0ZXItPnN0YXR1cyA9IDB4MTA7CisgCWZpbHRlci0+Y2FjaGUgPSAoYyAmIDB4MWYpIDw8
IDY7CisgICAgIH0gZWxzZSBpZiAoYyA8IDB4ZjApIHsgLyogM2J5dGUgY29kZSBmaXJzdCBjaGFy
ICovCisgCWZpbHRlci0+c3RhdHVzID0gMHgyMDsKKyAJZmlsdGVyLT5jYWNoZSA9IChjICYgMHhm
KSA8PCAxMjsKKyAgICAgfSBlbHNlIGlmIChjIDwgMHhmOCkgeyAvKiA0Ynl0ZSBjb2RlIGZpcnN0
IGNoYXIgKi8KKyAJZmlsdGVyLT5zdGF0dXMgPSAweDMwOworIAlmaWx0ZXItPmNhY2hlID0gKGMg
JiAweDcpIDw8IDE4OworICAgICB9IGVsc2UgaWYgKGMgPCAweGZjKSB7IC8qIDVieXRlIGNvZGUg
Zmlyc3QgY2hhciAqLworIAlmaWx0ZXItPnN0YXR1cyA9IDB4NDA7CisgCWZpbHRlci0+Y2FjaGUg
PSAoYyAmIDB4MykgPDwgMjQ7CisgICAgIH0gZWxzZSBpZiAoYyA8IDB4ZmUpICB7IC8qIDYgYnl0
ZSBjb2RlIGZpcnN0IGNoYXIgKi8KKyAJZmlsdGVyLT5zdGF0dXMgPSAweDUwOworIAlmaWx0ZXIt
PmNhY2hlID0gKGMgJiAweDEpIDw8IDMwOworICAgICB9IGVsc2UgeworIAlmaWx0ZXItPnN0YXR1
cyA9IDA7CisgCWZpbHRlci0+Y2FjaGUgPSAwOworICAgICB9CisgCisgICAgIHJldHVybiAwOwor
IH0KKyAKKyBzdGF0aWMgY29uc3QgdW5zaWduZWQgY2hhciB1dGY3aW1hcF9iYXNlNjRfdGFibGVb
XSA9CisgeworICAvKiAnQScsICdCJywgJ0MnLCAnRCcsICdFJywgJ0YnLCAnRycsICdIJywgJ0kn
LCAnSicsICdLJywgJ0wnLCAnTScsICovCisgICAgMHg0MSwweDQyLDB4NDMsMHg0NCwweDQ1LDB4
NDYsMHg0NywweDQ4LDB4NDksMHg0YSwweDRiLDB4NGMsMHg0ZCwKKyAgLyogJ04nLCAnTycsICdQ
JywgJ1EnLCAnUicsICdTJywgJ1QnLCAnVScsICdWJywgJ1cnLCAnWCcsICdZJywgJ1onLCAqLwor
ICAgIDB4NGUsMHg0ZiwweDUwLDB4NTEsMHg1MiwweDUzLDB4NTQsMHg1NSwweDU2LDB4NTcsMHg1
OCwweDU5LDB4NWEsCisgIC8qICdhJywgJ2InLCAnYycsICdkJywgJ2UnLCAnZicsICdnJywgJ2gn
LCAnaScsICdqJywgJ2snLCAnbCcsICdtJywgKi8KKyAgICAweDYxLDB4NjIsMHg2MywweDY0LDB4
NjUsMHg2NiwweDY3LDB4NjgsMHg2OSwweDZhLDB4NmIsMHg2YywweDZkLAorICAvKiAnbicsICdv
JywgJ3AnLCAncScsICdyJywgJ3MnLCAndCcsICd1JywgJ3YnLCAndycsICd4JywgJ3knLCAneics
ICovCisgICAgMHg2ZSwweDZmLDB4NzAsMHg3MSwweDcyLDB4NzMsMHg3NCwweDc1LDB4NzYsMHg3
NywweDc4LDB4NzksMHg3YSwKKyAgLyogJzAnLCAnMScsICcyJywgJzMnLCAnNCcsICc1JywgJzYn
LCAnNycsICc4JywgJzknLCAnKycsICcsJywgJ1wwJyAqLworICAgIDB4MzAsMHgzMSwweDMyLDB4
MzMsMHgzNCwweDM1LDB4MzYsMHgzNywweDM4LDB4MzksMHgyYiwweDJjLDB4MDAKKyB9OworIAor
IHN0YXRpYyBpbnQgbXV0ZjdfZW5jb2RlKHVpbnQgYywgY29udmVydF9zdGF0ZSAqZmlsdGVyLCBj
b252ZXJ0ZWRfb3V0X2NiX3Qgb3V0X2NiLCB2b2lkICpvdXRfY2JfcGFyYW0pCisgeworICAgICBp
bnQgbiwgczsKKyAKKyAgICAgbiA9IDA7CisgICAgIGlmIChjID09IDB4MjYpIHsKKyAJbiA9IDE7
CisgICAgIH0gZWxzZSBpZiAoKGMgPj0gMHgyMCAmJiBjIDw9IDB4N2UpIHx8IGMgPT0gMCkgewor
IAluID0gMjsKKyAgICAgfSBlbHNlIGlmIChjID49IDAgJiYgYyA8IFVDUzJNQVgpIHsKKyAJOwor
ICAgICB9IGVsc2UgaWYgKGMgPj0gU1VQTUlOICYmIGMgPCBTVVBNQVgpIHsKKyAJcyA9ICgoYyA+
PiAxMCkgLSAweDQwKSB8IDB4ZDgwMDsKKyAJQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJhbSkpOwor
IAlzID0gKGMgJiAweDNmZikgfCAweGRjMDA7CisgCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0p
KTsKKyAJcmV0dXJuIDA7CisgICAgIH0gZWxzZSB7CisgCXJldHVybiAtMTsKKyAgICAgfQorIAor
ICAgICBzd2l0Y2ggKGZpbHRlci0+c3RhdHVzKSB7CisgICAgIGNhc2UgMDoKKyAJaWYgKG4gIT0g
MCkgewkvKiBkaXJlY3RseSBlbmNvZGUgY2hhcmFjdGVycyAqLworIAkgICAgQ0sob3V0X2NiKGMs
IG91dF9jYl9wYXJhbSkpOworIAkgICAgaWYgKG4gPT0gMSkgeworIAkJQ0sob3V0X2NiKDB4MmQs
IG91dF9jYl9wYXJhbSkpOwkJLyogJy0nICovCisgCSAgICB9CisgCX0gZWxzZSB7CS8qIE1vZGlm
aWVkIEJhc2U2NCAqLworIAkgICAgQ0sob3V0X2NiKDB4MjYsIG91dF9jYl9wYXJhbSkpOwkJLyog
JyYnICovCisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDE7CisgCSAgICBmaWx0ZXItPmNhY2hlID0g
YzsKKyAJfQorIAlicmVhazsKKyAKKyAJLyogZW5jb2RlIE1vZGlmaWVkIEJhc2U2NCAqLworICAg
ICBjYXNlIDE6CisgCXMgPSBmaWx0ZXItPmNhY2hlOworIAlDSyhvdXRfY2IodXRmN2ltYXBfYmFz
ZTY0X3RhYmxlWyhzID4+IDEwKSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2Ni
KHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA+PiA0KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsK
KyAJaWYgKG4gIT0gMCkgeworIAkgICAgQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVso
cyA8PCAyKSAmIDB4M2NdLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIENLKG91dF9jYigweDJkLCBv
dXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworIAkgICAgQ0sob3V0X2NiKGMsIG91dF9jYl9wYXJh
bSkpOworIAkgICAgaWYgKG4gPT0gMSkgeworIAkJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJh
bSkpOwkJLyogJy0nICovCisgCSAgICB9CisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDA7CisgCX0g
ZWxzZSB7CisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDI7CisgCSAgICBmaWx0ZXItPmNhY2hlID0g
KChzICYgMHhmKSA8PCAxNikgfCBjOworIAl9CisgCWJyZWFrOworIAorICAgICBjYXNlIDI6Cisg
CXMgPSBmaWx0ZXItPmNhY2hlOworIAlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhz
ID4+IDE0KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jh
c2U2NF90YWJsZVsocyA+PiA4KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2Ni
KHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA+PiAyKSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsK
KyAJaWYgKG4gIT0gMCkgeworIAkgICAgQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVso
cyA8PCA0KSAmIDB4MzBdLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIENLKG91dF9jYigweDJkLCBv
dXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworIAkgICAgQ0sob3V0X2NiKGMsIG91dF9jYl9wYXJh
bSkpOworIAkgICAgaWYgKG4gPT0gMSkgeworIAkJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJh
bSkpOwkJLyogJy0nICovCisgCSAgICB9CisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDA7CisgCX0g
ZWxzZSB7CisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDM7CisgCSAgICBmaWx0ZXItPmNhY2hlID0g
KChzICYgMHgzKSA8PCAxNikgfCBjOworIAl9CisgCWJyZWFrOworIAorICAgICBjYXNlIDM6Cisg
CXMgPSBmaWx0ZXItPmNhY2hlOworIAlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhz
ID4+IDEyKSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jh
c2U2NF90YWJsZVsocyA+PiA2KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2Ni
KHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVtzICYgMHgzZl0sIG91dF9jYl9wYXJhbSkpOworIAlpZiAo
biAhPSAwKSB7CisgCSAgICBDSyhvdXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScg
Ki8KKyAJICAgIENLKG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIGlmIChuID09IDEp
IHsKKyAJCUNLKG91dF9jYigweDJkLCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworIAkgICAg
fQorIAkgICAgZmlsdGVyLT5zdGF0dXMgPSAwOworIAl9IGVsc2UgeworIAkgICAgZmlsdGVyLT5z
dGF0dXMgPSAxOworIAkgICAgZmlsdGVyLT5jYWNoZSA9IGM7CisgCX0KKyAJYnJlYWs7CisgCisg
ICAgIGRlZmF1bHQ6CisgCWZpbHRlci0+c3RhdHVzID0gMDsKKyAJYnJlYWs7CisgICAgIH0KKyAK
KyAgICAgcmV0dXJuIDA7CisgfQorIAorIHN0YXRpYyBpbnQgbXV0ZjdfZGVjb2RlKHVpbnQgYywg
Y29udmVydF9zdGF0ZSAqZmlsdGVyLCBjb252ZXJ0ZWRfb3V0X2NiX3Qgb3V0X2NiLCB2b2lkICpv
dXRfY2JfcGFyYW0pCisgeworICAgICBpbnQgcywgbjsKKyAKKyAgICAgbiA9IC0xOworICAgICBp
ZiAoZmlsdGVyLT5zdGF0dXMgIT0gMCkgewkJLyogTW9kaWZpZWQgQmFzZTY0ICovCisgCWlmIChj
ID49IDB4NDEgJiYgYyA8PSAweDVhKSB7CQkvKiBBIC0gWiAqLworIAkgICAgbiA9IGMgLSA2NTsK
KyAJfSBlbHNlIGlmIChjID49IDB4NjEgJiYgYyA8PSAweDdhKSB7CS8qIGEgLSB6ICovCisgCSAg
ICBuID0gYyAtIDcxOworIAl9IGVsc2UgaWYgKGMgPj0gMHgzMCAmJiBjIDw9IDB4MzkpIHsJLyog
MCAtIDkgKi8KKyAJICAgIG4gPSBjICsgNDsKKyAJfSBlbHNlIGlmIChjID09IDB4MmIpIHsJCQkv
KiAnKycgKi8KKyAJICAgIG4gPSA2MjsKKyAJfSBlbHNlIGlmIChjID09IDB4MmMpIHsJCQkvKiAn
LCcgKi8KKyAJICAgIG4gPSA2MzsKKyAJfQorIAlpZiAobiA8IDAgfHwgbiA+IDYzKSB7CisgCSAg
ICBpZiAoYyA9PSAweDJkKSB7CisgCQlpZiAoZmlsdGVyLT5zdGF0dXMgPT0gMSkgewkJLyogIiYt
IiAtPiAiJiIgKi8KKyAJCSAgICBDSyhvdXRfY2IoMHgyNiwgb3V0X2NiX3BhcmFtKSk7CisgCQl9
CisgCSAgICB9IGVsc2UgaWYgKGMgPj0gMCAmJiBjIDwgMHg4MCkgewkvKiBBU0NJSSBleGNsdWRl
ICctJyAqLworIAkJQ0sob3V0X2NiKGMsIG91dF9jYl9wYXJhbSkpOworIAkgICAgfSBlbHNlIHsJ
CS8qIGlsbGVnYWwgY2hhcmFjdGVyICovCisgCQlzID0gYyAmIE1BU0s7CisgCQlzIHw9IFRIUk9V
R0g7CisgCQlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisgCSAgICB9CisgCSAgICBmaWx0
ZXItPmNhY2hlID0gMDsKKyAJICAgIGZpbHRlci0+c3RhdHVzID0gMDsKKyAJICAgIHJldHVybiAw
OworIAl9CisgICAgIH0KKyAKKyAgICAgc3dpdGNoIChmaWx0ZXItPnN0YXR1cykgeworIAkvKiBk
aXJlY3RseSBlbmNvZGVkIGNoYXJhY3RlcnMgKi8KKyAgICAgY2FzZSAwOgorIAlpZiAoYyA9PSAw
eDI2KSB7CS8qICcmJyAgc2hpZnQgY2hhcmFjdGVyICovCisgCSAgICBmaWx0ZXItPnN0YXR1cysr
OworIAl9IGVsc2UgaWYgKGMgPj0gMCAmJiBjIDwgMHg4MCkgewkvKiBBU0NJSSAqLworIAkgICAg
Q0sob3V0X2NiKGMsIG91dF9jYl9wYXJhbSkpOworIAl9IGVsc2UgewkJLyogaWxsZWdhbCBjaGFy
YWN0ZXIgKi8KKyAJICAgIHMgPSBjICYgTUFTSzsKKyAJICAgIHMgfD0gVEhST1VHSDsKKyAJICAg
IENLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJfQorIAlicmVhazsKKyAKKyAJLyogZGVj
b2RlIE1vZGlmaWVkIEJhc2U2NCAqLworICAgICBjYXNlIDE6CisgICAgIGNhc2UgMjoKKyAJZmls
dGVyLT5jYWNoZSB8PSBuIDw8IDEwOworIAlmaWx0ZXItPnN0YXR1cyA9IDM7CisgCWJyZWFrOwor
ICAgICBjYXNlIDM6CisgCWZpbHRlci0+Y2FjaGUgfD0gbiA8PCA0OworIAlmaWx0ZXItPnN0YXR1
cyA9IDQ7CisgCWJyZWFrOworICAgICBjYXNlIDQ6CisgCXMgPSAoKG4gPj4gMikgJiAweGYpIHwg
KGZpbHRlci0+Y2FjaGUgJiAweGZmZmYpOworIAluID0gKG4gJiAweDMpIDw8IDE0OworIAlmaWx0
ZXItPnN0YXR1cyA9IDU7CisgCWlmIChzID49IDB4ZDgwMCAmJiBzIDwgMHhkYzAwKSB7CisgCSAg
ICBzID0gKCgocyAmIDB4M2ZmKSA8PCAxNikgKyAweDQwMDAwMCkgfCBuOworIAkgICAgZmlsdGVy
LT5jYWNoZSA9IHM7CisgCX0gZWxzZSBpZiAocyA+PSAweGRjMDAgJiYgcyA8IDB4ZTAwMCkgewor
IAkgICAgcyAmPSAweDNmZjsKKyAJICAgIHMgfD0gKGZpbHRlci0+Y2FjaGUgJiAweGZmZjAwMDAp
ID4+IDY7CisgCSAgICBmaWx0ZXItPmNhY2hlID0gbjsKKyAJICAgIGlmIChzID49IFNVUE1JTiAm
JiBzIDwgU1VQTUFYKSB7CisgCQlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisgCSAgICB9
IGVsc2UgewkJLyogaWxsZWdhbCBjaGFyYWN0ZXIgKi8KKyAJCXMgJj0gTUFTSzsKKyAJCXMgfD0g
VEhST1VHSDsKKyAJCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIH0KKyAJfSBl
bHNlIHsKKyAJICAgIGZpbHRlci0+Y2FjaGUgPSBuOworIAkgICAgQ0sob3V0X2NiKHMsIG91dF9j
Yl9wYXJhbSkpOworIAl9CisgCWJyZWFrOworIAorICAgICBjYXNlIDU6CisgCWZpbHRlci0+Y2Fj
aGUgfD0gbiA8PCA4OworIAlmaWx0ZXItPnN0YXR1cyA9IDY7CisgCWJyZWFrOworICAgICBjYXNl
IDY6CisgCWZpbHRlci0+Y2FjaGUgfD0gbiA8PCAyOworIAlmaWx0ZXItPnN0YXR1cyA9IDc7Cisg
CWJyZWFrOworICAgICBjYXNlIDc6CisgCXMgPSAoKG4gPj4gNCkgJiAweDMpIHwgKGZpbHRlci0+
Y2FjaGUgJiAweGZmZmYpOworIAluID0gKG4gJiAweGYpIDw8IDEyOworIAlmaWx0ZXItPnN0YXR1
cyA9IDg7CisgCWlmIChzID49IDB4ZDgwMCAmJiBzIDwgMHhkYzAwKSB7CisgCSAgICBzID0gKCgo
cyAmIDB4M2ZmKSA8PCAxNikgKyAweDQwMDAwMCkgfCBuOworIAkgICAgZmlsdGVyLT5jYWNoZSA9
IHM7CisgCX0gZWxzZSBpZiAocyA+PSAweGRjMDAgJiYgcyA8IDB4ZTAwMCkgeworIAkgICAgcyAm
PSAweDNmZjsKKyAJICAgIHMgfD0gKGZpbHRlci0+Y2FjaGUgJiAweGZmZjAwMDApID4+IDY7Cisg
CSAgICBmaWx0ZXItPmNhY2hlID0gbjsKKyAJICAgIGlmIChzID49IFNVUE1JTiAmJiBzIDwgU1VQ
TUFYKSB7CisgCQlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisgCSAgICB9IGVsc2UgewkJ
LyogaWxsZWdhbCBjaGFyYWN0ZXIgKi8KKyAJCXMgJj0gTUFTSzsKKyAJCXMgfD0gVEhST1VHSDsK
KyAJCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIH0KKyAJfSBlbHNlIHsKKyAJ
ICAgIGZpbHRlci0+Y2FjaGUgPSBuOworIAkgICAgQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJhbSkp
OworIAl9CisgCWJyZWFrOworIAorICAgICBjYXNlIDg6CisgCWZpbHRlci0+Y2FjaGUgfD0gbiA8
PCA2OworIAlmaWx0ZXItPnN0YXR1cyA9IDk7CisgCWJyZWFrOworICAgICBjYXNlIDk6CisgCXMg
PSBuIHwgKGZpbHRlci0+Y2FjaGUgJiAweGZmZmYpOworIAlmaWx0ZXItPnN0YXR1cyA9IDI7Cisg
CWlmIChzID49IDB4ZDgwMCAmJiBzIDwgMHhkYzAwKSB7CisgCSAgICBzID0gKCgocyAmIDB4M2Zm
KSA8PCAxNikgKyAweDQwMDAwMCk7CisgCSAgICBmaWx0ZXItPmNhY2hlID0gczsKKyAJfSBlbHNl
IGlmIChzID49IDB4ZGMwMCAmJiBzIDwgMHhlMDAwKSB7CisgCSAgICBzICY9IDB4M2ZmOworIAkg
ICAgcyB8PSAoZmlsdGVyLT5jYWNoZSAmIDB4ZmZmMDAwMCkgPj4gNjsKKyAJICAgIGZpbHRlci0+
Y2FjaGUgPSAwOworIAkgICAgaWYgKHMgPj0gU1VQTUlOICYmIHMgPCBTVVBNQVgpIHsKKyAJCUNL
KG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIH0gZWxzZSB7CQkvKiBpbGxlZ2FsIGNo
YXJhY3RlciAqLworIAkJcyAmPSBNQVNLOworIAkJcyB8PSBUSFJPVUdIOworIAkJQ0sob3V0X2Ni
KHMsIG91dF9jYl9wYXJhbSkpOworIAkgICAgfQorIAl9IGVsc2UgeworIAkgICAgZmlsdGVyLT5j
YWNoZSA9IDA7CisgCSAgICBDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisgCX0KKyAJYnJl
YWs7CisgCisgICAgIGRlZmF1bHQ6CisgCWZpbHRlci0+c3RhdHVzID0gMDsKKyAJYnJlYWs7Cisg
ICAgIH0KKyAKKyAgICAgcmV0dXJuIDA7CisgfQorIHN0YXRpYyBpbnQgbXV0ZjdfZW5jb2RlX2Zs
dXNoKGNvbnZlcnRfc3RhdGUgKmZpbHRlciwgY29udmVydGVkX291dF9jYl90IG91dF9jYiwgdm9p
ZCAqb3V0X2NiX3BhcmFtKQorIHsKKyAgICAgaW50IHN0YXR1cywgY2FjaGU7CisgCisgICAgIHN0
YXR1cyA9IGZpbHRlci0+c3RhdHVzOworICAgICBjYWNoZSA9IGZpbHRlci0+Y2FjaGU7CisgICAg
IGZpbHRlci0+c3RhdHVzID0gMDsKKyAgICAgZmlsdGVyLT5jYWNoZSA9IDA7CisgICAgIC8qIGZs
dXNoIGZyYWdtZW50cyAqLworICAgICBzd2l0Y2ggKHN0YXR1cykgeworICAgICBjYXNlIDE6Cisg
CUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKGNhY2hlID4+IDEwKSAmIDB4M2ZdLCBv
dXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsoY2FjaGUg
Pj4gNCkgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYih1dGY3aW1hcF9iYXNl
NjRfdGFibGVbKGNhY2hlIDw8IDIpICYgMHgzY10sIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRf
Y2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScgKi8KKyAJYnJlYWs7CisgCisgICAgIGNh
c2UgMjoKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsoY2FjaGUgPj4gMTQpICYg
MHgzZl0sIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxl
WyhjYWNoZSA+PiA4KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKHV0Zjdp
bWFwX2Jhc2U2NF90YWJsZVsoY2FjaGUgPj4gMikgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7Cisg
CUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKGNhY2hlIDw8IDQpICYgMHgzMF0sIG91
dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScg
Ki8KKyAJYnJlYWs7CisgCisgICAgIGNhc2UgMzoKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2
NF90YWJsZVsoY2FjaGUgPj4gMTIpICYgMHgzZl0sIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRf
Y2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhjYWNoZSA+PiA2KSAmIDB4M2ZdLCBvdXRfY2JfcGFy
YW0pKTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVtjYWNoZSAmIDB4M2ZdLCBv
dXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJhbSkpOwkJLyogJy0n
ICovCisgCWJyZWFrOworICAgICB9CisgICAgIHJldHVybiAwOworIH0KKyAKKyB0eXBlZGVmIHN0
cnVjdCBfY29udmVydF9vcHRzIHsKKyAgICAgY29udmVydF9jYl90IGVuY29kZV9jYjsKKyAgICAg
Y29udmVydF9jYl90IGRlY29kZV9jYjsKKyAgICAgZmx1c2hfY2JfdCBmbHVzaF9lbmNvZGU7Cisg
ICAgIGZsdXNoX2NiX3QgZmx1c2hfZGVjb2RlOworIH0gY29udmVydF9vcHRzOworIAorIHR5cGVk
ZWYgc3RydWN0IF9wYXJhbV9jb252ZXJ0IHsKKyAgICAgaW50IGxlbjsKKyAgICAgY2hhciAqb3V0
OworICAgICBjb252ZXJ0X29wdHMgKm9wdHM7CisgICAgIGNvbnZlcnRfc3RhdGUgZmlsdGVyOwor
IH0gcGFyYW1fY29udmVydDsKKyAKKyAvKiBqdXN0IGEgY291bnRlciAqLworIHN0YXRpYyBpbnQg
Y291bnRfbGVuX2NiKHVpbnQgYywgdm9pZCAqcGFyYW0pCisgeworICAgICAoKihpbnQgKilwYXJh
bSkrKzsKKyAgICAgcmV0dXJuIDA7CisgfQorIAorIHN0YXRpYyBpbnQgd3JpdGVfb3V0X2NiKHVp
bnQgYywgdm9pZCAqcGFyYW0pCisgeworICAgICBwYXJhbV9jb252ZXJ0ICpyX3BhcmFtPShwYXJh
bV9jb252ZXJ0ICopcGFyYW07CisgCisgICAgIHJfcGFyYW0tPm91dFtyX3BhcmFtLT5sZW5dPShj
aGFyKWM7CisgICAgIHJfcGFyYW0tPmxlbisrOworICAgICByZXR1cm4gMDsKKyB9CisgCisgLyog
J2MnIGlzIHdjaGFyLiB3ZSBuZWVkIHRvIGNhbGwgZW5jb2RlX2NiIGZ1bmN0aW9uIHRvIGNhbGN1
bGF0ZSB0aGUKKyAgICBvdXRwdXQgYnVmZmVyIHNpemUgKi8KKyBzdGF0aWMgaW50IGdldF9sZW5f
Y2IodWludCBjLCB2b2lkICpwYXJhbSkKKyB7CisgICAgIHJldHVybiAoKHBhcmFtX2NvbnZlcnQg
KilwYXJhbSktPm9wdHMtPmVuY29kZV9jYihjLCAmKChwYXJhbV9jb252ZXJ0ICopcGFyYW0pLT5m
aWx0ZXIsIGNvdW50X2xlbl9jYiwgKHZvaWQgKikmKChwYXJhbV9jb252ZXJ0ICopcGFyYW0pLT5s
ZW4pOworIH0KKyAKKyBzdGF0aWMgaW50IHJlYWxfb3V0X2NiKHVpbnQgYywgdm9pZCAqcGFyYW0p
CisgeworICAgICByZXR1cm4gKChwYXJhbV9jb252ZXJ0ICopcGFyYW0pLT5vcHRzLT5lbmNvZGVf
Y2IoYywgJigocGFyYW1fY29udmVydCAqKXBhcmFtKS0+ZmlsdGVyLCB3cml0ZV9vdXRfY2IsIHBh
cmFtKTsKKyB9CisgCisgc3RhdGljIGNoYXIgKmRvX2NvbnZlcnNpb24oY29udmVydF9vcHRzICpv
cHRzLCBjaGFyICppbiwgaW50IGlubGVuLCBpbnQgKm91dGxlbikKKyB7CisgICAgIHBhcmFtX2Nv
bnZlcnQgcGFyYW07CisgICAgIGNvbnZlcnRfc3RhdGUgZmlsdGVyOworICAgICBpbnQgaTsKKyAK
KyAgICAgcGFyYW0ubGVuID0gMDsKKyAgICAgcGFyYW0ub3B0cyA9IG9wdHM7CisgICAgIGJ6ZXJv
KCZwYXJhbS5maWx0ZXIsIHNpemVvZihwYXJhbS5maWx0ZXIpKTsKKyAgICAgYnplcm8oJmZpbHRl
ciwgc2l6ZW9mKGZpbHRlcikpOworIAorICAgICBmb3IoaT0wOyBpPGlubGVuOyBpKyspCisgCWlm
KG9wdHMtPmRlY29kZV9jYigodWludCkodW5zaWduZWQgY2hhcilpbltpXSwgJmZpbHRlciwgZ2V0
X2xlbl9jYiwgKHZvaWQgKikmcGFyYW0pKQorIAkgICAgcmV0dXJuIE5VTEw7CisgCisgICAgIGlm
KG9wdHMtPmZsdXNoX2RlY29kZSkKKyAJaWYob3B0cy0+Zmx1c2hfZGVjb2RlKCZmaWx0ZXIsIGdl
dF9sZW5fY2IsICh2b2lkICopJnBhcmFtKSkKKyAJICAgIHJldHVybiBOVUxMOworICAgICBpZihv
cHRzLT5mbHVzaF9lbmNvZGUpCisgCWlmKG9wdHMtPmZsdXNoX2VuY29kZSgmcGFyYW0uZmlsdGVy
LCBjb3VudF9sZW5fY2IsICh2b2lkICopJnBhcmFtLmxlbikpCisgCSAgICByZXR1cm4gTlVMTDsK
KyAKKyAgICAgaWYoIShwYXJhbS5vdXQ9KGNoYXIgKiltYWxsb2MocGFyYW0ubGVuKSkpCisgCXJl
dHVybiBOVUxMOworICAgICBwYXJhbS5sZW49MDsKKyAgICAgYnplcm8oJnBhcmFtLmZpbHRlciwg
c2l6ZW9mKHBhcmFtLmZpbHRlcikpOworICAgICBiemVybygmZmlsdGVyLCBzaXplb2YoZmlsdGVy
KSk7CisgICAgIAorICAgICBmb3IoaT0wOyBpPGlubGVuOyBpKyspCisgCWlmKG9wdHMtPmRlY29k
ZV9jYigodWludCkodW5zaWduZWQgY2hhcilpbltpXSwgJmZpbHRlciwgcmVhbF9vdXRfY2IsICh2
b2lkICopJnBhcmFtKSkgeworIAkgICAgZnJlZShwYXJhbS5vdXQpOworIAkgICAgcmV0dXJuIE5V
TEw7CisgCX0KKyAKKyAgICAgaWYob3B0cy0+Zmx1c2hfZGVjb2RlKQorIAlpZihvcHRzLT5mbHVz
aF9kZWNvZGUoJmZpbHRlciwgcmVhbF9vdXRfY2IsICh2b2lkICopJnBhcmFtKSkgeworIAkgICAg
ZnJlZShwYXJhbS5vdXQpOworIAkgICAgcmV0dXJuIE5VTEw7CisgCX0KKyAgICAgaWYob3B0cy0+
Zmx1c2hfZW5jb2RlKQorIAlpZihvcHRzLT5mbHVzaF9lbmNvZGUoJnBhcmFtLmZpbHRlciwgd3Jp
dGVfb3V0X2NiLCAodm9pZCAqKSZwYXJhbS5sZW4pKSB7CisgCSAgICBmcmVlKHBhcmFtLm91dCk7
CisgCSAgICByZXR1cm4gTlVMTDsKKyAJfQorIAorICAgICAqb3V0bGVuID0gcGFyYW0ubGVuOwor
ICAgICByZXR1cm4gcGFyYW0ub3V0OworIH0KKyAKKyBleHRlcm4gY2hhciAqdXRmOF90b19tdXRm
NyhjaGFyICppbiwgaW50IGlubGVuLCBpbnQgKm91dGxlbikKKyB7CisgICAgIGNvbnZlcnRfb3B0
cyBvcHRzOworIAorICAgICBvcHRzLmVuY29kZV9jYiA9IG11dGY3X2VuY29kZTsKKyAgICAgb3B0
cy5kZWNvZGVfY2IgPSB1dGY4X2RlY29kZTsKKyAgICAgb3B0cy5mbHVzaF9lbmNvZGUgPSBtdXRm
N19lbmNvZGVfZmx1c2g7CisgICAgIG9wdHMuZmx1c2hfZGVjb2RlID0gTlVMTDsKKyAKKyAgICAg
cmV0dXJuIGRvX2NvbnZlcnNpb24oJm9wdHMsIGluLCBpbmxlbiwgb3V0bGVuKTsKKyB9CisgCisg
ZXh0ZXJuIGNoYXIgKm11dGY3X3RvX3V0ZjgoY2hhciAqaW4sIGludCBpbmxlbiwgaW50ICpvdXRs
ZW4pCisgeworICAgICBjb252ZXJ0X29wdHMgb3B0czsKKyAKKyAgICAgb3B0cy5lbmNvZGVfY2Ig
PSB1dGY4X2VuY29kZTsKKyAgICAgb3B0cy5kZWNvZGVfY2IgPSBtdXRmN19kZWNvZGU7CisgICAg
IG9wdHMuZmx1c2hfZW5jb2RlID0gTlVMTDsKKyAgICAgb3B0cy5mbHVzaF9kZWNvZGUgPSBOVUxM
OworIAorICAgICByZXR1cm4gZG9fY29udmVyc2lvbigmb3B0cywgaW4sIGlubGVuLCBvdXRsZW4p
OworIH0KZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9jaGFyc2V0
X2NvbnZlcnQuaCBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9jaGFyc2V0X2NvbnZlcnQuaAoqKiog
Y3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL2NoYXJzZXRfY29udmVydC5oCTE5NzAtMDEtMDEg
MDM6MDA6MDAgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2NoYXJzZXRfY29udmVy
dC5oCTIwMDUtMTEtMDMgMTc6NTM6NDAgKzAzMDAKKioqKioqKioqKioqKioqCioqKiAwICoqKioK
LS0tIDEsNyAtLS0tCisgI2lmbmRlZiBfQ0hBUlNFVF9DT05WRVJUX0gKKyAjZGVmaW5lIF9DSEFS
U0VUX0NPTlZFUlRfSAorIAorIGV4dGVybiBjaGFyICp1dGY4X3RvX211dGY3KGNoYXIgKmluLCBp
bnQgaW5sZW4sIGludCAqb3V0bGVuKTsKKyBleHRlcm4gY2hhciAqbXV0ZjdfdG9fdXRmOChjaGFy
ICppbiwgaW50IGlubGVuLCBpbnQgKm91dGxlbik7CisgCisgI2VuZGlmIC8qIF9DSEFSU0VUX0NP
TlZFUlRfSCAqLwpkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL2lk
bGVfaWRsZWQuYyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9pZGxlX2lkbGVkLmMKKioqIGN5cnVz
LWltYXBkLTIuMi4xMi5vbGQvaW1hcC9pZGxlX2lkbGVkLmMJMjAwMy0xMC0yMyAwMDowNToxMSAr
MDQwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvaWRsZV9pZGxlZC5jCTIwMDUtMTEtMDMg
MTc6NTM6MDcgKzAzMDAKKioqKioqKioqKioqKioqCioqKiAyMTAsMjE2ICoqKioKICAgICAgLyog
c2VuZCAqLwogICAgICBpZiAoc2VuZHRvKG5vdGlmeV9zb2NrLCAodm9pZCAqKSAmaWRsZWRhdGEs
CiAgCSAgICAgICBJRExFREFUQV9CQVNFX1NJWkUrc3RybGVuKGlkbGVkYXRhLm1ib3huYW1lKSsx
LCAvKiAxIGZvciBOVUxMICovCiEgCSAgICAgICAwLCAoc3RydWN0IHNvY2thZGRyICopICZpZGxl
X3JlbW90ZSwgaWRsZV9yZW1vdGVfbGVuKSA9PSAtMSkgewogICAgICAgIHN5c2xvZyhMT0dfRVJS
LCAiZXJyb3Igc2VuZGluZyB0byBpZGxlZDogJXgiLCBtc2cpOwogICAgICAgIHJldHVybiAwOwog
ICAgICB9Ci0tLSAyMTAsMjE2IC0tLS0KICAgICAgLyogc2VuZCAqLwogICAgICBpZiAoc2VuZHRv
KG5vdGlmeV9zb2NrLCAodm9pZCAqKSAmaWRsZWRhdGEsCiAgCSAgICAgICBJRExFREFUQV9CQVNF
X1NJWkUrc3RybGVuKGlkbGVkYXRhLm1ib3huYW1lKSsxLCAvKiAxIGZvciBOVUxMICovCiEgCSAg
ICAgICAwLCAoc3RydWN0IHNvY2thZGRyICopICZpZGxlX3JlbW90ZSwgaWRsZV9yZW1vdGVfbGVu
KSA9PSAoc3NpemVfdCktMSkgewogICAgICAgIHN5c2xvZyhMT0dfRVJSLCAiZXJyb3Igc2VuZGlu
ZyB0byBpZGxlZDogJXgiLCBtc2cpOwogICAgICAgIHJldHVybiAwOwogICAgICB9CmRpZmYgLU4g
LUMgMyAtciBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvaW1hcGQuYyBjeXJ1cy1pbWFwZC0y
LjIuMTIvaW1hcC9pbWFwZC5jCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvaW1hcGQu
YwkyMDA1LTExLTAyIDE3OjU3OjAwICswMzAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9p
bWFwZC5jCTIwMDUtMTEtMDMgMTc6NTM6MDcgKzAzMDAKKioqKioqKioqKioqKioqCioqKiA4MCw4
NSAqKioqCi0tLSA4MCw4OCAtLS0tCiAgI2luY2x1ZGUgIm1haWxib3guaCIKICAjaW5jbHVkZSAi
bWVzc2FnZS5oIgogICNpbmNsdWRlICJtYm94bmFtZS5oIgorICNpZmRlZiBFTkFCTEVfQ09OVkVS
VF9VU0VSSUQKKyAjaW5jbHVkZSAibGRhcGQuaCIKKyAjZW5kaWYKICAjaW5jbHVkZSAibWJveGxp
c3QuaCIKICAjaW5jbHVkZSAibWJkdW1wLmgiCiAgI2luY2x1ZGUgIm1rZ210aW1lLmgiCioqKioq
KioqKioqKioqKgoqKiogMTEyLDExNyAqKioqCi0tLSAxMTUsMTIzIC0tLS0KICBzdGF0aWMgY2hh
ciBpbWFwZF9jbGllbnRob3N0W05JX01BWEhPU1QqMisxXSA9ICJbbG9jYWxdIjsKICBzdGF0aWMg
aW50IGltYXBkX2xvZ2ZkID0gLTE7CiAgY2hhciAqaW1hcGRfdXNlcmlkOworICNpZmRlZiBFTkFC
TEVfQ09OVkVSVF9VU0VSSUQKKyBpbnQgaW1hcGRfY29udmVydHVzZXJpZDsKKyAjZW5kaWYKICBz
dGF0aWMgY2hhciAqaW1hcGRfbWFnaWNwbHVzID0gTlVMTDsKICBzdHJ1Y3QgYXV0aF9zdGF0ZSAq
aW1hcGRfYXV0aHN0YXRlID0gMDsKICBzdGF0aWMgaW50IGltYXBkX3VzZXJpc2FkbWluID0gMDsK
KioqKioqKioqKioqKioqCioqKiA0NzYsNDgxICoqKioKLS0tIDQ4Miw0OTIgLS0tLQogICAgICB9
CiAgI2VuZGlmCiAgCisgI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICAgICBpZihpbWFw
ZF9jb252ZXJ0dXNlcmlkKQorIAltYm94bmFtZV9jbGVhbnVwKCk7CisgI2VuZGlmIC8qIEVOQUJM
RV9DT05WRVJUX1VTRVJJRCAqLworIAogICAgICBjeXJ1c19yZXNldF9zdGRpbygpOyAKICAKICAg
ICAgc3RyY3B5KGltYXBkX2NsaWVudGhvc3QsICJbbG9jYWxdIik7CioqKioqKioqKioqKioqKgoq
KiogNTQ3LDU1MiAqKioqCi0tLSA1NTgsNTY4IC0tLS0KICAJICAgICBFQ19DT05GSUcpOwogICAg
ICB9CiAgCisgI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICAgICBpZihjb252ZXJ0dXNl
cmlkX2luaXQoKSkKKyAgICAgICAgZmF0YWwoImNvbnZlcnR1c2VyaWZfaW5pdCgpIGZhaWxlZCIs
RUNfQ09ORklHKTsKKyAjZW5kaWYgLyogRU5BQkxFX0NPTlZFUlRfVVNFUklEICovCisgCiAgICAg
IC8qIG9wZW4gdGhlIG1ib3hsaXN0LCB3ZSdsbCBuZWVkIGl0IGZvciByZWFsIHdvcmsgKi8KICAg
ICAgbWJveGxpc3RfaW5pdCgwKTsKICAgICAgbWJveGxpc3Rfb3BlbihOVUxMKTsKKioqKioqKioq
KioqKioqCioqKiA1ODgsNTkzICoqKioKLS0tIDYwNCw2MjUgLS0tLQogICAgICByZXR1cm4gMDsK
ICB9CiAgCisgc3RhdGljIGludCBpbWFwZF9jb25maWdfcmVyZWFkKCkKKyB7CisgI2lmZGVmIEVO
QUJMRV9DT05WRVJUX1VTRVJJRAorICAgICBjaGFyICpleGVtcHRzOworIAorICAgICB0ZW1wbGF0
ZV9vcHRpb24gb3B0c1tdPXsKKyAJeyh2b2lkICopSU1BUE9QVF9DT05WRVJUVVNFUklELCBURU1Q
TEFURU9QVF9UWVBFX0tOT1dOT1BUfSwKKyAJeyh2b2lkICopSU1BUE9QVF9DT05WRVJUVVNFUklE
X0VYRU1QVFMsIFRFTVBMQVRFT1BUX1RZUEVfS05PV05PUFR9LAorICAgICB9OworIAorICAgICBy
ZXR1cm4gY29uZmlnX3JlcmVhZChvcHRzLCBzaXplb2Yob3B0cykvc2l6ZW9mKG9wdHNbMF0pKTsK
KyAjZWxzZQorICAgICByZXR1cm4gMDsKKyAjZW5kaWYKKyB9CisgCiAgLyoKICAgKiBydW4gZm9y
IGVhY2ggYWNjZXB0ZWQgY29ubmVjdGlvbgogICAqLwoqKioqKioqKioqKioqKioKKioqIDYxOCw2
MjMgKioqKgotLS0gNjUwLDY1OCAtLS0tCiAgICAgIGltYXBkX2luID0gcHJvdF9uZXcoMCwgMCk7
CiAgICAgIGltYXBkX291dCA9IHByb3RfbmV3KDEsIDEpOwogIAorICAgICBpZihpbWFwZF9jb25m
aWdfcmVyZWFkKCkpCisgCWZhdGFsKCJDYW4ndCByZXJlYWQgY29uZmlndXJhdGlvbiBmaWxlcyIs
IEVDX0NPTkZJRyk7CisgCiAgICAgIC8qIEZpbmQgb3V0IG5hbWUgb2YgY2xpZW50IGhvc3QgKi8K
ICAgICAgc2FsZW4gPSBzaXplb2YoaW1hcGRfcmVtb3RlYWRkcik7CiAgICAgIGlmIChnZXRwZWVy
bmFtZSgwLCAoc3RydWN0IHNvY2thZGRyICopJmltYXBkX3JlbW90ZWFkZHIsICZzYWxlbikgPT0g
MCAmJgoqKioqKioqKioqKioqKioKKioqIDcwMiw3MDcgKioqKgotLS0gNzM3LDc0NSAtLS0tCiAg
LyogQ2FsbGVkIGJ5IHNlcnZpY2UgQVBJIHRvIHNodXQgZG93biB0aGUgc2VydmljZSAqLwogIHZv
aWQgc2VydmljZV9hYm9ydChpbnQgZXJyb3IpCiAgeworICNpZmRlZiBFTkFCTEVfQ09OVkVSVF9V
U0VSSUQKKyAgICAgY29udmVydHVzZXJpZF9jbGVhbnVwKCk7CisgI2VuZGlmIC8qIEVOQUJMRV9D
T05WRVJUX1VTRVJJRCAqLwogICAgICBzaHV0X2Rvd24oZXJyb3IpOwogIH0KICAKKioqKioqKioq
KioqKioqCioqKiAxNjkzLDE2OTggKioqKgotLS0gMTczMSwxNzc3IC0tLS0KICAgICAgfQogIH0K
ICAKKyBzdGF0aWMgdm9pZCBpbWFwZF9sb2dnZWR1c2VyX2luaXQoKQorIHsKKyAjaWZkZWYgRU5B
QkxFX0NPTlZFUlRfVVNFUklECisgICAgIGNoYXIgKmV4ZW1wdHM7CisgCisgICAgIGlmKCFpbWFw
ZF9uYW1lc3BhY2UuaXNhbHQpCisgCXJldHVybjsKKyAgICAgCisgICAgIGltYXBkX2NvbnZlcnR1
c2VyaWQgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQ09OVkVSVFVTRVJJRCk7CisgICAgIGV4
ZW1wdHMgPSAoY2hhciAqKWNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9DT05WRVJUVVNFUklEX0VY
RU1QVFMpOworIAorICAgICBpZihleGVtcHRzKSB7CisgCS8qIGxvb2sgZm9yIHVzZXJpZCBpbnNp
ZGUgJ2V4ZW1wdHMnIHN0cmluZyAqLworIAljaGFyICpwPWV4ZW1wdHM7CisgCWNoYXIgKm47Cisg
CWludCB1c2VyaWRfbGVuPXN0cmxlbihpbWFwZF91c2VyaWQpOworIAorIAlkbyB7CisgCSAgICBm
b3IoOyAqcD09JyAnOyBwKyspOworIAkgICAgaWYoKnApIHsKKyAJCWludCByZXM7CisgCQlpbnQg
Y19sZW47CisgCisgCQluPXN0cmNocihwLCAnICcpOworIAkJCisgCQljX2xlbiA9IG4gPyAobi1w
KTogc3RybGVuKHApOworIAorIAkJaWYoY19sZW49PXVzZXJpZF9sZW4gJiYgIW1lbWNtcChpbWFw
ZF91c2VyaWQsIHAsIHVzZXJpZF9sZW4pKSB7CisgCQkgICAgLyogdXNlcmlkIGhhcyBiZWVuIGZv
dW5kISBzd2l0Y2ggY29udmVydHVzZXJpZAorIAkJICAgICAgIG9wdGlvbiAqLworIAkJICAgIGlt
YXBkX2NvbnZlcnR1c2VyaWQgPSAhaW1hcGRfY29udmVydHVzZXJpZDsKKyAJCSAgICBicmVhazsK
KyAJCX0KKyAKKyAJCXA9bjsKKyAJICAgIH0KKyAJfSB3aGlsZShwKTsKKyAgICAgfQorICNlbmRp
ZgorIH0KKyAKICBzdGF0aWMgdm9pZCB1c2VyaWRfdG9pbnRlcm5hbChzdHJ1Y3QgbmFtZXNwYWNl
ICpuYW1lc3BhY2UsIGNoYXIgKnVzZXJpZCkKICB7CiAgICAgIGNoYXIgaGllcnNlcF9vcmlnID0g
bmFtZXNwYWNlLT5oaWVyX3NlcDsKKioqKioqKioqKioqKioqCioqKiAxODkyLDE4OTcgKioqKgot
LS0gMTk3MSwxOTc3IC0tLS0KICAKICAgICAgLyogVHJhbnNsYXRlIGFueSBzZXBhcmF0b3JzIGlu
IHVzZXJpZCAqLwogICAgICB1c2VyaWRfdG9pbnRlcm5hbCgmaW1hcGRfbmFtZXNwYWNlLCBpbWFw
ZF91c2VyaWQpOworICAgICBpbWFwZF9sb2dnZWR1c2VyX2luaXQoKTsKICAKICAgICAgZnJlZWJ1
ZigmcGFzc3dkYnVmKTsKICAKKioqKioqKioqKioqKioqCioqKiAyMDM5LDIwNDQgKioqKgotLS0g
MjExOSwyMTI1IC0tLS0KICAKICAgICAgLyogVHJhbnNsYXRlIGFueSBzZXBhcmF0b3JzIGluIHVz
ZXJpZCAqLwogICAgICB1c2VyaWRfdG9pbnRlcm5hbCgmaW1hcGRfbmFtZXNwYWNlLCBpbWFwZF91
c2VyaWQpOworICAgICBpbWFwZF9sb2dnZWR1c2VyX2luaXQoKTsKICAKICAgICAgYXV0b2NyZWF0
ZV9pbmJveCgpOwogIApkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFw
L2ltYXBkLmggY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvaW1hcGQuaAoqKiogY3lydXMtaW1hcGQt
Mi4yLjEyLm9sZC9pbWFwL2ltYXBkLmgJMjAwNS0xMS0wMiAxNzo1NjozMCArMDMwMAotLS0gY3ly
dXMtaW1hcGQtMi4yLjEyL2ltYXAvaW1hcGQuaAkyMDA1LTExLTAzIDE3OjUzOjA4ICswMzAwCioq
KioqKioqKioqKioqKgoqKiogNTEsNTYgKioqKgotLS0gNTEsNTggLS0tLQogIAogIC8qIFVzZXJp
ZCBjbGllbnQgaGFzIGxvZ2dlZCBpbiBhcyAqLwogIGV4dGVybiBjaGFyICppbWFwZF91c2VyaWQ7
CisgLyogY29udmVydCBvdGhlciB1c2VycyBpZHMgYmV0d2VlbiBuYW1lc3BhY2VzIChzd2l0Y2gp
ICovCisgaW50IGltYXBkX2NvbnZlcnR1c2VyaWQ7CiAgCiAgLyogQXV0aG9yaXphdGlvbiBzdGF0
ZSBmb3IgbG9nZ2VkIGluIHVzZXJpZCAqLwogIGV4dGVybiBzdHJ1Y3QgYXV0aF9zdGF0ZSAqaW1h
cGRfYXV0aHN0YXRlOwpkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFw
L2xkYXBkLmMgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbGRhcGQuYwoqKiogY3lydXMtaW1hcGQt
Mi4yLjEyLm9sZC9pbWFwL2xkYXBkLmMJMTk3MC0wMS0wMSAwMzowMDowMCArMDMwMAotLS0gY3ly
dXMtaW1hcGQtMi4yLjEyL2ltYXAvbGRhcGQuYwkyMDA1LTExLTAzIDE3OjUzOjQwICswMzAwCioq
KioqKioqKioqKioqKgoqKiogMCAqKioqCi0tLSAxLDM1MyAtLS0tCisgI2luY2x1ZGUgPHN5cy90
eXBlcy5oPgorICNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+CisgI2luY2x1ZGUgPHN5cy91bi5oPgor
ICNpbmNsdWRlIDxzeXNsb2cuaD4KKyAjaW5jbHVkZSA8c3lzL3N0YXQuaD4KKyAjaW5jbHVkZSA8
c3RkaW8uaD4KKyAjaW5jbHVkZSA8c3RkbGliLmg+CisgI2luY2x1ZGUgPGVycm5vLmg+CisgI2lu
Y2x1ZGUgPGFzc2VydC5oPgorICNpZmRlZiBIQVZFX1VOSVNURF9ICisgI2luY2x1ZGUgPHVuaXN0
ZC5oPgorICNlbmRpZgorICNpbmNsdWRlIDxsYmVyLmg+CisgI2luY2x1ZGUgPGxkYXAuaD4KKyAK
KyAjaW5jbHVkZSAibGRhcGQuaCIKKyAjaW5jbHVkZSAiZ2xvYmFsLmgiCisgI2luY2x1ZGUgImNo
YXJzZXRfY29udmVydC5oIgorICNpbmNsdWRlICJleGl0Y29kZXMuaCIKKyAKKyAvKiBnbG9iYWwg
c3RhdGUgKi8KKyBjb25zdCBpbnQgY29uZmlnX25lZWRfZGF0YSA9IDA7CisgCisgc3RhdGljIExE
QVAgKmxkYXBfc2Vzc2lvbj1OVUxMOworIAorIHN0YXRpYyBjaGFyICpsZGFwX2hvc3Q9Imtpbmsi
OworIHN0YXRpYyBpbnQgbGRhcF9wb3J0PUxEQVBfUE9SVDsKKyBzdGF0aWMgY2hhciAqbGRhcF91
c2VyPSJjbj1tYW5hZ2VyLGRjPWVsYnJ1cyxkYz1ydSI7Cisgc3RhdGljIGNoYXIgKmxkYXBfcGFz
c3dvcmQ9InNlY3JldCI7Cisgc3RhdGljIGNoYXIgKmxkYXBfYmFzZT0iZGM9ZWxicnVzLGRjPXJ1
IjsKKyAKKyAjZGVmaW5lIExEQVBfRklMVEVSX0lOVCAiKHVpZD0lLipzKSIKKyAjZGVmaW5lIExE
QVBfRklMVEVSX0lOVF9MRU4gKHNpemVvZihMREFQX0ZJTFRFUl9JTlQpIC0gMSkKKyAjZGVmaW5l
IExEQVBfRklMVEVSX0VYVCAiKHNuPSUuKnMpIgorICNkZWZpbmUgTERBUF9GSUxURVJfRVhUX0xF
TiAoc2l6ZW9mKExEQVBfRklMVEVSX0VYVCkgLSAxKQorICNkZWZpbmUgTERBUF9BVFRSX0lOVCAi
c24iCisgI2RlZmluZSBMREFQX0FUVFJfRVhUICJ1aWQiCisgCisgc3RhdGljIGludCBuX2xpc3Rl
bmVycz0wOworIAorIHZvaWQgZmF0YWwoY29uc3QgY2hhciAqbXNnLCBpbnQgZXJyKQorIHsKKyAg
ICAgc3lzbG9nKExPR19DUklULCAiJXMiLCBtc2cpOworICAgICBzeXNsb2coTE9HX05PVElDRSwg
ImV4aXRpbmciKTsKKyAKKyAgICAgY3lydXNfZG9uZSgpOworICAgICAKKyAgICAgZXhpdChlcnIp
OworIH0KKyAKKyB2b2lkIGxkYXBfY2xlYW51cCgpCisgeworICAgICBpZihsZGFwX3Nlc3Npb24p
IHsKKyAJbGRhcF91bmJpbmRfcyhsZGFwX3Nlc3Npb24pOworIAlsZGFwX3Nlc3Npb249TlVMTDsK
KyAgICAgfQorIH0KKyAKKyAvKiAnZG9tYWluJyBhbmQgJ2RvbWFpbmxlbicgdmFyaWFibGVzIGFy
ZSBpZ25vcmVkIG5vdyAqLworIHN0YXRpYyBpbnQgZ2V0X2lkX2Zyb21fbGRhcChjb25zdCBjaGFy
ICppbiwgaW50IGluX2xlbiwgY29uc3QgY2hhciAqZG9tYWluLCBpbnQgZG9tYWlubGVuLCBjaGFy
ICpvdXQsIGludCAqb3V0X2xlbiwgaW50IGludDJleHQpCisgeworICAgICBMREFQTWVzc2FnZSAq
bGRhcF9yZXM7CisgICAgIGNoYXIgKmluX2xkYXA7CisgICAgIGludCBpbl9sZGFwX2xlbjsKKyAg
ICAgY2hhciAqbGRhcF9maWx0ZXJfdGVtcGxhdGU7CisgICAgIGludCBsZGFwX2ZpbHRlcl90ZW1w
bGF0ZV9sZW47CisgICAgIGNoYXIgKmxkYXBfZmlsdGVyOworICAgICBjaGFyICpsZGFwX2F0dHJz
WzJdOworIAorICAgICAvKiBJbnB1dCBidWZmZXIgJ2luJyBpcyBNVVRGLTcgc3RyaW5nIGluIGNh
c2UgaWYKKyAgICAgICAgZXh0ZXJuYWw9PmludGVybmFsLiBXZSBuZWVkIHRvIGNvbnZlcnQgaXQg
dG8gVVRGLTggZW5jb2RpbmcKKyAgICAgICAgYmVmb3JlIHF1ZXJ5aW5nIHRvIExEQVAuICovCisg
ICAgIGlmKCFpbnQyZXh0KSB7CisgCWNoYXIgKmluX3Rlc3Q7CisgCWludCBpbl90ZXN0X2xlbjsK
KyAKKyAJaWYoIShpbl9sZGFwID0gbXV0ZjdfdG9fdXRmOCgoY2hhciAqKWluLCBpbl9sZW4sICZp
bl9sZGFwX2xlbikpKQorIAkgICAgcmV0dXJuIDE7CisgCisgCS8qIGNoZWNrIGlmICdpbicgaXMg
YSB2YWxpZCBpbWFwLXV0Zi03IHN0cmluZyAqLworIAlpZighKGluX3Rlc3QgPSB1dGY4X3RvX211
dGY3KGluX2xkYXAsIGluX2xkYXBfbGVuLCAmaW5fdGVzdF9sZW4pKSkgeworIAkgICAgZnJlZShp
bl9sZGFwKTsKKyAJICAgIHJldHVybiAxOworIAl9CisgCisgCWlmKGluX3Rlc3RfbGVuIT1pbl9s
ZW4gfHwgbWVtY21wKGluLCBpbl90ZXN0LCBpbl9sZW4pKSB7CisgCSAgICBmcmVlKGluX2xkYXAp
OworIAkgICAgZnJlZShpbl90ZXN0KTsKKyAJICAgIHJldHVybiAxOworIAl9CisgCWZyZWUoaW5f
dGVzdCk7CisgCisgCWxkYXBfZmlsdGVyX3RlbXBsYXRlID0gTERBUF9GSUxURVJfRVhUOworIAls
ZGFwX2ZpbHRlcl90ZW1wbGF0ZV9sZW4gPSBMREFQX0ZJTFRFUl9FWFRfTEVOOworIAlsZGFwX2F0
dHJzWzBdID0gTERBUF9BVFRSX0VYVDsKKyAgICAgfQorICAgICBlbHNlIHsKKyAJaW5fbGRhcCA9
IChjaGFyICopaW47CisgCWluX2xkYXBfbGVuID0gaW5fbGVuOworIAlsZGFwX2ZpbHRlcl90ZW1w
bGF0ZSA9IExEQVBfRklMVEVSX0lOVDsKKyAJbGRhcF9maWx0ZXJfdGVtcGxhdGVfbGVuID0gTERB
UF9GSUxURVJfSU5UX0xFTjsKKyAJbGRhcF9hdHRyc1swXSA9IExEQVBfQVRUUl9JTlQ7CisgICAg
IH0KKyAKKyAgICAgLyogdG9kbzogd2UgbWF5IHBhcnNlICdpbicgc3RyaW5nIGxhdGVyICovCisg
CisgICAgIC8qIGlmIGEgY29ubmVjdGlvbiB0byBMREFQIHNlcnZlciBpcyBub3QgZXN0YWJsaXNo
ZWQgdGhlbiB0cnkgdG8KKyAgICAgICAgZXN0YWJsaXNoIGl0ICovCisgICAgIGlmKCFsZGFwX3Nl
c3Npb24pIHsKKyAJdm9pZCAqb3B0dmFsPUxEQVBfT1BUX09OOworIAorIAlpZighKGxkYXBfc2Vz
c2lvbiA9IGxkYXBfaW5pdChsZGFwX2hvc3QsIGxkYXBfcG9ydCkpIHx8CisgCSAgIGxkYXBfc2V0
X29wdGlvbihsZGFwX3Nlc3Npb24sIExEQVBfT1BUX1JFU1RBUlQsIG9wdHZhbCk9PS0xIHx8Cisg
CSAgIGxkYXBfc2ltcGxlX2JpbmRfcyhsZGFwX3Nlc3Npb24sIGxkYXBfdXNlciwgbGRhcF9wYXNz
d29yZCkhPUxEQVBfU1VDQ0VTUykgeworIAkgICAgbGRhcF9jbGVhbnVwKCk7CisgCSAgICByZXR1
cm4gMTsKKyAJfQorICAgICB9CisgCisgICAgIGxkYXBfZmlsdGVyID0gKGNoYXIgKiltYWxsb2Mo
c3RybGVuKGxkYXBfZmlsdGVyX3RlbXBsYXRlKStpbl9sZGFwX2xlbik7CisgICAgIGlmKCFsZGFw
X2ZpbHRlcikgeworIAlpZihpbl9sZGFwICE9IGluKQorIAkgICAgZnJlZShpbl9sZGFwKTsKKyAJ
cmV0dXJuIDE7CisgICAgIH0KKyAgICAgc3ByaW50ZihsZGFwX2ZpbHRlciwgbGRhcF9maWx0ZXJf
dGVtcGxhdGUsIGluX2xkYXBfbGVuLCBpbl9sZGFwKTsKKyAKKyAgICAgbGRhcF9hdHRyc1sxXT1O
VUxMOworIAorICAgICBpZihsZGFwX3NlYXJjaF9zKGxkYXBfc2Vzc2lvbiwgbGRhcF9iYXNlLCBM
REFQX1NDT1BFX1NVQlRSRUUsIGxkYXBfZmlsdGVyLCBsZGFwX2F0dHJzLCAwLCAmbGRhcF9yZXMp
IT1MREFQX1NVQ0NFU1MpIHsKKyAJaWYoaW5fbGRhcCAhPSBpbikKKyAJICAgIGZyZWUoaW5fbGRh
cCk7CisgCWZyZWUobGRhcF9maWx0ZXIpOworIAkvKiBkaXNjb25uZWN0IGZyb20gTERBUCBzZXJ2
ZXIgKHdlIHdpbGwgdHJ5IHRvIGNvbm5lY3QgYWdhaW4KKyAJICAgbGF0ZXIpICovCisgCWxkYXBf
Y2xlYW51cCgpOworIAlyZXR1cm4gMTsKKyAgICAgfQorICAgICBlbHNlIHsKKyAJY2hhciAqKnZh
bHM9TlVMTDsKKyAJY2hhciAqbm9uZW5jb2RlZF9vdXQ7CisgCWludCBub25lbmNvZGVkX2xlbjsK
KyAKKyAJaWYoaW5fbGRhcCAhPSBpbikKKyAJICAgIGZyZWUoaW5fbGRhcCk7CisgCWZyZWUobGRh
cF9maWx0ZXIpOworIAorIAlhc3NlcnQobGRhcF9yZXMpOworIAkvKiB0aGUgZXh0ZXJuYWwgbmFt
ZSBoYXNuJ3QgYmVlbiBmb3VuZCBvciB0aGVyZSBhcmUgbW9yZSB0aGFuCisgCSAgIG9uZSByZXN1
bHQgcmVjb3JkcyAqLworIAlpZihsZGFwX2NvdW50X2VudHJpZXMobGRhcF9zZXNzaW9uLCBsZGFw
X3JlcykhPTEpIHsKKyAJICAgIGxkYXBfbXNnZnJlZShsZGFwX3Jlcyk7CisgCisgCSAgICByZXR1
cm4gMTsKKyAJfQorIAllbHNlIHsKKyAJICAgIExEQVBNZXNzYWdlICplbnRyeTsKKyAJICAgIGNo
YXIgKmF0dHI7CisgCisgCSAgICBlbnRyeSA9IGxkYXBfZmlyc3RfZW50cnkobGRhcF9zZXNzaW9u
LCBsZGFwX3Jlcyk7CisgCSAgICBhc3NlcnQoZW50cnkpOworIAorIAkgICAgdmFscyA9IGxkYXBf
Z2V0X3ZhbHVlcyhsZGFwX3Nlc3Npb24sIGVudHJ5LCBsZGFwX2F0dHJzWzBdKTsKKyAJICAgIGFz
c2VydCh2YWxzICYmIGxkYXBfY291bnRfdmFsdWVzKHZhbHMpKTsKKyAKKyAJICAgIC8qIHNhdmUg
J3ZhbHNbMF0nIGFzIGFuIGV4dGVybmFsIG5hbWUgYW5kICdpbicgYXMgYW4gaW50ZXJuYWwKKyAJ
ICAgICAgIG9uZSAqLworIAkgICAgbm9uZW5jb2RlZF9vdXQgPSB2YWxzWzBdOworIAkgICAgbm9u
ZW5jb2RlZF9sZW4gPSBzdHJsZW4obm9uZW5jb2RlZF9vdXQpOworIAl9CisgCisgCS8qICdub25l
bmNvZGVkX291dCcgYnVmZmVyIGlzIGFuIFVURi04IGJ1ZmZlci4gV2UgbmVlZCB0bworIAkgICBj
b252ZXJ0IGl0IHRvIE1VVEYtNyBlbmNvZGluZyBpbiBjYXNlIGlmIGl0IGlzIGFuIGV4dGVybmFs
CisgCSAgIGJ1ZmZlci4gKi8KKyAJaWYoaW50MmV4dCkgeworIAkgICAgY2hhciAqdGVtcF9vdXQg
PSB1dGY4X3RvX211dGY3KG5vbmVuY29kZWRfb3V0LCBub25lbmNvZGVkX2xlbiwgb3V0X2xlbik7
CisgCSAgICBpZighdGVtcF9vdXQpCisgCQlyZXR1cm4gMTsKKyAJICAgIGlmKCpvdXRfbGVuID4g
TUFYX01BSUxCT1hfTkFNRSkgeworIAkJKm91dF9sZW4gPSAwOworIAkJZnJlZSh0ZW1wX291dCk7
CisgCQlyZXR1cm4gMTsKKyAJICAgIH0KKyAJICAgIG1lbWNweShvdXQsIHRlbXBfb3V0LCAqb3V0
X2xlbik7CisgCSAgICBmcmVlKHRlbXBfb3V0KTsKKyAJfQorIAllbHNlIHsKKyAJICAgIG1lbWNw
eShvdXQsIG5vbmVuY29kZWRfb3V0LCBub25lbmNvZGVkX2xlbik7CisgCSAgICAqb3V0X2xlbiA9
IG5vbmVuY29kZWRfbGVuOworIAl9CisgCisgCWlmKHZhbHMpCisgCSAgICBsZGFwX3ZhbHVlX2Zy
ZWUodmFscyk7CisgCWlmKGxkYXBfcmVzKQorIAkgICAgbGRhcF9tc2dmcmVlKGxkYXBfcmVzKTsK
KyAgICAgfQorIAorICAgICByZXR1cm4gMDsKKyB9CisgCisgaW50IG1haW4oaW50IGFyZ2MsIGNo
YXIgKiphcmd2KQorIHsKKyAgICAgaW50IG9wdDsKKyAgICAgaW50IHNlbmRfcywgcywgbGVuOwor
ICAgICBzdHJ1Y3Qgc29ja2FkZHJfaW4gbG9jYWw7CisgICAgIGxkYXBfZGF0YV90IGxkYXBkYXRh
OworICAgICBsZGFwX2RhdGFfcmVzdWx0X3QgbGRhcGRhdGFfcmVzdWx0OworICAgICBzdHJ1Y3Qg
c29ja2FkZHJfaW4gZnJvbTsKKyAgICAgc29ja2xlbl90IGZyb21sZW47CisgICAgIGZkX3NldCBy
ZWFkX3NldCwgcnNldDsKKyAgICAgaW50IG5mZHM7CisgICAgIHN0cnVjdCB0aW1ldmFsIHRpbWVv
dXQ7CisgICAgIHBpZF90IHBpZDsKKyAgICAgaW50IGZkOworICAgICBjaGFyICphbHRfY29uZmln
ID0gTlVMTDsKKyAgICAgaW50IGN1cmNoaWxkOworICAgICBpbnQgcG9ydF9udW07CisgCisgICAg
IHdoaWxlICgob3B0ID0gZ2V0b3B0KGFyZ2MsIGFyZ3YsICJDOiIpKSAhPSBFT0YpIHsKKyAJc3dp
dGNoIChvcHQpIHsKKyAgICAgICAgIGNhc2UgJ0MnOiAvKiBhbHQgY29uZmlnIGZpbGUgKi8KKyAg
ICAgICAgICAgICBhbHRfY29uZmlnID0gb3B0YXJnOworICAgICAgICAgICAgIGJyZWFrOworIAlj
YXNlICduJzoKKyAJICAgIG5fbGlzdGVuZXJzID0gYXRvaShvcHRhcmcpOworIAkgICAgaWYobl9s
aXN0ZW5lcnM8PTApIHsKKyAJCWZwcmludGYoc3RkZXJyLCAiaW52YWxpZCBudW1iZXIgb2YgbGlz
dGVuZXIgcHJvY2Vzc2VzXG4iKTsKKyAJCWV4aXQoRUNfVVNBR0UpOworIAkgICAgfQorIAkgICAg
YnJlYWs7CisgCWRlZmF1bHQ6CisgCSAgICBmcHJpbnRmKHN0ZGVyciwgImludmFsaWQgYXJndW1l
bnRcbiIpOworIAkgICAgZXhpdChFQ19VU0FHRSk7CisgCSAgICBicmVhazsKKyAJfQorICAgICB9
CisgCisgICAgIGN5cnVzX2luaXQoYWx0X2NvbmZpZywgImxkYXBkIiwgMCk7CisgCisgICAgIHBv
cnRfbnVtID0gY29uZmlnX2dldGludChJTUFQT1BUX0NPTlZFUlRVU0VSSURfVURQUE9SVCk7Cisg
ICAgIGlmKCFwb3J0X251bSkgeworIAlzeXNsb2coTE9HX0VSUiwgIkludmFsaWQgdmFsdWUgb2Yg
Y29udmVydHVzZXJpZF91ZHBwb3J0IGNvbmZpZyBvcHRpb25cbiIpOworIAlleGl0KDEpOworICAg
ICB9CisgCisgICAgIC8qIGNyZWF0ZSBzb2NrZXQgd2UgYXJlIGdvaW5nIHRvIHVzZSBmb3IgbGlz
dGVuaW5nICovCisgICAgIGlmICgocyA9IHNvY2tldChBRl9JTkVULCBTT0NLX0RHUkFNLCAwKSkg
PT0gLTEpIHsKKyAJcGVycm9yKCJzb2NrZXQiKTsKKyAJY3lydXNfZG9uZSgpOworIAlleGl0KDEp
OworICAgICB9CisgCisgICAgIG5fbGlzdGVuZXJzID0gY29uZmlnX2dldGludChJTUFQT1BUX0NP
TlZFUlRVU0VSSURfTl9MSVNURU5FUlMpOworICAgICBpZihuX2xpc3RlbmVyczw9MCkKKyAJbl9s
aXN0ZW5lcnM9MTsKKyAKKyAgICAgbG9jYWwuc2luX2ZhbWlseSA9IEFGX0lORVQ7CisgICAgIGlu
ZXRfcHRvbihBRl9JTkVULCAiMTI3LjAuMC4xIiwgJmxvY2FsLnNpbl9hZGRyKTsKKyAgICAgbG9j
YWwuc2luX3BvcnQgPSBodG9ucyhwb3J0X251bSk7CisgICAgIGxlbj1zaXplb2YobG9jYWwpOwor
IAorICAgICBpZiAoYmluZChzLCAoc3RydWN0IHNvY2thZGRyICopJmxvY2FsLCBsZW4pID09IC0x
KSB7CisgCXBlcnJvcigiYmluZCIpOworIAljeXJ1c19kb25lKCk7CisgCWV4aXQoMSk7CisgICAg
IH0KKyAKKyAgICAgZm9yKGN1cmNoaWxkPTA7IGN1cmNoaWxkPG5fbGlzdGVuZXJzOyBjdXJjaGls
ZCsrKSB7CisgCXBpZCA9IGZvcmsoKTsKKyAJaWYgKHBpZCA9PSAtMSkgeworIAkgICAgcGVycm9y
KCJmb3JrIik7CisgCSAgICBjeXJ1c19kb25lKCk7CisgCSAgICBleGl0KDEpOworIAl9CisgCQor
IAlpZiAocGlkICE9IDApIHsgLyogcGFyZW50ICovCisgCSAgICBjb250aW51ZTsKKyAJfQorIAkv
KiBjaGlsZCAqLworIAlicmVhazsKKyAgICAgfQorIAorICAgICBpZiAocGlkICE9IDApIHsgLyog
cGFyZW50ICovCisgCWN5cnVzX2RvbmUoKTsKKyAJZXhpdCgwKTsKKyAgICAgfQorIAkKKyAgICAg
LyogY2hpbGQgKi8KKyAKKyAgICAgLyogZ2V0IHJlYWR5IGZvciBzZWxlY3QoKSAqLworICAgICBG
RF9aRVJPKCZyZWFkX3NldCk7CisgICAgIEZEX1NFVChzLCAmcmVhZF9zZXQpOworICAgICBuZmRz
ID0gcyArIDE7CisgCisgICAgIGZvciAoOzspIHsKKyAJaW50IG47CisgCisgCS8qIHRpbWVvdXQg
Zm9yIHNlbGVjdCBpcyAxIHNlY29uZCAqLworIAl0aW1lb3V0LnR2X3NlYyA9IDE7CisgCXRpbWVv
dXQudHZfdXNlYyA9IDA7CisgCisgCS8qIGNoZWNrIGZvciB0aGUgbmV4dCBpbnB1dCAqLworIAly
c2V0ID0gcmVhZF9zZXQ7CisgCW4gPSBzZWxlY3QobmZkcywgJnJzZXQsIE5VTEwsIE5VTEwsICZ0
aW1lb3V0KTsKKyAJaWYgKG4gPCAwICYmIGVycm5vID09IEVBR0FJTikgY29udGludWU7CisgCWlm
IChuIDwgMCAmJiBlcnJubyA9PSBFSU5UUikgY29udGludWU7CisgCWlmIChuID09IC0xKSB7Cisg
CSAgICAvKiB1aCBvaCAqLworIAkgICAgc3lzbG9nKExPR19FUlIsICJzZWxlY3QoKTogJW0iKTsK
KyAJICAgIGNsb3NlKHMpOworIAkgICAgZmF0YWwoInNlbGVjdCBlcnJvciIsLTEpOworIAl9Cisg
CisgCS8qIHJlYWQgb24gaW5ldCBzb2NrZXQgKi8KKyAJaWYgKEZEX0lTU0VUKHMsICZyc2V0KSkg
eworIAkgICAgZnJvbWxlbiA9IHNpemVvZihmcm9tKTsKKyAJICAgIG4gPSByZWN2ZnJvbShzLCAo
dm9pZCopICZsZGFwZGF0YSwgc2l6ZW9mKGxkYXBfZGF0YV90KSwgMCwKKyAJCQkgKHN0cnVjdCBz
b2NrYWRkciAqKSAmZnJvbSwgJmZyb21sZW4pOworIAorIAkgICAgaWYgKG4gPiAwKSB7CisgCQlp
ZiAobiA8PSBMREFQREFUQV9CQVNFX1NJWkUgfHwKKyAJCSAgICBsZGFwZGF0YS51c2VybGVuIDwg
bi1MREFQREFUQV9CQVNFX1NJWkUpCisgCQkgICAgc3lzbG9nKExPR19FUlIsICJJbnZhbGlkIG1l
c3NhZ2UgcmVjZWl2ZWQsIHNpemU9JWRcbiIsIG4pOworIAkJZWxzZSB7CisgCQkgICAgaW50IHJl
c3VsdGxlbj0wOworIAorIAkJICAgIGxkYXBkYXRhX3Jlc3VsdC5jb2RlPWdldF9pZF9mcm9tX2xk
YXAoCisgCQkJICAgbGRhcGRhdGEuYnVmLCBsZGFwZGF0YS51c2VybGVuLAorIAkJCSAgIGxkYXBk
YXRhLmJ1ZitsZGFwZGF0YS51c2VybGVuLCBuLUxEQVBEQVRBX0JBU0VfU0laRS1sZGFwZGF0YS51
c2VybGVuLAorIAkJCSAgIGxkYXBkYXRhX3Jlc3VsdC5idWYsICZyZXN1bHRsZW4sCisgCQkJICAg
bGRhcGRhdGEuaW50MmV4dCk7CisgCQkgICAgaWYoc2VuZHRvKHMsICh2b2lkICopJmxkYXBkYXRh
X3Jlc3VsdCwgcmVzdWx0bGVuK0xEQVBEQVRBX1JFU1VMVF9CQVNFX1NJWkUsMCwoc3RydWN0IHNv
Y2thZGRyICopJmZyb20sZnJvbWxlbik9PS0xKQorIAkJCXN5c2xvZyhMT0dfRVJSLCAiQ2Fubm90
IHNlbmQgYW4gYW5zd2VyOiAlc1xuIiwgc3RyZXJyb3IoZXJybm8pKTsKKyAJCX0KKyAJICAgIH0K
KyAJfSBlbHNlIHsKKyAJICAgIC8qIGxvZyBzb21lIHNvcnQgb2YgZXJyb3IgKi8JICAgIAorIAl9
CisgCisgICAgIH0KKyAKKyAgICAgY3lydXNfZG9uZSgpOworIAorICAgICAvKiBuZXZlciBnZXRz
IGhlcmUgKi8gICAgICAKKyAgICAgZXhpdCgxKTsKKyB9CisgCisgdm9pZCBwcmludHN0cmluZyhj
b25zdCBjaGFyICpzIF9fYXR0cmlidXRlX18oKHVudXNlZCkpKQorIHsgCisgICAgIC8qIG5lZWRl
ZCB0byBsaW5rIGFnYWluc3QgYW5ub3RhdGUubyAqLworICAgICBmYXRhbCgicHJpbnRzdHJpbmco
KSBleGVjdXRlZCEhISIsCisgICAgICAgICAgIEVDX1NPRlRXQVJFKTsKKyB9CmRpZmYgLU4gLUMg
MyAtciBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvbGRhcGQuaCBjeXJ1cy1pbWFwZC0yLjIu
MTIvaW1hcC9sZGFwZC5oCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvbGRhcGQuaAkx
OTcwLTAxLTAxIDAzOjAwOjAwICswMzAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9sZGFw
ZC5oCTIwMDUtMTEtMDMgMTc6NTM6NDAgKzAzMDAKKioqKioqKioqKioqKioqCioqKiAwICoqKioK
LS0tIDEsMjcgLS0tLQorICNpZm5kZWYgX0xEQVBEX0gKKyAjZGVmaW5lIF9MREFQRF9ICisgCisg
I2luY2x1ZGUgIm1haWxib3guaCIKKyAKKyAvKiBzb2NrZXQgdG8gY29tbXVuaWNhdGUgd2l0aCB0
aGUgbGRhcGQgKi8KKyAjZGVmaW5lIEZOQU1FX0NPTlZFUlRVU0VSSURfU09DSyAiL3NvY2tldC9s
ZGFwIgorIAorIHR5cGVkZWYgc3RydWN0IGxkYXBfZGF0YV9zIHsKKyAgICAgdW5zaWduZWQgbG9u
ZyBpbnQyZXh0OworICAgICB1bnNpZ25lZCBsb25nIHVzZXJsZW47IC8qIGxlbmd0aCBvZiB0aGUg
dXNlcm5hbWUgYnVmZmVyICovCisgCisgICAgIC8qIG5vbi1udWxsLXRlcm1pbmF0ZWQgYnVmZmVy
IGZvciB1c2VybmFtZSBhbmQgZG9tYWluICovCisgICAgIGNoYXIgYnVmW01BWF9NQUlMQk9YX05B
TUUqMl07CisgfSBsZGFwX2RhdGFfdDsKKyAKKyB0eXBlZGVmIHN0cnVjdCBsZGFwX2RhdGFfcmVz
dWx0X3MgeworICAgICB1bnNpZ25lZCBsb25nIGNvZGU7CisgCisgICAgIC8qIG5vbi1udWxsLXRl
cm1pbmF0ZWQgYnVmZmVyIGZvciBjb252ZXJ0ZWQgdXNlcm5hbWUgKi8KKyAgICAgY2hhciBidWZb
TUFYX01BSUxCT1hfTkFNRV07CisgfSBsZGFwX2RhdGFfcmVzdWx0X3Q7CisgCisgI2RlZmluZSBM
REFQREFUQV9CQVNFX1NJWkUJKDIgKiBzaXplb2YodW5zaWduZWQgbG9uZykpCisgI2RlZmluZSBM
REFQREFUQV9SRVNVTFRfQkFTRV9TSVpFCShzaXplb2YodW5zaWduZWQgbG9uZykpCisgCisgI2Vu
ZGlmIC8qIF9MREFQRF9IICovCmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1pbWFwZC0yLjIuMTIub2xk
L2ltYXAvTWFrZWZpbGUuaW4gY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvTWFrZWZpbGUuaW4KKioq
IGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9NYWtlZmlsZS5pbgkyMDA1LTExLTAyIDE3OjU2
OjIxICswMzAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9NYWtlZmlsZS5pbgkyMDA1LTEx
LTAzIDE3OjUzOjA3ICswMzAwCioqKioqKioqKioqKioqKgoqKiogNjksNzUgKioqKgogIFNJRVZF
X0xJQlMgPSBAU0lFVkVfTElCU0AKICBJTUFQX0NPTV9FUlJfTElCUyA9IEBJTUFQX0NPTV9FUlJf
TElCU0AKICBMSUJfV1JBUCA9IEBMSUJfV1JBUEAKISBMSUJTID0gJChJTUFQX0xJQlMpICQoSU1B
UF9DT01fRVJSX0xJQlMpCiAgREVQTElCUyA9IC4uL2xpYi9saWJjeXJ1cy5hIC4uL2xpYi9saWJj
eXJ1c19taW4uYSBAREVQTElCU0AKICAKICBDRkxBR1MgPSBAQ0ZMQUdTQAotLS0gNjksNzUgLS0t
LQogIFNJRVZFX0xJQlMgPSBAU0lFVkVfTElCU0AKICBJTUFQX0NPTV9FUlJfTElCUyA9IEBJTUFQ
X0NPTV9FUlJfTElCU0AKICBMSUJfV1JBUCA9IEBMSUJfV1JBUEAKISBMSUJTID0gJChJTUFQX0xJ
QlMpICQoSU1BUF9DT01fRVJSX0xJQlMpIC1scmVkYmxhY2sgLWxsZGFwCiAgREVQTElCUyA9IC4u
L2xpYi9saWJjeXJ1cy5hIC4uL2xpYi9saWJjeXJ1c19taW4uYSBAREVQTElCU0AKICAKICBDRkxB
R1MgPSBAQ0ZMQUdTQAoqKioqKioqKioqKioqKioKKioqIDEwNCwxMTAgKioqKgogIAljb252ZXJ0
X2NvZGUubyBkdXBsaWNhdGUubyBzYXNsY2xpZW50Lm8gc2FzbHNlcnZlci5vIHNpZ25hbHMubyBc
CiAgCWFubm90YXRlLm8gc2VhcmNoX2VuZ2luZXMubyBzcXVhdC5vIHNxdWF0X2ludGVybmFsLm8g
bWJkdW1wLm8gXAogIAlpbWFwcGFyc2UubyB0ZWxlbWV0cnkubyB1c2VyLm8gbm90aWZ5Lm8gcHJv
dG9jb2wubyBxdW90YV9kYi5vIFwKISAJYXV0b3NpZXZlLm8gJChTRUVOKSAkKElETEUpCiAgCiAg
SU1BUERPQkpTPXB1c2hzdGF0cy5vIGJhY2tlbmQubyBpbWFwZC5vIGluZGV4Lm8gdGxzLm8gdmVy
c2lvbi5vCiAgCi0tLSAxMDQsMTEwIC0tLS0KICAJY29udmVydF9jb2RlLm8gZHVwbGljYXRlLm8g
c2FzbGNsaWVudC5vIHNhc2xzZXJ2ZXIubyBzaWduYWxzLm8gXAogIAlhbm5vdGF0ZS5vIHNlYXJj
aF9lbmdpbmVzLm8gc3F1YXQubyBzcXVhdF9pbnRlcm5hbC5vIG1iZHVtcC5vIFwKICAJaW1hcHBh
cnNlLm8gdGVsZW1ldHJ5Lm8gdXNlci5vIG5vdGlmeS5vIHByb3RvY29sLm8gcXVvdGFfZGIubyBc
CiEgCWF1dG9zaWV2ZS5vIGNoYXJzZXRfY29udmVydC5vICQoU0VFTikgJChJRExFKQogIAogIElN
QVBET0JKUz1wdXNoc3RhdHMubyBiYWNrZW5kLm8gaW1hcGQubyBpbmRleC5vIHRscy5vIHZlcnNp
b24ubwogIAoqKioqKioqKioqKioqKioKKioqIDE5MCwxOTUgKioqKgotLS0gMTkwLDE5OSAtLS0t
CiAgCSQoQ0MpICQoTERGTEFHUykgLW8gaWRsZWQgXAogIAkgaWRsZWQubyBtdXRleF9mYWtlLm8g
bGliaW1hcC5hICQoU0lFVkVfTElCUykgJChERVBMSUJTKSAkKExJQlMpCiAgCisgbGRhcGQ6IGxk
YXBkLm8gbXV0ZXhfZmFrZS5vIGxpYmltYXAuYSAkKERFUExJQlMpCisgCSQoQ0MpICQoTERGTEFH
UykgLW8gbGRhcGQgXAorIAkgbGRhcGQubyBtdXRleF9mYWtlLm8gbGliaW1hcC5hICQoU0lFVkVf
TElCUykgJChERVBMSUJTKSAkKExJQlMpCisgCiAgbG10cGQ6IGxtdHBkLm8gJChMTVRQT0JKUykg
JChTSUVWRV9PQkpTKSBtdXRleF9mYWtlLm8gbGliaW1hcC5hICQoU0lFVkVfTElCUykgXAogIAkk
KERFUExJQlMpICQoU0VSVklDRSkKICAJJChDQykgJChMREZMQUdTKSAtbyBsbXRwZCBcCmRpZmYg
LU4gLUMgMyAtciBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvbWJveGxpc3QuYyBjeXJ1cy1p
bWFwZC0yLjIuMTIvaW1hcC9tYm94bGlzdC5jCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2lt
YXAvbWJveGxpc3QuYwkyMDA1LTExLTAyIDE3OjU3OjAxICswMzAwCi0tLSBjeXJ1cy1pbWFwZC0y
LjIuMTIvaW1hcC9tYm94bGlzdC5jCTIwMDUtMTEtMDMgMTc6NTM6MDggKzAzMDAKKioqKioqKioq
KioqKioqCioqKiAxODc5LDE4ODkgKioqKgogIAl9CiAgCiAgICAgICAgCS8qIG1ha2Ugc3VyZSBp
dCdzIGluIHRoZSBtYWlsYm94ZXMgZGIgKi8KISAJaWYgKHJvY2stPmNoZWNrbWJveGxpc3QpIHsK
ISAJICAgIHIgPSBtYm94bGlzdF9sb29rdXAobmFtZWJ1ZiwgTlVMTCwgTlVMTCwgTlVMTCk7CiEg
CX0gZWxzZSB7CiEgCSAgICByID0gMDsJCS8qIGRvbid0IGJvdGhlciBjaGVja2luZyAqLwohIAl9
CiAgCiAgCS8qIHJpZ2h0IHdvcmsgd2l0aCBhbiBhbHRlcm5hdGUgKG5vdCB0aGUgYnVpbGQtaW4p
CiAgCSAgIG5hbWVzcGFjZSAvLyBzb3JjZXJlciAqLwotLS0gMTg3OSwxODg5IC0tLS0KICAJfQog
IAogICAgICAgIAkvKiBtYWtlIHN1cmUgaXQncyBpbiB0aGUgbWFpbGJveGVzIGRiICovCiEgIAlp
ZiAocm9jay0+Y2hlY2ttYm94bGlzdCkgewohICAJICAgIHIgPSBtYm94bGlzdF9sb29rdXAobmFt
ZWJ1ZiwgTlVMTCwgTlVMTCwgTlVMTCk7CiEgIAl9IGVsc2UgewohIAkgICAgciA9IDA7CiEgIAl9
CiAgCiAgCS8qIHJpZ2h0IHdvcmsgd2l0aCBhbiBhbHRlcm5hdGUgKG5vdCB0aGUgYnVpbGQtaW4p
CiAgCSAgIG5hbWVzcGFjZSAvLyBzb3JjZXJlciAqLwpkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1h
cGQtMi4yLjEyLm9sZC9pbWFwL21ib3huYW1lLmMgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJv
eG5hbWUuYwoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL21ib3huYW1lLmMJMjAwNS0x
MS0wMiAxNzo1NzowMSArMDMwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJveG5hbWUu
YwkyMDA1LTExLTAzIDE3OjUzOjA4ICswMzAwCioqKioqKioqKioqKioqKgoqKiogNTcsNjIgKioq
KgotLS0gNTcsNjkgLS0tLQogIAogICNpbmNsdWRlICJtYm94bmFtZS5oIgogICNpbmNsdWRlICJt
Ym94bGlzdC5oIgorICNpbmNsdWRlICJpbWFwZC5oIgorIAorICNpZmRlZiBFTkFCTEVfQ09OVkVS
VF9VU0VSSUQKKyAjaW5jbHVkZSA8cmVkYmxhY2suaD4KKyAjaW5jbHVkZSA8c3lzbG9nLmg+Cisg
I2luY2x1ZGUgImxkYXBkLmgiCisgI2VuZGlmIC8qIEVOQUJMRV9DT05WRVJUX1VTRVJJRCAqLwog
IAogIC8qIE1haWxib3ggcGF0dGVybnMgd2hpY2ggdGhlIGRlc2lnbiBvZiB0aGUgc2VydmVyIHBy
b2hpYml0cyAqLwogIHN0YXRpYyBjaGFyICpiYWRtYm94cGF0dGVybnNbXSA9IHsKKioqKioqKioq
KioqKioqCioqKiA5NSwxMDAgKioqKgotLS0gMTAyLDQzOCAtLS0tCiAgfTsKICAjZGVmaW5lIENI
QVJNT0Q2NChjKSAgKGluZGV4X21vZDY0Wyh1bnNpZ25lZCBjaGFyKShjKV0pCiAgCisgI2lmZGVm
IEVOQUJMRV9DT05WRVJUX1VTRVJJRAorIHR5cGVkZWYgc3RydWN0IF9yYnRfZGF0YV90IHsKKyAg
ICAgY2hhciAqZG9tYWluOworICAgICBjaGFyICppZF9pbjsKKyAgICAgaW50IGlkX2luX2xlbjsK
KyAgICAgY2hhciAqaWRfb3V0OworICAgICBpbnQgaWRfb3V0X2xlbjsKKyB9IHJidF9kYXRhX3Q7
CisgCisgc3RhdGljIHN0cnVjdCByYnRyZWUgKnJidF9pbnRfdG9fZXh0PU5VTEw7Cisgc3RhdGlj
IHN0cnVjdCByYnRyZWUgKnJidF9leHRfdG9faW50PU5VTEw7CisgCisgc3RhdGljIGludCBjb252
ZXJ0dXNlcmlkX3NvY2tldD0tMTsKKyAKKyBpbnQgcmJ0X2RhdGFfY29tcGFyZShjb25zdCB2b2lk
ICpwMSwgY29uc3Qgdm9pZCAqcDIsIGNvbnN0IHZvaWQgKmNvbmZpZykKKyB7CisgICAgIHJidF9k
YXRhX3QgKmQxPShyYnRfZGF0YV90ICopcDE7CisgICAgIHJidF9kYXRhX3QgKmQyPShyYnRfZGF0
YV90ICopcDI7CisgICAgIGludCByZXM7CisgCisgICAgIGlmKCEocmVzPXN0cmNtcChkMS0+ZG9t
YWluLCBkMi0+ZG9tYWluKSkpIHsKKyAJY2hhciAqc3RyMSwgKnN0cjI7CisgCWludCBzdHIxX2xl
biwgc3RyMl9sZW47CisgCWludCBtaW5fbGVuOworIAorIAlpZihjb25maWcpIHsKKyAJICAgIHN0
cjE9ZDEtPmlkX2luOworIAkgICAgc3RyMV9sZW49ZDEtPmlkX2luX2xlbjsKKyAJICAgIHN0cjI9
ZDItPmlkX2luOworIAkgICAgc3RyMl9sZW49ZDItPmlkX2luX2xlbjsKKyAJfQorIAllbHNlIHsK
KyAJICAgIHN0cjE9ZDEtPmlkX291dDsKKyAJICAgIHN0cjFfbGVuPWQxLT5pZF9vdXRfbGVuOwor
IAkgICAgc3RyMj1kMi0+aWRfb3V0OworIAkgICAgc3RyMl9sZW49ZDItPmlkX291dF9sZW47Cisg
CX0KKyAJbWluX2xlbiA9IChzdHIxX2xlbiA8IHN0cjJfbGVuKT8gc3RyMV9sZW4gOiBzdHIyX2xl
bjsKKyAJaWYoIShyZXM9bWVtY21wKHN0cjEsIHN0cjIsIG1pbl9sZW4pKSkgeworIAkgICAgaWYo
bWluX2xlbj09c3RyMV9sZW4pCisgCQlyZXMgPSAobWluX2xlbj09c3RyMl9sZW4pPzA6LTE7Cisg
CSAgICBlbHNlCisgCQlyZXMgPSAtMTsKKyAJfQorICAgICB9CisgICAgIHJldHVybiByZXM7Cisg
fQorIAorICNkZWZpbmUgRE9OVF9BTExPQ0FURV9JTiAgMHgxCisgI2RlZmluZSBET05UX0FMTE9D
QVRFX09VVCAweDIKKyAKKyByYnRfZGF0YV90ICpyYnRfaW5pdF91c2VyaWRfZGF0YShjb25zdCBj
aGFyICpkb21haW4sIGNvbnN0IGNoYXIgKmluLCBpbnQgaW5fbGVuLCBjb25zdCBjaGFyICpvdXQs
IGludCBvdXRfbGVuLCBpbnQgZmxhZ3MpCisgeworICAgICByYnRfZGF0YV90ICpyZXM9KHJidF9k
YXRhX3QgKiltYWxsb2Moc2l6ZW9mKHJidF9kYXRhX3QpKTsKKyAKKyAgICAgaWYoIXJlcykKKyAJ
cmV0dXJuIE5VTEw7CisgCisgICAgIHJlcy0+ZG9tYWluID0gc3RyZHVwKGRvbWFpbik7CisgICAg
IGlmKCFyZXMtPmRvbWFpbikgeworIAlmcmVlKHJlcyk7CisgCXJldHVybiBOVUxMOworICAgICB9
CisgCisgICAgIGlmKGluID09IG91dCAmJiAoZmxhZ3MgJiAoRE9OVF9BTExPQ0FURV9JTnxET05U
X0FMTE9DQVRFX09VVCkpKQorIAlmbGFncyB8PSAoRE9OVF9BTExPQ0FURV9JTnxET05UX0FMTE9D
QVRFX09VVCk7CisgCisgICAgIGlmKGZsYWdzICYgRE9OVF9BTExPQ0FURV9JTikKKyAJcmVzLT5p
ZF9pbiA9IChjaGFyICopaW47CisgICAgIGVsc2UgaWYoIShyZXMtPmlkX2luID0gKGNoYXIgKilt
YWxsb2MoaW5fbGVuKSkpIHsKKyAJZnJlZShyZXMtPmRvbWFpbik7CisgCWZyZWUocmVzKTsKKyAJ
cmV0dXJuIE5VTEw7CisgICAgIH0KKyAgICAgZWxzZQorIAltZW1jcHkocmVzLT5pZF9pbiwgaW4s
IGluX2xlbik7CisgCisgICAgIGlmKGluID09IG91dCAmJiAhZmxhZ3MpIHsKKyAJb3V0ID0gcmVz
LT5pZF9pbjsKKyAJZmxhZ3MgfD0gRE9OVF9BTExPQ0FURV9PVVQ7CisgICAgIH0KKyAKKyAgICAg
aWYoZmxhZ3MgJiBET05UX0FMTE9DQVRFX09VVCkKKyAJcmVzLT5pZF9vdXQgPSAoY2hhciAqKW91
dDsKKyAgICAgZWxzZSBpZighKHJlcy0+aWRfb3V0ID0gKGNoYXIgKiltYWxsb2Mob3V0X2xlbikp
KSB7CisgCWZyZWUocmVzLT5kb21haW4pOworIAlpZighKGZsYWdzICYgRE9OVF9BTExPQ0FURV9J
TikpCisgCSAgICBmcmVlKHJlcy0+aWRfaW4pOworIAlmcmVlKHJlcyk7CisgCXJldHVybiBOVUxM
OworICAgICB9CisgICAgIGVsc2UKKyAJbWVtY3B5KHJlcy0+aWRfb3V0LCBvdXQsIG91dF9sZW4p
OworIAorICAgICByZXMtPmlkX2luX2xlbiA9IGluX2xlbjsKKyAgICAgcmVzLT5pZF9vdXRfbGVu
ID0gb3V0X2xlbjsKKyAKKyAgICAgcmV0dXJuIHJlczsKKyB9CisgCisgdm9pZCByYnRfZnJlZV91
c2VyaWRfZGF0YShyYnRfZGF0YV90ICpkYXRhKQorIHsKKyAgICAgZnJlZShkYXRhLT5kb21haW4p
OworICAgICBmcmVlKGRhdGEtPmlkX2luKTsKKyAgICAgaWYoZGF0YS0+aWRfaW4hPWRhdGEtPmlk
X291dCkKKyAJZnJlZShkYXRhLT5pZF9vdXQpOworICAgICBmcmVlKGRhdGEpOworIH0KKyAKKyAj
ZGVmaW5lIElOVEVSTkFMICAgICAgICAgICAgICAweDEKKyAjZGVmaW5lIExEQVBfTkFNRV9NVVNU
X0VYSVNUUyAweDIKKyAKKyBleHRlcm4gaW50IGNvbnZlcnR1c2VyaWRfaW5pdCgpCisgeworICAg
ICBjb25zdCBjaGFyICpjb252ZXJ0dXNlcmlkX3NvY2s7CisgICAgIGludCBsb2NhbGxlbjsKKyAg
ICAgaW50IHBhdGhsZW47CisgICAgIG1vZGVfdCBvbGR1bWFzazsKKyAgICAgaW50IHBvcnRfbnVt
OworICAgICBzdHJ1Y3Qgc29ja2FkZHJfaW4gY29udmVydHVzZXJpZF9yZW1vdGU7CisgICAgIGlu
dCBjb252ZXJ0dXNlcmlkX3JlbW90ZV9sZW47CisgCisgICAgIC8qIGlmIHRoZSBzb2NrZXQgaXMg
YWxyZWFkeSBvcGVuLCByZXR1cm4gKi8KKyAgICAgaWYgKGNvbnZlcnR1c2VyaWRfc29ja2V0ICE9
IC0xKSB7CisgCXN5c2xvZyhMT0dfRVJSLCAiY29udmVydHVzZXJpZF9pbml0OiBtdXN0IG5vdCBi
ZSBjYWxsZWQgdHdpY2UiKTsKKyAJcmV0dXJuIC0xOworICAgICB9CisgCisgICAgIHBvcnRfbnVt
ID0gY29uZmlnX2dldGludChJTUFQT1BUX0NPTlZFUlRVU0VSSURfVURQUE9SVCk7CisgICAgIGlm
KCFwb3J0X251bSkgeworIAlzeXNsb2coTE9HX0VSUiwgIkludmFsaWQgdmFsdWUgb2YgY29udmVy
dHVzZXJpZF91ZHBwb3J0IGNvbmZpZyBvcHRpb25cbiIpOworIAlyZXR1cm4gLTE7CisgICAgIH0K
KyAKKyAgICAgaWYgKChjb252ZXJ0dXNlcmlkX3NvY2tldCA9IHNvY2tldChBRl9JTkVULCBTT0NL
X0RHUkFNLCAwKSkgPT0gLTEpIHsKKyAJc3lzbG9nKExPR19FUlIsICJjb252ZXJ0dXNlcmlkX2lu
aXQ6IGNhbid0IGNyZWF0ZSBhIHNvY2tldCIpOworIAlyZXR1cm4gLTE7CisgICAgIH0KKyAKKyAg
ICAgY29udmVydHVzZXJpZF9yZW1vdGUuc2luX2ZhbWlseSA9IEFGX0lORVQ7CisgICAgIGNvbnZl
cnR1c2VyaWRfcmVtb3RlLnNpbl9wb3J0ID0gaHRvbnMocG9ydF9udW0pOworICAgICBpbmV0X3B0
b24oQUZfSU5FVCwgIjEyNy4wLjAuMSIsICZjb252ZXJ0dXNlcmlkX3JlbW90ZS5zaW5fYWRkcik7
CisgICAgIGNvbnZlcnR1c2VyaWRfcmVtb3RlX2xlbiA9IHNpemVvZihjb252ZXJ0dXNlcmlkX3Jl
bW90ZSk7CisgCisgICAgIGlmKGNvbm5lY3QoY29udmVydHVzZXJpZF9zb2NrZXQsIChzdHJ1Y3Qg
c29ja2FkZHIgKikmY29udmVydHVzZXJpZF9yZW1vdGUsIGNvbnZlcnR1c2VyaWRfcmVtb3RlX2xl
bik9PS0xKSB7CisgCXN5c2xvZyhMT0dfRVJSLCAiY29udmVydHVzZXJpZF9pbml0OiBjYW4ndCBj
b25uZWN0IChkYXRhZ3JhbSkiKTsKKyAJcmV0dXJuIC0xOworICAgICB9CisgCisgICAgIHJldHVy
biAwOworIH0KKyAKKyBzdGF0aWMgY2hhciAqbWJveG5hbWVfZ2V0X2lkX2Zyb21fbGRhcChjb25z
dCBjaGFyICppbiwgaW50IGluX2xlbiwgY29uc3QgY2hhciAqZG9tYWluLCBpbnQgKm91dF9sZW4s
IGludCBmbGFncykKKyB7CisgICAgIGxkYXBfZGF0YV90IHNlbmRkYXRhOworICAgICBpbnQgZG9t
YWlubGVuPXN0cmxlbihkb21haW4pOworICAgICBzc2l6ZV90IHNpemU7CisgCisgICAgIHNlbmRk
YXRhLmludDJleHQgPSBmbGFncyZJTlRFUk5BTDsKKyAgICAgc2VuZGRhdGEudXNlcmxlbiA9IGlu
X2xlbjsKKyAgICAgbWVtY3B5KHNlbmRkYXRhLmJ1ZiwgaW4sIGluX2xlbik7CisgICAgIG1lbWNw
eShzZW5kZGF0YS5idWYraW5fbGVuLCBkb21haW4sIGRvbWFpbmxlbik7CisgCisgICAgIHNpemU9
c2VuZChjb252ZXJ0dXNlcmlkX3NvY2tldCwgKHZvaWQgKikmc2VuZGRhdGEsIExEQVBEQVRBX0JB
U0VfU0laRStpbl9sZW4rZG9tYWlubGVuLCAwKTsKKyAgICAgaWYoc2l6ZSA9PSAoc3NpemVfdCkt
MSkgeworIAlzeXNsb2coTE9HX0VSUiwgIkNhbm5vdCBzZW5kIGNvbnZlcnR1c2VyaWQgcXVlcnk6
ICVzLlxuIiwgc3RyZXJyb3IoZXJybm8pKTsKKyAJcmV0dXJuIE5VTEw7CisgICAgIH0KKyAgICAg
aWYoc2l6ZSAhPSBMREFQREFUQV9CQVNFX1NJWkUraW5fbGVuK2RvbWFpbmxlbikKKyAJc3lzbG9n
KExPR19FUlIsICJDYW5ub3Qgc2VuZCBmdWxsIGNvbnZlcnR1c2VyaWQgcXVlcnkuXG4iKTsKKyAK
KyAgICAgaWYoc2l6ZSkgeworIAlzdHJ1Y3Qgc29ja2FkZHJfdW4gZnJvbTsKKyAJc29ja2xlbl90
IGZyb21sZW49c2l6ZW9mKGZyb20pOworIAlsZGFwX2RhdGFfcmVzdWx0X3QgcmVjdmRhdGE7Cisg
CWNoYXIgKm91dDsKKyAKKyAJc2l6ZSA9IHJlY3YoY29udmVydHVzZXJpZF9zb2NrZXQsICh2b2lk
ICopJnJlY3ZkYXRhLCBzaXplb2YocmVjdmRhdGEpLCAwKTsKKyAJaWYoc2l6ZT09KHNzaXplX3Qp
LTEpIHsKKyAJICAgIHN5c2xvZyhMT0dfRVJSLCAiQ2Fubm90IHJlY2VpdmUgY29udmVydHVzZXJp
ZCBhbnN3ZXI6ICVzLlxuIiwgc3RyZXJyb3IoZXJybm8pKTsKKyAJICAgIHJldHVybiBOVUxMOwor
IAl9CisgCWlmKHNpemU8TERBUERBVEFfUkVTVUxUX0JBU0VfU0laRSkgeworIAkgICAgc3lzbG9n
KExPR19FUlIsICJXcm9uZyBzaXplIG9mIGNvbnZlcnR1c2VyaWQgYW5zd2VyLlxuIik7CisgCSAg
ICByZXR1cm4gTlVMTDsKKyAJfQorIAkvKiBhbnN3ZXIgaXMgImNhbid0IGNvbnZlcnQgdXNlcmlk
IiBvciByZXN1bHQgc3RyaW5nIGlzCisgCSAgIGVtcHR5ICovCisgCWlmKHJlY3ZkYXRhLmNvZGUg
fHwgc2l6ZT09TERBUERBVEFfUkVTVUxUX0JBU0VfU0laRSkKKyAJICAgIHJldHVybiBOVUxMOwor
IAlzaXplLT1MREFQREFUQV9SRVNVTFRfQkFTRV9TSVpFOworIAlvdXQ9KGNoYXIgKiltYWxsb2Mo
c2l6ZSk7CisgCWlmKCFvdXQpCisgCSAgICByZXR1cm4gTlVMTDsKKyAJbWVtY3B5KG91dCwgcmVj
dmRhdGEuYnVmLCBzaXplKTsKKyAJKm91dF9sZW4gPSBzaXplOworIAlyZXR1cm4gb3V0OworICAg
ICB9CisgCisgICAgIHJldHVybiBOVUxMOworIH0KKyAKKyBzdGF0aWMgY2hhciAqbWJveG5hbWVf
Z2V0X2lkKGNvbnN0IGNoYXIgKmluLCBpbnQgaW5fbGVuLCBjb25zdCBjaGFyICpkb21haW4sIGlu
dCAqb3V0X2xlbiwgc3RydWN0IHJidHJlZSAqKmNfaW50LCBzdHJ1Y3QgcmJ0cmVlICoqY19leHQs
IGludCBmbGFncykKKyB7CisgICAgIHJidF9kYXRhX3QgZGF0YTsKKyAgICAgcmJ0X2RhdGFfdCAq
c2F2ZWRfZGF0YTsKKyAgICAgY2hhciAqb3V0OworICAgICBpbnQgbmVlZF9hbGxvYz0wOworIAor
ICAgICBpZighKmNfaW50KQorIAlpZighKCpjX2ludCA9IHJiaW5pdChyYnRfZGF0YV9jb21wYXJl
LCAodm9pZCAqKSgoZmxhZ3MmSU5URVJOQUwpPjApKSkpCisgCSAgICByZXR1cm4gTlVMTDsKKyAg
ICAgaWYoISpjX2V4dCkKKyAJaWYoISgqY19leHQgPSByYmluaXQocmJ0X2RhdGFfY29tcGFyZSwg
KHZvaWQgKikoIShmbGFncyZJTlRFUk5BTCkpKSkpCisgCSAgICByZXR1cm4gTlVMTDsKKyAgICAg
ZGF0YS5kb21haW4gPSAoY2hhciAqKWRvbWFpbjsKKyAJICAgCisgICAgIGlmKGZsYWdzJklOVEVS
TkFMKSB7CisgCWRhdGEuaWRfaW4gPSAoY2hhciAqKWluOworIAlkYXRhLmlkX2luX2xlbiA9IGlu
X2xlbjsKKyAJZGF0YS5pZF9vdXQgPSBOVUxMOworIAlkYXRhLmlkX291dF9sZW4gPSAwOworICAg
ICB9CisgICAgIGVsc2UgeworIAlkYXRhLmlkX291dCA9IChjaGFyICopaW47CisgCWRhdGEuaWRf
b3V0X2xlbiA9IGluX2xlbjsKKyAJZGF0YS5pZF9pbiA9IE5VTEw7CisgCWRhdGEuaWRfaW5fbGVu
ID0gMDsKKyAgICAgfQorIAorICAgICAvKiBmaXJzdGx5IGxvb2sgZm9yIHRoZSBuYW1lIGluIHRo
ZSBsb2NhbCAoaW4tbWVtb3J5KSBzdG9yYWdlICovCisgICAgIGlmKChzYXZlZF9kYXRhPShyYnRf
ZGF0YV90ICopcmJmaW5kKCh2b2lkICopJmRhdGEsICpjX2ludCkpKSB7CisgCWlmKGZsYWdzJklO
VEVSTkFMKSB7CisgCSAgICAqb3V0X2xlbiA9IHNhdmVkX2RhdGEtPmlkX291dF9sZW47CisgCSAg
ICByZXR1cm4gc2F2ZWRfZGF0YS0+aWRfb3V0OworIAl9CisgCWVsc2UgeworIAkgICAgKm91dF9s
ZW4gPSBzYXZlZF9kYXRhLT5pZF9pbl9sZW47CisgCSAgICByZXR1cm4gc2F2ZWRfZGF0YS0+aWRf
aW47CisgCX0gCisgICAgIH0KKyAKKyAgICAgb3V0ID0gbWJveG5hbWVfZ2V0X2lkX2Zyb21fbGRh
cChpbiwgaW5fbGVuLCBkb21haW4sIG91dF9sZW4sIGZsYWdzKTsKKyAKKyAgICAgaWYoIW91dCkg
eworIAlpZihmbGFncyAmIExEQVBfTkFNRV9NVVNUX0VYSVNUUykKKyAJICAgIHJldHVybiBOVUxM
OworIAkvKiBzYXZlIHRoZSBpbnRlcm5hbCBuYW1lIGFzIGV4dGVybmFsIGlmIExEQVAgZmV0Y2hp
bmcgZmFpbHMgKi8KKyAJZWxzZSB7CisgCSAgICBvdXQ9KGNoYXIgKilpbjsKKyAJICAgICpvdXRf
bGVuPWluX2xlbjsKKyAJICAgIG5lZWRfYWxsb2M9MTsKKyAJfQorICAgICB9CisgICAgIAorICAg
ICAvKiBOb3cgd2UgaGF2ZSAnb3V0JyBhbmQgJypvdXRfbGVuJyB2YXJpYWJsZXMuIFNhdmUgJ2lu
JyBhbmQKKyAgICAgICAgJ291dCcgaW4gb3VyIG1lbW9yeSBkYXRhYmFzZXMgKi8KKyAgICAgaWYo
ZmxhZ3MmSU5URVJOQUwpCisgCXNhdmVkX2RhdGE9cmJ0X2luaXRfdXNlcmlkX2RhdGEoZG9tYWlu
LCBpbiwgaW5fbGVuLCBvdXQsICpvdXRfbGVuLCBuZWVkX2FsbG9jPzA6RE9OVF9BTExPQ0FURV9P
VVQpOworICAgICBlbHNlCisgCXNhdmVkX2RhdGE9cmJ0X2luaXRfdXNlcmlkX2RhdGEoZG9tYWlu
LCBvdXQsICpvdXRfbGVuLCBpbiwgaW5fbGVuLCBuZWVkX2FsbG9jPzA6RE9OVF9BTExPQ0FURV9J
Tik7CisgICAgIAorICAgICBpZighcmJzZWFyY2goc2F2ZWRfZGF0YSwqY19pbnQpKSB7CisgCXJi
dF9mcmVlX3VzZXJpZF9kYXRhKHNhdmVkX2RhdGEpOworIAlzYXZlZF9kYXRhPU5VTEw7CisgICAg
IH0KKyAgICAgZWxzZSBpZighcmJzZWFyY2goc2F2ZWRfZGF0YSwqY19leHQpKSB7CisgCXJiZGVs
ZXRlKHNhdmVkX2RhdGEsICpjX2ludCk7CisgCXJidF9mcmVlX3VzZXJpZF9kYXRhKHNhdmVkX2Rh
dGEpOworIAlzYXZlZF9kYXRhPU5VTEw7CisgICAgIH0KKyAKKyAgICAgLyogSWYgd2UgY2FuJ3Qg
c2F2ZSBkYXRhIGluIHRoZSBtZW1vcnkgc3RvcmFnZSB0aGVuIHJldHVybiBOVUxMCisgICAgICAg
IGJlY2F1c2Ugd2UgYXJlIG5vdCBzdXJlIGlmIGRhdGEgaW4gbGRhcCBzdG9yYWdlIHdpbGwgbm90
IGJlCisgICAgICAgIGNoYW5nZWQgd2hlbiB0aGlzIGZ1bmN0aW9uIGlzIGNhbGxlZCBuZXh0IHRp
bWUuIEZpeG1lOiBtYXliZSwKKyAgICAgICAgd2UgY2FuIHJldHVybiBjb252ZXJ0ZWQgc3RyaW5n
IGFueXdheS4gKi8KKyAgICAgaWYoIXNhdmVkX2RhdGEpCisgCXJldHVybiBOVUxMOworIAkgICAg
CisgICAgIHJldHVybiBvdXQ7CisgfQorIAorIHN0YXRpYyB2b2lkIHJidF93YWxrX2NiKGNvbnN0
IHZvaWQgKm5vZGVwLCBjb25zdCBWSVNJVCB3aGljaCwgY29uc3QgaW50IGRlcHRoLCB2b2lkICph
cmcpCisgeworICAgICBpZih3aGljaCA9PSBlbmRvcmRlciB8fCB3aGljaCA9PSBsZWFmKQorIAly
YnRfZnJlZV91c2VyaWRfZGF0YSgocmJ0X2RhdGFfdCAqKW5vZGVwKTsKKyB9CisgCisgLyogZGVz
dHJveWluZyBhbGwgdGhlIGRhdGEgbmVlZGVkIGZvciBuYW1lcyB0cmFuc2Zvcm1hdGlvbiAodGhp
cworICAgIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuIGNsaWVudCB0ZXJtaW5hdGVzIGhpcyBjb25u
ZWN0aW9uKSAqLworIGV4dGVybiB2b2lkIG1ib3huYW1lX2NsZWFudXAoKQorIHsKKyAgICAgcmJ0
X2RhdGFfdCAqZGF0YTsKKyAKKyAgICAgaWYocmJ0X2ludF90b19leHQpIHsKKyAJcmJ3YWxrKHJi
dF9pbnRfdG9fZXh0LCByYnRfd2Fsa19jYiwgTlVMTCk7CisgCSAgICAKKyAJcmJkZXN0cm95KHJi
dF9pbnRfdG9fZXh0KTsKKyAJcmJ0X2ludF90b19leHQ9TlVMTDsKKyAgICAgfQorICAgICBpZihy
YnRfZXh0X3RvX2ludCkgeworIAlyYmRlc3Ryb3kocmJ0X2V4dF90b19pbnQpOworIAlyYnRfZXh0
X3RvX2ludD1OVUxMOworICAgICB9CisgfQorIGV4dGVybiBpbnQgY29udmVydHVzZXJpZF9jbGVh
bnVwKCkKKyB7CisgICAgIGNsb3NlKGNvbnZlcnR1c2VyaWRfc29ja2V0KTsKKyB9CisgCisgI2Vu
ZGlmIC8qIEVOQUJMRV9DT05WRVJUX1VTRVJJRCAqLworIAorIHN0YXRpYyBjaGFyICptYm94bmFt
ZV9nZXRfZXh0ZXJuYWxfaWQoY29uc3QgY2hhciAqaW4sIGludCBpbl9sZW4sIGNvbnN0IGNoYXIg
KmRvbWFpbiwgaW50ICpvdXRfbGVuKQorIHsKKyAjaWZuZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJ
RAorICAgICAqb3V0X2xlbiA9IGluX2xlbjsKKyAgICAgcmV0dXJuIChjaGFyICopaW47CisgI2Vs
c2UKKyAgICAgcmV0dXJuIG1ib3huYW1lX2dldF9pZChpbiwgaW5fbGVuLCBkb21haW4sIG91dF9s
ZW4sICZyYnRfaW50X3RvX2V4dCwgJnJidF9leHRfdG9faW50LCBJTlRFUk5BTHxMREFQX05BTUVf
TVVTVF9FWElTVFMpOworICNlbmRpZgorIH0KKyAKKyBzdGF0aWMgY2hhciAqbWJveG5hbWVfZ2V0
X2ludGVybmFsX2lkKGNvbnN0IGNoYXIgKmluLCBpbnQgaW5fbGVuLCBjb25zdCBjaGFyICpkb21h
aW4sIGludCAqb3V0X2xlbikKKyB7CisgI2lmbmRlZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKyAg
ICAgKm91dF9sZW4gPSBpbl9sZW47CisgICAgIHJldHVybiAoY2hhciAqKWluOworICNlbHNlCisg
ICAgIHJldHVybiBtYm94bmFtZV9nZXRfaWQoaW4sIGluX2xlbiwgZG9tYWluLCBvdXRfbGVuLCAm
cmJ0X2V4dF90b19pbnQsICZyYnRfaW50X3RvX2V4dCwgTERBUF9OQU1FX01VU1RfRVhJU1RTKTsK
KyAjZW5kaWYKKyB9CiAgCiAgc3RhdGljIGludCBtYm94bmFtZV9jaGVja19oaWVyc2VwcyhzdHJ1
Y3QgbmFtZXNwYWNlICpuYW1lc3BhY2UsIGNvbnN0IGNoYXIgKm5hbWUsIGludCBuYW1lbGVuKQog
IHsKKioqKioqKioqKioqKioqCioqKiAyMDUsMjExICoqKioKICAJCQkJICAgY29uc3QgY2hhciAq
bmFtZSwKICAJCQkJICAgY29uc3QgY2hhciAqdXNlcmlkLCBjaGFyICpyZXN1bHQpCiAgewohICAg
ICBjaGFyICpjcDsKICAgICAgaW50IHVzZXJsZW4sIGRvbWFpbmxlbiA9IDAsIG5hbWVsZW47CiAg
ICAgIGludCBwcmVmaXhsZW47CiAgICAgIHNpemVfdCByZXN1bHRsZW47Ci0tLSA1NDMsNTQ5IC0t
LS0KICAJCQkJICAgY29uc3QgY2hhciAqbmFtZSwKICAJCQkJICAgY29uc3QgY2hhciAqdXNlcmlk
LCBjaGFyICpyZXN1bHQpCiAgewohICAgICBjaGFyICpjcCwgKmRvbWFpbj0iIjsKICAgICAgaW50
IHVzZXJsZW4sIGRvbWFpbmxlbiA9IDAsIG5hbWVsZW47CiAgICAgIGludCBwcmVmaXhsZW47CiAg
ICAgIHNpemVfdCByZXN1bHRsZW47CioqKioqKioqKioqKioqKgoqKiogMjIyLDIyOCAqKioqCiAg
ICAgIGlmIChjb25maWdfdmlydGRvbWFpbnMpIHsKICAJaWYgKHVzZXJpZCAmJiAoY3AgPSBzdHJj
aHIodXNlcmlkLCAnQCcpKSkgewogIAkgICAgLyogdXNlciBsb2dnZWQgaW4gYXMgdXNlckBkb21h
aW4gKi8KISAJICAgIHVzZXJsZW4gPSBjcCsrIC0gdXNlcmlkOwogIAkgICAgaWYgKCEoY29uZmln
X2RlZmRvbWFpbiAmJiAhc3RyY2FzZWNtcChjb25maWdfZGVmZG9tYWluLCBjcCkpKSB7CiAgCQkv
KiBkb24ndCBwcmVwZW5kIGRlZmF1bHQgZG9tYWluICovCiAgCQlkb21haW5sZW4gPSBzdHJsZW4o
Y3ApKzE7Ci0tLSA1NjAsNTY3IC0tLS0KICAgICAgaWYgKGNvbmZpZ192aXJ0ZG9tYWlucykgewog
IAlpZiAodXNlcmlkICYmIChjcCA9IHN0cmNocih1c2VyaWQsICdAJykpKSB7CiAgCSAgICAvKiB1
c2VyIGxvZ2dlZCBpbiBhcyB1c2VyQGRvbWFpbiAqLwohIAkgICAgdXNlcmxlbiA9IGNwIC0gdXNl
cmlkOwohIAkgICAgZG9tYWluID0gKytjcDsKICAJICAgIGlmICghKGNvbmZpZ19kZWZkb21haW4g
JiYgIXN0cmNhc2VjbXAoY29uZmlnX2RlZmRvbWFpbiwgY3ApKSkgewogIAkJLyogZG9uJ3QgcHJl
cGVuZCBkZWZhdWx0IGRvbWFpbiAqLwogIAkJZG9tYWlubGVuID0gc3RybGVuKGNwKSsxOwoqKioq
KioqKioqKioqKioKKioqIDIzMywyMzggKioqKgotLS0gNTcyLDU3OCAtLS0tCiAgCX0KICAJaWYg
KChjcCA9IHN0cnJjaHIobmFtZSwgJ0AnKSkpIHsKICAJICAgIC8qIG1haWxib3ggc3BlY2lmaWVk
IGFzIG1ib3hAZG9tYWluICovCisgCSAgICBkb21haW4gPSBjcCsxOwogIAkgICAgbmFtZWxlbiA9
IGNwIC0gbmFtZTsKICAKICAJICAgIGlmIChjb25maWdfZGVmZG9tYWluICYmICFzdHJjYXNlY21w
KGNvbmZpZ19kZWZkb21haW4sIGNwKzEpKSB7CioqKioqKioqKioqKioqKgoqKiogMjkwLDMwNyAq
KioqCiAgCiAgICAgIGlmICghc3RybmNtcChuYW1lLCBuYW1lc3BhY2UtPnByZWZpeFtOQU1FU1BB
Q0VfVVNFUl0sIHByZWZpeGxlbi0xKSAmJgogIAkobmFtZWxlbiA9PSBwcmVmaXhsZW4tMSB8fCBu
YW1lW3ByZWZpeGxlbi0xXSA9PSBuYW1lc3BhY2UtPmhpZXJfc2VwKSkgewogIAogIAlpZiAobmFt
ZWxlbiA9PSBwcmVmaXhsZW4tMSkgewogIAkgICAgLyogY2FuJ3QgY3JlYXRlIGZvbGRlcnMgdXNp
bmcgdW5kZWxpbWl0ZWQgcHJlZml4ICovCiAgCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5B
TUU7CiAgCX0KICAKISAJaWYgKGRvbWFpbmxlbituYW1lbGVuLXByZWZpeGxlbis1ID4gTUFYX01B
SUxCT1hfTkFNRSkgewohIAkgICAgcmV0dXJuIElNQVBfTUFJTEJPWF9CQUROQU1FOwogIAl9CiAg
CiEgCXNwcmludGYocmVzdWx0LCAidXNlci4lLipzIiwgbmFtZWxlbi1wcmVmaXhsZW4sIG5hbWUr
cHJlZml4bGVuKTsKICAKICAJLyogVHJhbnNsYXRlIGFueSBzZXBhcmF0b3JzIGluIHVzZXJpZCtt
YWlsYm94ICovCiAgCW1ib3huYW1lX2hpZXJzZXBfdG9pbnRlcm5hbChuYW1lc3BhY2UsIHJlc3Vs
dCs1LCAwKTsKICAJcmV0dXJuIDA7Ci0tLSA2MzAsNjgxIC0tLS0KICAKICAgICAgaWYgKCFzdHJu
Y21wKG5hbWUsIG5hbWVzcGFjZS0+cHJlZml4W05BTUVTUEFDRV9VU0VSXSwgcHJlZml4bGVuLTEp
ICYmCiAgCShuYW1lbGVuID09IHByZWZpeGxlbi0xIHx8IG5hbWVbcHJlZml4bGVuLTFdID09IG5h
bWVzcGFjZS0+aGllcl9zZXApKSB7CisgCWNoYXIgbW9kaWZpZWRfdXNlcm5hbWVbTUFYX01BSUxC
T1hfTkFNRSsxXTsKKyAJY2hhciAqaW50X2lkPSIiOworIAlzaXplX3QgaW50X2lkX2xlbj0wOwor
IAlzaXplX3QgZXh0X2lkX2xlbj0wOwogIAogIAlpZiAobmFtZWxlbiA9PSBwcmVmaXhsZW4tMSkg
ewogIAkgICAgLyogY2FuJ3QgY3JlYXRlIGZvbGRlcnMgdXNpbmcgdW5kZWxpbWl0ZWQgcHJlZml4
ICovCiAgCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7CiAgCX0KICAKISAJaWYoIWlt
YXBkX2NvbnZlcnR1c2VyaWQpIHsKISAJICAgIGlmIChkb21haW5sZW4rbmFtZWxlbi1wcmVmaXhs
ZW4rNSA+IE1BWF9NQUlMQk9YX05BTUUpCiEgCQlyZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7
CiEgCSAgICBuYW1lKz1wcmVmaXhsZW47CiAgCX0KKyAJZWxzZSB7CisgCSAgICBjaGFyICpzZXA7
CiAgCiEgCSAgICBuYW1lKz1wcmVmaXhsZW47CiEgCSAgICBzZXA9c3RyY2hyKG5hbWUsbmFtZXNw
YWNlLT5oaWVyX3NlcCk7CiEgCSAgICBpZighc2VwIHx8IHNlcC1uYW1lID49IG5hbWVsZW4tcHJl
Zml4bGVuKQohIAkJZXh0X2lkX2xlbiA9IG5hbWVsZW4tcHJlZml4bGVuOwohIAkgICAgZWxzZQoh
IAkJZXh0X2lkX2xlbiA9IHNlcC1uYW1lOwogIAorIAkgICAgaWYoIWV4dF9pZF9sZW4pCisgCQly
ZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7CisgCSAgICAKKyAJICAgIC8qIHdlIG11c3QgdHJh
bnNmb3JtIGhpZXJhcmNoeSBzZXBhcmF0b3JzIGluIHRoZSBfdXNlcl9pZF8KKyAJICAgICAgIGlu
dG8gaW50ZXJuYWwgcmVwcmVzZW50YXRpb25zIGJlZm9yZSBxdWVyeWluZyB0aGUKKyAJICAgICAg
IGludGVybmFsIHVzZXIgaWQgYmVjYXVzZSB0aGUgcmV2ZXJ0IHRyYW5zZm9ybWF0aW9uCisgCSAg
ICAgICB3b3JrcyB3aXRoIHVzZXJuYW1lcyBvbmx5IGFuZCBrbm93cyBub3RoaW5nIGFib3V0Cisg
CSAgICAgICBzZXBhcmF0b3JzIC0tIHNvcmNlcmVyICovCisgCSAgICBtZW1jcHkobW9kaWZpZWRf
dXNlcm5hbWUsIG5hbWUsIGV4dF9pZF9sZW4pOworIAkgICAgbWJveG5hbWVfaGllcnNlcF90b2lu
dGVybmFsKG5hbWVzcGFjZSwgbW9kaWZpZWRfdXNlcm5hbWUsZXh0X2lkX2xlbik7CisgCisgCSAg
ICBpbnRfaWQgPSBtYm94bmFtZV9nZXRfaW50ZXJuYWxfaWQobW9kaWZpZWRfdXNlcm5hbWUsIGV4
dF9pZF9sZW4sIGRvbWFpbiwgJmludF9pZF9sZW4pOworIAkgICAgaWYoIWludF9pZCkKKyAJCXJl
dHVybiBJTUFQX01BSUxCT1hfTk9ORVhJU1RFTlQ7CisgCSAgICBpZihkb21haW5sZW4rbmFtZWxl
bi1wcmVmaXhsZW4rNS1leHRfaWRfbGVuK2ludF9pZF9sZW4gPiBNQVhfTUFJTEJPWF9OQU1FKQor
IAkJcmV0dXJuIElNQVBfTUFJTEJPWF9CQUROQU1FOworIAkgICAgbmFtZSs9ZXh0X2lkX2xlbjsK
KyAJfQorIAorIAlzcHJpbnRmKHJlc3VsdCwgInVzZXIuJS4qcyUuKnMiLCBpbnRfaWRfbGVuLCBp
bnRfaWQsIG5hbWVsZW4tcHJlZml4bGVuLWV4dF9pZF9sZW4sIG5hbWUpOworIAkKICAJLyogVHJh
bnNsYXRlIGFueSBzZXBhcmF0b3JzIGluIHVzZXJpZCttYWlsYm94ICovCiAgCW1ib3huYW1lX2hp
ZXJzZXBfdG9pbnRlcm5hbChuYW1lc3BhY2UsIHJlc3VsdCs1LCAwKTsKICAJcmV0dXJuIDA7Cioq
KioqKioqKioqKioqKgoqKiogMzk5LDQwNSAqKioqCiAgc3RhdGljIGludCBtYm94bmFtZV90b2V4
dGVybmFsX2FsdChzdHJ1Y3QgbmFtZXNwYWNlICpuYW1lc3BhY2UsIGNvbnN0IGNoYXIgKm5hbWUs
CiAgCQkJCSAgY29uc3QgY2hhciAqdXNlcmlkLCBjaGFyICpyZXN1bHQpCiAgewohICAgICBjaGFy
ICpkb21haW47CiAgICAgIHNpemVfdCB1c2VybGVuLCByZXN1bHRsZW47CiAgCiAgICAgIC8qIEJs
YW5rIHRoZSByZXN1bHQsIGp1c3QgaW4gY2FzZSAqLwotLS0gNzczLDc3OSAtLS0tCiAgc3RhdGlj
IGludCBtYm94bmFtZV90b2V4dGVybmFsX2FsdChzdHJ1Y3QgbmFtZXNwYWNlICpuYW1lc3BhY2Us
IGNvbnN0IGNoYXIgKm5hbWUsCiAgCQkJCSAgY29uc3QgY2hhciAqdXNlcmlkLCBjaGFyICpyZXN1
bHQpCiAgewohICAgICBjaGFyICpkb21haW49TlVMTDsKICAgICAgc2l6ZV90IHVzZXJsZW4sIHJl
c3VsdGxlbjsKICAKICAgICAgLyogQmxhbmsgdGhlIHJlc3VsdCwganVzdCBpbiBjYXNlICovCioq
KioqKioqKioqKioqKgoqKiogNDE1LDQyNyAqKioqCiAgCXNpemVfdCBkb21haW5sZW4gPSBzdHJs
ZW4oZG9tYWluKTsKICAKICAJdXNlcmxlbiA9IGRvbWFpbiAtIHVzZXJpZDsKICAKISAJaWYgKCFz
dHJuY21wKG5hbWUsIGRvbWFpbisxLCBkb21haW5sZW4tMSkgJiYKISAJICAgIG5hbWVbZG9tYWlu
bGVuLTFdID09ICchJykgewohIAkgICAgbmFtZSArPSBkb21haW5sZW47CiAgCX0KICAgICAgfQog
IAogICAgICAvKiBQZXJzb25hbCAoSU5CT1gpIG5hbWVzcGFjZSAqLwogICAgICBpZiAoIXN0cm5j
YXNlY21wKG5hbWUsICJpbmJveCIsIDUpICYmCiAgCShuYW1lWzVdID09ICdcMCcgfHwgbmFtZVs1
XSA9PSAnLicpKSB7Ci0tLSA3ODksODA3IC0tLS0KICAJc2l6ZV90IGRvbWFpbmxlbiA9IHN0cmxl
bihkb21haW4pOwogIAogIAl1c2VybGVuID0gZG9tYWluIC0gdXNlcmlkOworIAlkb21haW4rKzsK
KyAJZG9tYWlubGVuLS07CiAgCiEgCWlmICghc3RybmNtcChuYW1lLCBkb21haW4sIGRvbWFpbmxl
bikgJiYKISAJICAgIG5hbWVbZG9tYWlubGVuXSA9PSAnIScpIHsKISAJICAgIG5hbWUgKz0gZG9t
YWlubGVuKzE7CiAgCX0KICAgICAgfQogIAorICAgICAvKiBzZXQgdGhlIGVtcHR5IGRvbWFpbiBp
ZiBpdCBkb2Vzbid0IGV4aXN0cyAqLworICAgICBpZighZG9tYWluKQorIAlkb21haW49IiI7Cisg
CiAgICAgIC8qIFBlcnNvbmFsIChJTkJPWCkgbmFtZXNwYWNlICovCiAgICAgIGlmICghc3RybmNh
c2VjbXAobmFtZSwgImluYm94IiwgNSkgJiYKICAJKG5hbWVbNV0gPT0gJ1wwJyB8fCBuYW1lWzVd
ID09ICcuJykpIHsKKioqKioqKioqKioqKioqCioqKiA0NDUsNDYyICoqKioKICAgICAgZWxzZSBp
ZiAoIXN0cm5jbXAobmFtZSwgInVzZXIiLCA0KSAmJgogIAkgICAgIChuYW1lWzRdID09ICdcMCcg
fHwgbmFtZVs0XSA9PSAnLicpKSB7CiAgCXNpemVfdCBwcmVmaXhsZW4gPSBzdHJsZW4obmFtZXNw
YWNlLT5wcmVmaXhbTkFNRVNQQUNFX1VTRVJdKTsKICAKISAJaWYgKChwcmVmaXhsZW4gPiBNQVhf
TUFJTEJPWF9OQU1FKSB8fCAKISAJICAgICgobmFtZVs0XSA9PSAnLicpICYmIAohIAkgICAgICgo
cHJlZml4bGVuKzErc3RybGVuKG5hbWUrNSkpID4gTUFYX01BSUxCT1hfTkFNRSkpKQogIAkgICAg
cmV0dXJuIElNQVBfTUFJTEJPWF9CQUROQU1FOwogIAogIAlzcHJpbnRmKHJlc3VsdCwgIiUuKnMi
LAogIAkJcHJlZml4bGVuLTEsIG5hbWVzcGFjZS0+cHJlZml4W05BTUVTUEFDRV9VU0VSXSk7CiAg
CXJlc3VsdGxlbiA9IHN0cmxlbihyZXN1bHQpOwohIAlpZiAobmFtZVs0XSA9PSAnLicpIHsKISAJ
ICAgIHNwcmludGYocmVzdWx0K3Jlc3VsdGxlbiwgIiVjJXMiLCBuYW1lc3BhY2UtPmhpZXJfc2Vw
LCBuYW1lKzUpOwohIAl9CiAgICAgIH0KICAKICAgICAgLyogU2hhcmVkIG5hbWVzcGFjZSAqLwot
LS0gODI1LDg3NiAtLS0tCiAgICAgIGVsc2UgaWYgKCFzdHJuY21wKG5hbWUsICJ1c2VyIiwgNCkg
JiYKICAJICAgICAobmFtZVs0XSA9PSAnXDAnIHx8IG5hbWVbNF0gPT0gJy4nKSkgewogIAlzaXpl
X3QgcHJlZml4bGVuID0gc3RybGVuKG5hbWVzcGFjZS0+cHJlZml4W05BTUVTUEFDRV9VU0VSXSk7
CisgCWNoYXIgKmV4dF9pZD0iIjsKKyAJc2l6ZV90IGV4dF9pZF9sZW49MDsKICAKISAJaWYgKHBy
ZWZpeGxlbiA+IE1BWF9NQUlMQk9YX05BTUUpCiAgCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JB
RE5BTUU7CisgCQorIAlpZihuYW1lWzRdID09ICcuJykgeworIAkgICAgaWYoIWltYXBkX2NvbnZl
cnR1c2VyaWQpIHsKKyAJCWlmKChwcmVmaXhsZW4rMStzdHJsZW4obmFtZSs1KSkgPiBNQVhfTUFJ
TEJPWF9OQU1FKQorIAkJICAgIHJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsKKyAJCW5hbWUr
PTU7CisgCSAgICB9CisgCSAgICAvKiBmZXRjaGluZyB0aGUgdXNlcidzIGlkZW50aWZpZXIgLy8g
c29yY2VyZXIgKi8KKyAJICAgIGVsc2UgeworIAkJY2hhciAqc2VwOworIAkJc2l6ZV90IGludF9p
ZF9sZW47CisgCisgCQluYW1lKz01OworIAkJc2VwPXN0cmNocihuYW1lLCcuJyk7CisgCQlpZihz
ZXApCisgCQkgICAgaW50X2lkX2xlbj1zZXAtbmFtZTsKKyAJCWVsc2UKKyAJCSAgICBpbnRfaWRf
bGVuPXN0cmxlbihuYW1lKTsKKyAKKyAJCWlmKCFpbnRfaWRfbGVuKQorIAkJICAgIHJldHVybiBJ
TUFQX01BSUxCT1hfQkFETkFNRTsKKyAKKyAJCS8qIHdlIGFzc3VtZSB0aGF0IHRoZSB1c2VyIGRv
bWFpbiBpcyBzYW1lIGFzIHRoZSBuYW1lJ3MKKyAJCSAgIGRvbWFpbiAqLworIAkJZXh0X2lkID0g
bWJveG5hbWVfZ2V0X2V4dGVybmFsX2lkKG5hbWUsIGludF9pZF9sZW4sIGRvbWFpbiwgJmV4dF9p
ZF9sZW4pOworIAkJaWYoIWV4dF9pZCkKKyAJCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX05PTkVY
SVNURU5UOworIAkJaWYocHJlZml4bGVuICsgZXh0X2lkX2xlbiArIHN0cmxlbihuYW1lK2ludF9p
ZF9sZW4pID4gTUFYX01BSUxCT1hfTkFNRSkKKyAJCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JB
RE5BTUU7CisgCQluYW1lKz1pbnRfaWRfbGVuOworIAkgICAgfQorIAl9CiAgCiAgCXNwcmludGYo
cmVzdWx0LCAiJS4qcyIsCiAgCQlwcmVmaXhsZW4tMSwgbmFtZXNwYWNlLT5wcmVmaXhbTkFNRVNQ
QUNFX1VTRVJdKTsKICAJcmVzdWx0bGVuID0gc3RybGVuKHJlc3VsdCk7CiEgCiEgCS8qIGluIHRo
ZSBjYXNlIGlmIGZldGNoaW5nIGlkIGlzbid0IGVuYWJsZWQsIGV4dF9pZCB2YXJpYWJsZQohIAkg
ICB3aWxsIGJlIGVtcHR5IGFuZCBuYW1lIHZhcmlhYmxlIHdpbGwgY29uc2lzdCBvZiB0aGUgZnVs
bAohIAkgICBtYWlsYm94IG5hbWUgd2l0aG91dCBuYW1lc3BhY2UtPnByZWZpeFtOQU1FU1BBQ0Vf
VVNFUl0gKi8KISAJc3ByaW50ZihyZXN1bHQrcmVzdWx0bGVuLCAiJWMlLipzJXMiLCBuYW1lc3Bh
Y2UtPmhpZXJfc2VwLCBleHRfaWRfbGVuLCBleHRfaWQsIG5hbWUpOwogICAgICB9CiAgCiAgICAg
IC8qIFNoYXJlZCBuYW1lc3BhY2UgKi8KZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4x
Mi5vbGQvaW1hcC9tYm94bmFtZS5oIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL21ib3huYW1lLmgK
KioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9tYm94bmFtZS5oCTIwMDQtMDMtMTkgMTc6
NDk6MTcgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL21ib3huYW1lLmgJMjAwNS0x
MS0wMyAxNzo1MzowOCArMDMwMAoqKioqKioqKioqKioqKioKKioqIDc4LDgzICoqKioKLS0tIDc4
LDkxIC0tLS0KICAJCQkgICAgdm9pZCAqcm9jaywgaW50IGZvcmNlKTsKICB9OwogIAorICNpZmRl
ZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKyAvKiBjb252ZXJ0IHVzZXJpZCBpbml0aWFsaXphdGlv
biBhbmQgY2xlYW51cCAqLworIGludCBjb252ZXJ0dXNlcmlkX2luaXQoKTsKKyBpbnQgY29udmVy
dHVzZXJpZF9jbGVhbnVwKCk7CisgLyogZGVzdHJveSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIHdo
aWNoIGlzIG5lZWRlZCB0byB0cmFuc2Zvcm0gdXNlcmlkcyAqLworIHZvaWQgbWJveG5hbWVfY2xl
YW51cCgpOworICNlbmRpZiAvKiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQgKi8KKyAKICAvKiBDcmVh
dGUgbmFtZXNwYWNlIGJhc2VkIG9uIGNvbmZpZyBvcHRpb25zLiAqLwogIGludCBtYm94bmFtZV9p
bml0X25hbWVzcGFjZShzdHJ1Y3QgbmFtZXNwYWNlICpuYW1lc3BhY2UsIGludCBpc2FkbWluKTsK
ICAKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbGliL2hhc2guYyBjeXJ1
cy1pbWFwZC0yLjIuMTIvbGliL2hhc2guYwoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9saWIv
aGFzaC5jCTIwMDQtMDUtMjQgMTg6MzI6MzQgKzA0MDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9s
aWIvaGFzaC5jCTIwMDUtMTEtMDMgMTc6NTM6MDggKzAzMDAKKioqKioqKioqKioqKioqCioqKiAz
MTcsMzIyICoqKioKLS0tIDMxNywzNTIgLS0tLQogICAgICAgIH0KICB9CiAgCisgLyogU2FtZSBh
cyBoYXNoX2VudW1lcmF0ZSgpIGJ1dCBoYXMgYWJpbGl0eSB0byBkZWxldGUga2V5cyB3aGlsZSBn
b2luZworICAgIHRocm91Z2ggYSBoYXNoIHRhYmxlLiBSZXR1cm4gbm9uLXplcm8gdmFsdWUgZnJv
bSB0aGUgY2FsbGJhY2sKKyAgICBmdW5jdGlvbiBpZiB5b3Ugd2FudCB0byBkZWxldGUgYSBrZXku
IERlbGV0ZSBhbnkgZXh0ZXJuYWwgZGF0YQorICAgIHlvdXJzZWxmLiAqLworIHZvaWQgaGFzaF93
YWxrKGhhc2hfdGFibGUgKnRhYmxlLCBpbnQgKCpmdW5jKShjaGFyICosIHZvaWQgKiwgdm9pZCAq
KSwKKyAJCSAgICB2b2lkICpyb2NrKQorIHsKKyAgICAgdW5zaWduZWQgaTsKKyAgICAgYnVja2V0
ICp0ZW1wLCAqdGVtcF9vbGQ7CisgCisgICAgIGZvciAoaT0wO2k8dGFibGUtPnNpemU7IGkrKykg
eworIAlpZiAoKHRhYmxlLT50YWJsZSlbaV0gIT0gTlVMTCkgeworIAkgICAgZm9yICh0ZW1wID0g
KHRhYmxlLT50YWJsZSlbaV0sIHRlbXBfb2xkPU5VTEw7CisgCQkgTlVMTCAhPSB0ZW1wOworIAkJ
IHRlbXBfb2xkPXRlbXAsIHRlbXAgPSB0ZW1wLT5uZXh0KSB7CisgCisgCQlpZihmdW5jKHRlbXAg
LT4ga2V5LCB0ZW1wLT5kYXRhLCByb2NrKSkgeworIAkJICAgIGlmKHRlbXBfb2xkKQorIAkJCXRl
bXBfb2xkLT5uZXh0ID0gdGVtcC0+bmV4dDsKKyAJCSAgICBlbHNlCisgCQkJKHRhYmxlLT50YWJs
ZSlbaV0gPSB0ZW1wLT5uZXh0OworIAkJICAgIGlmKCF0YWJsZS0+cG9vbCkgeworIAkJCWZyZWUo
dGVtcC0+a2V5KTsKKyAJCQlmcmVlKHRlbXApOworIAkJICAgIH0KKyAJCX0KKyAJICAgIH0KKyAJ
fQorICAgICB9CisgfQogIAogICNpZmRlZiBURVNUCiAgCmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1p
bWFwZC0yLjIuMTIub2xkL2xpYi9oYXNoLmggY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9oYXNoLmgK
KioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbGliL2hhc2guaAkyMDAzLTEwLTIyIDIyOjUwOjEy
ICswNDAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2hhc2guaAkyMDA1LTExLTAzIDE3OjUz
OjA4ICswMzAwCioqKioqKioqKioqKioqKgoqKiogNzgsODMgKioqKgotLS0gNzgsOTAgLS0tLQog
IHZvaWQgaGFzaF9lbnVtZXJhdGUoaGFzaF90YWJsZSAqdGFibGUsdm9pZCAoKmZ1bmMpKGNoYXIg
Kix2b2lkICosdm9pZCAqKSwKICAJCSAgICB2b2lkICpyb2NrKTsKICAKKyAvKiBTYW1lIGFzIGhh
c2hfZW51bWVyYXRlKCkgYnV0IGhhcyBhYmlsaXR5IHRvIGRlbGV0ZSBrZXlzIHdoaWxlIGdvaW5n
CisgICAgdGhyb3VnaCBhIGhhc2ggdGFibGUuIFJldHVybiBub24temVybyB2YWx1ZSBmcm9tIHRo
ZSBjYWxsYmFjaworICAgIGZ1bmN0aW9uIGlmIHlvdSB3YW50IHRvIGRlbGV0ZSBhIGtleS4gRGVs
ZXRlIGFueSBleHRlcm5hbCBkYXRhCisgICAgeW91cnNlbGYuICovCisgdm9pZCBoYXNoX3dhbGso
aGFzaF90YWJsZSAqdGFibGUsIGludCAoKmZ1bmMpKGNoYXIgKiwgdm9pZCAqLCB2b2lkICopLAor
IAkgICAgICAgdm9pZCAqcm9jayk7CisgCiAgLyoKICAqKiBGcmVlcyBhIGhhc2ggdGFibGUuICBG
b3IgZWFjaCBub2RlIHRoYXQgd2FzIGluc2VydGVkIGluIHRoZSB0YWJsZSwKICAqKiBpdCBjYWxs
cyB0aGUgZnVuY3Rpb24gd2hvc2UgYWRkcmVzcyBpdCB3YXMgcGFzc2VkLCB3aXRoIGEgcG9pbnRl
cgpkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9saWIvaW1hcG9wdGlvbnMg
Y3lydXMtaW1hcGQtMi4yLjEyL2xpYi9pbWFwb3B0aW9ucwoqKiogY3lydXMtaW1hcGQtMi4yLjEy
Lm9sZC9saWIvaW1hcG9wdGlvbnMJMjAwNS0xMS0wMiAxNzo1NjozMSArMDMwMAotLS0gY3lydXMt
aW1hcGQtMi4yLjEyL2xpYi9pbWFwb3B0aW9ucwkyMDA1LTExLTAzIDE3OjUzOjA4ICswMzAwCioq
KioqKioqKioqKioqKgoqKiogOTEwLDkxNSAqKioqCi0tLSA5MTAsOTIwIC0tLS0KICAgICBpbnRl
cmZhY2UsIG90aGVyd2lzZSB0aGUgdXNlciBpcyBhc3N1bWVkIHRvIGJlIGluIHRoZSBkZWZhdWx0
CiAgICAgZG9tYWluIChpZiBzZXQpLiAqLwogIAorIHsgImNvbnZlcnR1c2VyaWQiLCAwLCBTV0lU
Q0ggfQorIHsgImNvbnZlcnR1c2VyaWRfZXhlbXB0cyIsIE5VTEwsIFNUUklORyB9CisgeyAiY29u
dmVydHVzZXJpZF91ZHBwb3J0IiwgMCwgSU5UIH0KKyB7ICJjb252ZXJ0dXNlcmlkX25fbGlzdGVu
ZXJzIiwgMCwgSU5UIH0KKyAKICAvKgogIC5TSCBTRUUgQUxTTwogIC5QUApkaWZmIC1OIC1DIDMg
LXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9saWIvbGliY29uZmlnLmMgY3lydXMtaW1hcGQtMi4y
LjEyL2xpYi9saWJjb25maWcuYwoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9saWIvbGliY29u
ZmlnLmMJMjAwNC0wNS0yMiAwNzo0NTo1NCArMDQwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2xp
Yi9saWJjb25maWcuYwkyMDA1LTExLTAzIDE3OjUzOjA5ICswMzAwCioqKioqKioqKioqKioqKgoq
KiogNTA4LDUxMCAqKioqCi0tLSA1MDgsOTA5IC0tLS0KICAgICAgfQogICAgICBmY2xvc2UoaW5m
aWxlKTsKICB9CisgCisgaW50IGNvbmZpZ190ZW1wbGF0ZV9jb21wYXJlKGNvbnN0IGNoYXIgKm9w
dG5hbWUsIGludCBvcHRpZCwgdGVtcGxhdGVfb3B0aW9uICpvcHRzLCBpbnQgb3B0c19sZW4pCisg
eworICAgICBpbnQgaTsKKyAKKyAgICAgZm9yKGk9MDsgaTxvcHRzX2xlbjsgaSsrKSB7CisgCXN3
aXRjaChvcHRzW2ldLnR5cGUpIHsKKyAJY2FzZSBURU1QTEFURU9QVF9UWVBFX0tOT1dOT1BUOgor
IAkgICAgaWYob3B0aWQ9PShpbnQpb3B0c1tpXS52YWwpCisgCQlyZXR1cm4gMDsKKyAJICAgIGJy
ZWFrOworIAljYXNlIFRFTVBMQVRFT1BUX1RZUEVfRVhBQ1RNQVRDSDoKKyAJICAgIGlmKCFzdHJj
bXAoKGNoYXIgKilvcHRzW2ldLnZhbCwgb3B0bmFtZSkpCisgCQlyZXR1cm4gMDsKKyAJICAgIGJy
ZWFrOworIAljYXNlIFRFTVBMQVRFT1BUX1RZUEVfUFJFRklYOgorIAkgICAgaWYoIXN0cm5jbXAo
KGNoYXIgKilvcHRzW2ldLnZhbCwgb3B0bmFtZSwgc3RybGVuKChjaGFyICopb3B0c1tpXS52YWwp
KSkKKyAJCXJldHVybiAwOworIAkgICAgYnJlYWs7CisgCX0KKyAgICAgfQorICAgICByZXR1cm4g
MTsKKyB9CisgCisgc3RhdGljIGludCBjb25maWdfcmVyZWFkX2ZpbGUoY29uc3QgY2hhciAqZmls
ZW5hbWUsIHRlbXBsYXRlX29wdGlvbiAqb3B0cywgaW50IG9wdHNfbGVuKQorIHsKKyAgICAgZW51
bSBvcHR0eXBlIG9wdCA9IElNQVBPUFRfWkVSTzsKKyAgICAgaW50IGxpbmVubyA9IDA7CisgICAg
IGNoYXIgYnVmWzQwOTZdLCBlcnJidWZbMTAyNF07CisgICAgIGNoYXIgKnAsICpxLCAqa2V5LCAq
ZnVsbGtleSwgKnNydmtleSwgKnZhbCwgKm5ld3ZhbDsKKyAgICAgaW50IHNlcnZpY2Vfc3BlY2lm
aWM7CisgICAgIGludCBpZGxlbiA9IChjb25maWdfaWRlbnQgPyBzdHJsZW4oY29uZmlnX2lkZW50
KSA6IDApOworICAgICBGSUxFICppbmZpbGU7CisgCisgICAgIGlmKCFvcHRzX2xlbikKKyAJcmV0
dXJuIDA7CisgCisgICAgIC8qIHJlYWQgaW4gY29uZmlnIGZpbGUgKi8KKyAgICAgaW5maWxlID0g
Zm9wZW4oZmlsZW5hbWUsICJyIik7CisgICAgIGlmICghaW5maWxlKSB7CisgCXN0cmxjcHkoYnVm
LCBDWVJVU19QQVRILCBzaXplb2YoYnVmKSk7CisgCXN0cmxjYXQoYnVmLCBmaWxlbmFtZSwgc2l6
ZW9mKGJ1ZikpOworIAlpbmZpbGUgPSBmb3BlbihidWYsICJyIik7CisgICAgIH0KKyAgICAgaWYg
KCFpbmZpbGUpIHsKKyAJc3lzbG9nKExPR19FUlIsICJjYW4ndCBvcGVuIGNvbmZpZ3VyYXRpb24g
ZmlsZSAlczogJXMiLGZpbGVuYW1lLCBlcnJvcl9tZXNzYWdlKGVycm5vKSk7CisgCXJldHVybiAt
MTsKKyAgICAgfQorIAorICAgICAvKiBjaGVjayB0byBzZWUgaWYgd2UndmUgYWxyZWFkeSByZWFk
IHRoaXMgZmlsZSAqLworICAgICBpZiAoaGFzaF9sb29rdXAoZmlsZW5hbWUsICZpbmNsdWRlaGFz
aCkpIHsKKyAJc3lzbG9nKExPR19FUlIsICJjb25maWd1cmF0aW9uIGZpbGUgJXMgaW5jbHVkZWQg
dHdpY2UiLCBmaWxlbmFtZSk7CisgCWZjbG9zZShpbmZpbGUpOworIAlyZXR1cm4gLTE7CisgICAg
IH0KKyAgICAgZWxzZSB7CisgCWhhc2hfaW5zZXJ0KGZpbGVuYW1lLCAodm9pZCopIDB4REVBREJF
RUYsICZpbmNsdWRlaGFzaCk7CisgICAgIH0KKyAgICAgCisgICAgIHdoaWxlIChmZ2V0cyhidWYs
IHNpemVvZihidWYpLCBpbmZpbGUpKSB7CisgCWxpbmVubysrOworIAorIAlzZXJ2aWNlX3NwZWNp
ZmljID0gMDsKKyAJCisgCWlmIChidWZbMF0gJiYgYnVmW3N0cmxlbihidWYpLTFdID09ICdcbicp
IGJ1ZltzdHJsZW4oYnVmKS0xXSA9ICdcMCc7CisgCWZvciAocCA9IGJ1ZjsgKnAgJiYgaXNzcGFj
ZSgoaW50KSAqcCk7IHArKyk7CisgCWlmICghKnAgfHwgKnAgPT0gJyMnKSBjb250aW51ZTsKKyAK
KyAJZnVsbGtleSA9IGtleSA9IHA7CisgCWlmICgqcCA9PSAnQCcpIHArKzsgIC8qIGFsbG93IEAg
YXMgdGhlIGZpcnN0IGNoYXIgKGZvciBkaXJlY3RpdmVzKSAqLworIAl3aGlsZSAoKnAgJiYgKGlz
YWxudW0oKGludCkgKnApIHx8ICpwID09ICctJyB8fCAqcCA9PSAnXycpKSB7CisgCSAgICBpZiAo
aXN1cHBlcigodW5zaWduZWQgY2hhcikgKnApKSAqcCA9IHRvbG93ZXIoKHVuc2lnbmVkIGNoYXIp
ICpwKTsKKyAJICAgIHArKzsKKyAJfQorIAlpZiAoKnAgIT0gJzonKSB7CisgCSAgICBzeXNsb2co
TE9HX0VSUiwKKyAJCSAgICJpbnZhbGlkIG9wdGlvbiBuYW1lIG9uIGxpbmUgJWQgb2YgY29uZmln
dXJhdGlvbiBmaWxlICVzIiwKKyAJCSAgICBsaW5lbm8sIGZpbGVuYW1lKTsKKyAJICAgIGZjbG9z
ZShpbmZpbGUpOworIAkgICAgcmV0dXJuIC0xOworIAl9CisgCSpwKysgPSAnXDAnOworIAkKKyAJ
d2hpbGUgKCpwICYmIGlzc3BhY2UoKGludCkgKnApKSBwKys7CisgCQorIAkvKiByZW1vdmUgdHJh
aWxpbmcgd2hpdGVzcGFjZSAqLworIAlmb3IgKHEgPSBwICsgc3RybGVuKHApIC0gMTsgcSA+IHAg
JiYgaXNzcGFjZSgoaW50KSAqcSk7IHEtLSkgeworIAkgICAgKnEgPSAnXDAnOworIAl9CisgCQor
IAlpZiAoISpwKSB7CisgCSAgICBzeXNsb2coTE9HX0VSUiwKKyAJCSAgICJlbXB0eSBvcHRpb24g
dmFsdWUgb24gbGluZSAlZCBvZiBjb25maWd1cmF0aW9uIGZpbGUiLAorIAkJICAgbGluZW5vKTsK
KyAJICAgIGZjbG9zZShpbmZpbGUpOworIAkgICAgcmV0dXJuIC0xOworIAl9CisgCQorIAlzcnZr
ZXkgPSBOVUxMOworIAorIAkvKiBMb29rIGZvciBkaXJlY3RpdmVzICovCisgCWlmIChrZXlbMF0g
PT0gJ0AnKSB7CisgCSAgICBpZiAoIXN0cmNhc2VjbXAoa2V5LCAiQGluY2x1ZGUiKSkgeworIAkJ
aWYoY29uZmlnX3JlcmVhZF9maWxlKHAsb3B0cyxvcHRzX2xlbikpIHsKKyAJCSAgICBmY2xvc2Uo
aW5maWxlKTsKKyAJCSAgICByZXR1cm4gLTE7CisgCQl9CisgCQljb250aW51ZTsKKyAJICAgIH0K
KyAJICAgIGVsc2UgeworIAkJc3lzbG9nKExPR19FUlIsCisgCQkgICAgICAgImludmFsaWQgZGly
ZWN0aXZlIG9uIGxpbmUgJWQgb2YgY29uZmlndXJhdGlvbiBmaWxlICVzIiwKKyAJCSAgICAgICBs
aW5lbm8sIGZpbGVuYW1lKTsKKyAJCWZjbG9zZShpbmZpbGUpOworIAkJcmV0dXJuIC0xOworIAkg
ICAgfQorIAl9CisgCisgCS8qIEZpbmQgaWYgdGhlcmUgaXMgYSA8c2VydmljZT5fIHByZWZpeCAq
LworIAlpZihjb25maWdfaWRlbnQgJiYgIXN0cm5jYXNlY21wKGtleSwgY29uZmlnX2lkZW50LCBp
ZGxlbikgCisgCSAgICYmIGtleVtpZGxlbl0gPT0gJ18nKSB7CisgCSAgICAvKiBza2lwIHNlcnZp
Y2VfIHByZWZpeCAqLworIAkgICAgc3J2a2V5ID0ga2V5ICsgaWRsZW4gKyAxOworIAl9CisgCQor
IAkvKiBsb29rIGZvciBhIHNlcnZpY2VfIHByZWZpeCBtYXRjaCBpbiBpbWFwb3B0cyAqLworIAlp
ZihzcnZrZXkpIHsKKyAJICAgIGZvciAob3B0ID0gSU1BUE9QVF9aRVJPOyBvcHQgPCBJTUFQT1BU
X0xBU1Q7IG9wdCsrKSB7CisgCQlpZiAoIXN0cmNhc2VjbXAoaW1hcG9wdHNbb3B0XS5vcHRuYW1l
LCBzcnZrZXkpKSB7CisgCQkgICAga2V5ID0gc3J2a2V5OworIAkJICAgIHNlcnZpY2Vfc3BlY2lm
aWMgPSAxOworIAkJICAgIGJyZWFrOworIAkJfQorIAkgICAgfQorIAl9CisgCQorIAkvKiBEaWQg
bm90IGZpbmQgYSBzZXJ2aWNlXyBzcGVjaWZpYyBtYXRjaCwgdHJ5IGxvb2tpbmcgZm9yIGFuCisg
CSAqIGV4YWN0IG1hdGNoICovCisgCWlmKCFzZXJ2aWNlX3NwZWNpZmljKSB7CisgCSAgICBmb3Ig
KG9wdCA9IElNQVBPUFRfWkVSTzsgb3B0IDwgSU1BUE9QVF9MQVNUOyBvcHQrKykgeworIAkJaWYg
KCFzdHJjYXNlY21wKGltYXBvcHRzW29wdF0ub3B0bmFtZSwga2V5KSkgeworIAkJICAgIGJyZWFr
OworIAkJfQorIAkgICAgfQorIAl9CisgCisgCS8qIElmIGJvdGggb2YgdGhvc2UgbG9vcHMgZmFp
bGVkLCBpdCBnb2VzIHZlcmJhdGltIGludG8gdGhlCisgCSAqIG92ZXJmbG93IGhhc2ggdGFibGUu
ICovCisgCQorIAlpZiAob3B0IDwgSU1BUE9QVF9MQVNUKSB7CisgCSAgICAvKiBza2lwIGFsbCBv
cHRpb25zIGV4Y2VwdCB0aG9zZSBtYWNoZWQgdGVtcGxhdGUgKi8KKyAJICAgIGlmKGNvbmZpZ190
ZW1wbGF0ZV9jb21wYXJlKGltYXBvcHRzW29wdF0ub3B0bmFtZSxvcHQsb3B0cyxvcHRzX2xlbikp
CisgCQljb250aW51ZTsKKyAKKyAJICAgIC8qIE9rYXksIHdlIGtub3cgYWJvdXQgdGhpcyBjb25m
aWd1cmUgb3B0aW9uLgorIAkgICAgICogU28gZmlyc3QgY2hlY2sgdGhhdCB3ZSBoYXZlIGVpdGhl
cgorIAkgICAgICogIDEuIG5vdCBzZWVuIGl0CisgCSAgICAgKiAgMi4gc2VlbiBpdHMgZ2VuZXJp
YyBmb3JtLCBidXQgdGhpcyBpcyBhIHNlcnZpY2Ugc3BlY2lmaWMgZm9ybQorIAkgICAgICoKKyAJ
ICAgICAqICBJZiB3ZSBoYXZlIGFscmVhZHkgc2VlbiBhIHNlcnZpY2Utc3BlY2lmaWMgZm9ybSwg
YW5kIHRoaXMgaXMKKyAJICAgICAqICBhIGdlbmVyaWMgZm9ybSwganVzdCBza2lwIGl0IGFuZCBk
b24ndCBtb2FuLgorIAkgICAgICovCisgCSAgICBpZigoaW1hcG9wdHNbb3B0XS5zZWVuID09IDEg
JiYgIXNlcnZpY2Vfc3BlY2lmaWMpIAorIAkgICAgIHx8KGltYXBvcHRzW29wdF0uc2VlbiA9PSAy
ICYmIHNlcnZpY2Vfc3BlY2lmaWMpKSB7CisgCQlzeXNsb2coTE9HX0VSUiwKKyAJCSAgICAgICAi
b3B0aW9uICclcycgd2FzIHNwZWNpZmllZCB0d2ljZSBpbiBjb25maWcgZmlsZSAoc2Vjb25kIG9j
Y3VyYW5jZSBvbiBsaW5lICVkKSIsCisgCQkgICAgICAgZnVsbGtleSwgbGluZW5vKTsKKyAJCWZj
bG9zZShpbmZpbGUpOworIAkJcmV0dXJuIC0xOworIAkgICAgfSBlbHNlIGlmKGltYXBvcHRzW29w
dF0uc2VlbiA9PSAyICYmICFzZXJ2aWNlX3NwZWNpZmljKSB7CisgCQljb250aW51ZTsKKyAJICAg
IH0KKyAKKyAJICAgIC8qIElmIHdlJ3ZlIHNlZW4gaXQgYWxyZWFkeSwgd2UncmUgcmVwbGFjaW5n
IGl0LCBzbyB3ZSBuZWVkCisgCSAgICAgKiB0byBmcmVlIHRoZSBjdXJyZW50IHN0cmluZyBpZiB0
aGVyZSBpcyBvbmUgKi8KKyAJICAgIGlmKGltYXBvcHRzW29wdF0uc2VlbiAmJiBpbWFwb3B0c1tv
cHRdLnQgPT0gT1BUX1NUUklORykKKyAJCWZyZWUoKGNoYXIgKilpbWFwb3B0c1tvcHRdLnZhbC5z
KTsKKyAKKyAgICAgICAgICAgICBpZihzZXJ2aWNlX3NwZWNpZmljKQorIAkJaW1hcG9wdHNbb3B0
XS5zZWVuID0gMjsKKyAJICAgIGVsc2UKKyAJCWltYXBvcHRzW29wdF0uc2VlbiA9IDE7CisgCSAg
ICAKKyAJICAgIC8qIHRoaXMgaXMgYSBrbm93biBvcHRpb24gKi8KKyAJICAgIHN3aXRjaCAoaW1h
cG9wdHNbb3B0XS50KSB7CisgCSAgICBjYXNlIE9QVF9TVFJJTkc6IAorIAkgICAgewkJICAgIAor
IAkJaW1hcG9wdHNbb3B0XS52YWwucyA9IHhzdHJkdXAocCk7CisgCisgCQlpZihvcHQgPT0gSU1B
UE9QVF9DT05GSUdESVJFQ1RPUlkpCisgCQkgICAgY29uZmlnX2RpciA9IGltYXBvcHRzW29wdF0u
dmFsLnM7CisgCisgCQlicmVhazsKKyAJICAgIH0KKyAJICAgIGNhc2UgT1BUX0lOVDoKKyAJICAg
IHsKKyAJCWxvbmcgdmFsOworIAkJY2hhciAqcHRyOworIAkJCisgCQl2YWwgPSBzdHJ0b2wocCwg
JnB0ciwgMCk7CisgCQlpZiAoIXB0ciB8fCAqcHRyICE9ICdcMCcpIHsKKyAJCSAgICAvKiBlcnJv
ciBkdXJpbmcgY29udmVyc2lvbiAqLworIAkJICAgIHN5c2xvZyhMT0dfRVJSLAorIAkJCSAgICJu
b24taW50ZWdlciB2YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIsCisgCQkJICAgaW1hcG9wdHNbb3B0
XS5vcHRuYW1lLCBsaW5lbm8pOworIAkJICAgIGZjbG9zZShpbmZpbGUpOworIAkJICAgIHJldHVy
biAtMTsKKyAJCX0KKyAKKyAJCWltYXBvcHRzW29wdF0udmFsLmkgPSB2YWw7CisgCQlicmVhazsK
KyAJICAgIH0KKyAJICAgIGNhc2UgT1BUX1NXSVRDSDoKKyAJICAgIHsKKyAJCWlmICgqcCA9PSAn
MCcgfHwgKnAgPT0gJ24nIHx8CisgCQkgICAgKCpwID09ICdvJyAmJiBwWzFdID09ICdmJykgfHwg
KnAgPT0gJ2YnKSB7CisgCQkgICAgaW1hcG9wdHNbb3B0XS52YWwuYiA9IDA7CisgCQl9CisgCQll
bHNlIGlmICgqcCA9PSAnMScgfHwgKnAgPT0gJ3knIHx8CisgCQkJICgqcCA9PSAnbycgJiYgcFsx
XSA9PSAnbicpIHx8ICpwID09ICd0JykgeworIAkJICAgIGltYXBvcHRzW29wdF0udmFsLmIgPSAx
OworIAkJfQorIAkJZWxzZSB7CisgCQkgICAgLyogZXJyb3IgZHVyaW5nIGNvbnZlcnNpb24gKi8K
KyAJCSAgICBzeXNsb2coTE9HX0VSUiwKKyAJCQkgICAibm9uLXN3aXRjaCB2YWx1ZSBmb3IgJXMg
aW4gbGluZSAlZCIsCisgCQkJICAgaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBsaW5lbm8pOworIAkJ
ICAgIGZjbG9zZShpbmZpbGUpOworIAkJICAgIHJldHVybiAtMTsKKyAJCX0KKyAJCWJyZWFrOwor
IAkgICAgfQorIAkgICAgY2FzZSBPUFRfRU5VTToKKyAJICAgIGNhc2UgT1BUX1NUUklOR0xJU1Q6
CisgCSAgICB7CisgCQljb25zdCBzdHJ1Y3QgZW51bV9vcHRpb25fcyAqZSA9IGltYXBvcHRzW29w
dF0uZW51bV9vcHRpb25zOworIAorIAkJaWYgKGltYXBvcHRzW29wdF0udCA9PSBPUFRfRU5VTSkg
eworIAkJICAgIC8qIG5vcm1hbGl6ZSBvbi9vZmYgdmFsdWVzICovCisgCQkgICAgaWYgKCFzdHJj
bXAocCwgIjEiKSB8fCAhc3RyY21wKHAsICJ5ZXMiKSB8fAorIAkJCSFzdHJjbXAocCwgInQiKSB8
fCAhc3RyY21wKHAsICJ0cnVlIikpIHsKKyAJCQlwID0gIm9uIjsKKyAJCSAgICB9IGVsc2UgaWYg
KCFzdHJjbXAocCwgIjAiKSB8fCAhc3RyY21wKHAsICJubyIpIHx8CisgCQkJICAgICAgICFzdHJj
bXAocCwgImYiKSB8fCAhc3RyY21wKHAsICJmYWxzZSIpKSB7CisgCQkJcCA9ICJvZmYiOworIAkJ
ICAgIH0KKyAJCX0KKyAKKyAJCXdoaWxlIChlLT5uYW1lKSB7CisgCQkgICAgaWYgKCFzdHJjbXAo
ZS0+bmFtZSwgcCkpIGJyZWFrOworIAkJICAgIGUrKzsKKyAJCX0KKyAJCWlmIChlLT5uYW1lKSB7
CisgCQkgICAgaWYgKGltYXBvcHRzW29wdF0udCA9PSBPUFRfRU5VTSkKKyAJCQlpbWFwb3B0c1tv
cHRdLnZhbC5lID0gZS0+dmFsOworIAkJICAgIGVsc2UKKyAJCQlpbWFwb3B0c1tvcHRdLnZhbC5z
ID0gZS0+bmFtZTsKKyAJCX0gZWxzZSB7CisgCQkgICAgLyogZXJyb3IgZHVyaW5nIGNvbnZlcnNp
b24gKi8KKyAJCSAgICBzeXNsb2coTE9HX0VSUiwKKyAJCQkgICAiaW52YWxpZCB2YWx1ZSBmb3Ig
JXMgaW4gbGluZSAlZCIsCisgCQkJICAgaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBsaW5lbm8pOwor
IAkJICAgIGZjbG9zZShpbmZpbGUpOworIAkJICAgIHJldHVybiAtMTsKKyAJCX0KKyAJCWJyZWFr
OworIAkgICAgfQorIAkgICAgY2FzZSBPUFRfTk9UT1BUOgorIAkgICAgZGVmYXVsdDoKKyAJCWFi
b3J0KCk7CisgCSAgICB9CisgCX0gZWxzZSB7CisgCSAgICAvKiBjaGVjayB0byBtYWtlIHN1cmUg
aXQncyB2YWxpZCBmb3Igb3ZlcmZsb3cgKi8KKyAJICAgIC8qIHRoYXQgaXMsIHBhcnRpdGlvbiBu
YW1lcyBhbmQgYW55dGhpbmcgdGhhdCBtaWdodCBiZQorIAkgICAgICogdXNlZCBieSBTQVNMICov
CisgLyoKKyAgIHh4eCB0aGlzIHdvdWxkIGJlIG5pY2UgaWYgaXQgd2Fzbid0IGZvciBvdGhlciBz
ZXJ2aWNlcyB3aG8gbWlnaHQgYmUKKyAgICAgICBzaGFyaW5nIHRoaXMgY29uZmlnIGZpbGUgYW5k
IHdob3NlIG5hbWVzIHdlIGNhbm5vdCBwcmVkaWN0CisgCisgCSAgICBpZihzdHJuY2FzZWNtcChr
ZXksInNhc2xfIiw1KQorIAkgICAgJiYgc3RybmNhc2VjbXAoa2V5LCJwYXJ0aXRpb24tIiwxMCkp
IHsKKyAJCXNwcmludGYoZXJyYnVmLAorIAkJCSJvcHRpb24gJyVzJyBpcyB1bmtub3duIG9uIGxp
bmUgJWQgb2YgY29uZmlnIGZpbGUiLAorIAkJCWZ1bGxrZXksIGxpbmVubyk7CisgCQlmYXRhbChl
cnJidWYsIEVDX0NPTkZJRyk7CisgCSAgICB9CisgKi8KKyAKKyAJICAgIC8qIHNraXAgYWxsIG9w
dGlvbnMgZXhjZXB0IHRob3NlIG1hY2hlZCB0ZW1wbGF0ZSAqLworIAkgICAgaWYoY29uZmlnX3Rl
bXBsYXRlX2NvbXBhcmUoa2V5LDAsb3B0cyxvcHRzX2xlbikpCisgCQljb250aW51ZTsKKyAKKyAJ
ICAgIC8qIFB1dCBpdCBpbiB0aGUgb3ZlcmZsb3cgaGFzaCB0YWJsZSAqLworIAkgICAgbmV3dmFs
ID0geHN0cmR1cChwKTsKKyAJICAgIHZhbCA9IGhhc2hfaW5zZXJ0KGtleSwgbmV3dmFsLCAmY29u
ZmlnaGFzaCk7CisgCSAgICBpZih2YWwgIT0gbmV3dmFsKSB7CisgCQlzeXNsb2coTE9HX0VSUiwK
KyAJCSAgICAgICAib3B0aW9uICclcycgd2FzIHNwZWNpZmllZCB0d2ljZSBpbiBjb25maWcgZmls
ZSAoc2Vjb25kIG9jY3VyYW5jZSBvbiBsaW5lICVkKSIsCisgCQkgICAgICAgZnVsbGtleSwgbGlu
ZW5vKTsKKyAJCWZjbG9zZShpbmZpbGUpOworIAkJcmV0dXJuIC0xOworIAkgICAgfQorIAl9Cisg
ICAgIH0KKyAgICAgZmNsb3NlKGluZmlsZSk7CisgICAgIHJldHVybiAwOworIH0KKyAKKyB0eXBl
ZGVmIHN0cnVjdCBfY29uZmlnX2RlbGV0ZV9jYl9wYXJhbSB7CisgICAgIHRlbXBsYXRlX29wdGlv
biAqb3B0czsKKyAgICAgaW50IG9wdHNfbGVuOworIH0gY29uZmlnX2RlbGV0ZV9jYl9wYXJhbTsK
KyAKKyBpbnQgY29uZmlnX2RlbGV0ZV9jYihjaGFyICprZXksIHZvaWQgKmRhdGEsIHZvaWQgKnBh
cmFtKQorIHsKKyAgICAgaWYoIWNvbmZpZ190ZW1wbGF0ZV9jb21wYXJlKAorIAkgICAoY2hhciAq
KWtleSwgMCwKKyAJICAgKChjb25maWdfZGVsZXRlX2NiX3BhcmFtICopcGFyYW0pLT5vcHRzLAor
IAkgICAoKGNvbmZpZ19kZWxldGVfY2JfcGFyYW0gKilwYXJhbSktPm9wdHNfbGVuKSkKKyAJcmV0
dXJuIC0xOworICAgICByZXR1cm4gMDsKKyB9CisgCisgZXh0ZXJuIGludCBjb25maWdfcmVyZWFk
KHRlbXBsYXRlX29wdGlvbiAqb3B0cywgaW50IG9wdHNfbGVuKQorIHsKKyAgICAgZW51bSBvcHR0
eXBlIG9wdCA9IElNQVBPUFRfWkVSTzsKKyAgICAgY29uZmlnX2RlbGV0ZV9jYl9wYXJhbSBwYXJh
bTsKKyAgICAgaW50IGN1cl90ZW1wbDsKKyAgICAgaW50IHJlczsKKyAKKyAgICAgaWYoIW9wdHNf
bGVuKQorIAlyZXR1cm4gMDsKKyAKKyAgICAgLyogcmVtb3ZlIG9wdGlvbnMgdGhhdCBtYWNoZWQg
dGVtcGxhdGUgKi8KKyAgICAgZm9yIChvcHQgPSBJTUFQT1BUX1pFUk87IG9wdCA8IElNQVBPUFRf
TEFTVDsgb3B0KyspIHsKKyAJaWYoaW1hcG9wdHNbb3B0XS5zZWVuKSB7CisgCSAgICAvKiBqdXN0
IHNldCBkZWZhdWx0IHZhbHVlcyBmb3Iga25vd24gb3B0aW9ucyAqLworIAkgICAgaWYoIWNvbmZp
Z190ZW1wbGF0ZV9jb21wYXJlKGltYXBvcHRzW29wdF0ub3B0bmFtZSxvcHQsb3B0cyxvcHRzX2xl
bikpIHsKKyAJCWlmKGltYXBvcHRzW29wdF0udCA9PSBPUFRfU1RSSU5HKQorIAkJICAgIGZyZWUo
KGNoYXIgKilpbWFwb3B0c1tvcHRdLnZhbC5zKTsKKyAJCWltYXBvcHRzW29wdF0udmFsID0gaW1h
cG9wdHNbb3B0XS5kZWY7CisgCQlpbWFwb3B0c1tvcHRdLnNlZW4gPSAwOworIAkgICAgfQorIAl9
CisgICAgIH0KKyAKKyAgICAgLyogY2hlY2sgaWYgd2UgbmVlZCB0byB3YWxrIHRocm91Z2ggYWxs
IGhhc2hlZCBvcHRpb25zIG9yIHdlIGp1c3QKKyAgICAgICAgbmVlZCB0byBkZWxldGUgTiBoYXNo
ZWQgb3B0aW9ucyAqLworICAgICBmb3IoY3VyX3RlbXBsPTA7IGN1cl90ZW1wbDxvcHRzX2xlbjsg
Y3VyX3RlbXBsKyspIHsKKyAJaWYob3B0c1tjdXJfdGVtcGxdLnR5cGU9PVRFTVBMQVRFT1BUX1RZ
UEVfUFJFRklYKQorIAkgICAgYnJlYWs7CisgCWVsc2UgaWYob3B0c1tjdXJfdGVtcGxdLnR5cGU9
PVRFTVBMQVRFT1BUX1RZUEVfRVhBQ1RNQVRDSCkKKyAJICAgIC8qIHRyeSB0byBkZWxldGUgZXhh
Y3QgbWF0Y2ggb3B0aW9uIChpZiBpdCBleGlzdHMpICovCisgCSAgICBoYXNoX2RlbCgoY2hhciAq
KW9wdHNbY3VyX3RlbXBsXS52YWwsICZjb25maWdoYXNoKTsKKyAgICAgfQorIAorICAgICAvKiBp
ZiB3ZSd2ZSBmb3VuZCBhIHByZWZpeCAobm9uLWV4YWN0KSB0ZW1wbGF0ZSB0aGFuIHdhbGsgdGhy
b3VnaAorICAgICAgICBhbGwgaGFzaGVkIG9wdGlvbnMgKi8KKyAgICAgaWYoY3VyX3RlbXBsPG9w
dHNfbGVuKSB7CisgCXBhcmFtLm9wdHM9b3B0czsKKyAJcGFyYW0ub3B0c19sZW49b3B0c19sZW47
CisgCisgCWhhc2hfd2FsaygmY29uZmlnaGFzaCwgY29uZmlnX2RlbGV0ZV9jYiwgJnBhcmFtKTsK
KyAgICAgfQorIAorICAgICAvKiBub3cgY2FsbCBjb25maWdfcmVyZWFkX2ZpbGUoKSBhcyBpbiBj
b25maWdfcmVhZCgpICovCisgICAgIGlmKCFjb25zdHJ1Y3RfaGFzaF90YWJsZSgmaW5jbHVkZWhh
c2gsIElOQ0xVREVIQVNIU0laRSwgMSkpIHsKKyAJZmF0YWwoImNvdWxkIG5vdCBjb25zdHJ1Y3Qg
aW5jbHVkZSBmaWxlICBoYXNoIHRhYmxlIiwgRUNfQ09ORklHKTsKKyAgICAgfQorIAorICAgICBy
ZXM9Y29uZmlnX3JlcmVhZF9maWxlKGNvbmZpZ19maWxlbmFtZSwgb3B0cywgb3B0c19sZW4pOwor
IAorICAgICBmcmVlX2hhc2hfdGFibGUoJmluY2x1ZGVoYXNoLCBOVUxMKTsKKyAKKyAgICAgaWYo
cmVzKQorIAlyZXR1cm4gcmVzOworIAorICAgICAvKiBOb3RlIGlmIHdlIGRvbid0IGNoYW5nZSB2
YXJpYWJsZXMgYmVsb3cgdGhhdCB0aGF5IGNhbiBwb2ludCB0bworICAgICAgICBmcmVlZCBtZW1v
cnkuIFRPRE86IHJpZ2h0IHdvcmsgd2l0aCBJTUFQT1BUX0RFRkFVTFRQQVJUSVRJT04KKyAgICAg
ICAgb3B0aW9uIGFuZCB3aXRoIG90aGVyIHBhcnRpdGlvbnMgcGF0Y2ggaXMgbmVlZGVkLiAqLwor
IAorICAgICAvKiBsb29rIHVwIG1haWxib3ggaGFzaGluZyAqLworICAgICBjb25maWdfaGFzaGlt
YXBzcG9vbCA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9IQVNISU1BUFNQT09MKTsKKyAKKyAg
ICAgLyogYXJlIHdlIHN1cHBvcnRpbmcgdmlydHVhbCBkb21haW5zPyAgKi8KKyAgICAgY29uZmln
X3ZpcnRkb21haW5zID0gY29uZmlnX2dldGVudW0oSU1BUE9QVF9WSVJURE9NQUlOUyk7CisgICAg
IGNvbmZpZ19kZWZkb21haW4gPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfREVGQVVMVERPTUFJ
Tik7CisgCisgICAgIC8qIGxvb2sgdXAgdGhlIGhvc3RuYW1lIHdlIHNob3VsZCBwcmVzZW50IHRv
IHRoZSB1c2VyICovCisgICAgIGNvbmZpZ19zZXJ2ZXJuYW1lID0gY29uZmlnX2dldHN0cmluZyhJ
TUFQT1BUX1NFUlZFUk5BTUUpOworICAgICBpZiAoIWNvbmZpZ19zZXJ2ZXJuYW1lKSB7CisgCWNv
bmZpZ19zZXJ2ZXJuYW1lID0geG1hbGxvYyhzaXplb2YoY2hhcikgKiAyNTYpOworIAlnZXRob3N0
bmFtZSgoY2hhciAqKSBjb25maWdfc2VydmVybmFtZSwgMjU2KTsKKyAgICAgfQorIAorICAgICBj
b25maWdfbXVwZGF0ZV9zZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTVVQREFURV9T
RVJWRVIpOworIAorICAgICByZXR1cm4gMDsKKyB9CmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1pbWFw
ZC0yLjIuMTIub2xkL2xpYi9saWJjb25maWcuaCBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2xpYmNv
bmZpZy5oCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2xpYi9saWJjb25maWcuaAkyMDAzLTEy
LTI5IDIzOjIyOjU1ICswMzAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2xpYmNvbmZpZy5o
CTIwMDUtMTEtMDMgMTc6NTM6MDkgKzAzMDAKKioqKioqKioqKioqKioqCioqKiA0Niw1NCAqKioq
Ci0tLSA0Niw2NSAtLS0tCiAgI2luY2x1ZGUgImV4aXRjb2Rlcy5oIgogICNpbmNsdWRlICJpbWFw
b3B0cy5oIgogIAorIC8qIHR5cGVzIGZvciBzdHJ1Y3R1cmUgdGVtcGxhdGVfb3B0aW9uICovCisg
I2RlZmluZSBURU1QTEFURU9QVF9UWVBFX0tOT1dOT1BUICAgMAorICNkZWZpbmUgVEVNUExBVEVP
UFRfVFlQRV9FWEFDVE1BVENIIDEKKyAjZGVmaW5lIFRFTVBMQVRFT1BUX1RZUEVfUFJFRklYICAg
ICAyCisgCisgdHlwZWRlZiBzdHJ1Y3QgX3RlbXBsYXRlX29wdGlvbiB7CisgICAgIHZvaWQgKnZh
bDsKKyAgICAgaW50IHR5cGU7CisgfSB0ZW1wbGF0ZV9vcHRpb247CisgCiAgLyogdGhlc2Ugd2ls
bCBhc3NlcnQoKSBpZiB0aGV5J3JlIGNhbGxlZCBvbiB0aGUgd3JvbmcgdHlwZSBvZgogICAgIG9w
dGlvbiAoaW1hcG9wdHMuYykgKi8KICBleHRlcm4gdm9pZCBjb25maWdfcmVhZChjb25zdCBjaGFy
ICphbHRfY29uZmlnKTsKKyBleHRlcm4gaW50IGNvbmZpZ19yZXJlYWQodGVtcGxhdGVfb3B0aW9u
ICpvcHRzLCBpbnQgb3B0c19sZW4pOwogIGV4dGVybiBjb25zdCBjaGFyICpjb25maWdfZ2V0c3Ry
aW5nKGVudW0gaW1hcG9wdCBvcHQpOwogIGV4dGVybiBpbnQgY29uZmlnX2dldGludChlbnVtIGlt
YXBvcHQgb3B0KTsKICBleHRlcm4gaW50IGNvbmZpZ19nZXRzd2l0Y2goZW51bSBpbWFwb3B0IG9w
dCk7CmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL25vdGlmeWQvTWFrZWZp
bGUuaW4gY3lydXMtaW1hcGQtMi4yLjEyL25vdGlmeWQvTWFrZWZpbGUuaW4KKioqIGN5cnVzLWlt
YXBkLTIuMi4xMi5vbGQvbm90aWZ5ZC9NYWtlZmlsZS5pbgkyMDA1LTExLTAyIDE3OjU2OjI2ICsw
MzAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvbm90aWZ5ZC9NYWtlZmlsZS5pbgkyMDA1LTExLTAz
IDE3OjUzOjA5ICswMzAwCioqKioqKioqKioqKioqKgoqKiogNzIsNzggKioqKgogIFNJRVZFX0xJ
QlMgPSBAU0lFVkVfTElCU0AKICBJTUFQX0NPTV9FUlJfTElCUyA9IEBJTUFQX0NPTV9FUlJfTElC
U0AKICBMSUJfV1JBUCA9IEBMSUJfV1JBUEAKISBMSUJTID0gQFpFUEhZUl9MSUJTQCBATElCU0Ag
JChJTUFQX0NPTV9FUlJfTElCUykKICBERVBMSUJTPS4uL2ltYXAvbXV0ZXhfZmFrZS5vIC4uL2lt
YXAvbGliaW1hcC5hICQoU0lFVkVfTElCUykgLi4vbGliL2xpYmN5cnVzLmEgLi4vbGliL2xpYmN5
cnVzX21pbi5hIEBERVBMSUJTQAogIAogIFBVUklGWT0vdXNyL2xvY2FsL2Jpbi9wdXJpZnkKLS0t
IDcyLDc4IC0tLS0KICBTSUVWRV9MSUJTID0gQFNJRVZFX0xJQlNACiAgSU1BUF9DT01fRVJSX0xJ
QlMgPSBASU1BUF9DT01fRVJSX0xJQlNACiAgTElCX1dSQVAgPSBATElCX1dSQVBACiEgTElCUyA9
IEBaRVBIWVJfTElCU0AgQExJQlNAICQoSU1BUF9DT01fRVJSX0xJQlMpIC1scmVkYmxhY2sgLWxs
ZGFwCiAgREVQTElCUz0uLi9pbWFwL211dGV4X2Zha2UubyAuLi9pbWFwL2xpYmltYXAuYSAkKFNJ
RVZFX0xJQlMpIC4uL2xpYi9saWJjeXJ1cy5hIC4uL2xpYi9saWJjeXJ1c19taW4uYSBAREVQTElC
U0AKICAKICBQVVJJRlk9L3Vzci9sb2NhbC9iaW4vcHVyaWZ5CmRpZmYgLU4gLUMgMyAtciBjeXJ1
cy1pbWFwZC0yLjIuMTIub2xkL3B0Y2xpZW50L01ha2VmaWxlLmluIGN5cnVzLWltYXBkLTIuMi4x
Mi9wdGNsaWVudC9NYWtlZmlsZS5pbgoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9wdGNsaWVu
dC9NYWtlZmlsZS5pbgkyMDA1LTExLTAyIDE3OjU2OjIzICswMzAwCi0tLSBjeXJ1cy1pbWFwZC0y
LjIuMTIvcHRjbGllbnQvTWFrZWZpbGUuaW4JMjAwNS0xMS0wMyAxNzo1MzowOSArMDMwMAoqKioq
KioqKioqKioqKioKKioqIDU4LDY0ICoqKioKICBBRlNfTElCUyA9IEBBRlNfTElCU0AKICBJTUFQ
X0xJQlMgPSBASU1BUF9MSUJTQCBATElCX1JUQAogIFNJRVZFX0xJQlMgPSBAU0lFVkVfTElCU0AK
ISBMSUJTID0gJChJTUFQX0xJQlMpIEBDT01fRVJSX0xJQlNACiAgTElCX1NBU0wgPSBATElCX1NB
U0xACiAgTElCX1dSQVAgPSBATElCX1dSQVBACiAgREVQTElCUyA9IC4uL2ltYXAvbGliaW1hcC5h
ICQoU0lFVkVfTElCUykgLi4vbGliL2xpYmN5cnVzLmEgLi4vbGliL2xpYmN5cnVzX21pbi5hIEBE
RVBMSUJTQCAKLS0tIDU4LDY0IC0tLS0KICBBRlNfTElCUyA9IEBBRlNfTElCU0AKICBJTUFQX0xJ
QlMgPSBASU1BUF9MSUJTQCBATElCX1JUQAogIFNJRVZFX0xJQlMgPSBAU0lFVkVfTElCU0AKISBM
SUJTID0gJChJTUFQX0xJQlMpIEBDT01fRVJSX0xJQlNAIC1scmVkYmxhY2sgLWxsZGFwCiAgTElC
X1NBU0wgPSBATElCX1NBU0xACiAgTElCX1dSQVAgPSBATElCX1dSQVBACiAgREVQTElCUyA9IC4u
L2ltYXAvbGliaW1hcC5hICQoU0lFVkVfTElCUykgLi4vbGliL2xpYmN5cnVzLmEgLi4vbGliL2xp
YmN5cnVzX21pbi5hIEBERVBMSUJTQCAKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4x
Mi5vbGQvdGltc2lldmVkL01ha2VmaWxlLmluIGN5cnVzLWltYXBkLTIuMi4xMi90aW1zaWV2ZWQv
TWFrZWZpbGUuaW4KKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvdGltc2lldmVkL01ha2VmaWxl
LmluCTIwMDQtMDUtMjggMjI6MDM6MTAgKzA0MDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi90aW1z
aWV2ZWQvTWFrZWZpbGUuaW4JMjAwNS0xMS0wMyAxNzo1MzowOSArMDMwMAoqKioqKioqKioqKioq
KioKKioqIDcxLDc3ICoqKioKICBJTUFQX0xJQlMgPSBASU1BUF9MSUJTQCBATElCX1JUQAogIElN
QVBfQ09NX0VSUl9MSUJTID0gQElNQVBfQ09NX0VSUl9MSUJTQAogIExJQl9XUkFQID0gQExJQl9X
UkFQQAohIExJQlMgPSAkKElNQVBfQ09NX0VSUl9MSUJTKQogIERFUExJQlM9Li4vc2lldmUvbGli
c2lldmUuYSAuLi9pbWFwL211dGV4X2Zha2UubyAuLi9pbWFwL2xpYmltYXAuYSAuLi9saWIvbGli
Y3lydXMuYSAuLi9saWIvbGliY3lydXNfbWluLmEgQERFUExJQlNACiAgCiAgUFVSSUZZPS91c3Iv
bG9jYWwvYmluL3B1cmlmeQotLS0gNzEsNzcgLS0tLQogIElNQVBfTElCUyA9IEBJTUFQX0xJQlNA
IEBMSUJfUlRACiAgSU1BUF9DT01fRVJSX0xJQlMgPSBASU1BUF9DT01fRVJSX0xJQlNACiAgTElC
X1dSQVAgPSBATElCX1dSQVBACiEgTElCUyA9ICQoSU1BUF9DT01fRVJSX0xJQlMpIC1scmVkYmxh
Y2sgLWxsZGFwCiAgREVQTElCUz0uLi9zaWV2ZS9saWJzaWV2ZS5hIC4uL2ltYXAvbXV0ZXhfZmFr
ZS5vIC4uL2ltYXAvbGliaW1hcC5hIC4uL2xpYi9saWJjeXJ1cy5hIC4uL2xpYi9saWJjeXJ1c19t
aW4uYSBAREVQTElCU0AKICAKICBQVVJJRlk9L3Vzci9sb2NhbC9iaW4vcHVyaWZ5CmRpZmYgLU4g
LUMgMyAtciBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL3Rvb2xzL2NvbmZpZzJoZWFkZXIgY3lydXMt
aW1hcGQtMi4yLjEyL3Rvb2xzL2NvbmZpZzJoZWFkZXIKKioqIGN5cnVzLWltYXBkLTIuMi4xMi5v
bGQvdG9vbHMvY29uZmlnMmhlYWRlcgkyMDA1LTExLTAyIDE3OjU2OjMyICswMzAwCi0tLSBjeXJ1
cy1pbWFwZC0yLjIuMTIvdG9vbHMvY29uZmlnMmhlYWRlcgkyMDA1LTExLTAzIDE3OjUzOjA5ICsw
MzAwCioqKioqKioqKioqKioqKgoqKiogMTI2LDEzMiAqKioqCiAgCiAgc3RydWN0IGltYXBvcHRf
cyBpbWFwb3B0c1tdID0KICB7CiEgICB7IElNQVBPUFRfWkVSTywgIiIsIDAsIHsgTlVMTCB9LCBP
UFRfTk9UT1BULCB7ICB7IE5VTEwsIElNQVBfRU5VTV9aRVJPIH0gfSB9LAogIEVPRgogICAgICA7
CiAgCi0tLSAxMjYsMTMyIC0tLS0KICAKICBzdHJ1Y3QgaW1hcG9wdF9zIGltYXBvcHRzW10gPQog
IHsKISAgIHsgSU1BUE9QVF9aRVJPLCAiIiwgMCwgeyBOVUxMIH0sIHsgTlVMTCB9LCBPUFRfTk9U
T1BULCB7ICB7IE5VTEwsIElNQVBfRU5VTV9aRVJPIH0gfSB9LAogIEVPRgogICAgICA7CiAgCioq
KioqKioqKioqKioqKgoqKiogMjA0LDIxMCAqKioqCiAgCQkJOiAieyh2b2lkKikkMn0iOwogIAl9
CiAgCiEgCXByaW50IENGSUxFICIgIHsgSU1BUE9QVF8iLCB1Yygkb3B0KSwgIiwgXCIkMVwiLCAw
LCAkZGVmLCBPUFRfJDMsIHsgJGVudW1zIHsgTlVMTCwgSU1BUF9FTlVNX1pFUk8gfSB9IH0sXG4i
OwogICAgICB9IGVsc2UgewogIAkjY2hvbXA7CiAgCSNwcmludCAicmVqZWN0ZWQgJyRfJ1xuIjsK
LS0tIDIwNCwyMTAgLS0tLQogIAkJCTogInsodm9pZCopJDJ9IjsKICAJfQogIAohIAlwcmludCBD
RklMRSAiICB7IElNQVBPUFRfIiwgdWMoJG9wdCksICIsIFwiJDFcIiwgMCwgJGRlZiwgJGRlZiwg
T1BUXyQzLCB7ICRlbnVtcyB7IE5VTEwsIElNQVBfRU5VTV9aRVJPIH0gfSB9LFxuIjsKICAgICAg
fSBlbHNlIHsKICAJI2Nob21wOwogIAkjcHJpbnQgInJlamVjdGVkICckXydcbiI7CioqKioqKioq
KioqKioqKgoqKiogMjUxLDI1NiAqKioqCi0tLSAyNTEsMjU3IC0tLS0KICAgICAgY29uc3QgY2hh
ciAqb3B0bmFtZTsKICAgICAgaW50IHNlZW47CiAgICAgIHVuaW9uIGNvbmZpZ192YWx1ZSB2YWw7
CisgICAgIHVuaW9uIGNvbmZpZ192YWx1ZSBkZWY7CiAgICAgIGNvbnN0IGVudW0gb3B0dHlwZSB0
OwogIEVPRgogIDsKKioqKioqKioqKioqKioqCioqKiAyNjUsMjcxICoqKioKICAgICAgOwogIAog
IHByaW50IENGSUxFIDw8RU9GCiEgICB7IElNQVBPUFRfTEFTVCwgTlVMTCwgMCwgeyBOVUxMIH0s
IE9QVF9OT1RPUFQsIHsgIHsgTlVMTCwgSU1BUF9FTlVNX1pFUk8gfSB9IH0KICB9OwogIAogIC8q
IGMgY29kZSBnb2VzIGhlcmUgKi8KLS0tIDI2NiwyNzIgLS0tLQogICAgICA7CiAgCiAgcHJpbnQg
Q0ZJTEUgPDxFT0YKISAgIHsgSU1BUE9QVF9MQVNULCBOVUxMLCAwLCB7IE5VTEwgfSwgeyBOVUxM
IH0sIE9QVF9OT1RPUFQsIHsgIHsgTlVMTCwgSU1BUF9FTlVNX1pFUk8gfSB9IH0KICB9OwogIAog
IC8qIGMgY29kZSBnb2VzIGhlcmUgKi8K
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>399</attachid>
            <date>2005-11-15 04:16 EDT</date>
            <desc>Update</desc>
            <filename>cyrus-imapd-convertuserid-2.2.12.patch</filename>
            <type>text/plain</type>
            <size>79049</size>
            <attacher>dzal_mail@mtu-net.ru</attacher>
            
              <data encoding="base64">ZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvY29uZmlnLmguaW4gY3lydXMt
aW1hcGQtMi4yLjEyL2NvbmZpZy5oLmluCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2NvbmZp
Zy5oLmluCTIwMDUtMDItMTQgMjA6NTk6NDEgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9j
b25maWcuaC5pbgkyMDA1LTExLTExIDE3OjU4OjM2ICswMzAwCioqKioqKioqKioqKioqKgoqKiog
NjQsNjkgKioqKgotLS0gNjQsNzIgLS0tLQogIC8qIERvIHdlIGhhdmUgYSBkZWNlbnQgcmVnZXgg
bGlicmFyeT8gKi8KICAjdW5kZWYgRU5BQkxFX1JFR0VYCiAgCisgLyogRW5hYmxlIGNvbnZlcnRp
bmcgdXNlcmlkcyB2aWEgTERBUCBzdXBwb3J0PyAqLworICN1bmRlZiBFTkFCTEVfQ09OVkVSVF9V
U0VSSUQKKyAKICAvKiBFbmFibGUgTmV0c2NhcGUgTWVudSBPcHRpb24gSGFjaz8gKi8KICAjdW5k
ZWYgRU5BQkxFX1hfTkVUU0NBUEVfSEFDSwogIApkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQt
Mi4yLjEyLm9sZC9jb25maWd1cmUgY3lydXMtaW1hcGQtMi4yLjEyL2NvbmZpZ3VyZQoqKiogY3ly
dXMtaW1hcGQtMi4yLjEyLm9sZC9jb25maWd1cmUJMjAwNS0wMi0xNCAyMDo1OTo0NiArMDMwMAot
LS0gY3lydXMtaW1hcGQtMi4yLjEyL2NvbmZpZ3VyZQkyMDA1LTExLTExIDE3OjU4OjM3ICswMzAw
CioqKioqKioqKioqKioqKgoqKiogODUyLDg1NyAqKioqCi0tLSA4NTIsODU4IC0tLS0KICAgIC0t
ZW5hYmxlLWNtdWxvY2FsICAgICAgIGVuYWJsZSBDTVUtc3BlY2lmaWMgbG9jYWwgc3VwcG9ydAog
ICAgLS1lbmFibGUtb2xkc2lldmVuYW1lICAgZW5hYmxlIHRoZSB1c2Ugb2YgJ2ltYXAnIGFzIHRo
ZSBzaWV2ZSBzZXJ2aWNlIG5hbWUKICAgIC0tZW5hYmxlLWxpc3RleHQgICAgICAgIGVuYWJsZSBJ
TUFQIExpc3QgZXh0ZW5zaW9ucworICAgLS1lbmFibGUtY29udmVydHVzZXJpZCAgZW5hYmxlIGNv
bnZlcnRpbmcgdXNlcmlkcyB2aWEgTERBUCBzdXBwb3J0CiAgICAtLWVuYWJsZS1uZXRzY2FwZWhh
Y2sgICBlbmFibGUgTmV0c2NhcGUgaGFjayBmb3IgdGhlIG1lbnUgb3B0aW9uCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpbiBDb21tdW5pY2F0b3IgdG8gQWRtaW5pc3RyYXRlIE1haWwKICAg
IC0tZW5hYmxlLWdzc2FwaT08RElSPiAgIGVuYWJsZSBHU1NBUEkgYXV0aGVudGljYXRpb24geWVz
CioqKioqKioqKioqKioqKgoqKiogMTExODAsMTExODUgKioqKgotLS0gMTExODEsMTExOTggLS0t
LQogIAlmaQogIGZpOwogIAorICMgQ2hlY2sgd2hldGhlciAtLWVuYWJsZS1jb252ZXJ0dXNlcmlk
IG9yIC0tZGlzYWJsZS1jb252ZXJ0dXNlcmlkIHdhcyBnaXZlbi4KKyBpZiB0ZXN0ICIke2VuYWJs
ZV9jb252ZXJ0dXNlcmlkK3NldH0iID0gc2V0OyB0aGVuCisgICBlbmFibGV2YWw9IiRlbmFibGVf
Y29udmVydHVzZXJpZCIKKyAgIGlmIHRlc3QgIiRlbmFibGV2YWwiID0geWVzOyB0aGVuCisgCisg
Y2F0ID4+Y29uZmRlZnMuaCA8PFxfQUNFT0YKKyAjZGVmaW5lIEVOQUJMRV9DT05WRVJUX1VTRVJJ
RAorIF9BQ0VPRgorIAlJTUFQX1BST0dTPSIkSU1BUF9QUk9HUyBsZGFwZCIKKyAJZmkKKyBmaTsK
KyAKICAjIENoZWNrIHdoZXRoZXIgLS1lbmFibGUtbmV0c2NhcGVoYWNrIG9yIC0tZGlzYWJsZS1u
ZXRzY2FwZWhhY2sgd2FzIGdpdmVuLgogIGlmIHRlc3QgIiR7ZW5hYmxlX25ldHNjYXBlaGFjaytz
ZXR9IiA9IHNldDsgdGhlbgogICAgZW5hYmxldmFsPSIkZW5hYmxlX25ldHNjYXBlaGFjayIKZGlm
ZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvY29uZmlndXJlLmluIGN5cnVzLWlt
YXBkLTIuMi4xMi9jb25maWd1cmUuaW4KKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvY29uZmln
dXJlLmluCTIwMDUtMDEtMTkgMDI6NDY6MDAgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9j
b25maWd1cmUuaW4JMjAwNS0xMS0xMSAxNzo1ODozOCArMDMwMAoqKioqKioqKioqKioqKioKKioq
IDkxNyw5MjIgKioqKgotLS0gOTE3LDkyOSAtLS0tCiAgCQlBQ19ERUZJTkUoRU5BQkxFX0xJU1RF
WFQsW10sW0VuYWJsZSB0aGUgTElTVEVYVCBleHRlbnNpb24/XSkKICAJZmkpCiAgCisgQUNfQVJH
X0VOQUJMRShjb252ZXJ0dXNlcmlkLAorIAlbICAtLWVuYWJsZS1jb252ZXJ0dXNlcmlkICBlbmFi
bGUgY29udmVydGluZyB1c2VyaWRzIHZpYSBMREFQIHN1cHBvcnRdLAorIAlpZiB0ZXN0ICIkZW5h
YmxldmFsIiA9IHllczsgdGhlbgorIAkJQUNfREVGSU5FKEVOQUJMRV9DT05WRVJUX1VTRVJJRCxb
XSxbRW5hYmxlIGNvbnZlcnRpbmcgdXNlcmlkcyB2aWEgTERBUCBzdXBwb3J0P10pCisgCQlJTUFQ
X1BST0dTPSIkSU1BUF9QUk9HUyBsZGFwZCIKKyAJZmkpCisgCiAgQUNfQVJHX0VOQUJMRShuZXRz
Y2FwZWhhY2ssCiAgCVsgIC0tZW5hYmxlLW5ldHNjYXBlaGFjayAgIGVuYWJsZSBOZXRzY2FwZSBo
YWNrIGZvciB0aGUgbWVudSBvcHRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIENv
bW11bmljYXRvciB0byBBZG1pbmlzdHJhdGUgTWFpbF0sCmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1p
bWFwZC0yLjIuMTIub2xkL2ltYXAvY2hhcnNldF9jb252ZXJ0LmMgY3lydXMtaW1hcGQtMi4yLjEy
L2ltYXAvY2hhcnNldF9jb252ZXJ0LmMKKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9j
aGFyc2V0X2NvbnZlcnQuYwkxOTcwLTAxLTAxIDAzOjAwOjAwICswMzAwCi0tLSBjeXJ1cy1pbWFw
ZC0yLjIuMTIvaW1hcC9jaGFyc2V0X2NvbnZlcnQuYwkyMDA1LTExLTExIDE3OjU4OjU3ICswMzAw
CioqKioqKioqKioqKioqKgoqKiogMCAqKioqCi0tLSAxLDU0NCAtLS0tCisgI2luY2x1ZGUgPHN0
ZGxpYi5oPgorIAorICNpbmNsdWRlICJjaGFyc2V0X2NvbnZlcnQuaCIKKyAKKyAvKiBobW0uLi4g
bWF5YmUgMHg3RkZGRkZGRlUgPyAqLworICNkZWZpbmUgVUNTNE1BWCAweDcwMDAwMDAwVQorIAor
ICNkZWZpbmUgVUNTMk1BWCAweDAwMDEwMDAwVQorICNkZWZpbmUgU1VQTUlOICAweDAwMDEwMDAw
VQorICNkZWZpbmUgU1VQTUFYICAweDAwMjAwMDAwVQorIAorICNkZWZpbmUgTUFTSyAgICAweGZm
ZmZmZlUKKyAjZGVmaW5lIFRIUk9VR0ggMHg3ODAwMDAwMFUgICAgICAgICAgICAgIC8qIDAwMDAw
MGggLSBGRkZGRkZoICovCisgCisgdHlwZWRlZiB1bnNpZ25lZCBpbnQgdWludDsKKyAKKyB0eXBl
ZGVmIHN0cnVjdCBfY29udmVydF9zdGF0ZSB7CisgICAgIGludCBjYWNoZTsKKyAgICAgaW50IHN0
YXR1czsKKyB9IGNvbnZlcnRfc3RhdGU7CisgCisgdHlwZWRlZiBpbnQgKCpjb252ZXJ0ZWRfb3V0
X2NiX3QpKHVpbnQgYywgdm9pZCAqKTsKKyB0eXBlZGVmIGludCAoKmNvbnZlcnRfY2JfdCkodWlu
dCBjLCBjb252ZXJ0X3N0YXRlICosIGNvbnZlcnRlZF9vdXRfY2JfdCwgdm9pZCAqKTsKKyB0eXBl
ZGVmIGludCAoKmZsdXNoX2NiX3QpKGNvbnZlcnRfc3RhdGUgKiwgY29udmVydGVkX291dF9jYl90
LCB2b2lkICopOworIAorICNkZWZpbmUgQ0soc3RhdGVtZW50KQlkbyB7IGlmICgoc3RhdGVtZW50
KSkgcmV0dXJuICgtMSk7IH0gd2hpbGUgKDApCisgCisgc3RhdGljIGludCB1dGY4X2VuY29kZSh1
aW50IGMsIGNvbnZlcnRfc3RhdGUgKmZpbHRlciwgY29udmVydGVkX291dF9jYl90IG91dF9jYiwg
dm9pZCAqb3V0X2NiX3BhcmFtKQorIHsKKyAgICAgLyogc2tpcCB3cm9uZyBzeW1ib2xzICovCisg
ICAgIGlmIChjID4gVUNTNE1BWCkKKyAJcmV0dXJuIDA7CisgICAgIAorICAgICBpZiAoYyA8IDB4
ODApIHsKKyAJQ0sob3V0X2NiKGMsIG91dF9jYl9wYXJhbSkpOworICAgICB9IGVsc2UgaWYgKGMg
PCAweDgwMCkgeworIAlDSyhvdXRfY2IoKChjID4+IDYpICYgMHgxZikgfCAweGMwLCBvdXRfY2Jf
cGFyYW0pKTsKKyAJQ0sob3V0X2NiKChjICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsK
KyAgICAgfSBlbHNlIGlmIChjIDwgMHgxMDAwMCkgeworIAlDSyhvdXRfY2IoKChjID4+IDEyKSAm
IDB4MGYpIHwgMHhlMCwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigoKGMgPj4gNikgJiAw
eDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoKGMgJiAweDNmKSB8IDB4
ODAsIG91dF9jYl9wYXJhbSkpOworICAgICB9IGVsc2UgaWYgKGMgPCAweDIwMDAwMCkgeworIAlD
SyhvdXRfY2IoKChjID4+IDE4KSAmIDB4MDcpIHwgMHhmMCwgb3V0X2NiX3BhcmFtKSk7CisgCUNL
KG91dF9jYigoKGMgPj4gMTIpICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0so
b3V0X2NiKCgoYyA+PiA2KSAmIDB4M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91
dF9jYigoYyAmIDB4M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisgICAgIH0gZWxzZSBpZiAo
YyA8IDB4NDAwMDAwMCkgeworIAlDSyhvdXRfY2IoKChjID4+IDI0KSAmIDB4MDMpIHwgMHhmOCwg
b3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigoKGMgPj4gMTgpICYgMHgzZikgfCAweDgwLCBv
dXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKCgoYyA+PiAxMikgJiAweDNmKSB8IDB4ODAsIG91
dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoKChjID4+IDYpICYgMHgzZikgfCAweDgwLCBvdXRf
Y2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKChjICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0p
KTsKKyAgICAgfSBlbHNlIHsKKyAJQ0sob3V0X2NiKCgoYyA+PiAzMCkgJiAweDAxKSB8IDB4ZmMs
IG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoKChjID4+IDI0KSAmIDB4M2YpIHwgMHg4MCwg
b3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigoKGMgPj4gMTgpICYgMHgzZikgfCAweDgwLCBv
dXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKCgoYyA+PiAxMikgJiAweDNmKSB8IDB4ODAsIG91
dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoKChjID4+IDYpICYgMHgzZikgfCAweDgwLCBvdXRf
Y2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKChjICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0p
KTsKKyAgICAgfQorIAorICAgICByZXR1cm4gMDsKKyB9CisgCisgc3RhdGljIGludCB1dGY4X2Rl
Y29kZSh1aW50IGMsIGNvbnZlcnRfc3RhdGUgKmZpbHRlciwgY29udmVydGVkX291dF9jYl90IG91
dF9jYiwgdm9pZCAqb3V0X2NiX3BhcmFtKQorIHsKKyAgICAgaWYgKGMgPCAweDgwKSB7CisgCUNL
KG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKyAJZmlsdGVyLT5zdGF0dXMgPSAwOworICAgICB9
IGVsc2UgaWYgKGMgPCAweGMwKSB7CisgCXVpbnQgczsKKyAKKyAJc3dpdGNoIChmaWx0ZXItPnN0
YXR1cyAmIDB4ZmYpIHsKKyAJY2FzZSAweDEwOiAvKiAyYnl0ZSBjb2RlIDJuZCBjaGFyICovCisg
CWNhc2UgMHgyMTogLyogM2J5dGUgY29kZSAzcmQgY2hhciAqLworIAljYXNlIDB4MzI6IC8qIDRi
eXRlIGNvZGUgNHRoIGNoYXIgKi8KKyAJY2FzZSAweDQzOiAvKiA1Ynl0ZSBjb2RlIDV0aCBjaGFy
ICovCisgCWNhc2UgMHg1NDogLyogNmJ5dGUgY29kZSA2dGggY2hhciAqLworIAkgICAgZmlsdGVy
LT5zdGF0dXMgPSAwOworIAkgICAgcyA9IGZpbHRlci0+Y2FjaGUgfCAoYyAmIDB4M2YpOworIAkg
ICAgaWYgKHMgPj0gMHg4MCkKKyAJCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAg
IGJyZWFrOworIAljYXNlIDB4MjA6IC8qIDNieXRlIGNvZGUgMm5kIGNoYXIgKi8KKyAJY2FzZSAw
eDMxOiAvKiA0Ynl0ZSBjb2RlIDNyZCBjaGFyICovCisgCWNhc2UgMHg0MjogLyogNWJ5dGUgY29k
ZSA0dGggY2hhciAqLworIAljYXNlIDB4NTM6IC8qIDZieXRlIGNvZGUgNXRoIGNoYXIgKi8KKyAJ
ICAgIGZpbHRlci0+Y2FjaGUgfD0gKChjICYgMHgzZikgPDwgNik7CisgCSAgICBmaWx0ZXItPnN0
YXR1cysrOworIAkgICAgYnJlYWs7CisgCWNhc2UgMHgzMDogLyogNGJ5dGUgY29kZSAybmQgY2hh
ciAqLworIAljYXNlIDB4NDE6IC8qIDVieXRlIGNvZGUgM3JkIGNoYXIgKi8KKyAJY2FzZSAweDUy
OiAvKiA2Ynl0ZSBjb2RlIDR0aCBjaGFyICovCisgCSAgICBmaWx0ZXItPmNhY2hlIHw9ICgoYyAm
IDB4M2YpIDw8IDEyKTsKKyAJICAgIGZpbHRlci0+c3RhdHVzKys7CisgCSAgICBicmVhazsKKyAJ
Y2FzZSAweDQwOiAvKiA1Ynl0ZSBjb2RlIDJuZCBjaGFyICovCisgCWNhc2UgMHg1MTogLyogNmJ5
dGUgY29kZSAzcmQgY2hhciAqLworIAkgICAgZmlsdGVyLT5jYWNoZSB8PSAoKGMgJiAweDNmKSA8
PCAxOCk7CisgCSAgICBmaWx0ZXItPnN0YXR1cysrOworIAkgICAgYnJlYWs7CisgCWNhc2UgMHg1
MDogLyogNmJ5dGUgY29kZSAybmQgY2hhciAqLworIAkgICAgZmlsdGVyLT5jYWNoZSB8PSAoKGMg
JiAweDNmKSA8PCAyNCk7CisgCSAgICBmaWx0ZXItPnN0YXR1cysrOworIAkgICAgYnJlYWs7Cisg
CWRlZmF1bHQ6CisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDA7CisgCSAgICBicmVhazsKKyAJfQor
ICAgICB9IGVsc2UgaWYgKGMgPCAweGUwKSB7IC8qIDJieXRlIGNvZGUgZmlyc3QgY2hhciAqLwor
IAlmaWx0ZXItPnN0YXR1cyA9IDB4MTA7CisgCWZpbHRlci0+Y2FjaGUgPSAoYyAmIDB4MWYpIDw8
IDY7CisgICAgIH0gZWxzZSBpZiAoYyA8IDB4ZjApIHsgLyogM2J5dGUgY29kZSBmaXJzdCBjaGFy
ICovCisgCWZpbHRlci0+c3RhdHVzID0gMHgyMDsKKyAJZmlsdGVyLT5jYWNoZSA9IChjICYgMHhm
KSA8PCAxMjsKKyAgICAgfSBlbHNlIGlmIChjIDwgMHhmOCkgeyAvKiA0Ynl0ZSBjb2RlIGZpcnN0
IGNoYXIgKi8KKyAJZmlsdGVyLT5zdGF0dXMgPSAweDMwOworIAlmaWx0ZXItPmNhY2hlID0gKGMg
JiAweDcpIDw8IDE4OworICAgICB9IGVsc2UgaWYgKGMgPCAweGZjKSB7IC8qIDVieXRlIGNvZGUg
Zmlyc3QgY2hhciAqLworIAlmaWx0ZXItPnN0YXR1cyA9IDB4NDA7CisgCWZpbHRlci0+Y2FjaGUg
PSAoYyAmIDB4MykgPDwgMjQ7CisgICAgIH0gZWxzZSBpZiAoYyA8IDB4ZmUpICB7IC8qIDYgYnl0
ZSBjb2RlIGZpcnN0IGNoYXIgKi8KKyAJZmlsdGVyLT5zdGF0dXMgPSAweDUwOworIAlmaWx0ZXIt
PmNhY2hlID0gKGMgJiAweDEpIDw8IDMwOworICAgICB9IGVsc2UgeworIAlmaWx0ZXItPnN0YXR1
cyA9IDA7CisgCWZpbHRlci0+Y2FjaGUgPSAwOworICAgICB9CisgCisgICAgIHJldHVybiAwOwor
IH0KKyAKKyBzdGF0aWMgY29uc3QgdW5zaWduZWQgY2hhciB1dGY3aW1hcF9iYXNlNjRfdGFibGVb
XSA9CisgeworICAvKiAnQScsICdCJywgJ0MnLCAnRCcsICdFJywgJ0YnLCAnRycsICdIJywgJ0kn
LCAnSicsICdLJywgJ0wnLCAnTScsICovCisgICAgMHg0MSwweDQyLDB4NDMsMHg0NCwweDQ1LDB4
NDYsMHg0NywweDQ4LDB4NDksMHg0YSwweDRiLDB4NGMsMHg0ZCwKKyAgLyogJ04nLCAnTycsICdQ
JywgJ1EnLCAnUicsICdTJywgJ1QnLCAnVScsICdWJywgJ1cnLCAnWCcsICdZJywgJ1onLCAqLwor
ICAgIDB4NGUsMHg0ZiwweDUwLDB4NTEsMHg1MiwweDUzLDB4NTQsMHg1NSwweDU2LDB4NTcsMHg1
OCwweDU5LDB4NWEsCisgIC8qICdhJywgJ2InLCAnYycsICdkJywgJ2UnLCAnZicsICdnJywgJ2gn
LCAnaScsICdqJywgJ2snLCAnbCcsICdtJywgKi8KKyAgICAweDYxLDB4NjIsMHg2MywweDY0LDB4
NjUsMHg2NiwweDY3LDB4NjgsMHg2OSwweDZhLDB4NmIsMHg2YywweDZkLAorICAvKiAnbicsICdv
JywgJ3AnLCAncScsICdyJywgJ3MnLCAndCcsICd1JywgJ3YnLCAndycsICd4JywgJ3knLCAneics
ICovCisgICAgMHg2ZSwweDZmLDB4NzAsMHg3MSwweDcyLDB4NzMsMHg3NCwweDc1LDB4NzYsMHg3
NywweDc4LDB4NzksMHg3YSwKKyAgLyogJzAnLCAnMScsICcyJywgJzMnLCAnNCcsICc1JywgJzYn
LCAnNycsICc4JywgJzknLCAnKycsICcsJywgJ1wwJyAqLworICAgIDB4MzAsMHgzMSwweDMyLDB4
MzMsMHgzNCwweDM1LDB4MzYsMHgzNywweDM4LDB4MzksMHgyYiwweDJjLDB4MDAKKyB9OworIAor
IHN0YXRpYyBpbnQgbXV0ZjdfZW5jb2RlKHVpbnQgYywgY29udmVydF9zdGF0ZSAqZmlsdGVyLCBj
b252ZXJ0ZWRfb3V0X2NiX3Qgb3V0X2NiLCB2b2lkICpvdXRfY2JfcGFyYW0pCisgeworICAgICBp
bnQgbiwgczsKKyAKKyAgICAgbiA9IDA7CisgICAgIGlmIChjID09IDB4MjYpIHsKKyAJbiA9IDE7
CisgICAgIH0gZWxzZSBpZiAoKGMgPj0gMHgyMCAmJiBjIDw9IDB4N2UpIHx8IGMgPT0gMCkgewor
IAluID0gMjsKKyAgICAgfSBlbHNlIGlmIChjID49IDAgJiYgYyA8IFVDUzJNQVgpIHsKKyAJOwor
ICAgICB9IGVsc2UgaWYgKGMgPj0gU1VQTUlOICYmIGMgPCBTVVBNQVgpIHsKKyAJcyA9ICgoYyA+
PiAxMCkgLSAweDQwKSB8IDB4ZDgwMDsKKyAJQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJhbSkpOwor
IAlzID0gKGMgJiAweDNmZikgfCAweGRjMDA7CisgCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0p
KTsKKyAJcmV0dXJuIDA7CisgICAgIH0gZWxzZSB7CisgCXJldHVybiAtMTsKKyAgICAgfQorIAor
ICAgICBzd2l0Y2ggKGZpbHRlci0+c3RhdHVzKSB7CisgICAgIGNhc2UgMDoKKyAJaWYgKG4gIT0g
MCkgewkvKiBkaXJlY3RseSBlbmNvZGUgY2hhcmFjdGVycyAqLworIAkgICAgQ0sob3V0X2NiKGMs
IG91dF9jYl9wYXJhbSkpOworIAkgICAgaWYgKG4gPT0gMSkgeworIAkJQ0sob3V0X2NiKDB4MmQs
IG91dF9jYl9wYXJhbSkpOwkJLyogJy0nICovCisgCSAgICB9CisgCX0gZWxzZSB7CS8qIE1vZGlm
aWVkIEJhc2U2NCAqLworIAkgICAgQ0sob3V0X2NiKDB4MjYsIG91dF9jYl9wYXJhbSkpOwkJLyog
JyYnICovCisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDE7CisgCSAgICBmaWx0ZXItPmNhY2hlID0g
YzsKKyAJfQorIAlicmVhazsKKyAKKyAJLyogZW5jb2RlIE1vZGlmaWVkIEJhc2U2NCAqLworICAg
ICBjYXNlIDE6CisgCXMgPSBmaWx0ZXItPmNhY2hlOworIAlDSyhvdXRfY2IodXRmN2ltYXBfYmFz
ZTY0X3RhYmxlWyhzID4+IDEwKSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2Ni
KHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA+PiA0KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsK
KyAJaWYgKG4gIT0gMCkgeworIAkgICAgQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVso
cyA8PCAyKSAmIDB4M2NdLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIENLKG91dF9jYigweDJkLCBv
dXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworIAkgICAgQ0sob3V0X2NiKGMsIG91dF9jYl9wYXJh
bSkpOworIAkgICAgaWYgKG4gPT0gMSkgeworIAkJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJh
bSkpOwkJLyogJy0nICovCisgCSAgICB9CisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDA7CisgCX0g
ZWxzZSB7CisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDI7CisgCSAgICBmaWx0ZXItPmNhY2hlID0g
KChzICYgMHhmKSA8PCAxNikgfCBjOworIAl9CisgCWJyZWFrOworIAorICAgICBjYXNlIDI6Cisg
CXMgPSBmaWx0ZXItPmNhY2hlOworIAlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhz
ID4+IDE0KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jh
c2U2NF90YWJsZVsocyA+PiA4KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2Ni
KHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA+PiAyKSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsK
KyAJaWYgKG4gIT0gMCkgeworIAkgICAgQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVso
cyA8PCA0KSAmIDB4MzBdLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIENLKG91dF9jYigweDJkLCBv
dXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworIAkgICAgQ0sob3V0X2NiKGMsIG91dF9jYl9wYXJh
bSkpOworIAkgICAgaWYgKG4gPT0gMSkgeworIAkJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJh
bSkpOwkJLyogJy0nICovCisgCSAgICB9CisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDA7CisgCX0g
ZWxzZSB7CisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDM7CisgCSAgICBmaWx0ZXItPmNhY2hlID0g
KChzICYgMHgzKSA8PCAxNikgfCBjOworIAl9CisgCWJyZWFrOworIAorICAgICBjYXNlIDM6Cisg
CXMgPSBmaWx0ZXItPmNhY2hlOworIAlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhz
ID4+IDEyKSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jh
c2U2NF90YWJsZVsocyA+PiA2KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2Ni
KHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVtzICYgMHgzZl0sIG91dF9jYl9wYXJhbSkpOworIAlpZiAo
biAhPSAwKSB7CisgCSAgICBDSyhvdXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScg
Ki8KKyAJICAgIENLKG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIGlmIChuID09IDEp
IHsKKyAJCUNLKG91dF9jYigweDJkLCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworIAkgICAg
fQorIAkgICAgZmlsdGVyLT5zdGF0dXMgPSAwOworIAl9IGVsc2UgeworIAkgICAgZmlsdGVyLT5z
dGF0dXMgPSAxOworIAkgICAgZmlsdGVyLT5jYWNoZSA9IGM7CisgCX0KKyAJYnJlYWs7CisgCisg
ICAgIGRlZmF1bHQ6CisgCWZpbHRlci0+c3RhdHVzID0gMDsKKyAJYnJlYWs7CisgICAgIH0KKyAK
KyAgICAgcmV0dXJuIDA7CisgfQorIAorIHN0YXRpYyBpbnQgbXV0ZjdfZGVjb2RlKHVpbnQgYywg
Y29udmVydF9zdGF0ZSAqZmlsdGVyLCBjb252ZXJ0ZWRfb3V0X2NiX3Qgb3V0X2NiLCB2b2lkICpv
dXRfY2JfcGFyYW0pCisgeworICAgICBpbnQgcywgbjsKKyAKKyAgICAgbiA9IC0xOworICAgICBp
ZiAoZmlsdGVyLT5zdGF0dXMgIT0gMCkgewkJLyogTW9kaWZpZWQgQmFzZTY0ICovCisgCWlmIChj
ID49IDB4NDEgJiYgYyA8PSAweDVhKSB7CQkvKiBBIC0gWiAqLworIAkgICAgbiA9IGMgLSA2NTsK
KyAJfSBlbHNlIGlmIChjID49IDB4NjEgJiYgYyA8PSAweDdhKSB7CS8qIGEgLSB6ICovCisgCSAg
ICBuID0gYyAtIDcxOworIAl9IGVsc2UgaWYgKGMgPj0gMHgzMCAmJiBjIDw9IDB4MzkpIHsJLyog
MCAtIDkgKi8KKyAJICAgIG4gPSBjICsgNDsKKyAJfSBlbHNlIGlmIChjID09IDB4MmIpIHsJCQkv
KiAnKycgKi8KKyAJICAgIG4gPSA2MjsKKyAJfSBlbHNlIGlmIChjID09IDB4MmMpIHsJCQkvKiAn
LCcgKi8KKyAJICAgIG4gPSA2MzsKKyAJfQorIAlpZiAobiA8IDAgfHwgbiA+IDYzKSB7CisgCSAg
ICBpZiAoYyA9PSAweDJkKSB7CisgCQlpZiAoZmlsdGVyLT5zdGF0dXMgPT0gMSkgewkJLyogIiYt
IiAtPiAiJiIgKi8KKyAJCSAgICBDSyhvdXRfY2IoMHgyNiwgb3V0X2NiX3BhcmFtKSk7CisgCQl9
CisgCSAgICB9IGVsc2UgaWYgKGMgPj0gMCAmJiBjIDwgMHg4MCkgewkvKiBBU0NJSSBleGNsdWRl
ICctJyAqLworIAkJQ0sob3V0X2NiKGMsIG91dF9jYl9wYXJhbSkpOworIAkgICAgfSBlbHNlIHsJ
CS8qIGlsbGVnYWwgY2hhcmFjdGVyICovCisgCQlzID0gYyAmIE1BU0s7CisgCQlzIHw9IFRIUk9V
R0g7CisgCQlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisgCSAgICB9CisgCSAgICBmaWx0
ZXItPmNhY2hlID0gMDsKKyAJICAgIGZpbHRlci0+c3RhdHVzID0gMDsKKyAJICAgIHJldHVybiAw
OworIAl9CisgICAgIH0KKyAKKyAgICAgc3dpdGNoIChmaWx0ZXItPnN0YXR1cykgeworIAkvKiBk
aXJlY3RseSBlbmNvZGVkIGNoYXJhY3RlcnMgKi8KKyAgICAgY2FzZSAwOgorIAlpZiAoYyA9PSAw
eDI2KSB7CS8qICcmJyAgc2hpZnQgY2hhcmFjdGVyICovCisgCSAgICBmaWx0ZXItPnN0YXR1cysr
OworIAl9IGVsc2UgaWYgKGMgPj0gMCAmJiBjIDwgMHg4MCkgewkvKiBBU0NJSSAqLworIAkgICAg
Q0sob3V0X2NiKGMsIG91dF9jYl9wYXJhbSkpOworIAl9IGVsc2UgewkJLyogaWxsZWdhbCBjaGFy
YWN0ZXIgKi8KKyAJICAgIHMgPSBjICYgTUFTSzsKKyAJICAgIHMgfD0gVEhST1VHSDsKKyAJICAg
IENLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJfQorIAlicmVhazsKKyAKKyAJLyogZGVj
b2RlIE1vZGlmaWVkIEJhc2U2NCAqLworICAgICBjYXNlIDE6CisgICAgIGNhc2UgMjoKKyAJZmls
dGVyLT5jYWNoZSB8PSBuIDw8IDEwOworIAlmaWx0ZXItPnN0YXR1cyA9IDM7CisgCWJyZWFrOwor
ICAgICBjYXNlIDM6CisgCWZpbHRlci0+Y2FjaGUgfD0gbiA8PCA0OworIAlmaWx0ZXItPnN0YXR1
cyA9IDQ7CisgCWJyZWFrOworICAgICBjYXNlIDQ6CisgCXMgPSAoKG4gPj4gMikgJiAweGYpIHwg
KGZpbHRlci0+Y2FjaGUgJiAweGZmZmYpOworIAluID0gKG4gJiAweDMpIDw8IDE0OworIAlmaWx0
ZXItPnN0YXR1cyA9IDU7CisgCWlmIChzID49IDB4ZDgwMCAmJiBzIDwgMHhkYzAwKSB7CisgCSAg
ICBzID0gKCgocyAmIDB4M2ZmKSA8PCAxNikgKyAweDQwMDAwMCkgfCBuOworIAkgICAgZmlsdGVy
LT5jYWNoZSA9IHM7CisgCX0gZWxzZSBpZiAocyA+PSAweGRjMDAgJiYgcyA8IDB4ZTAwMCkgewor
IAkgICAgcyAmPSAweDNmZjsKKyAJICAgIHMgfD0gKGZpbHRlci0+Y2FjaGUgJiAweGZmZjAwMDAp
ID4+IDY7CisgCSAgICBmaWx0ZXItPmNhY2hlID0gbjsKKyAJICAgIGlmIChzID49IFNVUE1JTiAm
JiBzIDwgU1VQTUFYKSB7CisgCQlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisgCSAgICB9
IGVsc2UgewkJLyogaWxsZWdhbCBjaGFyYWN0ZXIgKi8KKyAJCXMgJj0gTUFTSzsKKyAJCXMgfD0g
VEhST1VHSDsKKyAJCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIH0KKyAJfSBl
bHNlIHsKKyAJICAgIGZpbHRlci0+Y2FjaGUgPSBuOworIAkgICAgQ0sob3V0X2NiKHMsIG91dF9j
Yl9wYXJhbSkpOworIAl9CisgCWJyZWFrOworIAorICAgICBjYXNlIDU6CisgCWZpbHRlci0+Y2Fj
aGUgfD0gbiA8PCA4OworIAlmaWx0ZXItPnN0YXR1cyA9IDY7CisgCWJyZWFrOworICAgICBjYXNl
IDY6CisgCWZpbHRlci0+Y2FjaGUgfD0gbiA8PCAyOworIAlmaWx0ZXItPnN0YXR1cyA9IDc7Cisg
CWJyZWFrOworICAgICBjYXNlIDc6CisgCXMgPSAoKG4gPj4gNCkgJiAweDMpIHwgKGZpbHRlci0+
Y2FjaGUgJiAweGZmZmYpOworIAluID0gKG4gJiAweGYpIDw8IDEyOworIAlmaWx0ZXItPnN0YXR1
cyA9IDg7CisgCWlmIChzID49IDB4ZDgwMCAmJiBzIDwgMHhkYzAwKSB7CisgCSAgICBzID0gKCgo
cyAmIDB4M2ZmKSA8PCAxNikgKyAweDQwMDAwMCkgfCBuOworIAkgICAgZmlsdGVyLT5jYWNoZSA9
IHM7CisgCX0gZWxzZSBpZiAocyA+PSAweGRjMDAgJiYgcyA8IDB4ZTAwMCkgeworIAkgICAgcyAm
PSAweDNmZjsKKyAJICAgIHMgfD0gKGZpbHRlci0+Y2FjaGUgJiAweGZmZjAwMDApID4+IDY7Cisg
CSAgICBmaWx0ZXItPmNhY2hlID0gbjsKKyAJICAgIGlmIChzID49IFNVUE1JTiAmJiBzIDwgU1VQ
TUFYKSB7CisgCQlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisgCSAgICB9IGVsc2UgewkJ
LyogaWxsZWdhbCBjaGFyYWN0ZXIgKi8KKyAJCXMgJj0gTUFTSzsKKyAJCXMgfD0gVEhST1VHSDsK
KyAJCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIH0KKyAJfSBlbHNlIHsKKyAJ
ICAgIGZpbHRlci0+Y2FjaGUgPSBuOworIAkgICAgQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJhbSkp
OworIAl9CisgCWJyZWFrOworIAorICAgICBjYXNlIDg6CisgCWZpbHRlci0+Y2FjaGUgfD0gbiA8
PCA2OworIAlmaWx0ZXItPnN0YXR1cyA9IDk7CisgCWJyZWFrOworICAgICBjYXNlIDk6CisgCXMg
PSBuIHwgKGZpbHRlci0+Y2FjaGUgJiAweGZmZmYpOworIAlmaWx0ZXItPnN0YXR1cyA9IDI7Cisg
CWlmIChzID49IDB4ZDgwMCAmJiBzIDwgMHhkYzAwKSB7CisgCSAgICBzID0gKCgocyAmIDB4M2Zm
KSA8PCAxNikgKyAweDQwMDAwMCk7CisgCSAgICBmaWx0ZXItPmNhY2hlID0gczsKKyAJfSBlbHNl
IGlmIChzID49IDB4ZGMwMCAmJiBzIDwgMHhlMDAwKSB7CisgCSAgICBzICY9IDB4M2ZmOworIAkg
ICAgcyB8PSAoZmlsdGVyLT5jYWNoZSAmIDB4ZmZmMDAwMCkgPj4gNjsKKyAJICAgIGZpbHRlci0+
Y2FjaGUgPSAwOworIAkgICAgaWYgKHMgPj0gU1VQTUlOICYmIHMgPCBTVVBNQVgpIHsKKyAJCUNL
KG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIH0gZWxzZSB7CQkvKiBpbGxlZ2FsIGNo
YXJhY3RlciAqLworIAkJcyAmPSBNQVNLOworIAkJcyB8PSBUSFJPVUdIOworIAkJQ0sob3V0X2Ni
KHMsIG91dF9jYl9wYXJhbSkpOworIAkgICAgfQorIAl9IGVsc2UgeworIAkgICAgZmlsdGVyLT5j
YWNoZSA9IDA7CisgCSAgICBDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisgCX0KKyAJYnJl
YWs7CisgCisgICAgIGRlZmF1bHQ6CisgCWZpbHRlci0+c3RhdHVzID0gMDsKKyAJYnJlYWs7Cisg
ICAgIH0KKyAKKyAgICAgcmV0dXJuIDA7CisgfQorIHN0YXRpYyBpbnQgbXV0ZjdfZW5jb2RlX2Zs
dXNoKGNvbnZlcnRfc3RhdGUgKmZpbHRlciwgY29udmVydGVkX291dF9jYl90IG91dF9jYiwgdm9p
ZCAqb3V0X2NiX3BhcmFtKQorIHsKKyAgICAgaW50IHN0YXR1cywgY2FjaGU7CisgCisgICAgIHN0
YXR1cyA9IGZpbHRlci0+c3RhdHVzOworICAgICBjYWNoZSA9IGZpbHRlci0+Y2FjaGU7CisgICAg
IGZpbHRlci0+c3RhdHVzID0gMDsKKyAgICAgZmlsdGVyLT5jYWNoZSA9IDA7CisgICAgIC8qIGZs
dXNoIGZyYWdtZW50cyAqLworICAgICBzd2l0Y2ggKHN0YXR1cykgeworICAgICBjYXNlIDE6Cisg
CUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKGNhY2hlID4+IDEwKSAmIDB4M2ZdLCBv
dXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsoY2FjaGUg
Pj4gNCkgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYih1dGY3aW1hcF9iYXNl
NjRfdGFibGVbKGNhY2hlIDw8IDIpICYgMHgzY10sIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRf
Y2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScgKi8KKyAJYnJlYWs7CisgCisgICAgIGNh
c2UgMjoKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsoY2FjaGUgPj4gMTQpICYg
MHgzZl0sIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxl
WyhjYWNoZSA+PiA4KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKHV0Zjdp
bWFwX2Jhc2U2NF90YWJsZVsoY2FjaGUgPj4gMikgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7Cisg
CUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKGNhY2hlIDw8IDQpICYgMHgzMF0sIG91
dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScg
Ki8KKyAJYnJlYWs7CisgCisgICAgIGNhc2UgMzoKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2
NF90YWJsZVsoY2FjaGUgPj4gMTIpICYgMHgzZl0sIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRf
Y2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhjYWNoZSA+PiA2KSAmIDB4M2ZdLCBvdXRfY2JfcGFy
YW0pKTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVtjYWNoZSAmIDB4M2ZdLCBv
dXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJhbSkpOwkJLyogJy0n
ICovCisgCWJyZWFrOworICAgICB9CisgICAgIHJldHVybiAwOworIH0KKyAKKyB0eXBlZGVmIHN0
cnVjdCBfY29udmVydF9vcHRzIHsKKyAgICAgY29udmVydF9jYl90IGVuY29kZV9jYjsKKyAgICAg
Y29udmVydF9jYl90IGRlY29kZV9jYjsKKyAgICAgZmx1c2hfY2JfdCBmbHVzaF9lbmNvZGU7Cisg
ICAgIGZsdXNoX2NiX3QgZmx1c2hfZGVjb2RlOworIH0gY29udmVydF9vcHRzOworIAorIHR5cGVk
ZWYgc3RydWN0IF9wYXJhbV9jb252ZXJ0IHsKKyAgICAgaW50IGxlbjsKKyAgICAgY2hhciAqb3V0
OworICAgICBjb252ZXJ0X29wdHMgKm9wdHM7CisgICAgIGNvbnZlcnRfc3RhdGUgZmlsdGVyOwor
IH0gcGFyYW1fY29udmVydDsKKyAKKyAvKiBqdXN0IGEgY291bnRlciAqLworIHN0YXRpYyBpbnQg
Y291bnRfbGVuX2NiKHVpbnQgYywgdm9pZCAqcGFyYW0pCisgeworICAgICAoKihpbnQgKilwYXJh
bSkrKzsKKyAgICAgcmV0dXJuIDA7CisgfQorIAorIHN0YXRpYyBpbnQgd3JpdGVfb3V0X2NiKHVp
bnQgYywgdm9pZCAqcGFyYW0pCisgeworICAgICBwYXJhbV9jb252ZXJ0ICpyX3BhcmFtPShwYXJh
bV9jb252ZXJ0ICopcGFyYW07CisgCisgICAgIHJfcGFyYW0tPm91dFtyX3BhcmFtLT5sZW5dPShj
aGFyKWM7CisgICAgIHJfcGFyYW0tPmxlbisrOworICAgICByZXR1cm4gMDsKKyB9CisgCisgLyog
J2MnIGlzIHdjaGFyLiB3ZSBuZWVkIHRvIGNhbGwgZW5jb2RlX2NiIGZ1bmN0aW9uIHRvIGNhbGN1
bGF0ZSB0aGUKKyAgICBvdXRwdXQgYnVmZmVyIHNpemUgKi8KKyBzdGF0aWMgaW50IGdldF9sZW5f
Y2IodWludCBjLCB2b2lkICpwYXJhbSkKKyB7CisgICAgIHJldHVybiAoKHBhcmFtX2NvbnZlcnQg
KilwYXJhbSktPm9wdHMtPmVuY29kZV9jYihjLCAmKChwYXJhbV9jb252ZXJ0ICopcGFyYW0pLT5m
aWx0ZXIsIGNvdW50X2xlbl9jYiwgKHZvaWQgKikmKChwYXJhbV9jb252ZXJ0ICopcGFyYW0pLT5s
ZW4pOworIH0KKyAKKyBzdGF0aWMgaW50IHJlYWxfb3V0X2NiKHVpbnQgYywgdm9pZCAqcGFyYW0p
CisgeworICAgICByZXR1cm4gKChwYXJhbV9jb252ZXJ0ICopcGFyYW0pLT5vcHRzLT5lbmNvZGVf
Y2IoYywgJigocGFyYW1fY29udmVydCAqKXBhcmFtKS0+ZmlsdGVyLCB3cml0ZV9vdXRfY2IsIHBh
cmFtKTsKKyB9CisgCisgc3RhdGljIGNoYXIgKmRvX2NvbnZlcnNpb24oY29udmVydF9vcHRzICpv
cHRzLCBjaGFyICppbiwgaW50IGlubGVuLCBpbnQgKm91dGxlbikKKyB7CisgICAgIHBhcmFtX2Nv
bnZlcnQgcGFyYW07CisgICAgIGNvbnZlcnRfc3RhdGUgZmlsdGVyOworICAgICBpbnQgaTsKKyAK
KyAgICAgcGFyYW0ubGVuID0gMDsKKyAgICAgcGFyYW0ub3B0cyA9IG9wdHM7CisgICAgIGJ6ZXJv
KCZwYXJhbS5maWx0ZXIsIHNpemVvZihwYXJhbS5maWx0ZXIpKTsKKyAgICAgYnplcm8oJmZpbHRl
ciwgc2l6ZW9mKGZpbHRlcikpOworIAorICAgICBmb3IoaT0wOyBpPGlubGVuOyBpKyspCisgCWlm
KG9wdHMtPmRlY29kZV9jYigodWludCkodW5zaWduZWQgY2hhcilpbltpXSwgJmZpbHRlciwgZ2V0
X2xlbl9jYiwgKHZvaWQgKikmcGFyYW0pKQorIAkgICAgcmV0dXJuIE5VTEw7CisgCisgICAgIGlm
KG9wdHMtPmZsdXNoX2RlY29kZSkKKyAJaWYob3B0cy0+Zmx1c2hfZGVjb2RlKCZmaWx0ZXIsIGdl
dF9sZW5fY2IsICh2b2lkICopJnBhcmFtKSkKKyAJICAgIHJldHVybiBOVUxMOworICAgICBpZihv
cHRzLT5mbHVzaF9lbmNvZGUpCisgCWlmKG9wdHMtPmZsdXNoX2VuY29kZSgmcGFyYW0uZmlsdGVy
LCBjb3VudF9sZW5fY2IsICh2b2lkICopJnBhcmFtLmxlbikpCisgCSAgICByZXR1cm4gTlVMTDsK
KyAKKyAgICAgaWYoIShwYXJhbS5vdXQ9KGNoYXIgKiltYWxsb2MocGFyYW0ubGVuKSkpCisgCXJl
dHVybiBOVUxMOworICAgICBwYXJhbS5sZW49MDsKKyAgICAgYnplcm8oJnBhcmFtLmZpbHRlciwg
c2l6ZW9mKHBhcmFtLmZpbHRlcikpOworICAgICBiemVybygmZmlsdGVyLCBzaXplb2YoZmlsdGVy
KSk7CisgICAgIAorICAgICBmb3IoaT0wOyBpPGlubGVuOyBpKyspCisgCWlmKG9wdHMtPmRlY29k
ZV9jYigodWludCkodW5zaWduZWQgY2hhcilpbltpXSwgJmZpbHRlciwgcmVhbF9vdXRfY2IsICh2
b2lkICopJnBhcmFtKSkgeworIAkgICAgZnJlZShwYXJhbS5vdXQpOworIAkgICAgcmV0dXJuIE5V
TEw7CisgCX0KKyAKKyAgICAgaWYob3B0cy0+Zmx1c2hfZGVjb2RlKQorIAlpZihvcHRzLT5mbHVz
aF9kZWNvZGUoJmZpbHRlciwgcmVhbF9vdXRfY2IsICh2b2lkICopJnBhcmFtKSkgeworIAkgICAg
ZnJlZShwYXJhbS5vdXQpOworIAkgICAgcmV0dXJuIE5VTEw7CisgCX0KKyAgICAgaWYob3B0cy0+
Zmx1c2hfZW5jb2RlKQorIAlpZihvcHRzLT5mbHVzaF9lbmNvZGUoJnBhcmFtLmZpbHRlciwgd3Jp
dGVfb3V0X2NiLCAodm9pZCAqKSZwYXJhbS5sZW4pKSB7CisgCSAgICBmcmVlKHBhcmFtLm91dCk7
CisgCSAgICByZXR1cm4gTlVMTDsKKyAJfQorIAorICAgICAqb3V0bGVuID0gcGFyYW0ubGVuOwor
ICAgICByZXR1cm4gcGFyYW0ub3V0OworIH0KKyAKKyBleHRlcm4gY2hhciAqdXRmOF90b19tdXRm
NyhjaGFyICppbiwgaW50IGlubGVuLCBpbnQgKm91dGxlbikKKyB7CisgICAgIGNvbnZlcnRfb3B0
cyBvcHRzOworIAorICAgICBvcHRzLmVuY29kZV9jYiA9IG11dGY3X2VuY29kZTsKKyAgICAgb3B0
cy5kZWNvZGVfY2IgPSB1dGY4X2RlY29kZTsKKyAgICAgb3B0cy5mbHVzaF9lbmNvZGUgPSBtdXRm
N19lbmNvZGVfZmx1c2g7CisgICAgIG9wdHMuZmx1c2hfZGVjb2RlID0gTlVMTDsKKyAKKyAgICAg
cmV0dXJuIGRvX2NvbnZlcnNpb24oJm9wdHMsIGluLCBpbmxlbiwgb3V0bGVuKTsKKyB9CisgCisg
ZXh0ZXJuIGNoYXIgKm11dGY3X3RvX3V0ZjgoY2hhciAqaW4sIGludCBpbmxlbiwgaW50ICpvdXRs
ZW4pCisgeworICAgICBjb252ZXJ0X29wdHMgb3B0czsKKyAKKyAgICAgb3B0cy5lbmNvZGVfY2Ig
PSB1dGY4X2VuY29kZTsKKyAgICAgb3B0cy5kZWNvZGVfY2IgPSBtdXRmN19kZWNvZGU7CisgICAg
IG9wdHMuZmx1c2hfZW5jb2RlID0gTlVMTDsKKyAgICAgb3B0cy5mbHVzaF9kZWNvZGUgPSBOVUxM
OworIAorICAgICByZXR1cm4gZG9fY29udmVyc2lvbigmb3B0cywgaW4sIGlubGVuLCBvdXRsZW4p
OworIH0KZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9jaGFyc2V0
X2NvbnZlcnQuaCBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9jaGFyc2V0X2NvbnZlcnQuaAoqKiog
Y3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL2NoYXJzZXRfY29udmVydC5oCTE5NzAtMDEtMDEg
MDM6MDA6MDAgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2NoYXJzZXRfY29udmVy
dC5oCTIwMDUtMTEtMTEgMTc6NTg6NTcgKzAzMDAKKioqKioqKioqKioqKioqCioqKiAwICoqKioK
LS0tIDEsNyAtLS0tCisgI2lmbmRlZiBfQ0hBUlNFVF9DT05WRVJUX0gKKyAjZGVmaW5lIF9DSEFS
U0VUX0NPTlZFUlRfSAorIAorIGV4dGVybiBjaGFyICp1dGY4X3RvX211dGY3KGNoYXIgKmluLCBp
bnQgaW5sZW4sIGludCAqb3V0bGVuKTsKKyBleHRlcm4gY2hhciAqbXV0ZjdfdG9fdXRmOChjaGFy
ICppbiwgaW50IGlubGVuLCBpbnQgKm91dGxlbik7CisgCisgI2VuZGlmIC8qIF9DSEFSU0VUX0NP
TlZFUlRfSCAqLwpkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL2lk
bGVfaWRsZWQuYyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9pZGxlX2lkbGVkLmMKKioqIGN5cnVz
LWltYXBkLTIuMi4xMi5vbGQvaW1hcC9pZGxlX2lkbGVkLmMJMjAwMy0xMC0yMyAwMDowNToxMSAr
MDQwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvaWRsZV9pZGxlZC5jCTIwMDUtMTEtMTEg
MTc6NTg6MzggKzAzMDAKKioqKioqKioqKioqKioqCioqKiAyMTAsMjE2ICoqKioKICAgICAgLyog
c2VuZCAqLwogICAgICBpZiAoc2VuZHRvKG5vdGlmeV9zb2NrLCAodm9pZCAqKSAmaWRsZWRhdGEs
CiAgCSAgICAgICBJRExFREFUQV9CQVNFX1NJWkUrc3RybGVuKGlkbGVkYXRhLm1ib3huYW1lKSsx
LCAvKiAxIGZvciBOVUxMICovCiEgCSAgICAgICAwLCAoc3RydWN0IHNvY2thZGRyICopICZpZGxl
X3JlbW90ZSwgaWRsZV9yZW1vdGVfbGVuKSA9PSAtMSkgewogICAgICAgIHN5c2xvZyhMT0dfRVJS
LCAiZXJyb3Igc2VuZGluZyB0byBpZGxlZDogJXgiLCBtc2cpOwogICAgICAgIHJldHVybiAwOwog
ICAgICB9Ci0tLSAyMTAsMjE2IC0tLS0KICAgICAgLyogc2VuZCAqLwogICAgICBpZiAoc2VuZHRv
KG5vdGlmeV9zb2NrLCAodm9pZCAqKSAmaWRsZWRhdGEsCiAgCSAgICAgICBJRExFREFUQV9CQVNF
X1NJWkUrc3RybGVuKGlkbGVkYXRhLm1ib3huYW1lKSsxLCAvKiAxIGZvciBOVUxMICovCiEgCSAg
ICAgICAwLCAoc3RydWN0IHNvY2thZGRyICopICZpZGxlX3JlbW90ZSwgaWRsZV9yZW1vdGVfbGVu
KSA9PSAoc3NpemVfdCktMSkgewogICAgICAgIHN5c2xvZyhMT0dfRVJSLCAiZXJyb3Igc2VuZGlu
ZyB0byBpZGxlZDogJXgiLCBtc2cpOwogICAgICAgIHJldHVybiAwOwogICAgICB9CmRpZmYgLU4g
LUMgMyAtciBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvaW1hcGQuYyBjeXJ1cy1pbWFwZC0y
LjIuMTIvaW1hcC9pbWFwZC5jCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvaW1hcGQu
YwkyMDA1LTExLTA3IDE4OjI0OjQzICswMzAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9p
bWFwZC5jCTIwMDUtMTEtMTEgMTc6NTg6MzggKzAzMDAKKioqKioqKioqKioqKioqCioqKiA4MCw4
NSAqKioqCi0tLSA4MCw4OCAtLS0tCiAgI2luY2x1ZGUgIm1haWxib3guaCIKICAjaW5jbHVkZSAi
bWVzc2FnZS5oIgogICNpbmNsdWRlICJtYm94bmFtZS5oIgorICNpZmRlZiBFTkFCTEVfQ09OVkVS
VF9VU0VSSUQKKyAjaW5jbHVkZSAibGRhcGQuaCIKKyAjZW5kaWYKICAjaW5jbHVkZSAibWJveGxp
c3QuaCIKICAjaW5jbHVkZSAibWJkdW1wLmgiCiAgI2luY2x1ZGUgIm1rZ210aW1lLmgiCioqKioq
KioqKioqKioqKgoqKiogMTEyLDExNyAqKioqCi0tLSAxMTUsMTIzIC0tLS0KICBzdGF0aWMgY2hh
ciBpbWFwZF9jbGllbnRob3N0W05JX01BWEhPU1QqMisxXSA9ICJbbG9jYWxdIjsKICBzdGF0aWMg
aW50IGltYXBkX2xvZ2ZkID0gLTE7CiAgY2hhciAqaW1hcGRfdXNlcmlkOworICNpZmRlZiBFTkFC
TEVfQ09OVkVSVF9VU0VSSUQKKyBpbnQgaW1hcGRfY29udmVydHVzZXJpZDsKKyAjZW5kaWYKICBz
dGF0aWMgY2hhciAqaW1hcGRfbWFnaWNwbHVzID0gTlVMTDsKICBzdHJ1Y3QgYXV0aF9zdGF0ZSAq
aW1hcGRfYXV0aHN0YXRlID0gMDsKICBzdGF0aWMgaW50IGltYXBkX3VzZXJpc2FkbWluID0gMDsK
KioqKioqKioqKioqKioqCioqKiA0NzYsNDgxICoqKioKLS0tIDQ4Miw0OTIgLS0tLQogICAgICB9
CiAgI2VuZGlmCiAgCisgI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICAgICBpZihpbWFw
ZF9jb252ZXJ0dXNlcmlkKQorIAltYm94bmFtZV9jbGVhbnVwKCk7CisgI2VuZGlmIC8qIEVOQUJM
RV9DT05WRVJUX1VTRVJJRCAqLworIAogICAgICBjeXJ1c19yZXNldF9zdGRpbygpOyAKICAKICAg
ICAgc3RyY3B5KGltYXBkX2NsaWVudGhvc3QsICJbbG9jYWxdIik7CioqKioqKioqKioqKioqKgoq
KiogNTUyLDU1NyAqKioqCi0tLSA1NjMsNTczIC0tLS0KICAJCQkJICAgMCwgJy4nLCAwKSkKICAJ
ZmF0YWwoImNhbm5vdCBpbml0aWFsaXplIHRoZSBpbnRlcm5hbCBuYW1lc3BhY2UiLCBFQ19URU1Q
RkFJTCk7CiAgCisgI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICAgICBpZihjb252ZXJ0
dXNlcmlkX2luaXQoKSkKKyAgICAgICAgZmF0YWwoImNvbnZlcnR1c2VyaWRfaW5pdCgpIGZhaWxl
ZCIsIEVDX0NPTkZJRyk7CisgI2VuZGlmIC8qIEVOQUJMRV9DT05WRVJUX1VTRVJJRCAqLworIAog
ICAgICAvKiBvcGVuIHRoZSBtYm94bGlzdCwgd2UnbGwgbmVlZCBpdCBmb3IgcmVhbCB3b3JrICov
CiAgICAgIG1ib3hsaXN0X2luaXQoMCk7CiAgICAgIG1ib3hsaXN0X29wZW4oTlVMTCk7CioqKioq
KioqKioqKioqKgoqKiogNTkzLDU5OCAqKioqCi0tLSA2MDksNjI4IC0tLS0KICAgICAgcmV0dXJu
IDA7CiAgfQogIAorIHN0YXRpYyBpbnQgaW1hcGRfY29uZmlnX3JlcmVhZCgpCisgeworICNpZmRl
ZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKyAgICAgdGVtcGxhdGVfb3B0aW9uIG9wdHNbXT17Cisg
CXsodm9pZCAqKUlNQVBPUFRfQ09OVkVSVFVTRVJJRCwgVEVNUExBVEVPUFRfVFlQRV9LTk9XTk9Q
VH0sCisgCXsodm9pZCAqKUlNQVBPUFRfQ09OVkVSVFVTRVJJRF9FWEVNUFRTLCBURU1QTEFURU9Q
VF9UWVBFX0tOT1dOT1BUfSwKKyAgICAgfTsKKyAKKyAgICAgcmV0dXJuIGNvbmZpZ19yZXJlYWQo
b3B0cywgc2l6ZW9mKG9wdHMpL3NpemVvZihvcHRzWzBdKSk7CisgI2Vsc2UKKyAgICAgcmV0dXJu
IDA7CisgI2VuZGlmCisgfQorIAogIC8qCiAgICogcnVuIGZvciBlYWNoIGFjY2VwdGVkIGNvbm5l
Y3Rpb24KICAgKi8KKioqKioqKioqKioqKioqCioqKiA2MjMsNjI4ICoqKioKLS0tIDY1Myw2NjEg
LS0tLQogICAgICBpbWFwZF9pbiA9IHByb3RfbmV3KDAsIDApOwogICAgICBpbWFwZF9vdXQgPSBw
cm90X25ldygxLCAxKTsKICAKKyAgICAgaWYoaW1hcGRfY29uZmlnX3JlcmVhZCgpKQorIAlmYXRh
bCgiQ2FuJ3QgcmVyZWFkIGNvbmZpZ3VyYXRpb24gZmlsZXMiLCBFQ19DT05GSUcpOworIAogICAg
ICAvKiBGaW5kIG91dCBuYW1lIG9mIGNsaWVudCBob3N0ICovCiAgICAgIHNhbGVuID0gc2l6ZW9m
KGltYXBkX3JlbW90ZWFkZHIpOwogICAgICBpZiAoZ2V0cGVlcm5hbWUoMCwgKHN0cnVjdCBzb2Nr
YWRkciAqKSZpbWFwZF9yZW1vdGVhZGRyLCAmc2FsZW4pID09IDAgJiYKKioqKioqKioqKioqKioq
CioqKiA3MDcsNzEyICoqKioKLS0tIDc0MCw3NDggLS0tLQogIC8qIENhbGxlZCBieSBzZXJ2aWNl
IEFQSSB0byBzaHV0IGRvd24gdGhlIHNlcnZpY2UgKi8KICB2b2lkIHNlcnZpY2VfYWJvcnQoaW50
IGVycm9yKQogIHsKKyAjaWZkZWYgRU5BQkxFX0NPTlZFUlRfVVNFUklECisgICAgIGNvbnZlcnR1
c2VyaWRfY2xlYW51cCgpOworICNlbmRpZiAvKiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQgKi8KICAg
ICAgc2h1dF9kb3duKGVycm9yKTsKICB9CiAgCioqKioqKioqKioqKioqKgoqKiogMTY5OCwxNzAz
ICoqKioKLS0tIDE3MzQsMTc4MCAtLS0tCiAgICAgIH0KICB9CiAgCisgc3RhdGljIHZvaWQgaW1h
cGRfbG9nZ2VkdXNlcl9pbml0KCkKKyB7CisgI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAor
ICAgICBjaGFyICpleGVtcHRzOworIAorICAgICBpZighaW1hcGRfbmFtZXNwYWNlLmlzYWx0KQor
IAlyZXR1cm47CisgICAgIAorICAgICBpbWFwZF9jb252ZXJ0dXNlcmlkID0gY29uZmlnX2dldHN3
aXRjaChJTUFQT1BUX0NPTlZFUlRVU0VSSUQpOworICAgICBleGVtcHRzID0gKGNoYXIgKiljb25m
aWdfZ2V0c3RyaW5nKElNQVBPUFRfQ09OVkVSVFVTRVJJRF9FWEVNUFRTKTsKKyAKKyAgICAgaWYo
ZXhlbXB0cykgeworIAkvKiBsb29rIGZvciB1c2VyaWQgaW5zaWRlICdleGVtcHRzJyBzdHJpbmcg
Ki8KKyAJY2hhciAqcD1leGVtcHRzOworIAljaGFyICpuOworIAlpbnQgdXNlcmlkX2xlbj1zdHJs
ZW4oaW1hcGRfdXNlcmlkKTsKKyAKKyAJZG8geworIAkgICAgZm9yKDsgKnA9PScgJzsgcCsrKTsK
KyAJICAgIGlmKCpwKSB7CisgCQlpbnQgcmVzOworIAkJaW50IGNfbGVuOworIAorIAkJbj1zdHJj
aHIocCwgJyAnKTsKKyAJCQorIAkJY19sZW4gPSBuID8gKG4tcCk6IHN0cmxlbihwKTsKKyAKKyAJ
CWlmKGNfbGVuPT11c2VyaWRfbGVuICYmICFtZW1jbXAoaW1hcGRfdXNlcmlkLCBwLCB1c2VyaWRf
bGVuKSkgeworIAkJICAgIC8qIHVzZXJpZCBoYXMgYmVlbiBmb3VuZCEgc3dpdGNoIGNvbnZlcnR1
c2VyaWQKKyAJCSAgICAgICBvcHRpb24gKi8KKyAJCSAgICBpbWFwZF9jb252ZXJ0dXNlcmlkID0g
IWltYXBkX2NvbnZlcnR1c2VyaWQ7CisgCQkgICAgYnJlYWs7CisgCQl9CisgCisgCQlwPW47Cisg
CSAgICB9CisgCX0gd2hpbGUocCk7CisgICAgIH0KKyAjZW5kaWYKKyB9CisgCiAgc3RhdGljIHZv
aWQgdXNlcmlkX3RvaW50ZXJuYWwoc3RydWN0IG5hbWVzcGFjZSAqbmFtZXNwYWNlLCBjaGFyICp1
c2VyaWQpCiAgewogICAgICBjaGFyIGhpZXJzZXBfb3JpZyA9IG5hbWVzcGFjZS0+aGllcl9zZXA7
CioqKioqKioqKioqKioqKgoqKiogMTg5NywxOTAyICoqKioKLS0tIDE5NzQsMTk4MCAtLS0tCiAg
CiAgICAgIC8qIFRyYW5zbGF0ZSBhbnkgc2VwYXJhdG9ycyBpbiB1c2VyaWQgKi8KICAgICAgdXNl
cmlkX3RvaW50ZXJuYWwoJmltYXBkX25hbWVzcGFjZSwgaW1hcGRfdXNlcmlkKTsKKyAgICAgaW1h
cGRfbG9nZ2VkdXNlcl9pbml0KCk7CiAgCiAgICAgIGZyZWVidWYoJnBhc3N3ZGJ1Zik7CiAgCioq
KioqKioqKioqKioqKgoqKiogMjA0NCwyMDQ5ICoqKioKLS0tIDIxMjIsMjEyOCAtLS0tCiAgCiAg
ICAgIC8qIFRyYW5zbGF0ZSBhbnkgc2VwYXJhdG9ycyBpbiB1c2VyaWQgKi8KICAgICAgdXNlcmlk
X3RvaW50ZXJuYWwoJmltYXBkX25hbWVzcGFjZSwgaW1hcGRfdXNlcmlkKTsKKyAgICAgaW1hcGRf
bG9nZ2VkdXNlcl9pbml0KCk7CiAgCiAgICAgIGF1dG9jcmVhdGVfaW5ib3goKTsKICAKZGlmZiAt
TiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9pbWFwZC5oIGN5cnVzLWltYXBk
LTIuMi4xMi9pbWFwL2ltYXBkLmgKKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9pbWFw
ZC5oCTIwMDUtMTEtMDcgMTg6MDU6MzYgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFw
L2ltYXBkLmgJMjAwNS0xMS0xMSAxNzo1ODozOCArMDMwMAoqKioqKioqKioqKioqKioKKioqIDUx
LDU2ICoqKioKLS0tIDUxLDU4IC0tLS0KICAKICAvKiBVc2VyaWQgY2xpZW50IGhhcyBsb2dnZWQg
aW4gYXMgKi8KICBleHRlcm4gY2hhciAqaW1hcGRfdXNlcmlkOworIC8qIGNvbnZlcnQgb3RoZXIg
dXNlcnMgaWRzIGJldHdlZW4gbmFtZXNwYWNlcyAoc3dpdGNoKSAqLworIGludCBpbWFwZF9jb252
ZXJ0dXNlcmlkOwogIAogIC8qIEF1dGhvcml6YXRpb24gc3RhdGUgZm9yIGxvZ2dlZCBpbiB1c2Vy
aWQgKi8KICBleHRlcm4gc3RydWN0IGF1dGhfc3RhdGUgKmltYXBkX2F1dGhzdGF0ZTsKZGlmZiAt
TiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9sZGFwZC5jIGN5cnVzLWltYXBk
LTIuMi4xMi9pbWFwL2xkYXBkLmMKKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9sZGFw
ZC5jCTE5NzAtMDEtMDEgMDM6MDA6MDAgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFw
L2xkYXBkLmMJMjAwNS0xMS0xMSAxNzo1ODo1NyArMDMwMAoqKioqKioqKioqKioqKioKKioqIDAg
KioqKgotLS0gMSw0MDAgLS0tLQorICNpZmRlZiBIQVZFX0NPTkZJR19ICisgI2luY2x1ZGUgPGNv
bmZpZy5oPgorICNlbmRpZgorIAorICNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KKyAjaW5jbHVkZSA8
c3lzL3NvY2tldC5oPgorICNpbmNsdWRlIDxuZXRpbmV0L2luLmg+CisgI2luY2x1ZGUgPGFycGEv
aW5ldC5oPgorICNpbmNsdWRlIDxzeXMvdW4uaD4KKyAjaW5jbHVkZSA8c3lzbG9nLmg+CisgI2lu
Y2x1ZGUgPHN5cy9zdGF0Lmg+CisgI2luY2x1ZGUgPHN0ZGlvLmg+CisgI2luY2x1ZGUgPHN0ZGxp
Yi5oPgorICNpbmNsdWRlIDxzdHJpbmcuaD4KKyAjaW5jbHVkZSA8ZXJybm8uaD4KKyAjaW5jbHVk
ZSA8YXNzZXJ0Lmg+CisgI2lmZGVmIEhBVkVfVU5JU1REX0gKKyAjaW5jbHVkZSA8dW5pc3RkLmg+
CisgI2VuZGlmCisgI2luY2x1ZGUgPGxiZXIuaD4KKyAjaW5jbHVkZSA8bGRhcC5oPgorIAorICNp
bmNsdWRlICJsZGFwZC5oIgorICNpbmNsdWRlICJnbG9iYWwuaCIKKyAjaW5jbHVkZSAiY2hhcnNl
dF9jb252ZXJ0LmgiCisgI2luY2x1ZGUgImV4aXRjb2Rlcy5oIgorIAorIC8qIGdsb2JhbCBzdGF0
ZSAqLworIGNvbnN0IGludCBjb25maWdfbmVlZF9kYXRhID0gMDsKKyAKKyBzdGF0aWMgTERBUCAq
bGRhcF9zZXNzaW9uPU5VTEw7CisgCisgI2RlZmluZSBMREFQX0ZJTFRFUl9URU1QTEFURVNJWkUg
NworIAorIC8qIG9wdGlvbnMgd2hpY2ggd2FzIHJlYWQgZnJvbSBjb25maWd1cmF0aW9uIGZpbGVz
ICovCisgc3RhdGljIGNvbnN0IGNoYXIgKmxkYXBfaG9zdDsKKyBzdGF0aWMgaW50IGxkYXBfcG9y
dDsKKyBzdGF0aWMgY29uc3QgY2hhciAqbGRhcF91c2VyOworIHN0YXRpYyBjb25zdCBjaGFyICps
ZGFwX3Bhc3N3b3JkOworIHN0YXRpYyBjb25zdCBjaGFyICpsZGFwX2Jhc2U7Cisgc3RhdGljIGNv
bnN0IGNoYXIgKmxkYXBfYXR0cl9pbnQ7Cisgc3RhdGljIGNvbnN0IGNoYXIgKmxkYXBfYXR0cl9l
eHQ7Cisgc3RhdGljIGNoYXIgKmxkYXBfZmlsdGVyX2ludDsKKyBzdGF0aWMgY2hhciAqbGRhcF9m
aWx0ZXJfZXh0OworIHN0YXRpYyBpbnQgbGRhcF9maWx0ZXJfaW50X2xlbjsKKyBzdGF0aWMgaW50
IGxkYXBfZmlsdGVyX2V4dF9sZW47CisgCisgc3RhdGljIGludCBuX2xpc3RlbmVycz0wOworIAor
IHZvaWQgZmF0YWwoY29uc3QgY2hhciAqbXNnLCBpbnQgZXJyKQorIHsKKyAgICAgc3lzbG9nKExP
R19DUklULCAiJXMiLCBtc2cpOworICAgICBzeXNsb2coTE9HX05PVElDRSwgImV4aXRpbmciKTsK
KyAKKyAgICAgY3lydXNfZG9uZSgpOworICAgICAKKyAgICAgZXhpdChlcnIpOworIH0KKyAKKyB2
b2lkIGxkYXBfY2xlYW51cCgpCisgeworICAgICBpZihsZGFwX3Nlc3Npb24pIHsKKyAJbGRhcF91
bmJpbmRfcyhsZGFwX3Nlc3Npb24pOworIAlsZGFwX3Nlc3Npb249TlVMTDsKKyAgICAgfQorIH0K
KyAKKyAvKiAnZG9tYWluJyBhbmQgJ2RvbWFpbmxlbicgdmFyaWFibGVzIGFyZSBpZ25vcmVkIG5v
dyAqLworIHN0YXRpYyBpbnQgZ2V0X2lkX2Zyb21fbGRhcChjb25zdCBjaGFyICppbiwgaW50IGlu
X2xlbiwgY29uc3QgY2hhciAqZG9tYWluLCBpbnQgZG9tYWlubGVuLCBjaGFyICpvdXQsIGludCAq
b3V0X2xlbiwgaW50IGludDJleHQpCisgeworICAgICBMREFQTWVzc2FnZSAqbGRhcF9yZXM7Cisg
ICAgIGNoYXIgKmluX2xkYXA7CisgICAgIGludCBpbl9sZGFwX2xlbjsKKyAgICAgY29uc3QgY2hh
ciAqbGRhcF9maWx0ZXJfdGVtcGxhdGU7CisgICAgIGludCBsZGFwX2ZpbHRlcl90ZW1wbGF0ZV9s
ZW47CisgICAgIGNoYXIgKmxkYXBfZmlsdGVyOworICAgICBjaGFyICpsZGFwX2F0dHJzWzJdOwor
IAorICAgICAvKiBJbnB1dCBidWZmZXIgJ2luJyBpcyBNVVRGLTcgc3RyaW5nIGluIGNhc2UgaWYK
KyAgICAgICAgZXh0ZXJuYWw9PmludGVybmFsLiBXZSBuZWVkIHRvIGNvbnZlcnQgaXQgdG8gVVRG
LTggZW5jb2RpbmcKKyAgICAgICAgYmVmb3JlIHF1ZXJ5aW5nIHRvIExEQVAuICovCisgICAgIGlm
KCFpbnQyZXh0KSB7CisgCWNoYXIgKmluX3Rlc3Q7CisgCWludCBpbl90ZXN0X2xlbjsKKyAKKyAJ
aWYoIShpbl9sZGFwID0gbXV0ZjdfdG9fdXRmOCgoY2hhciAqKWluLCBpbl9sZW4sICZpbl9sZGFw
X2xlbikpKQorIAkgICAgcmV0dXJuIDE7CisgCisgCS8qIENoZWNrIGlmICdpbicgaXMgYSB2YWxp
ZCBpbWFwLXV0Zi03IHN0cmluZy4gTm90ZSB0aGF0IHdlCisgCSAgIGFsc28gZGlzYWxsb3cgaGVy
ZSB0byBoYXZlIG11bHRpcGxlIG11dGYtNyByZXByZXNlbnRhdGlvbnMKKyAJICAgb2YgYSBVbmlj
b2RlIHN0cmluZy4gKi8KKyAJaWYoIShpbl90ZXN0ID0gdXRmOF90b19tdXRmNyhpbl9sZGFwLCBp
bl9sZGFwX2xlbiwgJmluX3Rlc3RfbGVuKSkpIHsKKyAJICAgIGZyZWUoaW5fbGRhcCk7CisgCSAg
ICByZXR1cm4gMTsKKyAJfQorIAorIAlpZihpbl90ZXN0X2xlbiE9aW5fbGVuIHx8IG1lbWNtcChp
biwgaW5fdGVzdCwgaW5fbGVuKSkgeworIAkgICAgZnJlZShpbl9sZGFwKTsKKyAJICAgIGZyZWUo
aW5fdGVzdCk7CisgCSAgICByZXR1cm4gMTsKKyAJfQorIAlmcmVlKGluX3Rlc3QpOworIAorIAls
ZGFwX2ZpbHRlcl90ZW1wbGF0ZSA9IGxkYXBfZmlsdGVyX2V4dDsKKyAJbGRhcF9maWx0ZXJfdGVt
cGxhdGVfbGVuID0gbGRhcF9maWx0ZXJfZXh0X2xlbjsKKyAJbGRhcF9hdHRyc1swXSA9IChjaGFy
ICopbGRhcF9hdHRyX2ludDsKKyAgICAgfQorICAgICBlbHNlIHsKKyAJaW5fbGRhcCA9IChjaGFy
ICopaW47CisgCWluX2xkYXBfbGVuID0gaW5fbGVuOworIAlsZGFwX2ZpbHRlcl90ZW1wbGF0ZSA9
IGxkYXBfZmlsdGVyX2ludDsKKyAJbGRhcF9maWx0ZXJfdGVtcGxhdGVfbGVuID0gbGRhcF9maWx0
ZXJfaW50X2xlbjsKKyAJbGRhcF9hdHRyc1swXSA9IChjaGFyICopbGRhcF9hdHRyX2V4dDsKKyAg
ICAgfQorIAorICAgICAvKiBpZiB0aGUgY29ubmVjdGlvbiB0byBMREFQIHNlcnZlciBpcyBub3Qg
ZXN0YWJsaXNoZWQgdGhlbiB0cnkgdG8KKyAgICAgICAgZXN0YWJsaXNoIGl0ICovCisgICAgIGlm
KCFsZGFwX3Nlc3Npb24pIHsKKyAJdm9pZCAqb3B0dmFsPUxEQVBfT1BUX09OOworIAorIAlpZigh
KGxkYXBfc2Vzc2lvbiA9IGxkYXBfaW5pdChsZGFwX2hvc3QsIGxkYXBfcG9ydCkpIHx8CisgCSAg
IGxkYXBfc2V0X29wdGlvbihsZGFwX3Nlc3Npb24sIExEQVBfT1BUX1JFU1RBUlQsIG9wdHZhbCk9
PS0xIHx8CisgCSAgIGxkYXBfc2ltcGxlX2JpbmRfcyhsZGFwX3Nlc3Npb24sIGxkYXBfdXNlciwg
bGRhcF9wYXNzd29yZCkhPUxEQVBfU1VDQ0VTUykgeworIAkgICAgbGRhcF9jbGVhbnVwKCk7Cisg
CSAgICByZXR1cm4gMTsKKyAJfQorICAgICB9CisgCisgICAgIC8qIHRoZSBhbGxvY2F0ZWQgYnVm
ZmVyIGlzIGJpZ2dlciB0aGFuIG5lZWRlZDogdGVtcGxhdGUgaGF2ZQorICAgICAgICAiJS4qcyIg
c3RyaW5nIHdpdGhpbiBpdCB3aGljaCBpcyByZXBsYWNlZCB0byBpbl9sZGFwIHN0cmluZyAqLwor
ICAgICBsZGFwX2ZpbHRlciA9IChjaGFyICopbWFsbG9jKGxkYXBfZmlsdGVyX3RlbXBsYXRlX2xl
bitpbl9sZGFwX2xlbik7CisgICAgIGlmKCFsZGFwX2ZpbHRlcikgeworIAlpZihpbl9sZGFwICE9
IGluKQorIAkgICAgZnJlZShpbl9sZGFwKTsKKyAJcmV0dXJuIDE7CisgICAgIH0KKyAgICAgc3By
aW50ZihsZGFwX2ZpbHRlciwgbGRhcF9maWx0ZXJfdGVtcGxhdGUsIGluX2xkYXBfbGVuLCBpbl9s
ZGFwKTsKKyAKKyAgICAgbGRhcF9hdHRyc1sxXT1OVUxMOworIAorICAgICBpZihsZGFwX3NlYXJj
aF9zKGxkYXBfc2Vzc2lvbiwgbGRhcF9iYXNlLCBMREFQX1NDT1BFX1NVQlRSRUUsIGxkYXBfZmls
dGVyLCBsZGFwX2F0dHJzLCAwLCAmbGRhcF9yZXMpIT1MREFQX1NVQ0NFU1MpIHsKKyAJaWYoaW5f
bGRhcCAhPSBpbikKKyAJICAgIGZyZWUoaW5fbGRhcCk7CisgCWZyZWUobGRhcF9maWx0ZXIpOwor
IAkvKiBkaXNjb25uZWN0IGZyb20gTERBUCBzZXJ2ZXIgKHdlIHdpbGwgdHJ5IHRvIGNvbm5lY3Qg
YWdhaW4KKyAJICAgbGF0ZXIpICovCisgCWxkYXBfY2xlYW51cCgpOworIAlyZXR1cm4gMTsKKyAg
ICAgfQorICAgICBlbHNlIHsKKyAJY2hhciAqKnZhbHM9TlVMTDsKKyAJY2hhciAqbm9uZW5jb2Rl
ZF9vdXQ7CisgCWludCBub25lbmNvZGVkX2xlbjsKKyAKKyAJaWYoaW5fbGRhcCAhPSBpbikKKyAJ
ICAgIGZyZWUoaW5fbGRhcCk7CisgCWZyZWUobGRhcF9maWx0ZXIpOworIAorIAlhc3NlcnQobGRh
cF9yZXMpOworIAkvKiB0aGUgZXh0ZXJuYWwgbmFtZSBoYXNuJ3QgYmVlbiBmb3VuZCBvciB0aGVy
ZSBhcmUgbW9yZSB0aGFuCisgCSAgIG9uZSByZXN1bHQgcmVjb3JkcyAqLworIAlpZihsZGFwX2Nv
dW50X2VudHJpZXMobGRhcF9zZXNzaW9uLCBsZGFwX3JlcykhPTEpIHsKKyAJICAgIGxkYXBfbXNn
ZnJlZShsZGFwX3Jlcyk7CisgCisgCSAgICByZXR1cm4gMTsKKyAJfQorIAllbHNlIHsKKyAJICAg
IExEQVBNZXNzYWdlICplbnRyeTsKKyAJICAgIGNoYXIgKmF0dHI7CisgCisgCSAgICBlbnRyeSA9
IGxkYXBfZmlyc3RfZW50cnkobGRhcF9zZXNzaW9uLCBsZGFwX3Jlcyk7CisgCSAgICBhc3NlcnQo
ZW50cnkpOworIAorIAkgICAgdmFscyA9IGxkYXBfZ2V0X3ZhbHVlcyhsZGFwX3Nlc3Npb24sIGVu
dHJ5LCBsZGFwX2F0dHJzWzBdKTsKKyAJICAgIGFzc2VydCh2YWxzICYmIGxkYXBfY291bnRfdmFs
dWVzKHZhbHMpKTsKKyAKKyAJICAgIC8qIHNhdmUgJ3ZhbHNbMF0nIGFzIGFuIGV4dGVybmFsIG5h
bWUgYW5kICdpbicgYXMgYW4gaW50ZXJuYWwKKyAJICAgICAgIG9uZSAqLworIAkgICAgbm9uZW5j
b2RlZF9vdXQgPSB2YWxzWzBdOworIAkgICAgbm9uZW5jb2RlZF9sZW4gPSBzdHJsZW4obm9uZW5j
b2RlZF9vdXQpOworIAl9CisgCisgCS8qICdub25lbmNvZGVkX291dCcgYnVmZmVyIGlzIGFuIFVU
Ri04IGJ1ZmZlci4gV2UgbmVlZCB0bworIAkgICBjb252ZXJ0IGl0IHRvIE1VVEYtNyBlbmNvZGlu
ZyBpbiBjYXNlIGlmIGl0IGlzIGFuIGV4dGVybmFsCisgCSAgIHVzZXJpZC4gKi8KKyAJaWYoaW50
MmV4dCkgeworIAkgICAgY2hhciAqdGVtcF9vdXQgPSB1dGY4X3RvX211dGY3KG5vbmVuY29kZWRf
b3V0LCBub25lbmNvZGVkX2xlbiwgb3V0X2xlbik7CisgCSAgICBpZighdGVtcF9vdXQpCisgCQly
ZXR1cm4gMTsKKyAJICAgIGlmKCpvdXRfbGVuID4gTUFYX01BSUxCT1hfTkFNRSkgeworIAkJKm91
dF9sZW4gPSAwOworIAkJZnJlZSh0ZW1wX291dCk7CisgCQlyZXR1cm4gMTsKKyAJICAgIH0KKyAJ
ICAgIG1lbWNweShvdXQsIHRlbXBfb3V0LCAqb3V0X2xlbik7CisgCSAgICBmcmVlKHRlbXBfb3V0
KTsKKyAJfQorIAllbHNlIHsKKyAJICAgIG1lbWNweShvdXQsIG5vbmVuY29kZWRfb3V0LCBub25l
bmNvZGVkX2xlbik7CisgCSAgICAqb3V0X2xlbiA9IG5vbmVuY29kZWRfbGVuOworIAl9CisgCisg
CWlmKHZhbHMpCisgCSAgICBsZGFwX3ZhbHVlX2ZyZWUodmFscyk7CisgCWlmKGxkYXBfcmVzKQor
IAkgICAgbGRhcF9tc2dmcmVlKGxkYXBfcmVzKTsKKyAgICAgfQorIAorICAgICByZXR1cm4gMDsK
KyB9CisgCisgLyogcmVhZCBjb252ZXJ0dXNlcmlkIExEQVAgY29uZmlndXJhdGlvbiBvcHRpb25z
IGZyb20gY29uZmlndXJhdGlvbgorICAgIGZpbGVzICovCisgc3RhdGljIGludCByZWFkX2xkYXBf
b3B0aW9ucygpCisgeworICAgICBpbnQgbGRhcF9hdHRyX2ludF9sZW47CisgICAgIGludCBsZGFw
X2F0dHJfZXh0X2xlbjsKKyAKKyAgICAgbGRhcF9ob3N0ID0gY29uZmlnX2dldHN0cmluZyhJTUFQ
T1BUX0NPTlZFUlRVU0VSSURfTERBUF9IT1NUKTsKKyAgICAgaWYoIWxkYXBfaG9zdCkgeworIAlz
eXNsb2coTE9HX0VSUiwgImNvbnZlcnR1c2VyaWRfbGRhcF9ob3N0IG9wdGlvbiBpcyBub3Qgc2V0
XG4iKTsKKyAJcmV0dXJuIDE7CisgICAgIH0KKyAKKyAgICAgbGRhcF9wb3J0ID0gY29uZmlnX2dl
dGludChJTUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9QT1JUKTsKKyAgICAgaWYoIWxkYXBfcG9y
dCkKKyAJbGRhcF9wb3J0PUxEQVBfUE9SVDsKKyAKKyAgICAgbGRhcF91c2VyID0gY29uZmlnX2dl
dHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9VU0VSKTsKKyAgICAgaWYoIWxkYXBf
dXNlcikgeworIAlzeXNsb2coTE9HX0VSUiwgImNvbnZlcnR1c2VyaWRfbGRhcF91c2VyIG9wdGlv
biBpcyBub3Qgc2V0XG4iKTsKKyAJcmV0dXJuIDE7CisgICAgIH0KKyAgICAgbGRhcF9wYXNzd29y
ZCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9DT05WRVJUVVNFUklEX0xEQVBfUEFTU1dPUkQp
OworICAgICBpZighbGRhcF9wYXNzd29yZCkgeworIAlzeXNsb2coTE9HX0VSUiwgImNvbnZlcnR1
c2VyaWRfbGRhcF9wYXNzd29yZCBvcHRpb24gaXMgbm90IHNldFxuIik7CisgCXJldHVybiAxOwor
ICAgICB9CisgICAgIGxkYXBfYmFzZSA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9DT05WRVJU
VVNFUklEX0xEQVBfQkFTRSk7CisgICAgIGlmKCFsZGFwX2Jhc2UpIHsKKyAJc3lzbG9nKExPR19F
UlIsICJjb252ZXJ0dXNlcmlkX2xkYXBfYmFzZSBvcHRpb24gaXMgbm90IHNldFxuIik7CisgCXJl
dHVybiAxOworICAgICB9CisgICAgIGxkYXBfYXR0cl9pbnQgPSBjb25maWdfZ2V0c3RyaW5nKElN
QVBPUFRfQ09OVkVSVFVTRVJJRF9MREFQX0FUVFJfSU5UKTsKKyAgICAgaWYoIWxkYXBfYXR0cl9p
bnQpIHsKKyAJc3lzbG9nKExPR19FUlIsICJjb252ZXJ0dXNlcmlkX2xkYXBfYXR0cl9pbnQgb3B0
aW9uIGlzIG5vdCBzZXRcbiIpOworIAlyZXR1cm4gMTsKKyAgICAgfQorICAgICBsZGFwX2F0dHJf
ZXh0ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9BVFRSX0VY
VCk7CisgICAgIGlmKCFsZGFwX2F0dHJfZXh0KSB7CisgCXN5c2xvZyhMT0dfRVJSLCAiY29udmVy
dHVzZXJpZF9sZGFwX2F0dHJfZXh0IG9wdGlvbiBpcyBub3Qgc2V0XG4iKTsKKyAJcmV0dXJuIDE7
CisgICAgIH0KKyAgICAgbGRhcF9hdHRyX2ludF9sZW4gPSBzdHJsZW4obGRhcF9hdHRyX2ludCk7
CisgICAgIGxkYXBfZmlsdGVyX2ludF9sZW4gPSBsZGFwX2F0dHJfaW50X2xlbiArIExEQVBfRklM
VEVSX1RFTVBMQVRFU0laRTsKKyAgICAgbGRhcF9maWx0ZXJfaW50ID0gKGNoYXIgKiltYWxsb2Mo
bGRhcF9maWx0ZXJfaW50X2xlbik7CisgICAgIGlmKCFsZGFwX2ZpbHRlcl9pbnQpIHsKKyAJc3lz
bG9nKExPR19FUlIsICJtZW1vcnkgYWxsb2NhdGlvbiB3YXMgZmFpbGVkXG4iKTsKKyAJcmV0dXJu
IDE7CisgICAgIH0KKyAgICAgbGRhcF9hdHRyX2V4dF9sZW4gPSBzdHJsZW4obGRhcF9hdHRyX2V4
dCk7CisgICAgIGxkYXBfZmlsdGVyX2V4dF9sZW4gPSBsZGFwX2F0dHJfZXh0X2xlbiArIExEQVBf
RklMVEVSX1RFTVBMQVRFU0laRTsKKyAgICAgbGRhcF9maWx0ZXJfZXh0ID0gKGNoYXIgKiltYWxs
b2MobGRhcF9maWx0ZXJfZXh0X2xlbik7CisgICAgIGlmKCFsZGFwX2ZpbHRlcl9leHQpIHsKKyAJ
c3lzbG9nKExPR19FUlIsICJtZW1vcnkgYWxsb2NhdGlvbiB3YXMgZmFpbGVkXG4iKTsKKyAJZnJl
ZShsZGFwX2ZpbHRlcl9pbnQpOworIAlyZXR1cm4gMTsKKyAgICAgfQorICAgICBzcHJpbnRmKGxk
YXBfZmlsdGVyX2ludCwiKCVzPSUlLipzKSIsbGRhcF9hdHRyX2ludCk7CisgICAgIHNwcmludGYo
bGRhcF9maWx0ZXJfZXh0LCIoJXM9JSUuKnMpIixsZGFwX2F0dHJfZXh0KTsKKyAKKyAgICAgcmV0
dXJuIDA7CisgfQorIAorIGludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikKKyB7CisgICAg
IGludCBvcHQ7CisgICAgIGludCBzLCBsZW47CisgICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBsb2Nh
bDsKKyAgICAgbGRhcF9kYXRhX3QgbGRhcGRhdGE7CisgICAgIGxkYXBfZGF0YV9yZXN1bHRfdCBs
ZGFwZGF0YV9yZXN1bHQ7CisgICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBmcm9tOworICAgICBzb2Nr
bGVuX3QgZnJvbWxlbjsKKyAgICAgcGlkX3QgcGlkOworICAgICBpbnQgZmQ7CisgICAgIGNoYXIg
KmFsdF9jb25maWcgPSBOVUxMOworICAgICBpbnQgY3VyY2hpbGQ7CisgICAgIGludCBwb3J0X251
bTsKKyAKKyAgICAgd2hpbGUgKChvcHQgPSBnZXRvcHQoYXJnYywgYXJndiwgIkM6IikpICE9IEVP
RikgeworIAlzd2l0Y2ggKG9wdCkgeworICAgICAgICAgY2FzZSAnQyc6IC8qIGFsdCBjb25maWcg
ZmlsZSAqLworICAgICAgICAgICAgIGFsdF9jb25maWcgPSBvcHRhcmc7CisgICAgICAgICAgICAg
YnJlYWs7CisgCWNhc2UgJ24nOgorIAkgICAgbl9saXN0ZW5lcnMgPSBhdG9pKG9wdGFyZyk7Cisg
CSAgICBpZihuX2xpc3RlbmVyczw9MCkgeworIAkJZnByaW50ZihzdGRlcnIsICJpbnZhbGlkIG51
bWJlciBvZiBsaXN0ZW5lciBwcm9jZXNzZXNcbiIpOworIAkJZXhpdChFQ19VU0FHRSk7CisgCSAg
ICB9CisgCSAgICBicmVhazsKKyAJZGVmYXVsdDoKKyAJICAgIGZwcmludGYoc3RkZXJyLCAiaW52
YWxpZCBhcmd1bWVudFxuIik7CisgCSAgICBleGl0KEVDX1VTQUdFKTsKKyAJICAgIGJyZWFrOwor
IAl9CisgICAgIH0KKyAKKyAgICAgY3lydXNfaW5pdChhbHRfY29uZmlnLCAibGRhcGQiLCAwKTsK
KyAKKyAgICAgcG9ydF9udW0gPSBjb25maWdfZ2V0aW50KElNQVBPUFRfQ09OVkVSVFVTRVJJRF9V
RFBQT1JUKTsKKyAgICAgaWYoIXBvcnRfbnVtKSB7CisgCXN5c2xvZyhMT0dfRVJSLCAiSW52YWxp
ZCB2YWx1ZSBvZiBjb252ZXJ0dXNlcmlkX3VkcHBvcnQgY29uZmlnIG9wdGlvblxuIik7CisgCWV4
aXQoMSk7CisgICAgIH0KKyAKKyAgICAgaWYocmVhZF9sZGFwX29wdGlvbnMoKSkKKyAJZXhpdCgx
KTsKKyAKKyAgICAgLyogY3JlYXRlIHNvY2tldCB3ZSBhcmUgZ29pbmcgdG8gdXNlIGZvciBsaXN0
ZW5pbmcgKi8KKyAgICAgaWYgKChzID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfREdSQU0sIDApKSA9
PSAtMSkgeworIAlwZXJyb3IoInNvY2tldCIpOworIAljeXJ1c19kb25lKCk7CisgCWV4aXQoMSk7
CisgICAgIH0KKyAKKyAgICAgbl9saXN0ZW5lcnMgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfQ09O
VkVSVFVTRVJJRF9OX0xJU1RFTkVSUyk7CisgICAgIGlmKG5fbGlzdGVuZXJzPD0wKQorIAluX2xp
c3RlbmVycz0xOworIAorICAgICBsb2NhbC5zaW5fZmFtaWx5ID0gQUZfSU5FVDsKKyAgICAgaW5l
dF9wdG9uKEFGX0lORVQsICIxMjcuMC4wLjEiLCAmbG9jYWwuc2luX2FkZHIpOworICAgICBsb2Nh
bC5zaW5fcG9ydCA9IGh0b25zKHBvcnRfbnVtKTsKKyAgICAgbGVuPXNpemVvZihsb2NhbCk7Cisg
CisgICAgIGlmIChiaW5kKHMsIChzdHJ1Y3Qgc29ja2FkZHIgKikmbG9jYWwsIGxlbikgPT0gLTEp
IHsKKyAJcGVycm9yKCJiaW5kIik7CisgCWN5cnVzX2RvbmUoKTsKKyAJZXhpdCgxKTsKKyAgICAg
fQorIAorICAgICBmb3IoY3VyY2hpbGQ9MDsgY3VyY2hpbGQ8bl9saXN0ZW5lcnM7IGN1cmNoaWxk
KyspIHsKKyAJcGlkID0gZm9yaygpOworIAlpZiAocGlkID09IC0xKSB7CisgCSAgICBwZXJyb3Io
ImZvcmsiKTsKKyAJICAgIGN5cnVzX2RvbmUoKTsKKyAJICAgIGV4aXQoMSk7CisgCX0KKyAJCisg
CWlmIChwaWQgIT0gMCkgeyAvKiBwYXJlbnQgKi8KKyAJICAgIGNvbnRpbnVlOworIAl9CisgCS8q
IGNoaWxkICovCisgCWJyZWFrOworICAgICB9CisgCisgICAgIGlmIChwaWQgIT0gMCkgeyAvKiBw
YXJlbnQgKi8KKyAJY3lydXNfZG9uZSgpOworIAlleGl0KDApOworICAgICB9CisgCQorICAgICAv
KiBjaGlsZCAqLworIAorICAgICBmb3IgKDs7KSB7CisgCWludCBuOworIAorIAlmcm9tbGVuID0g
c2l6ZW9mKGZyb20pOworIAluID0gcmVjdmZyb20ocywgKHZvaWQqKSAmbGRhcGRhdGEsIHNpemVv
ZihsZGFwX2RhdGFfdCksIDAsCisgCQkgICAgIChzdHJ1Y3Qgc29ja2FkZHIgKikgJmZyb20sICZm
cm9tbGVuKTsKKyAKKyAJaWYgKG4gPiAwKSB7CisgCSAgICBpZiAobiA8PSBMREFQREFUQV9CQVNF
X1NJWkUgfHwKKyAJCWxkYXBkYXRhLnVzZXJsZW4gPCBuLUxEQVBEQVRBX0JBU0VfU0laRSkKKyAJ
CXN5c2xvZyhMT0dfRVJSLCAiSW52YWxpZCBtZXNzYWdlIHJlY2VpdmVkLCBzaXplPSVkXG4iLCBu
KTsKKyAJICAgIGVsc2UgeworIAkJaW50IHJlc3VsdGxlbj0wOworIAorIAkJbGRhcGRhdGFfcmVz
dWx0LmNvZGU9Z2V0X2lkX2Zyb21fbGRhcCgKKyAJCSAgICBsZGFwZGF0YS5idWYsIGxkYXBkYXRh
LnVzZXJsZW4sCisgCQkgICAgbGRhcGRhdGEuYnVmK2xkYXBkYXRhLnVzZXJsZW4sIG4tTERBUERB
VEFfQkFTRV9TSVpFLWxkYXBkYXRhLnVzZXJsZW4sCisgCQkgICAgbGRhcGRhdGFfcmVzdWx0LmJ1
ZiwgJnJlc3VsdGxlbiwKKyAJCSAgICBsZGFwZGF0YS5pbnQyZXh0KTsKKyAJCWlmKHNlbmR0byhz
LCAodm9pZCAqKSZsZGFwZGF0YV9yZXN1bHQsIHJlc3VsdGxlbitMREFQREFUQV9SRVNVTFRfQkFT
RV9TSVpFLDAsKHN0cnVjdCBzb2NrYWRkciAqKSZmcm9tLGZyb21sZW4pPT0tMSkKKyAJCSAgICBz
eXNsb2coTE9HX0VSUiwgIkNhbm5vdCBzZW5kIGFuIGFuc3dlcjogJXNcbiIsIHN0cmVycm9yKGVy
cm5vKSk7CisgCSAgICB9CisgCX0KKyAgICAgfQorIAorICAgICBjeXJ1c19kb25lKCk7CisgCisg
ICAgIC8qIG5ldmVyIGdldHMgaGVyZSAqLyAgICAgIAorICAgICBleGl0KDEpOworIH0KKyAKKyB2
b2lkIHByaW50c3RyaW5nKGNvbnN0IGNoYXIgKnMgX19hdHRyaWJ1dGVfXygodW51c2VkKSkpCisg
eyAKKyAgICAgLyogbmVlZGVkIHRvIGxpbmsgYWdhaW5zdCBhbm5vdGF0ZS5vICovCisgICAgIGZh
dGFsKCJwcmludHN0cmluZygpIGV4ZWN1dGVkISEhIiwKKyAgICAgICAgICAgRUNfU09GVFdBUkUp
OworIH0KZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9sZGFwZC5o
IGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2xkYXBkLmgKKioqIGN5cnVzLWltYXBkLTIuMi4xMi5v
bGQvaW1hcC9sZGFwZC5oCTE5NzAtMDEtMDEgMDM6MDA6MDAgKzAzMDAKLS0tIGN5cnVzLWltYXBk
LTIuMi4xMi9pbWFwL2xkYXBkLmgJMjAwNS0xMS0xMSAxNzo1ODo1NyArMDMwMAoqKioqKioqKioq
KioqKioKKioqIDAgKioqKgotLS0gMSwyNyAtLS0tCisgI2lmbmRlZiBfTERBUERfSAorICNkZWZp
bmUgX0xEQVBEX0gKKyAKKyAjaW5jbHVkZSAibWFpbGJveC5oIgorIAorIC8qIHNvY2tldCB0byBj
b21tdW5pY2F0ZSB3aXRoIHRoZSBsZGFwZCAqLworICNkZWZpbmUgRk5BTUVfQ09OVkVSVFVTRVJJ
RF9TT0NLICIvc29ja2V0L2xkYXAiCisgCisgdHlwZWRlZiBzdHJ1Y3QgbGRhcF9kYXRhX3Mgewor
ICAgICB1bnNpZ25lZCBsb25nIGludDJleHQ7CisgICAgIHVuc2lnbmVkIGxvbmcgdXNlcmxlbjsg
LyogbGVuZ3RoIG9mIHRoZSB1c2VybmFtZSBidWZmZXIgKi8KKyAKKyAgICAgLyogbm9uLW51bGwt
dGVybWluYXRlZCBidWZmZXIgZm9yIHVzZXJuYW1lIGFuZCBkb21haW4gKi8KKyAgICAgY2hhciBi
dWZbTUFYX01BSUxCT1hfTkFNRSoyXTsKKyB9IGxkYXBfZGF0YV90OworIAorIHR5cGVkZWYgc3Ry
dWN0IGxkYXBfZGF0YV9yZXN1bHRfcyB7CisgICAgIHVuc2lnbmVkIGxvbmcgY29kZTsKKyAKKyAg
ICAgLyogbm9uLW51bGwtdGVybWluYXRlZCBidWZmZXIgZm9yIGNvbnZlcnRlZCB1c2VybmFtZSAq
LworICAgICBjaGFyIGJ1ZltNQVhfTUFJTEJPWF9OQU1FXTsKKyB9IGxkYXBfZGF0YV9yZXN1bHRf
dDsKKyAKKyAjZGVmaW5lIExEQVBEQVRBX0JBU0VfU0laRQkoMiAqIHNpemVvZih1bnNpZ25lZCBs
b25nKSkKKyAjZGVmaW5lIExEQVBEQVRBX1JFU1VMVF9CQVNFX1NJWkUJKHNpemVvZih1bnNpZ25l
ZCBsb25nKSkKKyAKKyAjZW5kaWYgLyogX0xEQVBEX0ggKi8KZGlmZiAtTiAtQyAzIC1yIGN5cnVz
LWltYXBkLTIuMi4xMi5vbGQvaW1hcC9NYWtlZmlsZS5pbiBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1h
cC9NYWtlZmlsZS5pbgoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL01ha2VmaWxlLmlu
CTIwMDUtMTEtMDcgMTg6MDU6MjQgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL01h
a2VmaWxlLmluCTIwMDUtMTEtMTEgMTc6NTg6MzggKzAzMDAKKioqKioqKioqKioqKioqCioqKiA2
OSw3NSAqKioqCiAgU0lFVkVfTElCUyA9IEBTSUVWRV9MSUJTQAogIElNQVBfQ09NX0VSUl9MSUJT
ID0gQElNQVBfQ09NX0VSUl9MSUJTQAogIExJQl9XUkFQID0gQExJQl9XUkFQQAohIExJQlMgPSAk
KElNQVBfTElCUykgJChJTUFQX0NPTV9FUlJfTElCUykKICBERVBMSUJTID0gLi4vbGliL2xpYmN5
cnVzLmEgLi4vbGliL2xpYmN5cnVzX21pbi5hIEBERVBMSUJTQAogIAogIENGTEFHUyA9IEBDRkxB
R1NACi0tLSA2OSw3NSAtLS0tCiAgU0lFVkVfTElCUyA9IEBTSUVWRV9MSUJTQAogIElNQVBfQ09N
X0VSUl9MSUJTID0gQElNQVBfQ09NX0VSUl9MSUJTQAogIExJQl9XUkFQID0gQExJQl9XUkFQQAoh
IExJQlMgPSAkKElNQVBfTElCUykgJChJTUFQX0NPTV9FUlJfTElCUykgLWxyZWRibGFjayAtbGxk
YXAKICBERVBMSUJTID0gLi4vbGliL2xpYmN5cnVzLmEgLi4vbGliL2xpYmN5cnVzX21pbi5hIEBE
RVBMSUJTQAogIAogIENGTEFHUyA9IEBDRkxBR1NACioqKioqKioqKioqKioqKgoqKiogMTA0LDEx
MCAqKioqCiAgCWNvbnZlcnRfY29kZS5vIGR1cGxpY2F0ZS5vIHNhc2xjbGllbnQubyBzYXNsc2Vy
dmVyLm8gc2lnbmFscy5vIFwKICAJYW5ub3RhdGUubyBzZWFyY2hfZW5naW5lcy5vIHNxdWF0Lm8g
c3F1YXRfaW50ZXJuYWwubyBtYmR1bXAubyBcCiAgCWltYXBwYXJzZS5vIHRlbGVtZXRyeS5vIHVz
ZXIubyBub3RpZnkubyBwcm90b2NvbC5vIHF1b3RhX2RiLm8gXAohIAlhdXRvc2lldmUubyAkKFNF
RU4pICQoSURMRSkKICAKICBJTUFQRE9CSlM9cHVzaHN0YXRzLm8gYmFja2VuZC5vIGltYXBkLm8g
aW5kZXgubyB0bHMubyB2ZXJzaW9uLm8KICAKLS0tIDEwNCwxMTAgLS0tLQogIAljb252ZXJ0X2Nv
ZGUubyBkdXBsaWNhdGUubyBzYXNsY2xpZW50Lm8gc2FzbHNlcnZlci5vIHNpZ25hbHMubyBcCiAg
CWFubm90YXRlLm8gc2VhcmNoX2VuZ2luZXMubyBzcXVhdC5vIHNxdWF0X2ludGVybmFsLm8gbWJk
dW1wLm8gXAogIAlpbWFwcGFyc2UubyB0ZWxlbWV0cnkubyB1c2VyLm8gbm90aWZ5Lm8gcHJvdG9j
b2wubyBxdW90YV9kYi5vIFwKISAJYXV0b3NpZXZlLm8gY2hhcnNldF9jb252ZXJ0Lm8gJChTRUVO
KSAkKElETEUpCiAgCiAgSU1BUERPQkpTPXB1c2hzdGF0cy5vIGJhY2tlbmQubyBpbWFwZC5vIGlu
ZGV4Lm8gdGxzLm8gdmVyc2lvbi5vCiAgCioqKioqKioqKioqKioqKgoqKiogMTkwLDE5NSAqKioq
Ci0tLSAxOTAsMTk5IC0tLS0KICAJJChDQykgJChMREZMQUdTKSAtbyBpZGxlZCBcCiAgCSBpZGxl
ZC5vIG11dGV4X2Zha2UubyBsaWJpbWFwLmEgJChTSUVWRV9MSUJTKSAkKERFUExJQlMpICQoTElC
UykKICAKKyBsZGFwZDogbGRhcGQubyBtdXRleF9mYWtlLm8gbGliaW1hcC5hICQoREVQTElCUykK
KyAJJChDQykgJChMREZMQUdTKSAtbyBsZGFwZCBcCisgCSBsZGFwZC5vIG11dGV4X2Zha2UubyBs
aWJpbWFwLmEgJChTSUVWRV9MSUJTKSAkKERFUExJQlMpICQoTElCUykKKyAKICBsbXRwZDogbG10
cGQubyAkKExNVFBPQkpTKSAkKFNJRVZFX09CSlMpIG11dGV4X2Zha2UubyBsaWJpbWFwLmEgJChT
SUVWRV9MSUJTKSBcCiAgCSQoREVQTElCUykgJChTRVJWSUNFKQogIAkkKENDKSAkKExERkxBR1Mp
IC1vIGxtdHBkIFwKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9t
Ym94bGlzdC5jIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL21ib3hsaXN0LmMKKioqIGN5cnVzLWlt
YXBkLTIuMi4xMi5vbGQvaW1hcC9tYm94bGlzdC5jCTIwMDUtMTEtMDcgMTg6MjQ6NDMgKzAzMDAK
LS0tIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL21ib3hsaXN0LmMJMjAwNS0xMS0xMSAxNzo1ODoz
OCArMDMwMAoqKioqKioqKioqKioqKioKKioqIDE4ODAsMTg5MCAqKioqCiAgCX0KICAKICAgICAg
ICAJLyogbWFrZSBzdXJlIGl0J3MgaW4gdGhlIG1haWxib3hlcyBkYiAqLwohIAlpZiAocm9jay0+
Y2hlY2ttYm94bGlzdCkgewohIAkgICAgciA9IG1ib3hsaXN0X2xvb2t1cChuYW1lYnVmLCBOVUxM
LCBOVUxMLCBOVUxMKTsKISAJfSBlbHNlIHsKISAJICAgIHIgPSAwOwkJLyogZG9uJ3QgYm90aGVy
IGNoZWNraW5nICovCiEgCX0KICAKICAJLyogcmlnaHQgd29yayB3aXRoIGFuIGFsdGVybmF0ZSAo
bm90IHRoZSBidWlsZC1pbikKICAJICAgbmFtZXNwYWNlIC8vIHNvcmNlcmVyICovCi0tLSAxODgw
LDE4OTAgLS0tLQogIAl9CiAgCiAgICAgICAgCS8qIG1ha2Ugc3VyZSBpdCdzIGluIHRoZSBtYWls
Ym94ZXMgZGIgKi8KISAgCWlmIChyb2NrLT5jaGVja21ib3hsaXN0KSB7CiEgIAkgICAgciA9IG1i
b3hsaXN0X2xvb2t1cChuYW1lYnVmLCBOVUxMLCBOVUxMLCBOVUxMKTsKISAgCX0gZWxzZSB7CiEg
CSAgICByID0gMDsKISAgCX0KICAKICAJLyogcmlnaHQgd29yayB3aXRoIGFuIGFsdGVybmF0ZSAo
bm90IHRoZSBidWlsZC1pbikKICAJICAgbmFtZXNwYWNlIC8vIHNvcmNlcmVyICovCmRpZmYgLU4g
LUMgMyAtciBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvbWJveG5hbWUuYyBjeXJ1cy1pbWFw
ZC0yLjIuMTIvaW1hcC9tYm94bmFtZS5jCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAv
bWJveG5hbWUuYwkyMDA1LTExLTA3IDE4OjI0OjQ0ICswMzAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIu
MTIvaW1hcC9tYm94bmFtZS5jCTIwMDUtMTEtMTEgMTc6NTg6MzggKzAzMDAKKioqKioqKioqKioq
KioqCioqKiA1Nyw2MiAqKioqCi0tLSA1Nyw2OSAtLS0tCiAgCiAgI2luY2x1ZGUgIm1ib3huYW1l
LmgiCiAgI2luY2x1ZGUgIm1ib3hsaXN0LmgiCisgI2luY2x1ZGUgImltYXBkLmgiCisgCisgI2lm
ZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICNpbmNsdWRlIDxyZWRibGFjay5oPgorICNpbmNs
dWRlIDxzeXNsb2cuaD4KKyAjaW5jbHVkZSAibGRhcGQuaCIKKyAjZW5kaWYgLyogRU5BQkxFX0NP
TlZFUlRfVVNFUklEICovCiAgCiAgLyogTWFpbGJveCBwYXR0ZXJucyB3aGljaCB0aGUgZGVzaWdu
IG9mIHRoZSBzZXJ2ZXIgcHJvaGliaXRzICovCiAgc3RhdGljIGNoYXIgKmJhZG1ib3hwYXR0ZXJu
c1tdID0gewoqKioqKioqKioqKioqKioKKioqIDk1LDEwMCAqKioqCi0tLSAxMDIsNDM4IC0tLS0K
ICB9OwogICNkZWZpbmUgQ0hBUk1PRDY0KGMpICAoaW5kZXhfbW9kNjRbKHVuc2lnbmVkIGNoYXIp
KGMpXSkKICAKKyAjaWZkZWYgRU5BQkxFX0NPTlZFUlRfVVNFUklECisgdHlwZWRlZiBzdHJ1Y3Qg
X3JidF9kYXRhX3QgeworICAgICBjaGFyICpkb21haW47CisgICAgIGNoYXIgKmlkX2luOworICAg
ICBpbnQgaWRfaW5fbGVuOworICAgICBjaGFyICppZF9vdXQ7CisgICAgIGludCBpZF9vdXRfbGVu
OworIH0gcmJ0X2RhdGFfdDsKKyAKKyBzdGF0aWMgc3RydWN0IHJidHJlZSAqcmJ0X2ludF90b19l
eHQ9TlVMTDsKKyBzdGF0aWMgc3RydWN0IHJidHJlZSAqcmJ0X2V4dF90b19pbnQ9TlVMTDsKKyAK
KyBzdGF0aWMgaW50IGNvbnZlcnR1c2VyaWRfc29ja2V0PS0xOworIAorIGludCByYnRfZGF0YV9j
b21wYXJlKGNvbnN0IHZvaWQgKnAxLCBjb25zdCB2b2lkICpwMiwgY29uc3Qgdm9pZCAqY29uZmln
KQorIHsKKyAgICAgcmJ0X2RhdGFfdCAqZDE9KHJidF9kYXRhX3QgKilwMTsKKyAgICAgcmJ0X2Rh
dGFfdCAqZDI9KHJidF9kYXRhX3QgKilwMjsKKyAgICAgaW50IHJlczsKKyAKKyAgICAgaWYoIShy
ZXM9c3RyY21wKGQxLT5kb21haW4sIGQyLT5kb21haW4pKSkgeworIAljaGFyICpzdHIxLCAqc3Ry
MjsKKyAJaW50IHN0cjFfbGVuLCBzdHIyX2xlbjsKKyAJaW50IG1pbl9sZW47CisgCisgCWlmKGNv
bmZpZykgeworIAkgICAgc3RyMT1kMS0+aWRfaW47CisgCSAgICBzdHIxX2xlbj1kMS0+aWRfaW5f
bGVuOworIAkgICAgc3RyMj1kMi0+aWRfaW47CisgCSAgICBzdHIyX2xlbj1kMi0+aWRfaW5fbGVu
OworIAl9CisgCWVsc2UgeworIAkgICAgc3RyMT1kMS0+aWRfb3V0OworIAkgICAgc3RyMV9sZW49
ZDEtPmlkX291dF9sZW47CisgCSAgICBzdHIyPWQyLT5pZF9vdXQ7CisgCSAgICBzdHIyX2xlbj1k
Mi0+aWRfb3V0X2xlbjsKKyAJfQorIAltaW5fbGVuID0gKHN0cjFfbGVuIDwgc3RyMl9sZW4pPyBz
dHIxX2xlbiA6IHN0cjJfbGVuOworIAlpZighKHJlcz1tZW1jbXAoc3RyMSwgc3RyMiwgbWluX2xl
bikpKSB7CisgCSAgICBpZihtaW5fbGVuPT1zdHIxX2xlbikKKyAJCXJlcyA9IChtaW5fbGVuPT1z
dHIyX2xlbik/MDotMTsKKyAJICAgIGVsc2UKKyAJCXJlcyA9IC0xOworIAl9CisgICAgIH0KKyAg
ICAgcmV0dXJuIHJlczsKKyB9CisgCisgI2RlZmluZSBET05UX0FMTE9DQVRFX0lOICAweDEKKyAj
ZGVmaW5lIERPTlRfQUxMT0NBVEVfT1VUIDB4MgorIAorIHJidF9kYXRhX3QgKnJidF9pbml0X3Vz
ZXJpZF9kYXRhKGNvbnN0IGNoYXIgKmRvbWFpbiwgY29uc3QgY2hhciAqaW4sIGludCBpbl9sZW4s
IGNvbnN0IGNoYXIgKm91dCwgaW50IG91dF9sZW4sIGludCBmbGFncykKKyB7CisgICAgIHJidF9k
YXRhX3QgKnJlcz0ocmJ0X2RhdGFfdCAqKW1hbGxvYyhzaXplb2YocmJ0X2RhdGFfdCkpOworIAor
ICAgICBpZighcmVzKQorIAlyZXR1cm4gTlVMTDsKKyAKKyAgICAgcmVzLT5kb21haW4gPSBzdHJk
dXAoZG9tYWluKTsKKyAgICAgaWYoIXJlcy0+ZG9tYWluKSB7CisgCWZyZWUocmVzKTsKKyAJcmV0
dXJuIE5VTEw7CisgICAgIH0KKyAKKyAgICAgaWYoaW4gPT0gb3V0ICYmIChmbGFncyAmIChET05U
X0FMTE9DQVRFX0lOfERPTlRfQUxMT0NBVEVfT1VUKSkpCisgCWZsYWdzIHw9IChET05UX0FMTE9D
QVRFX0lOfERPTlRfQUxMT0NBVEVfT1VUKTsKKyAKKyAgICAgaWYoZmxhZ3MgJiBET05UX0FMTE9D
QVRFX0lOKQorIAlyZXMtPmlkX2luID0gKGNoYXIgKilpbjsKKyAgICAgZWxzZSBpZighKHJlcy0+
aWRfaW4gPSAoY2hhciAqKW1hbGxvYyhpbl9sZW4pKSkgeworIAlmcmVlKHJlcy0+ZG9tYWluKTsK
KyAJZnJlZShyZXMpOworIAlyZXR1cm4gTlVMTDsKKyAgICAgfQorICAgICBlbHNlCisgCW1lbWNw
eShyZXMtPmlkX2luLCBpbiwgaW5fbGVuKTsKKyAKKyAgICAgaWYoaW4gPT0gb3V0ICYmICFmbGFn
cykgeworIAlvdXQgPSByZXMtPmlkX2luOworIAlmbGFncyB8PSBET05UX0FMTE9DQVRFX09VVDsK
KyAgICAgfQorIAorICAgICBpZihmbGFncyAmIERPTlRfQUxMT0NBVEVfT1VUKQorIAlyZXMtPmlk
X291dCA9IChjaGFyICopb3V0OworICAgICBlbHNlIGlmKCEocmVzLT5pZF9vdXQgPSAoY2hhciAq
KW1hbGxvYyhvdXRfbGVuKSkpIHsKKyAJZnJlZShyZXMtPmRvbWFpbik7CisgCWlmKCEoZmxhZ3Mg
JiBET05UX0FMTE9DQVRFX0lOKSkKKyAJICAgIGZyZWUocmVzLT5pZF9pbik7CisgCWZyZWUocmVz
KTsKKyAJcmV0dXJuIE5VTEw7CisgICAgIH0KKyAgICAgZWxzZQorIAltZW1jcHkocmVzLT5pZF9v
dXQsIG91dCwgb3V0X2xlbik7CisgCisgICAgIHJlcy0+aWRfaW5fbGVuID0gaW5fbGVuOworICAg
ICByZXMtPmlkX291dF9sZW4gPSBvdXRfbGVuOworIAorICAgICByZXR1cm4gcmVzOworIH0KKyAK
KyB2b2lkIHJidF9mcmVlX3VzZXJpZF9kYXRhKHJidF9kYXRhX3QgKmRhdGEpCisgeworICAgICBm
cmVlKGRhdGEtPmRvbWFpbik7CisgICAgIGZyZWUoZGF0YS0+aWRfaW4pOworICAgICBpZihkYXRh
LT5pZF9pbiE9ZGF0YS0+aWRfb3V0KQorIAlmcmVlKGRhdGEtPmlkX291dCk7CisgICAgIGZyZWUo
ZGF0YSk7CisgfQorIAorICNkZWZpbmUgSU5URVJOQUwgICAgICAgICAgICAgIDB4MQorICNkZWZp
bmUgTERBUF9OQU1FX01VU1RfRVhJU1RTIDB4MgorIAorIGV4dGVybiBpbnQgY29udmVydHVzZXJp
ZF9pbml0KCkKKyB7CisgICAgIGNvbnN0IGNoYXIgKmNvbnZlcnR1c2VyaWRfc29jazsKKyAgICAg
aW50IGxvY2FsbGVuOworICAgICBpbnQgcGF0aGxlbjsKKyAgICAgbW9kZV90IG9sZHVtYXNrOwor
ICAgICBpbnQgcG9ydF9udW07CisgICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBjb252ZXJ0dXNlcmlk
X3JlbW90ZTsKKyAgICAgaW50IGNvbnZlcnR1c2VyaWRfcmVtb3RlX2xlbjsKKyAKKyAgICAgLyog
aWYgdGhlIHNvY2tldCBpcyBhbHJlYWR5IG9wZW4sIHJldHVybiAqLworICAgICBpZiAoY29udmVy
dHVzZXJpZF9zb2NrZXQgIT0gLTEpIHsKKyAJc3lzbG9nKExPR19FUlIsICJjb252ZXJ0dXNlcmlk
X2luaXQ6IG11c3Qgbm90IGJlIGNhbGxlZCB0d2ljZSIpOworIAlyZXR1cm4gLTE7CisgICAgIH0K
KyAKKyAgICAgcG9ydF9udW0gPSBjb25maWdfZ2V0aW50KElNQVBPUFRfQ09OVkVSVFVTRVJJRF9V
RFBQT1JUKTsKKyAgICAgaWYoIXBvcnRfbnVtKSB7CisgCXN5c2xvZyhMT0dfRVJSLCAiSW52YWxp
ZCB2YWx1ZSBvZiBjb252ZXJ0dXNlcmlkX3VkcHBvcnQgY29uZmlnIG9wdGlvblxuIik7CisgCXJl
dHVybiAtMTsKKyAgICAgfQorIAorICAgICBpZiAoKGNvbnZlcnR1c2VyaWRfc29ja2V0ID0gc29j
a2V0KEFGX0lORVQsIFNPQ0tfREdSQU0sIDApKSA9PSAtMSkgeworIAlzeXNsb2coTE9HX0VSUiwg
ImNvbnZlcnR1c2VyaWRfaW5pdDogY2FuJ3QgY3JlYXRlIGEgc29ja2V0Iik7CisgCXJldHVybiAt
MTsKKyAgICAgfQorIAorICAgICBjb252ZXJ0dXNlcmlkX3JlbW90ZS5zaW5fZmFtaWx5ID0gQUZf
SU5FVDsKKyAgICAgY29udmVydHVzZXJpZF9yZW1vdGUuc2luX3BvcnQgPSBodG9ucyhwb3J0X251
bSk7CisgICAgIGluZXRfcHRvbihBRl9JTkVULCAiMTI3LjAuMC4xIiwgJmNvbnZlcnR1c2VyaWRf
cmVtb3RlLnNpbl9hZGRyKTsKKyAgICAgY29udmVydHVzZXJpZF9yZW1vdGVfbGVuID0gc2l6ZW9m
KGNvbnZlcnR1c2VyaWRfcmVtb3RlKTsKKyAKKyAgICAgaWYoY29ubmVjdChjb252ZXJ0dXNlcmlk
X3NvY2tldCwgKHN0cnVjdCBzb2NrYWRkciAqKSZjb252ZXJ0dXNlcmlkX3JlbW90ZSwgY29udmVy
dHVzZXJpZF9yZW1vdGVfbGVuKT09LTEpIHsKKyAJc3lzbG9nKExPR19FUlIsICJjb252ZXJ0dXNl
cmlkX2luaXQ6IGNhbid0IGNvbm5lY3QgKGRhdGFncmFtKSIpOworIAlyZXR1cm4gLTE7CisgICAg
IH0KKyAKKyAgICAgcmV0dXJuIDA7CisgfQorIAorIHN0YXRpYyBjaGFyICptYm94bmFtZV9nZXRf
aWRfZnJvbV9sZGFwKGNvbnN0IGNoYXIgKmluLCBpbnQgaW5fbGVuLCBjb25zdCBjaGFyICpkb21h
aW4sIGludCAqb3V0X2xlbiwgaW50IGZsYWdzKQorIHsKKyAgICAgbGRhcF9kYXRhX3Qgc2VuZGRh
dGE7CisgICAgIGludCBkb21haW5sZW49c3RybGVuKGRvbWFpbik7CisgICAgIHNzaXplX3Qgc2l6
ZTsKKyAKKyAgICAgc2VuZGRhdGEuaW50MmV4dCA9IGZsYWdzJklOVEVSTkFMOworICAgICBzZW5k
ZGF0YS51c2VybGVuID0gaW5fbGVuOworICAgICBtZW1jcHkoc2VuZGRhdGEuYnVmLCBpbiwgaW5f
bGVuKTsKKyAgICAgbWVtY3B5KHNlbmRkYXRhLmJ1Zitpbl9sZW4sIGRvbWFpbiwgZG9tYWlubGVu
KTsKKyAKKyAgICAgc2l6ZT1zZW5kKGNvbnZlcnR1c2VyaWRfc29ja2V0LCAodm9pZCAqKSZzZW5k
ZGF0YSwgTERBUERBVEFfQkFTRV9TSVpFK2luX2xlbitkb21haW5sZW4sIDApOworICAgICBpZihz
aXplID09IChzc2l6ZV90KS0xKSB7CisgCXN5c2xvZyhMT0dfRVJSLCAiQ2Fubm90IHNlbmQgY29u
dmVydHVzZXJpZCBxdWVyeTogJXMuXG4iLCBzdHJlcnJvcihlcnJubykpOworIAlyZXR1cm4gTlVM
TDsKKyAgICAgfQorICAgICBpZihzaXplICE9IExEQVBEQVRBX0JBU0VfU0laRStpbl9sZW4rZG9t
YWlubGVuKQorIAlzeXNsb2coTE9HX0VSUiwgIkNhbm5vdCBzZW5kIGZ1bGwgY29udmVydHVzZXJp
ZCBxdWVyeS5cbiIpOworIAorICAgICBpZihzaXplKSB7CisgCXN0cnVjdCBzb2NrYWRkcl91biBm
cm9tOworIAlzb2NrbGVuX3QgZnJvbWxlbj1zaXplb2YoZnJvbSk7CisgCWxkYXBfZGF0YV9yZXN1
bHRfdCByZWN2ZGF0YTsKKyAJY2hhciAqb3V0OworIAorIAlzaXplID0gcmVjdihjb252ZXJ0dXNl
cmlkX3NvY2tldCwgKHZvaWQgKikmcmVjdmRhdGEsIHNpemVvZihyZWN2ZGF0YSksIDApOworIAlp
ZihzaXplPT0oc3NpemVfdCktMSkgeworIAkgICAgc3lzbG9nKExPR19FUlIsICJDYW5ub3QgcmVj
ZWl2ZSBjb252ZXJ0dXNlcmlkIGFuc3dlcjogJXMuXG4iLCBzdHJlcnJvcihlcnJubykpOworIAkg
ICAgcmV0dXJuIE5VTEw7CisgCX0KKyAJaWYoc2l6ZTxMREFQREFUQV9SRVNVTFRfQkFTRV9TSVpF
KSB7CisgCSAgICBzeXNsb2coTE9HX0VSUiwgIldyb25nIHNpemUgb2YgY29udmVydHVzZXJpZCBh
bnN3ZXIuXG4iKTsKKyAJICAgIHJldHVybiBOVUxMOworIAl9CisgCS8qIGFuc3dlciBpcyAiY2Fu
J3QgY29udmVydCB1c2VyaWQiIG9yIHJlc3VsdCBzdHJpbmcgaXMKKyAJICAgZW1wdHkgKi8KKyAJ
aWYocmVjdmRhdGEuY29kZSB8fCBzaXplPT1MREFQREFUQV9SRVNVTFRfQkFTRV9TSVpFKQorIAkg
ICAgcmV0dXJuIE5VTEw7CisgCXNpemUtPUxEQVBEQVRBX1JFU1VMVF9CQVNFX1NJWkU7CisgCW91
dD0oY2hhciAqKW1hbGxvYyhzaXplKTsKKyAJaWYoIW91dCkKKyAJICAgIHJldHVybiBOVUxMOwor
IAltZW1jcHkob3V0LCByZWN2ZGF0YS5idWYsIHNpemUpOworIAkqb3V0X2xlbiA9IHNpemU7Cisg
CXJldHVybiBvdXQ7CisgICAgIH0KKyAKKyAgICAgcmV0dXJuIE5VTEw7CisgfQorIAorIHN0YXRp
YyBjaGFyICptYm94bmFtZV9nZXRfaWQoY29uc3QgY2hhciAqaW4sIGludCBpbl9sZW4sIGNvbnN0
IGNoYXIgKmRvbWFpbiwgaW50ICpvdXRfbGVuLCBzdHJ1Y3QgcmJ0cmVlICoqY19pbnQsIHN0cnVj
dCByYnRyZWUgKipjX2V4dCwgaW50IGZsYWdzKQorIHsKKyAgICAgcmJ0X2RhdGFfdCBkYXRhOwor
ICAgICByYnRfZGF0YV90ICpzYXZlZF9kYXRhOworICAgICBjaGFyICpvdXQ7CisgICAgIGludCBu
ZWVkX2FsbG9jPTA7CisgCisgICAgIGlmKCEqY19pbnQpCisgCWlmKCEoKmNfaW50ID0gcmJpbml0
KHJidF9kYXRhX2NvbXBhcmUsICh2b2lkICopKChmbGFncyZJTlRFUk5BTCk+MCkpKSkKKyAJICAg
IHJldHVybiBOVUxMOworICAgICBpZighKmNfZXh0KQorIAlpZighKCpjX2V4dCA9IHJiaW5pdChy
YnRfZGF0YV9jb21wYXJlLCAodm9pZCAqKSghKGZsYWdzJklOVEVSTkFMKSkpKSkKKyAJICAgIHJl
dHVybiBOVUxMOworICAgICBkYXRhLmRvbWFpbiA9IChjaGFyICopZG9tYWluOworIAkgICAKKyAg
ICAgaWYoZmxhZ3MmSU5URVJOQUwpIHsKKyAJZGF0YS5pZF9pbiA9IChjaGFyICopaW47CisgCWRh
dGEuaWRfaW5fbGVuID0gaW5fbGVuOworIAlkYXRhLmlkX291dCA9IE5VTEw7CisgCWRhdGEuaWRf
b3V0X2xlbiA9IDA7CisgICAgIH0KKyAgICAgZWxzZSB7CisgCWRhdGEuaWRfb3V0ID0gKGNoYXIg
KilpbjsKKyAJZGF0YS5pZF9vdXRfbGVuID0gaW5fbGVuOworIAlkYXRhLmlkX2luID0gTlVMTDsK
KyAJZGF0YS5pZF9pbl9sZW4gPSAwOworICAgICB9CisgCisgICAgIC8qIGZpcnN0bHkgbG9vayBm
b3IgdGhlIG5hbWUgaW4gdGhlIGxvY2FsIChpbi1tZW1vcnkpIHN0b3JhZ2UgKi8KKyAgICAgaWYo
KHNhdmVkX2RhdGE9KHJidF9kYXRhX3QgKilyYmZpbmQoKHZvaWQgKikmZGF0YSwgKmNfaW50KSkp
IHsKKyAJaWYoZmxhZ3MmSU5URVJOQUwpIHsKKyAJICAgICpvdXRfbGVuID0gc2F2ZWRfZGF0YS0+
aWRfb3V0X2xlbjsKKyAJICAgIHJldHVybiBzYXZlZF9kYXRhLT5pZF9vdXQ7CisgCX0KKyAJZWxz
ZSB7CisgCSAgICAqb3V0X2xlbiA9IHNhdmVkX2RhdGEtPmlkX2luX2xlbjsKKyAJICAgIHJldHVy
biBzYXZlZF9kYXRhLT5pZF9pbjsKKyAJfSAKKyAgICAgfQorIAorICAgICBvdXQgPSBtYm94bmFt
ZV9nZXRfaWRfZnJvbV9sZGFwKGluLCBpbl9sZW4sIGRvbWFpbiwgb3V0X2xlbiwgZmxhZ3MpOwor
IAorICAgICBpZighb3V0KSB7CisgCWlmKGZsYWdzICYgTERBUF9OQU1FX01VU1RfRVhJU1RTKQor
IAkgICAgcmV0dXJuIE5VTEw7CisgCS8qIHNhdmUgdGhlIGludGVybmFsIG5hbWUgYXMgZXh0ZXJu
YWwgaWYgTERBUCBmZXRjaGluZyBmYWlscyAqLworIAllbHNlIHsKKyAJICAgIG91dD0oY2hhciAq
KWluOworIAkgICAgKm91dF9sZW49aW5fbGVuOworIAkgICAgbmVlZF9hbGxvYz0xOworIAl9Cisg
ICAgIH0KKyAgICAgCisgICAgIC8qIE5vdyB3ZSBoYXZlICdvdXQnIGFuZCAnKm91dF9sZW4nIHZh
cmlhYmxlcy4gU2F2ZSAnaW4nIGFuZAorICAgICAgICAnb3V0JyBpbiBvdXIgbWVtb3J5IGRhdGFi
YXNlcyAqLworICAgICBpZihmbGFncyZJTlRFUk5BTCkKKyAJc2F2ZWRfZGF0YT1yYnRfaW5pdF91
c2VyaWRfZGF0YShkb21haW4sIGluLCBpbl9sZW4sIG91dCwgKm91dF9sZW4sIG5lZWRfYWxsb2M/
MDpET05UX0FMTE9DQVRFX09VVCk7CisgICAgIGVsc2UKKyAJc2F2ZWRfZGF0YT1yYnRfaW5pdF91
c2VyaWRfZGF0YShkb21haW4sIG91dCwgKm91dF9sZW4sIGluLCBpbl9sZW4sIG5lZWRfYWxsb2M/
MDpET05UX0FMTE9DQVRFX0lOKTsKKyAgICAgCisgICAgIGlmKCFyYnNlYXJjaChzYXZlZF9kYXRh
LCpjX2ludCkpIHsKKyAJcmJ0X2ZyZWVfdXNlcmlkX2RhdGEoc2F2ZWRfZGF0YSk7CisgCXNhdmVk
X2RhdGE9TlVMTDsKKyAgICAgfQorICAgICBlbHNlIGlmKCFyYnNlYXJjaChzYXZlZF9kYXRhLCpj
X2V4dCkpIHsKKyAJcmJkZWxldGUoc2F2ZWRfZGF0YSwgKmNfaW50KTsKKyAJcmJ0X2ZyZWVfdXNl
cmlkX2RhdGEoc2F2ZWRfZGF0YSk7CisgCXNhdmVkX2RhdGE9TlVMTDsKKyAgICAgfQorIAorICAg
ICAvKiBJZiB3ZSBjYW4ndCBzYXZlIGRhdGEgaW4gdGhlIG1lbW9yeSBzdG9yYWdlIHRoZW4gcmV0
dXJuIE5VTEwKKyAgICAgICAgYmVjYXVzZSB3ZSBhcmUgbm90IHN1cmUgaWYgZGF0YSBpbiBsZGFw
IHN0b3JhZ2Ugd2lsbCBub3QgYmUKKyAgICAgICAgY2hhbmdlZCB3aGVuIHRoaXMgZnVuY3Rpb24g
aXMgY2FsbGVkIG5leHQgdGltZS4gRml4bWU6IG1heWJlLAorICAgICAgICB3ZSBjYW4gcmV0dXJu
IGNvbnZlcnRlZCBzdHJpbmcgYW55d2F5LiAqLworICAgICBpZighc2F2ZWRfZGF0YSkKKyAJcmV0
dXJuIE5VTEw7CisgCSAgICAKKyAgICAgcmV0dXJuIG91dDsKKyB9CisgCisgc3RhdGljIHZvaWQg
cmJ0X3dhbGtfY2IoY29uc3Qgdm9pZCAqbm9kZXAsIGNvbnN0IFZJU0lUIHdoaWNoLCBjb25zdCBp
bnQgZGVwdGgsIHZvaWQgKmFyZykKKyB7CisgICAgIGlmKHdoaWNoID09IGVuZG9yZGVyIHx8IHdo
aWNoID09IGxlYWYpCisgCXJidF9mcmVlX3VzZXJpZF9kYXRhKChyYnRfZGF0YV90ICopbm9kZXAp
OworIH0KKyAKKyAvKiBkZXN0cm95aW5nIGFsbCB0aGUgZGF0YSBuZWVkZWQgZm9yIG5hbWVzIHRy
YW5zZm9ybWF0aW9uICh0aGlzCisgICAgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW4gY2xpZW50IHRl
cm1pbmF0ZXMgaGlzIGNvbm5lY3Rpb24pICovCisgZXh0ZXJuIHZvaWQgbWJveG5hbWVfY2xlYW51
cCgpCisgeworICAgICByYnRfZGF0YV90ICpkYXRhOworIAorICAgICBpZihyYnRfaW50X3RvX2V4
dCkgeworIAlyYndhbGsocmJ0X2ludF90b19leHQsIHJidF93YWxrX2NiLCBOVUxMKTsKKyAJICAg
IAorIAlyYmRlc3Ryb3kocmJ0X2ludF90b19leHQpOworIAlyYnRfaW50X3RvX2V4dD1OVUxMOwor
ICAgICB9CisgICAgIGlmKHJidF9leHRfdG9faW50KSB7CisgCXJiZGVzdHJveShyYnRfZXh0X3Rv
X2ludCk7CisgCXJidF9leHRfdG9faW50PU5VTEw7CisgICAgIH0KKyB9CisgZXh0ZXJuIGludCBj
b252ZXJ0dXNlcmlkX2NsZWFudXAoKQorIHsKKyAgICAgY2xvc2UoY29udmVydHVzZXJpZF9zb2Nr
ZXQpOworIH0KKyAKKyAjZW5kaWYgLyogRU5BQkxFX0NPTlZFUlRfVVNFUklEICovCisgCisgc3Rh
dGljIGNoYXIgKm1ib3huYW1lX2dldF9leHRlcm5hbF9pZChjb25zdCBjaGFyICppbiwgaW50IGlu
X2xlbiwgY29uc3QgY2hhciAqZG9tYWluLCBpbnQgKm91dF9sZW4pCisgeworICNpZm5kZWYgRU5B
QkxFX0NPTlZFUlRfVVNFUklECisgICAgICpvdXRfbGVuID0gaW5fbGVuOworICAgICByZXR1cm4g
KGNoYXIgKilpbjsKKyAjZWxzZQorICAgICByZXR1cm4gbWJveG5hbWVfZ2V0X2lkKGluLCBpbl9s
ZW4sIGRvbWFpbiwgb3V0X2xlbiwgJnJidF9pbnRfdG9fZXh0LCAmcmJ0X2V4dF90b19pbnQsIElO
VEVSTkFMfExEQVBfTkFNRV9NVVNUX0VYSVNUUyk7CisgI2VuZGlmCisgfQorIAorIHN0YXRpYyBj
aGFyICptYm94bmFtZV9nZXRfaW50ZXJuYWxfaWQoY29uc3QgY2hhciAqaW4sIGludCBpbl9sZW4s
IGNvbnN0IGNoYXIgKmRvbWFpbiwgaW50ICpvdXRfbGVuKQorIHsKKyAjaWZuZGVmIEVOQUJMRV9D
T05WRVJUX1VTRVJJRAorICAgICAqb3V0X2xlbiA9IGluX2xlbjsKKyAgICAgcmV0dXJuIChjaGFy
ICopaW47CisgI2Vsc2UKKyAgICAgcmV0dXJuIG1ib3huYW1lX2dldF9pZChpbiwgaW5fbGVuLCBk
b21haW4sIG91dF9sZW4sICZyYnRfZXh0X3RvX2ludCwgJnJidF9pbnRfdG9fZXh0LCBMREFQX05B
TUVfTVVTVF9FWElTVFMpOworICNlbmRpZgorIH0KICAKICBzdGF0aWMgaW50IG1ib3huYW1lX2No
ZWNrX2hpZXJzZXBzKHN0cnVjdCBuYW1lc3BhY2UgKm5hbWVzcGFjZSwgY29uc3QgY2hhciAqbmFt
ZSwgaW50IG5hbWVsZW4pCiAgewoqKioqKioqKioqKioqKioKKioqIDIwNSwyMTEgKioqKgogIAkJ
CQkgICBjb25zdCBjaGFyICpuYW1lLAogIAkJCQkgICBjb25zdCBjaGFyICp1c2VyaWQsIGNoYXIg
KnJlc3VsdCkKICB7CiEgICAgIGNoYXIgKmNwOwogICAgICBpbnQgdXNlcmxlbiwgZG9tYWlubGVu
ID0gMCwgbmFtZWxlbjsKICAgICAgaW50IHByZWZpeGxlbjsKICAgICAgc2l6ZV90IHJlc3VsdGxl
bjsKLS0tIDU0Myw1NDkgLS0tLQogIAkJCQkgICBjb25zdCBjaGFyICpuYW1lLAogIAkJCQkgICBj
b25zdCBjaGFyICp1c2VyaWQsIGNoYXIgKnJlc3VsdCkKICB7CiEgICAgIGNoYXIgKmNwLCAqZG9t
YWluPSIiOwogICAgICBpbnQgdXNlcmxlbiwgZG9tYWlubGVuID0gMCwgbmFtZWxlbjsKICAgICAg
aW50IHByZWZpeGxlbjsKICAgICAgc2l6ZV90IHJlc3VsdGxlbjsKKioqKioqKioqKioqKioqCioq
KiAyMjIsMjI4ICoqKioKICAgICAgaWYgKGNvbmZpZ192aXJ0ZG9tYWlucykgewogIAlpZiAodXNl
cmlkICYmIChjcCA9IHN0cmNocih1c2VyaWQsICdAJykpKSB7CiAgCSAgICAvKiB1c2VyIGxvZ2dl
ZCBpbiBhcyB1c2VyQGRvbWFpbiAqLwohIAkgICAgdXNlcmxlbiA9IGNwKysgLSB1c2VyaWQ7CiAg
CSAgICBpZiAoIShjb25maWdfZGVmZG9tYWluICYmICFzdHJjYXNlY21wKGNvbmZpZ19kZWZkb21h
aW4sIGNwKSkpIHsKICAJCS8qIGRvbid0IHByZXBlbmQgZGVmYXVsdCBkb21haW4gKi8KICAJCWRv
bWFpbmxlbiA9IHN0cmxlbihjcCkrMTsKLS0tIDU2MCw1NjcgLS0tLQogICAgICBpZiAoY29uZmln
X3ZpcnRkb21haW5zKSB7CiAgCWlmICh1c2VyaWQgJiYgKGNwID0gc3RyY2hyKHVzZXJpZCwgJ0An
KSkpIHsKICAJICAgIC8qIHVzZXIgbG9nZ2VkIGluIGFzIHVzZXJAZG9tYWluICovCiEgCSAgICB1
c2VybGVuID0gY3AgLSB1c2VyaWQ7CiEgCSAgICBkb21haW4gPSArK2NwOwogIAkgICAgaWYgKCEo
Y29uZmlnX2RlZmRvbWFpbiAmJiAhc3RyY2FzZWNtcChjb25maWdfZGVmZG9tYWluLCBjcCkpKSB7
CiAgCQkvKiBkb24ndCBwcmVwZW5kIGRlZmF1bHQgZG9tYWluICovCiAgCQlkb21haW5sZW4gPSBz
dHJsZW4oY3ApKzE7CioqKioqKioqKioqKioqKgoqKiogMjMzLDIzOCAqKioqCi0tLSA1NzIsNTc4
IC0tLS0KICAJfQogIAlpZiAoKGNwID0gc3RycmNocihuYW1lLCAnQCcpKSkgewogIAkgICAgLyog
bWFpbGJveCBzcGVjaWZpZWQgYXMgbWJveEBkb21haW4gKi8KKyAJICAgIGRvbWFpbiA9IGNwKzE7
CiAgCSAgICBuYW1lbGVuID0gY3AgLSBuYW1lOwogIAogIAkgICAgaWYgKGNvbmZpZ19kZWZkb21h
aW4gJiYgIXN0cmNhc2VjbXAoY29uZmlnX2RlZmRvbWFpbiwgY3ArMSkpIHsKKioqKioqKioqKioq
KioqCioqKiAyOTAsMzA3ICoqKioKICAKICAgICAgaWYgKCFzdHJuY21wKG5hbWUsIG5hbWVzcGFj
ZS0+cHJlZml4W05BTUVTUEFDRV9VU0VSXSwgcHJlZml4bGVuLTEpICYmCiAgCShuYW1lbGVuID09
IHByZWZpeGxlbi0xIHx8IG5hbWVbcHJlZml4bGVuLTFdID09IG5hbWVzcGFjZS0+aGllcl9zZXAp
KSB7CiAgCiAgCWlmIChuYW1lbGVuID09IHByZWZpeGxlbi0xKSB7CiAgCSAgICAvKiBjYW4ndCBj
cmVhdGUgZm9sZGVycyB1c2luZyB1bmRlbGltaXRlZCBwcmVmaXggKi8KICAJICAgIHJldHVybiBJ
TUFQX01BSUxCT1hfQkFETkFNRTsKICAJfQogIAohIAlpZiAoZG9tYWlubGVuK25hbWVsZW4tcHJl
Zml4bGVuKzUgPiBNQVhfTUFJTEJPWF9OQU1FKSB7CiEgCSAgICByZXR1cm4gSU1BUF9NQUlMQk9Y
X0JBRE5BTUU7CiAgCX0KICAKISAJc3ByaW50ZihyZXN1bHQsICJ1c2VyLiUuKnMiLCBuYW1lbGVu
LXByZWZpeGxlbiwgbmFtZStwcmVmaXhsZW4pOwogIAogIAkvKiBUcmFuc2xhdGUgYW55IHNlcGFy
YXRvcnMgaW4gdXNlcmlkK21haWxib3ggKi8KICAJbWJveG5hbWVfaGllcnNlcF90b2ludGVybmFs
KG5hbWVzcGFjZSwgcmVzdWx0KzUsIDApOwogIAlyZXR1cm4gMDsKLS0tIDYzMCw2ODEgLS0tLQog
IAogICAgICBpZiAoIXN0cm5jbXAobmFtZSwgbmFtZXNwYWNlLT5wcmVmaXhbTkFNRVNQQUNFX1VT
RVJdLCBwcmVmaXhsZW4tMSkgJiYKICAJKG5hbWVsZW4gPT0gcHJlZml4bGVuLTEgfHwgbmFtZVtw
cmVmaXhsZW4tMV0gPT0gbmFtZXNwYWNlLT5oaWVyX3NlcCkpIHsKKyAJY2hhciBtb2RpZmllZF91
c2VybmFtZVtNQVhfTUFJTEJPWF9OQU1FKzFdOworIAljaGFyICppbnRfaWQ9IiI7CisgCXNpemVf
dCBpbnRfaWRfbGVuPTA7CisgCXNpemVfdCBleHRfaWRfbGVuPTA7CiAgCiAgCWlmIChuYW1lbGVu
ID09IHByZWZpeGxlbi0xKSB7CiAgCSAgICAvKiBjYW4ndCBjcmVhdGUgZm9sZGVycyB1c2luZyB1
bmRlbGltaXRlZCBwcmVmaXggKi8KICAJICAgIHJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsK
ICAJfQogIAohIAlpZighaW1hcGRfY29udmVydHVzZXJpZCkgewohIAkgICAgaWYgKGRvbWFpbmxl
bituYW1lbGVuLXByZWZpeGxlbis1ID4gTUFYX01BSUxCT1hfTkFNRSkKISAJCXJldHVybiBJTUFQ
X01BSUxCT1hfQkFETkFNRTsKISAJICAgIG5hbWUrPXByZWZpeGxlbjsKICAJfQorIAllbHNlIHsK
KyAJICAgIGNoYXIgKnNlcDsKICAKISAJICAgIG5hbWUrPXByZWZpeGxlbjsKISAJICAgIHNlcD1z
dHJjaHIobmFtZSxuYW1lc3BhY2UtPmhpZXJfc2VwKTsKISAJICAgIGlmKCFzZXAgfHwgc2VwLW5h
bWUgPj0gbmFtZWxlbi1wcmVmaXhsZW4pCiEgCQlleHRfaWRfbGVuID0gbmFtZWxlbi1wcmVmaXhs
ZW47CiEgCSAgICBlbHNlCiEgCQlleHRfaWRfbGVuID0gc2VwLW5hbWU7CiAgCisgCSAgICBpZigh
ZXh0X2lkX2xlbikKKyAJCXJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsKKyAJICAgIAorIAkg
ICAgLyogd2UgbXVzdCB0cmFuc2Zvcm0gaGllcmFyY2h5IHNlcGFyYXRvcnMgaW4gdGhlIF91c2Vy
X2lkXworIAkgICAgICAgaW50byBpbnRlcm5hbCByZXByZXNlbnRhdGlvbnMgYmVmb3JlIHF1ZXJ5
aW5nIHRoZQorIAkgICAgICAgaW50ZXJuYWwgdXNlciBpZCBiZWNhdXNlIHRoZSByZXZlcnQgdHJh
bnNmb3JtYXRpb24KKyAJICAgICAgIHdvcmtzIHdpdGggdXNlcm5hbWVzIG9ubHkgYW5kIGtub3dz
IG5vdGhpbmcgYWJvdXQKKyAJICAgICAgIHNlcGFyYXRvcnMgLS0gc29yY2VyZXIgKi8KKyAJICAg
IG1lbWNweShtb2RpZmllZF91c2VybmFtZSwgbmFtZSwgZXh0X2lkX2xlbik7CisgCSAgICBtYm94
bmFtZV9oaWVyc2VwX3RvaW50ZXJuYWwobmFtZXNwYWNlLCBtb2RpZmllZF91c2VybmFtZSxleHRf
aWRfbGVuKTsKKyAKKyAJICAgIGludF9pZCA9IG1ib3huYW1lX2dldF9pbnRlcm5hbF9pZChtb2Rp
ZmllZF91c2VybmFtZSwgZXh0X2lkX2xlbiwgZG9tYWluLCAmaW50X2lkX2xlbik7CisgCSAgICBp
ZighaW50X2lkKQorIAkJcmV0dXJuIElNQVBfTUFJTEJPWF9OT05FWElTVEVOVDsKKyAJICAgIGlm
KGRvbWFpbmxlbituYW1lbGVuLXByZWZpeGxlbis1LWV4dF9pZF9sZW4raW50X2lkX2xlbiA+IE1B
WF9NQUlMQk9YX05BTUUpCisgCQlyZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7CisgCSAgICBu
YW1lKz1leHRfaWRfbGVuOworIAl9CisgCisgCXNwcmludGYocmVzdWx0LCAidXNlci4lLipzJS4q
cyIsIGludF9pZF9sZW4sIGludF9pZCwgbmFtZWxlbi1wcmVmaXhsZW4tZXh0X2lkX2xlbiwgbmFt
ZSk7CisgCQogIAkvKiBUcmFuc2xhdGUgYW55IHNlcGFyYXRvcnMgaW4gdXNlcmlkK21haWxib3gg
Ki8KICAJbWJveG5hbWVfaGllcnNlcF90b2ludGVybmFsKG5hbWVzcGFjZSwgcmVzdWx0KzUsIDAp
OwogIAlyZXR1cm4gMDsKKioqKioqKioqKioqKioqCioqKiAzOTksNDA1ICoqKioKICBzdGF0aWMg
aW50IG1ib3huYW1lX3RvZXh0ZXJuYWxfYWx0KHN0cnVjdCBuYW1lc3BhY2UgKm5hbWVzcGFjZSwg
Y29uc3QgY2hhciAqbmFtZSwKICAJCQkJICBjb25zdCBjaGFyICp1c2VyaWQsIGNoYXIgKnJlc3Vs
dCkKICB7CiEgICAgIGNoYXIgKmRvbWFpbjsKICAgICAgc2l6ZV90IHVzZXJsZW4sIHJlc3VsdGxl
bjsKICAKICAgICAgLyogQmxhbmsgdGhlIHJlc3VsdCwganVzdCBpbiBjYXNlICovCi0tLSA3NzMs
Nzc5IC0tLS0KICBzdGF0aWMgaW50IG1ib3huYW1lX3RvZXh0ZXJuYWxfYWx0KHN0cnVjdCBuYW1l
c3BhY2UgKm5hbWVzcGFjZSwgY29uc3QgY2hhciAqbmFtZSwKICAJCQkJICBjb25zdCBjaGFyICp1
c2VyaWQsIGNoYXIgKnJlc3VsdCkKICB7CiEgICAgIGNoYXIgKmRvbWFpbj1OVUxMOwogICAgICBz
aXplX3QgdXNlcmxlbiwgcmVzdWx0bGVuOwogIAogICAgICAvKiBCbGFuayB0aGUgcmVzdWx0LCBq
dXN0IGluIGNhc2UgKi8KKioqKioqKioqKioqKioqCioqKiA0MTUsNDI3ICoqKioKICAJc2l6ZV90
IGRvbWFpbmxlbiA9IHN0cmxlbihkb21haW4pOwogIAogIAl1c2VybGVuID0gZG9tYWluIC0gdXNl
cmlkOwogIAohIAlpZiAoIXN0cm5jbXAobmFtZSwgZG9tYWluKzEsIGRvbWFpbmxlbi0xKSAmJgoh
IAkgICAgbmFtZVtkb21haW5sZW4tMV0gPT0gJyEnKSB7CiEgCSAgICBuYW1lICs9IGRvbWFpbmxl
bjsKICAJfQogICAgICB9CiAgCiAgICAgIC8qIFBlcnNvbmFsIChJTkJPWCkgbmFtZXNwYWNlICov
CiAgICAgIGlmICghc3RybmNhc2VjbXAobmFtZSwgImluYm94IiwgNSkgJiYKICAJKG5hbWVbNV0g
PT0gJ1wwJyB8fCBuYW1lWzVdID09ICcuJykpIHsKLS0tIDc4OSw4MDcgLS0tLQogIAlzaXplX3Qg
ZG9tYWlubGVuID0gc3RybGVuKGRvbWFpbik7CiAgCiAgCXVzZXJsZW4gPSBkb21haW4gLSB1c2Vy
aWQ7CisgCWRvbWFpbisrOworIAlkb21haW5sZW4tLTsKICAKISAJaWYgKCFzdHJuY21wKG5hbWUs
IGRvbWFpbiwgZG9tYWlubGVuKSAmJgohIAkgICAgbmFtZVtkb21haW5sZW5dID09ICchJykgewoh
IAkgICAgbmFtZSArPSBkb21haW5sZW4rMTsKICAJfQogICAgICB9CiAgCisgICAgIC8qIHNldCB0
aGUgZW1wdHkgZG9tYWluIGlmIGl0IGRvZXNuJ3QgZXhpc3RzICovCisgICAgIGlmKCFkb21haW4p
CisgCWRvbWFpbj0iIjsKKyAKICAgICAgLyogUGVyc29uYWwgKElOQk9YKSBuYW1lc3BhY2UgKi8K
ICAgICAgaWYgKCFzdHJuY2FzZWNtcChuYW1lLCAiaW5ib3giLCA1KSAmJgogIAkobmFtZVs1XSA9
PSAnXDAnIHx8IG5hbWVbNV0gPT0gJy4nKSkgewoqKioqKioqKioqKioqKioKKioqIDQ0NSw0NjIg
KioqKgogICAgICBlbHNlIGlmICghc3RybmNtcChuYW1lLCAidXNlciIsIDQpICYmCiAgCSAgICAg
KG5hbWVbNF0gPT0gJ1wwJyB8fCBuYW1lWzRdID09ICcuJykpIHsKICAJc2l6ZV90IHByZWZpeGxl
biA9IHN0cmxlbihuYW1lc3BhY2UtPnByZWZpeFtOQU1FU1BBQ0VfVVNFUl0pOwogIAohIAlpZiAo
KHByZWZpeGxlbiA+IE1BWF9NQUlMQk9YX05BTUUpIHx8IAohIAkgICAgKChuYW1lWzRdID09ICcu
JykgJiYgCiEgCSAgICAgKChwcmVmaXhsZW4rMStzdHJsZW4obmFtZSs1KSkgPiBNQVhfTUFJTEJP
WF9OQU1FKSkpCiAgCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7CiAgCiAgCXNwcmlu
dGYocmVzdWx0LCAiJS4qcyIsCiAgCQlwcmVmaXhsZW4tMSwgbmFtZXNwYWNlLT5wcmVmaXhbTkFN
RVNQQUNFX1VTRVJdKTsKICAJcmVzdWx0bGVuID0gc3RybGVuKHJlc3VsdCk7CiEgCWlmIChuYW1l
WzRdID09ICcuJykgewohIAkgICAgc3ByaW50ZihyZXN1bHQrcmVzdWx0bGVuLCAiJWMlcyIsIG5h
bWVzcGFjZS0+aGllcl9zZXAsIG5hbWUrNSk7CiEgCX0KICAgICAgfQogIAogICAgICAvKiBTaGFy
ZWQgbmFtZXNwYWNlICovCi0tLSA4MjUsODc2IC0tLS0KICAgICAgZWxzZSBpZiAoIXN0cm5jbXAo
bmFtZSwgInVzZXIiLCA0KSAmJgogIAkgICAgIChuYW1lWzRdID09ICdcMCcgfHwgbmFtZVs0XSA9
PSAnLicpKSB7CiAgCXNpemVfdCBwcmVmaXhsZW4gPSBzdHJsZW4obmFtZXNwYWNlLT5wcmVmaXhb
TkFNRVNQQUNFX1VTRVJdKTsKKyAJY2hhciAqZXh0X2lkPSIiOworIAlzaXplX3QgZXh0X2lkX2xl
bj0wOwogIAohIAlpZiAocHJlZml4bGVuID4gTUFYX01BSUxCT1hfTkFNRSkKICAJICAgIHJldHVy
biBJTUFQX01BSUxCT1hfQkFETkFNRTsKKyAJCisgCWlmKG5hbWVbNF0gPT0gJy4nKSB7CisgCSAg
ICBpZighaW1hcGRfY29udmVydHVzZXJpZCkgeworIAkJaWYoKHByZWZpeGxlbisxK3N0cmxlbihu
YW1lKzUpKSA+IE1BWF9NQUlMQk9YX05BTUUpCisgCQkgICAgcmV0dXJuIElNQVBfTUFJTEJPWF9C
QUROQU1FOworIAkJbmFtZSs9NTsKKyAJICAgIH0KKyAJICAgIC8qIGZldGNoaW5nIHRoZSB1c2Vy
J3MgaWRlbnRpZmllciAvLyBzb3JjZXJlciAqLworIAkgICAgZWxzZSB7CisgCQljaGFyICpzZXA7
CisgCQlzaXplX3QgaW50X2lkX2xlbjsKKyAKKyAJCW5hbWUrPTU7CisgCQlzZXA9c3RyY2hyKG5h
bWUsJy4nKTsKKyAJCWlmKHNlcCkKKyAJCSAgICBpbnRfaWRfbGVuPXNlcC1uYW1lOworIAkJZWxz
ZQorIAkJICAgIGludF9pZF9sZW49c3RybGVuKG5hbWUpOworIAorIAkJaWYoIWludF9pZF9sZW4p
CisgCQkgICAgcmV0dXJuIElNQVBfTUFJTEJPWF9CQUROQU1FOworIAorIAkJLyogd2UgYXNzdW1l
IHRoYXQgdGhlIHVzZXIgZG9tYWluIGlzIHNhbWUgYXMgdGhlIG5hbWUncworIAkJICAgZG9tYWlu
ICovCisgCQlleHRfaWQgPSBtYm94bmFtZV9nZXRfZXh0ZXJuYWxfaWQobmFtZSwgaW50X2lkX2xl
biwgZG9tYWluLCAmZXh0X2lkX2xlbik7CisgCQlpZighZXh0X2lkKQorIAkJICAgIHJldHVybiBJ
TUFQX01BSUxCT1hfTk9ORVhJU1RFTlQ7CisgCQlpZihwcmVmaXhsZW4gKyBleHRfaWRfbGVuICsg
c3RybGVuKG5hbWUraW50X2lkX2xlbikgPiBNQVhfTUFJTEJPWF9OQU1FKQorIAkJICAgIHJldHVy
biBJTUFQX01BSUxCT1hfQkFETkFNRTsKKyAJCW5hbWUrPWludF9pZF9sZW47CisgCSAgICB9Cisg
CX0KICAKICAJc3ByaW50ZihyZXN1bHQsICIlLipzIiwKICAJCXByZWZpeGxlbi0xLCBuYW1lc3Bh
Y2UtPnByZWZpeFtOQU1FU1BBQ0VfVVNFUl0pOwogIAlyZXN1bHRsZW4gPSBzdHJsZW4ocmVzdWx0
KTsKISAKISAJLyogaW4gdGhlIGNhc2UgaWYgZmV0Y2hpbmcgaWQgaXNuJ3QgZW5hYmxlZCwgZXh0
X2lkIHZhcmlhYmxlCiEgCSAgIHdpbGwgYmUgZW1wdHkgYW5kIG5hbWUgdmFyaWFibGUgd2lsbCBj
b25zaXN0IG9mIHRoZSBmdWxsCiEgCSAgIG1haWxib3ggbmFtZSB3aXRob3V0IG5hbWVzcGFjZS0+
cHJlZml4W05BTUVTUEFDRV9VU0VSXSAqLwohIAlzcHJpbnRmKHJlc3VsdCtyZXN1bHRsZW4sICIl
YyUuKnMlcyIsIG5hbWVzcGFjZS0+aGllcl9zZXAsIGV4dF9pZF9sZW4sIGV4dF9pZCwgbmFtZSk7
CiAgICAgIH0KICAKICAgICAgLyogU2hhcmVkIG5hbWVzcGFjZSAqLwpkaWZmIC1OIC1DIDMgLXIg
Y3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL21ib3huYW1lLmggY3lydXMtaW1hcGQtMi4yLjEy
L2ltYXAvbWJveG5hbWUuaAoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL21ib3huYW1l
LmgJMjAwNS0xMS0wNyAxODoyNDo0NCArMDMwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAv
bWJveG5hbWUuaAkyMDA1LTExLTExIDE3OjU4OjM5ICswMzAwCioqKioqKioqKioqKioqKgoqKiog
NzgsODMgKioqKgotLS0gNzgsOTEgLS0tLQogIAkJCSAgICB2b2lkICpyb2NrLCBpbnQgZm9yY2Up
OwogIH07CiAgCisgI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorIC8qIGNvbnZlcnQgdXNl
cmlkIGluaXRpYWxpemF0aW9uIGFuZCBjbGVhbnVwICovCisgaW50IGNvbnZlcnR1c2VyaWRfaW5p
dCgpOworIGludCBjb252ZXJ0dXNlcmlkX2NsZWFudXAoKTsKKyAvKiBkZXN0cm95IGFkZGl0aW9u
YWwgaW5mb3JtYXRpb24gd2hpY2ggaXMgbmVlZGVkIHRvIHRyYW5zZm9ybSB1c2VyaWRzICovCisg
dm9pZCBtYm94bmFtZV9jbGVhbnVwKCk7CisgI2VuZGlmIC8qIEVOQUJMRV9DT05WRVJUX1VTRVJJ
RCAqLworIAogIC8qIGNyZWF0ZSBuYW1lc3BhY2UgYmFzZWQgb24gZ2l2ZW4gb3B0aW9ucyAqLwog
IGludCBtYm94bmFtZV9pbml0X25hbWVzcGFjZV9leHQoc3RydWN0IG5hbWVzcGFjZSAqbmFtZXNw
YWNlLCBpbnQgaXNhZG1pbiwgY2hhciBoaWVyX3NlcCwgaW50IGlzYWx0KTsKICAvKiBDcmVhdGUg
bmFtZXNwYWNlIGJhc2VkIG9uIGNvbmZpZyBvcHRpb25zLiAqLwpkaWZmIC1OIC1DIDMgLXIgY3ly
dXMtaW1hcGQtMi4yLjEyLm9sZC9saWIvaGFzaC5jIGN5cnVzLWltYXBkLTIuMi4xMi9saWIvaGFz
aC5jCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2xpYi9oYXNoLmMJMjAwNC0wNS0yNCAxODoz
MjozNCArMDQwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9oYXNoLmMJMjAwNS0xMS0xMSAx
Nzo1ODozOSArMDMwMAoqKioqKioqKioqKioqKioKKioqIDMxNywzMjIgKioqKgotLS0gMzE3LDM1
NSAtLS0tCiAgICAgICAgfQogIH0KICAKKyAvKiBTYW1lIGFzIGhhc2hfZW51bWVyYXRlKCkgYnV0
IGhhcyBhYmlsaXR5IHRvIGRlbGV0ZSBrZXlzIHdoaWxlIGdvaW5nCisgICAgdGhyb3VnaCBhIGhh
c2ggdGFibGUuIFJldHVybiBub24temVybyB2YWx1ZSBmcm9tIHRoZSBjYWxsYmFjaworICAgIGZ1
bmN0aW9uIGlmIHlvdSB3YW50IHRvIGRlbGV0ZSBhIGtleS4gRGVsZXRlIGFueSBleHRlcm5hbCBk
YXRhCisgICAgeW91cnNlbGYuICovCisgdm9pZCBoYXNoX3dhbGsoaGFzaF90YWJsZSAqdGFibGUs
IGludCAoKmZ1bmMpKGNoYXIgKiwgdm9pZCAqLCB2b2lkICopLAorIAkJICAgIHZvaWQgKnJvY2sp
CisgeworICAgICB1bnNpZ25lZCBpOworICAgICBidWNrZXQgKnRlbXAsICp0ZW1wX29sZCwgKnRl
bXBfbmV4dDsKKyAKKyAgICAgZm9yIChpPTA7aTx0YWJsZS0+c2l6ZTsgaSsrKSB7CisgCWlmICgo
dGFibGUtPnRhYmxlKVtpXSAhPSBOVUxMKSB7CisgCSAgICBmb3IgKHRlbXAgPSAodGFibGUtPnRh
YmxlKVtpXSwgdGVtcF9vbGQ9TlVMTDsKKyAJCSBOVUxMICE9IHRlbXA7CisgCQkgdGVtcCA9IHRl
bXBfbmV4dCkgeworIAorIAkJdGVtcF9uZXh0ID0gdGVtcC0+bmV4dDsKKyAJCWlmKGZ1bmModGVt
cCAtPiBrZXksIHRlbXAtPmRhdGEsIHJvY2spKSB7CisgCQkgICAgaWYodGVtcF9vbGQpCisgCQkJ
dGVtcF9vbGQtPm5leHQgPSB0ZW1wX25leHQ7CisgCQkgICAgZWxzZQorIAkJCSh0YWJsZS0+dGFi
bGUpW2ldID0gdGVtcF9uZXh0OworIAkJICAgIGlmKCF0YWJsZS0+cG9vbCkgeworIAkJCWZyZWUo
dGVtcC0+a2V5KTsKKyAJCQlmcmVlKHRlbXApOworIAkJICAgIH0KKyAJCX0KKyAJCWVsc2UKKyAJ
CSAgICB0ZW1wX29sZD10ZW1wOworIAkgICAgfQorIAl9CisgICAgIH0KKyB9CiAgCiAgI2lmZGVm
IFRFU1QKICAKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbGliL2hhc2gu
aCBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2hhc2guaAoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9s
ZC9saWIvaGFzaC5oCTIwMDMtMTAtMjIgMjI6NTA6MTIgKzA0MDAKLS0tIGN5cnVzLWltYXBkLTIu
Mi4xMi9saWIvaGFzaC5oCTIwMDUtMTEtMTEgMTc6NTg6MzkgKzAzMDAKKioqKioqKioqKioqKioq
CioqKiA3OCw4MyAqKioqCi0tLSA3OCw5MCAtLS0tCiAgdm9pZCBoYXNoX2VudW1lcmF0ZShoYXNo
X3RhYmxlICp0YWJsZSx2b2lkICgqZnVuYykoY2hhciAqLHZvaWQgKix2b2lkICopLAogIAkJICAg
IHZvaWQgKnJvY2spOwogIAorIC8qIFNhbWUgYXMgaGFzaF9lbnVtZXJhdGUoKSBidXQgaGFzIGFi
aWxpdHkgdG8gZGVsZXRlIGtleXMgd2hpbGUgZ29pbmcKKyAgICB0aHJvdWdoIGEgaGFzaCB0YWJs
ZS4gUmV0dXJuIG5vbi16ZXJvIHZhbHVlIGZyb20gdGhlIGNhbGxiYWNrCisgICAgZnVuY3Rpb24g
aWYgeW91IHdhbnQgdG8gZGVsZXRlIGEga2V5LiBEZWxldGUgYW55IGV4dGVybmFsIGRhdGEKKyAg
ICB5b3Vyc2VsZi4gKi8KKyB2b2lkIGhhc2hfd2FsayhoYXNoX3RhYmxlICp0YWJsZSwgaW50ICgq
ZnVuYykoY2hhciAqLCB2b2lkICosIHZvaWQgKiksCisgCSAgICAgICB2b2lkICpyb2NrKTsKKyAK
ICAvKgogICoqIEZyZWVzIGEgaGFzaCB0YWJsZS4gIEZvciBlYWNoIG5vZGUgdGhhdCB3YXMgaW5z
ZXJ0ZWQgaW4gdGhlIHRhYmxlLAogICoqIGl0IGNhbGxzIHRoZSBmdW5jdGlvbiB3aG9zZSBhZGRy
ZXNzIGl0IHdhcyBwYXNzZWQsIHdpdGggYSBwb2ludGVyCmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1p
bWFwZC0yLjIuMTIub2xkL2xpYi9pbWFwb3B0aW9ucyBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2lt
YXBvcHRpb25zCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2xpYi9pbWFwb3B0aW9ucwkyMDA1
LTExLTA3IDE4OjA1OjM2ICswMzAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2ltYXBvcHRp
b25zCTIwMDUtMTEtMTQgMTM6NTA6MTYgKzAzMDAKKioqKioqKioqKioqKioqCioqKiA5MTAsOTE1
ICoqKioKLS0tIDkxMCw5NTYgLS0tLQogICAgIGludGVyZmFjZSwgb3RoZXJ3aXNlIHRoZSB1c2Vy
IGlzIGFzc3VtZWQgdG8gYmUgaW4gdGhlIGRlZmF1bHQKICAgICBkb21haW4gKGlmIHNldCkuICov
CiAgCisgeyAiY29udmVydHVzZXJpZCIsIDAsIFNXSVRDSCB9CisgLyogRW5hYmxlIHVzZXIgaWRl
bnRpZmllcnMgY29udmVyc2lvbiB2aWEgTERBUC4gVGhpcyBpcyBhIGRlZmF1bHQKKyAgICBydWxl
OiBpdCBpcyBwb3NzaWJsZSB0byBzZXQgZXhlbXB0aW9ucyBvbiBzb21lIHNldCBvZiB1c2VycyB2
aWEKKyAgICBjb252ZXJ0dXNlcmlkX2V4ZW1wdHMgY29uZmlnIHZhcmlhYmxlLiBJZiB1c2VyJ3Mg
cnVsZSBpcyAnY29udmVydCcKKyAgICB0aGVuIGhlIGRvZXNuJ3Qgc2VlIHVzZXIgaWRlbnRpZmll
cnMgdmlhIElNQVAgY29tbWFuZHMuIEluc3RlYWQsCisgICAgbmFtZXMgZ290IGZyb20gTERBUCBh
cmUgc2hvd2VkLiBOb3RlIHRoYXQgaWYgYW4gdXNlcmlkIGRvZXNuJ3QKKyAgICBleGlzdCBpbiBM
REFQIHRoZW4gYW55IHVzZXIgd2hvc2UgcnVsZSBpcyAnY29udmVydCcgY2FuJ3Qgc2VlCisgICAg
Zm9sZGVycyBvZiB0aGF0IHVzZXIuIFRoZSAnY29udmVydCcgcnVsZSBpcyBlbmFibGVkIGlmIHVz
ZXIgdXNlcworICAgIGFsdG5hbWVzcGFjZSBvcHRpb24uICovCisgCisgeyAiY29udmVydHVzZXJp
ZF9leGVtcHRzIiwgTlVMTCwgU1RSSU5HIH0KKyAvKiBFeGVtdGlvbnMgKGxpc3Qgb2YgdXNlciBp
ZGVudGlmaWVycykgZnJvbSBjb252ZXJ0dXNlcmlkIG9wdGlvbi4gKi8KKyAKKyB7ICJjb252ZXJ0
dXNlcmlkX3VkcHBvcnQiLCAwLCBJTlQgfQorIC8qIFVEUCBwb3J0IG51bWJlciB3aGVyZSBsZGFw
ZCBwcm9jZXNzZXMgaXMgbGlzdGVuaW5nIG9uLiBsZGFwZCBpcyBhCisgICAgcHJvY2VzcyB3aGlj
aCBwZXJmb21zIHF1ZXJpZXMgdG8gTERBUC4gKi8KKyAKKyB7ICJjb252ZXJ0dXNlcmlkX25fbGlz
dGVuZXJzIiwgMCwgSU5UIH0KKyAvKiBOdW1iZXIgb2YgbGRhcGQgcHJvY2Vzc2VzLiAqLworIAor
IHsgImNvbnZlcnR1c2VyaWRfbGRhcF9ob3N0IiwgTlVMTCwgU1RSSU5HIH0KKyAvKiBMREFQIHNl
cnZlciBob3N0IHVzZWQgYnkgbGRhcGQuICovCisgCisgeyAiY29udmVydHVzZXJpZF9sZGFwX3Bv
cnQiLCAzODksIElOVCB9CisgLyogTERBUCBzZXJ2ZXIgcG9ydCB1c2VkIGJ5IGxkYXBkLiAqLwor
IAorIHsgImNvbnZlcnR1c2VyaWRfbGRhcF91c2VyIiwgTlVMTCwgU1RSSU5HIH0KKyAvKiBMREFQ
IHVzZXIgdXNlZCBieSBsZGFwZC4gKi8KKyAKKyB7ICJjb252ZXJ0dXNlcmlkX2xkYXBfcGFzc3dv
cmQiLCBOVUxMLCBTVFJJTkcgfQorIC8qIExEQVAgdXNlcidzIHBhc3N3b3JkIHVzZWQgYnkgbGRh
cGQuICovCisgCisgeyAiY29udmVydHVzZXJpZF9sZGFwX2Jhc2UiLCBOVUxMLCBTVFJJTkcgfQor
IC8qIExEQVAgYmFzZSB1c2VkIGJ5IGxkYXBkLiAqLworIAorIHsgImNvbnZlcnR1c2VyaWRfbGRh
cF9hdHRyX2ludCIsICJ1aWQiLCBTVFJJTkcgfQorIC8qIE5hbWUgb2YgTERBUCBhdHRyaWJ1dGUg
c3RvcmluZyBpbnRlcm5hbCBuYW1lcyBvZiB1c2Vycy4gKi8KKyAKKyB7ICJjb252ZXJ0dXNlcmlk
X2xkYXBfYXR0cl9leHQiLCAic24iLCBTVFJJTkcgfQorIC8qIE5hbWUgb2YgTERBUCBhdHRyaWJ1
dGUgc3RvcmluZyBleHRlcm5hbCBuYW1lcyBvZiB1c2Vycy4gKi8KKyAKICAvKgogIC5TSCBTRUUg
QUxTTwogIC5QUApkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9saWIvbGli
Y29uZmlnLmMgY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9saWJjb25maWcuYwoqKiogY3lydXMtaW1h
cGQtMi4yLjEyLm9sZC9saWIvbGliY29uZmlnLmMJMjAwNC0wNS0yMiAwNzo0NTo1NCArMDQwMAot
LS0gY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9saWJjb25maWcuYwkyMDA1LTExLTExIDE3OjU4OjM5
ICswMzAwCioqKioqKioqKioqKioqKgoqKiogMTYxLDE2NyAqKioqCiAgICAgIGlmKGFsdF9jb25m
aWcpIGNvbmZpZ19maWxlbmFtZSA9IHhzdHJkdXAoYWx0X2NvbmZpZyk7CiAgICAgIGVsc2UgY29u
ZmlnX2ZpbGVuYW1lID0geHN0cmR1cChDT05GSUdfRklMRU5BTUUpOwogIAohICAgICBpZighY29u
c3RydWN0X2hhc2hfdGFibGUoJmNvbmZpZ2hhc2gsIENPTkZJR0hBU0hTSVpFLCAxKSkgewogIAlm
YXRhbCgiY291bGQgbm90IGNvbnN0cnVjdCBjb25maWd1cmF0aW9uIGhhc2ggdGFibGUiLCBFQ19D
T05GSUcpOwogICAgICB9CiAgCi0tLSAxNjEsMTcwIC0tLS0KICAgICAgaWYoYWx0X2NvbmZpZykg
Y29uZmlnX2ZpbGVuYW1lID0geHN0cmR1cChhbHRfY29uZmlnKTsKICAgICAgZWxzZSBjb25maWdf
ZmlsZW5hbWUgPSB4c3RyZHVwKENPTkZJR19GSUxFTkFNRSk7CiAgCiEgICAgIC8qIHdlIGRvbid0
IHVzZSBtZW1vcnkgcG9vbCBmb3IgdGhpcyBoYXNoIGJlY2F1c2Ugd2UgbWF5IGRlbGV0ZQohICAg
ICAgICBrZXlzIGZyb20gaXQgbWFueSB0aW1lcyAoZGVsZXRpb25zIGZyb20gcG9vbGVkIGhhc2gg
bGVhayB0aGUKISAgICAgICAgbWVtb3J5KSAqLwohICAgICBpZighY29uc3RydWN0X2hhc2hfdGFi
bGUoJmNvbmZpZ2hhc2gsIENPTkZJR0hBU0hTSVpFLCAwKSkgewogIAlmYXRhbCgiY291bGQgbm90
IGNvbnN0cnVjdCBjb25maWd1cmF0aW9uIGhhc2ggdGFibGUiLCBFQ19DT05GSUcpOwogICAgICB9
CiAgCioqKioqKioqKioqKioqKgoqKiogNTA4LDUxMCAqKioqCi0tLSA1MTEsOTE5IC0tLS0KICAg
ICAgfQogICAgICBmY2xvc2UoaW5maWxlKTsKICB9CisgCisgaW50IGNvbmZpZ190ZW1wbGF0ZV9j
b21wYXJlKGNvbnN0IGNoYXIgKm9wdG5hbWUsIGludCBvcHRpZCwgdGVtcGxhdGVfb3B0aW9uICpv
cHRzLCBpbnQgb3B0c19sZW4pCisgeworICAgICBpbnQgaTsKKyAKKyAgICAgZm9yKGk9MDsgaTxv
cHRzX2xlbjsgaSsrKSB7CisgCXN3aXRjaChvcHRzW2ldLnR5cGUpIHsKKyAJY2FzZSBURU1QTEFU
RU9QVF9UWVBFX0tOT1dOT1BUOgorIAkgICAgaWYob3B0aWQ9PShpbnQpb3B0c1tpXS52YWwpCisg
CQlyZXR1cm4gMDsKKyAJICAgIGJyZWFrOworIAljYXNlIFRFTVBMQVRFT1BUX1RZUEVfRVhBQ1RN
QVRDSDoKKyAJICAgIGlmKCFzdHJjbXAoKGNoYXIgKilvcHRzW2ldLnZhbCwgb3B0bmFtZSkpCisg
CQlyZXR1cm4gMDsKKyAJICAgIGJyZWFrOworIAljYXNlIFRFTVBMQVRFT1BUX1RZUEVfUFJFRklY
OgorIAkgICAgaWYoIXN0cm5jbXAoKGNoYXIgKilvcHRzW2ldLnZhbCwgb3B0bmFtZSwgc3RybGVu
KChjaGFyICopb3B0c1tpXS52YWwpKSkKKyAJCXJldHVybiAwOworIAkgICAgYnJlYWs7CisgCX0K
KyAgICAgfQorICAgICByZXR1cm4gMTsKKyB9CisgCisgc3RhdGljIGludCBjb25maWdfcmVyZWFk
X2ZpbGUoY29uc3QgY2hhciAqZmlsZW5hbWUsIHRlbXBsYXRlX29wdGlvbiAqb3B0cywgaW50IG9w
dHNfbGVuKQorIHsKKyAgICAgZW51bSBvcHR0eXBlIG9wdCA9IElNQVBPUFRfWkVSTzsKKyAgICAg
aW50IGxpbmVubyA9IDA7CisgICAgIGNoYXIgYnVmWzQwOTZdLCBlcnJidWZbMTAyNF07CisgICAg
IGNoYXIgKnAsICpxLCAqa2V5LCAqZnVsbGtleSwgKnNydmtleSwgKnZhbCwgKm5ld3ZhbDsKKyAg
ICAgaW50IHNlcnZpY2Vfc3BlY2lmaWM7CisgICAgIGludCBpZGxlbiA9IChjb25maWdfaWRlbnQg
PyBzdHJsZW4oY29uZmlnX2lkZW50KSA6IDApOworICAgICBGSUxFICppbmZpbGU7CisgCisgICAg
IGlmKCFvcHRzX2xlbikKKyAJcmV0dXJuIDA7CisgCisgICAgIC8qIHJlYWQgaW4gY29uZmlnIGZp
bGUgKi8KKyAgICAgaW5maWxlID0gZm9wZW4oZmlsZW5hbWUsICJyIik7CisgICAgIGlmICghaW5m
aWxlKSB7CisgCXN0cmxjcHkoYnVmLCBDWVJVU19QQVRILCBzaXplb2YoYnVmKSk7CisgCXN0cmxj
YXQoYnVmLCBmaWxlbmFtZSwgc2l6ZW9mKGJ1ZikpOworIAlpbmZpbGUgPSBmb3BlbihidWYsICJy
Iik7CisgICAgIH0KKyAgICAgaWYgKCFpbmZpbGUpIHsKKyAJc3lzbG9nKExPR19FUlIsICJjYW4n
dCBvcGVuIGNvbmZpZ3VyYXRpb24gZmlsZSAlczogJXMiLGZpbGVuYW1lLCBlcnJvcl9tZXNzYWdl
KGVycm5vKSk7CisgCXJldHVybiAtMTsKKyAgICAgfQorIAorICAgICAvKiBjaGVjayB0byBzZWUg
aWYgd2UndmUgYWxyZWFkeSByZWFkIHRoaXMgZmlsZSAqLworICAgICBpZiAoaGFzaF9sb29rdXAo
ZmlsZW5hbWUsICZpbmNsdWRlaGFzaCkpIHsKKyAJc3lzbG9nKExPR19FUlIsICJjb25maWd1cmF0
aW9uIGZpbGUgJXMgaW5jbHVkZWQgdHdpY2UiLCBmaWxlbmFtZSk7CisgCWZjbG9zZShpbmZpbGUp
OworIAlyZXR1cm4gLTE7CisgICAgIH0KKyAgICAgZWxzZSB7CisgCWhhc2hfaW5zZXJ0KGZpbGVu
YW1lLCAodm9pZCopIDB4REVBREJFRUYsICZpbmNsdWRlaGFzaCk7CisgICAgIH0KKyAgICAgCisg
ICAgIHdoaWxlIChmZ2V0cyhidWYsIHNpemVvZihidWYpLCBpbmZpbGUpKSB7CisgCWxpbmVubysr
OworIAorIAlzZXJ2aWNlX3NwZWNpZmljID0gMDsKKyAJCisgCWlmIChidWZbMF0gJiYgYnVmW3N0
cmxlbihidWYpLTFdID09ICdcbicpIGJ1ZltzdHJsZW4oYnVmKS0xXSA9ICdcMCc7CisgCWZvciAo
cCA9IGJ1ZjsgKnAgJiYgaXNzcGFjZSgoaW50KSAqcCk7IHArKyk7CisgCWlmICghKnAgfHwgKnAg
PT0gJyMnKSBjb250aW51ZTsKKyAKKyAJZnVsbGtleSA9IGtleSA9IHA7CisgCWlmICgqcCA9PSAn
QCcpIHArKzsgIC8qIGFsbG93IEAgYXMgdGhlIGZpcnN0IGNoYXIgKGZvciBkaXJlY3RpdmVzKSAq
LworIAl3aGlsZSAoKnAgJiYgKGlzYWxudW0oKGludCkgKnApIHx8ICpwID09ICctJyB8fCAqcCA9
PSAnXycpKSB7CisgCSAgICBpZiAoaXN1cHBlcigodW5zaWduZWQgY2hhcikgKnApKSAqcCA9IHRv
bG93ZXIoKHVuc2lnbmVkIGNoYXIpICpwKTsKKyAJICAgIHArKzsKKyAJfQorIAlpZiAoKnAgIT0g
JzonKSB7CisgCSAgICBzeXNsb2coTE9HX0VSUiwKKyAJCSAgICJpbnZhbGlkIG9wdGlvbiBuYW1l
IG9uIGxpbmUgJWQgb2YgY29uZmlndXJhdGlvbiBmaWxlICVzIiwKKyAJCSAgICBsaW5lbm8sIGZp
bGVuYW1lKTsKKyAJICAgIGZjbG9zZShpbmZpbGUpOworIAkgICAgcmV0dXJuIC0xOworIAl9Cisg
CSpwKysgPSAnXDAnOworIAkKKyAJd2hpbGUgKCpwICYmIGlzc3BhY2UoKGludCkgKnApKSBwKys7
CisgCQorIAkvKiByZW1vdmUgdHJhaWxpbmcgd2hpdGVzcGFjZSAqLworIAlmb3IgKHEgPSBwICsg
c3RybGVuKHApIC0gMTsgcSA+IHAgJiYgaXNzcGFjZSgoaW50KSAqcSk7IHEtLSkgeworIAkgICAg
KnEgPSAnXDAnOworIAl9CisgCQorIAlpZiAoISpwKSB7CisgCSAgICBzeXNsb2coTE9HX0VSUiwK
KyAJCSAgICJlbXB0eSBvcHRpb24gdmFsdWUgb24gbGluZSAlZCBvZiBjb25maWd1cmF0aW9uIGZp
bGUiLAorIAkJICAgbGluZW5vKTsKKyAJICAgIGZjbG9zZShpbmZpbGUpOworIAkgICAgcmV0dXJu
IC0xOworIAl9CisgCQorIAlzcnZrZXkgPSBOVUxMOworIAorIAkvKiBMb29rIGZvciBkaXJlY3Rp
dmVzICovCisgCWlmIChrZXlbMF0gPT0gJ0AnKSB7CisgCSAgICBpZiAoIXN0cmNhc2VjbXAoa2V5
LCAiQGluY2x1ZGUiKSkgeworIAkJaWYoY29uZmlnX3JlcmVhZF9maWxlKHAsb3B0cyxvcHRzX2xl
bikpIHsKKyAJCSAgICBmY2xvc2UoaW5maWxlKTsKKyAJCSAgICByZXR1cm4gLTE7CisgCQl9Cisg
CQljb250aW51ZTsKKyAJICAgIH0KKyAJICAgIGVsc2UgeworIAkJc3lzbG9nKExPR19FUlIsCisg
CQkgICAgICAgImludmFsaWQgZGlyZWN0aXZlIG9uIGxpbmUgJWQgb2YgY29uZmlndXJhdGlvbiBm
aWxlICVzIiwKKyAJCSAgICAgICBsaW5lbm8sIGZpbGVuYW1lKTsKKyAJCWZjbG9zZShpbmZpbGUp
OworIAkJcmV0dXJuIC0xOworIAkgICAgfQorIAl9CisgCisgCS8qIEZpbmQgaWYgdGhlcmUgaXMg
YSA8c2VydmljZT5fIHByZWZpeCAqLworIAlpZihjb25maWdfaWRlbnQgJiYgIXN0cm5jYXNlY21w
KGtleSwgY29uZmlnX2lkZW50LCBpZGxlbikgCisgCSAgICYmIGtleVtpZGxlbl0gPT0gJ18nKSB7
CisgCSAgICAvKiBza2lwIHNlcnZpY2VfIHByZWZpeCAqLworIAkgICAgc3J2a2V5ID0ga2V5ICsg
aWRsZW4gKyAxOworIAl9CisgCQorIAkvKiBsb29rIGZvciBhIHNlcnZpY2VfIHByZWZpeCBtYXRj
aCBpbiBpbWFwb3B0cyAqLworIAlpZihzcnZrZXkpIHsKKyAJICAgIGZvciAob3B0ID0gSU1BUE9Q
VF9aRVJPOyBvcHQgPCBJTUFQT1BUX0xBU1Q7IG9wdCsrKSB7CisgCQlpZiAoIXN0cmNhc2VjbXAo
aW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBzcnZrZXkpKSB7CisgCQkgICAga2V5ID0gc3J2a2V5Owor
IAkJICAgIHNlcnZpY2Vfc3BlY2lmaWMgPSAxOworIAkJICAgIGJyZWFrOworIAkJfQorIAkgICAg
fQorIAl9CisgCQorIAkvKiBEaWQgbm90IGZpbmQgYSBzZXJ2aWNlXyBzcGVjaWZpYyBtYXRjaCwg
dHJ5IGxvb2tpbmcgZm9yIGFuCisgCSAqIGV4YWN0IG1hdGNoICovCisgCWlmKCFzZXJ2aWNlX3Nw
ZWNpZmljKSB7CisgCSAgICBmb3IgKG9wdCA9IElNQVBPUFRfWkVSTzsgb3B0IDwgSU1BUE9QVF9M
QVNUOyBvcHQrKykgeworIAkJaWYgKCFzdHJjYXNlY21wKGltYXBvcHRzW29wdF0ub3B0bmFtZSwg
a2V5KSkgeworIAkJICAgIGJyZWFrOworIAkJfQorIAkgICAgfQorIAl9CisgCisgCS8qIElmIGJv
dGggb2YgdGhvc2UgbG9vcHMgZmFpbGVkLCBpdCBnb2VzIHZlcmJhdGltIGludG8gdGhlCisgCSAq
IG92ZXJmbG93IGhhc2ggdGFibGUuICovCisgCQorIAlpZiAob3B0IDwgSU1BUE9QVF9MQVNUKSB7
CisgCSAgICAvKiBza2lwIGFsbCBvcHRpb25zIGV4Y2VwdCB0aG9zZSBtYWNoZWQgdGVtcGxhdGUg
Ki8KKyAJICAgIGlmKGNvbmZpZ190ZW1wbGF0ZV9jb21wYXJlKGltYXBvcHRzW29wdF0ub3B0bmFt
ZSxvcHQsb3B0cyxvcHRzX2xlbikpCisgCQljb250aW51ZTsKKyAKKyAJICAgIC8qIE9rYXksIHdl
IGtub3cgYWJvdXQgdGhpcyBjb25maWd1cmUgb3B0aW9uLgorIAkgICAgICogU28gZmlyc3QgY2hl
Y2sgdGhhdCB3ZSBoYXZlIGVpdGhlcgorIAkgICAgICogIDEuIG5vdCBzZWVuIGl0CisgCSAgICAg
KiAgMi4gc2VlbiBpdHMgZ2VuZXJpYyBmb3JtLCBidXQgdGhpcyBpcyBhIHNlcnZpY2Ugc3BlY2lm
aWMgZm9ybQorIAkgICAgICoKKyAJICAgICAqICBJZiB3ZSBoYXZlIGFscmVhZHkgc2VlbiBhIHNl
cnZpY2Utc3BlY2lmaWMgZm9ybSwgYW5kIHRoaXMgaXMKKyAJICAgICAqICBhIGdlbmVyaWMgZm9y
bSwganVzdCBza2lwIGl0IGFuZCBkb24ndCBtb2FuLgorIAkgICAgICovCisgCSAgICBpZigoaW1h
cG9wdHNbb3B0XS5zZWVuID09IDEgJiYgIXNlcnZpY2Vfc3BlY2lmaWMpIAorIAkgICAgIHx8KGlt
YXBvcHRzW29wdF0uc2VlbiA9PSAyICYmIHNlcnZpY2Vfc3BlY2lmaWMpKSB7CisgCQlzeXNsb2co
TE9HX0VSUiwKKyAJCSAgICAgICAib3B0aW9uICclcycgd2FzIHNwZWNpZmllZCB0d2ljZSBpbiBj
b25maWcgZmlsZSAoc2Vjb25kIG9jY3VyYW5jZSBvbiBsaW5lICVkKSIsCisgCQkgICAgICAgZnVs
bGtleSwgbGluZW5vKTsKKyAJCWZjbG9zZShpbmZpbGUpOworIAkJcmV0dXJuIC0xOworIAkgICAg
fSBlbHNlIGlmKGltYXBvcHRzW29wdF0uc2VlbiA9PSAyICYmICFzZXJ2aWNlX3NwZWNpZmljKSB7
CisgCQljb250aW51ZTsKKyAJICAgIH0KKyAKKyAJICAgIC8qIElmIHdlJ3ZlIHNlZW4gaXQgYWxy
ZWFkeSwgd2UncmUgcmVwbGFjaW5nIGl0LCBzbyB3ZSBuZWVkCisgCSAgICAgKiB0byBmcmVlIHRo
ZSBjdXJyZW50IHN0cmluZyBpZiB0aGVyZSBpcyBvbmUgKi8KKyAJICAgIGlmKGltYXBvcHRzW29w
dF0uc2VlbiAmJiBpbWFwb3B0c1tvcHRdLnQgPT0gT1BUX1NUUklORykKKyAJCWZyZWUoKGNoYXIg
KilpbWFwb3B0c1tvcHRdLnZhbC5zKTsKKyAKKyAgICAgICAgICAgICBpZihzZXJ2aWNlX3NwZWNp
ZmljKQorIAkJaW1hcG9wdHNbb3B0XS5zZWVuID0gMjsKKyAJICAgIGVsc2UKKyAJCWltYXBvcHRz
W29wdF0uc2VlbiA9IDE7CisgCSAgICAKKyAJICAgIC8qIHRoaXMgaXMgYSBrbm93biBvcHRpb24g
Ki8KKyAJICAgIHN3aXRjaCAoaW1hcG9wdHNbb3B0XS50KSB7CisgCSAgICBjYXNlIE9QVF9TVFJJ
Tkc6IAorIAkgICAgewkJICAgIAorIAkJaW1hcG9wdHNbb3B0XS52YWwucyA9IHhzdHJkdXAocCk7
CisgCisgCQlpZihvcHQgPT0gSU1BUE9QVF9DT05GSUdESVJFQ1RPUlkpCisgCQkgICAgY29uZmln
X2RpciA9IGltYXBvcHRzW29wdF0udmFsLnM7CisgCisgCQlicmVhazsKKyAJICAgIH0KKyAJICAg
IGNhc2UgT1BUX0lOVDoKKyAJICAgIHsKKyAJCWxvbmcgdmFsOworIAkJY2hhciAqcHRyOworIAkJ
CisgCQl2YWwgPSBzdHJ0b2wocCwgJnB0ciwgMCk7CisgCQlpZiAoIXB0ciB8fCAqcHRyICE9ICdc
MCcpIHsKKyAJCSAgICAvKiBlcnJvciBkdXJpbmcgY29udmVyc2lvbiAqLworIAkJICAgIHN5c2xv
ZyhMT0dfRVJSLAorIAkJCSAgICJub24taW50ZWdlciB2YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIs
CisgCQkJICAgaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBsaW5lbm8pOworIAkJICAgIGZjbG9zZShp
bmZpbGUpOworIAkJICAgIHJldHVybiAtMTsKKyAJCX0KKyAKKyAJCWltYXBvcHRzW29wdF0udmFs
LmkgPSB2YWw7CisgCQlicmVhazsKKyAJICAgIH0KKyAJICAgIGNhc2UgT1BUX1NXSVRDSDoKKyAJ
ICAgIHsKKyAJCWlmICgqcCA9PSAnMCcgfHwgKnAgPT0gJ24nIHx8CisgCQkgICAgKCpwID09ICdv
JyAmJiBwWzFdID09ICdmJykgfHwgKnAgPT0gJ2YnKSB7CisgCQkgICAgaW1hcG9wdHNbb3B0XS52
YWwuYiA9IDA7CisgCQl9CisgCQllbHNlIGlmICgqcCA9PSAnMScgfHwgKnAgPT0gJ3knIHx8Cisg
CQkJICgqcCA9PSAnbycgJiYgcFsxXSA9PSAnbicpIHx8ICpwID09ICd0JykgeworIAkJICAgIGlt
YXBvcHRzW29wdF0udmFsLmIgPSAxOworIAkJfQorIAkJZWxzZSB7CisgCQkgICAgLyogZXJyb3Ig
ZHVyaW5nIGNvbnZlcnNpb24gKi8KKyAJCSAgICBzeXNsb2coTE9HX0VSUiwKKyAJCQkgICAibm9u
LXN3aXRjaCB2YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIsCisgCQkJICAgaW1hcG9wdHNbb3B0XS5v
cHRuYW1lLCBsaW5lbm8pOworIAkJICAgIGZjbG9zZShpbmZpbGUpOworIAkJICAgIHJldHVybiAt
MTsKKyAJCX0KKyAJCWJyZWFrOworIAkgICAgfQorIAkgICAgY2FzZSBPUFRfRU5VTToKKyAJICAg
IGNhc2UgT1BUX1NUUklOR0xJU1Q6CisgCSAgICB7CisgCQljb25zdCBzdHJ1Y3QgZW51bV9vcHRp
b25fcyAqZSA9IGltYXBvcHRzW29wdF0uZW51bV9vcHRpb25zOworIAorIAkJaWYgKGltYXBvcHRz
W29wdF0udCA9PSBPUFRfRU5VTSkgeworIAkJICAgIC8qIG5vcm1hbGl6ZSBvbi9vZmYgdmFsdWVz
ICovCisgCQkgICAgaWYgKCFzdHJjbXAocCwgIjEiKSB8fCAhc3RyY21wKHAsICJ5ZXMiKSB8fAor
IAkJCSFzdHJjbXAocCwgInQiKSB8fCAhc3RyY21wKHAsICJ0cnVlIikpIHsKKyAJCQlwID0gIm9u
IjsKKyAJCSAgICB9IGVsc2UgaWYgKCFzdHJjbXAocCwgIjAiKSB8fCAhc3RyY21wKHAsICJubyIp
IHx8CisgCQkJICAgICAgICFzdHJjbXAocCwgImYiKSB8fCAhc3RyY21wKHAsICJmYWxzZSIpKSB7
CisgCQkJcCA9ICJvZmYiOworIAkJICAgIH0KKyAJCX0KKyAKKyAJCXdoaWxlIChlLT5uYW1lKSB7
CisgCQkgICAgaWYgKCFzdHJjbXAoZS0+bmFtZSwgcCkpIGJyZWFrOworIAkJICAgIGUrKzsKKyAJ
CX0KKyAJCWlmIChlLT5uYW1lKSB7CisgCQkgICAgaWYgKGltYXBvcHRzW29wdF0udCA9PSBPUFRf
RU5VTSkKKyAJCQlpbWFwb3B0c1tvcHRdLnZhbC5lID0gZS0+dmFsOworIAkJICAgIGVsc2UKKyAJ
CQlpbWFwb3B0c1tvcHRdLnZhbC5zID0gZS0+bmFtZTsKKyAJCX0gZWxzZSB7CisgCQkgICAgLyog
ZXJyb3IgZHVyaW5nIGNvbnZlcnNpb24gKi8KKyAJCSAgICBzeXNsb2coTE9HX0VSUiwKKyAJCQkg
ICAiaW52YWxpZCB2YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIsCisgCQkJICAgaW1hcG9wdHNbb3B0
XS5vcHRuYW1lLCBsaW5lbm8pOworIAkJICAgIGZjbG9zZShpbmZpbGUpOworIAkJICAgIHJldHVy
biAtMTsKKyAJCX0KKyAJCWJyZWFrOworIAkgICAgfQorIAkgICAgY2FzZSBPUFRfTk9UT1BUOgor
IAkgICAgZGVmYXVsdDoKKyAJCWFib3J0KCk7CisgCSAgICB9CisgCX0gZWxzZSB7CisgCSAgICAv
KiBjaGVjayB0byBtYWtlIHN1cmUgaXQncyB2YWxpZCBmb3Igb3ZlcmZsb3cgKi8KKyAJICAgIC8q
IHRoYXQgaXMsIHBhcnRpdGlvbiBuYW1lcyBhbmQgYW55dGhpbmcgdGhhdCBtaWdodCBiZQorIAkg
ICAgICogdXNlZCBieSBTQVNMICovCisgLyoKKyAgIHh4eCB0aGlzIHdvdWxkIGJlIG5pY2UgaWYg
aXQgd2Fzbid0IGZvciBvdGhlciBzZXJ2aWNlcyB3aG8gbWlnaHQgYmUKKyAgICAgICBzaGFyaW5n
IHRoaXMgY29uZmlnIGZpbGUgYW5kIHdob3NlIG5hbWVzIHdlIGNhbm5vdCBwcmVkaWN0CisgCisg
CSAgICBpZihzdHJuY2FzZWNtcChrZXksInNhc2xfIiw1KQorIAkgICAgJiYgc3RybmNhc2VjbXAo
a2V5LCJwYXJ0aXRpb24tIiwxMCkpIHsKKyAJCXNwcmludGYoZXJyYnVmLAorIAkJCSJvcHRpb24g
JyVzJyBpcyB1bmtub3duIG9uIGxpbmUgJWQgb2YgY29uZmlnIGZpbGUiLAorIAkJCWZ1bGxrZXks
IGxpbmVubyk7CisgCQlmYXRhbChlcnJidWYsIEVDX0NPTkZJRyk7CisgCSAgICB9CisgKi8KKyAK
KyAJICAgIC8qIHNraXAgYWxsIG9wdGlvbnMgZXhjZXB0IHRob3NlIG1hY2hlZCB0ZW1wbGF0ZSAq
LworIAkgICAgaWYoY29uZmlnX3RlbXBsYXRlX2NvbXBhcmUoa2V5LDAsb3B0cyxvcHRzX2xlbikp
CisgCQljb250aW51ZTsKKyAKKyAJICAgIC8qIFB1dCBpdCBpbiB0aGUgb3ZlcmZsb3cgaGFzaCB0
YWJsZSAqLworIAkgICAgbmV3dmFsID0geHN0cmR1cChwKTsKKyAJICAgIHZhbCA9IGhhc2hfaW5z
ZXJ0KGtleSwgbmV3dmFsLCAmY29uZmlnaGFzaCk7CisgCSAgICBpZih2YWwgIT0gbmV3dmFsKSB7
CisgCQlzeXNsb2coTE9HX0VSUiwKKyAJCSAgICAgICAib3B0aW9uICclcycgd2FzIHNwZWNpZmll
ZCB0d2ljZSBpbiBjb25maWcgZmlsZSAoc2Vjb25kIG9jY3VyYW5jZSBvbiBsaW5lICVkKSIsCisg
CQkgICAgICAgZnVsbGtleSwgbGluZW5vKTsKKyAJCWZjbG9zZShpbmZpbGUpOworIAkJcmV0dXJu
IC0xOworIAkgICAgfQorIAl9CisgICAgIH0KKyAgICAgZmNsb3NlKGluZmlsZSk7CisgICAgIHJl
dHVybiAwOworIH0KKyAKKyB0eXBlZGVmIHN0cnVjdCBfY29uZmlnX2RlbGV0ZV9jYl9wYXJhbSB7
CisgICAgIHRlbXBsYXRlX29wdGlvbiAqb3B0czsKKyAgICAgaW50IG9wdHNfbGVuOworIH0gY29u
ZmlnX2RlbGV0ZV9jYl9wYXJhbTsKKyAKKyBpbnQgY29uZmlnX2RlbGV0ZV9jYihjaGFyICprZXks
IHZvaWQgKmRhdGEsIHZvaWQgKnBhcmFtKQorIHsKKyAgICAgaWYoIWNvbmZpZ190ZW1wbGF0ZV9j
b21wYXJlKAorIAkgICAoY2hhciAqKWtleSwgMCwKKyAJICAgKChjb25maWdfZGVsZXRlX2NiX3Bh
cmFtICopcGFyYW0pLT5vcHRzLAorIAkgICAoKGNvbmZpZ19kZWxldGVfY2JfcGFyYW0gKilwYXJh
bSktPm9wdHNfbGVuKSkgeworIAlmcmVlKGRhdGEpOworIAlyZXR1cm4gLTE7CisgICAgIH0KKyAg
ICAgcmV0dXJuIDA7CisgfQorIAorIGV4dGVybiBpbnQgY29uZmlnX3JlcmVhZCh0ZW1wbGF0ZV9v
cHRpb24gKm9wdHMsIGludCBvcHRzX2xlbikKKyB7CisgICAgIGVudW0gb3B0dHlwZSBvcHQgPSBJ
TUFQT1BUX1pFUk87CisgICAgIGNvbmZpZ19kZWxldGVfY2JfcGFyYW0gcGFyYW07CisgICAgIGlu
dCBjdXJfdGVtcGw7CisgICAgIGludCByZXM7CisgCisgICAgIGlmKCFvcHRzX2xlbikKKyAJcmV0
dXJuIDA7CisgCisgICAgIC8qIHJlbW92ZSBvcHRpb25zIHRoYXQgbWFjaGVkIHRlbXBsYXRlICov
CisgICAgIGZvciAob3B0ID0gSU1BUE9QVF9aRVJPOyBvcHQgPCBJTUFQT1BUX0xBU1Q7IG9wdCsr
KSB7CisgCWlmKGltYXBvcHRzW29wdF0uc2VlbikgeworIAkgICAgLyoganVzdCBzZXQgZGVmYXVs
dCB2YWx1ZXMgZm9yIGtub3duIG9wdGlvbnMgKi8KKyAJICAgIGlmKCFjb25maWdfdGVtcGxhdGVf
Y29tcGFyZShpbWFwb3B0c1tvcHRdLm9wdG5hbWUsb3B0LG9wdHMsb3B0c19sZW4pKSB7CisgCQlp
ZihpbWFwb3B0c1tvcHRdLnQgPT0gT1BUX1NUUklORykKKyAJCSAgICBmcmVlKChjaGFyICopaW1h
cG9wdHNbb3B0XS52YWwucyk7CisgCQlpbWFwb3B0c1tvcHRdLnZhbCA9IGltYXBvcHRzW29wdF0u
ZGVmOworIAkJaW1hcG9wdHNbb3B0XS5zZWVuID0gMDsKKyAJICAgIH0KKyAJfQorICAgICB9Cisg
CisgICAgIC8qIGNoZWNrIGlmIHdlIG5lZWQgdG8gd2FsayB0aHJvdWdoIGFsbCBoYXNoZWQgb3B0
aW9ucyBvciB3ZSBqdXN0CisgICAgICAgIG5lZWQgdG8gZGVsZXRlIE4gaGFzaGVkIG9wdGlvbnMg
Ki8KKyAgICAgZm9yKGN1cl90ZW1wbD0wOyBjdXJfdGVtcGw8b3B0c19sZW47IGN1cl90ZW1wbCsr
KSB7CisgCWlmKG9wdHNbY3VyX3RlbXBsXS50eXBlPT1URU1QTEFURU9QVF9UWVBFX1BSRUZJWCkK
KyAJICAgIGJyZWFrOworIAllbHNlIGlmKG9wdHNbY3VyX3RlbXBsXS50eXBlPT1URU1QTEFURU9Q
VF9UWVBFX0VYQUNUTUFUQ0gpIHsKKyAJICAgIHZvaWQgKmRhdGE7CisgCSAgICAKKyAJICAgIC8q
IHRyeSB0byBkZWxldGUgZXhhY3QgbWF0Y2ggb3B0aW9uIChpZiBpdCBleGlzdHMsIGl0IHdpbGwK
KyAJICAgICAgIGJlIGRlbGV0ZWQpICovCisgCSAgICBpZigoZGF0YT1oYXNoX2RlbCgoY2hhciAq
KW9wdHNbY3VyX3RlbXBsXS52YWwsICZjb25maWdoYXNoKSkpCisgCQlmcmVlKGRhdGEpOworIAl9
CisgICAgIH0KKyAKKyAgICAgLyogaWYgd2UndmUgZm91bmQgYSBwcmVmaXggKG5vbi1leGFjdCkg
dGVtcGxhdGUgdGhhbiB3YWxrIHRocm91Z2gKKyAgICAgICAgYWxsIGhhc2hlZCBvcHRpb25zICov
CisgICAgIGlmKGN1cl90ZW1wbDxvcHRzX2xlbikgeworIAlwYXJhbS5vcHRzPW9wdHM7CisgCXBh
cmFtLm9wdHNfbGVuPW9wdHNfbGVuOworIAorIAloYXNoX3dhbGsoJmNvbmZpZ2hhc2gsIGNvbmZp
Z19kZWxldGVfY2IsICZwYXJhbSk7CisgICAgIH0KKyAKKyAgICAgLyogbm93IGNhbGwgY29uZmln
X3JlcmVhZF9maWxlKCkgYXMgaW4gY29uZmlnX3JlYWQoKSAqLworICAgICBpZighY29uc3RydWN0
X2hhc2hfdGFibGUoJmluY2x1ZGVoYXNoLCBJTkNMVURFSEFTSFNJWkUsIDEpKSB7CisgCWZhdGFs
KCJjb3VsZCBub3QgY29uc3RydWN0IGluY2x1ZGUgZmlsZSAgaGFzaCB0YWJsZSIsIEVDX0NPTkZJ
Ryk7CisgICAgIH0KKyAKKyAgICAgcmVzPWNvbmZpZ19yZXJlYWRfZmlsZShjb25maWdfZmlsZW5h
bWUsIG9wdHMsIG9wdHNfbGVuKTsKKyAKKyAgICAgZnJlZV9oYXNoX3RhYmxlKCZpbmNsdWRlaGFz
aCwgTlVMTCk7CisgCisgICAgIGlmKHJlcykKKyAJcmV0dXJuIHJlczsKKyAKKyAgICAgLyogTm90
ZSBpZiB3ZSBkb24ndCBjaGFuZ2UgdmFyaWFibGVzIGJlbG93IHRoZW4gdGhheSBjYW4gcG9pbnQg
dG8KKyAgICAgICAgZnJlZWQgbWVtb3J5LiBUT0RPOiByaWdodCB3b3JrIHdpdGggSU1BUE9QVF9E
RUZBVUxUUEFSVElUSU9OCisgICAgICAgIG9wdGlvbiBhbmQgd2l0aCBvdGhlciBwYXJ0aXRpb25z
IHBhdGhlcyBpcyBuZWVkZWQuICovCisgCisgICAgIC8qIGxvb2sgdXAgbWFpbGJveCBoYXNoaW5n
ICovCisgICAgIGNvbmZpZ19oYXNoaW1hcHNwb29sID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BU
X0hBU0hJTUFQU1BPT0wpOworIAorICAgICAvKiBhcmUgd2Ugc3VwcG9ydGluZyB2aXJ0dWFsIGRv
bWFpbnM/ICAqLworICAgICBjb25maWdfdmlydGRvbWFpbnMgPSBjb25maWdfZ2V0ZW51bShJTUFQ
T1BUX1ZJUlRET01BSU5TKTsKKyAgICAgY29uZmlnX2RlZmRvbWFpbiA9IGNvbmZpZ19nZXRzdHJp
bmcoSU1BUE9QVF9ERUZBVUxURE9NQUlOKTsKKyAKKyAgICAgLyogbG9vayB1cCB0aGUgaG9zdG5h
bWUgd2Ugc2hvdWxkIHByZXNlbnQgdG8gdGhlIHVzZXIgKi8KKyAgICAgY29uZmlnX3NlcnZlcm5h
bWUgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfU0VSVkVSTkFNRSk7CisgICAgIGlmICghY29u
ZmlnX3NlcnZlcm5hbWUpIHsKKyAJY29uZmlnX3NlcnZlcm5hbWUgPSB4bWFsbG9jKHNpemVvZihj
aGFyKSAqIDI1Nik7CisgCWdldGhvc3RuYW1lKChjaGFyICopIGNvbmZpZ19zZXJ2ZXJuYW1lLCAy
NTYpOworICAgICB9CisgCisgICAgIGNvbmZpZ19tdXBkYXRlX3NlcnZlciA9IGNvbmZpZ19nZXRz
dHJpbmcoSU1BUE9QVF9NVVBEQVRFX1NFUlZFUik7CisgCisgICAgIHJldHVybiAwOworIH0KZGlm
ZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbGliL2xpYmNvbmZpZy5oIGN5cnVz
LWltYXBkLTIuMi4xMi9saWIvbGliY29uZmlnLmgKKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQv
bGliL2xpYmNvbmZpZy5oCTIwMDMtMTItMjkgMjM6MjI6NTUgKzAzMDAKLS0tIGN5cnVzLWltYXBk
LTIuMi4xMi9saWIvbGliY29uZmlnLmgJMjAwNS0xMS0xMSAxNzo1ODozOSArMDMwMAoqKioqKioq
KioqKioqKioKKioqIDQ2LDU0ICoqKioKLS0tIDQ2LDY1IC0tLS0KICAjaW5jbHVkZSAiZXhpdGNv
ZGVzLmgiCiAgI2luY2x1ZGUgImltYXBvcHRzLmgiCiAgCisgLyogdHlwZXMgZm9yIHN0cnVjdHVy
ZSB0ZW1wbGF0ZV9vcHRpb24gKi8KKyAjZGVmaW5lIFRFTVBMQVRFT1BUX1RZUEVfS05PV05PUFQg
ICAwCisgI2RlZmluZSBURU1QTEFURU9QVF9UWVBFX0VYQUNUTUFUQ0ggMQorICNkZWZpbmUgVEVN
UExBVEVPUFRfVFlQRV9QUkVGSVggICAgIDIKKyAKKyB0eXBlZGVmIHN0cnVjdCBfdGVtcGxhdGVf
b3B0aW9uIHsKKyAgICAgdm9pZCAqdmFsOworICAgICBpbnQgdHlwZTsKKyB9IHRlbXBsYXRlX29w
dGlvbjsKKyAKICAvKiB0aGVzZSB3aWxsIGFzc2VydCgpIGlmIHRoZXkncmUgY2FsbGVkIG9uIHRo
ZSB3cm9uZyB0eXBlIG9mCiAgICAgb3B0aW9uIChpbWFwb3B0cy5jKSAqLwogIGV4dGVybiB2b2lk
IGNvbmZpZ19yZWFkKGNvbnN0IGNoYXIgKmFsdF9jb25maWcpOworIGV4dGVybiBpbnQgY29uZmln
X3JlcmVhZCh0ZW1wbGF0ZV9vcHRpb24gKm9wdHMsIGludCBvcHRzX2xlbik7CiAgZXh0ZXJuIGNv
bnN0IGNoYXIgKmNvbmZpZ19nZXRzdHJpbmcoZW51bSBpbWFwb3B0IG9wdCk7CiAgZXh0ZXJuIGlu
dCBjb25maWdfZ2V0aW50KGVudW0gaW1hcG9wdCBvcHQpOwogIGV4dGVybiBpbnQgY29uZmlnX2dl
dHN3aXRjaChlbnVtIGltYXBvcHQgb3B0KTsKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIu
Mi4xMi5vbGQvbm90aWZ5ZC9NYWtlZmlsZS5pbiBjeXJ1cy1pbWFwZC0yLjIuMTIvbm90aWZ5ZC9N
YWtlZmlsZS5pbgoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9ub3RpZnlkL01ha2VmaWxlLmlu
CTIwMDUtMTEtMDcgMTg6MDU6MzEgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9ub3RpZnlk
L01ha2VmaWxlLmluCTIwMDUtMTEtMTEgMTc6NTg6MzkgKzAzMDAKKioqKioqKioqKioqKioqCioq
KiA3Miw3OCAqKioqCiAgU0lFVkVfTElCUyA9IEBTSUVWRV9MSUJTQAogIElNQVBfQ09NX0VSUl9M
SUJTID0gQElNQVBfQ09NX0VSUl9MSUJTQAogIExJQl9XUkFQID0gQExJQl9XUkFQQAohIExJQlMg
PSBAWkVQSFlSX0xJQlNAIEBMSUJTQCAkKElNQVBfQ09NX0VSUl9MSUJTKQogIERFUExJQlM9Li4v
aW1hcC9tdXRleF9mYWtlLm8gLi4vaW1hcC9saWJpbWFwLmEgJChTSUVWRV9MSUJTKSAuLi9saWIv
bGliY3lydXMuYSAuLi9saWIvbGliY3lydXNfbWluLmEgQERFUExJQlNACiAgCiAgUFVSSUZZPS91
c3IvbG9jYWwvYmluL3B1cmlmeQotLS0gNzIsNzggLS0tLQogIFNJRVZFX0xJQlMgPSBAU0lFVkVf
TElCU0AKICBJTUFQX0NPTV9FUlJfTElCUyA9IEBJTUFQX0NPTV9FUlJfTElCU0AKICBMSUJfV1JB
UCA9IEBMSUJfV1JBUEAKISBMSUJTID0gQFpFUEhZUl9MSUJTQCBATElCU0AgJChJTUFQX0NPTV9F
UlJfTElCUykgLWxyZWRibGFjayAtbGxkYXAKICBERVBMSUJTPS4uL2ltYXAvbXV0ZXhfZmFrZS5v
IC4uL2ltYXAvbGliaW1hcC5hICQoU0lFVkVfTElCUykgLi4vbGliL2xpYmN5cnVzLmEgLi4vbGli
L2xpYmN5cnVzX21pbi5hIEBERVBMSUJTQAogIAogIFBVUklGWT0vdXNyL2xvY2FsL2Jpbi9wdXJp
ZnkKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvcHRjbGllbnQvTWFrZWZp
bGUuaW4gY3lydXMtaW1hcGQtMi4yLjEyL3B0Y2xpZW50L01ha2VmaWxlLmluCioqKiBjeXJ1cy1p
bWFwZC0yLjIuMTIub2xkL3B0Y2xpZW50L01ha2VmaWxlLmluCTIwMDUtMTEtMDcgMTg6MDU6Mjcg
KzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9wdGNsaWVudC9NYWtlZmlsZS5pbgkyMDA1LTEx
LTExIDE3OjU4OjM5ICswMzAwCioqKioqKioqKioqKioqKgoqKiogNTgsNjQgKioqKgogIEFGU19M
SUJTID0gQEFGU19MSUJTQAogIElNQVBfTElCUyA9IEBJTUFQX0xJQlNAIEBMSUJfUlRACiAgU0lF
VkVfTElCUyA9IEBTSUVWRV9MSUJTQAohIExJQlMgPSAkKElNQVBfTElCUykgQENPTV9FUlJfTElC
U0AKICBMSUJfU0FTTCA9IEBMSUJfU0FTTEAKICBMSUJfV1JBUCA9IEBMSUJfV1JBUEAKICBERVBM
SUJTID0gLi4vaW1hcC9saWJpbWFwLmEgJChTSUVWRV9MSUJTKSAuLi9saWIvbGliY3lydXMuYSAu
Li9saWIvbGliY3lydXNfbWluLmEgQERFUExJQlNAIAotLS0gNTgsNjQgLS0tLQogIEFGU19MSUJT
ID0gQEFGU19MSUJTQAogIElNQVBfTElCUyA9IEBJTUFQX0xJQlNAIEBMSUJfUlRACiAgU0lFVkVf
TElCUyA9IEBTSUVWRV9MSUJTQAohIExJQlMgPSAkKElNQVBfTElCUykgQENPTV9FUlJfTElCU0Ag
LWxyZWRibGFjayAtbGxkYXAKICBMSUJfU0FTTCA9IEBMSUJfU0FTTEAKICBMSUJfV1JBUCA9IEBM
SUJfV1JBUEAKICBERVBMSUJTID0gLi4vaW1hcC9saWJpbWFwLmEgJChTSUVWRV9MSUJTKSAuLi9s
aWIvbGliY3lydXMuYSAuLi9saWIvbGliY3lydXNfbWluLmEgQERFUExJQlNAIApkaWZmIC1OIC1D
IDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC90aW1zaWV2ZWQvTWFrZWZpbGUuaW4gY3lydXMt
aW1hcGQtMi4yLjEyL3RpbXNpZXZlZC9NYWtlZmlsZS5pbgoqKiogY3lydXMtaW1hcGQtMi4yLjEy
Lm9sZC90aW1zaWV2ZWQvTWFrZWZpbGUuaW4JMjAwNC0wNS0yOCAyMjowMzoxMCArMDQwMAotLS0g
Y3lydXMtaW1hcGQtMi4yLjEyL3RpbXNpZXZlZC9NYWtlZmlsZS5pbgkyMDA1LTExLTExIDE3OjU4
OjQwICswMzAwCioqKioqKioqKioqKioqKgoqKiogNzEsNzcgKioqKgogIElNQVBfTElCUyA9IEBJ
TUFQX0xJQlNAIEBMSUJfUlRACiAgSU1BUF9DT01fRVJSX0xJQlMgPSBASU1BUF9DT01fRVJSX0xJ
QlNACiAgTElCX1dSQVAgPSBATElCX1dSQVBACiEgTElCUyA9ICQoSU1BUF9DT01fRVJSX0xJQlMp
CiAgREVQTElCUz0uLi9zaWV2ZS9saWJzaWV2ZS5hIC4uL2ltYXAvbXV0ZXhfZmFrZS5vIC4uL2lt
YXAvbGliaW1hcC5hIC4uL2xpYi9saWJjeXJ1cy5hIC4uL2xpYi9saWJjeXJ1c19taW4uYSBAREVQ
TElCU0AKICAKICBQVVJJRlk9L3Vzci9sb2NhbC9iaW4vcHVyaWZ5Ci0tLSA3MSw3NyAtLS0tCiAg
SU1BUF9MSUJTID0gQElNQVBfTElCU0AgQExJQl9SVEAKICBJTUFQX0NPTV9FUlJfTElCUyA9IEBJ
TUFQX0NPTV9FUlJfTElCU0AKICBMSUJfV1JBUCA9IEBMSUJfV1JBUEAKISBMSUJTID0gJChJTUFQ
X0NPTV9FUlJfTElCUykgLWxyZWRibGFjayAtbGxkYXAKICBERVBMSUJTPS4uL3NpZXZlL2xpYnNp
ZXZlLmEgLi4vaW1hcC9tdXRleF9mYWtlLm8gLi4vaW1hcC9saWJpbWFwLmEgLi4vbGliL2xpYmN5
cnVzLmEgLi4vbGliL2xpYmN5cnVzX21pbi5hIEBERVBMSUJTQAogIAogIFBVUklGWT0vdXNyL2xv
Y2FsL2Jpbi9wdXJpZnkKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvdG9v
bHMvY29uZmlnMmhlYWRlciBjeXJ1cy1pbWFwZC0yLjIuMTIvdG9vbHMvY29uZmlnMmhlYWRlcgoq
KiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC90b29scy9jb25maWcyaGVhZGVyCTIwMDUtMTEtMDcg
MTg6MDU6MzcgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi90b29scy9jb25maWcyaGVhZGVy
CTIwMDUtMTEtMTEgMTc6NTg6NDAgKzAzMDAKKioqKioqKioqKioqKioqCioqKiAxMjYsMTMyICoq
KioKICAKICBzdHJ1Y3QgaW1hcG9wdF9zIGltYXBvcHRzW10gPQogIHsKISAgIHsgSU1BUE9QVF9a
RVJPLCAiIiwgMCwgeyBOVUxMIH0sIE9QVF9OT1RPUFQsIHsgIHsgTlVMTCwgSU1BUF9FTlVNX1pF
Uk8gfSB9IH0sCiAgRU9GCiAgICAgIDsKICAKLS0tIDEyNiwxMzIgLS0tLQogIAogIHN0cnVjdCBp
bWFwb3B0X3MgaW1hcG9wdHNbXSA9CiAgewohICAgeyBJTUFQT1BUX1pFUk8sICIiLCAwLCB7IE5V
TEwgfSwgeyBOVUxMIH0sIE9QVF9OT1RPUFQsIHsgIHsgTlVMTCwgSU1BUF9FTlVNX1pFUk8gfSB9
IH0sCiAgRU9GCiAgICAgIDsKICAKKioqKioqKioqKioqKioqCioqKiAyMDQsMjEwICoqKioKICAJ
CQk6ICJ7KHZvaWQqKSQyfSI7CiAgCX0KICAKISAJcHJpbnQgQ0ZJTEUgIiAgeyBJTUFQT1BUXyIs
IHVjKCRvcHQpLCAiLCBcIiQxXCIsIDAsICRkZWYsIE9QVF8kMywgeyAkZW51bXMgeyBOVUxMLCBJ
TUFQX0VOVU1fWkVSTyB9IH0gfSxcbiI7CiAgICAgIH0gZWxzZSB7CiAgCSNjaG9tcDsKICAJI3By
aW50ICJyZWplY3RlZCAnJF8nXG4iOwotLS0gMjA0LDIxMCAtLS0tCiAgCQkJOiAieyh2b2lkKikk
Mn0iOwogIAl9CiAgCiEgCXByaW50IENGSUxFICIgIHsgSU1BUE9QVF8iLCB1Yygkb3B0KSwgIiwg
XCIkMVwiLCAwLCAkZGVmLCAkZGVmLCBPUFRfJDMsIHsgJGVudW1zIHsgTlVMTCwgSU1BUF9FTlVN
X1pFUk8gfSB9IH0sXG4iOwogICAgICB9IGVsc2UgewogIAkjY2hvbXA7CiAgCSNwcmludCAicmVq
ZWN0ZWQgJyRfJ1xuIjsKKioqKioqKioqKioqKioqCioqKiAyNTEsMjU2ICoqKioKLS0tIDI1MSwy
NTcgLS0tLQogICAgICBjb25zdCBjaGFyICpvcHRuYW1lOwogICAgICBpbnQgc2VlbjsKICAgICAg
dW5pb24gY29uZmlnX3ZhbHVlIHZhbDsKKyAgICAgdW5pb24gY29uZmlnX3ZhbHVlIGRlZjsKICAg
ICAgY29uc3QgZW51bSBvcHR0eXBlIHQ7CiAgRU9GCiAgOwoqKioqKioqKioqKioqKioKKioqIDI2
NSwyNzEgKioqKgogICAgICA7CiAgCiAgcHJpbnQgQ0ZJTEUgPDxFT0YKISAgIHsgSU1BUE9QVF9M
QVNULCBOVUxMLCAwLCB7IE5VTEwgfSwgT1BUX05PVE9QVCwgeyAgeyBOVUxMLCBJTUFQX0VOVU1f
WkVSTyB9IH0gfQogIH07CiAgCiAgLyogYyBjb2RlIGdvZXMgaGVyZSAqLwotLS0gMjY2LDI3MiAt
LS0tCiAgICAgIDsKICAKICBwcmludCBDRklMRSA8PEVPRgohICAgeyBJTUFQT1BUX0xBU1QsIE5V
TEwsIDAsIHsgTlVMTCB9LCB7IE5VTEwgfSwgT1BUX05PVE9QVCwgeyAgeyBOVUxMLCBJTUFQX0VO
VU1fWkVSTyB9IH0gfQogIH07CiAgCiAgLyogYyBjb2RlIGdvZXMgaGVyZSAqLwo=
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>400</attachid>
            <date>2005-11-24 08:34 EDT</date>
            <desc>Update</desc>
            <filename>cyrus-imapd-convertuserid-2.2.12_8.patch</filename>
            <type>text/plain</type>
            <size>90988</size>
            <attacher>dzal_mail@mtu-net.ru</attacher>
            
              <data encoding="base64">ZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvY29uZmlnLmguaW4gY3lydXMt
aW1hcGQtMi4yLjEyL2NvbmZpZy5oLmluCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2NvbmZp
Zy5oLmluCTIwMDUtMDItMTQgMjA6NTk6NDEgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9j
b25maWcuaC5pbgkyMDA1LTExLTIyIDE4OjU3OjUxICswMzAwCioqKioqKioqKioqKioqKgoqKiog
NjQsNjkgKioqKgotLS0gNjQsNzIgLS0tLQogIC8qIERvIHdlIGhhdmUgYSBkZWNlbnQgcmVnZXgg
bGlicmFyeT8gKi8KICAjdW5kZWYgRU5BQkxFX1JFR0VYCiAgCisgLyogRW5hYmxlIGNvbnZlcnRp
bmcgdXNlcmlkcyB2aWEgTERBUCBzdXBwb3J0PyAqLworICN1bmRlZiBFTkFCTEVfQ09OVkVSVF9V
U0VSSUQKKyAKICAvKiBFbmFibGUgTmV0c2NhcGUgTWVudSBPcHRpb24gSGFjaz8gKi8KICAjdW5k
ZWYgRU5BQkxFX1hfTkVUU0NBUEVfSEFDSwogIApkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQt
Mi4yLjEyLm9sZC9jb25maWd1cmUgY3lydXMtaW1hcGQtMi4yLjEyL2NvbmZpZ3VyZQoqKiogY3ly
dXMtaW1hcGQtMi4yLjEyLm9sZC9jb25maWd1cmUJMjAwNS0wMi0xNCAyMDo1OTo0NiArMDMwMAot
LS0gY3lydXMtaW1hcGQtMi4yLjEyL2NvbmZpZ3VyZQkyMDA1LTExLTIyIDE4OjU3OjUyICswMzAw
CioqKioqKioqKioqKioqKgoqKiogODUyLDg1NyAqKioqCi0tLSA4NTIsODU4IC0tLS0KICAgIC0t
ZW5hYmxlLWNtdWxvY2FsICAgICAgIGVuYWJsZSBDTVUtc3BlY2lmaWMgbG9jYWwgc3VwcG9ydAog
ICAgLS1lbmFibGUtb2xkc2lldmVuYW1lICAgZW5hYmxlIHRoZSB1c2Ugb2YgJ2ltYXAnIGFzIHRo
ZSBzaWV2ZSBzZXJ2aWNlIG5hbWUKICAgIC0tZW5hYmxlLWxpc3RleHQgICAgICAgIGVuYWJsZSBJ
TUFQIExpc3QgZXh0ZW5zaW9ucworICAgLS1lbmFibGUtY29udmVydHVzZXJpZCAgZW5hYmxlIGNv
bnZlcnRpbmcgdXNlcmlkcyB2aWEgTERBUCBzdXBwb3J0CiAgICAtLWVuYWJsZS1uZXRzY2FwZWhh
Y2sgICBlbmFibGUgTmV0c2NhcGUgaGFjayBmb3IgdGhlIG1lbnUgb3B0aW9uCiAgICAgICAgICAg
ICAgICAgICAgICAgICAgICBpbiBDb21tdW5pY2F0b3IgdG8gQWRtaW5pc3RyYXRlIE1haWwKICAg
IC0tZW5hYmxlLWdzc2FwaT08RElSPiAgIGVuYWJsZSBHU1NBUEkgYXV0aGVudGljYXRpb24geWVz
CioqKioqKioqKioqKioqKgoqKiogMTExODAsMTExODUgKioqKgotLS0gMTExODEsMTExOTggLS0t
LQogIAlmaQogIGZpOwogIAorICMgQ2hlY2sgd2hldGhlciAtLWVuYWJsZS1jb252ZXJ0dXNlcmlk
IG9yIC0tZGlzYWJsZS1jb252ZXJ0dXNlcmlkIHdhcyBnaXZlbi4KKyBpZiB0ZXN0ICIke2VuYWJs
ZV9jb252ZXJ0dXNlcmlkK3NldH0iID0gc2V0OyB0aGVuCisgICBlbmFibGV2YWw9IiRlbmFibGVf
Y29udmVydHVzZXJpZCIKKyAgIGlmIHRlc3QgIiRlbmFibGV2YWwiID0geWVzOyB0aGVuCisgCisg
Y2F0ID4+Y29uZmRlZnMuaCA8PFxfQUNFT0YKKyAjZGVmaW5lIEVOQUJMRV9DT05WRVJUX1VTRVJJ
RAorIF9BQ0VPRgorIAlJTUFQX1BST0dTPSIkSU1BUF9QUk9HUyBsZGFwZCIKKyAJZmkKKyBmaTsK
KyAKICAjIENoZWNrIHdoZXRoZXIgLS1lbmFibGUtbmV0c2NhcGVoYWNrIG9yIC0tZGlzYWJsZS1u
ZXRzY2FwZWhhY2sgd2FzIGdpdmVuLgogIGlmIHRlc3QgIiR7ZW5hYmxlX25ldHNjYXBlaGFjaytz
ZXR9IiA9IHNldDsgdGhlbgogICAgZW5hYmxldmFsPSIkZW5hYmxlX25ldHNjYXBlaGFjayIKZGlm
ZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvY29uZmlndXJlLmluIGN5cnVzLWlt
YXBkLTIuMi4xMi9jb25maWd1cmUuaW4KKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvY29uZmln
dXJlLmluCTIwMDUtMDEtMTkgMDI6NDY6MDAgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9j
b25maWd1cmUuaW4JMjAwNS0xMS0yMiAxODo1Nzo1MiArMDMwMAoqKioqKioqKioqKioqKioKKioq
IDkxNyw5MjIgKioqKgotLS0gOTE3LDkyOSAtLS0tCiAgCQlBQ19ERUZJTkUoRU5BQkxFX0xJU1RF
WFQsW10sW0VuYWJsZSB0aGUgTElTVEVYVCBleHRlbnNpb24/XSkKICAJZmkpCiAgCisgQUNfQVJH
X0VOQUJMRShjb252ZXJ0dXNlcmlkLAorIAlbICAtLWVuYWJsZS1jb252ZXJ0dXNlcmlkICBlbmFi
bGUgY29udmVydGluZyB1c2VyaWRzIHZpYSBMREFQIHN1cHBvcnRdLAorIAlpZiB0ZXN0ICIkZW5h
YmxldmFsIiA9IHllczsgdGhlbgorIAkJQUNfREVGSU5FKEVOQUJMRV9DT05WRVJUX1VTRVJJRCxb
XSxbRW5hYmxlIGNvbnZlcnRpbmcgdXNlcmlkcyB2aWEgTERBUCBzdXBwb3J0P10pCisgCQlJTUFQ
X1BST0dTPSIkSU1BUF9QUk9HUyBsZGFwZCIKKyAJZmkpCisgCiAgQUNfQVJHX0VOQUJMRShuZXRz
Y2FwZWhhY2ssCiAgCVsgIC0tZW5hYmxlLW5ldHNjYXBlaGFjayAgIGVuYWJsZSBOZXRzY2FwZSBo
YWNrIGZvciB0aGUgbWVudSBvcHRpb24KICAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIENv
bW11bmljYXRvciB0byBBZG1pbmlzdHJhdGUgTWFpbF0sCmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1p
bWFwZC0yLjIuMTIub2xkL2ltYXAvY2hhcnNldF9jb252ZXJ0LmMgY3lydXMtaW1hcGQtMi4yLjEy
L2ltYXAvY2hhcnNldF9jb252ZXJ0LmMKKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9j
aGFyc2V0X2NvbnZlcnQuYwkxOTcwLTAxLTAxIDAzOjAwOjAwICswMzAwCi0tLSBjeXJ1cy1pbWFw
ZC0yLjIuMTIvaW1hcC9jaGFyc2V0X2NvbnZlcnQuYwkyMDA1LTExLTIyIDE4OjU4OjMwICswMzAw
CioqKioqKioqKioqKioqKgoqKiogMCAqKioqCi0tLSAxLDU0NSAtLS0tCisgLyogVGhpcyBmaWxl
IHdhcyB0YWtlbiBmcm9tIFBIUCA1IGFuZCB3YXMgbW9kaWZpZWQgYnkKKyAgICBBbGV4YW5kZXIg
RHJvemRvdiA8ZHphbF9tYWlsQG10dS1uZXQucnU+ICovCisgI2luY2x1ZGUgPHN0ZGxpYi5oPgor
IAorICNpbmNsdWRlICJjaGFyc2V0X2NvbnZlcnQuaCIKKyAKKyAjZGVmaW5lIFVDUzRNQVggMHg3
MDAwMDAwMFUKKyAKKyAjZGVmaW5lIFVDUzJNQVggMHgwMDAxMDAwMFUKKyAjZGVmaW5lIFNVUE1J
TiAgMHgwMDAxMDAwMFUKKyAjZGVmaW5lIFNVUE1BWCAgMHgwMDIwMDAwMFUKKyAKKyAjZGVmaW5l
IE1BU0sgICAgMHhmZmZmZmZVCisgI2RlZmluZSBUSFJPVUdIIDB4NzgwMDAwMDBVICAgICAgICAg
ICAgICAvKiAwMDAwMDBoIC0gRkZGRkZGaCAqLworIAorIHR5cGVkZWYgdW5zaWduZWQgaW50IHVp
bnQ7CisgCisgdHlwZWRlZiBzdHJ1Y3QgX2NvbnZlcnRfc3RhdGUgeworICAgICBpbnQgY2FjaGU7
CisgICAgIGludCBzdGF0dXM7CisgfSBjb252ZXJ0X3N0YXRlOworIAorIHR5cGVkZWYgaW50ICgq
Y29udmVydGVkX291dF9jYl90KSh1aW50IGMsIHZvaWQgKik7CisgdHlwZWRlZiBpbnQgKCpjb252
ZXJ0X2NiX3QpKHVpbnQgYywgY29udmVydF9zdGF0ZSAqLCBjb252ZXJ0ZWRfb3V0X2NiX3QsIHZv
aWQgKik7CisgdHlwZWRlZiBpbnQgKCpmbHVzaF9jYl90KShjb252ZXJ0X3N0YXRlICosIGNvbnZl
cnRlZF9vdXRfY2JfdCwgdm9pZCAqKTsKKyAKKyAjZGVmaW5lIENLKHN0YXRlbWVudCkJZG8geyBp
ZiAoKHN0YXRlbWVudCkpIHJldHVybiAoLTEpOyB9IHdoaWxlICgwKQorIAorIHN0YXRpYyBpbnQg
dXRmOF9lbmNvZGUodWludCBjLCBjb252ZXJ0X3N0YXRlICpmaWx0ZXIsIGNvbnZlcnRlZF9vdXRf
Y2JfdCBvdXRfY2IsIHZvaWQgKm91dF9jYl9wYXJhbSkKKyB7CisgICAgIC8qIHNraXAgd3Jvbmcg
c3ltYm9scyAqLworICAgICBpZiAoYyA+IFVDUzRNQVgpCisgCXJldHVybiAwOworICAgICAKKyAg
ICAgaWYgKGMgPCAweDgwKSB7CisgCUNLKG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKyAgICAg
fSBlbHNlIGlmIChjIDwgMHg4MDApIHsKKyAJQ0sob3V0X2NiKCgoYyA+PiA2KSAmIDB4MWYpIHwg
MHhjMCwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigoYyAmIDB4M2YpIHwgMHg4MCwgb3V0
X2NiX3BhcmFtKSk7CisgICAgIH0gZWxzZSBpZiAoYyA8IDB4MTAwMDApIHsKKyAJQ0sob3V0X2Ni
KCgoYyA+PiAxMikgJiAweDBmKSB8IDB4ZTAsIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2Io
KChjID4+IDYpICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKChj
ICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKyAgICAgfSBlbHNlIGlmIChjIDwgMHgy
MDAwMDApIHsKKyAJQ0sob3V0X2NiKCgoYyA+PiAxOCkgJiAweDA3KSB8IDB4ZjAsIG91dF9jYl9w
YXJhbSkpOworIAlDSyhvdXRfY2IoKChjID4+IDEyKSAmIDB4M2YpIHwgMHg4MCwgb3V0X2NiX3Bh
cmFtKSk7CisgCUNLKG91dF9jYigoKGMgPj4gNikgJiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJh
bSkpOworIAlDSyhvdXRfY2IoKGMgJiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworICAg
ICB9IGVsc2UgaWYgKGMgPCAweDQwMDAwMDApIHsKKyAJQ0sob3V0X2NiKCgoYyA+PiAyNCkgJiAw
eDAzKSB8IDB4ZjgsIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoKChjID4+IDE4KSAmIDB4
M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigoKGMgPj4gMTIpICYgMHgz
ZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKCgoYyA+PiA2KSAmIDB4M2Yp
IHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigoYyAmIDB4M2YpIHwgMHg4MCwg
b3V0X2NiX3BhcmFtKSk7CisgICAgIH0gZWxzZSB7CisgCUNLKG91dF9jYigoKGMgPj4gMzApICYg
MHgwMSkgfCAweGZjLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKCgoYyA+PiAyNCkgJiAw
eDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2IoKChjID4+IDE4KSAmIDB4
M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigoKGMgPj4gMTIpICYgMHgz
ZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKCgoYyA+PiA2KSAmIDB4M2Yp
IHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigoYyAmIDB4M2YpIHwgMHg4MCwg
b3V0X2NiX3BhcmFtKSk7CisgICAgIH0KKyAKKyAgICAgcmV0dXJuIDA7CisgfQorIAorIHN0YXRp
YyBpbnQgdXRmOF9kZWNvZGUodWludCBjLCBjb252ZXJ0X3N0YXRlICpmaWx0ZXIsIGNvbnZlcnRl
ZF9vdXRfY2JfdCBvdXRfY2IsIHZvaWQgKm91dF9jYl9wYXJhbSkKKyB7CisgICAgIGlmIChjIDwg
MHg4MCkgeworIAlDSyhvdXRfY2IoYywgb3V0X2NiX3BhcmFtKSk7CisgCWZpbHRlci0+c3RhdHVz
ID0gMDsKKyAgICAgfSBlbHNlIGlmIChjIDwgMHhjMCkgeworIAl1aW50IHM7CisgCisgCXN3aXRj
aCAoZmlsdGVyLT5zdGF0dXMgJiAweGZmKSB7CisgCWNhc2UgMHgxMDogLyogMmJ5dGUgY29kZSAy
bmQgY2hhciAqLworIAljYXNlIDB4MjE6IC8qIDNieXRlIGNvZGUgM3JkIGNoYXIgKi8KKyAJY2Fz
ZSAweDMyOiAvKiA0Ynl0ZSBjb2RlIDR0aCBjaGFyICovCisgCWNhc2UgMHg0MzogLyogNWJ5dGUg
Y29kZSA1dGggY2hhciAqLworIAljYXNlIDB4NTQ6IC8qIDZieXRlIGNvZGUgNnRoIGNoYXIgKi8K
KyAJICAgIGZpbHRlci0+c3RhdHVzID0gMDsKKyAJICAgIHMgPSBmaWx0ZXItPmNhY2hlIHwgKGMg
JiAweDNmKTsKKyAJICAgIGlmIChzID49IDB4ODApCisgCQlDSyhvdXRfY2Iocywgb3V0X2NiX3Bh
cmFtKSk7CisgCSAgICBicmVhazsKKyAJY2FzZSAweDIwOiAvKiAzYnl0ZSBjb2RlIDJuZCBjaGFy
ICovCisgCWNhc2UgMHgzMTogLyogNGJ5dGUgY29kZSAzcmQgY2hhciAqLworIAljYXNlIDB4NDI6
IC8qIDVieXRlIGNvZGUgNHRoIGNoYXIgKi8KKyAJY2FzZSAweDUzOiAvKiA2Ynl0ZSBjb2RlIDV0
aCBjaGFyICovCisgCSAgICBmaWx0ZXItPmNhY2hlIHw9ICgoYyAmIDB4M2YpIDw8IDYpOworIAkg
ICAgZmlsdGVyLT5zdGF0dXMrKzsKKyAJICAgIGJyZWFrOworIAljYXNlIDB4MzA6IC8qIDRieXRl
IGNvZGUgMm5kIGNoYXIgKi8KKyAJY2FzZSAweDQxOiAvKiA1Ynl0ZSBjb2RlIDNyZCBjaGFyICov
CisgCWNhc2UgMHg1MjogLyogNmJ5dGUgY29kZSA0dGggY2hhciAqLworIAkgICAgZmlsdGVyLT5j
YWNoZSB8PSAoKGMgJiAweDNmKSA8PCAxMik7CisgCSAgICBmaWx0ZXItPnN0YXR1cysrOworIAkg
ICAgYnJlYWs7CisgCWNhc2UgMHg0MDogLyogNWJ5dGUgY29kZSAybmQgY2hhciAqLworIAljYXNl
IDB4NTE6IC8qIDZieXRlIGNvZGUgM3JkIGNoYXIgKi8KKyAJICAgIGZpbHRlci0+Y2FjaGUgfD0g
KChjICYgMHgzZikgPDwgMTgpOworIAkgICAgZmlsdGVyLT5zdGF0dXMrKzsKKyAJICAgIGJyZWFr
OworIAljYXNlIDB4NTA6IC8qIDZieXRlIGNvZGUgMm5kIGNoYXIgKi8KKyAJICAgIGZpbHRlci0+
Y2FjaGUgfD0gKChjICYgMHgzZikgPDwgMjQpOworIAkgICAgZmlsdGVyLT5zdGF0dXMrKzsKKyAJ
ICAgIGJyZWFrOworIAlkZWZhdWx0OgorIAkgICAgZmlsdGVyLT5zdGF0dXMgPSAwOworIAkgICAg
YnJlYWs7CisgCX0KKyAgICAgfSBlbHNlIGlmIChjIDwgMHhlMCkgeyAvKiAyYnl0ZSBjb2RlIGZp
cnN0IGNoYXIgKi8KKyAJZmlsdGVyLT5zdGF0dXMgPSAweDEwOworIAlmaWx0ZXItPmNhY2hlID0g
KGMgJiAweDFmKSA8PCA2OworICAgICB9IGVsc2UgaWYgKGMgPCAweGYwKSB7IC8qIDNieXRlIGNv
ZGUgZmlyc3QgY2hhciAqLworIAlmaWx0ZXItPnN0YXR1cyA9IDB4MjA7CisgCWZpbHRlci0+Y2Fj
aGUgPSAoYyAmIDB4ZikgPDwgMTI7CisgICAgIH0gZWxzZSBpZiAoYyA8IDB4ZjgpIHsgLyogNGJ5
dGUgY29kZSBmaXJzdCBjaGFyICovCisgCWZpbHRlci0+c3RhdHVzID0gMHgzMDsKKyAJZmlsdGVy
LT5jYWNoZSA9IChjICYgMHg3KSA8PCAxODsKKyAgICAgfSBlbHNlIGlmIChjIDwgMHhmYykgeyAv
KiA1Ynl0ZSBjb2RlIGZpcnN0IGNoYXIgKi8KKyAJZmlsdGVyLT5zdGF0dXMgPSAweDQwOworIAlm
aWx0ZXItPmNhY2hlID0gKGMgJiAweDMpIDw8IDI0OworICAgICB9IGVsc2UgaWYgKGMgPCAweGZl
KSAgeyAvKiA2IGJ5dGUgY29kZSBmaXJzdCBjaGFyICovCisgCWZpbHRlci0+c3RhdHVzID0gMHg1
MDsKKyAJZmlsdGVyLT5jYWNoZSA9IChjICYgMHgxKSA8PCAzMDsKKyAgICAgfSBlbHNlIHsKKyAJ
ZmlsdGVyLT5zdGF0dXMgPSAwOworIAlmaWx0ZXItPmNhY2hlID0gMDsKKyAgICAgfQorIAorICAg
ICByZXR1cm4gMDsKKyB9CisgCisgc3RhdGljIGNvbnN0IHVuc2lnbmVkIGNoYXIgdXRmN2ltYXBf
YmFzZTY0X3RhYmxlW10gPQorIHsKKyAgLyogJ0EnLCAnQicsICdDJywgJ0QnLCAnRScsICdGJywg
J0cnLCAnSCcsICdJJywgJ0onLCAnSycsICdMJywgJ00nLCAqLworICAgIDB4NDEsMHg0MiwweDQz
LDB4NDQsMHg0NSwweDQ2LDB4NDcsMHg0OCwweDQ5LDB4NGEsMHg0YiwweDRjLDB4NGQsCisgIC8q
ICdOJywgJ08nLCAnUCcsICdRJywgJ1InLCAnUycsICdUJywgJ1UnLCAnVicsICdXJywgJ1gnLCAn
WScsICdaJywgKi8KKyAgICAweDRlLDB4NGYsMHg1MCwweDUxLDB4NTIsMHg1MywweDU0LDB4NTUs
MHg1NiwweDU3LDB4NTgsMHg1OSwweDVhLAorICAvKiAnYScsICdiJywgJ2MnLCAnZCcsICdlJywg
J2YnLCAnZycsICdoJywgJ2knLCAnaicsICdrJywgJ2wnLCAnbScsICovCisgICAgMHg2MSwweDYy
LDB4NjMsMHg2NCwweDY1LDB4NjYsMHg2NywweDY4LDB4NjksMHg2YSwweDZiLDB4NmMsMHg2ZCwK
KyAgLyogJ24nLCAnbycsICdwJywgJ3EnLCAncicsICdzJywgJ3QnLCAndScsICd2JywgJ3cnLCAn
eCcsICd5JywgJ3onLCAqLworICAgIDB4NmUsMHg2ZiwweDcwLDB4NzEsMHg3MiwweDczLDB4NzQs
MHg3NSwweDc2LDB4NzcsMHg3OCwweDc5LDB4N2EsCisgIC8qICcwJywgJzEnLCAnMicsICczJywg
JzQnLCAnNScsICc2JywgJzcnLCAnOCcsICc5JywgJysnLCAnLCcsICdcMCcgKi8KKyAgICAweDMw
LDB4MzEsMHgzMiwweDMzLDB4MzQsMHgzNSwweDM2LDB4MzcsMHgzOCwweDM5LDB4MmIsMHgyYyww
eDAwCisgfTsKKyAKKyBzdGF0aWMgaW50IG11dGY3X2VuY29kZSh1aW50IGMsIGNvbnZlcnRfc3Rh
dGUgKmZpbHRlciwgY29udmVydGVkX291dF9jYl90IG91dF9jYiwgdm9pZCAqb3V0X2NiX3BhcmFt
KQorIHsKKyAgICAgaW50IG4sIHM7CisgCisgICAgIG4gPSAwOworICAgICBpZiAoYyA9PSAweDI2
KSB7CisgCW4gPSAxOworICAgICB9IGVsc2UgaWYgKChjID49IDB4MjAgJiYgYyA8PSAweDdlKSB8
fCBjID09IDApIHsKKyAJbiA9IDI7CisgICAgIH0gZWxzZSBpZiAoYyA+PSAwICYmIGMgPCBVQ1My
TUFYKSB7CisgCTsKKyAgICAgfSBlbHNlIGlmIChjID49IFNVUE1JTiAmJiBjIDwgU1VQTUFYKSB7
CisgCXMgPSAoKGMgPj4gMTApIC0gMHg0MCkgfCAweGQ4MDA7CisgCUNLKG91dF9jYihzLCBvdXRf
Y2JfcGFyYW0pKTsKKyAJcyA9IChjICYgMHgzZmYpIHwgMHhkYzAwOworIAlDSyhvdXRfY2Iocywg
b3V0X2NiX3BhcmFtKSk7CisgCXJldHVybiAwOworICAgICB9IGVsc2UgeworIAlyZXR1cm4gLTE7
CisgICAgIH0KKyAKKyAgICAgc3dpdGNoIChmaWx0ZXItPnN0YXR1cykgeworICAgICBjYXNlIDA6
CisgCWlmIChuICE9IDApIHsJLyogZGlyZWN0bHkgZW5jb2RlIGNoYXJhY3RlcnMgKi8KKyAJICAg
IENLKG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIGlmIChuID09IDEpIHsKKyAJCUNL
KG91dF9jYigweDJkLCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworIAkgICAgfQorIAl9IGVs
c2UgewkvKiBNb2RpZmllZCBCYXNlNjQgKi8KKyAJICAgIENLKG91dF9jYigweDI2LCBvdXRfY2Jf
cGFyYW0pKTsJCS8qICcmJyAqLworIAkgICAgZmlsdGVyLT5zdGF0dXMgPSAxOworIAkgICAgZmls
dGVyLT5jYWNoZSA9IGM7CisgCX0KKyAJYnJlYWs7CisgCisgCS8qIGVuY29kZSBNb2RpZmllZCBC
YXNlNjQgKi8KKyAgICAgY2FzZSAxOgorIAlzID0gZmlsdGVyLT5jYWNoZTsKKyAJQ0sob3V0X2Ni
KHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA+PiAxMCkgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7
CisgCUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKHMgPj4gNCkgJiAweDNmXSwgb3V0
X2NiX3BhcmFtKSk7CisgCWlmIChuICE9IDApIHsKKyAJICAgIENLKG91dF9jYih1dGY3aW1hcF9i
YXNlNjRfdGFibGVbKHMgPDwgMikgJiAweDNjXSwgb3V0X2NiX3BhcmFtKSk7CisgCSAgICBDSyhv
dXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScgKi8KKyAJICAgIENLKG91dF9jYihj
LCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIGlmIChuID09IDEpIHsKKyAJCUNLKG91dF9jYigweDJk
LCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworIAkgICAgfQorIAkgICAgZmlsdGVyLT5zdGF0
dXMgPSAwOworIAl9IGVsc2UgeworIAkgICAgZmlsdGVyLT5zdGF0dXMgPSAyOworIAkgICAgZmls
dGVyLT5jYWNoZSA9ICgocyAmIDB4ZikgPDwgMTYpIHwgYzsKKyAJfQorIAlicmVhazsKKyAKKyAg
ICAgY2FzZSAyOgorIAlzID0gZmlsdGVyLT5jYWNoZTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jh
c2U2NF90YWJsZVsocyA+PiAxNCkgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9j
Yih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKHMgPj4gOCkgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7
CisgCUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKHMgPj4gMikgJiAweDNmXSwgb3V0
X2NiX3BhcmFtKSk7CisgCWlmIChuICE9IDApIHsKKyAJICAgIENLKG91dF9jYih1dGY3aW1hcF9i
YXNlNjRfdGFibGVbKHMgPDwgNCkgJiAweDMwXSwgb3V0X2NiX3BhcmFtKSk7CisgCSAgICBDSyhv
dXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScgKi8KKyAJICAgIENLKG91dF9jYihj
LCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIGlmIChuID09IDEpIHsKKyAJCUNLKG91dF9jYigweDJk
LCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworIAkgICAgfQorIAkgICAgZmlsdGVyLT5zdGF0
dXMgPSAwOworIAl9IGVsc2UgeworIAkgICAgZmlsdGVyLT5zdGF0dXMgPSAzOworIAkgICAgZmls
dGVyLT5jYWNoZSA9ICgocyAmIDB4MykgPDwgMTYpIHwgYzsKKyAJfQorIAlicmVhazsKKyAKKyAg
ICAgY2FzZSAzOgorIAlzID0gZmlsdGVyLT5jYWNoZTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jh
c2U2NF90YWJsZVsocyA+PiAxMikgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9j
Yih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKHMgPj4gNikgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7
CisgCUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbcyAmIDB4M2ZdLCBvdXRfY2JfcGFy
YW0pKTsKKyAJaWYgKG4gIT0gMCkgeworIAkgICAgQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJh
bSkpOwkJLyogJy0nICovCisgCSAgICBDSyhvdXRfY2IoYywgb3V0X2NiX3BhcmFtKSk7CisgCSAg
ICBpZiAobiA9PSAxKSB7CisgCQlDSyhvdXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAn
LScgKi8KKyAJICAgIH0KKyAJICAgIGZpbHRlci0+c3RhdHVzID0gMDsKKyAJfSBlbHNlIHsKKyAJ
ICAgIGZpbHRlci0+c3RhdHVzID0gMTsKKyAJICAgIGZpbHRlci0+Y2FjaGUgPSBjOworIAl9Cisg
CWJyZWFrOworIAorICAgICBkZWZhdWx0OgorIAlmaWx0ZXItPnN0YXR1cyA9IDA7CisgCWJyZWFr
OworICAgICB9CisgCisgICAgIHJldHVybiAwOworIH0KKyAKKyBzdGF0aWMgaW50IG11dGY3X2Rl
Y29kZSh1aW50IGMsIGNvbnZlcnRfc3RhdGUgKmZpbHRlciwgY29udmVydGVkX291dF9jYl90IG91
dF9jYiwgdm9pZCAqb3V0X2NiX3BhcmFtKQorIHsKKyAgICAgaW50IHMsIG47CisgCisgICAgIG4g
PSAtMTsKKyAgICAgaWYgKGZpbHRlci0+c3RhdHVzICE9IDApIHsJCS8qIE1vZGlmaWVkIEJhc2U2
NCAqLworIAlpZiAoYyA+PSAweDQxICYmIGMgPD0gMHg1YSkgewkJLyogQSAtIFogKi8KKyAJICAg
IG4gPSBjIC0gNjU7CisgCX0gZWxzZSBpZiAoYyA+PSAweDYxICYmIGMgPD0gMHg3YSkgewkvKiBh
IC0geiAqLworIAkgICAgbiA9IGMgLSA3MTsKKyAJfSBlbHNlIGlmIChjID49IDB4MzAgJiYgYyA8
PSAweDM5KSB7CS8qIDAgLSA5ICovCisgCSAgICBuID0gYyArIDQ7CisgCX0gZWxzZSBpZiAoYyA9
PSAweDJiKSB7CQkJLyogJysnICovCisgCSAgICBuID0gNjI7CisgCX0gZWxzZSBpZiAoYyA9PSAw
eDJjKSB7CQkJLyogJywnICovCisgCSAgICBuID0gNjM7CisgCX0KKyAJaWYgKG4gPCAwIHx8IG4g
PiA2MykgeworIAkgICAgaWYgKGMgPT0gMHgyZCkgeworIAkJaWYgKGZpbHRlci0+c3RhdHVzID09
IDEpIHsJCS8qICImLSIgLT4gIiYiICovCisgCQkgICAgQ0sob3V0X2NiKDB4MjYsIG91dF9jYl9w
YXJhbSkpOworIAkJfQorIAkgICAgfSBlbHNlIGlmIChjID49IDAgJiYgYyA8IDB4ODApIHsJLyog
QVNDSUkgZXhjbHVkZSAnLScgKi8KKyAJCUNLKG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKyAJ
ICAgIH0gZWxzZSB7CQkvKiBpbGxlZ2FsIGNoYXJhY3RlciAqLworIAkJcyA9IGMgJiBNQVNLOwor
IAkJcyB8PSBUSFJPVUdIOworIAkJQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJhbSkpOworIAkgICAg
fQorIAkgICAgZmlsdGVyLT5jYWNoZSA9IDA7CisgCSAgICBmaWx0ZXItPnN0YXR1cyA9IDA7Cisg
CSAgICByZXR1cm4gMDsKKyAJfQorICAgICB9CisgCisgICAgIHN3aXRjaCAoZmlsdGVyLT5zdGF0
dXMpIHsKKyAJLyogZGlyZWN0bHkgZW5jb2RlZCBjaGFyYWN0ZXJzICovCisgICAgIGNhc2UgMDoK
KyAJaWYgKGMgPT0gMHgyNikgewkvKiAnJicgIHNoaWZ0IGNoYXJhY3RlciAqLworIAkgICAgZmls
dGVyLT5zdGF0dXMrKzsKKyAJfSBlbHNlIGlmIChjID49IDAgJiYgYyA8IDB4ODApIHsJLyogQVND
SUkgKi8KKyAJICAgIENLKG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKyAJfSBlbHNlIHsJCS8q
IGlsbGVnYWwgY2hhcmFjdGVyICovCisgCSAgICBzID0gYyAmIE1BU0s7CisgCSAgICBzIHw9IFRI
Uk9VR0g7CisgCSAgICBDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisgCX0KKyAJYnJlYWs7
CisgCisgCS8qIGRlY29kZSBNb2RpZmllZCBCYXNlNjQgKi8KKyAgICAgY2FzZSAxOgorICAgICBj
YXNlIDI6CisgCWZpbHRlci0+Y2FjaGUgfD0gbiA8PCAxMDsKKyAJZmlsdGVyLT5zdGF0dXMgPSAz
OworIAlicmVhazsKKyAgICAgY2FzZSAzOgorIAlmaWx0ZXItPmNhY2hlIHw9IG4gPDwgNDsKKyAJ
ZmlsdGVyLT5zdGF0dXMgPSA0OworIAlicmVhazsKKyAgICAgY2FzZSA0OgorIAlzID0gKChuID4+
IDIpICYgMHhmKSB8IChmaWx0ZXItPmNhY2hlICYgMHhmZmZmKTsKKyAJbiA9IChuICYgMHgzKSA8
PCAxNDsKKyAJZmlsdGVyLT5zdGF0dXMgPSA1OworIAlpZiAocyA+PSAweGQ4MDAgJiYgcyA8IDB4
ZGMwMCkgeworIAkgICAgcyA9ICgoKHMgJiAweDNmZikgPDwgMTYpICsgMHg0MDAwMDApIHwgbjsK
KyAJICAgIGZpbHRlci0+Y2FjaGUgPSBzOworIAl9IGVsc2UgaWYgKHMgPj0gMHhkYzAwICYmIHMg
PCAweGUwMDApIHsKKyAJICAgIHMgJj0gMHgzZmY7CisgCSAgICBzIHw9IChmaWx0ZXItPmNhY2hl
ICYgMHhmZmYwMDAwKSA+PiA2OworIAkgICAgZmlsdGVyLT5jYWNoZSA9IG47CisgCSAgICBpZiAo
cyA+PSBTVVBNSU4gJiYgcyA8IFNVUE1BWCkgeworIAkJQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJh
bSkpOworIAkgICAgfSBlbHNlIHsJCS8qIGlsbGVnYWwgY2hhcmFjdGVyICovCisgCQlzICY9IE1B
U0s7CisgCQlzIHw9IFRIUk9VR0g7CisgCQlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7Cisg
CSAgICB9CisgCX0gZWxzZSB7CisgCSAgICBmaWx0ZXItPmNhY2hlID0gbjsKKyAJICAgIENLKG91
dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJfQorIAlicmVhazsKKyAKKyAgICAgY2FzZSA1Ogor
IAlmaWx0ZXItPmNhY2hlIHw9IG4gPDwgODsKKyAJZmlsdGVyLT5zdGF0dXMgPSA2OworIAlicmVh
azsKKyAgICAgY2FzZSA2OgorIAlmaWx0ZXItPmNhY2hlIHw9IG4gPDwgMjsKKyAJZmlsdGVyLT5z
dGF0dXMgPSA3OworIAlicmVhazsKKyAgICAgY2FzZSA3OgorIAlzID0gKChuID4+IDQpICYgMHgz
KSB8IChmaWx0ZXItPmNhY2hlICYgMHhmZmZmKTsKKyAJbiA9IChuICYgMHhmKSA8PCAxMjsKKyAJ
ZmlsdGVyLT5zdGF0dXMgPSA4OworIAlpZiAocyA+PSAweGQ4MDAgJiYgcyA8IDB4ZGMwMCkgewor
IAkgICAgcyA9ICgoKHMgJiAweDNmZikgPDwgMTYpICsgMHg0MDAwMDApIHwgbjsKKyAJICAgIGZp
bHRlci0+Y2FjaGUgPSBzOworIAl9IGVsc2UgaWYgKHMgPj0gMHhkYzAwICYmIHMgPCAweGUwMDAp
IHsKKyAJICAgIHMgJj0gMHgzZmY7CisgCSAgICBzIHw9IChmaWx0ZXItPmNhY2hlICYgMHhmZmYw
MDAwKSA+PiA2OworIAkgICAgZmlsdGVyLT5jYWNoZSA9IG47CisgCSAgICBpZiAocyA+PSBTVVBN
SU4gJiYgcyA8IFNVUE1BWCkgeworIAkJQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJhbSkpOworIAkg
ICAgfSBlbHNlIHsJCS8qIGlsbGVnYWwgY2hhcmFjdGVyICovCisgCQlzICY9IE1BU0s7CisgCQlz
IHw9IFRIUk9VR0g7CisgCQlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisgCSAgICB9Cisg
CX0gZWxzZSB7CisgCSAgICBmaWx0ZXItPmNhY2hlID0gbjsKKyAJICAgIENLKG91dF9jYihzLCBv
dXRfY2JfcGFyYW0pKTsKKyAJfQorIAlicmVhazsKKyAKKyAgICAgY2FzZSA4OgorIAlmaWx0ZXIt
PmNhY2hlIHw9IG4gPDwgNjsKKyAJZmlsdGVyLT5zdGF0dXMgPSA5OworIAlicmVhazsKKyAgICAg
Y2FzZSA5OgorIAlzID0gbiB8IChmaWx0ZXItPmNhY2hlICYgMHhmZmZmKTsKKyAJZmlsdGVyLT5z
dGF0dXMgPSAyOworIAlpZiAocyA+PSAweGQ4MDAgJiYgcyA8IDB4ZGMwMCkgeworIAkgICAgcyA9
ICgoKHMgJiAweDNmZikgPDwgMTYpICsgMHg0MDAwMDApOworIAkgICAgZmlsdGVyLT5jYWNoZSA9
IHM7CisgCX0gZWxzZSBpZiAocyA+PSAweGRjMDAgJiYgcyA8IDB4ZTAwMCkgeworIAkgICAgcyAm
PSAweDNmZjsKKyAJICAgIHMgfD0gKGZpbHRlci0+Y2FjaGUgJiAweGZmZjAwMDApID4+IDY7Cisg
CSAgICBmaWx0ZXItPmNhY2hlID0gMDsKKyAJICAgIGlmIChzID49IFNVUE1JTiAmJiBzIDwgU1VQ
TUFYKSB7CisgCQlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisgCSAgICB9IGVsc2UgewkJ
LyogaWxsZWdhbCBjaGFyYWN0ZXIgKi8KKyAJCXMgJj0gTUFTSzsKKyAJCXMgfD0gVEhST1VHSDsK
KyAJCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKyAJICAgIH0KKyAJfSBlbHNlIHsKKyAJ
ICAgIGZpbHRlci0+Y2FjaGUgPSAwOworIAkgICAgQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJhbSkp
OworIAl9CisgCWJyZWFrOworIAorICAgICBkZWZhdWx0OgorIAlmaWx0ZXItPnN0YXR1cyA9IDA7
CisgCWJyZWFrOworICAgICB9CisgCisgICAgIHJldHVybiAwOworIH0KKyBzdGF0aWMgaW50IG11
dGY3X2VuY29kZV9mbHVzaChjb252ZXJ0X3N0YXRlICpmaWx0ZXIsIGNvbnZlcnRlZF9vdXRfY2Jf
dCBvdXRfY2IsIHZvaWQgKm91dF9jYl9wYXJhbSkKKyB7CisgICAgIGludCBzdGF0dXMsIGNhY2hl
OworIAorICAgICBzdGF0dXMgPSBmaWx0ZXItPnN0YXR1czsKKyAgICAgY2FjaGUgPSBmaWx0ZXIt
PmNhY2hlOworICAgICBmaWx0ZXItPnN0YXR1cyA9IDA7CisgICAgIGZpbHRlci0+Y2FjaGUgPSAw
OworICAgICAvKiBmbHVzaCBmcmFnbWVudHMgKi8KKyAgICAgc3dpdGNoIChzdGF0dXMpIHsKKyAg
ICAgY2FzZSAxOgorIAlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhjYWNoZSA+PiAx
MCkgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRf
dGFibGVbKGNhY2hlID4+IDQpICYgMHgzZl0sIG91dF9jYl9wYXJhbSkpOworIAlDSyhvdXRfY2Io
dXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhjYWNoZSA8PCAyKSAmIDB4M2NdLCBvdXRfY2JfcGFyYW0p
KTsKKyAJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJhbSkpOwkJLyogJy0nICovCisgCWJyZWFr
OworIAorICAgICBjYXNlIDI6CisgCUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKGNh
Y2hlID4+IDE0KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFw
X2Jhc2U2NF90YWJsZVsoY2FjaGUgPj4gOCkgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisgCUNL
KG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKGNhY2hlID4+IDIpICYgMHgzZl0sIG91dF9j
Yl9wYXJhbSkpOworIAlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhjYWNoZSA8PCA0
KSAmIDB4MzBdLCBvdXRfY2JfcGFyYW0pKTsKKyAJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJh
bSkpOwkJLyogJy0nICovCisgCWJyZWFrOworIAorICAgICBjYXNlIDM6CisgCUNLKG91dF9jYih1
dGY3aW1hcF9iYXNlNjRfdGFibGVbKGNhY2hlID4+IDEyKSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0p
KTsKKyAJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsoY2FjaGUgPj4gNikgJiAweDNm
XSwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbY2Fj
aGUgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisgCUNLKG91dF9jYigweDJkLCBvdXRfY2JfcGFy
YW0pKTsJCS8qICctJyAqLworIAlicmVhazsKKyAgICAgfQorICAgICByZXR1cm4gMDsKKyB9Cisg
CisgdHlwZWRlZiBzdHJ1Y3QgX2NvbnZlcnRfb3B0cyB7CisgICAgIGNvbnZlcnRfY2JfdCBlbmNv
ZGVfY2I7CisgICAgIGNvbnZlcnRfY2JfdCBkZWNvZGVfY2I7CisgICAgIGZsdXNoX2NiX3QgZmx1
c2hfZW5jb2RlOworICAgICBmbHVzaF9jYl90IGZsdXNoX2RlY29kZTsKKyB9IGNvbnZlcnRfb3B0
czsKKyAKKyB0eXBlZGVmIHN0cnVjdCBfcGFyYW1fY29udmVydCB7CisgICAgIGludCBsZW47Cisg
ICAgIGNoYXIgKm91dDsKKyAgICAgY29udmVydF9vcHRzICpvcHRzOworICAgICBjb252ZXJ0X3N0
YXRlIGZpbHRlcjsKKyB9IHBhcmFtX2NvbnZlcnQ7CisgCisgLyoganVzdCBhIGNvdW50ZXIgKi8K
KyBzdGF0aWMgaW50IGNvdW50X2xlbl9jYih1aW50IGMsIHZvaWQgKnBhcmFtKQorIHsKKyAgICAg
KCooaW50ICopcGFyYW0pKys7CisgICAgIHJldHVybiAwOworIH0KKyAKKyBzdGF0aWMgaW50IHdy
aXRlX291dF9jYih1aW50IGMsIHZvaWQgKnBhcmFtKQorIHsKKyAgICAgcGFyYW1fY29udmVydCAq
cl9wYXJhbT0ocGFyYW1fY29udmVydCAqKXBhcmFtOworIAorICAgICByX3BhcmFtLT5vdXRbcl9w
YXJhbS0+bGVuXT0oY2hhciljOworICAgICByX3BhcmFtLT5sZW4rKzsKKyAgICAgcmV0dXJuIDA7
CisgfQorIAorIC8qICdjJyBpcyB3Y2hhci4gd2UgbmVlZCB0byBjYWxsIGVuY29kZV9jYiBmdW5j
dGlvbiB0byBjYWxjdWxhdGUgdGhlCisgICAgb3V0cHV0IGJ1ZmZlciBzaXplICovCisgc3RhdGlj
IGludCBnZXRfbGVuX2NiKHVpbnQgYywgdm9pZCAqcGFyYW0pCisgeworICAgICByZXR1cm4gKChw
YXJhbV9jb252ZXJ0ICopcGFyYW0pLT5vcHRzLT5lbmNvZGVfY2IoYywgJigocGFyYW1fY29udmVy
dCAqKXBhcmFtKS0+ZmlsdGVyLCBjb3VudF9sZW5fY2IsICh2b2lkICopJigocGFyYW1fY29udmVy
dCAqKXBhcmFtKS0+bGVuKTsKKyB9CisgCisgc3RhdGljIGludCByZWFsX291dF9jYih1aW50IGMs
IHZvaWQgKnBhcmFtKQorIHsKKyAgICAgcmV0dXJuICgocGFyYW1fY29udmVydCAqKXBhcmFtKS0+
b3B0cy0+ZW5jb2RlX2NiKGMsICYoKHBhcmFtX2NvbnZlcnQgKilwYXJhbSktPmZpbHRlciwgd3Jp
dGVfb3V0X2NiLCBwYXJhbSk7CisgfQorIAorIHN0YXRpYyBjaGFyICpkb19jb252ZXJzaW9uKGNv
bnZlcnRfb3B0cyAqb3B0cywgY2hhciAqaW4sIGludCBpbmxlbiwgaW50ICpvdXRsZW4pCisgewor
ICAgICBwYXJhbV9jb252ZXJ0IHBhcmFtOworICAgICBjb252ZXJ0X3N0YXRlIGZpbHRlcjsKKyAg
ICAgaW50IGk7CisgCisgICAgIHBhcmFtLmxlbiA9IDA7CisgICAgIHBhcmFtLm9wdHMgPSBvcHRz
OworICAgICBiemVybygmcGFyYW0uZmlsdGVyLCBzaXplb2YocGFyYW0uZmlsdGVyKSk7CisgICAg
IGJ6ZXJvKCZmaWx0ZXIsIHNpemVvZihmaWx0ZXIpKTsKKyAKKyAgICAgZm9yKGk9MDsgaTxpbmxl
bjsgaSsrKQorIAlpZihvcHRzLT5kZWNvZGVfY2IoKHVpbnQpKHVuc2lnbmVkIGNoYXIpaW5baV0s
ICZmaWx0ZXIsIGdldF9sZW5fY2IsICh2b2lkICopJnBhcmFtKSkKKyAJICAgIHJldHVybiBOVUxM
OworIAorICAgICBpZihvcHRzLT5mbHVzaF9kZWNvZGUpCisgCWlmKG9wdHMtPmZsdXNoX2RlY29k
ZSgmZmlsdGVyLCBnZXRfbGVuX2NiLCAodm9pZCAqKSZwYXJhbSkpCisgCSAgICByZXR1cm4gTlVM
TDsKKyAgICAgaWYob3B0cy0+Zmx1c2hfZW5jb2RlKQorIAlpZihvcHRzLT5mbHVzaF9lbmNvZGUo
JnBhcmFtLmZpbHRlciwgY291bnRfbGVuX2NiLCAodm9pZCAqKSZwYXJhbS5sZW4pKQorIAkgICAg
cmV0dXJuIE5VTEw7CisgCisgICAgIGlmKCEocGFyYW0ub3V0PShjaGFyICopbWFsbG9jKHBhcmFt
LmxlbikpKQorIAlyZXR1cm4gTlVMTDsKKyAgICAgcGFyYW0ubGVuPTA7CisgICAgIGJ6ZXJvKCZw
YXJhbS5maWx0ZXIsIHNpemVvZihwYXJhbS5maWx0ZXIpKTsKKyAgICAgYnplcm8oJmZpbHRlciwg
c2l6ZW9mKGZpbHRlcikpOworICAgICAKKyAgICAgZm9yKGk9MDsgaTxpbmxlbjsgaSsrKQorIAlp
ZihvcHRzLT5kZWNvZGVfY2IoKHVpbnQpKHVuc2lnbmVkIGNoYXIpaW5baV0sICZmaWx0ZXIsIHJl
YWxfb3V0X2NiLCAodm9pZCAqKSZwYXJhbSkpIHsKKyAJICAgIGZyZWUocGFyYW0ub3V0KTsKKyAJ
ICAgIHJldHVybiBOVUxMOworIAl9CisgCisgICAgIGlmKG9wdHMtPmZsdXNoX2RlY29kZSkKKyAJ
aWYob3B0cy0+Zmx1c2hfZGVjb2RlKCZmaWx0ZXIsIHJlYWxfb3V0X2NiLCAodm9pZCAqKSZwYXJh
bSkpIHsKKyAJICAgIGZyZWUocGFyYW0ub3V0KTsKKyAJICAgIHJldHVybiBOVUxMOworIAl9Cisg
ICAgIGlmKG9wdHMtPmZsdXNoX2VuY29kZSkKKyAJaWYob3B0cy0+Zmx1c2hfZW5jb2RlKCZwYXJh
bS5maWx0ZXIsIHdyaXRlX291dF9jYiwgKHZvaWQgKikmcGFyYW0ubGVuKSkgeworIAkgICAgZnJl
ZShwYXJhbS5vdXQpOworIAkgICAgcmV0dXJuIE5VTEw7CisgCX0KKyAKKyAgICAgKm91dGxlbiA9
IHBhcmFtLmxlbjsKKyAgICAgcmV0dXJuIHBhcmFtLm91dDsKKyB9CisgCisgZXh0ZXJuIGNoYXIg
KnV0ZjhfdG9fbXV0ZjcoY2hhciAqaW4sIGludCBpbmxlbiwgaW50ICpvdXRsZW4pCisgeworICAg
ICBjb252ZXJ0X29wdHMgb3B0czsKKyAKKyAgICAgb3B0cy5lbmNvZGVfY2IgPSBtdXRmN19lbmNv
ZGU7CisgICAgIG9wdHMuZGVjb2RlX2NiID0gdXRmOF9kZWNvZGU7CisgICAgIG9wdHMuZmx1c2hf
ZW5jb2RlID0gbXV0ZjdfZW5jb2RlX2ZsdXNoOworICAgICBvcHRzLmZsdXNoX2RlY29kZSA9IE5V
TEw7CisgCisgICAgIHJldHVybiBkb19jb252ZXJzaW9uKCZvcHRzLCBpbiwgaW5sZW4sIG91dGxl
bik7CisgfQorIAorIGV4dGVybiBjaGFyICptdXRmN190b191dGY4KGNoYXIgKmluLCBpbnQgaW5s
ZW4sIGludCAqb3V0bGVuKQorIHsKKyAgICAgY29udmVydF9vcHRzIG9wdHM7CisgCisgICAgIG9w
dHMuZW5jb2RlX2NiID0gdXRmOF9lbmNvZGU7CisgICAgIG9wdHMuZGVjb2RlX2NiID0gbXV0Zjdf
ZGVjb2RlOworICAgICBvcHRzLmZsdXNoX2VuY29kZSA9IE5VTEw7CisgICAgIG9wdHMuZmx1c2hf
ZGVjb2RlID0gTlVMTDsKKyAKKyAgICAgcmV0dXJuIGRvX2NvbnZlcnNpb24oJm9wdHMsIGluLCBp
bmxlbiwgb3V0bGVuKTsKKyB9CmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1pbWFwZC0yLjIuMTIub2xk
L2ltYXAvY2hhcnNldF9jb252ZXJ0LmggY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvY2hhcnNldF9j
b252ZXJ0LmgKKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9jaGFyc2V0X2NvbnZlcnQu
aAkxOTcwLTAxLTAxIDAzOjAwOjAwICswMzAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9j
aGFyc2V0X2NvbnZlcnQuaAkyMDA1LTExLTIyIDE4OjU4OjMxICswMzAwCioqKioqKioqKioqKioq
KgoqKiogMCAqKioqCi0tLSAxLDcgLS0tLQorICNpZm5kZWYgX0NIQVJTRVRfQ09OVkVSVF9ICisg
I2RlZmluZSBfQ0hBUlNFVF9DT05WRVJUX0gKKyAKKyBleHRlcm4gY2hhciAqdXRmOF90b19tdXRm
NyhjaGFyICppbiwgaW50IGlubGVuLCBpbnQgKm91dGxlbik7CisgZXh0ZXJuIGNoYXIgKm11dGY3
X3RvX3V0ZjgoY2hhciAqaW4sIGludCBpbmxlbiwgaW50ICpvdXRsZW4pOworIAorICNlbmRpZiAv
KiBfQ0hBUlNFVF9DT05WRVJUX0ggKi8KZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4x
Mi5vbGQvaW1hcC9pZGxlX2lkbGVkLmMgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvaWRsZV9pZGxl
ZC5jCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvaWRsZV9pZGxlZC5jCTIwMDMtMTAt
MjMgMDA6MDU6MTEgKzA0MDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2lkbGVfaWRsZWQu
YwkyMDA1LTExLTIyIDE4OjU3OjUyICswMzAwCioqKioqKioqKioqKioqKgoqKiogMjEwLDIxNiAq
KioqCiAgICAgIC8qIHNlbmQgKi8KICAgICAgaWYgKHNlbmR0byhub3RpZnlfc29jaywgKHZvaWQg
KikgJmlkbGVkYXRhLAogIAkgICAgICAgSURMRURBVEFfQkFTRV9TSVpFK3N0cmxlbihpZGxlZGF0
YS5tYm94bmFtZSkrMSwgLyogMSBmb3IgTlVMTCAqLwohIAkgICAgICAgMCwgKHN0cnVjdCBzb2Nr
YWRkciAqKSAmaWRsZV9yZW1vdGUsIGlkbGVfcmVtb3RlX2xlbikgPT0gLTEpIHsKICAgICAgICBz
eXNsb2coTE9HX0VSUiwgImVycm9yIHNlbmRpbmcgdG8gaWRsZWQ6ICV4IiwgbXNnKTsKICAgICAg
ICByZXR1cm4gMDsKICAgICAgfQotLS0gMjEwLDIxNiAtLS0tCiAgICAgIC8qIHNlbmQgKi8KICAg
ICAgaWYgKHNlbmR0byhub3RpZnlfc29jaywgKHZvaWQgKikgJmlkbGVkYXRhLAogIAkgICAgICAg
SURMRURBVEFfQkFTRV9TSVpFK3N0cmxlbihpZGxlZGF0YS5tYm94bmFtZSkrMSwgLyogMSBmb3Ig
TlVMTCAqLwohIAkgICAgICAgMCwgKHN0cnVjdCBzb2NrYWRkciAqKSAmaWRsZV9yZW1vdGUsIGlk
bGVfcmVtb3RlX2xlbikgPT0gKHNzaXplX3QpLTEpIHsKICAgICAgICBzeXNsb2coTE9HX0VSUiwg
ImVycm9yIHNlbmRpbmcgdG8gaWRsZWQ6ICV4IiwgbXNnKTsKICAgICAgICByZXR1cm4gMDsKICAg
ICAgfQpkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL2ltYXBkLmMg
Y3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvaW1hcGQuYwoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9s
ZC9pbWFwL2ltYXBkLmMJMjAwNS0xMS0wNyAxODoyNDo0MyArMDMwMAotLS0gY3lydXMtaW1hcGQt
Mi4yLjEyL2ltYXAvaW1hcGQuYwkyMDA1LTExLTIyIDE4OjU3OjUzICswMzAwCioqKioqKioqKioq
KioqKgoqKiogODAsODUgKioqKgotLS0gODAsODggLS0tLQogICNpbmNsdWRlICJtYWlsYm94Lmgi
CiAgI2luY2x1ZGUgIm1lc3NhZ2UuaCIKICAjaW5jbHVkZSAibWJveG5hbWUuaCIKKyAjaWZkZWYg
RU5BQkxFX0NPTlZFUlRfVVNFUklECisgI2luY2x1ZGUgImxkYXBkLmgiCisgI2VuZGlmCiAgI2lu
Y2x1ZGUgIm1ib3hsaXN0LmgiCiAgI2luY2x1ZGUgIm1iZHVtcC5oIgogICNpbmNsdWRlICJta2dt
dGltZS5oIgoqKioqKioqKioqKioqKioKKioqIDExMiwxMTcgKioqKgotLS0gMTE1LDEyNCAtLS0t
CiAgc3RhdGljIGNoYXIgaW1hcGRfY2xpZW50aG9zdFtOSV9NQVhIT1NUKjIrMV0gPSAiW2xvY2Fs
XSI7CiAgc3RhdGljIGludCBpbWFwZF9sb2dmZCA9IC0xOwogIGNoYXIgKmltYXBkX3VzZXJpZDsK
KyAjaWZkZWYgRU5BQkxFX0NPTlZFUlRfVVNFUklECisgaW50IGltYXBkX2NvbnZlcnR1c2VyaWQ9
MDsKKyBpbnQgaW1hcGRfbm9uY29udmVydGVkdXNlcmlkX2FsbG93ZWQ9MDsKKyAjZW5kaWYKICBz
dGF0aWMgY2hhciAqaW1hcGRfbWFnaWNwbHVzID0gTlVMTDsKICBzdHJ1Y3QgYXV0aF9zdGF0ZSAq
aW1hcGRfYXV0aHN0YXRlID0gMDsKICBzdGF0aWMgaW50IGltYXBkX3VzZXJpc2FkbWluID0gMDsK
KioqKioqKioqKioqKioqCioqKiA0NzYsNDgxICoqKioKLS0tIDQ4Myw0OTMgLS0tLQogICAgICB9
CiAgI2VuZGlmCiAgCisgI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICAgICBpZihpbWFw
ZF9jb252ZXJ0dXNlcmlkKQorIAltYm94bmFtZV9jbGVhbnVwKCk7CisgI2VuZGlmIC8qIEVOQUJM
RV9DT05WRVJUX1VTRVJJRCAqLworIAogICAgICBjeXJ1c19yZXNldF9zdGRpbygpOyAKICAKICAg
ICAgc3RyY3B5KGltYXBkX2NsaWVudGhvc3QsICJbbG9jYWxdIik7CioqKioqKioqKioqKioqKgoq
KiogNTUyLDU1NyAqKioqCi0tLSA1NjQsNTc0IC0tLS0KICAJCQkJICAgMCwgJy4nLCAwKSkKICAJ
ZmF0YWwoImNhbm5vdCBpbml0aWFsaXplIHRoZSBpbnRlcm5hbCBuYW1lc3BhY2UiLCBFQ19URU1Q
RkFJTCk7CiAgCisgI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICAgICBpZihjb252ZXJ0
dXNlcmlkX2luaXQoKSkKKyAgICAgICAgZmF0YWwoImNvbnZlcnR1c2VyaWRfaW5pdCgpIGZhaWxl
ZCIsIEVDX0NPTkZJRyk7CisgI2VuZGlmIC8qIEVOQUJMRV9DT05WRVJUX1VTRVJJRCAqLworIAog
ICAgICAvKiBvcGVuIHRoZSBtYm94bGlzdCwgd2UnbGwgbmVlZCBpdCBmb3IgcmVhbCB3b3JrICov
CiAgICAgIG1ib3hsaXN0X2luaXQoMCk7CiAgICAgIG1ib3hsaXN0X29wZW4oTlVMTCk7CioqKioq
KioqKioqKioqKgoqKiogNTkzLDU5OCAqKioqCi0tLSA2MTAsNjMwIC0tLS0KICAgICAgcmV0dXJu
IDA7CiAgfQogIAorIHN0YXRpYyBpbnQgaW1hcGRfY29uZmlnX3JlcmVhZCgpCisgeworICNpZmRl
ZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKyAgICAgdGVtcGxhdGVfb3B0aW9uIG9wdHNbXT17Cisg
CXsodm9pZCAqKUlNQVBPUFRfQ09OVkVSVFVTRVJJRCwgVEVNUExBVEVPUFRfVFlQRV9LTk9XTk9Q
VH0sCisgCXsodm9pZCAqKUlNQVBPUFRfQ09OVkVSVFVTRVJJRF9FWEVNUFRTLCBURU1QTEFURU9Q
VF9UWVBFX0tOT1dOT1BUfSwKKyAJeyh2b2lkICopSU1BUE9QVF9DT05WRVJUVVNFUklEX0FMTE9X
X05PTkNPTlZFUlRFRCwgVEVNUExBVEVPUFRfVFlQRV9LTk9XTk9QVH0sCisgICAgIH07CisgCisg
ICAgIHJldHVybiBjb25maWdfcmVyZWFkKG9wdHMsIHNpemVvZihvcHRzKS9zaXplb2Yob3B0c1sw
XSkpOworICNlbHNlCisgICAgIHJldHVybiAwOworICNlbmRpZgorIH0KKyAKICAvKgogICAqIHJ1
biBmb3IgZWFjaCBhY2NlcHRlZCBjb25uZWN0aW9uCiAgICovCioqKioqKioqKioqKioqKgoqKiog
NjIzLDYyOCAqKioqCi0tLSA2NTUsNjYzIC0tLS0KICAgICAgaW1hcGRfaW4gPSBwcm90X25ldygw
LCAwKTsKICAgICAgaW1hcGRfb3V0ID0gcHJvdF9uZXcoMSwgMSk7CiAgCisgICAgIGlmKGltYXBk
X2NvbmZpZ19yZXJlYWQoKSkKKyAJZmF0YWwoIkNhbid0IHJlcmVhZCBjb25maWd1cmF0aW9uIGZp
bGVzIiwgRUNfQ09ORklHKTsKKyAKICAgICAgLyogRmluZCBvdXQgbmFtZSBvZiBjbGllbnQgaG9z
dCAqLwogICAgICBzYWxlbiA9IHNpemVvZihpbWFwZF9yZW1vdGVhZGRyKTsKICAgICAgaWYgKGdl
dHBlZXJuYW1lKDAsIChzdHJ1Y3Qgc29ja2FkZHIgKikmaW1hcGRfcmVtb3RlYWRkciwgJnNhbGVu
KSA9PSAwICYmCioqKioqKioqKioqKioqKgoqKiogNzA3LDcxMiAqKioqCi0tLSA3NDIsNzUwIC0t
LS0KICAvKiBDYWxsZWQgYnkgc2VydmljZSBBUEkgdG8gc2h1dCBkb3duIHRoZSBzZXJ2aWNlICov
CiAgdm9pZCBzZXJ2aWNlX2Fib3J0KGludCBlcnJvcikKICB7CisgI2lmZGVmIEVOQUJMRV9DT05W
RVJUX1VTRVJJRAorICAgICBjb252ZXJ0dXNlcmlkX2NsZWFudXAoKTsKKyAjZW5kaWYgLyogRU5B
QkxFX0NPTlZFUlRfVVNFUklEICovCiAgICAgIHNodXRfZG93bihlcnJvcik7CiAgfQogIAoqKioq
KioqKioqKioqKioKKioqIDE2OTgsMTcwMyAqKioqCi0tLSAxNzM2LDE3ODQgLS0tLQogICAgICB9
CiAgfQogIAorIHN0YXRpYyB2b2lkIGltYXBkX2xvZ2dlZHVzZXJfaW5pdCgpCisgeworICNpZmRl
ZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKyAgICAgY2hhciAqZXhlbXB0czsKKyAKKyAgICAgaWYo
IWltYXBkX25hbWVzcGFjZS5pc2FsdCkKKyAJcmV0dXJuOworICAgICAKKyAgICAgaW1hcGRfY29u
dmVydHVzZXJpZCA9IGNvbmZpZ19nZXRzd2l0Y2goSU1BUE9QVF9DT05WRVJUVVNFUklEKTsKKyAg
ICAgZXhlbXB0cyA9IChjaGFyICopY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VS
SURfRVhFTVBUUyk7CisgCisgICAgIGlmKGV4ZW1wdHMpIHsKKyAJLyogbG9vayBmb3IgdXNlcmlk
IGluc2lkZSAnZXhlbXB0cycgc3RyaW5nICovCisgCWNoYXIgKnA9ZXhlbXB0czsKKyAJY2hhciAq
bjsKKyAJaW50IHVzZXJpZF9sZW49c3RybGVuKGltYXBkX3VzZXJpZCk7CisgCisgCWRvIHsKKyAJ
ICAgIGZvcig7ICpwPT0nICc7IHArKyk7CisgCSAgICBpZigqcCkgeworIAkJaW50IHJlczsKKyAJ
CWludCBjX2xlbjsKKyAKKyAJCW49c3RyY2hyKHAsICcgJyk7CisgCQkKKyAJCWNfbGVuID0gbiA/
IChuLXApOiBzdHJsZW4ocCk7CisgCisgCQlpZihjX2xlbj09dXNlcmlkX2xlbiAmJiAhbWVtY21w
KGltYXBkX3VzZXJpZCwgcCwgdXNlcmlkX2xlbikpIHsKKyAJCSAgICAvKiB1c2VyaWQgaGFzIGJl
ZW4gZm91bmQhIHN3aXRjaCBjb252ZXJ0dXNlcmlkCisgCQkgICAgICAgb3B0aW9uICovCisgCQkg
ICAgaW1hcGRfY29udmVydHVzZXJpZCA9ICFpbWFwZF9jb252ZXJ0dXNlcmlkOworIAkJICAgIGJy
ZWFrOworIAkJfQorIAorIAkJcD1uOworIAkgICAgfQorIAl9IHdoaWxlKHApOworICAgICB9Cisg
ICAgIGlmKGltYXBkX2NvbnZlcnR1c2VyaWQpCisgCWltYXBkX25vbmNvbnZlcnRlZHVzZXJpZF9h
bGxvd2VkID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0NPTlZFUlRVU0VSSURfQUxMT1dfTk9O
Q09OVkVSVEVEKTsKKyAjZW5kaWYKKyB9CisgCiAgc3RhdGljIHZvaWQgdXNlcmlkX3RvaW50ZXJu
YWwoc3RydWN0IG5hbWVzcGFjZSAqbmFtZXNwYWNlLCBjaGFyICp1c2VyaWQpCiAgewogICAgICBj
aGFyIGhpZXJzZXBfb3JpZyA9IG5hbWVzcGFjZS0+aGllcl9zZXA7CioqKioqKioqKioqKioqKgoq
KiogMTg5NywxOTAyICoqKioKLS0tIDE5NzgsMTk4NCAtLS0tCiAgCiAgICAgIC8qIFRyYW5zbGF0
ZSBhbnkgc2VwYXJhdG9ycyBpbiB1c2VyaWQgKi8KICAgICAgdXNlcmlkX3RvaW50ZXJuYWwoJmlt
YXBkX25hbWVzcGFjZSwgaW1hcGRfdXNlcmlkKTsKKyAgICAgaW1hcGRfbG9nZ2VkdXNlcl9pbml0
KCk7CiAgCiAgICAgIGZyZWVidWYoJnBhc3N3ZGJ1Zik7CiAgCioqKioqKioqKioqKioqKgoqKiog
MjA0NCwyMDQ5ICoqKioKLS0tIDIxMjYsMjEzMiAtLS0tCiAgCiAgICAgIC8qIFRyYW5zbGF0ZSBh
bnkgc2VwYXJhdG9ycyBpbiB1c2VyaWQgKi8KICAgICAgdXNlcmlkX3RvaW50ZXJuYWwoJmltYXBk
X25hbWVzcGFjZSwgaW1hcGRfdXNlcmlkKTsKKyAgICAgaW1hcGRfbG9nZ2VkdXNlcl9pbml0KCk7
CiAgCiAgICAgIGF1dG9jcmVhdGVfaW5ib3goKTsKICAKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWlt
YXBkLTIuMi4xMi5vbGQvaW1hcC9pbWFwZC5oIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2ltYXBk
LmgKKioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9pbWFwZC5oCTIwMDUtMTEtMDcgMTg6
MDU6MzYgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2ltYXBkLmgJMjAwNS0xMS0y
MiAxODo1Nzo1MyArMDMwMAoqKioqKioqKioqKioqKioKKioqIDUxLDU2ICoqKioKLS0tIDUxLDYx
IC0tLS0KICAKICAvKiBVc2VyaWQgY2xpZW50IGhhcyBsb2dnZWQgaW4gYXMgKi8KICBleHRlcm4g
Y2hhciAqaW1hcGRfdXNlcmlkOworICNpZmRlZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKyAvKiBj
b252ZXJ0IG90aGVyIHVzZXJzIGlkcyBiZXR3ZWVuIG5hbWVzcGFjZXMgKHN3aXRjaCkgKi8KKyBp
bnQgaW1hcGRfY29udmVydHVzZXJpZDsKKyBpbnQgaW1hcGRfbm9uY29udmVydGVkdXNlcmlkX2Fs
bG93ZWQ7CisgI2VuZGlmIC8qIEVOQUJMRV9DT05WRVJUX1VTRVJJRCAqLwogIAogIC8qIEF1dGhv
cml6YXRpb24gc3RhdGUgZm9yIGxvZ2dlZCBpbiB1c2VyaWQgKi8KICBleHRlcm4gc3RydWN0IGF1
dGhfc3RhdGUgKmltYXBkX2F1dGhzdGF0ZTsKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIu
Mi4xMi5vbGQvaW1hcC9sZGFwZC5jIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2xkYXBkLmMKKioq
IGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9sZGFwZC5jCTE5NzAtMDEtMDEgMDM6MDA6MDAg
KzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2xkYXBkLmMJMjAwNS0xMS0yMyAxMzo1
NjoyOCArMDMwMAoqKioqKioqKioqKioqKioKKioqIDAgKioqKgotLS0gMSw0MDEgLS0tLQorICNp
ZmRlZiBIQVZFX0NPTkZJR19ICisgI2luY2x1ZGUgPGNvbmZpZy5oPgorICNlbmRpZgorIAorICNp
bmNsdWRlIDxzeXMvdHlwZXMuaD4KKyAjaW5jbHVkZSA8c3lzL3NvY2tldC5oPgorICNpbmNsdWRl
IDxuZXRpbmV0L2luLmg+CisgI2luY2x1ZGUgPGFycGEvaW5ldC5oPgorICNpbmNsdWRlIDxzeXMv
dW4uaD4KKyAjaW5jbHVkZSA8c3lzbG9nLmg+CisgI2luY2x1ZGUgPHN5cy9zdGF0Lmg+CisgI2lu
Y2x1ZGUgPHN0ZGlvLmg+CisgI2luY2x1ZGUgPHN0ZGxpYi5oPgorICNpbmNsdWRlIDxzdHJpbmcu
aD4KKyAjaW5jbHVkZSA8ZXJybm8uaD4KKyAjZGVmaW5lIF9HTlVfU09VUkNFCisgI2luY2x1ZGUg
PGdldG9wdC5oPgorICNpbmNsdWRlIDxhc3NlcnQuaD4KKyAjaWZkZWYgSEFWRV9VTklTVERfSAor
ICNpbmNsdWRlIDx1bmlzdGQuaD4KKyAjZW5kaWYKKyAjaW5jbHVkZSA8bGJlci5oPgorICNpbmNs
dWRlIDxsZGFwLmg+CisgCisgI2luY2x1ZGUgImxkYXBkLmgiCisgI2luY2x1ZGUgImdsb2JhbC5o
IgorICNpbmNsdWRlICJjaGFyc2V0X2NvbnZlcnQuaCIKKyAjaW5jbHVkZSAiZXhpdGNvZGVzLmgi
CisgCisgLyogZ2xvYmFsIHN0YXRlICovCisgY29uc3QgaW50IGNvbmZpZ19uZWVkX2RhdGEgPSAw
OworIAorIHN0YXRpYyBMREFQICpsZGFwX3Nlc3Npb249TlVMTDsKKyAKKyAjZGVmaW5lIExEQVBf
RklMVEVSX1RFTVBMQVRFU0laRSA3CisgCisgLyogb3B0aW9ucyB3aGljaCB3YXMgcmVhZCBmcm9t
IGNvbmZpZ3VyYXRpb24gZmlsZXMgKi8KKyBzdGF0aWMgY29uc3QgY2hhciAqbGRhcF9ob3N0Owor
IHN0YXRpYyBjb25zdCBjaGFyICpsZGFwZF9sb2NhbGhvc3Q7Cisgc3RhdGljIGludCBsZGFwX3Bv
cnQ7Cisgc3RhdGljIGNvbnN0IGNoYXIgKmxkYXBfdXNlcjsKKyBzdGF0aWMgY29uc3QgY2hhciAq
bGRhcF9wYXNzd29yZDsKKyBzdGF0aWMgY29uc3QgY2hhciAqbGRhcF9iYXNlOworIHN0YXRpYyBj
b25zdCBjaGFyICpsZGFwX2F0dHJfaW50OworIHN0YXRpYyBjb25zdCBjaGFyICpsZGFwX2F0dHJf
ZXh0OworIHN0YXRpYyBjaGFyICpsZGFwX2ZpbHRlcl9pbnQ7Cisgc3RhdGljIGNoYXIgKmxkYXBf
ZmlsdGVyX2V4dDsKKyBzdGF0aWMgaW50IGxkYXBfZmlsdGVyX2ludF9sZW47Cisgc3RhdGljIGlu
dCBsZGFwX2ZpbHRlcl9leHRfbGVuOworIAorIHN0YXRpYyBpbnQgbl9saXN0ZW5lcnM9MDsKKyAK
KyB2b2lkIGZhdGFsKGNvbnN0IGNoYXIgKm1zZywgaW50IGVycikKKyB7CisgICAgIHN5c2xvZyhM
T0dfQ1JJVCwgIiVzIiwgbXNnKTsKKyAgICAgc3lzbG9nKExPR19OT1RJQ0UsICJleGl0aW5nIik7
CisgCisgICAgIGN5cnVzX2RvbmUoKTsKKyAgICAgCisgICAgIGV4aXQoZXJyKTsKKyB9CisgCisg
dm9pZCBsZGFwX2NsZWFudXAoKQorIHsKKyAgICAgaWYobGRhcF9zZXNzaW9uKSB7CisgCWxkYXBf
dW5iaW5kX3MobGRhcF9zZXNzaW9uKTsKKyAJbGRhcF9zZXNzaW9uPU5VTEw7CisgICAgIH0KKyB9
CisgCisgLyogJ2RvbWFpbicgYW5kICdkb21haW5sZW4nIHZhcmlhYmxlcyBhcmUgaWdub3JlZCBu
b3cgKi8KKyBzdGF0aWMgaW50IGdldF9pZF9mcm9tX2xkYXAoY29uc3QgY2hhciAqaW4sIGludCBp
bl9sZW4sIGNvbnN0IGNoYXIgKmRvbWFpbiwgaW50IGRvbWFpbmxlbiwgY2hhciAqb3V0LCBpbnQg
Km91dF9sZW4sIGludCBpbnQyZXh0KQorIHsKKyAgICAgTERBUE1lc3NhZ2UgKmxkYXBfcmVzOwor
ICAgICBjaGFyICppbl9sZGFwOworICAgICBpbnQgaW5fbGRhcF9sZW47CisgICAgIGNvbnN0IGNo
YXIgKmxkYXBfZmlsdGVyX3RlbXBsYXRlOworICAgICBpbnQgbGRhcF9maWx0ZXJfdGVtcGxhdGVf
bGVuOworICAgICBjaGFyICpsZGFwX2ZpbHRlcjsKKyAgICAgY2hhciAqbGRhcF9hdHRyc1syXTsK
KyAKKyAgICAgLyogSW5wdXQgYnVmZmVyICdpbicgaXMgTVVURi03IHN0cmluZyBpbiBjYXNlIGlm
CisgICAgICAgIGV4dGVybmFsPT5pbnRlcm5hbC4gV2UgbmVlZCB0byBjb252ZXJ0IGl0IHRvIFVU
Ri04IGVuY29kaW5nCisgICAgICAgIGJlZm9yZSBxdWVyeWluZyB0byBMREFQLiAqLworICAgICBp
ZighaW50MmV4dCkgeworIAljaGFyICppbl90ZXN0OworIAlpbnQgaW5fdGVzdF9sZW47CisgCisg
CWlmKCEoaW5fbGRhcCA9IG11dGY3X3RvX3V0ZjgoKGNoYXIgKilpbiwgaW5fbGVuLCAmaW5fbGRh
cF9sZW4pKSkgeworIAkgICAgc3lzbG9nKExPR19ERUJVRywgIm11dGY3X3RvX3V0ZjgoKSBmYWls
ZWQuXG4iKTsKKyAJICAgIHJldHVybiAxOworIAl9CisgCisgCS8qIENoZWNrIGlmICdpbicgaXMg
YSB2YWxpZCBpbWFwLXV0Zi03IHN0cmluZy4gTm90ZSB0aGF0IHdlCisgCSAgIGFsc28gZGlzYWxs
b3cgaGVyZSB0byBoYXZlIG11bHRpcGxlIG11dGYtNyByZXByZXNlbnRhdGlvbnMKKyAJICAgb2Yg
YSBVbmljb2RlIHN0cmluZy4gKi8KKyAJaWYoIShpbl90ZXN0ID0gdXRmOF90b19tdXRmNyhpbl9s
ZGFwLCBpbl9sZGFwX2xlbiwgJmluX3Rlc3RfbGVuKSkpIHsKKyAJICAgIHN5c2xvZyhMT0dfREVC
VUcsICJ1dGY4X3RvX211dGY3KCkgZmFpbGVkIHdoaWxlIGNoZWNraW5nIHVzZXIgdW5wdXQuXG4i
KTsKKyAJICAgIGZyZWUoaW5fbGRhcCk7CisgCSAgICByZXR1cm4gMTsKKyAJfQorIAorIAlpZihp
bl90ZXN0X2xlbiE9aW5fbGVuIHx8IG1lbWNtcChpbiwgaW5fdGVzdCwgaW5fbGVuKSkgeworIAkg
ICAgc3lzbG9nKExPR19ERUJVRywgIkluY29ycmVjdCBNVVRGLTcgc3RyaW5nIHJlY2VpdmVkLlxu
Iik7CisgCSAgICBmcmVlKGluX2xkYXApOworIAkgICAgZnJlZShpbl90ZXN0KTsKKyAJICAgIHJl
dHVybiAxOworIAl9CisgCWZyZWUoaW5fdGVzdCk7CisgCisgCWxkYXBfZmlsdGVyX3RlbXBsYXRl
ID0gbGRhcF9maWx0ZXJfZXh0OworIAlsZGFwX2ZpbHRlcl90ZW1wbGF0ZV9sZW4gPSBsZGFwX2Zp
bHRlcl9leHRfbGVuOworIAlsZGFwX2F0dHJzWzBdID0gKGNoYXIgKilsZGFwX2F0dHJfaW50Owor
ICAgICB9CisgICAgIGVsc2UgeworIAlpbl9sZGFwID0gKGNoYXIgKilpbjsKKyAJaW5fbGRhcF9s
ZW4gPSBpbl9sZW47CisgCWxkYXBfZmlsdGVyX3RlbXBsYXRlID0gbGRhcF9maWx0ZXJfaW50Owor
IAlsZGFwX2ZpbHRlcl90ZW1wbGF0ZV9sZW4gPSBsZGFwX2ZpbHRlcl9pbnRfbGVuOworIAlsZGFw
X2F0dHJzWzBdID0gKGNoYXIgKilsZGFwX2F0dHJfZXh0OworICAgICB9CisgCisgICAgIC8qIGlm
IHRoZSBjb25uZWN0aW9uIHRvIExEQVAgc2VydmVyIGlzIG5vdCBlc3RhYmxpc2hlZCB0aGVuIHRy
eSB0bworICAgICAgICBlc3RhYmxpc2ggaXQgKi8KKyAgICAgaWYoIWxkYXBfc2Vzc2lvbikgewor
IAl2b2lkICpvcHR2YWw9TERBUF9PUFRfT047CisgCisgCWlmKCEobGRhcF9zZXNzaW9uID0gbGRh
cF9pbml0KGxkYXBfaG9zdCwgbGRhcF9wb3J0KSkgfHwKKyAJICAgbGRhcF9zZXRfb3B0aW9uKGxk
YXBfc2Vzc2lvbiwgTERBUF9PUFRfUkVTVEFSVCwgb3B0dmFsKT09LTEgfHwKKyAJICAgbGRhcF9z
aW1wbGVfYmluZF9zKGxkYXBfc2Vzc2lvbiwgbGRhcF91c2VyLCBsZGFwX3Bhc3N3b3JkKSE9TERB
UF9TVUNDRVNTKSB7CisgCSAgICBzeXNsb2coTE9HX0RFQlVHLCAiQ2Fubm90IGluaXRpYWxpemUg
TERBUCBjbGllbnQgbGlicmFyeSFcbiIpOworIAkgICAgbGRhcF9jbGVhbnVwKCk7CisgCSAgICBy
ZXR1cm4gMTsKKyAJfQorICAgICB9CisgCisgICAgIC8qIHRoZSBhbGxvY2F0ZWQgYnVmZmVyIGlz
IGJpZ2dlciB0aGFuIG5lZWRlZDogdGVtcGxhdGUgaGF2ZQorICAgICAgICAiJS4qcyIgc3RyaW5n
IHdpdGhpbiBpdCB3aGljaCBpcyByZXBsYWNlZCB0byBpbl9sZGFwIHN0cmluZyAqLworICAgICBs
ZGFwX2ZpbHRlciA9IChjaGFyICopbWFsbG9jKGxkYXBfZmlsdGVyX3RlbXBsYXRlX2xlbitpbl9s
ZGFwX2xlbik7CisgICAgIGlmKCFsZGFwX2ZpbHRlcikgeworIAlpZihpbl9sZGFwICE9IGluKQor
IAkgICAgZnJlZShpbl9sZGFwKTsKKyAJcmV0dXJuIDE7CisgICAgIH0KKyAgICAgc3ByaW50Zihs
ZGFwX2ZpbHRlciwgbGRhcF9maWx0ZXJfdGVtcGxhdGUsIGluX2xkYXBfbGVuLCBpbl9sZGFwKTsK
KyAKKyAgICAgbGRhcF9hdHRyc1sxXT1OVUxMOworIAorICAgICBpZihsZGFwX3NlYXJjaF9zKGxk
YXBfc2Vzc2lvbiwgbGRhcF9iYXNlLCBMREFQX1NDT1BFX1NVQlRSRUUsIGxkYXBfZmlsdGVyLCBs
ZGFwX2F0dHJzLCAwLCAmbGRhcF9yZXMpIT1MREFQX1NVQ0NFU1MpIHsKKyAJc3lzbG9nKExPR19E
RUJVRywgImxkYXBfc2VhcmNoX3MoKSBmYWlsZWQhXG4iKTsKKyAJaWYoaW5fbGRhcCAhPSBpbikK
KyAJICAgIGZyZWUoaW5fbGRhcCk7CisgCWZyZWUobGRhcF9maWx0ZXIpOworIAkvKiBkaXNjb25u
ZWN0IGZyb20gTERBUCBzZXJ2ZXIgKHdlIHdpbGwgdHJ5IHRvIGNvbm5lY3QgYWdhaW4KKyAJICAg
bGF0ZXIpICovCisgCWxkYXBfY2xlYW51cCgpOworIAlyZXR1cm4gMTsKKyAgICAgfQorICAgICBl
bHNlIHsKKyAJY2hhciAqKnZhbHM9TlVMTDsKKyAJY2hhciAqbm9uZW5jb2RlZF9vdXQ7CisgCWlu
dCBub25lbmNvZGVkX2xlbjsKKyAJaW50IGNvdW50X2VudHJpZXM7CisgCisgCWlmKGluX2xkYXAg
IT0gaW4pCisgCSAgICBmcmVlKGluX2xkYXApOworIAlmcmVlKGxkYXBfZmlsdGVyKTsKKyAKKyAJ
YXNzZXJ0KGxkYXBfcmVzKTsKKyAJLyogdGhlIGV4dGVybmFsIG5hbWUgaGFzbid0IGJlZW4gZm91
bmQgb3IgdGhlcmUgYXJlIG1vcmUgdGhhbgorIAkgICBvbmUgcmVzdWx0IHJlY29yZHMgKi8KKyAJ
aWYoKGNvdW50X2VudHJpZXM9bGRhcF9jb3VudF9lbnRyaWVzKGxkYXBfc2Vzc2lvbiwgbGRhcF9y
ZXMpKSE9MSkgeworIAkgICAgaWYoY291bnRfZW50cmllcykKKyAJCXN5c2xvZyhMT0dfREVCVUcs
ICJsZGFwX2NvdW50X2VudHJpZXMoKSByZXR1cm5lZCAlaS5cbiIsIGNvdW50X2VudHJpZXMpOwor
IAkgICAgbGRhcF9tc2dmcmVlKGxkYXBfcmVzKTsKKyAKKyAJICAgIHJldHVybiAxOworIAl9Cisg
CWVsc2UgeworIAkgICAgTERBUE1lc3NhZ2UgKmVudHJ5OworIAkgICAgY2hhciAqYXR0cjsKKyAK
KyAJICAgIGVudHJ5ID0gbGRhcF9maXJzdF9lbnRyeShsZGFwX3Nlc3Npb24sIGxkYXBfcmVzKTsK
KyAJICAgIGFzc2VydChlbnRyeSk7CisgCisgCSAgICB2YWxzID0gbGRhcF9nZXRfdmFsdWVzKGxk
YXBfc2Vzc2lvbiwgZW50cnksIGxkYXBfYXR0cnNbMF0pOworIAkgICAgYXNzZXJ0KHZhbHMgJiYg
bGRhcF9jb3VudF92YWx1ZXModmFscykpOworIAorIAkgICAgLyogc2F2ZSAndmFsc1swXScgYXMg
YW4gZXh0ZXJuYWwgbmFtZSBhbmQgJ2luJyBhcyBhbiBpbnRlcm5hbAorIAkgICAgICAgb25lICov
CisgCSAgICBub25lbmNvZGVkX291dCA9IHZhbHNbMF07CisgCSAgICBub25lbmNvZGVkX2xlbiA9
IHN0cmxlbihub25lbmNvZGVkX291dCk7CisgCX0KKyAKKyAJLyogJ25vbmVuY29kZWRfb3V0JyBi
dWZmZXIgaXMgYW4gVVRGLTggYnVmZmVyLiBXZSBuZWVkIHRvCisgCSAgIGNvbnZlcnQgaXQgdG8g
TVVURi03IGVuY29kaW5nIGluIGNhc2UgaWYgaXQgaXMgYW4gZXh0ZXJuYWwKKyAJICAgdXNlcmlk
LiAqLworIAlpZihpbnQyZXh0KSB7CisgCSAgICBjaGFyICp0ZW1wX291dCA9IHV0ZjhfdG9fbXV0
Zjcobm9uZW5jb2RlZF9vdXQsIG5vbmVuY29kZWRfbGVuLCBvdXRfbGVuKTsKKyAJICAgIGlmKCF0
ZW1wX291dCkgeworIAkJc3lzbG9nKExPR19ERUJVRywgInV0ZjhfdG9fbXV0ZjcoKSBmYWlsZWQu
XG4iKTsKKyAJCXJldHVybiAxOworIAkgICAgfQorIAkgICAgaWYoKm91dF9sZW4gPiBNQVhfTUFJ
TEJPWF9OQU1FKSB7CisgCQkqb3V0X2xlbiA9IDA7CisgCQlmcmVlKHRlbXBfb3V0KTsKKyAJCXJl
dHVybiAxOworIAkgICAgfQorIAkgICAgbWVtY3B5KG91dCwgdGVtcF9vdXQsICpvdXRfbGVuKTsK
KyAJICAgIGZyZWUodGVtcF9vdXQpOworIAl9CisgCWVsc2UgeworIAkgICAgbWVtY3B5KG91dCwg
bm9uZW5jb2RlZF9vdXQsIG5vbmVuY29kZWRfbGVuKTsKKyAJICAgICpvdXRfbGVuID0gbm9uZW5j
b2RlZF9sZW47CisgCX0KKyAKKyAJaWYodmFscykKKyAJICAgIGxkYXBfdmFsdWVfZnJlZSh2YWxz
KTsKKyAJaWYobGRhcF9yZXMpCisgCSAgICBsZGFwX21zZ2ZyZWUobGRhcF9yZXMpOworICAgICB9
CisgCisgICAgIHJldHVybiAwOworIH0KKyAKKyAvKiByZWFkIGNvbnZlcnR1c2VyaWQgTERBUCBj
b25maWd1cmF0aW9uIG9wdGlvbnMgZnJvbSBjb25maWd1cmF0aW9uCisgICAgZmlsZXMgKi8KKyBz
dGF0aWMgaW50IHJlYWRfbGRhcF9vcHRpb25zKCkKKyB7CisgICAgIGludCBsZGFwX2F0dHJfaW50
X2xlbjsKKyAgICAgaW50IGxkYXBfYXR0cl9leHRfbGVuOworIAorICAgICBsZGFwX2hvc3QgPSBj
b25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQ09OVkVSVFVTRVJJRF9MREFQX0hPU1QpOworICAgICBs
ZGFwZF9sb2NhbGhvc3QgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQ09OVkVSVFVTRVJJRF9M
T0NBTEhPU1QpOworIAorICAgICBsZGFwX3BvcnQgPSBjb25maWdfZ2V0aW50KElNQVBPUFRfQ09O
VkVSVFVTRVJJRF9MREFQX1BPUlQpOworICAgICBpZighbGRhcF9wb3J0KQorIAlsZGFwX3BvcnQ9
TERBUF9QT1JUOworIAorICAgICBsZGFwX3VzZXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRf
Q09OVkVSVFVTRVJJRF9MREFQX1VTRVIpOworICAgICBsZGFwX3Bhc3N3b3JkID0gY29uZmlnX2dl
dHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9QQVNTV09SRCk7CisgCisgICAgIGxk
YXBfYmFzZSA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9DT05WRVJUVVNFUklEX0xEQVBfQkFT
RSk7CisgCisgICAgIGxkYXBfYXR0cl9pbnQgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQ09O
VkVSVFVTRVJJRF9MREFQX0FUVFJfSU5UKTsKKyAgICAgaWYoIWxkYXBfYXR0cl9pbnQpIHsKKyAJ
c3lzbG9nKExPR19FUlIsICJjb252ZXJ0dXNlcmlkX2xkYXBfYXR0cl9pbnQgb3B0aW9uIGlzIG5v
dCBzZXRcbiIpOworIAlyZXR1cm4gMTsKKyAgICAgfQorICAgICBsZGFwX2F0dHJfZXh0ID0gY29u
ZmlnX2dldHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9BVFRSX0VYVCk7CisgICAg
IGlmKCFsZGFwX2F0dHJfZXh0KSB7CisgCXN5c2xvZyhMT0dfRVJSLCAiY29udmVydHVzZXJpZF9s
ZGFwX2F0dHJfZXh0IG9wdGlvbiBpcyBub3Qgc2V0XG4iKTsKKyAJcmV0dXJuIDE7CisgICAgIH0K
KyAgICAgbGRhcF9hdHRyX2ludF9sZW4gPSBzdHJsZW4obGRhcF9hdHRyX2ludCk7CisgICAgIGxk
YXBfZmlsdGVyX2ludF9sZW4gPSBsZGFwX2F0dHJfaW50X2xlbiArIExEQVBfRklMVEVSX1RFTVBM
QVRFU0laRTsKKyAgICAgbGRhcF9maWx0ZXJfaW50ID0gKGNoYXIgKiltYWxsb2MobGRhcF9maWx0
ZXJfaW50X2xlbik7CisgICAgIGlmKCFsZGFwX2ZpbHRlcl9pbnQpIHsKKyAJc3lzbG9nKExPR19F
UlIsICJtZW1vcnkgYWxsb2NhdGlvbiB3YXMgZmFpbGVkXG4iKTsKKyAJcmV0dXJuIDE7CisgICAg
IH0KKyAgICAgbGRhcF9hdHRyX2V4dF9sZW4gPSBzdHJsZW4obGRhcF9hdHRyX2V4dCk7CisgICAg
IGxkYXBfZmlsdGVyX2V4dF9sZW4gPSBsZGFwX2F0dHJfZXh0X2xlbiArIExEQVBfRklMVEVSX1RF
TVBMQVRFU0laRTsKKyAgICAgbGRhcF9maWx0ZXJfZXh0ID0gKGNoYXIgKiltYWxsb2MobGRhcF9m
aWx0ZXJfZXh0X2xlbik7CisgICAgIGlmKCFsZGFwX2ZpbHRlcl9leHQpIHsKKyAJc3lzbG9nKExP
R19FUlIsICJtZW1vcnkgYWxsb2NhdGlvbiB3YXMgZmFpbGVkXG4iKTsKKyAJZnJlZShsZGFwX2Zp
bHRlcl9pbnQpOworIAlyZXR1cm4gMTsKKyAgICAgfQorICAgICBzcHJpbnRmKGxkYXBfZmlsdGVy
X2ludCwiKCVzPSUlLipzKSIsbGRhcF9hdHRyX2ludCk7CisgICAgIHNwcmludGYobGRhcF9maWx0
ZXJfZXh0LCIoJXM9JSUuKnMpIixsZGFwX2F0dHJfZXh0KTsKKyAKKyAgICAgcmV0dXJuIDA7Cisg
fQorIAorIGludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikKKyB7CisgICAgIGludCBvcHQ7
CisgICAgIGludCBzLCBsZW47CisgICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBsb2NhbDsKKyAgICAg
bGRhcF9kYXRhX3QgbGRhcGRhdGE7CisgICAgIGxkYXBfZGF0YV9yZXN1bHRfdCBsZGFwZGF0YV9y
ZXN1bHQ7CisgICAgIHN0cnVjdCBzb2NrYWRkcl9pbiBmcm9tOworICAgICBzb2NrbGVuX3QgZnJv
bWxlbjsKKyAgICAgcGlkX3QgcGlkOworICAgICBpbnQgZmQ7CisgICAgIGNoYXIgKmFsdF9jb25m
aWcgPSBOVUxMOworICAgICBpbnQgY3VyY2hpbGQ7CisgICAgIGludCBwb3J0X251bTsKKyAgICAg
c3RydWN0IG9wdGlvbiBsb25nb3B0c1tdPXsKKyAJeyJwcmVmb3JrIiwgMSwgTlVMTCwgJ24nfSwK
KyAJe05VTEwsIDAsIE5VTEwsIDB9LAorICAgICB9OworIAorICAgICB3aGlsZSAoKG9wdCA9IGdl
dG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJDOm46IiwgbG9uZ29wdHMsIE5VTEwpKSAhPSBFT0YpIHsK
KyAJc3dpdGNoIChvcHQpIHsKKyAgICAgICAgIGNhc2UgJ0MnOiAvKiBhbHQgY29uZmlnIGZpbGUg
Ki8KKyAgICAgICAgICAgICBhbHRfY29uZmlnID0gb3B0YXJnOworICAgICAgICAgICAgIGJyZWFr
OworIAljYXNlICduJzoKKyAJICAgIG5fbGlzdGVuZXJzID0gYXRvaShvcHRhcmcpOworIAkgICAg
aWYobl9saXN0ZW5lcnM8PTApIHsKKyAJCWZwcmludGYoc3RkZXJyLCAiaW52YWxpZCBudW1iZXIg
b2YgbGlzdGVuZXIgcHJvY2Vzc2VzXG4iKTsKKyAJCWV4aXQoRUNfVVNBR0UpOworIAkgICAgfQor
IAkgICAgYnJlYWs7CisgCWRlZmF1bHQ6CisgCSAgICBmcHJpbnRmKHN0ZGVyciwgImludmFsaWQg
YXJndW1lbnRcbiIpOworIAkgICAgZXhpdChFQ19VU0FHRSk7CisgCSAgICBicmVhazsKKyAJfQor
ICAgICB9CisgCisgICAgIC8qIHNldCBkZWZhdWx0IG51bWJlciBvZiBsaXN0ZW5lcnMgaWYgbmVl
ZGVkICovCisgICAgIGlmKCFuX2xpc3RlbmVycykKKyAJbl9saXN0ZW5lcnM9MTsKKyAKKyAgICAg
Y3lydXNfaW5pdChhbHRfY29uZmlnLCAibGRhcGQiLCAwKTsKKyAKKyAgICAgcG9ydF9udW0gPSBj
b25maWdfZ2V0aW50KElNQVBPUFRfQ09OVkVSVFVTRVJJRF9VRFBQT1JUKTsKKyAKKyAgICAgaWYo
cmVhZF9sZGFwX29wdGlvbnMoKSkKKyAJZXhpdCgxKTsKKyAKKyAgICAgLyogY3JlYXRlIHNvY2tl
dCB3ZSBhcmUgZ29pbmcgdG8gdXNlIGZvciBsaXN0ZW5pbmcgKi8KKyAgICAgaWYgKChzID0gc29j
a2V0KEFGX0lORVQsIFNPQ0tfREdSQU0sIDApKSA9PSAtMSkgeworIAlwZXJyb3IoInNvY2tldCIp
OworIAljeXJ1c19kb25lKCk7CisgCWV4aXQoMSk7CisgICAgIH0KKyAKKyAgICAgbG9jYWwuc2lu
X2ZhbWlseSA9IEFGX0lORVQ7CisgICAgIGluZXRfcHRvbihBRl9JTkVULCBsZGFwZF9sb2NhbGhv
c3QsICZsb2NhbC5zaW5fYWRkcik7CisgICAgIGxvY2FsLnNpbl9wb3J0ID0gaHRvbnMocG9ydF9u
dW0pOworICAgICBsZW49c2l6ZW9mKGxvY2FsKTsKKyAKKyAgICAgaWYgKGJpbmQocywgKHN0cnVj
dCBzb2NrYWRkciAqKSZsb2NhbCwgbGVuKSA9PSAtMSkgeworIAlwZXJyb3IoImJpbmQiKTsKKyAJ
Y3lydXNfZG9uZSgpOworIAlleGl0KDEpOworICAgICB9CisgCisgICAgIGZvcihjdXJjaGlsZD0w
OyBjdXJjaGlsZDxuX2xpc3RlbmVyczsgY3VyY2hpbGQrKykgeworIAlwaWQgPSBmb3JrKCk7Cisg
CWlmIChwaWQgPT0gLTEpIHsKKyAJICAgIHBlcnJvcigiZm9yayIpOworIAkgICAgY3lydXNfZG9u
ZSgpOworIAkgICAgZXhpdCgxKTsKKyAJfQorIAkKKyAJaWYgKHBpZCAhPSAwKSB7IC8qIHBhcmVu
dCAqLworIAkgICAgY29udGludWU7CisgCX0KKyAJLyogY2hpbGQgKi8KKyAJYnJlYWs7CisgICAg
IH0KKyAKKyAgICAgaWYgKHBpZCAhPSAwKSB7IC8qIHBhcmVudCAqLworIAljeXJ1c19kb25lKCk7
CisgCWV4aXQoMCk7CisgICAgIH0KKyAJCisgICAgIC8qIGNoaWxkICovCisgCisgICAgIGZvciAo
OzspIHsKKyAJaW50IG47CisgCisgCWZyb21sZW4gPSBzaXplb2YoZnJvbSk7CisgCW4gPSByZWN2
ZnJvbShzLCAodm9pZCopICZsZGFwZGF0YSwgc2l6ZW9mKGxkYXBfZGF0YV90KSwgMCwKKyAJCSAg
ICAgKHN0cnVjdCBzb2NrYWRkciAqKSAmZnJvbSwgJmZyb21sZW4pOworIAorIAlpZiAobiA+IDAp
IHsKKyAJICAgIGlmIChuIDw9IExEQVBEQVRBX0JBU0VfU0laRSB8fAorIAkJbGRhcGRhdGEudXNl
cmxlbiA8IG4tTERBUERBVEFfQkFTRV9TSVpFKQorIAkJc3lzbG9nKExPR19FUlIsICJJbnZhbGlk
IG1lc3NhZ2UgcmVjZWl2ZWQsIHNpemU9JWRcbiIsIG4pOworIAkgICAgZWxzZSB7CisgCQlpbnQg
cmVzdWx0bGVuPTA7CisgCisgCQlsZGFwZGF0YV9yZXN1bHQuY29kZT1nZXRfaWRfZnJvbV9sZGFw
KAorIAkJICAgIGxkYXBkYXRhLmJ1ZiwgbGRhcGRhdGEudXNlcmxlbiwKKyAJCSAgICBsZGFwZGF0
YS5idWYrbGRhcGRhdGEudXNlcmxlbiwgbi1MREFQREFUQV9CQVNFX1NJWkUtbGRhcGRhdGEudXNl
cmxlbiwKKyAJCSAgICBsZGFwZGF0YV9yZXN1bHQuYnVmLCAmcmVzdWx0bGVuLAorIAkJICAgIGxk
YXBkYXRhLmludDJleHQpOworIAkJaWYoc2VuZHRvKHMsICh2b2lkICopJmxkYXBkYXRhX3Jlc3Vs
dCwgcmVzdWx0bGVuK0xEQVBEQVRBX1JFU1VMVF9CQVNFX1NJWkUsMCwoc3RydWN0IHNvY2thZGRy
ICopJmZyb20sZnJvbWxlbik9PS0xKQorIAkJICAgIHN5c2xvZyhMT0dfRVJSLCAiQ2Fubm90IHNl
bmQgYW4gYW5zd2VyOiAlc1xuIiwgc3RyZXJyb3IoZXJybm8pKTsKKyAJICAgIH0KKyAJfQorICAg
ICB9CisgCisgICAgIGN5cnVzX2RvbmUoKTsKKyAKKyAgICAgLyogbmV2ZXIgZ2V0cyBoZXJlICov
ICAgICAgCisgICAgIGV4aXQoMSk7CisgfQorIAorIHZvaWQgcHJpbnRzdHJpbmcoY29uc3QgY2hh
ciAqcyBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSkKKyB7IAorICAgICAvKiBuZWVkZWQgdG8gbGlu
ayBhZ2FpbnN0IGFubm90YXRlLm8gKi8KKyAgICAgZmF0YWwoInByaW50c3RyaW5nKCkgZXhlY3V0
ZWQhISEiLAorICAgICAgICAgICBFQ19TT0ZUV0FSRSk7CisgfQpkaWZmIC1OIC1DIDMgLXIgY3ly
dXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL2xkYXBkLmggY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAv
bGRhcGQuaAoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL2xkYXBkLmgJMTk3MC0wMS0w
MSAwMzowMDowMCArMDMwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbGRhcGQuaAkyMDA1
LTExLTIyIDE4OjU4OjMwICswMzAwCioqKioqKioqKioqKioqKgoqKiogMCAqKioqCi0tLSAxLDI3
IC0tLS0KKyAjaWZuZGVmIF9MREFQRF9ICisgI2RlZmluZSBfTERBUERfSAorIAorICNpbmNsdWRl
ICJtYWlsYm94LmgiCisgCisgLyogc29ja2V0IHRvIGNvbW11bmljYXRlIHdpdGggdGhlIGxkYXBk
ICovCisgI2RlZmluZSBGTkFNRV9DT05WRVJUVVNFUklEX1NPQ0sgIi9zb2NrZXQvbGRhcCIKKyAK
KyB0eXBlZGVmIHN0cnVjdCBsZGFwX2RhdGFfcyB7CisgICAgIHVuc2lnbmVkIGxvbmcgaW50MmV4
dDsKKyAgICAgdW5zaWduZWQgbG9uZyB1c2VybGVuOyAvKiBsZW5ndGggb2YgdGhlIHVzZXJuYW1l
IGJ1ZmZlciAqLworIAorICAgICAvKiBub24tbnVsbC10ZXJtaW5hdGVkIGJ1ZmZlciBmb3IgdXNl
cm5hbWUgYW5kIGRvbWFpbiAqLworICAgICBjaGFyIGJ1ZltNQVhfTUFJTEJPWF9OQU1FKjJdOwor
IH0gbGRhcF9kYXRhX3Q7CisgCisgdHlwZWRlZiBzdHJ1Y3QgbGRhcF9kYXRhX3Jlc3VsdF9zIHsK
KyAgICAgdW5zaWduZWQgbG9uZyBjb2RlOworIAorICAgICAvKiBub24tbnVsbC10ZXJtaW5hdGVk
IGJ1ZmZlciBmb3IgY29udmVydGVkIHVzZXJuYW1lICovCisgICAgIGNoYXIgYnVmW01BWF9NQUlM
Qk9YX05BTUVdOworIH0gbGRhcF9kYXRhX3Jlc3VsdF90OworIAorICNkZWZpbmUgTERBUERBVEFf
QkFTRV9TSVpFCSgyICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKQorICNkZWZpbmUgTERBUERBVEFf
UkVTVUxUX0JBU0VfU0laRQkoc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKQorIAorICNlbmRpZiAvKiBf
TERBUERfSCAqLwpkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL01h
a2VmaWxlLmluIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL01ha2VmaWxlLmluCioqKiBjeXJ1cy1p
bWFwZC0yLjIuMTIub2xkL2ltYXAvTWFrZWZpbGUuaW4JMjAwNS0xMS0wNyAxODowNToyNCArMDMw
MAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvTWFrZWZpbGUuaW4JMjAwNS0xMS0yMiAxODo1
Nzo1MyArMDMwMAoqKioqKioqKioqKioqKioKKioqIDY5LDc1ICoqKioKICBTSUVWRV9MSUJTID0g
QFNJRVZFX0xJQlNACiAgSU1BUF9DT01fRVJSX0xJQlMgPSBASU1BUF9DT01fRVJSX0xJQlNACiAg
TElCX1dSQVAgPSBATElCX1dSQVBACiEgTElCUyA9ICQoSU1BUF9MSUJTKSAkKElNQVBfQ09NX0VS
Ul9MSUJTKQogIERFUExJQlMgPSAuLi9saWIvbGliY3lydXMuYSAuLi9saWIvbGliY3lydXNfbWlu
LmEgQERFUExJQlNACiAgCiAgQ0ZMQUdTID0gQENGTEFHU0AKLS0tIDY5LDc1IC0tLS0KICBTSUVW
RV9MSUJTID0gQFNJRVZFX0xJQlNACiAgSU1BUF9DT01fRVJSX0xJQlMgPSBASU1BUF9DT01fRVJS
X0xJQlNACiAgTElCX1dSQVAgPSBATElCX1dSQVBACiEgTElCUyA9ICQoSU1BUF9MSUJTKSAkKElN
QVBfQ09NX0VSUl9MSUJTKSAtbHJlZGJsYWNrIC1sbGRhcAogIERFUExJQlMgPSAuLi9saWIvbGli
Y3lydXMuYSAuLi9saWIvbGliY3lydXNfbWluLmEgQERFUExJQlNACiAgCiAgQ0ZMQUdTID0gQENG
TEFHU0AKKioqKioqKioqKioqKioqCioqKiAxMDQsMTEwICoqKioKICAJY29udmVydF9jb2RlLm8g
ZHVwbGljYXRlLm8gc2FzbGNsaWVudC5vIHNhc2xzZXJ2ZXIubyBzaWduYWxzLm8gXAogIAlhbm5v
dGF0ZS5vIHNlYXJjaF9lbmdpbmVzLm8gc3F1YXQubyBzcXVhdF9pbnRlcm5hbC5vIG1iZHVtcC5v
IFwKICAJaW1hcHBhcnNlLm8gdGVsZW1ldHJ5Lm8gdXNlci5vIG5vdGlmeS5vIHByb3RvY29sLm8g
cXVvdGFfZGIubyBcCiEgCWF1dG9zaWV2ZS5vICQoU0VFTikgJChJRExFKQogIAogIElNQVBET0JK
Uz1wdXNoc3RhdHMubyBiYWNrZW5kLm8gaW1hcGQubyBpbmRleC5vIHRscy5vIHZlcnNpb24ubwog
IAotLS0gMTA0LDExMCAtLS0tCiAgCWNvbnZlcnRfY29kZS5vIGR1cGxpY2F0ZS5vIHNhc2xjbGll
bnQubyBzYXNsc2VydmVyLm8gc2lnbmFscy5vIFwKICAJYW5ub3RhdGUubyBzZWFyY2hfZW5naW5l
cy5vIHNxdWF0Lm8gc3F1YXRfaW50ZXJuYWwubyBtYmR1bXAubyBcCiAgCWltYXBwYXJzZS5vIHRl
bGVtZXRyeS5vIHVzZXIubyBub3RpZnkubyBwcm90b2NvbC5vIHF1b3RhX2RiLm8gXAohIAlhdXRv
c2lldmUubyBjaGFyc2V0X2NvbnZlcnQubyAkKFNFRU4pICQoSURMRSkKICAKICBJTUFQRE9CSlM9
cHVzaHN0YXRzLm8gYmFja2VuZC5vIGltYXBkLm8gaW5kZXgubyB0bHMubyB2ZXJzaW9uLm8KICAK
KioqKioqKioqKioqKioqCioqKiAxOTAsMTk1ICoqKioKLS0tIDE5MCwxOTkgLS0tLQogIAkkKEND
KSAkKExERkxBR1MpIC1vIGlkbGVkIFwKICAJIGlkbGVkLm8gbXV0ZXhfZmFrZS5vIGxpYmltYXAu
YSAkKFNJRVZFX0xJQlMpICQoREVQTElCUykgJChMSUJTKQogIAorIGxkYXBkOiBsZGFwZC5vIG11
dGV4X2Zha2UubyBsaWJpbWFwLmEgJChERVBMSUJTKQorIAkkKENDKSAkKExERkxBR1MpIC1vIGxk
YXBkIFwKKyAJIGxkYXBkLm8gbXV0ZXhfZmFrZS5vIGxpYmltYXAuYSAkKFNJRVZFX0xJQlMpICQo
REVQTElCUykgJChMSUJTKQorIAogIGxtdHBkOiBsbXRwZC5vICQoTE1UUE9CSlMpICQoU0lFVkVf
T0JKUykgbXV0ZXhfZmFrZS5vIGxpYmltYXAuYSAkKFNJRVZFX0xJQlMpIFwKICAJJChERVBMSUJT
KSAkKFNFUlZJQ0UpCiAgCSQoQ0MpICQoTERGTEFHUykgLW8gbG10cGQgXApkaWZmIC1OIC1DIDMg
LXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL21ib3hsaXN0LmMgY3lydXMtaW1hcGQtMi4y
LjEyL2ltYXAvbWJveGxpc3QuYwoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL21ib3hs
aXN0LmMJMjAwNS0xMS0wNyAxODoyNDo0MyArMDMwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2lt
YXAvbWJveGxpc3QuYwkyMDA1LTExLTIyIDE4OjU3OjUzICswMzAwCioqKioqKioqKioqKioqKgoq
KiogMTc1OSwxNzk0ICoqKioKICAgICAgLyogZG9uJ3QgbGlzdCBtYWlsYm94ZXMgb3V0c2lkZSBv
ZiB0aGUgZGVmYXVsdCBkb21haW4gKi8KICAgICAgaWYgKCFyb2NrLT5kb21haW5sZW4gJiYgIXJv
Y2stPmlzYWRtaW4gJiYgc3RyY2hyKGtleSwgJyEnKSkgcmV0dXJuIDA7IAogIAotICAgICBtaW5t
YXRjaCA9IDA7Ci0gCi0gICAgIG1lbWNweShuYW1lYnVmLCBrZXksIGtleWxlbik7Ci0gICAgIG5h
bWVidWZba2V5bGVuXSA9ICdcMCc7Ci0gCi0gICAgIC8qIHJpZ2h0IHdvcmsgd2l0aCBhbiBhbHRl
cm5hdGUgKG5vdCB0aGUgYnVpbGQtaW4pCi0gICAgICAgIG5hbWVzcGFjZSAtLSBzb3JjZXJlciAq
LwotICAgICBpZihrZXlsZW4gPj0gc2l6ZW9mKG5hbWVidWYpKSB7Ci0gCXN5c2xvZyhMT0dfRVJS
LCAib3ZlcnNpemUga2V5bGVuIGluIG1ib3hsaXN0LmM6ZmluZF9wKCkiKTsKLSAJcmV0dXJuIDA7
Ci0gICAgIH0KLSAgICAgaWYocm9jay0+aW5ib3hvZmZzZXQpIHsKLSAJbmFtZWJ1Zltyb2NrLT5p
bmJveG9mZnNldF0gPSByb2NrLT5pbmJveGNhc2VbMF07Ci0gCW5hbWVidWZbcm9jay0+aW5ib3hv
ZmZzZXQrMV0gPSByb2NrLT5pbmJveGNhc2VbMV07Ci0gCW5hbWVidWZbcm9jay0+aW5ib3hvZmZz
ZXQrMl0gPSByb2NrLT5pbmJveGNhc2VbMl07Ci0gCW5hbWVidWZbcm9jay0+aW5ib3hvZmZzZXQr
M10gPSByb2NrLT5pbmJveGNhc2VbM107Ci0gCW5hbWVidWZbcm9jay0+aW5ib3hvZmZzZXQrNF0g
PSByb2NrLT5pbmJveGNhc2VbNF07Ci0gICAgIH0KLSAKLSAgICAgLyogaWYgY2FudCBnZXQgdGhl
IGV4dGVybmFsIG5hbWUgdGhlbiBza2lwIHRoZSBjdXJyZW50Ci0gICAgICAgIGtleSAtLSBzb3Jj
ZXJlciAqLwotICAgICBpZigocm9jay0+bmFtZXNwYWNlLT5tYm94bmFtZV90b2V4dGVybmFsKShy
b2NrLT5uYW1lc3BhY2UsIG5hbWVidWYrcm9jay0+aW5ib3hvZmZzZXQsIGF1dGhfY2Fub251c2Vy
KHJvY2stPmF1dGhfc3RhdGUpLCBuYW1lYnVmX291dCkpCi0gCXJldHVybiAwOwotIAotICAgICBt
YXRjaGxlbiA9IGdsb2JfdGVzdChnLCBuYW1lYnVmX291dCwKLSAJCQkgc3RybGVuKG5hbWVidWZf
b3V0KSwgJm1pbm1hdGNoKTsKLSAKLSAgICAgLyogSWYgaXRzIG5vdCBhIG1hdGNoLCBza2lwIGl0
IC0tIHBhcnRpYWwgbWF0Y2hlcyBhcmUgb2suICovCi0gICAgIGlmKG1hdGNobGVuID09IC0xKSBy
ZXR1cm4gMDsKLSAKICAgICAgaWYgKHJvY2stPmZpbmRfbmFtZXNwYWNlICE9IE5BTUVTUEFDRV9J
TkJPWCAmJgogIAlyb2NrLT51c2VybWJveG5hbWUgJiYKICAJa2V5bGVuID49IHJvY2stPnVzZXJt
Ym94bmFtZWxlbiAmJgotLS0gMTc1OSwxNzY0IC0tLS0KKioqKioqKioqKioqKioqCioqKiAxODQy
LDE4NDcgKioqKgotLS0gMTgxMiwxODQ2IC0tLS0KICAJfQogICAgICB9CiAgICAgIAorICAgICBt
aW5tYXRjaCA9IDA7CisgCisgICAgIG1lbWNweShuYW1lYnVmLCBrZXksIGtleWxlbik7CisgICAg
IG5hbWVidWZba2V5bGVuXSA9ICdcMCc7CisgCisgICAgIC8qIHJpZ2h0IHdvcmsgd2l0aCBhbiBh
bHRlcm5hdGUgbmFtZXNwYWNlIC0tIHNvcmNlcmVyICovCisgICAgIGlmKGtleWxlbiA+PSBzaXpl
b2YobmFtZWJ1ZikpIHsKKyAJc3lzbG9nKExPR19FUlIsICJvdmVyc2l6ZSBrZXlsZW4gaW4gbWJv
eGxpc3QuYzpmaW5kX3AoKSIpOworIAlyZXR1cm4gMDsKKyAgICAgfQorICAgICBpZihyb2NrLT5p
bmJveG9mZnNldCkgeworIAluYW1lYnVmW3JvY2stPmluYm94b2Zmc2V0XSA9IHJvY2stPmluYm94
Y2FzZVswXTsKKyAJbmFtZWJ1Zltyb2NrLT5pbmJveG9mZnNldCsxXSA9IHJvY2stPmluYm94Y2Fz
ZVsxXTsKKyAJbmFtZWJ1Zltyb2NrLT5pbmJveG9mZnNldCsyXSA9IHJvY2stPmluYm94Y2FzZVsy
XTsKKyAJbmFtZWJ1Zltyb2NrLT5pbmJveG9mZnNldCszXSA9IHJvY2stPmluYm94Y2FzZVszXTsK
KyAJbmFtZWJ1Zltyb2NrLT5pbmJveG9mZnNldCs0XSA9IHJvY2stPmluYm94Y2FzZVs0XTsKKyAg
ICAgfQorIAorICAgICAvKiBpZiBjYW50IGdldCB0aGUgZXh0ZXJuYWwgbmFtZSB0aGVuIHNraXAg
dGhlIGN1cnJlbnQKKyAgICAgICAga2V5IC0tIHNvcmNlcmVyICovCisgICAgIGlmKChyb2NrLT5u
YW1lc3BhY2UtPm1ib3huYW1lX3RvZXh0ZXJuYWwpKHJvY2stPm5hbWVzcGFjZSwgbmFtZWJ1Zity
b2NrLT5pbmJveG9mZnNldCwgYXV0aF9jYW5vbnVzZXIocm9jay0+YXV0aF9zdGF0ZSksIG5hbWVi
dWZfb3V0KSkKKyAJcmV0dXJuIDA7CisgCisgICAgIG1hdGNobGVuID0gZ2xvYl90ZXN0KGcsIG5h
bWVidWZfb3V0LAorIAkJCSBzdHJsZW4obmFtZWJ1Zl9vdXQpLCAmbWlubWF0Y2gpOworIAorICAg
ICAvKiBJZiBpdHMgbm90IGEgbWF0Y2gsIHNraXAgaXQgLS0gcGFydGlhbCBtYXRjaGVzIGFyZSBv
ay4gKi8KKyAgICAgaWYobWF0Y2hsZW4gPT0gLTEpIHJldHVybiAwOworIAogICAgICAvKiBpZiB3
ZSBnZXQgaGVyZSwgY2xvc2UgZW5vdWdoIGZvciB1cyB0byBzcGVuZCB0aGUgdGltZQogICAgICAg
ICBhY3RpbmcgaW50ZXJlc3RlZCAqLwogICAgICByZXR1cm4gMTsKKioqKioqKioqKioqKioqCioq
KiAxODgwLDE4OTAgKioqKgogIAl9CiAgCiAgICAgICAgCS8qIG1ha2Ugc3VyZSBpdCdzIGluIHRo
ZSBtYWlsYm94ZXMgZGIgKi8KISAJaWYgKHJvY2stPmNoZWNrbWJveGxpc3QpIHsKISAJICAgIHIg
PSBtYm94bGlzdF9sb29rdXAobmFtZWJ1ZiwgTlVMTCwgTlVMTCwgTlVMTCk7CiEgCX0gZWxzZSB7
CiEgCSAgICByID0gMDsJCS8qIGRvbid0IGJvdGhlciBjaGVja2luZyAqLwohIAl9CiAgCiAgCS8q
IHJpZ2h0IHdvcmsgd2l0aCBhbiBhbHRlcm5hdGUgKG5vdCB0aGUgYnVpbGQtaW4pCiAgCSAgIG5h
bWVzcGFjZSAvLyBzb3JjZXJlciAqLwotLS0gMTg3OSwxODg5IC0tLS0KICAJfQogIAogICAgICAg
IAkvKiBtYWtlIHN1cmUgaXQncyBpbiB0aGUgbWFpbGJveGVzIGRiICovCiEgIAlpZiAocm9jay0+
Y2hlY2ttYm94bGlzdCkgewohICAJICAgIHIgPSBtYm94bGlzdF9sb29rdXAobmFtZWJ1ZiwgTlVM
TCwgTlVMTCwgTlVMTCk7CiEgIAl9IGVsc2UgewohIAkgICAgciA9IDA7CiEgIAl9CiAgCiAgCS8q
IHJpZ2h0IHdvcmsgd2l0aCBhbiBhbHRlcm5hdGUgKG5vdCB0aGUgYnVpbGQtaW4pCiAgCSAgIG5h
bWVzcGFjZSAvLyBzb3JjZXJlciAqLwpkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEy
Lm9sZC9pbWFwL21ib3huYW1lLmMgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJveG5hbWUuYwoq
KiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL21ib3huYW1lLmMJMjAwNS0xMS0wNyAxODoy
NDo0NCArMDMwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJveG5hbWUuYwkyMDA1LTEx
LTIyIDE4OjU3OjUzICswMzAwCioqKioqKioqKioqKioqKgoqKiogNTcsNjIgKioqKgotLS0gNTcs
NzIgLS0tLQogIAogICNpbmNsdWRlICJtYm94bmFtZS5oIgogICNpbmNsdWRlICJtYm94bGlzdC5o
IgorICNpbmNsdWRlICJpbWFwZC5oIgorIAorICNpZmRlZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQK
KyAjaW5jbHVkZSA8c3lzL3NvY2tldC5oPgorICNpbmNsdWRlIDxuZXRpbmV0L2luLmg+CisgI2lu
Y2x1ZGUgPGFycGEvaW5ldC5oPgorICNpbmNsdWRlIDxyZWRibGFjay5oPgorICNpbmNsdWRlIDxz
eXNsb2cuaD4KKyAjaW5jbHVkZSAibGRhcGQuaCIKKyAjZW5kaWYgLyogRU5BQkxFX0NPTlZFUlRf
VVNFUklEICovCiAgCiAgLyogTWFpbGJveCBwYXR0ZXJucyB3aGljaCB0aGUgZGVzaWduIG9mIHRo
ZSBzZXJ2ZXIgcHJvaGliaXRzICovCiAgc3RhdGljIGNoYXIgKmJhZG1ib3hwYXR0ZXJuc1tdID0g
ewoqKioqKioqKioqKioqKioKKioqIDk1LDEwMCAqKioqCi0tLSAxMDUsNDQ0IC0tLS0KICB9Owog
ICNkZWZpbmUgQ0hBUk1PRDY0KGMpICAoaW5kZXhfbW9kNjRbKHVuc2lnbmVkIGNoYXIpKGMpXSkK
ICAKKyAjaWZkZWYgRU5BQkxFX0NPTlZFUlRfVVNFUklECisgdHlwZWRlZiBzdHJ1Y3QgX3JidF9k
YXRhX3QgeworICAgICBjaGFyICpkb21haW47CisgICAgIGNoYXIgKmlkX2luOworICAgICBpbnQg
aWRfaW5fbGVuOworICAgICBjaGFyICppZF9vdXQ7CisgICAgIGludCBpZF9vdXRfbGVuOworIH0g
cmJ0X2RhdGFfdDsKKyAKKyBzdGF0aWMgc3RydWN0IHJidHJlZSAqcmJ0X2ludF90b19leHQ9TlVM
TDsKKyBzdGF0aWMgc3RydWN0IHJidHJlZSAqcmJ0X2V4dF90b19pbnQ9TlVMTDsKKyAKKyBzdGF0
aWMgaW50IGNvbnZlcnR1c2VyaWRfc29ja2V0PS0xOworIAorIGludCByYnRfZGF0YV9jb21wYXJl
KGNvbnN0IHZvaWQgKnAxLCBjb25zdCB2b2lkICpwMiwgY29uc3Qgdm9pZCAqY29uZmlnKQorIHsK
KyAgICAgcmJ0X2RhdGFfdCAqZDE9KHJidF9kYXRhX3QgKilwMTsKKyAgICAgcmJ0X2RhdGFfdCAq
ZDI9KHJidF9kYXRhX3QgKilwMjsKKyAgICAgaW50IHJlczsKKyAKKyAgICAgaWYoIShyZXM9c3Ry
Y21wKGQxLT5kb21haW4sIGQyLT5kb21haW4pKSkgeworIAljaGFyICpzdHIxLCAqc3RyMjsKKyAJ
aW50IHN0cjFfbGVuLCBzdHIyX2xlbjsKKyAJaW50IG1pbl9sZW47CisgCisgCWlmKGNvbmZpZykg
eworIAkgICAgc3RyMT1kMS0+aWRfaW47CisgCSAgICBzdHIxX2xlbj1kMS0+aWRfaW5fbGVuOwor
IAkgICAgc3RyMj1kMi0+aWRfaW47CisgCSAgICBzdHIyX2xlbj1kMi0+aWRfaW5fbGVuOworIAl9
CisgCWVsc2UgeworIAkgICAgc3RyMT1kMS0+aWRfb3V0OworIAkgICAgc3RyMV9sZW49ZDEtPmlk
X291dF9sZW47CisgCSAgICBzdHIyPWQyLT5pZF9vdXQ7CisgCSAgICBzdHIyX2xlbj1kMi0+aWRf
b3V0X2xlbjsKKyAJfQorIAltaW5fbGVuID0gKHN0cjFfbGVuIDwgc3RyMl9sZW4pPyBzdHIxX2xl
biA6IHN0cjJfbGVuOworIAlpZighKHJlcz1tZW1jbXAoc3RyMSwgc3RyMiwgbWluX2xlbikpKSB7
CisgCSAgICBpZihtaW5fbGVuPT1zdHIxX2xlbikKKyAJCXJlcyA9IChtaW5fbGVuPT1zdHIyX2xl
bik/MDotMTsKKyAJICAgIGVsc2UKKyAJCXJlcyA9IC0xOworIAl9CisgICAgIH0KKyAgICAgcmV0
dXJuIHJlczsKKyB9CisgCisgI2RlZmluZSBET05UX0FMTE9DQVRFX0lOICAweDEKKyAjZGVmaW5l
IERPTlRfQUxMT0NBVEVfT1VUIDB4MgorIAorIHJidF9kYXRhX3QgKnJidF9pbml0X3VzZXJpZF9k
YXRhKGNvbnN0IGNoYXIgKmRvbWFpbiwgY29uc3QgY2hhciAqaW4sIGludCBpbl9sZW4sIGNvbnN0
IGNoYXIgKm91dCwgaW50IG91dF9sZW4sIGludCBmbGFncykKKyB7CisgICAgIHJidF9kYXRhX3Qg
KnJlcz0ocmJ0X2RhdGFfdCAqKW1hbGxvYyhzaXplb2YocmJ0X2RhdGFfdCkpOworIAorICAgICBp
ZighcmVzKQorIAlyZXR1cm4gTlVMTDsKKyAKKyAgICAgcmVzLT5kb21haW4gPSBzdHJkdXAoZG9t
YWluKTsKKyAgICAgaWYoIXJlcy0+ZG9tYWluKSB7CisgCWZyZWUocmVzKTsKKyAJcmV0dXJuIE5V
TEw7CisgICAgIH0KKyAKKyAgICAgaWYoaW4gPT0gb3V0ICYmIChmbGFncyAmIChET05UX0FMTE9D
QVRFX0lOfERPTlRfQUxMT0NBVEVfT1VUKSkpCisgCWZsYWdzIHw9IChET05UX0FMTE9DQVRFX0lO
fERPTlRfQUxMT0NBVEVfT1VUKTsKKyAKKyAgICAgaWYoZmxhZ3MgJiBET05UX0FMTE9DQVRFX0lO
KQorIAlyZXMtPmlkX2luID0gKGNoYXIgKilpbjsKKyAgICAgZWxzZSBpZighKHJlcy0+aWRfaW4g
PSAoY2hhciAqKW1hbGxvYyhpbl9sZW4pKSkgeworIAlmcmVlKHJlcy0+ZG9tYWluKTsKKyAJZnJl
ZShyZXMpOworIAlyZXR1cm4gTlVMTDsKKyAgICAgfQorICAgICBlbHNlCisgCW1lbWNweShyZXMt
PmlkX2luLCBpbiwgaW5fbGVuKTsKKyAKKyAgICAgaWYoaW4gPT0gb3V0ICYmICFmbGFncykgewor
IAlvdXQgPSByZXMtPmlkX2luOworIAlmbGFncyB8PSBET05UX0FMTE9DQVRFX09VVDsKKyAgICAg
fQorIAorICAgICBpZihmbGFncyAmIERPTlRfQUxMT0NBVEVfT1VUKQorIAlyZXMtPmlkX291dCA9
IChjaGFyICopb3V0OworICAgICBlbHNlIGlmKCEocmVzLT5pZF9vdXQgPSAoY2hhciAqKW1hbGxv
YyhvdXRfbGVuKSkpIHsKKyAJZnJlZShyZXMtPmRvbWFpbik7CisgCWlmKCEoZmxhZ3MgJiBET05U
X0FMTE9DQVRFX0lOKSkKKyAJICAgIGZyZWUocmVzLT5pZF9pbik7CisgCWZyZWUocmVzKTsKKyAJ
cmV0dXJuIE5VTEw7CisgICAgIH0KKyAgICAgZWxzZQorIAltZW1jcHkocmVzLT5pZF9vdXQsIG91
dCwgb3V0X2xlbik7CisgCisgICAgIHJlcy0+aWRfaW5fbGVuID0gaW5fbGVuOworICAgICByZXMt
PmlkX291dF9sZW4gPSBvdXRfbGVuOworIAorICAgICByZXR1cm4gcmVzOworIH0KKyAKKyB2b2lk
IHJidF9mcmVlX3VzZXJpZF9kYXRhKHJidF9kYXRhX3QgKmRhdGEpCisgeworICAgICBmcmVlKGRh
dGEtPmRvbWFpbik7CisgICAgIGZyZWUoZGF0YS0+aWRfaW4pOworICAgICBpZihkYXRhLT5pZF9p
biE9ZGF0YS0+aWRfb3V0KQorIAlmcmVlKGRhdGEtPmlkX291dCk7CisgICAgIGZyZWUoZGF0YSk7
CisgfQorIAorICNkZWZpbmUgSU5URVJOQUwgICAgICAgICAgICAgIDB4MQorICNkZWZpbmUgTERB
UF9OQU1FX01VU1RfRVhJU1RTIDB4MgorICNkZWZpbmUgRE9OVF9SRVRVUk5fRVhJU1RFTlQgIDB4
NAorIAorIGV4dGVybiBpbnQgY29udmVydHVzZXJpZF9pbml0KCkKKyB7CisgICAgIGNvbnN0IGNo
YXIgKmNvbnZlcnR1c2VyaWRfc29jazsKKyAgICAgaW50IGxvY2FsbGVuOworICAgICBpbnQgcGF0
aGxlbjsKKyAgICAgbW9kZV90IG9sZHVtYXNrOworICAgICBpbnQgcG9ydF9udW07CisgICAgIHN0
cnVjdCBzb2NrYWRkcl9pbiBjb252ZXJ0dXNlcmlkX3JlbW90ZTsKKyAgICAgaW50IGNvbnZlcnR1
c2VyaWRfcmVtb3RlX2xlbjsKKyAKKyAgICAgLyogaWYgdGhlIHNvY2tldCBpcyBhbHJlYWR5IG9w
ZW4sIHJldHVybiAqLworICAgICBpZiAoY29udmVydHVzZXJpZF9zb2NrZXQgIT0gLTEpIHsKKyAJ
c3lzbG9nKExPR19FUlIsICJjb252ZXJ0dXNlcmlkX2luaXQ6IG11c3Qgbm90IGJlIGNhbGxlZCB0
d2ljZSIpOworIAlyZXR1cm4gLTE7CisgICAgIH0KKyAKKyAgICAgcG9ydF9udW0gPSBjb25maWdf
Z2V0aW50KElNQVBPUFRfQ09OVkVSVFVTRVJJRF9VRFBQT1JUKTsKKyAgICAgaWYoIXBvcnRfbnVt
KSB7CisgCXN5c2xvZyhMT0dfRVJSLCAiSW52YWxpZCB2YWx1ZSBvZiBjb252ZXJ0dXNlcmlkX3Vk
cHBvcnQgY29uZmlnIG9wdGlvblxuIik7CisgCXJldHVybiAtMTsKKyAgICAgfQorIAorICAgICBp
ZiAoKGNvbnZlcnR1c2VyaWRfc29ja2V0ID0gc29ja2V0KEFGX0lORVQsIFNPQ0tfREdSQU0sIDAp
KSA9PSAtMSkgeworIAlzeXNsb2coTE9HX0VSUiwgImNvbnZlcnR1c2VyaWRfaW5pdDogY2FuJ3Qg
Y3JlYXRlIGEgc29ja2V0Iik7CisgCXJldHVybiAtMTsKKyAgICAgfQorIAorICAgICBjb252ZXJ0
dXNlcmlkX3JlbW90ZS5zaW5fZmFtaWx5ID0gQUZfSU5FVDsKKyAgICAgY29udmVydHVzZXJpZF9y
ZW1vdGUuc2luX3BvcnQgPSBodG9ucyhwb3J0X251bSk7CisgICAgIGluZXRfcHRvbihBRl9JTkVU
LCBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQ09OVkVSVFVTRVJJRF9MT0NBTEhPU1QpLCAmY29u
dmVydHVzZXJpZF9yZW1vdGUuc2luX2FkZHIpOworICAgICBjb252ZXJ0dXNlcmlkX3JlbW90ZV9s
ZW4gPSBzaXplb2YoY29udmVydHVzZXJpZF9yZW1vdGUpOworIAorICAgICBpZihjb25uZWN0KGNv
bnZlcnR1c2VyaWRfc29ja2V0LCAoc3RydWN0IHNvY2thZGRyICopJmNvbnZlcnR1c2VyaWRfcmVt
b3RlLCBjb252ZXJ0dXNlcmlkX3JlbW90ZV9sZW4pPT0tMSkgeworIAlzeXNsb2coTE9HX0VSUiwg
ImNvbnZlcnR1c2VyaWRfaW5pdDogY2FuJ3QgY29ubmVjdCAoZGF0YWdyYW0pIik7CisgCXJldHVy
biAtMTsKKyAgICAgfQorIAorICAgICByZXR1cm4gMDsKKyB9CisgCisgc3RhdGljIGNoYXIgKm1i
b3huYW1lX2dldF9pZF9mcm9tX2xkYXAoY29uc3QgY2hhciAqaW4sIGludCBpbl9sZW4sIGNvbnN0
IGNoYXIgKmRvbWFpbiwgaW50ICpvdXRfbGVuLCBpbnQgZmxhZ3MpCisgeworICAgICBsZGFwX2Rh
dGFfdCBzZW5kZGF0YTsKKyAgICAgaW50IGRvbWFpbmxlbj1zdHJsZW4oZG9tYWluKTsKKyAgICAg
c3NpemVfdCBzaXplOworIAorICAgICBzZW5kZGF0YS5pbnQyZXh0ID0gZmxhZ3MmSU5URVJOQUw7
CisgICAgIHNlbmRkYXRhLnVzZXJsZW4gPSBpbl9sZW47CisgICAgIG1lbWNweShzZW5kZGF0YS5i
dWYsIGluLCBpbl9sZW4pOworICAgICBtZW1jcHkoc2VuZGRhdGEuYnVmK2luX2xlbiwgZG9tYWlu
LCBkb21haW5sZW4pOworIAorICAgICBzaXplPXNlbmQoY29udmVydHVzZXJpZF9zb2NrZXQsICh2
b2lkICopJnNlbmRkYXRhLCBMREFQREFUQV9CQVNFX1NJWkUraW5fbGVuK2RvbWFpbmxlbiwgMCk7
CisgICAgIGlmKHNpemUgPT0gKHNzaXplX3QpLTEpIHsKKyAJc3lzbG9nKExPR19FUlIsICJDYW5u
b3Qgc2VuZCBjb252ZXJ0dXNlcmlkIHF1ZXJ5OiAlcy5cbiIsIHN0cmVycm9yKGVycm5vKSk7Cisg
CXJldHVybiBOVUxMOworICAgICB9CisgICAgIGlmKHNpemUgIT0gTERBUERBVEFfQkFTRV9TSVpF
K2luX2xlbitkb21haW5sZW4pCisgCXN5c2xvZyhMT0dfRVJSLCAiQ2Fubm90IHNlbmQgZnVsbCBj
b252ZXJ0dXNlcmlkIHF1ZXJ5LlxuIik7CisgCisgICAgIGlmKHNpemUpIHsKKyAJbGRhcF9kYXRh
X3Jlc3VsdF90IHJlY3ZkYXRhOworIAljaGFyICpvdXQ7CisgCisgCXNpemUgPSByZWN2KGNvbnZl
cnR1c2VyaWRfc29ja2V0LCAodm9pZCAqKSZyZWN2ZGF0YSwgc2l6ZW9mKHJlY3ZkYXRhKSwgMCk7
CisgCWlmKHNpemU9PShzc2l6ZV90KS0xKSB7CisgCSAgICBzeXNsb2coTE9HX0VSUiwgIkNhbm5v
dCByZWNlaXZlIGNvbnZlcnR1c2VyaWQgYW5zd2VyOiAlcy5cbiIsIHN0cmVycm9yKGVycm5vKSk7
CisgCSAgICByZXR1cm4gTlVMTDsKKyAJfQorIAlpZihzaXplPExEQVBEQVRBX1JFU1VMVF9CQVNF
X1NJWkUpIHsKKyAJICAgIHN5c2xvZyhMT0dfRVJSLCAiV3Jvbmcgc2l6ZSBvZiBjb252ZXJ0dXNl
cmlkIGFuc3dlci5cbiIpOworIAkgICAgcmV0dXJuIE5VTEw7CisgCX0KKyAJLyogYW5zd2VyIGlz
ICJjYW4ndCBjb252ZXJ0IHVzZXJpZCIgb3IgcmVzdWx0IHN0cmluZyBpcworIAkgICBlbXB0eSAq
LworIAlpZihyZWN2ZGF0YS5jb2RlIHx8IHNpemU9PUxEQVBEQVRBX1JFU1VMVF9CQVNFX1NJWkUp
CisgCSAgICByZXR1cm4gTlVMTDsKKyAJc2l6ZS09TERBUERBVEFfUkVTVUxUX0JBU0VfU0laRTsK
KyAJb3V0PShjaGFyICopbWFsbG9jKHNpemUpOworIAlpZighb3V0KQorIAkgICAgcmV0dXJuIE5V
TEw7CisgCW1lbWNweShvdXQsIHJlY3ZkYXRhLmJ1Ziwgc2l6ZSk7CisgCSpvdXRfbGVuID0gc2l6
ZTsKKyAJcmV0dXJuIG91dDsKKyAgICAgfQorIAorICAgICByZXR1cm4gTlVMTDsKKyB9CisgCisg
c3RhdGljIGNoYXIgKm1ib3huYW1lX2dldF9pZChjb25zdCBjaGFyICppbiwgaW50IGluX2xlbiwg
Y29uc3QgY2hhciAqZG9tYWluLCBpbnQgKm91dF9sZW4sIHN0cnVjdCByYnRyZWUgKipjX2ludCwg
c3RydWN0IHJidHJlZSAqKmNfZXh0LCBpbnQgZmxhZ3MpCisgeworICAgICByYnRfZGF0YV90IGRh
dGE7CisgICAgIHJidF9kYXRhX3QgKnNhdmVkX2RhdGE7CisgICAgIGNoYXIgKm91dDsKKyAgICAg
aW50IG5lZWRfYWxsb2M9MDsKKyAgICAgaW50IG5vbmV4aXN0ZW50PTA7CisgCisgICAgIGlmKCEq
Y19pbnQpCisgCWlmKCEoKmNfaW50ID0gcmJpbml0KHJidF9kYXRhX2NvbXBhcmUsICh2b2lkICop
KChmbGFncyZJTlRFUk5BTCk+MCkpKSkKKyAJICAgIHJldHVybiBOVUxMOworICAgICBpZighKmNf
ZXh0KQorIAlpZighKCpjX2V4dCA9IHJiaW5pdChyYnRfZGF0YV9jb21wYXJlLCAodm9pZCAqKSgh
KGZsYWdzJklOVEVSTkFMKSkpKSkKKyAJICAgIHJldHVybiBOVUxMOworICAgICBkYXRhLmRvbWFp
biA9IChjaGFyICopZG9tYWluOworIAkgICAKKyAgICAgaWYoZmxhZ3MmSU5URVJOQUwpIHsKKyAJ
ZGF0YS5pZF9pbiA9IChjaGFyICopaW47CisgCWRhdGEuaWRfaW5fbGVuID0gaW5fbGVuOworIAlk
YXRhLmlkX291dCA9IE5VTEw7CisgCWRhdGEuaWRfb3V0X2xlbiA9IDA7CisgICAgIH0KKyAgICAg
ZWxzZSB7CisgCWRhdGEuaWRfb3V0ID0gKGNoYXIgKilpbjsKKyAJZGF0YS5pZF9vdXRfbGVuID0g
aW5fbGVuOworIAlkYXRhLmlkX2luID0gTlVMTDsKKyAJZGF0YS5pZF9pbl9sZW4gPSAwOworICAg
ICB9CisgCisgICAgIC8qIGZpcnN0bHkgbG9vayBmb3IgdGhlIG5hbWUgaW4gdGhlIGxvY2FsIChp
bi1tZW1vcnkpIHN0b3JhZ2UgKi8KKyAgICAgaWYoKHNhdmVkX2RhdGE9KHJidF9kYXRhX3QgKily
YmZpbmQoKHZvaWQgKikmZGF0YSwgKmNfaW50KSkpIHsKKyAJaWYoZmxhZ3MmSU5URVJOQUwpIHsK
KyAJICAgICpvdXRfbGVuID0gc2F2ZWRfZGF0YS0+aWRfb3V0X2xlbjsKKyAJICAgIHJldHVybiBz
YXZlZF9kYXRhLT5pZF9vdXQ7CisgCX0KKyAJZWxzZSB7CisgCSAgICAqb3V0X2xlbiA9IHNhdmVk
X2RhdGEtPmlkX2luX2xlbjsKKyAJICAgIHJldHVybiBzYXZlZF9kYXRhLT5pZF9pbjsKKyAJfSAK
KyAgICAgfQorIAorICAgICBvdXQgPSBtYm94bmFtZV9nZXRfaWRfZnJvbV9sZGFwKGluLCBpbl9s
ZW4sIGRvbWFpbiwgb3V0X2xlbiwgZmxhZ3MpOworIAorICAgICBpZighb3V0KSB7CisgCWlmKGZs
YWdzICYgTERBUF9OQU1FX01VU1RfRVhJU1RTKQorIAkgICAgcmV0dXJuIE5VTEw7CisgCS8qIHNh
dmUgdGhlIGludGVybmFsIG5hbWUgYXMgZXh0ZXJuYWwgaWYgTERBUCBmZXRjaGluZyBmYWlscyAq
LworIAllbHNlIHsKKyAJICAgIG91dD0oY2hhciAqKWluOworIAkgICAgKm91dF9sZW49aW5fbGVu
OworIAkgICAgbmVlZF9hbGxvYz0xOworIAkgICAgbm9uZXhpc3RlbnQ9MTsKKyAJfQorICAgICB9
CisgICAgIAorICAgICAvKiBOb3cgd2UgaGF2ZSAnb3V0JyBhbmQgJypvdXRfbGVuJyB2YXJpYWJs
ZXMuIFNhdmUgJ2luJyBhbmQKKyAgICAgICAgJ291dCcgaW4gb3VyIG1lbW9yeSBkYXRhYmFzZXMg
Ki8KKyAgICAgaWYoZmxhZ3MmSU5URVJOQUwpCisgCXNhdmVkX2RhdGE9cmJ0X2luaXRfdXNlcmlk
X2RhdGEoZG9tYWluLCBpbiwgaW5fbGVuLCBvdXQsICpvdXRfbGVuLCBuZWVkX2FsbG9jPzA6RE9O
VF9BTExPQ0FURV9PVVQpOworICAgICBlbHNlCisgCXNhdmVkX2RhdGE9cmJ0X2luaXRfdXNlcmlk
X2RhdGEoZG9tYWluLCBvdXQsICpvdXRfbGVuLCBpbiwgaW5fbGVuLCBuZWVkX2FsbG9jPzA6RE9O
VF9BTExPQ0FURV9JTik7CisgICAgIAorICAgICBpZighcmJzZWFyY2goc2F2ZWRfZGF0YSwqY19p
bnQpKSB7CisgCXJidF9mcmVlX3VzZXJpZF9kYXRhKHNhdmVkX2RhdGEpOworIAlzYXZlZF9kYXRh
PU5VTEw7CisgICAgIH0KKyAgICAgZWxzZSBpZighcmJzZWFyY2goc2F2ZWRfZGF0YSwqY19leHQp
KSB7CisgCXJiZGVsZXRlKHNhdmVkX2RhdGEsICpjX2ludCk7CisgCXJidF9mcmVlX3VzZXJpZF9k
YXRhKHNhdmVkX2RhdGEpOworIAlzYXZlZF9kYXRhPU5VTEw7CisgICAgIH0KKyAKKyAgICAgLyog
SWYgd2UgY2FuJ3Qgc2F2ZSBkYXRhIGluIHRoZSBtZW1vcnkgc3RvcmFnZSB0aGVuIHJldHVybiBO
VUxMCisgICAgICAgIGJlY2F1c2Ugd2UgYXJlIG5vdCBzdXJlIGlmIGRhdGEgaW4gbGRhcCBzdG9y
YWdlIHdpbGwgbm90IGJlCisgICAgICAgIGNoYW5nZWQgd2hlbiB0aGlzIGZ1bmN0aW9uIGlzIGNh
bGxlZCBuZXh0IHRpbWUuICovCisgICAgIGlmKCFzYXZlZF9kYXRhKQorIAlyZXR1cm4gTlVMTDsK
KyAKKyAgICAgaWYoIW5vbmV4aXN0ZW50ICYmIChmbGFncyAmIERPTlRfUkVUVVJOX0VYSVNURU5U
KSkKKyAJcmV0dXJuIE5VTEw7CisgCSAgICAKKyAgICAgcmV0dXJuIG91dDsKKyB9CisgCisgc3Rh
dGljIHZvaWQgcmJ0X3dhbGtfY2IoY29uc3Qgdm9pZCAqbm9kZXAsIGNvbnN0IFZJU0lUIHdoaWNo
LCBjb25zdCBpbnQgZGVwdGgsIHZvaWQgKmFyZykKKyB7CisgICAgIGlmKHdoaWNoID09IGVuZG9y
ZGVyIHx8IHdoaWNoID09IGxlYWYpCisgCXJidF9mcmVlX3VzZXJpZF9kYXRhKChyYnRfZGF0YV90
ICopbm9kZXApOworIH0KKyAKKyAvKiBkZXN0cm95aW5nIGFsbCB0aGUgZGF0YSBuZWVkZWQgZm9y
IG5hbWVzIHRyYW5zZm9ybWF0aW9uICh0aGlzCisgICAgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW4g
Y2xpZW50IHRlcm1pbmF0ZXMgaGlzIGNvbm5lY3Rpb24pICovCisgZXh0ZXJuIHZvaWQgbWJveG5h
bWVfY2xlYW51cCgpCisgeworICAgICByYnRfZGF0YV90ICpkYXRhOworIAorICAgICBpZihyYnRf
aW50X3RvX2V4dCkgeworIAlyYndhbGsocmJ0X2ludF90b19leHQsIHJidF93YWxrX2NiLCBOVUxM
KTsKKyAJICAgIAorIAlyYmRlc3Ryb3kocmJ0X2ludF90b19leHQpOworIAlyYnRfaW50X3RvX2V4
dD1OVUxMOworICAgICB9CisgICAgIGlmKHJidF9leHRfdG9faW50KSB7CisgCXJiZGVzdHJveShy
YnRfZXh0X3RvX2ludCk7CisgCXJidF9leHRfdG9faW50PU5VTEw7CisgICAgIH0KKyB9CisgZXh0
ZXJuIGludCBjb252ZXJ0dXNlcmlkX2NsZWFudXAoKQorIHsKKyAgICAgY2xvc2UoY29udmVydHVz
ZXJpZF9zb2NrZXQpOworIH0KKyAKKyAjZW5kaWYgLyogRU5BQkxFX0NPTlZFUlRfVVNFUklEICov
CisgCisgc3RhdGljIGNoYXIgKm1ib3huYW1lX2dldF9leHRlcm5hbF9pZChjb25zdCBjaGFyICpp
biwgaW50IGluX2xlbiwgY29uc3QgY2hhciAqZG9tYWluLCBpbnQgKm91dF9sZW4sIGludCBmbGFn
cykKKyB7CisgI2lmbmRlZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKyAgICAgKm91dF9sZW4gPSBp
bl9sZW47CisgICAgIHJldHVybiAoY2hhciAqKWluOworICNlbHNlCisgICAgIHJldHVybiBtYm94
bmFtZV9nZXRfaWQoaW4sIGluX2xlbiwgZG9tYWluLCBvdXRfbGVuLCAmcmJ0X2ludF90b19leHQs
ICZyYnRfZXh0X3RvX2ludCwgSU5URVJOQUx8KGZsYWdzJihMREFQX05BTUVfTVVTVF9FWElTVFN8
RE9OVF9SRVRVUk5fRVhJU1RFTlQpKSk7CisgI2VuZGlmCisgfQorIAorIHN0YXRpYyBjaGFyICpt
Ym94bmFtZV9nZXRfaW50ZXJuYWxfaWQoY29uc3QgY2hhciAqaW4sIGludCBpbl9sZW4sIGNvbnN0
IGNoYXIgKmRvbWFpbiwgaW50ICpvdXRfbGVuKQorIHsKKyAjaWZuZGVmIEVOQUJMRV9DT05WRVJU
X1VTRVJJRAorICAgICAqb3V0X2xlbiA9IGluX2xlbjsKKyAgICAgcmV0dXJuIChjaGFyICopaW47
CisgI2Vsc2UKKyAgICAgcmV0dXJuIG1ib3huYW1lX2dldF9pZChpbiwgaW5fbGVuLCBkb21haW4s
IG91dF9sZW4sICZyYnRfZXh0X3RvX2ludCwgJnJidF9pbnRfdG9fZXh0LCBMREFQX05BTUVfTVVT
VF9FWElTVFMpOworICNlbmRpZgorIH0KICAKICBzdGF0aWMgaW50IG1ib3huYW1lX2NoZWNrX2hp
ZXJzZXBzKHN0cnVjdCBuYW1lc3BhY2UgKm5hbWVzcGFjZSwgY29uc3QgY2hhciAqbmFtZSwgaW50
IG5hbWVsZW4pCiAgewoqKioqKioqKioqKioqKioKKioqIDIwNSwyMTEgKioqKgogIAkJCQkgICBj
b25zdCBjaGFyICpuYW1lLAogIAkJCQkgICBjb25zdCBjaGFyICp1c2VyaWQsIGNoYXIgKnJlc3Vs
dCkKICB7CiEgICAgIGNoYXIgKmNwOwogICAgICBpbnQgdXNlcmxlbiwgZG9tYWlubGVuID0gMCwg
bmFtZWxlbjsKICAgICAgaW50IHByZWZpeGxlbjsKICAgICAgc2l6ZV90IHJlc3VsdGxlbjsKLS0t
IDU0OSw1NTUgLS0tLQogIAkJCQkgICBjb25zdCBjaGFyICpuYW1lLAogIAkJCQkgICBjb25zdCBj
aGFyICp1c2VyaWQsIGNoYXIgKnJlc3VsdCkKICB7CiEgICAgIGNoYXIgKmNwLCAqZG9tYWluPSIi
OwogICAgICBpbnQgdXNlcmxlbiwgZG9tYWlubGVuID0gMCwgbmFtZWxlbjsKICAgICAgaW50IHBy
ZWZpeGxlbjsKICAgICAgc2l6ZV90IHJlc3VsdGxlbjsKKioqKioqKioqKioqKioqCioqKiAyMjIs
MjI4ICoqKioKICAgICAgaWYgKGNvbmZpZ192aXJ0ZG9tYWlucykgewogIAlpZiAodXNlcmlkICYm
IChjcCA9IHN0cmNocih1c2VyaWQsICdAJykpKSB7CiAgCSAgICAvKiB1c2VyIGxvZ2dlZCBpbiBh
cyB1c2VyQGRvbWFpbiAqLwohIAkgICAgdXNlcmxlbiA9IGNwKysgLSB1c2VyaWQ7CiAgCSAgICBp
ZiAoIShjb25maWdfZGVmZG9tYWluICYmICFzdHJjYXNlY21wKGNvbmZpZ19kZWZkb21haW4sIGNw
KSkpIHsKICAJCS8qIGRvbid0IHByZXBlbmQgZGVmYXVsdCBkb21haW4gKi8KICAJCWRvbWFpbmxl
biA9IHN0cmxlbihjcCkrMTsKLS0tIDU2Niw1NzMgLS0tLQogICAgICBpZiAoY29uZmlnX3ZpcnRk
b21haW5zKSB7CiAgCWlmICh1c2VyaWQgJiYgKGNwID0gc3RyY2hyKHVzZXJpZCwgJ0AnKSkpIHsK
ICAJICAgIC8qIHVzZXIgbG9nZ2VkIGluIGFzIHVzZXJAZG9tYWluICovCiEgCSAgICB1c2VybGVu
ID0gY3AgLSB1c2VyaWQ7CiEgCSAgICBkb21haW4gPSArK2NwOwogIAkgICAgaWYgKCEoY29uZmln
X2RlZmRvbWFpbiAmJiAhc3RyY2FzZWNtcChjb25maWdfZGVmZG9tYWluLCBjcCkpKSB7CiAgCQkv
KiBkb24ndCBwcmVwZW5kIGRlZmF1bHQgZG9tYWluICovCiAgCQlkb21haW5sZW4gPSBzdHJsZW4o
Y3ApKzE7CioqKioqKioqKioqKioqKgoqKiogMjMzLDIzOCAqKioqCi0tLSA1NzgsNTg0IC0tLS0K
ICAJfQogIAlpZiAoKGNwID0gc3RycmNocihuYW1lLCAnQCcpKSkgewogIAkgICAgLyogbWFpbGJv
eCBzcGVjaWZpZWQgYXMgbWJveEBkb21haW4gKi8KKyAJICAgIGRvbWFpbiA9IGNwKzE7CiAgCSAg
ICBuYW1lbGVuID0gY3AgLSBuYW1lOwogIAogIAkgICAgaWYgKGNvbmZpZ19kZWZkb21haW4gJiYg
IXN0cmNhc2VjbXAoY29uZmlnX2RlZmRvbWFpbiwgY3ArMSkpIHsKKioqKioqKioqKioqKioqCioq
KiAyOTAsMzA3ICoqKioKICAKICAgICAgaWYgKCFzdHJuY21wKG5hbWUsIG5hbWVzcGFjZS0+cHJl
Zml4W05BTUVTUEFDRV9VU0VSXSwgcHJlZml4bGVuLTEpICYmCiAgCShuYW1lbGVuID09IHByZWZp
eGxlbi0xIHx8IG5hbWVbcHJlZml4bGVuLTFdID09IG5hbWVzcGFjZS0+aGllcl9zZXApKSB7CiAg
CiAgCWlmIChuYW1lbGVuID09IHByZWZpeGxlbi0xKSB7CiAgCSAgICAvKiBjYW4ndCBjcmVhdGUg
Zm9sZGVycyB1c2luZyB1bmRlbGltaXRlZCBwcmVmaXggKi8KICAJICAgIHJldHVybiBJTUFQX01B
SUxCT1hfQkFETkFNRTsKICAJfQogIAohIAlpZiAoZG9tYWlubGVuK25hbWVsZW4tcHJlZml4bGVu
KzUgPiBNQVhfTUFJTEJPWF9OQU1FKSB7CiEgCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5B
TUU7CiAgCX0KICAKISAJc3ByaW50ZihyZXN1bHQsICJ1c2VyLiUuKnMiLCBuYW1lbGVuLXByZWZp
eGxlbiwgbmFtZStwcmVmaXhsZW4pOwogIAogIAkvKiBUcmFuc2xhdGUgYW55IHNlcGFyYXRvcnMg
aW4gdXNlcmlkK21haWxib3ggKi8KICAJbWJveG5hbWVfaGllcnNlcF90b2ludGVybmFsKG5hbWVz
cGFjZSwgcmVzdWx0KzUsIDApOwogIAlyZXR1cm4gMDsKLS0tIDYzNiw3MTQgLS0tLQogIAogICAg
ICBpZiAoIXN0cm5jbXAobmFtZSwgbmFtZXNwYWNlLT5wcmVmaXhbTkFNRVNQQUNFX1VTRVJdLCBw
cmVmaXhsZW4tMSkgJiYKICAJKG5hbWVsZW4gPT0gcHJlZml4bGVuLTEgfHwgbmFtZVtwcmVmaXhs
ZW4tMV0gPT0gbmFtZXNwYWNlLT5oaWVyX3NlcCkpIHsKKyAJY2hhciBtb2RpZmllZF91c2VybmFt
ZVtNQVhfTUFJTEJPWF9OQU1FKzFdOworIAljaGFyICppbnRfaWQ9IiI7CisgCXNpemVfdCBpbnRf
aWRfbGVuPTA7CisgCXNpemVfdCBleHRfaWRfbGVuPTA7CiAgCiAgCWlmIChuYW1lbGVuID09IHBy
ZWZpeGxlbi0xKSB7CiAgCSAgICAvKiBjYW4ndCBjcmVhdGUgZm9sZGVycyB1c2luZyB1bmRlbGlt
aXRlZCBwcmVmaXggKi8KICAJICAgIHJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsKICAJfQog
IAohIAlpZighaW1hcGRfY29udmVydHVzZXJpZCkgewohIAkgICAgaWYgKGRvbWFpbmxlbituYW1l
bGVuLXByZWZpeGxlbis1ID4gTUFYX01BSUxCT1hfTkFNRSkKISAJCXJldHVybiBJTUFQX01BSUxC
T1hfQkFETkFNRTsKISAJICAgIG5hbWUrPXByZWZpeGxlbjsKICAJfQorIAllbHNlIHsKKyAJICAg
IGNoYXIgKnNlcDsKICAKISAJICAgIG5hbWUrPXByZWZpeGxlbjsKISAJICAgIHNlcD1zdHJjaHIo
bmFtZSxuYW1lc3BhY2UtPmhpZXJfc2VwKTsKISAJICAgIGlmKCFzZXAgfHwgc2VwLW5hbWUgPj0g
bmFtZWxlbi1wcmVmaXhsZW4pCiEgCQlleHRfaWRfbGVuID0gbmFtZWxlbi1wcmVmaXhsZW47CiEg
CSAgICBlbHNlCiEgCQlleHRfaWRfbGVuID0gc2VwLW5hbWU7CiEgCiEgCSAgICBpZighZXh0X2lk
X2xlbikKISAJCXJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsKISAJICAgIAohIAkgICAgLyog
d2UgbXVzdCB0cmFuc2Zvcm0gaGllcmFyY2h5IHNlcGFyYXRvcnMgaW4gdGhlIF91c2VyX2lkXwoh
IAkgICAgICAgaW50byBpbnRlcm5hbCByZXByZXNlbnRhdGlvbnMgYmVmb3JlIHF1ZXJ5aW5nIHRo
ZQohIAkgICAgICAgaW50ZXJuYWwgdXNlciBpZCBiZWNhdXNlIHRoZSByZXZlcnQgdHJhbnNmb3Jt
YXRpb24KISAJICAgICAgIHdvcmtzIHdpdGggdXNlcm5hbWVzIG9ubHkgYW5kIGtub3dzIG5vdGhp
bmcgYWJvdXQKISAJICAgICAgIHNlcGFyYXRvcnMgLS0gc29yY2VyZXIgKi8KISAJICAgIG1lbWNw
eShtb2RpZmllZF91c2VybmFtZSwgbmFtZSwgZXh0X2lkX2xlbik7CiEgCSAgICBtYm94bmFtZV9o
aWVyc2VwX3RvaW50ZXJuYWwobmFtZXNwYWNlLCBtb2RpZmllZF91c2VybmFtZSxleHRfaWRfbGVu
KTsKISAKISAJICAgIGludF9pZCA9IG1ib3huYW1lX2dldF9pbnRlcm5hbF9pZChtb2RpZmllZF91
c2VybmFtZSwgZXh0X2lkX2xlbiwgZG9tYWluLCAmaW50X2lkX2xlbik7CiEgCSAgICBpZighaW50
X2lkKSB7CiEgCQljaGFyIHRlbXBfbWJuYW1lW01BWF9NQUlMQk9YX05BTUUrMV07CiEgCiEgCQlp
ZighaW1hcGRfbm9uY29udmVydGVkdXNlcmlkX2FsbG93ZWQpCiEgCQkgICAgcmV0dXJuIElNQVBf
TUFJTEJPWF9OT05FWElTVEVOVDsKISAKISAJCS8qIGJ1aWxkIGludGVybmFsIG1haWxib3ggbmFt
ZSB3aXRoIGdpdmVuIHVzZXJpZCB0bwohIAkJICAgY2hlY2sgaWYgdGhpcyBtYWlsYm94IGV4aXN0
cyAqLwohIAkJaWYoZG9tYWlubGVuK25hbWVsZW4tcHJlZml4bGVuKzUgPiBNQVhfTUFJTEJPWF9O
QU1FKQohIAkJICAgIHJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsKICAKKyAJCW1lbWNweSh0
ZW1wX21ibmFtZSwgInVzZXIuIiwgNSk7CisgCQltZW1jcHkodGVtcF9tYm5hbWUrNSwgbW9kaWZp
ZWRfdXNlcm5hbWUsIGV4dF9pZF9sZW4pOworIAkJbWVtY3B5KHRlbXBfbWJuYW1lKzUrZXh0X2lk
X2xlbiwgbmFtZStleHRfaWRfbGVuLCBuYW1lbGVuLXByZWZpeGxlbi1leHRfaWRfbGVuKTsKKyAJ
CXRlbXBfbWJuYW1lWzUrbmFtZWxlbi1wcmVmaXhsZW5dPTA7CisgCisgCQltYm94bmFtZV9oaWVy
c2VwX3RvaW50ZXJuYWwobmFtZXNwYWNlLCB0ZW1wX21ibmFtZSs1LCAwKTsKKyAJCWlmKG1ib3hs
aXN0X2xvb2t1cCh0ZW1wX21ibmFtZSwgTlVMTCwgTlVMTCwgTlVMTCkpCisgCQkgICAgcmV0dXJu
IElNQVBfTUFJTEJPWF9OT05FWElTVEVOVDsKKyAJCSAgICAKKyAJCS8qIGxvb2sgZm9yIGludGVy
bmFsIGlkIHdpdGggdGhlIHZhbHVlIG9mIGdpdmVuCisgCQkgICBleHRlcm5hbCBpZCAqLworIAkJ
aW50X2lkID0gbWJveG5hbWVfZ2V0X2V4dGVybmFsX2lkKG1vZGlmaWVkX3VzZXJuYW1lLCBleHRf
aWRfbGVuLCBkb21haW4sICZpbnRfaWRfbGVuLCBET05UX1JFVFVSTl9FWElTVEVOVCk7CisgCQkv
KiBjb252ZXJ0IGVycm9yIG9yIHRoZSBpbnRlcm5hbCBpZCBleGlzdHMgaW4gTERBUCBhcworIAkJ
ICAgZXh0ZXJuYWwgKi8KKyAJCWlmKCFpbnRfaWQpCisgCQkgICAgcmV0dXJuIElNQVBfTUFJTEJP
WF9OT05FWElTVEVOVDsKKyAJCS8qIG90aGVyd2lzZSB1c2UgaW50ZXJuYWwgaWQgKi8KKyAJICAg
IH0KKyAJICAgIGlmKGRvbWFpbmxlbituYW1lbGVuLXByZWZpeGxlbis1LWV4dF9pZF9sZW4raW50
X2lkX2xlbiA+IE1BWF9NQUlMQk9YX05BTUUpCisgCQlyZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5B
TUU7CisgCSAgICBuYW1lKz1leHRfaWRfbGVuOworIAl9CisgCisgCXNwcmludGYocmVzdWx0LCAi
dXNlci4lLipzJS4qcyIsIGludF9pZF9sZW4sIGludF9pZCwgbmFtZWxlbi1wcmVmaXhsZW4tZXh0
X2lkX2xlbiwgbmFtZSk7CisgCQogIAkvKiBUcmFuc2xhdGUgYW55IHNlcGFyYXRvcnMgaW4gdXNl
cmlkK21haWxib3ggKi8KICAJbWJveG5hbWVfaGllcnNlcF90b2ludGVybmFsKG5hbWVzcGFjZSwg
cmVzdWx0KzUsIDApOwogIAlyZXR1cm4gMDsKKioqKioqKioqKioqKioqCioqKiAzOTksNDA1ICoq
KioKICBzdGF0aWMgaW50IG1ib3huYW1lX3RvZXh0ZXJuYWxfYWx0KHN0cnVjdCBuYW1lc3BhY2Ug
Km5hbWVzcGFjZSwgY29uc3QgY2hhciAqbmFtZSwKICAJCQkJICBjb25zdCBjaGFyICp1c2VyaWQs
IGNoYXIgKnJlc3VsdCkKICB7CiEgICAgIGNoYXIgKmRvbWFpbjsKICAgICAgc2l6ZV90IHVzZXJs
ZW4sIHJlc3VsdGxlbjsKICAKICAgICAgLyogQmxhbmsgdGhlIHJlc3VsdCwganVzdCBpbiBjYXNl
ICovCi0tLSA4MDYsODEyIC0tLS0KICBzdGF0aWMgaW50IG1ib3huYW1lX3RvZXh0ZXJuYWxfYWx0
KHN0cnVjdCBuYW1lc3BhY2UgKm5hbWVzcGFjZSwgY29uc3QgY2hhciAqbmFtZSwKICAJCQkJICBj
b25zdCBjaGFyICp1c2VyaWQsIGNoYXIgKnJlc3VsdCkKICB7CiEgICAgIGNoYXIgKmRvbWFpbj1O
VUxMOwogICAgICBzaXplX3QgdXNlcmxlbiwgcmVzdWx0bGVuOwogIAogICAgICAvKiBCbGFuayB0
aGUgcmVzdWx0LCBqdXN0IGluIGNhc2UgKi8KKioqKioqKioqKioqKioqCioqKiA0MTUsNDI3ICoq
KioKICAJc2l6ZV90IGRvbWFpbmxlbiA9IHN0cmxlbihkb21haW4pOwogIAogIAl1c2VybGVuID0g
ZG9tYWluIC0gdXNlcmlkOwogIAohIAlpZiAoIXN0cm5jbXAobmFtZSwgZG9tYWluKzEsIGRvbWFp
bmxlbi0xKSAmJgohIAkgICAgbmFtZVtkb21haW5sZW4tMV0gPT0gJyEnKSB7CiEgCSAgICBuYW1l
ICs9IGRvbWFpbmxlbjsKICAJfQogICAgICB9CiAgCiAgICAgIC8qIFBlcnNvbmFsIChJTkJPWCkg
bmFtZXNwYWNlICovCiAgICAgIGlmICghc3RybmNhc2VjbXAobmFtZSwgImluYm94IiwgNSkgJiYK
ICAJKG5hbWVbNV0gPT0gJ1wwJyB8fCBuYW1lWzVdID09ICcuJykpIHsKLS0tIDgyMiw4NDAgLS0t
LQogIAlzaXplX3QgZG9tYWlubGVuID0gc3RybGVuKGRvbWFpbik7CiAgCiAgCXVzZXJsZW4gPSBk
b21haW4gLSB1c2VyaWQ7CisgCWRvbWFpbisrOworIAlkb21haW5sZW4tLTsKICAKISAJaWYgKCFz
dHJuY21wKG5hbWUsIGRvbWFpbiwgZG9tYWlubGVuKSAmJgohIAkgICAgbmFtZVtkb21haW5sZW5d
ID09ICchJykgewohIAkgICAgbmFtZSArPSBkb21haW5sZW4rMTsKICAJfQogICAgICB9CiAgCisg
ICAgIC8qIHNldCB0aGUgZW1wdHkgZG9tYWluIGlmIGl0IGRvZXNuJ3QgZXhpc3RzICovCisgICAg
IGlmKCFkb21haW4pCisgCWRvbWFpbj0iIjsKKyAKICAgICAgLyogUGVyc29uYWwgKElOQk9YKSBu
YW1lc3BhY2UgKi8KICAgICAgaWYgKCFzdHJuY2FzZWNtcChuYW1lLCAiaW5ib3giLCA1KSAmJgog
IAkobmFtZVs1XSA9PSAnXDAnIHx8IG5hbWVbNV0gPT0gJy4nKSkgewoqKioqKioqKioqKioqKioK
KioqIDQ0NSw0NjIgKioqKgogICAgICBlbHNlIGlmICghc3RybmNtcChuYW1lLCAidXNlciIsIDQp
ICYmCiAgCSAgICAgKG5hbWVbNF0gPT0gJ1wwJyB8fCBuYW1lWzRdID09ICcuJykpIHsKICAJc2l6
ZV90IHByZWZpeGxlbiA9IHN0cmxlbihuYW1lc3BhY2UtPnByZWZpeFtOQU1FU1BBQ0VfVVNFUl0p
OwogIAohIAlpZiAoKHByZWZpeGxlbiA+IE1BWF9NQUlMQk9YX05BTUUpIHx8IAohIAkgICAgKChu
YW1lWzRdID09ICcuJykgJiYgCiEgCSAgICAgKChwcmVmaXhsZW4rMStzdHJsZW4obmFtZSs1KSkg
PiBNQVhfTUFJTEJPWF9OQU1FKSkpCiAgCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7
CiAgCiAgCXNwcmludGYocmVzdWx0LCAiJS4qcyIsCiAgCQlwcmVmaXhsZW4tMSwgbmFtZXNwYWNl
LT5wcmVmaXhbTkFNRVNQQUNFX1VTRVJdKTsKICAJcmVzdWx0bGVuID0gc3RybGVuKHJlc3VsdCk7
CiEgCWlmIChuYW1lWzRdID09ICcuJykgewohIAkgICAgc3ByaW50ZihyZXN1bHQrcmVzdWx0bGVu
LCAiJWMlcyIsIG5hbWVzcGFjZS0+aGllcl9zZXAsIG5hbWUrNSk7CiEgCX0KICAgICAgfQogIAog
ICAgICAvKiBTaGFyZWQgbmFtZXNwYWNlICovCi0tLSA4NTgsOTA5IC0tLS0KICAgICAgZWxzZSBp
ZiAoIXN0cm5jbXAobmFtZSwgInVzZXIiLCA0KSAmJgogIAkgICAgIChuYW1lWzRdID09ICdcMCcg
fHwgbmFtZVs0XSA9PSAnLicpKSB7CiAgCXNpemVfdCBwcmVmaXhsZW4gPSBzdHJsZW4obmFtZXNw
YWNlLT5wcmVmaXhbTkFNRVNQQUNFX1VTRVJdKTsKKyAJY2hhciAqZXh0X2lkPSIiOworIAlzaXpl
X3QgZXh0X2lkX2xlbj0wOwogIAohIAlpZiAocHJlZml4bGVuID4gTUFYX01BSUxCT1hfTkFNRSkK
ICAJICAgIHJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsKKyAJCisgCWlmKG5hbWVbNF0gPT0g
Jy4nKSB7CisgCSAgICBpZighaW1hcGRfY29udmVydHVzZXJpZCkgeworIAkJaWYoKHByZWZpeGxl
bisxK3N0cmxlbihuYW1lKzUpKSA+IE1BWF9NQUlMQk9YX05BTUUpCisgCQkgICAgcmV0dXJuIElN
QVBfTUFJTEJPWF9CQUROQU1FOworIAkJbmFtZSs9NTsKKyAJICAgIH0KKyAJICAgIC8qIGZldGNo
aW5nIHRoZSB1c2VyJ3MgaWRlbnRpZmllciAvLyBzb3JjZXJlciAqLworIAkgICAgZWxzZSB7Cisg
CQljaGFyICpzZXA7CisgCQlzaXplX3QgaW50X2lkX2xlbjsKKyAKKyAJCW5hbWUrPTU7CisgCQlz
ZXA9c3RyY2hyKG5hbWUsJy4nKTsKKyAJCWlmKHNlcCkKKyAJCSAgICBpbnRfaWRfbGVuPXNlcC1u
YW1lOworIAkJZWxzZQorIAkJICAgIGludF9pZF9sZW49c3RybGVuKG5hbWUpOworIAorIAkJaWYo
IWludF9pZF9sZW4pCisgCQkgICAgcmV0dXJuIElNQVBfTUFJTEJPWF9CQUROQU1FOworIAorIAkJ
Lyogd2UgYXNzdW1lIHRoYXQgdGhlIHVzZXIgZG9tYWluIGlzIHNhbWUgYXMgdGhlIG5hbWUncwor
IAkJICAgZG9tYWluICovCisgCQlleHRfaWQgPSBtYm94bmFtZV9nZXRfZXh0ZXJuYWxfaWQobmFt
ZSwgaW50X2lkX2xlbiwgZG9tYWluLCAmZXh0X2lkX2xlbiwgKCFpbWFwZF9ub25jb252ZXJ0ZWR1
c2VyaWRfYWxsb3dlZCk/TERBUF9OQU1FX01VU1RfRVhJU1RTOjApOworIAkJaWYoIWV4dF9pZCkK
KyAJCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX05PTkVYSVNURU5UOworIAkJaWYocHJlZml4bGVu
ICsgZXh0X2lkX2xlbiArIHN0cmxlbihuYW1lK2ludF9pZF9sZW4pID4gTUFYX01BSUxCT1hfTkFN
RSkKKyAJCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7CisgCQluYW1lKz1pbnRfaWRf
bGVuOworIAkgICAgfQorIAl9CiAgCiAgCXNwcmludGYocmVzdWx0LCAiJS4qcyIsCiAgCQlwcmVm
aXhsZW4tMSwgbmFtZXNwYWNlLT5wcmVmaXhbTkFNRVNQQUNFX1VTRVJdKTsKICAJcmVzdWx0bGVu
ID0gc3RybGVuKHJlc3VsdCk7CiEgCiEgCS8qIGluIHRoZSBjYXNlIGlmIGZldGNoaW5nIGlkIGlz
bid0IGVuYWJsZWQsIGV4dF9pZCB2YXJpYWJsZQohIAkgICB3aWxsIGJlIGVtcHR5IGFuZCBuYW1l
IHZhcmlhYmxlIHdpbGwgY29uc2lzdCBvZiB0aGUgZnVsbAohIAkgICBtYWlsYm94IG5hbWUgd2l0
aG91dCBuYW1lc3BhY2UtPnByZWZpeFtOQU1FU1BBQ0VfVVNFUl0gKi8KISAJc3ByaW50ZihyZXN1
bHQrcmVzdWx0bGVuLCAiJWMlLipzJXMiLCBuYW1lc3BhY2UtPmhpZXJfc2VwLCBleHRfaWRfbGVu
LCBleHRfaWQsIG5hbWUpOwogICAgICB9CiAgCiAgICAgIC8qIFNoYXJlZCBuYW1lc3BhY2UgKi8K
ZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9tYm94bmFtZS5oIGN5
cnVzLWltYXBkLTIuMi4xMi9pbWFwL21ib3huYW1lLmgKKioqIGN5cnVzLWltYXBkLTIuMi4xMi5v
bGQvaW1hcC9tYm94bmFtZS5oCTIwMDUtMTEtMDcgMTg6MjQ6NDQgKzAzMDAKLS0tIGN5cnVzLWlt
YXBkLTIuMi4xMi9pbWFwL21ib3huYW1lLmgJMjAwNS0xMS0yMiAxODo1Nzo1MyArMDMwMAoqKioq
KioqKioqKioqKioKKioqIDc4LDgzICoqKioKLS0tIDc4LDkxIC0tLS0KICAJCQkgICAgdm9pZCAq
cm9jaywgaW50IGZvcmNlKTsKICB9OwogIAorICNpZmRlZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQK
KyAvKiBjb252ZXJ0IHVzZXJpZCBpbml0aWFsaXphdGlvbiBhbmQgY2xlYW51cCAqLworIGludCBj
b252ZXJ0dXNlcmlkX2luaXQoKTsKKyBpbnQgY29udmVydHVzZXJpZF9jbGVhbnVwKCk7CisgLyog
ZGVzdHJveSBhZGRpdGlvbmFsIGluZm9ybWF0aW9uIHdoaWNoIGlzIG5lZWRlZCB0byB0cmFuc2Zv
cm0gdXNlcmlkcyAqLworIHZvaWQgbWJveG5hbWVfY2xlYW51cCgpOworICNlbmRpZiAvKiBFTkFC
TEVfQ09OVkVSVF9VU0VSSUQgKi8KKyAKICAvKiBjcmVhdGUgbmFtZXNwYWNlIGJhc2VkIG9uIGdp
dmVuIG9wdGlvbnMgKi8KICBpbnQgbWJveG5hbWVfaW5pdF9uYW1lc3BhY2VfZXh0KHN0cnVjdCBu
YW1lc3BhY2UgKm5hbWVzcGFjZSwgaW50IGlzYWRtaW4sIGNoYXIgaGllcl9zZXAsIGludCBpc2Fs
dCk7CiAgLyogQ3JlYXRlIG5hbWVzcGFjZSBiYXNlZCBvbiBjb25maWcgb3B0aW9ucy4gKi8KZGlm
ZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbGliL2hhc2guYyBjeXJ1cy1pbWFw
ZC0yLjIuMTIvbGliL2hhc2guYwoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9saWIvaGFzaC5j
CTIwMDQtMDUtMjQgMTg6MzI6MzQgKzA0MDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9saWIvaGFz
aC5jCTIwMDUtMTEtMjIgMTg6NTc6NTQgKzAzMDAKKioqKioqKioqKioqKioqCioqKiAzMTcsMzIy
ICoqKioKLS0tIDMxNywzNTUgLS0tLQogICAgICAgIH0KICB9CiAgCisgLyogU2FtZSBhcyBoYXNo
X2VudW1lcmF0ZSgpIGJ1dCBoYXMgYWJpbGl0eSB0byBkZWxldGUga2V5cyB3aGlsZSBnb2luZwor
ICAgIHRocm91Z2ggYSBoYXNoIHRhYmxlLiBSZXR1cm4gbm9uLXplcm8gdmFsdWUgZnJvbSB0aGUg
Y2FsbGJhY2sKKyAgICBmdW5jdGlvbiBpZiB5b3Ugd2FudCB0byBkZWxldGUgYSBrZXkuIERlbGV0
ZSBhbnkgZXh0ZXJuYWwgZGF0YQorICAgIHlvdXJzZWxmLiAqLworIHZvaWQgaGFzaF93YWxrKGhh
c2hfdGFibGUgKnRhYmxlLCBpbnQgKCpmdW5jKShjaGFyICosIHZvaWQgKiwgdm9pZCAqKSwKKyAJ
CSAgICB2b2lkICpyb2NrKQorIHsKKyAgICAgdW5zaWduZWQgaTsKKyAgICAgYnVja2V0ICp0ZW1w
LCAqdGVtcF9vbGQsICp0ZW1wX25leHQ7CisgCisgICAgIGZvciAoaT0wO2k8dGFibGUtPnNpemU7
IGkrKykgeworIAlpZiAoKHRhYmxlLT50YWJsZSlbaV0gIT0gTlVMTCkgeworIAkgICAgZm9yICh0
ZW1wID0gKHRhYmxlLT50YWJsZSlbaV0sIHRlbXBfb2xkPU5VTEw7CisgCQkgTlVMTCAhPSB0ZW1w
OworIAkJIHRlbXAgPSB0ZW1wX25leHQpIHsKKyAKKyAJCXRlbXBfbmV4dCA9IHRlbXAtPm5leHQ7
CisgCQlpZihmdW5jKHRlbXAgLT4ga2V5LCB0ZW1wLT5kYXRhLCByb2NrKSkgeworIAkJICAgIGlm
KHRlbXBfb2xkKQorIAkJCXRlbXBfb2xkLT5uZXh0ID0gdGVtcF9uZXh0OworIAkJICAgIGVsc2UK
KyAJCQkodGFibGUtPnRhYmxlKVtpXSA9IHRlbXBfbmV4dDsKKyAJCSAgICBpZighdGFibGUtPnBv
b2wpIHsKKyAJCQlmcmVlKHRlbXAtPmtleSk7CisgCQkJZnJlZSh0ZW1wKTsKKyAJCSAgICB9Cisg
CQl9CisgCQllbHNlCisgCQkgICAgdGVtcF9vbGQ9dGVtcDsKKyAJICAgIH0KKyAJfQorICAgICB9
CisgfQogIAogICNpZmRlZiBURVNUCiAgCmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1pbWFwZC0yLjIu
MTIub2xkL2xpYi9oYXNoLmggY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9oYXNoLmgKKioqIGN5cnVz
LWltYXBkLTIuMi4xMi5vbGQvbGliL2hhc2guaAkyMDAzLTEwLTIyIDIyOjUwOjEyICswNDAwCi0t
LSBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2hhc2guaAkyMDA1LTExLTIyIDE4OjU3OjU0ICswMzAw
CioqKioqKioqKioqKioqKgoqKiogNzgsODMgKioqKgotLS0gNzgsOTAgLS0tLQogIHZvaWQgaGFz
aF9lbnVtZXJhdGUoaGFzaF90YWJsZSAqdGFibGUsdm9pZCAoKmZ1bmMpKGNoYXIgKix2b2lkICos
dm9pZCAqKSwKICAJCSAgICB2b2lkICpyb2NrKTsKICAKKyAvKiBTYW1lIGFzIGhhc2hfZW51bWVy
YXRlKCkgYnV0IGhhcyBhYmlsaXR5IHRvIGRlbGV0ZSBrZXlzIHdoaWxlIGdvaW5nCisgICAgdGhy
b3VnaCBhIGhhc2ggdGFibGUuIFJldHVybiBub24temVybyB2YWx1ZSBmcm9tIHRoZSBjYWxsYmFj
aworICAgIGZ1bmN0aW9uIGlmIHlvdSB3YW50IHRvIGRlbGV0ZSBhIGtleS4gRGVsZXRlIGFueSBl
eHRlcm5hbCBkYXRhCisgICAgeW91cnNlbGYuICovCisgdm9pZCBoYXNoX3dhbGsoaGFzaF90YWJs
ZSAqdGFibGUsIGludCAoKmZ1bmMpKGNoYXIgKiwgdm9pZCAqLCB2b2lkICopLAorIAkgICAgICAg
dm9pZCAqcm9jayk7CisgCiAgLyoKICAqKiBGcmVlcyBhIGhhc2ggdGFibGUuICBGb3IgZWFjaCBu
b2RlIHRoYXQgd2FzIGluc2VydGVkIGluIHRoZSB0YWJsZSwKICAqKiBpdCBjYWxscyB0aGUgZnVu
Y3Rpb24gd2hvc2UgYWRkcmVzcyBpdCB3YXMgcGFzc2VkLCB3aXRoIGEgcG9pbnRlcgpkaWZmIC1O
IC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9saWIvaW1hcG9wdGlvbnMgY3lydXMtaW1h
cGQtMi4yLjEyL2xpYi9pbWFwb3B0aW9ucwoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9saWIv
aW1hcG9wdGlvbnMJMjAwNS0xMS0wNyAxODowNTozNiArMDMwMAotLS0gY3lydXMtaW1hcGQtMi4y
LjEyL2xpYi9pbWFwb3B0aW9ucwkyMDA1LTExLTIzIDE1OjQxOjQ3ICswMzAwCioqKioqKioqKioq
KioqKgoqKiogOTEwLDkxNSAqKioqCi0tLSA5MTAsOTYyIC0tLS0KICAgICBpbnRlcmZhY2UsIG90
aGVyd2lzZSB0aGUgdXNlciBpcyBhc3N1bWVkIHRvIGJlIGluIHRoZSBkZWZhdWx0CiAgICAgZG9t
YWluIChpZiBzZXQpLiAqLwogIAorIHsgImNvbnZlcnR1c2VyaWQiLCAwLCBTV0lUQ0ggfQorIC8q
IEVuYWJsZSB1c2VyIGlkZW50aWZpZXJzIGNvbnZlcnNpb24gdmlhIExEQVAuIFRoaXMgaXMgYSBk
ZWZhdWx0CisgICAgcnVsZTogaXQgaXMgcG9zc2libGUgdG8gc2V0IGV4ZW1wdGlvbnMgb24gc29t
ZSBzZXQgb2YgdXNlcnMgdmlhCisgICAgY29udmVydHVzZXJpZF9leGVtcHRzIGNvbmZpZyB2YXJp
YWJsZS4gSWYgdXNlcidzIHJ1bGUgaXMgJ2NvbnZlcnQnCisgICAgdGhlbiBoZSBkb2Vzbid0IHNl
ZSB1c2VyIGlkZW50aWZpZXJzIHZpYSBJTUFQIGNvbW1hbmRzLiBJbnN0ZWFkLAorICAgIG5hbWVz
IGdvdCBmcm9tIExEQVAgYXJlIHNob3dlZC4gVGhpcyBvcHRpb24gaXMgcmVyZWFkZWQgb24gZWFj
aAorICAgIG5ldyBjb25uZWN0ZWQgSU1BUCBjbGllbnQsIHNvIHlvdSBkb24ndCBuZWVkIHRvIHJl
c3RhcnQgdGhlIHNlcnZlcgorICAgIHRvIGFwcGx5IGNoYW5nZXMuICovCisgCisgeyAiY29udmVy
dHVzZXJpZF9leGVtcHRzIiwgTlVMTCwgU1RSSU5HIH0KKyAvKiBFeGVtdGlvbnMgKGxpc3Qgb2Yg
dXNlciBpZGVudGlmaWVycykgZnJvbSBjb252ZXJ0dXNlcmlkIG9wdGlvbi4KKyAgICBUaGlzIG9w
dGlvbiBpcyByZXJlYWRlZCBvbiBlYWNoIG5ldyBjb25uZWN0ZWQgSU1BUCBjbGllbnQuICovCisg
CisgeyAiY29udmVydHVzZXJpZF9hbGxvd19ub25jb252ZXJ0ZWQiLCAwLCBTV0lUQ0ggfQorIC8q
IEFsbG93IHRvIHVzZSBvcmlnaW5hbCB1c2VyaWRzIGlmIHRoZXJlIGFyZSBubyBpbmZvcm1hdGlv
biBvbgorICAgIHRoZW0gaW4gTERBUC4gVGhpcyBvcHRpb24gaXMgcmVyZWFkZWQgb24gZWFjaCBu
ZXcgY29ubmVjdGVkIElNQVAKKyAgICBjbGllbnQuICovCisgCisgeyAiY29udmVydHVzZXJpZF9s
b2NhbGhvc3QiLCAiMTI3LjAuMC4xIiwgU1RSSU5HIH0KKyAvKiBJUC1hZGRyZXNzIHdoaWNoIGxk
YXBkIHByb2Nlc3NlcyBhcmUgYmluZGluZyB0by4gWW91IHdpbGwgbmV2ZXIKKyAgICBuZWVkIHRv
IGNoYW5nZSB0aGUgZGVmYXVsdCB2YWx1ZS4gKi8KKyAKKyB7ICJjb252ZXJ0dXNlcmlkX3VkcHBv
cnQiLCAxMDAwMSwgSU5UIH0KKyAvKiBVRFAgcG9ydCBudW1iZXIgd2hlcmUgbGRhcGQgcHJvY2Vz
c2VzIGFyZSBsaXN0ZW5pbmcgb24uIGxkYXBkIGlzIGEKKyAgICBwcm9jZXNzIHdoaWNoIHBlcmZv
bXMgcXVlcmllcyB0byBMREFQLiAqLworIAorIHsgImNvbnZlcnR1c2VyaWRfbGRhcF9ob3N0Iiwg
TlVMTCwgU1RSSU5HIH0KKyAvKiBMREFQIHNlcnZlciBob3N0IHVzZWQgYnkgbGRhcGQuICovCisg
CisgeyAiY29udmVydHVzZXJpZF9sZGFwX3BvcnQiLCAzODksIElOVCB9CisgLyogTERBUCBzZXJ2
ZXIgcG9ydCB1c2VkIGJ5IGxkYXBkLiAqLworIAorIHsgImNvbnZlcnR1c2VyaWRfbGRhcF91c2Vy
IiwgTlVMTCwgU1RSSU5HIH0KKyAvKiBMREFQIHVzZXIgdXNlZCBieSBsZGFwZC4gKi8KKyAKKyB7
ICJjb252ZXJ0dXNlcmlkX2xkYXBfcGFzc3dvcmQiLCBOVUxMLCBTVFJJTkcgfQorIC8qIExEQVAg
dXNlcidzIHBhc3N3b3JkIHVzZWQgYnkgbGRhcGQuICovCisgCisgeyAiY29udmVydHVzZXJpZF9s
ZGFwX2Jhc2UiLCBOVUxMLCBTVFJJTkcgfQorIC8qIExEQVAgYmFzZSB1c2VkIGJ5IGxkYXBkLiAq
LworIAorIHsgImNvbnZlcnR1c2VyaWRfbGRhcF9hdHRyX2ludCIsICJ1aWQiLCBTVFJJTkcgfQor
IC8qIE5hbWUgb2YgTERBUCBhdHRyaWJ1dGUgc3RvcmluZyBpbnRlcm5hbCBuYW1lcyBvZiB1c2Vy
cy4gKi8KKyAKKyB7ICJjb252ZXJ0dXNlcmlkX2xkYXBfYXR0cl9leHQiLCAic24iLCBTVFJJTkcg
fQorIC8qIE5hbWUgb2YgTERBUCBhdHRyaWJ1dGUgc3RvcmluZyBleHRlcm5hbCBuYW1lcyBvZiB1
c2Vycy4gKi8KKyAKICAvKgogIC5TSCBTRUUgQUxTTwogIC5QUApkaWZmIC1OIC1DIDMgLXIgY3ly
dXMtaW1hcGQtMi4yLjEyLm9sZC9saWIvbGliY29uZmlnLmMgY3lydXMtaW1hcGQtMi4yLjEyL2xp
Yi9saWJjb25maWcuYwoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9saWIvbGliY29uZmlnLmMJ
MjAwNC0wNS0yMiAwNzo0NTo1NCArMDQwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9saWJj
b25maWcuYwkyMDA1LTExLTIyIDE4OjU3OjU0ICswMzAwCioqKioqKioqKioqKioqKgoqKiogMTYx
LDE2NyAqKioqCiAgICAgIGlmKGFsdF9jb25maWcpIGNvbmZpZ19maWxlbmFtZSA9IHhzdHJkdXAo
YWx0X2NvbmZpZyk7CiAgICAgIGVsc2UgY29uZmlnX2ZpbGVuYW1lID0geHN0cmR1cChDT05GSUdf
RklMRU5BTUUpOwogIAohICAgICBpZighY29uc3RydWN0X2hhc2hfdGFibGUoJmNvbmZpZ2hhc2gs
IENPTkZJR0hBU0hTSVpFLCAxKSkgewogIAlmYXRhbCgiY291bGQgbm90IGNvbnN0cnVjdCBjb25m
aWd1cmF0aW9uIGhhc2ggdGFibGUiLCBFQ19DT05GSUcpOwogICAgICB9CiAgCi0tLSAxNjEsMTcw
IC0tLS0KICAgICAgaWYoYWx0X2NvbmZpZykgY29uZmlnX2ZpbGVuYW1lID0geHN0cmR1cChhbHRf
Y29uZmlnKTsKICAgICAgZWxzZSBjb25maWdfZmlsZW5hbWUgPSB4c3RyZHVwKENPTkZJR19GSUxF
TkFNRSk7CiAgCiEgICAgIC8qIHdlIGRvbid0IHVzZSBtZW1vcnkgcG9vbCBmb3IgdGhpcyBoYXNo
IGJlY2F1c2Ugd2UgbWF5IGRlbGV0ZQohICAgICAgICBrZXlzIGZyb20gaXQgbWFueSB0aW1lcyAo
ZGVsZXRpb25zIGZyb20gcG9vbGVkIGhhc2ggbGVhayB0aGUKISAgICAgICAgbWVtb3J5KSAqLwoh
ICAgICBpZighY29uc3RydWN0X2hhc2hfdGFibGUoJmNvbmZpZ2hhc2gsIENPTkZJR0hBU0hTSVpF
LCAwKSkgewogIAlmYXRhbCgiY291bGQgbm90IGNvbnN0cnVjdCBjb25maWd1cmF0aW9uIGhhc2gg
dGFibGUiLCBFQ19DT05GSUcpOwogICAgICB9CiAgCioqKioqKioqKioqKioqKgoqKiogNTA4LDUx
MCAqKioqCi0tLSA1MTEsOTE5IC0tLS0KICAgICAgfQogICAgICBmY2xvc2UoaW5maWxlKTsKICB9
CisgCisgaW50IGNvbmZpZ190ZW1wbGF0ZV9jb21wYXJlKGNvbnN0IGNoYXIgKm9wdG5hbWUsIGlu
dCBvcHRpZCwgdGVtcGxhdGVfb3B0aW9uICpvcHRzLCBpbnQgb3B0c19sZW4pCisgeworICAgICBp
bnQgaTsKKyAKKyAgICAgZm9yKGk9MDsgaTxvcHRzX2xlbjsgaSsrKSB7CisgCXN3aXRjaChvcHRz
W2ldLnR5cGUpIHsKKyAJY2FzZSBURU1QTEFURU9QVF9UWVBFX0tOT1dOT1BUOgorIAkgICAgaWYo
b3B0aWQ9PShpbnQpb3B0c1tpXS52YWwpCisgCQlyZXR1cm4gMDsKKyAJICAgIGJyZWFrOworIAlj
YXNlIFRFTVBMQVRFT1BUX1RZUEVfRVhBQ1RNQVRDSDoKKyAJICAgIGlmKCFzdHJjbXAoKGNoYXIg
KilvcHRzW2ldLnZhbCwgb3B0bmFtZSkpCisgCQlyZXR1cm4gMDsKKyAJICAgIGJyZWFrOworIAlj
YXNlIFRFTVBMQVRFT1BUX1RZUEVfUFJFRklYOgorIAkgICAgaWYoIXN0cm5jbXAoKGNoYXIgKilv
cHRzW2ldLnZhbCwgb3B0bmFtZSwgc3RybGVuKChjaGFyICopb3B0c1tpXS52YWwpKSkKKyAJCXJl
dHVybiAwOworIAkgICAgYnJlYWs7CisgCX0KKyAgICAgfQorICAgICByZXR1cm4gMTsKKyB9Cisg
Cisgc3RhdGljIGludCBjb25maWdfcmVyZWFkX2ZpbGUoY29uc3QgY2hhciAqZmlsZW5hbWUsIHRl
bXBsYXRlX29wdGlvbiAqb3B0cywgaW50IG9wdHNfbGVuKQorIHsKKyAgICAgZW51bSBvcHR0eXBl
IG9wdCA9IElNQVBPUFRfWkVSTzsKKyAgICAgaW50IGxpbmVubyA9IDA7CisgICAgIGNoYXIgYnVm
WzQwOTZdLCBlcnJidWZbMTAyNF07CisgICAgIGNoYXIgKnAsICpxLCAqa2V5LCAqZnVsbGtleSwg
KnNydmtleSwgKnZhbCwgKm5ld3ZhbDsKKyAgICAgaW50IHNlcnZpY2Vfc3BlY2lmaWM7CisgICAg
IGludCBpZGxlbiA9IChjb25maWdfaWRlbnQgPyBzdHJsZW4oY29uZmlnX2lkZW50KSA6IDApOwor
ICAgICBGSUxFICppbmZpbGU7CisgCisgICAgIGlmKCFvcHRzX2xlbikKKyAJcmV0dXJuIDA7Cisg
CisgICAgIC8qIHJlYWQgaW4gY29uZmlnIGZpbGUgKi8KKyAgICAgaW5maWxlID0gZm9wZW4oZmls
ZW5hbWUsICJyIik7CisgICAgIGlmICghaW5maWxlKSB7CisgCXN0cmxjcHkoYnVmLCBDWVJVU19Q
QVRILCBzaXplb2YoYnVmKSk7CisgCXN0cmxjYXQoYnVmLCBmaWxlbmFtZSwgc2l6ZW9mKGJ1Zikp
OworIAlpbmZpbGUgPSBmb3BlbihidWYsICJyIik7CisgICAgIH0KKyAgICAgaWYgKCFpbmZpbGUp
IHsKKyAJc3lzbG9nKExPR19FUlIsICJjYW4ndCBvcGVuIGNvbmZpZ3VyYXRpb24gZmlsZSAlczog
JXMiLGZpbGVuYW1lLCBlcnJvcl9tZXNzYWdlKGVycm5vKSk7CisgCXJldHVybiAtMTsKKyAgICAg
fQorIAorICAgICAvKiBjaGVjayB0byBzZWUgaWYgd2UndmUgYWxyZWFkeSByZWFkIHRoaXMgZmls
ZSAqLworICAgICBpZiAoaGFzaF9sb29rdXAoZmlsZW5hbWUsICZpbmNsdWRlaGFzaCkpIHsKKyAJ
c3lzbG9nKExPR19FUlIsICJjb25maWd1cmF0aW9uIGZpbGUgJXMgaW5jbHVkZWQgdHdpY2UiLCBm
aWxlbmFtZSk7CisgCWZjbG9zZShpbmZpbGUpOworIAlyZXR1cm4gLTE7CisgICAgIH0KKyAgICAg
ZWxzZSB7CisgCWhhc2hfaW5zZXJ0KGZpbGVuYW1lLCAodm9pZCopIDB4REVBREJFRUYsICZpbmNs
dWRlaGFzaCk7CisgICAgIH0KKyAgICAgCisgICAgIHdoaWxlIChmZ2V0cyhidWYsIHNpemVvZihi
dWYpLCBpbmZpbGUpKSB7CisgCWxpbmVubysrOworIAorIAlzZXJ2aWNlX3NwZWNpZmljID0gMDsK
KyAJCisgCWlmIChidWZbMF0gJiYgYnVmW3N0cmxlbihidWYpLTFdID09ICdcbicpIGJ1ZltzdHJs
ZW4oYnVmKS0xXSA9ICdcMCc7CisgCWZvciAocCA9IGJ1ZjsgKnAgJiYgaXNzcGFjZSgoaW50KSAq
cCk7IHArKyk7CisgCWlmICghKnAgfHwgKnAgPT0gJyMnKSBjb250aW51ZTsKKyAKKyAJZnVsbGtl
eSA9IGtleSA9IHA7CisgCWlmICgqcCA9PSAnQCcpIHArKzsgIC8qIGFsbG93IEAgYXMgdGhlIGZp
cnN0IGNoYXIgKGZvciBkaXJlY3RpdmVzKSAqLworIAl3aGlsZSAoKnAgJiYgKGlzYWxudW0oKGlu
dCkgKnApIHx8ICpwID09ICctJyB8fCAqcCA9PSAnXycpKSB7CisgCSAgICBpZiAoaXN1cHBlcigo
dW5zaWduZWQgY2hhcikgKnApKSAqcCA9IHRvbG93ZXIoKHVuc2lnbmVkIGNoYXIpICpwKTsKKyAJ
ICAgIHArKzsKKyAJfQorIAlpZiAoKnAgIT0gJzonKSB7CisgCSAgICBzeXNsb2coTE9HX0VSUiwK
KyAJCSAgICJpbnZhbGlkIG9wdGlvbiBuYW1lIG9uIGxpbmUgJWQgb2YgY29uZmlndXJhdGlvbiBm
aWxlICVzIiwKKyAJCSAgICBsaW5lbm8sIGZpbGVuYW1lKTsKKyAJICAgIGZjbG9zZShpbmZpbGUp
OworIAkgICAgcmV0dXJuIC0xOworIAl9CisgCSpwKysgPSAnXDAnOworIAkKKyAJd2hpbGUgKCpw
ICYmIGlzc3BhY2UoKGludCkgKnApKSBwKys7CisgCQorIAkvKiByZW1vdmUgdHJhaWxpbmcgd2hp
dGVzcGFjZSAqLworIAlmb3IgKHEgPSBwICsgc3RybGVuKHApIC0gMTsgcSA+IHAgJiYgaXNzcGFj
ZSgoaW50KSAqcSk7IHEtLSkgeworIAkgICAgKnEgPSAnXDAnOworIAl9CisgCQorIAlpZiAoISpw
KSB7CisgCSAgICBzeXNsb2coTE9HX0VSUiwKKyAJCSAgICJlbXB0eSBvcHRpb24gdmFsdWUgb24g
bGluZSAlZCBvZiBjb25maWd1cmF0aW9uIGZpbGUiLAorIAkJICAgbGluZW5vKTsKKyAJICAgIGZj
bG9zZShpbmZpbGUpOworIAkgICAgcmV0dXJuIC0xOworIAl9CisgCQorIAlzcnZrZXkgPSBOVUxM
OworIAorIAkvKiBMb29rIGZvciBkaXJlY3RpdmVzICovCisgCWlmIChrZXlbMF0gPT0gJ0AnKSB7
CisgCSAgICBpZiAoIXN0cmNhc2VjbXAoa2V5LCAiQGluY2x1ZGUiKSkgeworIAkJaWYoY29uZmln
X3JlcmVhZF9maWxlKHAsb3B0cyxvcHRzX2xlbikpIHsKKyAJCSAgICBmY2xvc2UoaW5maWxlKTsK
KyAJCSAgICByZXR1cm4gLTE7CisgCQl9CisgCQljb250aW51ZTsKKyAJICAgIH0KKyAJICAgIGVs
c2UgeworIAkJc3lzbG9nKExPR19FUlIsCisgCQkgICAgICAgImludmFsaWQgZGlyZWN0aXZlIG9u
IGxpbmUgJWQgb2YgY29uZmlndXJhdGlvbiBmaWxlICVzIiwKKyAJCSAgICAgICBsaW5lbm8sIGZp
bGVuYW1lKTsKKyAJCWZjbG9zZShpbmZpbGUpOworIAkJcmV0dXJuIC0xOworIAkgICAgfQorIAl9
CisgCisgCS8qIEZpbmQgaWYgdGhlcmUgaXMgYSA8c2VydmljZT5fIHByZWZpeCAqLworIAlpZihj
b25maWdfaWRlbnQgJiYgIXN0cm5jYXNlY21wKGtleSwgY29uZmlnX2lkZW50LCBpZGxlbikgCisg
CSAgICYmIGtleVtpZGxlbl0gPT0gJ18nKSB7CisgCSAgICAvKiBza2lwIHNlcnZpY2VfIHByZWZp
eCAqLworIAkgICAgc3J2a2V5ID0ga2V5ICsgaWRsZW4gKyAxOworIAl9CisgCQorIAkvKiBsb29r
IGZvciBhIHNlcnZpY2VfIHByZWZpeCBtYXRjaCBpbiBpbWFwb3B0cyAqLworIAlpZihzcnZrZXkp
IHsKKyAJICAgIGZvciAob3B0ID0gSU1BUE9QVF9aRVJPOyBvcHQgPCBJTUFQT1BUX0xBU1Q7IG9w
dCsrKSB7CisgCQlpZiAoIXN0cmNhc2VjbXAoaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBzcnZrZXkp
KSB7CisgCQkgICAga2V5ID0gc3J2a2V5OworIAkJICAgIHNlcnZpY2Vfc3BlY2lmaWMgPSAxOwor
IAkJICAgIGJyZWFrOworIAkJfQorIAkgICAgfQorIAl9CisgCQorIAkvKiBEaWQgbm90IGZpbmQg
YSBzZXJ2aWNlXyBzcGVjaWZpYyBtYXRjaCwgdHJ5IGxvb2tpbmcgZm9yIGFuCisgCSAqIGV4YWN0
IG1hdGNoICovCisgCWlmKCFzZXJ2aWNlX3NwZWNpZmljKSB7CisgCSAgICBmb3IgKG9wdCA9IElN
QVBPUFRfWkVSTzsgb3B0IDwgSU1BUE9QVF9MQVNUOyBvcHQrKykgeworIAkJaWYgKCFzdHJjYXNl
Y21wKGltYXBvcHRzW29wdF0ub3B0bmFtZSwga2V5KSkgeworIAkJICAgIGJyZWFrOworIAkJfQor
IAkgICAgfQorIAl9CisgCisgCS8qIElmIGJvdGggb2YgdGhvc2UgbG9vcHMgZmFpbGVkLCBpdCBn
b2VzIHZlcmJhdGltIGludG8gdGhlCisgCSAqIG92ZXJmbG93IGhhc2ggdGFibGUuICovCisgCQor
IAlpZiAob3B0IDwgSU1BUE9QVF9MQVNUKSB7CisgCSAgICAvKiBza2lwIGFsbCBvcHRpb25zIGV4
Y2VwdCB0aG9zZSBtYWNoZWQgdGVtcGxhdGUgKi8KKyAJICAgIGlmKGNvbmZpZ190ZW1wbGF0ZV9j
b21wYXJlKGltYXBvcHRzW29wdF0ub3B0bmFtZSxvcHQsb3B0cyxvcHRzX2xlbikpCisgCQljb250
aW51ZTsKKyAKKyAJICAgIC8qIE9rYXksIHdlIGtub3cgYWJvdXQgdGhpcyBjb25maWd1cmUgb3B0
aW9uLgorIAkgICAgICogU28gZmlyc3QgY2hlY2sgdGhhdCB3ZSBoYXZlIGVpdGhlcgorIAkgICAg
ICogIDEuIG5vdCBzZWVuIGl0CisgCSAgICAgKiAgMi4gc2VlbiBpdHMgZ2VuZXJpYyBmb3JtLCBi
dXQgdGhpcyBpcyBhIHNlcnZpY2Ugc3BlY2lmaWMgZm9ybQorIAkgICAgICoKKyAJICAgICAqICBJ
ZiB3ZSBoYXZlIGFscmVhZHkgc2VlbiBhIHNlcnZpY2Utc3BlY2lmaWMgZm9ybSwgYW5kIHRoaXMg
aXMKKyAJICAgICAqICBhIGdlbmVyaWMgZm9ybSwganVzdCBza2lwIGl0IGFuZCBkb24ndCBtb2Fu
LgorIAkgICAgICovCisgCSAgICBpZigoaW1hcG9wdHNbb3B0XS5zZWVuID09IDEgJiYgIXNlcnZp
Y2Vfc3BlY2lmaWMpIAorIAkgICAgIHx8KGltYXBvcHRzW29wdF0uc2VlbiA9PSAyICYmIHNlcnZp
Y2Vfc3BlY2lmaWMpKSB7CisgCQlzeXNsb2coTE9HX0VSUiwKKyAJCSAgICAgICAib3B0aW9uICcl
cycgd2FzIHNwZWNpZmllZCB0d2ljZSBpbiBjb25maWcgZmlsZSAoc2Vjb25kIG9jY3VyYW5jZSBv
biBsaW5lICVkKSIsCisgCQkgICAgICAgZnVsbGtleSwgbGluZW5vKTsKKyAJCWZjbG9zZShpbmZp
bGUpOworIAkJcmV0dXJuIC0xOworIAkgICAgfSBlbHNlIGlmKGltYXBvcHRzW29wdF0uc2VlbiA9
PSAyICYmICFzZXJ2aWNlX3NwZWNpZmljKSB7CisgCQljb250aW51ZTsKKyAJICAgIH0KKyAKKyAJ
ICAgIC8qIElmIHdlJ3ZlIHNlZW4gaXQgYWxyZWFkeSwgd2UncmUgcmVwbGFjaW5nIGl0LCBzbyB3
ZSBuZWVkCisgCSAgICAgKiB0byBmcmVlIHRoZSBjdXJyZW50IHN0cmluZyBpZiB0aGVyZSBpcyBv
bmUgKi8KKyAJICAgIGlmKGltYXBvcHRzW29wdF0uc2VlbiAmJiBpbWFwb3B0c1tvcHRdLnQgPT0g
T1BUX1NUUklORykKKyAJCWZyZWUoKGNoYXIgKilpbWFwb3B0c1tvcHRdLnZhbC5zKTsKKyAKKyAg
ICAgICAgICAgICBpZihzZXJ2aWNlX3NwZWNpZmljKQorIAkJaW1hcG9wdHNbb3B0XS5zZWVuID0g
MjsKKyAJICAgIGVsc2UKKyAJCWltYXBvcHRzW29wdF0uc2VlbiA9IDE7CisgCSAgICAKKyAJICAg
IC8qIHRoaXMgaXMgYSBrbm93biBvcHRpb24gKi8KKyAJICAgIHN3aXRjaCAoaW1hcG9wdHNbb3B0
XS50KSB7CisgCSAgICBjYXNlIE9QVF9TVFJJTkc6IAorIAkgICAgewkJICAgIAorIAkJaW1hcG9w
dHNbb3B0XS52YWwucyA9IHhzdHJkdXAocCk7CisgCisgCQlpZihvcHQgPT0gSU1BUE9QVF9DT05G
SUdESVJFQ1RPUlkpCisgCQkgICAgY29uZmlnX2RpciA9IGltYXBvcHRzW29wdF0udmFsLnM7Cisg
CisgCQlicmVhazsKKyAJICAgIH0KKyAJICAgIGNhc2UgT1BUX0lOVDoKKyAJICAgIHsKKyAJCWxv
bmcgdmFsOworIAkJY2hhciAqcHRyOworIAkJCisgCQl2YWwgPSBzdHJ0b2wocCwgJnB0ciwgMCk7
CisgCQlpZiAoIXB0ciB8fCAqcHRyICE9ICdcMCcpIHsKKyAJCSAgICAvKiBlcnJvciBkdXJpbmcg
Y29udmVyc2lvbiAqLworIAkJICAgIHN5c2xvZyhMT0dfRVJSLAorIAkJCSAgICJub24taW50ZWdl
ciB2YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIsCisgCQkJICAgaW1hcG9wdHNbb3B0XS5vcHRuYW1l
LCBsaW5lbm8pOworIAkJICAgIGZjbG9zZShpbmZpbGUpOworIAkJICAgIHJldHVybiAtMTsKKyAJ
CX0KKyAKKyAJCWltYXBvcHRzW29wdF0udmFsLmkgPSB2YWw7CisgCQlicmVhazsKKyAJICAgIH0K
KyAJICAgIGNhc2UgT1BUX1NXSVRDSDoKKyAJICAgIHsKKyAJCWlmICgqcCA9PSAnMCcgfHwgKnAg
PT0gJ24nIHx8CisgCQkgICAgKCpwID09ICdvJyAmJiBwWzFdID09ICdmJykgfHwgKnAgPT0gJ2Yn
KSB7CisgCQkgICAgaW1hcG9wdHNbb3B0XS52YWwuYiA9IDA7CisgCQl9CisgCQllbHNlIGlmICgq
cCA9PSAnMScgfHwgKnAgPT0gJ3knIHx8CisgCQkJICgqcCA9PSAnbycgJiYgcFsxXSA9PSAnbicp
IHx8ICpwID09ICd0JykgeworIAkJICAgIGltYXBvcHRzW29wdF0udmFsLmIgPSAxOworIAkJfQor
IAkJZWxzZSB7CisgCQkgICAgLyogZXJyb3IgZHVyaW5nIGNvbnZlcnNpb24gKi8KKyAJCSAgICBz
eXNsb2coTE9HX0VSUiwKKyAJCQkgICAibm9uLXN3aXRjaCB2YWx1ZSBmb3IgJXMgaW4gbGluZSAl
ZCIsCisgCQkJICAgaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBsaW5lbm8pOworIAkJICAgIGZjbG9z
ZShpbmZpbGUpOworIAkJICAgIHJldHVybiAtMTsKKyAJCX0KKyAJCWJyZWFrOworIAkgICAgfQor
IAkgICAgY2FzZSBPUFRfRU5VTToKKyAJICAgIGNhc2UgT1BUX1NUUklOR0xJU1Q6CisgCSAgICB7
CisgCQljb25zdCBzdHJ1Y3QgZW51bV9vcHRpb25fcyAqZSA9IGltYXBvcHRzW29wdF0uZW51bV9v
cHRpb25zOworIAorIAkJaWYgKGltYXBvcHRzW29wdF0udCA9PSBPUFRfRU5VTSkgeworIAkJICAg
IC8qIG5vcm1hbGl6ZSBvbi9vZmYgdmFsdWVzICovCisgCQkgICAgaWYgKCFzdHJjbXAocCwgIjEi
KSB8fCAhc3RyY21wKHAsICJ5ZXMiKSB8fAorIAkJCSFzdHJjbXAocCwgInQiKSB8fCAhc3RyY21w
KHAsICJ0cnVlIikpIHsKKyAJCQlwID0gIm9uIjsKKyAJCSAgICB9IGVsc2UgaWYgKCFzdHJjbXAo
cCwgIjAiKSB8fCAhc3RyY21wKHAsICJubyIpIHx8CisgCQkJICAgICAgICFzdHJjbXAocCwgImYi
KSB8fCAhc3RyY21wKHAsICJmYWxzZSIpKSB7CisgCQkJcCA9ICJvZmYiOworIAkJICAgIH0KKyAJ
CX0KKyAKKyAJCXdoaWxlIChlLT5uYW1lKSB7CisgCQkgICAgaWYgKCFzdHJjbXAoZS0+bmFtZSwg
cCkpIGJyZWFrOworIAkJICAgIGUrKzsKKyAJCX0KKyAJCWlmIChlLT5uYW1lKSB7CisgCQkgICAg
aWYgKGltYXBvcHRzW29wdF0udCA9PSBPUFRfRU5VTSkKKyAJCQlpbWFwb3B0c1tvcHRdLnZhbC5l
ID0gZS0+dmFsOworIAkJICAgIGVsc2UKKyAJCQlpbWFwb3B0c1tvcHRdLnZhbC5zID0gZS0+bmFt
ZTsKKyAJCX0gZWxzZSB7CisgCQkgICAgLyogZXJyb3IgZHVyaW5nIGNvbnZlcnNpb24gKi8KKyAJ
CSAgICBzeXNsb2coTE9HX0VSUiwKKyAJCQkgICAiaW52YWxpZCB2YWx1ZSBmb3IgJXMgaW4gbGlu
ZSAlZCIsCisgCQkJICAgaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBsaW5lbm8pOworIAkJICAgIGZj
bG9zZShpbmZpbGUpOworIAkJICAgIHJldHVybiAtMTsKKyAJCX0KKyAJCWJyZWFrOworIAkgICAg
fQorIAkgICAgY2FzZSBPUFRfTk9UT1BUOgorIAkgICAgZGVmYXVsdDoKKyAJCWFib3J0KCk7Cisg
CSAgICB9CisgCX0gZWxzZSB7CisgCSAgICAvKiBjaGVjayB0byBtYWtlIHN1cmUgaXQncyB2YWxp
ZCBmb3Igb3ZlcmZsb3cgKi8KKyAJICAgIC8qIHRoYXQgaXMsIHBhcnRpdGlvbiBuYW1lcyBhbmQg
YW55dGhpbmcgdGhhdCBtaWdodCBiZQorIAkgICAgICogdXNlZCBieSBTQVNMICovCisgLyoKKyAg
IHh4eCB0aGlzIHdvdWxkIGJlIG5pY2UgaWYgaXQgd2Fzbid0IGZvciBvdGhlciBzZXJ2aWNlcyB3
aG8gbWlnaHQgYmUKKyAgICAgICBzaGFyaW5nIHRoaXMgY29uZmlnIGZpbGUgYW5kIHdob3NlIG5h
bWVzIHdlIGNhbm5vdCBwcmVkaWN0CisgCisgCSAgICBpZihzdHJuY2FzZWNtcChrZXksInNhc2xf
Iiw1KQorIAkgICAgJiYgc3RybmNhc2VjbXAoa2V5LCJwYXJ0aXRpb24tIiwxMCkpIHsKKyAJCXNw
cmludGYoZXJyYnVmLAorIAkJCSJvcHRpb24gJyVzJyBpcyB1bmtub3duIG9uIGxpbmUgJWQgb2Yg
Y29uZmlnIGZpbGUiLAorIAkJCWZ1bGxrZXksIGxpbmVubyk7CisgCQlmYXRhbChlcnJidWYsIEVD
X0NPTkZJRyk7CisgCSAgICB9CisgKi8KKyAKKyAJICAgIC8qIHNraXAgYWxsIG9wdGlvbnMgZXhj
ZXB0IHRob3NlIG1hY2hlZCB0ZW1wbGF0ZSAqLworIAkgICAgaWYoY29uZmlnX3RlbXBsYXRlX2Nv
bXBhcmUoa2V5LDAsb3B0cyxvcHRzX2xlbikpCisgCQljb250aW51ZTsKKyAKKyAJICAgIC8qIFB1
dCBpdCBpbiB0aGUgb3ZlcmZsb3cgaGFzaCB0YWJsZSAqLworIAkgICAgbmV3dmFsID0geHN0cmR1
cChwKTsKKyAJICAgIHZhbCA9IGhhc2hfaW5zZXJ0KGtleSwgbmV3dmFsLCAmY29uZmlnaGFzaCk7
CisgCSAgICBpZih2YWwgIT0gbmV3dmFsKSB7CisgCQlzeXNsb2coTE9HX0VSUiwKKyAJCSAgICAg
ICAib3B0aW9uICclcycgd2FzIHNwZWNpZmllZCB0d2ljZSBpbiBjb25maWcgZmlsZSAoc2Vjb25k
IG9jY3VyYW5jZSBvbiBsaW5lICVkKSIsCisgCQkgICAgICAgZnVsbGtleSwgbGluZW5vKTsKKyAJ
CWZjbG9zZShpbmZpbGUpOworIAkJcmV0dXJuIC0xOworIAkgICAgfQorIAl9CisgICAgIH0KKyAg
ICAgZmNsb3NlKGluZmlsZSk7CisgICAgIHJldHVybiAwOworIH0KKyAKKyB0eXBlZGVmIHN0cnVj
dCBfY29uZmlnX2RlbGV0ZV9jYl9wYXJhbSB7CisgICAgIHRlbXBsYXRlX29wdGlvbiAqb3B0czsK
KyAgICAgaW50IG9wdHNfbGVuOworIH0gY29uZmlnX2RlbGV0ZV9jYl9wYXJhbTsKKyAKKyBpbnQg
Y29uZmlnX2RlbGV0ZV9jYihjaGFyICprZXksIHZvaWQgKmRhdGEsIHZvaWQgKnBhcmFtKQorIHsK
KyAgICAgaWYoIWNvbmZpZ190ZW1wbGF0ZV9jb21wYXJlKAorIAkgICAoY2hhciAqKWtleSwgMCwK
KyAJICAgKChjb25maWdfZGVsZXRlX2NiX3BhcmFtICopcGFyYW0pLT5vcHRzLAorIAkgICAoKGNv
bmZpZ19kZWxldGVfY2JfcGFyYW0gKilwYXJhbSktPm9wdHNfbGVuKSkgeworIAlmcmVlKGRhdGEp
OworIAlyZXR1cm4gLTE7CisgICAgIH0KKyAgICAgcmV0dXJuIDA7CisgfQorIAorIGV4dGVybiBp
bnQgY29uZmlnX3JlcmVhZCh0ZW1wbGF0ZV9vcHRpb24gKm9wdHMsIGludCBvcHRzX2xlbikKKyB7
CisgICAgIGVudW0gb3B0dHlwZSBvcHQgPSBJTUFQT1BUX1pFUk87CisgICAgIGNvbmZpZ19kZWxl
dGVfY2JfcGFyYW0gcGFyYW07CisgICAgIGludCBjdXJfdGVtcGw7CisgICAgIGludCByZXM7Cisg
CisgICAgIGlmKCFvcHRzX2xlbikKKyAJcmV0dXJuIDA7CisgCisgICAgIC8qIHJlbW92ZSBvcHRp
b25zIHRoYXQgbWFjaGVkIHRlbXBsYXRlICovCisgICAgIGZvciAob3B0ID0gSU1BUE9QVF9aRVJP
OyBvcHQgPCBJTUFQT1BUX0xBU1Q7IG9wdCsrKSB7CisgCWlmKGltYXBvcHRzW29wdF0uc2Vlbikg
eworIAkgICAgLyoganVzdCBzZXQgZGVmYXVsdCB2YWx1ZXMgZm9yIGtub3duIG9wdGlvbnMgKi8K
KyAJICAgIGlmKCFjb25maWdfdGVtcGxhdGVfY29tcGFyZShpbWFwb3B0c1tvcHRdLm9wdG5hbWUs
b3B0LG9wdHMsb3B0c19sZW4pKSB7CisgCQlpZihpbWFwb3B0c1tvcHRdLnQgPT0gT1BUX1NUUklO
RykKKyAJCSAgICBmcmVlKChjaGFyICopaW1hcG9wdHNbb3B0XS52YWwucyk7CisgCQlpbWFwb3B0
c1tvcHRdLnZhbCA9IGltYXBvcHRzW29wdF0uZGVmOworIAkJaW1hcG9wdHNbb3B0XS5zZWVuID0g
MDsKKyAJICAgIH0KKyAJfQorICAgICB9CisgCisgICAgIC8qIGNoZWNrIGlmIHdlIG5lZWQgdG8g
d2FsayB0aHJvdWdoIGFsbCBoYXNoZWQgb3B0aW9ucyBvciB3ZSBqdXN0CisgICAgICAgIG5lZWQg
dG8gZGVsZXRlIE4gaGFzaGVkIG9wdGlvbnMgKi8KKyAgICAgZm9yKGN1cl90ZW1wbD0wOyBjdXJf
dGVtcGw8b3B0c19sZW47IGN1cl90ZW1wbCsrKSB7CisgCWlmKG9wdHNbY3VyX3RlbXBsXS50eXBl
PT1URU1QTEFURU9QVF9UWVBFX1BSRUZJWCkKKyAJICAgIGJyZWFrOworIAllbHNlIGlmKG9wdHNb
Y3VyX3RlbXBsXS50eXBlPT1URU1QTEFURU9QVF9UWVBFX0VYQUNUTUFUQ0gpIHsKKyAJICAgIHZv
aWQgKmRhdGE7CisgCSAgICAKKyAJICAgIC8qIHRyeSB0byBkZWxldGUgZXhhY3QgbWF0Y2ggb3B0
aW9uIChpZiBpdCBleGlzdHMsIGl0IHdpbGwKKyAJICAgICAgIGJlIGRlbGV0ZWQpICovCisgCSAg
ICBpZigoZGF0YT1oYXNoX2RlbCgoY2hhciAqKW9wdHNbY3VyX3RlbXBsXS52YWwsICZjb25maWdo
YXNoKSkpCisgCQlmcmVlKGRhdGEpOworIAl9CisgICAgIH0KKyAKKyAgICAgLyogaWYgd2UndmUg
Zm91bmQgYSBwcmVmaXggKG5vbi1leGFjdCkgdGVtcGxhdGUgdGhhbiB3YWxrIHRocm91Z2gKKyAg
ICAgICAgYWxsIGhhc2hlZCBvcHRpb25zICovCisgICAgIGlmKGN1cl90ZW1wbDxvcHRzX2xlbikg
eworIAlwYXJhbS5vcHRzPW9wdHM7CisgCXBhcmFtLm9wdHNfbGVuPW9wdHNfbGVuOworIAorIAlo
YXNoX3dhbGsoJmNvbmZpZ2hhc2gsIGNvbmZpZ19kZWxldGVfY2IsICZwYXJhbSk7CisgICAgIH0K
KyAKKyAgICAgLyogbm93IGNhbGwgY29uZmlnX3JlcmVhZF9maWxlKCkgYXMgaW4gY29uZmlnX3Jl
YWQoKSAqLworICAgICBpZighY29uc3RydWN0X2hhc2hfdGFibGUoJmluY2x1ZGVoYXNoLCBJTkNM
VURFSEFTSFNJWkUsIDEpKSB7CisgCWZhdGFsKCJjb3VsZCBub3QgY29uc3RydWN0IGluY2x1ZGUg
ZmlsZSAgaGFzaCB0YWJsZSIsIEVDX0NPTkZJRyk7CisgICAgIH0KKyAKKyAgICAgcmVzPWNvbmZp
Z19yZXJlYWRfZmlsZShjb25maWdfZmlsZW5hbWUsIG9wdHMsIG9wdHNfbGVuKTsKKyAKKyAgICAg
ZnJlZV9oYXNoX3RhYmxlKCZpbmNsdWRlaGFzaCwgTlVMTCk7CisgCisgICAgIGlmKHJlcykKKyAJ
cmV0dXJuIHJlczsKKyAKKyAgICAgLyogTm90ZSBpZiB3ZSBkb24ndCBjaGFuZ2UgdmFyaWFibGVz
IGJlbG93IHRoZW4gdGhheSBjYW4gcG9pbnQgdG8KKyAgICAgICAgZnJlZWQgbWVtb3J5LiBUT0RP
OiByaWdodCB3b3JrIHdpdGggSU1BUE9QVF9ERUZBVUxUUEFSVElUSU9OCisgICAgICAgIG9wdGlv
biBhbmQgd2l0aCBvdGhlciBwYXJ0aXRpb25zIHBhdGhlcyBpcyBuZWVkZWQuICovCisgCisgICAg
IC8qIGxvb2sgdXAgbWFpbGJveCBoYXNoaW5nICovCisgICAgIGNvbmZpZ19oYXNoaW1hcHNwb29s
ID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0hBU0hJTUFQU1BPT0wpOworIAorICAgICAvKiBh
cmUgd2Ugc3VwcG9ydGluZyB2aXJ0dWFsIGRvbWFpbnM/ICAqLworICAgICBjb25maWdfdmlydGRv
bWFpbnMgPSBjb25maWdfZ2V0ZW51bShJTUFQT1BUX1ZJUlRET01BSU5TKTsKKyAgICAgY29uZmln
X2RlZmRvbWFpbiA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9ERUZBVUxURE9NQUlOKTsKKyAK
KyAgICAgLyogbG9vayB1cCB0aGUgaG9zdG5hbWUgd2Ugc2hvdWxkIHByZXNlbnQgdG8gdGhlIHVz
ZXIgKi8KKyAgICAgY29uZmlnX3NlcnZlcm5hbWUgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRf
U0VSVkVSTkFNRSk7CisgICAgIGlmICghY29uZmlnX3NlcnZlcm5hbWUpIHsKKyAJY29uZmlnX3Nl
cnZlcm5hbWUgPSB4bWFsbG9jKHNpemVvZihjaGFyKSAqIDI1Nik7CisgCWdldGhvc3RuYW1lKChj
aGFyICopIGNvbmZpZ19zZXJ2ZXJuYW1lLCAyNTYpOworICAgICB9CisgCisgICAgIGNvbmZpZ19t
dXBkYXRlX3NlcnZlciA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9NVVBEQVRFX1NFUlZFUik7
CisgCisgICAgIHJldHVybiAwOworIH0KZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4x
Mi5vbGQvbGliL2xpYmNvbmZpZy5oIGN5cnVzLWltYXBkLTIuMi4xMi9saWIvbGliY29uZmlnLmgK
KioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbGliL2xpYmNvbmZpZy5oCTIwMDMtMTItMjkgMjM6
MjI6NTUgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9saWIvbGliY29uZmlnLmgJMjAwNS0x
MS0yMiAxODo1Nzo1NCArMDMwMAoqKioqKioqKioqKioqKioKKioqIDQ2LDU0ICoqKioKLS0tIDQ2
LDY1IC0tLS0KICAjaW5jbHVkZSAiZXhpdGNvZGVzLmgiCiAgI2luY2x1ZGUgImltYXBvcHRzLmgi
CiAgCisgLyogdHlwZXMgZm9yIHN0cnVjdHVyZSB0ZW1wbGF0ZV9vcHRpb24gKi8KKyAjZGVmaW5l
IFRFTVBMQVRFT1BUX1RZUEVfS05PV05PUFQgICAwCisgI2RlZmluZSBURU1QTEFURU9QVF9UWVBF
X0VYQUNUTUFUQ0ggMQorICNkZWZpbmUgVEVNUExBVEVPUFRfVFlQRV9QUkVGSVggICAgIDIKKyAK
KyB0eXBlZGVmIHN0cnVjdCBfdGVtcGxhdGVfb3B0aW9uIHsKKyAgICAgdm9pZCAqdmFsOworICAg
ICBpbnQgdHlwZTsKKyB9IHRlbXBsYXRlX29wdGlvbjsKKyAKICAvKiB0aGVzZSB3aWxsIGFzc2Vy
dCgpIGlmIHRoZXkncmUgY2FsbGVkIG9uIHRoZSB3cm9uZyB0eXBlIG9mCiAgICAgb3B0aW9uIChp
bWFwb3B0cy5jKSAqLwogIGV4dGVybiB2b2lkIGNvbmZpZ19yZWFkKGNvbnN0IGNoYXIgKmFsdF9j
b25maWcpOworIGV4dGVybiBpbnQgY29uZmlnX3JlcmVhZCh0ZW1wbGF0ZV9vcHRpb24gKm9wdHMs
IGludCBvcHRzX2xlbik7CiAgZXh0ZXJuIGNvbnN0IGNoYXIgKmNvbmZpZ19nZXRzdHJpbmcoZW51
bSBpbWFwb3B0IG9wdCk7CiAgZXh0ZXJuIGludCBjb25maWdfZ2V0aW50KGVudW0gaW1hcG9wdCBv
cHQpOwogIGV4dGVybiBpbnQgY29uZmlnX2dldHN3aXRjaChlbnVtIGltYXBvcHQgb3B0KTsKZGlm
ZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbWFuL2xkYXBkLjggY3lydXMtaW1h
cGQtMi4yLjEyL21hbi9sZGFwZC44CioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL21hbi9sZGFw
ZC44CTE5NzAtMDEtMDEgMDM6MDA6MDAgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9tYW4v
bGRhcGQuOAkyMDA1LTExLTIyIDE4OjU4OjExICswMzAwCioqKioqKioqKioqKioqKgoqKiogMCAq
KioqCi0tLSAxLDQ3IC0tLS0KKyAuXCIgLSotIG5yb2ZmIC0qLQorIC5USCBMREFQRCA4ICJQcm9q
ZWN0IEN5cnVzIiBDTVUKKyAuU0ggTkFNRQorIGxkYXBkIFwtIGNvbm5lY3RvciBmcm9tIElNQVAg
c2VydmVyIHRvIExEQVAKKyAuU0ggU1lOT1BTSVMKKyAuQiBsZGFwZAorIFsKKyAuQiBcLUMKKyAu
SSBjb25maWctZmlsZQorIF0KKyBbCisgLkIgXC1uCisgLkkgbnByb2MKKyB8CisgLkIgXC1cLXBy
ZWZvcmsKKyAuSSBucHJvYworIF0KKyAuYnIKKyAuU0ggREVTQ1JJUFRJT04KKyAuSSBMZGFwZAor
IGlzIGEgcHJvY2VzcyB0aGF0IHBlcmZvcm1zIHF1ZXJpZXMgZnJvbSBJTUFQIHNlcnZlciB0byBM
REFQIHNlcnZlci4KKyBJdCBhY2NlcHRzIHF1ZXJpZXMgdmlhIFVEUCBwcm90b2NvbCBhbmQgc2Vu
ZHMgYW5zd2VycyB0byBjYWxsZXJzLgorIEl0IGNhbiBiZSBpbnZva2VkIGJ5CisgLklSIG1hc3Rl
ciAoOCkKKyBidXQgaXQgaXMgcG9zc2libGUgdG8gc3RhcnQgXGZJbGRhcGRcZlIgaW5kZXBlbmRl
bnRseS4KKyBJZiB5b3Ugd2FudCB0byBzdGFydCBcZklsZGFwZFxmUiB2aWEgXGZCbWFzdGVyKDgp
XGZSLCB5b3UgaGF2ZSB0bworIGFkZCBsYXVuY2ggcnVsZSB0byBTVEFSVCBzZWN0aW9uIG9mCisg
LklSIGN5cnVzLmNvbmYgKDUpCisgLlBQCisgLkkgTGRhcGQKKyByZWFkcyBpdHMgY29uZmlndXJh
dGlvbiBvcHRpb25zIG91dCBvZiB0aGUKKyAuSVIgaW1hcGQuY29uZiAoNSkKKyBmaWxlIHVubGVz
cyBzcGVjaWZpZWQgb3RoZXJ3aXNlIGJ5IFxmQi1DXGZSLgorIC5TSCBPUFRJT05TCisgLlRQCisg
LkJJIFwtQyAiIGNvbmZpZy1maWxlIgorIFJlYWQgY29uZmlndXJhdGlvbiBvcHRpb25zIGZyb20g
XGZJY29uZmlnLWZpbGVcZlIuCisgLlRQCisgLkJJIFwtbiAiIG5wcm9jIixcIFwtXC1wcmVmb3Jr
ICIgbnByb2MiCisgVGhlIG51bWJlciBvZiBcZklsZGFwZFxmUiBwcm9jZXNzZXMgdG8gd29yayBz
aW11bHRhbmVvdXNseS4gVGhlIGRlZmF1bHQgaXMgMS4KKyAuVFAKKyAuU0ggRklMRVMKKyAuVFAK
KyAuQiAvZXRjL2ltYXBkLmNvbmYKKyAuU0ggU0VFIEFMU08KKyAuUFAKKyBcZkJpbWFwZC5jb25m
KDUpXGZSLCBcZkJtYXN0ZXIoOClcZlIKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4x
Mi5vbGQvbWFuL01ha2VmaWxlLmluIGN5cnVzLWltYXBkLTIuMi4xMi9tYW4vTWFrZWZpbGUuaW4K
KioqIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbWFuL01ha2VmaWxlLmluCTIwMDQtMDMtMzAgMTk6
MTg6NDEgKzA0MDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9tYW4vTWFrZWZpbGUuaW4JMjAwNS0x
MS0yMiAxODo1Nzo1NCArMDMwMAoqKioqKioqKioqKioqKioKKioqIDYyLDcyICoqKioKICAJJChz
cmNkaXIpL2Z1ZC44ICQoc3JjZGlyKS9pbWFwZC44ICQoc3JjZGlyKS9wb3AzZC44ICQoc3JjZGly
KS9xdW90YS44IFwKICAJJChzcmNkaXIpL3JlY29uc3RydWN0LjggJChzcmNkaXIpL3JtbmV3cy44
ICQoc3JjZGlyKS9zeW5jbmV3cy44IFwKICAJJChzcmNkaXIpL21icGF0aC44ICQoc3JjZGlyKS90
aW1zaWV2ZWQuOCAkKHNyY2RpcikvbWFzdGVyLjggXAohIAkkKHNyY2RpcikvbG10cGQuOCAkKHNy
Y2RpcikvaWRsZWQuOCAkKHNyY2RpcikvY3RsX21ib3hsaXN0LjggXAohIAkkKHNyY2RpcikvY3Rs
X2RlbGl2ZXIuOCAkKHNyY2RpcikvY3RsX2N5cnVzZGIuOCAkKHNyY2RpcikvaXB1cmdlLjggXAoh
IAkkKHNyY2RpcikvdGxzX3BydW5lLjggJChzcmNkaXIpL3NxdWF0dGVyLjggJChzcmNkaXIpL2N2
dF9jeXJ1c2RiLjggXAohIAkkKHNyY2Rpcikvbm90aWZ5ZC44ICQoc3JjZGlyKS9jaGtfY3lydXMu
OCAkKHNyY2RpcikvbWJleGFtaW5lLjggXAohIAkkKHNyY2Rpcikvbm50cGQuOCAkKHNyY2Rpcikv
ZmV0Y2huZXdzLjggJChzcmNkaXIpL3NtbWFwZC44CiAgCiAgYWxsOiAkKE1BTjEpICQoTUFOMykg
JChNQU41KSAkKE1BTjgpCiAgCi0tLSA2Miw3MyAtLS0tCiAgCSQoc3JjZGlyKS9mdWQuOCAkKHNy
Y2RpcikvaW1hcGQuOCAkKHNyY2RpcikvcG9wM2QuOCAkKHNyY2RpcikvcXVvdGEuOCBcCiAgCSQo
c3JjZGlyKS9yZWNvbnN0cnVjdC44ICQoc3JjZGlyKS9ybW5ld3MuOCAkKHNyY2Rpcikvc3luY25l
d3MuOCBcCiAgCSQoc3JjZGlyKS9tYnBhdGguOCAkKHNyY2RpcikvdGltc2lldmVkLjggJChzcmNk
aXIpL21hc3Rlci44IFwKISAJJChzcmNkaXIpL2xkYXBkLjggJChzcmNkaXIpL2xtdHBkLjggJChz
cmNkaXIpL2lkbGVkLjggXAohIAkkKHNyY2RpcikvY3RsX21ib3hsaXN0LjggJChzcmNkaXIpL2N0
bF9kZWxpdmVyLjggXAohIAkkKHNyY2RpcikvY3RsX2N5cnVzZGIuOCAkKHNyY2RpcikvaXB1cmdl
LjggJChzcmNkaXIpL3Rsc19wcnVuZS44IFwKISAJJChzcmNkaXIpL3NxdWF0dGVyLjggJChzcmNk
aXIpL2N2dF9jeXJ1c2RiLjggJChzcmNkaXIpL25vdGlmeWQuOCBcCiEgCSQoc3JjZGlyKS9jaGtf
Y3lydXMuOCAkKHNyY2RpcikvbWJleGFtaW5lLjggJChzcmNkaXIpL25udHBkLjggXAohIAkkKHNy
Y2RpcikvZmV0Y2huZXdzLjggJChzcmNkaXIpL3NtbWFwZC44CiAgCiAgYWxsOiAkKE1BTjEpICQo
TUFOMykgJChNQU41KSAkKE1BTjgpCiAgCmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1pbWFwZC0yLjIu
MTIub2xkL21hbi9tYXN0ZXIuOCBjeXJ1cy1pbWFwZC0yLjIuMTIvbWFuL21hc3Rlci44CioqKiBj
eXJ1cy1pbWFwZC0yLjIuMTIub2xkL21hbi9tYXN0ZXIuOAkyMDA0LTEyLTE3IDE5OjMyOjIzICsw
MzAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvbWFuL21hc3Rlci44CTIwMDUtMTEtMjIgMTg6NTc6
NTQgKzAzMDAKKioqKioqKioqKioqKioqCioqKiAxNTIsMTU1ICoqKioKICAuU0ggU0VFIEFMU08K
ICAuUFAKICBcZkJjeXJ1cy5jb25mKDUpXGZSLCBcZkJpbWFwZC5jb25mKDUpXGZSLCBcZkJpbWFw
ZCg4KVxmUiwKISBcZkJwb3AzZCg4KVxmUiwgXGZCbG10cGQoOClcZlIsIFxmQnRpbXNpZXZlZCg4
KVxmUiwgXGZCaWRsZWQoOClcZlIKLS0tIDE1MiwxNTYgLS0tLQogIC5TSCBTRUUgQUxTTwogIC5Q
UAogIFxmQmN5cnVzLmNvbmYoNSlcZlIsIFxmQmltYXBkLmNvbmYoNSlcZlIsIFxmQmltYXBkKDgp
XGZSLAohIFxmQnBvcDNkKDgpXGZSLCBcZkJsZGFwZCg4KVxmUiwgXGZCbG10cGQoOClcZlIsCiEg
XGZCdGltc2lldmVkKDgpXGZSLCBcZkJpZGxlZCg4KVxmUgpkaWZmIC1OIC1DIDMgLXIgY3lydXMt
aW1hcGQtMi4yLjEyLm9sZC9tYXN0ZXIvY29uZi9jbXUtYmFja2VuZC5jb25mIGN5cnVzLWltYXBk
LTIuMi4xMi9tYXN0ZXIvY29uZi9jbXUtYmFja2VuZC5jb25mCioqKiBjeXJ1cy1pbWFwZC0yLjIu
MTIub2xkL21hc3Rlci9jb25mL2NtdS1iYWNrZW5kLmNvbmYJMjAwMy0xMC0yMiAyMjowMzoxMCAr
MDQwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL21hc3Rlci9jb25mL2NtdS1iYWNrZW5kLmNvbmYJ
MjAwNS0xMS0yMyAxNTozNDoyNCArMDMwMAoqKioqKioqKioqKioqKioKKioqIDYsMTEgKioqKgot
LS0gNiwxMyAtLS0tCiAgCiAgICByZWNvdmVyCWNtZD0iY3RsX2N5cnVzZGIgLXIiCiAgICBtdXBk
YXRlcHVzaCAgIGNtZD0iY3RsX21ib3hsaXN0IC1tIgorICAgIyB0aGlzIGlzIG9ubHkgbmVjZXNz
YXJ5IGlmIHVzaW5nIGNvbnZlcnR1c2VyaWQgZXh0ZW5zaW9uCisgIyAgbGRhcGQJCWNtZD0ibGRh
cGQgLW4gNSIKICB9CiAgCiAgIyBVTklYIHNvY2tldHMgc3RhcnQgd2l0aCBhIHNsYXNoIGFuZCBh
cmUgcHV0IGludG8gL3Zhci9pbWFwL3NvY2tldHMKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBk
LTIuMi4xMi5vbGQvbWFzdGVyL2NvbmYvY211LWZyb250ZW5kLmNvbmYgY3lydXMtaW1hcGQtMi4y
LjEyL21hc3Rlci9jb25mL2NtdS1mcm9udGVuZC5jb25mCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIu
b2xkL21hc3Rlci9jb25mL2NtdS1mcm9udGVuZC5jb25mCTIwMDMtMTAtMjIgMjI6MDM6MTAgKzA0
MDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9tYXN0ZXIvY29uZi9jbXUtZnJvbnRlbmQuY29uZgky
MDA1LTExLTIzIDE1OjM0OjI1ICswMzAwCioqKioqKioqKioqKioqKgoqKiogMiw3ICoqKioKLS0t
IDIsOSAtLS0tCiAgICBhdXRoCQljbWQ9Ii91c3IvbG9jYWwvYmluL2tzcnZ0Z3QgLWwgMzYwMCBp
bWFwIEBTSE9SVEhPU1RAIEFORFJFVy5DTVUuRURVIC9pbWFwL2NvbmYvc3J2dGFiIgogIAogICAg
bWJveGxpc3QJY21kPSJjdGxfY3lydXNkYiAtciIKKyAgICMgdGhpcyBpcyBvbmx5IG5lY2Vzc2Fy
eSBpZiB1c2luZyBjb252ZXJ0dXNlcmlkIGV4dGVuc2lvbgorICMgIGxkYXBkCQljbWQ9ImxkYXBk
IC1uIDUiCiAgfQogIAogICMgVU5JWCBzb2NrZXRzIHN0YXJ0IHdpdGggYSBzbGFzaCBhbmQgYXJl
IHB1dCBpbnRvIC92YXIvaW1hcC9zb2NrZXRzCmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1pbWFwZC0y
LjIuMTIub2xkL21hc3Rlci9jb25mL25vcm1hbC5jb25mIGN5cnVzLWltYXBkLTIuMi4xMi9tYXN0
ZXIvY29uZi9ub3JtYWwuY29uZgoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9tYXN0ZXIvY29u
Zi9ub3JtYWwuY29uZgkyMDAzLTEwLTIyIDIyOjAzOjEwICswNDAwCi0tLSBjeXJ1cy1pbWFwZC0y
LjIuMTIvbWFzdGVyL2NvbmYvbm9ybWFsLmNvbmYJMjAwNS0xMS0yMyAxNTozNDoyNiArMDMwMAoq
KioqKioqKioqKioqKioKKioqIDYsMTEgKioqKgotLS0gNiwxMyAtLS0tCiAgCiAgICAjIHRoaXMg
aXMgb25seSBuZWNlc3NhcnkgaWYgdXNpbmcgaWRsZWQgZm9yIElNQVAgSURMRQogICMgIGlkbGVk
CQljbWQ9ImlkbGVkIgorICAgIyB0aGlzIGlzIG9ubHkgbmVjZXNzYXJ5IGlmIHVzaW5nIGNvbnZl
cnR1c2VyaWQgZXh0ZW5zaW9uCisgIyAgbGRhcGQJCWNtZD0ibGRhcGQgLW4gNSIKICB9CiAgCiAg
IyBVTklYIHNvY2tldHMgc3RhcnQgd2l0aCBhIHNsYXNoIGFuZCBhcmUgcHV0IGludG8gL3Zhci9p
bWFwL3NvY2tldApkaWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9tYXN0ZXIv
Y29uZi9wcmVmb3JrLmNvbmYgY3lydXMtaW1hcGQtMi4yLjEyL21hc3Rlci9jb25mL3ByZWZvcmsu
Y29uZgoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9tYXN0ZXIvY29uZi9wcmVmb3JrLmNvbmYJ
MjAwMy0xMC0yMiAyMjowMzoxMCArMDQwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL21hc3Rlci9j
b25mL3ByZWZvcmsuY29uZgkyMDA1LTExLTIzIDE1OjM0OjI3ICswMzAwCioqKioqKioqKioqKioq
KgoqKiogNiwxMSAqKioqCi0tLSA2LDEzIC0tLS0KICAKICAgICMgdGhpcyBpcyBvbmx5IG5lY2Vz
c2FyeSBpZiB1c2luZyBpZGxlZCBmb3IgSU1BUCBJRExFCiAgIyAgaWRsZWQJCWNtZD0iaWRsZWQi
CisgICAjIHRoaXMgaXMgb25seSBuZWNlc3NhcnkgaWYgdXNpbmcgY29udmVydHVzZXJpZCBleHRl
bnNpb24KKyAjICBsZGFwZAkJY21kPSJsZGFwZCAtbiA1IgogIH0KICAKICAjIFVOSVggc29ja2V0
cyBzdGFydCB3aXRoIGEgc2xhc2ggYW5kIGFyZSBwdXQgaW50byAvdmFyL2ltYXAvc29ja2V0cwpk
aWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9tYXN0ZXIvY29uZi9zbWFsbC5j
b25mIGN5cnVzLWltYXBkLTIuMi4xMi9tYXN0ZXIvY29uZi9zbWFsbC5jb25mCioqKiBjeXJ1cy1p
bWFwZC0yLjIuMTIub2xkL21hc3Rlci9jb25mL3NtYWxsLmNvbmYJMjAwMi0xMC0wMiAwMDo0Njow
MSArMDQwMAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL21hc3Rlci9jb25mL3NtYWxsLmNvbmYJMjAw
NS0xMS0yMyAxNTozNDoyMiArMDMwMAoqKioqKioqKioqKioqKioKKioqIDYsMTEgKioqKgotLS0g
NiwxMyAtLS0tCiAgCiAgICAjIHRoaXMgaXMgb25seSBuZWNlc3NhcnkgaWYgdXNpbmcgaWRsZWQg
Zm9yIElNQVAgSURMRQogICMgIGlkbGVkCQljbWQ9ImlkbGVkIgorICAgIyB0aGlzIGlzIG9ubHkg
bmVjZXNzYXJ5IGlmIHVzaW5nIGNvbnZlcnR1c2VyaWQgZXh0ZW5zaW9uCisgIyAgbGRhcGQJCWNt
ZD0ibGRhcGQgLW4gNSIKICB9CiAgCiAgIyBVTklYIHNvY2tldHMgc3RhcnQgd2l0aCBhIHNsYXNo
IGFuZCBhcmUgcHV0IGludG8gL3Zhci9pbWFwL3NvY2tldHMKZGlmZiAtTiAtQyAzIC1yIGN5cnVz
LWltYXBkLTIuMi4xMi5vbGQvbm90aWZ5ZC9NYWtlZmlsZS5pbiBjeXJ1cy1pbWFwZC0yLjIuMTIv
bm90aWZ5ZC9NYWtlZmlsZS5pbgoqKiogY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9ub3RpZnlkL01h
a2VmaWxlLmluCTIwMDUtMTEtMDcgMTg6MDU6MzEgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4x
Mi9ub3RpZnlkL01ha2VmaWxlLmluCTIwMDUtMTEtMjIgMTg6NTc6NTQgKzAzMDAKKioqKioqKioq
KioqKioqCioqKiA3Miw3OCAqKioqCiAgU0lFVkVfTElCUyA9IEBTSUVWRV9MSUJTQAogIElNQVBf
Q09NX0VSUl9MSUJTID0gQElNQVBfQ09NX0VSUl9MSUJTQAogIExJQl9XUkFQID0gQExJQl9XUkFQ
QAohIExJQlMgPSBAWkVQSFlSX0xJQlNAIEBMSUJTQCAkKElNQVBfQ09NX0VSUl9MSUJTKQogIERF
UExJQlM9Li4vaW1hcC9tdXRleF9mYWtlLm8gLi4vaW1hcC9saWJpbWFwLmEgJChTSUVWRV9MSUJT
KSAuLi9saWIvbGliY3lydXMuYSAuLi9saWIvbGliY3lydXNfbWluLmEgQERFUExJQlNACiAgCiAg
UFVSSUZZPS91c3IvbG9jYWwvYmluL3B1cmlmeQotLS0gNzIsNzggLS0tLQogIFNJRVZFX0xJQlMg
PSBAU0lFVkVfTElCU0AKICBJTUFQX0NPTV9FUlJfTElCUyA9IEBJTUFQX0NPTV9FUlJfTElCU0AK
ICBMSUJfV1JBUCA9IEBMSUJfV1JBUEAKISBMSUJTID0gQFpFUEhZUl9MSUJTQCBATElCU0AgJChJ
TUFQX0NPTV9FUlJfTElCUykgLWxyZWRibGFjayAtbGxkYXAKICBERVBMSUJTPS4uL2ltYXAvbXV0
ZXhfZmFrZS5vIC4uL2ltYXAvbGliaW1hcC5hICQoU0lFVkVfTElCUykgLi4vbGliL2xpYmN5cnVz
LmEgLi4vbGliL2xpYmN5cnVzX21pbi5hIEBERVBMSUJTQAogIAogIFBVUklGWT0vdXNyL2xvY2Fs
L2Jpbi9wdXJpZnkKZGlmZiAtTiAtQyAzIC1yIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvcHRjbGll
bnQvTWFrZWZpbGUuaW4gY3lydXMtaW1hcGQtMi4yLjEyL3B0Y2xpZW50L01ha2VmaWxlLmluCioq
KiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL3B0Y2xpZW50L01ha2VmaWxlLmluCTIwMDUtMTEtMDcg
MTg6MDU6MjcgKzAzMDAKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi9wdGNsaWVudC9NYWtlZmlsZS5p
bgkyMDA1LTExLTIyIDE4OjU3OjU0ICswMzAwCioqKioqKioqKioqKioqKgoqKiogNTgsNjQgKioq
KgogIEFGU19MSUJTID0gQEFGU19MSUJTQAogIElNQVBfTElCUyA9IEBJTUFQX0xJQlNAIEBMSUJf
UlRACiAgU0lFVkVfTElCUyA9IEBTSUVWRV9MSUJTQAohIExJQlMgPSAkKElNQVBfTElCUykgQENP
TV9FUlJfTElCU0AKICBMSUJfU0FTTCA9IEBMSUJfU0FTTEAKICBMSUJfV1JBUCA9IEBMSUJfV1JB
UEAKICBERVBMSUJTID0gLi4vaW1hcC9saWJpbWFwLmEgJChTSUVWRV9MSUJTKSAuLi9saWIvbGli
Y3lydXMuYSAuLi9saWIvbGliY3lydXNfbWluLmEgQERFUExJQlNAIAotLS0gNTgsNjQgLS0tLQog
IEFGU19MSUJTID0gQEFGU19MSUJTQAogIElNQVBfTElCUyA9IEBJTUFQX0xJQlNAIEBMSUJfUlRA
CiAgU0lFVkVfTElCUyA9IEBTSUVWRV9MSUJTQAohIExJQlMgPSAkKElNQVBfTElCUykgQENPTV9F
UlJfTElCU0AgLWxyZWRibGFjayAtbGxkYXAKICBMSUJfU0FTTCA9IEBMSUJfU0FTTEAKICBMSUJf
V1JBUCA9IEBMSUJfV1JBUEAKICBERVBMSUJTID0gLi4vaW1hcC9saWJpbWFwLmEgJChTSUVWRV9M
SUJTKSAuLi9saWIvbGliY3lydXMuYSAuLi9saWIvbGliY3lydXNfbWluLmEgQERFUExJQlNAIApk
aWZmIC1OIC1DIDMgLXIgY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9SRUFETUUuY29udmVydHVzZXJp
ZCBjeXJ1cy1pbWFwZC0yLjIuMTIvUkVBRE1FLmNvbnZlcnR1c2VyaWQKKioqIGN5cnVzLWltYXBk
LTIuMi4xMi5vbGQvUkVBRE1FLmNvbnZlcnR1c2VyaWQJMTk3MC0wMS0wMSAwMzowMDowMCArMDMw
MAotLS0gY3lydXMtaW1hcGQtMi4yLjEyL1JFQURNRS5jb252ZXJ0dXNlcmlkCTIwMDUtMTEtMjMg
MTU6NDQ6MjYgKzAzMDAKKioqKioqKioqKioqKioqCioqKiAwICoqKioKLS0tIDEsMTQgLS0tLQor
IEN5cnVzIElNQVAgY29udmVydHVzZXJpZCBwYXRjaAorIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0KKyAKKyBUaGlzIHBhdGNoIGlzIG5lZWRlZCB0byBhZGQgYWJpbGl0eSB0byB0aGUg
c2VydmVyIHRvIGhpZGUKKyByZWFsIHVzZXJzIGluZGVudGlmaWVycyBhbmQgdG8gcmVwbGFjZSB0
aGVtIHRvIG90aGVyIG9uZXMKKyB3aGljaCBhcmUgZ290IGZyb20gTERBUC4KKyAKKyBTdGVwcyB5
b3UgbmVlZCB0byBkbyB0byBnZXQgY29udmVydHVzZXJpZCB3b3JrZWQ6CisgMS4gQnVpbGQgdGhl
IHNlcnZlciB3aXRoIC0tZW5hYmxlLWNvbnZlcnR1c2VyaWQgJ2NvbmZpZ3VyZScgb3B0aW9uOwor
IDIuIFNldCBjb252ZXJ1c2VyaWQqIG9wdGlvbnMgaW4gaW1hcGQuY29uZi4gU2VlIGltYXBkLmNv
bmYoNSkKKyAgICBmb3IgZGV0YWlscy4gVGhlIGRlZmF1bHQgYWN0aW9uICh3aXRob3V0IGFueSBj
b252ZXJ1c2VyaWQqCisgICAgb3B0aW9uIHNldCkgaXMgImRvbid0IGNvbnZlcnQiOworIDMuIEFk
ZCAibGRhcGQiIGluIFNUQVJUIHNlY3Rpb24gb2YgY3lydXMuY29uZi4gU2VlIGxkYXBkKDgpIGZv
cgorICAgIGRldGFpbHMuCmRpZmYgLU4gLUMgMyAtciBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL3Rp
bXNpZXZlZC9NYWtlZmlsZS5pbiBjeXJ1cy1pbWFwZC0yLjIuMTIvdGltc2lldmVkL01ha2VmaWxl
LmluCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL3RpbXNpZXZlZC9NYWtlZmlsZS5pbgkyMDA0
LTA1LTI4IDIyOjAzOjEwICswNDAwCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIvdGltc2lldmVkL01h
a2VmaWxlLmluCTIwMDUtMTEtMjIgMTg6NTc6NTUgKzAzMDAKKioqKioqKioqKioqKioqCioqKiA3
MSw3NyAqKioqCiAgSU1BUF9MSUJTID0gQElNQVBfTElCU0AgQExJQl9SVEAKICBJTUFQX0NPTV9F
UlJfTElCUyA9IEBJTUFQX0NPTV9FUlJfTElCU0AKICBMSUJfV1JBUCA9IEBMSUJfV1JBUEAKISBM
SUJTID0gJChJTUFQX0NPTV9FUlJfTElCUykKICBERVBMSUJTPS4uL3NpZXZlL2xpYnNpZXZlLmEg
Li4vaW1hcC9tdXRleF9mYWtlLm8gLi4vaW1hcC9saWJpbWFwLmEgLi4vbGliL2xpYmN5cnVzLmEg
Li4vbGliL2xpYmN5cnVzX21pbi5hIEBERVBMSUJTQAogIAogIFBVUklGWT0vdXNyL2xvY2FsL2Jp
bi9wdXJpZnkKLS0tIDcxLDc3IC0tLS0KICBJTUFQX0xJQlMgPSBASU1BUF9MSUJTQCBATElCX1JU
QAogIElNQVBfQ09NX0VSUl9MSUJTID0gQElNQVBfQ09NX0VSUl9MSUJTQAogIExJQl9XUkFQID0g
QExJQl9XUkFQQAohIExJQlMgPSAkKElNQVBfQ09NX0VSUl9MSUJTKSAtbHJlZGJsYWNrIC1sbGRh
cAogIERFUExJQlM9Li4vc2lldmUvbGlic2lldmUuYSAuLi9pbWFwL211dGV4X2Zha2UubyAuLi9p
bWFwL2xpYmltYXAuYSAuLi9saWIvbGliY3lydXMuYSAuLi9saWIvbGliY3lydXNfbWluLmEgQERF
UExJQlNACiAgCiAgUFVSSUZZPS91c3IvbG9jYWwvYmluL3B1cmlmeQpkaWZmIC1OIC1DIDMgLXIg
Y3lydXMtaW1hcGQtMi4yLjEyLm9sZC90b29scy9jb25maWcyaGVhZGVyIGN5cnVzLWltYXBkLTIu
Mi4xMi90b29scy9jb25maWcyaGVhZGVyCioqKiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL3Rvb2xz
L2NvbmZpZzJoZWFkZXIJMjAwNS0xMS0wNyAxODowNTozNyArMDMwMAotLS0gY3lydXMtaW1hcGQt
Mi4yLjEyL3Rvb2xzL2NvbmZpZzJoZWFkZXIJMjAwNS0xMS0yMiAxODo1Nzo1NSArMDMwMAoqKioq
KioqKioqKioqKioKKioqIDEyNiwxMzIgKioqKgogIAogIHN0cnVjdCBpbWFwb3B0X3MgaW1hcG9w
dHNbXSA9CiAgewohICAgeyBJTUFQT1BUX1pFUk8sICIiLCAwLCB7IE5VTEwgfSwgT1BUX05PVE9Q
VCwgeyAgeyBOVUxMLCBJTUFQX0VOVU1fWkVSTyB9IH0gfSwKICBFT0YKICAgICAgOwogIAotLS0g
MTI2LDEzMiAtLS0tCiAgCiAgc3RydWN0IGltYXBvcHRfcyBpbWFwb3B0c1tdID0KICB7CiEgICB7
IElNQVBPUFRfWkVSTywgIiIsIDAsIHsgTlVMTCB9LCB7IE5VTEwgfSwgT1BUX05PVE9QVCwgeyAg
eyBOVUxMLCBJTUFQX0VOVU1fWkVSTyB9IH0gfSwKICBFT0YKICAgICAgOwogIAoqKioqKioqKioq
KioqKioKKioqIDIwNCwyMTAgKioqKgogIAkJCTogInsodm9pZCopJDJ9IjsKICAJfQogIAohIAlw
cmludCBDRklMRSAiICB7IElNQVBPUFRfIiwgdWMoJG9wdCksICIsIFwiJDFcIiwgMCwgJGRlZiwg
T1BUXyQzLCB7ICRlbnVtcyB7IE5VTEwsIElNQVBfRU5VTV9aRVJPIH0gfSB9LFxuIjsKICAgICAg
fSBlbHNlIHsKICAJI2Nob21wOwogIAkjcHJpbnQgInJlamVjdGVkICckXydcbiI7Ci0tLSAyMDQs
MjEwIC0tLS0KICAJCQk6ICJ7KHZvaWQqKSQyfSI7CiAgCX0KICAKISAJcHJpbnQgQ0ZJTEUgIiAg
eyBJTUFQT1BUXyIsIHVjKCRvcHQpLCAiLCBcIiQxXCIsIDAsICRkZWYsICRkZWYsIE9QVF8kMywg
eyAkZW51bXMgeyBOVUxMLCBJTUFQX0VOVU1fWkVSTyB9IH0gfSxcbiI7CiAgICAgIH0gZWxzZSB7
CiAgCSNjaG9tcDsKICAJI3ByaW50ICJyZWplY3RlZCAnJF8nXG4iOwoqKioqKioqKioqKioqKioK
KioqIDI1MSwyNTYgKioqKgotLS0gMjUxLDI1NyAtLS0tCiAgICAgIGNvbnN0IGNoYXIgKm9wdG5h
bWU7CiAgICAgIGludCBzZWVuOwogICAgICB1bmlvbiBjb25maWdfdmFsdWUgdmFsOworICAgICB1
bmlvbiBjb25maWdfdmFsdWUgZGVmOwogICAgICBjb25zdCBlbnVtIG9wdHR5cGUgdDsKICBFT0YK
ICA7CioqKioqKioqKioqKioqKgoqKiogMjY1LDI3MSAqKioqCiAgICAgIDsKICAKICBwcmludCBD
RklMRSA8PEVPRgohICAgeyBJTUFQT1BUX0xBU1QsIE5VTEwsIDAsIHsgTlVMTCB9LCBPUFRfTk9U
T1BULCB7ICB7IE5VTEwsIElNQVBfRU5VTV9aRVJPIH0gfSB9CiAgfTsKICAKICAvKiBjIGNvZGUg
Z29lcyBoZXJlICovCi0tLSAyNjYsMjcyIC0tLS0KICAgICAgOwogIAogIHByaW50IENGSUxFIDw8
RU9GCiEgICB7IElNQVBPUFRfTEFTVCwgTlVMTCwgMCwgeyBOVUxMIH0sIHsgTlVMTCB9LCBPUFRf
Tk9UT1BULCB7ICB7IE5VTEwsIElNQVBfRU5VTV9aRVJPIH0gfSB9CiAgfTsKICAKICAvKiBjIGNv
ZGUgZ29lcyBoZXJlICovCg==
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>402</attachid>
            <date>2005-12-08 11:49 EDT</date>
            <desc>Update</desc>
            <filename>cyrus-imapd-convertuserid-2.2.12_12.patch</filename>
            <type>text/plain</type>
            <size>83593</size>
            <attacher>dzal_mail@mtu-net.ru</attacher>
            
              <data encoding="base64">ZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvY29uZmlnLmguaW4gY3lydXMtaW1hcGQt
Mi4yLjEyL2NvbmZpZy5oLmluCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2NvbmZpZy5oLmlu
CTIwMDUtMDItMTQgMjA6NTk6NDEgKzAzMDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9jb25maWcu
aC5pbgkyMDA1LTEyLTA4IDE5OjM4OjUwICswMzAwCkBAIC02NCw2ICs2NCw5IEBACiAvKiBEbyB3
ZSBoYXZlIGEgZGVjZW50IHJlZ2V4IGxpYnJhcnk/ICovCiAjdW5kZWYgRU5BQkxFX1JFR0VYCiAK
Ky8qIEVuYWJsZSBjb252ZXJ0aW5nIHVzZXJpZHMgdmlhIExEQVAgc3VwcG9ydD8gKi8KKyN1bmRl
ZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKwogLyogRW5hYmxlIE5ldHNjYXBlIE1lbnUgT3B0aW9u
IEhhY2s/ICovCiAjdW5kZWYgRU5BQkxFX1hfTkVUU0NBUEVfSEFDSwogCmRpZmYgLXVyTiBjeXJ1
cy1pbWFwZC0yLjIuMTIub2xkL2NvbmZpZ3VyZSBjeXJ1cy1pbWFwZC0yLjIuMTIvY29uZmlndXJl
Ci0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2NvbmZpZ3VyZQkyMDA1LTAyLTE0IDIwOjU5OjQ2
ICswMzAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvY29uZmlndXJlCTIwMDUtMTItMDggMTk6Mzg6
NTEgKzAzMDAKQEAgLTg1Miw2ICs4NTIsNyBAQAogICAtLWVuYWJsZS1jbXVsb2NhbCAgICAgICBl
bmFibGUgQ01VLXNwZWNpZmljIGxvY2FsIHN1cHBvcnQKICAgLS1lbmFibGUtb2xkc2lldmVuYW1l
ICAgZW5hYmxlIHRoZSB1c2Ugb2YgJ2ltYXAnIGFzIHRoZSBzaWV2ZSBzZXJ2aWNlIG5hbWUKICAg
LS1lbmFibGUtbGlzdGV4dCAgICAgICAgZW5hYmxlIElNQVAgTGlzdCBleHRlbnNpb25zCisgIC0t
ZW5hYmxlLWNvbnZlcnR1c2VyaWQgIGVuYWJsZSBjb252ZXJ0aW5nIHVzZXJpZHMgdmlhIExEQVAg
c3VwcG9ydAogICAtLWVuYWJsZS1uZXRzY2FwZWhhY2sgICBlbmFibGUgTmV0c2NhcGUgaGFjayBm
b3IgdGhlIG1lbnUgb3B0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIENvbW11bmlj
YXRvciB0byBBZG1pbmlzdHJhdGUgTWFpbAogICAtLWVuYWJsZS1nc3NhcGk9PERJUj4gICBlbmFi
bGUgR1NTQVBJIGF1dGhlbnRpY2F0aW9uIHllcwpAQCAtMTExODAsNiArMTExODEsMTggQEAKIAlm
aQogZmk7CiAKKyMgQ2hlY2sgd2hldGhlciAtLWVuYWJsZS1jb252ZXJ0dXNlcmlkIG9yIC0tZGlz
YWJsZS1jb252ZXJ0dXNlcmlkIHdhcyBnaXZlbi4KK2lmIHRlc3QgIiR7ZW5hYmxlX2NvbnZlcnR1
c2VyaWQrc2V0fSIgPSBzZXQ7IHRoZW4KKyAgZW5hYmxldmFsPSIkZW5hYmxlX2NvbnZlcnR1c2Vy
aWQiCisgIGlmIHRlc3QgIiRlbmFibGV2YWwiID0geWVzOyB0aGVuCisKK2NhdCA+PmNvbmZkZWZz
LmggPDxcX0FDRU9GCisjZGVmaW5lIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorX0FDRU9GCisJSU1B
UF9QUk9HUz0iJElNQVBfUFJPR1MgbGRhcGQiCisJZmkKK2ZpOworCiAjIENoZWNrIHdoZXRoZXIg
LS1lbmFibGUtbmV0c2NhcGVoYWNrIG9yIC0tZGlzYWJsZS1uZXRzY2FwZWhhY2sgd2FzIGdpdmVu
LgogaWYgdGVzdCAiJHtlbmFibGVfbmV0c2NhcGVoYWNrK3NldH0iID0gc2V0OyB0aGVuCiAgIGVu
YWJsZXZhbD0iJGVuYWJsZV9uZXRzY2FwZWhhY2siCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIu
MTIub2xkL2NvbmZpZ3VyZS5pbiBjeXJ1cy1pbWFwZC0yLjIuMTIvY29uZmlndXJlLmluCi0tLSBj
eXJ1cy1pbWFwZC0yLjIuMTIub2xkL2NvbmZpZ3VyZS5pbgkyMDA1LTAxLTE5IDAyOjQ2OjAwICsw
MzAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvY29uZmlndXJlLmluCTIwMDUtMTItMDggMTk6Mzg6
NTEgKzAzMDAKQEAgLTkxNyw2ICs5MTcsMTMgQEAKIAkJQUNfREVGSU5FKEVOQUJMRV9MSVNURVhU
LFtdLFtFbmFibGUgdGhlIExJU1RFWFQgZXh0ZW5zaW9uP10pCiAJZmkpCiAKK0FDX0FSR19FTkFC
TEUoY29udmVydHVzZXJpZCwKKwlbICAtLWVuYWJsZS1jb252ZXJ0dXNlcmlkICBlbmFibGUgY29u
dmVydGluZyB1c2VyaWRzIHZpYSBMREFQIHN1cHBvcnRdLAorCWlmIHRlc3QgIiRlbmFibGV2YWwi
ID0geWVzOyB0aGVuCisJCUFDX0RFRklORShFTkFCTEVfQ09OVkVSVF9VU0VSSUQsW10sW0VuYWJs
ZSBjb252ZXJ0aW5nIHVzZXJpZHMgdmlhIExEQVAgc3VwcG9ydD9dKQorCQlJTUFQX1BST0dTPSIk
SU1BUF9QUk9HUyBsZGFwZCIKKwlmaSkKKwogQUNfQVJHX0VOQUJMRShuZXRzY2FwZWhhY2ssCiAJ
WyAgLS1lbmFibGUtbmV0c2NhcGVoYWNrICAgZW5hYmxlIE5ldHNjYXBlIGhhY2sgZm9yIHRoZSBt
ZW51IG9wdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAgICBpbiBDb21tdW5pY2F0b3IgdG8g
QWRtaW5pc3RyYXRlIE1haWxdLApkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFw
L2NoYXJzZXRfY29udmVydC5jIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2NoYXJzZXRfY29udmVy
dC5jCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvY2hhcnNldF9jb252ZXJ0LmMJMTk3
MC0wMS0wMSAwMzowMDowMCArMDMwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvY2hhcnNl
dF9jb252ZXJ0LmMJMjAwNS0xMi0wOCAxOTozODo1MSArMDMwMApAQCAtMCwwICsxLDU0NSBAQAor
LyogVGhpcyBmaWxlIHdhcyB0YWtlbiBmcm9tIFBIUCA1IGFuZCB3YXMgbW9kaWZpZWQgYnkKKyAg
IEFsZXhhbmRlciBEcm96ZG92IDxkemFsX21haWxAbXR1LW5ldC5ydT4gKi8KKyNpbmNsdWRlIDxz
dGRsaWIuaD4KKworI2luY2x1ZGUgImNoYXJzZXRfY29udmVydC5oIgorCisjZGVmaW5lIFVDUzRN
QVggMHg3MDAwMDAwMFUKKworI2RlZmluZSBVQ1MyTUFYIDB4MDAwMTAwMDBVCisjZGVmaW5lIFNV
UE1JTiAgMHgwMDAxMDAwMFUKKyNkZWZpbmUgU1VQTUFYICAweDAwMjAwMDAwVQorCisjZGVmaW5l
IE1BU0sgICAgMHhmZmZmZmZVCisjZGVmaW5lIFRIUk9VR0ggMHg3ODAwMDAwMFUgICAgICAgICAg
ICAgIC8qIDAwMDAwMGggLSBGRkZGRkZoICovCisKK3R5cGVkZWYgdW5zaWduZWQgaW50IHVpbnQ7
CisKK3R5cGVkZWYgc3RydWN0IF9jb252ZXJ0X3N0YXRlIHsKKyAgICBpbnQgY2FjaGU7CisgICAg
aW50IHN0YXR1czsKK30gY29udmVydF9zdGF0ZTsKKwordHlwZWRlZiBpbnQgKCpjb252ZXJ0ZWRf
b3V0X2NiX3QpKHVpbnQgYywgdm9pZCAqKTsKK3R5cGVkZWYgaW50ICgqY29udmVydF9jYl90KSh1
aW50IGMsIGNvbnZlcnRfc3RhdGUgKiwgY29udmVydGVkX291dF9jYl90LCB2b2lkICopOwordHlw
ZWRlZiBpbnQgKCpmbHVzaF9jYl90KShjb252ZXJ0X3N0YXRlICosIGNvbnZlcnRlZF9vdXRfY2Jf
dCwgdm9pZCAqKTsKKworI2RlZmluZSBDSyhzdGF0ZW1lbnQpCWRvIHsgaWYgKChzdGF0ZW1lbnQp
KSByZXR1cm4gKC0xKTsgfSB3aGlsZSAoMCkKKworc3RhdGljIGludCB1dGY4X2VuY29kZSh1aW50
IGMsIGNvbnZlcnRfc3RhdGUgKmZpbHRlciwgY29udmVydGVkX291dF9jYl90IG91dF9jYiwgdm9p
ZCAqb3V0X2NiX3BhcmFtKQoreworICAgIC8qIHNraXAgd3Jvbmcgc3ltYm9scyAqLworICAgIGlm
IChjID4gVUNTNE1BWCkKKwlyZXR1cm4gMDsKKyAgICAKKyAgICBpZiAoYyA8IDB4ODApIHsKKwlD
SyhvdXRfY2IoYywgb3V0X2NiX3BhcmFtKSk7CisgICAgfSBlbHNlIGlmIChjIDwgMHg4MDApIHsK
KwlDSyhvdXRfY2IoKChjID4+IDYpICYgMHgxZikgfCAweGMwLCBvdXRfY2JfcGFyYW0pKTsKKwlD
SyhvdXRfY2IoKGMgJiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworICAgIH0gZWxzZSBp
ZiAoYyA8IDB4MTAwMDApIHsKKwlDSyhvdXRfY2IoKChjID4+IDEyKSAmIDB4MGYpIHwgMHhlMCwg
b3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKCgoYyA+PiA2KSAmIDB4M2YpIHwgMHg4MCwgb3V0
X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKChjICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0p
KTsKKyAgICB9IGVsc2UgaWYgKGMgPCAweDIwMDAwMCkgeworCUNLKG91dF9jYigoKGMgPj4gMTgp
ICYgMHgwNykgfCAweGYwLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IoKChjID4+IDEyKSAm
IDB4M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKCgoYyA+PiA2KSAmIDB4
M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKChjICYgMHgzZikgfCAweDgw
LCBvdXRfY2JfcGFyYW0pKTsKKyAgICB9IGVsc2UgaWYgKGMgPCAweDQwMDAwMDApIHsKKwlDSyhv
dXRfY2IoKChjID4+IDI0KSAmIDB4MDMpIHwgMHhmOCwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0
X2NiKCgoYyA+PiAxOCkgJiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9j
YigoKGMgPj4gMTIpICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2Io
KChjID4+IDYpICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IoKGMg
JiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworICAgIH0gZWxzZSB7CisJQ0sob3V0X2Ni
KCgoYyA+PiAzMCkgJiAweDAxKSB8IDB4ZmMsIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9jYigo
KGMgPj4gMjQpICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IoKChj
ID4+IDE4KSAmIDB4M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKCgoYyA+
PiAxMikgJiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9jYigoKGMgPj4g
NikgJiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9jYigoYyAmIDB4M2Yp
IHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyBpbnQgdXRmOF9kZWNvZGUodWludCBjLCBjb252ZXJ0X3N0YXRlICpmaWx0ZXIsIGNvbnZl
cnRlZF9vdXRfY2JfdCBvdXRfY2IsIHZvaWQgKm91dF9jYl9wYXJhbSkKK3sKKyAgICBpZiAoYyA8
IDB4ODApIHsKKwlDSyhvdXRfY2IoYywgb3V0X2NiX3BhcmFtKSk7CisJZmlsdGVyLT5zdGF0dXMg
PSAwOworICAgIH0gZWxzZSBpZiAoYyA8IDB4YzApIHsKKwl1aW50IHM7CisKKwlzd2l0Y2ggKGZp
bHRlci0+c3RhdHVzICYgMHhmZikgeworCWNhc2UgMHgxMDogLyogMmJ5dGUgY29kZSAybmQgY2hh
ciAqLworCWNhc2UgMHgyMTogLyogM2J5dGUgY29kZSAzcmQgY2hhciAqLworCWNhc2UgMHgzMjog
LyogNGJ5dGUgY29kZSA0dGggY2hhciAqLworCWNhc2UgMHg0MzogLyogNWJ5dGUgY29kZSA1dGgg
Y2hhciAqLworCWNhc2UgMHg1NDogLyogNmJ5dGUgY29kZSA2dGggY2hhciAqLworCSAgICBmaWx0
ZXItPnN0YXR1cyA9IDA7CisJICAgIHMgPSBmaWx0ZXItPmNhY2hlIHwgKGMgJiAweDNmKTsKKwkg
ICAgaWYgKHMgPj0gMHg4MCkKKwkJQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJhbSkpOworCSAgICBi
cmVhazsKKwljYXNlIDB4MjA6IC8qIDNieXRlIGNvZGUgMm5kIGNoYXIgKi8KKwljYXNlIDB4MzE6
IC8qIDRieXRlIGNvZGUgM3JkIGNoYXIgKi8KKwljYXNlIDB4NDI6IC8qIDVieXRlIGNvZGUgNHRo
IGNoYXIgKi8KKwljYXNlIDB4NTM6IC8qIDZieXRlIGNvZGUgNXRoIGNoYXIgKi8KKwkgICAgZmls
dGVyLT5jYWNoZSB8PSAoKGMgJiAweDNmKSA8PCA2KTsKKwkgICAgZmlsdGVyLT5zdGF0dXMrKzsK
KwkgICAgYnJlYWs7CisJY2FzZSAweDMwOiAvKiA0Ynl0ZSBjb2RlIDJuZCBjaGFyICovCisJY2Fz
ZSAweDQxOiAvKiA1Ynl0ZSBjb2RlIDNyZCBjaGFyICovCisJY2FzZSAweDUyOiAvKiA2Ynl0ZSBj
b2RlIDR0aCBjaGFyICovCisJICAgIGZpbHRlci0+Y2FjaGUgfD0gKChjICYgMHgzZikgPDwgMTIp
OworCSAgICBmaWx0ZXItPnN0YXR1cysrOworCSAgICBicmVhazsKKwljYXNlIDB4NDA6IC8qIDVi
eXRlIGNvZGUgMm5kIGNoYXIgKi8KKwljYXNlIDB4NTE6IC8qIDZieXRlIGNvZGUgM3JkIGNoYXIg
Ki8KKwkgICAgZmlsdGVyLT5jYWNoZSB8PSAoKGMgJiAweDNmKSA8PCAxOCk7CisJICAgIGZpbHRl
ci0+c3RhdHVzKys7CisJICAgIGJyZWFrOworCWNhc2UgMHg1MDogLyogNmJ5dGUgY29kZSAybmQg
Y2hhciAqLworCSAgICBmaWx0ZXItPmNhY2hlIHw9ICgoYyAmIDB4M2YpIDw8IDI0KTsKKwkgICAg
ZmlsdGVyLT5zdGF0dXMrKzsKKwkgICAgYnJlYWs7CisJZGVmYXVsdDoKKwkgICAgZmlsdGVyLT5z
dGF0dXMgPSAwOworCSAgICBicmVhazsKKwl9CisgICAgfSBlbHNlIGlmIChjIDwgMHhlMCkgeyAv
KiAyYnl0ZSBjb2RlIGZpcnN0IGNoYXIgKi8KKwlmaWx0ZXItPnN0YXR1cyA9IDB4MTA7CisJZmls
dGVyLT5jYWNoZSA9IChjICYgMHgxZikgPDwgNjsKKyAgICB9IGVsc2UgaWYgKGMgPCAweGYwKSB7
IC8qIDNieXRlIGNvZGUgZmlyc3QgY2hhciAqLworCWZpbHRlci0+c3RhdHVzID0gMHgyMDsKKwlm
aWx0ZXItPmNhY2hlID0gKGMgJiAweGYpIDw8IDEyOworICAgIH0gZWxzZSBpZiAoYyA8IDB4Zjgp
IHsgLyogNGJ5dGUgY29kZSBmaXJzdCBjaGFyICovCisJZmlsdGVyLT5zdGF0dXMgPSAweDMwOwor
CWZpbHRlci0+Y2FjaGUgPSAoYyAmIDB4NykgPDwgMTg7CisgICAgfSBlbHNlIGlmIChjIDwgMHhm
YykgeyAvKiA1Ynl0ZSBjb2RlIGZpcnN0IGNoYXIgKi8KKwlmaWx0ZXItPnN0YXR1cyA9IDB4NDA7
CisJZmlsdGVyLT5jYWNoZSA9IChjICYgMHgzKSA8PCAyNDsKKyAgICB9IGVsc2UgaWYgKGMgPCAw
eGZlKSAgeyAvKiA2IGJ5dGUgY29kZSBmaXJzdCBjaGFyICovCisJZmlsdGVyLT5zdGF0dXMgPSAw
eDUwOworCWZpbHRlci0+Y2FjaGUgPSAoYyAmIDB4MSkgPDwgMzA7CisgICAgfSBlbHNlIHsKKwlm
aWx0ZXItPnN0YXR1cyA9IDA7CisJZmlsdGVyLT5jYWNoZSA9IDA7CisgICAgfQorCisgICAgcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCB1bnNpZ25lZCBjaGFyIHV0ZjdpbWFwX2Jhc2U2NF90
YWJsZVtdID0KK3sKKyAvKiAnQScsICdCJywgJ0MnLCAnRCcsICdFJywgJ0YnLCAnRycsICdIJywg
J0knLCAnSicsICdLJywgJ0wnLCAnTScsICovCisgICAweDQxLDB4NDIsMHg0MywweDQ0LDB4NDUs
MHg0NiwweDQ3LDB4NDgsMHg0OSwweDRhLDB4NGIsMHg0YywweDRkLAorIC8qICdOJywgJ08nLCAn
UCcsICdRJywgJ1InLCAnUycsICdUJywgJ1UnLCAnVicsICdXJywgJ1gnLCAnWScsICdaJywgKi8K
KyAgIDB4NGUsMHg0ZiwweDUwLDB4NTEsMHg1MiwweDUzLDB4NTQsMHg1NSwweDU2LDB4NTcsMHg1
OCwweDU5LDB4NWEsCisgLyogJ2EnLCAnYicsICdjJywgJ2QnLCAnZScsICdmJywgJ2cnLCAnaCcs
ICdpJywgJ2onLCAnaycsICdsJywgJ20nLCAqLworICAgMHg2MSwweDYyLDB4NjMsMHg2NCwweDY1
LDB4NjYsMHg2NywweDY4LDB4NjksMHg2YSwweDZiLDB4NmMsMHg2ZCwKKyAvKiAnbicsICdvJywg
J3AnLCAncScsICdyJywgJ3MnLCAndCcsICd1JywgJ3YnLCAndycsICd4JywgJ3knLCAneicsICov
CisgICAweDZlLDB4NmYsMHg3MCwweDcxLDB4NzIsMHg3MywweDc0LDB4NzUsMHg3NiwweDc3LDB4
NzgsMHg3OSwweDdhLAorIC8qICcwJywgJzEnLCAnMicsICczJywgJzQnLCAnNScsICc2JywgJzcn
LCAnOCcsICc5JywgJysnLCAnLCcsICdcMCcgKi8KKyAgIDB4MzAsMHgzMSwweDMyLDB4MzMsMHgz
NCwweDM1LDB4MzYsMHgzNywweDM4LDB4MzksMHgyYiwweDJjLDB4MDAKK307CisKK3N0YXRpYyBp
bnQgbXV0ZjdfZW5jb2RlKHVpbnQgYywgY29udmVydF9zdGF0ZSAqZmlsdGVyLCBjb252ZXJ0ZWRf
b3V0X2NiX3Qgb3V0X2NiLCB2b2lkICpvdXRfY2JfcGFyYW0pCit7CisgICAgaW50IG4sIHM7CisK
KyAgICBuID0gMDsKKyAgICBpZiAoYyA9PSAweDI2KSB7CisJbiA9IDE7CisgICAgfSBlbHNlIGlm
ICgoYyA+PSAweDIwICYmIGMgPD0gMHg3ZSkgfHwgYyA9PSAwKSB7CisJbiA9IDI7CisgICAgfSBl
bHNlIGlmIChjID49IDAgJiYgYyA8IFVDUzJNQVgpIHsKKwk7CisgICAgfSBlbHNlIGlmIChjID49
IFNVUE1JTiAmJiBjIDwgU1VQTUFYKSB7CisJcyA9ICgoYyA+PiAxMCkgLSAweDQwKSB8IDB4ZDgw
MDsKKwlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisJcyA9IChjICYgMHgzZmYpIHwgMHhk
YzAwOworCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKwlyZXR1cm4gMDsKKyAgICB9IGVs
c2UgeworCXJldHVybiAtMTsKKyAgICB9CisKKyAgICBzd2l0Y2ggKGZpbHRlci0+c3RhdHVzKSB7
CisgICAgY2FzZSAwOgorCWlmIChuICE9IDApIHsJLyogZGlyZWN0bHkgZW5jb2RlIGNoYXJhY3Rl
cnMgKi8KKwkgICAgQ0sob3V0X2NiKGMsIG91dF9jYl9wYXJhbSkpOworCSAgICBpZiAobiA9PSAx
KSB7CisJCUNLKG91dF9jYigweDJkLCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworCSAgICB9
CisJfSBlbHNlIHsJLyogTW9kaWZpZWQgQmFzZTY0ICovCisJICAgIENLKG91dF9jYigweDI2LCBv
dXRfY2JfcGFyYW0pKTsJCS8qICcmJyAqLworCSAgICBmaWx0ZXItPnN0YXR1cyA9IDE7CisJICAg
IGZpbHRlci0+Y2FjaGUgPSBjOworCX0KKwlicmVhazsKKworCS8qIGVuY29kZSBNb2RpZmllZCBC
YXNlNjQgKi8KKyAgICBjYXNlIDE6CisJcyA9IGZpbHRlci0+Y2FjaGU7CisJQ0sob3V0X2NiKHV0
ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA+PiAxMCkgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisJ
Q0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA+PiA0KSAmIDB4M2ZdLCBvdXRfY2Jf
cGFyYW0pKTsKKwlpZiAobiAhPSAwKSB7CisJICAgIENLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRf
dGFibGVbKHMgPDwgMikgJiAweDNjXSwgb3V0X2NiX3BhcmFtKSk7CisJICAgIENLKG91dF9jYigw
eDJkLCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworCSAgICBDSyhvdXRfY2IoYywgb3V0X2Ni
X3BhcmFtKSk7CisJICAgIGlmIChuID09IDEpIHsKKwkJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9w
YXJhbSkpOwkJLyogJy0nICovCisJICAgIH0KKwkgICAgZmlsdGVyLT5zdGF0dXMgPSAwOworCX0g
ZWxzZSB7CisJICAgIGZpbHRlci0+c3RhdHVzID0gMjsKKwkgICAgZmlsdGVyLT5jYWNoZSA9ICgo
cyAmIDB4ZikgPDwgMTYpIHwgYzsKKwl9CisJYnJlYWs7CisKKyAgICBjYXNlIDI6CisJcyA9IGZp
bHRlci0+Y2FjaGU7CisJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA+PiAxNCkg
JiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJs
ZVsocyA+PiA4KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IodXRmN2ltYXBf
YmFzZTY0X3RhYmxlWyhzID4+IDIpICYgMHgzZl0sIG91dF9jYl9wYXJhbSkpOworCWlmIChuICE9
IDApIHsKKwkgICAgQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA8PCA0KSAmIDB4
MzBdLCBvdXRfY2JfcGFyYW0pKTsKKwkgICAgQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJhbSkp
OwkJLyogJy0nICovCisJICAgIENLKG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKwkgICAgaWYg
KG4gPT0gMSkgeworCQlDSyhvdXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScgKi8K
KwkgICAgfQorCSAgICBmaWx0ZXItPnN0YXR1cyA9IDA7CisJfSBlbHNlIHsKKwkgICAgZmlsdGVy
LT5zdGF0dXMgPSAzOworCSAgICBmaWx0ZXItPmNhY2hlID0gKChzICYgMHgzKSA8PCAxNikgfCBj
OworCX0KKwlicmVhazsKKworICAgIGNhc2UgMzoKKwlzID0gZmlsdGVyLT5jYWNoZTsKKwlDSyhv
dXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhzID4+IDEyKSAmIDB4M2ZdLCBvdXRfY2JfcGFy
YW0pKTsKKwlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhzID4+IDYpICYgMHgzZl0s
IG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbcyAmIDB4
M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKwlpZiAobiAhPSAwKSB7CisJICAgIENLKG91dF9jYigweDJk
LCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworCSAgICBDSyhvdXRfY2IoYywgb3V0X2NiX3Bh
cmFtKSk7CisJICAgIGlmIChuID09IDEpIHsKKwkJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJh
bSkpOwkJLyogJy0nICovCisJICAgIH0KKwkgICAgZmlsdGVyLT5zdGF0dXMgPSAwOworCX0gZWxz
ZSB7CisJICAgIGZpbHRlci0+c3RhdHVzID0gMTsKKwkgICAgZmlsdGVyLT5jYWNoZSA9IGM7CisJ
fQorCWJyZWFrOworCisgICAgZGVmYXVsdDoKKwlmaWx0ZXItPnN0YXR1cyA9IDA7CisJYnJlYWs7
CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbXV0ZjdfZGVjb2RlKHVp
bnQgYywgY29udmVydF9zdGF0ZSAqZmlsdGVyLCBjb252ZXJ0ZWRfb3V0X2NiX3Qgb3V0X2NiLCB2
b2lkICpvdXRfY2JfcGFyYW0pCit7CisgICAgaW50IHMsIG47CisKKyAgICBuID0gLTE7CisgICAg
aWYgKGZpbHRlci0+c3RhdHVzICE9IDApIHsJCS8qIE1vZGlmaWVkIEJhc2U2NCAqLworCWlmIChj
ID49IDB4NDEgJiYgYyA8PSAweDVhKSB7CQkvKiBBIC0gWiAqLworCSAgICBuID0gYyAtIDY1Owor
CX0gZWxzZSBpZiAoYyA+PSAweDYxICYmIGMgPD0gMHg3YSkgewkvKiBhIC0geiAqLworCSAgICBu
ID0gYyAtIDcxOworCX0gZWxzZSBpZiAoYyA+PSAweDMwICYmIGMgPD0gMHgzOSkgewkvKiAwIC0g
OSAqLworCSAgICBuID0gYyArIDQ7CisJfSBlbHNlIGlmIChjID09IDB4MmIpIHsJCQkvKiAnKycg
Ki8KKwkgICAgbiA9IDYyOworCX0gZWxzZSBpZiAoYyA9PSAweDJjKSB7CQkJLyogJywnICovCisJ
ICAgIG4gPSA2MzsKKwl9CisJaWYgKG4gPCAwIHx8IG4gPiA2MykgeworCSAgICBpZiAoYyA9PSAw
eDJkKSB7CisJCWlmIChmaWx0ZXItPnN0YXR1cyA9PSAxKSB7CQkvKiAiJi0iIC0+ICImIiAqLwor
CQkgICAgQ0sob3V0X2NiKDB4MjYsIG91dF9jYl9wYXJhbSkpOworCQl9CisJICAgIH0gZWxzZSBp
ZiAoYyA+PSAwICYmIGMgPCAweDgwKSB7CS8qIEFTQ0lJIGV4Y2x1ZGUgJy0nICovCisJCUNLKG91
dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKwkgICAgfSBlbHNlIHsJCS8qIGlsbGVnYWwgY2hhcmFj
dGVyICovCisJCXMgPSBjICYgTUFTSzsKKwkJcyB8PSBUSFJPVUdIOworCQlDSyhvdXRfY2Iocywg
b3V0X2NiX3BhcmFtKSk7CisJICAgIH0KKwkgICAgZmlsdGVyLT5jYWNoZSA9IDA7CisJICAgIGZp
bHRlci0+c3RhdHVzID0gMDsKKwkgICAgcmV0dXJuIDA7CisJfQorICAgIH0KKworICAgIHN3aXRj
aCAoZmlsdGVyLT5zdGF0dXMpIHsKKwkvKiBkaXJlY3RseSBlbmNvZGVkIGNoYXJhY3RlcnMgKi8K
KyAgICBjYXNlIDA6CisJaWYgKGMgPT0gMHgyNikgewkvKiAnJicgIHNoaWZ0IGNoYXJhY3RlciAq
LworCSAgICBmaWx0ZXItPnN0YXR1cysrOworCX0gZWxzZSBpZiAoYyA+PSAwICYmIGMgPCAweDgw
KSB7CS8qIEFTQ0lJICovCisJICAgIENLKG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKwl9IGVs
c2UgewkJLyogaWxsZWdhbCBjaGFyYWN0ZXIgKi8KKwkgICAgcyA9IGMgJiBNQVNLOworCSAgICBz
IHw9IFRIUk9VR0g7CisJICAgIENLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKwl9CisJYnJl
YWs7CisKKwkvKiBkZWNvZGUgTW9kaWZpZWQgQmFzZTY0ICovCisgICAgY2FzZSAxOgorICAgIGNh
c2UgMjoKKwlmaWx0ZXItPmNhY2hlIHw9IG4gPDwgMTA7CisJZmlsdGVyLT5zdGF0dXMgPSAzOwor
CWJyZWFrOworICAgIGNhc2UgMzoKKwlmaWx0ZXItPmNhY2hlIHw9IG4gPDwgNDsKKwlmaWx0ZXIt
PnN0YXR1cyA9IDQ7CisJYnJlYWs7CisgICAgY2FzZSA0OgorCXMgPSAoKG4gPj4gMikgJiAweGYp
IHwgKGZpbHRlci0+Y2FjaGUgJiAweGZmZmYpOworCW4gPSAobiAmIDB4MykgPDwgMTQ7CisJZmls
dGVyLT5zdGF0dXMgPSA1OworCWlmIChzID49IDB4ZDgwMCAmJiBzIDwgMHhkYzAwKSB7CisJICAg
IHMgPSAoKChzICYgMHgzZmYpIDw8IDE2KSArIDB4NDAwMDAwKSB8IG47CisJICAgIGZpbHRlci0+
Y2FjaGUgPSBzOworCX0gZWxzZSBpZiAocyA+PSAweGRjMDAgJiYgcyA8IDB4ZTAwMCkgeworCSAg
ICBzICY9IDB4M2ZmOworCSAgICBzIHw9IChmaWx0ZXItPmNhY2hlICYgMHhmZmYwMDAwKSA+PiA2
OworCSAgICBmaWx0ZXItPmNhY2hlID0gbjsKKwkgICAgaWYgKHMgPj0gU1VQTUlOICYmIHMgPCBT
VVBNQVgpIHsKKwkJQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJhbSkpOworCSAgICB9IGVsc2UgewkJ
LyogaWxsZWdhbCBjaGFyYWN0ZXIgKi8KKwkJcyAmPSBNQVNLOworCQlzIHw9IFRIUk9VR0g7CisJ
CUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKwkgICAgfQorCX0gZWxzZSB7CisJICAgIGZp
bHRlci0+Y2FjaGUgPSBuOworCSAgICBDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisJfQor
CWJyZWFrOworCisgICAgY2FzZSA1OgorCWZpbHRlci0+Y2FjaGUgfD0gbiA8PCA4OworCWZpbHRl
ci0+c3RhdHVzID0gNjsKKwlicmVhazsKKyAgICBjYXNlIDY6CisJZmlsdGVyLT5jYWNoZSB8PSBu
IDw8IDI7CisJZmlsdGVyLT5zdGF0dXMgPSA3OworCWJyZWFrOworICAgIGNhc2UgNzoKKwlzID0g
KChuID4+IDQpICYgMHgzKSB8IChmaWx0ZXItPmNhY2hlICYgMHhmZmZmKTsKKwluID0gKG4gJiAw
eGYpIDw8IDEyOworCWZpbHRlci0+c3RhdHVzID0gODsKKwlpZiAocyA+PSAweGQ4MDAgJiYgcyA8
IDB4ZGMwMCkgeworCSAgICBzID0gKCgocyAmIDB4M2ZmKSA8PCAxNikgKyAweDQwMDAwMCkgfCBu
OworCSAgICBmaWx0ZXItPmNhY2hlID0gczsKKwl9IGVsc2UgaWYgKHMgPj0gMHhkYzAwICYmIHMg
PCAweGUwMDApIHsKKwkgICAgcyAmPSAweDNmZjsKKwkgICAgcyB8PSAoZmlsdGVyLT5jYWNoZSAm
IDB4ZmZmMDAwMCkgPj4gNjsKKwkgICAgZmlsdGVyLT5jYWNoZSA9IG47CisJICAgIGlmIChzID49
IFNVUE1JTiAmJiBzIDwgU1VQTUFYKSB7CisJCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsK
KwkgICAgfSBlbHNlIHsJCS8qIGlsbGVnYWwgY2hhcmFjdGVyICovCisJCXMgJj0gTUFTSzsKKwkJ
cyB8PSBUSFJPVUdIOworCQlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisJICAgIH0KKwl9
IGVsc2UgeworCSAgICBmaWx0ZXItPmNhY2hlID0gbjsKKwkgICAgQ0sob3V0X2NiKHMsIG91dF9j
Yl9wYXJhbSkpOworCX0KKwlicmVhazsKKworICAgIGNhc2UgODoKKwlmaWx0ZXItPmNhY2hlIHw9
IG4gPDwgNjsKKwlmaWx0ZXItPnN0YXR1cyA9IDk7CisJYnJlYWs7CisgICAgY2FzZSA5OgorCXMg
PSBuIHwgKGZpbHRlci0+Y2FjaGUgJiAweGZmZmYpOworCWZpbHRlci0+c3RhdHVzID0gMjsKKwlp
ZiAocyA+PSAweGQ4MDAgJiYgcyA8IDB4ZGMwMCkgeworCSAgICBzID0gKCgocyAmIDB4M2ZmKSA8
PCAxNikgKyAweDQwMDAwMCk7CisJICAgIGZpbHRlci0+Y2FjaGUgPSBzOworCX0gZWxzZSBpZiAo
cyA+PSAweGRjMDAgJiYgcyA8IDB4ZTAwMCkgeworCSAgICBzICY9IDB4M2ZmOworCSAgICBzIHw9
IChmaWx0ZXItPmNhY2hlICYgMHhmZmYwMDAwKSA+PiA2OworCSAgICBmaWx0ZXItPmNhY2hlID0g
MDsKKwkgICAgaWYgKHMgPj0gU1VQTUlOICYmIHMgPCBTVVBNQVgpIHsKKwkJQ0sob3V0X2NiKHMs
IG91dF9jYl9wYXJhbSkpOworCSAgICB9IGVsc2UgewkJLyogaWxsZWdhbCBjaGFyYWN0ZXIgKi8K
KwkJcyAmPSBNQVNLOworCQlzIHw9IFRIUk9VR0g7CisJCUNLKG91dF9jYihzLCBvdXRfY2JfcGFy
YW0pKTsKKwkgICAgfQorCX0gZWxzZSB7CisJICAgIGZpbHRlci0+Y2FjaGUgPSAwOworCSAgICBD
SyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisJfQorCWJyZWFrOworCisgICAgZGVmYXVsdDoK
KwlmaWx0ZXItPnN0YXR1cyA9IDA7CisJYnJlYWs7CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9
CitzdGF0aWMgaW50IG11dGY3X2VuY29kZV9mbHVzaChjb252ZXJ0X3N0YXRlICpmaWx0ZXIsIGNv
bnZlcnRlZF9vdXRfY2JfdCBvdXRfY2IsIHZvaWQgKm91dF9jYl9wYXJhbSkKK3sKKyAgICBpbnQg
c3RhdHVzLCBjYWNoZTsKKworICAgIHN0YXR1cyA9IGZpbHRlci0+c3RhdHVzOworICAgIGNhY2hl
ID0gZmlsdGVyLT5jYWNoZTsKKyAgICBmaWx0ZXItPnN0YXR1cyA9IDA7CisgICAgZmlsdGVyLT5j
YWNoZSA9IDA7CisgICAgLyogZmx1c2ggZnJhZ21lbnRzICovCisgICAgc3dpdGNoIChzdGF0dXMp
IHsKKyAgICBjYXNlIDE6CisJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsoY2FjaGUg
Pj4gMTApICYgMHgzZl0sIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9jYih1dGY3aW1hcF9iYXNl
NjRfdGFibGVbKGNhY2hlID4+IDQpICYgMHgzZl0sIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9j
Yih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKGNhY2hlIDw8IDIpICYgMHgzY10sIG91dF9jYl9wYXJh
bSkpOworCUNLKG91dF9jYigweDJkLCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworCWJyZWFr
OworCisgICAgY2FzZSAyOgorCUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKGNhY2hl
ID4+IDE0KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IodXRmN2ltYXBfYmFz
ZTY0X3RhYmxlWyhjYWNoZSA+PiA4KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRf
Y2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhjYWNoZSA+PiAyKSAmIDB4M2ZdLCBvdXRfY2JfcGFy
YW0pKTsKKwlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhjYWNoZSA8PCA0KSAmIDB4
MzBdLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkv
KiAnLScgKi8KKwlicmVhazsKKworICAgIGNhc2UgMzoKKwlDSyhvdXRfY2IodXRmN2ltYXBfYmFz
ZTY0X3RhYmxlWyhjYWNoZSA+PiAxMikgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0
X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsoY2FjaGUgPj4gNikgJiAweDNmXSwgb3V0X2NiX3Bh
cmFtKSk7CisJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVtjYWNoZSAmIDB4M2ZdLCBv
dXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScg
Ki8KKwlicmVhazsKKyAgICB9CisgICAgcmV0dXJuIDA7Cit9CisKK3R5cGVkZWYgc3RydWN0IF9j
b252ZXJ0X29wdHMgeworICAgIGNvbnZlcnRfY2JfdCBlbmNvZGVfY2I7CisgICAgY29udmVydF9j
Yl90IGRlY29kZV9jYjsKKyAgICBmbHVzaF9jYl90IGZsdXNoX2VuY29kZTsKKyAgICBmbHVzaF9j
Yl90IGZsdXNoX2RlY29kZTsKK30gY29udmVydF9vcHRzOworCit0eXBlZGVmIHN0cnVjdCBfcGFy
YW1fY29udmVydCB7CisgICAgaW50IGxlbjsKKyAgICBjaGFyICpvdXQ7CisgICAgY29udmVydF9v
cHRzICpvcHRzOworICAgIGNvbnZlcnRfc3RhdGUgZmlsdGVyOworfSBwYXJhbV9jb252ZXJ0Owor
CisvKiBqdXN0IGEgY291bnRlciAqLworc3RhdGljIGludCBjb3VudF9sZW5fY2IodWludCBjLCB2
b2lkICpwYXJhbSkKK3sKKyAgICAoKihpbnQgKilwYXJhbSkrKzsKKyAgICByZXR1cm4gMDsKK30K
Kworc3RhdGljIGludCB3cml0ZV9vdXRfY2IodWludCBjLCB2b2lkICpwYXJhbSkKK3sKKyAgICBw
YXJhbV9jb252ZXJ0ICpyX3BhcmFtPShwYXJhbV9jb252ZXJ0ICopcGFyYW07CisKKyAgICByX3Bh
cmFtLT5vdXRbcl9wYXJhbS0+bGVuXT0oY2hhciljOworICAgIHJfcGFyYW0tPmxlbisrOworICAg
IHJldHVybiAwOworfQorCisvKiAnYycgaXMgd2NoYXIuIHdlIG5lZWQgdG8gY2FsbCBlbmNvZGVf
Y2IgZnVuY3Rpb24gdG8gY2FsY3VsYXRlIHRoZQorICAgb3V0cHV0IGJ1ZmZlciBzaXplICovCitz
dGF0aWMgaW50IGdldF9sZW5fY2IodWludCBjLCB2b2lkICpwYXJhbSkKK3sKKyAgICByZXR1cm4g
KChwYXJhbV9jb252ZXJ0ICopcGFyYW0pLT5vcHRzLT5lbmNvZGVfY2IoYywgJigocGFyYW1fY29u
dmVydCAqKXBhcmFtKS0+ZmlsdGVyLCBjb3VudF9sZW5fY2IsICh2b2lkICopJigocGFyYW1fY29u
dmVydCAqKXBhcmFtKS0+bGVuKTsKK30KKworc3RhdGljIGludCByZWFsX291dF9jYih1aW50IGMs
IHZvaWQgKnBhcmFtKQoreworICAgIHJldHVybiAoKHBhcmFtX2NvbnZlcnQgKilwYXJhbSktPm9w
dHMtPmVuY29kZV9jYihjLCAmKChwYXJhbV9jb252ZXJ0ICopcGFyYW0pLT5maWx0ZXIsIHdyaXRl
X291dF9jYiwgcGFyYW0pOworfQorCitzdGF0aWMgY2hhciAqZG9fY29udmVyc2lvbihjb252ZXJ0
X29wdHMgKm9wdHMsIGNoYXIgKmluLCBpbnQgaW5sZW4sIGludCAqb3V0bGVuKQoreworICAgIHBh
cmFtX2NvbnZlcnQgcGFyYW07CisgICAgY29udmVydF9zdGF0ZSBmaWx0ZXI7CisgICAgaW50IGk7
CisKKyAgICBwYXJhbS5sZW4gPSAwOworICAgIHBhcmFtLm9wdHMgPSBvcHRzOworICAgIGJ6ZXJv
KCZwYXJhbS5maWx0ZXIsIHNpemVvZihwYXJhbS5maWx0ZXIpKTsKKyAgICBiemVybygmZmlsdGVy
LCBzaXplb2YoZmlsdGVyKSk7CisKKyAgICBmb3IoaT0wOyBpPGlubGVuOyBpKyspCisJaWYob3B0
cy0+ZGVjb2RlX2NiKCh1aW50KSh1bnNpZ25lZCBjaGFyKWluW2ldLCAmZmlsdGVyLCBnZXRfbGVu
X2NiLCAodm9pZCAqKSZwYXJhbSkpCisJICAgIHJldHVybiBOVUxMOworCisgICAgaWYob3B0cy0+
Zmx1c2hfZGVjb2RlKQorCWlmKG9wdHMtPmZsdXNoX2RlY29kZSgmZmlsdGVyLCBnZXRfbGVuX2Ni
LCAodm9pZCAqKSZwYXJhbSkpCisJICAgIHJldHVybiBOVUxMOworICAgIGlmKG9wdHMtPmZsdXNo
X2VuY29kZSkKKwlpZihvcHRzLT5mbHVzaF9lbmNvZGUoJnBhcmFtLmZpbHRlciwgY291bnRfbGVu
X2NiLCAodm9pZCAqKSZwYXJhbS5sZW4pKQorCSAgICByZXR1cm4gTlVMTDsKKworICAgIGlmKCEo
cGFyYW0ub3V0PShjaGFyICopbWFsbG9jKHBhcmFtLmxlbikpKQorCXJldHVybiBOVUxMOworICAg
IHBhcmFtLmxlbj0wOworICAgIGJ6ZXJvKCZwYXJhbS5maWx0ZXIsIHNpemVvZihwYXJhbS5maWx0
ZXIpKTsKKyAgICBiemVybygmZmlsdGVyLCBzaXplb2YoZmlsdGVyKSk7CisgICAgCisgICAgZm9y
KGk9MDsgaTxpbmxlbjsgaSsrKQorCWlmKG9wdHMtPmRlY29kZV9jYigodWludCkodW5zaWduZWQg
Y2hhcilpbltpXSwgJmZpbHRlciwgcmVhbF9vdXRfY2IsICh2b2lkICopJnBhcmFtKSkgeworCSAg
ICBmcmVlKHBhcmFtLm91dCk7CisJICAgIHJldHVybiBOVUxMOworCX0KKworICAgIGlmKG9wdHMt
PmZsdXNoX2RlY29kZSkKKwlpZihvcHRzLT5mbHVzaF9kZWNvZGUoJmZpbHRlciwgcmVhbF9vdXRf
Y2IsICh2b2lkICopJnBhcmFtKSkgeworCSAgICBmcmVlKHBhcmFtLm91dCk7CisJICAgIHJldHVy
biBOVUxMOworCX0KKyAgICBpZihvcHRzLT5mbHVzaF9lbmNvZGUpCisJaWYob3B0cy0+Zmx1c2hf
ZW5jb2RlKCZwYXJhbS5maWx0ZXIsIHdyaXRlX291dF9jYiwgKHZvaWQgKikmcGFyYW0ubGVuKSkg
eworCSAgICBmcmVlKHBhcmFtLm91dCk7CisJICAgIHJldHVybiBOVUxMOworCX0KKworICAgICpv
dXRsZW4gPSBwYXJhbS5sZW47CisgICAgcmV0dXJuIHBhcmFtLm91dDsKK30KKworZXh0ZXJuIGNo
YXIgKnV0ZjhfdG9fbXV0ZjcoY2hhciAqaW4sIGludCBpbmxlbiwgaW50ICpvdXRsZW4pCit7Cisg
ICAgY29udmVydF9vcHRzIG9wdHM7CisKKyAgICBvcHRzLmVuY29kZV9jYiA9IG11dGY3X2VuY29k
ZTsKKyAgICBvcHRzLmRlY29kZV9jYiA9IHV0ZjhfZGVjb2RlOworICAgIG9wdHMuZmx1c2hfZW5j
b2RlID0gbXV0ZjdfZW5jb2RlX2ZsdXNoOworICAgIG9wdHMuZmx1c2hfZGVjb2RlID0gTlVMTDsK
KworICAgIHJldHVybiBkb19jb252ZXJzaW9uKCZvcHRzLCBpbiwgaW5sZW4sIG91dGxlbik7Cit9
CisKK2V4dGVybiBjaGFyICptdXRmN190b191dGY4KGNoYXIgKmluLCBpbnQgaW5sZW4sIGludCAq
b3V0bGVuKQoreworICAgIGNvbnZlcnRfb3B0cyBvcHRzOworCisgICAgb3B0cy5lbmNvZGVfY2Ig
PSB1dGY4X2VuY29kZTsKKyAgICBvcHRzLmRlY29kZV9jYiA9IG11dGY3X2RlY29kZTsKKyAgICBv
cHRzLmZsdXNoX2VuY29kZSA9IE5VTEw7CisgICAgb3B0cy5mbHVzaF9kZWNvZGUgPSBOVUxMOwor
CisgICAgcmV0dXJuIGRvX2NvbnZlcnNpb24oJm9wdHMsIGluLCBpbmxlbiwgb3V0bGVuKTsKK30K
ZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9jaGFyc2V0X2NvbnZlcnQuaCBj
eXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9jaGFyc2V0X2NvbnZlcnQuaAotLS0gY3lydXMtaW1hcGQt
Mi4yLjEyLm9sZC9pbWFwL2NoYXJzZXRfY29udmVydC5oCTE5NzAtMDEtMDEgMDM6MDA6MDAgKzAz
MDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2NoYXJzZXRfY29udmVydC5oCTIwMDUtMTIt
MDggMTk6Mzg6NTEgKzAzMDAKQEAgLTAsMCArMSw3IEBACisjaWZuZGVmIF9DSEFSU0VUX0NPTlZF
UlRfSAorI2RlZmluZSBfQ0hBUlNFVF9DT05WRVJUX0gKKworZXh0ZXJuIGNoYXIgKnV0ZjhfdG9f
bXV0ZjcoY2hhciAqaW4sIGludCBpbmxlbiwgaW50ICpvdXRsZW4pOworZXh0ZXJuIGNoYXIgKm11
dGY3X3RvX3V0ZjgoY2hhciAqaW4sIGludCBpbmxlbiwgaW50ICpvdXRsZW4pOworCisjZW5kaWYg
LyogX0NIQVJTRVRfQ09OVkVSVF9IICovCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xk
L2ltYXAvaWRsZV9pZGxlZC5jIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2lkbGVfaWRsZWQuYwot
LS0gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL2lkbGVfaWRsZWQuYwkyMDA1LTEyLTA4IDE2
OjU4OjQ5ICswMzAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9pZGxlX2lkbGVkLmMJMjAw
NS0xMi0wOCAxOTozODo1MiArMDMwMApAQCAtMjMzLDcgKzIzMyw3IEBACiAgICAgLyogc2VuZCAq
LwogICAgIGlmIChzZW5kdG8obm90aWZ5X3NvY2ssICh2b2lkICopICZpZGxlZGF0YSwKIAkgICAg
ICAgSURMRURBVEFfQkFTRV9TSVpFK3N0cmxlbihpZGxlZGF0YS5tYm94bmFtZSkrMSwgLyogMSBm
b3IgTlVMTCAqLwotCSAgICAgICAwLCAoc3RydWN0IHNvY2thZGRyICopICZpZGxlX3JlbW90ZSwg
aWRsZV9yZW1vdGVfbGVuKSA9PSAtMSkgeworCSAgICAgICAwLCAoc3RydWN0IHNvY2thZGRyICop
ICZpZGxlX3JlbW90ZSwgaWRsZV9yZW1vdGVfbGVuKSA9PSAoc3NpemVfdCktMSkgewogICAgICAg
c3lzbG9nKExPR19FUlIsICJlcnJvciBzZW5kaW5nIHRvIGlkbGVkOiAleCIsIG1zZyk7CiAgICAg
ICByZXR1cm4gMDsKICAgICB9CmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAv
aW1hcGQuYyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9pbWFwZC5jCi0tLSBjeXJ1cy1pbWFwZC0y
LjIuMTIub2xkL2ltYXAvaW1hcGQuYwkyMDA1LTEyLTA4IDE2OjU5OjA0ICswMzAwCisrKyBjeXJ1
cy1pbWFwZC0yLjIuMTIvaW1hcC9pbWFwZC5jCTIwMDUtMTItMDggMTk6Mzg6NTIgKzAzMDAKQEAg
LTgwLDYgKzgwLDkgQEAKICNpbmNsdWRlICJtYWlsYm94LmgiCiAjaW5jbHVkZSAibWVzc2FnZS5o
IgogI2luY2x1ZGUgIm1ib3huYW1lLmgiCisjaWZkZWYgRU5BQkxFX0NPTlZFUlRfVVNFUklECisj
aW5jbHVkZSAibGRhcGQuaCIKKyNlbmRpZgogI2luY2x1ZGUgIm1ib3hsaXN0LmgiCiAjaW5jbHVk
ZSAibWJkdW1wLmgiCiAjaW5jbHVkZSAibWtnbXRpbWUuaCIKQEAgLTQ3Nyw2ICs0ODAsMTEgQEAK
ICAgICB9CiAjZW5kaWYKIAorI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICAgIGlmKGlt
YXBkX2NvbnZlcnR1c2VyaWQpCisJbWJveG5hbWVfY2xlYW51cCgpOworI2VuZGlmIC8qIEVOQUJM
RV9DT05WRVJUX1VTRVJJRCAqLworCiAgICAgY3lydXNfcmVzZXRfc3RkaW8oKTsgCiAKICAgICBz
dHJjcHkoaW1hcGRfY2xpZW50aG9zdCwgIltsb2NhbF0iKTsKQEAgLTU1Myw2ICs1NjEsMTEgQEAK
IAkJCQkgICAwLCAnLicsIDApKQogCWZhdGFsKCJjYW5ub3QgaW5pdGlhbGl6ZSB0aGUgaW50ZXJu
YWwgbmFtZXNwYWNlIiwgRUNfVEVNUEZBSUwpOwogCisjaWZkZWYgRU5BQkxFX0NPTlZFUlRfVVNF
UklECisgICAgaWYoY29udmVydHVzZXJpZF9pbml0KCkpCisgICAgICAgZmF0YWwoImNvbnZlcnR1
c2VyaWRfaW5pdCgpIGZhaWxlZCIsIEVDX0NPTkZJRyk7CisjZW5kaWYgLyogRU5BQkxFX0NPTlZF
UlRfVVNFUklEICovCisKICAgICAvKiBvcGVuIHRoZSBtYm94bGlzdCwgd2UnbGwgbmVlZCBpdCBm
b3IgcmVhbCB3b3JrICovCiAgICAgbWJveGxpc3RfaW5pdCgwKTsKICAgICBtYm94bGlzdF9vcGVu
KE5VTEwpOwpAQCAtNjI0LDYgKzYzNywxMSBAQAogICAgIGltYXBkX2luID0gcHJvdF9uZXcoMCwg
MCk7CiAgICAgaW1hcGRfb3V0ID0gcHJvdF9uZXcoMSwgMSk7CiAKKyNpZmRlZiBFTkFCTEVfQ09O
VkVSVF9VU0VSSUQKKyAgICBpZihjb252ZXJ0dXNlcmlkX2NvbmZpZ19yZXJlYWQoKSkKKwlmYXRh
bCgiQ2FuJ3QgcmVyZWFkIGNvbmZpZ3VyYXRpb24gZmlsZXMiLCBFQ19DT05GSUcpOworI2VuZGlm
CisKICAgICAvKiBGaW5kIG91dCBuYW1lIG9mIGNsaWVudCBob3N0ICovCiAgICAgc2FsZW4gPSBz
aXplb2YoaW1hcGRfcmVtb3RlYWRkcik7CiAgICAgaWYgKGdldHBlZXJuYW1lKDAsIChzdHJ1Y3Qg
c29ja2FkZHIgKikmaW1hcGRfcmVtb3RlYWRkciwgJnNhbGVuKSA9PSAwICYmCkBAIC03MDgsNiAr
NzI2LDkgQEAKIC8qIENhbGxlZCBieSBzZXJ2aWNlIEFQSSB0byBzaHV0IGRvd24gdGhlIHNlcnZp
Y2UgKi8KIHZvaWQgc2VydmljZV9hYm9ydChpbnQgZXJyb3IpCiB7CisjaWZkZWYgRU5BQkxFX0NP
TlZFUlRfVVNFUklECisgICAgY29udmVydHVzZXJpZF9jbGVhbnVwKCk7CisjZW5kaWYgLyogRU5B
QkxFX0NPTlZFUlRfVVNFUklEICovCiAgICAgc2h1dF9kb3duKGVycm9yKTsKIH0KIApAQCAtMTY5
OSw2ICsxNzIwLDUxIEBACiAgICAgfQogfQogCitzdGF0aWMgdm9pZCBpbWFwZF9sb2dnZWR1c2Vy
X2luaXQoKQoreworI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICAgIGNoYXIgKmV4ZW1w
dHM7CisKKyAgICBpZighaW1hcGRfbmFtZXNwYWNlLmlzYWx0KQorCXJldHVybjsKKyAgICAKKyAg
ICBpbWFwZF9jb252ZXJ0dXNlcmlkID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0NPTlZFUlRV
U0VSSUQpOworICAgIGV4ZW1wdHMgPSAoY2hhciAqKWNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9D
T05WRVJUVVNFUklEX0VYRU1QVFMpOworCisgICAgaWYoZXhlbXB0cykgeworCS8qIGxvb2sgZm9y
IHVzZXJpZCBpbnNpZGUgJ2V4ZW1wdHMnIHN0cmluZyAqLworCWNoYXIgKnA9ZXhlbXB0czsKKwlj
aGFyICpuOworCWludCB1c2VyaWRfbGVuPXN0cmxlbihpbWFwZF91c2VyaWQpOworCisJZG8gewor
CSAgICBmb3IoOyAqcD09JyAnOyBwKyspOworCSAgICBpZigqcCkgeworCQlpbnQgcmVzOworCQlp
bnQgY19sZW47CisKKwkJbj1zdHJjaHIocCwgJyAnKTsKKwkJCisJCWNfbGVuID0gbiA/IChuLXAp
OiBzdHJsZW4ocCk7CisKKwkJaWYoY19sZW49PXVzZXJpZF9sZW4gJiYgIW1lbWNtcChpbWFwZF91
c2VyaWQsIHAsIHVzZXJpZF9sZW4pKSB7CisJCSAgICAvKiB1c2VyaWQgaGFzIGJlZW4gZm91bmQh
IHN3aXRjaCBjb252ZXJ0dXNlcmlkCisJCSAgICAgICBvcHRpb24gKi8KKwkJICAgIGltYXBkX2Nv
bnZlcnR1c2VyaWQgPSAhaW1hcGRfY29udmVydHVzZXJpZDsKKwkJICAgIGJyZWFrOworCQl9CisK
KwkJcD1uOworCSAgICB9CisJfSB3aGlsZShwKTsKKyAgICB9CisgICAgaWYoaW1hcGRfY29udmVy
dHVzZXJpZCkgeworCWltYXBkX25vbmNvbnZlcnRlZHVzZXJpZF9hbGxvd2VkID0gY29uZmlnX2dl
dHN3aXRjaChJTUFQT1BUX0NPTlZFUlRVU0VSSURfQUxMT1dfTk9OQ09OVkVSVEVEKTsKKwlpbWFw
ZF9kb250aWdub3JlX2NvbnZlcnR1c2VyaWRfZXJyb3JzID0gY29uZmlnX2dldHN3aXRjaChJTUFQ
T1BUX0NPTlZFUlRVU0VSSURfRE9OVElHTk9SRV9FUlJPUlMpOworICAgIH0KKyNlbmRpZgorfQor
CiBzdGF0aWMgdm9pZCB1c2VyaWRfdG9pbnRlcm5hbChzdHJ1Y3QgbmFtZXNwYWNlICpuYW1lc3Bh
Y2UsIGNoYXIgKnVzZXJpZCkKIHsKICAgICBjaGFyIGhpZXJzZXBfb3JpZyA9IG5hbWVzcGFjZS0+
aGllcl9zZXA7CkBAIC0xODk4LDYgKzE5NjQsNyBAQAogCiAgICAgLyogVHJhbnNsYXRlIGFueSBz
ZXBhcmF0b3JzIGluIHVzZXJpZCAqLwogICAgIHVzZXJpZF90b2ludGVybmFsKCZpbWFwZF9uYW1l
c3BhY2UsIGltYXBkX3VzZXJpZCk7CisgICAgaW1hcGRfbG9nZ2VkdXNlcl9pbml0KCk7CiAKICAg
ICBmcmVlYnVmKCZwYXNzd2RidWYpOwogCkBAIC0yMDQ1LDYgKzIxMTIsNyBAQAogCiAgICAgLyog
VHJhbnNsYXRlIGFueSBzZXBhcmF0b3JzIGluIHVzZXJpZCAqLwogICAgIHVzZXJpZF90b2ludGVy
bmFsKCZpbWFwZF9uYW1lc3BhY2UsIGltYXBkX3VzZXJpZCk7CisgICAgaW1hcGRfbG9nZ2VkdXNl
cl9pbml0KCk7CiAKICAgICBhdXRvY3JlYXRlX2luYm94KCk7CiAKZGlmZiAtdXJOIGN5cnVzLWlt
YXBkLTIuMi4xMi5vbGQvaW1hcC9sZGFwZC5jIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2xkYXBk
LmMKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9sZGFwZC5jCTE5NzAtMDEtMDEgMDM6
MDA6MDAgKzAzMDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2xkYXBkLmMJMjAwNS0xMi0w
OCAxOTozODo1MiArMDMwMApAQCAtMCwwICsxLDQxMiBAQAorI2lmZGVmIEhBVkVfQ09ORklHX0gK
KyNpbmNsdWRlIDxjb25maWcuaD4KKyNlbmRpZgorCisjaW5jbHVkZSA8c3lzL3R5cGVzLmg+Cisj
aW5jbHVkZSA8c3lzL3NvY2tldC5oPgorI2luY2x1ZGUgPG5ldGluZXQvaW4uaD4KKyNpbmNsdWRl
IDxhcnBhL2luZXQuaD4KKyNpbmNsdWRlIDxzeXMvdW4uaD4KKyNpbmNsdWRlIDxzeXNsb2cuaD4K
KyNpbmNsdWRlIDxzeXMvc3RhdC5oPgorI2luY2x1ZGUgPHN0ZGlvLmg+CisjaW5jbHVkZSA8c3Rk
bGliLmg+CisjaW5jbHVkZSA8c3RyaW5nLmg+CisjaW5jbHVkZSA8ZXJybm8uaD4KKyNkZWZpbmUg
X0dOVV9TT1VSQ0UKKyNpbmNsdWRlIDxnZXRvcHQuaD4KKyNpbmNsdWRlIDxhc3NlcnQuaD4KKyNp
ZmRlZiBIQVZFX1VOSVNURF9ICisjaW5jbHVkZSA8dW5pc3RkLmg+CisjZW5kaWYKKyNpbmNsdWRl
IDxsYmVyLmg+CisjaW5jbHVkZSA8bGRhcC5oPgorCisjaW5jbHVkZSAibGRhcGQuaCIKKyNpbmNs
dWRlICJnbG9iYWwuaCIKKyNpbmNsdWRlICJjaGFyc2V0X2NvbnZlcnQuaCIKKyNpbmNsdWRlICJl
eGl0Y29kZXMuaCIKKworLyogZ2xvYmFsIHN0YXRlICovCitjb25zdCBpbnQgY29uZmlnX25lZWRf
ZGF0YSA9IDA7CisKK3N0YXRpYyBMREFQICpsZGFwX3Nlc3Npb249TlVMTDsKKworI2RlZmluZSBM
REFQX0ZJTFRFUl9URU1QTEFURVNJWkUgOAorCisvKiBvcHRpb25zIHdoaWNoIHdhcyByZWFkIGZy
b20gY29uZmlndXJhdGlvbiBmaWxlcyAqLworc3RhdGljIGNvbnN0IGNoYXIgKmxkYXBfaG9zdDsK
K3N0YXRpYyBjb25zdCBjaGFyICpsZGFwZF9sb2NhbGhvc3Q7CitzdGF0aWMgaW50IGxkYXBfcG9y
dDsKK3N0YXRpYyBjb25zdCBjaGFyICpsZGFwX3VzZXI7CitzdGF0aWMgY29uc3QgY2hhciAqbGRh
cF9wYXNzd29yZDsKK3N0YXRpYyBjb25zdCBjaGFyICpsZGFwX2Jhc2U7CitzdGF0aWMgY29uc3Qg
Y2hhciAqbGRhcF9hdHRyX2ludDsKK3N0YXRpYyBjb25zdCBjaGFyICpsZGFwX2F0dHJfZXh0Owor
c3RhdGljIGNoYXIgKmxkYXBfZmlsdGVyX2ludDsKK3N0YXRpYyBjaGFyICpsZGFwX2ZpbHRlcl9l
eHQ7CitzdGF0aWMgaW50IGxkYXBfZmlsdGVyX2ludF9sZW47CitzdGF0aWMgaW50IGxkYXBfZmls
dGVyX2V4dF9sZW47CisKK3N0YXRpYyBpbnQgbl9saXN0ZW5lcnM9MDsKKwordm9pZCBmYXRhbChj
b25zdCBjaGFyICptc2csIGludCBlcnIpCit7CisgICAgc3lzbG9nKExPR19DUklULCAiJXMiLCBt
c2cpOworICAgIHN5c2xvZyhMT0dfTk9USUNFLCAiZXhpdGluZyIpOworCisgICAgY3lydXNfZG9u
ZSgpOworICAgIAorICAgIGV4aXQoZXJyKTsKK30KKworc3RhdGljIHZvaWQgbGRhcF9jbGVhbnVw
KCkKK3sKKyAgICBpZihsZGFwX3Nlc3Npb24pIHsKKwlsZGFwX3VuYmluZF9zKGxkYXBfc2Vzc2lv
bik7CisJbGRhcF9zZXNzaW9uPU5VTEw7CisgICAgfQorfQorCitzdGF0aWMgaW50IGxkYXBfaW5p
dF9pZl9uZWVkZWQoKQoreworICAgIGlmKCFsZGFwX3Nlc3Npb24pIHsKKwlpZighKGxkYXBfc2Vz
c2lvbiA9IGxkYXBfaW5pdChsZGFwX2hvc3QsIGxkYXBfcG9ydCkpIHx8CisJICAgbGRhcF9zZXRf
b3B0aW9uKGxkYXBfc2Vzc2lvbiwgTERBUF9PUFRfUkVTVEFSVCwgTERBUF9PUFRfT04pPT0tMSB8
fAorCSAgIGxkYXBfc2ltcGxlX2JpbmRfcyhsZGFwX3Nlc3Npb24sIGxkYXBfdXNlciwgbGRhcF9w
YXNzd29yZCkhPUxEQVBfU1VDQ0VTUykgeworCSAgICBsZGFwX2NsZWFudXAoKTsKKwkgICAgcmV0
dXJuIENPTlZFUlRVU0VSSURfTERBUEZBSUxFRDsKKwl9CisgICAgfQorICAgIHJldHVybiAwOwor
fQorCisvKiAnZG9tYWluJyBhbmQgJ2RvbWFpbmxlbicgdmFyaWFibGVzIGFyZSBpZ25vcmVkIG5v
dyAqLworc3RhdGljIGludCBnZXRfaWRfZnJvbV9sZGFwKGNvbnN0IGNoYXIgKmluLCBpbnQgaW5f
bGVuLCBjb25zdCBjaGFyICpkb21haW4sIGludCBkb21haW5sZW4sIGNoYXIgKm91dCwgaW50ICpv
dXRfbGVuLCBpbnQgaW50MmV4dCkKK3sKKyAgICBMREFQTWVzc2FnZSAqbGRhcF9yZXM7CisgICAg
Y2hhciAqaW5fbGRhcDsKKyAgICBpbnQgaW5fbGRhcF9sZW47CisgICAgY29uc3QgY2hhciAqbGRh
cF9maWx0ZXJfdGVtcGxhdGU7CisgICAgaW50IGxkYXBfZmlsdGVyX3RlbXBsYXRlX2xlbjsKKyAg
ICBjaGFyICpsZGFwX2ZpbHRlcjsKKyAgICBjaGFyICpsZGFwX2F0dHJzWzJdOworCisgICAgLyog
SW5wdXQgYnVmZmVyICdpbicgaXMgTVVURi03IHN0cmluZyBpbiBjYXNlIGlmCisgICAgICAgZXh0
ZXJuYWw9PmludGVybmFsLiBXZSBuZWVkIHRvIGNvbnZlcnQgaXQgdG8gVVRGLTggZW5jb2RpbmcK
KyAgICAgICBiZWZvcmUgcXVlcnlpbmcgdG8gTERBUC4gKi8KKyAgICBpZighaW50MmV4dCkgewor
CWNoYXIgKmluX3Rlc3Q7CisJaW50IGluX3Rlc3RfbGVuOworCisJaWYoIShpbl9sZGFwID0gbXV0
ZjdfdG9fdXRmOCgoY2hhciAqKWluLCBpbl9sZW4sICZpbl9sZGFwX2xlbikpKSB7CisJICAgIHN5
c2xvZyhMT0dfREVCVUcsICJtdXRmN190b191dGY4KCkgZmFpbGVkLlxuIik7CisJICAgIHJldHVy
biBDT05WRVJUVVNFUklEX1NZU0ZBSUxFRDsKKwl9CisKKwkvKiBDaGVjayBpZiAnaW4nIGlzIGEg
dmFsaWQgaW1hcC11dGYtNyBzdHJpbmcuIE5vdGUgdGhhdCB3ZQorCSAgIGFsc28gZGlzYWxsb3cg
aGVyZSB0byBoYXZlIG11bHRpcGxlIG11dGYtNyByZXByZXNlbnRhdGlvbnMKKwkgICBvZiBhIFVu
aWNvZGUgc3RyaW5nLiAqLworCWlmKCEoaW5fdGVzdCA9IHV0ZjhfdG9fbXV0ZjcoaW5fbGRhcCwg
aW5fbGRhcF9sZW4sICZpbl90ZXN0X2xlbikpKSB7CisJICAgIHN5c2xvZyhMT0dfREVCVUcsICJ1
dGY4X3RvX211dGY3KCkgZmFpbGVkIHdoaWxlIGNoZWNraW5nIHVzZXIgdW5wdXQuXG4iKTsKKwkg
ICAgZnJlZShpbl9sZGFwKTsKKwkgICAgcmV0dXJuIENPTlZFUlRVU0VSSURfU1lTRkFJTEVEOwor
CX0KKworCWlmKGluX3Rlc3RfbGVuIT1pbl9sZW4gfHwgbWVtY21wKGluLCBpbl90ZXN0LCBpbl9s
ZW4pKSB7CisJICAgIHN5c2xvZyhMT0dfREVCVUcsICJJbmNvcnJlY3QgTVVURi03IHN0cmluZyBy
ZWNlaXZlZC5cbiIpOworCSAgICBmcmVlKGluX2xkYXApOworCSAgICBmcmVlKGluX3Rlc3QpOwor
CSAgICByZXR1cm4gQ09OVkVSVFVTRVJJRF9TWVNGQUlMRUQ7CisJfQorCWZyZWUoaW5fdGVzdCk7
CisKKwlsZGFwX2ZpbHRlcl90ZW1wbGF0ZSA9IGxkYXBfZmlsdGVyX2V4dDsKKwlsZGFwX2ZpbHRl
cl90ZW1wbGF0ZV9sZW4gPSBsZGFwX2ZpbHRlcl9leHRfbGVuOworCWxkYXBfYXR0cnNbMF0gPSAo
Y2hhciAqKWxkYXBfYXR0cl9pbnQ7CisgICAgfQorICAgIGVsc2UgeworCWluX2xkYXAgPSAoY2hh
ciAqKWluOworCWluX2xkYXBfbGVuID0gaW5fbGVuOworCWxkYXBfZmlsdGVyX3RlbXBsYXRlID0g
bGRhcF9maWx0ZXJfaW50OworCWxkYXBfZmlsdGVyX3RlbXBsYXRlX2xlbiA9IGxkYXBfZmlsdGVy
X2ludF9sZW47CisJbGRhcF9hdHRyc1swXSA9IChjaGFyICopbGRhcF9hdHRyX2V4dDsKKyAgICB9
CisKKyAgICAvKiBpZiB0aGUgY29ubmVjdGlvbiB0byBMREFQIHNlcnZlciBpcyBub3QgZXN0YWJs
aXNoZWQgdGhlbiB0cnkgdG8KKyAgICAgICBlc3RhYmxpc2ggaXQgKi8KKyAgICBpZihsZGFwX2lu
aXRfaWZfbmVlZGVkKCkpIHsKKwlzeXNsb2coTE9HX0RFQlVHLCAiQ2Fubm90IGluaXRpYWxpemUg
TERBUCBjbGllbnQgbGlicmFyeSFcbiIpOworCXJldHVybiBDT05WRVJUVVNFUklEX0xEQVBGQUlM
RUQ7CisgICAgfQorCisgICAgLyogdGhlIGFsbG9jYXRlZCBidWZmZXIgaXMgYmlnZ2VyIHRoYW4g
bmVlZGVkOiB0ZW1wbGF0ZSBoYXZlCisgICAgICAgIiUuKnMiIHN0cmluZyB3aXRoaW4gaXQgd2hp
Y2ggaXMgcmVwbGFjZWQgdG8gaW5fbGRhcCBzdHJpbmcgKi8KKyAgICBsZGFwX2ZpbHRlciA9IChj
aGFyICopbWFsbG9jKGxkYXBfZmlsdGVyX3RlbXBsYXRlX2xlbitpbl9sZGFwX2xlbik7CisgICAg
aWYoIWxkYXBfZmlsdGVyKSB7CisJaWYoaW5fbGRhcCAhPSBpbikKKwkgICAgZnJlZShpbl9sZGFw
KTsKKwlyZXR1cm4gQ09OVkVSVFVTRVJJRF9TWVNGQUlMRUQ7CisgICAgfQorICAgIHNwcmludGYo
bGRhcF9maWx0ZXIsIGxkYXBfZmlsdGVyX3RlbXBsYXRlLCBpbl9sZGFwX2xlbiwgaW5fbGRhcCk7
CisKKyAgICBsZGFwX2F0dHJzWzFdPU5VTEw7CisKKyAgICBpZihsZGFwX3NlYXJjaF9zKGxkYXBf
c2Vzc2lvbiwgbGRhcF9iYXNlLCBMREFQX1NDT1BFX1NVQlRSRUUsIGxkYXBfZmlsdGVyLCBsZGFw
X2F0dHJzLCAwLCAmbGRhcF9yZXMpIT1MREFQX1NVQ0NFU1MpIHsKKwlzeXNsb2coTE9HX0RFQlVH
LCAibGRhcF9zZWFyY2hfcygpIGZhaWxlZCEgV2lsbCB0cnkgdG8gcmVjb25uZWN0LlxuIik7CisJ
bGRhcF9jbGVhbnVwKCk7CisKKwlpZihsZGFwX2luaXRfaWZfbmVlZGVkKCkpCisJICAgIHN5c2xv
ZyhMT0dfREVCVUcsICJSZWNvbm5lY3QgZmFpbGVkIVxuIik7CisJZWxzZSBpZihsZGFwX3NlYXJj
aF9zKGxkYXBfc2Vzc2lvbiwgbGRhcF9iYXNlLCBMREFQX1NDT1BFX1NVQlRSRUUsIGxkYXBfZmls
dGVyLCBsZGFwX2F0dHJzLCAwLCAmbGRhcF9yZXMpIT1MREFQX1NVQ0NFU1MpIHsKKwkgICAgc3lz
bG9nKExPR19ERUJVRywgImxkYXBfc2VhcmNoX3MoKSBmYWlsZWQgYWdhaW4hXG4iKTsKKwkgICAg
bGRhcF9jbGVhbnVwKCk7CisJfQorICAgIH0KKworICAgIGlmKGluX2xkYXAgIT0gaW4pCisJZnJl
ZShpbl9sZGFwKTsKKyAgICBmcmVlKGxkYXBfZmlsdGVyKTsKKworICAgIC8qIGlmIHF1ZXJ5IGZh
aWxlZCB0aGVuIHJldHVybiBlcnJvciAqLworICAgIGlmKCFsZGFwX3Nlc3Npb24pCisJcmV0dXJu
IENPTlZFUlRVU0VSSURfTERBUEZBSUxFRDsKKyAgICBlbHNlIHsKKwljaGFyICoqdmFscz1OVUxM
OworCWNoYXIgKm5vbmVuY29kZWRfb3V0OworCWludCBub25lbmNvZGVkX2xlbjsKKwlpbnQgY291
bnRfZW50cmllczsKKworCWFzc2VydChsZGFwX3Jlcyk7CisJLyogdGhlIGV4dGVybmFsIG5hbWUg
aGFzbid0IGJlZW4gZm91bmQgb3IgdGhlcmUgYXJlIG1vcmUgdGhhbgorCSAgIG9uZSByZXN1bHQg
cmVjb3JkcyAqLworCWlmKChjb3VudF9lbnRyaWVzPWxkYXBfY291bnRfZW50cmllcyhsZGFwX3Nl
c3Npb24sIGxkYXBfcmVzKSkhPTEpIHsKKwkgICAgaWYoY291bnRfZW50cmllcykKKwkJc3lzbG9n
KExPR19ERUJVRywgImxkYXBfY291bnRfZW50cmllcygpIHJldHVybmVkICVpLlxuIiwgY291bnRf
ZW50cmllcyk7CisJICAgIGxkYXBfbXNnZnJlZShsZGFwX3Jlcyk7CisKKwkgICAgcmV0dXJuIENP
TlZFUlRVU0VSSURfTk9ORVhJU1RFTlRfSUQ7CisJfQorCWVsc2UgeworCSAgICBMREFQTWVzc2Fn
ZSAqZW50cnk7CisJICAgIGNoYXIgKmF0dHI7CisKKwkgICAgZW50cnkgPSBsZGFwX2ZpcnN0X2Vu
dHJ5KGxkYXBfc2Vzc2lvbiwgbGRhcF9yZXMpOworCSAgICBhc3NlcnQoZW50cnkpOworCisJICAg
IHZhbHMgPSBsZGFwX2dldF92YWx1ZXMobGRhcF9zZXNzaW9uLCBlbnRyeSwgbGRhcF9hdHRyc1sw
XSk7CisJICAgIGFzc2VydCh2YWxzICYmIGxkYXBfY291bnRfdmFsdWVzKHZhbHMpKTsKKworCSAg
ICAvKiBzYXZlICd2YWxzWzBdJyBhcyBhbiBleHRlcm5hbCBuYW1lIGFuZCAnaW4nIGFzIGFuIGlu
dGVybmFsCisJICAgICAgIG9uZSAqLworCSAgICBub25lbmNvZGVkX291dCA9IHZhbHNbMF07CisJ
ICAgIG5vbmVuY29kZWRfbGVuID0gc3RybGVuKG5vbmVuY29kZWRfb3V0KTsKKwl9CisKKwkvKiAn
bm9uZW5jb2RlZF9vdXQnIGJ1ZmZlciBpcyBhbiBVVEYtOCBidWZmZXIuIFdlIG5lZWQgdG8KKwkg
ICBjb252ZXJ0IGl0IHRvIE1VVEYtNyBlbmNvZGluZyBpbiBjYXNlIGlmIGl0IGlzIGFuIGV4dGVy
bmFsCisJICAgdXNlcmlkLiAqLworCWlmKGludDJleHQpIHsKKwkgICAgY2hhciAqdGVtcF9vdXQg
PSB1dGY4X3RvX211dGY3KG5vbmVuY29kZWRfb3V0LCBub25lbmNvZGVkX2xlbiwgb3V0X2xlbik7
CisJICAgIGlmKCF0ZW1wX291dCkgeworCQlzeXNsb2coTE9HX0RFQlVHLCAidXRmOF90b19tdXRm
NygpIGZhaWxlZC5cbiIpOworCQlyZXR1cm4gQ09OVkVSVFVTRVJJRF9TWVNGQUlMRUQ7CisJICAg
IH0KKwkgICAgaWYoKm91dF9sZW4gPiBNQVhfTUFJTEJPWF9OQU1FKSB7CisJCSpvdXRfbGVuID0g
MDsKKwkJZnJlZSh0ZW1wX291dCk7CisJCXJldHVybiBDT05WRVJUVVNFUklEX1NZU0ZBSUxFRDsK
KwkgICAgfQorCSAgICBtZW1jcHkob3V0LCB0ZW1wX291dCwgKm91dF9sZW4pOworCSAgICBmcmVl
KHRlbXBfb3V0KTsKKwl9CisJZWxzZSB7CisJICAgIG1lbWNweShvdXQsIG5vbmVuY29kZWRfb3V0
LCBub25lbmNvZGVkX2xlbik7CisJICAgICpvdXRfbGVuID0gbm9uZW5jb2RlZF9sZW47CisJfQor
CisJaWYodmFscykKKwkgICAgbGRhcF92YWx1ZV9mcmVlKHZhbHMpOworCWlmKGxkYXBfcmVzKQor
CSAgICBsZGFwX21zZ2ZyZWUobGRhcF9yZXMpOworICAgIH0KKworICAgIHJldHVybiAwOworfQor
CisvKiByZWFkIGNvbnZlcnR1c2VyaWQgTERBUCBjb25maWd1cmF0aW9uIG9wdGlvbnMgZnJvbSBj
b25maWd1cmF0aW9uCisgICBmaWxlcyAqLworc3RhdGljIGludCByZWFkX2xkYXBfb3B0aW9ucygp
Cit7CisgICAgaW50IGxkYXBfYXR0cl9pbnRfbGVuOworICAgIGludCBsZGFwX2F0dHJfZXh0X2xl
bjsKKworICAgIGxkYXBfaG9zdCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9DT05WRVJUVVNF
UklEX0xEQVBfSE9TVCk7CisgICAgbGRhcGRfbG9jYWxob3N0ID0gY29uZmlnX2dldHN0cmluZyhJ
TUFQT1BUX0NPTlZFUlRVU0VSSURfTE9DQUxIT1NUKTsKKworICAgIGxkYXBfcG9ydCA9IGNvbmZp
Z19nZXRpbnQoSU1BUE9QVF9DT05WRVJUVVNFUklEX0xEQVBfUE9SVCk7CisgICAgaWYoIWxkYXBf
cG9ydCkKKwlsZGFwX3BvcnQ9TERBUF9QT1JUOworCisgICAgbGRhcF91c2VyID0gY29uZmlnX2dl
dHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9VU0VSKTsKKyAgICBsZGFwX3Bhc3N3
b3JkID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9QQVNTV09S
RCk7CisKKyAgICBsZGFwX2Jhc2UgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQ09OVkVSVFVT
RVJJRF9MREFQX0JBU0UpOworCisgICAgbGRhcF9hdHRyX2ludCA9IGNvbmZpZ19nZXRzdHJpbmco
SU1BUE9QVF9DT05WRVJUVVNFUklEX0xEQVBfQVRUUl9JTlQpOworICAgIGlmKCFsZGFwX2F0dHJf
aW50KSB7CisJc3lzbG9nKExPR19FUlIsICJjb252ZXJ0dXNlcmlkX2xkYXBfYXR0cl9pbnQgb3B0
aW9uIGlzIG5vdCBzZXRcbiIpOworCXJldHVybiAxOworICAgIH0KKyAgICBsZGFwX2F0dHJfZXh0
ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9BVFRSX0VYVCk7
CisgICAgaWYoIWxkYXBfYXR0cl9leHQpIHsKKwlzeXNsb2coTE9HX0VSUiwgImNvbnZlcnR1c2Vy
aWRfbGRhcF9hdHRyX2V4dCBvcHRpb24gaXMgbm90IHNldFxuIik7CisJcmV0dXJuIDE7CisgICAg
fQorICAgIGxkYXBfYXR0cl9pbnRfbGVuID0gc3RybGVuKGxkYXBfYXR0cl9pbnQpOworICAgIGxk
YXBfZmlsdGVyX2ludF9sZW4gPSBsZGFwX2F0dHJfaW50X2xlbiArIExEQVBfRklMVEVSX1RFTVBM
QVRFU0laRTsKKyAgICBsZGFwX2ZpbHRlcl9pbnQgPSAoY2hhciAqKW1hbGxvYyhsZGFwX2ZpbHRl
cl9pbnRfbGVuKTsKKyAgICBpZighbGRhcF9maWx0ZXJfaW50KSB7CisJc3lzbG9nKExPR19FUlIs
ICJtZW1vcnkgYWxsb2NhdGlvbiB3YXMgZmFpbGVkXG4iKTsKKwlyZXR1cm4gMTsKKyAgICB9Cisg
ICAgbGRhcF9hdHRyX2V4dF9sZW4gPSBzdHJsZW4obGRhcF9hdHRyX2V4dCk7CisgICAgbGRhcF9m
aWx0ZXJfZXh0X2xlbiA9IGxkYXBfYXR0cl9leHRfbGVuICsgTERBUF9GSUxURVJfVEVNUExBVEVT
SVpFOworICAgIGxkYXBfZmlsdGVyX2V4dCA9IChjaGFyICopbWFsbG9jKGxkYXBfZmlsdGVyX2V4
dF9sZW4pOworICAgIGlmKCFsZGFwX2ZpbHRlcl9leHQpIHsKKwlzeXNsb2coTE9HX0VSUiwgIm1l
bW9yeSBhbGxvY2F0aW9uIHdhcyBmYWlsZWRcbiIpOworCWZyZWUobGRhcF9maWx0ZXJfaW50KTsK
KwlyZXR1cm4gMTsKKyAgICB9CisgICAgc3ByaW50ZihsZGFwX2ZpbHRlcl9pbnQsIiglcz0lJS4q
cykiLGxkYXBfYXR0cl9pbnQpOworICAgIHNwcmludGYobGRhcF9maWx0ZXJfZXh0LCIoJXM9JSUu
KnMpIixsZGFwX2F0dHJfZXh0KTsKKworICAgIHJldHVybiAwOworfQorCitpbnQgbWFpbihpbnQg
YXJnYywgY2hhciAqKmFyZ3YpCit7CisgICAgaW50IG9wdDsKKyAgICBpbnQgcywgbGVuOworICAg
IHN0cnVjdCBzb2NrYWRkcl9pbiBsb2NhbDsKKyAgICBsZGFwX2RhdGFfdCBsZGFwZGF0YTsKKyAg
ICBsZGFwX2RhdGFfcmVzdWx0X3QgbGRhcGRhdGFfcmVzdWx0OworICAgIHN0cnVjdCBzb2NrYWRk
cl9pbiBmcm9tOworICAgIHNvY2tsZW5fdCBmcm9tbGVuOworICAgIHBpZF90IHBpZDsKKyAgICBp
bnQgZmQ7CisgICAgY2hhciAqYWx0X2NvbmZpZyA9IE5VTEw7CisgICAgaW50IGN1cmNoaWxkOwor
ICAgIGludCBwb3J0X251bTsKKyAgICBzdHJ1Y3Qgb3B0aW9uIGxvbmdvcHRzW109eworCXsicHJl
Zm9yayIsIDEsIE5VTEwsICduJ30sCisJe05VTEwsIDAsIE5VTEwsIDB9LAorICAgIH07CisKKyAg
ICB3aGlsZSAoKG9wdCA9IGdldG9wdF9sb25nKGFyZ2MsIGFyZ3YsICJDOm46IiwgbG9uZ29wdHMs
IE5VTEwpKSAhPSBFT0YpIHsKKwlzd2l0Y2ggKG9wdCkgeworICAgICAgICBjYXNlICdDJzogLyog
YWx0IGNvbmZpZyBmaWxlICovCisgICAgICAgICAgICBhbHRfY29uZmlnID0gb3B0YXJnOworICAg
ICAgICAgICAgYnJlYWs7CisJY2FzZSAnbic6CisJICAgIG5fbGlzdGVuZXJzID0gYXRvaShvcHRh
cmcpOworCSAgICBpZihuX2xpc3RlbmVyczw9MCkgeworCQlmcHJpbnRmKHN0ZGVyciwgImludmFs
aWQgbnVtYmVyIG9mIGxpc3RlbmVyIHByb2Nlc3Nlc1xuIik7CisJCWV4aXQoRUNfVVNBR0UpOwor
CSAgICB9CisJICAgIGJyZWFrOworCWRlZmF1bHQ6CisJICAgIGZwcmludGYoc3RkZXJyLCAiaW52
YWxpZCBhcmd1bWVudFxuIik7CisJICAgIGV4aXQoRUNfVVNBR0UpOworCSAgICBicmVhazsKKwl9
CisgICAgfQorCisgICAgLyogc2V0IGRlZmF1bHQgbnVtYmVyIG9mIGxpc3RlbmVycyBpZiBuZWVk
ZWQgKi8KKyAgICBpZighbl9saXN0ZW5lcnMpCisJbl9saXN0ZW5lcnM9MTsKKworICAgIGN5cnVz
X2luaXQoYWx0X2NvbmZpZywgImxkYXBkIiwgMCk7CisKKyAgICBwb3J0X251bSA9IGNvbmZpZ19n
ZXRpbnQoSU1BUE9QVF9DT05WRVJUVVNFUklEX1VEUFBPUlQpOworCisgICAgaWYocmVhZF9sZGFw
X29wdGlvbnMoKSkKKwlleGl0KDEpOworCisgICAgLyogY3JlYXRlIHNvY2tldCB3ZSBhcmUgZ29p
bmcgdG8gdXNlIGZvciBsaXN0ZW5pbmcgKi8KKyAgICBpZiAoKHMgPSBzb2NrZXQoQUZfSU5FVCwg
U09DS19ER1JBTSwgMCkpID09IC0xKSB7CisJcGVycm9yKCJzb2NrZXQiKTsKKwljeXJ1c19kb25l
KCk7CisJZXhpdCgxKTsKKyAgICB9CisKKyAgICBsb2NhbC5zaW5fZmFtaWx5ID0gQUZfSU5FVDsK
KyAgICBpbmV0X3B0b24oQUZfSU5FVCwgbGRhcGRfbG9jYWxob3N0LCAmbG9jYWwuc2luX2FkZHIp
OworICAgIGxvY2FsLnNpbl9wb3J0ID0gaHRvbnMocG9ydF9udW0pOworICAgIGxlbj1zaXplb2Yo
bG9jYWwpOworCisgICAgaWYgKGJpbmQocywgKHN0cnVjdCBzb2NrYWRkciAqKSZsb2NhbCwgbGVu
KSA9PSAtMSkgeworCXBlcnJvcigiYmluZCIpOworCWN5cnVzX2RvbmUoKTsKKwlleGl0KDEpOwor
ICAgIH0KKworICAgIGZvcihjdXJjaGlsZD0wOyBjdXJjaGlsZDxuX2xpc3RlbmVyczsgY3VyY2hp
bGQrKykgeworCXBpZCA9IGZvcmsoKTsKKwlpZiAocGlkID09IC0xKSB7CisJICAgIHBlcnJvcigi
Zm9yayIpOworCSAgICBjeXJ1c19kb25lKCk7CisJICAgIGV4aXQoMSk7CisJfQorCQorCWlmIChw
aWQgIT0gMCkgeyAvKiBwYXJlbnQgKi8KKwkgICAgY29udGludWU7CisJfQorCS8qIGNoaWxkICov
CisJYnJlYWs7CisgICAgfQorCisgICAgaWYgKHBpZCAhPSAwKSB7IC8qIHBhcmVudCAqLworCWN5
cnVzX2RvbmUoKTsKKwlleGl0KDApOworICAgIH0KKwkKKyAgICAvKiBjaGlsZCAqLworCisgICAg
Zm9yICg7OykgeworCWludCBuOworCisJZnJvbWxlbiA9IHNpemVvZihmcm9tKTsKKwluID0gcmVj
dmZyb20ocywgKHZvaWQqKSAmbGRhcGRhdGEsIHNpemVvZihsZGFwX2RhdGFfdCksIDAsCisJCSAg
ICAgKHN0cnVjdCBzb2NrYWRkciAqKSAmZnJvbSwgJmZyb21sZW4pOworCisJaWYgKG4gPiAwKSB7
CisJICAgIGlmIChuIDw9IExEQVBEQVRBX0JBU0VfU0laRSB8fAorCQlsZGFwZGF0YS51c2VybGVu
IDwgbi1MREFQREFUQV9CQVNFX1NJWkUpCisJCXN5c2xvZyhMT0dfRVJSLCAiSW52YWxpZCBtZXNz
YWdlIHJlY2VpdmVkLCBzaXplPSVkXG4iLCBuKTsKKwkgICAgZWxzZSB7CisJCWludCByZXN1bHRs
ZW49MDsKKworCQlsZGFwZGF0YV9yZXN1bHQuY29kZT1nZXRfaWRfZnJvbV9sZGFwKAorCQkgICAg
bGRhcGRhdGEuYnVmLCBsZGFwZGF0YS51c2VybGVuLAorCQkgICAgbGRhcGRhdGEuYnVmK2xkYXBk
YXRhLnVzZXJsZW4sIG4tTERBUERBVEFfQkFTRV9TSVpFLWxkYXBkYXRhLnVzZXJsZW4sCisJCSAg
ICBsZGFwZGF0YV9yZXN1bHQuYnVmLCAmcmVzdWx0bGVuLAorCQkgICAgbGRhcGRhdGEuaW50MmV4
dCk7CisJCWlmKHNlbmR0byhzLCAodm9pZCAqKSZsZGFwZGF0YV9yZXN1bHQsIHJlc3VsdGxlbitM
REFQREFUQV9SRVNVTFRfQkFTRV9TSVpFLDAsKHN0cnVjdCBzb2NrYWRkciAqKSZmcm9tLGZyb21s
ZW4pPT0tMSkKKwkJICAgIHN5c2xvZyhMT0dfRVJSLCAiQ2Fubm90IHNlbmQgYW4gYW5zd2VyOiAl
c1xuIiwgc3RyZXJyb3IoZXJybm8pKTsKKwkgICAgfQorCX0KKyAgICB9CisKKyAgICBjeXJ1c19k
b25lKCk7CisKKyAgICAvKiBuZXZlciBnZXRzIGhlcmUgKi8gICAgICAKKyAgICBleGl0KDEpOwor
fQorCit2b2lkIHByaW50c3RyaW5nKGNvbnN0IGNoYXIgKnMgX19hdHRyaWJ1dGVfXygodW51c2Vk
KSkpCit7IAorICAgIC8qIG5lZWRlZCB0byBsaW5rIGFnYWluc3QgYW5ub3RhdGUubyAqLworICAg
IGZhdGFsKCJwcmludHN0cmluZygpIGV4ZWN1dGVkISEhIiwKKyAgICAgICAgICBFQ19TT0ZUV0FS
RSk7Cit9CmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvbGRhcGQuaCBjeXJ1
cy1pbWFwZC0yLjIuMTIvaW1hcC9sZGFwZC5oCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2lt
YXAvbGRhcGQuaAkxOTcwLTAxLTAxIDAzOjAwOjAwICswMzAwCisrKyBjeXJ1cy1pbWFwZC0yLjIu
MTIvaW1hcC9sZGFwZC5oCTIwMDUtMTItMDggMTk6Mzg6NTIgKzAzMDAKQEAgLTAsMCArMSwyOCBA
QAorI2lmbmRlZiBfTERBUERfSAorI2RlZmluZSBfTERBUERfSAorCisjaW5jbHVkZSAibWFpbGJv
eC5oIgorCisjZGVmaW5lIENPTlZFUlRVU0VSSURfTERBUEZBSUxFRCAgICAgMQorI2RlZmluZSBD
T05WRVJUVVNFUklEX1NZU0ZBSUxFRCAgICAgIDIKKyNkZWZpbmUgQ09OVkVSVFVTRVJJRF9OT05F
WElTVEVOVF9JRCAzCisKK3R5cGVkZWYgc3RydWN0IGxkYXBfZGF0YV9zIHsKKyAgICB1bnNpZ25l
ZCBsb25nIGludDJleHQ7CisgICAgdW5zaWduZWQgbG9uZyB1c2VybGVuOyAvKiBsZW5ndGggb2Yg
dGhlIHVzZXJuYW1lIGJ1ZmZlciAqLworCisgICAgLyogbm9uLW51bGwtdGVybWluYXRlZCBidWZm
ZXIgZm9yIHVzZXJuYW1lIGFuZCBkb21haW4gKi8KKyAgICBjaGFyIGJ1ZltNQVhfTUFJTEJPWF9O
QU1FKjJdOworfSBsZGFwX2RhdGFfdDsKKwordHlwZWRlZiBzdHJ1Y3QgbGRhcF9kYXRhX3Jlc3Vs
dF9zIHsKKyAgICB1bnNpZ25lZCBsb25nIGNvZGU7CisKKyAgICAvKiBub24tbnVsbC10ZXJtaW5h
dGVkIGJ1ZmZlciBmb3IgY29udmVydGVkIHVzZXJuYW1lICovCisgICAgY2hhciBidWZbTUFYX01B
SUxCT1hfTkFNRV07Cit9IGxkYXBfZGF0YV9yZXN1bHRfdDsKKworI2RlZmluZSBMREFQREFUQV9C
QVNFX1NJWkUJKDIgKiBzaXplb2YodW5zaWduZWQgbG9uZykpCisjZGVmaW5lIExEQVBEQVRBX1JF
U1VMVF9CQVNFX1NJWkUJKHNpemVvZih1bnNpZ25lZCBsb25nKSkKKworI2VuZGlmIC8qIF9MREFQ
RF9IICovCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvTWFrZWZpbGUuaW4g
Y3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvTWFrZWZpbGUuaW4KLS0tIGN5cnVzLWltYXBkLTIuMi4x
Mi5vbGQvaW1hcC9NYWtlZmlsZS5pbgkyMDA1LTEyLTA4IDE2OjU4OjM4ICswMzAwCisrKyBjeXJ1
cy1pbWFwZC0yLjIuMTIvaW1hcC9NYWtlZmlsZS5pbgkyMDA1LTEyLTA4IDE5OjM4OjUyICswMzAw
CkBAIC02OSw3ICs2OSw3IEBACiBTSUVWRV9MSUJTID0gQFNJRVZFX0xJQlNACiBJTUFQX0NPTV9F
UlJfTElCUyA9IEBJTUFQX0NPTV9FUlJfTElCU0AKIExJQl9XUkFQID0gQExJQl9XUkFQQAotTElC
UyA9ICQoSU1BUF9MSUJTKSAkKElNQVBfQ09NX0VSUl9MSUJTKQorTElCUyA9ICQoSU1BUF9MSUJT
KSAkKElNQVBfQ09NX0VSUl9MSUJTKSAtbHJlZGJsYWNrIC1sbGRhcAogREVQTElCUyA9IC4uL2xp
Yi9saWJjeXJ1cy5hIC4uL2xpYi9saWJjeXJ1c19taW4uYSBAREVQTElCU0AKIAogQ0ZMQUdTID0g
QENGTEFHU0AKQEAgLTEwNCw3ICsxMDQsNyBAQAogCWNvbnZlcnRfY29kZS5vIGR1cGxpY2F0ZS5v
IHNhc2xjbGllbnQubyBzYXNsc2VydmVyLm8gc2lnbmFscy5vIFwKIAlhbm5vdGF0ZS5vIHNlYXJj
aF9lbmdpbmVzLm8gc3F1YXQubyBzcXVhdF9pbnRlcm5hbC5vIG1iZHVtcC5vIFwKIAlpbWFwcGFy
c2UubyB0ZWxlbWV0cnkubyB1c2VyLm8gbm90aWZ5Lm8gcHJvdG9jb2wubyBxdW90YV9kYi5vIFwK
LQlhdXRvc2lldmUubyAkKFNFRU4pICQoSURMRSkKKwlhdXRvc2lldmUubyBjaGFyc2V0X2NvbnZl
cnQubyAkKFNFRU4pICQoSURMRSkKIAogSU1BUERPQkpTPXB1c2hzdGF0cy5vIGJhY2tlbmQubyBp
bWFwZC5vIGluZGV4Lm8gdGxzLm8gdmVyc2lvbi5vCiAKQEAgLTE5MCw2ICsxOTAsMTAgQEAKIAkk
KENDKSAkKExERkxBR1MpIC1vIGlkbGVkIFwKIAkgaWRsZWQubyBtdXRleF9mYWtlLm8gbGliaW1h
cC5hICQoU0lFVkVfTElCUykgJChERVBMSUJTKSAkKExJQlMpCiAKK2xkYXBkOiBsZGFwZC5vIG11
dGV4X2Zha2UubyBsaWJpbWFwLmEgJChERVBMSUJTKQorCSQoQ0MpICQoTERGTEFHUykgLW8gbGRh
cGQgXAorCSBsZGFwZC5vIG11dGV4X2Zha2UubyBsaWJpbWFwLmEgJChTSUVWRV9MSUJTKSAkKERF
UExJQlMpICQoTElCUykKKwogbG10cGQ6IGxtdHBkLm8gJChMTVRQT0JKUykgJChTSUVWRV9PQkpT
KSBtdXRleF9mYWtlLm8gbGliaW1hcC5hICQoU0lFVkVfTElCUykgXAogCSQoREVQTElCUykgJChT
RVJWSUNFKQogCSQoQ0MpICQoTERGTEFHUykgLW8gbG10cGQgXApkaWZmIC11ck4gY3lydXMtaW1h
cGQtMi4yLjEyLm9sZC9pbWFwL21ib3hsaXN0LmMgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJv
eGxpc3QuYwotLS0gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL21ib3hsaXN0LmMJMjAwNS0x
Mi0wOCAxNjo1OTowNSArMDMwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJveGxpc3Qu
YwkyMDA1LTEyLTA4IDE5OjM4OjUyICswMzAwCkBAIC0xNzU5LDM2ICsxNzU5LDYgQEAKICAgICAv
KiBkb24ndCBsaXN0IG1haWxib3hlcyBvdXRzaWRlIG9mIHRoZSBkZWZhdWx0IGRvbWFpbiAqLwog
ICAgIGlmICghcm9jay0+ZG9tYWlubGVuICYmICFyb2NrLT5pc2FkbWluICYmIHN0cmNocihrZXks
ICchJykpIHJldHVybiAwOyAKIAotICAgIG1pbm1hdGNoID0gMDsKLQotICAgIG1lbWNweShuYW1l
YnVmLCBrZXksIGtleWxlbik7Ci0gICAgbmFtZWJ1ZltrZXlsZW5dID0gJ1wwJzsKLQotICAgIC8q
IHJpZ2h0IHdvcmsgd2l0aCBhbiBhbHRlcm5hdGUgKG5vdCB0aGUgYnVpbGQtaW4pCi0gICAgICAg
bmFtZXNwYWNlIC0tIHNvcmNlcmVyICovCi0gICAgaWYoa2V5bGVuID49IHNpemVvZihuYW1lYnVm
KSkgewotCXN5c2xvZyhMT0dfRVJSLCAib3ZlcnNpemUga2V5bGVuIGluIG1ib3hsaXN0LmM6Zmlu
ZF9wKCkiKTsKLQlyZXR1cm4gMDsKLSAgICB9Ci0gICAgaWYocm9jay0+aW5ib3hvZmZzZXQpIHsK
LQluYW1lYnVmW3JvY2stPmluYm94b2Zmc2V0XSA9IHJvY2stPmluYm94Y2FzZVswXTsKLQluYW1l
YnVmW3JvY2stPmluYm94b2Zmc2V0KzFdID0gcm9jay0+aW5ib3hjYXNlWzFdOwotCW5hbWVidWZb
cm9jay0+aW5ib3hvZmZzZXQrMl0gPSByb2NrLT5pbmJveGNhc2VbMl07Ci0JbmFtZWJ1Zltyb2Nr
LT5pbmJveG9mZnNldCszXSA9IHJvY2stPmluYm94Y2FzZVszXTsKLQluYW1lYnVmW3JvY2stPmlu
Ym94b2Zmc2V0KzRdID0gcm9jay0+aW5ib3hjYXNlWzRdOwotICAgIH0KLQotICAgIC8qIGlmIGNh
bnQgZ2V0IHRoZSBleHRlcm5hbCBuYW1lIHRoZW4gc2tpcCB0aGUgY3VycmVudAotICAgICAgIGtl
eSAtLSBzb3JjZXJlciAqLwotICAgIGlmKChyb2NrLT5uYW1lc3BhY2UtPm1ib3huYW1lX3RvZXh0
ZXJuYWwpKHJvY2stPm5hbWVzcGFjZSwgbmFtZWJ1Zityb2NrLT5pbmJveG9mZnNldCwgYXV0aF9j
YW5vbnVzZXIocm9jay0+YXV0aF9zdGF0ZSksIG5hbWVidWZfb3V0KSkKLQlyZXR1cm4gMDsKLQot
ICAgIG1hdGNobGVuID0gZ2xvYl90ZXN0KGcsIG5hbWVidWZfb3V0LAotCQkJIHN0cmxlbihuYW1l
YnVmX291dCksICZtaW5tYXRjaCk7Ci0KLSAgICAvKiBJZiBpdHMgbm90IGEgbWF0Y2gsIHNraXAg
aXQgLS0gcGFydGlhbCBtYXRjaGVzIGFyZSBvay4gKi8KLSAgICBpZihtYXRjaGxlbiA9PSAtMSkg
cmV0dXJuIDA7Ci0KICAgICBpZiAocm9jay0+ZmluZF9uYW1lc3BhY2UgIT0gTkFNRVNQQUNFX0lO
Qk9YICYmCiAJcm9jay0+dXNlcm1ib3huYW1lICYmCiAJa2V5bGVuID49IHJvY2stPnVzZXJtYm94
bmFtZWxlbiAmJgpAQCAtMTg0Miw2ICsxODEyLDM1IEBACiAJfQogICAgIH0KICAgICAKKyAgICBt
aW5tYXRjaCA9IDA7CisKKyAgICBtZW1jcHkobmFtZWJ1Ziwga2V5LCBrZXlsZW4pOworICAgIG5h
bWVidWZba2V5bGVuXSA9ICdcMCc7CisKKyAgICAvKiByaWdodCB3b3JrIHdpdGggYW4gYWx0ZXJu
YXRlIG5hbWVzcGFjZSAtLSBzb3JjZXJlciAqLworICAgIGlmKGtleWxlbiA+PSBzaXplb2YobmFt
ZWJ1ZikpIHsKKwlzeXNsb2coTE9HX0VSUiwgIm92ZXJzaXplIGtleWxlbiBpbiBtYm94bGlzdC5j
OmZpbmRfcCgpIik7CisJcmV0dXJuIDA7CisgICAgfQorICAgIGlmKHJvY2stPmluYm94b2Zmc2V0
KSB7CisJbmFtZWJ1Zltyb2NrLT5pbmJveG9mZnNldF0gPSByb2NrLT5pbmJveGNhc2VbMF07CisJ
bmFtZWJ1Zltyb2NrLT5pbmJveG9mZnNldCsxXSA9IHJvY2stPmluYm94Y2FzZVsxXTsKKwluYW1l
YnVmW3JvY2stPmluYm94b2Zmc2V0KzJdID0gcm9jay0+aW5ib3hjYXNlWzJdOworCW5hbWVidWZb
cm9jay0+aW5ib3hvZmZzZXQrM10gPSByb2NrLT5pbmJveGNhc2VbM107CisJbmFtZWJ1Zltyb2Nr
LT5pbmJveG9mZnNldCs0XSA9IHJvY2stPmluYm94Y2FzZVs0XTsKKyAgICB9CisKKyAgICAvKiBp
ZiBjYW50IGdldCB0aGUgZXh0ZXJuYWwgbmFtZSB0aGVuIHNraXAgdGhlIGN1cnJlbnQKKyAgICAg
ICBrZXkgLS0gc29yY2VyZXIgKi8KKyAgICBpZigocm9jay0+bmFtZXNwYWNlLT5tYm94bmFtZV90
b2V4dGVybmFsKShyb2NrLT5uYW1lc3BhY2UsIG5hbWVidWYrcm9jay0+aW5ib3hvZmZzZXQsIGF1
dGhfY2Fub251c2VyKHJvY2stPmF1dGhfc3RhdGUpLCBuYW1lYnVmX291dCkpCisJcmV0dXJuIDA7
CisKKyAgICBtYXRjaGxlbiA9IGdsb2JfdGVzdChnLCBuYW1lYnVmX291dCwKKwkJCSBzdHJsZW4o
bmFtZWJ1Zl9vdXQpLCAmbWlubWF0Y2gpOworCisgICAgLyogSWYgaXRzIG5vdCBhIG1hdGNoLCBz
a2lwIGl0IC0tIHBhcnRpYWwgbWF0Y2hlcyBhcmUgb2suICovCisgICAgaWYobWF0Y2hsZW4gPT0g
LTEpIHJldHVybiAwOworCiAgICAgLyogaWYgd2UgZ2V0IGhlcmUsIGNsb3NlIGVub3VnaCBmb3Ig
dXMgdG8gc3BlbmQgdGhlIHRpbWUKICAgICAgICBhY3RpbmcgaW50ZXJlc3RlZCAqLwogICAgIHJl
dHVybiAxOwpAQCAtMTg4MCwxMSArMTg3OSwxMSBAQAogCX0KIAogICAgICAgCS8qIG1ha2Ugc3Vy
ZSBpdCdzIGluIHRoZSBtYWlsYm94ZXMgZGIgKi8KLQlpZiAocm9jay0+Y2hlY2ttYm94bGlzdCkg
ewotCSAgICByID0gbWJveGxpc3RfbG9va3VwKG5hbWVidWYsIE5VTEwsIE5VTEwsIE5VTEwpOwot
CX0gZWxzZSB7Ci0JICAgIHIgPSAwOwkJLyogZG9uJ3QgYm90aGVyIGNoZWNraW5nICovCi0JfQor
IAlpZiAocm9jay0+Y2hlY2ttYm94bGlzdCkgeworIAkgICAgciA9IG1ib3hsaXN0X2xvb2t1cChu
YW1lYnVmLCBOVUxMLCBOVUxMLCBOVUxMKTsKKyAJfSBlbHNlIHsKKwkgICAgciA9IDA7CisgCX0K
IAogCS8qIHJpZ2h0IHdvcmsgd2l0aCBhbiBhbHRlcm5hdGUgKG5vdCB0aGUgYnVpbGQtaW4pCiAJ
ICAgbmFtZXNwYWNlIC8vIHNvcmNlcmVyICovCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIu
b2xkL2ltYXAvbWJveG5hbWUuYyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9tYm94bmFtZS5jCi0t
LSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvbWJveG5hbWUuYwkyMDA1LTEyLTA4IDE2OjU5
OjA1ICswMzAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9tYm94bmFtZS5jCTIwMDUtMTIt
MDggMTk6Mzg6NTMgKzAzMDAKQEAgLTU3LDYgKzU3LDE2IEBACiAKICNpbmNsdWRlICJtYm94bmFt
ZS5oIgogI2luY2x1ZGUgIm1ib3hsaXN0LmgiCisjaW5jbHVkZSAiaW1hcGQuaCIKKworI2lmZGVm
IEVOQUJMRV9DT05WRVJUX1VTRVJJRAorI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4KKyNpbmNsdWRl
IDxuZXRpbmV0L2luLmg+CisjaW5jbHVkZSA8YXJwYS9pbmV0Lmg+CisjaW5jbHVkZSA8cmVkYmxh
Y2suaD4KKyNpbmNsdWRlIDxzeXNsb2cuaD4KKyNpbmNsdWRlICJsZGFwZC5oIgorI2VuZGlmIC8q
IEVOQUJMRV9DT05WRVJUX1VTRVJJRCAqLwogCiAvKiBNYWlsYm94IHBhdHRlcm5zIHdoaWNoIHRo
ZSBkZXNpZ24gb2YgdGhlIHNlcnZlciBwcm9oaWJpdHMgKi8KIHN0YXRpYyBjaGFyICpiYWRtYm94
cGF0dGVybnNbXSA9IHsKQEAgLTk1LDYgKzEwNSwzNjUgQEAKIH07CiAjZGVmaW5lIENIQVJNT0Q2
NChjKSAgKGluZGV4X21vZDY0Wyh1bnNpZ25lZCBjaGFyKShjKV0pCiAKKyNpZmRlZiBFTkFCTEVf
Q09OVkVSVF9VU0VSSUQKK2ludCBpbWFwZF9jb252ZXJ0dXNlcmlkPTA7CitpbnQgaW1hcGRfbm9u
Y29udmVydGVkdXNlcmlkX2FsbG93ZWQ9MDsKK2ludCBpbWFwZF9kb250aWdub3JlX2NvbnZlcnR1
c2VyaWRfZXJyb3JzPTA7CisKK3R5cGVkZWYgc3RydWN0IF9yYnRfZGF0YV90IHsKKyAgICBjaGFy
ICpkb21haW47CisgICAgY2hhciAqaWRfaW47CisgICAgaW50IGlkX2luX2xlbjsKKyAgICBjaGFy
ICppZF9vdXQ7CisgICAgaW50IGlkX291dF9sZW47Cit9IHJidF9kYXRhX3Q7CisKK3N0YXRpYyBz
dHJ1Y3QgcmJ0cmVlICpyYnRfaW50X3RvX2V4dD1OVUxMOworc3RhdGljIHN0cnVjdCByYnRyZWUg
KnJidF9leHRfdG9faW50PU5VTEw7CisKK3N0YXRpYyBpbnQgY29udmVydHVzZXJpZF9zb2NrZXQ9
LTE7CisKK2ludCByYnRfZGF0YV9jb21wYXJlKGNvbnN0IHZvaWQgKnAxLCBjb25zdCB2b2lkICpw
MiwgY29uc3Qgdm9pZCAqY29uZmlnKQoreworICAgIHJidF9kYXRhX3QgKmQxPShyYnRfZGF0YV90
ICopcDE7CisgICAgcmJ0X2RhdGFfdCAqZDI9KHJidF9kYXRhX3QgKilwMjsKKyAgICBpbnQgcmVz
OworCisgICAgaWYoIShyZXM9c3RyY21wKGQxLT5kb21haW4sIGQyLT5kb21haW4pKSkgeworCWNo
YXIgKnN0cjEsICpzdHIyOworCWludCBzdHIxX2xlbiwgc3RyMl9sZW47CisJaW50IG1pbl9sZW47
CisKKwlpZihjb25maWcpIHsKKwkgICAgc3RyMT1kMS0+aWRfaW47CisJICAgIHN0cjFfbGVuPWQx
LT5pZF9pbl9sZW47CisJICAgIHN0cjI9ZDItPmlkX2luOworCSAgICBzdHIyX2xlbj1kMi0+aWRf
aW5fbGVuOworCX0KKwllbHNlIHsKKwkgICAgc3RyMT1kMS0+aWRfb3V0OworCSAgICBzdHIxX2xl
bj1kMS0+aWRfb3V0X2xlbjsKKwkgICAgc3RyMj1kMi0+aWRfb3V0OworCSAgICBzdHIyX2xlbj1k
Mi0+aWRfb3V0X2xlbjsKKwl9CisJbWluX2xlbiA9IChzdHIxX2xlbiA8IHN0cjJfbGVuKT8gc3Ry
MV9sZW4gOiBzdHIyX2xlbjsKKwlpZighKHJlcz1tZW1jbXAoc3RyMSwgc3RyMiwgbWluX2xlbikp
KSB7CisJICAgIGlmKG1pbl9sZW49PXN0cjFfbGVuKQorCQlyZXMgPSAobWluX2xlbj09c3RyMl9s
ZW4pPzA6LTE7CisJICAgIGVsc2UKKwkJcmVzID0gLTE7CisJfQorICAgIH0KKyAgICByZXR1cm4g
cmVzOworfQorCisjZGVmaW5lIERPTlRfQUxMT0NBVEVfSU4gIDB4MQorI2RlZmluZSBET05UX0FM
TE9DQVRFX09VVCAweDIKKworcmJ0X2RhdGFfdCAqcmJ0X2luaXRfdXNlcmlkX2RhdGEoY29uc3Qg
Y2hhciAqZG9tYWluLCBjb25zdCBjaGFyICppbiwgaW50IGluX2xlbiwgY29uc3QgY2hhciAqb3V0
LCBpbnQgb3V0X2xlbiwgaW50IGZsYWdzKQoreworICAgIHJidF9kYXRhX3QgKnJlcz0ocmJ0X2Rh
dGFfdCAqKW1hbGxvYyhzaXplb2YocmJ0X2RhdGFfdCkpOworCisgICAgaWYoIXJlcykKKwlyZXR1
cm4gTlVMTDsKKworICAgIHJlcy0+ZG9tYWluID0gc3RyZHVwKGRvbWFpbik7CisgICAgaWYoIXJl
cy0+ZG9tYWluKSB7CisJZnJlZShyZXMpOworCXJldHVybiBOVUxMOworICAgIH0KKworICAgIGlm
KGluID09IG91dCAmJiAoZmxhZ3MgJiAoRE9OVF9BTExPQ0FURV9JTnxET05UX0FMTE9DQVRFX09V
VCkpKQorCWZsYWdzIHw9IChET05UX0FMTE9DQVRFX0lOfERPTlRfQUxMT0NBVEVfT1VUKTsKKwor
ICAgIGlmKGZsYWdzICYgRE9OVF9BTExPQ0FURV9JTikKKwlyZXMtPmlkX2luID0gKGNoYXIgKilp
bjsKKyAgICBlbHNlIGlmKCEocmVzLT5pZF9pbiA9IChjaGFyICopbWFsbG9jKGluX2xlbikpKSB7
CisJZnJlZShyZXMtPmRvbWFpbik7CisJZnJlZShyZXMpOworCXJldHVybiBOVUxMOworICAgIH0K
KyAgICBlbHNlCisJbWVtY3B5KHJlcy0+aWRfaW4sIGluLCBpbl9sZW4pOworCisgICAgaWYoaW4g
PT0gb3V0ICYmICFmbGFncykgeworCW91dCA9IHJlcy0+aWRfaW47CisJZmxhZ3MgfD0gRE9OVF9B
TExPQ0FURV9PVVQ7CisgICAgfQorCisgICAgaWYoZmxhZ3MgJiBET05UX0FMTE9DQVRFX09VVCkK
KwlyZXMtPmlkX291dCA9IChjaGFyICopb3V0OworICAgIGVsc2UgaWYoIShyZXMtPmlkX291dCA9
IChjaGFyICopbWFsbG9jKG91dF9sZW4pKSkgeworCWZyZWUocmVzLT5kb21haW4pOworCWlmKCEo
ZmxhZ3MgJiBET05UX0FMTE9DQVRFX0lOKSkKKwkgICAgZnJlZShyZXMtPmlkX2luKTsKKwlmcmVl
KHJlcyk7CisJcmV0dXJuIE5VTEw7CisgICAgfQorICAgIGVsc2UKKwltZW1jcHkocmVzLT5pZF9v
dXQsIG91dCwgb3V0X2xlbik7CisKKyAgICByZXMtPmlkX2luX2xlbiA9IGluX2xlbjsKKyAgICBy
ZXMtPmlkX291dF9sZW4gPSBvdXRfbGVuOworCisgICAgcmV0dXJuIHJlczsKK30KKwordm9pZCBy
YnRfZnJlZV91c2VyaWRfZGF0YShyYnRfZGF0YV90ICpkYXRhKQoreworICAgIGZyZWUoZGF0YS0+
ZG9tYWluKTsKKyAgICBmcmVlKGRhdGEtPmlkX2luKTsKKyAgICBpZihkYXRhLT5pZF9pbiE9ZGF0
YS0+aWRfb3V0KQorCWZyZWUoZGF0YS0+aWRfb3V0KTsKKyAgICBmcmVlKGRhdGEpOworfQorCisj
ZGVmaW5lIElOVEVSTkFMICAgICAgICAgICAgICAweDEKKyNkZWZpbmUgTERBUF9OQU1FX01VU1Rf
RVhJU1RTIDB4MgorI2RlZmluZSBET05UX0lHTk9SRV9FUlJPUlMgICAgMHg0CisjZGVmaW5lIERP
TlRfUkVUVVJOX0VYSVNURU5UICAweDgKKworZXh0ZXJuIGludCBjb252ZXJ0dXNlcmlkX2luaXQo
KQoreworICAgIGNvbnN0IGNoYXIgKmNvbnZlcnR1c2VyaWRfc29jazsKKyAgICBpbnQgbG9jYWxs
ZW47CisgICAgaW50IHBhdGhsZW47CisgICAgbW9kZV90IG9sZHVtYXNrOworICAgIGludCBwb3J0
X251bTsKKyAgICBzdHJ1Y3Qgc29ja2FkZHJfaW4gY29udmVydHVzZXJpZF9yZW1vdGU7CisgICAg
aW50IGNvbnZlcnR1c2VyaWRfcmVtb3RlX2xlbjsKKworICAgIC8qIGlmIHRoZSBzb2NrZXQgaXMg
YWxyZWFkeSBvcGVuLCByZXR1cm4gKi8KKyAgICBpZiAoY29udmVydHVzZXJpZF9zb2NrZXQgIT0g
LTEpIHsKKwlzeXNsb2coTE9HX0VSUiwgImNvbnZlcnR1c2VyaWRfaW5pdDogbXVzdCBub3QgYmUg
Y2FsbGVkIHR3aWNlIik7CisJcmV0dXJuIC0xOworICAgIH0KKworICAgIHBvcnRfbnVtID0gY29u
ZmlnX2dldGludChJTUFQT1BUX0NPTlZFUlRVU0VSSURfVURQUE9SVCk7CisgICAgaWYoIXBvcnRf
bnVtKSB7CisJc3lzbG9nKExPR19FUlIsICJJbnZhbGlkIHZhbHVlIG9mIGNvbnZlcnR1c2VyaWRf
dWRwcG9ydCBjb25maWcgb3B0aW9uXG4iKTsKKwlyZXR1cm4gLTE7CisgICAgfQorCisgICAgaWYg
KChjb252ZXJ0dXNlcmlkX3NvY2tldCA9IHNvY2tldChBRl9JTkVULCBTT0NLX0RHUkFNLCAwKSkg
PT0gLTEpIHsKKwlzeXNsb2coTE9HX0VSUiwgImNvbnZlcnR1c2VyaWRfaW5pdDogY2FuJ3QgY3Jl
YXRlIGEgc29ja2V0Iik7CisJcmV0dXJuIC0xOworICAgIH0KKworICAgIGNvbnZlcnR1c2VyaWRf
cmVtb3RlLnNpbl9mYW1pbHkgPSBBRl9JTkVUOworICAgIGNvbnZlcnR1c2VyaWRfcmVtb3RlLnNp
bl9wb3J0ID0gaHRvbnMocG9ydF9udW0pOworICAgIGluZXRfcHRvbihBRl9JTkVULCBjb25maWdf
Z2V0c3RyaW5nKElNQVBPUFRfQ09OVkVSVFVTRVJJRF9MT0NBTEhPU1QpLCAmY29udmVydHVzZXJp
ZF9yZW1vdGUuc2luX2FkZHIpOworICAgIGNvbnZlcnR1c2VyaWRfcmVtb3RlX2xlbiA9IHNpemVv
Zihjb252ZXJ0dXNlcmlkX3JlbW90ZSk7CisKKyAgICBpZihjb25uZWN0KGNvbnZlcnR1c2VyaWRf
c29ja2V0LCAoc3RydWN0IHNvY2thZGRyICopJmNvbnZlcnR1c2VyaWRfcmVtb3RlLCBjb252ZXJ0
dXNlcmlkX3JlbW90ZV9sZW4pPT0tMSkgeworCXN5c2xvZyhMT0dfRVJSLCAiY29udmVydHVzZXJp
ZF9pbml0OiBjYW4ndCBjb25uZWN0IChkYXRhZ3JhbSkiKTsKKwlyZXR1cm4gLTE7CisgICAgfQor
CisgICAgcmV0dXJuIDA7Cit9CisKK2V4dGVybiBpbnQgY29udmVydHVzZXJpZF9jb25maWdfcmVy
ZWFkKCkKK3sKKyAgICB0ZW1wbGF0ZV9vcHRpb24gb3B0c1tdPXsKKwl7KHZvaWQgKilJTUFQT1BU
X0NPTlZFUlRVU0VSSUQsIFRFTVBMQVRFT1BUX1RZUEVfS05PV05PUFR9LAorCXsodm9pZCAqKUlN
QVBPUFRfQ09OVkVSVFVTRVJJRF9FWEVNUFRTLCBURU1QTEFURU9QVF9UWVBFX0tOT1dOT1BUfSwK
Kwl7KHZvaWQgKilJTUFQT1BUX0NPTlZFUlRVU0VSSURfQUxMT1dfTk9OQ09OVkVSVEVELCBURU1Q
TEFURU9QVF9UWVBFX0tOT1dOT1BUfSwKKwl7KHZvaWQgKilJTUFQT1BUX0NPTlZFUlRVU0VSSURf
RE9OVElHTk9SRV9FUlJPUlMsIFRFTVBMQVRFT1BUX1RZUEVfS05PV05PUFR9LAorICAgIH07CisK
KyAgICByZXR1cm4gY29uZmlnX3JlcmVhZChvcHRzLCBzaXplb2Yob3B0cykvc2l6ZW9mKG9wdHNb
MF0pKTsKK30KKworc3RhdGljIGNoYXIgKm1ib3huYW1lX2dldF9pZF9mcm9tX2xkYXAoY29uc3Qg
Y2hhciAqaW4sIGludCBpbl9sZW4sIGNvbnN0IGNoYXIgKmRvbWFpbiwgaW50ICpvdXRfbGVuLCB1
bnNpZ25lZCBsb25nICplcnJjb2RlLCBpbnQgZmxhZ3MpCit7CisgICAgbGRhcF9kYXRhX3Qgc2Vu
ZGRhdGE7CisgICAgaW50IGRvbWFpbmxlbj1zdHJsZW4oZG9tYWluKTsKKyAgICBzc2l6ZV90IHNp
emU7CisKKyAgICBzZW5kZGF0YS5pbnQyZXh0ID0gZmxhZ3MmSU5URVJOQUw7CisgICAgc2VuZGRh
dGEudXNlcmxlbiA9IGluX2xlbjsKKyAgICBtZW1jcHkoc2VuZGRhdGEuYnVmLCBpbiwgaW5fbGVu
KTsKKyAgICBtZW1jcHkoc2VuZGRhdGEuYnVmK2luX2xlbiwgZG9tYWluLCBkb21haW5sZW4pOwor
CisgICAgc2l6ZT1zZW5kKGNvbnZlcnR1c2VyaWRfc29ja2V0LCAodm9pZCAqKSZzZW5kZGF0YSwg
TERBUERBVEFfQkFTRV9TSVpFK2luX2xlbitkb21haW5sZW4sIDApOworICAgIGlmKHNpemUgPT0g
KHNzaXplX3QpLTEpIHsKKwlzeXNsb2coTE9HX0VSUiwgIkNhbm5vdCBzZW5kIGNvbnZlcnR1c2Vy
aWQgcXVlcnk6ICVzLlxuIiwgc3RyZXJyb3IoZXJybm8pKTsKKwkqZXJyY29kZSA9IENPTlZFUlRV
U0VSSURfU1lTRkFJTEVEOworCXJldHVybiBOVUxMOworICAgIH0KKyAgICBpZihzaXplICE9IExE
QVBEQVRBX0JBU0VfU0laRStpbl9sZW4rZG9tYWlubGVuKQorCXN5c2xvZyhMT0dfRVJSLCAiQ2Fu
bm90IHNlbmQgZnVsbCBjb252ZXJ0dXNlcmlkIHF1ZXJ5LlxuIik7CisKKyAgICBpZihzaXplKSB7
CisJbGRhcF9kYXRhX3Jlc3VsdF90IHJlY3ZkYXRhOworCWNoYXIgKm91dDsKKworCXNpemUgPSBy
ZWN2KGNvbnZlcnR1c2VyaWRfc29ja2V0LCAodm9pZCAqKSZyZWN2ZGF0YSwgc2l6ZW9mKHJlY3Zk
YXRhKSwgMCk7CisJaWYoc2l6ZT09KHNzaXplX3QpLTEpIHsKKwkgICAgc3lzbG9nKExPR19FUlIs
ICJDYW5ub3QgcmVjZWl2ZSBjb252ZXJ0dXNlcmlkIGFuc3dlcjogJXMuXG4iLCBzdHJlcnJvcihl
cnJubykpOworCSAgICAqZXJyY29kZSA9IENPTlZFUlRVU0VSSURfU1lTRkFJTEVEOworCSAgICBy
ZXR1cm4gTlVMTDsKKwl9CisJaWYoc2l6ZTxMREFQREFUQV9SRVNVTFRfQkFTRV9TSVpFIHx8CisJ
ICAgKHNpemU9PUxEQVBEQVRBX1JFU1VMVF9CQVNFX1NJWkUgJiYgIXJlY3ZkYXRhLmNvZGUpKSB7
CisJICAgIHN5c2xvZyhMT0dfRVJSLCAiV3Jvbmcgc2l6ZSBvZiBjb252ZXJ0dXNlcmlkIGFuc3dl
ci5cbiIpOworCSAgICAqZXJyY29kZSA9IENPTlZFUlRVU0VSSURfU1lTRkFJTEVEOworCSAgICBy
ZXR1cm4gTlVMTDsKKwl9CisJKmVycmNvZGUgPSByZWN2ZGF0YS5jb2RlOworCisJLyogYW5zd2Vy
IGlzICJjYW4ndCBjb252ZXJ0IHVzZXJpZCIgKi8KKwlpZihyZWN2ZGF0YS5jb2RlKQorCSAgICBy
ZXR1cm4gTlVMTDsKKworCXNpemUtPUxEQVBEQVRBX1JFU1VMVF9CQVNFX1NJWkU7CisJb3V0PShj
aGFyICopbWFsbG9jKHNpemUpOworCWlmKCFvdXQpCisJICAgIHJldHVybiBOVUxMOworCW1lbWNw
eShvdXQsIHJlY3ZkYXRhLmJ1Ziwgc2l6ZSk7CisJKm91dF9sZW4gPSBzaXplOworCXJldHVybiBv
dXQ7CisgICAgfQorCisgICAgKmVycmNvZGUgPSBDT05WRVJUVVNFUklEX1NZU0ZBSUxFRDsKKyAg
ICByZXR1cm4gTlVMTDsKK30KKworc3RhdGljIGNoYXIgKm1ib3huYW1lX2dldF9pZChjb25zdCBj
aGFyICppbiwgaW50IGluX2xlbiwgY29uc3QgY2hhciAqZG9tYWluLCBpbnQgKm91dF9sZW4sIHN0
cnVjdCByYnRyZWUgKipjX2ludCwgc3RydWN0IHJidHJlZSAqKmNfZXh0LCBpbnQgZmxhZ3MpCit7
CisgICAgcmJ0X2RhdGFfdCBkYXRhOworICAgIHJidF9kYXRhX3QgKnNhdmVkX2RhdGE7CisgICAg
Y2hhciAqb3V0OworICAgIGludCBuZWVkX2FsbG9jPTA7CisgICAgaW50IG5vbmV4aXN0ZW50PTA7
CisgICAgdW5zaWduZWQgbG9uZyBlcnJjb2RlOworCisgICAgaWYoISpjX2ludCkKKwlpZighKCpj
X2ludCA9IHJiaW5pdChyYnRfZGF0YV9jb21wYXJlLCAodm9pZCAqKSgoZmxhZ3MmSU5URVJOQUwp
PjApKSkpCisJICAgIHJldHVybiBOVUxMOworICAgIGlmKCEqY19leHQpCisJaWYoISgqY19leHQg
PSByYmluaXQocmJ0X2RhdGFfY29tcGFyZSwgKHZvaWQgKikoIShmbGFncyZJTlRFUk5BTCkpKSkp
CisJICAgIHJldHVybiBOVUxMOworICAgIGRhdGEuZG9tYWluID0gKGNoYXIgKilkb21haW47CisJ
ICAgCisgICAgaWYoZmxhZ3MmSU5URVJOQUwpIHsKKwlkYXRhLmlkX2luID0gKGNoYXIgKilpbjsK
KwlkYXRhLmlkX2luX2xlbiA9IGluX2xlbjsKKwlkYXRhLmlkX291dCA9IE5VTEw7CisJZGF0YS5p
ZF9vdXRfbGVuID0gMDsKKyAgICB9CisgICAgZWxzZSB7CisJZGF0YS5pZF9vdXQgPSAoY2hhciAq
KWluOworCWRhdGEuaWRfb3V0X2xlbiA9IGluX2xlbjsKKwlkYXRhLmlkX2luID0gTlVMTDsKKwlk
YXRhLmlkX2luX2xlbiA9IDA7CisgICAgfQorCisgICAgLyogZmlyc3RseSBsb29rIGZvciB0aGUg
bmFtZSBpbiB0aGUgbG9jYWwgKGluLW1lbW9yeSkgc3RvcmFnZSAqLworICAgIGlmKChzYXZlZF9k
YXRhPShyYnRfZGF0YV90ICopcmJmaW5kKCh2b2lkICopJmRhdGEsICpjX2ludCkpKSB7CisJaWYo
ZmxhZ3MmSU5URVJOQUwpIHsKKwkgICAgKm91dF9sZW4gPSBzYXZlZF9kYXRhLT5pZF9vdXRfbGVu
OworCSAgICByZXR1cm4gc2F2ZWRfZGF0YS0+aWRfb3V0OworCX0KKwllbHNlIHsKKwkgICAgKm91
dF9sZW4gPSBzYXZlZF9kYXRhLT5pZF9pbl9sZW47CisJICAgIHJldHVybiBzYXZlZF9kYXRhLT5p
ZF9pbjsKKwl9IAorICAgIH0KKworICAgIG91dCA9IG1ib3huYW1lX2dldF9pZF9mcm9tX2xkYXAo
aW4sIGluX2xlbiwgZG9tYWluLCBvdXRfbGVuLCAmZXJyY29kZSwgZmxhZ3MpOworCisgICAgaWYo
IW91dCkgeworCWlmKGZsYWdzICYgTERBUF9OQU1FX01VU1RfRVhJU1RTIHx8ICgoZmxhZ3MgJiBE
T05UX0lHTk9SRV9FUlJPUlMpICYmIGVycmNvZGUhPUNPTlZFUlRVU0VSSURfTk9ORVhJU1RFTlRf
SUQpKQorCSAgICByZXR1cm4gTlVMTDsKKwkvKiBzYXZlIHRoZSBpbnRlcm5hbCBuYW1lIGFzIGV4
dGVybmFsIGlmIExEQVAgZmV0Y2hpbmcgZmFpbHMgKi8KKwllbHNlIHsKKwkgICAgb3V0PShjaGFy
ICopaW47CisJICAgICpvdXRfbGVuPWluX2xlbjsKKwkgICAgbmVlZF9hbGxvYz0xOworCSAgICBu
b25leGlzdGVudD0xOworCX0KKyAgICB9CisgICAgCisgICAgLyogTm93IHdlIGhhdmUgJ291dCcg
YW5kICcqb3V0X2xlbicgdmFyaWFibGVzLiBTYXZlICdpbicgYW5kCisgICAgICAgJ291dCcgaW4g
b3VyIG1lbW9yeSBkYXRhYmFzZXMgKi8KKyAgICBpZihmbGFncyZJTlRFUk5BTCkKKwlzYXZlZF9k
YXRhPXJidF9pbml0X3VzZXJpZF9kYXRhKGRvbWFpbiwgaW4sIGluX2xlbiwgb3V0LCAqb3V0X2xl
biwgbmVlZF9hbGxvYz8wOkRPTlRfQUxMT0NBVEVfT1VUKTsKKyAgICBlbHNlCisJc2F2ZWRfZGF0
YT1yYnRfaW5pdF91c2VyaWRfZGF0YShkb21haW4sIG91dCwgKm91dF9sZW4sIGluLCBpbl9sZW4s
IG5lZWRfYWxsb2M/MDpET05UX0FMTE9DQVRFX0lOKTsKKyAgICAKKyAgICBpZighcmJzZWFyY2go
c2F2ZWRfZGF0YSwqY19pbnQpKSB7CisJcmJ0X2ZyZWVfdXNlcmlkX2RhdGEoc2F2ZWRfZGF0YSk7
CisJc2F2ZWRfZGF0YT1OVUxMOworICAgIH0KKyAgICBlbHNlIGlmKCFyYnNlYXJjaChzYXZlZF9k
YXRhLCpjX2V4dCkpIHsKKwlyYmRlbGV0ZShzYXZlZF9kYXRhLCAqY19pbnQpOworCXJidF9mcmVl
X3VzZXJpZF9kYXRhKHNhdmVkX2RhdGEpOworCXNhdmVkX2RhdGE9TlVMTDsKKyAgICB9CisKKyAg
ICAvKiBJZiB3ZSBjYW4ndCBzYXZlIGRhdGEgaW4gdGhlIG1lbW9yeSBzdG9yYWdlIHRoZW4gcmV0
dXJuIE5VTEwKKyAgICAgICBiZWNhdXNlIHdlIGFyZSBub3Qgc3VyZSBpZiBkYXRhIGluIGxkYXAg
c3RvcmFnZSB3aWxsIG5vdCBiZQorICAgICAgIGNoYW5nZWQgd2hlbiB0aGlzIGZ1bmN0aW9uIGlz
IGNhbGxlZCBuZXh0IHRpbWUuICovCisgICAgaWYoIXNhdmVkX2RhdGEpCisJcmV0dXJuIE5VTEw7
CisKKyAgICBpZighbm9uZXhpc3RlbnQgJiYgKGZsYWdzICYgRE9OVF9SRVRVUk5fRVhJU1RFTlQp
KQorCXJldHVybiBOVUxMOworCSAgICAKKyAgICByZXR1cm4gb3V0OworfQorCitzdGF0aWMgdm9p
ZCByYnRfd2Fsa19jYihjb25zdCB2b2lkICpub2RlcCwgY29uc3QgVklTSVQgd2hpY2gsIGNvbnN0
IGludCBkZXB0aCwgdm9pZCAqYXJnKQoreworICAgIGlmKHdoaWNoID09IGVuZG9yZGVyIHx8IHdo
aWNoID09IGxlYWYpCisJcmJ0X2ZyZWVfdXNlcmlkX2RhdGEoKHJidF9kYXRhX3QgKilub2RlcCk7
Cit9CisKKy8qIGRlc3Ryb3lpbmcgYWxsIHRoZSBkYXRhIG5lZWRlZCBmb3IgbmFtZXMgdHJhbnNm
b3JtYXRpb24gKHRoaXMKKyAgIGZ1bmN0aW9uIGlzIGNhbGxlZCB3aGVuIGNsaWVudCB0ZXJtaW5h
dGVzIGhpcyBjb25uZWN0aW9uKSAqLworZXh0ZXJuIHZvaWQgbWJveG5hbWVfY2xlYW51cCgpCit7
CisgICAgcmJ0X2RhdGFfdCAqZGF0YTsKKworICAgIGlmKHJidF9pbnRfdG9fZXh0KSB7CisJcmJ3
YWxrKHJidF9pbnRfdG9fZXh0LCByYnRfd2Fsa19jYiwgTlVMTCk7CisJICAgIAorCXJiZGVzdHJv
eShyYnRfaW50X3RvX2V4dCk7CisJcmJ0X2ludF90b19leHQ9TlVMTDsKKyAgICB9CisgICAgaWYo
cmJ0X2V4dF90b19pbnQpIHsKKwlyYmRlc3Ryb3kocmJ0X2V4dF90b19pbnQpOworCXJidF9leHRf
dG9faW50PU5VTEw7CisgICAgfQorfQorZXh0ZXJuIGludCBjb252ZXJ0dXNlcmlkX2NsZWFudXAo
KQoreworICAgIGNsb3NlKGNvbnZlcnR1c2VyaWRfc29ja2V0KTsKK30KKworI2VuZGlmIC8qIEVO
QUJMRV9DT05WRVJUX1VTRVJJRCAqLworCitzdGF0aWMgY2hhciAqbWJveG5hbWVfZ2V0X2V4dGVy
bmFsX2lkKGNvbnN0IGNoYXIgKmluLCBpbnQgaW5fbGVuLCBjb25zdCBjaGFyICpkb21haW4sIGlu
dCAqb3V0X2xlbiwgaW50IGZsYWdzKQoreworI2lmbmRlZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQK
KyAgICAqb3V0X2xlbiA9IGluX2xlbjsKKyAgICByZXR1cm4gKGNoYXIgKilpbjsKKyNlbHNlCisg
ICAgcmV0dXJuIG1ib3huYW1lX2dldF9pZChpbiwgaW5fbGVuLCBkb21haW4sIG91dF9sZW4sICZy
YnRfaW50X3RvX2V4dCwgJnJidF9leHRfdG9faW50LCBJTlRFUk5BTHwoZmxhZ3MmKExEQVBfTkFN
RV9NVVNUX0VYSVNUU3xET05UX1JFVFVSTl9FWElTVEVOVHxET05UX0lHTk9SRV9FUlJPUlMpKSk7
CisjZW5kaWYKK30KKworc3RhdGljIGNoYXIgKm1ib3huYW1lX2dldF9pbnRlcm5hbF9pZChjb25z
dCBjaGFyICppbiwgaW50IGluX2xlbiwgY29uc3QgY2hhciAqZG9tYWluLCBpbnQgKm91dF9sZW4p
Cit7CisjaWZuZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICAgICpvdXRfbGVuID0gaW5fbGVu
OworICAgIHJldHVybiAoY2hhciAqKWluOworI2Vsc2UKKyAgICByZXR1cm4gbWJveG5hbWVfZ2V0
X2lkKGluLCBpbl9sZW4sIGRvbWFpbiwgb3V0X2xlbiwgJnJidF9leHRfdG9faW50LCAmcmJ0X2lu
dF90b19leHQsIExEQVBfTkFNRV9NVVNUX0VYSVNUUyk7CisjZW5kaWYKK30KIAogc3RhdGljIGlu
dCBtYm94bmFtZV9jaGVja19oaWVyc2VwcyhzdHJ1Y3QgbmFtZXNwYWNlICpuYW1lc3BhY2UsIGNv
bnN0IGNoYXIgKm5hbWUsIGludCBuYW1lbGVuKQogewpAQCAtMjA1LDcgKzU3NCw3IEBACiAJCQkJ
ICAgY29uc3QgY2hhciAqbmFtZSwKIAkJCQkgICBjb25zdCBjaGFyICp1c2VyaWQsIGNoYXIgKnJl
c3VsdCkKIHsKLSAgICBjaGFyICpjcDsKKyAgICBjaGFyICpjcCwgKmRvbWFpbj0iIjsKICAgICBp
bnQgdXNlcmxlbiwgZG9tYWlubGVuID0gMCwgbmFtZWxlbjsKICAgICBpbnQgcHJlZml4bGVuOwog
ICAgIHNpemVfdCByZXN1bHRsZW47CkBAIC0yMjIsNyArNTkxLDggQEAKICAgICBpZiAoY29uZmln
X3ZpcnRkb21haW5zKSB7CiAJaWYgKHVzZXJpZCAmJiAoY3AgPSBzdHJjaHIodXNlcmlkLCAnQCcp
KSkgewogCSAgICAvKiB1c2VyIGxvZ2dlZCBpbiBhcyB1c2VyQGRvbWFpbiAqLwotCSAgICB1c2Vy
bGVuID0gY3ArKyAtIHVzZXJpZDsKKwkgICAgdXNlcmxlbiA9IGNwIC0gdXNlcmlkOworCSAgICBk
b21haW4gPSArK2NwOwogCSAgICBpZiAoIShjb25maWdfZGVmZG9tYWluICYmICFzdHJjYXNlY21w
KGNvbmZpZ19kZWZkb21haW4sIGNwKSkpIHsKIAkJLyogZG9uJ3QgcHJlcGVuZCBkZWZhdWx0IGRv
bWFpbiAqLwogCQlkb21haW5sZW4gPSBzdHJsZW4oY3ApKzE7CkBAIC0yMzMsNiArNjAzLDcgQEAK
IAl9CiAJaWYgKChjcCA9IHN0cnJjaHIobmFtZSwgJ0AnKSkpIHsKIAkgICAgLyogbWFpbGJveCBz
cGVjaWZpZWQgYXMgbWJveEBkb21haW4gKi8KKwkgICAgZG9tYWluID0gY3ArMTsKIAkgICAgbmFt
ZWxlbiA9IGNwIC0gbmFtZTsKIAogCSAgICBpZiAoY29uZmlnX2RlZmRvbWFpbiAmJiAhc3RyY2Fz
ZWNtcChjb25maWdfZGVmZG9tYWluLCBjcCsxKSkgewpAQCAtMjkwLDE4ICs2NjEsODMgQEAKIAog
ICAgIGlmICghc3RybmNtcChuYW1lLCBuYW1lc3BhY2UtPnByZWZpeFtOQU1FU1BBQ0VfVVNFUl0s
IHByZWZpeGxlbi0xKSAmJgogCShuYW1lbGVuID09IHByZWZpeGxlbi0xIHx8IG5hbWVbcHJlZml4
bGVuLTFdID09IG5hbWVzcGFjZS0+aGllcl9zZXApKSB7CisJY2hhciBtb2RpZmllZF91c2VybmFt
ZVtNQVhfTUFJTEJPWF9OQU1FKzFdOworCWNoYXIgKmludF9pZD0iIjsKKwlzaXplX3QgaW50X2lk
X2xlbj0wOworCXNpemVfdCBleHRfaWRfbGVuPTA7CiAKIAlpZiAobmFtZWxlbiA9PSBwcmVmaXhs
ZW4tMSkgewogCSAgICAvKiBjYW4ndCBjcmVhdGUgZm9sZGVycyB1c2luZyB1bmRlbGltaXRlZCBw
cmVmaXggKi8KIAkgICAgcmV0dXJuIElNQVBfTUFJTEJPWF9CQUROQU1FOwogCX0KIAotCWlmIChk
b21haW5sZW4rbmFtZWxlbi1wcmVmaXhsZW4rNSA+IE1BWF9NQUlMQk9YX05BTUUpIHsKLQkgICAg
cmV0dXJuIElNQVBfTUFJTEJPWF9CQUROQU1FOworCWlmKCFpbWFwZF9jb252ZXJ0dXNlcmlkKSB7
CisJICAgIGlmIChkb21haW5sZW4rbmFtZWxlbi1wcmVmaXhsZW4rNSA+IE1BWF9NQUlMQk9YX05B
TUUpCisJCXJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsKKwkgICAgbmFtZSs9cHJlZml4bGVu
OwogCX0KKwllbHNlIHsKKwkgICAgY2hhciAqc2VwOworCisJICAgIG5hbWUrPXByZWZpeGxlbjsK
KwkgICAgc2VwPXN0cmNocihuYW1lLG5hbWVzcGFjZS0+aGllcl9zZXApOworCSAgICBpZighc2Vw
IHx8IHNlcC1uYW1lID49IG5hbWVsZW4tcHJlZml4bGVuKQorCQlleHRfaWRfbGVuID0gbmFtZWxl
bi1wcmVmaXhsZW47CisJICAgIGVsc2UKKwkJZXh0X2lkX2xlbiA9IHNlcC1uYW1lOworCisJICAg
IGlmKCFleHRfaWRfbGVuKQorCQlyZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7CisJICAgIAor
CSAgICAvKiB3ZSBtdXN0IHRyYW5zZm9ybSBoaWVyYXJjaHkgc2VwYXJhdG9ycyBpbiB0aGUgX3Vz
ZXJfaWRfCisJICAgICAgIGludG8gaW50ZXJuYWwgcmVwcmVzZW50YXRpb25zIGJlZm9yZSBxdWVy
eWluZyB0aGUKKwkgICAgICAgaW50ZXJuYWwgdXNlciBpZCBiZWNhdXNlIHRoZSByZXZlcnQgdHJh
bnNmb3JtYXRpb24KKwkgICAgICAgd29ya3Mgd2l0aCB1c2VybmFtZXMgb25seSBhbmQga25vd3Mg
bm90aGluZyBhYm91dAorCSAgICAgICBzZXBhcmF0b3JzIC0tIHNvcmNlcmVyICovCisJICAgIG1l
bWNweShtb2RpZmllZF91c2VybmFtZSwgbmFtZSwgZXh0X2lkX2xlbik7CisJICAgIG1ib3huYW1l
X2hpZXJzZXBfdG9pbnRlcm5hbChuYW1lc3BhY2UsIG1vZGlmaWVkX3VzZXJuYW1lLGV4dF9pZF9s
ZW4pOworCisJICAgIGludF9pZCA9IG1ib3huYW1lX2dldF9pbnRlcm5hbF9pZChtb2RpZmllZF91
c2VybmFtZSwgZXh0X2lkX2xlbiwgZG9tYWluLCAmaW50X2lkX2xlbik7CisJICAgIGlmKCFpbnRf
aWQpIHsKKwkJY2hhciB0ZW1wX21ibmFtZVtNQVhfTUFJTEJPWF9OQU1FKzFdOworCisJCWlmKCFp
bWFwZF9ub25jb252ZXJ0ZWR1c2VyaWRfYWxsb3dlZCkKKwkJICAgIHJldHVybiBJTUFQX01BSUxC
T1hfTk9ORVhJU1RFTlQ7CisKKwkJLyogYnVpbGQgaW50ZXJuYWwgbWFpbGJveCBuYW1lIHdpdGgg
Z2l2ZW4gdXNlcmlkIHRvCisJCSAgIGNoZWNrIGlmIHRoaXMgbWFpbGJveCBleGlzdHMgKi8KKwkJ
aWYoZG9tYWlubGVuK25hbWVsZW4tcHJlZml4bGVuKzUgPiBNQVhfTUFJTEJPWF9OQU1FKQorCQkg
ICAgcmV0dXJuIElNQVBfTUFJTEJPWF9CQUROQU1FOwogCi0Jc3ByaW50ZihyZXN1bHQsICJ1c2Vy
LiUuKnMiLCBuYW1lbGVuLXByZWZpeGxlbiwgbmFtZStwcmVmaXhsZW4pOworCQltZW1jcHkodGVt
cF9tYm5hbWUsICJ1c2VyLiIsIDUpOworCQltZW1jcHkodGVtcF9tYm5hbWUrNSwgbW9kaWZpZWRf
dXNlcm5hbWUsIGV4dF9pZF9sZW4pOworCQltZW1jcHkodGVtcF9tYm5hbWUrNStleHRfaWRfbGVu
LCBuYW1lK2V4dF9pZF9sZW4sIG5hbWVsZW4tcHJlZml4bGVuLWV4dF9pZF9sZW4pOworCQl0ZW1w
X21ibmFtZVs1K25hbWVsZW4tcHJlZml4bGVuXT0wOworCisJCW1ib3huYW1lX2hpZXJzZXBfdG9p
bnRlcm5hbChuYW1lc3BhY2UsIHRlbXBfbWJuYW1lKzUsIDApOworCQlpZihtYm94bGlzdF9sb29r
dXAodGVtcF9tYm5hbWUsIE5VTEwsIE5VTEwsIE5VTEwpKQorCQkgICAgcmV0dXJuIElNQVBfTUFJ
TEJPWF9OT05FWElTVEVOVDsKKwkJICAgIAorCQkvKiBsb29rIGZvciBpbnRlcm5hbCBpZCB3aXRo
IHRoZSB2YWx1ZSBvZiBnaXZlbgorCQkgICBleHRlcm5hbCBpZCAqLworCQlpbnRfaWQgPSBtYm94
bmFtZV9nZXRfZXh0ZXJuYWxfaWQoCisJCSAgICBtb2RpZmllZF91c2VybmFtZSwgZXh0X2lkX2xl
biwgZG9tYWluLCAmaW50X2lkX2xlbiwKKwkJICAgIERPTlRfUkVUVVJOX0VYSVNURU5UfAorCQkg
ICAgKGltYXBkX2RvbnRpZ25vcmVfY29udmVydHVzZXJpZF9lcnJvcnM/CisJCSAgICAgRE9OVF9J
R05PUkVfRVJST1JTOjApKTsKKwkJLyogY29udmVydCBlcnJvciBvciB0aGUgaW50ZXJuYWwgaWQg
ZXhpc3RzIGluIExEQVAgYXMKKwkJICAgZXh0ZXJuYWwgKi8KKwkJaWYoIWludF9pZCkKKwkJICAg
IHJldHVybiBJTUFQX01BSUxCT1hfTk9ORVhJU1RFTlQ7CisJCS8qIG90aGVyd2lzZSB1c2UgaW50
ZXJuYWwgaWQgKi8KKwkgICAgfQorCSAgICBpZihkb21haW5sZW4rbmFtZWxlbi1wcmVmaXhsZW4r
NS1leHRfaWRfbGVuK2ludF9pZF9sZW4gPiBNQVhfTUFJTEJPWF9OQU1FKQorCQlyZXR1cm4gSU1B
UF9NQUlMQk9YX0JBRE5BTUU7CisJICAgIG5hbWUrPWV4dF9pZF9sZW47CisJfQogCisJc3ByaW50
ZihyZXN1bHQsICJ1c2VyLiUuKnMlLipzIiwgaW50X2lkX2xlbiwgaW50X2lkLCBuYW1lbGVuLXBy
ZWZpeGxlbi1leHRfaWRfbGVuLCBuYW1lKTsKKwkKIAkvKiBUcmFuc2xhdGUgYW55IHNlcGFyYXRv
cnMgaW4gdXNlcmlkK21haWxib3ggKi8KIAltYm94bmFtZV9oaWVyc2VwX3RvaW50ZXJuYWwobmFt
ZXNwYWNlLCByZXN1bHQrNSwgMCk7CiAJcmV0dXJuIDA7CkBAIC0zOTksNyArODM1LDcgQEAKIHN0
YXRpYyBpbnQgbWJveG5hbWVfdG9leHRlcm5hbF9hbHQoc3RydWN0IG5hbWVzcGFjZSAqbmFtZXNw
YWNlLCBjb25zdCBjaGFyICpuYW1lLAogCQkJCSAgY29uc3QgY2hhciAqdXNlcmlkLCBjaGFyICpy
ZXN1bHQpCiB7Ci0gICAgY2hhciAqZG9tYWluOworICAgIGNoYXIgKmRvbWFpbj1OVUxMOwogICAg
IHNpemVfdCB1c2VybGVuLCByZXN1bHRsZW47CiAKICAgICAvKiBCbGFuayB0aGUgcmVzdWx0LCBq
dXN0IGluIGNhc2UgKi8KQEAgLTQxNSwxMyArODUxLDE5IEBACiAJc2l6ZV90IGRvbWFpbmxlbiA9
IHN0cmxlbihkb21haW4pOwogCiAJdXNlcmxlbiA9IGRvbWFpbiAtIHVzZXJpZDsKKwlkb21haW4r
KzsKKwlkb21haW5sZW4tLTsKIAotCWlmICghc3RybmNtcChuYW1lLCBkb21haW4rMSwgZG9tYWlu
bGVuLTEpICYmCi0JICAgIG5hbWVbZG9tYWlubGVuLTFdID09ICchJykgewotCSAgICBuYW1lICs9
IGRvbWFpbmxlbjsKKwlpZiAoIXN0cm5jbXAobmFtZSwgZG9tYWluLCBkb21haW5sZW4pICYmCisJ
ICAgIG5hbWVbZG9tYWlubGVuXSA9PSAnIScpIHsKKwkgICAgbmFtZSArPSBkb21haW5sZW4rMTsK
IAl9CiAgICAgfQogCisgICAgLyogc2V0IHRoZSBlbXB0eSBkb21haW4gaWYgaXQgZG9lc24ndCBl
eGlzdHMgKi8KKyAgICBpZighZG9tYWluKQorCWRvbWFpbj0iIjsKKwogICAgIC8qIFBlcnNvbmFs
IChJTkJPWCkgbmFtZXNwYWNlICovCiAgICAgaWYgKCFzdHJuY2FzZWNtcChuYW1lLCAiaW5ib3gi
LCA1KSAmJgogCShuYW1lWzVdID09ICdcMCcgfHwgbmFtZVs1XSA9PSAnLicpKSB7CkBAIC00NDUs
MTggKzg4Nyw1NyBAQAogICAgIGVsc2UgaWYgKCFzdHJuY21wKG5hbWUsICJ1c2VyIiwgNCkgJiYK
IAkgICAgIChuYW1lWzRdID09ICdcMCcgfHwgbmFtZVs0XSA9PSAnLicpKSB7CiAJc2l6ZV90IHBy
ZWZpeGxlbiA9IHN0cmxlbihuYW1lc3BhY2UtPnByZWZpeFtOQU1FU1BBQ0VfVVNFUl0pOworCWNo
YXIgKmV4dF9pZD0iIjsKKwlzaXplX3QgZXh0X2lkX2xlbj0wOwogCi0JaWYgKChwcmVmaXhsZW4g
PiBNQVhfTUFJTEJPWF9OQU1FKSB8fCAKLQkgICAgKChuYW1lWzRdID09ICcuJykgJiYgCi0JICAg
ICAoKHByZWZpeGxlbisxK3N0cmxlbihuYW1lKzUpKSA+IE1BWF9NQUlMQk9YX05BTUUpKSkKKwlp
ZiAocHJlZml4bGVuID4gTUFYX01BSUxCT1hfTkFNRSkKIAkgICAgcmV0dXJuIElNQVBfTUFJTEJP
WF9CQUROQU1FOworCQorCWlmKG5hbWVbNF0gPT0gJy4nKSB7CisJICAgIGlmKCFpbWFwZF9jb252
ZXJ0dXNlcmlkKSB7CisJCWlmKChwcmVmaXhsZW4rMStzdHJsZW4obmFtZSs1KSkgPiBNQVhfTUFJ
TEJPWF9OQU1FKQorCQkgICAgcmV0dXJuIElNQVBfTUFJTEJPWF9CQUROQU1FOworCQluYW1lKz01
OworCSAgICB9CisJICAgIC8qIGZldGNoaW5nIHRoZSB1c2VyJ3MgaWRlbnRpZmllciAvLyBzb3Jj
ZXJlciAqLworCSAgICBlbHNlIHsKKwkJY2hhciAqc2VwOworCQlzaXplX3QgaW50X2lkX2xlbjsK
KworCQluYW1lKz01OworCQlzZXA9c3RyY2hyKG5hbWUsJy4nKTsKKwkJaWYoc2VwKQorCQkgICAg
aW50X2lkX2xlbj1zZXAtbmFtZTsKKwkJZWxzZQorCQkgICAgaW50X2lkX2xlbj1zdHJsZW4obmFt
ZSk7CisKKwkJaWYoIWludF9pZF9sZW4pCisJCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5B
TUU7CisKKwkJLyogd2UgYXNzdW1lIHRoYXQgdGhlIHVzZXIgZG9tYWluIGlzIHNhbWUgYXMgdGhl
IG5hbWUncworCQkgICBkb21haW4gKi8KKwkJZXh0X2lkID0gbWJveG5hbWVfZ2V0X2V4dGVybmFs
X2lkKAorCQkgICAgbmFtZSwgaW50X2lkX2xlbiwgZG9tYWluLCAmZXh0X2lkX2xlbiwKKwkJICAg
ICghaW1hcGRfbm9uY29udmVydGVkdXNlcmlkX2FsbG93ZWQpPworCQkgICAgTERBUF9OQU1FX01V
U1RfRVhJU1RTOgorCQkgICAgKGltYXBkX2RvbnRpZ25vcmVfY29udmVydHVzZXJpZF9lcnJvcnM/
CisJCSAgICAgRE9OVF9JR05PUkVfRVJST1JTOjApKTsKKwkJaWYoIWV4dF9pZCkKKwkJICAgIHJl
dHVybiBJTUFQX01BSUxCT1hfTk9ORVhJU1RFTlQ7CisJCWlmKHByZWZpeGxlbiArIGV4dF9pZF9s
ZW4gKyBzdHJsZW4obmFtZStpbnRfaWRfbGVuKSA+IE1BWF9NQUlMQk9YX05BTUUpCisJCSAgICBy
ZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7CisJCW5hbWUrPWludF9pZF9sZW47CisJICAgIH0K
Kwl9CiAKIAlzcHJpbnRmKHJlc3VsdCwgIiUuKnMiLAogCQlwcmVmaXhsZW4tMSwgbmFtZXNwYWNl
LT5wcmVmaXhbTkFNRVNQQUNFX1VTRVJdKTsKIAlyZXN1bHRsZW4gPSBzdHJsZW4ocmVzdWx0KTsK
LQlpZiAobmFtZVs0XSA9PSAnLicpIHsKLQkgICAgc3ByaW50ZihyZXN1bHQrcmVzdWx0bGVuLCAi
JWMlcyIsIG5hbWVzcGFjZS0+aGllcl9zZXAsIG5hbWUrNSk7Ci0JfQorCisJLyogaW4gdGhlIGNh
c2UgaWYgZmV0Y2hpbmcgaWQgaXNuJ3QgZW5hYmxlZCwgZXh0X2lkIHZhcmlhYmxlCisJICAgd2ls
bCBiZSBlbXB0eSBhbmQgbmFtZSB2YXJpYWJsZSB3aWxsIGNvbnNpc3Qgb2YgdGhlIGZ1bGwKKwkg
ICBtYWlsYm94IG5hbWUgd2l0aG91dCBuYW1lc3BhY2UtPnByZWZpeFtOQU1FU1BBQ0VfVVNFUl0g
Ki8KKwlzcHJpbnRmKHJlc3VsdCtyZXN1bHRsZW4sICIlYyUuKnMlcyIsIG5hbWVzcGFjZS0+aGll
cl9zZXAsIGV4dF9pZF9sZW4sIGV4dF9pZCwgbmFtZSk7CiAgICAgfQogCiAgICAgLyogU2hhcmVk
IG5hbWVzcGFjZSAqLwpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL21ib3hu
YW1lLmggY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJveG5hbWUuaAotLS0gY3lydXMtaW1hcGQt
Mi4yLjEyLm9sZC9pbWFwL21ib3huYW1lLmgJMjAwNS0xMi0wOCAxNjo1OTowNSArMDMwMAorKysg
Y3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJveG5hbWUuaAkyMDA1LTEyLTA4IDE5OjM4OjUzICsw
MzAwCkBAIC03OCw2ICs3OCwyMCBAQAogCQkJICAgIHZvaWQgKnJvY2ssIGludCBmb3JjZSk7CiB9
OwogCisjaWZkZWYgRU5BQkxFX0NPTlZFUlRfVVNFUklECisvKiBjb252ZXJ0IG90aGVyIHVzZXJz
IGlkcyBiZXR3ZWVuIG5hbWVzcGFjZXMgKHN3aXRjaCkgKi8KK2V4dGVybiBpbnQgaW1hcGRfY29u
dmVydHVzZXJpZDsKK2V4dGVybiBpbnQgaW1hcGRfbm9uY29udmVydGVkdXNlcmlkX2FsbG93ZWQ7
CitleHRlcm4gaW50IGltYXBkX2RvbnRpZ25vcmVfY29udmVydHVzZXJpZF9lcnJvcnM7CisKKy8q
IGNvbnZlcnQgdXNlcmlkIGluaXRpYWxpemF0aW9uIGFuZCBjbGVhbnVwICovCitpbnQgY29udmVy
dHVzZXJpZF9pbml0KCk7CitpbnQgY29udmVydHVzZXJpZF9jb25maWdfcmVyZWFkKCk7CitpbnQg
Y29udmVydHVzZXJpZF9jbGVhbnVwKCk7CisvKiBkZXN0cm95IGFkZGl0aW9uYWwgaW5mb3JtYXRp
b24gd2hpY2ggaXMgbmVlZGVkIHRvIHRyYW5zZm9ybSB1c2VyaWRzICovCit2b2lkIG1ib3huYW1l
X2NsZWFudXAoKTsKKyNlbmRpZiAvKiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQgKi8KKwogLyogY3Jl
YXRlIG5hbWVzcGFjZSBiYXNlZCBvbiBnaXZlbiBvcHRpb25zICovCiBpbnQgbWJveG5hbWVfaW5p
dF9uYW1lc3BhY2VfZXh0KHN0cnVjdCBuYW1lc3BhY2UgKm5hbWVzcGFjZSwgaW50IGlzYWRtaW4s
IGNoYXIgaGllcl9zZXAsIGludCBpc2FsdCk7CiAvKiBDcmVhdGUgbmFtZXNwYWNlIGJhc2VkIG9u
IGNvbmZpZyBvcHRpb25zLiAqLwpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9saWIv
aGFzaC5jIGN5cnVzLWltYXBkLTIuMi4xMi9saWIvaGFzaC5jCi0tLSBjeXJ1cy1pbWFwZC0yLjIu
MTIub2xkL2xpYi9oYXNoLmMJMjAwNC0wNS0yNCAxODozMjozNCArMDQwMAorKysgY3lydXMtaW1h
cGQtMi4yLjEyL2xpYi9oYXNoLmMJMjAwNS0xMi0wOCAxOTozODo1MyArMDMwMApAQCAtMzE3LDYg
KzMxNywzOSBAQAogICAgICAgfQogfQogCisvKiBTYW1lIGFzIGhhc2hfZW51bWVyYXRlKCkgYnV0
IGhhcyBhYmlsaXR5IHRvIGRlbGV0ZSBrZXlzIHdoaWxlIGdvaW5nCisgICB0aHJvdWdoIGEgaGFz
aCB0YWJsZS4gUmV0dXJuIG5vbi16ZXJvIHZhbHVlIGZyb20gdGhlIGNhbGxiYWNrCisgICBmdW5j
dGlvbiBpZiB5b3Ugd2FudCB0byBkZWxldGUgYSBrZXkuIERlbGV0ZSBhbnkgZXh0ZXJuYWwgZGF0
YQorICAgeW91cnNlbGYuICovCit2b2lkIGhhc2hfd2FsayhoYXNoX3RhYmxlICp0YWJsZSwgaW50
ICgqZnVuYykoY2hhciAqLCB2b2lkICosIHZvaWQgKiksCisJCSAgICB2b2lkICpyb2NrKQorewor
ICAgIHVuc2lnbmVkIGk7CisgICAgYnVja2V0ICp0ZW1wLCAqdGVtcF9vbGQsICp0ZW1wX25leHQ7
CisKKyAgICBmb3IgKGk9MDtpPHRhYmxlLT5zaXplOyBpKyspIHsKKwlpZiAoKHRhYmxlLT50YWJs
ZSlbaV0gIT0gTlVMTCkgeworCSAgICBmb3IgKHRlbXAgPSAodGFibGUtPnRhYmxlKVtpXSwgdGVt
cF9vbGQ9TlVMTDsKKwkJIE5VTEwgIT0gdGVtcDsKKwkJIHRlbXAgPSB0ZW1wX25leHQpIHsKKwor
CQl0ZW1wX25leHQgPSB0ZW1wLT5uZXh0OworCQlpZihmdW5jKHRlbXAgLT4ga2V5LCB0ZW1wLT5k
YXRhLCByb2NrKSkgeworCQkgICAgaWYodGVtcF9vbGQpCisJCQl0ZW1wX29sZC0+bmV4dCA9IHRl
bXBfbmV4dDsKKwkJICAgIGVsc2UKKwkJCSh0YWJsZS0+dGFibGUpW2ldID0gdGVtcF9uZXh0Owor
CQkgICAgaWYoIXRhYmxlLT5wb29sKSB7CisJCQlmcmVlKHRlbXAtPmtleSk7CisJCQlmcmVlKHRl
bXApOworCQkgICAgfQorCQl9CisJCWVsc2UKKwkJICAgIHRlbXBfb2xkPXRlbXA7CisJICAgIH0K
Kwl9CisgICAgfQorfQogCiAjaWZkZWYgVEVTVAogCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIu
MTIub2xkL2xpYi9oYXNoLmggY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9oYXNoLmgKLS0tIGN5cnVz
LWltYXBkLTIuMi4xMi5vbGQvbGliL2hhc2guaAkyMDAzLTEwLTIyIDIyOjUwOjEyICswNDAwCisr
KyBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2hhc2guaAkyMDA1LTEyLTA4IDE5OjM4OjUzICswMzAw
CkBAIC03OCw2ICs3OCwxMyBAQAogdm9pZCBoYXNoX2VudW1lcmF0ZShoYXNoX3RhYmxlICp0YWJs
ZSx2b2lkICgqZnVuYykoY2hhciAqLHZvaWQgKix2b2lkICopLAogCQkgICAgdm9pZCAqcm9jayk7
CiAKKy8qIFNhbWUgYXMgaGFzaF9lbnVtZXJhdGUoKSBidXQgaGFzIGFiaWxpdHkgdG8gZGVsZXRl
IGtleXMgd2hpbGUgZ29pbmcKKyAgIHRocm91Z2ggYSBoYXNoIHRhYmxlLiBSZXR1cm4gbm9uLXpl
cm8gdmFsdWUgZnJvbSB0aGUgY2FsbGJhY2sKKyAgIGZ1bmN0aW9uIGlmIHlvdSB3YW50IHRvIGRl
bGV0ZSBhIGtleS4gRGVsZXRlIGFueSBleHRlcm5hbCBkYXRhCisgICB5b3Vyc2VsZi4gKi8KK3Zv
aWQgaGFzaF93YWxrKGhhc2hfdGFibGUgKnRhYmxlLCBpbnQgKCpmdW5jKShjaGFyICosIHZvaWQg
Kiwgdm9pZCAqKSwKKwkgICAgICAgdm9pZCAqcm9jayk7CisKIC8qCiAqKiBGcmVlcyBhIGhhc2gg
dGFibGUuICBGb3IgZWFjaCBub2RlIHRoYXQgd2FzIGluc2VydGVkIGluIHRoZSB0YWJsZSwKICoq
IGl0IGNhbGxzIHRoZSBmdW5jdGlvbiB3aG9zZSBhZGRyZXNzIGl0IHdhcyBwYXNzZWQsIHdpdGgg
YSBwb2ludGVyCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2xpYi9pbWFwb3B0aW9u
cyBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2ltYXBvcHRpb25zCi0tLSBjeXJ1cy1pbWFwZC0yLjIu
MTIub2xkL2xpYi9pbWFwb3B0aW9ucwkyMDA1LTEyLTA4IDE2OjU4OjQ4ICswMzAwCisrKyBjeXJ1
cy1pbWFwZC0yLjIuMTIvbGliL2ltYXBvcHRpb25zCTIwMDUtMTItMDggMTk6Mzg6NTMgKzAzMDAK
QEAgLTkxMCw2ICs5MTAsNTkgQEAKICAgIGludGVyZmFjZSwgb3RoZXJ3aXNlIHRoZSB1c2VyIGlz
IGFzc3VtZWQgdG8gYmUgaW4gdGhlIGRlZmF1bHQKICAgIGRvbWFpbiAoaWYgc2V0KS4gKi8KIAor
eyAiY29udmVydHVzZXJpZCIsIDAsIFNXSVRDSCB9CisvKiBFbmFibGUgdXNlciBpZGVudGlmaWVy
cyBjb252ZXJzaW9uIHZpYSBMREFQLiBUaGlzIGlzIGEgZGVmYXVsdAorICAgcnVsZTogaXQgaXMg
cG9zc2libGUgdG8gc2V0IGV4ZW1wdGlvbnMgb24gc29tZSBzZXQgb2YgdXNlcnMgdmlhCisgICBj
b252ZXJ0dXNlcmlkX2V4ZW1wdHMgY29uZmlnIHZhcmlhYmxlLiBJZiB1c2VyJ3MgcnVsZSBpcyAn
Y29udmVydCcKKyAgIHRoZW4gaGUgZG9lc24ndCBzZWUgdXNlciBpZGVudGlmaWVycyB2aWEgSU1B
UCBjb21tYW5kcy4gSW5zdGVhZCwKKyAgIG5hbWVzIGdvdCBmcm9tIExEQVAgYXJlIHNob3dlZC4g
VGhpcyBvcHRpb24gaXMgcmVyZWFkZWQgb24gZWFjaAorICAgbmV3IGNvbm5lY3RlZCBJTUFQIGNs
aWVudCwgc28geW91IGRvbid0IG5lZWQgdG8gcmVzdGFydCB0aGUgc2VydmVyCisgICB0byBhcHBs
eSBjaGFuZ2VzLiAqLworCit7ICJjb252ZXJ0dXNlcmlkX2V4ZW1wdHMiLCBOVUxMLCBTVFJJTkcg
fQorLyogRXhlbXRpb25zIChsaXN0IG9mIHVzZXIgaWRlbnRpZmllcnMpIGZyb20gY29udmVydHVz
ZXJpZCBvcHRpb24uCisgICBUaGlzIG9wdGlvbiBpcyByZXJlYWRlZCBvbiBlYWNoIG5ldyBjb25u
ZWN0ZWQgSU1BUCBjbGllbnQuICovCisKK3sgImNvbnZlcnR1c2VyaWRfYWxsb3dfbm9uY29udmVy
dGVkIiwgMCwgU1dJVENIIH0KKy8qIEFsbG93IHRvIHVzZSBvcmlnaW5hbCB1c2VyaWRzIGlmIHRo
ZXJlIGFyZSBubyBpbmZvcm1hdGlvbiBvbgorICAgdGhlbSBpbiBMREFQLiBUaGlzIG9wdGlvbiBp
cyByZXJlYWRlZCBvbiBlYWNoIG5ldyBjb25uZWN0ZWQgSU1BUAorICAgY2xpZW50LiAqLworCit7
ICJjb252ZXJ0dXNlcmlkX2RvbnRpZ25vcmVfZXJyb3JzIiwgMCwgU1dJVENIIH0KKy8qIElmIGVu
YWJsZWQgYW5kIHRoZXJlIGlzIGFuIGVycm9yIHdoaWxlIGZldGNoaW5nIHVzZXJpZCwgb3JpZ2lu
YWwKKyAgIHVzZXJpZHMgd29uJ3QgYmVlbiByZXR1cm5lZCBldmVuIGlmICdjb252ZXJ0dXNlcmlk
X2FsbG93X25vbmNvbnZlcnRlZCcKKyAgIG9wdGlvbiBpcyBlbmFibGVkLiBUaGlzIG9wdGlvbiBp
cyByZXJlYWRlZCBvbiBlYWNoIG5ldyBjb25uZWN0ZWQgSU1BUAorICAgY2xpZW50LiAqLworCit7
ICJjb252ZXJ0dXNlcmlkX2xvY2FsaG9zdCIsICIxMjcuMC4wLjEiLCBTVFJJTkcgfQorLyogSVAt
YWRkcmVzcyB3aGljaCBsZGFwZCBwcm9jZXNzZXMgYXJlIGJpbmRpbmcgdG8uIFlvdSB3aWxsIG5l
dmVyCisgICBuZWVkIHRvIGNoYW5nZSB0aGUgZGVmYXVsdCB2YWx1ZS4gKi8KKworeyAiY29udmVy
dHVzZXJpZF91ZHBwb3J0IiwgMTAwMDEsIElOVCB9CisvKiBVRFAgcG9ydCBudW1iZXIgd2hlcmUg
bGRhcGQgcHJvY2Vzc2VzIGFyZSBsaXN0ZW5pbmcgb24uIGxkYXBkIGlzIGEKKyAgIHByb2Nlc3Mg
d2hpY2ggcGVyZm9tcyBxdWVyaWVzIHRvIExEQVAuICovCisKK3sgImNvbnZlcnR1c2VyaWRfbGRh
cF9ob3N0IiwgTlVMTCwgU1RSSU5HIH0KKy8qIExEQVAgc2VydmVyIGhvc3QgdXNlZCBieSBsZGFw
ZC4gKi8KKworeyAiY29udmVydHVzZXJpZF9sZGFwX3BvcnQiLCAzODksIElOVCB9CisvKiBMREFQ
IHNlcnZlciBwb3J0IHVzZWQgYnkgbGRhcGQuICovCisKK3sgImNvbnZlcnR1c2VyaWRfbGRhcF91
c2VyIiwgTlVMTCwgU1RSSU5HIH0KKy8qIExEQVAgdXNlciB1c2VkIGJ5IGxkYXBkLiAqLworCit7
ICJjb252ZXJ0dXNlcmlkX2xkYXBfcGFzc3dvcmQiLCBOVUxMLCBTVFJJTkcgfQorLyogTERBUCB1
c2VyJ3MgcGFzc3dvcmQgdXNlZCBieSBsZGFwZC4gKi8KKworeyAiY29udmVydHVzZXJpZF9sZGFw
X2Jhc2UiLCBOVUxMLCBTVFJJTkcgfQorLyogTERBUCBiYXNlIHVzZWQgYnkgbGRhcGQuICovCisK
K3sgImNvbnZlcnR1c2VyaWRfbGRhcF9hdHRyX2ludCIsICJ1aWQiLCBTVFJJTkcgfQorLyogTmFt
ZSBvZiBMREFQIGF0dHJpYnV0ZSBzdG9yaW5nIGludGVybmFsIG5hbWVzIG9mIHVzZXJzLiAqLwor
Cit7ICJjb252ZXJ0dXNlcmlkX2xkYXBfYXR0cl9leHQiLCAic24iLCBTVFJJTkcgfQorLyogTmFt
ZSBvZiBMREFQIGF0dHJpYnV0ZSBzdG9yaW5nIGV4dGVybmFsIG5hbWVzIG9mIHVzZXJzLiAqLwor
CiAvKgogLlNIIFNFRSBBTFNPCiAuUFAKZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQv
bGliL2xpYmNvbmZpZy5jIGN5cnVzLWltYXBkLTIuMi4xMi9saWIvbGliY29uZmlnLmMKLS0tIGN5
cnVzLWltYXBkLTIuMi4xMi5vbGQvbGliL2xpYmNvbmZpZy5jCTIwMDQtMDUtMjIgMDc6NDU6NTQg
KzA0MDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9saWIvbGliY29uZmlnLmMJMjAwNS0xMi0wOCAx
OTozODo1MyArMDMwMApAQCAtMTYxLDcgKzE2MSwxMCBAQAogICAgIGlmKGFsdF9jb25maWcpIGNv
bmZpZ19maWxlbmFtZSA9IHhzdHJkdXAoYWx0X2NvbmZpZyk7CiAgICAgZWxzZSBjb25maWdfZmls
ZW5hbWUgPSB4c3RyZHVwKENPTkZJR19GSUxFTkFNRSk7CiAKLSAgICBpZighY29uc3RydWN0X2hh
c2hfdGFibGUoJmNvbmZpZ2hhc2gsIENPTkZJR0hBU0hTSVpFLCAxKSkgeworICAgIC8qIHdlIGRv
bid0IHVzZSBtZW1vcnkgcG9vbCBmb3IgdGhpcyBoYXNoIGJlY2F1c2Ugd2UgbWF5IGRlbGV0ZQor
ICAgICAgIGtleXMgZnJvbSBpdCBtYW55IHRpbWVzIChkZWxldGlvbnMgZnJvbSBwb29sZWQgaGFz
aCBsZWFrIHRoZQorICAgICAgIG1lbW9yeSkgKi8KKyAgICBpZighY29uc3RydWN0X2hhc2hfdGFi
bGUoJmNvbmZpZ2hhc2gsIENPTkZJR0hBU0hTSVpFLCAwKSkgewogCWZhdGFsKCJjb3VsZCBub3Qg
Y29uc3RydWN0IGNvbmZpZ3VyYXRpb24gaGFzaCB0YWJsZSIsIEVDX0NPTkZJRyk7CiAgICAgfQog
CkBAIC01MDgsMyArNTExLDQwOSBAQAogICAgIH0KICAgICBmY2xvc2UoaW5maWxlKTsKIH0KKwor
aW50IGNvbmZpZ190ZW1wbGF0ZV9jb21wYXJlKGNvbnN0IGNoYXIgKm9wdG5hbWUsIGludCBvcHRp
ZCwgdGVtcGxhdGVfb3B0aW9uICpvcHRzLCBpbnQgb3B0c19sZW4pCit7CisgICAgaW50IGk7CisK
KyAgICBmb3IoaT0wOyBpPG9wdHNfbGVuOyBpKyspIHsKKwlzd2l0Y2gob3B0c1tpXS50eXBlKSB7
CisJY2FzZSBURU1QTEFURU9QVF9UWVBFX0tOT1dOT1BUOgorCSAgICBpZihvcHRpZD09KGludClv
cHRzW2ldLnZhbCkKKwkJcmV0dXJuIDA7CisJICAgIGJyZWFrOworCWNhc2UgVEVNUExBVEVPUFRf
VFlQRV9FWEFDVE1BVENIOgorCSAgICBpZighc3RyY21wKChjaGFyICopb3B0c1tpXS52YWwsIG9w
dG5hbWUpKQorCQlyZXR1cm4gMDsKKwkgICAgYnJlYWs7CisJY2FzZSBURU1QTEFURU9QVF9UWVBF
X1BSRUZJWDoKKwkgICAgaWYoIXN0cm5jbXAoKGNoYXIgKilvcHRzW2ldLnZhbCwgb3B0bmFtZSwg
c3RybGVuKChjaGFyICopb3B0c1tpXS52YWwpKSkKKwkJcmV0dXJuIDA7CisJICAgIGJyZWFrOwor
CX0KKyAgICB9CisgICAgcmV0dXJuIDE7Cit9CisKK3N0YXRpYyBpbnQgY29uZmlnX3JlcmVhZF9m
aWxlKGNvbnN0IGNoYXIgKmZpbGVuYW1lLCB0ZW1wbGF0ZV9vcHRpb24gKm9wdHMsIGludCBvcHRz
X2xlbikKK3sKKyAgICBlbnVtIG9wdHR5cGUgb3B0ID0gSU1BUE9QVF9aRVJPOworICAgIGludCBs
aW5lbm8gPSAwOworICAgIGNoYXIgYnVmWzQwOTZdLCBlcnJidWZbMTAyNF07CisgICAgY2hhciAq
cCwgKnEsICprZXksICpmdWxsa2V5LCAqc3J2a2V5LCAqdmFsLCAqbmV3dmFsOworICAgIGludCBz
ZXJ2aWNlX3NwZWNpZmljOworICAgIGludCBpZGxlbiA9IChjb25maWdfaWRlbnQgPyBzdHJsZW4o
Y29uZmlnX2lkZW50KSA6IDApOworICAgIEZJTEUgKmluZmlsZTsKKworICAgIGlmKCFvcHRzX2xl
bikKKwlyZXR1cm4gMDsKKworICAgIC8qIHJlYWQgaW4gY29uZmlnIGZpbGUgKi8KKyAgICBpbmZp
bGUgPSBmb3BlbihmaWxlbmFtZSwgInIiKTsKKyAgICBpZiAoIWluZmlsZSkgeworCXN0cmxjcHko
YnVmLCBDWVJVU19QQVRILCBzaXplb2YoYnVmKSk7CisJc3RybGNhdChidWYsIGZpbGVuYW1lLCBz
aXplb2YoYnVmKSk7CisJaW5maWxlID0gZm9wZW4oYnVmLCAiciIpOworICAgIH0KKyAgICBpZiAo
IWluZmlsZSkgeworCXN5c2xvZyhMT0dfRVJSLCAiY2FuJ3Qgb3BlbiBjb25maWd1cmF0aW9uIGZp
bGUgJXM6ICVzIixmaWxlbmFtZSwgZXJyb3JfbWVzc2FnZShlcnJubykpOworCXJldHVybiAtMTsK
KyAgICB9CisKKyAgICAvKiBjaGVjayB0byBzZWUgaWYgd2UndmUgYWxyZWFkeSByZWFkIHRoaXMg
ZmlsZSAqLworICAgIGlmIChoYXNoX2xvb2t1cChmaWxlbmFtZSwgJmluY2x1ZGVoYXNoKSkgewor
CXN5c2xvZyhMT0dfRVJSLCAiY29uZmlndXJhdGlvbiBmaWxlICVzIGluY2x1ZGVkIHR3aWNlIiwg
ZmlsZW5hbWUpOworCWZjbG9zZShpbmZpbGUpOworCXJldHVybiAtMTsKKyAgICB9CisgICAgZWxz
ZSB7CisJaGFzaF9pbnNlcnQoZmlsZW5hbWUsICh2b2lkKikgMHhERUFEQkVFRiwgJmluY2x1ZGVo
YXNoKTsKKyAgICB9CisgICAgCisgICAgd2hpbGUgKGZnZXRzKGJ1Ziwgc2l6ZW9mKGJ1ZiksIGlu
ZmlsZSkpIHsKKwlsaW5lbm8rKzsKKworCXNlcnZpY2Vfc3BlY2lmaWMgPSAwOworCQorCWlmIChi
dWZbMF0gJiYgYnVmW3N0cmxlbihidWYpLTFdID09ICdcbicpIGJ1ZltzdHJsZW4oYnVmKS0xXSA9
ICdcMCc7CisJZm9yIChwID0gYnVmOyAqcCAmJiBpc3NwYWNlKChpbnQpICpwKTsgcCsrKTsKKwlp
ZiAoISpwIHx8ICpwID09ICcjJykgY29udGludWU7CisKKwlmdWxsa2V5ID0ga2V5ID0gcDsKKwlp
ZiAoKnAgPT0gJ0AnKSBwKys7ICAvKiBhbGxvdyBAIGFzIHRoZSBmaXJzdCBjaGFyIChmb3IgZGly
ZWN0aXZlcykgKi8KKwl3aGlsZSAoKnAgJiYgKGlzYWxudW0oKGludCkgKnApIHx8ICpwID09ICct
JyB8fCAqcCA9PSAnXycpKSB7CisJICAgIGlmIChpc3VwcGVyKCh1bnNpZ25lZCBjaGFyKSAqcCkp
ICpwID0gdG9sb3dlcigodW5zaWduZWQgY2hhcikgKnApOworCSAgICBwKys7CisJfQorCWlmICgq
cCAhPSAnOicpIHsKKwkgICAgc3lzbG9nKExPR19FUlIsCisJCSAgICJpbnZhbGlkIG9wdGlvbiBu
YW1lIG9uIGxpbmUgJWQgb2YgY29uZmlndXJhdGlvbiBmaWxlICVzIiwKKwkJICAgIGxpbmVubywg
ZmlsZW5hbWUpOworCSAgICBmY2xvc2UoaW5maWxlKTsKKwkgICAgcmV0dXJuIC0xOworCX0KKwkq
cCsrID0gJ1wwJzsKKwkKKwl3aGlsZSAoKnAgJiYgaXNzcGFjZSgoaW50KSAqcCkpIHArKzsKKwkK
KwkvKiByZW1vdmUgdHJhaWxpbmcgd2hpdGVzcGFjZSAqLworCWZvciAocSA9IHAgKyBzdHJsZW4o
cCkgLSAxOyBxID4gcCAmJiBpc3NwYWNlKChpbnQpICpxKTsgcS0tKSB7CisJICAgICpxID0gJ1ww
JzsKKwl9CisJCisJaWYgKCEqcCkgeworCSAgICBzeXNsb2coTE9HX0VSUiwKKwkJICAgImVtcHR5
IG9wdGlvbiB2YWx1ZSBvbiBsaW5lICVkIG9mIGNvbmZpZ3VyYXRpb24gZmlsZSIsCisJCSAgIGxp
bmVubyk7CisJICAgIGZjbG9zZShpbmZpbGUpOworCSAgICByZXR1cm4gLTE7CisJfQorCQorCXNy
dmtleSA9IE5VTEw7CisKKwkvKiBMb29rIGZvciBkaXJlY3RpdmVzICovCisJaWYgKGtleVswXSA9
PSAnQCcpIHsKKwkgICAgaWYgKCFzdHJjYXNlY21wKGtleSwgIkBpbmNsdWRlIikpIHsKKwkJaWYo
Y29uZmlnX3JlcmVhZF9maWxlKHAsb3B0cyxvcHRzX2xlbikpIHsKKwkJICAgIGZjbG9zZShpbmZp
bGUpOworCQkgICAgcmV0dXJuIC0xOworCQl9CisJCWNvbnRpbnVlOworCSAgICB9CisJICAgIGVs
c2UgeworCQlzeXNsb2coTE9HX0VSUiwKKwkJICAgICAgICJpbnZhbGlkIGRpcmVjdGl2ZSBvbiBs
aW5lICVkIG9mIGNvbmZpZ3VyYXRpb24gZmlsZSAlcyIsCisJCSAgICAgICBsaW5lbm8sIGZpbGVu
YW1lKTsKKwkJZmNsb3NlKGluZmlsZSk7CisJCXJldHVybiAtMTsKKwkgICAgfQorCX0KKworCS8q
IEZpbmQgaWYgdGhlcmUgaXMgYSA8c2VydmljZT5fIHByZWZpeCAqLworCWlmKGNvbmZpZ19pZGVu
dCAmJiAhc3RybmNhc2VjbXAoa2V5LCBjb25maWdfaWRlbnQsIGlkbGVuKSAKKwkgICAmJiBrZXlb
aWRsZW5dID09ICdfJykgeworCSAgICAvKiBza2lwIHNlcnZpY2VfIHByZWZpeCAqLworCSAgICBz
cnZrZXkgPSBrZXkgKyBpZGxlbiArIDE7CisJfQorCQorCS8qIGxvb2sgZm9yIGEgc2VydmljZV8g
cHJlZml4IG1hdGNoIGluIGltYXBvcHRzICovCisJaWYoc3J2a2V5KSB7CisJICAgIGZvciAob3B0
ID0gSU1BUE9QVF9aRVJPOyBvcHQgPCBJTUFQT1BUX0xBU1Q7IG9wdCsrKSB7CisJCWlmICghc3Ry
Y2FzZWNtcChpbWFwb3B0c1tvcHRdLm9wdG5hbWUsIHNydmtleSkpIHsKKwkJICAgIGtleSA9IHNy
dmtleTsKKwkJICAgIHNlcnZpY2Vfc3BlY2lmaWMgPSAxOworCQkgICAgYnJlYWs7CisJCX0KKwkg
ICAgfQorCX0KKwkKKwkvKiBEaWQgbm90IGZpbmQgYSBzZXJ2aWNlXyBzcGVjaWZpYyBtYXRjaCwg
dHJ5IGxvb2tpbmcgZm9yIGFuCisJICogZXhhY3QgbWF0Y2ggKi8KKwlpZighc2VydmljZV9zcGVj
aWZpYykgeworCSAgICBmb3IgKG9wdCA9IElNQVBPUFRfWkVSTzsgb3B0IDwgSU1BUE9QVF9MQVNU
OyBvcHQrKykgeworCQlpZiAoIXN0cmNhc2VjbXAoaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBrZXkp
KSB7CisJCSAgICBicmVhazsKKwkJfQorCSAgICB9CisJfQorCisJLyogSWYgYm90aCBvZiB0aG9z
ZSBsb29wcyBmYWlsZWQsIGl0IGdvZXMgdmVyYmF0aW0gaW50byB0aGUKKwkgKiBvdmVyZmxvdyBo
YXNoIHRhYmxlLiAqLworCQorCWlmIChvcHQgPCBJTUFQT1BUX0xBU1QpIHsKKwkgICAgLyogc2tp
cCBhbGwgb3B0aW9ucyBleGNlcHQgdGhvc2UgbWFjaGVkIHRlbXBsYXRlICovCisJICAgIGlmKGNv
bmZpZ190ZW1wbGF0ZV9jb21wYXJlKGltYXBvcHRzW29wdF0ub3B0bmFtZSxvcHQsb3B0cyxvcHRz
X2xlbikpCisJCWNvbnRpbnVlOworCisJICAgIC8qIE9rYXksIHdlIGtub3cgYWJvdXQgdGhpcyBj
b25maWd1cmUgb3B0aW9uLgorCSAgICAgKiBTbyBmaXJzdCBjaGVjayB0aGF0IHdlIGhhdmUgZWl0
aGVyCisJICAgICAqICAxLiBub3Qgc2VlbiBpdAorCSAgICAgKiAgMi4gc2VlbiBpdHMgZ2VuZXJp
YyBmb3JtLCBidXQgdGhpcyBpcyBhIHNlcnZpY2Ugc3BlY2lmaWMgZm9ybQorCSAgICAgKgorCSAg
ICAgKiAgSWYgd2UgaGF2ZSBhbHJlYWR5IHNlZW4gYSBzZXJ2aWNlLXNwZWNpZmljIGZvcm0sIGFu
ZCB0aGlzIGlzCisJICAgICAqICBhIGdlbmVyaWMgZm9ybSwganVzdCBza2lwIGl0IGFuZCBkb24n
dCBtb2FuLgorCSAgICAgKi8KKwkgICAgaWYoKGltYXBvcHRzW29wdF0uc2VlbiA9PSAxICYmICFz
ZXJ2aWNlX3NwZWNpZmljKSAKKwkgICAgIHx8KGltYXBvcHRzW29wdF0uc2VlbiA9PSAyICYmIHNl
cnZpY2Vfc3BlY2lmaWMpKSB7CisJCXN5c2xvZyhMT0dfRVJSLAorCQkgICAgICAgIm9wdGlvbiAn
JXMnIHdhcyBzcGVjaWZpZWQgdHdpY2UgaW4gY29uZmlnIGZpbGUgKHNlY29uZCBvY2N1cmFuY2Ug
b24gbGluZSAlZCkiLAorCQkgICAgICAgZnVsbGtleSwgbGluZW5vKTsKKwkJZmNsb3NlKGluZmls
ZSk7CisJCXJldHVybiAtMTsKKwkgICAgfSBlbHNlIGlmKGltYXBvcHRzW29wdF0uc2VlbiA9PSAy
ICYmICFzZXJ2aWNlX3NwZWNpZmljKSB7CisJCWNvbnRpbnVlOworCSAgICB9CisKKwkgICAgLyog
SWYgd2UndmUgc2VlbiBpdCBhbHJlYWR5LCB3ZSdyZSByZXBsYWNpbmcgaXQsIHNvIHdlIG5lZWQK
KwkgICAgICogdG8gZnJlZSB0aGUgY3VycmVudCBzdHJpbmcgaWYgdGhlcmUgaXMgb25lICovCisJ
ICAgIGlmKGltYXBvcHRzW29wdF0uc2VlbiAmJiBpbWFwb3B0c1tvcHRdLnQgPT0gT1BUX1NUUklO
RykKKwkJZnJlZSgoY2hhciAqKWltYXBvcHRzW29wdF0udmFsLnMpOworCisgICAgICAgICAgICBp
ZihzZXJ2aWNlX3NwZWNpZmljKQorCQlpbWFwb3B0c1tvcHRdLnNlZW4gPSAyOworCSAgICBlbHNl
CisJCWltYXBvcHRzW29wdF0uc2VlbiA9IDE7CisJICAgIAorCSAgICAvKiB0aGlzIGlzIGEga25v
d24gb3B0aW9uICovCisJICAgIHN3aXRjaCAoaW1hcG9wdHNbb3B0XS50KSB7CisJICAgIGNhc2Ug
T1BUX1NUUklORzogCisJICAgIHsJCSAgICAKKwkJaW1hcG9wdHNbb3B0XS52YWwucyA9IHhzdHJk
dXAocCk7CisKKwkJaWYob3B0ID09IElNQVBPUFRfQ09ORklHRElSRUNUT1JZKQorCQkgICAgY29u
ZmlnX2RpciA9IGltYXBvcHRzW29wdF0udmFsLnM7CisKKwkJYnJlYWs7CisJICAgIH0KKwkgICAg
Y2FzZSBPUFRfSU5UOgorCSAgICB7CisJCWxvbmcgdmFsOworCQljaGFyICpwdHI7CisJCQorCQl2
YWwgPSBzdHJ0b2wocCwgJnB0ciwgMCk7CisJCWlmICghcHRyIHx8ICpwdHIgIT0gJ1wwJykgewor
CQkgICAgLyogZXJyb3IgZHVyaW5nIGNvbnZlcnNpb24gKi8KKwkJICAgIHN5c2xvZyhMT0dfRVJS
LAorCQkJICAgIm5vbi1pbnRlZ2VyIHZhbHVlIGZvciAlcyBpbiBsaW5lICVkIiwKKwkJCSAgIGlt
YXBvcHRzW29wdF0ub3B0bmFtZSwgbGluZW5vKTsKKwkJICAgIGZjbG9zZShpbmZpbGUpOworCQkg
ICAgcmV0dXJuIC0xOworCQl9CisKKwkJaW1hcG9wdHNbb3B0XS52YWwuaSA9IHZhbDsKKwkJYnJl
YWs7CisJICAgIH0KKwkgICAgY2FzZSBPUFRfU1dJVENIOgorCSAgICB7CisJCWlmICgqcCA9PSAn
MCcgfHwgKnAgPT0gJ24nIHx8CisJCSAgICAoKnAgPT0gJ28nICYmIHBbMV0gPT0gJ2YnKSB8fCAq
cCA9PSAnZicpIHsKKwkJICAgIGltYXBvcHRzW29wdF0udmFsLmIgPSAwOworCQl9CisJCWVsc2Ug
aWYgKCpwID09ICcxJyB8fCAqcCA9PSAneScgfHwKKwkJCSAoKnAgPT0gJ28nICYmIHBbMV0gPT0g
J24nKSB8fCAqcCA9PSAndCcpIHsKKwkJICAgIGltYXBvcHRzW29wdF0udmFsLmIgPSAxOworCQl9
CisJCWVsc2UgeworCQkgICAgLyogZXJyb3IgZHVyaW5nIGNvbnZlcnNpb24gKi8KKwkJICAgIHN5
c2xvZyhMT0dfRVJSLAorCQkJICAgIm5vbi1zd2l0Y2ggdmFsdWUgZm9yICVzIGluIGxpbmUgJWQi
LAorCQkJICAgaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBsaW5lbm8pOworCQkgICAgZmNsb3NlKGlu
ZmlsZSk7CisJCSAgICByZXR1cm4gLTE7CisJCX0KKwkJYnJlYWs7CisJICAgIH0KKwkgICAgY2Fz
ZSBPUFRfRU5VTToKKwkgICAgY2FzZSBPUFRfU1RSSU5HTElTVDoKKwkgICAgeworCQljb25zdCBz
dHJ1Y3QgZW51bV9vcHRpb25fcyAqZSA9IGltYXBvcHRzW29wdF0uZW51bV9vcHRpb25zOworCisJ
CWlmIChpbWFwb3B0c1tvcHRdLnQgPT0gT1BUX0VOVU0pIHsKKwkJICAgIC8qIG5vcm1hbGl6ZSBv
bi9vZmYgdmFsdWVzICovCisJCSAgICBpZiAoIXN0cmNtcChwLCAiMSIpIHx8ICFzdHJjbXAocCwg
InllcyIpIHx8CisJCQkhc3RyY21wKHAsICJ0IikgfHwgIXN0cmNtcChwLCAidHJ1ZSIpKSB7CisJ
CQlwID0gIm9uIjsKKwkJICAgIH0gZWxzZSBpZiAoIXN0cmNtcChwLCAiMCIpIHx8ICFzdHJjbXAo
cCwgIm5vIikgfHwKKwkJCSAgICAgICAhc3RyY21wKHAsICJmIikgfHwgIXN0cmNtcChwLCAiZmFs
c2UiKSkgeworCQkJcCA9ICJvZmYiOworCQkgICAgfQorCQl9CisKKwkJd2hpbGUgKGUtPm5hbWUp
IHsKKwkJICAgIGlmICghc3RyY21wKGUtPm5hbWUsIHApKSBicmVhazsKKwkJICAgIGUrKzsKKwkJ
fQorCQlpZiAoZS0+bmFtZSkgeworCQkgICAgaWYgKGltYXBvcHRzW29wdF0udCA9PSBPUFRfRU5V
TSkKKwkJCWltYXBvcHRzW29wdF0udmFsLmUgPSBlLT52YWw7CisJCSAgICBlbHNlCisJCQlpbWFw
b3B0c1tvcHRdLnZhbC5zID0gZS0+bmFtZTsKKwkJfSBlbHNlIHsKKwkJICAgIC8qIGVycm9yIGR1
cmluZyBjb252ZXJzaW9uICovCisJCSAgICBzeXNsb2coTE9HX0VSUiwKKwkJCSAgICJpbnZhbGlk
IHZhbHVlIGZvciAlcyBpbiBsaW5lICVkIiwKKwkJCSAgIGltYXBvcHRzW29wdF0ub3B0bmFtZSwg
bGluZW5vKTsKKwkJICAgIGZjbG9zZShpbmZpbGUpOworCQkgICAgcmV0dXJuIC0xOworCQl9CisJ
CWJyZWFrOworCSAgICB9CisJICAgIGNhc2UgT1BUX05PVE9QVDoKKwkgICAgZGVmYXVsdDoKKwkJ
YWJvcnQoKTsKKwkgICAgfQorCX0gZWxzZSB7CisJICAgIC8qIGNoZWNrIHRvIG1ha2Ugc3VyZSBp
dCdzIHZhbGlkIGZvciBvdmVyZmxvdyAqLworCSAgICAvKiB0aGF0IGlzLCBwYXJ0aXRpb24gbmFt
ZXMgYW5kIGFueXRoaW5nIHRoYXQgbWlnaHQgYmUKKwkgICAgICogdXNlZCBieSBTQVNMICovCisv
KgorICB4eHggdGhpcyB3b3VsZCBiZSBuaWNlIGlmIGl0IHdhc24ndCBmb3Igb3RoZXIgc2Vydmlj
ZXMgd2hvIG1pZ2h0IGJlCisgICAgICBzaGFyaW5nIHRoaXMgY29uZmlnIGZpbGUgYW5kIHdob3Nl
IG5hbWVzIHdlIGNhbm5vdCBwcmVkaWN0CisKKwkgICAgaWYoc3RybmNhc2VjbXAoa2V5LCJzYXNs
XyIsNSkKKwkgICAgJiYgc3RybmNhc2VjbXAoa2V5LCJwYXJ0aXRpb24tIiwxMCkpIHsKKwkJc3By
aW50ZihlcnJidWYsCisJCQkib3B0aW9uICclcycgaXMgdW5rbm93biBvbiBsaW5lICVkIG9mIGNv
bmZpZyBmaWxlIiwKKwkJCWZ1bGxrZXksIGxpbmVubyk7CisJCWZhdGFsKGVycmJ1ZiwgRUNfQ09O
RklHKTsKKwkgICAgfQorKi8KKworCSAgICAvKiBza2lwIGFsbCBvcHRpb25zIGV4Y2VwdCB0aG9z
ZSBtYWNoZWQgdGVtcGxhdGUgKi8KKwkgICAgaWYoY29uZmlnX3RlbXBsYXRlX2NvbXBhcmUoa2V5
LDAsb3B0cyxvcHRzX2xlbikpCisJCWNvbnRpbnVlOworCisJICAgIC8qIFB1dCBpdCBpbiB0aGUg
b3ZlcmZsb3cgaGFzaCB0YWJsZSAqLworCSAgICBuZXd2YWwgPSB4c3RyZHVwKHApOworCSAgICB2
YWwgPSBoYXNoX2luc2VydChrZXksIG5ld3ZhbCwgJmNvbmZpZ2hhc2gpOworCSAgICBpZih2YWwg
IT0gbmV3dmFsKSB7CisJCXN5c2xvZyhMT0dfRVJSLAorCQkgICAgICAgIm9wdGlvbiAnJXMnIHdh
cyBzcGVjaWZpZWQgdHdpY2UgaW4gY29uZmlnIGZpbGUgKHNlY29uZCBvY2N1cmFuY2Ugb24gbGlu
ZSAlZCkiLAorCQkgICAgICAgZnVsbGtleSwgbGluZW5vKTsKKwkJZmNsb3NlKGluZmlsZSk7CisJ
CXJldHVybiAtMTsKKwkgICAgfQorCX0KKyAgICB9CisgICAgZmNsb3NlKGluZmlsZSk7CisgICAg
cmV0dXJuIDA7Cit9CisKK3R5cGVkZWYgc3RydWN0IF9jb25maWdfZGVsZXRlX2NiX3BhcmFtIHsK
KyAgICB0ZW1wbGF0ZV9vcHRpb24gKm9wdHM7CisgICAgaW50IG9wdHNfbGVuOworfSBjb25maWdf
ZGVsZXRlX2NiX3BhcmFtOworCitpbnQgY29uZmlnX2RlbGV0ZV9jYihjaGFyICprZXksIHZvaWQg
KmRhdGEsIHZvaWQgKnBhcmFtKQoreworICAgIGlmKCFjb25maWdfdGVtcGxhdGVfY29tcGFyZSgK
KwkgICAoY2hhciAqKWtleSwgMCwKKwkgICAoKGNvbmZpZ19kZWxldGVfY2JfcGFyYW0gKilwYXJh
bSktPm9wdHMsCisJICAgKChjb25maWdfZGVsZXRlX2NiX3BhcmFtICopcGFyYW0pLT5vcHRzX2xl
bikpIHsKKwlmcmVlKGRhdGEpOworCXJldHVybiAtMTsKKyAgICB9CisgICAgcmV0dXJuIDA7Cit9
CisKK2V4dGVybiBpbnQgY29uZmlnX3JlcmVhZCh0ZW1wbGF0ZV9vcHRpb24gKm9wdHMsIGludCBv
cHRzX2xlbikKK3sKKyAgICBlbnVtIG9wdHR5cGUgb3B0ID0gSU1BUE9QVF9aRVJPOworICAgIGNv
bmZpZ19kZWxldGVfY2JfcGFyYW0gcGFyYW07CisgICAgaW50IGN1cl90ZW1wbDsKKyAgICBpbnQg
cmVzOworCisgICAgaWYoIW9wdHNfbGVuKQorCXJldHVybiAwOworCisgICAgLyogcmVtb3ZlIG9w
dGlvbnMgdGhhdCBtYWNoZWQgdGVtcGxhdGUgKi8KKyAgICBmb3IgKG9wdCA9IElNQVBPUFRfWkVS
Tzsgb3B0IDwgSU1BUE9QVF9MQVNUOyBvcHQrKykgeworCWlmKGltYXBvcHRzW29wdF0uc2Vlbikg
eworCSAgICAvKiBqdXN0IHNldCBkZWZhdWx0IHZhbHVlcyBmb3Iga25vd24gb3B0aW9ucyAqLwor
CSAgICBpZighY29uZmlnX3RlbXBsYXRlX2NvbXBhcmUoaW1hcG9wdHNbb3B0XS5vcHRuYW1lLG9w
dCxvcHRzLG9wdHNfbGVuKSkgeworCQlpZihpbWFwb3B0c1tvcHRdLnQgPT0gT1BUX1NUUklORykK
KwkJICAgIGZyZWUoKGNoYXIgKilpbWFwb3B0c1tvcHRdLnZhbC5zKTsKKwkJaW1hcG9wdHNbb3B0
XS52YWwgPSBpbWFwb3B0c1tvcHRdLmRlZjsKKwkJaW1hcG9wdHNbb3B0XS5zZWVuID0gMDsKKwkg
ICAgfQorCX0KKyAgICB9CisKKyAgICAvKiBjaGVjayBpZiB3ZSBuZWVkIHRvIHdhbGsgdGhyb3Vn
aCBhbGwgaGFzaGVkIG9wdGlvbnMgb3Igd2UganVzdAorICAgICAgIG5lZWQgdG8gZGVsZXRlIE4g
aGFzaGVkIG9wdGlvbnMgKi8KKyAgICBmb3IoY3VyX3RlbXBsPTA7IGN1cl90ZW1wbDxvcHRzX2xl
bjsgY3VyX3RlbXBsKyspIHsKKwlpZihvcHRzW2N1cl90ZW1wbF0udHlwZT09VEVNUExBVEVPUFRf
VFlQRV9QUkVGSVgpCisJICAgIGJyZWFrOworCWVsc2UgaWYob3B0c1tjdXJfdGVtcGxdLnR5cGU9
PVRFTVBMQVRFT1BUX1RZUEVfRVhBQ1RNQVRDSCkgeworCSAgICB2b2lkICpkYXRhOworCSAgICAK
KwkgICAgLyogdHJ5IHRvIGRlbGV0ZSBleGFjdCBtYXRjaCBvcHRpb24gKGlmIGl0IGV4aXN0cywg
aXQgd2lsbAorCSAgICAgICBiZSBkZWxldGVkKSAqLworCSAgICBpZigoZGF0YT1oYXNoX2RlbCgo
Y2hhciAqKW9wdHNbY3VyX3RlbXBsXS52YWwsICZjb25maWdoYXNoKSkpCisJCWZyZWUoZGF0YSk7
CisJfQorICAgIH0KKworICAgIC8qIGlmIHdlJ3ZlIGZvdW5kIGEgcHJlZml4IChub24tZXhhY3Qp
IHRlbXBsYXRlIHRoYW4gd2FsayB0aHJvdWdoCisgICAgICAgYWxsIGhhc2hlZCBvcHRpb25zICov
CisgICAgaWYoY3VyX3RlbXBsPG9wdHNfbGVuKSB7CisJcGFyYW0ub3B0cz1vcHRzOworCXBhcmFt
Lm9wdHNfbGVuPW9wdHNfbGVuOworCisJaGFzaF93YWxrKCZjb25maWdoYXNoLCBjb25maWdfZGVs
ZXRlX2NiLCAmcGFyYW0pOworICAgIH0KKworICAgIC8qIG5vdyBjYWxsIGNvbmZpZ19yZXJlYWRf
ZmlsZSgpIGFzIGluIGNvbmZpZ19yZWFkKCkgKi8KKyAgICBpZighY29uc3RydWN0X2hhc2hfdGFi
bGUoJmluY2x1ZGVoYXNoLCBJTkNMVURFSEFTSFNJWkUsIDEpKSB7CisJZmF0YWwoImNvdWxkIG5v
dCBjb25zdHJ1Y3QgaW5jbHVkZSBmaWxlICBoYXNoIHRhYmxlIiwgRUNfQ09ORklHKTsKKyAgICB9
CisKKyAgICByZXM9Y29uZmlnX3JlcmVhZF9maWxlKGNvbmZpZ19maWxlbmFtZSwgb3B0cywgb3B0
c19sZW4pOworCisgICAgZnJlZV9oYXNoX3RhYmxlKCZpbmNsdWRlaGFzaCwgTlVMTCk7CisKKyAg
ICBpZihyZXMpCisJcmV0dXJuIHJlczsKKworICAgIC8qIE5vdGUgaWYgd2UgZG9uJ3QgY2hhbmdl
IHZhcmlhYmxlcyBiZWxvdyB0aGVuIHRoYXkgY2FuIHBvaW50IHRvCisgICAgICAgZnJlZWQgbWVt
b3J5LiBUT0RPOiByaWdodCB3b3JrIHdpdGggSU1BUE9QVF9ERUZBVUxUUEFSVElUSU9OCisgICAg
ICAgb3B0aW9uIGFuZCB3aXRoIG90aGVyIHBhcnRpdGlvbnMgcGF0aGVzIGlzIG5lZWRlZC4gKi8K
KworICAgIC8qIGxvb2sgdXAgbWFpbGJveCBoYXNoaW5nICovCisgICAgY29uZmlnX2hhc2hpbWFw
c3Bvb2wgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfSEFTSElNQVBTUE9PTCk7CisKKyAgICAv
KiBhcmUgd2Ugc3VwcG9ydGluZyB2aXJ0dWFsIGRvbWFpbnM/ICAqLworICAgIGNvbmZpZ192aXJ0
ZG9tYWlucyA9IGNvbmZpZ19nZXRlbnVtKElNQVBPUFRfVklSVERPTUFJTlMpOworICAgIGNvbmZp
Z19kZWZkb21haW4gPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfREVGQVVMVERPTUFJTik7CisK
KyAgICAvKiBsb29rIHVwIHRoZSBob3N0bmFtZSB3ZSBzaG91bGQgcHJlc2VudCB0byB0aGUgdXNl
ciAqLworICAgIGNvbmZpZ19zZXJ2ZXJuYW1lID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1NF
UlZFUk5BTUUpOworICAgIGlmICghY29uZmlnX3NlcnZlcm5hbWUpIHsKKwljb25maWdfc2VydmVy
bmFtZSA9IHhtYWxsb2Moc2l6ZW9mKGNoYXIpICogMjU2KTsKKwlnZXRob3N0bmFtZSgoY2hhciAq
KSBjb25maWdfc2VydmVybmFtZSwgMjU2KTsKKyAgICB9CisKKyAgICBjb25maWdfbXVwZGF0ZV9z
ZXJ2ZXIgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfTVVQREFURV9TRVJWRVIpOworCisgICAg
cmV0dXJuIDA7Cit9CmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2xpYi9saWJjb25m
aWcuaCBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2xpYmNvbmZpZy5oCi0tLSBjeXJ1cy1pbWFwZC0y
LjIuMTIub2xkL2xpYi9saWJjb25maWcuaAkyMDAzLTEyLTI5IDIzOjIyOjU1ICswMzAwCisrKyBj
eXJ1cy1pbWFwZC0yLjIuMTIvbGliL2xpYmNvbmZpZy5oCTIwMDUtMTItMDggMTk6Mzg6NTMgKzAz
MDAKQEAgLTQ2LDkgKzQ2LDIwIEBACiAjaW5jbHVkZSAiZXhpdGNvZGVzLmgiCiAjaW5jbHVkZSAi
aW1hcG9wdHMuaCIKIAorLyogdHlwZXMgZm9yIHN0cnVjdHVyZSB0ZW1wbGF0ZV9vcHRpb24gKi8K
KyNkZWZpbmUgVEVNUExBVEVPUFRfVFlQRV9LTk9XTk9QVCAgIDAKKyNkZWZpbmUgVEVNUExBVEVP
UFRfVFlQRV9FWEFDVE1BVENIIDEKKyNkZWZpbmUgVEVNUExBVEVPUFRfVFlQRV9QUkVGSVggICAg
IDIKKwordHlwZWRlZiBzdHJ1Y3QgX3RlbXBsYXRlX29wdGlvbiB7CisgICAgdm9pZCAqdmFsOwor
ICAgIGludCB0eXBlOworfSB0ZW1wbGF0ZV9vcHRpb247CisKIC8qIHRoZXNlIHdpbGwgYXNzZXJ0
KCkgaWYgdGhleSdyZSBjYWxsZWQgb24gdGhlIHdyb25nIHR5cGUgb2YKICAgIG9wdGlvbiAoaW1h
cG9wdHMuYykgKi8KIGV4dGVybiB2b2lkIGNvbmZpZ19yZWFkKGNvbnN0IGNoYXIgKmFsdF9jb25m
aWcpOworZXh0ZXJuIGludCBjb25maWdfcmVyZWFkKHRlbXBsYXRlX29wdGlvbiAqb3B0cywgaW50
IG9wdHNfbGVuKTsKIGV4dGVybiBjb25zdCBjaGFyICpjb25maWdfZ2V0c3RyaW5nKGVudW0gaW1h
cG9wdCBvcHQpOwogZXh0ZXJuIGludCBjb25maWdfZ2V0aW50KGVudW0gaW1hcG9wdCBvcHQpOwog
ZXh0ZXJuIGludCBjb25maWdfZ2V0c3dpdGNoKGVudW0gaW1hcG9wdCBvcHQpOwpkaWZmIC11ck4g
Y3lydXMtaW1hcGQtMi4yLjEyLm9sZC9tYW4vbGRhcGQuOCBjeXJ1cy1pbWFwZC0yLjIuMTIvbWFu
L2xkYXBkLjgKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbWFuL2xkYXBkLjgJMTk3MC0wMS0w
MSAwMzowMDowMCArMDMwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL21hbi9sZGFwZC44CTIwMDUt
MTItMDggMTk6Mzg6NTQgKzAzMDAKQEAgLTAsMCArMSw0NiBAQAorLlwiIC0qLSBucm9mZiAtKi0K
Ky5USCBMREFQRCA4ICJQcm9qZWN0IEN5cnVzIiBDTVUKKy5TSCBOQU1FCitsZGFwZCBcLSBjb25u
ZWN0b3IgZnJvbSBJTUFQIHNlcnZlciB0byBMREFQCisuU0ggU1lOT1BTSVMKKy5CIGxkYXBkCitb
CisuQiBcLUMKKy5JIGNvbmZpZy1maWxlCitdCitbCisuQiBcLW4KKy5JIG5wcm9jCit8CisuQiBc
LVwtcHJlZm9yaworLkkgbnByb2MKK10KKy5icgorLlNIIERFU0NSSVBUSU9OCisuSSBMZGFwZAor
aXMgYSBwcm9jZXNzIHRoYXQgcGVyZm9ybXMgcXVlcmllcyBmcm9tIElNQVAgc2VydmVyIHRvIExE
QVAgc2VydmVyLgorSXQgYWNjZXB0cyBxdWVyaWVzIHZpYSBVRFAgcHJvdG9jb2wgYW5kIHNlbmRz
IGFuc3dlcnMgdG8gY2FsbGVycy4KK0l0IGNhbiBiZSBpbnZva2VkIGJ5CisuSVIgbWFzdGVyICg4
KQorYnV0IGl0IGlzIHBvc3NpYmxlIHRvIHN0YXJ0IFxmSWxkYXBkXGZSIGluZGVwZW5kZW50bHku
CitJZiB5b3Ugd2FudCB0byBzdGFydCBcZklsZGFwZFxmUiB2aWEgXGZCbWFzdGVyKDgpXGZSLCB5
b3UgaGF2ZSB0bworYWRkIGxhdW5jaCBydWxlIHRvIFNUQVJUIHNlY3Rpb24gb2YKKy5JUiBjeXJ1
cy5jb25mICg1KQorLlBQCisuSSBMZGFwZAorcmVhZHMgaXRzIGNvbmZpZ3VyYXRpb24gb3B0aW9u
cyBvdXQgb2YgdGhlCisuSVIgaW1hcGQuY29uZiAoNSkKK2ZpbGUgdW5sZXNzIHNwZWNpZmllZCBv
dGhlcndpc2UgYnkgXGZCLUNcZlIuCisuU0ggT1BUSU9OUworLlRQCisuQkkgXC1DICIgY29uZmln
LWZpbGUiCitSZWFkIGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBmcm9tIFxmSWNvbmZpZy1maWxlXGZS
LgorLlRQCisuQkkgXC1uICIgbnByb2MiLFwgXC1cLXByZWZvcmsgIiBucHJvYyIKK1RoZSBudW1i
ZXIgb2YgXGZJbGRhcGRcZlIgcHJvY2Vzc2VzIHRvIHdvcmsgc2ltdWx0YW5lb3VzbHkuIFRoZSBk
ZWZhdWx0IGlzIDEuCisuU0ggRklMRVMKKy5UUAorLkIgL2V0Yy9pbWFwZC5jb25mCisuU0ggU0VF
IEFMU08KKy5QUAorXGZCaW1hcGQuY29uZig1KVxmUiwgXGZCbWFzdGVyKDgpXGZSCmRpZmYgLXVy
TiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL21hbi9NYWtlZmlsZS5pbiBjeXJ1cy1pbWFwZC0yLjIu
MTIvbWFuL01ha2VmaWxlLmluCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL21hbi9NYWtlZmls
ZS5pbgkyMDA0LTAzLTMwIDE5OjE4OjQxICswNDAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvbWFu
L01ha2VmaWxlLmluCTIwMDUtMTItMDggMTk6Mzg6NTQgKzAzMDAKQEAgLTYyLDExICs2MiwxMiBA
QAogCSQoc3JjZGlyKS9mdWQuOCAkKHNyY2RpcikvaW1hcGQuOCAkKHNyY2RpcikvcG9wM2QuOCAk
KHNyY2RpcikvcXVvdGEuOCBcCiAJJChzcmNkaXIpL3JlY29uc3RydWN0LjggJChzcmNkaXIpL3Jt
bmV3cy44ICQoc3JjZGlyKS9zeW5jbmV3cy44IFwKIAkkKHNyY2RpcikvbWJwYXRoLjggJChzcmNk
aXIpL3RpbXNpZXZlZC44ICQoc3JjZGlyKS9tYXN0ZXIuOCBcCi0JJChzcmNkaXIpL2xtdHBkLjgg
JChzcmNkaXIpL2lkbGVkLjggJChzcmNkaXIpL2N0bF9tYm94bGlzdC44IFwKLQkkKHNyY2Rpcikv
Y3RsX2RlbGl2ZXIuOCAkKHNyY2RpcikvY3RsX2N5cnVzZGIuOCAkKHNyY2RpcikvaXB1cmdlLjgg
XAotCSQoc3JjZGlyKS90bHNfcHJ1bmUuOCAkKHNyY2Rpcikvc3F1YXR0ZXIuOCAkKHNyY2Rpcikv
Y3Z0X2N5cnVzZGIuOCBcCi0JJChzcmNkaXIpL25vdGlmeWQuOCAkKHNyY2RpcikvY2hrX2N5cnVz
LjggJChzcmNkaXIpL21iZXhhbWluZS44IFwKLQkkKHNyY2Rpcikvbm50cGQuOCAkKHNyY2Rpcikv
ZmV0Y2huZXdzLjggJChzcmNkaXIpL3NtbWFwZC44CisJJChzcmNkaXIpL2xkYXBkLjggJChzcmNk
aXIpL2xtdHBkLjggJChzcmNkaXIpL2lkbGVkLjggXAorCSQoc3JjZGlyKS9jdGxfbWJveGxpc3Qu
OCAkKHNyY2RpcikvY3RsX2RlbGl2ZXIuOCBcCisJJChzcmNkaXIpL2N0bF9jeXJ1c2RiLjggJChz
cmNkaXIpL2lwdXJnZS44ICQoc3JjZGlyKS90bHNfcHJ1bmUuOCBcCisJJChzcmNkaXIpL3NxdWF0
dGVyLjggJChzcmNkaXIpL2N2dF9jeXJ1c2RiLjggJChzcmNkaXIpL25vdGlmeWQuOCBcCisJJChz
cmNkaXIpL2Noa19jeXJ1cy44ICQoc3JjZGlyKS9tYmV4YW1pbmUuOCAkKHNyY2Rpcikvbm50cGQu
OCBcCisJJChzcmNkaXIpL2ZldGNobmV3cy44ICQoc3JjZGlyKS9zbW1hcGQuOAogCiBhbGw6ICQo
TUFOMSkgJChNQU4zKSAkKE1BTjUpICQoTUFOOCkKIApkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4y
LjEyLm9sZC9tYW4vbWFzdGVyLjggY3lydXMtaW1hcGQtMi4yLjEyL21hbi9tYXN0ZXIuOAotLS0g
Y3lydXMtaW1hcGQtMi4yLjEyLm9sZC9tYW4vbWFzdGVyLjgJMjAwNC0xMi0xNyAxOTozMjoyMyAr
MDMwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL21hbi9tYXN0ZXIuOAkyMDA1LTEyLTA4IDE5OjM4
OjU0ICswMzAwCkBAIC0xNTIsNCArMTUyLDUgQEAKIC5TSCBTRUUgQUxTTwogLlBQCiBcZkJjeXJ1
cy5jb25mKDUpXGZSLCBcZkJpbWFwZC5jb25mKDUpXGZSLCBcZkJpbWFwZCg4KVxmUiwKLVxmQnBv
cDNkKDgpXGZSLCBcZkJsbXRwZCg4KVxmUiwgXGZCdGltc2lldmVkKDgpXGZSLCBcZkJpZGxlZCg4
KVxmUgorXGZCcG9wM2QoOClcZlIsIFxmQmxkYXBkKDgpXGZSLCBcZkJsbXRwZCg4KVxmUiwKK1xm
QnRpbXNpZXZlZCg4KVxmUiwgXGZCaWRsZWQoOClcZlIKZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIu
Mi4xMi5vbGQvbWFzdGVyL2NvbmYvY211LWJhY2tlbmQuY29uZiBjeXJ1cy1pbWFwZC0yLjIuMTIv
bWFzdGVyL2NvbmYvY211LWJhY2tlbmQuY29uZgotLS0gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9t
YXN0ZXIvY29uZi9jbXUtYmFja2VuZC5jb25mCTIwMDMtMTAtMjIgMjI6MDM6MTAgKzA0MDAKKysr
IGN5cnVzLWltYXBkLTIuMi4xMi9tYXN0ZXIvY29uZi9jbXUtYmFja2VuZC5jb25mCTIwMDUtMTIt
MDggMTk6Mzg6NTQgKzAzMDAKQEAgLTYsNiArNiw4IEBACiAKICAgcmVjb3ZlcgljbWQ9ImN0bF9j
eXJ1c2RiIC1yIgogICBtdXBkYXRlcHVzaCAgIGNtZD0iY3RsX21ib3hsaXN0IC1tIgorICAjIHRo
aXMgaXMgb25seSBuZWNlc3NhcnkgaWYgdXNpbmcgY29udmVydHVzZXJpZCBleHRlbnNpb24KKyMg
IGxkYXBkCQljbWQ9ImxkYXBkIC1uIDUiCiB9CiAKICMgVU5JWCBzb2NrZXRzIHN0YXJ0IHdpdGgg
YSBzbGFzaCBhbmQgYXJlIHB1dCBpbnRvIC92YXIvaW1hcC9zb2NrZXRzCmRpZmYgLXVyTiBjeXJ1
cy1pbWFwZC0yLjIuMTIub2xkL21hc3Rlci9jb25mL2NtdS1mcm9udGVuZC5jb25mIGN5cnVzLWlt
YXBkLTIuMi4xMi9tYXN0ZXIvY29uZi9jbXUtZnJvbnRlbmQuY29uZgotLS0gY3lydXMtaW1hcGQt
Mi4yLjEyLm9sZC9tYXN0ZXIvY29uZi9jbXUtZnJvbnRlbmQuY29uZgkyMDAzLTEwLTIyIDIyOjAz
OjEwICswNDAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvbWFzdGVyL2NvbmYvY211LWZyb250ZW5k
LmNvbmYJMjAwNS0xMi0wOCAxOTozODo1NCArMDMwMApAQCAtMiw2ICsyLDggQEAKICAgYXV0aAkJ
Y21kPSIvdXNyL2xvY2FsL2Jpbi9rc3J2dGd0IC1sIDM2MDAgaW1hcCBAU0hPUlRIT1NUQCBBTkRS
RVcuQ01VLkVEVSAvaW1hcC9jb25mL3NydnRhYiIKIAogICBtYm94bGlzdAljbWQ9ImN0bF9jeXJ1
c2RiIC1yIgorICAjIHRoaXMgaXMgb25seSBuZWNlc3NhcnkgaWYgdXNpbmcgY29udmVydHVzZXJp
ZCBleHRlbnNpb24KKyMgIGxkYXBkCQljbWQ9ImxkYXBkIC1uIDUiCiB9CiAKICMgVU5JWCBzb2Nr
ZXRzIHN0YXJ0IHdpdGggYSBzbGFzaCBhbmQgYXJlIHB1dCBpbnRvIC92YXIvaW1hcC9zb2NrZXRz
CmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL21hc3Rlci9jb25mL25vcm1hbC5jb25m
IGN5cnVzLWltYXBkLTIuMi4xMi9tYXN0ZXIvY29uZi9ub3JtYWwuY29uZgotLS0gY3lydXMtaW1h
cGQtMi4yLjEyLm9sZC9tYXN0ZXIvY29uZi9ub3JtYWwuY29uZgkyMDAzLTEwLTIyIDIyOjAzOjEw
ICswNDAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvbWFzdGVyL2NvbmYvbm9ybWFsLmNvbmYJMjAw
NS0xMi0wOCAxOTozODo1NCArMDMwMApAQCAtNiw2ICs2LDggQEAKIAogICAjIHRoaXMgaXMgb25s
eSBuZWNlc3NhcnkgaWYgdXNpbmcgaWRsZWQgZm9yIElNQVAgSURMRQogIyAgaWRsZWQJCWNtZD0i
aWRsZWQiCisgICMgdGhpcyBpcyBvbmx5IG5lY2Vzc2FyeSBpZiB1c2luZyBjb252ZXJ0dXNlcmlk
IGV4dGVuc2lvbgorIyAgbGRhcGQJCWNtZD0ibGRhcGQgLW4gNSIKIH0KIAogIyBVTklYIHNvY2tl
dHMgc3RhcnQgd2l0aCBhIHNsYXNoIGFuZCBhcmUgcHV0IGludG8gL3Zhci9pbWFwL3NvY2tldApk
aWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9tYXN0ZXIvY29uZi9wcmVmb3JrLmNvbmYg
Y3lydXMtaW1hcGQtMi4yLjEyL21hc3Rlci9jb25mL3ByZWZvcmsuY29uZgotLS0gY3lydXMtaW1h
cGQtMi4yLjEyLm9sZC9tYXN0ZXIvY29uZi9wcmVmb3JrLmNvbmYJMjAwMy0xMC0yMiAyMjowMzox
MCArMDQwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL21hc3Rlci9jb25mL3ByZWZvcmsuY29uZgky
MDA1LTEyLTA4IDE5OjM4OjU0ICswMzAwCkBAIC02LDYgKzYsOCBAQAogCiAgICMgdGhpcyBpcyBv
bmx5IG5lY2Vzc2FyeSBpZiB1c2luZyBpZGxlZCBmb3IgSU1BUCBJRExFCiAjICBpZGxlZAkJY21k
PSJpZGxlZCIKKyAgIyB0aGlzIGlzIG9ubHkgbmVjZXNzYXJ5IGlmIHVzaW5nIGNvbnZlcnR1c2Vy
aWQgZXh0ZW5zaW9uCisjICBsZGFwZAkJY21kPSJsZGFwZCAtbiA1IgogfQogCiAjIFVOSVggc29j
a2V0cyBzdGFydCB3aXRoIGEgc2xhc2ggYW5kIGFyZSBwdXQgaW50byAvdmFyL2ltYXAvc29ja2V0
cwpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9tYXN0ZXIvY29uZi9zbWFsbC5jb25m
IGN5cnVzLWltYXBkLTIuMi4xMi9tYXN0ZXIvY29uZi9zbWFsbC5jb25mCi0tLSBjeXJ1cy1pbWFw
ZC0yLjIuMTIub2xkL21hc3Rlci9jb25mL3NtYWxsLmNvbmYJMjAwMi0xMC0wMiAwMDo0NjowMSAr
MDQwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL21hc3Rlci9jb25mL3NtYWxsLmNvbmYJMjAwNS0x
Mi0wOCAxOTozODo1NCArMDMwMApAQCAtNiw2ICs2LDggQEAKIAogICAjIHRoaXMgaXMgb25seSBu
ZWNlc3NhcnkgaWYgdXNpbmcgaWRsZWQgZm9yIElNQVAgSURMRQogIyAgaWRsZWQJCWNtZD0iaWRs
ZWQiCisgICMgdGhpcyBpcyBvbmx5IG5lY2Vzc2FyeSBpZiB1c2luZyBjb252ZXJ0dXNlcmlkIGV4
dGVuc2lvbgorIyAgbGRhcGQJCWNtZD0ibGRhcGQgLW4gNSIKIH0KIAogIyBVTklYIHNvY2tldHMg
c3RhcnQgd2l0aCBhIHNsYXNoIGFuZCBhcmUgcHV0IGludG8gL3Zhci9pbWFwL3NvY2tldHMKZGlm
ZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbm90aWZ5ZC9NYWtlZmlsZS5pbiBjeXJ1cy1p
bWFwZC0yLjIuMTIvbm90aWZ5ZC9NYWtlZmlsZS5pbgotLS0gY3lydXMtaW1hcGQtMi4yLjEyLm9s
ZC9ub3RpZnlkL01ha2VmaWxlLmluCTIwMDUtMTItMDggMTY6NTg6NDQgKzAzMDAKKysrIGN5cnVz
LWltYXBkLTIuMi4xMi9ub3RpZnlkL01ha2VmaWxlLmluCTIwMDUtMTItMDggMTk6Mzg6NTUgKzAz
MDAKQEAgLTcyLDcgKzcyLDcgQEAKIFNJRVZFX0xJQlMgPSBAU0lFVkVfTElCU0AKIElNQVBfQ09N
X0VSUl9MSUJTID0gQElNQVBfQ09NX0VSUl9MSUJTQAogTElCX1dSQVAgPSBATElCX1dSQVBACi1M
SUJTID0gQFpFUEhZUl9MSUJTQCBATElCU0AgJChJTUFQX0NPTV9FUlJfTElCUykKK0xJQlMgPSBA
WkVQSFlSX0xJQlNAIEBMSUJTQCAkKElNQVBfQ09NX0VSUl9MSUJTKSAtbHJlZGJsYWNrIC1sbGRh
cAogREVQTElCUz0uLi9pbWFwL211dGV4X2Zha2UubyAuLi9pbWFwL2xpYmltYXAuYSAkKFNJRVZF
X0xJQlMpIC4uL2xpYi9saWJjeXJ1cy5hIC4uL2xpYi9saWJjeXJ1c19taW4uYSBAREVQTElCU0AK
IAogUFVSSUZZPS91c3IvbG9jYWwvYmluL3B1cmlmeQpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4y
LjEyLm9sZC9wdGNsaWVudC9NYWtlZmlsZS5pbiBjeXJ1cy1pbWFwZC0yLjIuMTIvcHRjbGllbnQv
TWFrZWZpbGUuaW4KLS0tIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvcHRjbGllbnQvTWFrZWZpbGUu
aW4JMjAwNS0xMi0wOCAxNjo1ODo0MCArMDMwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL3B0Y2xp
ZW50L01ha2VmaWxlLmluCTIwMDUtMTItMDggMTk6Mzg6NTUgKzAzMDAKQEAgLTU4LDcgKzU4LDcg
QEAKIEFGU19MSUJTID0gQEFGU19MSUJTQAogSU1BUF9MSUJTID0gQElNQVBfTElCU0AgQExJQl9S
VEAKIFNJRVZFX0xJQlMgPSBAU0lFVkVfTElCU0AKLUxJQlMgPSAkKElNQVBfTElCUykgQENPTV9F
UlJfTElCU0AKK0xJQlMgPSAkKElNQVBfTElCUykgQENPTV9FUlJfTElCU0AgLWxyZWRibGFjayAt
bGxkYXAKIExJQl9TQVNMID0gQExJQl9TQVNMQAogTElCX1dSQVAgPSBATElCX1dSQVBACiBERVBM
SUJTID0gLi4vaW1hcC9saWJpbWFwLmEgJChTSUVWRV9MSUJTKSAuLi9saWIvbGliY3lydXMuYSAu
Li9saWIvbGliY3lydXNfbWluLmEgQERFUExJQlNAIApkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4y
LjEyLm9sZC9SRUFETUUuY29udmVydHVzZXJpZCBjeXJ1cy1pbWFwZC0yLjIuMTIvUkVBRE1FLmNv
bnZlcnR1c2VyaWQKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvUkVBRE1FLmNvbnZlcnR1c2Vy
aWQJMTk3MC0wMS0wMSAwMzowMDowMCArMDMwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL1JFQURN
RS5jb252ZXJ0dXNlcmlkCTIwMDUtMTItMDggMTk6Mzk6MTIgKzAzMDAKQEAgLTAsMCArMSwxNCBA
QAorQ3lydXMgSU1BUCBjb252ZXJ0dXNlcmlkIHBhdGNoCistLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tCisKK1RoaXMgcGF0Y2ggaXMgbmVlZGVkIHRvIGFkZCBhYmlsaXR5IHRvIHRoZSBz
ZXJ2ZXIgdG8gaGlkZQorcmVhbCB1c2VycyBpbmRlbnRpZmllcnMgYW5kIHRvIHJlcGxhY2UgdGhl
bSB0byBvdGhlciBvbmVzCit3aGljaCBhcmUgZ290IGZyb20gTERBUC4KKworU3RlcHMgeW91IG5l
ZWQgdG8gZG8gdG8gZ2V0IGNvbnZlcnR1c2VyaWQgd29ya2VkOgorMS4gQnVpbGQgdGhlIHNlcnZl
ciB3aXRoIC0tZW5hYmxlLWNvbnZlcnR1c2VyaWQgJ2NvbmZpZ3VyZScgb3B0aW9uOworMi4gU2V0
IGNvbnZlcnVzZXJpZCogb3B0aW9ucyBpbiBpbWFwZC5jb25mLiBTZWUgaW1hcGQuY29uZig1KQor
ICAgZm9yIGRldGFpbHMuIFRoZSBkZWZhdWx0IGFjdGlvbiAod2l0aG91dCBhbnkgY29udmVydXNl
cmlkKgorICAgb3B0aW9uIHNldCkgaXMgImRvbid0IGNvbnZlcnQiOworMy4gQWRkICJsZGFwZCIg
aW4gU1RBUlQgc2VjdGlvbiBvZiBjeXJ1cy5jb25mLiBTZWUgbGRhcGQoOCkgZm9yCisgICBkZXRh
aWxzLgpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC90aW1zaWV2ZWQvTWFrZWZpbGUu
aW4gY3lydXMtaW1hcGQtMi4yLjEyL3RpbXNpZXZlZC9NYWtlZmlsZS5pbgotLS0gY3lydXMtaW1h
cGQtMi4yLjEyLm9sZC90aW1zaWV2ZWQvTWFrZWZpbGUuaW4JMjAwNC0wNS0yOCAyMjowMzoxMCAr
MDQwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL3RpbXNpZXZlZC9NYWtlZmlsZS5pbgkyMDA1LTEy
LTA4IDE5OjM4OjU1ICswMzAwCkBAIC03MSw3ICs3MSw3IEBACiBJTUFQX0xJQlMgPSBASU1BUF9M
SUJTQCBATElCX1JUQAogSU1BUF9DT01fRVJSX0xJQlMgPSBASU1BUF9DT01fRVJSX0xJQlNACiBM
SUJfV1JBUCA9IEBMSUJfV1JBUEAKLUxJQlMgPSAkKElNQVBfQ09NX0VSUl9MSUJTKQorTElCUyA9
ICQoSU1BUF9DT01fRVJSX0xJQlMpIC1scmVkYmxhY2sgLWxsZGFwCiBERVBMSUJTPS4uL3NpZXZl
L2xpYnNpZXZlLmEgLi4vaW1hcC9tdXRleF9mYWtlLm8gLi4vaW1hcC9saWJpbWFwLmEgLi4vbGli
L2xpYmN5cnVzLmEgLi4vbGliL2xpYmN5cnVzX21pbi5hIEBERVBMSUJTQAogCiBQVVJJRlk9L3Vz
ci9sb2NhbC9iaW4vcHVyaWZ5CmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL3Rvb2xz
L2NvbmZpZzJoZWFkZXIgY3lydXMtaW1hcGQtMi4yLjEyL3Rvb2xzL2NvbmZpZzJoZWFkZXIKLS0t
IGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvdG9vbHMvY29uZmlnMmhlYWRlcgkyMDA1LTEyLTA4IDE2
OjU4OjQ5ICswMzAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvdG9vbHMvY29uZmlnMmhlYWRlcgky
MDA1LTEyLTA4IDE5OjM4OjU1ICswMzAwCkBAIC0xMjYsNyArMTI2LDcgQEAKIAogc3RydWN0IGlt
YXBvcHRfcyBpbWFwb3B0c1tdID0KIHsKLSAgeyBJTUFQT1BUX1pFUk8sICIiLCAwLCB7IE5VTEwg
fSwgT1BUX05PVE9QVCwgeyAgeyBOVUxMLCBJTUFQX0VOVU1fWkVSTyB9IH0gfSwKKyAgeyBJTUFQ
T1BUX1pFUk8sICIiLCAwLCB7IE5VTEwgfSwgeyBOVUxMIH0sIE9QVF9OT1RPUFQsIHsgIHsgTlVM
TCwgSU1BUF9FTlVNX1pFUk8gfSB9IH0sCiBFT0YKICAgICA7CiAKQEAgLTIwNCw3ICsyMDQsNyBA
QAogCQkJOiAieyh2b2lkKikkMn0iOwogCX0KIAotCXByaW50IENGSUxFICIgIHsgSU1BUE9QVF8i
LCB1Yygkb3B0KSwgIiwgXCIkMVwiLCAwLCAkZGVmLCBPUFRfJDMsIHsgJGVudW1zIHsgTlVMTCwg
SU1BUF9FTlVNX1pFUk8gfSB9IH0sXG4iOworCXByaW50IENGSUxFICIgIHsgSU1BUE9QVF8iLCB1
Yygkb3B0KSwgIiwgXCIkMVwiLCAwLCAkZGVmLCAkZGVmLCBPUFRfJDMsIHsgJGVudW1zIHsgTlVM
TCwgSU1BUF9FTlVNX1pFUk8gfSB9IH0sXG4iOwogICAgIH0gZWxzZSB7CiAJI2Nob21wOwogCSNw
cmludCAicmVqZWN0ZWQgJyRfJ1xuIjsKQEAgLTI1MSw2ICsyNTEsNyBAQAogICAgIGNvbnN0IGNo
YXIgKm9wdG5hbWU7CiAgICAgaW50IHNlZW47CiAgICAgdW5pb24gY29uZmlnX3ZhbHVlIHZhbDsK
KyAgICB1bmlvbiBjb25maWdfdmFsdWUgZGVmOwogICAgIGNvbnN0IGVudW0gb3B0dHlwZSB0Owog
RU9GCiA7CkBAIC0yNjUsNyArMjY2LDcgQEAKICAgICA7CiAKIHByaW50IENGSUxFIDw8RU9GCi0g
IHsgSU1BUE9QVF9MQVNULCBOVUxMLCAwLCB7IE5VTEwgfSwgT1BUX05PVE9QVCwgeyAgeyBOVUxM
LCBJTUFQX0VOVU1fWkVSTyB9IH0gfQorICB7IElNQVBPUFRfTEFTVCwgTlVMTCwgMCwgeyBOVUxM
IH0sIHsgTlVMTCB9LCBPUFRfTk9UT1BULCB7ICB7IE5VTEwsIElNQVBfRU5VTV9aRVJPIH0gfSB9
CiB9OwogCiAvKiBjIGNvZGUgZ29lcyBoZXJlICovCg==
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>409</attachid>
            <date>2005-12-30 07:33 EDT</date>
            <desc>Update</desc>
            <filename>cyrus-imapd-convertuserid2-2.2.12_4.patch</filename>
            <type>text/plain</type>
            <size>98582</size>
            <attacher>dzal_mail@mtu-net.ru</attacher>
            
              <data encoding="base64">ZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvY29uZmlnLmguaW4gY3lydXMtaW1hcGQt
Mi4yLjEyL2NvbmZpZy5oLmluCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2NvbmZpZy5oLmlu
CTIwMDUtMDItMTQgMjA6NTk6NDEgKzAzMDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9jb25maWcu
aC5pbgkyMDA1LTEyLTMwIDE1OjEzOjU3ICswMzAwCkBAIC02NCw2ICs2NCw5IEBACiAvKiBEbyB3
ZSBoYXZlIGEgZGVjZW50IHJlZ2V4IGxpYnJhcnk/ICovCiAjdW5kZWYgRU5BQkxFX1JFR0VYCiAK
Ky8qIEVuYWJsZSBjb252ZXJ0aW5nIHVzZXJpZHMgdmlhIExEQVAgc3VwcG9ydD8gKi8KKyN1bmRl
ZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKwogLyogRW5hYmxlIE5ldHNjYXBlIE1lbnUgT3B0aW9u
IEhhY2s/ICovCiAjdW5kZWYgRU5BQkxFX1hfTkVUU0NBUEVfSEFDSwogCmRpZmYgLXVyTiBjeXJ1
cy1pbWFwZC0yLjIuMTIub2xkL2NvbmZpZ3VyZSBjeXJ1cy1pbWFwZC0yLjIuMTIvY29uZmlndXJl
Ci0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2NvbmZpZ3VyZQkyMDA1LTAyLTE0IDIwOjU5OjQ2
ICswMzAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvY29uZmlndXJlCTIwMDUtMTItMzAgMTU6MTM6
NTcgKzAzMDAKQEAgLTg1Miw2ICs4NTIsNyBAQAogICAtLWVuYWJsZS1jbXVsb2NhbCAgICAgICBl
bmFibGUgQ01VLXNwZWNpZmljIGxvY2FsIHN1cHBvcnQKICAgLS1lbmFibGUtb2xkc2lldmVuYW1l
ICAgZW5hYmxlIHRoZSB1c2Ugb2YgJ2ltYXAnIGFzIHRoZSBzaWV2ZSBzZXJ2aWNlIG5hbWUKICAg
LS1lbmFibGUtbGlzdGV4dCAgICAgICAgZW5hYmxlIElNQVAgTGlzdCBleHRlbnNpb25zCisgIC0t
ZW5hYmxlLWNvbnZlcnR1c2VyaWQgIGVuYWJsZSBjb252ZXJ0aW5nIHVzZXJpZHMgdmlhIExEQVAg
c3VwcG9ydAogICAtLWVuYWJsZS1uZXRzY2FwZWhhY2sgICBlbmFibGUgTmV0c2NhcGUgaGFjayBm
b3IgdGhlIG1lbnUgb3B0aW9uCiAgICAgICAgICAgICAgICAgICAgICAgICAgIGluIENvbW11bmlj
YXRvciB0byBBZG1pbmlzdHJhdGUgTWFpbAogICAtLWVuYWJsZS1nc3NhcGk9PERJUj4gICBlbmFi
bGUgR1NTQVBJIGF1dGhlbnRpY2F0aW9uIHllcwpAQCAtMTExODAsNiArMTExODEsMTggQEAKIAlm
aQogZmk7CiAKKyMgQ2hlY2sgd2hldGhlciAtLWVuYWJsZS1jb252ZXJ0dXNlcmlkIG9yIC0tZGlz
YWJsZS1jb252ZXJ0dXNlcmlkIHdhcyBnaXZlbi4KK2lmIHRlc3QgIiR7ZW5hYmxlX2NvbnZlcnR1
c2VyaWQrc2V0fSIgPSBzZXQ7IHRoZW4KKyAgZW5hYmxldmFsPSIkZW5hYmxlX2NvbnZlcnR1c2Vy
aWQiCisgIGlmIHRlc3QgIiRlbmFibGV2YWwiID0geWVzOyB0aGVuCisKK2NhdCA+PmNvbmZkZWZz
LmggPDxcX0FDRU9GCisjZGVmaW5lIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorX0FDRU9GCisJSU1B
UF9QUk9HUz0iJElNQVBfUFJPR1MgbGRhcGQiCisJZmkKK2ZpOworCiAjIENoZWNrIHdoZXRoZXIg
LS1lbmFibGUtbmV0c2NhcGVoYWNrIG9yIC0tZGlzYWJsZS1uZXRzY2FwZWhhY2sgd2FzIGdpdmVu
LgogaWYgdGVzdCAiJHtlbmFibGVfbmV0c2NhcGVoYWNrK3NldH0iID0gc2V0OyB0aGVuCiAgIGVu
YWJsZXZhbD0iJGVuYWJsZV9uZXRzY2FwZWhhY2siCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIu
MTIub2xkL2NvbmZpZ3VyZS5pbiBjeXJ1cy1pbWFwZC0yLjIuMTIvY29uZmlndXJlLmluCi0tLSBj
eXJ1cy1pbWFwZC0yLjIuMTIub2xkL2NvbmZpZ3VyZS5pbgkyMDA1LTAxLTE5IDAyOjQ2OjAwICsw
MzAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvY29uZmlndXJlLmluCTIwMDUtMTItMzAgMTU6MTM6
NTggKzAzMDAKQEAgLTkxNyw2ICs5MTcsMTMgQEAKIAkJQUNfREVGSU5FKEVOQUJMRV9MSVNURVhU
LFtdLFtFbmFibGUgdGhlIExJU1RFWFQgZXh0ZW5zaW9uP10pCiAJZmkpCiAKK0FDX0FSR19FTkFC
TEUoY29udmVydHVzZXJpZCwKKwlbICAtLWVuYWJsZS1jb252ZXJ0dXNlcmlkICBlbmFibGUgY29u
dmVydGluZyB1c2VyaWRzIHZpYSBMREFQIHN1cHBvcnRdLAorCWlmIHRlc3QgIiRlbmFibGV2YWwi
ID0geWVzOyB0aGVuCisJCUFDX0RFRklORShFTkFCTEVfQ09OVkVSVF9VU0VSSUQsW10sW0VuYWJs
ZSBjb252ZXJ0aW5nIHVzZXJpZHMgdmlhIExEQVAgc3VwcG9ydD9dKQorCQlJTUFQX1BST0dTPSIk
SU1BUF9QUk9HUyBsZGFwZCIKKwlmaSkKKwogQUNfQVJHX0VOQUJMRShuZXRzY2FwZWhhY2ssCiAJ
WyAgLS1lbmFibGUtbmV0c2NhcGVoYWNrICAgZW5hYmxlIE5ldHNjYXBlIGhhY2sgZm9yIHRoZSBt
ZW51IG9wdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAgICBpbiBDb21tdW5pY2F0b3IgdG8g
QWRtaW5pc3RyYXRlIE1haWxdLApkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFw
L2NoYXJzZXRfY29udmVydC5jIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2NoYXJzZXRfY29udmVy
dC5jCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvY2hhcnNldF9jb252ZXJ0LmMJMTk3
MC0wMS0wMSAwMzowMDowMCArMDMwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvY2hhcnNl
dF9jb252ZXJ0LmMJMjAwNS0xMi0zMCAxNToxNDozMSArMDMwMApAQCAtMCwwICsxLDU0NSBAQAor
LyogVGhpcyBmaWxlIHdhcyB0YWtlbiBmcm9tIFBIUCA1IGFuZCB3YXMgbW9kaWZpZWQgYnkKKyAg
IEFsZXhhbmRlciBEcm96ZG92IDxkemFsX21haWxAbXR1LW5ldC5ydT4gKi8KKyNpbmNsdWRlIDxz
dGRsaWIuaD4KKworI2luY2x1ZGUgImNoYXJzZXRfY29udmVydC5oIgorCisjZGVmaW5lIFVDUzRN
QVggMHg3MDAwMDAwMFUKKworI2RlZmluZSBVQ1MyTUFYIDB4MDAwMTAwMDBVCisjZGVmaW5lIFNV
UE1JTiAgMHgwMDAxMDAwMFUKKyNkZWZpbmUgU1VQTUFYICAweDAwMjAwMDAwVQorCisjZGVmaW5l
IE1BU0sgICAgMHhmZmZmZmZVCisjZGVmaW5lIFRIUk9VR0ggMHg3ODAwMDAwMFUgICAgICAgICAg
ICAgIC8qIDAwMDAwMGggLSBGRkZGRkZoICovCisKK3R5cGVkZWYgdW5zaWduZWQgaW50IHVpbnQ7
CisKK3R5cGVkZWYgc3RydWN0IF9jb252ZXJ0X3N0YXRlIHsKKyAgICBpbnQgY2FjaGU7CisgICAg
aW50IHN0YXR1czsKK30gY29udmVydF9zdGF0ZTsKKwordHlwZWRlZiBpbnQgKCpjb252ZXJ0ZWRf
b3V0X2NiX3QpKHVpbnQgYywgdm9pZCAqKTsKK3R5cGVkZWYgaW50ICgqY29udmVydF9jYl90KSh1
aW50IGMsIGNvbnZlcnRfc3RhdGUgKiwgY29udmVydGVkX291dF9jYl90LCB2b2lkICopOwordHlw
ZWRlZiBpbnQgKCpmbHVzaF9jYl90KShjb252ZXJ0X3N0YXRlICosIGNvbnZlcnRlZF9vdXRfY2Jf
dCwgdm9pZCAqKTsKKworI2RlZmluZSBDSyhzdGF0ZW1lbnQpCWRvIHsgaWYgKChzdGF0ZW1lbnQp
KSByZXR1cm4gKC0xKTsgfSB3aGlsZSAoMCkKKworc3RhdGljIGludCB1dGY4X2VuY29kZSh1aW50
IGMsIGNvbnZlcnRfc3RhdGUgKmZpbHRlciwgY29udmVydGVkX291dF9jYl90IG91dF9jYiwgdm9p
ZCAqb3V0X2NiX3BhcmFtKQoreworICAgIC8qIHNraXAgd3Jvbmcgc3ltYm9scyAqLworICAgIGlm
IChjID4gVUNTNE1BWCkKKwlyZXR1cm4gMDsKKyAgICAKKyAgICBpZiAoYyA8IDB4ODApIHsKKwlD
SyhvdXRfY2IoYywgb3V0X2NiX3BhcmFtKSk7CisgICAgfSBlbHNlIGlmIChjIDwgMHg4MDApIHsK
KwlDSyhvdXRfY2IoKChjID4+IDYpICYgMHgxZikgfCAweGMwLCBvdXRfY2JfcGFyYW0pKTsKKwlD
SyhvdXRfY2IoKGMgJiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworICAgIH0gZWxzZSBp
ZiAoYyA8IDB4MTAwMDApIHsKKwlDSyhvdXRfY2IoKChjID4+IDEyKSAmIDB4MGYpIHwgMHhlMCwg
b3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKCgoYyA+PiA2KSAmIDB4M2YpIHwgMHg4MCwgb3V0
X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKChjICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0p
KTsKKyAgICB9IGVsc2UgaWYgKGMgPCAweDIwMDAwMCkgeworCUNLKG91dF9jYigoKGMgPj4gMTgp
ICYgMHgwNykgfCAweGYwLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IoKChjID4+IDEyKSAm
IDB4M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKCgoYyA+PiA2KSAmIDB4
M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKChjICYgMHgzZikgfCAweDgw
LCBvdXRfY2JfcGFyYW0pKTsKKyAgICB9IGVsc2UgaWYgKGMgPCAweDQwMDAwMDApIHsKKwlDSyhv
dXRfY2IoKChjID4+IDI0KSAmIDB4MDMpIHwgMHhmOCwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0
X2NiKCgoYyA+PiAxOCkgJiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9j
YigoKGMgPj4gMTIpICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2Io
KChjID4+IDYpICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IoKGMg
JiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworICAgIH0gZWxzZSB7CisJQ0sob3V0X2Ni
KCgoYyA+PiAzMCkgJiAweDAxKSB8IDB4ZmMsIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9jYigo
KGMgPj4gMjQpICYgMHgzZikgfCAweDgwLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IoKChj
ID4+IDE4KSAmIDB4M2YpIHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKCgoYyA+
PiAxMikgJiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9jYigoKGMgPj4g
NikgJiAweDNmKSB8IDB4ODAsIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9jYigoYyAmIDB4M2Yp
IHwgMHg4MCwgb3V0X2NiX3BhcmFtKSk7CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9CisKK3N0
YXRpYyBpbnQgdXRmOF9kZWNvZGUodWludCBjLCBjb252ZXJ0X3N0YXRlICpmaWx0ZXIsIGNvbnZl
cnRlZF9vdXRfY2JfdCBvdXRfY2IsIHZvaWQgKm91dF9jYl9wYXJhbSkKK3sKKyAgICBpZiAoYyA8
IDB4ODApIHsKKwlDSyhvdXRfY2IoYywgb3V0X2NiX3BhcmFtKSk7CisJZmlsdGVyLT5zdGF0dXMg
PSAwOworICAgIH0gZWxzZSBpZiAoYyA8IDB4YzApIHsKKwl1aW50IHM7CisKKwlzd2l0Y2ggKGZp
bHRlci0+c3RhdHVzICYgMHhmZikgeworCWNhc2UgMHgxMDogLyogMmJ5dGUgY29kZSAybmQgY2hh
ciAqLworCWNhc2UgMHgyMTogLyogM2J5dGUgY29kZSAzcmQgY2hhciAqLworCWNhc2UgMHgzMjog
LyogNGJ5dGUgY29kZSA0dGggY2hhciAqLworCWNhc2UgMHg0MzogLyogNWJ5dGUgY29kZSA1dGgg
Y2hhciAqLworCWNhc2UgMHg1NDogLyogNmJ5dGUgY29kZSA2dGggY2hhciAqLworCSAgICBmaWx0
ZXItPnN0YXR1cyA9IDA7CisJICAgIHMgPSBmaWx0ZXItPmNhY2hlIHwgKGMgJiAweDNmKTsKKwkg
ICAgaWYgKHMgPj0gMHg4MCkKKwkJQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJhbSkpOworCSAgICBi
cmVhazsKKwljYXNlIDB4MjA6IC8qIDNieXRlIGNvZGUgMm5kIGNoYXIgKi8KKwljYXNlIDB4MzE6
IC8qIDRieXRlIGNvZGUgM3JkIGNoYXIgKi8KKwljYXNlIDB4NDI6IC8qIDVieXRlIGNvZGUgNHRo
IGNoYXIgKi8KKwljYXNlIDB4NTM6IC8qIDZieXRlIGNvZGUgNXRoIGNoYXIgKi8KKwkgICAgZmls
dGVyLT5jYWNoZSB8PSAoKGMgJiAweDNmKSA8PCA2KTsKKwkgICAgZmlsdGVyLT5zdGF0dXMrKzsK
KwkgICAgYnJlYWs7CisJY2FzZSAweDMwOiAvKiA0Ynl0ZSBjb2RlIDJuZCBjaGFyICovCisJY2Fz
ZSAweDQxOiAvKiA1Ynl0ZSBjb2RlIDNyZCBjaGFyICovCisJY2FzZSAweDUyOiAvKiA2Ynl0ZSBj
b2RlIDR0aCBjaGFyICovCisJICAgIGZpbHRlci0+Y2FjaGUgfD0gKChjICYgMHgzZikgPDwgMTIp
OworCSAgICBmaWx0ZXItPnN0YXR1cysrOworCSAgICBicmVhazsKKwljYXNlIDB4NDA6IC8qIDVi
eXRlIGNvZGUgMm5kIGNoYXIgKi8KKwljYXNlIDB4NTE6IC8qIDZieXRlIGNvZGUgM3JkIGNoYXIg
Ki8KKwkgICAgZmlsdGVyLT5jYWNoZSB8PSAoKGMgJiAweDNmKSA8PCAxOCk7CisJICAgIGZpbHRl
ci0+c3RhdHVzKys7CisJICAgIGJyZWFrOworCWNhc2UgMHg1MDogLyogNmJ5dGUgY29kZSAybmQg
Y2hhciAqLworCSAgICBmaWx0ZXItPmNhY2hlIHw9ICgoYyAmIDB4M2YpIDw8IDI0KTsKKwkgICAg
ZmlsdGVyLT5zdGF0dXMrKzsKKwkgICAgYnJlYWs7CisJZGVmYXVsdDoKKwkgICAgZmlsdGVyLT5z
dGF0dXMgPSAwOworCSAgICBicmVhazsKKwl9CisgICAgfSBlbHNlIGlmIChjIDwgMHhlMCkgeyAv
KiAyYnl0ZSBjb2RlIGZpcnN0IGNoYXIgKi8KKwlmaWx0ZXItPnN0YXR1cyA9IDB4MTA7CisJZmls
dGVyLT5jYWNoZSA9IChjICYgMHgxZikgPDwgNjsKKyAgICB9IGVsc2UgaWYgKGMgPCAweGYwKSB7
IC8qIDNieXRlIGNvZGUgZmlyc3QgY2hhciAqLworCWZpbHRlci0+c3RhdHVzID0gMHgyMDsKKwlm
aWx0ZXItPmNhY2hlID0gKGMgJiAweGYpIDw8IDEyOworICAgIH0gZWxzZSBpZiAoYyA8IDB4Zjgp
IHsgLyogNGJ5dGUgY29kZSBmaXJzdCBjaGFyICovCisJZmlsdGVyLT5zdGF0dXMgPSAweDMwOwor
CWZpbHRlci0+Y2FjaGUgPSAoYyAmIDB4NykgPDwgMTg7CisgICAgfSBlbHNlIGlmIChjIDwgMHhm
YykgeyAvKiA1Ynl0ZSBjb2RlIGZpcnN0IGNoYXIgKi8KKwlmaWx0ZXItPnN0YXR1cyA9IDB4NDA7
CisJZmlsdGVyLT5jYWNoZSA9IChjICYgMHgzKSA8PCAyNDsKKyAgICB9IGVsc2UgaWYgKGMgPCAw
eGZlKSAgeyAvKiA2IGJ5dGUgY29kZSBmaXJzdCBjaGFyICovCisJZmlsdGVyLT5zdGF0dXMgPSAw
eDUwOworCWZpbHRlci0+Y2FjaGUgPSAoYyAmIDB4MSkgPDwgMzA7CisgICAgfSBlbHNlIHsKKwlm
aWx0ZXItPnN0YXR1cyA9IDA7CisJZmlsdGVyLT5jYWNoZSA9IDA7CisgICAgfQorCisgICAgcmV0
dXJuIDA7Cit9CisKK3N0YXRpYyBjb25zdCB1bnNpZ25lZCBjaGFyIHV0ZjdpbWFwX2Jhc2U2NF90
YWJsZVtdID0KK3sKKyAvKiAnQScsICdCJywgJ0MnLCAnRCcsICdFJywgJ0YnLCAnRycsICdIJywg
J0knLCAnSicsICdLJywgJ0wnLCAnTScsICovCisgICAweDQxLDB4NDIsMHg0MywweDQ0LDB4NDUs
MHg0NiwweDQ3LDB4NDgsMHg0OSwweDRhLDB4NGIsMHg0YywweDRkLAorIC8qICdOJywgJ08nLCAn
UCcsICdRJywgJ1InLCAnUycsICdUJywgJ1UnLCAnVicsICdXJywgJ1gnLCAnWScsICdaJywgKi8K
KyAgIDB4NGUsMHg0ZiwweDUwLDB4NTEsMHg1MiwweDUzLDB4NTQsMHg1NSwweDU2LDB4NTcsMHg1
OCwweDU5LDB4NWEsCisgLyogJ2EnLCAnYicsICdjJywgJ2QnLCAnZScsICdmJywgJ2cnLCAnaCcs
ICdpJywgJ2onLCAnaycsICdsJywgJ20nLCAqLworICAgMHg2MSwweDYyLDB4NjMsMHg2NCwweDY1
LDB4NjYsMHg2NywweDY4LDB4NjksMHg2YSwweDZiLDB4NmMsMHg2ZCwKKyAvKiAnbicsICdvJywg
J3AnLCAncScsICdyJywgJ3MnLCAndCcsICd1JywgJ3YnLCAndycsICd4JywgJ3knLCAneicsICov
CisgICAweDZlLDB4NmYsMHg3MCwweDcxLDB4NzIsMHg3MywweDc0LDB4NzUsMHg3NiwweDc3LDB4
NzgsMHg3OSwweDdhLAorIC8qICcwJywgJzEnLCAnMicsICczJywgJzQnLCAnNScsICc2JywgJzcn
LCAnOCcsICc5JywgJysnLCAnLCcsICdcMCcgKi8KKyAgIDB4MzAsMHgzMSwweDMyLDB4MzMsMHgz
NCwweDM1LDB4MzYsMHgzNywweDM4LDB4MzksMHgyYiwweDJjLDB4MDAKK307CisKK3N0YXRpYyBp
bnQgbXV0ZjdfZW5jb2RlKHVpbnQgYywgY29udmVydF9zdGF0ZSAqZmlsdGVyLCBjb252ZXJ0ZWRf
b3V0X2NiX3Qgb3V0X2NiLCB2b2lkICpvdXRfY2JfcGFyYW0pCit7CisgICAgaW50IG4sIHM7CisK
KyAgICBuID0gMDsKKyAgICBpZiAoYyA9PSAweDI2KSB7CisJbiA9IDE7CisgICAgfSBlbHNlIGlm
ICgoYyA+PSAweDIwICYmIGMgPD0gMHg3ZSkgfHwgYyA9PSAwKSB7CisJbiA9IDI7CisgICAgfSBl
bHNlIGlmIChjID49IDAgJiYgYyA8IFVDUzJNQVgpIHsKKwk7CisgICAgfSBlbHNlIGlmIChjID49
IFNVUE1JTiAmJiBjIDwgU1VQTUFYKSB7CisJcyA9ICgoYyA+PiAxMCkgLSAweDQwKSB8IDB4ZDgw
MDsKKwlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisJcyA9IChjICYgMHgzZmYpIHwgMHhk
YzAwOworCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKwlyZXR1cm4gMDsKKyAgICB9IGVs
c2UgeworCXJldHVybiAtMTsKKyAgICB9CisKKyAgICBzd2l0Y2ggKGZpbHRlci0+c3RhdHVzKSB7
CisgICAgY2FzZSAwOgorCWlmIChuICE9IDApIHsJLyogZGlyZWN0bHkgZW5jb2RlIGNoYXJhY3Rl
cnMgKi8KKwkgICAgQ0sob3V0X2NiKGMsIG91dF9jYl9wYXJhbSkpOworCSAgICBpZiAobiA9PSAx
KSB7CisJCUNLKG91dF9jYigweDJkLCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworCSAgICB9
CisJfSBlbHNlIHsJLyogTW9kaWZpZWQgQmFzZTY0ICovCisJICAgIENLKG91dF9jYigweDI2LCBv
dXRfY2JfcGFyYW0pKTsJCS8qICcmJyAqLworCSAgICBmaWx0ZXItPnN0YXR1cyA9IDE7CisJICAg
IGZpbHRlci0+Y2FjaGUgPSBjOworCX0KKwlicmVhazsKKworCS8qIGVuY29kZSBNb2RpZmllZCBC
YXNlNjQgKi8KKyAgICBjYXNlIDE6CisJcyA9IGZpbHRlci0+Y2FjaGU7CisJQ0sob3V0X2NiKHV0
ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA+PiAxMCkgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisJ
Q0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA+PiA0KSAmIDB4M2ZdLCBvdXRfY2Jf
cGFyYW0pKTsKKwlpZiAobiAhPSAwKSB7CisJICAgIENLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRf
dGFibGVbKHMgPDwgMikgJiAweDNjXSwgb3V0X2NiX3BhcmFtKSk7CisJICAgIENLKG91dF9jYigw
eDJkLCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworCSAgICBDSyhvdXRfY2IoYywgb3V0X2Ni
X3BhcmFtKSk7CisJICAgIGlmIChuID09IDEpIHsKKwkJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9w
YXJhbSkpOwkJLyogJy0nICovCisJICAgIH0KKwkgICAgZmlsdGVyLT5zdGF0dXMgPSAwOworCX0g
ZWxzZSB7CisJICAgIGZpbHRlci0+c3RhdHVzID0gMjsKKwkgICAgZmlsdGVyLT5jYWNoZSA9ICgo
cyAmIDB4ZikgPDwgMTYpIHwgYzsKKwl9CisJYnJlYWs7CisKKyAgICBjYXNlIDI6CisJcyA9IGZp
bHRlci0+Y2FjaGU7CisJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA+PiAxNCkg
JiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJs
ZVsocyA+PiA4KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IodXRmN2ltYXBf
YmFzZTY0X3RhYmxlWyhzID4+IDIpICYgMHgzZl0sIG91dF9jYl9wYXJhbSkpOworCWlmIChuICE9
IDApIHsKKwkgICAgQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsocyA8PCA0KSAmIDB4
MzBdLCBvdXRfY2JfcGFyYW0pKTsKKwkgICAgQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJhbSkp
OwkJLyogJy0nICovCisJICAgIENLKG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKwkgICAgaWYg
KG4gPT0gMSkgeworCQlDSyhvdXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScgKi8K
KwkgICAgfQorCSAgICBmaWx0ZXItPnN0YXR1cyA9IDA7CisJfSBlbHNlIHsKKwkgICAgZmlsdGVy
LT5zdGF0dXMgPSAzOworCSAgICBmaWx0ZXItPmNhY2hlID0gKChzICYgMHgzKSA8PCAxNikgfCBj
OworCX0KKwlicmVhazsKKworICAgIGNhc2UgMzoKKwlzID0gZmlsdGVyLT5jYWNoZTsKKwlDSyhv
dXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhzID4+IDEyKSAmIDB4M2ZdLCBvdXRfY2JfcGFy
YW0pKTsKKwlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhzID4+IDYpICYgMHgzZl0s
IG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbcyAmIDB4
M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKwlpZiAobiAhPSAwKSB7CisJICAgIENLKG91dF9jYigweDJk
LCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworCSAgICBDSyhvdXRfY2IoYywgb3V0X2NiX3Bh
cmFtKSk7CisJICAgIGlmIChuID09IDEpIHsKKwkJQ0sob3V0X2NiKDB4MmQsIG91dF9jYl9wYXJh
bSkpOwkJLyogJy0nICovCisJICAgIH0KKwkgICAgZmlsdGVyLT5zdGF0dXMgPSAwOworCX0gZWxz
ZSB7CisJICAgIGZpbHRlci0+c3RhdHVzID0gMTsKKwkgICAgZmlsdGVyLT5jYWNoZSA9IGM7CisJ
fQorCWJyZWFrOworCisgICAgZGVmYXVsdDoKKwlmaWx0ZXItPnN0YXR1cyA9IDA7CisJYnJlYWs7
CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9CisKK3N0YXRpYyBpbnQgbXV0ZjdfZGVjb2RlKHVp
bnQgYywgY29udmVydF9zdGF0ZSAqZmlsdGVyLCBjb252ZXJ0ZWRfb3V0X2NiX3Qgb3V0X2NiLCB2
b2lkICpvdXRfY2JfcGFyYW0pCit7CisgICAgaW50IHMsIG47CisKKyAgICBuID0gLTE7CisgICAg
aWYgKGZpbHRlci0+c3RhdHVzICE9IDApIHsJCS8qIE1vZGlmaWVkIEJhc2U2NCAqLworCWlmIChj
ID49IDB4NDEgJiYgYyA8PSAweDVhKSB7CQkvKiBBIC0gWiAqLworCSAgICBuID0gYyAtIDY1Owor
CX0gZWxzZSBpZiAoYyA+PSAweDYxICYmIGMgPD0gMHg3YSkgewkvKiBhIC0geiAqLworCSAgICBu
ID0gYyAtIDcxOworCX0gZWxzZSBpZiAoYyA+PSAweDMwICYmIGMgPD0gMHgzOSkgewkvKiAwIC0g
OSAqLworCSAgICBuID0gYyArIDQ7CisJfSBlbHNlIGlmIChjID09IDB4MmIpIHsJCQkvKiAnKycg
Ki8KKwkgICAgbiA9IDYyOworCX0gZWxzZSBpZiAoYyA9PSAweDJjKSB7CQkJLyogJywnICovCisJ
ICAgIG4gPSA2MzsKKwl9CisJaWYgKG4gPCAwIHx8IG4gPiA2MykgeworCSAgICBpZiAoYyA9PSAw
eDJkKSB7CisJCWlmIChmaWx0ZXItPnN0YXR1cyA9PSAxKSB7CQkvKiAiJi0iIC0+ICImIiAqLwor
CQkgICAgQ0sob3V0X2NiKDB4MjYsIG91dF9jYl9wYXJhbSkpOworCQl9CisJICAgIH0gZWxzZSBp
ZiAoYyA+PSAwICYmIGMgPCAweDgwKSB7CS8qIEFTQ0lJIGV4Y2x1ZGUgJy0nICovCisJCUNLKG91
dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKwkgICAgfSBlbHNlIHsJCS8qIGlsbGVnYWwgY2hhcmFj
dGVyICovCisJCXMgPSBjICYgTUFTSzsKKwkJcyB8PSBUSFJPVUdIOworCQlDSyhvdXRfY2Iocywg
b3V0X2NiX3BhcmFtKSk7CisJICAgIH0KKwkgICAgZmlsdGVyLT5jYWNoZSA9IDA7CisJICAgIGZp
bHRlci0+c3RhdHVzID0gMDsKKwkgICAgcmV0dXJuIDA7CisJfQorICAgIH0KKworICAgIHN3aXRj
aCAoZmlsdGVyLT5zdGF0dXMpIHsKKwkvKiBkaXJlY3RseSBlbmNvZGVkIGNoYXJhY3RlcnMgKi8K
KyAgICBjYXNlIDA6CisJaWYgKGMgPT0gMHgyNikgewkvKiAnJicgIHNoaWZ0IGNoYXJhY3RlciAq
LworCSAgICBmaWx0ZXItPnN0YXR1cysrOworCX0gZWxzZSBpZiAoYyA+PSAwICYmIGMgPCAweDgw
KSB7CS8qIEFTQ0lJICovCisJICAgIENLKG91dF9jYihjLCBvdXRfY2JfcGFyYW0pKTsKKwl9IGVs
c2UgewkJLyogaWxsZWdhbCBjaGFyYWN0ZXIgKi8KKwkgICAgcyA9IGMgJiBNQVNLOworCSAgICBz
IHw9IFRIUk9VR0g7CisJICAgIENLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKwl9CisJYnJl
YWs7CisKKwkvKiBkZWNvZGUgTW9kaWZpZWQgQmFzZTY0ICovCisgICAgY2FzZSAxOgorICAgIGNh
c2UgMjoKKwlmaWx0ZXItPmNhY2hlIHw9IG4gPDwgMTA7CisJZmlsdGVyLT5zdGF0dXMgPSAzOwor
CWJyZWFrOworICAgIGNhc2UgMzoKKwlmaWx0ZXItPmNhY2hlIHw9IG4gPDwgNDsKKwlmaWx0ZXIt
PnN0YXR1cyA9IDQ7CisJYnJlYWs7CisgICAgY2FzZSA0OgorCXMgPSAoKG4gPj4gMikgJiAweGYp
IHwgKGZpbHRlci0+Y2FjaGUgJiAweGZmZmYpOworCW4gPSAobiAmIDB4MykgPDwgMTQ7CisJZmls
dGVyLT5zdGF0dXMgPSA1OworCWlmIChzID49IDB4ZDgwMCAmJiBzIDwgMHhkYzAwKSB7CisJICAg
IHMgPSAoKChzICYgMHgzZmYpIDw8IDE2KSArIDB4NDAwMDAwKSB8IG47CisJICAgIGZpbHRlci0+
Y2FjaGUgPSBzOworCX0gZWxzZSBpZiAocyA+PSAweGRjMDAgJiYgcyA8IDB4ZTAwMCkgeworCSAg
ICBzICY9IDB4M2ZmOworCSAgICBzIHw9IChmaWx0ZXItPmNhY2hlICYgMHhmZmYwMDAwKSA+PiA2
OworCSAgICBmaWx0ZXItPmNhY2hlID0gbjsKKwkgICAgaWYgKHMgPj0gU1VQTUlOICYmIHMgPCBT
VVBNQVgpIHsKKwkJQ0sob3V0X2NiKHMsIG91dF9jYl9wYXJhbSkpOworCSAgICB9IGVsc2UgewkJ
LyogaWxsZWdhbCBjaGFyYWN0ZXIgKi8KKwkJcyAmPSBNQVNLOworCQlzIHw9IFRIUk9VR0g7CisJ
CUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsKKwkgICAgfQorCX0gZWxzZSB7CisJICAgIGZp
bHRlci0+Y2FjaGUgPSBuOworCSAgICBDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisJfQor
CWJyZWFrOworCisgICAgY2FzZSA1OgorCWZpbHRlci0+Y2FjaGUgfD0gbiA8PCA4OworCWZpbHRl
ci0+c3RhdHVzID0gNjsKKwlicmVhazsKKyAgICBjYXNlIDY6CisJZmlsdGVyLT5jYWNoZSB8PSBu
IDw8IDI7CisJZmlsdGVyLT5zdGF0dXMgPSA3OworCWJyZWFrOworICAgIGNhc2UgNzoKKwlzID0g
KChuID4+IDQpICYgMHgzKSB8IChmaWx0ZXItPmNhY2hlICYgMHhmZmZmKTsKKwluID0gKG4gJiAw
eGYpIDw8IDEyOworCWZpbHRlci0+c3RhdHVzID0gODsKKwlpZiAocyA+PSAweGQ4MDAgJiYgcyA8
IDB4ZGMwMCkgeworCSAgICBzID0gKCgocyAmIDB4M2ZmKSA8PCAxNikgKyAweDQwMDAwMCkgfCBu
OworCSAgICBmaWx0ZXItPmNhY2hlID0gczsKKwl9IGVsc2UgaWYgKHMgPj0gMHhkYzAwICYmIHMg
PCAweGUwMDApIHsKKwkgICAgcyAmPSAweDNmZjsKKwkgICAgcyB8PSAoZmlsdGVyLT5jYWNoZSAm
IDB4ZmZmMDAwMCkgPj4gNjsKKwkgICAgZmlsdGVyLT5jYWNoZSA9IG47CisJICAgIGlmIChzID49
IFNVUE1JTiAmJiBzIDwgU1VQTUFYKSB7CisJCUNLKG91dF9jYihzLCBvdXRfY2JfcGFyYW0pKTsK
KwkgICAgfSBlbHNlIHsJCS8qIGlsbGVnYWwgY2hhcmFjdGVyICovCisJCXMgJj0gTUFTSzsKKwkJ
cyB8PSBUSFJPVUdIOworCQlDSyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisJICAgIH0KKwl9
IGVsc2UgeworCSAgICBmaWx0ZXItPmNhY2hlID0gbjsKKwkgICAgQ0sob3V0X2NiKHMsIG91dF9j
Yl9wYXJhbSkpOworCX0KKwlicmVhazsKKworICAgIGNhc2UgODoKKwlmaWx0ZXItPmNhY2hlIHw9
IG4gPDwgNjsKKwlmaWx0ZXItPnN0YXR1cyA9IDk7CisJYnJlYWs7CisgICAgY2FzZSA5OgorCXMg
PSBuIHwgKGZpbHRlci0+Y2FjaGUgJiAweGZmZmYpOworCWZpbHRlci0+c3RhdHVzID0gMjsKKwlp
ZiAocyA+PSAweGQ4MDAgJiYgcyA8IDB4ZGMwMCkgeworCSAgICBzID0gKCgocyAmIDB4M2ZmKSA8
PCAxNikgKyAweDQwMDAwMCk7CisJICAgIGZpbHRlci0+Y2FjaGUgPSBzOworCX0gZWxzZSBpZiAo
cyA+PSAweGRjMDAgJiYgcyA8IDB4ZTAwMCkgeworCSAgICBzICY9IDB4M2ZmOworCSAgICBzIHw9
IChmaWx0ZXItPmNhY2hlICYgMHhmZmYwMDAwKSA+PiA2OworCSAgICBmaWx0ZXItPmNhY2hlID0g
MDsKKwkgICAgaWYgKHMgPj0gU1VQTUlOICYmIHMgPCBTVVBNQVgpIHsKKwkJQ0sob3V0X2NiKHMs
IG91dF9jYl9wYXJhbSkpOworCSAgICB9IGVsc2UgewkJLyogaWxsZWdhbCBjaGFyYWN0ZXIgKi8K
KwkJcyAmPSBNQVNLOworCQlzIHw9IFRIUk9VR0g7CisJCUNLKG91dF9jYihzLCBvdXRfY2JfcGFy
YW0pKTsKKwkgICAgfQorCX0gZWxzZSB7CisJICAgIGZpbHRlci0+Y2FjaGUgPSAwOworCSAgICBD
SyhvdXRfY2Iocywgb3V0X2NiX3BhcmFtKSk7CisJfQorCWJyZWFrOworCisgICAgZGVmYXVsdDoK
KwlmaWx0ZXItPnN0YXR1cyA9IDA7CisJYnJlYWs7CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9
CitzdGF0aWMgaW50IG11dGY3X2VuY29kZV9mbHVzaChjb252ZXJ0X3N0YXRlICpmaWx0ZXIsIGNv
bnZlcnRlZF9vdXRfY2JfdCBvdXRfY2IsIHZvaWQgKm91dF9jYl9wYXJhbSkKK3sKKyAgICBpbnQg
c3RhdHVzLCBjYWNoZTsKKworICAgIHN0YXR1cyA9IGZpbHRlci0+c3RhdHVzOworICAgIGNhY2hl
ID0gZmlsdGVyLT5jYWNoZTsKKyAgICBmaWx0ZXItPnN0YXR1cyA9IDA7CisgICAgZmlsdGVyLT5j
YWNoZSA9IDA7CisgICAgLyogZmx1c2ggZnJhZ21lbnRzICovCisgICAgc3dpdGNoIChzdGF0dXMp
IHsKKyAgICBjYXNlIDE6CisJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsoY2FjaGUg
Pj4gMTApICYgMHgzZl0sIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9jYih1dGY3aW1hcF9iYXNl
NjRfdGFibGVbKGNhY2hlID4+IDQpICYgMHgzZl0sIG91dF9jYl9wYXJhbSkpOworCUNLKG91dF9j
Yih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKGNhY2hlIDw8IDIpICYgMHgzY10sIG91dF9jYl9wYXJh
bSkpOworCUNLKG91dF9jYigweDJkLCBvdXRfY2JfcGFyYW0pKTsJCS8qICctJyAqLworCWJyZWFr
OworCisgICAgY2FzZSAyOgorCUNLKG91dF9jYih1dGY3aW1hcF9iYXNlNjRfdGFibGVbKGNhY2hl
ID4+IDE0KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IodXRmN2ltYXBfYmFz
ZTY0X3RhYmxlWyhjYWNoZSA+PiA4KSAmIDB4M2ZdLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRf
Y2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhjYWNoZSA+PiAyKSAmIDB4M2ZdLCBvdXRfY2JfcGFy
YW0pKTsKKwlDSyhvdXRfY2IodXRmN2ltYXBfYmFzZTY0X3RhYmxlWyhjYWNoZSA8PCA0KSAmIDB4
MzBdLCBvdXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkv
KiAnLScgKi8KKwlicmVhazsKKworICAgIGNhc2UgMzoKKwlDSyhvdXRfY2IodXRmN2ltYXBfYmFz
ZTY0X3RhYmxlWyhjYWNoZSA+PiAxMikgJiAweDNmXSwgb3V0X2NiX3BhcmFtKSk7CisJQ0sob3V0
X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVsoY2FjaGUgPj4gNikgJiAweDNmXSwgb3V0X2NiX3Bh
cmFtKSk7CisJQ0sob3V0X2NiKHV0ZjdpbWFwX2Jhc2U2NF90YWJsZVtjYWNoZSAmIDB4M2ZdLCBv
dXRfY2JfcGFyYW0pKTsKKwlDSyhvdXRfY2IoMHgyZCwgb3V0X2NiX3BhcmFtKSk7CQkvKiAnLScg
Ki8KKwlicmVhazsKKyAgICB9CisgICAgcmV0dXJuIDA7Cit9CisKK3R5cGVkZWYgc3RydWN0IF9j
b252ZXJ0X29wdHMgeworICAgIGNvbnZlcnRfY2JfdCBlbmNvZGVfY2I7CisgICAgY29udmVydF9j
Yl90IGRlY29kZV9jYjsKKyAgICBmbHVzaF9jYl90IGZsdXNoX2VuY29kZTsKKyAgICBmbHVzaF9j
Yl90IGZsdXNoX2RlY29kZTsKK30gY29udmVydF9vcHRzOworCit0eXBlZGVmIHN0cnVjdCBfcGFy
YW1fY29udmVydCB7CisgICAgaW50IGxlbjsKKyAgICBjaGFyICpvdXQ7CisgICAgY29udmVydF9v
cHRzICpvcHRzOworICAgIGNvbnZlcnRfc3RhdGUgZmlsdGVyOworfSBwYXJhbV9jb252ZXJ0Owor
CisvKiBqdXN0IGEgY291bnRlciAqLworc3RhdGljIGludCBjb3VudF9sZW5fY2IodWludCBjLCB2
b2lkICpwYXJhbSkKK3sKKyAgICAoKihpbnQgKilwYXJhbSkrKzsKKyAgICByZXR1cm4gMDsKK30K
Kworc3RhdGljIGludCB3cml0ZV9vdXRfY2IodWludCBjLCB2b2lkICpwYXJhbSkKK3sKKyAgICBw
YXJhbV9jb252ZXJ0ICpyX3BhcmFtPShwYXJhbV9jb252ZXJ0ICopcGFyYW07CisKKyAgICByX3Bh
cmFtLT5vdXRbcl9wYXJhbS0+bGVuXT0oY2hhciljOworICAgIHJfcGFyYW0tPmxlbisrOworICAg
IHJldHVybiAwOworfQorCisvKiAnYycgaXMgd2NoYXIuIHdlIG5lZWQgdG8gY2FsbCBlbmNvZGVf
Y2IgZnVuY3Rpb24gdG8gY2FsY3VsYXRlIHRoZQorICAgb3V0cHV0IGJ1ZmZlciBzaXplICovCitz
dGF0aWMgaW50IGdldF9sZW5fY2IodWludCBjLCB2b2lkICpwYXJhbSkKK3sKKyAgICByZXR1cm4g
KChwYXJhbV9jb252ZXJ0ICopcGFyYW0pLT5vcHRzLT5lbmNvZGVfY2IoYywgJigocGFyYW1fY29u
dmVydCAqKXBhcmFtKS0+ZmlsdGVyLCBjb3VudF9sZW5fY2IsICh2b2lkICopJigocGFyYW1fY29u
dmVydCAqKXBhcmFtKS0+bGVuKTsKK30KKworc3RhdGljIGludCByZWFsX291dF9jYih1aW50IGMs
IHZvaWQgKnBhcmFtKQoreworICAgIHJldHVybiAoKHBhcmFtX2NvbnZlcnQgKilwYXJhbSktPm9w
dHMtPmVuY29kZV9jYihjLCAmKChwYXJhbV9jb252ZXJ0ICopcGFyYW0pLT5maWx0ZXIsIHdyaXRl
X291dF9jYiwgcGFyYW0pOworfQorCitzdGF0aWMgY2hhciAqZG9fY29udmVyc2lvbihjb252ZXJ0
X29wdHMgKm9wdHMsIGNoYXIgKmluLCBpbnQgaW5sZW4sIGludCAqb3V0bGVuKQoreworICAgIHBh
cmFtX2NvbnZlcnQgcGFyYW07CisgICAgY29udmVydF9zdGF0ZSBmaWx0ZXI7CisgICAgaW50IGk7
CisKKyAgICBwYXJhbS5sZW4gPSAwOworICAgIHBhcmFtLm9wdHMgPSBvcHRzOworICAgIGJ6ZXJv
KCZwYXJhbS5maWx0ZXIsIHNpemVvZihwYXJhbS5maWx0ZXIpKTsKKyAgICBiemVybygmZmlsdGVy
LCBzaXplb2YoZmlsdGVyKSk7CisKKyAgICBmb3IoaT0wOyBpPGlubGVuOyBpKyspCisJaWYob3B0
cy0+ZGVjb2RlX2NiKCh1aW50KSh1bnNpZ25lZCBjaGFyKWluW2ldLCAmZmlsdGVyLCBnZXRfbGVu
X2NiLCAodm9pZCAqKSZwYXJhbSkpCisJICAgIHJldHVybiBOVUxMOworCisgICAgaWYob3B0cy0+
Zmx1c2hfZGVjb2RlKQorCWlmKG9wdHMtPmZsdXNoX2RlY29kZSgmZmlsdGVyLCBnZXRfbGVuX2Ni
LCAodm9pZCAqKSZwYXJhbSkpCisJICAgIHJldHVybiBOVUxMOworICAgIGlmKG9wdHMtPmZsdXNo
X2VuY29kZSkKKwlpZihvcHRzLT5mbHVzaF9lbmNvZGUoJnBhcmFtLmZpbHRlciwgY291bnRfbGVu
X2NiLCAodm9pZCAqKSZwYXJhbS5sZW4pKQorCSAgICByZXR1cm4gTlVMTDsKKworICAgIGlmKCEo
cGFyYW0ub3V0PShjaGFyICopbWFsbG9jKHBhcmFtLmxlbikpKQorCXJldHVybiBOVUxMOworICAg
IHBhcmFtLmxlbj0wOworICAgIGJ6ZXJvKCZwYXJhbS5maWx0ZXIsIHNpemVvZihwYXJhbS5maWx0
ZXIpKTsKKyAgICBiemVybygmZmlsdGVyLCBzaXplb2YoZmlsdGVyKSk7CisgICAgCisgICAgZm9y
KGk9MDsgaTxpbmxlbjsgaSsrKQorCWlmKG9wdHMtPmRlY29kZV9jYigodWludCkodW5zaWduZWQg
Y2hhcilpbltpXSwgJmZpbHRlciwgcmVhbF9vdXRfY2IsICh2b2lkICopJnBhcmFtKSkgeworCSAg
ICBmcmVlKHBhcmFtLm91dCk7CisJICAgIHJldHVybiBOVUxMOworCX0KKworICAgIGlmKG9wdHMt
PmZsdXNoX2RlY29kZSkKKwlpZihvcHRzLT5mbHVzaF9kZWNvZGUoJmZpbHRlciwgcmVhbF9vdXRf
Y2IsICh2b2lkICopJnBhcmFtKSkgeworCSAgICBmcmVlKHBhcmFtLm91dCk7CisJICAgIHJldHVy
biBOVUxMOworCX0KKyAgICBpZihvcHRzLT5mbHVzaF9lbmNvZGUpCisJaWYob3B0cy0+Zmx1c2hf
ZW5jb2RlKCZwYXJhbS5maWx0ZXIsIHdyaXRlX291dF9jYiwgKHZvaWQgKikmcGFyYW0ubGVuKSkg
eworCSAgICBmcmVlKHBhcmFtLm91dCk7CisJICAgIHJldHVybiBOVUxMOworCX0KKworICAgICpv
dXRsZW4gPSBwYXJhbS5sZW47CisgICAgcmV0dXJuIHBhcmFtLm91dDsKK30KKworZXh0ZXJuIGNo
YXIgKnV0ZjhfdG9fbXV0ZjcoY2hhciAqaW4sIGludCBpbmxlbiwgaW50ICpvdXRsZW4pCit7Cisg
ICAgY29udmVydF9vcHRzIG9wdHM7CisKKyAgICBvcHRzLmVuY29kZV9jYiA9IG11dGY3X2VuY29k
ZTsKKyAgICBvcHRzLmRlY29kZV9jYiA9IHV0ZjhfZGVjb2RlOworICAgIG9wdHMuZmx1c2hfZW5j
b2RlID0gbXV0ZjdfZW5jb2RlX2ZsdXNoOworICAgIG9wdHMuZmx1c2hfZGVjb2RlID0gTlVMTDsK
KworICAgIHJldHVybiBkb19jb252ZXJzaW9uKCZvcHRzLCBpbiwgaW5sZW4sIG91dGxlbik7Cit9
CisKK2V4dGVybiBjaGFyICptdXRmN190b191dGY4KGNoYXIgKmluLCBpbnQgaW5sZW4sIGludCAq
b3V0bGVuKQoreworICAgIGNvbnZlcnRfb3B0cyBvcHRzOworCisgICAgb3B0cy5lbmNvZGVfY2Ig
PSB1dGY4X2VuY29kZTsKKyAgICBvcHRzLmRlY29kZV9jYiA9IG11dGY3X2RlY29kZTsKKyAgICBv
cHRzLmZsdXNoX2VuY29kZSA9IE5VTEw7CisgICAgb3B0cy5mbHVzaF9kZWNvZGUgPSBOVUxMOwor
CisgICAgcmV0dXJuIGRvX2NvbnZlcnNpb24oJm9wdHMsIGluLCBpbmxlbiwgb3V0bGVuKTsKK30K
ZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9jaGFyc2V0X2NvbnZlcnQuaCBj
eXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9jaGFyc2V0X2NvbnZlcnQuaAotLS0gY3lydXMtaW1hcGQt
Mi4yLjEyLm9sZC9pbWFwL2NoYXJzZXRfY29udmVydC5oCTE5NzAtMDEtMDEgMDM6MDA6MDAgKzAz
MDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL2NoYXJzZXRfY29udmVydC5oCTIwMDUtMTIt
MzAgMTU6MTQ6MzEgKzAzMDAKQEAgLTAsMCArMSw3IEBACisjaWZuZGVmIF9DSEFSU0VUX0NPTlZF
UlRfSAorI2RlZmluZSBfQ0hBUlNFVF9DT05WRVJUX0gKKworZXh0ZXJuIGNoYXIgKnV0ZjhfdG9f
bXV0ZjcoY2hhciAqaW4sIGludCBpbmxlbiwgaW50ICpvdXRsZW4pOworZXh0ZXJuIGNoYXIgKm11
dGY3X3RvX3V0ZjgoY2hhciAqaW4sIGludCBpbmxlbiwgaW50ICpvdXRsZW4pOworCisjZW5kaWYg
LyogX0NIQVJTRVRfQ09OVkVSVF9IICovCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xk
L2ltYXAvZ2xvYmFsLmMgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvZ2xvYmFsLmMKLS0tIGN5cnVz
LWltYXBkLTIuMi4xMi5vbGQvaW1hcC9nbG9iYWwuYwkyMDA0LTExLTIzIDIwOjQwOjE1ICswMzAw
CisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9nbG9iYWwuYwkyMDA1LTEyLTMwIDE1OjEzOjU4
ICswMzAwCkBAIC05Miw2ICs5Miw5IEBACiAjaWZkZWYgV0lUSF9QVFMKIHN0cnVjdCBjeXJ1c2Ri
X2JhY2tlbmQgKmNvbmZpZ19wdHNjYWNoZV9kYjsKICNlbmRpZgorI2lmZGVmIEVOQUJMRV9DT05W
RVJUX1VTRVJJRAorc3RydWN0IGN5cnVzZGJfYmFja2VuZCAqY29uZmlnX2NvbnZlcnR1c2VyaWRf
Y2FjaGVfZGI7CisjZW5kaWYKIAogLyogQ2FsbGVkIGJlZm9yZSBhIGN5cnVzIGFwcGxpY2F0aW9u
IHN0YXJ0cyAoYnV0IGFmdGVyIGNvbW1hbmQgbGluZSBwYXJhbWV0ZXJzCiAgKiBhcmUgcmVhZCkg
Ki8KQEAgLTE4Myw2ICsxODYsMTEgQEAKIAljb25maWdfcHRzY2FjaGVfZGIgPQogCSAgICBjeXJ1
c2RiX2Zyb21uYW1lKGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QVFNDQUNIRV9EQikpOwogI2Vu
ZGlmCisjaWZkZWYgRU5BQkxFX0NPTlZFUlRfVVNFUklECisJY29uZmlnX2NvbnZlcnR1c2VyaWRf
Y2FjaGVfZGIgPQorCSAgICAocCA9IChjaGFyICopY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0NP
TlZFUlRVU0VSSURfQ0FDSEVfREIpKT8KKwkgICAgY3lydXNkYl9mcm9tbmFtZShwKSA6IE5VTEw7
CisjZW5kaWYKIAogCS8qIGNvbmZpZ3VyZSBsaWJjeXJ1cyBhcyBuZWVkZWQgKi8KIAlsaWJjeXJ1
c19jb25maWdfc2V0c3RyaW5nKENZUlVTT1BUX0NPTkZJR19ESVIsIGNvbmZpZ19kaXIpOwpkaWZm
IC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL2ltYXBkLmMgY3lydXMtaW1hcGQtMi4y
LjEyL2ltYXAvaW1hcGQuYwotLS0gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL2ltYXBkLmMJ
MjAwNS0xMi0zMCAxMjo1NjoyNCArMDMwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvaW1h
cGQuYwkyMDA1LTEyLTMwIDE1OjEzOjU4ICswMzAwCkBAIC04MCw2ICs4MCw5IEBACiAjaW5jbHVk
ZSAibWFpbGJveC5oIgogI2luY2x1ZGUgIm1lc3NhZ2UuaCIKICNpbmNsdWRlICJtYm94bmFtZS5o
IgorI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorI2luY2x1ZGUgImxkYXBkLmgiCisjZW5k
aWYKICNpbmNsdWRlICJtYm94bGlzdC5oIgogI2luY2x1ZGUgIm1iZHVtcC5oIgogI2luY2x1ZGUg
Im1rZ210aW1lLmgiCkBAIC00NzcsNiArNDgwLDExIEBACiAgICAgfQogI2VuZGlmCiAKKyNpZmRl
ZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKyAgICBpZihpbWFwZF9jb252ZXJ0dXNlcmlkKQorCW1i
b3huYW1lX2NsZWFudXAoKTsKKyNlbmRpZiAvKiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQgKi8KKwog
ICAgIGN5cnVzX3Jlc2V0X3N0ZGlvKCk7IAogCiAgICAgc3RyY3B5KGltYXBkX2NsaWVudGhvc3Qs
ICJbbG9jYWxdIik7CkBAIC01NTMsNiArNTYxLDExIEBACiAJCQkJICAgMSwgJy4nLCAtMSkpCiAJ
ZmF0YWwoImNhbm5vdCBpbml0aWFsaXplIHRoZSBpbnRlcm5hbCBuYW1lc3BhY2UiLCBFQ19URU1Q
RkFJTCk7CiAKKyNpZmRlZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKyAgICBpZihjb252ZXJ0dXNl
cmlkX2luaXQoKSkKKyAgICAgICBmYXRhbCgiY29udmVydHVzZXJpZF9pbml0KCkgZmFpbGVkIiwg
RUNfQ09ORklHKTsKKyNlbmRpZiAvKiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQgKi8KKwogICAgIC8q
IG9wZW4gdGhlIG1ib3hsaXN0LCB3ZSdsbCBuZWVkIGl0IGZvciByZWFsIHdvcmsgKi8KICAgICBt
Ym94bGlzdF9pbml0KDApOwogICAgIG1ib3hsaXN0X29wZW4oTlVMTCk7CkBAIC02MjQsNiArNjM3
LDExIEBACiAgICAgaW1hcGRfaW4gPSBwcm90X25ldygwLCAwKTsKICAgICBpbWFwZF9vdXQgPSBw
cm90X25ldygxLCAxKTsKIAorI2lmZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICAgIGlmKGNv
bnZlcnR1c2VyaWRfY29uZmlnX3JlcmVhZCgpKQorCWZhdGFsKCJDYW4ndCByZXJlYWQgY29uZmln
dXJhdGlvbiBmaWxlcyIsIEVDX0NPTkZJRyk7CisjZW5kaWYKKwogICAgIC8qIEZpbmQgb3V0IG5h
bWUgb2YgY2xpZW50IGhvc3QgKi8KICAgICBzYWxlbiA9IHNpemVvZihpbWFwZF9yZW1vdGVhZGRy
KTsKICAgICBpZiAoZ2V0cGVlcm5hbWUoMCwgKHN0cnVjdCBzb2NrYWRkciAqKSZpbWFwZF9yZW1v
dGVhZGRyLCAmc2FsZW4pID09IDAgJiYKQEAgLTcwOCw2ICs3MjYsOSBAQAogLyogQ2FsbGVkIGJ5
IHNlcnZpY2UgQVBJIHRvIHNodXQgZG93biB0aGUgc2VydmljZSAqLwogdm9pZCBzZXJ2aWNlX2Fi
b3J0KGludCBlcnJvcikKIHsKKyNpZmRlZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKyAgICBjb252
ZXJ0dXNlcmlkX2NsZWFudXAoKTsKKyNlbmRpZiAvKiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQgKi8K
ICAgICBzaHV0X2Rvd24oZXJyb3IpOwogfQogCkBAIC0xNjk5LDYgKzE3MjAsNTIgQEAKICAgICB9
CiB9CiAKK3N0YXRpYyB2b2lkIGltYXBkX2xvZ2dlZHVzZXJfaW5pdCgpCit7CisjaWZkZWYgRU5B
QkxFX0NPTlZFUlRfVVNFUklECisgICAgY2hhciAqZXhlbXB0czsKKworICAgIGlmKCFpbWFwZF9u
YW1lc3BhY2UuaXNhbHQpCisJcmV0dXJuOworICAgIAorICAgIGltYXBkX2NvbnZlcnR1c2VyaWQg
PSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQ09OVkVSVFVTRVJJRCk7CisgICAgZXhlbXB0cyA9
IChjaGFyICopY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VSSURfRVhFTVBUUyk7
CisKKyAgICBpZihleGVtcHRzKSB7CisJLyogbG9vayBmb3IgdXNlcmlkIGluc2lkZSAnZXhlbXB0
cycgc3RyaW5nICovCisJY2hhciAqcD1leGVtcHRzOworCWNoYXIgKm47CisJaW50IHVzZXJpZF9s
ZW49c3RybGVuKGltYXBkX3VzZXJpZCk7CisKKwlkbyB7CisJICAgIGZvcig7ICpwPT0nICc7IHAr
Kyk7CisJICAgIGlmKCpwKSB7CisJCWludCByZXM7CisJCWludCBjX2xlbjsKKworCQluPXN0cmNo
cihwLCAnICcpOworCQkKKwkJY19sZW4gPSBuID8gKG4tcCk6IHN0cmxlbihwKTsKKworCQlpZihj
X2xlbj09dXNlcmlkX2xlbiAmJiAhbWVtY21wKGltYXBkX3VzZXJpZCwgcCwgdXNlcmlkX2xlbikp
IHsKKwkJICAgIC8qIHVzZXJpZCBoYXMgYmVlbiBmb3VuZCEgc3dpdGNoIGNvbnZlcnR1c2VyaWQK
KwkJICAgICAgIG9wdGlvbiAqLworCQkgICAgaW1hcGRfY29udmVydHVzZXJpZCA9ICFpbWFwZF9j
b252ZXJ0dXNlcmlkOworCQkgICAgYnJlYWs7CisJCX0KKworCQlwPW47CisJICAgIH0KKwl9IHdo
aWxlKHApOworICAgIH0KKyAgICBpZihpbWFwZF9jb252ZXJ0dXNlcmlkKSB7CisJaW1hcGRfbm9u
Y29udmVydGVkdXNlcmlkX2FsbG93ZWQgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQ09OVkVS
VFVTRVJJRF9BTExPV19OT05DT05WRVJURUQpOworCWltYXBkX2RvbnRpZ25vcmVfY29udmVydHVz
ZXJpZF9lcnJvcnMgPSBjb25maWdfZ2V0c3dpdGNoKElNQVBPUFRfQ09OVkVSVFVTRVJJRF9ET05U
SUdOT1JFX0VSUk9SUyk7CisJaW1hcGRfY29udmVydHVzZXJpZF9hY3R1YWxfdGltZW91dCA9IGNv
bmZpZ19nZXRpbnQoSU1BUE9QVF9DT05WRVJUVVNFUklEX0FDVFVBTF9USU1FT1VUKTsKKyAgICB9
CisjZW5kaWYKK30KKwogc3RhdGljIHZvaWQgdXNlcmlkX3RvaW50ZXJuYWwoc3RydWN0IG5hbWVz
cGFjZSAqbmFtZXNwYWNlLCBjaGFyICp1c2VyaWQpCiB7CiAgICAgY2hhciBoaWVyc2VwX29yaWcg
PSBuYW1lc3BhY2UtPmhpZXJfc2VwOwpAQCAtMTg5OCw2ICsxOTY1LDcgQEAKIAogICAgIC8qIFRy
YW5zbGF0ZSBhbnkgc2VwYXJhdG9ycyBpbiB1c2VyaWQgKi8KICAgICB1c2VyaWRfdG9pbnRlcm5h
bCgmaW1hcGRfbmFtZXNwYWNlLCBpbWFwZF91c2VyaWQpOworICAgIGltYXBkX2xvZ2dlZHVzZXJf
aW5pdCgpOwogCiAgICAgZnJlZWJ1ZigmcGFzc3dkYnVmKTsKIApAQCAtMjA0NSw2ICsyMTEzLDcg
QEAKIAogICAgIC8qIFRyYW5zbGF0ZSBhbnkgc2VwYXJhdG9ycyBpbiB1c2VyaWQgKi8KICAgICB1
c2VyaWRfdG9pbnRlcm5hbCgmaW1hcGRfbmFtZXNwYWNlLCBpbWFwZF91c2VyaWQpOworICAgIGlt
YXBkX2xvZ2dlZHVzZXJfaW5pdCgpOwogCiAgICAgYXV0b2NyZWF0ZV9pbmJveCgpOwogCmRpZmYg
LXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvbGRhcGQuYyBjeXJ1cy1pbWFwZC0yLjIu
MTIvaW1hcC9sZGFwZC5jCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvbGRhcGQuYwkx
OTcwLTAxLTAxIDAzOjAwOjAwICswMzAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9sZGFw
ZC5jCTIwMDUtMTItMzAgMTU6MTk6MDUgKzAzMDAKQEAgLTAsMCArMSw0NjggQEAKKyNpZmRlZiBI
QVZFX0NPTkZJR19ICisjaW5jbHVkZSA8Y29uZmlnLmg+CisjZW5kaWYKKworI2luY2x1ZGUgPHN5
cy90eXBlcy5oPgorI2luY2x1ZGUgPHN5cy9zb2NrZXQuaD4KKyNpbmNsdWRlIDxuZXRpbmV0L2lu
Lmg+CisjaW5jbHVkZSA8YXJwYS9pbmV0Lmg+CisjaW5jbHVkZSA8c3lzL3VuLmg+CisjaW5jbHVk
ZSA8c3lzbG9nLmg+CisjaW5jbHVkZSA8c3lzL3N0YXQuaD4KKyNpbmNsdWRlIDxzdGRpby5oPgor
I2luY2x1ZGUgPHN0ZGxpYi5oPgorI2luY2x1ZGUgPHN0cmluZy5oPgorI2luY2x1ZGUgPGVycm5v
Lmg+CisjZGVmaW5lIF9HTlVfU09VUkNFCisjaW5jbHVkZSA8Z2V0b3B0Lmg+CisjaW5jbHVkZSA8
YXNzZXJ0Lmg+CisjaWZkZWYgSEFWRV9VTklTVERfSAorI2luY2x1ZGUgPHVuaXN0ZC5oPgorI2Vu
ZGlmCisjaW5jbHVkZSA8bGJlci5oPgorI2luY2x1ZGUgPGxkYXAuaD4KKworI2luY2x1ZGUgImxk
YXBkLmgiCisjaW5jbHVkZSAiZ2xvYmFsLmgiCisjaW5jbHVkZSAiY2hhcnNldF9jb252ZXJ0Lmgi
CisjaW5jbHVkZSAiZXhpdGNvZGVzLmgiCisKKy8qIGdsb2JhbCBzdGF0ZSAqLworY29uc3QgaW50
IGNvbmZpZ19uZWVkX2RhdGEgPSAwOworCitzdGF0aWMgTERBUCAqbGRhcF9zZXNzaW9uPU5VTEw7
CisKKyNkZWZpbmUgTERBUF9GSUxURVJfVEVNUExBVEUgIiglcz0lJS4qcykiCisjZGVmaW5lIExE
QVBfRklMVEVSX1RFTVBMQVRFU0laRSAoc2l6ZW9mKExEQVBfRklMVEVSX1RFTVBMQVRFKS9zaXpl
b2YoY2hhcikpCisKKyNkZWZpbmUgTERBUF9ET01BSU5GSUxURVJfVEVNUExBVEUgIiglcz0lJS4q
cywlcz0lJS4qcykiCisjZGVmaW5lIExEQVBfRE9NQUlORklMVEVSX1RFTVBMQVRFU0laRSAoc2l6
ZW9mKExEQVBfRE9NQUlORklMVEVSX1RFTVBMQVRFKS9zaXplb2YoY2hhcikpCisKKy8qIG9wdGlv
bnMgd2hpY2ggd2FzIHJlYWQgZnJvbSBjb25maWd1cmF0aW9uIGZpbGVzICovCitzdGF0aWMgY29u
c3QgY2hhciAqbGRhcF9ob3N0Oworc3RhdGljIGNvbnN0IGNoYXIgKmxkYXBkX2xvY2FsaG9zdDsK
K3N0YXRpYyBpbnQgbGRhcF9wb3J0Oworc3RhdGljIGNvbnN0IGNoYXIgKmxkYXBfdXNlcjsKK3N0
YXRpYyBjb25zdCBjaGFyICpsZGFwX3Bhc3N3b3JkOworc3RhdGljIGNvbnN0IGNoYXIgKmxkYXBf
YmFzZTsKK3N0YXRpYyBjb25zdCBjaGFyICpsZGFwX2F0dHJfaW50Oworc3RhdGljIGNvbnN0IGNo
YXIgKmxkYXBfYXR0cl9leHQ7CitzdGF0aWMgY29uc3QgY2hhciAqbGRhcF9hdHRyX2RvbWFpbjsK
K3N0YXRpYyBjaGFyICpsZGFwX2ZpbHRlcl9pbnQ7CitzdGF0aWMgY2hhciAqbGRhcF9maWx0ZXJf
ZXh0Oworc3RhdGljIGludCBsZGFwX2ZpbHRlcl9pbnRfbGVuOworc3RhdGljIGludCBsZGFwX2Zp
bHRlcl9leHRfbGVuOworc3RhdGljIGludCBsZGFwX3F1ZXJ5X2RvbWFpbnM7CisKK3N0YXRpYyBp
bnQgbl9saXN0ZW5lcnM9MDsKKwordm9pZCBmYXRhbChjb25zdCBjaGFyICptc2csIGludCBlcnIp
Cit7CisgICAgc3lzbG9nKExPR19DUklULCAiJXMiLCBtc2cpOworICAgIHN5c2xvZyhMT0dfTk9U
SUNFLCAiZXhpdGluZyIpOworCisgICAgY3lydXNfZG9uZSgpOworICAgIAorICAgIGV4aXQoZXJy
KTsKK30KKworc3RhdGljIHZvaWQgbGRhcF9jbGVhbnVwKCkKK3sKKyAgICBpZihsZGFwX3Nlc3Np
b24pIHsKKwlsZGFwX3VuYmluZF9zKGxkYXBfc2Vzc2lvbik7CisJbGRhcF9zZXNzaW9uPU5VTEw7
CisgICAgfQorfQorCitzdGF0aWMgaW50IGxkYXBfaW5pdF9pZl9uZWVkZWQoKQoreworICAgIGlm
KCFsZGFwX3Nlc3Npb24pIHsKKwlpZighKGxkYXBfc2Vzc2lvbiA9IGxkYXBfaW5pdChsZGFwX2hv
c3QsIGxkYXBfcG9ydCkpIHx8CisJICAgbGRhcF9zZXRfb3B0aW9uKGxkYXBfc2Vzc2lvbiwgTERB
UF9PUFRfUkVTVEFSVCwgTERBUF9PUFRfT04pPT0tMSB8fAorCSAgIGxkYXBfc2ltcGxlX2JpbmRf
cyhsZGFwX3Nlc3Npb24sIGxkYXBfdXNlciwgbGRhcF9wYXNzd29yZCkhPUxEQVBfU1VDQ0VTUykg
eworCSAgICBsZGFwX2NsZWFudXAoKTsKKwkgICAgcmV0dXJuIENPTlZFUlRVU0VSSURfTERBUEZB
SUxFRDsKKwl9CisgICAgfQorICAgIHJldHVybiAwOworfQorCisjZGVmaW5lIEZSRUVfTERBUF9S
RVNVTFQodmFscywgbGRhcF9yZXMpIFwKK2RvIHsgXAoraWYodmFscykgXAorICAgIGxkYXBfdmFs
dWVfZnJlZSh2YWxzKTsgXAorbGRhcF9tc2dmcmVlKGxkYXBfcmVzKTsgXAorfSB3aGlsZSgwKTsK
Kworc3RhdGljIGludCBnZXRfaWRfZnJvbV9sZGFwKGNvbnN0IGNoYXIgKmluLCBpbnQgaW5fbGVu
LCBjb25zdCBjaGFyICpkb21haW4sIGludCBkb21haW5sZW4sIGNoYXIgKm91dCwgaW50ICpvdXRf
bGVuLCBpbnQgaW50MmV4dCkKK3sKKyAgICBMREFQTWVzc2FnZSAqbGRhcF9yZXM7CisgICAgY2hh
ciAqaW5fbGRhcDsKKyAgICBpbnQgaW5fbGRhcF9sZW47CisgICAgY29uc3QgY2hhciAqbGRhcF9m
aWx0ZXJfdGVtcGxhdGU7CisgICAgaW50IGxkYXBfZmlsdGVyX3RlbXBsYXRlX2xlbjsKKyAgICBj
aGFyICpsZGFwX2ZpbHRlcjsKKyAgICBjaGFyICpsZGFwX2F0dHJzWzJdOworCisgICAgLyogSW5w
dXQgYnVmZmVyICdpbicgaXMgTVVURi03IHN0cmluZyBpbiBjYXNlIGlmCisgICAgICAgZXh0ZXJu
YWw9PmludGVybmFsLiBXZSBuZWVkIHRvIGNvbnZlcnQgaXQgdG8gVVRGLTggZW5jb2RpbmcKKyAg
ICAgICBiZWZvcmUgcXVlcnlpbmcgdG8gTERBUC4gKi8KKyAgICBpZighaW50MmV4dCkgeworCWNo
YXIgKmluX3Rlc3Q7CisJaW50IGluX3Rlc3RfbGVuOworCisJaWYoIShpbl9sZGFwID0gbXV0Zjdf
dG9fdXRmOCgoY2hhciAqKWluLCBpbl9sZW4sICZpbl9sZGFwX2xlbikpKSB7CisJICAgIHN5c2xv
ZyhMT0dfREVCVUcsICJtdXRmN190b191dGY4KCkgZmFpbGVkLlxuIik7CisJICAgIHJldHVybiBD
T05WRVJUVVNFUklEX1NZU0ZBSUxFRDsKKwl9CisKKwkvKiBDaGVjayBpZiAnaW4nIGlzIGEgdmFs
aWQgaW1hcC11dGYtNyBzdHJpbmcuIE5vdGUgdGhhdCB3ZQorCSAgIGFsc28gZGlzYWxsb3cgaGVy
ZSB0byBoYXZlIG11bHRpcGxlIG11dGYtNyByZXByZXNlbnRhdGlvbnMKKwkgICBvZiBhIFVuaWNv
ZGUgc3RyaW5nLiAqLworCWlmKCEoaW5fdGVzdCA9IHV0ZjhfdG9fbXV0ZjcoaW5fbGRhcCwgaW5f
bGRhcF9sZW4sICZpbl90ZXN0X2xlbikpKSB7CisJICAgIHN5c2xvZyhMT0dfREVCVUcsICJ1dGY4
X3RvX211dGY3KCkgZmFpbGVkIHdoaWxlIGNoZWNraW5nIHVzZXIgdW5wdXQuXG4iKTsKKwkgICAg
ZnJlZShpbl9sZGFwKTsKKwkgICAgcmV0dXJuIENPTlZFUlRVU0VSSURfU1lTRkFJTEVEOworCX0K
KworCWlmKGluX3Rlc3RfbGVuIT1pbl9sZW4gfHwgbWVtY21wKGluLCBpbl90ZXN0LCBpbl9sZW4p
KSB7CisJICAgIHN5c2xvZyhMT0dfREVCVUcsICJJbmNvcnJlY3QgTVVURi03IHN0cmluZyByZWNl
aXZlZC5cbiIpOworCSAgICBmcmVlKGluX2xkYXApOworCSAgICBmcmVlKGluX3Rlc3QpOworCSAg
ICByZXR1cm4gQ09OVkVSVFVTRVJJRF9TWVNGQUlMRUQ7CisJfQorCWZyZWUoaW5fdGVzdCk7CisK
KwlsZGFwX2ZpbHRlcl90ZW1wbGF0ZSA9IGxkYXBfZmlsdGVyX2V4dDsKKwlsZGFwX2ZpbHRlcl90
ZW1wbGF0ZV9sZW4gPSBsZGFwX2ZpbHRlcl9leHRfbGVuOworCWxkYXBfYXR0cnNbMF0gPSAoY2hh
ciAqKWxkYXBfYXR0cl9pbnQ7CisgICAgfQorICAgIGVsc2UgeworCWluX2xkYXAgPSAoY2hhciAq
KWluOworCWluX2xkYXBfbGVuID0gaW5fbGVuOworCWxkYXBfZmlsdGVyX3RlbXBsYXRlID0gbGRh
cF9maWx0ZXJfaW50OworCWxkYXBfZmlsdGVyX3RlbXBsYXRlX2xlbiA9IGxkYXBfZmlsdGVyX2lu
dF9sZW47CisJbGRhcF9hdHRyc1swXSA9IChjaGFyICopbGRhcF9hdHRyX2V4dDsKKyAgICB9CisK
KyAgICBsZGFwX2F0dHJzWzFdPU5VTEw7CisKKyAgICAvKiBpZiB0aGUgY29ubmVjdGlvbiB0byBM
REFQIHNlcnZlciBpcyBub3QgZXN0YWJsaXNoZWQgdGhlbiB0cnkgdG8KKyAgICAgICBlc3RhYmxp
c2ggaXQgKi8KKyAgICBpZihsZGFwX2luaXRfaWZfbmVlZGVkKCkpIHsKKwlzeXNsb2coTE9HX0RF
QlVHLCAiQ2Fubm90IGluaXRpYWxpemUgTERBUCBjbGllbnQgbGlicmFyeSFcbiIpOworCXJldHVy
biBDT05WRVJUVVNFUklEX0xEQVBGQUlMRUQ7CisgICAgfQorCisgICAgLyogdGhlIGFsbG9jYXRl
ZCBidWZmZXIgaXMgYmlnZ2VyIHRoYW4gbmVlZGVkOiB0ZW1wbGF0ZSBoYXZlCisgICAgICAgIiUu
KnMiIHN0cmluZ3Mgd2l0aGluIGl0IHdoaWNoIGFyZSByZXBsYWNlZCB0byBpbl9sZGFwIGFuZAor
ICAgICAgIGRvbWFpbiBzdHJpbmdzICovCisgICAgbGRhcF9maWx0ZXIgPSAoY2hhciAqKW1hbGxv
YyhsZGFwX2ZpbHRlcl90ZW1wbGF0ZV9sZW4raW5fbGRhcF9sZW4pOworICAgIGlmKCFsZGFwX2Zp
bHRlcikgeworCWlmKGluX2xkYXAgIT0gaW4pCisJICAgIGZyZWUoaW5fbGRhcCk7CisJcmV0dXJu
IENPTlZFUlRVU0VSSURfU1lTRkFJTEVEOworICAgIH0KKworICAgIC8qIGlmIHdlIGFyZW4ndCB1
c2luZyBkb21haW5zIGluIExEQVAgcXVlcmllcyB0aGVuIHRoZSBsYXN0IHR3bworICAgICAgIGFy
Z3VtZW50cyB3b24ndCBiZSB1c2VkIGJ5IHRoZSBzcHJpbnRmIGZ1bmN0aW9uICovCisgICAgc3By
aW50ZihsZGFwX2ZpbHRlciwgbGRhcF9maWx0ZXJfdGVtcGxhdGUsIGluX2xkYXBfbGVuLCBpbl9s
ZGFwLCBkb21haW5sZW4sIGRvbWFpbik7CisKKyAgICBpZihsZGFwX3NlYXJjaF9zKGxkYXBfc2Vz
c2lvbiwgbGRhcF9iYXNlLCBMREFQX1NDT1BFX1NVQlRSRUUsIGxkYXBfZmlsdGVyLCBsZGFwX2F0
dHJzLCAwLCAmbGRhcF9yZXMpIT1MREFQX1NVQ0NFU1MpIHsKKwlzeXNsb2coTE9HX0RFQlVHLCAi
bGRhcF9zZWFyY2hfcygpIGZhaWxlZCEgV2lsbCB0cnkgdG8gcmVjb25uZWN0LlxuIik7CisJbGRh
cF9jbGVhbnVwKCk7CisKKwlpZihsZGFwX2luaXRfaWZfbmVlZGVkKCkpCisJICAgIHN5c2xvZyhM
T0dfREVCVUcsICJSZWNvbm5lY3QgZmFpbGVkIVxuIik7CisJZWxzZSBpZihsZGFwX3NlYXJjaF9z
KGxkYXBfc2Vzc2lvbiwgbGRhcF9iYXNlLCBMREFQX1NDT1BFX1NVQlRSRUUsIGxkYXBfZmlsdGVy
LCBsZGFwX2F0dHJzLCAwLCAmbGRhcF9yZXMpIT1MREFQX1NVQ0NFU1MpIHsKKwkgICAgc3lzbG9n
KExPR19ERUJVRywgImxkYXBfc2VhcmNoX3MoKSBmYWlsZWQgYWdhaW4hXG4iKTsKKwkgICAgbGRh
cF9jbGVhbnVwKCk7CisJfQorICAgIH0KKworICAgIGlmKGluX2xkYXAgIT0gaW4pCisJZnJlZShp
bl9sZGFwKTsKKyAgICBmcmVlKGxkYXBfZmlsdGVyKTsKKworICAgIC8qIGlmIHF1ZXJ5IGZhaWxl
ZCB0aGVuIHJldHVybiBlcnJvciAqLworICAgIGlmKCFsZGFwX3Nlc3Npb24pCisJcmV0dXJuIENP
TlZFUlRVU0VSSURfTERBUEZBSUxFRDsKKyAgICBlbHNlIHsKKwljaGFyICoqdmFscz1OVUxMOwor
CWNoYXIgKm5vbmVuY29kZWRfb3V0OworCWludCBub25lbmNvZGVkX2xlbjsKKwlpbnQgY291bnRf
ZW50cmllczsKKworCWlmKCFsZGFwX3JlcykgeworCSAgICBzeXNsb2coTE9HX0RFQlVHLCAibGRh
cF9yZXMgaXMgTlVMTCEiKTsKKwkgICAgcmV0dXJuIENPTlZFUlRVU0VSSURfU1lTRkFJTEVEOwor
CX0KKworCS8qIHRoZSBleHRlcm5hbCBuYW1lIGhhc24ndCBiZWVuIGZvdW5kIG9yIHRoZXJlIGFy
ZSBtb3JlIHRoYW4KKwkgICBvbmUgcmVzdWx0IHJlY29yZHMgKi8KKwlpZigoY291bnRfZW50cmll
cz1sZGFwX2NvdW50X2VudHJpZXMobGRhcF9zZXNzaW9uLCBsZGFwX3JlcykpIT0xKSB7CisJICAg
IGlmKGNvdW50X2VudHJpZXMpCisJCXN5c2xvZyhMT0dfREVCVUcsICJsZGFwX2NvdW50X2VudHJp
ZXMoKSByZXR1cm5lZCAlaS5cbiIsIGNvdW50X2VudHJpZXMpOworCisJICAgIEZSRUVfTERBUF9S
RVNVTFQodmFscywgbGRhcF9yZXMpOworCSAgICByZXR1cm4gQ09OVkVSVFVTRVJJRF9OT05FWElT
VEVOVF9JRDsKKwl9CisJZWxzZSB7CisJICAgIExEQVBNZXNzYWdlICplbnRyeTsKKwkgICAgY2hh
ciAqYXR0cjsKKworCSAgICBlbnRyeSA9IGxkYXBfZmlyc3RfZW50cnkobGRhcF9zZXNzaW9uLCBs
ZGFwX3Jlcyk7CisJICAgIGlmKCFlbnRyeSkgeworCQlzeXNsb2coTE9HX0RFQlVHLCAiZW50cnkg
aXMgTlVMTCEiKTsKKworCQlGUkVFX0xEQVBfUkVTVUxUKHZhbHMsIGxkYXBfcmVzKTsKKwkJcmV0
dXJuIENPTlZFUlRVU0VSSURfU1lTRkFJTEVEOworCSAgICB9CisKKwkgICAgdmFscyA9IGxkYXBf
Z2V0X3ZhbHVlcyhsZGFwX3Nlc3Npb24sIGVudHJ5LCBsZGFwX2F0dHJzWzBdKTsKKwkgICAgaWYo
IXZhbHMgfHwgIWxkYXBfY291bnRfdmFsdWVzKHZhbHMpKSB7CisJCWlmKCF2YWxzKQorCQkgICAg
c3lzbG9nKExPR19ERUJVRywgInZhbHMgaXMgTlVMTCEiKTsKKwkJZWxzZQorCQkgICAgc3lzbG9n
KExPR19ERUJVRywgInZhbHMgaXMgRU1QVFkhIik7CisKKwkJRlJFRV9MREFQX1JFU1VMVCh2YWxz
LCBsZGFwX3Jlcyk7CisJCXJldHVybiBDT05WRVJUVVNFUklEX1NZU0ZBSUxFRDsKKwkgICAgfQor
CisJICAgIC8qIHNhdmUgJ3ZhbHNbMF0nIGFzIGFuIGV4dGVybmFsIG5hbWUgYW5kICdpbicgYXMg
YW4gaW50ZXJuYWwKKwkgICAgICAgb25lICovCisJICAgIG5vbmVuY29kZWRfb3V0ID0gdmFsc1sw
XTsKKwkgICAgbm9uZW5jb2RlZF9sZW4gPSBzdHJsZW4obm9uZW5jb2RlZF9vdXQpOworCX0KKwor
CS8qICdub25lbmNvZGVkX291dCcgYnVmZmVyIGlzIGFuIFVURi04IGJ1ZmZlci4gV2UgbmVlZCB0
bworCSAgIGNvbnZlcnQgaXQgdG8gTVVURi03IGVuY29kaW5nIGluIGNhc2UgaWYgaXQgaXMgYW4g
ZXh0ZXJuYWwKKwkgICB1c2VyaWQuICovCisJaWYoaW50MmV4dCkgeworCSAgICBjaGFyICp0ZW1w
X291dCA9IHV0ZjhfdG9fbXV0Zjcobm9uZW5jb2RlZF9vdXQsIG5vbmVuY29kZWRfbGVuLCBvdXRf
bGVuKTsKKwkgICAgaWYoIXRlbXBfb3V0KSB7CisJCXN5c2xvZyhMT0dfREVCVUcsICJ1dGY4X3Rv
X211dGY3KCkgZmFpbGVkLlxuIik7CisKKwkJRlJFRV9MREFQX1JFU1VMVCh2YWxzLCBsZGFwX3Jl
cyk7CisJCXJldHVybiBDT05WRVJUVVNFUklEX1NZU0ZBSUxFRDsKKwkgICAgfQorCSAgICBpZigq
b3V0X2xlbiA+IE1BWF9NQUlMQk9YX05BTUUpIHsKKwkJc3lzbG9nKExPR19ERUJVRywgInRvbyBs
b25nIHV0ZjhfdG9fbXV0ZjcoKSBvdXRwdXQgc3RyaW5nLlxuIik7CisJCSpvdXRfbGVuID0gMDsK
KwkJZnJlZSh0ZW1wX291dCk7CisKKwkJRlJFRV9MREFQX1JFU1VMVCh2YWxzLCBsZGFwX3Jlcyk7
CisJCXJldHVybiBDT05WRVJUVVNFUklEX1NZU0ZBSUxFRDsKKwkgICAgfQorCSAgICBtZW1jcHko
b3V0LCB0ZW1wX291dCwgKm91dF9sZW4pOworCSAgICBmcmVlKHRlbXBfb3V0KTsKKwl9CisJZWxz
ZSB7CisJICAgIG1lbWNweShvdXQsIG5vbmVuY29kZWRfb3V0LCBub25lbmNvZGVkX2xlbik7CisJ
ICAgICpvdXRfbGVuID0gbm9uZW5jb2RlZF9sZW47CisJfQorCisJRlJFRV9MREFQX1JFU1VMVCh2
YWxzLCBsZGFwX3Jlcyk7CisgICAgfQorCisgICAgcmV0dXJuIDA7Cit9CisKKy8qIHJlYWQgY29u
dmVydHVzZXJpZCBMREFQIGNvbmZpZ3VyYXRpb24gb3B0aW9ucyBmcm9tIGNvbmZpZ3VyYXRpb24K
KyAgIGZpbGVzICovCitzdGF0aWMgaW50IHJlYWRfbGRhcF9vcHRpb25zKCkKK3sKKyAgICBpbnQg
bGRhcF9hdHRyX2ludF9sZW47CisgICAgaW50IGxkYXBfYXR0cl9leHRfbGVuOworICAgIGludCBs
ZGFwX2F0dHJfZG9tYWluX2xlbjsKKworICAgIGlmKGNvbmZpZ192aXJ0ZG9tYWlucykKKwlsZGFw
X3F1ZXJ5X2RvbWFpbnMgPSAxOworICAgIGVsc2UKKwlsZGFwX3F1ZXJ5X2RvbWFpbnMgPSBjb25m
aWdfZ2V0c3dpdGNoKElNQVBPUFRfQ09OVkVSVFVTRVJJRF9MREFQX1FVRVJZX0RPTUFJTlMpOwor
ICAgIAorICAgIGxkYXBfaG9zdCA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9DT05WRVJUVVNF
UklEX0xEQVBfSE9TVCk7CisgICAgbGRhcGRfbG9jYWxob3N0ID0gY29uZmlnX2dldHN0cmluZyhJ
TUFQT1BUX0NPTlZFUlRVU0VSSURfTE9DQUxIT1NUKTsKKworICAgIGxkYXBfcG9ydCA9IGNvbmZp
Z19nZXRpbnQoSU1BUE9QVF9DT05WRVJUVVNFUklEX0xEQVBfUE9SVCk7CisgICAgaWYoIWxkYXBf
cG9ydCkKKwlsZGFwX3BvcnQ9TERBUF9QT1JUOworCisgICAgbGRhcF91c2VyID0gY29uZmlnX2dl
dHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9VU0VSKTsKKyAgICBsZGFwX3Bhc3N3
b3JkID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9QQVNTV09S
RCk7CisKKyAgICBsZGFwX2Jhc2UgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQ09OVkVSVFVT
RVJJRF9MREFQX0JBU0UpOworCisgICAgbGRhcF9hdHRyX2ludCA9IGNvbmZpZ19nZXRzdHJpbmco
SU1BUE9QVF9DT05WRVJUVVNFUklEX0xEQVBfQVRUUl9JTlQpOworICAgIGlmKCFsZGFwX2F0dHJf
aW50KSB7CisJc3lzbG9nKExPR19FUlIsICJjb252ZXJ0dXNlcmlkX2xkYXBfYXR0cl9pbnQgb3B0
aW9uIGlzIG5vdCBzZXRcbiIpOworCXJldHVybiAxOworICAgIH0KKyAgICBsZGFwX2F0dHJfZXh0
ID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9BVFRSX0VYVCk7
CisgICAgaWYoIWxkYXBfYXR0cl9leHQpIHsKKwlzeXNsb2coTE9HX0VSUiwgImNvbnZlcnR1c2Vy
aWRfbGRhcF9hdHRyX2V4dCBvcHRpb24gaXMgbm90IHNldFxuIik7CisJcmV0dXJuIDE7CisgICAg
fQorCisgICAgbGRhcF9hdHRyX2ludF9sZW4gPSBzdHJsZW4obGRhcF9hdHRyX2ludCk7CisgICAg
bGRhcF9hdHRyX2V4dF9sZW4gPSBzdHJsZW4obGRhcF9hdHRyX2V4dCk7CisKKyAgICBpZihsZGFw
X3F1ZXJ5X2RvbWFpbnMpIHsKKwlsZGFwX2F0dHJfZG9tYWluID0gY29uZmlnX2dldHN0cmluZyhJ
TUFQT1BUX0NPTlZFUlRVU0VSSURfTERBUF9BVFRSX0RPTUFJTik7CisJbGRhcF9hdHRyX2RvbWFp
bl9sZW4gPSBzdHJsZW4obGRhcF9hdHRyX2RvbWFpbik7CisJbGRhcF9maWx0ZXJfaW50X2xlbiA9
IGxkYXBfYXR0cl9pbnRfbGVuICsgbGRhcF9hdHRyX2RvbWFpbl9sZW4gKyBMREFQX0RPTUFJTkZJ
TFRFUl9URU1QTEFURVNJWkU7CisJbGRhcF9maWx0ZXJfZXh0X2xlbiA9IGxkYXBfYXR0cl9leHRf
bGVuICsgbGRhcF9hdHRyX2RvbWFpbl9sZW4gKyBMREFQX0RPTUFJTkZJTFRFUl9URU1QTEFURVNJ
WkU7CisgICAgfQorICAgIGVsc2UgeworCWxkYXBfYXR0cl9kb21haW4gPSBOVUxMOworCWxkYXBf
YXR0cl9kb21haW5fbGVuID0gMDsKKwlsZGFwX2ZpbHRlcl9pbnRfbGVuID0gbGRhcF9hdHRyX2lu
dF9sZW4gKyBMREFQX0ZJTFRFUl9URU1QTEFURVNJWkU7CisJbGRhcF9maWx0ZXJfZXh0X2xlbiA9
IGxkYXBfYXR0cl9leHRfbGVuICsgTERBUF9GSUxURVJfVEVNUExBVEVTSVpFOworICAgIH0KKwor
ICAgIGxkYXBfZmlsdGVyX2ludCA9IChjaGFyICopbWFsbG9jKGxkYXBfZmlsdGVyX2ludF9sZW4p
OworICAgIGlmKCFsZGFwX2ZpbHRlcl9pbnQpIHsKKwlzeXNsb2coTE9HX0VSUiwgIm1lbW9yeSBh
bGxvY2F0aW9uIHdhcyBmYWlsZWRcbiIpOworCXJldHVybiAxOworICAgIH0KKyAgICBsZGFwX2Zp
bHRlcl9leHQgPSAoY2hhciAqKW1hbGxvYyhsZGFwX2ZpbHRlcl9leHRfbGVuKTsKKyAgICBpZigh
bGRhcF9maWx0ZXJfZXh0KSB7CisJc3lzbG9nKExPR19FUlIsICJtZW1vcnkgYWxsb2NhdGlvbiB3
YXMgZmFpbGVkXG4iKTsKKwlmcmVlKGxkYXBfZmlsdGVyX2ludCk7CisJcmV0dXJuIDE7CisgICAg
fQorICAgIHNwcmludGYobGRhcF9maWx0ZXJfaW50LCBsZGFwX3F1ZXJ5X2RvbWFpbnM/TERBUF9E
T01BSU5GSUxURVJfVEVNUExBVEU6TERBUF9GSUxURVJfVEVNUExBVEUsIGxkYXBfYXR0cl9pbnQs
IGxkYXBfYXR0cl9kb21haW4pOworICAgIHNwcmludGYobGRhcF9maWx0ZXJfZXh0LCBsZGFwX3F1
ZXJ5X2RvbWFpbnM/TERBUF9ET01BSU5GSUxURVJfVEVNUExBVEU6TERBUF9GSUxURVJfVEVNUExB
VEUsIGxkYXBfYXR0cl9leHQsIGxkYXBfYXR0cl9kb21haW4pOworCisgICAgcmV0dXJuIDA7Cit9
CisKK2ludCBtYWluKGludCBhcmdjLCBjaGFyICoqYXJndikKK3sKKyAgICBpbnQgb3B0OworICAg
IGludCBzLCBsZW47CisgICAgc3RydWN0IHNvY2thZGRyX2luIGxvY2FsOworICAgIGxkYXBfZGF0
YV90IGxkYXBkYXRhOworICAgIGxkYXBfZGF0YV9yZXN1bHRfdCBsZGFwZGF0YV9yZXN1bHQ7Cisg
ICAgc3RydWN0IHNvY2thZGRyX2luIGZyb207CisgICAgc29ja2xlbl90IGZyb21sZW47CisgICAg
cGlkX3QgcGlkOworICAgIGludCBmZDsKKyAgICBjaGFyICphbHRfY29uZmlnID0gTlVMTDsKKyAg
ICBpbnQgY3VyY2hpbGQ7CisgICAgaW50IHBvcnRfbnVtOworICAgIHN0cnVjdCBvcHRpb24gbG9u
Z29wdHNbXT17CisJeyJwcmVmb3JrIiwgMSwgTlVMTCwgJ24nfSwKKwl7TlVMTCwgMCwgTlVMTCwg
MH0sCisgICAgfTsKKworICAgIHdoaWxlICgob3B0ID0gZ2V0b3B0X2xvbmcoYXJnYywgYXJndiwg
IkM6bjoiLCBsb25nb3B0cywgTlVMTCkpICE9IEVPRikgeworCXN3aXRjaCAob3B0KSB7CisgICAg
ICAgIGNhc2UgJ0MnOiAvKiBhbHQgY29uZmlnIGZpbGUgKi8KKyAgICAgICAgICAgIGFsdF9jb25m
aWcgPSBvcHRhcmc7CisgICAgICAgICAgICBicmVhazsKKwljYXNlICduJzoKKwkgICAgbl9saXN0
ZW5lcnMgPSBhdG9pKG9wdGFyZyk7CisJICAgIGlmKG5fbGlzdGVuZXJzPD0wKSB7CisJCWZwcmlu
dGYoc3RkZXJyLCAiaW52YWxpZCBudW1iZXIgb2YgbGlzdGVuZXIgcHJvY2Vzc2VzXG4iKTsKKwkJ
ZXhpdChFQ19VU0FHRSk7CisJICAgIH0KKwkgICAgYnJlYWs7CisJZGVmYXVsdDoKKwkgICAgZnBy
aW50ZihzdGRlcnIsICJpbnZhbGlkIGFyZ3VtZW50XG4iKTsKKwkgICAgZXhpdChFQ19VU0FHRSk7
CisJICAgIGJyZWFrOworCX0KKyAgICB9CisKKyAgICAvKiBzZXQgZGVmYXVsdCBudW1iZXIgb2Yg
bGlzdGVuZXJzIGlmIG5lZWRlZCAqLworICAgIGlmKCFuX2xpc3RlbmVycykKKwluX2xpc3RlbmVy
cz0xOworCisgICAgY3lydXNfaW5pdChhbHRfY29uZmlnLCAibGRhcGQiLCAwKTsKKworICAgIHBv
cnRfbnVtID0gY29uZmlnX2dldGludChJTUFQT1BUX0NPTlZFUlRVU0VSSURfVURQUE9SVCk7CisK
KyAgICBpZihyZWFkX2xkYXBfb3B0aW9ucygpKQorCWV4aXQoMSk7CisKKyAgICAvKiBjcmVhdGUg
c29ja2V0IHdlIGFyZSBnb2luZyB0byB1c2UgZm9yIGxpc3RlbmluZyAqLworICAgIGlmICgocyA9
IHNvY2tldChBRl9JTkVULCBTT0NLX0RHUkFNLCAwKSkgPT0gLTEpIHsKKwlwZXJyb3IoInNvY2tl
dCIpOworCWN5cnVzX2RvbmUoKTsKKwlleGl0KDEpOworICAgIH0KKworICAgIGxvY2FsLnNpbl9m
YW1pbHkgPSBBRl9JTkVUOworICAgIGluZXRfcHRvbihBRl9JTkVULCBsZGFwZF9sb2NhbGhvc3Qs
ICZsb2NhbC5zaW5fYWRkcik7CisgICAgbG9jYWwuc2luX3BvcnQgPSBodG9ucyhwb3J0X251bSk7
CisgICAgbGVuPXNpemVvZihsb2NhbCk7CisKKyAgICBpZiAoYmluZChzLCAoc3RydWN0IHNvY2th
ZGRyICopJmxvY2FsLCBsZW4pID09IC0xKSB7CisJcGVycm9yKCJiaW5kIik7CisJY3lydXNfZG9u
ZSgpOworCWV4aXQoMSk7CisgICAgfQorCisgICAgZm9yKGN1cmNoaWxkPTA7IGN1cmNoaWxkPG5f
bGlzdGVuZXJzOyBjdXJjaGlsZCsrKSB7CisJcGlkID0gZm9yaygpOworCWlmIChwaWQgPT0gLTEp
IHsKKwkgICAgcGVycm9yKCJmb3JrIik7CisJICAgIGN5cnVzX2RvbmUoKTsKKwkgICAgZXhpdCgx
KTsKKwl9CisJCisJaWYgKHBpZCAhPSAwKSB7IC8qIHBhcmVudCAqLworCSAgICBjb250aW51ZTsK
Kwl9CisJLyogY2hpbGQgKi8KKwlicmVhazsKKyAgICB9CisKKyAgICBpZiAocGlkICE9IDApIHsg
LyogcGFyZW50ICovCisJY3lydXNfZG9uZSgpOworCWV4aXQoMCk7CisgICAgfQorCQorICAgIC8q
IGNoaWxkICovCisKKyAgICBmb3IgKDs7KSB7CisJaW50IG47CisKKwlmcm9tbGVuID0gc2l6ZW9m
KGZyb20pOworCW4gPSByZWN2ZnJvbShzLCAodm9pZCopICZsZGFwZGF0YSwgc2l6ZW9mKGxkYXBf
ZGF0YV90KSwgMCwKKwkJICAgICAoc3RydWN0IHNvY2thZGRyICopICZmcm9tLCAmZnJvbWxlbik7
CisKKwlpZiAobiA+IDApIHsKKwkgICAgaWYgKG4gPD0gTERBUERBVEFfQkFTRV9TSVpFIHx8CisJ
CSFsZGFwZGF0YS51c2VybGVuIHx8CisJCWxkYXBkYXRhLnVzZXJsZW4gPiBNQVhfTUFJTEJPWF9O
QU1FIHx8CisJCWxkYXBkYXRhLnVzZXJsZW4gPCBuLUxEQVBEQVRBX0JBU0VfU0laRSkKKwkJc3lz
bG9nKExPR19FUlIsICJJbnZhbGlkIG1lc3NhZ2UgcmVjZWl2ZWQsIHNpemU9JWQsIHVzZXJsZW49
JWx1XG4iLCBuLCAobiA8IExEQVBEQVRBX0JBU0VfU0laRSk/KHVuc2lnbmVkIGxvbmcpMDpsZGFw
ZGF0YS51c2VybGVuKTsKKwkgICAgZWxzZSB7CisJCWludCByZXN1bHRsZW49MDsKKworCQlsZGFw
ZGF0YV9yZXN1bHQuY29kZT1nZXRfaWRfZnJvbV9sZGFwKAorCQkgICAgbGRhcGRhdGEuYnVmLCBs
ZGFwZGF0YS51c2VybGVuLAorCQkgICAgbGRhcGRhdGEuYnVmK2xkYXBkYXRhLnVzZXJsZW4sIG4t
TERBUERBVEFfQkFTRV9TSVpFLWxkYXBkYXRhLnVzZXJsZW4sCisJCSAgICBsZGFwZGF0YV9yZXN1
bHQuYnVmLCAmcmVzdWx0bGVuLAorCQkgICAgbGRhcGRhdGEuaW50MmV4dCk7CisJCWlmKHNlbmR0
byhzLCAodm9pZCAqKSZsZGFwZGF0YV9yZXN1bHQsIHJlc3VsdGxlbitMREFQREFUQV9SRVNVTFRf
QkFTRV9TSVpFLDAsKHN0cnVjdCBzb2NrYWRkciAqKSZmcm9tLGZyb21sZW4pPT0tMSkKKwkJICAg
IHN5c2xvZyhMT0dfRVJSLCAiQ2Fubm90IHNlbmQgYW4gYW5zd2VyOiAlc1xuIiwgc3RyZXJyb3Io
ZXJybm8pKTsKKwkgICAgfQorCX0KKyAgICB9CisKKyAgICBjeXJ1c19kb25lKCk7CisKKyAgICAv
KiBuZXZlciBnZXRzIGhlcmUgKi8gICAgICAKKyAgICBleGl0KDEpOworfQorCit2b2lkIHByaW50
c3RyaW5nKGNvbnN0IGNoYXIgKnMgX19hdHRyaWJ1dGVfXygodW51c2VkKSkpCit7IAorICAgIC8q
IG5lZWRlZCB0byBsaW5rIGFnYWluc3QgYW5ub3RhdGUubyAqLworICAgIGZhdGFsKCJwcmludHN0
cmluZygpIGV4ZWN1dGVkISEhIiwKKyAgICAgICAgICBFQ19TT0ZUV0FSRSk7Cit9CmRpZmYgLXVy
TiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvbGRhcGQuaCBjeXJ1cy1pbWFwZC0yLjIuMTIv
aW1hcC9sZGFwZC5oCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2ltYXAvbGRhcGQuaAkxOTcw
LTAxLTAxIDAzOjAwOjAwICswMzAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvaW1hcC9sZGFwZC5o
CTIwMDUtMTItMzAgMTU6MTQ6MzEgKzAzMDAKQEAgLTAsMCArMSwzMSBAQAorI2lmbmRlZiBfTERB
UERfSAorI2RlZmluZSBfTERBUERfSAorCisjaW5jbHVkZSAibWFpbGJveC5oIgorCisjZGVmaW5l
IENPTlZFUlRVU0VSSURfT0sgICAgICAgICAgICAgMAorI2RlZmluZSBDT05WRVJUVVNFUklEX0xE
QVBGQUlMRUQgICAgIDEKKyNkZWZpbmUgQ09OVkVSVFVTRVJJRF9TWVNGQUlMRUQgICAgICAyCisj
ZGVmaW5lIENPTlZFUlRVU0VSSURfTk9ORVhJU1RFTlRfSUQgMworCisjZGVmaW5lIENPTlZFUlRV
U0VSSURfTUFTSyAgICAgICAgIDB4MworCit0eXBlZGVmIHN0cnVjdCBsZGFwX2RhdGFfcyB7Cisg
ICAgdW5zaWduZWQgbG9uZyBpbnQyZXh0OworICAgIHVuc2lnbmVkIGxvbmcgdXNlcmxlbjsgLyog
bGVuZ3RoIG9mIHRoZSB1c2VybmFtZSBidWZmZXIgKi8KKworICAgIC8qIG5vbi1udWxsLXRlcm1p
bmF0ZWQgYnVmZmVyIGZvciB1c2VybmFtZSBhbmQgZG9tYWluICovCisgICAgY2hhciBidWZbTUFY
X01BSUxCT1hfTkFNRSoyXTsKK30gbGRhcF9kYXRhX3Q7CisKK3R5cGVkZWYgc3RydWN0IGxkYXBf
ZGF0YV9yZXN1bHRfcyB7CisgICAgdW5zaWduZWQgbG9uZyBjb2RlOworCisgICAgLyogbm9uLW51
bGwtdGVybWluYXRlZCBidWZmZXIgZm9yIGNvbnZlcnRlZCB1c2VybmFtZSAqLworICAgIGNoYXIg
YnVmW01BWF9NQUlMQk9YX05BTUVdOworfSBsZGFwX2RhdGFfcmVzdWx0X3Q7CisKKyNkZWZpbmUg
TERBUERBVEFfQkFTRV9TSVpFCSgyICogc2l6ZW9mKHVuc2lnbmVkIGxvbmcpKQorI2RlZmluZSBM
REFQREFUQV9SRVNVTFRfQkFTRV9TSVpFCShzaXplb2YodW5zaWduZWQgbG9uZykpCisKKyNlbmRp
ZiAvKiBfTERBUERfSCAqLwpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL01h
a2VmaWxlLmluIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL01ha2VmaWxlLmluCi0tLSBjeXJ1cy1p
bWFwZC0yLjIuMTIub2xkL2ltYXAvTWFrZWZpbGUuaW4JMjAwNS0xMi0zMCAxMjo1NTo1MyArMDMw
MAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvTWFrZWZpbGUuaW4JMjAwNS0xMi0zMCAxNTox
Mzo1OCArMDMwMApAQCAtNjksNyArNjksNyBAQAogU0lFVkVfTElCUyA9IEBTSUVWRV9MSUJTQAog
SU1BUF9DT01fRVJSX0xJQlMgPSBASU1BUF9DT01fRVJSX0xJQlNACiBMSUJfV1JBUCA9IEBMSUJf
V1JBUEAKLUxJQlMgPSAkKElNQVBfTElCUykgJChJTUFQX0NPTV9FUlJfTElCUykKK0xJQlMgPSAk
KElNQVBfTElCUykgJChJTUFQX0NPTV9FUlJfTElCUykgLWxyZWRibGFjayAtbGxkYXAKIERFUExJ
QlMgPSAuLi9saWIvbGliY3lydXMuYSAuLi9saWIvbGliY3lydXNfbWluLmEgQERFUExJQlNACiAK
IENGTEFHUyA9IEBDRkxBR1NACkBAIC0xMDQsNyArMTA0LDcgQEAKIAljb252ZXJ0X2NvZGUubyBk
dXBsaWNhdGUubyBzYXNsY2xpZW50Lm8gc2FzbHNlcnZlci5vIHNpZ25hbHMubyBcCiAJYW5ub3Rh
dGUubyBzZWFyY2hfZW5naW5lcy5vIHNxdWF0Lm8gc3F1YXRfaW50ZXJuYWwubyBtYmR1bXAubyBc
CiAJaW1hcHBhcnNlLm8gdGVsZW1ldHJ5Lm8gdXNlci5vIG5vdGlmeS5vIHByb3RvY29sLm8gcXVv
dGFfZGIubyBcCi0JYXV0b3NpZXZlLm8gJChTRUVOKSAkKElETEUpCisJYXV0b3NpZXZlLm8gY2hh
cnNldF9jb252ZXJ0Lm8gJChTRUVOKSAkKElETEUpCiAKIElNQVBET0JKUz1wdXNoc3RhdHMubyBi
YWNrZW5kLm8gaW1hcGQubyBpbmRleC5vIHRscy5vIHZlcnNpb24ubwogCkBAIC0xOTAsNiArMTkw
LDEwIEBACiAJJChDQykgJChMREZMQUdTKSAtbyBpZGxlZCBcCiAJIGlkbGVkLm8gbXV0ZXhfZmFr
ZS5vIGxpYmltYXAuYSAkKFNJRVZFX0xJQlMpICQoREVQTElCUykgJChMSUJTKQogCitsZGFwZDog
bGRhcGQubyBtdXRleF9mYWtlLm8gbGliaW1hcC5hICQoREVQTElCUykKKwkkKENDKSAkKExERkxB
R1MpIC1vIGxkYXBkIFwKKwkgbGRhcGQubyBtdXRleF9mYWtlLm8gbGliaW1hcC5hICQoU0lFVkVf
TElCUykgJChERVBMSUJTKSAkKExJQlMpCisKIGxtdHBkOiBsbXRwZC5vICQoTE1UUE9CSlMpICQo
U0lFVkVfT0JKUykgbXV0ZXhfZmFrZS5vIGxpYmltYXAuYSAkKFNJRVZFX0xJQlMpIFwKIAkkKERF
UExJQlMpICQoU0VSVklDRSkKIAkkKENDKSAkKExERkxBR1MpIC1vIGxtdHBkIFwKZGlmZiAtdXJO
IGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9tYm94bGlzdC5jIGN5cnVzLWltYXBkLTIuMi4x
Mi9pbWFwL21ib3hsaXN0LmMKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9tYm94bGlz
dC5jCTIwMDUtMTItMzAgMTI6NTY6MjQgKzAzMDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFw
L21ib3hsaXN0LmMJMjAwNS0xMi0zMCAxNToxMzo1OCArMDMwMApAQCAtMTc1OSwzNiArMTc1OSw2
IEBACiAgICAgLyogZG9uJ3QgbGlzdCBtYWlsYm94ZXMgb3V0c2lkZSBvZiB0aGUgZGVmYXVsdCBk
b21haW4gKi8KICAgICBpZiAoIXJvY2stPmRvbWFpbmxlbiAmJiAhcm9jay0+aXNhZG1pbiAmJiBz
dHJjaHIoa2V5LCAnIScpKSByZXR1cm4gMDsgCiAKLSAgICBtaW5tYXRjaCA9IDA7Ci0KLSAgICBt
ZW1jcHkobmFtZWJ1Ziwga2V5LCBrZXlsZW4pOwotICAgIG5hbWVidWZba2V5bGVuXSA9ICdcMCc7
Ci0KLSAgICAvKiByaWdodCB3b3JrIHdpdGggYW4gYWx0ZXJuYXRlIChub3QgdGhlIGJ1aWxkLWlu
KQotICAgICAgIG5hbWVzcGFjZSAtLSBzb3JjZXJlciAqLwotICAgIGlmKGtleWxlbiA+PSBzaXpl
b2YobmFtZWJ1ZikpIHsKLQlzeXNsb2coTE9HX0VSUiwgIm92ZXJzaXplIGtleWxlbiBpbiBtYm94
bGlzdC5jOmZpbmRfcCgpIik7Ci0JcmV0dXJuIDA7Ci0gICAgfQotICAgIGlmKHJvY2stPmluYm94
b2Zmc2V0KSB7Ci0JbmFtZWJ1Zltyb2NrLT5pbmJveG9mZnNldF0gPSByb2NrLT5pbmJveGNhc2Vb
MF07Ci0JbmFtZWJ1Zltyb2NrLT5pbmJveG9mZnNldCsxXSA9IHJvY2stPmluYm94Y2FzZVsxXTsK
LQluYW1lYnVmW3JvY2stPmluYm94b2Zmc2V0KzJdID0gcm9jay0+aW5ib3hjYXNlWzJdOwotCW5h
bWVidWZbcm9jay0+aW5ib3hvZmZzZXQrM10gPSByb2NrLT5pbmJveGNhc2VbM107Ci0JbmFtZWJ1
Zltyb2NrLT5pbmJveG9mZnNldCs0XSA9IHJvY2stPmluYm94Y2FzZVs0XTsKLSAgICB9Ci0KLSAg
ICAvKiBpZiBjYW50IGdldCB0aGUgZXh0ZXJuYWwgbmFtZSB0aGVuIHNraXAgdGhlIGN1cnJlbnQK
LSAgICAgICBrZXkgLS0gc29yY2VyZXIgKi8KLSAgICBpZigocm9jay0+bmFtZXNwYWNlLT5tYm94
bmFtZV90b2V4dGVybmFsKShyb2NrLT5uYW1lc3BhY2UsIG5hbWVidWYrcm9jay0+aW5ib3hvZmZz
ZXQsIGF1dGhfY2Fub251c2VyKHJvY2stPmF1dGhfc3RhdGUpLCBuYW1lYnVmX291dCkpCi0JcmV0
dXJuIDA7Ci0KLSAgICBtYXRjaGxlbiA9IGdsb2JfdGVzdChnLCBuYW1lYnVmX291dCwKLQkJCSBz
dHJsZW4obmFtZWJ1Zl9vdXQpLCAmbWlubWF0Y2gpOwotCi0gICAgLyogSWYgaXRzIG5vdCBhIG1h
dGNoLCBza2lwIGl0IC0tIHBhcnRpYWwgbWF0Y2hlcyBhcmUgb2suICovCi0gICAgaWYobWF0Y2hs
ZW4gPT0gLTEpIHJldHVybiAwOwotCiAgICAgaWYgKHJvY2stPmZpbmRfbmFtZXNwYWNlICE9IE5B
TUVTUEFDRV9JTkJPWCAmJgogCXJvY2stPnVzZXJtYm94bmFtZSAmJgogCWtleWxlbiA+PSByb2Nr
LT51c2VybWJveG5hbWVsZW4gJiYKQEAgLTE4NDIsNiArMTgxMiwzNSBAQAogCX0KICAgICB9CiAg
ICAgCisgICAgbWlubWF0Y2ggPSAwOworCisgICAgbWVtY3B5KG5hbWVidWYsIGtleSwga2V5bGVu
KTsKKyAgICBuYW1lYnVmW2tleWxlbl0gPSAnXDAnOworCisgICAgLyogcmlnaHQgd29yayB3aXRo
IGFuIGFsdGVybmF0ZSBuYW1lc3BhY2UgLS0gc29yY2VyZXIgKi8KKyAgICBpZihrZXlsZW4gPj0g
c2l6ZW9mKG5hbWVidWYpKSB7CisJc3lzbG9nKExPR19FUlIsICJvdmVyc2l6ZSBrZXlsZW4gaW4g
bWJveGxpc3QuYzpmaW5kX3AoKSIpOworCXJldHVybiAwOworICAgIH0KKyAgICBpZihyb2NrLT5p
bmJveG9mZnNldCkgeworCW5hbWVidWZbcm9jay0+aW5ib3hvZmZzZXRdID0gcm9jay0+aW5ib3hj
YXNlWzBdOworCW5hbWVidWZbcm9jay0+aW5ib3hvZmZzZXQrMV0gPSByb2NrLT5pbmJveGNhc2Vb
MV07CisJbmFtZWJ1Zltyb2NrLT5pbmJveG9mZnNldCsyXSA9IHJvY2stPmluYm94Y2FzZVsyXTsK
KwluYW1lYnVmW3JvY2stPmluYm94b2Zmc2V0KzNdID0gcm9jay0+aW5ib3hjYXNlWzNdOworCW5h
bWVidWZbcm9jay0+aW5ib3hvZmZzZXQrNF0gPSByb2NrLT5pbmJveGNhc2VbNF07CisgICAgfQor
CisgICAgLyogaWYgY2FudCBnZXQgdGhlIGV4dGVybmFsIG5hbWUgdGhlbiBza2lwIHRoZSBjdXJy
ZW50CisgICAgICAga2V5IC0tIHNvcmNlcmVyICovCisgICAgaWYoKHJvY2stPm5hbWVzcGFjZS0+
bWJveG5hbWVfdG9leHRlcm5hbCkocm9jay0+bmFtZXNwYWNlLCBuYW1lYnVmK3JvY2stPmluYm94
b2Zmc2V0LCBhdXRoX2Nhbm9udXNlcihyb2NrLT5hdXRoX3N0YXRlKSwgbmFtZWJ1Zl9vdXQpKQor
CXJldHVybiAwOworCisgICAgbWF0Y2hsZW4gPSBnbG9iX3Rlc3QoZywgbmFtZWJ1Zl9vdXQsCisJ
CQkgc3RybGVuKG5hbWVidWZfb3V0KSwgJm1pbm1hdGNoKTsKKworICAgIC8qIElmIGl0cyBub3Qg
YSBtYXRjaCwgc2tpcCBpdCAtLSBwYXJ0aWFsIG1hdGNoZXMgYXJlIG9rLiAqLworICAgIGlmKG1h
dGNobGVuID09IC0xKSByZXR1cm4gMDsKKwogICAgIC8qIGlmIHdlIGdldCBoZXJlLCBjbG9zZSBl
bm91Z2ggZm9yIHVzIHRvIHNwZW5kIHRoZSB0aW1lCiAgICAgICAgYWN0aW5nIGludGVyZXN0ZWQg
Ki8KICAgICByZXR1cm4gMTsKZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvaW1hcC9t
Ym94bmFtZS5jIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL21ib3huYW1lLmMKLS0tIGN5cnVzLWlt
YXBkLTIuMi4xMi5vbGQvaW1hcC9tYm94bmFtZS5jCTIwMDUtMTItMzAgMTI6NTY6MjUgKzAzMDAK
KysrIGN5cnVzLWltYXBkLTIuMi4xMi9pbWFwL21ib3huYW1lLmMJMjAwNS0xMi0zMCAxNToxMzo1
OSArMDMwMApAQCAtNTcsNiArNTcsMTcgQEAKIAogI2luY2x1ZGUgIm1ib3huYW1lLmgiCiAjaW5j
bHVkZSAibWJveGxpc3QuaCIKKyNpbmNsdWRlICJpbWFwZC5oIgorCisjaWZkZWYgRU5BQkxFX0NP
TlZFUlRfVVNFUklECisjaW5jbHVkZSA8c3lzL3NvY2tldC5oPgorI2luY2x1ZGUgPG5ldGluZXQv
aW4uaD4KKyNpbmNsdWRlIDxhcnBhL2luZXQuaD4KKyNpbmNsdWRlIDxyZWRibGFjay5oPgorI2lu
Y2x1ZGUgPHN5c2xvZy5oPgorI2luY2x1ZGUgImxkYXBkLmgiCisjaW5jbHVkZSAiY3lydXNkYi5o
IgorI2VuZGlmIC8qIEVOQUJMRV9DT05WRVJUX1VTRVJJRCAqLwogCiAvKiBNYWlsYm94IHBhdHRl
cm5zIHdoaWNoIHRoZSBkZXNpZ24gb2YgdGhlIHNlcnZlciBwcm9oaWJpdHMgKi8KIHN0YXRpYyBj
aGFyICpiYWRtYm94cGF0dGVybnNbXSA9IHsKQEAgLTk1LDYgKzEwNiw3NzUgQEAKIH07CiAjZGVm
aW5lIENIQVJNT0Q2NChjKSAgKGluZGV4X21vZDY0Wyh1bnNpZ25lZCBjaGFyKShjKV0pCiAKKyNp
ZmRlZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQKKworaW50IGltYXBkX2NvbnZlcnR1c2VyaWQ9MDsK
K2ludCBpbWFwZF9ub25jb252ZXJ0ZWR1c2VyaWRfYWxsb3dlZD0wOworaW50IGltYXBkX2RvbnRp
Z25vcmVfY29udmVydHVzZXJpZF9lcnJvcnM9MDsKK2ludCBpbWFwZF9jb252ZXJ0dXNlcmlkX2Fj
dHVhbF90aW1lb3V0PTA7CisKK2V4dGVybiBzdHJ1Y3QgY3lydXNkYl9iYWNrZW5kICpjb25maWdf
Y29udmVydHVzZXJpZF9jYWNoZV9kYjsKK3N0YXRpYyBzdHJ1Y3QgZGIgKmNvbnZlcnR1c2VyaWRf
ZGI9TlVMTDsKKwordHlwZWRlZiBzdHJ1Y3QgX3JidF9kYXRhX3QgeworICAgIGNoYXIgKmRvbWFp
bjsKKyAgICBjaGFyICp1aWQ7CisgICAgaW50IHVpZF9sZW47CisgICAgY2hhciAqc247CisgICAg
aW50IHNuX2xlbjsKK30gcmJ0X2RhdGFfdDsKKworc3RhdGljIHN0cnVjdCByYnRyZWUgKnJidF9p
bnRfdG9fZXh0PU5VTEw7CitzdGF0aWMgc3RydWN0IHJidHJlZSAqcmJ0X2V4dF90b19pbnQ9TlVM
TDsKKworc3RhdGljIGludCBjb252ZXJ0dXNlcmlkX3NvY2tldD0tMTsKKworaW50IHJidF9kYXRh
X2NvbXBhcmUoY29uc3Qgdm9pZCAqcDEsIGNvbnN0IHZvaWQgKnAyLCBjb25zdCB2b2lkICpjb25m
aWcpCit7CisgICAgcmJ0X2RhdGFfdCAqZDE9KHJidF9kYXRhX3QgKilwMTsKKyAgICByYnRfZGF0
YV90ICpkMj0ocmJ0X2RhdGFfdCAqKXAyOworICAgIGludCByZXM7CisKKyAgICBpZighKHJlcz1z
dHJjbXAoZDEtPmRvbWFpbiwgZDItPmRvbWFpbikpKSB7CisJY2hhciAqc3RyMSwgKnN0cjI7CisJ
aW50IHN0cjFfbGVuLCBzdHIyX2xlbjsKKwlpbnQgbWluX2xlbjsKKworCWlmKGNvbmZpZykgewor
CSAgICBzdHIxPWQxLT51aWQ7CisJICAgIHN0cjFfbGVuPWQxLT51aWRfbGVuOworCSAgICBzdHIy
PWQyLT51aWQ7CisJICAgIHN0cjJfbGVuPWQyLT51aWRfbGVuOworCX0KKwllbHNlIHsKKwkgICAg
c3RyMT1kMS0+c247CisJICAgIHN0cjFfbGVuPWQxLT5zbl9sZW47CisJICAgIHN0cjI9ZDItPnNu
OworCSAgICBzdHIyX2xlbj1kMi0+c25fbGVuOworCX0KKwltaW5fbGVuID0gKHN0cjFfbGVuIDwg
c3RyMl9sZW4pPyBzdHIxX2xlbiA6IHN0cjJfbGVuOworCWlmKCEocmVzPW1lbWNtcChzdHIxLCBz
dHIyLCBtaW5fbGVuKSkpIHsKKwkgICAgaWYobWluX2xlbj09c3RyMV9sZW4pCisJCXJlcyA9ICht
aW5fbGVuPT1zdHIyX2xlbik/MDotMTsKKwkgICAgZWxzZQorCQlyZXMgPSAtMTsKKwl9CisgICAg
fQorICAgIHJldHVybiByZXM7Cit9CisKKyNkZWZpbmUgRE9OVF9BTExPQ0lOICAweDEKKyNkZWZp
bmUgRE9OVF9BTExPQ09VVCAweDIKKworc3RhdGljIHJidF9kYXRhX3QgKnJidF9pbml0X3VzZXJp
ZF9kYXRhKGNvbnN0IGNoYXIgKnVpZCwgaW50IHVpZF9sZW4sIGNvbnN0IGNoYXIgKmRvbWFpbiwg
Y29uc3QgY2hhciAqc24sIGludCBzbl9sZW4sIGludCBmbGFncykKK3sKKyAgICByYnRfZGF0YV90
ICpyZXM9KHJidF9kYXRhX3QgKiltYWxsb2Moc2l6ZW9mKHJidF9kYXRhX3QpKTsKKworICAgIGlm
KCFyZXMpCisJcmV0dXJuIE5VTEw7CisKKyAgICByZXMtPmRvbWFpbiA9IHN0cmR1cChkb21haW4p
OworICAgIGlmKCFyZXMtPmRvbWFpbikgeworCWZyZWUocmVzKTsKKwlyZXR1cm4gTlVMTDsKKyAg
ICB9CisKKyAgICBpZih1aWQgPT0gc24gJiYgKGZsYWdzICYgKERPTlRfQUxMT0NJTnxET05UX0FM
TE9DT1VUKSkpCisJZmxhZ3MgfD0gKERPTlRfQUxMT0NJTnxET05UX0FMTE9DT1VUKTsKKworICAg
IGlmKGZsYWdzICYgRE9OVF9BTExPQ0lOKQorCXJlcy0+dWlkID0gKGNoYXIgKil1aWQ7CisgICAg
ZWxzZSBpZighKHJlcy0+dWlkID0gKGNoYXIgKiltYWxsb2ModWlkX2xlbikpKSB7CisJZnJlZShy
ZXMtPmRvbWFpbik7CisJZnJlZShyZXMpOworCXJldHVybiBOVUxMOworICAgIH0KKyAgICBlbHNl
CisJbWVtY3B5KHJlcy0+dWlkLCB1aWQsIHVpZF9sZW4pOworCisgICAgaWYodWlkID09IHNuICYm
ICEoZmxhZ3MgJiBET05UX0FMTE9DT1VUKSkgeworCXNuID0gcmVzLT51aWQ7CisJZmxhZ3MgfD0g
RE9OVF9BTExPQ09VVDsKKyAgICB9CisKKyAgICBpZihmbGFncyAmIERPTlRfQUxMT0NPVVQpCisJ
cmVzLT5zbiA9IChjaGFyICopc247CisgICAgZWxzZSBpZighKHJlcy0+c24gPSAoY2hhciAqKW1h
bGxvYyhzbl9sZW4pKSkgeworCWZyZWUocmVzLT5kb21haW4pOworCWlmKCEoZmxhZ3MgJiBET05U
X0FMTE9DSU4pKQorCSAgICBmcmVlKHJlcy0+dWlkKTsKKwlmcmVlKHJlcyk7CisJcmV0dXJuIE5V
TEw7CisgICAgfQorICAgIGVsc2UKKwltZW1jcHkocmVzLT5zbiwgc24sIHNuX2xlbik7CisKKyAg
ICByZXMtPnVpZF9sZW4gPSB1aWRfbGVuOworICAgIHJlcy0+c25fbGVuID0gc25fbGVuOworCisg
ICAgcmV0dXJuIHJlczsKK30KKwordm9pZCByYnRfZnJlZV91c2VyaWRfZGF0YShyYnRfZGF0YV90
ICpkYXRhKQoreworICAgIGZyZWUoZGF0YS0+ZG9tYWluKTsKKyAgICBmcmVlKGRhdGEtPnVpZCk7
CisgICAgaWYoZGF0YS0+dWlkIT1kYXRhLT5zbikKKwlmcmVlKGRhdGEtPnNuKTsKKyAgICBmcmVl
KGRhdGEpOworfQorCisjZGVmaW5lIElOVEVSTkFMICAgICAgICAgICAgICAweDEKKworZXh0ZXJu
IGludCBjb252ZXJ0dXNlcmlkX2luaXQoKQoreworICAgIGNvbnN0IGNoYXIgKmNvbnZlcnR1c2Vy
aWRfc29jazsKKyAgICBpbnQgbG9jYWxsZW47CisgICAgaW50IHBhdGhsZW47CisgICAgbW9kZV90
IG9sZHVtYXNrOworICAgIGludCBwb3J0X251bTsKKyAgICBzdHJ1Y3Qgc29ja2FkZHJfaW4gY29u
dmVydHVzZXJpZF9yZW1vdGU7CisgICAgaW50IGNvbnZlcnR1c2VyaWRfcmVtb3RlX2xlbjsKKwor
ICAgIC8qIGlmIHRoZSBzb2NrZXQgaXMgYWxyZWFkeSBvcGVuLCByZXR1cm4gKi8KKyAgICBpZiAo
Y29udmVydHVzZXJpZF9zb2NrZXQgIT0gLTEpIHsKKwlzeXNsb2coTE9HX0VSUiwgImNvbnZlcnR1
c2VyaWRfaW5pdDogbXVzdCBub3QgYmUgY2FsbGVkIHR3aWNlIik7CisJcmV0dXJuIC0xOworICAg
IH0KKworICAgIHBvcnRfbnVtID0gY29uZmlnX2dldGludChJTUFQT1BUX0NPTlZFUlRVU0VSSURf
VURQUE9SVCk7CisgICAgaWYoIXBvcnRfbnVtKSB7CisJc3lzbG9nKExPR19FUlIsICJJbnZhbGlk
IHZhbHVlIG9mIGNvbnZlcnR1c2VyaWRfdWRwcG9ydCBjb25maWcgb3B0aW9uXG4iKTsKKwlyZXR1
cm4gLTE7CisgICAgfQorCisgICAgaWYgKChjb252ZXJ0dXNlcmlkX3NvY2tldCA9IHNvY2tldChB
Rl9JTkVULCBTT0NLX0RHUkFNLCAwKSkgPT0gLTEpIHsKKwlzeXNsb2coTE9HX0VSUiwgImNvbnZl
cnR1c2VyaWRfaW5pdDogY2FuJ3QgY3JlYXRlIGEgc29ja2V0Iik7CisJcmV0dXJuIC0xOworICAg
IH0KKworICAgIGNvbnZlcnR1c2VyaWRfcmVtb3RlLnNpbl9mYW1pbHkgPSBBRl9JTkVUOworICAg
IGNvbnZlcnR1c2VyaWRfcmVtb3RlLnNpbl9wb3J0ID0gaHRvbnMocG9ydF9udW0pOworICAgIGlu
ZXRfcHRvbihBRl9JTkVULCBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfQ09OVkVSVFVTRVJJRF9M
T0NBTEhPU1QpLCAmY29udmVydHVzZXJpZF9yZW1vdGUuc2luX2FkZHIpOworICAgIGNvbnZlcnR1
c2VyaWRfcmVtb3RlX2xlbiA9IHNpemVvZihjb252ZXJ0dXNlcmlkX3JlbW90ZSk7CisKKyAgICBp
Zihjb25uZWN0KGNvbnZlcnR1c2VyaWRfc29ja2V0LCAoc3RydWN0IHNvY2thZGRyICopJmNvbnZl
cnR1c2VyaWRfcmVtb3RlLCBjb252ZXJ0dXNlcmlkX3JlbW90ZV9sZW4pPT0tMSkgeworCXN5c2xv
ZyhMT0dfRVJSLCAiY29udmVydHVzZXJpZF9pbml0OiBjYW4ndCBjb25uZWN0IChkYXRhZ3JhbSki
KTsKKwlyZXR1cm4gLTE7CisgICAgfQorCisgICAgaWYoY29uZmlnX2NvbnZlcnR1c2VyaWRfY2Fj
aGVfZGIpIHsKKwlzaXplX3QgZm5hbWVfbGVuID0gc3RybGVuKGNvbmZpZ19kaXIpK3N0cmxlbihG
TkFNRV9DT05WRVJUVVNFUklEKSsxOworCWNoYXIgKmZuYW1lOworCQorCWlmKCEoZm5hbWUgPSAo
Y2hhciAqKW1hbGxvYyhmbmFtZV9sZW4pKSkKKwkgICAgc3lzbG9nKExPR19FUlIsICJjb252ZXJ0
dXNlcmlkX2luaXQ6IGNhbid0IGFsbG9jYXRlIGEgdGVtcG9yYXJ5IGJ1ZmZlci4gQ29udmVydHVz
ZXJpZCBjYWNoZSBpcyBkaXNhYmxlZCEiKTsKKwllbHNlIHsKKwkgICAgaW50IHJldDsKKwkgICAg
CisJICAgIHN0cmNweShmbmFtZSwgY29uZmlnX2Rpcik7CisJICAgIHN0cmNhdChmbmFtZSwgRk5B
TUVfQ09OVkVSVFVTRVJJRCk7CisJICAgIGlmKChyZXQgPSBjb25maWdfY29udmVydHVzZXJpZF9j
YWNoZV9kYi0+b3BlbihmbmFtZSwgQ1lSVVNEQl9DUkVBVEUsICZjb252ZXJ0dXNlcmlkX2RiKSkp
CisJCXN5c2xvZyhMT0dfRVJSLCAiY29udmVydHVzZXJpZF9pbml0OiBjYW4ndCBvcGVuICVzOiAl
cy4gQ29udmVydHVzZXJpZCBjYWNoZSBpcyBkaXNhYmxlZCEiLCBmbmFtZSwgY3lydXNkYl9zdHJl
cnJvcihyZXQpKTsKKwl9CisJaWYoZm5hbWUpCisJICAgIGZyZWUoZm5hbWUpOworICAgIH0KKwor
ICAgIHJldHVybiAwOworfQorCitleHRlcm4gaW50IGNvbnZlcnR1c2VyaWRfY29uZmlnX3JlcmVh
ZCgpCit7CisgICAgdGVtcGxhdGVfb3B0aW9uIG9wdHNbXT17CisJeyh2b2lkICopSU1BUE9QVF9D
T05WRVJUVVNFUklELCBURU1QTEFURU9QVF9UWVBFX0tOT1dOT1BUfSwKKwl7KHZvaWQgKilJTUFQ
T1BUX0NPTlZFUlRVU0VSSURfRVhFTVBUUywgVEVNUExBVEVPUFRfVFlQRV9LTk9XTk9QVH0sCisJ
eyh2b2lkICopSU1BUE9QVF9DT05WRVJUVVNFUklEX0FMTE9XX05PTkNPTlZFUlRFRCwgVEVNUExB
VEVPUFRfVFlQRV9LTk9XTk9QVH0sCisJeyh2b2lkICopSU1BUE9QVF9DT05WRVJUVVNFUklEX0RP
TlRJR05PUkVfRVJST1JTLCBURU1QTEFURU9QVF9UWVBFX0tOT1dOT1BUfSwKKwl7KHZvaWQgKilJ
TUFQT1BUX0NPTlZFUlRVU0VSSURfQUNUVUFMX1RJTUVPVVQsIFRFTVBMQVRFT1BUX1RZUEVfS05P
V05PUFR9LAorICAgIH07CisKKyAgICByZXR1cm4gY29uZmlnX3JlcmVhZChvcHRzLCBzaXplb2Yo
b3B0cykvc2l6ZW9mKG9wdHNbMF0pKTsKK30KKworc3RhdGljIGNoYXIgKmdldF9pZF9mcm9tX2xk
YXAoY29uc3QgY2hhciAqaW4sIGludCBpbl9sZW4sIGNvbnN0IGNoYXIgKmRvbWFpbiwgaW50ICpv
dXRfbGVuLCB1bnNpZ25lZCBsb25nICplcnJjb2RlLCBpbnQgZmxhZ3MpCit7CisgICAgbGRhcF9k
YXRhX3Qgc2VuZGRhdGE7CisgICAgaW50IGRvbWFpbmxlbj1zdHJsZW4oZG9tYWluKTsKKyAgICBz
c2l6ZV90IHNpemU7CisKKyAgICBzZW5kZGF0YS5pbnQyZXh0ID0gZmxhZ3MmSU5URVJOQUw7Cisg
ICAgc2VuZGRhdGEudXNlcmxlbiA9IGluX2xlbjsKKyAgICBtZW1jcHkoc2VuZGRhdGEuYnVmLCBp
biwgaW5fbGVuKTsKKyAgICBtZW1jcHkoc2VuZGRhdGEuYnVmK2luX2xlbiwgZG9tYWluLCBkb21h
aW5sZW4pOworCisgICAgc2l6ZT1zZW5kKGNvbnZlcnR1c2VyaWRfc29ja2V0LCAodm9pZCAqKSZz
ZW5kZGF0YSwgTERBUERBVEFfQkFTRV9TSVpFK2luX2xlbitkb21haW5sZW4sIDApOworICAgIGlm
KHNpemUgPT0gKHNzaXplX3QpLTEpIHsKKwlzeXNsb2coTE9HX0VSUiwgIkNhbm5vdCBzZW5kIGNv
bnZlcnR1c2VyaWQgcXVlcnk6ICVzLlxuIiwgc3RyZXJyb3IoZXJybm8pKTsKKwkqZXJyY29kZSA9
IENPTlZFUlRVU0VSSURfU1lTRkFJTEVEOworCXJldHVybiBOVUxMOworICAgIH0KKyAgICBpZihz
aXplICE9IExEQVBEQVRBX0JBU0VfU0laRStpbl9sZW4rZG9tYWlubGVuKQorCXN5c2xvZyhMT0df
RVJSLCAiQ2Fubm90IHNlbmQgZnVsbCBjb252ZXJ0dXNlcmlkIHF1ZXJ5LlxuIik7CisKKyAgICBp
ZihzaXplKSB7CisJbGRhcF9kYXRhX3Jlc3VsdF90IHJlY3ZkYXRhOworCWNoYXIgKm91dDsKKwor
CXNpemUgPSByZWN2KGNvbnZlcnR1c2VyaWRfc29ja2V0LCAodm9pZCAqKSZyZWN2ZGF0YSwgc2l6
ZW9mKHJlY3ZkYXRhKSwgMCk7CisJaWYoc2l6ZT09KHNzaXplX3QpLTEpIHsKKwkgICAgc3lzbG9n
KExPR19FUlIsICJDYW5ub3QgcmVjZWl2ZSBjb252ZXJ0dXNlcmlkIGFuc3dlcjogJXMuXG4iLCBz
dHJlcnJvcihlcnJubykpOworCSAgICAqZXJyY29kZSA9IENPTlZFUlRVU0VSSURfU1lTRkFJTEVE
OworCSAgICByZXR1cm4gTlVMTDsKKwl9CisJaWYoc2l6ZTxMREFQREFUQV9SRVNVTFRfQkFTRV9T
SVpFIHx8CisJICAgKHJlY3ZkYXRhLmNvZGUgPworCSAgICBzaXplPkxEQVBEQVRBX1JFU1VMVF9C
QVNFX1NJWkUgOiBzaXplPT1MREFQREFUQV9SRVNVTFRfQkFTRV9TSVpFKSkgeworCSAgICBzeXNs
b2coTE9HX0VSUiwgIldyb25nIHNpemUgb2YgY29udmVydHVzZXJpZCBhbnN3ZXIuXG4iKTsKKwkg
ICAgKmVycmNvZGUgPSBDT05WRVJUVVNFUklEX1NZU0ZBSUxFRDsKKwkgICAgcmV0dXJuIE5VTEw7
CisJfQorCSplcnJjb2RlID0gcmVjdmRhdGEuY29kZTsKKworCS8qIGFuc3dlciBpcyAiY2FuJ3Qg
Y29udmVydCB1c2VyaWQiICovCisJaWYocmVjdmRhdGEuY29kZSkKKwkgICAgcmV0dXJuIE5VTEw7
CisKKwlzaXplLT1MREFQREFUQV9SRVNVTFRfQkFTRV9TSVpFOworCW91dD0oY2hhciAqKW1hbGxv
YyhzaXplKTsKKwlpZighb3V0KSB7CisJICAgICplcnJjb2RlID0gQ09OVkVSVFVTRVJJRF9TWVNG
QUlMRUQ7CisJICAgIHN5c2xvZyhMT0dfREVCVUcsICJtYm94bmFtZV9nZXRfaWRfZnJvbV9sZGFw
KCk6IG1lbW9yeSBhbGxvY2F0aW9uIGZhaWxlZC5cbiIpOworCSAgICByZXR1cm4gTlVMTDsKKwl9
CisJbWVtY3B5KG91dCwgcmVjdmRhdGEuYnVmLCBzaXplKTsKKwkqb3V0X2xlbiA9IHNpemU7CisJ
cmV0dXJuIG91dDsKKyAgICB9CisKKyAgICAqZXJyY29kZSA9IENPTlZFUlRVU0VSSURfU1lTRkFJ
TEVEOworICAgIHJldHVybiBOVUxMOworfQorCitzdGF0aWMgY2hhciAqbWVtY2FjaGVfZmV0Y2go
Y29uc3QgY2hhciAqaW4sIGludCBpbl9sZW4sIGNvbnN0IGNoYXIgKmRvbWFpbiwgaW50ICpvdXRf
bGVuLCBpbnQgZmxhZ3MpCit7CisgICAgcmJ0X2RhdGFfdCBkYXRhOworICAgIHJidF9kYXRhX3Qg
KnNhdmVkX2RhdGE7CisKKyAgICAqb3V0X2xlbiA9IDA7CisKKyAgICBpZighcmJ0X2ludF90b19l
eHQpCisJaWYoIShyYnRfaW50X3RvX2V4dCA9IHJiaW5pdChyYnRfZGF0YV9jb21wYXJlLCAodm9p
ZCAqKTEpKSkKKwkgICAgcmV0dXJuIE5VTEw7CisgICAgaWYoIXJidF9leHRfdG9faW50KQorCWlm
KCEocmJ0X2V4dF90b19pbnQgPSByYmluaXQocmJ0X2RhdGFfY29tcGFyZSwgKHZvaWQgKikwKSkp
CisJICAgIHJldHVybiBOVUxMOworCisgICAgZGF0YS5kb21haW4gPSAoY2hhciAqKWRvbWFpbjsK
KyAgICBpZihmbGFncyZJTlRFUk5BTCkgeworCWRhdGEudWlkID0gKGNoYXIgKilpbjsKKwlkYXRh
LnVpZF9sZW4gPSBpbl9sZW47CisJZGF0YS5zbiA9IE5VTEw7CisJZGF0YS5zbl9sZW4gPSAwOwor
ICAgIH0KKyAgICBlbHNlIHsKKwlkYXRhLnNuID0gKGNoYXIgKilpbjsKKwlkYXRhLnNuX2xlbiA9
IGluX2xlbjsKKwlkYXRhLnVpZCA9IE5VTEw7CisJZGF0YS51aWRfbGVuID0gMDsKKyAgICB9CisK
KyAgICBpZigoc2F2ZWRfZGF0YT0ocmJ0X2RhdGFfdCAqKXJiZmluZCgodm9pZCAqKSZkYXRhLCAo
ZmxhZ3MmSU5URVJOQUwpP3JidF9pbnRfdG9fZXh0OnJidF9leHRfdG9faW50KSkpIHsKKwlpZihm
bGFncyZJTlRFUk5BTCkgeworCSAgICAqb3V0X2xlbiA9IHNhdmVkX2RhdGEtPnNuX2xlbjsKKwkg
ICAgcmV0dXJuIHNhdmVkX2RhdGEtPnNuOworCX0KKwllbHNlIHsKKwkgICAgKm91dF9sZW4gPSBz
YXZlZF9kYXRhLT51aWRfbGVuOworCSAgICByZXR1cm4gc2F2ZWRfZGF0YS0+dWlkOworCX0gCisg
ICAgfQorICAgIHJldHVybiBOVUxMOworfQorCitzdGF0aWMgaW50IG1lbWNhY2hlX3N0b3JlKGNv
bnN0IGNoYXIgKnVpZCwgaW50IHVpZF9sZW4sIGNvbnN0IGNoYXIgKmRvbWFpbiwgY29uc3QgY2hh
ciAqc24sIGludCBzbl9sZW4sIGludCBmbGFncykKK3sKKyAgICByYnRfZGF0YV90ICpzYXZlZF9k
YXRhOworCisgICAgc2F2ZWRfZGF0YT1yYnRfaW5pdF91c2VyaWRfZGF0YSh1aWQsIHVpZF9sZW4s
IGRvbWFpbiwgc24sIHNuX2xlbiwgZmxhZ3MpOworCisgICAgaWYoIXJic2VhcmNoKHNhdmVkX2Rh
dGEscmJ0X2ludF90b19leHQpKSB7CisJcmJ0X2ZyZWVfdXNlcmlkX2RhdGEoc2F2ZWRfZGF0YSk7
CisJc2F2ZWRfZGF0YT1OVUxMOworICAgIH0KKyAgICBlbHNlIGlmKCFyYnNlYXJjaChzYXZlZF9k
YXRhLHJidF9leHRfdG9faW50KSkgeworCXJiZGVsZXRlKHNhdmVkX2RhdGEsIHJidF9pbnRfdG9f
ZXh0KTsKKwlyYnRfZnJlZV91c2VyaWRfZGF0YShzYXZlZF9kYXRhKTsKKwlzYXZlZF9kYXRhPU5V
TEw7CisgICAgfQorICAgIHJldHVybiAhc2F2ZWRfZGF0YTsKK30KKworI2RlZmluZSBBQ1RVQUwg
MHg3MDAwMDAwMAorCitzdGF0aWMgY2hhciAqZGlza2NhY2hlX2ZldGNoKGNvbnN0IGNoYXIgKmlu
LCBpbnQgaW5fbGVuLCBjb25zdCBjaGFyICpkb21haW4sIGludCAqb3V0X2xlbiwgaW50IGluX2Zs
YWdzLCBpbnQgKm91dF9mbGFncykKK3sKKyAgICBjaGFyIGtleVtNQVhfTUFJTEJPWF9OQU1FKjIr
NSsxXTsKKyAgICBpbnQga2V5bGVuOworICAgIC8qIGZvcm1hdDogPGNvZGUgLSAxIGNoYXJhY3Rl
cj4gPHNwPiA8dGltZXN0YW1wIC0gZGVjaW1hbCBzdHJpbmc+CisgICAgICAgPHNwPiA8bWJuYW1l
PiAqLworICAgIGNoYXIgKmRhdGE7CisgICAgdW5zaWduZWQgbG9uZyB0aW1lc3RhbXA7CisgICAg
aW50IHJfb3V0X2ZsYWdzPTA7CisgICAgY2hhciAqcCwqZW5kOworICAgIGludCBkYXRhbGVuOwor
ICAgIGNoYXIgKnJldDsKKyAgICBpbnQgcmV0X2xlbjsKKworICAgICpvdXRfbGVuID0gMDsKKyAg
ICAqb3V0X2ZsYWdzID0gMDsKKworICAgIGlmKCFjb252ZXJ0dXNlcmlkX2RiKQorCXJldHVybiBO
VUxMOworCisgICAgaWYoaW5fbGVuID4gTUFYX01BSUxCT1hfTkFNRSkKKwlyZXR1cm4gTlVMTDsK
KworICAgIHNucHJpbnRmKGtleSwgc2l6ZW9mKGtleSksICIlcyElcyElLipzIiwKKwkgICAgIGRv
bWFpbiwKKwkgICAgIChpbl9mbGFncyZJTlRFUk5BTCk/InVpZCI6InNuIiwKKwkgICAgIGluX2xl
biwgaW4pOworICAgIGtleWxlbiA9IHN0cmxlbihrZXkpOworCisgICAgaWYoY29uZmlnX2NvbnZl
cnR1c2VyaWRfY2FjaGVfZGItPmZldGNoKGNvbnZlcnR1c2VyaWRfZGIsIGtleSwga2V5bGVuLCAo
Y29uc3QgY2hhciAqKikmZGF0YSwgJmRhdGFsZW4sIE5VTEwpKQorCXJldHVybiBOVUxMOworCisg
ICAgcD1kYXRhOworCisgICAgaWYoZGF0YWxlbjw1KQorCXJldHVybiBOVUxMOworCisgICAgcl9v
dXRfZmxhZ3MgPSAoKHVuc2lnbmVkIGNoYXIpZGF0YVswXSkgLSAodW5zaWduZWQgY2hhciknMCc7
CisgICAgcCA9IGRhdGErMTsKKyAgICBpZigqcCAhPSAnICcpCisJcmV0dXJuIE5VTEw7CisgICAg
cCsrOworICAgIGZvcihlbmQ9cDsgZW5kPGRhdGErZGF0YWxlbi0yOyBlbmQrKykgeworCWlmKCpl
bmQgPCAnMCcgfHwgKmVuZCA+ICc5JykKKwkgICAgYnJlYWs7CisgICAgfQorICAgIGlmKGVuZD09
ZGF0YStkYXRhbGVuLTIgfHwgIShlbmQtcCkgfHwgKGVuZC1wKT4yMCB8fCAqZW5kICE9ICcgJykK
KwlyZXR1cm4gTlVMTDsKKyAgICAKKyAgICB0aW1lc3RhbXAgPSBhdG9sKHApOworICAgIGlmKHRp
bWUoTlVMTCktdGltZXN0YW1wIDwgaW1hcGRfY29udmVydHVzZXJpZF9hY3R1YWxfdGltZW91dCkK
KwlyX291dF9mbGFncyB8PSBBQ1RVQUw7CisgICAgcCA9IGVuZCsxOworCisgICAgcmV0X2xlbiA9
IGRhdGFsZW4tKHAtZGF0YSk7CisgICAgaWYocmV0X2xlbiA+IE1BWF9NQUlMQk9YX05BTUUpCisJ
cmV0dXJuIE5VTEw7CisKKyAgICByZXQgPSAoY2hhciAqKW1hbGxvYyhyZXRfbGVuKTsKKyAgICBp
ZighcmV0KQorCXJldHVybiBOVUxMOworICAgIG1lbWNweShyZXQsIHAsIHJldF9sZW4pOworICAg
ICpvdXRfbGVuID0gcmV0X2xlbjsKKyAgICAqb3V0X2ZsYWdzID0gcl9vdXRfZmxhZ3M7CisKKyAg
ICByZXR1cm4gcmV0OworfQorCitzdGF0aWMgaW50IGRpc2tjYWNoZV9zdG9yZV9pbnQoY29uc3Qg
Y2hhciAqaWRfbmFtZSwgY29uc3QgY2hhciAqa2V5X3ZhbHVlLCBpbnQga2V5X3ZhbHVlX2xlbiwg
Y29uc3QgY2hhciAqZG9tYWluLCBjb25zdCBjaGFyICpkYXRhX3ZhbHVlLCBpbnQgZGF0YV92YWx1
ZV9sZW4sIGludCBjb2RlLCB0aW1lX3QgdGltZXN0YW1wLCBzdHJ1Y3QgdHhuICoqdGlkKQorewor
ICAgIGNoYXIga2V5W01BWF9NQUlMQk9YX05BTUUqMis1KzFdOworICAgIGNoYXIgZGF0YVtNQVhf
TUFJTEJPWF9OQU1FKzErMSsyMCsxXTsKKworICAgIGNvZGUgJj0gQ09OVkVSVFVTRVJJRF9NQVNL
OworICAgIHNucHJpbnRmKGtleSwgc2l6ZW9mKGtleSksICIlcyElcyElLipzIiwKKwkgICAgIGRv
bWFpbiwgaWRfbmFtZSwga2V5X3ZhbHVlX2xlbiwga2V5X3ZhbHVlKTsKKyAgICBzbnByaW50Zihk
YXRhLCBzaXplb2YoZGF0YSksICIlYyAlbHUgJS4qcyIsCisJICAgICAoY2hhcikoJzAnK2NvZGUp
LCAodW5zaWduZWQgbG9uZyl0aW1lc3RhbXAsCisJICAgICBkYXRhX3ZhbHVlX2xlbiwgZGF0YV92
YWx1ZSk7CisKKyAgICByZXR1cm4gY29uZmlnX2NvbnZlcnR1c2VyaWRfY2FjaGVfZGItPnN0b3Jl
KGNvbnZlcnR1c2VyaWRfZGIsIGtleSwgc3RybGVuKGtleSksCisJCQkJCSBkYXRhLCBzdHJsZW4o
ZGF0YSksIHRpZCk7Cit9CisKK3N0YXRpYyBpbnQgZGlza2NhY2hlX3N0b3JlKGNvbnN0IGNoYXIg
KnVpZCwgaW50IHVpZF9sZW4sIGNvbnN0IGNoYXIgKmRvbWFpbiwgY29uc3QgY2hhciAqc24sIGlu
dCBzbl9sZW4sIGludCBjb2RlKQoreworICAgIHN0cnVjdCB0eG4gKnRpZD1OVUxMOworICAgIHRp
bWVfdCB0aW1lc3RhbXA7CisKKyAgICBpZighY29udmVydHVzZXJpZF9kYikKKwlyZXR1cm4gMDsK
KworICAgIHRpbWVzdGFtcCA9IHRpbWUoTlVMTCk7CisgICAgaWYoIWRpc2tjYWNoZV9zdG9yZV9p
bnQoInVpZCIsIHVpZCwgdWlkX2xlbiwgZG9tYWluLCBzbiwgc25fbGVuLCBjb2RlLCB0aW1lc3Rh
bXAsICZ0aWQpICYmICFkaXNrY2FjaGVfc3RvcmVfaW50KCJzbiIsIHNuLCBzbl9sZW4sIGRvbWFp
biwgdWlkLCB1aWRfbGVuLCBjb2RlLCB0aW1lc3RhbXAsICZ0aWQpKQorCXJldHVybiBjb25maWdf
Y29udmVydHVzZXJpZF9jYWNoZV9kYi0+Y29tbWl0KGNvbnZlcnR1c2VyaWRfZGIsIHRpZCk7CisK
KyAgICBjb25maWdfY29udmVydHVzZXJpZF9jYWNoZV9kYi0+YWJvcnQoY29udmVydHVzZXJpZF9k
YiwgdGlkKTsKKyAgICByZXR1cm4gMTsKK30KKworc3RhdGljIGludCBkaXNrY2FjaGVfcmVtb3Zl
X2ludChjb25zdCBjaGFyICppZF9uYW1lLCBjb25zdCBjaGFyICprZXlfdmFsdWUsIGludCBrZXlf
dmFsdWVfbGVuLCBjb25zdCBjaGFyICpkb21haW4sIHN0cnVjdCB0eG4gKip0aWQpCit7CisgICAg
Y2hhciBrZXlbTUFYX01BSUxCT1hfTkFNRSoyKzUrMV07CisKKyAgICBzbnByaW50ZihrZXksIHNp
emVvZihrZXkpLCAiJXMhJXMhJS4qcyIsCisJICAgICBkb21haW4sIGlkX25hbWUsIGtleV92YWx1
ZV9sZW4sIGtleV92YWx1ZSk7CisKKyAgICByZXR1cm4gY29uZmlnX2NvbnZlcnR1c2VyaWRfY2Fj
aGVfZGItPmRlbGV0ZShjb252ZXJ0dXNlcmlkX2RiLCBrZXksIHN0cmxlbihrZXkpLCB0aWQsIDEp
OworfQorCitzdGF0aWMgaW50IGRpc2tjYWNoZV9yZW1vdmUoY29uc3QgY2hhciAqdWlkLCBpbnQg
dWlkX2xlbiwgY29uc3QgY2hhciAqZG9tYWluLCBjb25zdCBjaGFyICpzbiwgaW50IHNuX2xlbikK
K3sKKyAgICBzdHJ1Y3QgdHhuICp0aWQ9TlVMTDsKKworICAgIGlmKCFjb252ZXJ0dXNlcmlkX2Ri
KQorCXJldHVybiAwOworCisgICAgaWYoIWRpc2tjYWNoZV9yZW1vdmVfaW50KCJ1aWQiLCB1aWQs
IHVpZF9sZW4sIGRvbWFpbiwgJnRpZCkgJiYgIWRpc2tjYWNoZV9yZW1vdmVfaW50KCJzbiIsIHNu
LCBzbl9sZW4sIGRvbWFpbiwgJnRpZCkpCisJcmV0dXJuIGNvbmZpZ19jb252ZXJ0dXNlcmlkX2Nh
Y2hlX2RiLT5jb21taXQoY29udmVydHVzZXJpZF9kYiwgdGlkKTsKKworICAgIGNvbmZpZ19jb252
ZXJ0dXNlcmlkX2NhY2hlX2RiLT5hYm9ydChjb252ZXJ0dXNlcmlkX2RiLCB0aWQpOworICAgIHJl
dHVybiAxOworfQorCisjZGVmaW5lIFNOX1RPX1VJRF9DTEVBTlVQKGNhY2hlZF91aWQsIGNhY2hl
ZF9zbiwgb3V0X2xlbl92YWx1ZSkgZG8ge1wKK2lmKGNhY2hlZF91aWQpIHsgXAorZnJlZShjYWNo
ZWRfdWlkKTsgXAorY2FjaGVkX3VpZD1OVUxMOyBcCit9IFwKK2lmKGNhY2hlZF9zbikgeyBcCitm
cmVlKGNhY2hlZF9zbik7IFwKK2NhY2hlZF9zbj1OVUxMOyBcCit9IFwKKypvdXRfbGVuID0gKG91
dF9sZW5fdmFsdWUpOyBcCit9IHdoaWxlKDApOworCisjZGVmaW5lIFVJRF9UT19TTl9DTEVBTlVQ
KGNhY2hlZF9zbiwgb3V0X2xlbl92YWx1ZSkgZG8ge1wKK2lmKGNhY2hlZF9zbikgeyBcCitmcmVl
KGNhY2hlZF9zbik7IFwKK2NhY2hlZF9zbj1OVUxMOyBcCit9IFwKKypvdXRfbGVuID0gKG91dF9s
ZW5fdmFsdWUpOyBcCit9IHdoaWxlKDApOworCisvKiBDaGVjayBpZiBkaXNrY2FjaGUgcmVjb3Jk
IGZsYWdzIGFyZSBjb21wYXRpYmxlIHdpdGggY3VycmVudCBpbWFwZAorICAgb3B0aW9ucy4gSWYg
bm90LCB3ZSBjYW5ub3QgdXNlIHRoZSByZWNvcmQuICovCitzdGF0aWMgaW50IGRpc2tmbGFnc192
YWxpZChpbnQgZmxhZ3MpCit7CisgICAgaW50IGNvZGUgPSBmbGFncyAmIENPTlZFUlRVU0VSSURf
TUFTSzsKKworICAgIHJldHVybiBjb2RlID8gKGltYXBkX25vbmNvbnZlcnRlZHVzZXJpZF9hbGxv
d2VkICYmIChjb2RlPT1DT05WRVJUVVNFUklEX05PTkVYSVNURU5UX0lEIHx8ICFpbWFwZF9kb250
aWdub3JlX2NvbnZlcnR1c2VyaWRfZXJyb3JzKSkgOiAxOworfQorCitzdGF0aWMgY2hhciAqc25f
dG9fdWlkKGNvbnN0IGNoYXIgKmluLCBpbnQgaW5fbGVuLCBjb25zdCBjaGFyICpkb21haW4sIGlu
dCAqb3V0X2xlbiwgaW50ICpjb2RlKQoreworI2lmbmRlZiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQK
KyAgICAqb3V0X2xlbiA9IGluX2xlbjsKKyAgICAqY29kZSA9IDA7CisgICAgcmV0dXJuIChjaGFy
ICopaW47CisjZWxzZQorICAgIGludCBmbGFnczsKKyAgICBjaGFyICpjYWNoZWRfdWlkOworICAg
IGNoYXIgKmxkYXBfdWlkOworICAgIGludCBsZGFwX3VpZF9sZW47CisgICAgdW5zaWduZWQgbG9u
ZyBlcnJjb2RlOworICAgIGNoYXIgKmNhY2hlZF9zbj1OVUxMOworICAgIGludCBjYWNoZWRfc25f
bGVuOworICAgIGludCBzbl9mbGFncz0wOworCisgICAgKmNvZGUgPSAwOworICAgIGlmKChjYWNo
ZWRfdWlkID0gbWVtY2FjaGVfZmV0Y2goaW4sIGluX2xlbiwgZG9tYWluLCBvdXRfbGVuLCAwKSkp
CisJcmV0dXJuIGNhY2hlZF91aWQ7CisKKyAgICBjYWNoZWRfdWlkID0gZGlza2NhY2hlX2ZldGNo
KGluLCBpbl9sZW4sIGRvbWFpbiwgb3V0X2xlbiwgMCwgJmZsYWdzKTsKKyAgICBpZihjYWNoZWRf
dWlkICYmIChmbGFncyAmIEFDVFVBTCkpIHsKKwlpZighZGlza2ZsYWdzX3ZhbGlkKGZsYWdzKSB8
fCBtZW1jYWNoZV9zdG9yZShjYWNoZWRfdWlkLCAqb3V0X2xlbiwgZG9tYWluLCBpbiwgaW5fbGVu
LCBET05UX0FMTE9DSU4pKSB7CisJICAgIFNOX1RPX1VJRF9DTEVBTlVQKGNhY2hlZF91aWQsIGNh
Y2hlZF9zbiwgMCk7CisJICAgIHJldHVybiBOVUxMOworCX0KKwlyZXR1cm4gY2FjaGVkX3VpZDsK
KyAgICB9CisgICAgZWxzZSB7CisJLyogSWYgd2UnbGwgZm91bmQgaW52ZXJ0IHJlY29yZCB0aGVu
IHVzZXIncyBpbnB1dCBpcyB3cm9uZyAqLworCQorCWlmKChjYWNoZWRfc24gPSBtZW1jYWNoZV9m
ZXRjaChpbiwgaW5fbGVuLCBkb21haW4sICZjYWNoZWRfc25fbGVuLCBJTlRFUk5BTCkpKSB7CisJ
ICAgIGNhY2hlZF9zbj1OVUxMOworCSAgICBTTl9UT19VSURfQ0xFQU5VUChjYWNoZWRfdWlkLCBj
YWNoZWRfc24sIDApOworCSAgICByZXR1cm4gTlVMTDsKKwl9CisKKwljYWNoZWRfc24gPSBkaXNr
Y2FjaGVfZmV0Y2goaW4sIGluX2xlbiwgZG9tYWluLCAmY2FjaGVkX3NuX2xlbiwgSU5URVJOQUws
ICZzbl9mbGFncyk7CisJaWYoY2FjaGVkX3NuKSB7CisJICAgIGlmKHNuX2ZsYWdzICYgQUNUVUFM
KSB7CisJCS8qIGlmIGludmVydCByZWNvcmQgaXMgYWN0dWFsIHRoZW4gaXQgbXVzdCBiZSB2YWxp
ZAorCQkgICBiZWNhdXNlIGlmIGl0IGlzIG5vdCB2YWxpZCB0aGVuIHNuID09IHVpZCBhbmQgdGh1
cworCQkgICBjYWNoZWRfdWlkIG11c3QgYmUgdmFsaWQgdG9vIChidXQgYXQgdGhpcyBwb2ludCwK
KwkJICAgY2FjaGVkX3VpZCBpcyBub3QgdmFsaWQpICovCisJCWFzc2VydChkaXNrZmxhZ3NfdmFs
aWQoc25fZmxhZ3MpKTsKKwkJaWYobWVtY2FjaGVfc3RvcmUoaW4sIGluX2xlbiwgZG9tYWluLCBj
YWNoZWRfc24sIGNhY2hlZF9zbl9sZW4sIERPTlRfQUxMT0NPVVQpKQorCQkgICAgZnJlZShjYWNo
ZWRfc24pOworCQljYWNoZWRfc249TlVMTDsKKwkJU05fVE9fVUlEX0NMRUFOVVAoY2FjaGVkX3Vp
ZCwgY2FjaGVkX3NuLCAwKTsKKwkJcmV0dXJuIE5VTEw7CisJICAgIH0KKwl9CisgICAgfQorCisg
ICAgLyogTm93LCB3ZSBtYXkgaGF2ZSBub25hY3R1YWwgc24tPnVpZCBidXQgbWF5IGhhdmUgbm90
IChldmVuCisgICAgICAgbm9uYWN0dWFsIHNuLT51aWQpLiBXZSBtYXkgZGV0ZXJtaW5lIGl0IGJ5
IChjYWNoZWRfdWlkLAorICAgICAgICpvdXRfbGVuKSB2YXJpYWJsZXMuIEluIGJvdGggY2FzZXMg
d2UnbGwgdHJ5IHRvIHVzZSBMREFQLiAqLworCisgICAgbGRhcF91aWQ9Z2V0X2lkX2Zyb21fbGRh
cChpbiwgaW5fbGVuLCBkb21haW4sICZsZGFwX3VpZF9sZW4sICZlcnJjb2RlLCAwKTsKKyAgICBp
ZihsZGFwX3VpZCkgeworCWlmKCFkaXNrY2FjaGVfc3RvcmUobGRhcF91aWQsIGxkYXBfdWlkX2xl
biwgZG9tYWluLCBpbiwgaW5fbGVuLCBDT05WRVJUVVNFUklEX09LKSAmJgorCSAgICFtZW1jYWNo
ZV9zdG9yZShsZGFwX3VpZCwgbGRhcF91aWRfbGVuLCBkb21haW4sIGluLCBpbl9sZW4sIERPTlRf
QUxMT0NJTikpIHsKKwkgICAgU05fVE9fVUlEX0NMRUFOVVAoY2FjaGVkX3VpZCwgY2FjaGVkX3Nu
LCBsZGFwX3VpZF9sZW4pOworCSAgICByZXR1cm4gbGRhcF91aWQ7CisJfQorCWZyZWUobGRhcF91
aWQpOworCVNOX1RPX1VJRF9DTEVBTlVQKGNhY2hlZF91aWQsIGNhY2hlZF9zbiwgMCk7CisJcmV0
dXJuIE5VTEw7CisgICAgfQorCisgICAgaWYoZXJyY29kZT09Q09OVkVSVFVTRVJJRF9OT05FWElT
VEVOVF9JRCkgeworCWNoYXIgKmxkYXBfc247CisJaW50IGxkYXBfc25fbGVuOworCWludCB0ZW1w
Y29kZTsKKworCWlmKCFpbWFwZF9ub25jb252ZXJ0ZWR1c2VyaWRfYWxsb3dlZCkgeworCSAgICBp
ZihjYWNoZWRfdWlkKQorCQlkaXNrY2FjaGVfcmVtb3ZlKGNhY2hlZF91aWQsICpvdXRfbGVuLCBk
b21haW4sIGluLCBpbl9sZW4pOworCSAgICBTTl9UT19VSURfQ0xFQU5VUChjYWNoZWRfdWlkLCBj
YWNoZWRfc24sIDApOworCSAgICByZXR1cm4gTlVMTDsKKwl9CisKKwkvKiBtYWtpbmcgaW52ZXJ0
IExEQVAgcXVlcnkgKi8KKworCS8qIGlmIHRoZXJlIGlzIGNhY2hlZF9zbiB0aGVuIGl0IGlzIG5v
bmFjdHVhbCBzbyB3ZSBuZWVkIHRvIGRvCisJICAgTERBUCBxdWVyeSAqLworCisJbGRhcF9zbj1n
ZXRfaWRfZnJvbV9sZGFwKGluLCBpbl9sZW4sIGRvbWFpbiwgJmxkYXBfc25fbGVuLCAmZXJyY29k
ZSwgSU5URVJOQUwpOworCWlmKGxkYXBfc24pIHsKKwkgICAgaWYoY2FjaGVkX3VpZCkKKwkJZGlz
a2NhY2hlX3JlbW92ZShjYWNoZWRfdWlkLCAqb3V0X2xlbiwgZG9tYWluLCBpbiwgaW5fbGVuKTsK
KworCSAgICBpZihkaXNrY2FjaGVfc3RvcmUoaW4sIGluX2xlbiwgZG9tYWluLCBsZGFwX3NuLCBs
ZGFwX3NuX2xlbiwgQ09OVkVSVFVTRVJJRF9PSykgfHwgbWVtY2FjaGVfc3RvcmUoaW4sIGluX2xl
biwgZG9tYWluLCBsZGFwX3NuLCBsZGFwX3NuX2xlbiwgRE9OVF9BTExPQ09VVCkpCisJCWZyZWUo
bGRhcF9zbik7CisJICAgIFNOX1RPX1VJRF9DTEVBTlVQKGNhY2hlZF91aWQsIGNhY2hlZF9zbiwg
MCk7CisJICAgIHJldHVybiBOVUxMOworCX0KKworCWlmKGVycmNvZGU9PUNPTlZFUlRVU0VSSURf
Tk9ORVhJU1RFTlRfSUQpIHsKKwkgICAgaWYoY2FjaGVkX3VpZCkKKwkJZGlza2NhY2hlX3JlbW92
ZShjYWNoZWRfdWlkLCAqb3V0X2xlbiwgZG9tYWluLCBpbiwgaW5fbGVuKTsKKworCSAgICAvKiBX
ZSBuZWVkIHRvIGRlbGV0ZSBjYWNoZWRfc24gb25seSBpZiBpdCB3YXMgc3VjY2Vzc2Z1bGx5CisJ
ICAgICAgIHJlcXVlc3RlZCBmcm9tIExEQVAuIE90aGVyd2lzZSwgY2FjaGVkX3VpZD09Y2FjaGVk
X3NuCisJICAgICAgIHNvIGl0IGhhcyBiZWVuIGFscmVhZHkgZGVsZXRlZC4gKi8KKwkgICAgaWYo
Y2FjaGVkX3NuICYmIChzbl9mbGFncyZDT05WRVJUVVNFUklEX01BU0spPT1DT05WRVJUVVNFUklE
X09LKQorCQlkaXNrY2FjaGVfcmVtb3ZlKGluLCBpbl9sZW4sIGRvbWFpbiwgY2FjaGVkX3NuLCBj
YWNoZWRfc25fbGVuKTsKKwkgICAgKmNvZGUgPSBDT05WRVJUVVNFUklEX05PTkVYSVNURU5UX0lE
OworCSAgICBTTl9UT19VSURfQ0xFQU5VUChjYWNoZWRfdWlkLCBjYWNoZWRfc24sIGluX2xlbik7
CisJICAgIHJldHVybiAoY2hhciAqKWluOworCX0KKworCS8qIElmIGludmVydCBsZGFwIHF1ZXJ5
IGZhaWxlZCB0aGVuIHdlIG5lZWQgdG8gc2VlIG9uCisJICAgY2FjaGVkX3NuLiBJZiBjYWNoZWRf
c24gZXhpc3RzIHRoZW4gdGhlcmUgYXJlIGNhc2VzOgorCSAgIDEuIGNhY2hlZF9zbiB3YXMgc3Vj
Y2VmZnVsbHkgcmVxdWVzdGVkIGZyb20gTERBUC4gV2UgZG9uJ3QKKwkgICB3YW50IHRvIGRpc3Bs
YXkgdGhpcyByZWNvcmQ7CisJICAgMi4gY2FjaGVkX3NuIHdhcyBub3QgZm91bmQgaW4gTERBUAor
CSAgIChDT05WRVJUVVNFUklEX05PTkVYSVNURU5UX0lEKS4gSW4gdGhpcyBjYXNlIHdlIGNhbiBz
YXkKKwkgICB0aGF0IERCIGNoZWNraW5nIGlzIG5lZWRlZDsKKwkgICAzLiBUaGVyZSB3YXMgYW4g
ZXJyb3Igd2hpbGUgcmVxdWVzdGluZworCSAgIHNuLiBjYWNoZWRfdWlkPT1jYWNoZWRfc24gaW4g
dGhpcyBjYXNlLiBTbywgYW4gZXJyb3Igd2FzCisJICAgYW5kIGFuIGVycm9yIGlzLiBUaGVyZSBh
cmUgdHdvIGNhc2VzOgorCSAgIDMuMS4gV2UgaGF2ZSB0byBpZ25vcmUgZXJyb3JzLiBEQiBjaGVj
a2luZyBpcyBuZWVkZWQ7CisJICAgMy4yLiBXZSBtdXN0bid0IGlnbm9yZSBlcnJvcnMuIFdlIGRv
bid0IHdhbnQgdG8gZGlzcGxheQorCSAgIHRoaXMgcmVjb3JkOworCSAgIElmIGNhY2hlZF9zbiBk
b2Vzbid0IGV4aXN0IHRoZW4gd2Ugb25seSBkb24ndCB3YW50IHRvIGRpc3BsYXkKKwkgICB0aGlz
IHJlY29yZCBpZiB3ZSBtdXN0bid0IGlnbm9yZSBlcnJvcnMuCisJKi8KKwl0ZW1wY29kZSA9IHNu
X2ZsYWdzICYgQ09OVkVSVFVTRVJJRF9NQVNLOworCWlmKGNhY2hlZF9zbiA/CisJICAgKHRlbXBj
b2RlPT1DT05WRVJUVVNFUklEX09LIHx8ICh0ZW1wY29kZSE9Q09OVkVSVFVTRVJJRF9OT05FWElT
VEVOVF9JRCAmJiBpbWFwZF9kb250aWdub3JlX2NvbnZlcnR1c2VyaWRfZXJyb3JzKSkgOgorCSAg
IGltYXBkX2RvbnRpZ25vcmVfY29udmVydHVzZXJpZF9lcnJvcnMpIHsKKworCSAgICBpZih0ZW1w
Y29kZSE9Q09OVkVSVFVTRVJJRF9PSykKKwkJZGlza2NhY2hlX3JlbW92ZShjYWNoZWRfdWlkLCAq
b3V0X2xlbiwgZG9tYWluLCBpbiwgaW5fbGVuKTsKKwkgICAgZWxzZSBpZihjYWNoZWRfc24pIHsK
KwkJaWYobWVtY2FjaGVfc3RvcmUoaW4sIGluX2xlbiwgZG9tYWluLCBjYWNoZWRfc24sIGNhY2hl
ZF9zbl9sZW4sIERPTlRfQUxMT0NPVVQpKQorCQkgICAgZnJlZShjYWNoZWRfc24pOworCQljYWNo
ZWRfc249TlVMTDsKKwkJU05fVE9fVUlEX0NMRUFOVVAoY2FjaGVkX3VpZCwgY2FjaGVkX3NuLCAw
KTsKKwkJcmV0dXJuIE5VTEw7CisJICAgIH0KKworCSAgICBTTl9UT19VSURfQ0xFQU5VUChjYWNo
ZWRfdWlkLCBjYWNoZWRfc24sIDApOworCSAgICByZXR1cm4gTlVMTDsKKwl9CisKKwkvKiBSZW1v
dmUgY2FjaGVkIHJlY29yZHMgZnJvbSB0aGUgY2FjaGUuIFRoZXkgbWF5IGJlIGFkZGVkCisJICAg
YWdhaW4gaWYgc25fdG9fdWlkX3NhdmUoKSB3aWxsIGJlIGNhbGxlZC4gKi8KKwlpZihjYWNoZWRf
dWlkKQorCSAgICBkaXNrY2FjaGVfcmVtb3ZlKGNhY2hlZF91aWQsICpvdXRfbGVuLCBkb21haW4s
IGluLCBpbl9sZW4pOworCisJaWYoY2FjaGVkX3NuKQorCSAgICAqY29kZSA9ICh0ZW1wY29kZT09
Q09OVkVSVFVTRVJJRF9OT05FWElTVEVOVF9JRCkgPyBDT05WRVJUVVNFUklEX05PTkVYSVNURU5U
X0lEIDogZXJyY29kZTsKKwllbHNlCisJICAgICpjb2RlID0gZXJyY29kZTsKKworCVNOX1RPX1VJ
RF9DTEVBTlVQKGNhY2hlZF91aWQsIGNhY2hlZF9zbiwgaW5fbGVuKTsKKwlyZXR1cm4gKGNoYXIg
KilpbjsKKyAgICB9CisKKyAgICBpZihjYWNoZWRfdWlkICYmIGRpc2tmbGFnc192YWxpZChmbGFn
cykpIHsKKwlpZihtZW1jYWNoZV9zdG9yZShjYWNoZWRfdWlkLCAqb3V0X2xlbiwgZG9tYWluLCBp
biwgaW5fbGVuLCBET05UX0FMTE9DSU4pKSB7CisJICAgIFNOX1RPX1VJRF9DTEVBTlVQKGNhY2hl
ZF91aWQsIGNhY2hlZF9zbiwgMCk7CisJICAgIHJldHVybiBOVUxMOworCX0KKwlpZihjYWNoZWRf
c24pCisJICAgIGZyZWUoY2FjaGVkX3NuKTsKKwlyZXR1cm4gY2FjaGVkX3VpZDsKKyAgICB9Cisg
ICAgaWYoIWltYXBkX25vbmNvbnZlcnRlZHVzZXJpZF9hbGxvd2VkIHx8IGltYXBkX2RvbnRpZ25v
cmVfY29udmVydHVzZXJpZF9lcnJvcnMpIHsKKwlTTl9UT19VSURfQ0xFQU5VUChjYWNoZWRfdWlk
LCBjYWNoZWRfc24sIDApOworCXJldHVybiBOVUxMOworICAgIH0KKyAgICAqY29kZSA9IGVycmNv
ZGU7CisgICAgU05fVE9fVUlEX0NMRUFOVVAoY2FjaGVkX3VpZCwgY2FjaGVkX3NuLCBpbl9sZW4p
OworICAgIHJldHVybiAoY2hhciAqKWluOworI2VuZGlmIC8qIEVOQUJMRV9DT05WRVJUX1VTRVJJ
RCAqLworfQorCitzdGF0aWMgY2hhciAqc25fdG9fdWlkX3NhdmUoY29uc3QgY2hhciAqaW4sIGlu
dCBpbl9sZW4sIGNvbnN0IGNoYXIgKmRvbWFpbiwgaW50ICpvdXRfbGVuLCBpbnQgY29kZSkKK3sK
KyAgICBpZihkaXNrY2FjaGVfc3RvcmUoaW4sIGluX2xlbiwgZG9tYWluLCBpbiwgaW5fbGVuLCBj
b2RlKSB8fAorICAgICAgIG1lbWNhY2hlX3N0b3JlKGluLCBpbl9sZW4sIGRvbWFpbiwgaW4sIGlu
X2xlbiwgMCkpIHsKKwkqb3V0X2xlbj0wOworCXJldHVybiBOVUxMOworICAgIH0KKyAgICAqb3V0
X2xlbiA9IGluX2xlbjsKKyAgICByZXR1cm4gKGNoYXIgKilpbjsKK30KKworc3RhdGljIGNoYXIg
KnVpZF90b19zbihjb25zdCBjaGFyICppbiwgaW50IGluX2xlbiwgY29uc3QgY2hhciAqZG9tYWlu
LCBpbnQgKm91dF9sZW4pCit7CisjaWZuZGVmIEVOQUJMRV9DT05WRVJUX1VTRVJJRAorICAgICpv
dXRfbGVuID0gaW5fbGVuOworICAgIHJldHVybiAoY2hhciAqKWluOworI2Vsc2UKKyAgICBjaGFy
ICpjYWNoZWRfc247CisgICAgY2hhciAqbGRhcF9zbjsKKyAgICBpbnQgbGRhcF9zbl9sZW47Cisg
ICAgdW5zaWduZWQgbG9uZyBlcnJjb2RlOworICAgIGludCBmbGFnczsKKworICAgIGlmKChjYWNo
ZWRfc24gPSBtZW1jYWNoZV9mZXRjaChpbiwgaW5fbGVuLCBkb21haW4sIG91dF9sZW4sIElOVEVS
TkFMKSkpCisJcmV0dXJuIGNhY2hlZF9zbjsKKworICAgIGNhY2hlZF9zbiA9IGRpc2tjYWNoZV9m
ZXRjaChpbiwgaW5fbGVuLCBkb21haW4sIG91dF9sZW4sIElOVEVSTkFMLCAmZmxhZ3MpOworICAg
IGlmKGNhY2hlZF9zbiAmJiAoZmxhZ3MgJiBBQ1RVQUwpKSB7CisJaWYoIWRpc2tmbGFnc192YWxp
ZChmbGFncykgfHwgbWVtY2FjaGVfc3RvcmUoaW4sIGluX2xlbiwgZG9tYWluLCBjYWNoZWRfc24s
ICpvdXRfbGVuLCBET05UX0FMTE9DT1VUKSkgeworCSAgICBVSURfVE9fU05fQ0xFQU5VUChjYWNo
ZWRfc24sIDApOworCSAgICByZXR1cm4gTlVMTDsKKwl9CisJcmV0dXJuIGNhY2hlZF9zbjsKKyAg
ICB9CisKKyAgICBsZGFwX3NuPWdldF9pZF9mcm9tX2xkYXAoaW4sIGluX2xlbiwgZG9tYWluLCAm
bGRhcF9zbl9sZW4sICZlcnJjb2RlLCBJTlRFUk5BTCk7CisgICAgaWYobGRhcF9zbikgeworCWlm
KCFkaXNrY2FjaGVfc3RvcmUoaW4sIGluX2xlbiwgZG9tYWluLCBsZGFwX3NuLCBsZGFwX3NuX2xl
biwgQ09OVkVSVFVTRVJJRF9PSykgJiYKKwkgICAhbWVtY2FjaGVfc3RvcmUoaW4sIGluX2xlbiwg
ZG9tYWluLCBsZGFwX3NuLCBsZGFwX3NuX2xlbiwgRE9OVF9BTExPQ09VVCkpIHsKKwkgICAgVUlE
X1RPX1NOX0NMRUFOVVAoY2FjaGVkX3NuLCBsZGFwX3NuX2xlbik7CisJICAgIHJldHVybiBsZGFw
X3NuOworCX0KKwlmcmVlKGxkYXBfc24pOworCVVJRF9UT19TTl9DTEVBTlVQKGNhY2hlZF9zbiwg
MCk7CisJcmV0dXJuIE5VTEw7CisgICAgfQorCisgICAgaWYoZXJyY29kZT09Q09OVkVSVFVTRVJJ
RF9OT05FWElTVEVOVF9JRCkgeworCWlmKGNhY2hlZF9zbikKKwkgICAgZGlza2NhY2hlX3JlbW92
ZShpbiwgaW5fbGVuLCBkb21haW4sIGNhY2hlZF9zbiwgKm91dF9sZW4pOworCSAgICAKKwlpZigh
aW1hcGRfbm9uY29udmVydGVkdXNlcmlkX2FsbG93ZWQpIHsKKwkgICAgVUlEX1RPX1NOX0NMRUFO
VVAoY2FjaGVkX3NuLCAwKTsKKwkgICAgcmV0dXJuIE5VTEw7CisJfQorCisJaWYoZGlza2NhY2hl
X3N0b3JlKGluLCBpbl9sZW4sIGRvbWFpbiwgaW4sIGluX2xlbiwgQ09OVkVSVFVTRVJJRF9OT05F
WElTVEVOVF9JRCkgfHwgbWVtY2FjaGVfc3RvcmUoaW4sIGluX2xlbiwgZG9tYWluLCBpbiwgaW5f
bGVuLCAwKSkgeworCSAgICBVSURfVE9fU05fQ0xFQU5VUChjYWNoZWRfc24sIDApOworCSAgICBy
ZXR1cm4gTlVMTDsKKwl9CisJVUlEX1RPX1NOX0NMRUFOVVAoY2FjaGVkX3NuLCBpbl9sZW4pOwor
CXJldHVybiAoY2hhciAqKWluOworICAgIH0KKworICAgIGlmKGNhY2hlZF9zbiAmJiBkaXNrZmxh
Z3NfdmFsaWQoZmxhZ3MpKSB7CisJaWYobWVtY2FjaGVfc3RvcmUoaW4sIGluX2xlbiwgZG9tYWlu
LCBjYWNoZWRfc24sICpvdXRfbGVuLCBET05UX0FMTE9DT1VUKSkgeworCSAgICBVSURfVE9fU05f
Q0xFQU5VUChjYWNoZWRfc24sIDApOworCSAgICByZXR1cm4gTlVMTDsKKwl9CisJcmV0dXJuIGNh
Y2hlZF9zbjsKKyAgICB9CisKKyAgICBkaXNrY2FjaGVfc3RvcmUoaW4sIGluX2xlbiwgZG9tYWlu
LCBpbiwgaW5fbGVuLCBlcnJjb2RlKTsKKworICAgIGlmKCFpbWFwZF9ub25jb252ZXJ0ZWR1c2Vy
aWRfYWxsb3dlZCB8fCBpbWFwZF9kb250aWdub3JlX2NvbnZlcnR1c2VyaWRfZXJyb3JzKSB7CisJ
VUlEX1RPX1NOX0NMRUFOVVAoY2FjaGVkX3NuLCAwKTsKKwlyZXR1cm4gTlVMTDsKKyAgICB9CisK
KyAgICBpZihtZW1jYWNoZV9zdG9yZShpbiwgaW5fbGVuLCBkb21haW4sIGluLCBpbl9sZW4sIDAp
KSB7CisJVUlEX1RPX1NOX0NMRUFOVVAoY2FjaGVkX3NuLCAwKTsKKwlyZXR1cm4gTlVMTDsKKyAg
ICB9CisKKyAgICBVSURfVE9fU05fQ0xFQU5VUChjYWNoZWRfc24sIGluX2xlbik7CisgICAgcmV0
dXJuIChjaGFyICopaW47CisjZW5kaWYgLyogRU5BQkxFX0NPTlZFUlRfVVNFUklEICovCit9CisK
K3N0YXRpYyB2b2lkIHJidF93YWxrX2NiKGNvbnN0IHZvaWQgKm5vZGVwLCBjb25zdCBWSVNJVCB3
aGljaCwgY29uc3QgaW50IGRlcHRoLCB2b2lkICphcmcpCit7CisgICAgaWYod2hpY2ggPT0gZW5k
b3JkZXIgfHwgd2hpY2ggPT0gbGVhZikKKwlyYnRfZnJlZV91c2VyaWRfZGF0YSgocmJ0X2RhdGFf
dCAqKW5vZGVwKTsKK30KKworLyogZGVzdHJveWluZyBhbGwgdGhlIGRhdGEgbmVlZGVkIGZvciBu
YW1lcyB0cmFuc2Zvcm1hdGlvbiAodGhpcworICAgZnVuY3Rpb24gaXMgY2FsbGVkIHdoZW4gY2xp
ZW50IHRlcm1pbmF0ZXMgaGlzIGNvbm5lY3Rpb24pICovCitleHRlcm4gdm9pZCBtYm94bmFtZV9j
bGVhbnVwKCkKK3sKKyAgICByYnRfZGF0YV90ICpkYXRhOworCisgICAgaWYocmJ0X2ludF90b19l
eHQpIHsKKwlyYndhbGsocmJ0X2ludF90b19leHQsIHJidF93YWxrX2NiLCBOVUxMKTsKKwkgICAg
CisJcmJkZXN0cm95KHJidF9pbnRfdG9fZXh0KTsKKwlyYnRfaW50X3RvX2V4dD1OVUxMOworICAg
IH0KKyAgICBpZihyYnRfZXh0X3RvX2ludCkgeworCXJiZGVzdHJveShyYnRfZXh0X3RvX2ludCk7
CisJcmJ0X2V4dF90b19pbnQ9TlVMTDsKKyAgICB9Cit9CisKK2V4dGVybiBpbnQgY29udmVydHVz
ZXJpZF9jbGVhbnVwKCkKK3sKKyAgICBjbG9zZShjb252ZXJ0dXNlcmlkX3NvY2tldCk7CisKKyAg
ICBpZihjb252ZXJ0dXNlcmlkX2RiKSB7CisJY29uZmlnX2NvbnZlcnR1c2VyaWRfY2FjaGVfZGIt
PmNsb3NlKGNvbnZlcnR1c2VyaWRfZGIpOworCWNvbnZlcnR1c2VyaWRfZGI9TlVMTDsKKyAgICB9
Cit9CisKKyNlbmRpZiAvKiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQgKi8KKwogLyogQ2hlY2sgbWFp
bGJveCBuYW1lIGZvciBjb3JyZWN0IGhpZXJzZXBzIHN5bWJvbHMgZGVwZW5kaW5nIG9uCiAgICBu
YW1lc3BhY2UgKi8KIHN0YXRpYyBpbnQgbWJveG5hbWVfY2hlY2tfaGllcnNlcHMoc3RydWN0IG5h
bWVzcGFjZSAqbmFtZXNwYWNlLCBjb25zdCBjaGFyICpuYW1lLCBpbnQgbmFtZWxlbikKQEAgLTIw
Niw3ICs5ODYsNyBAQAogCQkJCSAgIGNvbnN0IGNoYXIgKm5hbWUsCiAJCQkJICAgY29uc3QgY2hh
ciAqdXNlcmlkLCBjaGFyICpyZXN1bHQpCiB7Ci0gICAgY2hhciAqY3A7CisgICAgY2hhciAqY3As
ICpkb21haW49IiI7CiAgICAgaW50IHVzZXJsZW4sIGRvbWFpbmxlbiA9IDAsIG5hbWVsZW47CiAg
ICAgaW50IHByZWZpeGxlbjsKICAgICBzaXplX3QgcmVzdWx0bGVuOwpAQCAtMjIzLDcgKzEwMDMs
OCBAQAogICAgIGlmIChjb25maWdfdmlydGRvbWFpbnMpIHsKIAlpZiAodXNlcmlkICYmIChjcCA9
IHN0cmNocih1c2VyaWQsICdAJykpKSB7CiAJICAgIC8qIHVzZXIgbG9nZ2VkIGluIGFzIHVzZXJA
ZG9tYWluICovCi0JICAgIHVzZXJsZW4gPSBjcCsrIC0gdXNlcmlkOworCSAgICB1c2VybGVuID0g
Y3AgLSB1c2VyaWQ7CisJICAgIGRvbWFpbiA9ICsrY3A7CiAJICAgIGlmICghKGNvbmZpZ19kZWZk
b21haW4gJiYgIXN0cmNhc2VjbXAoY29uZmlnX2RlZmRvbWFpbiwgY3ApKSkgewogCQkvKiBkb24n
dCBwcmVwZW5kIGRlZmF1bHQgZG9tYWluICovCiAJCWRvbWFpbmxlbiA9IHN0cmxlbihjcCkrMTsK
QEAgLTIzNCw2ICsxMDE1LDcgQEAKIAl9CiAJaWYgKChjcCA9IHN0cnJjaHIobmFtZSwgJ0AnKSkp
IHsKIAkgICAgLyogbWFpbGJveCBzcGVjaWZpZWQgYXMgbWJveEBkb21haW4gKi8KKwkgICAgZG9t
YWluID0gY3ArMTsKIAkgICAgbmFtZWxlbiA9IGNwIC0gbmFtZTsKIAogCSAgICBpZiAoY29uZmln
X2RlZmRvbWFpbiAmJiAhc3RyY2FzZWNtcChjb25maWdfZGVmZG9tYWluLCBjcCsxKSkgewpAQCAt
MjkxLDE4ICsxMDczLDc0IEBACiAKICAgICBpZiAoIXN0cm5jbXAobmFtZSwgbmFtZXNwYWNlLT5w
cmVmaXhbTkFNRVNQQUNFX1VTRVJdLCBwcmVmaXhsZW4tMSkgJiYKIAkobmFtZWxlbiA9PSBwcmVm
aXhsZW4tMSB8fCBuYW1lW3ByZWZpeGxlbi0xXSA9PSBuYW1lc3BhY2UtPmhpZXJfc2VwKSkgewor
CWNoYXIgbW9kaWZpZWRfdXNlcm5hbWVbTUFYX01BSUxCT1hfTkFNRSsxXTsKKwljaGFyICppbnRf
aWQ9IiI7CisJc2l6ZV90IGludF9pZF9sZW49MDsKKwlzaXplX3QgZXh0X2lkX2xlbj0wOwogCiAJ
aWYgKG5hbWVsZW4gPT0gcHJlZml4bGVuLTEpIHsKIAkgICAgLyogY2FuJ3QgY3JlYXRlIGZvbGRl
cnMgdXNpbmcgdW5kZWxpbWl0ZWQgcHJlZml4ICovCiAJICAgIHJldHVybiBJTUFQX01BSUxCT1hf
QkFETkFNRTsKIAl9CiAKLQlpZiAoZG9tYWlubGVuK25hbWVsZW4tcHJlZml4bGVuKzUgPiBNQVhf
TUFJTEJPWF9OQU1FKSB7Ci0JICAgIHJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsKKwlpZigh
aW1hcGRfY29udmVydHVzZXJpZCkgeworCSAgICBpZiAoZG9tYWlubGVuK25hbWVsZW4tcHJlZml4
bGVuKzUgPiBNQVhfTUFJTEJPWF9OQU1FKQorCQlyZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7
CisJICAgIG5hbWUrPXByZWZpeGxlbjsKIAl9CisJZWxzZSB7CisJICAgIGNoYXIgKnNlcDsKKwkg
ICAgaW50IGNvZGU7CisKKwkgICAgbmFtZSs9cHJlZml4bGVuOworCSAgICBzZXA9c3RyY2hyKG5h
bWUsbmFtZXNwYWNlLT5oaWVyX3NlcCk7CisJICAgIGlmKCFzZXAgfHwgc2VwLW5hbWUgPj0gbmFt
ZWxlbi1wcmVmaXhsZW4pCisJCWV4dF9pZF9sZW4gPSBuYW1lbGVuLXByZWZpeGxlbjsKKwkgICAg
ZWxzZQorCQlleHRfaWRfbGVuID0gc2VwLW5hbWU7CisKKwkgICAgaWYoIWV4dF9pZF9sZW4pCisJ
CXJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsKKworCSAgICAvKiB3ZSBtdXN0IHRyYW5zZm9y
bSBoaWVyYXJjaHkgc2VwYXJhdG9ycyBpbiB0aGUgX3VzZXJfaWRfCisJICAgICAgIGludG8gaW50
ZXJuYWwgcmVwcmVzZW50YXRpb25zIGJlZm9yZSBxdWVyeWluZyB0aGUKKwkgICAgICAgaW50ZXJu
YWwgdXNlciBpZCBiZWNhdXNlIHRoZSByZXZlcnQgdHJhbnNmb3JtYXRpb24KKwkgICAgICAgd29y
a3Mgd2l0aCB1c2VybmFtZXMgb25seSBhbmQga25vd3Mgbm90aGluZyBhYm91dAorCSAgICAgICBz
ZXBhcmF0b3JzIC0tIHNvcmNlcmVyICovCisJICAgIG1lbWNweShtb2RpZmllZF91c2VybmFtZSwg
bmFtZSwgZXh0X2lkX2xlbik7CisJICAgIG1ib3huYW1lX2hpZXJzZXBfdG9pbnRlcm5hbChuYW1l
c3BhY2UsIG1vZGlmaWVkX3VzZXJuYW1lLGV4dF9pZF9sZW4pOworCisJICAgIGludF9pZCA9IHNu
X3RvX3VpZChtb2RpZmllZF91c2VybmFtZSwgZXh0X2lkX2xlbiwgZG9tYWluLCAmaW50X2lkX2xl
biwgJmNvZGUpOworCSAgICBpZihpbnRfaWQgJiYgY29kZSkgeworCQljaGFyIHRlbXBfbWJuYW1l
W01BWF9NQUlMQk9YX05BTUUrMV07CisKKwkJLyogYnVpbGQgaW50ZXJuYWwgbWFpbGJveCBuYW1l
IHdpdGggZ2l2ZW4gdXNlcmlkIHRvCisJCSAgIGNoZWNrIGlmIHRoaXMgbWFpbGJveCBleGlzdHMg
Ki8KKwkJaWYoZG9tYWlubGVuK25hbWVsZW4tcHJlZml4bGVuKzUgPiBNQVhfTUFJTEJPWF9OQU1F
KQorCQkgICAgcmV0dXJuIElNQVBfTUFJTEJPWF9CQUROQU1FOworCisJCW1lbWNweSh0ZW1wX21i
bmFtZSwgInVzZXIuIiwgNSk7CisJCW1lbWNweSh0ZW1wX21ibmFtZSs1LCBtb2RpZmllZF91c2Vy
bmFtZSwgZXh0X2lkX2xlbik7CisJCW1lbWNweSh0ZW1wX21ibmFtZSs1K2V4dF9pZF9sZW4sIG5h
bWUrZXh0X2lkX2xlbiwgbmFtZWxlbi1wcmVmaXhsZW4tZXh0X2lkX2xlbik7CisJCXRlbXBfbWJu
YW1lWzUrbmFtZWxlbi1wcmVmaXhsZW5dPTA7CisKKwkJbWJveG5hbWVfaGllcnNlcF90b2ludGVy
bmFsKG5hbWVzcGFjZSwgdGVtcF9tYm5hbWUrNSwgMCk7CisJCWlmKG1ib3hsaXN0X2xvb2t1cCh0
ZW1wX21ibmFtZSwgTlVMTCwgTlVMTCwgTlVMTCkpCisJCSAgICByZXR1cm4gSU1BUF9NQUlMQk9Y
X05PTkVYSVNURU5UOwogCi0Jc3ByaW50ZihyZXN1bHQsICJ1c2VyLiUuKnMiLCBuYW1lbGVuLXBy
ZWZpeGxlbiwgbmFtZStwcmVmaXhsZW4pOworCQlpbnRfaWQgPSBzbl90b191aWRfc2F2ZShtb2Rp
ZmllZF91c2VybmFtZSwgZXh0X2lkX2xlbiwgZG9tYWluLCAmaW50X2lkX2xlbiwgY29kZSk7CisJ
ICAgIH0KKworCSAgICBpZighaW50X2lkKQorCQlyZXR1cm4gSU1BUF9NQUlMQk9YX05PTkVYSVNU
RU5UOwogCisJICAgIGlmKGRvbWFpbmxlbituYW1lbGVuLXByZWZpeGxlbis1LWV4dF9pZF9sZW4r
aW50X2lkX2xlbiA+IE1BWF9NQUlMQk9YX05BTUUpCisJCXJldHVybiBJTUFQX01BSUxCT1hfQkFE
TkFNRTsKKwkgICAgbmFtZSs9ZXh0X2lkX2xlbjsKKwl9CisKKwlzcHJpbnRmKHJlc3VsdCwgInVz
ZXIuJS4qcyUuKnMiLCBpbnRfaWRfbGVuLCBpbnRfaWQsIG5hbWVsZW4tcHJlZml4bGVuLWV4dF9p
ZF9sZW4sIG5hbWUpOworCQogCS8qIFRyYW5zbGF0ZSBhbnkgc2VwYXJhdG9ycyBpbiB1c2VyaWQr
bWFpbGJveCAqLwogCW1ib3huYW1lX2hpZXJzZXBfdG9pbnRlcm5hbChuYW1lc3BhY2UsIHJlc3Vs
dCs1LCAwKTsKIAlyZXR1cm4gMDsKQEAgLTQwMCw3ICsxMjM4LDcgQEAKIHN0YXRpYyBpbnQgbWJv
eG5hbWVfdG9leHRlcm5hbF9hbHQoc3RydWN0IG5hbWVzcGFjZSAqbmFtZXNwYWNlLCBjb25zdCBj
aGFyICpuYW1lLAogCQkJCSAgY29uc3QgY2hhciAqdXNlcmlkLCBjaGFyICpyZXN1bHQpCiB7Ci0g
ICAgY2hhciAqZG9tYWluOworICAgIGNoYXIgKmRvbWFpbj1OVUxMOwogICAgIHNpemVfdCB1c2Vy
bGVuLCByZXN1bHRsZW47CiAKICAgICAvKiBCbGFuayB0aGUgcmVzdWx0LCBqdXN0IGluIGNhc2Ug
Ki8KQEAgLTQxNiwxMyArMTI1NCwxOSBAQAogCXNpemVfdCBkb21haW5sZW4gPSBzdHJsZW4oZG9t
YWluKTsKIAogCXVzZXJsZW4gPSBkb21haW4gLSB1c2VyaWQ7CisJZG9tYWluKys7CisJZG9tYWlu
bGVuLS07CiAKLQlpZiAoIXN0cm5jbXAobmFtZSwgZG9tYWluKzEsIGRvbWFpbmxlbi0xKSAmJgot
CSAgICBuYW1lW2RvbWFpbmxlbi0xXSA9PSAnIScpIHsKLQkgICAgbmFtZSArPSBkb21haW5sZW47
CisJaWYgKCFzdHJuY21wKG5hbWUsIGRvbWFpbiwgZG9tYWlubGVuKSAmJgorCSAgICBuYW1lW2Rv
bWFpbmxlbl0gPT0gJyEnKSB7CisJICAgIG5hbWUgKz0gZG9tYWlubGVuKzE7CiAJfQogICAgIH0K
IAorICAgIC8qIHNldCB0aGUgZW1wdHkgZG9tYWluIGlmIGl0IGRvZXNuJ3QgZXhpc3RzICovCisg
ICAgaWYoIWRvbWFpbikKKwlkb21haW49IiI7CisKICAgICAvKiBQZXJzb25hbCAoSU5CT1gpIG5h
bWVzcGFjZSAqLwogICAgIGlmICghc3RybmNhc2VjbXAobmFtZSwgImluYm94IiwgNSkgJiYKIAko
bmFtZVs1XSA9PSAnXDAnIHx8IG5hbWVbNV0gPT0gJy4nKSkgewpAQCAtNDQ2LDE4ICsxMjkwLDUy
IEBACiAgICAgZWxzZSBpZiAoIXN0cm5jbXAobmFtZSwgInVzZXIiLCA0KSAmJgogCSAgICAgKG5h
bWVbNF0gPT0gJ1wwJyB8fCBuYW1lWzRdID09ICcuJykpIHsKIAlzaXplX3QgcHJlZml4bGVuID0g
c3RybGVuKG5hbWVzcGFjZS0+cHJlZml4W05BTUVTUEFDRV9VU0VSXSk7CisJY2hhciAqZXh0X2lk
PSIiOworCXNpemVfdCBleHRfaWRfbGVuPTA7CiAKLQlpZiAoKHByZWZpeGxlbiA+IE1BWF9NQUlM
Qk9YX05BTUUpIHx8IAotCSAgICAoKG5hbWVbNF0gPT0gJy4nKSAmJiAKLQkgICAgICgocHJlZml4
bGVuKzErc3RybGVuKG5hbWUrNSkpID4gTUFYX01BSUxCT1hfTkFNRSkpKQorCWlmIChwcmVmaXhs
ZW4gPiBNQVhfTUFJTEJPWF9OQU1FKQogCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7
CisJCisJaWYobmFtZVs0XSA9PSAnLicpIHsKKwkgICAgaWYoIWltYXBkX2NvbnZlcnR1c2VyaWQp
IHsKKwkJaWYoKHByZWZpeGxlbisxK3N0cmxlbihuYW1lKzUpKSA+IE1BWF9NQUlMQk9YX05BTUUp
CisJCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7CisJCW5hbWUrPTU7CisJICAgIH0K
KwkgICAgLyogZmV0Y2hpbmcgdGhlIHVzZXIncyBpZGVudGlmaWVyIC8vIHNvcmNlcmVyICovCisJ
ICAgIGVsc2UgeworCQljaGFyICpzZXA7CisJCXNpemVfdCBpbnRfaWRfbGVuOworCisJCW5hbWUr
PTU7CisJCXNlcD1zdHJjaHIobmFtZSwnLicpOworCQlpZihzZXApCisJCSAgICBpbnRfaWRfbGVu
PXNlcC1uYW1lOworCQllbHNlCisJCSAgICBpbnRfaWRfbGVuPXN0cmxlbihuYW1lKTsKKworCQlp
ZighaW50X2lkX2xlbikKKwkJICAgIHJldHVybiBJTUFQX01BSUxCT1hfQkFETkFNRTsKKworCQkv
KiB3ZSBhc3N1bWUgdGhhdCB0aGUgdXNlciBkb21haW4gaXMgc2FtZSBhcyB0aGUgbmFtZSdzCisJ
CSAgIGRvbWFpbiAoaW50ZXJkb21haW4gbG9va3VwIGFyZSBkZW5pZWQpICovCisJCWV4dF9pZCA9
IHVpZF90b19zbihuYW1lLCBpbnRfaWRfbGVuLCBkb21haW4sICZleHRfaWRfbGVuKTsKKwkJaWYo
IWV4dF9pZCkKKwkJICAgIHJldHVybiBJTUFQX01BSUxCT1hfTk9ORVhJU1RFTlQ7CisJCWlmKHBy
ZWZpeGxlbiArIGV4dF9pZF9sZW4gKyBzdHJsZW4obmFtZStpbnRfaWRfbGVuKSA+IE1BWF9NQUlM
Qk9YX05BTUUpCisJCSAgICByZXR1cm4gSU1BUF9NQUlMQk9YX0JBRE5BTUU7CisJCW5hbWUrPWlu
dF9pZF9sZW47CisJICAgIH0KKwl9CiAKIAlzcHJpbnRmKHJlc3VsdCwgIiUuKnMiLAogCQlwcmVm
aXhsZW4tMSwgbmFtZXNwYWNlLT5wcmVmaXhbTkFNRVNQQUNFX1VTRVJdKTsKIAlyZXN1bHRsZW4g
PSBzdHJsZW4ocmVzdWx0KTsKLQlpZiAobmFtZVs0XSA9PSAnLicpIHsKLQkgICAgc3ByaW50Zihy
ZXN1bHQrcmVzdWx0bGVuLCAiJWMlcyIsIG5hbWVzcGFjZS0+aGllcl9zZXAsIG5hbWUrNSk7Ci0J
fQorCisJLyogaW4gdGhlIGNhc2UgaWYgZmV0Y2hpbmcgaWQgaXNuJ3QgZW5hYmxlZCwgZXh0X2lk
IHZhcmlhYmxlCisJICAgd2lsbCBiZSBlbXB0eSBhbmQgbmFtZSB2YXJpYWJsZSB3aWxsIGNvbnNp
c3Qgb2YgdGhlIGZ1bGwKKwkgICBtYWlsYm94IG5hbWUgd2l0aG91dCBuYW1lc3BhY2UtPnByZWZp
eFtOQU1FU1BBQ0VfVVNFUl0gKi8KKwlzcHJpbnRmKHJlc3VsdCtyZXN1bHRsZW4sICIlYyUuKnMl
cyIsIG5hbWVzcGFjZS0+aGllcl9zZXAsIGV4dF9pZF9sZW4sIGV4dF9pZCwgbmFtZSk7CiAgICAg
fQogCiAgICAgLyogU2hhcmVkIG5hbWVzcGFjZSAqLwpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4y
LjEyLm9sZC9pbWFwL21ib3huYW1lLmggY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJveG5hbWUu
aAotLS0gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9pbWFwL21ib3huYW1lLmgJMjAwNS0xMi0zMCAx
Mjo1NjoyNSArMDMwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL2ltYXAvbWJveG5hbWUuaAkyMDA1
LTEyLTMwIDE1OjEzOjU5ICswMzAwCkBAIC03OCw2ICs3OCwyMyBAQAogCQkJICAgIHZvaWQgKnJv
Y2ssIGludCBmb3JjZSk7CiB9OwogCisjaWZkZWYgRU5BQkxFX0NPTlZFUlRfVVNFUklECisjZGVm
aW5lIEZOQU1FX0NPTlZFUlRVU0VSSUQgIi9jb252ZXJ0dXNlcmlkLmRiIgorCisvKiBjb252ZXJ0
IG90aGVyIHVzZXJzIGlkcyBiZXR3ZWVuIG5hbWVzcGFjZXMgKHN3aXRjaCkgKi8KK2V4dGVybiBp
bnQgaW1hcGRfY29udmVydHVzZXJpZDsKK2V4dGVybiBpbnQgaW1hcGRfbm9uY29udmVydGVkdXNl
cmlkX2FsbG93ZWQ7CitleHRlcm4gaW50IGltYXBkX2RvbnRpZ25vcmVfY29udmVydHVzZXJpZF9l
cnJvcnM7CitleHRlcm4gaW50IGltYXBkX2NvbnZlcnR1c2VyaWRfYWN0dWFsX3RpbWVvdXQ7CisK
Ky8qIGNvbnZlcnQgdXNlcmlkIGluaXRpYWxpemF0aW9uIGFuZCBjbGVhbnVwICovCitpbnQgY29u
dmVydHVzZXJpZF9pbml0KCk7CitpbnQgY29udmVydHVzZXJpZF9jb25maWdfcmVyZWFkKCk7Citp
bnQgY29udmVydHVzZXJpZF9jbGVhbnVwKCk7CisvKiBkZXN0cm95IGFkZGl0aW9uYWwgaW5mb3Jt
YXRpb24gd2hpY2ggaXMgbmVlZGVkIHRvIHRyYW5zZm9ybSB1c2VyaWRzICovCit2b2lkIG1ib3hu
YW1lX2NsZWFudXAoKTsKKyNlbmRpZiAvKiBFTkFCTEVfQ09OVkVSVF9VU0VSSUQgKi8KKwogLyog
Y3JlYXRlIG5hbWVzcGFjZSBiYXNlZCBvbiBnaXZlbiBvcHRpb25zICovCiBpbnQgbWJveG5hbWVf
aW5pdF9uYW1lc3BhY2VfZXh0KHN0cnVjdCBuYW1lc3BhY2UgKm5hbWVzcGFjZSwgaW50IGlzYWRt
aW4sIGNoYXIgaGllcl9zZXAsIGludCBpc2FsdCk7CiAvKiBDcmVhdGUgbmFtZXNwYWNlIGJhc2Vk
IG9uIGNvbmZpZyBvcHRpb25zLiAqLwpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9s
aWIvaGFzaC5jIGN5cnVzLWltYXBkLTIuMi4xMi9saWIvaGFzaC5jCi0tLSBjeXJ1cy1pbWFwZC0y
LjIuMTIub2xkL2xpYi9oYXNoLmMJMjAwNC0wNS0yNCAxODozMjozNCArMDQwMAorKysgY3lydXMt
aW1hcGQtMi4yLjEyL2xpYi9oYXNoLmMJMjAwNS0xMi0zMCAxNToxMzo1OSArMDMwMApAQCAtMzE3
LDYgKzMxNywzOSBAQAogICAgICAgfQogfQogCisvKiBTYW1lIGFzIGhhc2hfZW51bWVyYXRlKCkg
YnV0IGhhcyBhYmlsaXR5IHRvIGRlbGV0ZSBrZXlzIHdoaWxlIGdvaW5nCisgICB0aHJvdWdoIGEg
aGFzaCB0YWJsZS4gUmV0dXJuIG5vbi16ZXJvIHZhbHVlIGZyb20gdGhlIGNhbGxiYWNrCisgICBm
dW5jdGlvbiBpZiB5b3Ugd2FudCB0byBkZWxldGUgYSBrZXkuIERlbGV0ZSBhbnkgZXh0ZXJuYWwg
ZGF0YQorICAgeW91cnNlbGYuICovCit2b2lkIGhhc2hfd2FsayhoYXNoX3RhYmxlICp0YWJsZSwg
aW50ICgqZnVuYykoY2hhciAqLCB2b2lkICosIHZvaWQgKiksCisJCSAgICB2b2lkICpyb2NrKQor
eworICAgIHVuc2lnbmVkIGk7CisgICAgYnVja2V0ICp0ZW1wLCAqdGVtcF9vbGQsICp0ZW1wX25l
eHQ7CisKKyAgICBmb3IgKGk9MDtpPHRhYmxlLT5zaXplOyBpKyspIHsKKwlpZiAoKHRhYmxlLT50
YWJsZSlbaV0gIT0gTlVMTCkgeworCSAgICBmb3IgKHRlbXAgPSAodGFibGUtPnRhYmxlKVtpXSwg
dGVtcF9vbGQ9TlVMTDsKKwkJIE5VTEwgIT0gdGVtcDsKKwkJIHRlbXAgPSB0ZW1wX25leHQpIHsK
KworCQl0ZW1wX25leHQgPSB0ZW1wLT5uZXh0OworCQlpZihmdW5jKHRlbXAgLT4ga2V5LCB0ZW1w
LT5kYXRhLCByb2NrKSkgeworCQkgICAgaWYodGVtcF9vbGQpCisJCQl0ZW1wX29sZC0+bmV4dCA9
IHRlbXBfbmV4dDsKKwkJICAgIGVsc2UKKwkJCSh0YWJsZS0+dGFibGUpW2ldID0gdGVtcF9uZXh0
OworCQkgICAgaWYoIXRhYmxlLT5wb29sKSB7CisJCQlmcmVlKHRlbXAtPmtleSk7CisJCQlmcmVl
KHRlbXApOworCQkgICAgfQorCQl9CisJCWVsc2UKKwkJICAgIHRlbXBfb2xkPXRlbXA7CisJICAg
IH0KKwl9CisgICAgfQorfQogCiAjaWZkZWYgVEVTVAogCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0y
LjIuMTIub2xkL2xpYi9oYXNoLmggY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9oYXNoLmgKLS0tIGN5
cnVzLWltYXBkLTIuMi4xMi5vbGQvbGliL2hhc2guaAkyMDAzLTEwLTIyIDIyOjUwOjEyICswNDAw
CisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2hhc2guaAkyMDA1LTEyLTMwIDE1OjEzOjU5ICsw
MzAwCkBAIC03OCw2ICs3OCwxMyBAQAogdm9pZCBoYXNoX2VudW1lcmF0ZShoYXNoX3RhYmxlICp0
YWJsZSx2b2lkICgqZnVuYykoY2hhciAqLHZvaWQgKix2b2lkICopLAogCQkgICAgdm9pZCAqcm9j
ayk7CiAKKy8qIFNhbWUgYXMgaGFzaF9lbnVtZXJhdGUoKSBidXQgaGFzIGFiaWxpdHkgdG8gZGVs
ZXRlIGtleXMgd2hpbGUgZ29pbmcKKyAgIHRocm91Z2ggYSBoYXNoIHRhYmxlLiBSZXR1cm4gbm9u
LXplcm8gdmFsdWUgZnJvbSB0aGUgY2FsbGJhY2sKKyAgIGZ1bmN0aW9uIGlmIHlvdSB3YW50IHRv
IGRlbGV0ZSBhIGtleS4gRGVsZXRlIGFueSBleHRlcm5hbCBkYXRhCisgICB5b3Vyc2VsZi4gKi8K
K3ZvaWQgaGFzaF93YWxrKGhhc2hfdGFibGUgKnRhYmxlLCBpbnQgKCpmdW5jKShjaGFyICosIHZv
aWQgKiwgdm9pZCAqKSwKKwkgICAgICAgdm9pZCAqcm9jayk7CisKIC8qCiAqKiBGcmVlcyBhIGhh
c2ggdGFibGUuICBGb3IgZWFjaCBub2RlIHRoYXQgd2FzIGluc2VydGVkIGluIHRoZSB0YWJsZSwK
ICoqIGl0IGNhbGxzIHRoZSBmdW5jdGlvbiB3aG9zZSBhZGRyZXNzIGl0IHdhcyBwYXNzZWQsIHdp
dGggYSBwb2ludGVyCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2xpYi9pbWFwb3B0
aW9ucyBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2ltYXBvcHRpb25zCi0tLSBjeXJ1cy1pbWFwZC0y
LjIuMTIub2xkL2xpYi9pbWFwb3B0aW9ucwkyMDA1LTEyLTMwIDEyOjU2OjA0ICswMzAwCisrKyBj
eXJ1cy1pbWFwZC0yLjIuMTIvbGliL2ltYXBvcHRpb25zCTIwMDUtMTItMzAgMTU6MTM6NTkgKzAz
MDAKQEAgLTkxMCw2ICs5MTAsNzYgQEAKICAgIGludGVyZmFjZSwgb3RoZXJ3aXNlIHRoZSB1c2Vy
IGlzIGFzc3VtZWQgdG8gYmUgaW4gdGhlIGRlZmF1bHQKICAgIGRvbWFpbiAoaWYgc2V0KS4gKi8K
IAoreyAiY29udmVydHVzZXJpZCIsIDAsIFNXSVRDSCB9CisvKiBFbmFibGUgdXNlciBpZGVudGlm
aWVycyBjb252ZXJzaW9uIHZpYSBMREFQLiBUaGlzIGlzIGEgZGVmYXVsdAorICAgcnVsZTogaXQg
aXMgcG9zc2libGUgdG8gc2V0IGV4ZW1wdGlvbnMgb24gc29tZSBzZXQgb2YgdXNlcnMgdmlhCisg
ICBjb252ZXJ0dXNlcmlkX2V4ZW1wdHMgY29uZmlnIHZhcmlhYmxlLiBJZiB1c2VyJ3MgcnVsZSBp
cyAnY29udmVydCcKKyAgIHRoZW4gaGUgZG9lc24ndCBzZWUgdXNlciBpZGVudGlmaWVycyB2aWEg
SU1BUCBjb21tYW5kcy4gSW5zdGVhZCwKKyAgIG5hbWVzIGdvdCBmcm9tIExEQVAgYXJlIHNob3dl
ZC4gVGhpcyBvcHRpb24gaXMgcmVyZWFkZWQgb24gZWFjaAorICAgbmV3IGNvbm5lY3RlZCBJTUFQ
IGNsaWVudCwgc28geW91IGRvbid0IG5lZWQgdG8gcmVzdGFydCB0aGUgc2VydmVyCisgICB0byBh
cHBseSBjaGFuZ2VzLiAqLworCit7ICJjb252ZXJ0dXNlcmlkX2V4ZW1wdHMiLCBOVUxMLCBTVFJJ
TkcgfQorLyogRXhlbXRpb25zIChsaXN0IG9mIHVzZXIgaWRlbnRpZmllcnMpIGZyb20gY29udmVy
dHVzZXJpZCBvcHRpb24uCisgICBUaGlzIG9wdGlvbiBpcyByZXJlYWRlZCBvbiBlYWNoIG5ldyBj
b25uZWN0ZWQgSU1BUCBjbGllbnQuICovCisKK3sgImNvbnZlcnR1c2VyaWRfYWxsb3dfbm9uY29u
dmVydGVkIiwgMCwgU1dJVENIIH0KKy8qIEFsbG93IHRvIHVzZSBvcmlnaW5hbCB1c2VyaWRzIGlm
IHRoZXJlIGFyZSBubyBpbmZvcm1hdGlvbiBvbgorICAgdGhlbSBpbiBMREFQLiBUaGlzIG9wdGlv
biBpcyByZXJlYWRlZCBvbiBlYWNoIG5ldyBjb25uZWN0ZWQgSU1BUAorICAgY2xpZW50LiAqLwor
Cit7ICJjb252ZXJ0dXNlcmlkX2RvbnRpZ25vcmVfZXJyb3JzIiwgMCwgU1dJVENIIH0KKy8qIElm
IGVuYWJsZWQgYW5kIHRoZXJlIGlzIGFuIGVycm9yIHdoaWxlIGZldGNoaW5nIHVzZXJpZCwgb3Jp
Z2luYWwKKyAgIHVzZXJpZHMgd29uJ3QgYmVlbiByZXR1cm5lZCBldmVuIGlmICdjb252ZXJ0dXNl
cmlkX2FsbG93X25vbmNvbnZlcnRlZCcKKyAgIG9wdGlvbiBpcyBlbmFibGVkLiBUaGlzIG9wdGlv
biBpcyByZXJlYWRlZCBvbiBlYWNoIG5ldyBjb25uZWN0ZWQgSU1BUAorICAgY2xpZW50LiAqLwor
Cit7ICJjb252ZXJ0dXNlcmlkX2NhY2hlX2RiIiwgTlVMTCwgU1RSSU5HIH0KKy8qIExvY2FsIGNh
Y2hlIGJhY2tlbmQgZm9yIHN0b3JpbmcgY29udmVydGVkIGlkZW50aWZpZXJzLiBJZiB0aGlzIG9w
dGlvbgorICAgaXMgbm90IHNldCB0aGVuIGNhY2hlIHdpbGwgbm90IGJlIHVzZWQuICovCisKK3sg
ImNvbnZlcnR1c2VyaWRfYWN0dWFsX3RpbWVvdXQiLCA2MCwgSU5UIH0KKy8qIEEgbnVtYmVyIG9m
IHNlY29uZHMgbG9jYWwgY2FjaGUncyByZWNvcmRzIGFyZSBpbiB0aGUgJ2FjdHVhbCcgc3RhdGUK
KyAgIGJlZm9yZSB0aW1pbmcgb3V0LiBJZiBhIHJlY29yZCBpcyBpbiAnYWN0dWFsJyBzdGF0ZSB0
aGVuIHF1ZXJpZXMKKyAgIHRvIExEQVAgZm9yIHRoaXMgcmVjb3JkIGlzIG5vdCBwZXJmb3JtZWQu
IFRoaXMgb3B0aW9uIGlzIHJlcmVhZGVkIG9uCisgICBlYWNoIG5ldyBjb25uZWN0ZWQgSU1BUCBj
bGllbnQuKi8KKworeyAiY29udmVydHVzZXJpZF9sb2NhbGhvc3QiLCAiMTI3LjAuMC4xIiwgU1RS
SU5HIH0KKy8qIElQLWFkZHJlc3Mgd2hpY2ggbGRhcGQgcHJvY2Vzc2VzIGFyZSBiaW5kaW5nIHRv
LiBZb3Ugd2lsbCBuZXZlcgorICAgbmVlZCB0byBjaGFuZ2UgdGhlIGRlZmF1bHQgdmFsdWUuICov
CisKK3sgImNvbnZlcnR1c2VyaWRfdWRwcG9ydCIsIDEwMDAxLCBJTlQgfQorLyogVURQIHBvcnQg
bnVtYmVyIHdoZXJlIGxkYXBkIHByb2Nlc3NlcyBhcmUgbGlzdGVuaW5nIG9uLiBsZGFwZCBpcyBh
CisgICBwcm9jZXNzIHdoaWNoIHBlcmZvbXMgcXVlcmllcyB0byBMREFQLiAqLworCit7ICJjb252
ZXJ0dXNlcmlkX2xkYXBfaG9zdCIsIE5VTEwsIFNUUklORyB9CisvKiBMREFQIHNlcnZlciBob3N0
IHVzZWQgYnkgbGRhcGQuICovCisKK3sgImNvbnZlcnR1c2VyaWRfbGRhcF9wb3J0IiwgMzg5LCBJ
TlQgfQorLyogTERBUCBzZXJ2ZXIgcG9ydCB1c2VkIGJ5IGxkYXBkLiAqLworCit7ICJjb252ZXJ0
dXNlcmlkX2xkYXBfdXNlciIsIE5VTEwsIFNUUklORyB9CisvKiBMREFQIHVzZXIgdXNlZCBieSBs
ZGFwZC4gKi8KKworeyAiY29udmVydHVzZXJpZF9sZGFwX3Bhc3N3b3JkIiwgTlVMTCwgU1RSSU5H
IH0KKy8qIExEQVAgdXNlcidzIHBhc3N3b3JkIHVzZWQgYnkgbGRhcGQuICovCisKK3sgImNvbnZl
cnR1c2VyaWRfbGRhcF9iYXNlIiwgTlVMTCwgU1RSSU5HIH0KKy8qIExEQVAgYmFzZSB1c2VkIGJ5
IGxkYXBkLiAqLworCit7ICJjb252ZXJ0dXNlcmlkX2xkYXBfYXR0cl9pbnQiLCAidWlkIiwgU1RS
SU5HIH0KKy8qIE5hbWUgb2YgTERBUCBhdHRyaWJ1dGUgc3RvcmluZyBpbnRlcm5hbCBuYW1lcyBv
ZiB1c2Vycy4gKi8KKworeyAiY29udmVydHVzZXJpZF9sZGFwX2F0dHJfZXh0IiwgImNuIiwgU1RS
SU5HIH0KKy8qIE5hbWUgb2YgTERBUCBhdHRyaWJ1dGUgc3RvcmluZyBleHRlcm5hbCBuYW1lcyBv
ZiB1c2Vycy4gKi8KKworeyAiY29udmVydHVzZXJpZF9sZGFwX2F0dHJfZG9tYWluIiwgIm1haWxk
b21haW4iLCBTVFJJTkcgfQorLyogTmFtZSBvZiBMREFQIGF0dHJpYnV0ZSBzdG9yaW5nIGRvbWFp
biBuYW1lcyBvZiBJTUFQIHVzZXJzLiAqLworCit7ICJjb252ZXJ0dXNlcmlkX2xkYXBfcXVlcnlf
ZG9tYWlucyIsIDAsIFNXSVRDSCB9CisvKiBRdWVyeSBvciBub3QgZG9tYWluIG5hbWVzIHZpYSBM
REFQLiBOb3RlOiBpZiB2aXJ0ZG9tYWlucyBvcHRpb24gaXMKKyAgIGVuYWJsZWQgdGhlbiB0aGlz
IG9wdGlvbiBkb2Vzbid0IHBsYXkgYW55IHJvbGUgKGl0IGlzIGVuYWJsZWQgdG9vKS4gKi8KKwog
LyoKIC5TSCBTRUUgQUxTTwogLlBQCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL2xp
Yi9saWJjb25maWcuYyBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2xpYmNvbmZpZy5jCi0tLSBjeXJ1
cy1pbWFwZC0yLjIuMTIub2xkL2xpYi9saWJjb25maWcuYwkyMDA0LTA1LTIyIDA3OjQ1OjU0ICsw
NDAwCisrKyBjeXJ1cy1pbWFwZC0yLjIuMTIvbGliL2xpYmNvbmZpZy5jCTIwMDUtMTItMzAgMTU6
MTM6NTkgKzAzMDAKQEAgLTE2MSw3ICsxNjEsMTAgQEAKICAgICBpZihhbHRfY29uZmlnKSBjb25m
aWdfZmlsZW5hbWUgPSB4c3RyZHVwKGFsdF9jb25maWcpOwogICAgIGVsc2UgY29uZmlnX2ZpbGVu
YW1lID0geHN0cmR1cChDT05GSUdfRklMRU5BTUUpOwogCi0gICAgaWYoIWNvbnN0cnVjdF9oYXNo
X3RhYmxlKCZjb25maWdoYXNoLCBDT05GSUdIQVNIU0laRSwgMSkpIHsKKyAgICAvKiB3ZSBkb24n
dCB1c2UgbWVtb3J5IHBvb2wgZm9yIHRoaXMgaGFzaCBiZWNhdXNlIHdlIG1heSBkZWxldGUKKyAg
ICAgICBrZXlzIGZyb20gaXQgbWFueSB0aW1lcyAoZGVsZXRpb25zIGZyb20gcG9vbGVkIGhhc2gg
bGVhayB0aGUKKyAgICAgICBtZW1vcnkpICovCisgICAgaWYoIWNvbnN0cnVjdF9oYXNoX3RhYmxl
KCZjb25maWdoYXNoLCBDT05GSUdIQVNIU0laRSwgMCkpIHsKIAlmYXRhbCgiY291bGQgbm90IGNv
bnN0cnVjdCBjb25maWd1cmF0aW9uIGhhc2ggdGFibGUiLCBFQ19DT05GSUcpOwogICAgIH0KIApA
QCAtNTA4LDMgKzUxMSw0MDkgQEAKICAgICB9CiAgICAgZmNsb3NlKGluZmlsZSk7CiB9CisKK2lu
dCBjb25maWdfdGVtcGxhdGVfY29tcGFyZShjb25zdCBjaGFyICpvcHRuYW1lLCBpbnQgb3B0aWQs
IHRlbXBsYXRlX29wdGlvbiAqb3B0cywgaW50IG9wdHNfbGVuKQoreworICAgIGludCBpOworCisg
ICAgZm9yKGk9MDsgaTxvcHRzX2xlbjsgaSsrKSB7CisJc3dpdGNoKG9wdHNbaV0udHlwZSkgewor
CWNhc2UgVEVNUExBVEVPUFRfVFlQRV9LTk9XTk9QVDoKKwkgICAgaWYob3B0aWQ9PShpbnQpb3B0
c1tpXS52YWwpCisJCXJldHVybiAwOworCSAgICBicmVhazsKKwljYXNlIFRFTVBMQVRFT1BUX1RZ
UEVfRVhBQ1RNQVRDSDoKKwkgICAgaWYoIXN0cmNtcCgoY2hhciAqKW9wdHNbaV0udmFsLCBvcHRu
YW1lKSkKKwkJcmV0dXJuIDA7CisJICAgIGJyZWFrOworCWNhc2UgVEVNUExBVEVPUFRfVFlQRV9Q
UkVGSVg6CisJICAgIGlmKCFzdHJuY21wKChjaGFyICopb3B0c1tpXS52YWwsIG9wdG5hbWUsIHN0
cmxlbigoY2hhciAqKW9wdHNbaV0udmFsKSkpCisJCXJldHVybiAwOworCSAgICBicmVhazsKKwl9
CisgICAgfQorICAgIHJldHVybiAxOworfQorCitzdGF0aWMgaW50IGNvbmZpZ19yZXJlYWRfZmls
ZShjb25zdCBjaGFyICpmaWxlbmFtZSwgdGVtcGxhdGVfb3B0aW9uICpvcHRzLCBpbnQgb3B0c19s
ZW4pCit7CisgICAgZW51bSBvcHR0eXBlIG9wdCA9IElNQVBPUFRfWkVSTzsKKyAgICBpbnQgbGlu
ZW5vID0gMDsKKyAgICBjaGFyIGJ1Zls0MDk2XSwgZXJyYnVmWzEwMjRdOworICAgIGNoYXIgKnAs
ICpxLCAqa2V5LCAqZnVsbGtleSwgKnNydmtleSwgKnZhbCwgKm5ld3ZhbDsKKyAgICBpbnQgc2Vy
dmljZV9zcGVjaWZpYzsKKyAgICBpbnQgaWRsZW4gPSAoY29uZmlnX2lkZW50ID8gc3RybGVuKGNv
bmZpZ19pZGVudCkgOiAwKTsKKyAgICBGSUxFICppbmZpbGU7CisKKyAgICBpZighb3B0c19sZW4p
CisJcmV0dXJuIDA7CisKKyAgICAvKiByZWFkIGluIGNvbmZpZyBmaWxlICovCisgICAgaW5maWxl
ID0gZm9wZW4oZmlsZW5hbWUsICJyIik7CisgICAgaWYgKCFpbmZpbGUpIHsKKwlzdHJsY3B5KGJ1
ZiwgQ1lSVVNfUEFUSCwgc2l6ZW9mKGJ1ZikpOworCXN0cmxjYXQoYnVmLCBmaWxlbmFtZSwgc2l6
ZW9mKGJ1ZikpOworCWluZmlsZSA9IGZvcGVuKGJ1ZiwgInIiKTsKKyAgICB9CisgICAgaWYgKCFp
bmZpbGUpIHsKKwlzeXNsb2coTE9HX0VSUiwgImNhbid0IG9wZW4gY29uZmlndXJhdGlvbiBmaWxl
ICVzOiAlcyIsZmlsZW5hbWUsIGVycm9yX21lc3NhZ2UoZXJybm8pKTsKKwlyZXR1cm4gLTE7Cisg
ICAgfQorCisgICAgLyogY2hlY2sgdG8gc2VlIGlmIHdlJ3ZlIGFscmVhZHkgcmVhZCB0aGlzIGZp
bGUgKi8KKyAgICBpZiAoaGFzaF9sb29rdXAoZmlsZW5hbWUsICZpbmNsdWRlaGFzaCkpIHsKKwlz
eXNsb2coTE9HX0VSUiwgImNvbmZpZ3VyYXRpb24gZmlsZSAlcyBpbmNsdWRlZCB0d2ljZSIsIGZp
bGVuYW1lKTsKKwlmY2xvc2UoaW5maWxlKTsKKwlyZXR1cm4gLTE7CisgICAgfQorICAgIGVsc2Ug
eworCWhhc2hfaW5zZXJ0KGZpbGVuYW1lLCAodm9pZCopIDB4REVBREJFRUYsICZpbmNsdWRlaGFz
aCk7CisgICAgfQorICAgIAorICAgIHdoaWxlIChmZ2V0cyhidWYsIHNpemVvZihidWYpLCBpbmZp
bGUpKSB7CisJbGluZW5vKys7CisKKwlzZXJ2aWNlX3NwZWNpZmljID0gMDsKKwkKKwlpZiAoYnVm
WzBdICYmIGJ1ZltzdHJsZW4oYnVmKS0xXSA9PSAnXG4nKSBidWZbc3RybGVuKGJ1ZiktMV0gPSAn
XDAnOworCWZvciAocCA9IGJ1ZjsgKnAgJiYgaXNzcGFjZSgoaW50KSAqcCk7IHArKyk7CisJaWYg
KCEqcCB8fCAqcCA9PSAnIycpIGNvbnRpbnVlOworCisJZnVsbGtleSA9IGtleSA9IHA7CisJaWYg
KCpwID09ICdAJykgcCsrOyAgLyogYWxsb3cgQCBhcyB0aGUgZmlyc3QgY2hhciAoZm9yIGRpcmVj
dGl2ZXMpICovCisJd2hpbGUgKCpwICYmIChpc2FsbnVtKChpbnQpICpwKSB8fCAqcCA9PSAnLScg
fHwgKnAgPT0gJ18nKSkgeworCSAgICBpZiAoaXN1cHBlcigodW5zaWduZWQgY2hhcikgKnApKSAq
cCA9IHRvbG93ZXIoKHVuc2lnbmVkIGNoYXIpICpwKTsKKwkgICAgcCsrOworCX0KKwlpZiAoKnAg
IT0gJzonKSB7CisJICAgIHN5c2xvZyhMT0dfRVJSLAorCQkgICAiaW52YWxpZCBvcHRpb24gbmFt
ZSBvbiBsaW5lICVkIG9mIGNvbmZpZ3VyYXRpb24gZmlsZSAlcyIsCisJCSAgICBsaW5lbm8sIGZp
bGVuYW1lKTsKKwkgICAgZmNsb3NlKGluZmlsZSk7CisJICAgIHJldHVybiAtMTsKKwl9CisJKnAr
KyA9ICdcMCc7CisJCisJd2hpbGUgKCpwICYmIGlzc3BhY2UoKGludCkgKnApKSBwKys7CisJCisJ
LyogcmVtb3ZlIHRyYWlsaW5nIHdoaXRlc3BhY2UgKi8KKwlmb3IgKHEgPSBwICsgc3RybGVuKHAp
IC0gMTsgcSA+IHAgJiYgaXNzcGFjZSgoaW50KSAqcSk7IHEtLSkgeworCSAgICAqcSA9ICdcMCc7
CisJfQorCQorCWlmICghKnApIHsKKwkgICAgc3lzbG9nKExPR19FUlIsCisJCSAgICJlbXB0eSBv
cHRpb24gdmFsdWUgb24gbGluZSAlZCBvZiBjb25maWd1cmF0aW9uIGZpbGUiLAorCQkgICBsaW5l
bm8pOworCSAgICBmY2xvc2UoaW5maWxlKTsKKwkgICAgcmV0dXJuIC0xOworCX0KKwkKKwlzcnZr
ZXkgPSBOVUxMOworCisJLyogTG9vayBmb3IgZGlyZWN0aXZlcyAqLworCWlmIChrZXlbMF0gPT0g
J0AnKSB7CisJICAgIGlmICghc3RyY2FzZWNtcChrZXksICJAaW5jbHVkZSIpKSB7CisJCWlmKGNv
bmZpZ19yZXJlYWRfZmlsZShwLG9wdHMsb3B0c19sZW4pKSB7CisJCSAgICBmY2xvc2UoaW5maWxl
KTsKKwkJICAgIHJldHVybiAtMTsKKwkJfQorCQljb250aW51ZTsKKwkgICAgfQorCSAgICBlbHNl
IHsKKwkJc3lzbG9nKExPR19FUlIsCisJCSAgICAgICAiaW52YWxpZCBkaXJlY3RpdmUgb24gbGlu
ZSAlZCBvZiBjb25maWd1cmF0aW9uIGZpbGUgJXMiLAorCQkgICAgICAgbGluZW5vLCBmaWxlbmFt
ZSk7CisJCWZjbG9zZShpbmZpbGUpOworCQlyZXR1cm4gLTE7CisJICAgIH0KKwl9CisKKwkvKiBG
aW5kIGlmIHRoZXJlIGlzIGEgPHNlcnZpY2U+XyBwcmVmaXggKi8KKwlpZihjb25maWdfaWRlbnQg
JiYgIXN0cm5jYXNlY21wKGtleSwgY29uZmlnX2lkZW50LCBpZGxlbikgCisJICAgJiYga2V5W2lk
bGVuXSA9PSAnXycpIHsKKwkgICAgLyogc2tpcCBzZXJ2aWNlXyBwcmVmaXggKi8KKwkgICAgc3J2
a2V5ID0ga2V5ICsgaWRsZW4gKyAxOworCX0KKwkKKwkvKiBsb29rIGZvciBhIHNlcnZpY2VfIHBy
ZWZpeCBtYXRjaCBpbiBpbWFwb3B0cyAqLworCWlmKHNydmtleSkgeworCSAgICBmb3IgKG9wdCA9
IElNQVBPUFRfWkVSTzsgb3B0IDwgSU1BUE9QVF9MQVNUOyBvcHQrKykgeworCQlpZiAoIXN0cmNh
c2VjbXAoaW1hcG9wdHNbb3B0XS5vcHRuYW1lLCBzcnZrZXkpKSB7CisJCSAgICBrZXkgPSBzcnZr
ZXk7CisJCSAgICBzZXJ2aWNlX3NwZWNpZmljID0gMTsKKwkJICAgIGJyZWFrOworCQl9CisJICAg
IH0KKwl9CisJCisJLyogRGlkIG5vdCBmaW5kIGEgc2VydmljZV8gc3BlY2lmaWMgbWF0Y2gsIHRy
eSBsb29raW5nIGZvciBhbgorCSAqIGV4YWN0IG1hdGNoICovCisJaWYoIXNlcnZpY2Vfc3BlY2lm
aWMpIHsKKwkgICAgZm9yIChvcHQgPSBJTUFQT1BUX1pFUk87IG9wdCA8IElNQVBPUFRfTEFTVDsg
b3B0KyspIHsKKwkJaWYgKCFzdHJjYXNlY21wKGltYXBvcHRzW29wdF0ub3B0bmFtZSwga2V5KSkg
eworCQkgICAgYnJlYWs7CisJCX0KKwkgICAgfQorCX0KKworCS8qIElmIGJvdGggb2YgdGhvc2Ug
bG9vcHMgZmFpbGVkLCBpdCBnb2VzIHZlcmJhdGltIGludG8gdGhlCisJICogb3ZlcmZsb3cgaGFz
aCB0YWJsZS4gKi8KKwkKKwlpZiAob3B0IDwgSU1BUE9QVF9MQVNUKSB7CisJICAgIC8qIHNraXAg
YWxsIG9wdGlvbnMgZXhjZXB0IHRob3NlIG1hY2hlZCB0ZW1wbGF0ZSAqLworCSAgICBpZihjb25m
aWdfdGVtcGxhdGVfY29tcGFyZShpbWFwb3B0c1tvcHRdLm9wdG5hbWUsb3B0LG9wdHMsb3B0c19s
ZW4pKQorCQljb250aW51ZTsKKworCSAgICAvKiBPa2F5LCB3ZSBrbm93IGFib3V0IHRoaXMgY29u
ZmlndXJlIG9wdGlvbi4KKwkgICAgICogU28gZmlyc3QgY2hlY2sgdGhhdCB3ZSBoYXZlIGVpdGhl
cgorCSAgICAgKiAgMS4gbm90IHNlZW4gaXQKKwkgICAgICogIDIuIHNlZW4gaXRzIGdlbmVyaWMg
Zm9ybSwgYnV0IHRoaXMgaXMgYSBzZXJ2aWNlIHNwZWNpZmljIGZvcm0KKwkgICAgICoKKwkgICAg
ICogIElmIHdlIGhhdmUgYWxyZWFkeSBzZWVuIGEgc2VydmljZS1zcGVjaWZpYyBmb3JtLCBhbmQg
dGhpcyBpcworCSAgICAgKiAgYSBnZW5lcmljIGZvcm0sIGp1c3Qgc2tpcCBpdCBhbmQgZG9uJ3Qg
bW9hbi4KKwkgICAgICovCisJICAgIGlmKChpbWFwb3B0c1tvcHRdLnNlZW4gPT0gMSAmJiAhc2Vy
dmljZV9zcGVjaWZpYykgCisJICAgICB8fChpbWFwb3B0c1tvcHRdLnNlZW4gPT0gMiAmJiBzZXJ2
aWNlX3NwZWNpZmljKSkgeworCQlzeXNsb2coTE9HX0VSUiwKKwkJICAgICAgICJvcHRpb24gJyVz
JyB3YXMgc3BlY2lmaWVkIHR3aWNlIGluIGNvbmZpZyBmaWxlIChzZWNvbmQgb2NjdXJhbmNlIG9u
IGxpbmUgJWQpIiwKKwkJICAgICAgIGZ1bGxrZXksIGxpbmVubyk7CisJCWZjbG9zZShpbmZpbGUp
OworCQlyZXR1cm4gLTE7CisJICAgIH0gZWxzZSBpZihpbWFwb3B0c1tvcHRdLnNlZW4gPT0gMiAm
JiAhc2VydmljZV9zcGVjaWZpYykgeworCQljb250aW51ZTsKKwkgICAgfQorCisJICAgIC8qIElm
IHdlJ3ZlIHNlZW4gaXQgYWxyZWFkeSwgd2UncmUgcmVwbGFjaW5nIGl0LCBzbyB3ZSBuZWVkCisJ
ICAgICAqIHRvIGZyZWUgdGhlIGN1cnJlbnQgc3RyaW5nIGlmIHRoZXJlIGlzIG9uZSAqLworCSAg
ICBpZihpbWFwb3B0c1tvcHRdLnNlZW4gJiYgaW1hcG9wdHNbb3B0XS50ID09IE9QVF9TVFJJTkcp
CisJCWZyZWUoKGNoYXIgKilpbWFwb3B0c1tvcHRdLnZhbC5zKTsKKworICAgICAgICAgICAgaWYo
c2VydmljZV9zcGVjaWZpYykKKwkJaW1hcG9wdHNbb3B0XS5zZWVuID0gMjsKKwkgICAgZWxzZQor
CQlpbWFwb3B0c1tvcHRdLnNlZW4gPSAxOworCSAgICAKKwkgICAgLyogdGhpcyBpcyBhIGtub3du
IG9wdGlvbiAqLworCSAgICBzd2l0Y2ggKGltYXBvcHRzW29wdF0udCkgeworCSAgICBjYXNlIE9Q
VF9TVFJJTkc6IAorCSAgICB7CQkgICAgCisJCWltYXBvcHRzW29wdF0udmFsLnMgPSB4c3RyZHVw
KHApOworCisJCWlmKG9wdCA9PSBJTUFQT1BUX0NPTkZJR0RJUkVDVE9SWSkKKwkJICAgIGNvbmZp
Z19kaXIgPSBpbWFwb3B0c1tvcHRdLnZhbC5zOworCisJCWJyZWFrOworCSAgICB9CisJICAgIGNh
c2UgT1BUX0lOVDoKKwkgICAgeworCQlsb25nIHZhbDsKKwkJY2hhciAqcHRyOworCQkKKwkJdmFs
ID0gc3RydG9sKHAsICZwdHIsIDApOworCQlpZiAoIXB0ciB8fCAqcHRyICE9ICdcMCcpIHsKKwkJ
ICAgIC8qIGVycm9yIGR1cmluZyBjb252ZXJzaW9uICovCisJCSAgICBzeXNsb2coTE9HX0VSUiwK
KwkJCSAgICJub24taW50ZWdlciB2YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIsCisJCQkgICBpbWFw
b3B0c1tvcHRdLm9wdG5hbWUsIGxpbmVubyk7CisJCSAgICBmY2xvc2UoaW5maWxlKTsKKwkJICAg
IHJldHVybiAtMTsKKwkJfQorCisJCWltYXBvcHRzW29wdF0udmFsLmkgPSB2YWw7CisJCWJyZWFr
OworCSAgICB9CisJICAgIGNhc2UgT1BUX1NXSVRDSDoKKwkgICAgeworCQlpZiAoKnAgPT0gJzAn
IHx8ICpwID09ICduJyB8fAorCQkgICAgKCpwID09ICdvJyAmJiBwWzFdID09ICdmJykgfHwgKnAg
PT0gJ2YnKSB7CisJCSAgICBpbWFwb3B0c1tvcHRdLnZhbC5iID0gMDsKKwkJfQorCQllbHNlIGlm
ICgqcCA9PSAnMScgfHwgKnAgPT0gJ3knIHx8CisJCQkgKCpwID09ICdvJyAmJiBwWzFdID09ICdu
JykgfHwgKnAgPT0gJ3QnKSB7CisJCSAgICBpbWFwb3B0c1tvcHRdLnZhbC5iID0gMTsKKwkJfQor
CQllbHNlIHsKKwkJICAgIC8qIGVycm9yIGR1cmluZyBjb252ZXJzaW9uICovCisJCSAgICBzeXNs
b2coTE9HX0VSUiwKKwkJCSAgICJub24tc3dpdGNoIHZhbHVlIGZvciAlcyBpbiBsaW5lICVkIiwK
KwkJCSAgIGltYXBvcHRzW29wdF0ub3B0bmFtZSwgbGluZW5vKTsKKwkJICAgIGZjbG9zZShpbmZp
bGUpOworCQkgICAgcmV0dXJuIC0xOworCQl9CisJCWJyZWFrOworCSAgICB9CisJICAgIGNhc2Ug
T1BUX0VOVU06CisJICAgIGNhc2UgT1BUX1NUUklOR0xJU1Q6CisJICAgIHsKKwkJY29uc3Qgc3Ry
dWN0IGVudW1fb3B0aW9uX3MgKmUgPSBpbWFwb3B0c1tvcHRdLmVudW1fb3B0aW9uczsKKworCQlp
ZiAoaW1hcG9wdHNbb3B0XS50ID09IE9QVF9FTlVNKSB7CisJCSAgICAvKiBub3JtYWxpemUgb24v
b2ZmIHZhbHVlcyAqLworCQkgICAgaWYgKCFzdHJjbXAocCwgIjEiKSB8fCAhc3RyY21wKHAsICJ5
ZXMiKSB8fAorCQkJIXN0cmNtcChwLCAidCIpIHx8ICFzdHJjbXAocCwgInRydWUiKSkgeworCQkJ
cCA9ICJvbiI7CisJCSAgICB9IGVsc2UgaWYgKCFzdHJjbXAocCwgIjAiKSB8fCAhc3RyY21wKHAs
ICJubyIpIHx8CisJCQkgICAgICAgIXN0cmNtcChwLCAiZiIpIHx8ICFzdHJjbXAocCwgImZhbHNl
IikpIHsKKwkJCXAgPSAib2ZmIjsKKwkJICAgIH0KKwkJfQorCisJCXdoaWxlIChlLT5uYW1lKSB7
CisJCSAgICBpZiAoIXN0cmNtcChlLT5uYW1lLCBwKSkgYnJlYWs7CisJCSAgICBlKys7CisJCX0K
KwkJaWYgKGUtPm5hbWUpIHsKKwkJICAgIGlmIChpbWFwb3B0c1tvcHRdLnQgPT0gT1BUX0VOVU0p
CisJCQlpbWFwb3B0c1tvcHRdLnZhbC5lID0gZS0+dmFsOworCQkgICAgZWxzZQorCQkJaW1hcG9w
dHNbb3B0XS52YWwucyA9IGUtPm5hbWU7CisJCX0gZWxzZSB7CisJCSAgICAvKiBlcnJvciBkdXJp
bmcgY29udmVyc2lvbiAqLworCQkgICAgc3lzbG9nKExPR19FUlIsCisJCQkgICAiaW52YWxpZCB2
YWx1ZSBmb3IgJXMgaW4gbGluZSAlZCIsCisJCQkgICBpbWFwb3B0c1tvcHRdLm9wdG5hbWUsIGxp
bmVubyk7CisJCSAgICBmY2xvc2UoaW5maWxlKTsKKwkJICAgIHJldHVybiAtMTsKKwkJfQorCQli
cmVhazsKKwkgICAgfQorCSAgICBjYXNlIE9QVF9OT1RPUFQ6CisJICAgIGRlZmF1bHQ6CisJCWFi
b3J0KCk7CisJICAgIH0KKwl9IGVsc2UgeworCSAgICAvKiBjaGVjayB0byBtYWtlIHN1cmUgaXQn
cyB2YWxpZCBmb3Igb3ZlcmZsb3cgKi8KKwkgICAgLyogdGhhdCBpcywgcGFydGl0aW9uIG5hbWVz
IGFuZCBhbnl0aGluZyB0aGF0IG1pZ2h0IGJlCisJICAgICAqIHVzZWQgYnkgU0FTTCAqLworLyoK
KyAgeHh4IHRoaXMgd291bGQgYmUgbmljZSBpZiBpdCB3YXNuJ3QgZm9yIG90aGVyIHNlcnZpY2Vz
IHdobyBtaWdodCBiZQorICAgICAgc2hhcmluZyB0aGlzIGNvbmZpZyBmaWxlIGFuZCB3aG9zZSBu
YW1lcyB3ZSBjYW5ub3QgcHJlZGljdAorCisJICAgIGlmKHN0cm5jYXNlY21wKGtleSwic2FzbF8i
LDUpCisJICAgICYmIHN0cm5jYXNlY21wKGtleSwicGFydGl0aW9uLSIsMTApKSB7CisJCXNwcmlu
dGYoZXJyYnVmLAorCQkJIm9wdGlvbiAnJXMnIGlzIHVua25vd24gb24gbGluZSAlZCBvZiBjb25m
aWcgZmlsZSIsCisJCQlmdWxsa2V5LCBsaW5lbm8pOworCQlmYXRhbChlcnJidWYsIEVDX0NPTkZJ
Ryk7CisJICAgIH0KKyovCisKKwkgICAgLyogc2tpcCBhbGwgb3B0aW9ucyBleGNlcHQgdGhvc2Ug
bWFjaGVkIHRlbXBsYXRlICovCisJICAgIGlmKGNvbmZpZ190ZW1wbGF0ZV9jb21wYXJlKGtleSww
LG9wdHMsb3B0c19sZW4pKQorCQljb250aW51ZTsKKworCSAgICAvKiBQdXQgaXQgaW4gdGhlIG92
ZXJmbG93IGhhc2ggdGFibGUgKi8KKwkgICAgbmV3dmFsID0geHN0cmR1cChwKTsKKwkgICAgdmFs
ID0gaGFzaF9pbnNlcnQoa2V5LCBuZXd2YWwsICZjb25maWdoYXNoKTsKKwkgICAgaWYodmFsICE9
IG5ld3ZhbCkgeworCQlzeXNsb2coTE9HX0VSUiwKKwkJICAgICAgICJvcHRpb24gJyVzJyB3YXMg
c3BlY2lmaWVkIHR3aWNlIGluIGNvbmZpZyBmaWxlIChzZWNvbmQgb2NjdXJhbmNlIG9uIGxpbmUg
JWQpIiwKKwkJICAgICAgIGZ1bGxrZXksIGxpbmVubyk7CisJCWZjbG9zZShpbmZpbGUpOworCQly
ZXR1cm4gLTE7CisJICAgIH0KKwl9CisgICAgfQorICAgIGZjbG9zZShpbmZpbGUpOworICAgIHJl
dHVybiAwOworfQorCit0eXBlZGVmIHN0cnVjdCBfY29uZmlnX2RlbGV0ZV9jYl9wYXJhbSB7Cisg
ICAgdGVtcGxhdGVfb3B0aW9uICpvcHRzOworICAgIGludCBvcHRzX2xlbjsKK30gY29uZmlnX2Rl
bGV0ZV9jYl9wYXJhbTsKKworaW50IGNvbmZpZ19kZWxldGVfY2IoY2hhciAqa2V5LCB2b2lkICpk
YXRhLCB2b2lkICpwYXJhbSkKK3sKKyAgICBpZighY29uZmlnX3RlbXBsYXRlX2NvbXBhcmUoCisJ
ICAgKGNoYXIgKilrZXksIDAsCisJICAgKChjb25maWdfZGVsZXRlX2NiX3BhcmFtICopcGFyYW0p
LT5vcHRzLAorCSAgICgoY29uZmlnX2RlbGV0ZV9jYl9wYXJhbSAqKXBhcmFtKS0+b3B0c19sZW4p
KSB7CisJZnJlZShkYXRhKTsKKwlyZXR1cm4gLTE7CisgICAgfQorICAgIHJldHVybiAwOworfQor
CitleHRlcm4gaW50IGNvbmZpZ19yZXJlYWQodGVtcGxhdGVfb3B0aW9uICpvcHRzLCBpbnQgb3B0
c19sZW4pCit7CisgICAgZW51bSBvcHR0eXBlIG9wdCA9IElNQVBPUFRfWkVSTzsKKyAgICBjb25m
aWdfZGVsZXRlX2NiX3BhcmFtIHBhcmFtOworICAgIGludCBjdXJfdGVtcGw7CisgICAgaW50IHJl
czsKKworICAgIGlmKCFvcHRzX2xlbikKKwlyZXR1cm4gMDsKKworICAgIC8qIHJlbW92ZSBvcHRp
b25zIHRoYXQgbWFjaGVkIHRlbXBsYXRlICovCisgICAgZm9yIChvcHQgPSBJTUFQT1BUX1pFUk87
IG9wdCA8IElNQVBPUFRfTEFTVDsgb3B0KyspIHsKKwlpZihpbWFwb3B0c1tvcHRdLnNlZW4pIHsK
KwkgICAgLyoganVzdCBzZXQgZGVmYXVsdCB2YWx1ZXMgZm9yIGtub3duIG9wdGlvbnMgKi8KKwkg
ICAgaWYoIWNvbmZpZ190ZW1wbGF0ZV9jb21wYXJlKGltYXBvcHRzW29wdF0ub3B0bmFtZSxvcHQs
b3B0cyxvcHRzX2xlbikpIHsKKwkJaWYoaW1hcG9wdHNbb3B0XS50ID09IE9QVF9TVFJJTkcpCisJ
CSAgICBmcmVlKChjaGFyICopaW1hcG9wdHNbb3B0XS52YWwucyk7CisJCWltYXBvcHRzW29wdF0u
dmFsID0gaW1hcG9wdHNbb3B0XS5kZWY7CisJCWltYXBvcHRzW29wdF0uc2VlbiA9IDA7CisJICAg
IH0KKwl9CisgICAgfQorCisgICAgLyogY2hlY2sgaWYgd2UgbmVlZCB0byB3YWxrIHRocm91Z2gg
YWxsIGhhc2hlZCBvcHRpb25zIG9yIHdlIGp1c3QKKyAgICAgICBuZWVkIHRvIGRlbGV0ZSBOIGhh
c2hlZCBvcHRpb25zICovCisgICAgZm9yKGN1cl90ZW1wbD0wOyBjdXJfdGVtcGw8b3B0c19sZW47
IGN1cl90ZW1wbCsrKSB7CisJaWYob3B0c1tjdXJfdGVtcGxdLnR5cGU9PVRFTVBMQVRFT1BUX1RZ
UEVfUFJFRklYKQorCSAgICBicmVhazsKKwllbHNlIGlmKG9wdHNbY3VyX3RlbXBsXS50eXBlPT1U
RU1QTEFURU9QVF9UWVBFX0VYQUNUTUFUQ0gpIHsKKwkgICAgdm9pZCAqZGF0YTsKKwkgICAgCisJ
ICAgIC8qIHRyeSB0byBkZWxldGUgZXhhY3QgbWF0Y2ggb3B0aW9uIChpZiBpdCBleGlzdHMsIGl0
IHdpbGwKKwkgICAgICAgYmUgZGVsZXRlZCkgKi8KKwkgICAgaWYoKGRhdGE9aGFzaF9kZWwoKGNo
YXIgKilvcHRzW2N1cl90ZW1wbF0udmFsLCAmY29uZmlnaGFzaCkpKQorCQlmcmVlKGRhdGEpOwor
CX0KKyAgICB9CisKKyAgICAvKiBpZiB3ZSd2ZSBmb3VuZCBhIHByZWZpeCAobm9uLWV4YWN0KSB0
ZW1wbGF0ZSB0aGFuIHdhbGsgdGhyb3VnaAorICAgICAgIGFsbCBoYXNoZWQgb3B0aW9ucyAqLwor
ICAgIGlmKGN1cl90ZW1wbDxvcHRzX2xlbikgeworCXBhcmFtLm9wdHM9b3B0czsKKwlwYXJhbS5v
cHRzX2xlbj1vcHRzX2xlbjsKKworCWhhc2hfd2FsaygmY29uZmlnaGFzaCwgY29uZmlnX2RlbGV0
ZV9jYiwgJnBhcmFtKTsKKyAgICB9CisKKyAgICAvKiBub3cgY2FsbCBjb25maWdfcmVyZWFkX2Zp
bGUoKSBhcyBpbiBjb25maWdfcmVhZCgpICovCisgICAgaWYoIWNvbnN0cnVjdF9oYXNoX3RhYmxl
KCZpbmNsdWRlaGFzaCwgSU5DTFVERUhBU0hTSVpFLCAxKSkgeworCWZhdGFsKCJjb3VsZCBub3Qg
Y29uc3RydWN0IGluY2x1ZGUgZmlsZSAgaGFzaCB0YWJsZSIsIEVDX0NPTkZJRyk7CisgICAgfQor
CisgICAgcmVzPWNvbmZpZ19yZXJlYWRfZmlsZShjb25maWdfZmlsZW5hbWUsIG9wdHMsIG9wdHNf
bGVuKTsKKworICAgIGZyZWVfaGFzaF90YWJsZSgmaW5jbHVkZWhhc2gsIE5VTEwpOworCisgICAg
aWYocmVzKQorCXJldHVybiByZXM7CisKKyAgICAvKiBOb3RlIGlmIHdlIGRvbid0IGNoYW5nZSB2
YXJpYWJsZXMgYmVsb3cgdGhlbiB0aGF5IGNhbiBwb2ludCB0bworICAgICAgIGZyZWVkIG1lbW9y
eS4gVE9ETzogcmlnaHQgd29yayB3aXRoIElNQVBPUFRfREVGQVVMVFBBUlRJVElPTgorICAgICAg
IG9wdGlvbiBhbmQgd2l0aCBvdGhlciBwYXJ0aXRpb25zIHBhdGhlcyBpcyBuZWVkZWQuICovCisK
KyAgICAvKiBsb29rIHVwIG1haWxib3ggaGFzaGluZyAqLworICAgIGNvbmZpZ19oYXNoaW1hcHNw
b29sID0gY29uZmlnX2dldHN3aXRjaChJTUFQT1BUX0hBU0hJTUFQU1BPT0wpOworCisgICAgLyog
YXJlIHdlIHN1cHBvcnRpbmcgdmlydHVhbCBkb21haW5zPyAgKi8KKyAgICBjb25maWdfdmlydGRv
bWFpbnMgPSBjb25maWdfZ2V0ZW51bShJTUFQT1BUX1ZJUlRET01BSU5TKTsKKyAgICBjb25maWdf
ZGVmZG9tYWluID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0RFRkFVTFRET01BSU4pOworCisg
ICAgLyogbG9vayB1cCB0aGUgaG9zdG5hbWUgd2Ugc2hvdWxkIHByZXNlbnQgdG8gdGhlIHVzZXIg
Ki8KKyAgICBjb25maWdfc2VydmVybmFtZSA9IGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9TRVJW
RVJOQU1FKTsKKyAgICBpZiAoIWNvbmZpZ19zZXJ2ZXJuYW1lKSB7CisJY29uZmlnX3NlcnZlcm5h
bWUgPSB4bWFsbG9jKHNpemVvZihjaGFyKSAqIDI1Nik7CisJZ2V0aG9zdG5hbWUoKGNoYXIgKikg
Y29uZmlnX3NlcnZlcm5hbWUsIDI1Nik7CisgICAgfQorCisgICAgY29uZmlnX211cGRhdGVfc2Vy
dmVyID0gY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX01VUERBVEVfU0VSVkVSKTsKKworICAgIHJl
dHVybiAwOworfQpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9saWIvbGliY29uZmln
LmggY3lydXMtaW1hcGQtMi4yLjEyL2xpYi9saWJjb25maWcuaAotLS0gY3lydXMtaW1hcGQtMi4y
LjEyLm9sZC9saWIvbGliY29uZmlnLmgJMjAwMy0xMi0yOSAyMzoyMjo1NSArMDMwMAorKysgY3ly
dXMtaW1hcGQtMi4yLjEyL2xpYi9saWJjb25maWcuaAkyMDA1LTEyLTMwIDE1OjEzOjU5ICswMzAw
CkBAIC00Niw5ICs0NiwyMCBAQAogI2luY2x1ZGUgImV4aXRjb2Rlcy5oIgogI2luY2x1ZGUgImlt
YXBvcHRzLmgiCiAKKy8qIHR5cGVzIGZvciBzdHJ1Y3R1cmUgdGVtcGxhdGVfb3B0aW9uICovCisj
ZGVmaW5lIFRFTVBMQVRFT1BUX1RZUEVfS05PV05PUFQgICAwCisjZGVmaW5lIFRFTVBMQVRFT1BU
X1RZUEVfRVhBQ1RNQVRDSCAxCisjZGVmaW5lIFRFTVBMQVRFT1BUX1RZUEVfUFJFRklYICAgICAy
CisKK3R5cGVkZWYgc3RydWN0IF90ZW1wbGF0ZV9vcHRpb24geworICAgIHZvaWQgKnZhbDsKKyAg
ICBpbnQgdHlwZTsKK30gdGVtcGxhdGVfb3B0aW9uOworCiAvKiB0aGVzZSB3aWxsIGFzc2VydCgp
IGlmIHRoZXkncmUgY2FsbGVkIG9uIHRoZSB3cm9uZyB0eXBlIG9mCiAgICBvcHRpb24gKGltYXBv
cHRzLmMpICovCiBleHRlcm4gdm9pZCBjb25maWdfcmVhZChjb25zdCBjaGFyICphbHRfY29uZmln
KTsKK2V4dGVybiBpbnQgY29uZmlnX3JlcmVhZCh0ZW1wbGF0ZV9vcHRpb24gKm9wdHMsIGludCBv
cHRzX2xlbik7CiBleHRlcm4gY29uc3QgY2hhciAqY29uZmlnX2dldHN0cmluZyhlbnVtIGltYXBv
cHQgb3B0KTsKIGV4dGVybiBpbnQgY29uZmlnX2dldGludChlbnVtIGltYXBvcHQgb3B0KTsKIGV4
dGVybiBpbnQgY29uZmlnX2dldHN3aXRjaChlbnVtIGltYXBvcHQgb3B0KTsKZGlmZiAtdXJOIGN5
cnVzLWltYXBkLTIuMi4xMi5vbGQvbWFuL2xkYXBkLjggY3lydXMtaW1hcGQtMi4yLjEyL21hbi9s
ZGFwZC44Ci0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL21hbi9sZGFwZC44CTE5NzAtMDEtMDEg
MDM6MDA6MDAgKzAzMDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9tYW4vbGRhcGQuOAkyMDA1LTEy
LTMwIDE1OjE0OjQxICswMzAwCkBAIC0wLDAgKzEsNDYgQEAKKy5cIiAtKi0gbnJvZmYgLSotCisu
VEggTERBUEQgOCAiUHJvamVjdCBDeXJ1cyIgQ01VCisuU0ggTkFNRQorbGRhcGQgXC0gY29ubmVj
dG9yIGZyb20gSU1BUCBzZXJ2ZXIgdG8gTERBUAorLlNIIFNZTk9QU0lTCisuQiBsZGFwZAorWwor
LkIgXC1DCisuSSBjb25maWctZmlsZQorXQorWworLkIgXC1uCisuSSBucHJvYworfAorLkIgXC1c
LXByZWZvcmsKKy5JIG5wcm9jCitdCisuYnIKKy5TSCBERVNDUklQVElPTgorLkkgTGRhcGQKK2lz
IGEgcHJvY2VzcyB0aGF0IHBlcmZvcm1zIHF1ZXJpZXMgZnJvbSBJTUFQIHNlcnZlciB0byBMREFQ
IHNlcnZlci4KK0l0IGFjY2VwdHMgcXVlcmllcyB2aWEgVURQIHByb3RvY29sIGFuZCBzZW5kcyBh
bnN3ZXJzIHRvIGNhbGxlcnMuCitJdCBjYW4gYmUgaW52b2tlZCBieQorLklSIG1hc3RlciAoOCkK
K2J1dCBpdCBpcyBwb3NzaWJsZSB0byBzdGFydCBcZklsZGFwZFxmUiBpbmRlcGVuZGVudGx5Lgor
SWYgeW91IHdhbnQgdG8gc3RhcnQgXGZJbGRhcGRcZlIgdmlhIFxmQm1hc3Rlcig4KVxmUiwgeW91
IGhhdmUgdG8KK2FkZCBsYXVuY2ggcnVsZSB0byBTVEFSVCBzZWN0aW9uIG9mCisuSVIgY3lydXMu
Y29uZiAoNSkKKy5QUAorLkkgTGRhcGQKK3JlYWRzIGl0cyBjb25maWd1cmF0aW9uIG9wdGlvbnMg
b3V0IG9mIHRoZQorLklSIGltYXBkLmNvbmYgKDUpCitmaWxlIHVubGVzcyBzcGVjaWZpZWQgb3Ro
ZXJ3aXNlIGJ5IFxmQi1DXGZSLgorLlNIIE9QVElPTlMKKy5UUAorLkJJIFwtQyAiIGNvbmZpZy1m
aWxlIgorUmVhZCBjb25maWd1cmF0aW9uIG9wdGlvbnMgZnJvbSBcZkljb25maWctZmlsZVxmUi4K
Ky5UUAorLkJJIFwtbiAiIG5wcm9jIixcIFwtXC1wcmVmb3JrICIgbnByb2MiCitUaGUgbnVtYmVy
IG9mIFxmSWxkYXBkXGZSIHByb2Nlc3NlcyB0byB3b3JrIHNpbXVsdGFuZW91c2x5LiBUaGUgZGVm
YXVsdCBpcyAxLgorLlNIIEZJTEVTCisuVFAKKy5CIC9ldGMvaW1hcGQuY29uZgorLlNIIFNFRSBB
TFNPCisuUFAKK1xmQmltYXBkLmNvbmYoNSlcZlIsIFxmQm1hc3Rlcig4KVxmUgpkaWZmIC11ck4g
Y3lydXMtaW1hcGQtMi4yLjEyLm9sZC9tYW4vTWFrZWZpbGUuaW4gY3lydXMtaW1hcGQtMi4yLjEy
L21hbi9NYWtlZmlsZS5pbgotLS0gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9tYW4vTWFrZWZpbGUu
aW4JMjAwNC0wMy0zMCAxOToxODo0MSArMDQwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL21hbi9N
YWtlZmlsZS5pbgkyMDA1LTEyLTMwIDE1OjE0OjAwICswMzAwCkBAIC02MiwxMSArNjIsMTIgQEAK
IAkkKHNyY2RpcikvZnVkLjggJChzcmNkaXIpL2ltYXBkLjggJChzcmNkaXIpL3BvcDNkLjggJChz
cmNkaXIpL3F1b3RhLjggXAogCSQoc3JjZGlyKS9yZWNvbnN0cnVjdC44ICQoc3JjZGlyKS9ybW5l
d3MuOCAkKHNyY2Rpcikvc3luY25ld3MuOCBcCiAJJChzcmNkaXIpL21icGF0aC44ICQoc3JjZGly
KS90aW1zaWV2ZWQuOCAkKHNyY2RpcikvbWFzdGVyLjggXAotCSQoc3JjZGlyKS9sbXRwZC44ICQo
c3JjZGlyKS9pZGxlZC44ICQoc3JjZGlyKS9jdGxfbWJveGxpc3QuOCBcCi0JJChzcmNkaXIpL2N0
bF9kZWxpdmVyLjggJChzcmNkaXIpL2N0bF9jeXJ1c2RiLjggJChzcmNkaXIpL2lwdXJnZS44IFwK
LQkkKHNyY2RpcikvdGxzX3BydW5lLjggJChzcmNkaXIpL3NxdWF0dGVyLjggJChzcmNkaXIpL2N2
dF9jeXJ1c2RiLjggXAotCSQoc3JjZGlyKS9ub3RpZnlkLjggJChzcmNkaXIpL2Noa19jeXJ1cy44
ICQoc3JjZGlyKS9tYmV4YW1pbmUuOCBcCi0JJChzcmNkaXIpL25udHBkLjggJChzcmNkaXIpL2Zl
dGNobmV3cy44ICQoc3JjZGlyKS9zbW1hcGQuOAorCSQoc3JjZGlyKS9sZGFwZC44ICQoc3JjZGly
KS9sbXRwZC44ICQoc3JjZGlyKS9pZGxlZC44IFwKKwkkKHNyY2RpcikvY3RsX21ib3hsaXN0Ljgg
JChzcmNkaXIpL2N0bF9kZWxpdmVyLjggXAorCSQoc3JjZGlyKS9jdGxfY3lydXNkYi44ICQoc3Jj
ZGlyKS9pcHVyZ2UuOCAkKHNyY2RpcikvdGxzX3BydW5lLjggXAorCSQoc3JjZGlyKS9zcXVhdHRl
ci44ICQoc3JjZGlyKS9jdnRfY3lydXNkYi44ICQoc3JjZGlyKS9ub3RpZnlkLjggXAorCSQoc3Jj
ZGlyKS9jaGtfY3lydXMuOCAkKHNyY2RpcikvbWJleGFtaW5lLjggJChzcmNkaXIpL25udHBkLjgg
XAorCSQoc3JjZGlyKS9mZXRjaG5ld3MuOCAkKHNyY2Rpcikvc21tYXBkLjgKIAogYWxsOiAkKE1B
TjEpICQoTUFOMykgJChNQU41KSAkKE1BTjgpCiAKZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4x
Mi5vbGQvbWFuL21hc3Rlci44IGN5cnVzLWltYXBkLTIuMi4xMi9tYW4vbWFzdGVyLjgKLS0tIGN5
cnVzLWltYXBkLTIuMi4xMi5vbGQvbWFuL21hc3Rlci44CTIwMDQtMTItMTcgMTk6MzI6MjMgKzAz
MDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9tYW4vbWFzdGVyLjgJMjAwNS0xMi0zMCAxNToxNDow
MCArMDMwMApAQCAtMTUyLDQgKzE1Miw1IEBACiAuU0ggU0VFIEFMU08KIC5QUAogXGZCY3lydXMu
Y29uZig1KVxmUiwgXGZCaW1hcGQuY29uZig1KVxmUiwgXGZCaW1hcGQoOClcZlIsCi1cZkJwb3Az
ZCg4KVxmUiwgXGZCbG10cGQoOClcZlIsIFxmQnRpbXNpZXZlZCg4KVxmUiwgXGZCaWRsZWQoOClc
ZlIKK1xmQnBvcDNkKDgpXGZSLCBcZkJsZGFwZCg4KVxmUiwgXGZCbG10cGQoOClcZlIsCitcZkJ0
aW1zaWV2ZWQoOClcZlIsIFxmQmlkbGVkKDgpXGZSCmRpZmYgLXVyTiBjeXJ1cy1pbWFwZC0yLjIu
MTIub2xkL21hc3Rlci9jb25mL2NtdS1iYWNrZW5kLmNvbmYgY3lydXMtaW1hcGQtMi4yLjEyL21h
c3Rlci9jb25mL2NtdS1iYWNrZW5kLmNvbmYKLS0tIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbWFz
dGVyL2NvbmYvY211LWJhY2tlbmQuY29uZgkyMDAzLTEwLTIyIDIyOjAzOjEwICswNDAwCisrKyBj
eXJ1cy1pbWFwZC0yLjIuMTIvbWFzdGVyL2NvbmYvY211LWJhY2tlbmQuY29uZgkyMDA1LTEyLTMw
IDE1OjE0OjAwICswMzAwCkBAIC02LDYgKzYsOCBAQAogCiAgIHJlY292ZXIJY21kPSJjdGxfY3ly
dXNkYiAtciIKICAgbXVwZGF0ZXB1c2ggICBjbWQ9ImN0bF9tYm94bGlzdCAtbSIKKyAgIyB0aGlz
IGlzIG9ubHkgbmVjZXNzYXJ5IGlmIHVzaW5nIGNvbnZlcnR1c2VyaWQgZXh0ZW5zaW9uCisjICBs
ZGFwZAkJY21kPSJsZGFwZCAtbiA1IgogfQogCiAjIFVOSVggc29ja2V0cyBzdGFydCB3aXRoIGEg
c2xhc2ggYW5kIGFyZSBwdXQgaW50byAvdmFyL2ltYXAvc29ja2V0cwpkaWZmIC11ck4gY3lydXMt
aW1hcGQtMi4yLjEyLm9sZC9tYXN0ZXIvY29uZi9jbXUtZnJvbnRlbmQuY29uZiBjeXJ1cy1pbWFw
ZC0yLjIuMTIvbWFzdGVyL2NvbmYvY211LWZyb250ZW5kLmNvbmYKLS0tIGN5cnVzLWltYXBkLTIu
Mi4xMi5vbGQvbWFzdGVyL2NvbmYvY211LWZyb250ZW5kLmNvbmYJMjAwMy0xMC0yMiAyMjowMzox
MCArMDQwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL21hc3Rlci9jb25mL2NtdS1mcm9udGVuZC5j
b25mCTIwMDUtMTItMzAgMTU6MTQ6MDAgKzAzMDAKQEAgLTIsNiArMiw4IEBACiAgIGF1dGgJCWNt
ZD0iL3Vzci9sb2NhbC9iaW4va3NydnRndCAtbCAzNjAwIGltYXAgQFNIT1JUSE9TVEAgQU5EUkVX
LkNNVS5FRFUgL2ltYXAvY29uZi9zcnZ0YWIiCiAKICAgbWJveGxpc3QJY21kPSJjdGxfY3lydXNk
YiAtciIKKyAgIyB0aGlzIGlzIG9ubHkgbmVjZXNzYXJ5IGlmIHVzaW5nIGNvbnZlcnR1c2VyaWQg
ZXh0ZW5zaW9uCisjICBsZGFwZAkJY21kPSJsZGFwZCAtbiA1IgogfQogCiAjIFVOSVggc29ja2V0
cyBzdGFydCB3aXRoIGEgc2xhc2ggYW5kIGFyZSBwdXQgaW50byAvdmFyL2ltYXAvc29ja2V0cwpk
aWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC9tYXN0ZXIvY29uZi9ub3JtYWwuY29uZiBj
eXJ1cy1pbWFwZC0yLjIuMTIvbWFzdGVyL2NvbmYvbm9ybWFsLmNvbmYKLS0tIGN5cnVzLWltYXBk
LTIuMi4xMi5vbGQvbWFzdGVyL2NvbmYvbm9ybWFsLmNvbmYJMjAwMy0xMC0yMiAyMjowMzoxMCAr
MDQwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL21hc3Rlci9jb25mL25vcm1hbC5jb25mCTIwMDUt
MTItMzAgMTU6MTQ6MDAgKzAzMDAKQEAgLTYsNiArNiw4IEBACiAKICAgIyB0aGlzIGlzIG9ubHkg
bmVjZXNzYXJ5IGlmIHVzaW5nIGlkbGVkIGZvciBJTUFQIElETEUKICMgIGlkbGVkCQljbWQ9Imlk
bGVkIgorICAjIHRoaXMgaXMgb25seSBuZWNlc3NhcnkgaWYgdXNpbmcgY29udmVydHVzZXJpZCBl
eHRlbnNpb24KKyMgIGxkYXBkCQljbWQ9ImxkYXBkIC1uIDUiCiB9CiAKICMgVU5JWCBzb2NrZXRz
IHN0YXJ0IHdpdGggYSBzbGFzaCBhbmQgYXJlIHB1dCBpbnRvIC92YXIvaW1hcC9zb2NrZXQKZGlm
ZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbWFzdGVyL2NvbmYvcHJlZm9yay5jb25mIGN5
cnVzLWltYXBkLTIuMi4xMi9tYXN0ZXIvY29uZi9wcmVmb3JrLmNvbmYKLS0tIGN5cnVzLWltYXBk
LTIuMi4xMi5vbGQvbWFzdGVyL2NvbmYvcHJlZm9yay5jb25mCTIwMDMtMTAtMjIgMjI6MDM6MTAg
KzA0MDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9tYXN0ZXIvY29uZi9wcmVmb3JrLmNvbmYJMjAw
NS0xMi0zMCAxNToxNDowMCArMDMwMApAQCAtNiw2ICs2LDggQEAKIAogICAjIHRoaXMgaXMgb25s
eSBuZWNlc3NhcnkgaWYgdXNpbmcgaWRsZWQgZm9yIElNQVAgSURMRQogIyAgaWRsZWQJCWNtZD0i
aWRsZWQiCisgICMgdGhpcyBpcyBvbmx5IG5lY2Vzc2FyeSBpZiB1c2luZyBjb252ZXJ0dXNlcmlk
IGV4dGVuc2lvbgorIyAgbGRhcGQJCWNtZD0ibGRhcGQgLW4gNSIKIH0KIAogIyBVTklYIHNvY2tl
dHMgc3RhcnQgd2l0aCBhIHNsYXNoIGFuZCBhcmUgcHV0IGludG8gL3Zhci9pbWFwL3NvY2tldHMK
ZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvbWFzdGVyL2NvbmYvc21hbGwuY29uZiBj
eXJ1cy1pbWFwZC0yLjIuMTIvbWFzdGVyL2NvbmYvc21hbGwuY29uZgotLS0gY3lydXMtaW1hcGQt
Mi4yLjEyLm9sZC9tYXN0ZXIvY29uZi9zbWFsbC5jb25mCTIwMDItMTAtMDIgMDA6NDY6MDEgKzA0
MDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9tYXN0ZXIvY29uZi9zbWFsbC5jb25mCTIwMDUtMTIt
MzAgMTU6MTQ6MDAgKzAzMDAKQEAgLTYsNiArNiw4IEBACiAKICAgIyB0aGlzIGlzIG9ubHkgbmVj
ZXNzYXJ5IGlmIHVzaW5nIGlkbGVkIGZvciBJTUFQIElETEUKICMgIGlkbGVkCQljbWQ9ImlkbGVk
IgorICAjIHRoaXMgaXMgb25seSBuZWNlc3NhcnkgaWYgdXNpbmcgY29udmVydHVzZXJpZCBleHRl
bnNpb24KKyMgIGxkYXBkCQljbWQ9ImxkYXBkIC1uIDUiCiB9CiAKICMgVU5JWCBzb2NrZXRzIHN0
YXJ0IHdpdGggYSBzbGFzaCBhbmQgYXJlIHB1dCBpbnRvIC92YXIvaW1hcC9zb2NrZXRzCmRpZmYg
LXVyTiBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL25vdGlmeWQvTWFrZWZpbGUuaW4gY3lydXMtaW1h
cGQtMi4yLjEyL25vdGlmeWQvTWFrZWZpbGUuaW4KLS0tIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQv
bm90aWZ5ZC9NYWtlZmlsZS5pbgkyMDA1LTEyLTMwIDEyOjU1OjU5ICswMzAwCisrKyBjeXJ1cy1p
bWFwZC0yLjIuMTIvbm90aWZ5ZC9NYWtlZmlsZS5pbgkyMDA1LTEyLTMwIDE1OjE0OjAwICswMzAw
CkBAIC03Miw3ICs3Miw3IEBACiBTSUVWRV9MSUJTID0gQFNJRVZFX0xJQlNACiBJTUFQX0NPTV9F
UlJfTElCUyA9IEBJTUFQX0NPTV9FUlJfTElCU0AKIExJQl9XUkFQID0gQExJQl9XUkFQQAotTElC
UyA9IEBaRVBIWVJfTElCU0AgQExJQlNAICQoSU1BUF9DT01fRVJSX0xJQlMpCitMSUJTID0gQFpF
UEhZUl9MSUJTQCBATElCU0AgJChJTUFQX0NPTV9FUlJfTElCUykgLWxyZWRibGFjayAtbGxkYXAK
IERFUExJQlM9Li4vaW1hcC9tdXRleF9mYWtlLm8gLi4vaW1hcC9saWJpbWFwLmEgJChTSUVWRV9M
SUJTKSAuLi9saWIvbGliY3lydXMuYSAuLi9saWIvbGliY3lydXNfbWluLmEgQERFUExJQlNACiAK
IFBVUklGWT0vdXNyL2xvY2FsL2Jpbi9wdXJpZnkKZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4x
Mi5vbGQvcHRjbGllbnQvTWFrZWZpbGUuaW4gY3lydXMtaW1hcGQtMi4yLjEyL3B0Y2xpZW50L01h
a2VmaWxlLmluCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL3B0Y2xpZW50L01ha2VmaWxlLmlu
CTIwMDUtMTItMzAgMTI6NTU6NTYgKzAzMDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9wdGNsaWVu
dC9NYWtlZmlsZS5pbgkyMDA1LTEyLTMwIDE1OjE0OjAwICswMzAwCkBAIC01OCw3ICs1OCw3IEBA
CiBBRlNfTElCUyA9IEBBRlNfTElCU0AKIElNQVBfTElCUyA9IEBJTUFQX0xJQlNAIEBMSUJfUlRA
CiBTSUVWRV9MSUJTID0gQFNJRVZFX0xJQlNACi1MSUJTID0gJChJTUFQX0xJQlMpIEBDT01fRVJS
X0xJQlNACitMSUJTID0gJChJTUFQX0xJQlMpIEBDT01fRVJSX0xJQlNAIC1scmVkYmxhY2sgLWxs
ZGFwCiBMSUJfU0FTTCA9IEBMSUJfU0FTTEAKIExJQl9XUkFQID0gQExJQl9XUkFQQAogREVQTElC
UyA9IC4uL2ltYXAvbGliaW1hcC5hICQoU0lFVkVfTElCUykgLi4vbGliL2xpYmN5cnVzLmEgLi4v
bGliL2xpYmN5cnVzX21pbi5hIEBERVBMSUJTQCAKZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4x
Mi5vbGQvUkVBRE1FLmNvbnZlcnR1c2VyaWQgY3lydXMtaW1hcGQtMi4yLjEyL1JFQURNRS5jb252
ZXJ0dXNlcmlkCi0tLSBjeXJ1cy1pbWFwZC0yLjIuMTIub2xkL1JFQURNRS5jb252ZXJ0dXNlcmlk
CTE5NzAtMDEtMDEgMDM6MDA6MDAgKzAzMDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi9SRUFETUUu
Y29udmVydHVzZXJpZAkyMDA1LTEyLTMwIDE1OjE0OjUxICswMzAwCkBAIC0wLDAgKzEsMTQgQEAK
K0N5cnVzIElNQVAgY29udmVydHVzZXJpZCBwYXRjaAorLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQorCitUaGlzIHBhdGNoIGlzIG5lZWRlZCB0byBhZGQgYWJpbGl0eSB0byB0aGUgc2Vy
dmVyIHRvIGhpZGUKK3JlYWwgdXNlcnMgaW5kZW50aWZpZXJzIGFuZCB0byByZXBsYWNlIHRoZW0g
dG8gb3RoZXIgb25lcword2hpY2ggYXJlIGdvdCBmcm9tIExEQVAuCisKK1N0ZXBzIHlvdSBuZWVk
IHRvIGRvIHRvIGdldCBjb252ZXJ0dXNlcmlkIHdvcmtlZDoKKzEuIEJ1aWxkIHRoZSBzZXJ2ZXIg
d2l0aCAtLWVuYWJsZS1jb252ZXJ0dXNlcmlkICdjb25maWd1cmUnIG9wdGlvbjsKKzIuIFNldCBj
b252ZXJ1c2VyaWQqIG9wdGlvbnMgaW4gaW1hcGQuY29uZi4gU2VlIGltYXBkLmNvbmYoNSkKKyAg
IGZvciBkZXRhaWxzLiBUaGUgZGVmYXVsdCBhY3Rpb24gKHdpdGhvdXQgYW55IGNvbnZlcnVzZXJp
ZCoKKyAgIG9wdGlvbiBzZXQpIGlzICJkb24ndCBjb252ZXJ0IjsKKzMuIEFkZCAibGRhcGQiIGlu
IFNUQVJUIHNlY3Rpb24gb2YgY3lydXMuY29uZi4gU2VlIGxkYXBkKDgpIGZvcgorICAgZGV0YWls
cy4KZGlmZiAtdXJOIGN5cnVzLWltYXBkLTIuMi4xMi5vbGQvdGltc2lldmVkL01ha2VmaWxlLmlu
IGN5cnVzLWltYXBkLTIuMi4xMi90aW1zaWV2ZWQvTWFrZWZpbGUuaW4KLS0tIGN5cnVzLWltYXBk
LTIuMi4xMi5vbGQvdGltc2lldmVkL01ha2VmaWxlLmluCTIwMDQtMDUtMjggMjI6MDM6MTAgKzA0
MDAKKysrIGN5cnVzLWltYXBkLTIuMi4xMi90aW1zaWV2ZWQvTWFrZWZpbGUuaW4JMjAwNS0xMi0z
MCAxNToxNDowMSArMDMwMApAQCAtNzEsNyArNzEsNyBAQAogSU1BUF9MSUJTID0gQElNQVBfTElC
U0AgQExJQl9SVEAKIElNQVBfQ09NX0VSUl9MSUJTID0gQElNQVBfQ09NX0VSUl9MSUJTQAogTElC
X1dSQVAgPSBATElCX1dSQVBACi1MSUJTID0gJChJTUFQX0NPTV9FUlJfTElCUykKK0xJQlMgPSAk
KElNQVBfQ09NX0VSUl9MSUJTKSAtbHJlZGJsYWNrIC1sbGRhcAogREVQTElCUz0uLi9zaWV2ZS9s
aWJzaWV2ZS5hIC4uL2ltYXAvbXV0ZXhfZmFrZS5vIC4uL2ltYXAvbGliaW1hcC5hIC4uL2xpYi9s
aWJjeXJ1cy5hIC4uL2xpYi9saWJjeXJ1c19taW4uYSBAREVQTElCU0AKIAogUFVSSUZZPS91c3Iv
bG9jYWwvYmluL3B1cmlmeQpkaWZmIC11ck4gY3lydXMtaW1hcGQtMi4yLjEyLm9sZC90b29scy9j
b25maWcyaGVhZGVyIGN5cnVzLWltYXBkLTIuMi4xMi90b29scy9jb25maWcyaGVhZGVyCi0tLSBj
eXJ1cy1pbWFwZC0yLjIuMTIub2xkL3Rvb2xzL2NvbmZpZzJoZWFkZXIJMjAwNS0xMi0zMCAxMjo1
NjowNSArMDMwMAorKysgY3lydXMtaW1hcGQtMi4yLjEyL3Rvb2xzL2NvbmZpZzJoZWFkZXIJMjAw
NS0xMi0zMCAxNToxNDowMSArMDMwMApAQCAtMTI2LDcgKzEyNiw3IEBACiAKIHN0cnVjdCBpbWFw
b3B0X3MgaW1hcG9wdHNbXSA9CiB7Ci0gIHsgSU1BUE9QVF9aRVJPLCAiIiwgMCwgeyBOVUxMIH0s
IE9QVF9OT1RPUFQsIHsgIHsgTlVMTCwgSU1BUF9FTlVNX1pFUk8gfSB9IH0sCisgIHsgSU1BUE9Q
VF9aRVJPLCAiIiwgMCwgeyBOVUxMIH0sIHsgTlVMTCB9LCBPUFRfTk9UT1BULCB7ICB7IE5VTEws
IElNQVBfRU5VTV9aRVJPIH0gfSB9LAogRU9GCiAgICAgOwogCkBAIC0yMDQsNyArMjA0LDcgQEAK
IAkJCTogInsodm9pZCopJDJ9IjsKIAl9CiAKLQlwcmludCBDRklMRSAiICB7IElNQVBPUFRfIiwg
dWMoJG9wdCksICIsIFwiJDFcIiwgMCwgJGRlZiwgT1BUXyQzLCB7ICRlbnVtcyB7IE5VTEwsIElN
QVBfRU5VTV9aRVJPIH0gfSB9LFxuIjsKKwlwcmludCBDRklMRSAiICB7IElNQVBPUFRfIiwgdWMo
JG9wdCksICIsIFwiJDFcIiwgMCwgJGRlZiwgJGRlZiwgT1BUXyQzLCB7ICRlbnVtcyB7IE5VTEws
IElNQVBfRU5VTV9aRVJPIH0gfSB9LFxuIjsKICAgICB9IGVsc2UgewogCSNjaG9tcDsKIAkjcHJp
bnQgInJlamVjdGVkICckXydcbiI7CkBAIC0yNTEsNiArMjUxLDcgQEAKICAgICBjb25zdCBjaGFy
ICpvcHRuYW1lOwogICAgIGludCBzZWVuOwogICAgIHVuaW9uIGNvbmZpZ192YWx1ZSB2YWw7Cisg
ICAgdW5pb24gY29uZmlnX3ZhbHVlIGRlZjsKICAgICBjb25zdCBlbnVtIG9wdHR5cGUgdDsKIEVP
RgogOwpAQCAtMjY1LDcgKzI2Niw3IEBACiAgICAgOwogCiBwcmludCBDRklMRSA8PEVPRgotICB7
IElNQVBPUFRfTEFTVCwgTlVMTCwgMCwgeyBOVUxMIH0sIE9QVF9OT1RPUFQsIHsgIHsgTlVMTCwg
SU1BUF9FTlVNX1pFUk8gfSB9IH0KKyAgeyBJTUFQT1BUX0xBU1QsIE5VTEwsIDAsIHsgTlVMTCB9
LCB7IE5VTEwgfSwgT1BUX05PVE9QVCwgeyAgeyBOVUxMLCBJTUFQX0VOVU1fWkVSTyB9IH0gfQog
fTsKIAogLyogYyBjb2RlIGdvZXMgaGVyZSAqLwo=
</data>        

          </attachment>
      

    </bug>

</bugzilla>