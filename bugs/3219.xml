<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>3219</bug_id>
          
          <creation_ts>2010-05-14 10:07 EDT</creation_ts>
          <short_desc>sql canonuser plugin</short_desc>
          <delta_ts>2012-07-16 07:08:53 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus SASL</product>
          <component>plugins</component>
          <version>2.1.x</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>NEW</bug_status>
          
          
          <bug_file_loc>http://article.gmane.org/gmane.comp.security.cyrus.sasl/6868/</bug_file_loc>
          
          
          <priority>P3</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Lars Duesing">lars.duesing@camelotsweb.de</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          <cc>lars.duesing@camelotsweb.de</cc>
          

      

      

      
          <long_desc isprivate="0">
            <who name="Lars Duesing">lars.duesing@camelotsweb.de</who>
            <bug_when>2010-05-14 10:07:34 EDT</bug_when>
            <thetext>Created an attachment (id=1270)
sql-canon-plugin

Attached patch implements a canonuser plugin within the sql plugin.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Lars Duesing">lars.duesing@camelotsweb.de</who>
            <bug_when>2010-05-14 12:29:43 EDT</bug_when>
            <thetext>Created an attachment (id=1271)
sql-canon-plugin

Sorry, had a little problem inside - see http://cyrusimap.web.cmu.edu/archive/message.php?mailbox=archive.cyrus-sasl&amp;msg=9476</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Lars Duesing">lars.duesing@camelotsweb.de</who>
            <bug_when>2011-03-06 04:20:26 EDT</bug_when>
            <thetext>(cyrusimap.org is completely new - so link to old mailinglistarchive is no longer valid...)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Lars Duesing">lars.duesing@camelotsweb.de</who>
            <bug_when>2012-06-20 00:25:47 EDT</bug_when>
            <thetext>Created an attachment (id=1484)
patch against current git</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Lars Duesing">lars.duesing@camelotsweb.de</who>
            <bug_when>2012-07-16 07:08:53 EDT</bug_when>
            <thetext>Created an attachment (id=1497)
Somehow the recursion-check has left...</thetext>
          </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1270</attachid>
            <date>2010-05-14 10:07 EDT</date>
            <desc>sql-canon-plugin</desc>
            <filename>sql_canon.patch</filename>
            <type>text/plain</type>
            <size>16113</size>
            <attacher>lars.duesing@camelotsweb.de</attacher>
            
              <data encoding="base64">ZGlmZiAtcncgY3lydXMtc2FzbC0yLjEuMjQvZG9jL29wdGlvbnMuaHRtbCBjeXJ1cy1zYXNsLTIu
MS4yNC1zcWwvZG9jL29wdGlvbnMuaHRtbAoxNzZhMTc3LDE4Mgo+IDxURD5zcWxfYXV4cHJvcF9z
ZWxlY3Q8L1REPjxURD5TUUwgcGx1Z2luPC9URD4KPiA8VEQ+U0VMRUNUIHN0YXRlbWVudCB0byB1
c2UgZm9yIGZldGNoaW5nIHByb3BlcnRpZXMuICBUaGlzIG9wdGlvbiBpcwo+IDxiPnJlcXVpcmVk
PC9iPiBpbiBvcmRlciB0byB1c2UgdGhlIFNRTCBhdXhwcm9wIHBsdWdpbi48L1REPgo+IDxURD48
aT5ub25lPC9pPjwvVEQ+Cj4gPC9UUj4KPiA8VFI+CjE3N2ExODQsMTk1Cj4gPFREPlNFTEVDVCBz
dGF0ZW1lbnQgdG8gdXNlIGZvciBmZXRjaGluZyBwcm9wZXJ0aWVzLiA8Yj5EZXByZWNhdGVkPC9i
PiBhbGlhcyBmb3Igc3FsX2F1eHByb3Bfc2VsZWN0LiBUaGlzIG9wdGlvbiBpcwo+IDxiPnJlcXVp
cmVkPC9iPiBpbiBvcmRlciB0byB1c2UgdGhlIFNRTCBhdXhwcm9wIHBsdWdpbi48L1REPgo+IDxU
RD48aT5ub25lPC9pPjwvVEQ+Cj4gPC9UUj4KPiA8VFI+Cj4gPFREPnNxbF9zdGF0ZW1lbnQ8L1RE
PjxURD5TUUwgcGx1Z2luPC9URD4KPiA8VEQ+U0VMRUNUIHN0YXRlbWVudCB0byB1c2UgZm9yIGZl
dGNoaW5nIHByb3BlcnRpZXMuIDxiPkRlcHJlY2F0ZWQ8L2I+IGFsaWFzIGZvciBzcWxfYXV4cHJv
cF9zZWxlY3QuIFRoaXMgb3B0aW9uIGlzCj4gPGI+cmVxdWlyZWQ8L2I+IGluIG9yZGVyIHRvIHVz
ZSB0aGUgU1FMIGF1eHByb3AgcGx1Z2luLjwvVEQ+Cj4gPFREPjxpPm5vbmU8L2k+PC9URD4KPiA8
L1RSPgo+IDxUUj4KPiA8VEQ+c3FsX2Nhbm9uX3NlbGVjdDwvVEQ+PFREPlNRTCBwbHVnaW48L1RE
PgoxNzljMTk3CjwgPGI+cmVxdWlyZWQ8L2I+IGluIG9yZGVyIHRvIHVzZSB0aGUgU1FMIHBsdWdp
bi48L1REPgotLS0KPiA8Yj5yZXF1aXJlZDwvYj4gaW4gb3JkZXIgdG8gdXNlIHRoZSBTUUwgY2Fu
b24gcGx1Z2luLjwvVEQ+CjE4M2MyMDEKPCA8VEQ+c3FsX2luc2VydDwvVEQ+PFREPlNRTCBwbHVn
aW48L1REPgotLS0KPiA8VEQ+c3FsX2F1eHByb3BfaW5zZXJ0PC9URD48VEQ+U1FMIHBsdWdpbjwv
VEQ+CjE4OGMyMDYsMjExCjwgPFREPnNxbF91cGRhdGU8L1REPjxURD5TUUwgcGx1Z2luPC9URD4K
LS0tCj4gPFREPnNxbF9pbnNlcnQ8L1REPjxURD5TUUwgcGx1Z2luPC9URD4KPiA8VEQ+SU5TRVJU
IHN0YXRlbWVudCB0byB1c2UgZm9yIGNyZWF0aW5nIHByb3BlcnRpZXMgZm9yIG5ldyB1c2Vycy4g
PGI+RGVwcmVjYXRlZDwvYj4gYWxpYXMgZm9yIHNxbF9hdXhwcm9wX2luc2VydC48L1REPgo+IDxU
RD48aT5ub25lPC9pPjwvVEQ+Cj4gPC9UUj4KPiA8VFI+Cj4gPFREPnNxbF9hdXhwcm9wX3VwZGF0
ZTwvVEQ+PFREPlNRTCBwbHVnaW48L1REPgoxOTJhMjE2LDIyMQo+IDxUUj4KPiA8VEQ+c3FsX3Vw
ZGF0ZTwvVEQ+PFREPlNRTCBwbHVnaW48L1REPgo+IDxURD5VUERBVEUgc3RhdGVtZW50IHRvIHVz
ZSBmb3IgbW9kaWZ5aW5nIHByb3BlcnRpZXMuIDxiPkRlcHJlY2F0ZWQ8L2I+IGFsaWFzIGZvciBz
cWxfYXV4cHJvcF91cGRhdGU8L1REPgo+IDxURD48aT5ub25lPC9pPjwvVEQ+Cj4gPC9UUj4KPiA8
VFI+CjIxMmMyNDEKPCA8cD5UaGUgPHR0PnNxbF9pbnNlcnQ8L3R0PiBhbmQgPHR0PnNxbF91cGRh
dGU8L3R0PiBvcHRpb25zIGFyZQotLS0KPiA8cD5UaGUgPHR0PnNxbF9hdXhwcm9wX2luc2VydDwv
dHQ+IGFuZCA8dHQ+c3FsX2F1eHByb3BfdXBkYXRlPC90dD4gb3B0aW9ucyBhcmUKMjE5LDIyMGMy
NDgsMjQ5CjwgPHA+VGhlIFNRTCBzdGF0ZW1lbnRzIHByb3ZpZGVkIGluIHRoZSA8dHQ+c3FsX3Nl
bGVjdDwvdHQ+LAo8IDx0dD5zcWxfaW5zZXJ0PC90dD4gYW5kIDx0dD5zcWxfdXBkYXRlPC90dD4g
b3B0aW9ucyBjYW4gY29udGFpbgotLS0KPiA8cD5UaGUgU1FMIHN0YXRlbWVudHMgcHJvdmlkZWQg
aW4gdGhlIDx0dD5zcWxfYXV4cHJvcF9zZWxlY3Q8L3R0PiwKPiA8dHQ+c3FsX2F1eHByb3BfaW5z
ZXJ0PC90dD4gYW5kIDx0dD5zcWxfYXV4cHJvcF91cGRhdGU8L3R0PiBvcHRpb25zIGNhbiBjb250
YWluCjI1MGMyNzkKPCAgICAgIDx0dD5zcWxfc2VsZWN0OiBTRUxFQ1QgJXAgRlJPTSB1c2VyX3Rh
YmxlIFdIRVJFIHVzZXJuYW1lID0gJyV1JyBhbmQgcmVhbG0gPSAnJXInPC90dD4KLS0tCj4gICAg
ICA8dHQ+c3FsX2F1eHByb3Bfc2VsZWN0OiBTRUxFQ1QgJXAgRlJPTSB1c2VyX3RhYmxlIFdIRVJF
IHVzZXJuYW1lID0gJyV1JyBhbmQgcmVhbG0gPSAnJXInPC90dD4KMjY0YzI5Mwo8ICAgICAgPHR0
PnNxbF9pbnNlcnQ6IElOU0VSVCBJTlRPIHVzZXJfdGFibGUgKHVzZXJuYW1lLCByZWFsbSwgJXAp
IFZBTFVFUyAoJyV1JywgJyVyJywgJyV2Jyk8L3R0PgotLS0KPiAgICAgIDx0dD5zcWxfYXV4cHJv
cF9pbnNlcnQ6IElOU0VSVCBJTlRPIHVzZXJfdGFibGUgKHVzZXJuYW1lLCByZWFsbSwgJXApIFZB
TFVFUyAoJyV1JywgJyVyJywgJyV2Jyk8L3R0PgoyODNhMzEzLDMyMwo+IDxoMj5Ob3RlcyBvbiBT
UUwgY2Fub24gdXNlciBwbHVnaW4gb3B0aW9uczwvaDI+Cj4gPHA+VGhpcyBwbHVnaW4gc2hhcmVz
IGFsbCBjb25maWd1cmF0aW9uIHdpdGggU1FMIGF1eHByb3AgcGx1Z2luLiBUaGVyZWZvcmUgCj4g
eW91IGhhdmUgdG8gZ2l2ZSBvcHRpb25zIGxpa2Ugc3FsX2hvc3RuYW1lcyBhbmQgc3FsX3VzZXIg
b25seSBvbmNlLgo+IDwvcD4KPiA8cD5BbGwgYWJvdmUgZXhhbXBsZXMgZm9yIHNxbF9hdXhwcm9w
X3NlbGVjdCBhcmUgdmFsaWQgZm9yIHNxbF9jYW5vbl9zZWxlY3QsIHRvby4KPiA8L3A+Cj4gPHA+
Tk9URTogVGhpcyBwbHVnaW4gdGVzdHMgZm9yIHJlY3Vyc2lvbiA1IGl0ZXJhdGlvbnMuIAo+IChl
LmcuIHRlc3RAdGVzdC5sb2NhbC0+am9lQHRlc3QubG9jYWwtPmRvZUB0ZXN0LmxvY2FsLT50ZXN0
QHRlc3QubG9jYWwtPmpvZUB0ZXN0LmxvY2FsKQo+IEFmdGVyIHRoYXQgaXQgc3RvcHMgdGhlIHJl
Y3Vyc2lvbiBhdCB0aGUgY3VycmVudCBlbGVtZW50IGFuZCBpc3N1ZXMgYSB3YXJuaW5nLgo+IDwv
cD4KPiAKZGlmZiAtcncgY3lydXMtc2FzbC0yLjEuMjQvcGx1Z2lucy9tYWtlaW5pdC5zaCBjeXJ1
cy1zYXNsLTIuMS4yNC1zcWwvcGx1Z2lucy9tYWtlaW5pdC5zaAo5MmM5Mgo8ICMgbGRhcGRiIGlz
IGFsc28gYSBjYW5vbl91c2VyIHBsdWdpbgotLS0KPiAjIGxkYXBkYiBhbmQgc3FsIGFyZSBhbHNv
IGNhbm9uX3VzZXIgcGx1Z2lucwo5M2E5NCw5NQo+IGVjaG8gIlNBU0xfQ0FOT05VU0VSX1BMVUdf
SU5JVCggc3FsICkiID4+IHNxbF9pbml0LmMKPiAKZGlmZiAtcncgY3lydXMtc2FzbC0yLjEuMjQv
cGx1Z2lucy9zcWwuYyBjeXJ1cy1zYXNsLTIuMS4yNC1zcWwvcGx1Z2lucy9zcWwuYwozYzMKPCAq
KiBTUUwgQXV4cHJvcCBwbHVnaW4KLS0tCj4gKiogU1FMIEF1eHByb3AgYW5kIENhbm9uIHBsdWdp
bgo1YzUsNgo8ICoqIEtlbiBNdXJjaGlzb24KLS0tCj4gKiogTGFycyBEdWVzaW5nIC0tIGNhbm9u
IHBsdWdpbgo+ICoqIEtlbiBNdXJjaGlzb24gLS0gb3JpZ2luYWwgYXV4cHJvcCBwbHVnaW4KNTMs
NTVjNTQsNTcKPCAgICAgY29uc3QgY2hhciAqc3FsX3NlbGVjdDsKPCAgICAgY29uc3QgY2hhciAq
c3FsX2luc2VydDsKPCAgICAgY29uc3QgY2hhciAqc3FsX3VwZGF0ZTsKLS0tCj4gICAgIGNvbnN0
IGNoYXIgKnNxbF9hdXhwcm9wX3NlbGVjdDsKPiAgICAgY29uc3QgY2hhciAqc3FsX2Nhbm9uX3Nl
bGVjdDsKPiAgICAgY29uc3QgY2hhciAqc3FsX2F1eHByb3BfaW5zZXJ0Owo+ICAgICBjb25zdCBj
aGFyICpzcWxfYXV4cHJvcF91cGRhdGU7CjgwMiw4MDRjODA0LDgwNgo8ICAgICByID0gdXRpbHMt
PmdldG9wdCh1dGlscy0+Z2V0b3B0X2NvbnRleHQsIlNRTCIsICJzcWxfc2VsZWN0IiwKPCAJCSAg
ICAgICZzZXR0aW5ncy0+c3FsX3NlbGVjdCwgTlVMTCk7CjwgICAgIGlmIChyIHx8ICFzZXR0aW5n
cy0+c3FsX3NlbGVjdCApIHsKLS0tCj4gICAgIHIgPSB1dGlscy0+Z2V0b3B0KHV0aWxzLT5nZXRv
cHRfY29udGV4dCwiU1FMIiwgInNxbF9hdXhwcm9wX3NlbGVjdCIsCj4gCQkgICAgICAmc2V0dGlu
Z3MtPnNxbF9hdXhwcm9wX3NlbGVjdCwgTlVMTCk7Cj4gICAgIGlmIChyIHx8ICFzZXR0aW5ncy0+
c3FsX2F1eHByb3Bfc2VsZWN0ICkgewo4MDVhODA4LDgxMAo+IAlyID0gdXRpbHMtPmdldG9wdCh1
dGlscy0+Z2V0b3B0X2NvbnRleHQsIlNRTCIsICJzcWxfc2VsZWN0IiwKPiAJCQkgICZzZXR0aW5n
cy0+c3FsX2F1eHByb3Bfc2VsZWN0LCBOVUxMKTsKPiAJaWYgKHIgfHwgIXNldHRpbmdzLT5zcWxf
YXV4cHJvcF9zZWxlY3QpIHsKODA3LDgwOWM4MTIsODI0CjwgCQkJICAmc2V0dGluZ3MtPnNxbF9z
ZWxlY3QsIE5VTEwpOwo8IAlpZiAociB8fCAhc2V0dGluZ3MtPnNxbF9zZWxlY3QpIHsKPCAJICAg
IHNldHRpbmdzLT5zcWxfc2VsZWN0ID0gU1FMX0JMQU5LX1NUUklORzsKLS0tCj4gCQkJICAmc2V0
dGluZ3MtPnNxbF9hdXhwcm9wX3NlbGVjdCwgTlVMTCk7Cj4gCSAgICBpZiAociB8fCAhc2V0dGlu
Z3MtPnNxbF9hdXhwcm9wX3NlbGVjdCkgewo+IAkgICAgICAgIHNldHRpbmdzLT5zcWxfYXV4cHJv
cF9zZWxlY3QgPSBTUUxfQkxBTktfU1RSSU5HOwo+IAkgICAgfSBlbHNlCj4gICAgICAgICAgICAg
ewo+ICAgICAgICAgICAgICAgICB1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX1dBUk4sCj4gCQkg
ICAic3FsIHBsdWdpbjogT3B0aW9uIHNxbF9zdGF0ZW1lbnQgaXMgZGVwcmVjYXRlZCwgdXNlIHNx
bF9hdXhwcm9wX3NlbGVjdCBpbnN0ZWFkISIpOwo+ICAgICAgICAgICAgIH0KPiAgICAgICAgIH0K
PiAgICAgICAgIGVsc2UKPiAgICAgICAgIHsKPiAgICAgICAgICAgICB1dGlscy0+bG9nKE5VTEws
IFNBU0xfTE9HX1dBUk4sCj4gICAgICAgICAJICAgInNxbCBwbHVnaW46IE9wdGlvbiBzcWxfc2Vs
ZWN0IGlzIGRlcHJlY2F0ZWQsIHVzZSBzcWxfYXV4cHJvcF9zZWxlY3QgaW5zdGVhZCEiKTsKODEw
YTgyNiw4MzIKPiAgICAgICAgICAgICAKPiAgICAgfQo+IAo+ICAgICByID0gdXRpbHMtPmdldG9w
dCh1dGlscy0+Z2V0b3B0X2NvbnRleHQsICJTUUwiLCAic3FsX2Nhbm9uX3NlbGVjdCIsCj4gCQkg
ICAgICAmc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QsIE5VTEwpOwo+ICAgICBpZiAociB8fCAh
c2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QpIHsKPiAJc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxl
Y3QgPSBTUUxfQkxBTktfU1RSSU5HOwo4MTJhODM1LDgzNwo+ICAgICByID0gdXRpbHMtPmdldG9w
dCh1dGlscy0+Z2V0b3B0X2NvbnRleHQsICJTUUwiLCAic3FsX2F1eHByb3BfaW5zZXJ0IiwKPiAJ
CSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0LCBOVUxMKTsKPiAgICAgaWYgKHIg
fHwgIXNldHRpbmdzLT5zcWxfYXV4cHJvcF9pbnNlcnQpIHsKODE0LDgxNmM4MzksODQ3CjwgCQkg
ICAgICAmc2V0dGluZ3MtPnNxbF9pbnNlcnQsIE5VTEwpOwo8ICAgICBpZiAociB8fCAhc2V0dGlu
Z3MtPnNxbF9pbnNlcnQpIHsKPCAJc2V0dGluZ3MtPnNxbF9pbnNlcnQgPSBTUUxfQkxBTktfU1RS
SU5HOwotLS0KPiAJCSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0LCBOVUxMKTsK
PiAgICAgICAgIGlmIChyIHx8ICFzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0KSB7Cj4gCSAg
ICBzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0ID0gU1FMX0JMQU5LX1NUUklORzsKPiAJfSBl
bHNlCj4gICAgICAgICB7Cj4gICAgICAgICAgICAgdXRpbHMtPmxvZyhOVUxMLCBTQVNMX0xPR19X
QVJOLAo+IAkJICAgInNxbCBwbHVnaW46IE9wdGlvbiBzcWxfaW5zZXJ0IGlzIGRlcHJlY2F0ZWQs
IHVzZSBzcWxfYXV4cHJvcF9pbnNlcnQgaW5zdGVhZCEiKTsKPiAgICAgICAgIH0KPiAKODE4YTg1
MCw4NTIKPiAgICAgciA9IHV0aWxzLT5nZXRvcHQodXRpbHMtPmdldG9wdF9jb250ZXh0LCAiU1FM
IiwgInNxbF9hdXhwcm9wX3VwZGF0ZSIsCj4gCQkgICAgICAmc2V0dGluZ3MtPnNxbF9hdXhwcm9w
X3VwZGF0ZSwgTlVMTCk7Cj4gICAgIGlmIChyIHx8ICFzZXR0aW5ncy0+c3FsX2F1eHByb3BfdXBk
YXRlKSB7CjgyMCw4MjJjODU0LDg2MQo8IAkJICAgICAgJnNldHRpbmdzLT5zcWxfdXBkYXRlLCBO
VUxMKTsKPCAgICAgaWYgKHIgfHwgIXNldHRpbmdzLT5zcWxfdXBkYXRlKSB7CjwgCXNldHRpbmdz
LT5zcWxfdXBkYXRlID0gU1FMX0JMQU5LX1NUUklORzsKLS0tCj4gCQkgICAgICAmc2V0dGluZ3Mt
PnNxbF9hdXhwcm9wX3VwZGF0ZSwgTlVMTCk7Cj4gICAgICAgICBpZiAociB8fCAhc2V0dGluZ3Mt
PnNxbF9hdXhwcm9wX3VwZGF0ZSkgewo+IAkgICAgc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3VwZGF0
ZSA9IFNRTF9CTEFOS19TVFJJTkc7Cj4gICAgICAgICB9IGVsc2UKPiAgICAgICAgIHsKPiAgICAg
ICAgICAgICB1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX1dBUk4sCj4gCQkgICAic3FsIHBsdWdp
bjogT3B0aW9uIHNxbF91cGRhdGUgaXMgZGVwcmVjYXRlZCwgdXNlIHNxbF9hdXhwcm9wX3VwZGF0
ZSBpbnN0ZWFkISIpOwo+ICAgICAgICAgfQo5MjFjOTYwCjwgCQkJInNxbCBwbHVnaW4gUGFyc2Ug
dGhlIHVzZXJuYW1lICVzXG4iLCB1c2VyKTsKLS0tCj4gCQkJInNxbF9hdXhwcm9wIHBsdWdpbiBQ
YXJzZSB0aGUgdXNlcm5hbWUgJXNcbiIsIHVzZXIpOwo5NzBjMTAwOQo8IAkJCSAgICAic3FsIHBs
dWdpbiBjb3VsZG4ndCBjb25uZWN0IHRvIGFueSBob3N0XG4iKTsKLS0tCj4gCQkJICAgICJzcWxf
YXV4cHJvcCBwbHVnaW4gY291bGRuJ3QgY29ubmVjdCB0byBhbnkgaG9zdFxuIik7CjEwMjVjMTA2
NAo8IAkJCSAgICAic3FsIHBsdWdpbiBjcmVhdGUgc3RhdGVtZW50IGZyb20gJXMgJXMgJXNcbiIs
Ci0tLQo+IAkJCSAgICAic3FsX2F1eHByb3AgcGx1Z2luIGNyZWF0ZSBzdGF0ZW1lbnQgZnJvbSAl
cyAlcyAlc1xuIiwKMTAyOWMxMDY4CjwgCXF1ZXJ5ID0gc3FsX2NyZWF0ZV9zdGF0ZW1lbnQoc2V0
dGluZ3MtPnNxbF9zZWxlY3QsCi0tLQo+IAlxdWVyeSA9IHNxbF9jcmVhdGVfc3RhdGVtZW50KHNl
dHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxlY3QsCjEwMzljMTA3OAo8IAkJCSAgICAic3FsIHBsdWdp
biBkb2luZyBxdWVyeSAlc1xuIiwgcXVlcnkpOwotLS0KPiAJCQkgICAgInNxbF9hdXhwcm9wIHBs
dWdpbiBkb2luZyBxdWVyeSAlc1xuIiwgcXVlcnkpOwoxMDc2YzExMTUKPCAJCQkJInNxbCBwbHVn
aW4gY3JlYXRlIHN0YXRlbWVudCBmcm9tICVzICVzICVzXG4iLAotLS0KPiAJCQkJInNxbF9hdXhw
cm9wIHBsdWdpbiBjcmVhdGUgc3RhdGVtZW50IGZyb20gJXMgJXMgJXNcbiIsCjEwODJjMTEyMQo8
IAkgICAgcXVlcnkgPSBzcWxfY3JlYXRlX3N0YXRlbWVudChzZXR0aW5ncy0+c3FsX3NlbGVjdCwK
LS0tCj4gCSAgICBxdWVyeSA9IHNxbF9jcmVhdGVfc3RhdGVtZW50KHNldHRpbmdzLT5zcWxfYXV4
cHJvcF9zZWxlY3QsCjEwOTJjMTEzMQo8IAkJCQkgICAgInNxbCBwbHVnaW4gZG9pbmcgcXVlcnkg
JXNcbiIsIHF1ZXJ5KTsKLS0tCj4gCQkJCSAgICAic3FsX2F1eHByb3AgcGx1Z2luIGRvaW5nIHF1
ZXJ5ICVzXG4iLCBxdWVyeSk7CjExNTcsMTE1OGMxMTk2LDExOTcKPCAJc3FsX2V4aXN0cyhzZXR0
aW5ncy0+c3FsX2luc2VydCkgJiYKPCAJc3FsX2V4aXN0cyhzZXR0aW5ncy0+c3FsX3VwZGF0ZSkp
IHJldHVybiBTQVNMX09LOwotLS0KPiAJc3FsX2V4aXN0cyhzZXR0aW5ncy0+c3FsX2F1eHByb3Bf
aW5zZXJ0KSAmJgo+IAlzcWxfZXhpc3RzKHNldHRpbmdzLT5zcWxfYXV4cHJvcF91cGRhdGUpKSBy
ZXR1cm4gU0FTTF9PSzsKMTIyNmMxMjY1CjwgCXN0YXRlbWVudCA9IHNxbF9jcmVhdGVfc3RhdGVt
ZW50KHNldHRpbmdzLT5zcWxfc2VsZWN0LAotLS0KPiAJc3RhdGVtZW50ID0gc3FsX2NyZWF0ZV9z
dGF0ZW1lbnQoc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3NlbGVjdCwKMTIzM2MxMjcyCjwgCSAgICBj
bWQgPSBzZXR0aW5ncy0+c3FsX3VwZGF0ZTsKLS0tCj4gCSAgICBjbWQgPSBzZXR0aW5ncy0+c3Fs
X2F1eHByb3BfdXBkYXRlOwoxMjM2YzEyNzUKPCAJICAgIGNtZCA9IHNldHRpbmdzLT5zcWxfaW5z
ZXJ0OwotLS0KPiAJICAgIGNtZCA9IHNldHRpbmdzLT5zcWxfYXV4cHJvcF9pbnNlcnQ7CjEyOTVk
MTMzMwo8IAoxMzA4YTEzNDcsMTU0NQo+IAo+IHN0YXRpYyBpbnQKPiBzcWxfY2Fub25fc2VydmVy
ICh2b2lkICpnbG9iX2NvbnRleHQsCj4gCQkJICAgICAgIHNhc2xfc2VydmVyX3BhcmFtc190ICog
c3BhcmFtcywKPiAJCQkgICAgICAgY29uc3QgY2hhciAqdXNlciwgdW5zaWduZWQgdWxlbiwKPiAJ
CQkgICAgICAgdW5zaWduZWQgZmxhZ3MgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCj4gCQkJICAg
ICAgIGNoYXIgKm91dF91c2VyLAo+IAkJCSAgICAgICB1bnNpZ25lZCBvdXRfdW1heCwgdW5zaWdu
ZWQgKm91dF91bGVuKQo+IHsKPiAgIHNwYXJhbXMtPnV0aWxzLT5zZXRlcnJvciAoc3BhcmFtcy0+
dXRpbHMtPmNvbm4sIDAsICJzcWxfY2Fub25fc2VydmVyIik7Cj4gCj4gICBjaGFyICp1c2VyaWQg
PSBOVUxMOwo+ICAgLyogcmVhbG0gY291bGQgYmUgdXNlZCBmb3Igc29tZXRoaW5nIGNsZXZlciAq
Lwo+ICAgY2hhciAqcmVhbG0gPSBOVUxMOwo+ICAgY29uc3QgY2hhciAqdXNlcl9yZWFsbSA9IE5V
TEw7Cj4gICBjaGFyIHZhbHVlWzgxOTJdOwo+ICAgc2l6ZV90IHZhbHVlX2xlbjsKPiAgIGNoYXIg
b2xkX3ZhbHVlWzgxOTJdOwo+ICAgc2l6ZV90IG9sZF92YWx1ZV9sZW47Cj4gICBjaGFyICpxdWVy
eSA9IE5VTEw7Cj4gICBjaGFyICplc2NhcF91c2VyaWQgPSBOVUxMOwo+ICAgY2hhciAqZXNjYXBf
cmVhbG0gPSBOVUxMOwo+ICAgc3FsX3NldHRpbmdzX3QgKnNldHRpbmdzOwo+ICAgdm9pZCAqY29u
biA9IE5VTEw7Cj4gICB1bnNpZ25lZCBpOwo+ICAgY2hhciAqaW5fYnVmLCAqdXNlcmluOwo+ICAg
Y29uc3QgY2hhciAqYmVnaW5fdTsKPiAgIHNpemVfdCB1X2FwcHJlYWxtID0gMDsKPiAKPiAgIGlm
ICghZ2xvYl9jb250ZXh0IHx8ICFzcGFyYW1zLT51dGlscyB8fCAhdXNlcikKPiAgICAgcmV0dXJu
IFNBU0xfQkFEUEFSQU07Cj4gCj4gICAgIHNwYXJhbXMtPnV0aWxzLT5sb2coTlVMTCwgU0FTTF9M
T0dfREVCVUcsCj4gICAgICAgICAgICAgICAgICAgICAgICAgInNxbF9jYW5vbl9zZXJ2ZXIgUGFy
c2UgdGhlIHVzZXJuYW1lICVzXG4iLCB1c2VyKTsKPiAKPiAKPiAgIGluX2J1ZiA9IHNwYXJhbXMt
PnV0aWxzLT5tYWxsb2MgKCh1bGVuICsgMikgKiBzaXplb2YgKGNoYXIpKTsKPiAgIGlmICghaW5f
YnVmKQo+ICAgICByZXR1cm4gU0FTTF9OT01FTTsKPiAKPiAgIHVzZXJpbiA9IGluX2J1ZjsKPiAK
PiAgIG1lbWNweSAodXNlcmluLCB1c2VyLCB1bGVuKTsKPiAgIHVzZXJpblt1bGVuXSA9ICdcMCc7
Cj4gCj4gCj4gICBmb3IgKGkgPSAwOyBpc3NwYWNlICgoaW50KSB1c2VyaW5baV0pICYmIGkgPCB1
bGVuOyBpKyspOwo+ICAgYmVnaW5fdSA9ICYodXNlcmluW2ldKTsKPiAgIGlmIChpID4gMCkKPiAg
ICAgdWxlbiAtPSBpOwo+IAo+ICAgZm9yICg7IHVsZW4gPiAwICYmIGlzc3BhY2UgKChpbnQpIGJl
Z2luX3VbdWxlbiAtIDFdKTsgdWxlbi0tKTsKPiAgIGlmIChiZWdpbl91ID09ICYodXNlcmluW3Vs
ZW5dKSkKPiAgICAgewo+ICAgICAgIHNwYXJhbXMtPnV0aWxzLT5mcmVlIChpbl9idWYpOwo+ICAg
ICAgIHNwYXJhbXMtPnV0aWxzLT5zZXRlcnJvciAoc3BhcmFtcy0+dXRpbHMtPmNvbm4sIDAsCj4g
CQkJCSJBbGwtd2hpdGVzcGFjZSB1c2VybmFtZS4iKTsKPiAgICAgICByZXR1cm4gU0FTTF9GQUlM
Owo+ICAgICB9Cj4gCj4gICAvKiBOZWVkIHRvIGFwcGVuZCByZWFsbSBpZiBuZWNlc3NhcnkgKHNl
ZSBzYXNsLmgpICovCj4gICBpZiAoc3BhcmFtcy0+dXNlcl9yZWFsbSkKPiAgICAgewo+ICAgICAg
IHVzZXJfcmVhbG0gPSBzcGFyYW1zLT51c2VyX3JlYWxtOwo+ICAgICB9Cj4gICBlbHNlCj4gICAg
IHsKPiAgICAgICB1c2VyX3JlYWxtID0gc3BhcmFtcy0+c2VydmVyRlFETjsKPiAgICAgfQo+IAo+
ICAgaWYgKCFzdHJjaHIgKHVzZXIsICdAJykpCj4gICAgIHsKPiAgICAgICB1X2FwcHJlYWxtID0g
c3RybGVuICh1c2VyX3JlYWxtKSArIDE7Cj4gICAgIH0KPiAKPiAgIC8qIHNldHVwIHRoZSBzZXR0
aW5ncyAqLwo+ICAgc2V0dGluZ3MgPSAoc3FsX3NldHRpbmdzX3QgKikgZ2xvYl9jb250ZXh0Owo+
IAo+ICAgLyoganVzdCBuZWVkIHRvIGVzY2FwZSB1c2VyaWQgYW5kIHJlYWxtIG5vdyAqLwo+ICAg
LyogYWxsb2NhdGUgc29tZSBtZW1vcnkgKi8KPiAgIGVzY2FwX3VzZXJpZCA9IChjaGFyICopIHNw
YXJhbXMtPnV0aWxzLT5tYWxsb2MgKDI1NSk7Cj4gICBlc2NhcF9yZWFsbSA9IChjaGFyICopIHNw
YXJhbXMtPnV0aWxzLT5tYWxsb2MgKDI1NSk7Cj4gCj4gICBpZiAoIWVzY2FwX3VzZXJpZCB8fCAh
ZXNjYXBfcmVhbG0pCj4gICAgIHsKPiAgICAgICBzcGFyYW1zLT51dGlscy0+bG9nIChOVUxMLCBT
QVNMX0xPR19ERUJVRywKPiAJCQkgICAic3FsX2Nhbm9uX3NlcnZlcjogbWVtZXJyb3IgXG4iKTsK
PiAgICAgICBNRU1FUlJPUiAoc3BhcmFtcy0+dXRpbHMpOwo+ICAgICAgIGdvdG8gZG9uZTsKPiAg
ICAgfQo+IAo+ICAgY29ubiA9IHNxbF9jb25uZWN0IChzZXR0aW5ncywgc3BhcmFtcy0+dXRpbHMp
Owo+ICAgaWYgKCFjb25uKQo+ICAgICB7Cj4gICAgICAgc3BhcmFtcy0+dXRpbHMtPmxvZyAoTlVM
TCwgU0FTTF9MT0dfRVJSLAo+IAkJCSAgICJzcWxfY2Fub25fc2VydmVyIGNvdWxkbid0IGNvbm5l
Y3QgdG8gYW55IGhvc3RcbiIpOwo+ICAgICAgIGdvdG8gZG9uZTsKPiAgICAgfQo+IAo+ICAgLyog
ZXNjYXBlIG91dCAqLwo+ICAgc2V0dGluZ3MtPnNxbF9lbmdpbmUtPnNxbF9lc2NhcGVfc3RyIChl
c2NhcF91c2VyaWQsIHVzZXJpbik7Cj4gICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+c3FsX2VzY2Fw
ZV9zdHIgKGVzY2FwX3JlYWxtLCB1c2VyX3JlYWxtKTsKPiAKPiAgIC8qIGNyZWF0ZSBhIHN0YXRl
bWVudCB0aGF0IHdlIHdpbGwgdXNlICovCj4gICBzcGFyYW1zLT51dGlscy0+bG9nKE5VTEwsIFNB
U0xfTE9HX0RFQlVHLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic3FsX2Nhbm9uIHBs
dWdpbiBjcmVhdGUgc3RhdGVtZW50IGZyb20gJXMgJXNcbiIsCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGVzY2FwX3VzZXJpZCwgZXNjYXBfcmVhbG0pOwo+IAo+ICAgcXVlcnkgPSBzcWxf
Y3JlYXRlX3N0YXRlbWVudCAoc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QsCj4gCQkJCWVzY2Fw
X3VzZXJpZCwgZXNjYXBfdXNlcmlkLAo+IAkJCQllc2NhcF9yZWFsbSwgTlVMTCwgc3BhcmFtcy0+
dXRpbHMpOwo+ICAgbWVtY3B5KG9sZF92YWx1ZSx1c2VyaW4sIHN0cmxlbiAodXNlcmluKSk7Cj4g
ICBvbGRfdmFsdWVfbGVuID0gc3RybGVuICh1c2VyaW4pOwo+ICAgLyogcnVuIHRoZSBxdWVyeSAq
Lwo+ICAgc3BhcmFtcy0+dXRpbHMtPmxvZyhOVUxMLCBTQVNMX0xPR19ERUJVRywKPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgInNxbF9jYW5vbiBwbHVnaW4gZG9pbmcgcXVlcnkgJXNcbiIs
IHF1ZXJ5KTsKPiAKPiAgIHdoaWxlICghc2V0dGluZ3MtPnNxbF9lbmdpbmUtPnNxbF9leGVjIChj
b25uLCBxdWVyeSwgdmFsdWUsIHNpemVvZiAodmFsdWUpLAo+IAkJCQkgICAgICAgJnZhbHVlX2xl
biwgc3BhcmFtcy0+dXRpbHMpKQo+ICAgICB7Cj4gICAgICAgICBtZW1jcHkob2xkX3ZhbHVlLHZh
bHVlLHZhbHVlX2xlbik7Cj4gICAgICAgICBvbGRfdmFsdWVfbGVuPXZhbHVlX2xlbjsKPiAgICAg
ICAgIHNldHRpbmdzLT5zcWxfZW5naW5lLT5zcWxfZXNjYXBlX3N0ciAoZXNjYXBfdXNlcmlkLCB2
YWx1ZSk7Cj4gICAgICAgICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+c3FsX2VzY2FwZV9zdHIgKGVz
Y2FwX3JlYWxtLCB1c2VyX3JlYWxtKTsKPiAgICAgICAgIHNwYXJhbXMtPnV0aWxzLT5sb2coTlVM
TCwgU0FTTF9MT0dfREVCVUcsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzcWxfY2Fu
b24gcGx1Z2luIGNyZWF0ZSBzdGF0ZW1lbnQgZnJvbSAlcyAlc1xuIiwKPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZXNjYXBfdXNlcmlkLCBlc2NhcF9yZWFsbSk7Cj4gCj4gICAvKiBjcmVh
dGUgYSBzdGF0ZW1lbnQgdGhhdCB3ZSB3aWxsIHVzZSAqLwo+ICAgICAgICAgcXVlcnkgPSBzcWxf
Y3JlYXRlX3N0YXRlbWVudCAoc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QsCj4gCQkJCWVzY2Fw
X3VzZXJpZCwgZXNjYXBfdXNlcmlkLAo+IAkJCQllc2NhcF9yZWFsbSwgTlVMTCwgc3BhcmFtcy0+
dXRpbHMpOwo+ICAgICAgICBzcGFyYW1zLT51dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX0RFQlVH
LAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic3FsX2Nhbm9uIHBsdWdpbiBkb2luZyBx
dWVyeSAlc1xuIiwgcXVlcnkpOwo+IAo+IAl9Cj4gICAgICAgaWYgKG9sZF92YWx1ZV9sZW4gPCBv
dXRfdW1heCkKPiAJewo+IAkgIG1lbWNweSAob3V0X3VzZXIsIG9sZF92YWx1ZSwgb2xkX3ZhbHVl
X2xlbik7Cj4gCSAgb3V0X3VzZXJbb2xkX3ZhbHVlX2xlbl0gPSAnXDAnOwo+IAkgICpvdXRfdWxl
biA9IG9sZF92YWx1ZV9sZW47IAo+ICAgICB9Cj4gICAgICAgZWxzZQo+IAl7Cj4gCSAgTUVNRVJS
T1IgKHNwYXJhbXMtPnV0aWxzKTsKPiAJICBnb3RvIGRvbmU7Cj4gICAgIH0KPiAgIHNwYXJhbXMt
PnV0aWxzLT5mcmVlIChxdWVyeSk7Cj4gCj4gZG9uZToKPiAgIGlmIChlc2NhcF91c2VyaWQpCj4g
ICAgIHNwYXJhbXMtPnV0aWxzLT5mcmVlIChlc2NhcF91c2VyaWQpOwo+ICAgaWYgKGVzY2FwX3Jl
YWxtKQo+ICAgICBzcGFyYW1zLT51dGlscy0+ZnJlZSAoZXNjYXBfcmVhbG0pOwo+ICAgaWYgKGNv
bm4pCj4gICAgIHNldHRpbmdzLT5zcWxfZW5naW5lLT5zcWxfY2xvc2UgKGNvbm4pOwo+ICAgaWYg
KHVzZXJpZCkKPiAgICAgc3BhcmFtcy0+dXRpbHMtPmZyZWUgKHVzZXJpZCk7Cj4gICBpZiAocmVh
bG0pCj4gICAgIHNwYXJhbXMtPnV0aWxzLT5mcmVlIChyZWFsbSk7Cj4gICByZXR1cm4gU0FTTF9P
SzsKPiB9Cj4gCj4gc3RhdGljIGludAo+IHNxbF9jYW5vbl9jbGllbnQodm9pZCAqZ2xvYl9jb250
ZXh0IF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAo+IAkJICAgIHNhc2xfY2xpZW50X3BhcmFtc190
ICpjcGFyYW1zLAo+IAkJICAgIGNvbnN0IGNoYXIgKnVzZXIsCj4gCQkgICAgdW5zaWduZWQgdWxl
biwKPiAJCSAgICB1bnNpZ25lZCBmbGFncyBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKPiAJCSAg
ICBjaGFyICpvdXQsCj4gCQkgICAgdW5zaWduZWQgb3V0X21heCwKPiAJCSAgICB1bnNpZ25lZCAq
b3V0X3VsZW4pewo+ICAgICBpZighY3BhcmFtcyB8fCAhdXNlcikgcmV0dXJuIFNBU0xfQkFEUEFS
QU07Cj4gCj4gICAgIC8qIFRyaW0gd2hpdGVzcGFjZSAqLwo+ICAgICB3aGlsZShpc3NwYWNlKCoo
dW5zaWduZWQgY2hhciAqKXVzZXIpKSB7Cj4gCXVzZXIrKzsKPiAJdWxlbi0tOwo+ICAgICB9Cj4g
ICAgIHdoaWxlKGlzc3BhY2UoKHVuc2lnbmVkIGNoYXIpdXNlclt1bGVuLTFdKSkgewo+ICAgICAJ
dWxlbi0tOwo+ICAgICB9Cj4gCj4gICAgIGlmICghdWxlbikgewo+ICAgICAJY3BhcmFtcy0+dXRp
bHMtPnNldGVycm9yKGNwYXJhbXMtPnV0aWxzLT5jb25uLCAwLAo+IAkgICAgIkFsbC13aGl0ZXNw
YWNlIHVzZXJuYW1lLiIpOwo+IAlyZXR1cm4gU0FTTF9GQUlMOwo+ICAgICB9Cj4gICAgIGlmICh1
bGVuPm91dF91bWF4KSByZXR1cm4gU0FTTF9OT01FTTsKPiAgICAgbWVtY3B5KG91dCwgdXNlciwg
dWxlbik7Cj4gICAgIG91dFt1bGVuXSA9ICdcMCc7Cj4gICAgICpvdXRfdWxlbiA9IHVsZW47Cj4g
ICAgIHJldHVybiBTQVNMX09LOwo+IH0KPiAKPiAKPiAKPiAKPiAKMTM0NiwxMzQ3YzE1ODMsMTU4
NAo8ICAgICBpZiAoIXNxbF9leGlzdHMoc2V0dGluZ3MtPnNxbF9zZWxlY3QpKSB7CjwgCXV0aWxz
LT5sb2coTlVMTCwgU0FTTF9MT0dfRVJSLCAic3FsX3NlbGVjdCBvcHRpb24gbWlzc2luZyIpOwot
LS0KPiAgICAgaWYgKCFzcWxfZXhpc3RzKHNldHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxlY3QpKSB7
Cj4gCXV0aWxzLT5sb2coTlVMTCwgU0FTTF9MT0dfRVJSLCAic3FsX2F1eHByb3Bfc2VsZWN0IG9w
dGlvbiBtaXNzaW5nIik7CjEzNTMsMTM1NGMxNTkwLDE1OTEKPCAJICAgICAgICJzcWwgYXV4cHJv
cCBwbHVnaW4gdXNpbmcgJXMgZW5naW5lXG4iLAo8IAkgICAgICAgc2V0dGluZ3MtPnNxbF9lbmdp
bmUtPm5hbWUpOwotLS0KPiAJICAgICAgInNxbF9hdXhwcm9wX3BsdWdpbiB1c2luZyAlcyBlbmdp
bmUgd2l0aCBzZWxlY3Q6ICVzXG4iLAo+IAkgICAgICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+bmFt
ZSwgc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3NlbGVjdCk7CjEzNTlhMTU5NywxNjYxCj4gc3RhdGlj
IHNhc2xfY2Fub251c2VyX3BsdWdfdCBzcWxfY2Fub251c2VyX3BsdWdpbiA9IHsKPiAJMCwJLyog
ZmVhdHVyZXMgKi8KPiAJMCwJLyogc3BhcmUgKi8KPiAJTlVMTCwJLyogZ2xvYl9jb250ZXh0ICov
Cj4gCSJzcWwiLAkvKiBuYW1lICovCj4gCXNxbF9hdXhwcm9wX2ZyZWUsCS8qIGNhbm9uX3VzZXJf
ZnJlZSAqLwo+IAlzcWxfY2Fub25fc2VydmVyLAkvKiBjYW5vbl91c2VyX3NlcnZlciAqLwo+IAlz
cWxfY2Fub25fY2xpZW50LAkvKiBjYW5vbl91c2VyX2NsaWVudCAqLwo+IAlOVUxMLAo+IAlOVUxM
LAo+IAlOVUxMCj4gfTsKPiAKPiBpbnQKPiBzcWxfY2Fub251c2VyX3BsdWdfaW5pdCAoY29uc3Qg
c2FzbF91dGlsc190ICogdXRpbHMKPiAJCQkJICBfX2F0dHJpYnV0ZV9fICgodW51c2VkKSksIGlu
dCBtYXhfdmVyc2lvbiwKPiAJCQkJICBpbnQgKm91dF92ZXJzaW9uLAo+IAkJCQkgIHNhc2xfY2Fu
b251c2VyX3BsdWdfdCAqKiBwbHVnLAo+IAkJCQkgIGNvbnN0IGNoYXIgKnBsdWduYW1lCj4gCQkJ
CSAgX19hdHRyaWJ1dGVfXyAoKHVudXNlZCkpKQo+IHsKPiAgIHNxbF9zZXR0aW5nc190ICpzZXR0
aW5nczsKPiAKPiAgIGlmICghb3V0X3ZlcnNpb24gfHwgIXBsdWcpCj4gICAgIHJldHVybiBTQVNM
X0JBRFBBUkFNOwo+IAo+ICAgaWYgKG1heF92ZXJzaW9uIDwgU0FTTF9DQU5PTlVTRVJfUExVR19W
RVJTSU9OKQo+ICAgICByZXR1cm4gU0FTTF9CQURWRVJTOwo+IAo+ICAgKm91dF92ZXJzaW9uID0g
U0FTTF9DQU5PTlVTRVJfUExVR19WRVJTSU9OOwo+IAo+ICAgc2V0dGluZ3MgPSAoc3FsX3NldHRp
bmdzX3QgKikgdXRpbHMtPm1hbGxvYyAoc2l6ZW9mIChzcWxfc2V0dGluZ3NfdCkpOwo+IAo+ICAg
aWYgKCFzZXR0aW5ncykKPiAgICAgewo+ICAgICAgIE1FTUVSUk9SICh1dGlscyk7Cj4gICAgICAg
cmV0dXJuIFNBU0xfTk9NRU07Cj4gICAgIH0KPiAKPiAgIG1lbXNldCAoc2V0dGluZ3MsIDAsIHNp
emVvZiAoc3FsX3NldHRpbmdzX3QpKTsKPiAgIHNxbF9nZXRfc2V0dGluZ3MgKHV0aWxzLCBzZXR0
aW5ncyk7Cj4gCj4gICBpZiAoIXNldHRpbmdzLT5zcWxfZW5naW5lLT5uYW1lKQo+ICAgICByZXR1
cm4gU0FTTF9OT01FQ0g7Cj4gCj4gICBpZiAoIXNxbF9leGlzdHMgKHNldHRpbmdzLT5zcWxfY2Fu
b25fc2VsZWN0KSkKPiAgICAgewo+ICAgICAgIHV0aWxzLT5sb2cgKE5VTEwsIFNBU0xfTE9HX0VS
UiwKPiAJCSAgInNxbF9jYW5vbl9wbHVnaW46IHNxbF9jYW5vbl9zZWxlY3Qgb3B0aW9uIG1pc3Np
bmciKTsKPiAgICAgICB1dGlscy0+ZnJlZSAoc2V0dGluZ3MpOwo+ICAgICAgIHJldHVybiBTQVNM
X05PTUVDSDsKPiAgICAgfQo+IAo+ICAgdXRpbHMtPmxvZyAoTlVMTCwgU0FTTF9MT0dfREVCVUcs
Cj4gCSAgICAgICJzcWxfY2Fub25fcGx1Z2luIHVzaW5nICVzIGVuZ2luZSB3aXRoIHNlbGVjdDog
JXNcbiIsCj4gCSAgICAgIHNldHRpbmdzLT5zcWxfZW5naW5lLT5uYW1lLCBzZXR0aW5ncy0+c3Fs
X2Nhbm9uX3NlbGVjdCk7Cj4gCj4gICBzcWxfY2Fub251c2VyX3BsdWdpbi5nbG9iX2NvbnRleHQg
PSBzZXR0aW5nczsKPiAKPiAKPiAKPiAgICpwbHVnID0gJnNxbF9jYW5vbnVzZXJfcGx1Z2luOwo+
IAo+ICAgcmV0dXJuIFNBU0xfT0s7Cj4gfQpkaWZmIC1ydyBjeXJ1cy1zYXNsLTIuMS4yNC9wbHVn
aW5zL3NxbF9pbml0LmMgY3lydXMtc2FzbC0yLjEuMjQtc3FsL3BsdWdpbnMvc3FsX2luaXQuYwoz
OGEzOQo+IFNBU0xfQ0FOT05VU0VSX1BMVUdfSU5JVCggc3FsICkK
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1271</attachid>
            <date>2010-05-14 12:29 EDT</date>
            <desc>sql-canon-plugin</desc>
            <filename>sql_canon.patch</filename>
            <type>text/plain</type>
            <size>16114</size>
            <attacher>lars.duesing@camelotsweb.de</attacher>
            
              <data encoding="base64">ZGlmZiAtcncgY3lydXMtc2FzbC0yLjEuMjQvZG9jL29wdGlvbnMuaHRtbCBjeXJ1cy1zYXNsLTIu
MS4yNC1zcWwvZG9jL29wdGlvbnMuaHRtbAoxNzZhMTc3LDE4Mgo+IDxURD5zcWxfYXV4cHJvcF9z
ZWxlY3Q8L1REPjxURD5TUUwgcGx1Z2luPC9URD4KPiA8VEQ+U0VMRUNUIHN0YXRlbWVudCB0byB1
c2UgZm9yIGZldGNoaW5nIHByb3BlcnRpZXMuICBUaGlzIG9wdGlvbiBpcwo+IDxiPnJlcXVpcmVk
PC9iPiBpbiBvcmRlciB0byB1c2UgdGhlIFNRTCBhdXhwcm9wIHBsdWdpbi48L1REPgo+IDxURD48
aT5ub25lPC9pPjwvVEQ+Cj4gPC9UUj4KPiA8VFI+CjE3N2ExODQsMTk1Cj4gPFREPlNFTEVDVCBz
dGF0ZW1lbnQgdG8gdXNlIGZvciBmZXRjaGluZyBwcm9wZXJ0aWVzLiA8Yj5EZXByZWNhdGVkPC9i
PiBhbGlhcyBmb3Igc3FsX2F1eHByb3Bfc2VsZWN0LiBUaGlzIG9wdGlvbiBpcwo+IDxiPnJlcXVp
cmVkPC9iPiBpbiBvcmRlciB0byB1c2UgdGhlIFNRTCBhdXhwcm9wIHBsdWdpbi48L1REPgo+IDxU
RD48aT5ub25lPC9pPjwvVEQ+Cj4gPC9UUj4KPiA8VFI+Cj4gPFREPnNxbF9zdGF0ZW1lbnQ8L1RE
PjxURD5TUUwgcGx1Z2luPC9URD4KPiA8VEQ+U0VMRUNUIHN0YXRlbWVudCB0byB1c2UgZm9yIGZl
dGNoaW5nIHByb3BlcnRpZXMuIDxiPkRlcHJlY2F0ZWQ8L2I+IGFsaWFzIGZvciBzcWxfYXV4cHJv
cF9zZWxlY3QuIFRoaXMgb3B0aW9uIGlzCj4gPGI+cmVxdWlyZWQ8L2I+IGluIG9yZGVyIHRvIHVz
ZSB0aGUgU1FMIGF1eHByb3AgcGx1Z2luLjwvVEQ+Cj4gPFREPjxpPm5vbmU8L2k+PC9URD4KPiA8
L1RSPgo+IDxUUj4KPiA8VEQ+c3FsX2Nhbm9uX3NlbGVjdDwvVEQ+PFREPlNRTCBwbHVnaW48L1RE
PgoxNzljMTk3CjwgPGI+cmVxdWlyZWQ8L2I+IGluIG9yZGVyIHRvIHVzZSB0aGUgU1FMIHBsdWdp
bi48L1REPgotLS0KPiA8Yj5yZXF1aXJlZDwvYj4gaW4gb3JkZXIgdG8gdXNlIHRoZSBTUUwgY2Fu
b24gcGx1Z2luLjwvVEQ+CjE4M2MyMDEKPCA8VEQ+c3FsX2luc2VydDwvVEQ+PFREPlNRTCBwbHVn
aW48L1REPgotLS0KPiA8VEQ+c3FsX2F1eHByb3BfaW5zZXJ0PC9URD48VEQ+U1FMIHBsdWdpbjwv
VEQ+CjE4OGMyMDYsMjExCjwgPFREPnNxbF91cGRhdGU8L1REPjxURD5TUUwgcGx1Z2luPC9URD4K
LS0tCj4gPFREPnNxbF9pbnNlcnQ8L1REPjxURD5TUUwgcGx1Z2luPC9URD4KPiA8VEQ+SU5TRVJU
IHN0YXRlbWVudCB0byB1c2UgZm9yIGNyZWF0aW5nIHByb3BlcnRpZXMgZm9yIG5ldyB1c2Vycy4g
PGI+RGVwcmVjYXRlZDwvYj4gYWxpYXMgZm9yIHNxbF9hdXhwcm9wX2luc2VydC48L1REPgo+IDxU
RD48aT5ub25lPC9pPjwvVEQ+Cj4gPC9UUj4KPiA8VFI+Cj4gPFREPnNxbF9hdXhwcm9wX3VwZGF0
ZTwvVEQ+PFREPlNRTCBwbHVnaW48L1REPgoxOTJhMjE2LDIyMQo+IDxUUj4KPiA8VEQ+c3FsX3Vw
ZGF0ZTwvVEQ+PFREPlNRTCBwbHVnaW48L1REPgo+IDxURD5VUERBVEUgc3RhdGVtZW50IHRvIHVz
ZSBmb3IgbW9kaWZ5aW5nIHByb3BlcnRpZXMuIDxiPkRlcHJlY2F0ZWQ8L2I+IGFsaWFzIGZvciBz
cWxfYXV4cHJvcF91cGRhdGU8L1REPgo+IDxURD48aT5ub25lPC9pPjwvVEQ+Cj4gPC9UUj4KPiA8
VFI+CjIxMmMyNDEKPCA8cD5UaGUgPHR0PnNxbF9pbnNlcnQ8L3R0PiBhbmQgPHR0PnNxbF91cGRh
dGU8L3R0PiBvcHRpb25zIGFyZQotLS0KPiA8cD5UaGUgPHR0PnNxbF9hdXhwcm9wX2luc2VydDwv
dHQ+IGFuZCA8dHQ+c3FsX2F1eHByb3BfdXBkYXRlPC90dD4gb3B0aW9ucyBhcmUKMjE5LDIyMGMy
NDgsMjQ5CjwgPHA+VGhlIFNRTCBzdGF0ZW1lbnRzIHByb3ZpZGVkIGluIHRoZSA8dHQ+c3FsX3Nl
bGVjdDwvdHQ+LAo8IDx0dD5zcWxfaW5zZXJ0PC90dD4gYW5kIDx0dD5zcWxfdXBkYXRlPC90dD4g
b3B0aW9ucyBjYW4gY29udGFpbgotLS0KPiA8cD5UaGUgU1FMIHN0YXRlbWVudHMgcHJvdmlkZWQg
aW4gdGhlIDx0dD5zcWxfYXV4cHJvcF9zZWxlY3Q8L3R0PiwKPiA8dHQ+c3FsX2F1eHByb3BfaW5z
ZXJ0PC90dD4gYW5kIDx0dD5zcWxfYXV4cHJvcF91cGRhdGU8L3R0PiBvcHRpb25zIGNhbiBjb250
YWluCjI1MGMyNzkKPCAgICAgIDx0dD5zcWxfc2VsZWN0OiBTRUxFQ1QgJXAgRlJPTSB1c2VyX3Rh
YmxlIFdIRVJFIHVzZXJuYW1lID0gJyV1JyBhbmQgcmVhbG0gPSAnJXInPC90dD4KLS0tCj4gICAg
ICA8dHQ+c3FsX2F1eHByb3Bfc2VsZWN0OiBTRUxFQ1QgJXAgRlJPTSB1c2VyX3RhYmxlIFdIRVJF
IHVzZXJuYW1lID0gJyV1JyBhbmQgcmVhbG0gPSAnJXInPC90dD4KMjY0YzI5Mwo8ICAgICAgPHR0
PnNxbF9pbnNlcnQ6IElOU0VSVCBJTlRPIHVzZXJfdGFibGUgKHVzZXJuYW1lLCByZWFsbSwgJXAp
IFZBTFVFUyAoJyV1JywgJyVyJywgJyV2Jyk8L3R0PgotLS0KPiAgICAgIDx0dD5zcWxfYXV4cHJv
cF9pbnNlcnQ6IElOU0VSVCBJTlRPIHVzZXJfdGFibGUgKHVzZXJuYW1lLCByZWFsbSwgJXApIFZB
TFVFUyAoJyV1JywgJyVyJywgJyV2Jyk8L3R0PgoyODNhMzEzLDMyMwo+IDxoMj5Ob3RlcyBvbiBT
UUwgY2Fub24gdXNlciBwbHVnaW4gb3B0aW9uczwvaDI+Cj4gPHA+VGhpcyBwbHVnaW4gc2hhcmVz
IGFsbCBjb25maWd1cmF0aW9uIHdpdGggU1FMIGF1eHByb3AgcGx1Z2luLiBUaGVyZWZvcmUgCj4g
eW91IGhhdmUgdG8gZ2l2ZSBvcHRpb25zIGxpa2Ugc3FsX2hvc3RuYW1lcyBhbmQgc3FsX3VzZXIg
b25seSBvbmNlLgo+IDwvcD4KPiA8cD5BbGwgYWJvdmUgZXhhbXBsZXMgZm9yIHNxbF9hdXhwcm9w
X3NlbGVjdCBhcmUgdmFsaWQgZm9yIHNxbF9jYW5vbl9zZWxlY3QsIHRvby4KPiA8L3A+Cj4gPHA+
Tk9URTogVGhpcyBwbHVnaW4gdGVzdHMgZm9yIHJlY3Vyc2lvbiA1IGl0ZXJhdGlvbnMuIAo+IChl
LmcuIHRlc3RAdGVzdC5sb2NhbC0+am9lQHRlc3QubG9jYWwtPmRvZUB0ZXN0LmxvY2FsLT50ZXN0
QHRlc3QubG9jYWwtPmpvZUB0ZXN0LmxvY2FsKQo+IEFmdGVyIHRoYXQgaXQgc3RvcHMgdGhlIHJl
Y3Vyc2lvbiBhdCB0aGUgY3VycmVudCBlbGVtZW50IGFuZCBpc3N1ZXMgYSB3YXJuaW5nLgo+IDwv
cD4KPiAKZGlmZiAtcncgY3lydXMtc2FzbC0yLjEuMjQvcGx1Z2lucy9tYWtlaW5pdC5zaCBjeXJ1
cy1zYXNsLTIuMS4yNC1zcWwvcGx1Z2lucy9tYWtlaW5pdC5zaAo5MmM5Mgo8ICMgbGRhcGRiIGlz
IGFsc28gYSBjYW5vbl91c2VyIHBsdWdpbgotLS0KPiAjIGxkYXBkYiBhbmQgc3FsIGFyZSBhbHNv
IGNhbm9uX3VzZXIgcGx1Z2lucwo5M2E5NCw5NQo+IGVjaG8gIlNBU0xfQ0FOT05VU0VSX1BMVUdf
SU5JVCggc3FsICkiID4+IHNxbF9pbml0LmMKPiAKZGlmZiAtcncgY3lydXMtc2FzbC0yLjEuMjQv
cGx1Z2lucy9zcWwuYyBjeXJ1cy1zYXNsLTIuMS4yNC1zcWwvcGx1Z2lucy9zcWwuYwozYzMKPCAq
KiBTUUwgQXV4cHJvcCBwbHVnaW4KLS0tCj4gKiogU1FMIEF1eHByb3AgYW5kIENhbm9uIHBsdWdp
bgo1YzUsNgo8ICoqIEtlbiBNdXJjaGlzb24KLS0tCj4gKiogTGFycyBEdWVzaW5nIC0tIGNhbm9u
IHBsdWdpbgo+ICoqIEtlbiBNdXJjaGlzb24gLS0gb3JpZ2luYWwgYXV4cHJvcCBwbHVnaW4KNTMs
NTVjNTQsNTcKPCAgICAgY29uc3QgY2hhciAqc3FsX3NlbGVjdDsKPCAgICAgY29uc3QgY2hhciAq
c3FsX2luc2VydDsKPCAgICAgY29uc3QgY2hhciAqc3FsX3VwZGF0ZTsKLS0tCj4gICAgIGNvbnN0
IGNoYXIgKnNxbF9hdXhwcm9wX3NlbGVjdDsKPiAgICAgY29uc3QgY2hhciAqc3FsX2Nhbm9uX3Nl
bGVjdDsKPiAgICAgY29uc3QgY2hhciAqc3FsX2F1eHByb3BfaW5zZXJ0Owo+ICAgICBjb25zdCBj
aGFyICpzcWxfYXV4cHJvcF91cGRhdGU7CjgwMiw4MDRjODA0LDgwNgo8ICAgICByID0gdXRpbHMt
PmdldG9wdCh1dGlscy0+Z2V0b3B0X2NvbnRleHQsIlNRTCIsICJzcWxfc2VsZWN0IiwKPCAJCSAg
ICAgICZzZXR0aW5ncy0+c3FsX3NlbGVjdCwgTlVMTCk7CjwgICAgIGlmIChyIHx8ICFzZXR0aW5n
cy0+c3FsX3NlbGVjdCApIHsKLS0tCj4gICAgIHIgPSB1dGlscy0+Z2V0b3B0KHV0aWxzLT5nZXRv
cHRfY29udGV4dCwiU1FMIiwgInNxbF9hdXhwcm9wX3NlbGVjdCIsCj4gCQkgICAgICAmc2V0dGlu
Z3MtPnNxbF9hdXhwcm9wX3NlbGVjdCwgTlVMTCk7Cj4gICAgIGlmIChyIHx8ICFzZXR0aW5ncy0+
c3FsX2F1eHByb3Bfc2VsZWN0ICkgewo4MDVhODA4LDgxMAo+IAlyID0gdXRpbHMtPmdldG9wdCh1
dGlscy0+Z2V0b3B0X2NvbnRleHQsIlNRTCIsICJzcWxfc2VsZWN0IiwKPiAJCQkgICZzZXR0aW5n
cy0+c3FsX2F1eHByb3Bfc2VsZWN0LCBOVUxMKTsKPiAJaWYgKHIgfHwgIXNldHRpbmdzLT5zcWxf
YXV4cHJvcF9zZWxlY3QpIHsKODA3LDgwOWM4MTIsODI0CjwgCQkJICAmc2V0dGluZ3MtPnNxbF9z
ZWxlY3QsIE5VTEwpOwo8IAlpZiAociB8fCAhc2V0dGluZ3MtPnNxbF9zZWxlY3QpIHsKPCAJICAg
IHNldHRpbmdzLT5zcWxfc2VsZWN0ID0gU1FMX0JMQU5LX1NUUklORzsKLS0tCj4gCQkJICAmc2V0
dGluZ3MtPnNxbF9hdXhwcm9wX3NlbGVjdCwgTlVMTCk7Cj4gCSAgICBpZiAociB8fCAhc2V0dGlu
Z3MtPnNxbF9hdXhwcm9wX3NlbGVjdCkgewo+IAkgICAgICAgIHNldHRpbmdzLT5zcWxfYXV4cHJv
cF9zZWxlY3QgPSBTUUxfQkxBTktfU1RSSU5HOwo+IAkgICAgfSBlbHNlCj4gICAgICAgICAgICAg
ewo+ICAgICAgICAgICAgICAgICB1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX1dBUk4sCj4gCQkg
ICAic3FsIHBsdWdpbjogT3B0aW9uIHNxbF9zdGF0ZW1lbnQgaXMgZGVwcmVjYXRlZCwgdXNlIHNx
bF9hdXhwcm9wX3NlbGVjdCBpbnN0ZWFkISIpOwo+ICAgICAgICAgICAgIH0KPiAgICAgICAgIH0K
PiAgICAgICAgIGVsc2UKPiAgICAgICAgIHsKPiAgICAgICAgICAgICB1dGlscy0+bG9nKE5VTEws
IFNBU0xfTE9HX1dBUk4sCj4gICAgICAgICAJICAgInNxbCBwbHVnaW46IE9wdGlvbiBzcWxfc2Vs
ZWN0IGlzIGRlcHJlY2F0ZWQsIHVzZSBzcWxfYXV4cHJvcF9zZWxlY3QgaW5zdGVhZCEiKTsKODEw
YTgyNiw4MzIKPiAgICAgICAgICAgICAKPiAgICAgfQo+IAo+ICAgICByID0gdXRpbHMtPmdldG9w
dCh1dGlscy0+Z2V0b3B0X2NvbnRleHQsICJTUUwiLCAic3FsX2Nhbm9uX3NlbGVjdCIsCj4gCQkg
ICAgICAmc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QsIE5VTEwpOwo+ICAgICBpZiAociB8fCAh
c2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QpIHsKPiAJc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxl
Y3QgPSBTUUxfQkxBTktfU1RSSU5HOwo4MTJhODM1LDgzNwo+ICAgICByID0gdXRpbHMtPmdldG9w
dCh1dGlscy0+Z2V0b3B0X2NvbnRleHQsICJTUUwiLCAic3FsX2F1eHByb3BfaW5zZXJ0IiwKPiAJ
CSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0LCBOVUxMKTsKPiAgICAgaWYgKHIg
fHwgIXNldHRpbmdzLT5zcWxfYXV4cHJvcF9pbnNlcnQpIHsKODE0LDgxNmM4MzksODQ3CjwgCQkg
ICAgICAmc2V0dGluZ3MtPnNxbF9pbnNlcnQsIE5VTEwpOwo8ICAgICBpZiAociB8fCAhc2V0dGlu
Z3MtPnNxbF9pbnNlcnQpIHsKPCAJc2V0dGluZ3MtPnNxbF9pbnNlcnQgPSBTUUxfQkxBTktfU1RS
SU5HOwotLS0KPiAJCSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0LCBOVUxMKTsK
PiAgICAgICAgIGlmIChyIHx8ICFzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0KSB7Cj4gCSAg
ICBzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0ID0gU1FMX0JMQU5LX1NUUklORzsKPiAJfSBl
bHNlCj4gICAgICAgICB7Cj4gICAgICAgICAgICAgdXRpbHMtPmxvZyhOVUxMLCBTQVNMX0xPR19X
QVJOLAo+IAkJICAgInNxbCBwbHVnaW46IE9wdGlvbiBzcWxfaW5zZXJ0IGlzIGRlcHJlY2F0ZWQs
IHVzZSBzcWxfYXV4cHJvcF9pbnNlcnQgaW5zdGVhZCEiKTsKPiAgICAgICAgIH0KPiAKODE4YTg1
MCw4NTIKPiAgICAgciA9IHV0aWxzLT5nZXRvcHQodXRpbHMtPmdldG9wdF9jb250ZXh0LCAiU1FM
IiwgInNxbF9hdXhwcm9wX3VwZGF0ZSIsCj4gCQkgICAgICAmc2V0dGluZ3MtPnNxbF9hdXhwcm9w
X3VwZGF0ZSwgTlVMTCk7Cj4gICAgIGlmIChyIHx8ICFzZXR0aW5ncy0+c3FsX2F1eHByb3BfdXBk
YXRlKSB7CjgyMCw4MjJjODU0LDg2MQo8IAkJICAgICAgJnNldHRpbmdzLT5zcWxfdXBkYXRlLCBO
VUxMKTsKPCAgICAgaWYgKHIgfHwgIXNldHRpbmdzLT5zcWxfdXBkYXRlKSB7CjwgCXNldHRpbmdz
LT5zcWxfdXBkYXRlID0gU1FMX0JMQU5LX1NUUklORzsKLS0tCj4gCQkgICAgICAmc2V0dGluZ3Mt
PnNxbF9hdXhwcm9wX3VwZGF0ZSwgTlVMTCk7Cj4gICAgICAgICBpZiAociB8fCAhc2V0dGluZ3Mt
PnNxbF9hdXhwcm9wX3VwZGF0ZSkgewo+IAkgICAgc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3VwZGF0
ZSA9IFNRTF9CTEFOS19TVFJJTkc7Cj4gICAgICAgICB9IGVsc2UKPiAgICAgICAgIHsKPiAgICAg
ICAgICAgICB1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX1dBUk4sCj4gCQkgICAic3FsIHBsdWdp
bjogT3B0aW9uIHNxbF91cGRhdGUgaXMgZGVwcmVjYXRlZCwgdXNlIHNxbF9hdXhwcm9wX3VwZGF0
ZSBpbnN0ZWFkISIpOwo+ICAgICAgICAgfQo5MjFjOTYwCjwgCQkJInNxbCBwbHVnaW4gUGFyc2Ug
dGhlIHVzZXJuYW1lICVzXG4iLCB1c2VyKTsKLS0tCj4gCQkJInNxbF9hdXhwcm9wIHBsdWdpbiBQ
YXJzZSB0aGUgdXNlcm5hbWUgJXNcbiIsIHVzZXIpOwo5NzBjMTAwOQo8IAkJCSAgICAic3FsIHBs
dWdpbiBjb3VsZG4ndCBjb25uZWN0IHRvIGFueSBob3N0XG4iKTsKLS0tCj4gCQkJICAgICJzcWxf
YXV4cHJvcCBwbHVnaW4gY291bGRuJ3QgY29ubmVjdCB0byBhbnkgaG9zdFxuIik7CjEwMjVjMTA2
NAo8IAkJCSAgICAic3FsIHBsdWdpbiBjcmVhdGUgc3RhdGVtZW50IGZyb20gJXMgJXMgJXNcbiIs
Ci0tLQo+IAkJCSAgICAic3FsX2F1eHByb3AgcGx1Z2luIGNyZWF0ZSBzdGF0ZW1lbnQgZnJvbSAl
cyAlcyAlc1xuIiwKMTAyOWMxMDY4CjwgCXF1ZXJ5ID0gc3FsX2NyZWF0ZV9zdGF0ZW1lbnQoc2V0
dGluZ3MtPnNxbF9zZWxlY3QsCi0tLQo+IAlxdWVyeSA9IHNxbF9jcmVhdGVfc3RhdGVtZW50KHNl
dHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxlY3QsCjEwMzljMTA3OAo8IAkJCSAgICAic3FsIHBsdWdp
biBkb2luZyBxdWVyeSAlc1xuIiwgcXVlcnkpOwotLS0KPiAJCQkgICAgInNxbF9hdXhwcm9wIHBs
dWdpbiBkb2luZyBxdWVyeSAlc1xuIiwgcXVlcnkpOwoxMDc2YzExMTUKPCAJCQkJInNxbCBwbHVn
aW4gY3JlYXRlIHN0YXRlbWVudCBmcm9tICVzICVzICVzXG4iLAotLS0KPiAJCQkJInNxbF9hdXhw
cm9wIHBsdWdpbiBjcmVhdGUgc3RhdGVtZW50IGZyb20gJXMgJXMgJXNcbiIsCjEwODJjMTEyMQo8
IAkgICAgcXVlcnkgPSBzcWxfY3JlYXRlX3N0YXRlbWVudChzZXR0aW5ncy0+c3FsX3NlbGVjdCwK
LS0tCj4gCSAgICBxdWVyeSA9IHNxbF9jcmVhdGVfc3RhdGVtZW50KHNldHRpbmdzLT5zcWxfYXV4
cHJvcF9zZWxlY3QsCjEwOTJjMTEzMQo8IAkJCQkgICAgInNxbCBwbHVnaW4gZG9pbmcgcXVlcnkg
JXNcbiIsIHF1ZXJ5KTsKLS0tCj4gCQkJCSAgICAic3FsX2F1eHByb3AgcGx1Z2luIGRvaW5nIHF1
ZXJ5ICVzXG4iLCBxdWVyeSk7CjExNTcsMTE1OGMxMTk2LDExOTcKPCAJc3FsX2V4aXN0cyhzZXR0
aW5ncy0+c3FsX2luc2VydCkgJiYKPCAJc3FsX2V4aXN0cyhzZXR0aW5ncy0+c3FsX3VwZGF0ZSkp
IHJldHVybiBTQVNMX09LOwotLS0KPiAJc3FsX2V4aXN0cyhzZXR0aW5ncy0+c3FsX2F1eHByb3Bf
aW5zZXJ0KSAmJgo+IAlzcWxfZXhpc3RzKHNldHRpbmdzLT5zcWxfYXV4cHJvcF91cGRhdGUpKSBy
ZXR1cm4gU0FTTF9PSzsKMTIyNmMxMjY1CjwgCXN0YXRlbWVudCA9IHNxbF9jcmVhdGVfc3RhdGVt
ZW50KHNldHRpbmdzLT5zcWxfc2VsZWN0LAotLS0KPiAJc3RhdGVtZW50ID0gc3FsX2NyZWF0ZV9z
dGF0ZW1lbnQoc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3NlbGVjdCwKMTIzM2MxMjcyCjwgCSAgICBj
bWQgPSBzZXR0aW5ncy0+c3FsX3VwZGF0ZTsKLS0tCj4gCSAgICBjbWQgPSBzZXR0aW5ncy0+c3Fs
X2F1eHByb3BfdXBkYXRlOwoxMjM2YzEyNzUKPCAJICAgIGNtZCA9IHNldHRpbmdzLT5zcWxfaW5z
ZXJ0OwotLS0KPiAJICAgIGNtZCA9IHNldHRpbmdzLT5zcWxfYXV4cHJvcF9pbnNlcnQ7CjEyOTVk
MTMzMwo8IAoxMzA4YTEzNDcsMTU0NQo+IAo+IHN0YXRpYyBpbnQKPiBzcWxfY2Fub25fc2VydmVy
ICh2b2lkICpnbG9iX2NvbnRleHQsCj4gCQkJICAgICAgIHNhc2xfc2VydmVyX3BhcmFtc190ICog
c3BhcmFtcywKPiAJCQkgICAgICAgY29uc3QgY2hhciAqdXNlciwgdW5zaWduZWQgdWxlbiwKPiAJ
CQkgICAgICAgdW5zaWduZWQgZmxhZ3MgX19hdHRyaWJ1dGVfXygodW51c2VkKSksCj4gCQkJICAg
ICAgIGNoYXIgKm91dF91c2VyLAo+IAkJCSAgICAgICB1bnNpZ25lZCBvdXRfdW1heCwgdW5zaWdu
ZWQgKm91dF91bGVuKQo+IHsKPiAgIHNwYXJhbXMtPnV0aWxzLT5zZXRlcnJvciAoc3BhcmFtcy0+
dXRpbHMtPmNvbm4sIDAsICJzcWxfY2Fub25fc2VydmVyIik7Cj4gCj4gICBjaGFyICp1c2VyaWQg
PSBOVUxMOwo+ICAgLyogcmVhbG0gY291bGQgYmUgdXNlZCBmb3Igc29tZXRoaW5nIGNsZXZlciAq
Lwo+ICAgY2hhciAqcmVhbG0gPSBOVUxMOwo+ICAgY29uc3QgY2hhciAqdXNlcl9yZWFsbSA9IE5V
TEw7Cj4gICBjaGFyIHZhbHVlWzgxOTJdOwo+ICAgc2l6ZV90IHZhbHVlX2xlbjsKPiAgIGNoYXIg
b2xkX3ZhbHVlWzgxOTJdOwo+ICAgc2l6ZV90IG9sZF92YWx1ZV9sZW47Cj4gICBjaGFyICpxdWVy
eSA9IE5VTEw7Cj4gICBjaGFyICplc2NhcF91c2VyaWQgPSBOVUxMOwo+ICAgY2hhciAqZXNjYXBf
cmVhbG0gPSBOVUxMOwo+ICAgc3FsX3NldHRpbmdzX3QgKnNldHRpbmdzOwo+ICAgdm9pZCAqY29u
biA9IE5VTEw7Cj4gICB1bnNpZ25lZCBpOwo+ICAgY2hhciAqaW5fYnVmLCAqdXNlcmluOwo+ICAg
Y29uc3QgY2hhciAqYmVnaW5fdTsKPiAgIHNpemVfdCB1X2FwcHJlYWxtID0gMDsKPiAKPiAgIGlm
ICghZ2xvYl9jb250ZXh0IHx8ICFzcGFyYW1zLT51dGlscyB8fCAhdXNlcikKPiAgICAgcmV0dXJu
IFNBU0xfQkFEUEFSQU07Cj4gCj4gICAgIHNwYXJhbXMtPnV0aWxzLT5sb2coTlVMTCwgU0FTTF9M
T0dfREVCVUcsCj4gICAgICAgICAgICAgICAgICAgICAgICAgInNxbF9jYW5vbl9zZXJ2ZXIgUGFy
c2UgdGhlIHVzZXJuYW1lICVzXG4iLCB1c2VyKTsKPiAKPiAKPiAgIGluX2J1ZiA9IHNwYXJhbXMt
PnV0aWxzLT5tYWxsb2MgKCh1bGVuICsgMikgKiBzaXplb2YgKGNoYXIpKTsKPiAgIGlmICghaW5f
YnVmKQo+ICAgICByZXR1cm4gU0FTTF9OT01FTTsKPiAKPiAgIHVzZXJpbiA9IGluX2J1ZjsKPiAK
PiAgIG1lbWNweSAodXNlcmluLCB1c2VyLCB1bGVuKTsKPiAgIHVzZXJpblt1bGVuXSA9ICdcMCc7
Cj4gCj4gCj4gICBmb3IgKGkgPSAwOyBpc3NwYWNlICgoaW50KSB1c2VyaW5baV0pICYmIGkgPCB1
bGVuOyBpKyspOwo+ICAgYmVnaW5fdSA9ICYodXNlcmluW2ldKTsKPiAgIGlmIChpID4gMCkKPiAg
ICAgdWxlbiAtPSBpOwo+IAo+ICAgZm9yICg7IHVsZW4gPiAwICYmIGlzc3BhY2UgKChpbnQpIGJl
Z2luX3VbdWxlbiAtIDFdKTsgdWxlbi0tKTsKPiAgIGlmIChiZWdpbl91ID09ICYodXNlcmluW3Vs
ZW5dKSkKPiAgICAgewo+ICAgICAgIHNwYXJhbXMtPnV0aWxzLT5mcmVlIChpbl9idWYpOwo+ICAg
ICAgIHNwYXJhbXMtPnV0aWxzLT5zZXRlcnJvciAoc3BhcmFtcy0+dXRpbHMtPmNvbm4sIDAsCj4g
CQkJCSJBbGwtd2hpdGVzcGFjZSB1c2VybmFtZS4iKTsKPiAgICAgICByZXR1cm4gU0FTTF9GQUlM
Owo+ICAgICB9Cj4gCj4gICAvKiBOZWVkIHRvIGFwcGVuZCByZWFsbSBpZiBuZWNlc3NhcnkgKHNl
ZSBzYXNsLmgpICovCj4gICBpZiAoc3BhcmFtcy0+dXNlcl9yZWFsbSkKPiAgICAgewo+ICAgICAg
IHVzZXJfcmVhbG0gPSBzcGFyYW1zLT51c2VyX3JlYWxtOwo+ICAgICB9Cj4gICBlbHNlCj4gICAg
IHsKPiAgICAgICB1c2VyX3JlYWxtID0gc3BhcmFtcy0+c2VydmVyRlFETjsKPiAgICAgfQo+IAo+
ICAgaWYgKCFzdHJjaHIgKHVzZXIsICdAJykpCj4gICAgIHsKPiAgICAgICB1X2FwcHJlYWxtID0g
c3RybGVuICh1c2VyX3JlYWxtKSArIDE7Cj4gICAgIH0KPiAKPiAgIC8qIHNldHVwIHRoZSBzZXR0
aW5ncyAqLwo+ICAgc2V0dGluZ3MgPSAoc3FsX3NldHRpbmdzX3QgKikgZ2xvYl9jb250ZXh0Owo+
IAo+ICAgLyoganVzdCBuZWVkIHRvIGVzY2FwZSB1c2VyaWQgYW5kIHJlYWxtIG5vdyAqLwo+ICAg
LyogYWxsb2NhdGUgc29tZSBtZW1vcnkgKi8KPiAgIGVzY2FwX3VzZXJpZCA9IChjaGFyICopIHNw
YXJhbXMtPnV0aWxzLT5tYWxsb2MgKDI1NSk7Cj4gICBlc2NhcF9yZWFsbSA9IChjaGFyICopIHNw
YXJhbXMtPnV0aWxzLT5tYWxsb2MgKDI1NSk7Cj4gCj4gICBpZiAoIWVzY2FwX3VzZXJpZCB8fCAh
ZXNjYXBfcmVhbG0pCj4gICAgIHsKPiAgICAgICBzcGFyYW1zLT51dGlscy0+bG9nIChOVUxMLCBT
QVNMX0xPR19ERUJVRywKPiAJCQkgICAic3FsX2Nhbm9uX3NlcnZlcjogbWVtZXJyb3IgXG4iKTsK
PiAgICAgICBNRU1FUlJPUiAoc3BhcmFtcy0+dXRpbHMpOwo+ICAgICAgIGdvdG8gZG9uZTsKPiAg
ICAgfQo+IAo+ICAgY29ubiA9IHNxbF9jb25uZWN0IChzZXR0aW5ncywgc3BhcmFtcy0+dXRpbHMp
Owo+ICAgaWYgKCFjb25uKQo+ICAgICB7Cj4gICAgICAgc3BhcmFtcy0+dXRpbHMtPmxvZyAoTlVM
TCwgU0FTTF9MT0dfRVJSLAo+IAkJCSAgICJzcWxfY2Fub25fc2VydmVyIGNvdWxkbid0IGNvbm5l
Y3QgdG8gYW55IGhvc3RcbiIpOwo+ICAgICAgIGdvdG8gZG9uZTsKPiAgICAgfQo+IAo+ICAgLyog
ZXNjYXBlIG91dCAqLwo+ICAgc2V0dGluZ3MtPnNxbF9lbmdpbmUtPnNxbF9lc2NhcGVfc3RyIChl
c2NhcF91c2VyaWQsIHVzZXJpbik7Cj4gICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+c3FsX2VzY2Fw
ZV9zdHIgKGVzY2FwX3JlYWxtLCB1c2VyX3JlYWxtKTsKPiAKPiAgIC8qIGNyZWF0ZSBhIHN0YXRl
bWVudCB0aGF0IHdlIHdpbGwgdXNlICovCj4gICBzcGFyYW1zLT51dGlscy0+bG9nKE5VTEwsIFNB
U0xfTE9HX0RFQlVHLAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic3FsX2Nhbm9uIHBs
dWdpbiBjcmVhdGUgc3RhdGVtZW50IGZyb20gJXMgJXNcbiIsCj4gICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGVzY2FwX3VzZXJpZCwgZXNjYXBfcmVhbG0pOwo+IAo+ICAgcXVlcnkgPSBzcWxf
Y3JlYXRlX3N0YXRlbWVudCAoc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QsCj4gCQkJCWVzY2Fw
X3VzZXJpZCwgZXNjYXBfdXNlcmlkLAo+IAkJCQllc2NhcF9yZWFsbSwgTlVMTCwgc3BhcmFtcy0+
dXRpbHMpOwo+ICAgbWVtY3B5KG9sZF92YWx1ZSx1c2VyaW4sIHN0cmxlbiAodXNlcmluKSk7Cj4g
ICBvbGRfdmFsdWVfbGVuID0gc3RybGVuICh1c2VyaW4pOwo+ICAgLyogcnVuIHRoZSBxdWVyeSAq
Lwo+ICAgc3BhcmFtcy0+dXRpbHMtPmxvZyhOVUxMLCBTQVNMX0xPR19ERUJVRywKPiAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgInNxbF9jYW5vbiBwbHVnaW4gZG9pbmcgcXVlcnkgJXNcbiIs
IHF1ZXJ5KTsKPiAKPiAgIHdoaWxlICghc2V0dGluZ3MtPnNxbF9lbmdpbmUtPnNxbF9leGVjIChj
b25uLCBxdWVyeSwgdmFsdWUsIHNpemVvZiAodmFsdWUpLAo+IAkJCQkgICAgICAgJnZhbHVlX2xl
biwgc3BhcmFtcy0+dXRpbHMpKQo+ICAgICB7Cj4gICAgICAgICBtZW1jcHkob2xkX3ZhbHVlLHZh
bHVlLHZhbHVlX2xlbik7Cj4gICAgICAgICBvbGRfdmFsdWVfbGVuPXZhbHVlX2xlbjsKPiAgICAg
ICAgIHNldHRpbmdzLT5zcWxfZW5naW5lLT5zcWxfZXNjYXBlX3N0ciAoZXNjYXBfdXNlcmlkLCB2
YWx1ZSk7Cj4gICAgICAgICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+c3FsX2VzY2FwZV9zdHIgKGVz
Y2FwX3JlYWxtLCB1c2VyX3JlYWxtKTsKPiAgICAgICAgIHNwYXJhbXMtPnV0aWxzLT5sb2coTlVM
TCwgU0FTTF9MT0dfREVCVUcsCj4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzcWxfY2Fu
b24gcGx1Z2luIGNyZWF0ZSBzdGF0ZW1lbnQgZnJvbSAlcyAlc1xuIiwKPiAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgZXNjYXBfdXNlcmlkLCBlc2NhcF9yZWFsbSk7Cj4gCj4gICAvKiBjcmVh
dGUgYSBzdGF0ZW1lbnQgdGhhdCB3ZSB3aWxsIHVzZSAqLwo+ICAgICAgICAgcXVlcnkgPSBzcWxf
Y3JlYXRlX3N0YXRlbWVudCAoc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QsCj4gCQkJCWVzY2Fw
X3VzZXJpZCwgZXNjYXBfdXNlcmlkLAo+IAkJCQllc2NhcF9yZWFsbSwgTlVMTCwgc3BhcmFtcy0+
dXRpbHMpOwo+ICAgICAgICBzcGFyYW1zLT51dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX0RFQlVH
LAo+ICAgICAgICAgICAgICAgICAgICAgICAgICAgICAic3FsX2Nhbm9uIHBsdWdpbiBkb2luZyBx
dWVyeSAlc1xuIiwgcXVlcnkpOwo+IAo+IAl9Cj4gICAgICAgaWYgKG9sZF92YWx1ZV9sZW4gPCBv
dXRfdW1heCkKPiAJewo+IAkgIG1lbWNweSAob3V0X3VzZXIsIG9sZF92YWx1ZSwgb2xkX3ZhbHVl
X2xlbik7Cj4gCSAgb3V0X3VzZXJbb2xkX3ZhbHVlX2xlbl0gPSAnXDAnOwo+IAkgICpvdXRfdWxl
biA9IG9sZF92YWx1ZV9sZW47IAo+ICAgICB9Cj4gICAgICAgZWxzZQo+IAl7Cj4gCSAgTUVNRVJS
T1IgKHNwYXJhbXMtPnV0aWxzKTsKPiAJICBnb3RvIGRvbmU7Cj4gICAgIH0KPiAgIHNwYXJhbXMt
PnV0aWxzLT5mcmVlIChxdWVyeSk7Cj4gCj4gZG9uZToKPiAgIGlmIChlc2NhcF91c2VyaWQpCj4g
ICAgIHNwYXJhbXMtPnV0aWxzLT5mcmVlIChlc2NhcF91c2VyaWQpOwo+ICAgaWYgKGVzY2FwX3Jl
YWxtKQo+ICAgICBzcGFyYW1zLT51dGlscy0+ZnJlZSAoZXNjYXBfcmVhbG0pOwo+ICAgaWYgKGNv
bm4pCj4gICAgIHNldHRpbmdzLT5zcWxfZW5naW5lLT5zcWxfY2xvc2UgKGNvbm4pOwo+ICAgaWYg
KHVzZXJpZCkKPiAgICAgc3BhcmFtcy0+dXRpbHMtPmZyZWUgKHVzZXJpZCk7Cj4gICBpZiAocmVh
bG0pCj4gICAgIHNwYXJhbXMtPnV0aWxzLT5mcmVlIChyZWFsbSk7Cj4gICByZXR1cm4gU0FTTF9P
SzsKPiB9Cj4gCj4gc3RhdGljIGludAo+IHNxbF9jYW5vbl9jbGllbnQodm9pZCAqZ2xvYl9jb250
ZXh0IF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAo+IAkJICAgIHNhc2xfY2xpZW50X3BhcmFtc190
ICpjcGFyYW1zLAo+IAkJICAgIGNvbnN0IGNoYXIgKnVzZXIsCj4gCQkgICAgdW5zaWduZWQgdWxl
biwKPiAJCSAgICB1bnNpZ25lZCBmbGFncyBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKPiAJCSAg
ICBjaGFyICpvdXQsCj4gCQkgICAgdW5zaWduZWQgb3V0X21heCwKPiAJCSAgICB1bnNpZ25lZCAq
b3V0X3VsZW4pewo+ICAgICBpZighY3BhcmFtcyB8fCAhdXNlcikgcmV0dXJuIFNBU0xfQkFEUEFS
QU07Cj4gCj4gICAgIC8qIFRyaW0gd2hpdGVzcGFjZSAqLwo+ICAgICB3aGlsZShpc3NwYWNlKCoo
dW5zaWduZWQgY2hhciAqKXVzZXIpKSB7Cj4gCXVzZXIrKzsKPiAJdWxlbi0tOwo+ICAgICB9Cj4g
ICAgIHdoaWxlKGlzc3BhY2UoKHVuc2lnbmVkIGNoYXIpdXNlclt1bGVuLTFdKSkgewo+ICAgICAJ
dWxlbi0tOwo+ICAgICB9Cj4gCj4gICAgIGlmICghdWxlbikgewo+ICAgICAJY3BhcmFtcy0+dXRp
bHMtPnNldGVycm9yKGNwYXJhbXMtPnV0aWxzLT5jb25uLCAwLAo+IAkgICAgIkFsbC13aGl0ZXNw
YWNlIHVzZXJuYW1lLiIpOwo+IAlyZXR1cm4gU0FTTF9GQUlMOwo+ICAgICB9Cj4gICAgIGlmICh1
bGVuPm91dF9tYXgpIHJldHVybiBTQVNMX0JVRk9WRVI7Cj4gICAgIG1lbWNweShvdXQsIHVzZXIs
IHVsZW4pOwo+ICAgICBvdXRbdWxlbl0gPSAnXDAnOwo+ICAgICAqb3V0X3VsZW4gPSB1bGVuOwo+
ICAgICByZXR1cm4gU0FTTF9PSzsKPiB9Cj4gCj4gCj4gCj4gCj4gCjEzNDYsMTM0N2MxNTgzLDE1
ODQKPCAgICAgaWYgKCFzcWxfZXhpc3RzKHNldHRpbmdzLT5zcWxfc2VsZWN0KSkgewo8IAl1dGls
cy0+bG9nKE5VTEwsIFNBU0xfTE9HX0VSUiwgInNxbF9zZWxlY3Qgb3B0aW9uIG1pc3NpbmciKTsK
LS0tCj4gICAgIGlmICghc3FsX2V4aXN0cyhzZXR0aW5ncy0+c3FsX2F1eHByb3Bfc2VsZWN0KSkg
ewo+IAl1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX0VSUiwgInNxbF9hdXhwcm9wX3NlbGVjdCBv
cHRpb24gbWlzc2luZyIpOwoxMzUzLDEzNTRjMTU5MCwxNTkxCjwgCSAgICAgICAic3FsIGF1eHBy
b3AgcGx1Z2luIHVzaW5nICVzIGVuZ2luZVxuIiwKPCAJICAgICAgIHNldHRpbmdzLT5zcWxfZW5n
aW5lLT5uYW1lKTsKLS0tCj4gCSAgICAgICJzcWxfYXV4cHJvcF9wbHVnaW4gdXNpbmcgJXMgZW5n
aW5lIHdpdGggc2VsZWN0OiAlc1xuIiwKPiAJICAgICAgc2V0dGluZ3MtPnNxbF9lbmdpbmUtPm5h
bWUsIHNldHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxlY3QpOwoxMzU5YTE1OTcsMTY2MQo+IHN0YXRp
YyBzYXNsX2Nhbm9udXNlcl9wbHVnX3Qgc3FsX2Nhbm9udXNlcl9wbHVnaW4gPSB7Cj4gCTAsCS8q
IGZlYXR1cmVzICovCj4gCTAsCS8qIHNwYXJlICovCj4gCU5VTEwsCS8qIGdsb2JfY29udGV4dCAq
Lwo+IAkic3FsIiwJLyogbmFtZSAqLwo+IAlzcWxfYXV4cHJvcF9mcmVlLAkvKiBjYW5vbl91c2Vy
X2ZyZWUgKi8KPiAJc3FsX2Nhbm9uX3NlcnZlciwJLyogY2Fub25fdXNlcl9zZXJ2ZXIgKi8KPiAJ
c3FsX2Nhbm9uX2NsaWVudCwJLyogY2Fub25fdXNlcl9jbGllbnQgKi8KPiAJTlVMTCwKPiAJTlVM
TCwKPiAJTlVMTAo+IH07Cj4gCj4gaW50Cj4gc3FsX2Nhbm9udXNlcl9wbHVnX2luaXQgKGNvbnN0
IHNhc2xfdXRpbHNfdCAqIHV0aWxzCj4gCQkJCSAgX19hdHRyaWJ1dGVfXyAoKHVudXNlZCkpLCBp
bnQgbWF4X3ZlcnNpb24sCj4gCQkJCSAgaW50ICpvdXRfdmVyc2lvbiwKPiAJCQkJICBzYXNsX2Nh
bm9udXNlcl9wbHVnX3QgKiogcGx1ZywKPiAJCQkJICBjb25zdCBjaGFyICpwbHVnbmFtZQo+IAkJ
CQkgIF9fYXR0cmlidXRlX18gKCh1bnVzZWQpKSkKPiB7Cj4gICBzcWxfc2V0dGluZ3NfdCAqc2V0
dGluZ3M7Cj4gCj4gICBpZiAoIW91dF92ZXJzaW9uIHx8ICFwbHVnKQo+ICAgICByZXR1cm4gU0FT
TF9CQURQQVJBTTsKPiAKPiAgIGlmIChtYXhfdmVyc2lvbiA8IFNBU0xfQ0FOT05VU0VSX1BMVUdf
VkVSU0lPTikKPiAgICAgcmV0dXJuIFNBU0xfQkFEVkVSUzsKPiAKPiAgICpvdXRfdmVyc2lvbiA9
IFNBU0xfQ0FOT05VU0VSX1BMVUdfVkVSU0lPTjsKPiAKPiAgIHNldHRpbmdzID0gKHNxbF9zZXR0
aW5nc190ICopIHV0aWxzLT5tYWxsb2MgKHNpemVvZiAoc3FsX3NldHRpbmdzX3QpKTsKPiAKPiAg
IGlmICghc2V0dGluZ3MpCj4gICAgIHsKPiAgICAgICBNRU1FUlJPUiAodXRpbHMpOwo+ICAgICAg
IHJldHVybiBTQVNMX05PTUVNOwo+ICAgICB9Cj4gCj4gICBtZW1zZXQgKHNldHRpbmdzLCAwLCBz
aXplb2YgKHNxbF9zZXR0aW5nc190KSk7Cj4gICBzcWxfZ2V0X3NldHRpbmdzICh1dGlscywgc2V0
dGluZ3MpOwo+IAo+ICAgaWYgKCFzZXR0aW5ncy0+c3FsX2VuZ2luZS0+bmFtZSkKPiAgICAgcmV0
dXJuIFNBU0xfTk9NRUNIOwo+IAo+ICAgaWYgKCFzcWxfZXhpc3RzIChzZXR0aW5ncy0+c3FsX2Nh
bm9uX3NlbGVjdCkpCj4gICAgIHsKPiAgICAgICB1dGlscy0+bG9nIChOVUxMLCBTQVNMX0xPR19F
UlIsCj4gCQkgICJzcWxfY2Fub25fcGx1Z2luOiBzcWxfY2Fub25fc2VsZWN0IG9wdGlvbiBtaXNz
aW5nIik7Cj4gICAgICAgdXRpbHMtPmZyZWUgKHNldHRpbmdzKTsKPiAgICAgICByZXR1cm4gU0FT
TF9OT01FQ0g7Cj4gICAgIH0KPiAKPiAgIHV0aWxzLT5sb2cgKE5VTEwsIFNBU0xfTE9HX0RFQlVH
LAo+IAkgICAgICAic3FsX2Nhbm9uX3BsdWdpbiB1c2luZyAlcyBlbmdpbmUgd2l0aCBzZWxlY3Q6
ICVzXG4iLAo+IAkgICAgICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+bmFtZSwgc2V0dGluZ3MtPnNx
bF9jYW5vbl9zZWxlY3QpOwo+IAo+ICAgc3FsX2Nhbm9udXNlcl9wbHVnaW4uZ2xvYl9jb250ZXh0
ID0gc2V0dGluZ3M7Cj4gCj4gCj4gCj4gICAqcGx1ZyA9ICZzcWxfY2Fub251c2VyX3BsdWdpbjsK
PiAKPiAgIHJldHVybiBTQVNMX09LOwo+IH0KZGlmZiAtcncgY3lydXMtc2FzbC0yLjEuMjQvcGx1
Z2lucy9zcWxfaW5pdC5jIGN5cnVzLXNhc2wtMi4xLjI0LXNxbC9wbHVnaW5zL3NxbF9pbml0LmMK
MzhhMzkKPiBTQVNMX0NBTk9OVVNFUl9QTFVHX0lOSVQoIHNxbCApCg==
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1484</attachid>
            <date>2012-06-20 00:25 EDT</date>
            <desc>patch against current git</desc>
            <filename>sasl-mysql-canon-git.patch</filename>
            <type>text/plain</type>
            <size>20622</size>
            <attacher>lars.duesing@camelotsweb.de</attacher>
            
              <data encoding="base64">ZGlmZiAtLWdpdCBhL2RvYy9vcHRpb25zLmh0bWwgYi9kb2Mvb3B0aW9ucy5odG1sCmluZGV4IDRm
MTk1ZjcuLjc0ZWVkNzIgMTAwNjQ0Ci0tLSBhL2RvYy9vcHRpb25zLmh0bWwKKysrIGIvZG9jL29w
dGlvbnMuaHRtbApAQCAtMTc0LDIyICsxNzQsNTEgQEAgY2FjaGVkIGZvciBhIGZhc3QgcmVhdXRo
LiAgQSB2YWx1ZSBvZiAwIHdpbGwgZGlzYWJsZSByZWF1dGguPC9URD4KIDxURD48aT5ub25lPC9p
PiAoZW5naW5lIGRlcGVuZGVudCk8L1REPgogPC9UUj4KIDxUUj4KKzxURD5zcWxfYXV4cHJvcF9z
ZWxlY3Q8L1REPjxURD5TUUwgcGx1Z2luPC9URD4KKzxURD5TRUxFQ1Qgc3RhdGVtZW50IHRvIHVz
ZSBmb3IgZmV0Y2hpbmcgcHJvcGVydGllcy4gIFRoaXMgb3B0aW9uIGlzCis8Yj5yZXF1aXJlZDwv
Yj4gaW4gb3JkZXIgdG8gdXNlIHRoZSBTUUwgYXV4cHJvcCBwbHVnaW4uPC9URD4KKzxURD48aT5u
b25lPC9pPjwvVEQ+Cis8L1RSPgorPFRSPgogPFREPnNxbF9zZWxlY3Q8L1REPjxURD5TUUwgcGx1
Z2luPC9URD4KKzxURD5TRUxFQ1Qgc3RhdGVtZW50IHRvIHVzZSBmb3IgZmV0Y2hpbmcgcHJvcGVy
dGllcy4gPGI+RGVwcmVjYXRlZDwvYj4gYWxpYXMgZm9yIHNxbF9hdXhwcm9wX3NlbGVjdC4gVGhp
cyBvcHRpb24gaXMKKzxiPnJlcXVpcmVkPC9iPiBpbiBvcmRlciB0byB1c2UgdGhlIFNRTCBhdXhw
cm9wIHBsdWdpbi48L1REPgorPFREPjxpPm5vbmU8L2k+PC9URD4KKzwvVFI+Cis8VFI+Cis8VEQ+
c3FsX3N0YXRlbWVudDwvVEQ+PFREPlNRTCBwbHVnaW48L1REPgorPFREPlNFTEVDVCBzdGF0ZW1l
bnQgdG8gdXNlIGZvciBmZXRjaGluZyBwcm9wZXJ0aWVzLiA8Yj5EZXByZWNhdGVkPC9iPiBhbGlh
cyBmb3Igc3FsX2F1eHByb3Bfc2VsZWN0LiBUaGlzIG9wdGlvbiBpcworPGI+cmVxdWlyZWQ8L2I+
IGluIG9yZGVyIHRvIHVzZSB0aGUgU1FMIGF1eHByb3AgcGx1Z2luLjwvVEQ+Cis8VEQ+PGk+bm9u
ZTwvaT48L1REPgorPC9UUj4KKzxUUj4KKzxURD5zcWxfY2Fub25fc2VsZWN0PC9URD48VEQ+U1FM
IHBsdWdpbjwvVEQ+CiA8VEQ+U0VMRUNUIHN0YXRlbWVudCB0byB1c2UgZm9yIGZldGNoaW5nIHBy
b3BlcnRpZXMuICBUaGlzIG9wdGlvbiBpcwotPGI+cmVxdWlyZWQ8L2I+IGluIG9yZGVyIHRvIHVz
ZSB0aGUgU1FMIHBsdWdpbi48L1REPgorPGI+cmVxdWlyZWQ8L2I+IGluIG9yZGVyIHRvIHVzZSB0
aGUgU1FMIGNhbm9uIHBsdWdpbi48L1REPgogPFREPjxpPm5vbmU8L2k+PC9URD4KIDwvVFI+CiA8
VFI+Ci08VEQ+c3FsX2luc2VydDwvVEQ+PFREPlNRTCBwbHVnaW48L1REPgorPFREPnNxbF9hdXhw
cm9wX2luc2VydDwvVEQ+PFREPlNRTCBwbHVnaW48L1REPgogPFREPklOU0VSVCBzdGF0ZW1lbnQg
dG8gdXNlIGZvciBjcmVhdGluZyBwcm9wZXJ0aWVzIGZvciBuZXcgdXNlcnMuPC9URD4KIDxURD48
aT5ub25lPC9pPjwvVEQ+CiA8L1RSPgogPFRSPgotPFREPnNxbF91cGRhdGU8L1REPjxURD5TUUwg
cGx1Z2luPC9URD4KKzxURD5zcWxfaW5zZXJ0PC9URD48VEQ+U1FMIHBsdWdpbjwvVEQ+Cis8VEQ+
SU5TRVJUIHN0YXRlbWVudCB0byB1c2UgZm9yIGNyZWF0aW5nIHByb3BlcnRpZXMgZm9yIG5ldyB1
c2Vycy4gPGI+RGVwcmVjYXRlZDwvYj4gYWxpYXMgZm9yIHNxbF9hdXhwcm9wX2luc2VydC48L1RE
PgorPFREPjxpPm5vbmU8L2k+PC9URD4KKzwvVFI+Cis8VFI+Cis8VEQ+c3FsX2F1eHByb3BfdXBk
YXRlPC9URD48VEQ+U1FMIHBsdWdpbjwvVEQ+CiA8VEQ+VVBEQVRFIHN0YXRlbWVudCB0byB1c2Ug
Zm9yIG1vZGlmeWluZyBwcm9wZXJ0aWVzLjwvVEQ+CiA8VEQ+PGk+bm9uZTwvaT48L1REPgogPC9U
Uj4KIDxUUj4KKzxUUj4KKzxURD5zcWxfdXBkYXRlPC9URD48VEQ+U1FMIHBsdWdpbjwvVEQ+Cis8
VEQ+VVBEQVRFIHN0YXRlbWVudCB0byB1c2UgZm9yIG1vZGlmeWluZyBwcm9wZXJ0aWVzLiA8Yj5E
ZXByZWNhdGVkPC9iPiBhbGlhcyBmb3Igc3FsX2F1eHByb3BfdXBkYXRlPC9URD4KKzxURD48aT5u
b25lPC9pPjwvVEQ+Cis8L1RSPgorPFRSPgogPFREPnNxbF91c2Vzc2w8L1REPjxURD5TUUwgcGx1
Z2luPC9URD4KIDxURD5XaGVuIHNldCB0byAneWVzJywgJ29uJywgJzEnIG9yICd0cnVlJywgYSBz
ZWN1cmUgY29ubmVjdGlvbiB3aWxsCiBiZSBtYWRlIHRvIHRoZSBTUUwgc2VydmVyLjwvVEQ+CkBA
IC0yMDksMTUgKzIzOCwxNSBAQCBkZXBlbmRhbnQpPC9URD4KIAogPGgyPk5vdGVzIG9uIFNRTCBh
dXhwcm9wIG9wdGlvbnM8L2gyPgogCi08cD5UaGUgPHR0PnNxbF9pbnNlcnQ8L3R0PiBhbmQgPHR0
PnNxbF91cGRhdGU8L3R0PiBvcHRpb25zIGFyZQorPHA+VGhlIDx0dD5zcWxfYXV4cHJvcF9pbnNl
cnQ8L3R0PiBhbmQgPHR0PnNxbF9hdXhwcm9wX3VwZGF0ZTwvdHQ+IG9wdGlvbnMgYXJlCiBvcHRp
b25hbCBhbmQgYXJlIG9ubHkgbmVlZGVkIGlmIHlvdSB3aXNoIHRvIGFsbG93IHRoZSBTQVNMIGxp
YnJhcnkKIChlLmcuLCBzYXNscGFzc3dkMikgYW5kIHBsdWdpbnMgKGUuZy4sIE9UUCkgdG8gd3Jp
dGUgcHJvcGVydGllcyB0byB0aGUKIFNRTCBzZXJ2ZXIuICBJZiB1c2VkLCBib3RoIHN0YXRlbWVu
dHMgTVVTVCBiZSBwcm92aWRlZCBzbyB0aGF0CiBwcm9wZXJ0aWVzIGNhbiBiZSBhZGRlZCwgY2hh
bmdlZCBhbmQgZGVsZXRlZC4KIDxmb250IGNvbG9yPXJlZD5OT1RFOiBUaGUgY29sdW1ucyBmb3Ig
d3JpdGFibGUgcHJvcGVyaXRlcyBNVVNUIGFjY2VwdCBOVUxMIHZhbHVlcy48L2ZvbnQ+CiAKLTxw
PlRoZSBTUUwgc3RhdGVtZW50cyBwcm92aWRlZCBpbiB0aGUgPHR0PnNxbF9zZWxlY3Q8L3R0PiwK
LTx0dD5zcWxfaW5zZXJ0PC90dD4gYW5kIDx0dD5zcWxfdXBkYXRlPC90dD4gb3B0aW9ucyBjYW4g
Y29udGFpbgorPHA+VGhlIFNRTCBzdGF0ZW1lbnRzIHByb3ZpZGVkIGluIHRoZSA8dHQ+c3FsX2F1
eHByb3Bfc2VsZWN0PC90dD4sCis8dHQ+c3FsX2F1eHByb3BfaW5zZXJ0PC90dD4gYW5kIDx0dD5z
cWxfYXV4cHJvcF91cGRhdGU8L3R0PiBvcHRpb25zIGNhbiBjb250YWluCiBhcmd1bWVudHMgd2hp
Y2ggd2lsbCBiZSBzdWJzdGl0dXRlZCB3aXRoIHRoZSBhcHByb3ByaWF0ZSB2YWx1ZXMuICBUaGUK
IHZhbGlkIGFyZ3VtZW50cyBhcmU6CiAKQEAgLTI0Nyw3ICsyNzYsNyBAQCBxdW90ZWQuPC9mb250
PgogPGgzPkV4YW1wbGVzOjwvaDM+CiAKIDxwcmU+Ci0gICAgIDx0dD5zcWxfc2VsZWN0OiBTRUxF
Q1QgJXAgRlJPTSB1c2VyX3RhYmxlIFdIRVJFIHVzZXJuYW1lID0gJyV1JyBhbmQgcmVhbG0gPSAn
JXInPC90dD4KKyAgICAgPHR0PnNxbF9hdXhwcm9wX3NlbGVjdDogU0VMRUNUICVwIEZST00gdXNl
cl90YWJsZSBXSEVSRSB1c2VybmFtZSA9ICcldScgYW5kIHJlYWxtID0gJyVyJzwvdHQ+CiA8L3By
ZT4KIAogICAgICB3b3VsZCBzZW5kIHRoZSBmb2xsb3dpbmcgc3RhdGVtZW50IHRvIFNRTCBmb3Ig
dXNlciAiYm92aWsiIGFuZApAQCAtMjYxLDcgKzI5MCw3IEBAIHF1b3RlZC48L2ZvbnQ+CiA8L3By
ZT4KIAogPHByZT4KLSAgICAgPHR0PnNxbF9pbnNlcnQ6IElOU0VSVCBJTlRPIHVzZXJfdGFibGUg
KHVzZXJuYW1lLCByZWFsbSwgJXApIFZBTFVFUyAoJyV1JywgJyVyJywgJyV2Jyk8L3R0PgorICAg
ICA8dHQ+c3FsX2F1eHByb3BfaW5zZXJ0OiBJTlNFUlQgSU5UTyB1c2VyX3RhYmxlICh1c2VybmFt
ZSwgcmVhbG0sICVwKSBWQUxVRVMgKCcldScsICclcicsICcldicpPC90dD4KIAogPC9wcmU+CiAK
QEAgLTI4MSw2ICszMTAsMTcgQEAgcXVvdGVkLjwvZm9udD4KIDwvcHJlPgogaXMgYSB2YWxpZCB2
YWx1ZSBmb3IgPHR0PnNxbF9zZWxlY3Q8L3R0Pi4KIAorPGgyPk5vdGVzIG9uIFNRTCBjYW5vbiB1
c2VyIHBsdWdpbiBvcHRpb25zPC9oMj4KKzxwPlRoaXMgcGx1Z2luIHNoYXJlcyBhbGwgY29uZmln
dXJhdGlvbiB3aXRoIFNRTCBhdXhwcm9wIHBsdWdpbi4gVGhlcmVmb3JlIAoreW91IGhhdmUgdG8g
Z2l2ZSBvcHRpb25zIGxpa2Ugc3FsX2hvc3RuYW1lcyBhbmQgc3FsX3VzZXIgb25seSBvbmNlLgor
PC9wPgorPHA+QWxsIGFib3ZlIGV4YW1wbGVzIGZvciBzcWxfYXV4cHJvcF9zZWxlY3QgYXJlIHZh
bGlkIGZvciBzcWxfY2Fub25fc2VsZWN0LCB0b28uCis8L3A+Cis8cD5OT1RFOiBUaGlzIHBsdWdp
biB0ZXN0cyBmb3IgcmVjdXJzaW9uIDUgaXRlcmF0aW9ucy4gCisoZS5nLiB0ZXN0QHRlc3QubG9j
YWwtPmpvZUB0ZXN0LmxvY2FsLT5kb2VAdGVzdC5sb2NhbC0+dGVzdEB0ZXN0LmxvY2FsLT5qb2VA
dGVzdC5sb2NhbCkKK0FmdGVyIHRoYXQgaXQgc3RvcHMgdGhlIHJlY3Vyc2lvbiBhdCB0aGUgY3Vy
cmVudCBlbGVtZW50IGFuZCBpc3N1ZXMgYSB3YXJuaW5nLgorPC9wPgorCiA8aDI+Tm90ZXMgb24g
TERBUERCIHBsdWdpbiBvcHRpb25zPC9oMj4KIAogPHA+CmRpZmYgLS1naXQgYS9wbHVnaW5zL21h
a2Vpbml0LnNoIGIvcGx1Z2lucy9tYWtlaW5pdC5zaAppbmRleCBjYzY1ZjdkLi5kMDkxZDc0IDEw
MDY0NAotLS0gYS9wbHVnaW5zL21ha2Vpbml0LnNoCisrKyBiL3BsdWdpbnMvbWFrZWluaXQuc2gK
QEAgLTg5LDUgKzg5LDcgQEAgU0FTTF9BVVhQUk9QX1BMVUdfSU5JVCggJGF1eHByb3AgKQogIiA+
ICR7YXV4cHJvcH1faW5pdC5jCiBkb25lCiAKLSMgbGRhcGRiIGlzIGFsc28gYSBjYW5vbl91c2Vy
IHBsdWdpbgorIyBsZGFwZGIgYW5kIHNxbCBhcmUgYWxzbyBjYW5vbl91c2VyIHBsdWdpbnMKIGVj
aG8gIlNBU0xfQ0FOT05VU0VSX1BMVUdfSU5JVCggbGRhcGRiICkiID4+IGxkYXBkYl9pbml0LmMK
K2VjaG8gIlNBU0xfQ0FOT05VU0VSX1BMVUdfSU5JVCggc3FsICkiID4+IHNxbF9pbml0LmMKKwpk
aWZmIC0tZ2l0IGEvcGx1Z2lucy9zcWwuYyBiL3BsdWdpbnMvc3FsLmMKaW5kZXggM2I4OTM4My4u
OTk0YWQzZCAxMDA2NDQKLS0tIGEvcGx1Z2lucy9zcWwuYworKysgYi9wbHVnaW5zL3NxbC5jCkBA
IC0xLDggKzEsOSBAQAogLyoKICoqCi0qKiBTUUwgQXV4cHJvcCBwbHVnaW4KKyoqIFNRTCBBdXhw
cm9wIGFuZCBDYW5vbiBwbHVnaW4KICoqCi0qKiBLZW4gTXVyY2hpc29uCisqKiBMYXJzIER1ZXNp
bmcgLS0gY2Fub24gcGx1Z2luCisqKiBLZW4gTXVyY2hpc29uIC0tIG9yaWdpbmFsIGF1eHByb3Ag
cGx1Z2luCiAqKiBNYXlhIE5pZ3Jvc2ggLS0gb3JpZ2luYWwgc3RvcmUoKSBhbmQgdHhuIHN1cHBv
cnQKICoqIFNpbW9uIExvYWRlciAtLSBvcmlnaW5hbCBteXNxbCBwbHVnaW4KICoqIFBhdHJpY2sg
V2VsY2hlIC0tIG9yaWdpbmFsIHBnc3FsIHBsdWdpbgpAQCAtNTAsOSArNTEsMTAgQEAgdHlwZWRl
ZiBzdHJ1Y3Qgc3FsX3NldHRpbmdzIHsKICAgICBjb25zdCBjaGFyICpzcWxfcGFzc3dkOwogICAg
IGNvbnN0IGNoYXIgKnNxbF9ob3N0bmFtZXM7CiAgICAgY29uc3QgY2hhciAqc3FsX2RhdGFiYXNl
OwotICAgIGNvbnN0IGNoYXIgKnNxbF9zZWxlY3Q7Ci0gICAgY29uc3QgY2hhciAqc3FsX2luc2Vy
dDsKLSAgICBjb25zdCBjaGFyICpzcWxfdXBkYXRlOworICAgIGNvbnN0IGNoYXIgKnNxbF9hdXhw
cm9wX3NlbGVjdDsKKyAgICBjb25zdCBjaGFyICpzcWxfY2Fub25fc2VsZWN0OworICAgIGNvbnN0
IGNoYXIgKnNxbF9hdXhwcm9wX2luc2VydDsKKyAgICBjb25zdCBjaGFyICpzcWxfYXV4cHJvcF91
cGRhdGU7CiAgICAgaW50IHNxbF91c2Vzc2w7CiB9IHNxbF9zZXR0aW5nc190OwogCkBAIC03OTks
MjcgKzgwMSw2NCBAQCBzdGF0aWMgdm9pZCBzcWxfZ2V0X3NldHRpbmdzKGNvbnN0IHNhc2xfdXRp
bHNfdCAqdXRpbHMsIHZvaWQgKmdsb2JfY29udGV4dCkKIAlzZXR0aW5ncy0+c3FsX2RhdGFiYXNl
ID0gU1FMX0JMQU5LX1NUUklORzsKICAgICB9CiAKLSAgICByID0gdXRpbHMtPmdldG9wdCh1dGls
cy0+Z2V0b3B0X2NvbnRleHQsIlNRTCIsICJzcWxfc2VsZWN0IiwKLQkJICAgICAgJnNldHRpbmdz
LT5zcWxfc2VsZWN0LCBOVUxMKTsKLSAgICBpZiAociB8fCAhc2V0dGluZ3MtPnNxbF9zZWxlY3Qg
KSB7CisgICAgciA9IHV0aWxzLT5nZXRvcHQodXRpbHMtPmdldG9wdF9jb250ZXh0LCJTUUwiLCAi
c3FsX2F1eHByb3Bfc2VsZWN0IiwKKwkJICAgICAgJnNldHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxl
Y3QsIE5VTEwpOworICAgIGlmIChyIHx8ICFzZXR0aW5ncy0+c3FsX2F1eHByb3Bfc2VsZWN0ICkg
ewogCS8qIGJhY2t3YXJkcyBjb21wYXRpYmlsaXR5ICovCisJciA9IHV0aWxzLT5nZXRvcHQodXRp
bHMtPmdldG9wdF9jb250ZXh0LCJTUUwiLCAic3FsX3NlbGVjdCIsCisJCQkgICZzZXR0aW5ncy0+
c3FsX2F1eHByb3Bfc2VsZWN0LCBOVUxMKTsKKwlpZiAociB8fCAhc2V0dGluZ3MtPnNxbF9hdXhw
cm9wX3NlbGVjdCkgewogCXIgPSB1dGlscy0+Z2V0b3B0KHV0aWxzLT5nZXRvcHRfY29udGV4dCwi
U1FMIiwgInNxbF9zdGF0ZW1lbnQiLAotCQkJICAmc2V0dGluZ3MtPnNxbF9zZWxlY3QsIE5VTEwp
OwotCWlmIChyIHx8ICFzZXR0aW5ncy0+c3FsX3NlbGVjdCkgewotCSAgICBzZXR0aW5ncy0+c3Fs
X3NlbGVjdCA9IFNRTF9CTEFOS19TVFJJTkc7CisJCQkgICZzZXR0aW5ncy0+c3FsX2F1eHByb3Bf
c2VsZWN0LCBOVUxMKTsKKwkgICAgaWYgKHIgfHwgIXNldHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxl
Y3QpIHsKKwkgICAgICAgIHNldHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxlY3QgPSBTUUxfQkxBTktf
U1RSSU5HOworCSAgICB9IGVsc2UKKyAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICB1dGls
cy0+bG9nKE5VTEwsIFNBU0xfTE9HX1dBUk4sCisJCSAgICJzcWwgcGx1Z2luOiBPcHRpb24gc3Fs
X3N0YXRlbWVudCBpcyBkZXByZWNhdGVkLCB1c2Ugc3FsX2F1eHByb3Bfc2VsZWN0IGluc3RlYWQh
Iik7CisgICAgICAgICAgICB9CisgICAgICAgIH0KKyAgICAgICAgZWxzZQorICAgICAgICB7Cisg
ICAgICAgICAgICB1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX1dBUk4sCisgICAgICAgIAkgICAi
c3FsIHBsdWdpbjogT3B0aW9uIHNxbF9zZWxlY3QgaXMgZGVwcmVjYXRlZCwgdXNlIHNxbF9hdXhw
cm9wX3NlbGVjdCBpbnN0ZWFkISIpOwogCX0KKyAgICAgICAgICAgIAogICAgIH0KIAorICAgIHIg
PSB1dGlscy0+Z2V0b3B0KHV0aWxzLT5nZXRvcHRfY29udGV4dCwgIlNRTCIsICJzcWxfY2Fub25f
c2VsZWN0IiwKKwkJICAgICAgJnNldHRpbmdzLT5zcWxfY2Fub25fc2VsZWN0LCBOVUxMKTsKKyAg
ICBpZiAociB8fCAhc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QpIHsKKwlzZXR0aW5ncy0+c3Fs
X2Nhbm9uX3NlbGVjdCA9IFNRTF9CTEFOS19TVFJJTkc7CisgICAgfQorCisgICAgciA9IHV0aWxz
LT5nZXRvcHQodXRpbHMtPmdldG9wdF9jb250ZXh0LCAiU1FMIiwgInNxbF9hdXhwcm9wX2luc2Vy
dCIsCisJCSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0LCBOVUxMKTsKKyAgICBp
ZiAociB8fCAhc2V0dGluZ3MtPnNxbF9hdXhwcm9wX2luc2VydCkgewogICAgIHIgPSB1dGlscy0+
Z2V0b3B0KHV0aWxzLT5nZXRvcHRfY29udGV4dCwgIlNRTCIsICJzcWxfaW5zZXJ0IiwKLQkJICAg
ICAgJnNldHRpbmdzLT5zcWxfaW5zZXJ0LCBOVUxMKTsKLSAgICBpZiAociB8fCAhc2V0dGluZ3Mt
PnNxbF9pbnNlcnQpIHsKLQlzZXR0aW5ncy0+c3FsX2luc2VydCA9IFNRTF9CTEFOS19TVFJJTkc7
CisJCSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0LCBOVUxMKTsKKyAgICAgICAg
aWYgKHIgfHwgIXNldHRpbmdzLT5zcWxfYXV4cHJvcF9pbnNlcnQpIHsKKwkgICAgc2V0dGluZ3Mt
PnNxbF9hdXhwcm9wX2luc2VydCA9IFNRTF9CTEFOS19TVFJJTkc7CisJfSBlbHNlCisgICAgICAg
IHsKKyAgICAgICAgICAgIHV0aWxzLT5sb2coTlVMTCwgU0FTTF9MT0dfV0FSTiwKKwkJICAgInNx
bCBwbHVnaW46IE9wdGlvbiBzcWxfaW5zZXJ0IGlzIGRlcHJlY2F0ZWQsIHVzZSBzcWxfYXV4cHJv
cF9pbnNlcnQgaW5zdGVhZCEiKTsKKyAgICAgICAgfQorCiAgICAgfQogCisgICAgciA9IHV0aWxz
LT5nZXRvcHQodXRpbHMtPmdldG9wdF9jb250ZXh0LCAiU1FMIiwgInNxbF9hdXhwcm9wX3VwZGF0
ZSIsCisJCSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfdXBkYXRlLCBOVUxMKTsKKyAgICBp
ZiAociB8fCAhc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3VwZGF0ZSkgewogICAgIHIgPSB1dGlscy0+
Z2V0b3B0KHV0aWxzLT5nZXRvcHRfY29udGV4dCwgIlNRTCIsICJzcWxfdXBkYXRlIiwKLQkJICAg
ICAgJnNldHRpbmdzLT5zcWxfdXBkYXRlLCBOVUxMKTsKLSAgICBpZiAociB8fCAhc2V0dGluZ3Mt
PnNxbF91cGRhdGUpIHsKLQlzZXR0aW5ncy0+c3FsX3VwZGF0ZSA9IFNRTF9CTEFOS19TVFJJTkc7
CisJCSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfdXBkYXRlLCBOVUxMKTsKKyAgICAgICAg
aWYgKHIgfHwgIXNldHRpbmdzLT5zcWxfYXV4cHJvcF91cGRhdGUpIHsKKwkgICAgc2V0dGluZ3Mt
PnNxbF9hdXhwcm9wX3VwZGF0ZSA9IFNRTF9CTEFOS19TVFJJTkc7CisgICAgICAgIH0gZWxzZQor
ICAgICAgICB7CisgICAgICAgICAgICB1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX1dBUk4sCisJ
CSAgICJzcWwgcGx1Z2luOiBPcHRpb24gc3FsX3VwZGF0ZSBpcyBkZXByZWNhdGVkLCB1c2Ugc3Fs
X2F1eHByb3BfdXBkYXRlIGluc3RlYWQhIik7CisgICAgICAgIH0KICAgICB9CiAKICAgICByID0g
dXRpbHMtPmdldG9wdCh1dGlscy0+Z2V0b3B0X2NvbnRleHQsICJTUUwiLCAic3FsX3VzZXNzbCIs
CkBAIC05MTgsNyArOTU3LDcgQEAgc3RhdGljIGludCBzcWxfYXV4cHJvcF9sb29rdXAodm9pZCAq
Z2xvYl9jb250ZXh0LAogICAgIHNldHRpbmdzID0gKHNxbF9zZXR0aW5nc190ICopIGdsb2JfY29u
dGV4dDsKICAgICAKICAgICBzcGFyYW1zLT51dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX0RFQlVH
LAotCQkJInNxbCBwbHVnaW4gUGFyc2UgdGhlIHVzZXJuYW1lICVzXG4iLCB1c2VyKTsKKwkJCSJz
cWxfYXV4cHJvcCBwbHVnaW4gUGFyc2UgdGhlIHVzZXJuYW1lICVzXG4iLCB1c2VyKTsKICAgICAK
ICAgICB1c2VyX2J1ZiA9IHNwYXJhbXMtPnV0aWxzLT5tYWxsb2ModWxlbiArIDEpOwogICAgIGlm
ICghdXNlcl9idWYpIHsKQEAgLTk2Nyw3ICsxMDA2LDcgQEAgc3RhdGljIGludCBzcWxfYXV4cHJv
cF9sb29rdXAodm9pZCAqZ2xvYl9jb250ZXh0LAogICAgIGNvbm4gPSBzcWxfY29ubmVjdChzZXR0
aW5ncywgc3BhcmFtcy0+dXRpbHMpOwogICAgIGlmICghY29ubikgewogCXNwYXJhbXMtPnV0aWxz
LT5sb2coTlVMTCwgU0FTTF9MT0dfRVJSLAotCQkJICAgICJzcWwgcGx1Z2luIGNvdWxkbid0IGNv
bm5lY3QgdG8gYW55IGhvc3RcbiIpOworCQkJICAgICJzcWxfYXV4cHJvcCBwbHVnaW4gY291bGRu
J3QgY29ubmVjdCB0byBhbnkgaG9zdFxuIik7CiAJLyogVE9ETzogaW4gdGhlIGZ1dHVyZSB3ZSBt
aWdodCB3YW50IHRvIGV4dGVuZCB0aGUgaW50ZXJuYWwKIAkgICBTUUwgZHJpdmVyIEFQSSB0byBy
ZXR1cm4gYSBtb3JlIGRldGFpbGVkIGVycm9yICovCiAJcmV0ID0gU0FTTF9GQUlMOwpAQCAtMTAy
MiwxMSArMTA2MSwxMSBAQCBzdGF0aWMgaW50IHNxbF9hdXhwcm9wX2xvb2t1cCh2b2lkICpnbG9i
X2NvbnRleHQsCiAJfQogICAgIAogCXNwYXJhbXMtPnV0aWxzLT5sb2coTlVMTCwgU0FTTF9MT0df
REVCVUcsCi0JCQkgICAgInNxbCBwbHVnaW4gY3JlYXRlIHN0YXRlbWVudCBmcm9tICVzICVzICVz
XG4iLAorCQkJICAgICJzcWxfYXV4cHJvcCBwbHVnaW4gY3JlYXRlIHN0YXRlbWVudCBmcm9tICVz
ICVzICVzXG4iLAogCQkJICAgIHJlYWxuYW1lLCBlc2NhcF91c2VyaWQsIGVzY2FwX3JlYWxtKTsK
IAkKIAkvKiBjcmVhdGUgYSBzdGF0ZW1lbnQgdGhhdCB3ZSB3aWxsIHVzZSAqLwotCXF1ZXJ5ID0g
c3FsX2NyZWF0ZV9zdGF0ZW1lbnQoc2V0dGluZ3MtPnNxbF9zZWxlY3QsCisJcXVlcnkgPSBzcWxf
Y3JlYXRlX3N0YXRlbWVudChzZXR0aW5ncy0+c3FsX2F1eHByb3Bfc2VsZWN0LAogCQkJCSAgICAg
cmVhbG5hbWUsZXNjYXBfdXNlcmlkLAogCQkJCSAgICAgZXNjYXBfcmVhbG0sIE5VTEwsCiAJCQkJ
ICAgICBzcGFyYW1zLT51dGlscyk7CkBAIC0xMDM2LDcgKzEwNzUsNyBAQCBzdGF0aWMgaW50IHNx
bF9hdXhwcm9wX2xvb2t1cCh2b2lkICpnbG9iX2NvbnRleHQsCiAJfQogCQogCXNwYXJhbXMtPnV0
aWxzLT5sb2coTlVMTCwgU0FTTF9MT0dfREVCVUcsCi0JCQkgICAgInNxbCBwbHVnaW4gZG9pbmcg
cXVlcnkgJXNcbiIsIHF1ZXJ5KTsKKwkJCSAgICAic3FsX2F1eHByb3AgcGx1Z2luIGRvaW5nIHF1
ZXJ5ICVzXG4iLCBxdWVyeSk7CiAJCiAJdmFsdWVbMF0gPSAnXDAnOwogCXZhbHVlX2xlbiA9IDA7
CkBAIC0xMDczLDEzICsxMTEyLDEzIEBAIHN0YXRpYyBpbnQgc3FsX2F1eHByb3BfbG9va3VwKHZv
aWQgKmdsb2JfY29udGV4dCwKIAkgICAgfQogCiAJICAgIHNwYXJhbXMtPnV0aWxzLT5sb2coTlVM
TCwgU0FTTF9MT0dfREVCVUcsCi0JCQkJInNxbCBwbHVnaW4gY3JlYXRlIHN0YXRlbWVudCBmcm9t
ICVzICVzICVzXG4iLAorCQkJCSJzcWxfYXV4cHJvcCBwbHVnaW4gY3JlYXRlIHN0YXRlbWVudCBm
cm9tICVzICVzICVzXG4iLAogCQkJCVNBU0xfQVVYX1BBU1NXT1JEX1BST1AsCiAJCQkJZXNjYXBf
dXNlcmlkLAogCQkJCWVzY2FwX3JlYWxtKTsKICAgICAJCiAJICAgIC8qIGNyZWF0ZSBhIHN0YXRl
bWVudCB0aGF0IHdlIHdpbGwgdXNlICovCi0JICAgIHF1ZXJ5ID0gc3FsX2NyZWF0ZV9zdGF0ZW1l
bnQoc2V0dGluZ3MtPnNxbF9zZWxlY3QsCisJICAgIHF1ZXJ5ID0gc3FsX2NyZWF0ZV9zdGF0ZW1l
bnQoc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3NlbGVjdCwKIAkJCQkJIFNBU0xfQVVYX1BBU1NXT1JE
X1BST1AsCiAJCQkJCSBlc2NhcF91c2VyaWQsCiAJCQkJCSBlc2NhcF9yZWFsbSwKQEAgLTEwODks
NyArMTEyOCw3IEBAIHN0YXRpYyBpbnQgc3FsX2F1eHByb3BfbG9va3VwKHZvaWQgKmdsb2JfY29u
dGV4dCwKIAkJcmV0ID0gU0FTTF9OT01FTTsKIAkgICAgfSBlbHNlIHsKIAkJc3BhcmFtcy0+dXRp
bHMtPmxvZyhOVUxMLCBTQVNMX0xPR19ERUJVRywKLQkJCQkgICAgInNxbCBwbHVnaW4gZG9pbmcg
cXVlcnkgJXNcbiIsIHF1ZXJ5KTsKKwkJCQkgICAgInNxbF9hdXhwcm9wIHBsdWdpbiBkb2luZyBx
dWVyeSAlc1xuIiwgcXVlcnkpOwogICAgICAgICAJCiAJCXZhbHVlWzBdID0gJ1wwJzsKIAkJdmFs
dWVfbGVuID0gMDsKQEAgLTExNTQsOCArMTE5Myw4IEBAIHN0YXRpYyBpbnQgc3FsX2F1eHByb3Bf
c3RvcmUodm9pZCAqZ2xvYl9jb250ZXh0LAogCiAgICAgLyoganVzdCBjaGVja2luZyBpZiB3ZSBh
cmUgZW5hYmxlZCAqLwogICAgIGlmICghY3R4ICYmCi0Jc3FsX2V4aXN0cyhzZXR0aW5ncy0+c3Fs
X2luc2VydCkgJiYKLQlzcWxfZXhpc3RzKHNldHRpbmdzLT5zcWxfdXBkYXRlKSkgcmV0dXJuIFNB
U0xfT0s7CisJc3FsX2V4aXN0cyhzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0KSAmJgorCXNx
bF9leGlzdHMoc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3VwZGF0ZSkpIHJldHVybiBTQVNMX09LOwog
ICAgIAogICAgIC8qIG1ha2Ugc3VyZSBvdXIgaW5wdXQgaXMgb2theSAqLwogICAgIGlmICghZ2xv
Yl9jb250ZXh0IHx8ICFzcGFyYW1zIHx8ICF1c2VyKSByZXR1cm4gU0FTTF9CQURQQVJBTTsKQEAg
LTEyMjMsMTcgKzEyNjIsMTcgQEAgc3RhdGljIGludCBzcWxfYXV4cHJvcF9zdG9yZSh2b2lkICpn
bG9iX2NvbnRleHQsCiAKIAkvKiBkZXRlcm1pbmUgd2hpY2ggY29tbWFuZCB3ZSBuZWVkICovCiAJ
Lyogc2VlIGlmIHdlIGFscmVhZHkgaGF2ZSBhIHJvdyBmb3IgdGhpcyB1c2VyICovCi0Jc3RhdGVt
ZW50ID0gc3FsX2NyZWF0ZV9zdGF0ZW1lbnQoc2V0dGluZ3MtPnNxbF9zZWxlY3QsCisJc3RhdGVt
ZW50ID0gc3FsX2NyZWF0ZV9zdGF0ZW1lbnQoc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3NlbGVjdCwK
IAkJCQkJIFNRTF9XSUxEQ0FSRCwgZXNjYXBfdXNlcmlkLAogCQkJCQkgZXNjYXBfcmVhbG0sIE5V
TEwsCiAJCQkJCSBzcGFyYW1zLT51dGlscyk7CiAJaWYgKCFzZXR0aW5ncy0+c3FsX2VuZ2luZS0+
c3FsX2V4ZWMoY29ubiwgc3RhdGVtZW50LCBOVUxMLCAwLCBOVUxMLAogCQkJCQkgICAgc3BhcmFt
cy0+dXRpbHMpKSB7CiAJICAgIC8qIGFscmVhZHkgaGF2ZSBhIHJvdyA9PiBVUERBVEUgKi8KLQkg
ICAgY21kID0gc2V0dGluZ3MtPnNxbF91cGRhdGU7CisJICAgIGNtZCA9IHNldHRpbmdzLT5zcWxf
YXV4cHJvcF91cGRhdGU7CiAJfSBlbHNlIHsKIAkgICAgLyogbmV3IHJvdyA9PiBJTlNFUlQgKi8K
LQkgICAgY21kID0gc2V0dGluZ3MtPnNxbF9pbnNlcnQ7CisJICAgIGNtZCA9IHNldHRpbmdzLT5z
cWxfYXV4cHJvcF9pbnNlcnQ7CiAJfQogCXNwYXJhbXMtPnV0aWxzLT5mcmVlKHN0YXRlbWVudCk7
CiAKQEAgLTEyOTIsNyArMTMzMSw2IEBAIHN0YXRpYyBpbnQgc3FsX2F1eHByb3Bfc3RvcmUodm9p
ZCAqZ2xvYl9jb250ZXh0LAogICAgIC8qIGRvIGEgbGl0dGxlIGRhbmNlICovCiB9CiAKLQogc3Rh
dGljIHZvaWQgc3FsX2F1eHByb3BfZnJlZSh2b2lkICpnbG9iX2NvbnRleHQsIGNvbnN0IHNhc2xf
dXRpbHNfdCAqdXRpbHMpCiB7CiAgICAgc3FsX3NldHRpbmdzX3QgKnNldHRpbmdzOwpAQCAtMTMw
Niw2ICsxMzQ0LDIwNSBAQCBzdGF0aWMgdm9pZCBzcWxfYXV4cHJvcF9mcmVlKHZvaWQgKmdsb2Jf
Y29udGV4dCwgY29uc3Qgc2FzbF91dGlsc190ICp1dGlscykKICAgICB1dGlscy0+ZnJlZShzZXR0
aW5ncyk7CiB9CiAKKworc3RhdGljIGludAorc3FsX2Nhbm9uX3NlcnZlciAodm9pZCAqZ2xvYl9j
b250ZXh0LAorCQkJICAgICAgIHNhc2xfc2VydmVyX3BhcmFtc190ICogc3BhcmFtcywKKwkJCSAg
ICAgICBjb25zdCBjaGFyICp1c2VyLCB1bnNpZ25lZCB1bGVuLAorCQkJICAgICAgIHVuc2lnbmVk
IGZsYWdzIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAorCQkJICAgICAgIGNoYXIgKm91dF91c2Vy
LAorCQkJICAgICAgIHVuc2lnbmVkIG91dF91bWF4LCB1bnNpZ25lZCAqb3V0X3VsZW4pCit7Cisg
IHNwYXJhbXMtPnV0aWxzLT5zZXRlcnJvciAoc3BhcmFtcy0+dXRpbHMtPmNvbm4sIDAsICJzcWxf
Y2Fub25fc2VydmVyIik7CisKKyAgY2hhciAqdXNlcmlkID0gTlVMTDsKKyAgLyogcmVhbG0gY291
bGQgYmUgdXNlZCBmb3Igc29tZXRoaW5nIGNsZXZlciAqLworICBjaGFyICpyZWFsbSA9IE5VTEw7
CisgIGNvbnN0IGNoYXIgKnVzZXJfcmVhbG0gPSBOVUxMOworICBjaGFyIHZhbHVlWzgxOTJdOwor
ICBzaXplX3QgdmFsdWVfbGVuOworICBjaGFyIG9sZF92YWx1ZVs4MTkyXTsKKyAgc2l6ZV90IG9s
ZF92YWx1ZV9sZW47CisgIGNoYXIgKnF1ZXJ5ID0gTlVMTDsKKyAgY2hhciAqZXNjYXBfdXNlcmlk
ID0gTlVMTDsKKyAgY2hhciAqZXNjYXBfcmVhbG0gPSBOVUxMOworICBzcWxfc2V0dGluZ3NfdCAq
c2V0dGluZ3M7CisgIHZvaWQgKmNvbm4gPSBOVUxMOworICB1bnNpZ25lZCBpOworICBjaGFyICpp
bl9idWYsICp1c2VyaW47CisgIGNvbnN0IGNoYXIgKmJlZ2luX3U7CisgIHNpemVfdCB1X2FwcHJl
YWxtID0gMDsKKworICBpZiAoIWdsb2JfY29udGV4dCB8fCAhc3BhcmFtcy0+dXRpbHMgfHwgIXVz
ZXIpCisgICAgcmV0dXJuIFNBU0xfQkFEUEFSQU07CisKKyAgICBzcGFyYW1zLT51dGlscy0+bG9n
KE5VTEwsIFNBU0xfTE9HX0RFQlVHLAorICAgICAgICAgICAgICAgICAgICAgICAgInNxbF9jYW5v
bl9zZXJ2ZXIgUGFyc2UgdGhlIHVzZXJuYW1lICVzXG4iLCB1c2VyKTsKKworCisgIGluX2J1ZiA9
IHNwYXJhbXMtPnV0aWxzLT5tYWxsb2MgKCh1bGVuICsgMikgKiBzaXplb2YgKGNoYXIpKTsKKyAg
aWYgKCFpbl9idWYpCisgICAgcmV0dXJuIFNBU0xfTk9NRU07CisKKyAgdXNlcmluID0gaW5fYnVm
OworCisgIG1lbWNweSAodXNlcmluLCB1c2VyLCB1bGVuKTsKKyAgdXNlcmluW3VsZW5dID0gJ1ww
JzsKKworCisgIGZvciAoaSA9IDA7IGlzc3BhY2UgKChpbnQpIHVzZXJpbltpXSkgJiYgaSA8IHVs
ZW47IGkrKyk7CisgIGJlZ2luX3UgPSAmKHVzZXJpbltpXSk7CisgIGlmIChpID4gMCkKKyAgICB1
bGVuIC09IGk7CisKKyAgZm9yICg7IHVsZW4gPiAwICYmIGlzc3BhY2UgKChpbnQpIGJlZ2luX3Vb
dWxlbiAtIDFdKTsgdWxlbi0tKTsKKyAgaWYgKGJlZ2luX3UgPT0gJih1c2VyaW5bdWxlbl0pKQor
ICAgIHsKKyAgICAgIHNwYXJhbXMtPnV0aWxzLT5mcmVlIChpbl9idWYpOworICAgICAgc3BhcmFt
cy0+dXRpbHMtPnNldGVycm9yIChzcGFyYW1zLT51dGlscy0+Y29ubiwgMCwKKwkJCQkiQWxsLXdo
aXRlc3BhY2UgdXNlcm5hbWUuIik7CisgICAgICByZXR1cm4gU0FTTF9GQUlMOworICAgIH0KKwor
ICAvKiBOZWVkIHRvIGFwcGVuZCByZWFsbSBpZiBuZWNlc3NhcnkgKHNlZSBzYXNsLmgpICovCisg
IGlmIChzcGFyYW1zLT51c2VyX3JlYWxtKQorICAgIHsKKyAgICAgIHVzZXJfcmVhbG0gPSBzcGFy
YW1zLT51c2VyX3JlYWxtOworICAgIH0KKyAgZWxzZQorICAgIHsKKyAgICAgIHVzZXJfcmVhbG0g
PSBzcGFyYW1zLT5zZXJ2ZXJGUUROOworICAgIH0KKworICBpZiAoIXN0cmNociAodXNlciwgJ0An
KSkKKyAgICB7CisgICAgICB1X2FwcHJlYWxtID0gc3RybGVuICh1c2VyX3JlYWxtKSArIDE7Cisg
ICAgfQorCisgIC8qIHNldHVwIHRoZSBzZXR0aW5ncyAqLworICBzZXR0aW5ncyA9IChzcWxfc2V0
dGluZ3NfdCAqKSBnbG9iX2NvbnRleHQ7CisKKyAgLyoganVzdCBuZWVkIHRvIGVzY2FwZSB1c2Vy
aWQgYW5kIHJlYWxtIG5vdyAqLworICAvKiBhbGxvY2F0ZSBzb21lIG1lbW9yeSAqLworICBlc2Nh
cF91c2VyaWQgPSAoY2hhciAqKSBzcGFyYW1zLT51dGlscy0+bWFsbG9jICgyNTUpOworICBlc2Nh
cF9yZWFsbSA9IChjaGFyICopIHNwYXJhbXMtPnV0aWxzLT5tYWxsb2MgKDI1NSk7CisKKyAgaWYg
KCFlc2NhcF91c2VyaWQgfHwgIWVzY2FwX3JlYWxtKQorICAgIHsKKyAgICAgIHNwYXJhbXMtPnV0
aWxzLT5sb2cgKE5VTEwsIFNBU0xfTE9HX0RFQlVHLAorCQkJICAgInNxbF9jYW5vbl9zZXJ2ZXI6
IG1lbWVycm9yIFxuIik7CisgICAgICBNRU1FUlJPUiAoc3BhcmFtcy0+dXRpbHMpOworICAgICAg
Z290byBkb25lOworICAgIH0KKworICBjb25uID0gc3FsX2Nvbm5lY3QgKHNldHRpbmdzLCBzcGFy
YW1zLT51dGlscyk7CisgIGlmICghY29ubikKKyAgICB7CisgICAgICBzcGFyYW1zLT51dGlscy0+
bG9nIChOVUxMLCBTQVNMX0xPR19FUlIsCisJCQkgICAic3FsX2Nhbm9uX3NlcnZlciBjb3VsZG4n
dCBjb25uZWN0IHRvIGFueSBob3N0XG4iKTsKKyAgICAgIGdvdG8gZG9uZTsKKyAgICB9CisKKyAg
LyogZXNjYXBlIG91dCAqLworICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+c3FsX2VzY2FwZV9zdHIg
KGVzY2FwX3VzZXJpZCwgdXNlcmluKTsKKyAgc2V0dGluZ3MtPnNxbF9lbmdpbmUtPnNxbF9lc2Nh
cGVfc3RyIChlc2NhcF9yZWFsbSwgdXNlcl9yZWFsbSk7CisKKyAgLyogY3JlYXRlIGEgc3RhdGVt
ZW50IHRoYXQgd2Ugd2lsbCB1c2UgKi8KKyAgc3BhcmFtcy0+dXRpbHMtPmxvZyhOVUxMLCBTQVNM
X0xPR19ERUJVRywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAic3FsX2Nhbm9uIHBsdWdp
biBjcmVhdGUgc3RhdGVtZW50IGZyb20gJXMgJXNcbiIsCisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgZXNjYXBfdXNlcmlkLCBlc2NhcF9yZWFsbSk7CisKKyAgcXVlcnkgPSBzcWxfY3JlYXRl
X3N0YXRlbWVudCAoc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QsCisJCQkJZXNjYXBfdXNlcmlk
LCBlc2NhcF91c2VyaWQsCisJCQkJZXNjYXBfcmVhbG0sIE5VTEwsIHNwYXJhbXMtPnV0aWxzKTsK
KyAgbWVtY3B5KG9sZF92YWx1ZSx1c2VyaW4sIHN0cmxlbiAodXNlcmluKSk7CisgIG9sZF92YWx1
ZV9sZW4gPSBzdHJsZW4gKHVzZXJpbik7CisgIC8qIHJ1biB0aGUgcXVlcnkgKi8KKyAgc3BhcmFt
cy0+dXRpbHMtPmxvZyhOVUxMLCBTQVNMX0xPR19ERUJVRywKKyAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAic3FsX2Nhbm9uIHBsdWdpbiBkb2luZyBxdWVyeSAlc1xuIiwgcXVlcnkpOworCisg
IHdoaWxlICghc2V0dGluZ3MtPnNxbF9lbmdpbmUtPnNxbF9leGVjIChjb25uLCBxdWVyeSwgdmFs
dWUsIHNpemVvZiAodmFsdWUpLAorCQkJCSAgICAgICAmdmFsdWVfbGVuLCBzcGFyYW1zLT51dGls
cykpCisgICAgeworICAgICAgICBtZW1jcHkob2xkX3ZhbHVlLHZhbHVlLHZhbHVlX2xlbik7Cisg
ICAgICAgIG9sZF92YWx1ZV9sZW49dmFsdWVfbGVuOworICAgICAgICBzZXR0aW5ncy0+c3FsX2Vu
Z2luZS0+c3FsX2VzY2FwZV9zdHIgKGVzY2FwX3VzZXJpZCwgdmFsdWUpOworICAgICAgICBzZXR0
aW5ncy0+c3FsX2VuZ2luZS0+c3FsX2VzY2FwZV9zdHIgKGVzY2FwX3JlYWxtLCB1c2VyX3JlYWxt
KTsKKyAgICAgICAgc3BhcmFtcy0+dXRpbHMtPmxvZyhOVUxMLCBTQVNMX0xPR19ERUJVRywKKyAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAic3FsX2Nhbm9uIHBsdWdpbiBjcmVhdGUgc3RhdGVt
ZW50IGZyb20gJXMgJXNcbiIsCisgICAgICAgICAgICAgICAgICAgICAgICAgICAgZXNjYXBfdXNl
cmlkLCBlc2NhcF9yZWFsbSk7CisKKyAgLyogY3JlYXRlIGEgc3RhdGVtZW50IHRoYXQgd2Ugd2ls
bCB1c2UgKi8KKyAgICAgICAgcXVlcnkgPSBzcWxfY3JlYXRlX3N0YXRlbWVudCAoc2V0dGluZ3Mt
PnNxbF9jYW5vbl9zZWxlY3QsCisJCQkJZXNjYXBfdXNlcmlkLCBlc2NhcF91c2VyaWQsCisJCQkJ
ZXNjYXBfcmVhbG0sIE5VTEwsIHNwYXJhbXMtPnV0aWxzKTsKKyAgICAgICBzcGFyYW1zLT51dGls
cy0+bG9nKE5VTEwsIFNBU0xfTE9HX0RFQlVHLAorICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICJzcWxfY2Fub24gcGx1Z2luIGRvaW5nIHF1ZXJ5ICVzXG4iLCBxdWVyeSk7CisKKwl9CisgICAg
ICBpZiAob2xkX3ZhbHVlX2xlbiA8IG91dF91bWF4KQorCXsKKwkgIG1lbWNweSAob3V0X3VzZXIs
IG9sZF92YWx1ZSwgb2xkX3ZhbHVlX2xlbik7CisJICBvdXRfdXNlcltvbGRfdmFsdWVfbGVuXSA9
ICdcMCc7CisJICAqb3V0X3VsZW4gPSBvbGRfdmFsdWVfbGVuOyAKKyAgICB9CisgICAgICBlbHNl
CisJeworCSAgTUVNRVJST1IgKHNwYXJhbXMtPnV0aWxzKTsKKwkgIGdvdG8gZG9uZTsKKyAgICB9
CisgIHNwYXJhbXMtPnV0aWxzLT5mcmVlIChxdWVyeSk7CisKK2RvbmU6CisgIGlmIChlc2NhcF91
c2VyaWQpCisgICAgc3BhcmFtcy0+dXRpbHMtPmZyZWUgKGVzY2FwX3VzZXJpZCk7CisgIGlmIChl
c2NhcF9yZWFsbSkKKyAgICBzcGFyYW1zLT51dGlscy0+ZnJlZSAoZXNjYXBfcmVhbG0pOworICBp
ZiAoY29ubikKKyAgICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+c3FsX2Nsb3NlIChjb25uKTsKKyAg
aWYgKHVzZXJpZCkKKyAgICBzcGFyYW1zLT51dGlscy0+ZnJlZSAodXNlcmlkKTsKKyAgaWYgKHJl
YWxtKQorICAgIHNwYXJhbXMtPnV0aWxzLT5mcmVlIChyZWFsbSk7CisgIHJldHVybiBTQVNMX09L
OworfQorCitzdGF0aWMgaW50CitzcWxfY2Fub25fY2xpZW50KHZvaWQgKmdsb2JfY29udGV4dCBf
X2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKwkJICAgIHNhc2xfY2xpZW50X3BhcmFtc190ICpjcGFy
YW1zLAorCQkgICAgY29uc3QgY2hhciAqdXNlciwKKwkJICAgIHVuc2lnbmVkIHVsZW4sCisJCSAg
ICB1bnNpZ25lZCBmbGFncyBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKwkJICAgIGNoYXIgKm91
dCwKKwkJICAgIHVuc2lnbmVkIG91dF9tYXgsCisJCSAgICB1bnNpZ25lZCAqb3V0X3VsZW4pewor
ICAgIGlmKCFjcGFyYW1zIHx8ICF1c2VyKSByZXR1cm4gU0FTTF9CQURQQVJBTTsKKworICAgIC8q
IFRyaW0gd2hpdGVzcGFjZSAqLworICAgIHdoaWxlKGlzc3BhY2UoKih1bnNpZ25lZCBjaGFyICop
dXNlcikpIHsKKwl1c2VyKys7CisJdWxlbi0tOworICAgIH0KKyAgICB3aGlsZShpc3NwYWNlKCh1
bnNpZ25lZCBjaGFyKXVzZXJbdWxlbi0xXSkpIHsKKyAgICAJdWxlbi0tOworICAgIH0KKworICAg
IGlmICghdWxlbikgeworICAgIAljcGFyYW1zLT51dGlscy0+c2V0ZXJyb3IoY3BhcmFtcy0+dXRp
bHMtPmNvbm4sIDAsCisJICAgICJBbGwtd2hpdGVzcGFjZSB1c2VybmFtZS4iKTsKKwlyZXR1cm4g
U0FTTF9GQUlMOworICAgIH0KKyAgICBpZiAodWxlbj5vdXRfbWF4KSByZXR1cm4gU0FTTF9CVUZP
VkVSOworICAgIG1lbWNweShvdXQsIHVzZXIsIHVsZW4pOworICAgIG91dFt1bGVuXSA9ICdcMCc7
CisgICAgKm91dF91bGVuID0gdWxlbjsKKyAgICByZXR1cm4gU0FTTF9PSzsKK30KKworCisKKwor
CiBzdGF0aWMgc2FzbF9hdXhwcm9wX3BsdWdfdCBzcWxfYXV4cHJvcF9wbHVnaW4gPSB7CiAgICAg
MCwJCQkvKiBGZWF0dXJlcyAqLwogICAgIDAsCQkJLyogc3BhcmUgKi8KQEAgLTEzNDMsMTcgKzE1
ODAsODIgQEAgaW50IHNxbF9hdXhwcm9wX3BsdWdfaW5pdChjb25zdCBzYXNsX3V0aWxzX3QgKnV0
aWxzLAogICAgIAogICAgIGlmICghc2V0dGluZ3MtPnNxbF9lbmdpbmUtPm5hbWUpIHJldHVybiBT
QVNMX05PTUVDSDsKIAotICAgIGlmICghc3FsX2V4aXN0cyhzZXR0aW5ncy0+c3FsX3NlbGVjdCkp
IHsKLQl1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX0VSUiwgInNxbF9zZWxlY3Qgb3B0aW9uIG1p
c3NpbmciKTsKKyAgICBpZiAoIXNxbF9leGlzdHMoc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3NlbGVj
dCkpIHsKKwl1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX0VSUiwgInNxbF9hdXhwcm9wX3NlbGVj
dCBvcHRpb24gbWlzc2luZyIpOwogCXV0aWxzLT5mcmVlKHNldHRpbmdzKTsJCiAJcmV0dXJuIFNB
U0xfTk9NRUNIOwogICAgIH0KIAogICAgIHV0aWxzLT5sb2coTlVMTCwgU0FTTF9MT0dfREVCVUcs
Ci0JICAgICAgICJzcWwgYXV4cHJvcCBwbHVnaW4gdXNpbmcgJXMgZW5naW5lXG4iLAotCSAgICAg
ICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+bmFtZSk7CisJICAgICAgInNxbF9hdXhwcm9wX3BsdWdp
biB1c2luZyAlcyBlbmdpbmUgd2l0aCBzZWxlY3Q6ICVzXG4iLAorCSAgICAgIHNldHRpbmdzLT5z
cWxfZW5naW5lLT5uYW1lLCBzZXR0aW5ncy0+c3FsX2F1eHByb3Bfc2VsZWN0KTsKICAgICAKICAg
ICBzcWxfYXV4cHJvcF9wbHVnaW4uZ2xvYl9jb250ZXh0ID0gc2V0dGluZ3M7CiAgICAgCiAgICAg
cmV0dXJuIFNBU0xfT0s7CiB9CitzdGF0aWMgc2FzbF9jYW5vbnVzZXJfcGx1Z190IHNxbF9jYW5v
bnVzZXJfcGx1Z2luID0geworCTAsCS8qIGZlYXR1cmVzICovCisJMCwJLyogc3BhcmUgKi8KKwlO
VUxMLAkvKiBnbG9iX2NvbnRleHQgKi8KKwkic3FsIiwJLyogbmFtZSAqLworCXNxbF9hdXhwcm9w
X2ZyZWUsCS8qIGNhbm9uX3VzZXJfZnJlZSAqLworCXNxbF9jYW5vbl9zZXJ2ZXIsCS8qIGNhbm9u
X3VzZXJfc2VydmVyICovCisJc3FsX2Nhbm9uX2NsaWVudCwJLyogY2Fub25fdXNlcl9jbGllbnQg
Ki8KKwlOVUxMLAorCU5VTEwsCisJTlVMTAorfTsKKworaW50CitzcWxfY2Fub251c2VyX3BsdWdf
aW5pdCAoY29uc3Qgc2FzbF91dGlsc190ICogdXRpbHMKKwkJCQkgIF9fYXR0cmlidXRlX18gKCh1
bnVzZWQpKSwgaW50IG1heF92ZXJzaW9uLAorCQkJCSAgaW50ICpvdXRfdmVyc2lvbiwKKwkJCQkg
IHNhc2xfY2Fub251c2VyX3BsdWdfdCAqKiBwbHVnLAorCQkJCSAgY29uc3QgY2hhciAqcGx1Z25h
bWUKKwkJCQkgIF9fYXR0cmlidXRlX18gKCh1bnVzZWQpKSkKK3sKKyAgc3FsX3NldHRpbmdzX3Qg
KnNldHRpbmdzOworCisgIGlmICghb3V0X3ZlcnNpb24gfHwgIXBsdWcpCisgICAgcmV0dXJuIFNB
U0xfQkFEUEFSQU07CisKKyAgaWYgKG1heF92ZXJzaW9uIDwgU0FTTF9DQU5PTlVTRVJfUExVR19W
RVJTSU9OKQorICAgIHJldHVybiBTQVNMX0JBRFZFUlM7CisKKyAgKm91dF92ZXJzaW9uID0gU0FT
TF9DQU5PTlVTRVJfUExVR19WRVJTSU9OOworCisgIHNldHRpbmdzID0gKHNxbF9zZXR0aW5nc190
ICopIHV0aWxzLT5tYWxsb2MgKHNpemVvZiAoc3FsX3NldHRpbmdzX3QpKTsKKworICBpZiAoIXNl
dHRpbmdzKQorICAgIHsKKyAgICAgIE1FTUVSUk9SICh1dGlscyk7CisgICAgICByZXR1cm4gU0FT
TF9OT01FTTsKKyAgICB9CisKKyAgbWVtc2V0IChzZXR0aW5ncywgMCwgc2l6ZW9mIChzcWxfc2V0
dGluZ3NfdCkpOworICBzcWxfZ2V0X3NldHRpbmdzICh1dGlscywgc2V0dGluZ3MpOworCisgIGlm
ICghc2V0dGluZ3MtPnNxbF9lbmdpbmUtPm5hbWUpCisgICAgcmV0dXJuIFNBU0xfTk9NRUNIOwor
CisgIGlmICghc3FsX2V4aXN0cyAoc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QpKQorICAgIHsK
KyAgICAgIHV0aWxzLT5sb2cgKE5VTEwsIFNBU0xfTE9HX0VSUiwKKwkJICAic3FsX2Nhbm9uX3Bs
dWdpbjogc3FsX2Nhbm9uX3NlbGVjdCBvcHRpb24gbWlzc2luZyIpOworICAgICAgdXRpbHMtPmZy
ZWUgKHNldHRpbmdzKTsKKyAgICAgIHJldHVybiBTQVNMX05PTUVDSDsKKyAgICB9CisKKyAgdXRp
bHMtPmxvZyAoTlVMTCwgU0FTTF9MT0dfREVCVUcsCisJICAgICAgInNxbF9jYW5vbl9wbHVnaW4g
dXNpbmcgJXMgZW5naW5lIHdpdGggc2VsZWN0OiAlc1xuIiwKKwkgICAgICBzZXR0aW5ncy0+c3Fs
X2VuZ2luZS0+bmFtZSwgc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QpOworCisgIHNxbF9jYW5v
bnVzZXJfcGx1Z2luLmdsb2JfY29udGV4dCA9IHNldHRpbmdzOworCisKKworICAqcGx1ZyA9ICZz
cWxfY2Fub251c2VyX3BsdWdpbjsKKworICByZXR1cm4gU0FTTF9PSzsKK30K
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1497</attachid>
            <date>2012-07-16 07:08 EDT</date>
            <desc>Somehow the recursion-check has left...</desc>
            <filename>sasl-sql-canon.patch</filename>
            <type>text/plain</type>
            <size>20659</size>
            <attacher>lars.duesing@camelotsweb.de</attacher>
            
              <data encoding="base64">ZGlmZiAtdU5yIGN5cnVzLXNhc2wtMi4xLjI1L2RvYy9vcHRpb25zLmh0bWwgY3lydXMtc2FzbC0y
LjEuMjUtc3FsY2Fub24vZG9jL29wdGlvbnMuaHRtbAotLS0gY3lydXMtc2FzbC0yLjEuMjUvZG9j
L29wdGlvbnMuaHRtbAkyMDA5LTEyLTAzIDIwOjA3OjAxLjAwMDAwMDAwMCArMDEwMAorKysgY3ly
dXMtc2FzbC0yLjEuMjUtc3FsY2Fub24vZG9jL29wdGlvbnMuaHRtbAkyMDEyLTA3LTE2IDEyOjU4
OjExLjQ5NzM1NzU1MiArMDIwMApAQCAtMTc0LDIyICsxNzQsNTEgQEAKIDxURD48aT5ub25lPC9p
PiAoZW5naW5lIGRlcGVuZGVudCk8L1REPgogPC9UUj4KIDxUUj4KKzxURD5zcWxfYXV4cHJvcF9z
ZWxlY3Q8L1REPjxURD5TUUwgcGx1Z2luPC9URD4KKzxURD5TRUxFQ1Qgc3RhdGVtZW50IHRvIHVz
ZSBmb3IgZmV0Y2hpbmcgcHJvcGVydGllcy4gIFRoaXMgb3B0aW9uIGlzCis8Yj5yZXF1aXJlZDwv
Yj4gaW4gb3JkZXIgdG8gdXNlIHRoZSBTUUwgYXV4cHJvcCBwbHVnaW4uPC9URD4KKzxURD48aT5u
b25lPC9pPjwvVEQ+Cis8L1RSPgorPFRSPgogPFREPnNxbF9zZWxlY3Q8L1REPjxURD5TUUwgcGx1
Z2luPC9URD4KKzxURD5TRUxFQ1Qgc3RhdGVtZW50IHRvIHVzZSBmb3IgZmV0Y2hpbmcgcHJvcGVy
dGllcy4gPGI+RGVwcmVjYXRlZDwvYj4gYWxpYXMgZm9yIHNxbF9hdXhwcm9wX3NlbGVjdC4gVGhp
cyBvcHRpb24gaXMKKzxiPnJlcXVpcmVkPC9iPiBpbiBvcmRlciB0byB1c2UgdGhlIFNRTCBhdXhw
cm9wIHBsdWdpbi48L1REPgorPFREPjxpPm5vbmU8L2k+PC9URD4KKzwvVFI+Cis8VFI+Cis8VEQ+
c3FsX3N0YXRlbWVudDwvVEQ+PFREPlNRTCBwbHVnaW48L1REPgorPFREPlNFTEVDVCBzdGF0ZW1l
bnQgdG8gdXNlIGZvciBmZXRjaGluZyBwcm9wZXJ0aWVzLiA8Yj5EZXByZWNhdGVkPC9iPiBhbGlh
cyBmb3Igc3FsX2F1eHByb3Bfc2VsZWN0LiBUaGlzIG9wdGlvbiBpcworPGI+cmVxdWlyZWQ8L2I+
IGluIG9yZGVyIHRvIHVzZSB0aGUgU1FMIGF1eHByb3AgcGx1Z2luLjwvVEQ+Cis8VEQ+PGk+bm9u
ZTwvaT48L1REPgorPC9UUj4KKzxUUj4KKzxURD5zcWxfY2Fub25fc2VsZWN0PC9URD48VEQ+U1FM
IHBsdWdpbjwvVEQ+CiA8VEQ+U0VMRUNUIHN0YXRlbWVudCB0byB1c2UgZm9yIGZldGNoaW5nIHBy
b3BlcnRpZXMuICBUaGlzIG9wdGlvbiBpcwotPGI+cmVxdWlyZWQ8L2I+IGluIG9yZGVyIHRvIHVz
ZSB0aGUgU1FMIHBsdWdpbi48L1REPgorPGI+cmVxdWlyZWQ8L2I+IGluIG9yZGVyIHRvIHVzZSB0
aGUgU1FMIGNhbm9uIHBsdWdpbi48L1REPgogPFREPjxpPm5vbmU8L2k+PC9URD4KIDwvVFI+CiA8
VFI+Ci08VEQ+c3FsX2luc2VydDwvVEQ+PFREPlNRTCBwbHVnaW48L1REPgorPFREPnNxbF9hdXhw
cm9wX2luc2VydDwvVEQ+PFREPlNRTCBwbHVnaW48L1REPgogPFREPklOU0VSVCBzdGF0ZW1lbnQg
dG8gdXNlIGZvciBjcmVhdGluZyBwcm9wZXJ0aWVzIGZvciBuZXcgdXNlcnMuPC9URD4KIDxURD48
aT5ub25lPC9pPjwvVEQ+CiA8L1RSPgogPFRSPgotPFREPnNxbF91cGRhdGU8L1REPjxURD5TUUwg
cGx1Z2luPC9URD4KKzxURD5zcWxfaW5zZXJ0PC9URD48VEQ+U1FMIHBsdWdpbjwvVEQ+Cis8VEQ+
SU5TRVJUIHN0YXRlbWVudCB0byB1c2UgZm9yIGNyZWF0aW5nIHByb3BlcnRpZXMgZm9yIG5ldyB1
c2Vycy4gPGI+RGVwcmVjYXRlZDwvYj4gYWxpYXMgZm9yIHNxbF9hdXhwcm9wX2luc2VydC48L1RE
PgorPFREPjxpPm5vbmU8L2k+PC9URD4KKzwvVFI+Cis8VFI+Cis8VEQ+c3FsX2F1eHByb3BfdXBk
YXRlPC9URD48VEQ+U1FMIHBsdWdpbjwvVEQ+CiA8VEQ+VVBEQVRFIHN0YXRlbWVudCB0byB1c2Ug
Zm9yIG1vZGlmeWluZyBwcm9wZXJ0aWVzLjwvVEQ+CiA8VEQ+PGk+bm9uZTwvaT48L1REPgogPC9U
Uj4KIDxUUj4KKzxUUj4KKzxURD5zcWxfdXBkYXRlPC9URD48VEQ+U1FMIHBsdWdpbjwvVEQ+Cis8
VEQ+VVBEQVRFIHN0YXRlbWVudCB0byB1c2UgZm9yIG1vZGlmeWluZyBwcm9wZXJ0aWVzLiA8Yj5E
ZXByZWNhdGVkPC9iPiBhbGlhcyBmb3Igc3FsX2F1eHByb3BfdXBkYXRlPC9URD4KKzxURD48aT5u
b25lPC9pPjwvVEQ+Cis8L1RSPgorPFRSPgogPFREPnNxbF91c2Vzc2w8L1REPjxURD5TUUwgcGx1
Z2luPC9URD4KIDxURD5XaGVuIHNldCB0byAneWVzJywgJ29uJywgJzEnIG9yICd0cnVlJywgYSBz
ZWN1cmUgY29ubmVjdGlvbiB3aWxsCiBiZSBtYWRlIHRvIHRoZSBTUUwgc2VydmVyLjwvVEQ+CkBA
IC0yMDksMTUgKzIzOCwxNSBAQAogCiA8aDI+Tm90ZXMgb24gU1FMIGF1eHByb3Agb3B0aW9uczwv
aDI+CiAKLTxwPlRoZSA8dHQ+c3FsX2luc2VydDwvdHQ+IGFuZCA8dHQ+c3FsX3VwZGF0ZTwvdHQ+
IG9wdGlvbnMgYXJlCis8cD5UaGUgPHR0PnNxbF9hdXhwcm9wX2luc2VydDwvdHQ+IGFuZCA8dHQ+
c3FsX2F1eHByb3BfdXBkYXRlPC90dD4gb3B0aW9ucyBhcmUKIG9wdGlvbmFsIGFuZCBhcmUgb25s
eSBuZWVkZWQgaWYgeW91IHdpc2ggdG8gYWxsb3cgdGhlIFNBU0wgbGlicmFyeQogKGUuZy4sIHNh
c2xwYXNzd2QyKSBhbmQgcGx1Z2lucyAoZS5nLiwgT1RQKSB0byB3cml0ZSBwcm9wZXJ0aWVzIHRv
IHRoZQogU1FMIHNlcnZlci4gIElmIHVzZWQsIGJvdGggc3RhdGVtZW50cyBNVVNUIGJlIHByb3Zp
ZGVkIHNvIHRoYXQKIHByb3BlcnRpZXMgY2FuIGJlIGFkZGVkLCBjaGFuZ2VkIGFuZCBkZWxldGVk
LgogPGZvbnQgY29sb3I9cmVkPk5PVEU6IFRoZSBjb2x1bW5zIGZvciB3cml0YWJsZSBwcm9wZXJp
dGVzIE1VU1QgYWNjZXB0IE5VTEwgdmFsdWVzLjwvZm9udD4KIAotPHA+VGhlIFNRTCBzdGF0ZW1l
bnRzIHByb3ZpZGVkIGluIHRoZSA8dHQ+c3FsX3NlbGVjdDwvdHQ+LAotPHR0PnNxbF9pbnNlcnQ8
L3R0PiBhbmQgPHR0PnNxbF91cGRhdGU8L3R0PiBvcHRpb25zIGNhbiBjb250YWluCis8cD5UaGUg
U1FMIHN0YXRlbWVudHMgcHJvdmlkZWQgaW4gdGhlIDx0dD5zcWxfYXV4cHJvcF9zZWxlY3Q8L3R0
PiwKKzx0dD5zcWxfYXV4cHJvcF9pbnNlcnQ8L3R0PiBhbmQgPHR0PnNxbF9hdXhwcm9wX3VwZGF0
ZTwvdHQ+IG9wdGlvbnMgY2FuIGNvbnRhaW4KIGFyZ3VtZW50cyB3aGljaCB3aWxsIGJlIHN1YnN0
aXR1dGVkIHdpdGggdGhlIGFwcHJvcHJpYXRlIHZhbHVlcy4gIFRoZQogdmFsaWQgYXJndW1lbnRz
IGFyZToKIApAQCAtMjQ3LDcgKzI3Niw3IEBACiA8aDM+RXhhbXBsZXM6PC9oMz4KIAogPHByZT4K
LSAgICAgPHR0PnNxbF9zZWxlY3Q6IFNFTEVDVCAlcCBGUk9NIHVzZXJfdGFibGUgV0hFUkUgdXNl
cm5hbWUgPSAnJXUnIGFuZCByZWFsbSA9ICclcic8L3R0PgorICAgICA8dHQ+c3FsX2F1eHByb3Bf
c2VsZWN0OiBTRUxFQ1QgJXAgRlJPTSB1c2VyX3RhYmxlIFdIRVJFIHVzZXJuYW1lID0gJyV1JyBh
bmQgcmVhbG0gPSAnJXInPC90dD4KIDwvcHJlPgogCiAgICAgIHdvdWxkIHNlbmQgdGhlIGZvbGxv
d2luZyBzdGF0ZW1lbnQgdG8gU1FMIGZvciB1c2VyICJib3ZpayIgYW5kCkBAIC0yNjEsNyArMjkw
LDcgQEAKIDwvcHJlPgogCiA8cHJlPgotICAgICA8dHQ+c3FsX2luc2VydDogSU5TRVJUIElOVE8g
dXNlcl90YWJsZSAodXNlcm5hbWUsIHJlYWxtLCAlcCkgVkFMVUVTICgnJXUnLCAnJXInLCAnJXYn
KTwvdHQ+CisgICAgIDx0dD5zcWxfYXV4cHJvcF9pbnNlcnQ6IElOU0VSVCBJTlRPIHVzZXJfdGFi
bGUgKHVzZXJuYW1lLCByZWFsbSwgJXApIFZBTFVFUyAoJyV1JywgJyVyJywgJyV2Jyk8L3R0Pgog
CiA8L3ByZT4KIApAQCAtMjgxLDYgKzMxMCwxNyBAQAogPC9wcmU+CiBpcyBhIHZhbGlkIHZhbHVl
IGZvciA8dHQ+c3FsX3NlbGVjdDwvdHQ+LgogCis8aDI+Tm90ZXMgb24gU1FMIGNhbm9uIHVzZXIg
cGx1Z2luIG9wdGlvbnM8L2gyPgorPHA+VGhpcyBwbHVnaW4gc2hhcmVzIGFsbCBjb25maWd1cmF0
aW9uIHdpdGggU1FMIGF1eHByb3AgcGx1Z2luLiBUaGVyZWZvcmUgCit5b3UgaGF2ZSB0byBnaXZl
IG9wdGlvbnMgbGlrZSBzcWxfaG9zdG5hbWVzIGFuZCBzcWxfdXNlciBvbmx5IG9uY2UuCis8L3A+
Cis8cD5BbGwgYWJvdmUgZXhhbXBsZXMgZm9yIHNxbF9hdXhwcm9wX3NlbGVjdCBhcmUgdmFsaWQg
Zm9yIHNxbF9jYW5vbl9zZWxlY3QsIHRvby4KKzwvcD4KKzxwPk5PVEU6IFRoaXMgcGx1Z2luIHRl
c3RzIGZvciByZWN1cnNpb24gNSBpdGVyYXRpb25zLiAKKyhlLmcuIHRlc3RAdGVzdC5sb2NhbC0+
am9lQHRlc3QubG9jYWwtPmRvZUB0ZXN0LmxvY2FsLT50ZXN0QHRlc3QubG9jYWwtPmpvZUB0ZXN0
LmxvY2FsKQorQWZ0ZXIgdGhhdCBpdCBzdG9wcyB0aGUgcmVjdXJzaW9uIGF0IHRoZSBjdXJyZW50
IGVsZW1lbnQgYW5kIGlzc3VlcyBhIHdhcm5pbmcuCis8L3A+CisKIDxoMj5Ob3RlcyBvbiBMREFQ
REIgcGx1Z2luIG9wdGlvbnM8L2gyPgogCiA8cD4KZGlmZiAtdU5yIGN5cnVzLXNhc2wtMi4xLjI1
L3BsdWdpbnMvbWFrZWluaXQuc2ggY3lydXMtc2FzbC0yLjEuMjUtc3FsY2Fub24vcGx1Z2lucy9t
YWtlaW5pdC5zaAotLS0gY3lydXMtc2FzbC0yLjEuMjUvcGx1Z2lucy9tYWtlaW5pdC5zaAkyMDEx
LTA1LTExIDIxOjI1OjU1LjAwMDAwMDAwMCArMDIwMAorKysgY3lydXMtc2FzbC0yLjEuMjUtc3Fs
Y2Fub24vcGx1Z2lucy9tYWtlaW5pdC5zaAkyMDEyLTA3LTE2IDEyOjU4OjExLjQ5NzM1NzU1MiAr
MDIwMApAQCAtODksNSArODksNyBAQAogIiA+ICR7YXV4cHJvcH1faW5pdC5jCiBkb25lCiAKLSMg
bGRhcGRiIGlzIGFsc28gYSBjYW5vbl91c2VyIHBsdWdpbgorIyBsZGFwZGIgYW5kIHNxbCBhcmUg
YWxzbyBjYW5vbl91c2VyIHBsdWdpbnMKIGVjaG8gIlNBU0xfQ0FOT05VU0VSX1BMVUdfSU5JVCgg
bGRhcGRiICkiID4+IGxkYXBkYl9pbml0LmMKK2VjaG8gIlNBU0xfQ0FOT05VU0VSX1BMVUdfSU5J
VCggc3FsICkiID4+IHNxbF9pbml0LmMKKwpkaWZmIC11TnIgY3lydXMtc2FzbC0yLjEuMjUvcGx1
Z2lucy9zcWwuYyBjeXJ1cy1zYXNsLTIuMS4yNS1zcWxjYW5vbi9wbHVnaW5zL3NxbC5jCi0tLSBj
eXJ1cy1zYXNsLTIuMS4yNS9wbHVnaW5zL3NxbC5jCTIwMDktMTItMDMgMjA6MDc6MDIuMDAwMDAw
MDAwICswMTAwCisrKyBjeXJ1cy1zYXNsLTIuMS4yNS1zcWxjYW5vbi9wbHVnaW5zL3NxbC5jCTIw
MTItMDctMTYgMTI6NTg6MjEuMzYxMzY0MzgzICswMjAwCkBAIC0xLDggKzEsOSBAQAogLyoKICoq
Ci0qKiBTUUwgQXV4cHJvcCBwbHVnaW4KKyoqIFNRTCBBdXhwcm9wIGFuZCBDYW5vbiBwbHVnaW4K
ICoqCi0qKiBLZW4gTXVyY2hpc29uCisqKiBMYXJzIER1ZXNpbmcgLS0gY2Fub24gcGx1Z2luCisq
KiBLZW4gTXVyY2hpc29uIC0tIG9yaWdpbmFsIGF1eHByb3AgcGx1Z2luCiAqKiBNYXlhIE5pZ3Jv
c2ggLS0gb3JpZ2luYWwgc3RvcmUoKSBhbmQgdHhuIHN1cHBvcnQKICoqIFNpbW9uIExvYWRlciAt
LSBvcmlnaW5hbCBteXNxbCBwbHVnaW4KICoqIFBhdHJpY2sgV2VsY2hlIC0tIG9yaWdpbmFsIHBn
c3FsIHBsdWdpbgpAQCAtNTAsOSArNTEsMTAgQEAKICAgICBjb25zdCBjaGFyICpzcWxfcGFzc3dk
OwogICAgIGNvbnN0IGNoYXIgKnNxbF9ob3N0bmFtZXM7CiAgICAgY29uc3QgY2hhciAqc3FsX2Rh
dGFiYXNlOwotICAgIGNvbnN0IGNoYXIgKnNxbF9zZWxlY3Q7Ci0gICAgY29uc3QgY2hhciAqc3Fs
X2luc2VydDsKLSAgICBjb25zdCBjaGFyICpzcWxfdXBkYXRlOworICAgIGNvbnN0IGNoYXIgKnNx
bF9hdXhwcm9wX3NlbGVjdDsKKyAgICBjb25zdCBjaGFyICpzcWxfY2Fub25fc2VsZWN0OworICAg
IGNvbnN0IGNoYXIgKnNxbF9hdXhwcm9wX2luc2VydDsKKyAgICBjb25zdCBjaGFyICpzcWxfYXV4
cHJvcF91cGRhdGU7CiAgICAgaW50IHNxbF91c2Vzc2w7CiB9IHNxbF9zZXR0aW5nc190OwogCkBA
IC03OTksMjcgKzgwMSw2NCBAQAogCXNldHRpbmdzLT5zcWxfZGF0YWJhc2UgPSBTUUxfQkxBTktf
U1RSSU5HOwogICAgIH0KIAotICAgIHIgPSB1dGlscy0+Z2V0b3B0KHV0aWxzLT5nZXRvcHRfY29u
dGV4dCwiU1FMIiwgInNxbF9zZWxlY3QiLAotCQkgICAgICAmc2V0dGluZ3MtPnNxbF9zZWxlY3Qs
IE5VTEwpOwotICAgIGlmIChyIHx8ICFzZXR0aW5ncy0+c3FsX3NlbGVjdCApIHsKKyAgICByID0g
dXRpbHMtPmdldG9wdCh1dGlscy0+Z2V0b3B0X2NvbnRleHQsIlNRTCIsICJzcWxfYXV4cHJvcF9z
ZWxlY3QiLAorCQkgICAgICAmc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3NlbGVjdCwgTlVMTCk7Cisg
ICAgaWYgKHIgfHwgIXNldHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxlY3QgKSB7CiAJLyogYmFja3dh
cmRzIGNvbXBhdGliaWxpdHkgKi8KKwlyID0gdXRpbHMtPmdldG9wdCh1dGlscy0+Z2V0b3B0X2Nv
bnRleHQsIlNRTCIsICJzcWxfc2VsZWN0IiwKKwkJCSAgJnNldHRpbmdzLT5zcWxfYXV4cHJvcF9z
ZWxlY3QsIE5VTEwpOworCWlmIChyIHx8ICFzZXR0aW5ncy0+c3FsX2F1eHByb3Bfc2VsZWN0KSB7
CiAJciA9IHV0aWxzLT5nZXRvcHQodXRpbHMtPmdldG9wdF9jb250ZXh0LCJTUUwiLCAic3FsX3N0
YXRlbWVudCIsCi0JCQkgICZzZXR0aW5ncy0+c3FsX3NlbGVjdCwgTlVMTCk7Ci0JaWYgKHIgfHwg
IXNldHRpbmdzLT5zcWxfc2VsZWN0KSB7Ci0JICAgIHNldHRpbmdzLT5zcWxfc2VsZWN0ID0gU1FM
X0JMQU5LX1NUUklORzsKLQl9Ci0gICAgfQotCisJCQkgICZzZXR0aW5ncy0+c3FsX2F1eHByb3Bf
c2VsZWN0LCBOVUxMKTsKKwkgICAgaWYgKHIgfHwgIXNldHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxl
Y3QpIHsKKwkgICAgICAgIHNldHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxlY3QgPSBTUUxfQkxBTktf
U1RSSU5HOworCSAgICB9IGVsc2UKKyAgICAgICAgICAgIHsKKyAgICAgICAgICAgICAgICB1dGls
cy0+bG9nKE5VTEwsIFNBU0xfTE9HX1dBUk4sCisJCSAgICJzcWwgcGx1Z2luOiBPcHRpb24gc3Fs
X3N0YXRlbWVudCBpcyBkZXByZWNhdGVkLCB1c2Ugc3FsX2F1eHByb3Bfc2VsZWN0IGluc3RlYWQh
Iik7CisgICAgICAgICAgICB9CisgICAgICAgIH0KKyAgICAgICAgZWxzZQorICAgICAgICB7Cisg
ICAgICAgICAgICB1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX1dBUk4sCisgICAgICAgIAkgICAi
c3FsIHBsdWdpbjogT3B0aW9uIHNxbF9zZWxlY3QgaXMgZGVwcmVjYXRlZCwgdXNlIHNxbF9hdXhw
cm9wX3NlbGVjdCBpbnN0ZWFkISIpOworCX0KKyAgICAgICAgICAgIAorICAgIH0KKworICAgIHIg
PSB1dGlscy0+Z2V0b3B0KHV0aWxzLT5nZXRvcHRfY29udGV4dCwgIlNRTCIsICJzcWxfY2Fub25f
c2VsZWN0IiwKKwkJICAgICAgJnNldHRpbmdzLT5zcWxfY2Fub25fc2VsZWN0LCBOVUxMKTsKKyAg
ICBpZiAociB8fCAhc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QpIHsKKwlzZXR0aW5ncy0+c3Fs
X2Nhbm9uX3NlbGVjdCA9IFNRTF9CTEFOS19TVFJJTkc7CisgICAgfQorCisgICAgciA9IHV0aWxz
LT5nZXRvcHQodXRpbHMtPmdldG9wdF9jb250ZXh0LCAiU1FMIiwgInNxbF9hdXhwcm9wX2luc2Vy
dCIsCisJCSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0LCBOVUxMKTsKKyAgICBp
ZiAociB8fCAhc2V0dGluZ3MtPnNxbF9hdXhwcm9wX2luc2VydCkgewogICAgIHIgPSB1dGlscy0+
Z2V0b3B0KHV0aWxzLT5nZXRvcHRfY29udGV4dCwgIlNRTCIsICJzcWxfaW5zZXJ0IiwKLQkJICAg
ICAgJnNldHRpbmdzLT5zcWxfaW5zZXJ0LCBOVUxMKTsKLSAgICBpZiAociB8fCAhc2V0dGluZ3Mt
PnNxbF9pbnNlcnQpIHsKLQlzZXR0aW5ncy0+c3FsX2luc2VydCA9IFNRTF9CTEFOS19TVFJJTkc7
CisJCSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfaW5zZXJ0LCBOVUxMKTsKKyAgICAgICAg
aWYgKHIgfHwgIXNldHRpbmdzLT5zcWxfYXV4cHJvcF9pbnNlcnQpIHsKKwkgICAgc2V0dGluZ3Mt
PnNxbF9hdXhwcm9wX2luc2VydCA9IFNRTF9CTEFOS19TVFJJTkc7CisJfSBlbHNlCisgICAgICAg
IHsKKyAgICAgICAgICAgIHV0aWxzLT5sb2coTlVMTCwgU0FTTF9MT0dfV0FSTiwKKwkJICAgInNx
bCBwbHVnaW46IE9wdGlvbiBzcWxfaW5zZXJ0IGlzIGRlcHJlY2F0ZWQsIHVzZSBzcWxfYXV4cHJv
cF9pbnNlcnQgaW5zdGVhZCEiKTsKKyAgICAgICAgfQorCiAgICAgfQogCisgICAgciA9IHV0aWxz
LT5nZXRvcHQodXRpbHMtPmdldG9wdF9jb250ZXh0LCAiU1FMIiwgInNxbF9hdXhwcm9wX3VwZGF0
ZSIsCisJCSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfdXBkYXRlLCBOVUxMKTsKKyAgICBp
ZiAociB8fCAhc2V0dGluZ3MtPnNxbF9hdXhwcm9wX3VwZGF0ZSkgewogICAgIHIgPSB1dGlscy0+
Z2V0b3B0KHV0aWxzLT5nZXRvcHRfY29udGV4dCwgIlNRTCIsICJzcWxfdXBkYXRlIiwKLQkJICAg
ICAgJnNldHRpbmdzLT5zcWxfdXBkYXRlLCBOVUxMKTsKLSAgICBpZiAociB8fCAhc2V0dGluZ3Mt
PnNxbF91cGRhdGUpIHsKLQlzZXR0aW5ncy0+c3FsX3VwZGF0ZSA9IFNRTF9CTEFOS19TVFJJTkc7
CisJCSAgICAgICZzZXR0aW5ncy0+c3FsX2F1eHByb3BfdXBkYXRlLCBOVUxMKTsKKyAgICAgICAg
aWYgKHIgfHwgIXNldHRpbmdzLT5zcWxfYXV4cHJvcF91cGRhdGUpIHsKKwkgICAgc2V0dGluZ3Mt
PnNxbF9hdXhwcm9wX3VwZGF0ZSA9IFNRTF9CTEFOS19TVFJJTkc7CisgICAgICAgIH0gZWxzZQor
ICAgICAgICB7CisgICAgICAgICAgICB1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX1dBUk4sCisJ
CSAgICJzcWwgcGx1Z2luOiBPcHRpb24gc3FsX3VwZGF0ZSBpcyBkZXByZWNhdGVkLCB1c2Ugc3Fs
X2F1eHByb3BfdXBkYXRlIGluc3RlYWQhIik7CisgICAgICAgIH0KICAgICB9CiAKICAgICByID0g
dXRpbHMtPmdldG9wdCh1dGlscy0+Z2V0b3B0X2NvbnRleHQsICJTUUwiLCAic3FsX3VzZXNzbCIs
CkBAIC05MTgsNyArOTU3LDcgQEAKICAgICBzZXR0aW5ncyA9IChzcWxfc2V0dGluZ3NfdCAqKSBn
bG9iX2NvbnRleHQ7CiAgICAgCiAgICAgc3BhcmFtcy0+dXRpbHMtPmxvZyhOVUxMLCBTQVNMX0xP
R19ERUJVRywKLQkJCSJzcWwgcGx1Z2luIFBhcnNlIHRoZSB1c2VybmFtZSAlc1xuIiwgdXNlcik7
CisJCQkic3FsX2F1eHByb3AgcGx1Z2luIFBhcnNlIHRoZSB1c2VybmFtZSAlc1xuIiwgdXNlcik7
CiAgICAgCiAgICAgdXNlcl9idWYgPSBzcGFyYW1zLT51dGlscy0+bWFsbG9jKHVsZW4gKyAxKTsK
ICAgICBpZiAoIXVzZXJfYnVmKSB7CkBAIC05NjcsNyArMTAwNiw3IEBACiAgICAgY29ubiA9IHNx
bF9jb25uZWN0KHNldHRpbmdzLCBzcGFyYW1zLT51dGlscyk7CiAgICAgaWYgKCFjb25uKSB7CiAJ
c3BhcmFtcy0+dXRpbHMtPmxvZyhOVUxMLCBTQVNMX0xPR19FUlIsCi0JCQkgICAgInNxbCBwbHVn
aW4gY291bGRuJ3QgY29ubmVjdCB0byBhbnkgaG9zdFxuIik7CisJCQkgICAgInNxbF9hdXhwcm9w
IHBsdWdpbiBjb3VsZG4ndCBjb25uZWN0IHRvIGFueSBob3N0XG4iKTsKIAkvKiBUT0RPOiBpbiB0
aGUgZnV0dXJlIHdlIG1pZ2h0IHdhbnQgdG8gZXh0ZW5kIHRoZSBpbnRlcm5hbAogCSAgIFNRTCBk
cml2ZXIgQVBJIHRvIHJldHVybiBhIG1vcmUgZGV0YWlsZWQgZXJyb3IgKi8KIAlyZXQgPSBTQVNM
X0ZBSUw7CkBAIC0xMDIyLDExICsxMDYxLDExIEBACiAJfQogICAgIAogCXNwYXJhbXMtPnV0aWxz
LT5sb2coTlVMTCwgU0FTTF9MT0dfREVCVUcsCi0JCQkgICAgInNxbCBwbHVnaW4gY3JlYXRlIHN0
YXRlbWVudCBmcm9tICVzICVzICVzXG4iLAorCQkJICAgICJzcWxfYXV4cHJvcCBwbHVnaW4gY3Jl
YXRlIHN0YXRlbWVudCBmcm9tICVzICVzICVzXG4iLAogCQkJICAgIHJlYWxuYW1lLCBlc2NhcF91
c2VyaWQsIGVzY2FwX3JlYWxtKTsKIAkKIAkvKiBjcmVhdGUgYSBzdGF0ZW1lbnQgdGhhdCB3ZSB3
aWxsIHVzZSAqLwotCXF1ZXJ5ID0gc3FsX2NyZWF0ZV9zdGF0ZW1lbnQoc2V0dGluZ3MtPnNxbF9z
ZWxlY3QsCisJcXVlcnkgPSBzcWxfY3JlYXRlX3N0YXRlbWVudChzZXR0aW5ncy0+c3FsX2F1eHBy
b3Bfc2VsZWN0LAogCQkJCSAgICAgcmVhbG5hbWUsZXNjYXBfdXNlcmlkLAogCQkJCSAgICAgZXNj
YXBfcmVhbG0sIE5VTEwsCiAJCQkJICAgICBzcGFyYW1zLT51dGlscyk7CkBAIC0xMDM2LDcgKzEw
NzUsNyBAQAogCX0KIAkKIAlzcGFyYW1zLT51dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX0RFQlVH
LAotCQkJICAgICJzcWwgcGx1Z2luIGRvaW5nIHF1ZXJ5ICVzXG4iLCBxdWVyeSk7CisJCQkgICAg
InNxbF9hdXhwcm9wIHBsdWdpbiBkb2luZyBxdWVyeSAlc1xuIiwgcXVlcnkpOwogCQogCXZhbHVl
WzBdID0gJ1wwJzsKIAl2YWx1ZV9sZW4gPSAwOwpAQCAtMTA3MywxMyArMTExMiwxMyBAQAogCSAg
ICB9CiAKIAkgICAgc3BhcmFtcy0+dXRpbHMtPmxvZyhOVUxMLCBTQVNMX0xPR19ERUJVRywKLQkJ
CQkic3FsIHBsdWdpbiBjcmVhdGUgc3RhdGVtZW50IGZyb20gJXMgJXMgJXNcbiIsCisJCQkJInNx
bF9hdXhwcm9wIHBsdWdpbiBjcmVhdGUgc3RhdGVtZW50IGZyb20gJXMgJXMgJXNcbiIsCiAJCQkJ
U0FTTF9BVVhfUEFTU1dPUkRfUFJPUCwKIAkJCQllc2NhcF91c2VyaWQsCiAJCQkJZXNjYXBfcmVh
bG0pOwogICAgIAkKIAkgICAgLyogY3JlYXRlIGEgc3RhdGVtZW50IHRoYXQgd2Ugd2lsbCB1c2Ug
Ki8KLQkgICAgcXVlcnkgPSBzcWxfY3JlYXRlX3N0YXRlbWVudChzZXR0aW5ncy0+c3FsX3NlbGVj
dCwKKwkgICAgcXVlcnkgPSBzcWxfY3JlYXRlX3N0YXRlbWVudChzZXR0aW5ncy0+c3FsX2F1eHBy
b3Bfc2VsZWN0LAogCQkJCQkgU0FTTF9BVVhfUEFTU1dPUkRfUFJPUCwKIAkJCQkJIGVzY2FwX3Vz
ZXJpZCwKIAkJCQkJIGVzY2FwX3JlYWxtLApAQCAtMTA4OSw3ICsxMTI4LDcgQEAKIAkJcmV0ID0g
U0FTTF9OT01FTTsKIAkgICAgfSBlbHNlIHsKIAkJc3BhcmFtcy0+dXRpbHMtPmxvZyhOVUxMLCBT
QVNMX0xPR19ERUJVRywKLQkJCQkgICAgInNxbCBwbHVnaW4gZG9pbmcgcXVlcnkgJXNcbiIsIHF1
ZXJ5KTsKKwkJCQkgICAgInNxbF9hdXhwcm9wIHBsdWdpbiBkb2luZyBxdWVyeSAlc1xuIiwgcXVl
cnkpOwogICAgICAgICAJCiAJCXZhbHVlWzBdID0gJ1wwJzsKIAkJdmFsdWVfbGVuID0gMDsKQEAg
LTExNTQsOCArMTE5Myw4IEBACiAKICAgICAvKiBqdXN0IGNoZWNraW5nIGlmIHdlIGFyZSBlbmFi
bGVkICovCiAgICAgaWYgKCFjdHggJiYKLQlzcWxfZXhpc3RzKHNldHRpbmdzLT5zcWxfaW5zZXJ0
KSAmJgotCXNxbF9leGlzdHMoc2V0dGluZ3MtPnNxbF91cGRhdGUpKSByZXR1cm4gU0FTTF9PSzsK
KwlzcWxfZXhpc3RzKHNldHRpbmdzLT5zcWxfYXV4cHJvcF9pbnNlcnQpICYmCisJc3FsX2V4aXN0
cyhzZXR0aW5ncy0+c3FsX2F1eHByb3BfdXBkYXRlKSkgcmV0dXJuIFNBU0xfT0s7CiAgICAgCiAg
ICAgLyogbWFrZSBzdXJlIG91ciBpbnB1dCBpcyBva2F5ICovCiAgICAgaWYgKCFnbG9iX2NvbnRl
eHQgfHwgIXNwYXJhbXMgfHwgIXVzZXIpIHJldHVybiBTQVNMX0JBRFBBUkFNOwpAQCAtMTIyMywx
NyArMTI2MiwxNyBAQAogCiAJLyogZGV0ZXJtaW5lIHdoaWNoIGNvbW1hbmQgd2UgbmVlZCAqLwog
CS8qIHNlZSBpZiB3ZSBhbHJlYWR5IGhhdmUgYSByb3cgZm9yIHRoaXMgdXNlciAqLwotCXN0YXRl
bWVudCA9IHNxbF9jcmVhdGVfc3RhdGVtZW50KHNldHRpbmdzLT5zcWxfc2VsZWN0LAorCXN0YXRl
bWVudCA9IHNxbF9jcmVhdGVfc3RhdGVtZW50KHNldHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxlY3Qs
CiAJCQkJCSBTUUxfV0lMRENBUkQsIGVzY2FwX3VzZXJpZCwKIAkJCQkJIGVzY2FwX3JlYWxtLCBO
VUxMLAogCQkJCQkgc3BhcmFtcy0+dXRpbHMpOwogCWlmICghc2V0dGluZ3MtPnNxbF9lbmdpbmUt
PnNxbF9leGVjKGNvbm4sIHN0YXRlbWVudCwgTlVMTCwgMCwgTlVMTCwKIAkJCQkJICAgIHNwYXJh
bXMtPnV0aWxzKSkgewogCSAgICAvKiBhbHJlYWR5IGhhdmUgYSByb3cgPT4gVVBEQVRFICovCi0J
ICAgIGNtZCA9IHNldHRpbmdzLT5zcWxfdXBkYXRlOworCSAgICBjbWQgPSBzZXR0aW5ncy0+c3Fs
X2F1eHByb3BfdXBkYXRlOwogCX0gZWxzZSB7CiAJICAgIC8qIG5ldyByb3cgPT4gSU5TRVJUICov
Ci0JICAgIGNtZCA9IHNldHRpbmdzLT5zcWxfaW5zZXJ0OworCSAgICBjbWQgPSBzZXR0aW5ncy0+
c3FsX2F1eHByb3BfaW5zZXJ0OwogCX0KIAlzcGFyYW1zLT51dGlscy0+ZnJlZShzdGF0ZW1lbnQp
OwogCkBAIC0xMjkyLDcgKzEzMzEsNiBAQAogICAgIC8qIGRvIGEgbGl0dGxlIGRhbmNlICovCiB9
CiAKLQogc3RhdGljIHZvaWQgc3FsX2F1eHByb3BfZnJlZSh2b2lkICpnbG9iX2NvbnRleHQsIGNv
bnN0IHNhc2xfdXRpbHNfdCAqdXRpbHMpCiB7CiAgICAgc3FsX3NldHRpbmdzX3QgKnNldHRpbmdz
OwpAQCAtMTMwNiw2ICsxMzQ0LDIxOSBAQAogICAgIHV0aWxzLT5mcmVlKHNldHRpbmdzKTsKIH0K
IAorCitzdGF0aWMgaW50CitzcWxfY2Fub25fc2VydmVyICh2b2lkICpnbG9iX2NvbnRleHQsCisJ
CQkgICAgICAgc2FzbF9zZXJ2ZXJfcGFyYW1zX3QgKiBzcGFyYW1zLAorCQkJICAgICAgIGNvbnN0
IGNoYXIgKnVzZXIsIHVuc2lnbmVkIHVsZW4sCisJCQkgICAgICAgdW5zaWduZWQgZmxhZ3MgX19h
dHRyaWJ1dGVfXygodW51c2VkKSksCisJCQkgICAgICAgY2hhciAqb3V0X3VzZXIsCisJCQkgICAg
ICAgdW5zaWduZWQgb3V0X3VtYXgsIHVuc2lnbmVkICpvdXRfdWxlbikKK3sKKyAgc3BhcmFtcy0+
dXRpbHMtPnNldGVycm9yIChzcGFyYW1zLT51dGlscy0+Y29ubiwgMCwgInNxbF9jYW5vbl9zZXJ2
ZXIiKTsKKworICBjaGFyICp1c2VyaWQgPSBOVUxMOworICAvKiByZWFsbSBjb3VsZCBiZSB1c2Vk
IGZvciBzb21ldGhpbmcgY2xldmVyICovCisgIGNoYXIgKnJlYWxtID0gTlVMTDsKKyAgY29uc3Qg
Y2hhciAqdXNlcl9yZWFsbSA9IE5VTEw7CisgIGNoYXIgdmFsdWVbODE5Ml07CisgIHNpemVfdCB2
YWx1ZV9sZW47CisgIGNoYXIgb2xkX3ZhbHVlWzgxOTJdOworICBzaXplX3Qgb2xkX3ZhbHVlX2xl
bjsKKyAgY2hhciAqcXVlcnkgPSBOVUxMOworICBjaGFyICplc2NhcF91c2VyaWQgPSBOVUxMOwor
ICBjaGFyICplc2NhcF9yZWFsbSA9IE5VTEw7CisgIHNxbF9zZXR0aW5nc190ICpzZXR0aW5nczsK
KyAgdm9pZCAqY29ubiA9IE5VTEw7CisgIHVuc2lnbmVkIGk7CisgIGNoYXIgKmluX2J1ZiwgKnVz
ZXJpbjsKKyAgY29uc3QgY2hhciAqYmVnaW5fdTsKKyAgc2l6ZV90IHVfYXBwcmVhbG0gPSAwOwor
CisgIGlmICghZ2xvYl9jb250ZXh0IHx8ICFzcGFyYW1zLT51dGlscyB8fCAhdXNlcikKKyAgICBy
ZXR1cm4gU0FTTF9CQURQQVJBTTsKKworICAgIHNwYXJhbXMtPnV0aWxzLT5sb2coTlVMTCwgU0FT
TF9MT0dfREVCVUcsCisgICAgICAgICAgICAgICAgICAgICAgICAic3FsX2Nhbm9uX3NlcnZlciBQ
YXJzZSB0aGUgdXNlcm5hbWUgJXNcbiIsIHVzZXIpOworCisKKyAgaW5fYnVmID0gc3BhcmFtcy0+
dXRpbHMtPm1hbGxvYyAoKHVsZW4gKyAyKSAqIHNpemVvZiAoY2hhcikpOworICBpZiAoIWluX2J1
ZikKKyAgICByZXR1cm4gU0FTTF9OT01FTTsKKworICB1c2VyaW4gPSBpbl9idWY7CisKKyAgbWVt
Y3B5ICh1c2VyaW4sIHVzZXIsIHVsZW4pOworICB1c2VyaW5bdWxlbl0gPSAnXDAnOworCisKKyAg
Zm9yIChpID0gMDsgaXNzcGFjZSAoKGludCkgdXNlcmluW2ldKSAmJiBpIDwgdWxlbjsgaSsrKTsK
KyAgYmVnaW5fdSA9ICYodXNlcmluW2ldKTsKKyAgaWYgKGkgPiAwKQorICAgIHVsZW4gLT0gaTsK
KworICBmb3IgKDsgdWxlbiA+IDAgJiYgaXNzcGFjZSAoKGludCkgYmVnaW5fdVt1bGVuIC0gMV0p
OyB1bGVuLS0pOworICBpZiAoYmVnaW5fdSA9PSAmKHVzZXJpblt1bGVuXSkpCisgICAgeworICAg
ICAgc3BhcmFtcy0+dXRpbHMtPmZyZWUgKGluX2J1Zik7CisgICAgICBzcGFyYW1zLT51dGlscy0+
c2V0ZXJyb3IgKHNwYXJhbXMtPnV0aWxzLT5jb25uLCAwLAorCQkJCSJBbGwtd2hpdGVzcGFjZSB1
c2VybmFtZS4iKTsKKyAgICAgIHJldHVybiBTQVNMX0ZBSUw7CisgICAgfQorCisgIC8qIE5lZWQg
dG8gYXBwZW5kIHJlYWxtIGlmIG5lY2Vzc2FyeSAoc2VlIHNhc2wuaCkgKi8KKyAgaWYgKHNwYXJh
bXMtPnVzZXJfcmVhbG0pCisgICAgeworICAgICAgdXNlcl9yZWFsbSA9IHNwYXJhbXMtPnVzZXJf
cmVhbG07CisgICAgfQorICBlbHNlCisgICAgeworICAgICAgdXNlcl9yZWFsbSA9IHNwYXJhbXMt
PnNlcnZlckZRRE47CisgICAgfQorCisgIGlmICghc3RyY2hyICh1c2VyLCAnQCcpKQorICAgIHsK
KyAgICAgIHVfYXBwcmVhbG0gPSBzdHJsZW4gKHVzZXJfcmVhbG0pICsgMTsKKyAgICB9CisKKyAg
Lyogc2V0dXAgdGhlIHNldHRpbmdzICovCisgIHNldHRpbmdzID0gKHNxbF9zZXR0aW5nc190ICop
IGdsb2JfY29udGV4dDsKKworICAvKiBqdXN0IG5lZWQgdG8gZXNjYXBlIHVzZXJpZCBhbmQgcmVh
bG0gbm93ICovCisgIC8qIGFsbG9jYXRlIHNvbWUgbWVtb3J5ICovCisgIGVzY2FwX3VzZXJpZCA9
IChjaGFyICopIHNwYXJhbXMtPnV0aWxzLT5tYWxsb2MgKDI1NSk7CisgIGVzY2FwX3JlYWxtID0g
KGNoYXIgKikgc3BhcmFtcy0+dXRpbHMtPm1hbGxvYyAoMjU1KTsKKworICBpZiAoIWVzY2FwX3Vz
ZXJpZCB8fCAhZXNjYXBfcmVhbG0pCisgICAgeworICAgICAgc3BhcmFtcy0+dXRpbHMtPmxvZyAo
TlVMTCwgU0FTTF9MT0dfREVCVUcsCisJCQkgICAic3FsX2Nhbm9uX3NlcnZlcjogbWVtZXJyb3Ig
XG4iKTsKKyAgICAgIE1FTUVSUk9SIChzcGFyYW1zLT51dGlscyk7CisgICAgICBnb3RvIGRvbmU7
CisgICAgfQorCisgIGNvbm4gPSBzcWxfY29ubmVjdCAoc2V0dGluZ3MsIHNwYXJhbXMtPnV0aWxz
KTsKKyAgaWYgKCFjb25uKQorICAgIHsKKyAgICAgIHNwYXJhbXMtPnV0aWxzLT5sb2cgKE5VTEws
IFNBU0xfTE9HX0VSUiwKKwkJCSAgICJzcWxfY2Fub25fc2VydmVyIGNvdWxkbid0IGNvbm5lY3Qg
dG8gYW55IGhvc3RcbiIpOworICAgICAgZ290byBkb25lOworICAgIH0KKworICAvKiBlc2NhcGUg
b3V0ICovCisgIHNldHRpbmdzLT5zcWxfZW5naW5lLT5zcWxfZXNjYXBlX3N0ciAoZXNjYXBfdXNl
cmlkLCB1c2VyaW4pOworICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+c3FsX2VzY2FwZV9zdHIgKGVz
Y2FwX3JlYWxtLCB1c2VyX3JlYWxtKTsKKworICAvKiBjcmVhdGUgYSBzdGF0ZW1lbnQgdGhhdCB3
ZSB3aWxsIHVzZSAqLworICBzcGFyYW1zLT51dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX0RFQlVH
LAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICJzcWxfY2Fub24gcGx1Z2luIGNyZWF0ZSBz
dGF0ZW1lbnQgZnJvbSAlcyAlc1xuIiwKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICBlc2Nh
cF91c2VyaWQsIGVzY2FwX3JlYWxtKTsKKworICBxdWVyeSA9IHNxbF9jcmVhdGVfc3RhdGVtZW50
IChzZXR0aW5ncy0+c3FsX2Nhbm9uX3NlbGVjdCwKKwkJCQllc2NhcF91c2VyaWQsIGVzY2FwX3Vz
ZXJpZCwKKwkJCQllc2NhcF9yZWFsbSwgTlVMTCwgc3BhcmFtcy0+dXRpbHMpOworICBtZW1jcHko
b2xkX3ZhbHVlLHVzZXJpbiwgc3RybGVuICh1c2VyaW4pKTsKKyAgb2xkX3ZhbHVlX2xlbiA9IHN0
cmxlbiAodXNlcmluKTsKKyAgLyogcnVuIHRoZSBxdWVyeSAqLworICBzcGFyYW1zLT51dGlscy0+
bG9nKE5VTEwsIFNBU0xfTE9HX0RFQlVHLAorICAgICAgICAgICAgICAgICAgICAgICAgICAgICJz
cWxfY2Fub24gcGx1Z2luIGRvaW5nIHF1ZXJ5ICVzXG4iLCBxdWVyeSk7CisgIGludCByZWN1cnNp
b25fY291bnQ9MDsKKyAgd2hpbGUgKCFzZXR0aW5ncy0+c3FsX2VuZ2luZS0+c3FsX2V4ZWMgKGNv
bm4sIHF1ZXJ5LCB2YWx1ZSwgc2l6ZW9mICh2YWx1ZSksCisJCQkJICAgICAgICZ2YWx1ZV9sZW4s
IHNwYXJhbXMtPnV0aWxzKSAmJiAocmVjdXJzaW9uX2NvdW50IDwgNSkpCisgICAgeworCXJlY3Vy
c2lvbl9jb3VudCsrOworCWlmIChzdHJjbXAodmFsdWUsIG9sZF92YWx1ZSkgPT0gMCkgCisJewor
ICAgICAgICAJc3BhcmFtcy0+dXRpbHMtPmxvZyhOVUxMLCBTQVNMX0xPR19XQVJOLAorICAgICAg
ICAgICAgICAgICAgICJzcWxfY2Fub24gcGx1Z2luOiBmb3VuZCBkaXJlY3QgcmVjdXJzaXZlIHF1
ZXJ5IGZvciAlcyAlcyBhdCAlcyIsIHVzZXJpbiwgdXNlcl9yZWFsbSwgdmFsdWUpOworCQlyZWN1
cnNpb25fY291bnQ9MjU1OworCX0KKworICAgICAgICBtZW1jcHkob2xkX3ZhbHVlLHZhbHVlLHZh
bHVlX2xlbik7CisgICAgICAgIG9sZF92YWx1ZV9sZW49dmFsdWVfbGVuOworICAgICAgICBzZXR0
aW5ncy0+c3FsX2VuZ2luZS0+c3FsX2VzY2FwZV9zdHIgKGVzY2FwX3VzZXJpZCwgdmFsdWUpOwor
ICAgICAgICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+c3FsX2VzY2FwZV9zdHIgKGVzY2FwX3JlYWxt
LCB1c2VyX3JlYWxtKTsKKyAgICAgICAgc3BhcmFtcy0+dXRpbHMtPmxvZyhOVUxMLCBTQVNMX0xP
R19ERUJVRywKKyAgICAgICAgICAgICAgICAgICAgICAgICAgICAic3FsX2Nhbm9uIHBsdWdpbiBj
cmVhdGUgc3RhdGVtZW50IGZyb20gJXMgJXNcbiIsCisgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgZXNjYXBfdXNlcmlkLCBlc2NhcF9yZWFsbSk7CisKKyAgLyogY3JlYXRlIGEgc3RhdGVtZW50
IHRoYXQgd2Ugd2lsbCB1c2UgKi8KKyAgICAgICAgcXVlcnkgPSBzcWxfY3JlYXRlX3N0YXRlbWVu
dCAoc2V0dGluZ3MtPnNxbF9jYW5vbl9zZWxlY3QsCisJCQkJZXNjYXBfdXNlcmlkLCBlc2NhcF91
c2VyaWQsCisJCQkJZXNjYXBfcmVhbG0sIE5VTEwsIHNwYXJhbXMtPnV0aWxzKTsKKyAgICAgICBz
cGFyYW1zLT51dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX0RFQlVHLAorICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICJzcWxfY2Fub24gcGx1Z2luIGRvaW5nIHF1ZXJ5ICVzXG4iLCBxdWVyeSk7
CisKKwl9CisJaWYgKHJlY3Vyc2lvbl9jb3VudD41KQorICAgICAgICB7CisJCXNwYXJhbXMtPnV0
aWxzLT5sb2coTlVMTCwgU0FTTF9MT0dfV0FSTiwKKyAgICAgICAgICAgICAgICAgICJzcWxfY2Fu
b24gcGx1Z2luOiBmb3VuZCByZWN1cnNpdmUgcXVlcnkgZm9yICVzICVzIGF0ICVzIiwgdXNlcmlu
LCB1c2VyX3JlYWxtLCB2YWx1ZSk7CisJfQorCisgICAgICBpZiAob2xkX3ZhbHVlX2xlbiA8IG91
dF91bWF4KQorCXsKKwkgIG1lbWNweSAob3V0X3VzZXIsIG9sZF92YWx1ZSwgb2xkX3ZhbHVlX2xl
bik7CisJICBvdXRfdXNlcltvbGRfdmFsdWVfbGVuXSA9ICdcMCc7CisJICAqb3V0X3VsZW4gPSBv
bGRfdmFsdWVfbGVuOyAKKyAgICB9CisgICAgICBlbHNlCisJeworCSAgTUVNRVJST1IgKHNwYXJh
bXMtPnV0aWxzKTsKKwkgIGdvdG8gZG9uZTsKKyAgICB9CisgIHNwYXJhbXMtPnV0aWxzLT5mcmVl
IChxdWVyeSk7CisKK2RvbmU6CisgIGlmIChlc2NhcF91c2VyaWQpCisgICAgc3BhcmFtcy0+dXRp
bHMtPmZyZWUgKGVzY2FwX3VzZXJpZCk7CisgIGlmIChlc2NhcF9yZWFsbSkKKyAgICBzcGFyYW1z
LT51dGlscy0+ZnJlZSAoZXNjYXBfcmVhbG0pOworICBpZiAoY29ubikKKyAgICBzZXR0aW5ncy0+
c3FsX2VuZ2luZS0+c3FsX2Nsb3NlIChjb25uKTsKKyAgaWYgKHVzZXJpZCkKKyAgICBzcGFyYW1z
LT51dGlscy0+ZnJlZSAodXNlcmlkKTsKKyAgaWYgKHJlYWxtKQorICAgIHNwYXJhbXMtPnV0aWxz
LT5mcmVlIChyZWFsbSk7CisgIHJldHVybiBTQVNMX09LOworfQorCitzdGF0aWMgaW50CitzcWxf
Y2Fub25fY2xpZW50KHZvaWQgKmdsb2JfY29udGV4dCBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwK
KwkJICAgIHNhc2xfY2xpZW50X3BhcmFtc190ICpjcGFyYW1zLAorCQkgICAgY29uc3QgY2hhciAq
dXNlciwKKwkJICAgIHVuc2lnbmVkIHVsZW4sCisJCSAgICB1bnNpZ25lZCBmbGFncyBfX2F0dHJp
YnV0ZV9fKCh1bnVzZWQpKSwKKwkJICAgIGNoYXIgKm91dCwKKwkJICAgIHVuc2lnbmVkIG91dF9t
YXgsCisJCSAgICB1bnNpZ25lZCAqb3V0X3VsZW4peworICAgIGlmKCFjcGFyYW1zIHx8ICF1c2Vy
KSByZXR1cm4gU0FTTF9CQURQQVJBTTsKKworICAgIC8qIFRyaW0gd2hpdGVzcGFjZSAqLworICAg
IHdoaWxlKGlzc3BhY2UoKih1bnNpZ25lZCBjaGFyICopdXNlcikpIHsKKwl1c2VyKys7CisJdWxl
bi0tOworICAgIH0KKyAgICB3aGlsZShpc3NwYWNlKCh1bnNpZ25lZCBjaGFyKXVzZXJbdWxlbi0x
XSkpIHsKKyAgICAJdWxlbi0tOworICAgIH0KKworICAgIGlmICghdWxlbikgeworICAgIAljcGFy
YW1zLT51dGlscy0+c2V0ZXJyb3IoY3BhcmFtcy0+dXRpbHMtPmNvbm4sIDAsCisJICAgICJBbGwt
d2hpdGVzcGFjZSB1c2VybmFtZS4iKTsKKwlyZXR1cm4gU0FTTF9GQUlMOworICAgIH0KKyAgICBp
ZiAodWxlbj5vdXRfbWF4KSByZXR1cm4gU0FTTF9CVUZPVkVSOworICAgIG1lbWNweShvdXQsIHVz
ZXIsIHVsZW4pOworICAgIG91dFt1bGVuXSA9ICdcMCc7CisgICAgKm91dF91bGVuID0gdWxlbjsK
KyAgICByZXR1cm4gU0FTTF9PSzsKK30KKworCisKKworCiBzdGF0aWMgc2FzbF9hdXhwcm9wX3Bs
dWdfdCBzcWxfYXV4cHJvcF9wbHVnaW4gPSB7CiAgICAgMCwJCQkvKiBGZWF0dXJlcyAqLwogICAg
IDAsCQkJLyogc3BhcmUgKi8KQEAgLTEzNDMsMTcgKzE1OTQsODIgQEAKICAgICAKICAgICBpZiAo
IXNldHRpbmdzLT5zcWxfZW5naW5lLT5uYW1lKSByZXR1cm4gU0FTTF9OT01FQ0g7CiAKLSAgICBp
ZiAoIXNxbF9leGlzdHMoc2V0dGluZ3MtPnNxbF9zZWxlY3QpKSB7Ci0JdXRpbHMtPmxvZyhOVUxM
LCBTQVNMX0xPR19FUlIsICJzcWxfc2VsZWN0IG9wdGlvbiBtaXNzaW5nIik7CisgICAgaWYgKCFz
cWxfZXhpc3RzKHNldHRpbmdzLT5zcWxfYXV4cHJvcF9zZWxlY3QpKSB7CisJdXRpbHMtPmxvZyhO
VUxMLCBTQVNMX0xPR19FUlIsICJzcWxfYXV4cHJvcF9zZWxlY3Qgb3B0aW9uIG1pc3NpbmciKTsK
IAl1dGlscy0+ZnJlZShzZXR0aW5ncyk7CQogCXJldHVybiBTQVNMX05PTUVDSDsKICAgICB9CiAK
ICAgICB1dGlscy0+bG9nKE5VTEwsIFNBU0xfTE9HX0RFQlVHLAotCSAgICAgICAic3FsIGF1eHBy
b3AgcGx1Z2luIHVzaW5nICVzIGVuZ2luZVxuIiwKLQkgICAgICAgc2V0dGluZ3MtPnNxbF9lbmdp
bmUtPm5hbWUpOworCSAgICAgICJzcWxfYXV4cHJvcF9wbHVnaW4gdXNpbmcgJXMgZW5naW5lIHdp
dGggc2VsZWN0OiAlc1xuIiwKKwkgICAgICBzZXR0aW5ncy0+c3FsX2VuZ2luZS0+bmFtZSwgc2V0
dGluZ3MtPnNxbF9hdXhwcm9wX3NlbGVjdCk7CiAgICAgCiAgICAgc3FsX2F1eHByb3BfcGx1Z2lu
Lmdsb2JfY29udGV4dCA9IHNldHRpbmdzOwogICAgIAogICAgIHJldHVybiBTQVNMX09LOwogfQor
c3RhdGljIHNhc2xfY2Fub251c2VyX3BsdWdfdCBzcWxfY2Fub251c2VyX3BsdWdpbiA9IHsKKwkw
LAkvKiBmZWF0dXJlcyAqLworCTAsCS8qIHNwYXJlICovCisJTlVMTCwJLyogZ2xvYl9jb250ZXh0
ICovCisJInNxbCIsCS8qIG5hbWUgKi8KKwlzcWxfYXV4cHJvcF9mcmVlLAkvKiBjYW5vbl91c2Vy
X2ZyZWUgKi8KKwlzcWxfY2Fub25fc2VydmVyLAkvKiBjYW5vbl91c2VyX3NlcnZlciAqLworCXNx
bF9jYW5vbl9jbGllbnQsCS8qIGNhbm9uX3VzZXJfY2xpZW50ICovCisJTlVMTCwKKwlOVUxMLAor
CU5VTEwKK307CisKK2ludAorc3FsX2Nhbm9udXNlcl9wbHVnX2luaXQgKGNvbnN0IHNhc2xfdXRp
bHNfdCAqIHV0aWxzCisJCQkJICBfX2F0dHJpYnV0ZV9fICgodW51c2VkKSksIGludCBtYXhfdmVy
c2lvbiwKKwkJCQkgIGludCAqb3V0X3ZlcnNpb24sCisJCQkJICBzYXNsX2Nhbm9udXNlcl9wbHVn
X3QgKiogcGx1ZywKKwkJCQkgIGNvbnN0IGNoYXIgKnBsdWduYW1lCisJCQkJICBfX2F0dHJpYnV0
ZV9fICgodW51c2VkKSkpCit7CisgIHNxbF9zZXR0aW5nc190ICpzZXR0aW5nczsKKworICBpZiAo
IW91dF92ZXJzaW9uIHx8ICFwbHVnKQorICAgIHJldHVybiBTQVNMX0JBRFBBUkFNOworCisgIGlm
IChtYXhfdmVyc2lvbiA8IFNBU0xfQ0FOT05VU0VSX1BMVUdfVkVSU0lPTikKKyAgICByZXR1cm4g
U0FTTF9CQURWRVJTOworCisgICpvdXRfdmVyc2lvbiA9IFNBU0xfQ0FOT05VU0VSX1BMVUdfVkVS
U0lPTjsKKworICBzZXR0aW5ncyA9IChzcWxfc2V0dGluZ3NfdCAqKSB1dGlscy0+bWFsbG9jIChz
aXplb2YgKHNxbF9zZXR0aW5nc190KSk7CisKKyAgaWYgKCFzZXR0aW5ncykKKyAgICB7CisgICAg
ICBNRU1FUlJPUiAodXRpbHMpOworICAgICAgcmV0dXJuIFNBU0xfTk9NRU07CisgICAgfQorCisg
IG1lbXNldCAoc2V0dGluZ3MsIDAsIHNpemVvZiAoc3FsX3NldHRpbmdzX3QpKTsKKyAgc3FsX2dl
dF9zZXR0aW5ncyAodXRpbHMsIHNldHRpbmdzKTsKKworICBpZiAoIXNldHRpbmdzLT5zcWxfZW5n
aW5lLT5uYW1lKQorICAgIHJldHVybiBTQVNMX05PTUVDSDsKKworICBpZiAoIXNxbF9leGlzdHMg
KHNldHRpbmdzLT5zcWxfY2Fub25fc2VsZWN0KSkKKyAgICB7CisgICAgICB1dGlscy0+bG9nIChO
VUxMLCBTQVNMX0xPR19FUlIsCisJCSAgInNxbF9jYW5vbl9wbHVnaW46IHNxbF9jYW5vbl9zZWxl
Y3Qgb3B0aW9uIG1pc3NpbmciKTsKKyAgICAgIHV0aWxzLT5mcmVlIChzZXR0aW5ncyk7CisgICAg
ICByZXR1cm4gU0FTTF9OT01FQ0g7CisgICAgfQorCisgIHV0aWxzLT5sb2cgKE5VTEwsIFNBU0xf
TE9HX0RFQlVHLAorCSAgICAgICJzcWxfY2Fub25fcGx1Z2luIHVzaW5nICVzIGVuZ2luZSB3aXRo
IHNlbGVjdDogJXNcbiIsCisJICAgICAgc2V0dGluZ3MtPnNxbF9lbmdpbmUtPm5hbWUsIHNldHRp
bmdzLT5zcWxfY2Fub25fc2VsZWN0KTsKKworICBzcWxfY2Fub251c2VyX3BsdWdpbi5nbG9iX2Nv
bnRleHQgPSBzZXR0aW5nczsKKworCisKKyAgKnBsdWcgPSAmc3FsX2Nhbm9udXNlcl9wbHVnaW47
CisKKyAgcmV0dXJuIFNBU0xfT0s7Cit9Cg==
</data>        

          </attachment>
      

    </bug>

</bugzilla>