<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>1251</bug_id>
          
          <creation_ts>2002-04-29 16:25 EDT</creation_ts>
          <short_desc>support LDAP password checking</short_desc>
          <delta_ts>2010-10-25 18:46:29 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus SASL</product>
          <component>saslauthd</component>
          <version>2.1.x</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          <bug_file_loc>http://www.ypass.net/cyrus/</bug_file_loc>
          
          
          <priority>P2</priority>
          <bug_severity>bug</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Larry Greenfield">leg+cyrus@andrew.cmu.edu</reporter>
          <assigned_to name="Rob Siemborski">rjs3@andrew.cmu.edu</assigned_to>
          <cc>igor@ipass.net</cc>
          

      

      

      
          <long_desc isprivate="0">
            <who name="Larry Greenfield">leg+cyrus@andrew.cmu.edu</who>
            <bug_when>2002-04-29 16:25:28 EDT</bug_when>
            <thetext>consider using the patch at the URL given.  (think about whether or not we want
a configuration file or what.)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Larry Greenfield">leg+cyrus@andrew.cmu.edu</who>
            <bug_when>2002-04-29 16:26:22 EDT</bug_when>
            <thetext>igor: i&apos;ve opened a bug on saslauthd/LDAP.
hopefully we&apos;ll find time to incorporate it into the base distribution.
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-04-29 18:45:20 EDT</bug_when>
            <thetext>Please let me know if I can help.  If interested, I alse have an ldapauxprop 
patch that uses the same authentication kit.  -igor</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-04-30 13:53:29 EDT</bug_when>
            <thetext>I&apos;d be interested in seeing the auxprop patch.

However, it would help if there was some decent autoconf check for OpenLDAP, so
that we wouldn&apos;t always need liblber and libldap to build the library.  Also an
autoconf check to just disable it outright.  I can research but if you know one,
do share ;)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-04-30 22:28:45 EDT</bug_when>
            <thetext>You can fetch the auxprop patch at 
http://www.ypass.net/cyrus/ldap_auxprop_patch.html.  Note that I had to modify 
lib/checkpw.c in order to accomodate crypt based passwords.  This part of the 
patch seems like a kludge.  An enhancement can possibly include md5 and sha 
based passwords.

I am not much of an autoconf guru, but I think that you can find decent 
scripts in php ($src/ext/ldap/config.m4) and freeradius sources 
($src/src/modules/rlm_ldap/configure.in).  The latest samba source may be 
another place to look.  These packages try to accomodate various ldap APIs.  
It would not be too hard to port my patch to other LDAP v3 libs except for 
ldap_initialize() which is openldap specific call.  I like this call because 
all you have to do is pass url (ldaps://localhost/) to it, otherwise you have 
to parse the url string and it can get messy. </thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-05-03 16:26:01 EDT</bug_when>
            <thetext>committed saslauthd module.  using an openldap specific check (for ldap_initialize)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-05-08 12:33:38 EDT</bug_when>
            <thetext>There is a bug in the ldap code which breaks the compilation of saslauthd and 
auth_ldap. I am going to email you the patch.  What do you think about 
combining auth_ldap.c and lak.*?
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-05-08 12:34:49 EDT</bug_when>
            <thetext>if it&apos;s the bug you posted to the mailing list, I have a better patch with
autoconf support that I will be committing to cvs shortly.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-05-08 12:35:46 EDT</bug_when>
            <thetext>as far as combining the files, I don&apos;t have a strong preference either way.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-05-08 12:39:51 EDT</bug_when>
            <thetext>I modified the patch slightly.  See my email, but it is not drastically 
different.  Please apply your patch if you think it is better.  The problem was 
really with the wrong #ifdef.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-05-08 12:41:33 EDT</bug_when>
            <thetext>Lets leave things as is for now.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Nic Bernstein">nic@onlight.com</who>
            <bug_when>2002-05-10 12:07:35 EDT</bug_when>
            <thetext>Created an attachment (id=33)
Patch to change sizeof to strlen in auth_ldap.c and lak.c, etc.
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-05-10 12:25:08 EDT</bug_when>
            <thetext>appplied parts of the patch that were still applicable.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-05-17 11:58:30 EDT</bug_when>
            <thetext>Created an attachment (id=37)
auth_ldap overhaul
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-05-17 12:12:19 EDT</bug_when>
            <thetext>I just submitted a patch for the auth_ldap overhaul.  I hope that I submitted 
it properly.  The file is an output from cvs diff.
- Several bug fixes
- added ldap_auth_method: [bind|custom] option.  &apos;custom&apos; works just like the 
previous version did.  &apos;bind&apos; uses user&apos;s dn and ldap_simple_bind() as 
suggested on the list for authentication.  It works similar to the way pam_ldap 
from padl does.
- Added (extended) TLS/SSL support (needs more testing).
- Moved config_* routines lak.c.

I also developed ldap auth_method for cyrus-imapd based on lak.  This is 
developed mainly for virtual mailbox support, but it can have other uses.  If 
interested please let me know.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-05-17 12:18:48 EDT</bug_when>
            <thetext>Created an attachment (id=38)
Resending auth_ldap overhaul patch in tar format
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-05-17 12:27:12 EDT</bug_when>
            <thetext>Igor,  I&apos;m looking over the patch now and something crossed my mind, could you
write a part of the saslauthd.8 man page for your module?  A slightly larger
LDAP-SASLAUTHD document explaining all the options would also be nice.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-05-17 12:55:59 EDT</bug_when>
            <thetext>committed your changes, though I made it able to pick an aribtrary configuration
file at runtime instead of being forced to /usr/local/etc  (via the new -O
option to saslauthd)  Please confirm that this works for you.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-05-17 14:35:05 EDT</bug_when>
            <thetext>Please apply these two patches.  The first one prevented ldap mech from 
initializing.  The second patch fixes saslauthd segfault when non-existent 
config file (-O) is passed.

I&apos;ll try to work on the ldap docs this weekend, if not I&apos;ll come up with 
something early next week.  I wish solaris comes with doc macro for nroff, man 
pages &apos;an&apos; macro.

RCS file: /cvs/src/sasl/saslauthd/auth_ldap.c,v
retrieving revision 1.9
diff -r1.9 auth_ldap.c
101a102,103
&gt; 
&gt;     return 0;
Index: lak.c
===================================================================
RCS file: /cvs/src/sasl/saslauthd/lak.c,v
retrieving revision 1.5
diff -r1.5 lak.c
640c640
&lt;               syslog(LOG_ERR|LOG_AUTH, &quot;%s: Configure failed - check 
configuration file %s.&quot;, myname, session-&gt;conf-&gt;path);
---
&gt;               syslog(LOG_ERR|LOG_AUTH, &quot;%s: Configure failed - check 
configuration file %s.&quot;, myname, configFile);
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-05-17 14:41:39 EDT</bug_when>
            <thetext>committed. (sorry about the bugs!)

as far as the man pages, even plaintext could be good enough, and I can convert
it (though a full mdoc patch is better ;)</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-05-24 13:54:38 EDT</bug_when>
            <thetext>Created an attachment (id=40)
ldap additions for saslauthd.8
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-05-24 13:56:30 EDT</bug_when>
            <thetext>Created an attachment (id=41)
LDAP_SASLAUTHD document for cyrus_sasl/saslauthd package
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-05-28 15:08:48 EDT</bug_when>
            <thetext>committed the docs</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-06-17 19:26:39 EDT</bug_when>
            <thetext>Created an attachment (id=45)
More auth_ldap rewrite
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-06-17 19:31:16 EDT</bug_when>
            <thetext>Rob, please review and let me know what do you think.
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-19 14:04:46 EDT</bug_when>
            <thetext>committed to cvs.  do we need new documentation?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-06-19 14:06:52 EDT</bug_when>
            <thetext>Bug fix.

--- /tmp/lak.c  2002-06-19 14:02:44.104566280 -0400
+++ lak.c       2002-06-19 14:01:14.944580000 -0400
@@ -933,7 +933,7 @@
 
        lres-&gt;attribute = strdup(attr);
        if (lres-&gt;attribute == NULL) {
-               ldap_value_free(vals);
+               lak_free_result(lres);
                return LAK_NOMEM;
        }
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-06-19 14:09:49 EDT</bug_when>
            <thetext>We can use what we have, but I&apos;d like to change a few things.  I&apos;ll submit the 
revised docs here.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-06-19 14:41:11 EDT</bug_when>
            <thetext>Rob, you missed the param name change.  ;)

lak_free_result(vals);
needs to be
lak_free_result(lres);

-Igor</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-06-21 11:06:54 EDT</bug_when>
            <thetext>Fix config option names.

--- lak.c       2002-06-21 10:53:19.477173000 -0400
+++ /tmp/lak.c  2002-06-21 10:53:03.927171285 -0400
@@ -259,9 +259,9 @@
                }
        }
        conf-&gt;debug = lak_config_getint(&quot;ldap_debug&quot;, 0);
-       conf-&gt;tls_check_peer = lak_config_getint(&quot;ldap_tls_check_peer&quot;, 0);
-       conf-&gt;tls_cacert_file = (char *) lak_config_getstring
(&quot;ldap_tls_cacert_file&quot;, NULL);
-       conf-&gt;tls_cacert_dir = (char *) lak_config_getstring
(&quot;ldap_tls_cacert_dir&quot;, NULL);
+       conf-&gt;tls_check_peer = lak_config_getint(&quot;ldap_tls_checkpeer&quot;, 0);
+       conf-&gt;tls_cacert_file = (char *) lak_config_getstring
(&quot;ldap_tls_cacertfile&quot;, NULL);
+       conf-&gt;tls_cacert_dir = (char *) lak_config_getstring
(&quot;ldap_tls_cacertdir&quot;, NULL);
        conf-&gt;tls_ciphers = (char *) lak_config_getstring(&quot;ldap_tls_ciphers&quot;, 
NULL);
        conf-&gt;tls_cert = (char *) lak_config_getstring(&quot;ldap_tls_cert&quot;, NULL);
        conf-&gt;tls_key = (char *) lak_config_getstring(&quot;ldap_tls_key&quot;, NULL);
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-21 11:11:06 EDT</bug_when>
            <thetext>this patch was already applied, or does it go the other direction?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-06-22 00:14:18 EDT</bug_when>
            <thetext>Rob,
Sorry.  :(  I gave you a wrong diff.  The &apos;_&apos; is missing from the string 
literals in lak_config_get*. 

[root@saturn:/var/src/cyrus-sasl/saslauthd]# cvs diff lak.c
Index: lak.c
===================================================================
RCS file: /cvs/src/sasl/saslauthd/lak.c,v
retrieving revision 1.11
diff -r1.11 lak.c
262,264c262,264
&lt;       conf-&gt;tls_check_peer = lak_config_getint(&quot;ldap_tls_checkpeer&quot;, 0);
&lt;       conf-&gt;tls_cacert_file = (char *) lak_config_getstring
(&quot;ldap_tls_cacertfile&quot;, NULL);
&lt;       conf-&gt;tls_cacert_dir = (char *) lak_config_getstring
(&quot;ldap_tls_cacertdir&quot;, NULL);
---
&gt;       conf-&gt;tls_check_peer = lak_config_getint(&quot;ldap_tls_check_peer&quot;, 0);
&gt;       conf-&gt;tls_cacert_file = (char *) lak_config_getstring
(&quot;ldap_tls_cacert_file&quot;, NULL);
&gt;       conf-&gt;tls_cacert_dir = (char *) lak_config_getstring
(&quot;ldap_tls_cacert_dir&quot;, NULL);
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-06-24 18:21:53 EDT</bug_when>
            <thetext>Created an attachment (id=49)
LDAP_SASLAUTHD - readme for ldap-enabled saslauthd
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-06-24 18:22:27 EDT</bug_when>
            <thetext>Created an attachment (id=50)
Changes for saslauthd.8
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-06-24 18:28:35 EDT</bug_when>
            <thetext>committed these to the repository, I didn&apos;t include the LDAP NOTES section, and
instead refered to the LDAP_SASLAUTHD document, since it&apos;s basically the same
thing and maintaining it in two places could get obnoxious.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-07-04 20:07:27 EDT</bug_when>
            <thetext>Created an attachment (id=54)
Improve handling of broken LDAP server connections.
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2002-07-05 01:14:15 EDT</bug_when>
            <thetext>I attached a patch which improves handling of broken LDAP connections.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-07-05 11:34:01 EDT</bug_when>
            <thetext>committed.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Rob Siemborski">rjs3@andrew.cmu.edu</who>
            <bug_when>2002-07-30 00:53:09 EDT</bug_when>
            <thetext>Closing this bug.  Further patches can just be sent to me via email or posted in
a new bug.  (Since, well, its implemented now).</thetext>
          </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>33</attachid>
            <date>2002-05-10 12:07 EDT</date>
            <desc>Patch to change sizeof to strlen in auth_ldap.c and lak.c, etc.</desc>
            <filename>cyrus-sasl-2.1.3-diff</filename>
            <type>text/plain</type>
            <size>3848</size>
            <attacher>nic@onlight.com</attacher>
            
              <data encoding="base64">ZGlmZiAtY3diciBjeXJ1cy1zYXNsLTIuMS4zLUJFVEEvc2FzbGF1dGhkL2F1dGhfbGRhcC5jIGN5
cnVzLXNhc2wtMi4xLjMtT05ML3Nhc2xhdXRoZC9hdXRoX2xkYXAuYwoqKiogY3lydXMtc2FzbC0y
LjEuMy1CRVRBL3Nhc2xhdXRoZC9hdXRoX2xkYXAuYwlGcmkgTWF5ICAzIDE0OjU1OjIxIDIwMDIK
LS0tIGN5cnVzLXNhc2wtMi4xLjMtT05ML3Nhc2xhdXRoZC9hdXRoX2xkYXAuYwlUaHUgTWF5ICA5
IDEzOjM0OjMxIDIwMDIKKioqKioqKioqKioqKioqCioqKiA0OCw1MyAqKioqCi0tLSA0OCw1NCAt
LS0tCiAgCiAgI2lmZGVmIEFVVEhfTERBUAogIAorICNpbmNsdWRlIDxzeXMvdGltZS5oPgogICNp
bmNsdWRlICJsYWsuaCIKICAKICAjZGVmaW5lIENPTkZJR0xJU1RHUk9XU0laRSAxMDAKZGlmZiAt
Y3diciBjeXJ1cy1zYXNsLTIuMS4zLUJFVEEvc2FzbGF1dGhkL2xhay5jIGN5cnVzLXNhc2wtMi4x
LjMtT05ML3Nhc2xhdXRoZC9sYWsuYwoqKiogY3lydXMtc2FzbC0yLjEuMy1CRVRBL3Nhc2xhdXRo
ZC9sYWsuYwlGcmkgTWF5ICAzIDEzOjQ1OjMxIDIwMDIKLS0tIGN5cnVzLXNhc2wtMi4xLjMtT05M
L3Nhc2xhdXRoZC9sYWsuYwlGcmkgTWF5IDEwIDExOjAwOjUzIDIwMDIKKioqKioqKioqKioqKioq
CioqKiAyNSwzOCAqKioqCiAgICogREFNQUdFLgogICAqIEVORCBDT1BZUklHSFQgKi8KICAKISAj
aWZkZWYgV0lUSF9MREFQCiAgCiAgI2luY2x1ZGUgPHN5cy90aW1lLmg+CiAgI2luY2x1ZGUgPHN0
ZGlvLmg+CiAgI2luY2x1ZGUgPHN0ZGxpYi5oPgogICNpbmNsdWRlIDxzdHJpbmdzLmg+CiAgI2lu
Y2x1ZGUgPHN5c2xvZy5oPgohICNpbmNsdWRlIDxjcnlwdC5oPgogIAogICNpbmNsdWRlICJsYWsu
aCIKICAKLS0tIDI1LDQxIC0tLS0KICAgKiBEQU1BR0UuCiAgICogRU5EIENPUFlSSUdIVCAqLwog
IAohIAohICNpbmNsdWRlICJtZWNoYW5pc21zLmgiCiEgCiEgI2lmZGVmIEFVVEhfTERBUAogIAog
ICNpbmNsdWRlIDxzeXMvdGltZS5oPgogICNpbmNsdWRlIDxzdGRpby5oPgogICNpbmNsdWRlIDxz
dGRsaWIuaD4KICAjaW5jbHVkZSA8c3RyaW5ncy5oPgogICNpbmNsdWRlIDxzeXNsb2cuaD4KISAj
aW5jbHVkZSA8cnBjc3ZjL2NyeXB0Lmg+CiAgCiAgI2luY2x1ZGUgImxhay5oIgogIAoqKioqKioq
KioqKioqKioKKioqIDc4LDk3ICoqKioKICAJCXJldHVybiBOVUxMOwogIAl9CiAgCiEgCWJ1ZiA9
IG1hbGxvYyhzaXplb2YocykgKiAyICsgMSk7CiAgCWlmIChidWYgPT0gTlVMTCkgewogIAkJc3lz
bG9nKExPR19FUlJ8TE9HX0FVVEgsICIlczogQ2Fubm90IGFsbG9jYXRlIG1lbW9yeSIsIG15bmFt
ZSk7CiAgCQlyZXR1cm4gTlVMTDsKICAJfQogIAogIAlwdHIgPSBzOwohIAllbmQgPSAoY2hhciAq
KSBwdHIgKyBzdHJsZW4oKGNoYXIgKikgcHRyKTsKISAKISAJd2hpbGUgKCgodGVtcCA9IChjaGFy
ICopc3RycGJyaygoY2hhciAqKXB0ciwgIiooKVxcXDAiKSkhPU5VTEwpICYmICh0ZW1wIDwgZW5k
KSkgewogIAogIAkJaWYgKCh0ZW1wLXB0cikgPiAwKQogIAkJCXN0cm5jYXQoYnVmLCBwdHIsIHRl
bXAtcHRyKTsKLSAKICAJCXN3aXRjaCAoKnRlbXApIHsKICAJCQljYXNlICcqJzoKICAJCQkJc3Ry
Y2F0KGJ1ZiwgIlxcMmEiKTsKLS0tIDgxLDk5IC0tLS0KICAJCXJldHVybiBOVUxMOwogIAl9CiAg
CiEgCWJ1ZiA9IG1hbGxvYyhzdHJsZW4ocykgKiAyICsgMSk7CiEgCWJ1ZlswXSA9ICdcMCc7CiAg
CWlmIChidWYgPT0gTlVMTCkgewogIAkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICIlczogQ2Fu
bm90IGFsbG9jYXRlIG1lbW9yeSIsIG15bmFtZSk7CiAgCQlyZXR1cm4gTlVMTDsKICAJfQogIAog
IAlwdHIgPSBzOwohIAllbmQgPSBwdHIgKyBzdHJsZW4ocHRyKTsKICAKKyAJd2hpbGUgKCh0ZW1w
ID0gc3RycGJyayhwdHIsICIqKClcXCIpKSAmJiAodGVtcCA8IGVuZCkpIHsKICAJCWlmICgodGVt
cCAtIHB0cikgPiAwKQogIAkJCXN0cm5jYXQoYnVmLCBwdHIsIHRlbXAtcHRyKTsKICAJCXN3aXRj
aCAoKnRlbXApIHsKICAJCQljYXNlICcqJzoKICAJCQkJc3RyY2F0KGJ1ZiwgIlxcMmEiKTsKKioq
KioqKioqKioqKioqCioqKiAxMDUsMTE4ICoqKioKICAJCQljYXNlICdcXCc6CiAgCQkJCXN0cmNh
dChidWYsICJcXDVjIik7CiAgCQkJCWJyZWFrOwogIAkJCWNhc2UgJ1wwJzoKICAJCQkJc3RyY2F0
KGJ1ZiwgIlxcMDAiKTsKICAJCQkJYnJlYWs7CiAgCQl9CiAgCQlwdHI9dGVtcCsxOwogIAl9CiAg
CWlmICh0ZW1wPGVuZCkKISAJCXN0cmNhdChidWYsIChjaGFyICopIHB0cik7CiAgCiAgCWlmIChj
b25mLT52ZXJib3NlKQogIAkJc3lzbG9nKExPR19JTkZPfExPR19BVVRILCIlczogQWZ0ZXIgZXNj
YXBpbmcsIGl0J3MgJXMiLCBteW5hbWUsIGJ1Zik7Ci0tLSAxMDcsMTIzIC0tLS0KICAJCQljYXNl
ICdcXCc6CiAgCQkJCXN0cmNhdChidWYsICJcXDVjIik7CiAgCQkJCWJyZWFrOworICNpZiAwCisg
CQkJLyogdGhlIHN0cnBicmsgc2Vjb25kIGFyZyBjb250YWluZWQgXDAgKi8KICAJCQljYXNlICdc
MCc6CiAgCQkJCXN0cmNhdChidWYsICJcXDAwIik7CiAgCQkJCWJyZWFrOworICNlbmRpZgogIAkJ
fQogIAkJcHRyID0gdGVtcCArIDE7CiAgCX0KICAJaWYgKHRlbXAgPCBlbmQpCiEgCQlzdHJjYXQo
YnVmLCBwdHIpOwogIAogIAlpZiAoY29uZi0+dmVyYm9zZSkKICAJCXN5c2xvZyhMT0dfSU5GT3xM
T0dfQVVUSCwiJXM6IEFmdGVyIGVzY2FwaW5nLCBpdCdzICVzIiwgbXluYW1lLCBidWYpOwoqKioq
KioqKioqKioqKioKKioqIDE0NiwxNTUgKioqKgogIAkJcmV0dXJuIE5VTEw7CiAgCX0KICAKISAJ
aWYgKChidWY9KGNoYXIgKiltYWxsb2Moc2l6ZW9mKGNvbmYtPmZpbHRlcikrc2l6ZW9mKHVzZXIp
K3NpemVvZihyZWFsbSkrMSkpPT1OVUxMKSB7CiAgCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwg
IiVzOiBDYW5ub3QgYWxsb2NhdGUgbWVtb3J5IiwgbXluYW1lKTsKICAJCXJldHVybiBOVUxMOwog
IAl9CiAgCQogIAlwdHI9Y29uZi0+ZmlsdGVyOwogIAllbmQgPSAoY2hhciAqKSBwdHIgKyBzdHJs
ZW4oKGNoYXIgKikgcHRyKTsKLS0tIDE1MSwxNjEgLS0tLQogIAkJcmV0dXJuIE5VTEw7CiAgCX0K
ICAKISAJaWYgKChidWY9KGNoYXIgKiltYWxsb2Moc3RybGVuKGNvbmYtPmZpbHRlcikrc3RybGVu
KHVzZXIpK3N0cmxlbihyZWFsbSkrMSkpPT1OVUxMKSB7CiAgCQlzeXNsb2coTE9HX0VSUnxMT0df
QVVUSCwgIiVzOiBDYW5ub3QgYWxsb2NhdGUgbWVtb3J5IiwgbXluYW1lKTsKICAJCXJldHVybiBO
VUxMOwogIAl9CisgCWJ1ZlswXSA9ICdcMCc7CiAgCQogIAlwdHI9Y29uZi0+ZmlsdGVyOwogIAll
bmQgPSAoY2hhciAqKSBwdHIgKyBzdHJsZW4oKGNoYXIgKikgcHRyKTsKKioqKioqKioqKioqKioq
CioqKiA1MjUsNTI4ICoqKioKICAJfQogIH0KICAKISAjZW5kaWYgLyogV0lUSF9MREFQICovCi0t
LSA1MzEsNTM0IC0tLS0KICAJfQogIH0KICAKISAjZW5kaWYgLyogQVVUSF9MREFQICovCmRpZmYg
LWN3YnIgY3lydXMtc2FzbC0yLjEuMy1CRVRBL3Nhc2xhdXRoZC9sYWsuaCBjeXJ1cy1zYXNsLTIu
MS4zLU9OTC9zYXNsYXV0aGQvbGFrLmgKKioqIGN5cnVzLXNhc2wtMi4xLjMtQkVUQS9zYXNsYXV0
aGQvbGFrLmgJRnJpIE1heSAgMyAxMjowNTo0OSAyMDAyCi0tLSBjeXJ1cy1zYXNsLTIuMS4zLU9O
TC9zYXNsYXV0aGQvbGFrLmgJRnJpIE1heSAxMCAxMDo0NjozOSAyMDAyCioqKioqKioqKioqKioq
KgoqKiogMzAsMzUgKioqKgotLS0gMzAsMzYgLS0tLQogIAogICNpbmNsdWRlIDxsZGFwLmg+CiAg
I2luY2x1ZGUgPGxiZXIuaD4KKyAjaW5jbHVkZSA8c3lzL3RpbWUuaD4KICAKICAjZGVmaW5lIExB
S19PSyAwCiAgI2RlZmluZSBMQUtfRkFJTCAtMQo=
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>37</attachid>
            <date>2002-05-17 11:58 EDT</date>
            <desc>auth_ldap overhaul</desc>
            <filename>auth_ldap.patch</filename>
            <type>text/plain</type>
            <size>44061</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">PyBhdXRvbTR0ZS5jYWNoZQpJbmRleDogYXV0aF9sZGFwLmMKPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
L2N2cy9zcmMvc2FzbC9zYXNsYXV0aGQvYXV0aF9sZGFwLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9u
IDEuOApkaWZmIC1yMS44IGF1dGhfbGRhcC5jCjUyLDUzZDUxCjwgI2luY2x1ZGUgPGxkYXAuaD4K
PCAjaW5jbHVkZSA8bGJlci5oPgo1NmQ1Mwo8ICNkZWZpbmUgQ09ORklHTElTVEdST1dTSVpFIDEw
MAo1OSwyNjBkNTUKPCAjZGVmaW5lIEFVVEhfTERBUF9PSyAxCjwgI2RlZmluZSBBVVRIX0xEQVBf
RkFJTCAwCjwgCjwgc3RydWN0IGNvbmZpZ2xpc3Qgewo8ICAgICBjaGFyICprZXk7CjwgICAgIGNo
YXIgKnZhbHVlOwo8IH07CjwgCjwgc3RhdGljIHN0cnVjdCBjb25maWdsaXN0ICpjb25maWdsaXN0
Owo8IHN0YXRpYyBpbnQgbmNvbmZpZ2xpc3Q7CjwgCjwgc3RhdGljIExBSyAqbGFrID0gTlVMTDsK
PCAKPCBzdGF0aWMgaW50IGF1dGhfbGRhcF9jb25maWdfaW5pdChjb25zdCBjaGFyICpmaWxlbmFt
ZSkKPCB7CjwgCUZJTEUgKmluZmlsZTsKPCAJaW50IGxpbmVubyA9IDA7CjwgCWludCBhbGxvY2Vk
ID0gMDsKPCAJY2hhciBidWZbNDA5Nl07CjwgCWNoYXIgKnAsICprZXk7CjwgCWNoYXIgKnJlc3Vs
dDsKPCAKPCAJbmNvbmZpZ2xpc3Q9MDsKPCAKPCAJaW5maWxlID0gZm9wZW4oZmlsZW5hbWUsICJy
Iik7CjwgCWlmICghaW5maWxlKSB7CjwgCQlyZXR1cm4gQVVUSF9MREFQX0ZBSUw7CjwgCX0KPCAg
ICAgCjwgCXdoaWxlIChmZ2V0cyhidWYsIHNpemVvZihidWYpLCBpbmZpbGUpKSB7CjwgCQlsaW5l
bm8rKzsKPCAKPCAJCWlmIChidWZbc3RybGVuKGJ1ZiktMV0gPT0gJ1xuJykgCjwgCQkJYnVmW3N0
cmxlbihidWYpLTFdID0gJ1wwJzsKPCAJCWZvciAocCA9IGJ1ZjsgKnAgJiYgaXNzcGFjZSgoaW50
KSAqcCk7IHArKyk7CjwgCQkJaWYgKCEqcCB8fCAqcCA9PSAnIycpIAo8IAkJCQljb250aW51ZTsK
PCAKPCAJCWtleSA9IHA7CjwgCQl3aGlsZSAoKnAgJiYgKGlzYWxudW0oKGludCkgKnApIHx8ICpw
ID09ICctJyB8fCAqcCA9PSAnXycpKSB7CjwgCQkJaWYgKGlzdXBwZXIoKGludCkgKnApKSAKPCAJ
CQkJKnAgPSB0b2xvd2VyKCpwKTsKPCAJCQlwKys7CjwgCQl9CjwgCQlpZiAoKnAgIT0gJzonKSB7
CjwgCQkJcmV0dXJuIEFVVEhfTERBUF9GQUlMOwo8IAkJfQo8IAkJKnArKyA9ICdcMCc7CjwgCjwg
CQl3aGlsZSAoKnAgJiYgaXNzcGFjZSgoaW50KSAqcCkpIAo8IAkJCXArKzsKPCAKPCAJCWlmICgh
KnApIHsKPCAJCQlyZXR1cm4gQVVUSF9MREFQX0ZBSUw7CjwgCQl9CjwgCjwgCQlpZiAobmNvbmZp
Z2xpc3QgPT0gYWxsb2NlZCkgewo8IAkJCWFsbG9jZWQgKz0gQ09ORklHTElTVEdST1dTSVpFOwo8
IAkJCWNvbmZpZ2xpc3Q9cmVhbGxvYygoY2hhciAqKWNvbmZpZ2xpc3QsIGFsbG9jZWQgKiBzaXpl
b2Yoc3RydWN0IGNvbmZpZ2xpc3QpKTsKPCAJCQlpZiAoY29uZmlnbGlzdD09TlVMTCkgCjwgCQkJ
CXJldHVybiBBVVRIX0xEQVBfRkFJTDsKPCAJCX0KPCAKPCAJCXJlc3VsdCA9IHN0cmR1cChrZXkp
Owo8IAkJaWYgKHJlc3VsdD09TlVMTCkgCjwgCQkJcmV0dXJuIEFVVEhfTERBUF9GQUlMOwo8IAkJ
CWNvbmZpZ2xpc3RbbmNvbmZpZ2xpc3RdLmtleSA9IHJlc3VsdDsKPCAKPCAJCXJlc3VsdCA9IHN0
cmR1cChwKTsKPCAJCWlmIChyZXN1bHQ9PU5VTEwpIAo8IAkJCXJldHVybiBBVVRIX0xEQVBfRkFJ
TDsKPCAJCWNvbmZpZ2xpc3RbbmNvbmZpZ2xpc3RdLnZhbHVlID0gcmVzdWx0Owo8IAo8IAkJbmNv
bmZpZ2xpc3QrKzsKPCAJfQo8IAo8IAlmY2xvc2UoaW5maWxlKTsKPCAKPCAJcmV0dXJuIEFVVEhf
TERBUF9PSzsKPCB9CjwgCjwgc3RhdGljIGNvbnN0IGNoYXIgKmF1dGhfbGRhcF9jb25maWdfZ2V0
c3RyaW5nKGNvbnN0IGNoYXIgKmtleSwgY29uc3QgY2hhciAqZGVmKQo8IHsKPCAgICAgaW50IG9w
dDsKPCAKPCAgICAgZm9yIChvcHQgPSAwOyBvcHQgPCBuY29uZmlnbGlzdDsgb3B0KyspIHsKPCAJ
aWYgKCprZXkgPT0gY29uZmlnbGlzdFtvcHRdLmtleVswXSAmJgo8IAkgICAgIXN0cmNtcChrZXks
IGNvbmZpZ2xpc3Rbb3B0XS5rZXkpKQo8IAkgIHJldHVybiBjb25maWdsaXN0W29wdF0udmFsdWU7
CjwgICAgIH0KPCAgICAgcmV0dXJuIGRlZjsKPCB9CjwgCjwgc3RhdGljIGludCBhdXRoX2xkYXBf
Y29uZmlnX2dldGludChjb25zdCBjaGFyICprZXksIGludCBkZWYpCjwgewo8ICAgICBjb25zdCBj
aGFyICp2YWwgPSBhdXRoX2xkYXBfY29uZmlnX2dldHN0cmluZyhrZXksIChjaGFyICopMCk7Cjwg
CjwgICAgIGlmICghdmFsKSByZXR1cm4gZGVmOwo8ICAgICBpZiAoIWlzZGlnaXQoKGludCkgKnZh
bCkgJiYgKCp2YWwgIT0gJy0nIHx8ICFpc2RpZ2l0KChpbnQpIHZhbFsxXSkpKSByZXR1cm4gZGVm
Owo8ICAgICByZXR1cm4gYXRvaSh2YWwpOwo8IH0KPCAKPCBzdGF0aWMgaW50IGF1dGhfbGRhcF9j
b25maWdfZ2V0c3dpdGNoKGNvbnN0IGNoYXIgKmtleSwgaW50IGRlZikKPCB7CjwgICAgIGNvbnN0
IGNoYXIgKnZhbCA9IGF1dGhfbGRhcF9jb25maWdfZ2V0c3RyaW5nKGtleSwgKGNoYXIgKikwKTsK
PCAKPCAgICAgaWYgKCF2YWwpIHJldHVybiBkZWY7CjwgCjwgICAgIGlmICgqdmFsID09ICcwJyB8
fCAqdmFsID09ICduJyB8fAo8IAkoKnZhbCA9PSAnbycgJiYgdmFsWzFdID09ICdmJykgfHwgKnZh
bCA9PSAnZicpIHsKPCAJcmV0dXJuIDA7CjwgICAgIH0KPCAgICAgZWxzZSBpZiAoKnZhbCA9PSAn
MScgfHwgKnZhbCA9PSAneScgfHwKPCAJICAgICAoKnZhbCA9PSAnbycgJiYgdmFsWzFdID09ICdu
JykgfHwgKnZhbCA9PSAndCcpIHsKPCAJcmV0dXJuIDE7CjwgICAgIH0KPCAgICAgcmV0dXJuIGRl
ZjsKPCB9CjwgCjwgc3RhdGljIGludCBhdXRoX2xkYXBfY29uZmlndXJlKCkKPCB7CjwgICAgIAlj
b25zdCBjaGFyICpteW5hbWUgPSAiYXV0aF9sZGFwX2NvbmZpZ3VyZSI7CjwgCjwgCWludCByYyA9
IDA7CjwgCWNoYXIgKnM7CjwgCjwgCXJjID0gYXV0aF9sZGFwX2NvbmZpZ19pbml0KFNBU0xBVVRI
RF9DT05GX0ZJTEUpOwo8IAlpZiAocmMgIT0gQVVUSF9MREFQX09LKSB7CjwgCQlzeXNsb2coTE9H
X0lORk8sICIlczogQ2Fubm90IG9wZW4gY29uZmlndXJhdGlvbiBmaWxlIiwgbXluYW1lKTsKPCAJ
CXJldHVybiBBVVRIX0xEQVBfRkFJTDsKPCAJfQo8IAo8IAlsYWsgPSBtYWxsb2MoIHNpemVvZihM
QUspICk7CjwgCWlmIChsYWsgPT0gTlVMTCkgewo8IAkJc3lzbG9nKExPR19JTkZPLCAiJXM6IENh
bm5vdCBhbGxvY2F0ZSBtZW1vcnkiLCBteW5hbWUpOwo8IAkJcmV0dXJuIEFVVEhfTERBUF9GQUlM
Owo8IAl9CjwgCjwgCWxhay0+c2VydmVycyA9IChjaGFyICopIGF1dGhfbGRhcF9jb25maWdfZ2V0
c3RyaW5nKCJsZGFwX3NlcnZlcnMiLCAibGRhcDovL2xvY2FsaG9zdC8iKTsKPCAJbGFrLT5iaW5k
X2RuID0gKGNoYXIgKikgYXV0aF9sZGFwX2NvbmZpZ19nZXRzdHJpbmcoImxkYXBfYmluZF9kbiIs
ICIiKTsKPCAJbGFrLT5iaW5kX3B3ID0gKGNoYXIgKikgYXV0aF9sZGFwX2NvbmZpZ19nZXRzdHJp
bmcoImxkYXBfYmluZF9wdyIsICIiKTsKPCAJbGFrLT5zZWFyY2hfYmFzZSA9IChjaGFyICopIGF1
dGhfbGRhcF9jb25maWdfZ2V0c3RyaW5nKCJsZGFwX3NlYXJjaF9iYXNlIiwgIiIpOwo8IAlsYWst
PmZpbHRlciA9IChjaGFyICopIGF1dGhfbGRhcF9jb25maWdfZ2V0c3RyaW5nKCJsZGFwX2ZpbHRl
ciIsICJ1aWQ9JXUiKTsKPCAJbGFrLT50aW1lb3V0LnR2X3NlYyA9IGF1dGhfbGRhcF9jb25maWdf
Z2V0aW50KCJsZGFwX3RpbWVvdXQiLCA1KTsKPCAJbGFrLT50aW1lb3V0LnR2X3VzZWMgPSAwOwo8
IAlsYWstPnNpemVsaW1pdCA9IGF1dGhfbGRhcF9jb25maWdfZ2V0aW50KCJsZGFwX3NpemVsaW1p
dCIsIDApOwo8IAlsYWstPnRpbWVsaW1pdCA9IGF1dGhfbGRhcF9jb25maWdfZ2V0aW50KCJsZGFw
X3RpbWVsaW1pdCIsIDUpOwo8IAlzID0gKGNoYXIgKikgYXV0aF9sZGFwX2NvbmZpZ19nZXRzdHJp
bmcoImxkYXBfZGVyZWYiLCBOVUxMKTsKPCAJaWYgKHMpIHsKPCAJCWlmIChzdHJjYXNlY21wKHMs
ICJzZWFyY2giKSkgewo8IAkJCWxhay0+ZGVyZWYgPSBMREFQX0RFUkVGX1NFQVJDSElORzsKPCAJ
CX0gZWxzZSBpZiAoc3RyY2FzZWNtcChzLCAiZmluZCIpKSB7CjwgCQkJbGFrLT5kZXJlZiA9IExE
QVBfREVSRUZfRklORElORzsKPCAJCX0gZWxzZSBpZiAoc3RyY2FzZWNtcChzLCAiYWx3YXlzIikp
IHsKPCAJCQlsYWstPmRlcmVmID0gTERBUF9ERVJFRl9BTFdBWVM7CjwgCQl9IGVsc2UgaWYgKHN0
cmNhc2VjbXAocywgIm5ldmVyIikpIHsKPCAJCQlsYWstPmRlcmVmID0gTERBUF9ERVJFRl9ORVZF
UjsKPCAJCX0gZWxzZSB7CjwgCQkJbGFrLT5kZXJlZiA9IDA7CjwgCQl9CjwgCX0gZWxzZSB7Cjwg
CQlsYWstPmRlcmVmID0gMDsKPCAJfQo8IAlsYWstPnJlZmVycmFscyA9IGF1dGhfbGRhcF9jb25m
aWdfZ2V0c3dpdGNoKCJsZGFwX3JlZmVycmFscyIsIDApOwo8IAlsYWstPmNhY2hlX2V4cGlyeSA9
IGF1dGhfbGRhcF9jb25maWdfZ2V0aW50KCJsZGFwX2NhY2hlX2V4cGlyeSIsIDApOwo8IAlsYWst
PmNhY2hlX3NpemUgPSBhdXRoX2xkYXBfY29uZmlnX2dldGludCgibGRhcF9jYWNoZV9zaXplIiwg
MCk7CjwgCXMgPSAoY2hhciAqKSBhdXRoX2xkYXBfY29uZmlnX2dldHN0cmluZygibGRhcF9zY29w
ZSIsIE5VTEwpOwo8IAlpZiAocykgewo8IAkJaWYgKHN0cmNhc2VjbXAocywgIm9uZSIpKSB7Cjwg
CQkJbGFrLT5zY29wZSA9IExEQVBfU0NPUEVfT05FTEVWRUw7CjwgCQl9IGVsc2UgaWYgKHN0cmNh
c2VjbXAocywgImJhc2UiKSkgewo8IAkJCWxhay0+c2NvcGUgPSBMREFQX1NDT1BFX0JBU0U7Cjwg
CQl9IGVsc2Ugewo8IAkJCWxhay0+c2NvcGUgPSBMREFQX1NDT1BFX1NVQlRSRUU7CjwgCQl9Cjwg
CX0gZWxzZSB7CjwgCQlsYWstPnNjb3BlID0gTERBUF9TQ09QRV9TVUJUUkVFOwo8IAl9CjwgCWxh
ay0+ZGVidWcgPSBhdXRoX2xkYXBfY29uZmlnX2dldGludCgibGRhcF9kZWJ1ZyIsIDApOwo8IAls
YWstPnZlcmJvc2UgPSBhdXRoX2xkYXBfY29uZmlnX2dldHN3aXRjaCgibGRhcF92ZXJib3NlIiwg
MCk7CjwgCjwgCWlmIChsYWstPnZlcmJvc2UpIHsKPCAJCXN5c2xvZyhMT0dfSU5GTywgImxkYXBf
c2VydmVyczogJXMiLCBsYWstPnNlcnZlcnMpOwo8IAkJc3lzbG9nKExPR19JTkZPLCAibGRhcF9i
aW5kX2RuOiAlcyIsIGxhay0+YmluZF9kbik7CjwgCQlzeXNsb2coTE9HX0lORk8sICJsZGFwX2Jp
bmRfcHc6ICVzIiwgY3J5cHQobGFrLT5iaW5kX3B3LGxhay0+YmluZF9wdykpOwo8IAkJc3lzbG9n
KExPR19JTkZPLCAibGRhcF90aW1lb3V0OiAlZCIsIGxhay0+dGltZW91dC50dl9zZWMpOwo8IAkJ
c3lzbG9nKExPR19JTkZPLCAibGRhcF9zaXplbGltaXQ6ICVkIiwgbGFrLT5zaXplbGltaXQpOwo8
IAkJc3lzbG9nKExPR19JTkZPLCAibGRhcF90aW1lbGltaXQ6ICVkIiwgbGFrLT50aW1lbGltaXQp
Owo8IAkJc3lzbG9nKExPR19JTkZPLCAibGRhcF9kZXJlZjogJWQiLCBsYWstPmRlcmVmKTsKPCAJ
CXN5c2xvZyhMT0dfSU5GTywgImxkYXBfcmVmZXJyYWxzOiAlZCIsIGxhay0+cmVmZXJyYWxzKTsK
PCAJCXN5c2xvZyhMT0dfSU5GTywgImxkYXBfY2FjaGVfZXhwaXJ5OiAlZCIsIGxhay0+Y2FjaGVf
ZXhwaXJ5KTsKPCAJCXN5c2xvZyhMT0dfSU5GTywgImxkYXBfY2FjaGVfc2l6ZTogJWQiLCBsYWst
PmNhY2hlX3NpemUpOwo8IAkJc3lzbG9nKExPR19JTkZPLCAibGRhcF9zY29wZTogJWQiLCBsYWst
PnNjb3BlKTsKPCAJCXN5c2xvZyhMT0dfSU5GTywgImxkYXBfc2VhcmNoX2Jhc2U6ICVzIiwgbGFr
LT5zZWFyY2hfYmFzZSk7CjwgCQlzeXNsb2coTE9HX0lORk8sICJsZGFwX2ZpbHRlcjogJXMiLCBs
YWstPmZpbHRlcik7CjwgCQlzeXNsb2coTE9HX0lORk8sICJsZGFwX2RlYnVnOiAlZCIsIGxhay0+
ZGVidWcpOwo8IAl9CjwgCjwgCXJldHVybiBBVVRIX0xEQVBfT0s7CjwgfQo8IAo8IAoyNzUsMjgy
YzcwCjwgCWlmIChsYWsgPT0gTlVMTCkgewo8IAkJcmMgPSBhdXRoX2xkYXBfY29uZmlndXJlKCk7
CjwgCQlpZiAocmMgIT0gQVVUSF9MREFQX09LKSB7CjwgCQkJUkVUVVJOKCJOTyIpOwo8IAkJfQo8
IAl9CjwgCjwgCXJjID0gbGFrX2F1dGhlbnRpY2F0ZShsYWssKGNoYXIgKilsb2dpbiwoY2hhciAq
KXJlYWxtLChjaGFyICopcGFzc3dvcmQpOwotLS0KPiAJcmMgPSBsYWtfYXV0aGVudGljYXRlKGxv
Z2luLCByZWFsbSwgcGFzc3dvcmQsIFNBU0xBVVRIRF9DT05GX0ZJTEUpOwpJbmRleDogbGFrLmMK
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvc2FzbC9zYXNsYXV0aGQvbGFrLmMsdgpyZXRy
aWV2aW5nIHJldmlzaW9uIDEuNApkaWZmIC1yMS40IGxhay5jCjEsMmMxCjwgLyogQ09QWVJJR0hU
CjwgICogQ29weXJpZ2h0IChjKSAyMDAyLTIwMDIgSWdvciBCcmV6YWMKLS0tCj4gLyogQ09QWVJJ
R0hUICogQ29weXJpZ2h0IChjKSAyMDAyLTIwMDIgSWdvciBCcmV6YWMKNTBjNDksODgKPCBMQUtf
Q09OTiAqY29ubiA9IE5VTEw7Ci0tLQo+IHN0YXRpYyBpbnQgbGFrX3JlYWRfY29uZmlnKGNvbnN0
IGNoYXIgKik7Cj4gc3RhdGljIGNvbnN0IGNoYXIgKmxha19jb25maWdfZ2V0c3RyaW5nKGNvbnN0
IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKPiBzdGF0aWMgaW50IGxha19jb25maWdfZ2V0aW50KGNv
bnN0IGNoYXIgKiwgaW50ICk7Cj4gc3RhdGljIGludCBsYWtfY29uZmlnX2dldHN3aXRjaChjb25z
dCBjaGFyICosIGludCApOwo+IHN0YXRpYyBpbnQgbGFrX2NvbmZpZ3VyZShMQUtfQ09ORiAqKiwg
Y29uc3QgY2hhciAqKTsKPiBzdGF0aWMgdm9pZCBsYWtfcmVsZWFzZV9jb25maWcoTEFLX0NPTkYg
KiopOwo+ICNpZiAwCj4gc3RhdGljIGludCBsYWtfZ2V0X2ludGVnZXJfdmFsdWUgKExEQVAgKiwg
TERBUE1lc3NhZ2UgKiwgY29uc3QgY2hhciAqLCBpbnQgKik7Cj4gc3RhdGljIGludCBsYWtfZ2V0
X2xvbmdfaW50ZWdlcl92YWx1ZSAoTERBUCAqLCBMREFQTWVzc2FnZSAqLCBjb25zdCBjaGFyICos
IGxvbmcgaW50ICopOwo+IHN0YXRpYyBpbnQgbGFrX29jX2NoZWNrIChMREFQICosIExEQVBNZXNz
YWdlICosIGNvbnN0IGNoYXIgKik7Cj4gc3RhdGljIGludCBsYWtfaGFzX3ZhbHVlIChjaGFyICoq
LCBjb25zdCBjaGFyICopOwo+IHN0YXRpYyBpbnQgbGFrX2dldF9zdHJpbmdfdmFsdWVzIChMREFQ
ICosIExEQVBNZXNzYWdlICosIGNvbnN0IGNoYXIgKiwgY2hhciAqKiopOwo+ICNlbmRpZgo+IHN0
YXRpYyBpbnQgbGFrX2dldF9zdHJpbmdfdmFsdWUgKExEQVAgKiwgTERBUE1lc3NhZ2UgKiwgY29u
c3QgY2hhciAqLCBjaGFyICoqKTsKPiBzdGF0aWMgaW50IGxha19lc2NhcGUoY29uc3QgY2hhciAq
LCBjaGFyICoqKTsKPiBzdGF0aWMgaW50IGxha19maWx0ZXIoTEFLX1NFU1NJT04gKiwgY29uc3Qg
Y2hhciAqLCBjb25zdCBjaGFyICosIGNoYXIgKiopOwo+IHN0YXRpYyBpbnQgbGFrX2dldF91c2Vy
KExBS19TRVNTSU9OICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsKPiBzdGF0aWMgdm9p
ZCBsYWtfcmVsZWFzZV91c2VyKExBS19VU0VSICoqKTsKPiBzdGF0aWMgaW50IGxha19nZXRfc2Vz
c2lvbihMQUtfU0VTU0lPTiAqKiwgY29uc3QgY2hhciAqKSA7Cj4gc3RhdGljIGludCBsYWtfb3Bl
bl9zZXNzaW9uKExBS19TRVNTSU9OICopOwo+IHN0YXRpYyBpbnQgbGFrX3Jlb3Blbl9zZXNzaW9u
KExBS19TRVNTSU9OICopOwo+IHN0YXRpYyB2b2lkIGxha19jbG9zZV9zZXNzaW9uKExBS19TRVNT
SU9OICoqKTsKPiBzdGF0aWMgaW50IGxha19jb25uZWN0X2Fub255bW91c2x5KExBS19TRVNTSU9O
ICopOwo+IHN0YXRpYyBpbnQgbGFrX2Nvbm5lY3RfYXNfdXNlcihMQUtfU0VTU0lPTiAqLCBjb25z
dCBjaGFyICopOwo+IHN0YXRpYyBpbnQgbGFrX3NlYXJjaChMQUtfU0VTU0lPTiAqLCBjb25zdCBj
aGFyICosIGNvbnN0IGNoYXIgKiosIExEQVBNZXNzYWdlICoqKTsKPiBzdGF0aWMgaW50IGxha19y
ZXRyaWV2ZShMQUtfU0VTU0lPTiAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3Qg
Y2hhciAqKiwgTEFLICoqKTsKPiBzdGF0aWMgaW50IGxha19jdXN0b21fYXV0aGVudGljYXRlKExB
S19TRVNTSU9OICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqcmVhbG0sIGNvbnN0IGNoYXIg
Kik7Cj4gc3RhdGljIGludCBsYWtfYmluZF9hdXRoZW50aWNhdGUoTEFLX1NFU1NJT04gKiwgY29u
c3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7Cj4gCj4gc3RhdGljIExBS19T
RVNTSU9OICpwZXJzaXN0ZW50X3Nlc3Npb24gPSBOVUxMOwo+IAo+ICNkZWZpbmUgQ09ORklHTElT
VEdST1dTSVpFIDEwMAo+IAo+IHN0cnVjdCBjb25maWdsaXN0IHsKPiAJY2hhciAqa2V5Owo+IAlj
aGFyICp2YWx1ZTsKPiB9Owo+IAo+IHN0YXRpYyBzdHJ1Y3QgY29uZmlnbGlzdCAqY29uZmlnbGlz
dDsKPiBzdGF0aWMgaW50IG5jb25maWdsaXN0Owo1MmM5MAo8IHN0YXRpYyBpbnQgbGFrX2dldF9j
b25uKExBS19DT05OICoqY29ubikgCi0tLQo+IHN0YXRpYyBpbnQgbGFrX3JlYWRfY29uZmlnKGNv
bnN0IGNoYXIgKmZpbGVuYW1lKQo1NGM5Miw5Nwo8ICAgICAJY2hhciAgKm15bmFtZSA9ICJsYWtf
Z2V0X2Nvbm4iOwotLS0KPiAJRklMRSAqaW5maWxlOwo+IAlpbnQgbGluZW5vID0gMDsKPiAJaW50
IGFsbG9jZWQgPSAwOwo+IAljaGFyIGJ1Zls0MDk2XTsKPiAJY2hhciAqcCwgKmtleTsKPiAJY2hh
ciAqcmVzdWx0Owo1NmM5OQo8IAlMQUtfQ09OTiAqYzsKLS0tCj4gCW5jb25maWdsaXN0PTA7CjU4
LDYwYzEwMSwxMDIKPCAJYyA9IChMQUtfQ09OTiAqKW1hbGxvYyhzaXplb2YoTEFLX0NPTk4pKTsK
PCAJaWYgKGMgPT0gTlVMTCkgewo8IAkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICIlczogQ2Fu
bm90IGFsbG9jYXRlIG1lbW9yeSIsIG15bmFtZSk7Ci0tLQo+IAlpbmZpbGUgPSBmb3BlbihmaWxl
bmFtZSwgInIiKTsKPiAJaWYgKCFpbmZpbGUpIHsKNjJhMTA1LDE2MQo+ICAgICAKPiAJd2hpbGUg
KGZnZXRzKGJ1Ziwgc2l6ZW9mKGJ1ZiksIGluZmlsZSkpIHsKPiAJCWxpbmVubysrOwo+IAo+IAkJ
aWYgKGJ1ZltzdHJsZW4oYnVmKS0xXSA9PSAnXG4nKSAKPiAJCQlidWZbc3RybGVuKGJ1ZiktMV0g
PSAnXDAnOwo+IAkJZm9yIChwID0gYnVmOyAqcCAmJiBpc3NwYWNlKChpbnQpICpwKTsgcCsrKTsK
PiAJCQlpZiAoISpwIHx8ICpwID09ICcjJykgCj4gCQkJCWNvbnRpbnVlOwo+IAo+IAkJa2V5ID0g
cDsKPiAJCXdoaWxlICgqcCAmJiAoaXNhbG51bSgoaW50KSAqcCkgfHwgKnAgPT0gJy0nIHx8ICpw
ID09ICdfJykpIHsKPiAJCQlpZiAoaXN1cHBlcigoaW50KSAqcCkpIAo+IAkJCQkqcCA9IHRvbG93
ZXIoKnApOwo+IAkJCXArKzsKPiAJCX0KPiAJCWlmICgqcCAhPSAnOicpIHsKPiAJCQlyZXR1cm4g
TEFLX0ZBSUw7Cj4gCQl9Cj4gCQkqcCsrID0gJ1wwJzsKPiAKPiAJCXdoaWxlICgqcCAmJiBpc3Nw
YWNlKChpbnQpICpwKSkgCj4gCQkJcCsrOwo+IAo+IAkJaWYgKCEqcCkgewo+IAkJCXJldHVybiBM
QUtfRkFJTDsKPiAJCX0KPiAKPiAJCWlmIChuY29uZmlnbGlzdCA9PSBhbGxvY2VkKSB7Cj4gCQkJ
YWxsb2NlZCArPSBDT05GSUdMSVNUR1JPV1NJWkU7Cj4gCQkJY29uZmlnbGlzdD1yZWFsbG9jKChj
aGFyICopY29uZmlnbGlzdCwgYWxsb2NlZCAqIHNpemVvZihzdHJ1Y3QgY29uZmlnbGlzdCkpOwo+
IAkJCWlmIChjb25maWdsaXN0PT1OVUxMKSAKPiAJCQkJcmV0dXJuIExBS19GQUlMOwo+IAkJfQo+
IAo+IAkJcmVzdWx0ID0gc3RyZHVwKGtleSk7Cj4gCQlpZiAocmVzdWx0PT1OVUxMKSAKPiAJCQly
ZXR1cm4gTEFLX0ZBSUw7Cj4gCj4gCQljb25maWdsaXN0W25jb25maWdsaXN0XS5rZXkgPSByZXN1
bHQ7Cj4gCj4gCQlyZXN1bHQgPSBzdHJkdXAocCk7Cj4gCQlpZiAocmVzdWx0PT1OVUxMKSAKPiAJ
CQlyZXR1cm4gTEFLX0ZBSUw7Cj4gCQljb25maWdsaXN0W25jb25maWdsaXN0XS52YWx1ZSA9IHJl
c3VsdDsKPiAKPiAJCW5jb25maWdsaXN0Kys7Cj4gCX0KPiAKPiAJZmNsb3NlKGluZmlsZSk7Cj4g
Cj4gCXJldHVybiBMQUtfT0s7Cj4gfQo+IAo+IHN0YXRpYyBjb25zdCBjaGFyICpsYWtfY29uZmln
X2dldHN0cmluZyhjb25zdCBjaGFyICprZXksIGNvbnN0IGNoYXIgKmRlZikKPiB7Cj4gICAgIGlu
dCBvcHQ7CjY0LDY2YzE2MywyNzYKPCAJYy0+Ym91bmQ9MDsKPCAJYy0+bGQ9TlVMTDsKPCAJKmNv
bm49YzsKLS0tCj4gICAgIGZvciAob3B0ID0gMDsgb3B0IDwgbmNvbmZpZ2xpc3Q7IG9wdCsrKSB7
Cj4gCWlmICgqa2V5ID09IGNvbmZpZ2xpc3Rbb3B0XS5rZXlbMF0gJiYKPiAJICAgICFzdHJjbXAo
a2V5LCBjb25maWdsaXN0W29wdF0ua2V5KSkKPiAJICByZXR1cm4gY29uZmlnbGlzdFtvcHRdLnZh
bHVlOwo+ICAgICB9Cj4gICAgIHJldHVybiBkZWY7Cj4gfQo+IAo+IHN0YXRpYyBpbnQgbGFrX2Nv
bmZpZ19nZXRpbnQoY29uc3QgY2hhciAqa2V5LCBpbnQgZGVmKQo+IHsKPiAgICAgY29uc3QgY2hh
ciAqdmFsID0gbGFrX2NvbmZpZ19nZXRzdHJpbmcoa2V5LCAoY2hhciAqKTApOwo+IAo+ICAgICBp
ZiAoIXZhbCkgcmV0dXJuIGRlZjsKPiAgICAgaWYgKCFpc2RpZ2l0KChpbnQpICp2YWwpICYmICgq
dmFsICE9ICctJyB8fCAhaXNkaWdpdCgoaW50KSB2YWxbMV0pKSkgcmV0dXJuIGRlZjsKPiAgICAg
cmV0dXJuIGF0b2kodmFsKTsKPiB9Cj4gCj4gc3RhdGljIGludCBsYWtfY29uZmlnX2dldHN3aXRj
aChjb25zdCBjaGFyICprZXksIGludCBkZWYpCj4gewo+ICAgICBjb25zdCBjaGFyICp2YWwgPSBs
YWtfY29uZmlnX2dldHN0cmluZyhrZXksIChjaGFyICopMCk7Cj4gCj4gICAgIGlmICghdmFsKSBy
ZXR1cm4gZGVmOwo+IAo+ICAgICBpZiAoKnZhbCA9PSAnMCcgfHwgKnZhbCA9PSAnbicgfHwKPiAJ
KCp2YWwgPT0gJ28nICYmIHZhbFsxXSA9PSAnZicpIHx8ICp2YWwgPT0gJ2YnKSB7Cj4gCXJldHVy
biAwOwo+ICAgICB9Cj4gICAgIGVsc2UgaWYgKCp2YWwgPT0gJzEnIHx8ICp2YWwgPT0gJ3knIHx8
Cj4gCSAgICAgKCp2YWwgPT0gJ28nICYmIHZhbFsxXSA9PSAnbicpIHx8ICp2YWwgPT0gJ3QnKSB7
Cj4gCXJldHVybiAxOwo+ICAgICB9Cj4gICAgIHJldHVybiBkZWY7Cj4gfQo+IAo+IHN0YXRpYyBp
bnQgbGFrX2NvbmZpZ3VyZShMQUtfQ09ORiAqKnBjb25mLCBjb25zdCBjaGFyICpjb25maWdGaWxl
KQo+IHsKPiAgICAgCWNvbnN0IGNoYXIgKm15bmFtZSA9ICJsYWtfY29uZmlndXJlIjsKPiAKPiAJ
TEFLX0NPTkYgKmNvbmY7Cj4gCWludCByYyA9IDA7Cj4gCWNoYXIgKnM7Cj4gCj4gCWNvbmYgPSBt
YWxsb2MoIHNpemVvZihMQUtfQ09ORikgKTsKPiAJaWYgKGNvbmYgPT0gTlVMTCkgewo+IAkJcmV0
dXJuIExBS19GQUlMOwo+IAl9Cj4gCj4gCWNvbmYtPnBhdGggPSBzdHJkdXAoY29uZmlnRmlsZSk7
Cj4gCWlmIChjb25mLT5wYXRoID09IE5VTEwpIHsKPiAJCXJldHVybiBMQUtfRkFJTDsKPiAJfQo+
IAo+IAlyYyA9IGxha19yZWFkX2NvbmZpZyhjb25mLT5wYXRoKTsKPiAJaWYgKHJjICE9IExBS19P
Sykgewo+IAkJcmV0dXJuIExBS19GQUlMOwo+IAl9Cj4gCj4gCWNvbmYtPnNlcnZlcnMgPSAoY2hh
ciAqKSBsYWtfY29uZmlnX2dldHN0cmluZygibGRhcF9zZXJ2ZXJzIiwgImxkYXA6Ly9sb2NhbGhv
c3QvIik7Cj4gCWNvbmYtPmJpbmRfZG4gPSAoY2hhciAqKSBsYWtfY29uZmlnX2dldHN0cmluZygi
bGRhcF9iaW5kX2RuIiwgIiIpOwo+IAljb25mLT5iaW5kX3B3ID0gKGNoYXIgKikgbGFrX2NvbmZp
Z19nZXRzdHJpbmcoImxkYXBfYmluZF9wdyIsICIiKTsKPiAJY29uZi0+dmVyc2lvbiA9IGxha19j
b25maWdfZ2V0aW50KCJsZGFwX3ZlcnNpb24iLCBMREFQX1ZFUlNJT04zKTsKPiAJY29uZi0+c2Vh
cmNoX2Jhc2UgPSAoY2hhciAqKSBsYWtfY29uZmlnX2dldHN0cmluZygibGRhcF9zZWFyY2hfYmFz
ZSIsICIiKTsKPiAJY29uZi0+ZmlsdGVyID0gKGNoYXIgKikgbGFrX2NvbmZpZ19nZXRzdHJpbmco
ImxkYXBfZmlsdGVyIiwgInVpZD0ldSIpOwo+IAljb25mLT5sb29rdXBfYXR0cmliID0gKGNoYXIg
KikgbGFrX2NvbmZpZ19nZXRzdHJpbmcoImxkYXBfbG9va3VwX2F0dHJpYiIsIE5VTEwpOwo+IAlj
b25mLT5hdXRoX21ldGhvZCA9IExBS19BVVRIX01FVEhPRF9CSU5EOwo+IAlzID0gKGNoYXIgKikg
bGFrX2NvbmZpZ19nZXRzdHJpbmcoImxkYXBfYXV0aF9tZXRob2QiLCBOVUxMKTsKPiAJaWYgKHMp
IHsKPiAJCWlmICghc3RyY2FzZWNtcChzLCAiY3VzdG9tIikpIHsKPiAJCQljb25mLT5hdXRoX21l
dGhvZCA9IExBS19BVVRIX01FVEhPRF9DVVNUT007Cj4gCQl9Cj4gCX0KPiAJY29uZi0+dGltZW91
dC50dl9zZWMgPSBsYWtfY29uZmlnX2dldGludCgibGRhcF90aW1lb3V0IiwgNSk7Cj4gCWNvbmYt
PnRpbWVvdXQudHZfdXNlYyA9IDA7Cj4gCWNvbmYtPnNpemVsaW1pdCA9IGxha19jb25maWdfZ2V0
aW50KCJsZGFwX3NpemVsaW1pdCIsIDEpOwo+IAljb25mLT50aW1lbGltaXQgPSBsYWtfY29uZmln
X2dldGludCgibGRhcF90aW1lbGltaXQiLCA1KTsKPiAJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVG
X05FVkVSOwo+IAlzID0gKGNoYXIgKikgbGFrX2NvbmZpZ19nZXRzdHJpbmcoImxkYXBfZGVyZWYi
LCBOVUxMKTsKPiAJaWYgKHMpIHsKPiAJCWlmICghc3RyY2FzZWNtcChzLCAic2VhcmNoIikpIHsK
PiAJCQljb25mLT5kZXJlZiA9IExEQVBfREVSRUZfU0VBUkNISU5HOwo+IAkJfSBlbHNlIGlmICgh
c3RyY2FzZWNtcChzLCAiZmluZCIpKSB7Cj4gCQkJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVGX0ZJ
TkRJTkc7Cj4gCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKHMsICJhbHdheXMiKSkgewo+IAkJCWNv
bmYtPmRlcmVmID0gTERBUF9ERVJFRl9BTFdBWVM7Cj4gCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21w
KHMsICJuZXZlciIpKSB7Cj4gCQkJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVGX05FVkVSOwo+IAkJ
fQo+IAl9Cj4gCWNvbmYtPnJlZmVycmFscyA9IGxha19jb25maWdfZ2V0c3dpdGNoKCJsZGFwX3Jl
ZmVycmFscyIsIDApOwo+IAljb25mLT5yZXN0YXJ0ID0gbGFrX2NvbmZpZ19nZXRzd2l0Y2goImxk
YXBfcmVzdGFydCIsIDEpOwo+IAljb25mLT5jYWNoZV9leHBpcnkgPSBsYWtfY29uZmlnX2dldGlu
dCgibGRhcF9jYWNoZV9leHBpcnkiLCAwKTsKPiAJY29uZi0+Y2FjaGVfc2l6ZSA9IGxha19jb25m
aWdfZ2V0aW50KCJsZGFwX2NhY2hlX3NpemUiLCAwKTsKPiAJY29uZi0+c2NvcGUgPSBMREFQX1ND
T1BFX1NVQlRSRUU7Cj4gCXMgPSAoY2hhciAqKSBsYWtfY29uZmlnX2dldHN0cmluZygibGRhcF9z
Y29wZSIsIE5VTEwpOwo+IAlpZiAocykgewo+IAkJaWYgKCFzdHJjYXNlY21wKHMsICJvbmUiKSkg
ewo+IAkJCWNvbmYtPnNjb3BlID0gTERBUF9TQ09QRV9PTkVMRVZFTDsKPiAJCX0gZWxzZSBpZiAo
IXN0cmNhc2VjbXAocywgImJhc2UiKSkgewo+IAkJCWNvbmYtPnNjb3BlID0gTERBUF9TQ09QRV9C
QVNFOwo+IAkJfQo+IAl9Cj4gCWNvbmYtPmRlYnVnID0gbGFrX2NvbmZpZ19nZXRpbnQoImxkYXBf
ZGVidWciLCAwKTsKPiAJY29uZi0+dmVyYm9zZSA9IGxha19jb25maWdfZ2V0c3dpdGNoKCJsZGFw
X3ZlcmJvc2UiLCAwKTsKPiAJY29uZi0+c3NsID0gbGFrX2NvbmZpZ19nZXRzd2l0Y2goImxkYXBf
c3NsIiwgMCk7Cj4gCWNvbmYtPnN0YXJ0X3RscyA9IGxha19jb25maWdfZ2V0c3dpdGNoKCJsZGFw
X3N0YXJ0X3RscyIsIDApOwo+IAlpZiAoY29uZi0+c3RhcnRfdGxzKSB7Cj4gCQljb25mLT5zc2wg
PSAwOwo+IAl9Cj4gCWNvbmYtPnRsc19jaGVja3BlZXIgPSBsYWtfY29uZmlnX2dldGludCgibGRh
cF90bHNfY2hlY2twZWVyIiwgMCk7Cj4gCWNvbmYtPnRsc19jYWNlcnRmaWxlID0gKGNoYXIgKikg
bGFrX2NvbmZpZ19nZXRzdHJpbmcoImxkYXBfdGxzX2NhY2VydGZpbGUiLCBOVUxMKTsKPiAJY29u
Zi0+dGxzX2NhY2VydGRpciA9IChjaGFyICopIGxha19jb25maWdfZ2V0c3RyaW5nKCJsZGFwX3Rs
c19jYWNlcnRkaXIiLCBOVUxMKTsKPiAJY29uZi0+dGxzX2NpcGhlcnMgPSAoY2hhciAqKSBsYWtf
Y29uZmlnX2dldHN0cmluZygibGRhcF90bHNfY2lwaGVycyIsIE5VTEwpOwo+IAljb25mLT50bHNf
Y2VydCA9IChjaGFyICopIGxha19jb25maWdfZ2V0c3RyaW5nKCJsZGFwX3Rsc19jZXJ0IiwgTlVM
TCk7Cj4gCWNvbmYtPnRsc19rZXkgPSAoY2hhciAqKSBsYWtfY29uZmlnX2dldHN0cmluZygibGRh
cF90bHNfa2V5IiwgTlVMTCk7CjY3YTI3OAo+IAkqcGNvbmYgPSBjb25mOwo3MWEyODMsMzg1Cj4g
ICogVXRpbCBmdW5jdGlvbnMKPiAgKi8KPiAjaWYgMAo+IHN0YXRpYyBpbnQgbGFrX2dldF9pbnRl
Z2VyX3ZhbHVlIChMREFQICpsZCwgTERBUE1lc3NhZ2UgKmUsIGNvbnN0IGNoYXIgKmF0dHIsIGlu
dCAqcHRyKQo+IHsKPiAJY2hhciAqKnZhbHM7Cj4gCj4gCXZhbHMgPSBsZGFwX2dldF92YWx1ZXMg
KGxkLCBlLCAoY2hhciAqKSBhdHRyKTsKPiAJaWYgKHZhbHMgPT0gTlVMTCkgewo+IAkJcmV0dXJu
IExBS19GQUlMOwo+IAl9Cj4gCSpwdHIgPSBhdG9pICh2YWxzWzBdKTsKPiAJbGRhcF92YWx1ZV9m
cmVlICh2YWxzKTsKPiAKPiAJcmV0dXJuIExBS19PSzsKPiB9Cj4gCj4gc3RhdGljIGludCBsYWtf
Z2V0X2xvbmdfaW50ZWdlcl92YWx1ZSAoTERBUCAqbGQsIExEQVBNZXNzYWdlICplLCBjb25zdCBj
aGFyICphdHRyLCBsb25nIGludCAqcHRyKQo+IHsKPiAJY2hhciAqKnZhbHM7Cj4gCj4gCXZhbHMg
PSBsZGFwX2dldF92YWx1ZXMgKGxkLCBlLCAoY2hhciAqKSBhdHRyKTsKPiAJaWYgKHZhbHMgPT0g
TlVMTCkgewo+IAkJcmV0dXJuIExBS19GQUlMOwo+IAl9Cj4gCSpwdHIgPSBhdG9sICh2YWxzWzBd
KTsKPiAJbGRhcF92YWx1ZV9mcmVlICh2YWxzKTsKPiAKPiAJcmV0dXJuIExBS19PSzsKPiB9Cj4g
Cj4gCj4gc3RhdGljIGludCBsYWtfb2NfY2hlY2sgKExEQVAgKmxkLCBMREFQTWVzc2FnZSAqZSwg
Y29uc3QgY2hhciAqb2MpCj4gewo+IAljaGFyICoqdmFscywgKipwOwo+IAlpbnQgcmMgPSAwOwo+
IAo+IAl2YWxzID0gbGRhcF9nZXRfdmFsdWVzIChsZCwgZSwgIm9iamVjdENsYXNzIik7Cj4gCWlm
ICh2YWxzID09IE5VTEwpIHsKPiAJcmV0dXJuIExBS19GQUlMOwo+IAl9Cj4gCj4gCWZvciAocCA9
IHZhbHM7ICpwICE9IE5VTEw7IHArKykgewo+IAkJaWYgKCFzdHJjYXNlY21wICgqcCwgb2MpKSB7
Cj4gCQkJcmMgPSAxOwo+IAkJCWJyZWFrOwo+IAkJfQo+IAl9Cj4gCj4gCWxkYXBfdmFsdWVfZnJl
ZSAodmFscyk7Cj4gCj4gCXJldHVybiByYzsKPiB9Cj4gCj4gc3RhdGljIGludCBsYWtfaGFzX3Zh
bHVlIChjaGFyICoqc3JjLCBjb25zdCBjaGFyICp0Z3QpCj4gewo+IAljaGFyICoqcDsKPiAKPiAJ
Zm9yIChwID0gc3JjOyAqcCAhPSBOVUxMOyBwKyspIHsKPiAJCWlmICghc3RyY2FzZWNtcCAoKnAs
IHRndCkpIHsKPiAJCQlyZXR1cm4gMTsKPiAJCX0KPiAJfQo+IAo+IAlyZXR1cm4gMDsKPiB9Cj4g
Cj4gc3RhdGljIGludCBsYWtfZ2V0X3N0cmluZ192YWx1ZXMgKExEQVAgKmxkLCBMREFQTWVzc2Fn
ZSAqZSwgY29uc3QgY2hhciAqYXR0ciwgY2hhciAqKipwdHIpCj4gewo+IAljaGFyICoqdmFsczsK
PiAKPiAJdmFscyA9IGxkYXBfZ2V0X3ZhbHVlcyAobGQsIGUsIChjaGFyICopIGF0dHIpOwo+IAlp
ZiAodmFscyA9PSBOVUxMKSB7Cj4gCQlyZXR1cm4gTEFLX0ZBSUw7Cj4gCX0KPiAJKnB0ciA9IHZh
bHM7Cj4gCj4gCXJldHVybiBMQUtfT0s7Cj4gfQo+ICNlbmRpZiAvKiAwICovCj4gCj4gc3RhdGlj
IGludCBsYWtfZ2V0X3N0cmluZ192YWx1ZSAoTERBUCAqbGQsIExEQVBNZXNzYWdlICplLCBjb25z
dCBjaGFyICphdHRyLCBjaGFyICoqcHRyKQo+IHsKPiAJY2hhciAqKnZhbHM7Cj4gCWludCByYzsK
PiAKPiAJdmFscyA9IGxkYXBfZ2V0X3ZhbHVlcyAobGQsIGUsIChjaGFyICopIGF0dHIpOwo+IAlp
ZiAodmFscyA9PSBOVUxMKSB7Cj4gCQlyZXR1cm4gTEFLX0ZBSUw7Cj4gCX0KPiAJKnB0ciA9IHN0
cmR1cCAodmFsc1swXSk7Cj4gCWlmICgqcHRyID09IE5VTEwpIHsKPiAJCXJjID0gTEFLX0ZBSUw7
Cj4gCX0gZWxzZSB7Cj4gCQlyYyA9IExBS19PSzsKPiAJfQo+IAo+IAlsZGFwX3ZhbHVlX2ZyZWUg
KHZhbHMpOwo+IAo+IAlyZXR1cm4gcmM7Cj4gfQo+IAo+IC8qCjgwYzM5NAo8IHN0YXRpYyBjaGFy
ICpsYWtfZXNjYXBlKExBSyAqY29uZiwgY2hhciAqcykgCi0tLQo+IHN0YXRpYyBpbnQgbGFrX2Vz
Y2FwZShjb25zdCBjaGFyICpzLCBjaGFyICoqcmVzdWx0KSAKODJjMzk2CjwgICAgIAljaGFyICAq
bXluYW1lID0gImxha19lc2NhcGUiOwotLS0KPiAgICAgCS8qIGNoYXIgICpteW5hbWUgPSAibGFr
X2VzY2FwZSI7ICovCjg3LDkxZDQwMAo8IAlpZiAocyA9PSBOVUxMKSB7CjwgCQlzeXNsb2coTE9H
X1dBUk5JTkd8TE9HX0FVVEgsICIlczogTm90aGluZyB0byBlc2NhcGUuIiwgbXluYW1lKTsKPCAJ
CXJldHVybiBOVUxMOwo8IAl9CjwgCjk0LDk1YzQwMwo8IAkJc3lzbG9nKExPR19FUlJ8TE9HX0FV
VEgsICIlczogQ2Fubm90IGFsbG9jYXRlIG1lbW9yeSIsIG15bmFtZSk7CjwgCQlyZXR1cm4gTlVM
TDsKLS0tCj4gCQlyZXR1cm4gTEFLX0ZBSUw7Cjk5YzQwNwo8IAlwdHIgPSBzOwotLS0KPiAJcHRy
ID0gKGNoYXIgKilzOwoxMjksMTMwYzQzNwo8IAlpZiAoY29uZi0+dmVyYm9zZSkKPCAJCXN5c2xv
ZyhMT0dfSU5GT3xMT0dfQVVUSCwiJXM6IEFmdGVyIGVzY2FwaW5nLCBpdCdzICVzIiwgbXluYW1l
LCBidWYpOwotLS0KPiAJKnJlc3VsdCA9IGJ1ZjsKMTMyYzQzOQo8IAlyZXR1cm4oYnVmKTsKLS0t
Cj4gCXJldHVybiBMQUtfT0s7CjE0M2M0NTAKPCBzdGF0aWMgY2hhciAqbGFrX2ZpbHRlcihMQUsg
KmNvbmYsIGNoYXIgKnVzZXIsIGNoYXIgKnJlYWxtKSAKLS0tCj4gc3RhdGljIGludCBsYWtfZmls
dGVyKExBS19TRVNTSU9OICpzZXNzaW9uLCBjb25zdCBjaGFyICp1c2VybmFtZSwgY29uc3QgY2hh
ciAqcmVhbG0sIGNoYXIgKipyZXN1bHQpIAoxNDlhNDU3Cj4gCWludCByYzsKMTUxYzQ1OQo8IAlp
ZiAoY29uZi0+ZmlsdGVyID09IE5VTEwpIHsKLS0tCj4gCWlmIChzZXNzaW9uLT5jb25mLT5maWx0
ZXIgPT0gTlVMTCkgewoxNTMsMTU4YzQ2MQo8IAkJcmV0dXJuIE5VTEw7CjwgCX0KPCAKPCAJaWYg
KHVzZXIgPT0gTlVMTCkgewo8IAkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IHVz
ZXIgaXMgbnVsbCIsIG15bmFtZSk7CjwgCQlyZXR1cm4gTlVMTDsKLS0tCj4gCQlyZXR1cm4gTEFL
X0ZBSUw7CjE2MWM0NjQKPCAJYnVmPW1hbGxvYyhzdHJsZW4oY29uZi0+ZmlsdGVyKStzdHJsZW4o
dXNlcikrc3RybGVuKHJlYWxtKSsxKTsKLS0tCj4gCWJ1Zj1tYWxsb2Moc3RybGVuKHNlc3Npb24t
PmNvbmYtPmZpbHRlcikrc3RybGVuKHVzZXJuYW1lKStzdHJsZW4ocmVhbG0pKzEpOwoxNjRjNDY3
CjwgCQlyZXR1cm4gTlVMTDsKLS0tCj4gCQlyZXR1cm4gTEFLX0ZBSUw7CjE2OGM0NzEKPCAJcHRy
PWNvbmYtPmZpbHRlcjsKLS0tCj4gCXB0cj1zZXNzaW9uLT5jb25mLT5maWx0ZXI7CjE4NiwxODlj
NDg5LDQ5Ngo8IAkJCQllYnVmPWxha19lc2NhcGUoY29uZiwgdXNlcik7CjwgCQkJCWlmIChlYnVm
IT1OVUxMKSB7CjwgCQkJCQlzdHJjYXQoYnVmLGVidWYpOwo8IAkJCQkJZnJlZShlYnVmKTsKLS0t
Cj4gCQkJCWlmICh1c2VybmFtZSE9TlVMTCkgewo+IAkJCQkJcmM9bGFrX2VzY2FwZSh1c2VybmFt
ZSwgJmVidWYpOwo+IAkJCQkJaWYgKHJjID09IExBS19PSykgewo+IAkJCQkJCXN0cmNhdChidWYs
ZWJ1Zik7Cj4gCQkJCQkJZnJlZShlYnVmKTsKPiAJCQkJCX0KPiAJCQkJfSBlbHNlIHsKPiAJCQkJ
CXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIiVzOiBVc2VybmFtZSBub3QgYXZhaWxhYmxl
LiIsIG15bmFtZSk7CjE5NCwxOTVjNTAxLDUwMgo8IAkJCQkJZWJ1ZiA9IGxha19lc2NhcGUoY29u
ZiwgcmVhbG0pOwo8IAkJCQkJaWYgKGVidWYgIT0gTlVMTCkgewotLS0KPiAJCQkJCXJjID0gbGFr
X2VzY2FwZShyZWFsbSwgJmVidWYpOwo+IAkJCQkJaWYgKHJjID09IExBS19PSykgewoxOThhNTA2
LDUwNwo+IAkJCQl9IGVsc2Ugewo+IAkJCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAi
JXM6IFJlYWxtIG5vdCBhdmFpbGFibGUuIiwgbXluYW1lKTsKMjAyZDUxMAo8IAkJCQlzeXNsb2co
TE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogSW52YWxpZCBsb29rdXAgc3Vic3RpdHV0aW9uIGZv
cm1hdCAnJSUlYychIiwgbXluYW1lLCAqKHRlbXArMSkpOwoyMTBjNTE4CjwgCWlmIChjb25mLT52
ZXJib3NlKQotLS0KPiAJaWYgKHNlc3Npb24tPmNvbmYtPnZlcmJvc2UpCjIxM2M1MjEsNTIzCjwg
CXJldHVybihidWYpOwotLS0KPiAJKnJlc3VsdCA9IGJ1ZjsKPiAKPiAJcmV0dXJuIExBS19PSzsK
MjE2LDIxOWM1MjYKPCAvKiAKPCAgKiBFc3RhYmxpc2ggYSBjb25uZWN0aW9uIHRvIHRoZSBMREFQ
IHNlcnZlci4gCjwgICovCjwgc3RhdGljIGludCBsYWtfY29ubmVjdChMQUsgKmNvbmYsIExEQVAg
KipyZXMpCi0tLQo+IHN0YXRpYyBpbnQgbGFrX2dldF91c2VyKExBS19TRVNTSU9OICpzZXNzaW9u
LCBjb25zdCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpyZWFsbSkKMjIxYzUyOCw2NTQKPCAJY2hh
ciAgICpteW5hbWUgPSAibGFrX2Nvbm5lY3QiOwotLS0KPiAJY29uc3QgY2hhciAqbXluYW1lID0g
Imxha19nZXRfdXNlciI7Cj4gCj4gCWNoYXIgKmZpbHRlcjsKPiAJaW50IHJjOwo+IAlMREFQTWVz
c2FnZSAqcmVzLCAqZW50cnk7Cj4gCj4gCWlmIChzZXNzaW9uLT51c2VyICE9IE5VTEwpIHsgLyog
U2hvdWxkIG5vdCBoYXBwZW4sIGp1c3QgYSBzYW5pdHkgY2hlY2sgKi8KPiAJCWxha19yZWxlYXNl
X3VzZXIoJnNlc3Npb24tPnVzZXIpOwo+IAl9Cj4gCj4gCXJjID0gbGFrX2ZpbHRlcihzZXNzaW9u
LCB1c2VyLCByZWFsbSwgJmZpbHRlcik7Cj4gCWlmIChyYyAhPSBMQUtfT0spIHsKPiAJCXN5c2xv
ZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIiVzOiBsYWtfZmlsdGVyIGZhaWxlZC4iLCBteW5hbWUp
Owo+IAkJcmV0dXJuIExBS19GQUlMOwo+IAl9Cj4gCj4gCXJjID0gbGFrX3NlYXJjaChzZXNzaW9u
LCBmaWx0ZXIsIE5VTEwsICZyZXMpOwo+IAlpZiAocmMgIT0gTEFLX09LKSB7Cj4gCQlzeXNsb2co
TE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogbGFrX3NlYXJjaCBmYWlsZWQuIiwgbXluYW1lKTsK
PiAJCWZyZWUoZmlsdGVyKTsKPiAJCXJldHVybiBMQUtfRkFJTDsKPiAJfQo+IAo+IAllbnRyeSA9
IGxkYXBfZmlyc3RfZW50cnkoc2Vzc2lvbi0+bGQsIHJlcyk7IAo+IAlpZiAoZW50cnkgPT0gTlVM
TCkgewo+IAkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IGxkYXBfZmlyc3RfZW50
cnkoKSBmYWlsZWQuIiwgbXluYW1lKTsKPiAJCWZyZWUoZmlsdGVyKTsKPiAJCWxkYXBfbXNnZnJl
ZShyZXMpOwo+IAkJcmV0dXJuIExBS19GQUlMOwo+IAl9Cj4gCj4gCXNlc3Npb24tPnVzZXIgPSAo
TEFLX1VTRVIgKikgbWFsbG9jKHNpemVvZihMQUtfVVNFUikpOwo+IAlpZiAoc2Vzc2lvbi0+dXNl
ciA9PSBOVUxMKSB7Cj4gCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgIiVzOiBDYW5ub3QgYWxs
b2NhdGUgbWVtb3J5IiwgbXluYW1lKTsKPiAJCWZyZWUoZmlsdGVyKTsKPiAJCWxkYXBfbXNnZnJl
ZSAocmVzKTsKPiAJCXJldHVybiBMQUtfRkFJTDsKPiAJfQo+IAo+IAlzZXNzaW9uLT51c2VyLT5u
YW1lID0gc3RyZHVwKHVzZXIpOwo+IAlpZiAoc2Vzc2lvbi0+dXNlci0+bmFtZSA9PSBOVUxMKSB7
Cj4gCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgIiVzOiBDYW5ub3Qgc3RyZHVwIG9yIHVzZXJu
YW1lIGlzIGVtcHR5IiwgbXluYW1lKTsKPiAJCWZyZWUoZmlsdGVyKTsKPiAJCWxkYXBfbXNnZnJl
ZSAocmVzKTsKPiAJCWxha19yZWxlYXNlX3VzZXIoJnNlc3Npb24tPnVzZXIpOwo+IAkJcmV0dXJu
IExBS19GQUlMOwo+IAl9Cj4gCj4gCWlmIChyZWFsbSkgewo+IAkJc2Vzc2lvbi0+dXNlci0+cmVh
bG0gPSBzdHJkdXAocmVhbG0pOwo+IAkJaWYgKHNlc3Npb24tPnVzZXItPnJlYWxtID09IE5VTEwp
IHsKPiAJCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgIiVzOiBDYW5ub3Qgc3RyZHVwIiwgbXlu
YW1lKTsKPiAJCQlmcmVlKGZpbHRlcik7Cj4gCQkJbGRhcF9tc2dmcmVlIChyZXMpOwo+IAkJCWxh
a19yZWxlYXNlX3VzZXIoJnNlc3Npb24tPnVzZXIpOwo+IAkJCXJldHVybiBMQUtfRkFJTDsKPiAJ
CX0KPiAJfQo+IAo+IAlzZXNzaW9uLT51c2VyLT5kbiA9IGxkYXBfZ2V0X2RuKHNlc3Npb24tPmxk
LCByZXMpOwo+IAlpZiAoc2Vzc2lvbi0+dXNlci0+ZG4gPT0gTlVMTCkgewo+IAkJc3lzbG9nKExP
R19FUlJ8TE9HX0FVVEgsICIlczogbGRhcF9nZXRfZG4oKSBmYWlsZWQuIiwgbXluYW1lKTsKPiAJ
CWZyZWUoZmlsdGVyKTsKPiAJCWxkYXBfbXNnZnJlZSAocmVzKTsKPiAJCWxha19yZWxlYXNlX3Vz
ZXIoJnNlc3Npb24tPnVzZXIpOwo+IAkJcmV0dXJuIExBS19GQUlMOwo+IAl9Cj4gCj4gCXNlc3Np
b24tPnVzZXItPmJvdW5kX2FzX3VzZXIgPSAwOwo+IAo+IAlmcmVlKGZpbHRlcik7Cj4gCWxkYXBf
bXNnZnJlZSAocmVzKTsKPiAKPiAJcmV0dXJuIExBS19PSzsKPiB9Cj4gCj4gCj4gc3RhdGljIGlu
dCBsYWtfZ2V0X3Nlc3Npb24oTEFLX1NFU1NJT04gKipwc2Vzc2lvbiwgY29uc3QgY2hhciAqY29u
ZmlnRmlsZSkgCj4gewo+ICAgICAJY2hhciAgKm15bmFtZSA9ICJsYWtfZ2V0X3Nlc3Npb24iOwo+
IAo+IAlMQUtfU0VTU0lPTiAqc2Vzc2lvbjsKPiAJaW50IHJjOwo+IAo+IAlzZXNzaW9uID0gKnBz
ZXNzaW9uOwo+IAo+IAlpZiAoc2Vzc2lvbiAhPSBOVUxMKSB7Cj4gCQlpZiAoc2Vzc2lvbi0+Y29u
Zi0+dmVyYm9zZSkKPiAJCQlzeXNsb2coTE9HX0lORk98TE9HX0FVVEgsICIlczogUmV1c2UgZXhp
c3RpbmcgbGFrIHNlc3Npb24uIiwgbXluYW1lKTsKPiAKPiAJCWlmIChzZXNzaW9uLT51c2VyICE9
IE5VTEwpIHsgLyogZ2FyYmFnZSBjb2xsZWN0aW9uLCBzaG91bGQgbm90IGhhcHBlbiAqLwo+IAkJ
CWxha19yZWxlYXNlX3VzZXIoJnNlc3Npb24tPnVzZXIpOwo+IAkJfQo+IAkJcmV0dXJuIExBS19P
SzsKPiAJfQo+IAo+IAlzZXNzaW9uID0gKExBS19TRVNTSU9OICopbWFsbG9jKHNpemVvZihMQUsp
KTsKPiAJaWYgKHNlc3Npb24gPT0gTlVMTCkgewo+IAkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgs
ICIlczogQ2Fubm90IGFsbG9jYXRlIG1lbW9yeSIsIG15bmFtZSk7Cj4gCQlyZXR1cm4gTEFLX0ZB
SUw7Cj4gCX0KPiAKPiAJc2Vzc2lvbi0+Ym91bmQ9MDsKPiAJc2Vzc2lvbi0+bGQ9TlVMTDsKPiAJ
c2Vzc2lvbi0+Y29uZj1OVUxMOwo+IAlzZXNzaW9uLT51c2VyPU5VTEw7Cj4gCj4gCXJjID0gbGFr
X2NvbmZpZ3VyZSgmc2Vzc2lvbi0+Y29uZiwgY29uZmlnRmlsZSk7Cj4gCWlmIChyYyAhPSBMQUtf
T0spIHsKPiAJCXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAiJXM6IENvbmZpZ3VyZSBmYWlsZWQg
LSBjaGVjayBjb25maWd1cmF0aW9uIGZpbGUgJXMuIiwgbXluYW1lLCBzZXNzaW9uLT5jb25mLT5w
YXRoKTsKPiAJCWxha19yZWxlYXNlX2NvbmZpZygmc2Vzc2lvbi0+Y29uZik7Cj4gCQlmcmVlKHNl
c3Npb24pOwo+IAkJcmV0dXJuIHJjOwo+IAl9Cj4gCj4gCWlmIChzZXNzaW9uLT5jb25mLT52ZXJi
b3NlKQo+IAkJc3lzbG9nKExPR19JTkZPfExPR19BVVRILCAiJXM6IFN0YXJ0IGEgbmV3IGxhayBz
ZXNzaW9uLiIsIG15bmFtZSk7Cj4gCj4gCSpwc2Vzc2lvbj1zZXNzaW9uOwo+IAo+IAlyZXR1cm4g
TEFLX09LOwo+IH0KPiAKPiAKPiBzdGF0aWMgaW50IGxha19vcGVuX3Nlc3Npb24oTEFLX1NFU1NJ
T04gKnNlc3Npb24pCj4gewo+IAljaGFyICAgKm15bmFtZSA9ICJsYWtfb3Blbl9zZXNzaW9uIjsK
MjI0ZDY1Ngo8IAlMREFQICAgKmxkOwoyMjYsMjI3YzY1OCw2NjcKPCAJaWYgKGNvbmYtPnZlcmJv
c2UpCjwgCQlzeXNsb2coTE9HX0lORk98TE9HX0FVVEgsICIlczogQ29ubmVjdGluZyB0byBzZXJ2
ZXIgJXMiLCBteW5hbWUsIGNvbmYtPnNlcnZlcnMpOwotLS0KPiAJaWYgKHNlc3Npb24tPmNvbmYt
PnZlcmJvc2UpCj4gCQlzeXNsb2coTE9HX0lORk98TE9HX0FVVEgsICIlczogU2V0dXAgTERBUCBz
dHJ1Y3R1cmVzLiIsIG15bmFtZSk7Cj4gCj4gCWlmIChzZXNzaW9uLT5jb25mLT5zc2wgfHwgc2Vz
c2lvbi0+Y29uZi0+c3RhcnRfdGxzKSB7Cj4gCQlpZiAoc2Vzc2lvbi0+Y29uZi0+dGxzX2NhY2Vy
dGZpbGUgIT0gTlVMTCkgewo+IAkJCXJjID0gbGRhcF9zZXRfb3B0aW9uIChOVUxMLCBMREFQX09Q
VF9YX1RMU19DQUNFUlRGSUxFLCBzZXNzaW9uLT5jb25mLT50bHNfY2FjZXJ0ZmlsZSk7Cj4gCQkJ
aWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewo+IAkJCQlzeXNsb2cgKExPR19XQVJOSU5HfExPR19B
VVRILCAiJXM6IFVuYWJsZSB0byBzZXQgTERBUF9PUFRfWF9UTFNfQ0FDRVJURklMRSAoJXMpLiIs
IG15bmFtZSwgbGRhcF9lcnIyc3RyaW5nIChyYykpOwo+IAkJCX0KPiAJCX0KMjI5YzY2OSw3MDUK
PCAJcmMgPSBsZGFwX2luaXRpYWxpemUoJmxkLCBjb25mLT5zZXJ2ZXJzKTsKLS0tCj4gCQlpZiAo
c2Vzc2lvbi0+Y29uZi0+dGxzX2NhY2VydGRpciAhPSBOVUxMKSB7Cj4gCQkJcmMgPSBsZGFwX3Nl
dF9vcHRpb24gKE5VTEwsIExEQVBfT1BUX1hfVExTX0NBQ0VSVERJUiwgc2Vzc2lvbi0+Y29uZi0+
dGxzX2NhY2VydGRpcik7Cj4gCQkJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewo+IAkJCQlzeXNs
b2cgKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVuYWJsZSB0byBzZXQgTERBUF9PUFRfWF9U
TFNfQ0FDRVJURElSICglcykuIiwgbXluYW1lLCBsZGFwX2VycjJzdHJpbmcgKHJjKSk7Cj4gCQkJ
fQo+IAkJfQo+IAo+IAkJLyogcmVxdWlyZSBjZXJ0PyAqLwo+IAkJcmMgPSBsZGFwX3NldF9vcHRp
b24gKE5VTEwsIExEQVBfT1BUX1hfVExTX1JFUVVJUkVfQ0VSVCwgJnNlc3Npb24tPmNvbmYtPnRs
c19jaGVja3BlZXIpOwo+IAkJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewo+IAkJCXN5c2xvZyAo
TE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRvIHNldCBMREFQX09QVF9YX1RMU19S
RVFVSVJFX0NFUlQgKCVzKS4iLCBteW5hbWUsIGxkYXBfZXJyMnN0cmluZyAocmMpKTsKPiAJCX0K
PiAKPiAJCWlmIChzZXNzaW9uLT5jb25mLT50bHNfY2lwaGVycyAhPSBOVUxMKSB7Cj4gCQkJLyog
c2V0IGNpcGhlciBzdWl0ZSwgY2VydGlmaWNhdGUgYW5kIHByaXZhdGUga2V5OiAqLwo+IAkJCXJj
ID0gbGRhcF9zZXRfb3B0aW9uIChOVUxMLCBMREFQX09QVF9YX1RMU19DSVBIRVJfU1VJVEUsIHNl
c3Npb24tPmNvbmYtPnRsc19jaXBoZXJzKTsKPiAJCQlpZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7
Cj4gCQkJCXN5c2xvZyAoTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRvIHNldCBM
REFQX09QVF9YX1RMU19DSVBIRVJfU1VJVEUgKCVzKS4iLCBteW5hbWUsIGxkYXBfZXJyMnN0cmlu
ZyAocmMpKTsKPiAJCQl9Cj4gCQl9Cj4gCj4gCQlpZiAoc2Vzc2lvbi0+Y29uZi0+dGxzX2NlcnQg
IT0gTlVMTCkgewo+IAkJCXJjID0gbGRhcF9zZXRfb3B0aW9uIChOVUxMLCBMREFQX09QVF9YX1RM
U19DRVJURklMRSwgc2Vzc2lvbi0+Y29uZi0+dGxzX2NlcnQpOwo+IAkJCWlmIChyYyAhPSBMREFQ
X1NVQ0NFU1MpIHsKPiAJCQkJc3lzbG9nIChMT0dfV0FSTklOR3xMT0dfQVVUSCwgIiVzOiBVbmFi
bGUgdG8gc2V0IExEQVBfT1BUX1hfVExTX0NFUlRGSUxFICglcykuIiwgbXluYW1lLCBsZGFwX2Vy
cjJzdHJpbmcgKHJjKSk7Cj4gCQkJfQo+IAkJfQo+IAo+IAkJaWYgKHNlc3Npb24tPmNvbmYtPnRs
c19rZXkgIT0gTlVMTCkgewo+IAkJCXJjID0gbGRhcF9zZXRfb3B0aW9uIChOVUxMLCBMREFQX09Q
VF9YX1RMU19LRVlGSUxFLCBzZXNzaW9uLT5jb25mLT50bHNfa2V5KTsKPiAJCQlpZiAocmMgIT0g
TERBUF9TVUNDRVNTKSB7Cj4gCQkJCXN5c2xvZyAoTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczog
VW5hYmxlIHRvIHNldCBMREFQX09QVF9YX1RMU19LRVlGSUxFICglcykuIiwgbXluYW1lLCBsZGFw
X2VycjJzdHJpbmcgKHJjKSk7Cj4gCQkJfQo+IAkJfQo+IAl9Cj4gCj4gCXJjID0gbGRhcF9pbml0
aWFsaXplKCZzZXNzaW9uLT5sZCwgc2Vzc2lvbi0+Y29uZi0+c2VydmVycyk7CjIzMWM3MDcKPCAJ
CXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAiJXM6IGxkYXBfaW5pdGlhbGl6ZSBmYWlsZWQiLCBt
eW5hbWUsIGNvbmYtPnNlcnZlcnMpOwotLS0KPiAJCXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAi
JXM6IGxkYXBfaW5pdGlhbGl6ZSBmYWlsZWQiLCBteW5hbWUsIHNlc3Npb24tPmNvbmYtPnNlcnZl
cnMpOwoyMzUsMjM2YzcxMSw3MTIKPCAJaWYgKGNvbmYtPmRlYnVnKSB7CjwgCQlsZGFwX3NldF9v
cHRpb24oTlVMTCwgTERBUF9PUFRfREVCVUdfTEVWRUwsICYoY29uZi0+ZGVidWcpKTsKLS0tCj4g
CWlmIChzZXNzaW9uLT5jb25mLT5kZWJ1Zykgewo+IAkJcmMgPSBsZGFwX3NldF9vcHRpb24oTlVM
TCwgTERBUF9PUFRfREVCVUdfTEVWRUwsICYoc2Vzc2lvbi0+Y29uZi0+ZGVidWcpKTsKMjM4Yzcx
NCw3MjMKPCAJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRvIHNl
dCBMREFQX09QVF9ERUJVR19MRVZFTCAleC4iLCBteW5hbWUsIGNvbmYtPmRlYnVnKTsKLS0tCj4g
CQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVuYWJsZSB0byBzZXQgTERBUF9P
UFRfREVCVUdfTEVWRUwgJXguIiwgbXluYW1lLCBzZXNzaW9uLT5jb25mLT5kZWJ1Zyk7Cj4gCX0K
PiAKPiAJaWYgKHNlc3Npb24tPmNvbmYtPnNzbCB8fCBzZXNzaW9uLT5jb25mLT5zdGFydF90bHMp
IHsKPiAJCWludCB0bHMgPSBMREFQX09QVF9YX1RMU19IQVJEOwo+IAkJcmMgPSBsZGFwX3NldF9v
cHRpb24gKHNlc3Npb24tPmxkLCBMREFQX09QVF9YX1RMUywgJnRscyk7Cj4gCQlpZiAocmMgIT0g
TERBUF9TVUNDRVNTKSB7Cj4gCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVu
YWJsZSB0byBzZXQgTERBUF9PUFRfWF9UTFNfSEFSRCAoJXMpLiIsIG15bmFtZSwgbGRhcF9lcnIy
c3RyaW5nIChyYykpOwo+IAkJCXJldHVybiBMQUtfRkFJTDsKPiAJCX0KMjQxYzcyNgo8IAlyYyA9
IGxkYXBfc2V0X29wdGlvbihsZCwgTERBUF9PUFRfTkVUV09SS19USU1FT1VULCAmKGNvbmYtPnRp
bWVvdXQpKTsKLS0tCj4gCXJjID0gbGRhcF9zZXRfb3B0aW9uKHNlc3Npb24tPmxkLCBMREFQX09Q
VF9QUk9UT0NPTF9WRVJTSU9OLCAmKHNlc3Npb24tPmNvbmYtPnZlcnNpb24pKTsKMjQzYzcyOCw3
MjkKPCAJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIiVzOiBVbmFibGUgdG8gc2V0IExE
QVBfT1BUX05FVFdPUktfVElNRU9VVCAlZC4lZC4iLCBteW5hbWUsIGNvbmYtPnRpbWVvdXQudHZf
c2VjLCBjb25mLT50aW1lb3V0LnR2X3VzZWMpOwotLS0KPiAJCXN5c2xvZyhMT0dfV0FSTklOR3xM
T0dfQVVUSCwgIiVzOiBVbmFibGUgdG8gc2V0IExEQVBfT1BUX1BST1RPQ09MX1ZFUlNJT04gJWQu
IiwgbXluYW1lLCBzZXNzaW9uLT5jb25mLT52ZXJzaW9uKTsKPiAJCXNlc3Npb24tPmNvbmYtPnZl
cnNpb24gPSBMREFQX1ZFUlNJT04yOwoyNDYsMjQ5YzczMiw3MzQKPCAJaWYgKGNvbmYtPnRpbWVs
aW1pdCkgewo8IAkJbGRhcF9zZXRfb3B0aW9uKGxkLCBMREFQX09QVF9USU1FTElNSVQsICYoY29u
Zi0+dGltZWxpbWl0KSk7CjwgCQlpZiAocmMgIT0gTERBUF9PUFRfU1VDQ0VTUykKPCAJCQlzeXNs
b2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRvIHNldCBMREFQX09QVF9USU1F
TElNSVQgJWQuIiwgbXluYW1lLCBjb25mLT50aW1lbGltaXQpOwotLS0KPiAJcmMgPSBsZGFwX3Nl
dF9vcHRpb24oc2Vzc2lvbi0+bGQsIExEQVBfT1BUX05FVFdPUktfVElNRU9VVCwgJihzZXNzaW9u
LT5jb25mLT50aW1lb3V0KSk7Cj4gCWlmIChyYyAhPSBMREFQX09QVF9TVUNDRVNTKSB7Cj4gCQlz
eXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRvIHNldCBMREFQX09QVF9O
RVRXT1JLX1RJTUVPVVQgJWQuJWQuIiwgbXluYW1lLCBzZXNzaW9uLT5jb25mLT50aW1lb3V0LnR2
X3NlYywgc2Vzc2lvbi0+Y29uZi0+dGltZW91dC50dl91c2VjKTsKMjUyLDI1NWM3MzcsNzM5Cjwg
CWlmIChjb25mLT5kZXJlZikgewo8IAkJcmMgPSBsZGFwX3NldF9vcHRpb24obGQsIExEQVBfT1BU
X0RFUkVGLCAmKGNvbmYtPmRlcmVmKSk7CjwgCQlpZiAocmMgIT0gTERBUF9PUFRfU1VDQ0VTUykK
PCAJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRvIHNldCBMREFQ
X09QVF9ERVJFRiAlZC4iLCBteW5hbWUsIGNvbmYtPmRlcmVmKTsKLS0tCj4gCWxkYXBfc2V0X29w
dGlvbihzZXNzaW9uLT5sZCwgTERBUF9PUFRfVElNRUxJTUlULCAmKHNlc3Npb24tPmNvbmYtPnRp
bWVsaW1pdCkpOwo+IAlpZiAocmMgIT0gTERBUF9PUFRfU1VDQ0VTUykgewo+IAkJc3lzbG9nKExP
R19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVuYWJsZSB0byBzZXQgTERBUF9PUFRfVElNRUxJTUlU
ICVkLiIsIG15bmFtZSwgc2Vzc2lvbi0+Y29uZi0+dGltZWxpbWl0KTsKMjU4LDI2MWM3NDIsNzQ0
CjwgCWlmIChjb25mLT5yZWZlcnJhbHMpIHsKPCAJCXJjID0gbGRhcF9zZXRfb3B0aW9uKGxkLCBM
REFQX09QVF9SRUZFUlJBTFMsIExEQVBfT1BUX09OKTsKPCAJCWlmIChyYyAhPSBMREFQX09QVF9T
VUNDRVNTKQo8IAkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIiVzOiBVbmFibGUgdG8g
c2V0IExEQVBfT1BUX1JFRkVSUkFMUy4iLCBteW5hbWUpOwotLS0KPiAJcmMgPSBsZGFwX3NldF9v
cHRpb24oc2Vzc2lvbi0+bGQsIExEQVBfT1BUX0RFUkVGLCAmKHNlc3Npb24tPmNvbmYtPmRlcmVm
KSk7Cj4gCWlmIChyYyAhPSBMREFQX09QVF9TVUNDRVNTKSB7Cj4gCQlzeXNsb2coTE9HX1dBUk5J
Tkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRvIHNldCBMREFQX09QVF9ERVJFRiAlZC4iLCBteW5h
bWUsIHNlc3Npb24tPmNvbmYtPmRlcmVmKTsKMjY0LDI2N2M3NDcsNzQ5CjwgCWlmIChjb25mLT5z
aXplbGltaXQpIHsKPCAJCXJjID0gbGRhcF9zZXRfb3B0aW9uKGxkLCBMREFQX09QVF9TSVpFTElN
SVQsICYoY29uZi0+c2l6ZWxpbWl0KSk7CjwgCQlpZiAocmMgIT0gTERBUF9PUFRfU1VDQ0VTUykK
PCAJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRvIHNldCBMREFQ
X09QVF9TSVpFTElNSVQgJWQuIiwgbXluYW1lLCBjb25mLT5zaXplbGltaXQpOwotLS0KPiAJcmMg
PSBsZGFwX3NldF9vcHRpb24oc2Vzc2lvbi0+bGQsIExEQVBfT1BUX1JFRkVSUkFMUywgc2Vzc2lv
bi0+Y29uZi0+cmVmZXJyYWxzID8gTERBUF9PUFRfT04gOiBMREFQX09QVF9PRkYpOwo+IAlpZiAo
cmMgIT0gTERBUF9PUFRfU1VDQ0VTUykgewo+IAkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRI
LCAiJXM6IFVuYWJsZSB0byBzZXQgTERBUF9PUFRfUkVGRVJSQUxTLiIsIG15bmFtZSk7CjI3MCwy
NzhjNzUyLDc1OAo8IAkvKgo8IAkqIEJpbmQgdG8gdGhlIHNlcnZlcgo8IAkqLwo8IAlyYyA9IGxk
YXBfYmluZF9zKGxkLCBjb25mLT5iaW5kX2RuLCBjb25mLT5iaW5kX3B3LCBMREFQX0FVVEhfU0lN
UExFKTsKPCAJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewo8IAkJc3lzbG9nKExPR19XQVJOSU5H
fExPR19BVVRILCAiJXM6IFVuYWJsZSB0byBiaW5kIHRvIHNlcnZlciAlcyBhcyAlczogJWQgKCVz
KSIsIG15bmFtZSwKPCAJCWNvbmYtPnNlcnZlcnMsIGNvbmYtPmJpbmRfZG4sIHJjLCBsZGFwX2Vy
cjJzdHJpbmcocmMpKTsKPCAJCWxkYXBfdW5iaW5kX3MobGQpOwo8IAkJcmV0dXJuIExBS19GQUlM
OwotLS0KPiAJcmMgPSBsZGFwX3NldF9vcHRpb24oc2Vzc2lvbi0+bGQsIExEQVBfT1BUX1NJWkVM
SU1JVCwgJihzZXNzaW9uLT5jb25mLT5zaXplbGltaXQpKTsKPiAJaWYgKHJjICE9IExEQVBfT1BU
X1NVQ0NFU1MpCj4gCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRv
IHNldCBMREFQX09QVF9TSVpFTElNSVQgJWQuIiwgbXluYW1lLCBzZXNzaW9uLT5jb25mLT5zaXpl
bGltaXQpOwo+IAo+IAlyYyA9IGxkYXBfc2V0X29wdGlvbihzZXNzaW9uLT5sZCwgTERBUF9PUFRf
UkVTVEFSVCwgc2Vzc2lvbi0+Y29uZi0+cmVzdGFydCA/IExEQVBfT1BUX09OIDogTERBUF9PUFRf
T0ZGKTsKPiAJaWYgKHJjICE9IExEQVBfT1BUX1NVQ0NFU1MpIHsKPiAJCXN5c2xvZyhMT0dfV0FS
TklOR3xMT0dfQVVUSCwgIiVzOiBVbmFibGUgdG8gc2V0IExEQVBfT1BUX1JFU1RBUlQuIiwgbXlu
YW1lKTsKMjg0LDI4NmM3NjQsNzY2CjwgCWlmIChjb25mLT5jYWNoZV9leHBpcnkpIHsKPCAJCWlm
IChjb25mLT52ZXJib3NlKQo8IAkJCXN5c2xvZyhMT0dfSU5GT3xMT0dfQVVUSCwgIiVzOiBFbmFi
bGluZyAlbGQtYnl0ZSBjYWNoZSB3aXRoICVsZC1zZWNvbmQgZXhwaXJ5IiwgbXluYW1lLCBjb25m
LT5jYWNoZV9zaXplLCBjb25mLT5jYWNoZV9leHBpcnkpOwotLS0KPiAJaWYgKHNlc3Npb24tPmNv
bmYtPmNhY2hlX2V4cGlyeSkgewo+IAkJaWYgKHNlc3Npb24tPmNvbmYtPnZlcmJvc2UpCj4gCQkJ
c3lzbG9nKExPR19JTkZPfExPR19BVVRILCAiJXM6IEVuYWJsaW5nICVsZC1ieXRlIGNhY2hlIHdp
dGggJWxkLXNlY29uZCBleHBpcnkiLCBteW5hbWUsIHNlc3Npb24tPmNvbmYtPmNhY2hlX3NpemUs
IHNlc3Npb24tPmNvbmYtPmNhY2hlX2V4cGlyeSk7CjI4OGM3NjgKPCAJCXJjID0gbGRhcF9lbmFi
bGVfY2FjaGUobGQsIGNvbmYtPmNhY2hlX2V4cGlyeSwgY29uZi0+Y2FjaGVfc2l6ZSk7Ci0tLQo+
IAkJcmMgPSBsZGFwX2VuYWJsZV9jYWNoZShzZXNzaW9uLT5sZCwgc2Vzc2lvbi0+Y29uZi0+Y2Fj
aGVfZXhwaXJ5LCBzZXNzaW9uLT5jb25mLT5jYWNoZV9zaXplKTsKMjkxLDI5M2Q3NzAKPCAJCX0g
ZWxzZSB7CjwgCQlpZiAoY29uZi0+dmVyYm9zZSkKPCAJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9H
X0FVVEgsICIlczogQ2FjaGluZyBlbmFibGVkIiwgbXluYW1lKTsKMjk3ZDc3Mwo8IAkqcmVzID0g
bGQ7CjMwMSwzMDRjNzc3LDg2Nwo8IC8qIAo8ICAqIGxha19zZWFyY2ggLSAKPCAgKi8KPCBzdGF0
aWMgaW50IGxha19zZWFyY2goTEFLICpjb25mLCBMQUtfQ09OTiAqY29ubiwgY2hhciAqZmlsdGVy
LCBjaGFyICoqYXR0cnMsIExEQVBNZXNzYWdlICoqcmVzKQotLS0KPiAKPiBzdGF0aWMgaW50IGxh
a19yZW9wZW5fc2Vzc2lvbihMQUtfU0VTU0lPTiAqc2Vzc2lvbikKPiB7Cj4gCj4gCS8qIEZZSTog
VjMgbGV0cyB1cyBhdm9pZCBmaXZlIHVubmVlZGVkIGJpbmRzIGluIGEgcGFzc3dvcmQgY2hhbmdl
ICovCj4gCWlmIChzZXNzaW9uLT5jb25mLT52ZXJzaW9uID09IExEQVBfVkVSU0lPTjIpIHsKPiAJ
CWlmIChzZXNzaW9uLT5sZCAhPSBOVUxMKSB7Cj4gCQkJaWYgKHNlc3Npb24tPmNvbmYtPmNhY2hl
X2V4cGlyeSkKPiAJCQkJbGRhcF9kZXN0cm95X2NhY2hlKHNlc3Npb24tPmxkKTsKPiAJCQlsZGFw
X3VuYmluZF9zKHNlc3Npb24tPmxkKTsKPiAKPiAJCQlzZXNzaW9uLT5sZCA9IE5VTEw7Cj4gCQl9
Cj4gCQlpZiAoc2Vzc2lvbi0+dXNlciAhPSBOVUxMKSB7Cj4gCQkJc2Vzc2lvbi0+dXNlci0+Ym91
bmRfYXNfdXNlciA9IDA7Cj4gCQl9Cj4gCQlyZXR1cm4gbGFrX29wZW5fc2Vzc2lvbihzZXNzaW9u
KTsKPiAJfQo+IAo+IAlyZXR1cm4gTEFLX09LOwo+IH0KPiAKPiAKPiBzdGF0aWMgaW50IGxha19j
b25uZWN0X2Fub255bW91c2x5KExBS19TRVNTSU9OICpzZXNzaW9uKQo+IHsKPiAJY2hhciAgICpt
eW5hbWUgPSAibGFrX2Nvbm5lY3RfYW5vbnltb3VzbHkiOwo+IAo+IAlpbnQgcmM7Cj4gCj4gCWlm
IChzZXNzaW9uLT5jb25mLT52ZXJib3NlKQo+IAkJc3lzbG9nKExPR19JTkZPfExPR19BVVRILCAi
JXM6IENvbm5lY3RpbmcgYW5vbnltb3VzbHkgdG8gJXMiLCBteW5hbWUsIHNlc3Npb24tPmNvbmYt
PnNlcnZlcnMpOwo+IAo+IAlpZiAoc2Vzc2lvbi0+bGQgPT0gTlVMTCkgewo+IAkJcmMgPSBsYWtf
b3Blbl9zZXNzaW9uIChzZXNzaW9uKTsKPiAJCWlmIChyYyAhPSBMQUtfT0spCj4gCQkJcmV0dXJu
IHJjOwo+IAl9Cj4gCj4gCXJjID0gbGRhcF9zaW1wbGVfYmluZF9zKHNlc3Npb24tPmxkLCBzZXNz
aW9uLT5jb25mLT5iaW5kX2RuLCBzZXNzaW9uLT5jb25mLT5iaW5kX3B3KTsKPiAJaWYgKHJjICE9
IExEQVBfU1VDQ0VTUykgewo+IAkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVu
YWJsZSB0byBiaW5kIGFzICVzIHRvICVzOiAlZCAoJXMpIiwgbXluYW1lLCBzZXNzaW9uLT5jb25m
LT5iaW5kX2RuLCBzZXNzaW9uLT5jb25mLT5zZXJ2ZXJzLCByYywgbGRhcF9lcnIyc3RyaW5nKHJj
KSk7Cj4gCQlyZXR1cm4gTEFLX0ZBSUw7Cj4gCX0KPiAKPiAJaWYgKHNlc3Npb24tPnVzZXIgIT0g
TlVMTCkgewo+IAkJc2Vzc2lvbi0+dXNlci0+Ym91bmRfYXNfdXNlciA9IDA7Cj4gCX0KPiAKPiAJ
cmV0dXJuIExBS19PSzsKPiB9Cj4gCj4gCj4gc3RhdGljIGludCBsYWtfY29ubmVjdF9hc191c2Vy
KExBS19TRVNTSU9OICpzZXNzaW9uLCBjb25zdCBjaGFyICpwYXNzd29yZCkKPiB7Cj4gCWNoYXIg
ICAqbXluYW1lID0gImxha19jb25uZWN0X2FzX3VzZXIiOwo+IAo+IAlpbnQgcmM7Cj4gCj4gCWlm
IChzZXNzaW9uLT5jb25mLT52ZXJib3NlKQo+IAkJc3lzbG9nKExPR19JTkZPfExPR19BVVRILCAi
JXM6IENvbm5lY3RpbmcgYXMgJXMgdG8gJXMiLCBteW5hbWUsIHNlc3Npb24tPnVzZXItPmRuLCBz
ZXNzaW9uLT5jb25mLT5zZXJ2ZXJzKTsKPiAKPiAJLyogdGhpcyBzaG91bGRuJ3QgZXZlciBoYXBw
ZW4gKi8KPiAJaWYgKHNlc3Npb24tPnVzZXIgPT0gTlVMTCkgewo+IAkJcmV0dXJuIExBS19GQUlM
Owo+IAl9Cj4gCj4gCS8qIGF2b2lkIGJpbmRpbmcgYW5vbnltb3VzbHkgd2l0aCBhIEROIGJ1dCBu
byBwYXNzd29yZCAqLwo+IAlpZiAocGFzc3dvcmQgPT0gTlVMTCB8fCBwYXNzd29yZFswXSA9PSAn
XDAnKSB7Cj4gCQlyZXR1cm4gTEFLX0ZBSUw7Cj4gCX0KPiAKPiAJaWYgKHNlc3Npb24tPmxkID09
IE5VTEwpIHsKPiAJCXJjID0gbGFrX29wZW5fc2Vzc2lvbiAoc2Vzc2lvbik7Cj4gCQlpZiAocmMg
IT0gTEFLX09LKQo+IAkJCXJldHVybiByYzsKPiAJfQo+IAo+IAlyYyA9IGxkYXBfc2ltcGxlX2Jp
bmRfcyhzZXNzaW9uLT5sZCwgc2Vzc2lvbi0+dXNlci0+ZG4sIHBhc3N3b3JkKTsKPiAJaWYgKHJj
ICE9IExEQVBfU1VDQ0VTUykgewo+IAkJaWYgKHNlc3Npb24tPmNvbmYtPnZlcmJvc2UpCj4gCQkJ
c3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVuYWJsZSB0byBiaW5kIHRvIHNlcnZl
ciAlcyBhcyAlczogJWQgKCVzKSIsIG15bmFtZSwgc2Vzc2lvbi0+Y29uZi0+c2VydmVycywgc2Vz
c2lvbi0+dXNlci0+ZG4sIHJjLCBsZGFwX2VycjJzdHJpbmcocmMpKTsKPiAJCXJldHVybiBMQUtf
RkFJTDsKPiAJfQo+IAo+IAlzZXNzaW9uLT51c2VyLT5ib3VuZF9hc191c2VyID0gMTsKPiAKPiAJ
cmV0dXJuIExBS19PSzsKPiB9Cj4gCj4gCj4gc3RhdGljIGludCBsYWtfc2VhcmNoKExBS19TRVNT
SU9OICpzZXNzaW9uLCBjb25zdCBjaGFyICpmaWx0ZXIsIGNvbnN0IGNoYXIgKiphdHRycywgTERB
UE1lc3NhZ2UgKipyZXMpCjMxNGM4NzcKPCAJaWYgKCFjb25uLT5ib3VuZCkgewotLS0KPiAJaWYg
KCFzZXNzaW9uLT5ib3VuZCkgewozMTcsMzE4Yzg4MCw4ODEKPCAJCWlmIChjb25uLT5sZCkgewo8
IAkJCWlmIChjb25mLT52ZXJib3NlKQotLS0KPiAJCWlmIChzZXNzaW9uLT5sZCkgewo+IAkJCWlm
IChzZXNzaW9uLT5jb25mLT52ZXJib3NlKQozMjAsMzIxYzg4Myw4ODYKPCAJCQlpZiAoY29uZi0+
Y2FjaGVfZXhwaXJ5KQo8IAkJCQlsZGFwX2Rlc3Ryb3lfY2FjaGUoY29ubi0+bGQpOwotLS0KPiAJ
CQlpZiAoc2Vzc2lvbi0+Y29uZi0+Y2FjaGVfZXhwaXJ5KQo+IAkJCQlsZGFwX2Rlc3Ryb3lfY2Fj
aGUoc2Vzc2lvbi0+bGQpOwo+IAkJCQkKPiAJCQlsZGFwX3VuYmluZF9zKHNlc3Npb24tPmxkKTsK
MzIzLDMyNGM4ODgKPCAJCQlsZGFwX3VuYmluZF9zKGNvbm4tPmxkKTsKPCAJCQljb25uLT5sZCA9
IE5VTEw7Ci0tLQo+IAkJCXNlc3Npb24tPmxkID0gTlVMTDsKMzI3Yzg5MQo8IAkJcmMgPSBsYWtf
Y29ubmVjdChjb25mLCAmKGNvbm4tPmxkKSk7Ci0tLQo+IAkJcmMgPSBsYWtfY29ubmVjdF9hbm9u
eW1vdXNseShzZXNzaW9uKTsKMzMzYzg5Nwo8IAkJY29ubi0+Ym91bmQgPSAxOwotLS0KPiAJCXNl
c3Npb24tPmJvdW5kID0gMTsKMzM5LDM0MGM5MDMKPCAJcmMgPSBsZGFwX3NlYXJjaF9zdChjb25u
LT5sZCwgY29uZi0+c2VhcmNoX2Jhc2UsIGNvbmYtPnNjb3BlLCBmaWx0ZXIsCjwgCSAgICAgICAg
ICAgICAgICAgICAgKGNoYXIgKiopIGF0dHJzLCAwLCAmKGNvbmYtPnRpbWVvdXQpLCByZXMpOwot
LS0KPiAJcmMgPSBsZGFwX3NlYXJjaF9zdChzZXNzaW9uLT5sZCwgc2Vzc2lvbi0+Y29uZi0+c2Vh
cmNoX2Jhc2UsIHNlc3Npb24tPmNvbmYtPnNjb3BlLCBmaWx0ZXIsIChjaGFyICoqKSBhdHRycywg
MCwgJihzZXNzaW9uLT5jb25mLT50aW1lb3V0KSwgcmVzKTsKMzQyYTkwNgo+IAkJY2FzZSBMREFQ
X1NJWkVMSU1JVF9FWENFRURFRDoKMzQ4YzkxMgo8IAkJCWNvbm4tPmJvdW5kID0gMDsKLS0tCj4g
CQkJc2Vzc2lvbi0+Ym91bmQgPSAwOwozNTJjOTE2CjwgCWlmICgobGRhcF9jb3VudF9lbnRyaWVz
KGNvbm4tPmxkLCAqcmVzKSkgIT0gMSkgewotLS0KPiAJaWYgKChsZGFwX2NvdW50X2VudHJpZXMo
c2Vzc2lvbi0+bGQsICpyZXMpKSAhPSAxKSB7CjM2MGE5MjUsOTk4Cj4gCj4gc3RhdGljIHZvaWQg
bGFrX3JlbGVhc2VfdXNlcihMQUtfVVNFUiAqKnB1c2VyKQo+IHsKPiAJTEFLX1VTRVIgKnVzZXI7
Cj4gCj4gCXVzZXIgPSAqcHVzZXI7Cj4gCj4gCWlmICh1c2VyID09IE5VTEwpIHsKPiAJCXJldHVy
bjsKPiAJfQo+IAo+IAlpZiAodXNlci0+bmFtZSAhPSBOVUxMKSB7Cj4gCQlmcmVlICh1c2VyLT5u
YW1lKTsKPiAJfQo+IAo+IAlpZiAodXNlci0+cmVhbG0gIT0gTlVMTCkgewo+IAkJZnJlZSAodXNl
ci0+cmVhbG0pOwo+IAl9Cj4gCj4gCWlmICh1c2VyLT5kbiAhPSBOVUxMKSB7Cj4gCQlsZGFwX21l
bWZyZWUodXNlci0+ZG4pOwo+IAl9Cj4gCj4gCWZyZWUgKHVzZXIpOwo+IAkqcHVzZXIgPSBOVUxM
Owo+IAo+IAlyZXR1cm47Cj4gfQo+IAo+IAo+IHN0YXRpYyB2b2lkIGxha19yZWxlYXNlX2NvbmZp
ZyhMQUtfQ09ORiAqKnBjb25mKSAKPiB7Cj4gCUxBS19DT05GICpjb25mOwo+IAo+IAljb25mID0g
KnBjb25mOwo+IAo+IAlpZiAoY29uZiA9PSBOVUxMKSB7Cj4gCQlyZXR1cm47Cj4gCX0KPiAKPiAJ
aWYgKGNvbmYtPnBhdGggIT0gTlVMTCkgewo+IAkJZnJlZShjb25mLT5wYXRoKTsKPiAJfQo+IAo+
ICNpZiAwCj4gCWlmIChjb25mLT5zZXJ2ZXJzICE9IE5VTEwpIHsKPiAJCWZyZWUoY29uZi0+c2Vy
dmVycyk7Cj4gCX0KPiAJCj4gCWlmIChjb25mLT5iaW5kX2RuICE9IE5VTEwpIHsKPiAJCWZyZWUo
Y29uZi0+YmluZF9kbik7Cj4gCX0KPiAKPiAJaWYgKGNvbmYtPmJpbmRfcHcgIT0gTlVMTCkgewo+
IAkJZnJlZShjb25mLT5iaW5kX3B3KTsKPiAJfQo+IAo+IAlpZiAoY29uZi0+c2VhcmNoX2Jhc2Ug
IT0gTlVMTCkgewo+IAkJZnJlZShjb25mLT5zZWFyY2hfYmFzZSk7Cj4gCX0KPiAKPiAJaWYgKGNv
bmYtPmZpbHRlciAhPSBOVUxMKSB7Cj4gCQlmcmVlKGNvbmYtPmZpbHRlcik7Cj4gCX0KPiAjZW5k
aWYKPiAJZnJlZShjb25maWdsaXN0KTsKPiAKPiAJZnJlZSAoY29uZik7Cj4gCSpwY29uZiA9IE5V
TEw7Cj4gCj4gCXJldHVybjsKPiB9Cj4gCj4gCjM2MmMxMDAwCjwgICogbGFrX2xvb2t1cCAtIHJl
dHJpZXZlIHVzZXJAcmVhbG0gdmFsdWVzIHNwZWNpZmllZCBieSAnYXR0cnMnCi0tLQo+ICAqIGxh
a19yZXRyaWV2ZSAtIHJldHJpZXZlIHVzZXJAcmVhbG0gdmFsdWVzIHNwZWNpZmllZCBieSAnYXR0
cnMnCjM2NGMxMDAyCjwgaW50IGxha19sb29rdXAoTEFLICpjb25mLCBjaGFyICp1c2VyLCBjaGFy
ICpyZWFsbSwgY2hhciAqKmF0dHJzLCBMQUtfUkVTVUxUICoqcmVzKQotLS0KPiBzdGF0aWMgaW50
IGxha19yZXRyaWV2ZShMQUtfU0VTU0lPTiAqc2Vzc2lvbiwgY29uc3QgY2hhciAqdXNlciwgY29u
c3QgY2hhciAqcmVhbG0sIGNvbnN0IGNoYXIgKiphdHRycywgTEFLICoqcmVzdWx0KQozNjZjMTAw
NAo8IAljaGFyICAgKm15bmFtZSA9ICJsYWtfbG9va3VwIjsKLS0tCj4gCWNoYXIgICAqbXluYW1l
ID0gImxha19yZXRyaWV2ZSI7CjM3MCwzNzFjMTAwOCwxMDA5CjwgCUxBS19SRVNVTFQgKnB0ciA9
IE5VTEwsICp0ZW1wID0gTlVMTDsKPCAJTERBUE1lc3NhZ2UgKm1zZzsKLS0tCj4gCUxBSyAqcHRy
ID0gTlVMTCwgKnRlbXAgPSBOVUxMOwo+IAlMREFQTWVzc2FnZSAqcmVzOwozNzRjMTAxMgo8IAlj
aGFyICphdHRyLCAqKnZhbHM7Ci0tLQo+IAljaGFyICphdHRyLCAqdmFsOwozNzZjMTAxNAo8ICAg
ICAJKnJlcyA9IE5VTEw7Ci0tLQo+ICAgICAJKnJlc3VsdCA9IE5VTEw7CjM3OCwzODdjMTAxNiwx
MDE3CjwgCWlmIChjb25uID09IE5VTEwpIHsKPCAJCXJjID0gbGFrX2dldF9jb25uKCZjb25uKTsK
PCAJCWlmIChyYyAhPSBMQUtfT0spIHsKPCAJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgs
ICIlczogbGFrX2dldF9jb25uIGZhaWxlZC4iLCBteW5hbWUpOwo8IAkJCXJldHVybiBMQUtfRkFJ
TDsKPCAJCX0KPCAJfQo8IAo8IAlmaWx0ZXIgPSBsYWtfZmlsdGVyKGNvbmYsIHVzZXIsIHJlYWxt
KTsKPCAJaWYgKGZpbHRlciA9PSBOVUxMKSB7Ci0tLQo+IAlyYyA9IGxha19maWx0ZXIoc2Vzc2lv
biwgdXNlciwgcmVhbG0sICZmaWx0ZXIpOwo+IAlpZiAocmMgIT0gTEFLX09LKSB7CjM5MmMxMDIy
CjwgCXJjID0gbGFrX3NlYXJjaChjb25mLCBjb25uLCBmaWx0ZXIsIGF0dHJzLCAmbXNnKTsKLS0t
Cj4gCXJjID0gbGFrX3NlYXJjaChzZXNzaW9uLCBmaWx0ZXIsIGF0dHJzLCAmcmVzKTsKMzk5YzEw
MjkKPCAJZW50cnkgPSBsZGFwX2ZpcnN0X2VudHJ5KGNvbm4tPmxkLCBtc2cpOyAKLS0tCj4gCWVu
dHJ5ID0gbGRhcF9maXJzdF9lbnRyeShzZXNzaW9uLT5sZCwgcmVzKTsgCjQwM2MxMDMzCjwgCQls
ZGFwX21zZ2ZyZWUobXNnKTsKLS0tCj4gCQlsZGFwX21zZ2ZyZWUocmVzKTsKNDA3YzEwMzcKPCAJ
YXR0ciA9IGxkYXBfZmlyc3RfYXR0cmlidXRlKGNvbm4tPmxkLCBlbnRyeSwgJmJlcik7Ci0tLQo+
IAlhdHRyID0gbGRhcF9maXJzdF9hdHRyaWJ1dGUoc2Vzc2lvbi0+bGQsIGVudHJ5LCAmYmVyKTsK
NDExYzEwNDEKPCAJCWxkYXBfbXNnZnJlZShtc2cpOwotLS0KPiAJCWxkYXBfbXNnZnJlZShyZXMp
Owo0MTcsNDIxYzEwNDcsMTA3Ngo8IAkJdmFscyA9IGxkYXBfZ2V0X3ZhbHVlcyhjb25uLT5sZCwg
ZW50cnksIGF0dHIpOwo8IAkJaWYgKHZhbHMgPT0gTlVMTCkgewo8IAkJCXN5c2xvZyhMT0dfV0FS
TklOR3xMT0dfQVVUSCwgIiVzOiBFbnRyeSBkb2Vzbid0IGhhdmUgYW55IHZhbHVlcyBmb3IgJXMi
LCBteW5hbWUsIGF0dHIpOwo8IAkJCWNvbnRpbnVlOwo8IAkJfQotLS0KPiAJCXJjID0gbGFrX2dl
dF9zdHJpbmdfdmFsdWUoc2Vzc2lvbi0+bGQsIGVudHJ5LCBhdHRyLCAmdmFsKTsKPiAJCWlmIChy
YyA9PSBMQUtfT0spIHsKPiAJCQl0ZW1wID0gKExBSyAqKSBtYWxsb2Moc2l6ZW9mKExBSykpOwo+
IAkJCWlmICh0ZW1wID09IE5VTEwpIHsKPiAJCQkJc3lzbG9nKExPR19FUlJ8TE9HX0FVVEgsICIl
czogQ2Fubm90IGFsbG9jYXRlIG1lbW9yeSIsIG15bmFtZSk7Cj4gCQkJCWxkYXBfbWVtZnJlZShh
dHRyKTsKPiAJCQkJbGFrX2ZyZWVfcmVzdWx0KCpyZXN1bHQpOwo+IAkJCQlyYyA9IExBS19GQUlM
Owo+IAkJCQlnb3RvIGRvbmU7Cj4gCQkJfQo+IAo+IAkJCWlmICgqcmVzdWx0ID09IE5VTEwpIHsK
PiAJCQkJKnJlc3VsdCA9IHRlbXA7Cj4gCQkJCXB0ciA9ICpyZXN1bHQ7Cj4gCQkJfQo+IAkJCWVs
c2Ugewo+IAkJCQlwdHItPm5leHQgPSB0ZW1wOwo+IAkJCQlwdHIgPSB0ZW1wOwo+IAkJCX0KPiAJ
CQlwdHItPmF0dHJpYnV0ZSA9IChjaGFyICopc3RyZHVwKGF0dHIpOwo+IAkJCWlmIChwdHItPmF0
dHJpYnV0ZSA9PSBOVUxMKSB7Cj4gCQkJCXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAiJXM6IHN0
cmR1cCgpIGZhaWxlZCIsIG15bmFtZSk7Cj4gCQkJCWxkYXBfbWVtZnJlZShhdHRyKTsKPiAJCQkJ
bGFrX2ZyZWVfcmVzdWx0KCpyZXN1bHQpOwo+IAkJCQlyYyA9IExBS19GQUlMOwo+IAkJCQlnb3Rv
IGRvbmU7Cj4gCQkJfQo+IAkJCXB0ci0+dmFsdWUgPSB2YWw7Cj4gCQkJcHRyLT5sZW4gPSBzdHJs
ZW4ocHRyLT52YWx1ZSk7Cj4gCQkJcHRyLT5uZXh0ID0gTlVMTDsKNDIzLDQzMGMxMDc4LDEwODEK
PCAJCXRlbXAgPSAoTEFLX1JFU1VMVCAqKSBtYWxsb2Moc2l6ZW9mKExBS19SRVNVTFQpKTsKPCAJ
CWlmICgqcmVzID09IE5VTEwpIHsKPCAJCQkqcmVzID0gdGVtcDsKPCAJCQlwdHIgPSAqcmVzOwo8
IAkJfQo8IAkJZWxzZSB7CjwgCQkJcHRyLT5uZXh0ID0gdGVtcDsKPCAJCQlwdHIgPSB0ZW1wOwot
LS0KPiAJCQlpZiAoc2Vzc2lvbi0+Y29uZi0+dmVyYm9zZSkKPiAJCQkJc3lzbG9nKExPR19JTkZP
fExPR19BVVRILCAiJXM6IEF0dHJpYnV0ZSAlcywgVmFsdWUgJXMiLCBteW5hbWUsIHB0ci0+YXR0
cmlidXRlLCBwdHItPnZhbHVlKTsKPiAJCX0gZWxzZSB7Cj4gCQkJc3lzbG9nKExPR19XQVJOSU5H
fExPR19BVVRILCAiJXM6IEVudHJ5ICVzIGhhcyBubyB2YWx1ZS4iLCBteW5hbWUsIGF0dHIpOwo0
MzIsNDM4ZDEwODIKPCAJCXB0ci0+YXR0cmlidXRlID0gKGNoYXIgKilzdHJkdXAoYXR0cik7Cjwg
CQlwdHItPnZhbHVlID0gKGNoYXIgKilzdHJkdXAodmFsc1swXSk7IC8qIEdldCBvbmx5IGZpcnN0
IGF0dHJpYnV0ZSAqLwo8IAkJcHRyLT5sZW4gPSBzdHJsZW4ocHRyLT52YWx1ZSk7CjwgCQlwdHIt
Pm5leHQgPSBOVUxMOwo8IAo8IAkJaWYgKGNvbmYtPnZlcmJvc2UpCjwgCQkJc3lzbG9nKExPR19J
TkZPfExPR19BVVRILCAiJXM6IEF0dHJpYnV0ZSAlcywgVmFsdWUgJXMiLCBteW5hbWUsIHB0ci0+
YXR0cmlidXRlLCBwdHItPnZhbHVlKTsKNDQwZDEwODMKPCAJCWxkYXBfdmFsdWVfZnJlZSh2YWxz
KTsKNDQzYzEwODYKPCAJCWF0dHIgPSBsZGFwX25leHRfYXR0cmlidXRlKGNvbm4tPmxkLCBlbnRy
eSwgYmVyKTsKLS0tCj4gCQlhdHRyID0gbGRhcF9uZXh0X2F0dHJpYnV0ZShzZXNzaW9uLT5sZCwg
ZW50cnksIGJlcik7CjQ0NGExMDg4Cj4gCXJjID0gTEFLX09LOwo0NDVhMTA5MAo+IGRvbmU6CjQ0
OGMxMDkzCjwgCWxkYXBfbXNnZnJlZShtc2cpOwotLS0KPiAJbGRhcF9tc2dmcmVlKHJlcyk7CjQ1
MWMxMDk2CjwgCWlmICgqcmVzID09IE5VTEwpCi0tLQo+IAlpZiAoKnJlc3VsdCA9PSBOVUxMKQo0
NTMsNDU1YzEwOTgsMTA5OQo8IAllbHNlCjwgCQlyZXR1cm4gTEFLX09LOwo8IAkJCi0tLQo+IAo+
IAlyZXR1cm4gcmM7CjQ1OGMxMTAyLDExMDMKPCBpbnQgbGFrX2F1dGhlbnRpY2F0ZShMQUsgKmNv
bmYsIGNoYXIgKnVzZXIsIGNoYXIqIHJlYWxtLCBjaGFyICpwYXNzd29yZCkgCi0tLQo+IAo+IHN0
YXRpYyBpbnQgbGFrX2JpbmRfYXV0aGVudGljYXRlKExBS19TRVNTSU9OICpzZXNzaW9uLCBjb25z
dCBjaGFyICp1c2VyLCBjb25zdCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqcGFzc3dvcmQpIAo0
NjBjMTEwNSwxMTI5CjwgCWNoYXIgICAqbXluYW1lID0gImxha19hdXRoZW50aWNhdGUiOwotLS0K
PiAJaW50IHJjID0gTEFLX09LOwo+IAo+IAlpZiAoc2Vzc2lvbi0+dXNlciA9PSBOVUxMKSB7Cj4g
CQlyYyA9IGxha19nZXRfdXNlcihzZXNzaW9uLCB1c2VyLCByZWFsbSk7Cj4gCQlpZiAocmMgIT0g
TEFLX09LKQo+IAkJCXJldHVybiByYzsKPiAJfQo+IAo+IAlyYyA9IGxha19yZW9wZW5fc2Vzc2lv
bihzZXNzaW9uKTsKPiAJaWYgKHJjICE9IExBS19PSykgewo+IAkJcmV0dXJuIHJjOwo+IAl9Cj4g
Cj4gCXJjID0gbGFrX2Nvbm5lY3RfYXNfdXNlcihzZXNzaW9uLCBwYXNzd29yZCk7Cj4gCWxha19y
ZWxlYXNlX3VzZXIoJnNlc3Npb24tPnVzZXIpOwo+IAlsYWtfcmVvcGVuX3Nlc3Npb24oc2Vzc2lv
bik7Cj4gCWxha19jb25uZWN0X2Fub255bW91c2x5KHNlc3Npb24pOwo+IAo+IAlyZXR1cm4gcmM7
Cj4gfQo+IAo+IAo+IHN0YXRpYyBpbnQgbGFrX2N1c3RvbV9hdXRoZW50aWNhdGUoTEFLX1NFU1NJ
T04gKnNlc3Npb24sIGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnJlYWxtLCBjb25zdCBj
aGFyICpwYXNzd29yZCkgCj4gewo+IAljaGFyICAgKm15bmFtZSA9ICJsYWtfY3VzdG9tX2F1dGhl
bnRpY2F0ZSI7CjQ2MmMxMTMxCjwgCUxBS19SRVNVTFQgKnJlczsKLS0tCj4gCUxBSyAqbHJlczsK
NDY0ZDExMzIKPCAJaW50IHJldDsKNDY2YzExMzQKPCAJY2hhciAqYXR0cnNbXSA9IHsidXNlclBh
c3N3b3JkIiwgTlVMTH07Ci0tLQo+IAljb25zdCBjaGFyICphdHRyc1tdID0geyJ1c2VyUGFzc3dv
cmQiLCBOVUxMfTsKNDY4YzExMzYKPCAJcmMgPSBsYWtfbG9va3VwKGNvbmYsIHVzZXIsIHJlYWxt
LCBhdHRycywgJnJlcyk7Ci0tLQo+IAlyYyA9IGxha19yZXRyaWV2ZShzZXNzaW9uLCB1c2VyLCBy
ZWFsbSwgYXR0cnMsICZscmVzKTsKNDcwYzExMzgKPCAJCWlmIChjb25mLT52ZXJib3NlKSB7Ci0t
LQo+IAkJaWYgKHNlc3Npb24tPmNvbmYtPnZlcmJvc2UpIHsKNDczZDExNDAKPCAJCWxha19mcmVl
KHJlcyk7CjQ3N2MxMTQ0CjwgCXJldCA9IExBS19GQUlMOwotLS0KPiAJcmMgPSBMQUtfRkFJTDsK
NDc5LDQ4MGMxMTQ2LDExNDcKPCAJcHRyID0gcmVzLT52YWx1ZTsKPCAJZW5kID0gKGNoYXIgKikg
cHRyICsgcmVzLT5sZW47Ci0tLQo+IAlwdHIgPSBscmVzLT52YWx1ZTsKPiAJZW5kID0gKGNoYXIg
KikgcHRyICsgbHJlcy0+bGVuOwo0ODdjMTE1NAo8IAkJCQlyZXQgPSBMQUtfT0s7Ci0tLQo+IAkJ
CQlyYyA9IExBS19PSzsKNDkxYzExNTgKPCAJCQkJcmV0ID0gTEFLX09LOwotLS0KPiAJCQkJcmMg
PSBMQUtfT0s7CjQ5OWMxMTY2CjwgCWxha19mcmVlKHJlcyk7Ci0tLQo+IAlsYWtfZnJlZV9yZXN1
bHQobHJlcyk7CjUwMWMxMTY4CjwgCXJldHVybihyZXQpOwotLS0KPiAJcmV0dXJuKHJjKTsKNTA0
LDUwN2MxMTcxLDExNzIKPCAvKiAKPCAgKiBsYWtfZnJlZSAtIGZyZWUgbWVtb3J5IGJ1ZmZlcnMK
PCAgKi8KPCB2b2lkIGxha19mcmVlKExBS19SRVNVTFQgKnJlc3VsdCkgCi0tLQo+IAo+IHN0YXRp
YyB2b2lkIGxha19jbG9zZV9zZXNzaW9uKExBS19TRVNTSU9OICoqcHNlc3Npb24pIAo1MDlkMTE3
Mwo8IAkvKiBjaGFyICAgKm15bmFtZSA9ICJsYWtfZnJlZSI7ICovCjUxMWMxMTc1LDExNzkKPCAJ
aWYgKHJlc3VsdCA9PSBOVUxMKQotLS0KPiAJTEFLX1NFU1NJT04gKnNlc3Npb247Cj4gCj4gCXNl
c3Npb24gPSAqcHNlc3Npb247Cj4gCj4gCWlmIChzZXNzaW9uID09IE5VTEwpIHsKNTEyYTExODEK
PiAJfQo1MTQsNTE1YzExODMsMTE4Ngo8IAlpZiAocmVzdWx0LT5uZXh0ICE9IE5VTEwpIHsKPCAJ
CWxha19mcmVlKHJlc3VsdC0+bmV4dCk7Ci0tLQo+IAlpZiAoc2Vzc2lvbi0+bGQgIT0gTlVMTCkg
ewo+IAkJaWYgKHNlc3Npb24tPmNvbmYtPmNhY2hlX2V4cGlyeSkKPiAJCQlsZGFwX2Rlc3Ryb3lf
Y2FjaGUoc2Vzc2lvbi0+bGQpOwo+IAkJbGRhcF91bmJpbmRfcyhzZXNzaW9uLT5sZCk7CjUxOCw1
MjBjMTE4OSwxMjY0CjwgCWZyZWUocmVzdWx0LT5hdHRyaWJ1dGUpOwkKPCAJZnJlZShyZXN1bHQt
PnZhbHVlKTsJCjwgCWZyZWUocmVzdWx0KTsKLS0tCj4gCWxha19yZWxlYXNlX3VzZXIoJnNlc3Np
b24tPnVzZXIpOwo+IAlsYWtfcmVsZWFzZV9jb25maWcoJnNlc3Npb24tPmNvbmYpOwo+IAo+IAlm
cmVlKHNlc3Npb24pOwo+IAkqcHNlc3Npb24gPSBOVUxMOwo+IAo+IAlyZXR1cm47Cj4gfQo+IAo+
IAo+IGludCBsYWtfYXV0aGVudGljYXRlKGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnJl
YWxtLCBjb25zdCBjaGFyICpwYXNzd29yZCwgY29uc3QgY2hhciAqY29uZmlnRmlsZSkgCj4gewo+
IAljaGFyICAgKm15bmFtZSA9ICJsYWtfYXV0aGVudGljYXRlIjsKPiAKPiAJTEFLX1NFU1NJT04g
KnNlc3Npb247Cj4gCWludCByYzsKPiAKPiAJc2Vzc2lvbiA9IHBlcnNpc3RlbnRfc2Vzc2lvbjsK
PiAKPiAJaWYgKHNlc3Npb24gPT0gTlVMTCkgewo+IAkJcmMgPSBsYWtfZ2V0X3Nlc3Npb24oJnNl
c3Npb24sIGNvbmZpZ0ZpbGUpOwo+IAkJaWYgKHJjICE9IExBS19PSykgewo+IAkJCXN5c2xvZyhM
T0dfV0FSTklOR3xMT0dfQVVUSCwgIiVzOiBsYWtfZ2V0X3Nlc3Npb24gZmFpbGVkLiIsIG15bmFt
ZSk7Cj4gCQkJcmV0dXJuIExBS19GQUlMOwo+IAkJfQo+IAkJcGVyc2lzdGVudF9zZXNzaW9uID0g
c2Vzc2lvbjsKPiAJfQo+IAo+IAlpZiAoc2Vzc2lvbi0+Y29uZi0+YXV0aF9tZXRob2QgPT0gTEFL
X0FVVEhfTUVUSE9EX0JJTkQpIHsKPiAJCXJjID0gbGFrX2JpbmRfYXV0aGVudGljYXRlKHNlc3Np
b24sIHVzZXIsIHJlYWxtLCBwYXNzd29yZCk7Cj4gCX0gZWxzZSB7Cj4gCQlyYyA9IGxha19jdXN0
b21fYXV0aGVudGljYXRlKHNlc3Npb24sIHVzZXIsIHJlYWxtLCBwYXNzd29yZCk7Cj4gCX0KPiAK
PiAJcmV0dXJuIHJjOwo+IH0KPiAKPiAKPiBpbnQgbGFrX2xvb2t1cF9hdHRyaWIoY29uc3QgY2hh
ciAqdXNlciwgY29uc3QgY2hhciAqcmVhbG0sIGNvbnN0IGNoYXIgKmNvbmZpZ0ZpbGUsIExBSyAq
KnJlc3VsdCkgCj4gewo+IAljaGFyICAgKm15bmFtZSA9ICJsYWtfbG9va3VwX2F0dHJpYiI7Cj4g
Cj4gCUxBS19TRVNTSU9OICpzZXNzaW9uOwo+IAlMQUsgKmxyZXM7Cj4gCWNoYXIgKmF0dHJzWzJd
Owo+IAlpbnQgcmM7Cj4gCj4gCXNlc3Npb24gPSBwZXJzaXN0ZW50X3Nlc3Npb247Cj4gCj4gCWlm
IChzZXNzaW9uID09IE5VTEwpIHsKPiAJCXJjID0gbGFrX2dldF9zZXNzaW9uKCZzZXNzaW9uLCBj
b25maWdGaWxlKTsKPiAJCWlmIChyYyAhPSBMQUtfT0spIHsKPiAJCQlzeXNsb2coTE9HX1dBUk5J
Tkd8TE9HX0FVVEgsICIlczogbGFrX2dldF9zZXNzaW9uIGZhaWxlZC4iLCBteW5hbWUpOwo+IAkJ
CXJldHVybiBMQUtfRkFJTDsKPiAJCX0KPiAJCXBlcnNpc3RlbnRfc2Vzc2lvbiA9IHNlc3Npb247
Cj4gCX0KPiAKPiAJaWYgKHNlc3Npb24tPmNvbmYtPmxvb2t1cF9hdHRyaWIgPT0gTlVMTCkgewo+
IAkJcmV0dXJuIExBS19GQUlMOwo+IAl9Cj4gCj4gCWF0dHJzWzBdID0gc2Vzc2lvbi0+Y29uZi0+
bG9va3VwX2F0dHJpYjsKPiAJYXR0cnNbMV0gPSBOVUxMOwo+IAo+IAlyYyA9IGxha19yZXRyaWV2
ZShzZXNzaW9uLCB1c2VyLCByZWFsbSwgKGNvbnN0IGNoYXIgKiopYXR0cnMsICZscmVzKTsKPiAJ
aWYgKHJjICE9IExBS19PSykgewo+IAkJaWYgKHNlc3Npb24tPmNvbmYtPnZlcmJvc2UpIHsKPiAJ
CQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogQXR0cmlidXRlIG5vdCBmb3VuZC4i
LCBteW5hbWUpOwo+IAkJfQo+IAkJcmV0dXJuIExBS19GQUlMOwo+IAl9Cj4gCj4gCSpyZXN1bHQg
PSBscmVzOwo+IAo+IAlyZXR1cm4gTEFLX09LOwo1MjJhMTI2Nwo+IAo1MjRjMTI2OQo8ICAqIGxh
a19jbG9zZSAtIGZyZWUgbWVtb3J5IGJ1ZmZlcnMKLS0tCj4gICogbGFrX2ZyZWVfcmVzdWx0IC0g
ZnJlZSBtZW1vcnkgYnVmZmVycwo1MjZjMTI3MQo8IHZvaWQgbGFrX2Nsb3NlKExBSyAqY29uZiwg
TEFLX0NPTk4gKmNvbm4pIAotLS0KPiB2b2lkIGxha19mcmVlX3Jlc3VsdChMQUsgKnJlc3VsdCkg
CjUyOGMxMjczCjwgCS8qIGNoYXIgICAqbXluYW1lID0gImxha19jbG9zZSI7ICovCi0tLQo+IAkv
KiBjaGFyICAgKm15bmFtZSA9ICJsYWtfZnJlZV9yZXN1bHQiOyAqLwo1MzAsNTM1YzEyNzUsMTI3
Ngo8IAlpZiAoY29ubi0+bGQpIHsKPCAJCWlmIChjb25mLT5jYWNoZV9leHBpcnkpCjwgCQkJbGRh
cF9kZXN0cm95X2NhY2hlKGNvbm4tPmxkKTsKPCAJCQkKPCAJCWxkYXBfdW5iaW5kX3MoY29ubi0+
bGQpOwo8IAl9Ci0tLQo+IAlpZiAocmVzdWx0ID09IE5VTEwpCj4gCQlyZXR1cm47CjUzNyw1Mzhj
MTI3OCwxMjc5CjwgCWlmIChjb25uKSB7CjwgCQlmcmVlKGNvbm4pOwotLS0KPiAJaWYgKHJlc3Vs
dC0+bmV4dCAhPSBOVUxMKSB7Cj4gCQlsYWtfZnJlZV9yZXN1bHQocmVzdWx0LT5uZXh0KTsKNTM5
YTEyODEsMTI4Ngo+IAo+IAlmcmVlKHJlc3VsdC0+YXR0cmlidXRlKTsJCj4gCWZyZWUocmVzdWx0
LT52YWx1ZSk7CQo+IAlmcmVlKHJlc3VsdCk7Cj4gCj4gCXJldHVybjsKNTQwYTEyODgKPiAKSW5k
ZXg6IGxhay5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL3Nhc2wvc2FzbGF1dGhkL2xh
ay5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjIKZGlmZiAtcjEuMiBsYWsuaAo0OWM0OSw1Mwo8
IHR5cGVkZWYgc3RydWN0IGxhayB7Ci0tLQo+ICNkZWZpbmUgTEFLX0FVVEhfTUVUSE9EX0JJTkQg
MAo+ICNkZWZpbmUgTEFLX0FVVEhfTUVUSE9EX0NVU1RPTSAxCj4gCj4gdHlwZWRlZiBzdHJ1Y3Qg
bGFrX2NvbmYgewo+ICAgICBjaGFyICAgKnBhdGg7CjUyYTU3Cj4gICAgIGludCAgICAgdmVyc2lv
bjsKNTdhNjMKPiAgICAgaW50ICAgICByZXN0YXJ0Owo2MmE2OSw3MAo+ICAgICBjaGFyICAgKmxv
b2t1cF9hdHRyaWI7Cj4gICAgIGNoYXIgICAgYXV0aF9tZXRob2Q7CjY1YzczLDgxCjwgfSBMQUs7
Ci0tLQo+ICAgICBpbnQgICAgIHNzbDsKPiAgICAgaW50ICAgICBzdGFydF90bHM7Cj4gICAgIGlu
dCAgICAgdGxzX2NoZWNrcGVlcjsKPiAgICAgY2hhciAgICp0bHNfY2FjZXJ0ZmlsZTsKPiAgICAg
Y2hhciAgICp0bHNfY2FjZXJ0ZGlyOwo+ICAgICBjaGFyICAgKnRsc19jaXBoZXJzOwo+ICAgICBj
aGFyICAgKnRsc19jZXJ0Owo+ICAgICBjaGFyICAgKnRsc19rZXk7Cj4gfSBMQUtfQ09ORjsKNjcs
NzBjODMsODgKPCB0eXBlZGVmIHN0cnVjdCBsYWtfY29ubiB7CjwgICAgIGNoYXIgICAgYm91bmQ7
CjwgICAgIExEQVAgICAqbGQ7CjwgfSBMQUtfQ09OTjsKLS0tCj4gdHlwZWRlZiBzdHJ1Y3QgbGFr
X3VzZXIgewo+ICAgICBjaGFyICAgICpuYW1lOwo+ICAgICBjaGFyICAgICpyZWFsbTsKPiAgICAg
Y2hhciAgICAqZG47Cj4gICAgIGNoYXIgICAgIGJvdW5kX2FzX3VzZXI7Cj4gfSBMQUtfVVNFUjsK
NzIsNzdjOTAsMTAyCjwgdHlwZWRlZiBzdHJ1Y3QgbGFrX3Jlc3VsdCB7CjwgICAgIGNoYXIgICAg
ICAgICAgICAgICphdHRyaWJ1dGU7CjwgICAgIGNoYXIgICAgICAgICAgICAgICp2YWx1ZTsKPCAg
ICAgc2l6ZV90ICAgICAgICAgICAgIGxlbjsKPCAgICAgc3RydWN0IGxha19yZXN1bHQgKm5leHQ7
CjwgfSBMQUtfUkVTVUxUOwotLS0KPiB0eXBlZGVmIHN0cnVjdCBsYWtfc2Vzc2lvbiB7Cj4gICAg
IExEQVAgICAgICpsZDsKPiAgICAgY2hhciAgICAgIGJvdW5kOwo+ICAgICBMQUtfQ09ORiAqY29u
ZjsKPiAgICAgTEFLX1VTRVIgKnVzZXI7Cj4gfSBMQUtfU0VTU0lPTjsKPiAKPiB0eXBlZGVmIHN0
cnVjdCBsYWsgewo+ICAgICBjaGFyICAgICAgICphdHRyaWJ1dGU7Cj4gICAgIGNoYXIgICAgICAg
KnZhbHVlOwo+ICAgICBzaXplX3QgICAgICBsZW47Cj4gICAgIHN0cnVjdCBsYWsgKm5leHQ7Cj4g
fSBMQUs7Cjc5LDgyYzEwNCwxMDYKPCBpbnQgbGFrX2xvb2t1cChMQUsgKiwgY2hhciAqLCBjaGFy
ICosIGNoYXIgKiosIExBS19SRVNVTFQgKiopOwo8IGludCBsYWtfYXV0aGVudGljYXRlKExBSyAq
LCBjaGFyICosIGNoYXIgKiwgY2hhciAqKTsKPCB2b2lkIGxha19jbG9zZShMQUsgKiwgTEFLX0NP
Tk4gKik7Cjwgdm9pZCBsYWtfZnJlZShMQUtfUkVTVUxUICopOwotLS0KPiBpbnQgbGFrX2F1dGhl
bnRpY2F0ZShjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBj
aGFyICopOwo+IGludCBsYWtfbG9va3VwX2F0dHJpYihjb25zdCBjaGFyICosIGNvbnN0IGNoYXIg
KiwgY29uc3QgY2hhciAqLCBMQUsgKiopOwo+IHZvaWQgbGFrX2ZyZWVfcmVzdWx0KExBSyAqKTsK
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>38</attachid>
            <date>2002-05-17 12:18 EDT</date>
            <desc>Resending auth_ldap overhaul patch in tar format</desc>
            <filename>auth_ldap.tar</filename>
            <type>application/x-tar</type>
            <size>40960</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">bGFrLmMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAxMDA2NDQAMDAwMDAw
MAAwMDAwMDAxADAwMDAwMDc1NjUwADA3NDcxMDE0MTE3ADAxMDY0NgAgMAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB1c3RhciAgAHJvb3QAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAb3RoZXIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv
KiBDT1BZUklHSFQgKiBDb3B5cmlnaHQgKGMpIDIwMDItMjAwMiBJZ29yIEJyZXphYwogKiBBbGwg
cmlnaHRzIHJlc2VydmVkLgogKgogKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBh
bmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQKICogbW9kaWZpY2F0aW9uLCBhcmUgcGVy
bWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zCiAqIGFyZSBtZXQ6
CiAqIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUgYWJv
dmUgY29weXJpZ2h0CiAqICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRo
ZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4KICogMi4gUmVkaXN0cmlidXRpb25zIGluIGJpbmFyeSBm
b3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQKICogICAgbm90aWNlLCB0aGlz
IGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFpbWVyIGluIHRoZQog
KiAgICBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJvdmlkZWQgd2l0aCB0
aGUgZGlzdHJpYnV0aW9uLgogKgogKiBUSElTIFNPRlRXQVJFIElTIFBST1ZJREVEIEJZIElHT1Ig
QlJFWkFDLiBgYEFTIElTJycgQU5EIEFOWQogKiBFWFBSRVNTIE9SIElNUExJRUQgV0FSUkFOVElF
UywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRQogKiBJTVBMSUVEIFdBUlJBTlRJ
RVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIKICogUFVS
UE9TRSBBUkUgRElTQ0xBSU1FRC4gIElOIE5PIEVWRU5UIFNIQUxMIElHT1IgQlJFWkFDIE9SCiAq
IElUUyBFTVBMT1lFRVMgT1IgQUdFTlRTIEJFIExJQUJMRSBGT1IgQU5ZIERJUkVDVCwgSU5ESVJF
Q1QsCiAqIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09OU0VRVUVOVElBTCBE
QU1BR0VTIChJTkNMVURJTkcsCiAqIEJVVCBOT1QgTElNSVRFRCBUTywgUFJPQ1VSRU1FTlQgT0Yg
U1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUwogKiBPRiBVU0UsIERBVEEsIE9SIFBS
T0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVTRUQgQU5ECiAqIE9O
IEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNULCBTVFJJQ1QgTElB
QklMSVRZLCBPUgogKiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBPVEhFUldJU0UpIEFS
SVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFCiAqIFVTRSBPRiBUSElTIFNPRlRXQVJFLCBFVkVO
IElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0gKICogREFNQUdFLgogKiBFTkQg
Q09QWVJJR0hUICovCgojaW5jbHVkZSAibWVjaGFuaXNtcy5oIgoKI2lmZGVmIEFVVEhfTERBUAoK
I2luY2x1ZGUgPHN5cy90aW1lLmg+CiNpbmNsdWRlIDxzdGRpby5oPgojaW5jbHVkZSA8c3RkbGli
Lmg+CiNpbmNsdWRlIDxzdHJpbmdzLmg+CiNpbmNsdWRlIDxzeXNsb2cuaD4KCiNpZmRlZiBIQVZF
X0NSWVBUX0gKI2luY2x1ZGUgPGNyeXB0Lmg+CiNlbmRpZgoKI2lmZGVmIEhBVkVfVU5JU1REX0gK
I2luY2x1ZGUgPHVuaXN0ZC5oPgojZW5kaWYKCiNpbmNsdWRlIDxsZGFwLmg+CiNpbmNsdWRlIDxs
YmVyLmg+CiNpbmNsdWRlICJsYWsuaCIKCnN0YXRpYyBpbnQgbGFrX3JlYWRfY29uZmlnKGNvbnN0
IGNoYXIgKik7CnN0YXRpYyBjb25zdCBjaGFyICpsYWtfY29uZmlnX2dldHN0cmluZyhjb25zdCBj
aGFyICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQgbGFrX2NvbmZpZ19nZXRpbnQoY29uc3Qg
Y2hhciAqLCBpbnQgKTsKc3RhdGljIGludCBsYWtfY29uZmlnX2dldHN3aXRjaChjb25zdCBjaGFy
ICosIGludCApOwpzdGF0aWMgaW50IGxha19jb25maWd1cmUoTEFLX0NPTkYgKiosIGNvbnN0IGNo
YXIgKik7CnN0YXRpYyB2b2lkIGxha19yZWxlYXNlX2NvbmZpZyhMQUtfQ09ORiAqKik7CiNpZiAw
CnN0YXRpYyBpbnQgbGFrX2dldF9pbnRlZ2VyX3ZhbHVlIChMREFQICosIExEQVBNZXNzYWdlICos
IGNvbnN0IGNoYXIgKiwgaW50ICopOwpzdGF0aWMgaW50IGxha19nZXRfbG9uZ19pbnRlZ2VyX3Zh
bHVlIChMREFQICosIExEQVBNZXNzYWdlICosIGNvbnN0IGNoYXIgKiwgbG9uZyBpbnQgKik7CnN0
YXRpYyBpbnQgbGFrX29jX2NoZWNrIChMREFQICosIExEQVBNZXNzYWdlICosIGNvbnN0IGNoYXIg
Kik7CnN0YXRpYyBpbnQgbGFrX2hhc192YWx1ZSAoY2hhciAqKiwgY29uc3QgY2hhciAqKTsKc3Rh
dGljIGludCBsYWtfZ2V0X3N0cmluZ192YWx1ZXMgKExEQVAgKiwgTERBUE1lc3NhZ2UgKiwgY29u
c3QgY2hhciAqLCBjaGFyICoqKik7CiNlbmRpZgpzdGF0aWMgaW50IGxha19nZXRfc3RyaW5nX3Zh
bHVlIChMREFQICosIExEQVBNZXNzYWdlICosIGNvbnN0IGNoYXIgKiwgY2hhciAqKik7CnN0YXRp
YyBpbnQgbGFrX2VzY2FwZShjb25zdCBjaGFyICosIGNoYXIgKiopOwpzdGF0aWMgaW50IGxha19m
aWx0ZXIoTEFLX1NFU1NJT04gKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNoYXIgKiop
OwpzdGF0aWMgaW50IGxha19nZXRfdXNlcihMQUtfU0VTU0lPTiAqLCBjb25zdCBjaGFyICosIGNv
bnN0IGNoYXIgKik7CnN0YXRpYyB2b2lkIGxha19yZWxlYXNlX3VzZXIoTEFLX1VTRVIgKiopOwpz
dGF0aWMgaW50IGxha19nZXRfc2Vzc2lvbihMQUtfU0VTU0lPTiAqKiwgY29uc3QgY2hhciAqKSA7
CnN0YXRpYyBpbnQgbGFrX29wZW5fc2Vzc2lvbihMQUtfU0VTU0lPTiAqKTsKc3RhdGljIGludCBs
YWtfcmVvcGVuX3Nlc3Npb24oTEFLX1NFU1NJT04gKik7CnN0YXRpYyB2b2lkIGxha19jbG9zZV9z
ZXNzaW9uKExBS19TRVNTSU9OICoqKTsKc3RhdGljIGludCBsYWtfY29ubmVjdF9hbm9ueW1vdXNs
eShMQUtfU0VTU0lPTiAqKTsKc3RhdGljIGludCBsYWtfY29ubmVjdF9hc191c2VyKExBS19TRVNT
SU9OICosIGNvbnN0IGNoYXIgKik7CnN0YXRpYyBpbnQgbGFrX3NlYXJjaChMQUtfU0VTU0lPTiAq
LCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiosIExEQVBNZXNzYWdlICoqKTsKc3RhdGljIGlu
dCBsYWtfcmV0cmlldmUoTEFLX1NFU1NJT04gKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICos
IGNvbnN0IGNoYXIgKiosIExBSyAqKik7CnN0YXRpYyBpbnQgbGFrX2N1c3RvbV9hdXRoZW50aWNh
dGUoTEFLX1NFU1NJT04gKiwgY29uc3QgY2hhciAqLCBjb25zdCBjaGFyICpyZWFsbSwgY29uc3Qg
Y2hhciAqKTsKc3RhdGljIGludCBsYWtfYmluZF9hdXRoZW50aWNhdGUoTEFLX1NFU1NJT04gKiwg
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKik7CgpzdGF0aWMgTEFLX1NF
U1NJT04gKnBlcnNpc3RlbnRfc2Vzc2lvbiA9IE5VTEw7CgojZGVmaW5lIENPTkZJR0xJU1RHUk9X
U0laRSAxMDAKCnN0cnVjdCBjb25maWdsaXN0IHsKCWNoYXIgKmtleTsKCWNoYXIgKnZhbHVlOwp9
OwoKc3RhdGljIHN0cnVjdCBjb25maWdsaXN0ICpjb25maWdsaXN0OwpzdGF0aWMgaW50IG5jb25m
aWdsaXN0OwoKc3RhdGljIGludCBsYWtfcmVhZF9jb25maWcoY29uc3QgY2hhciAqZmlsZW5hbWUp
CnsKCUZJTEUgKmluZmlsZTsKCWludCBsaW5lbm8gPSAwOwoJaW50IGFsbG9jZWQgPSAwOwoJY2hh
ciBidWZbNDA5Nl07CgljaGFyICpwLCAqa2V5OwoJY2hhciAqcmVzdWx0OwoKCW5jb25maWdsaXN0
PTA7CgoJaW5maWxlID0gZm9wZW4oZmlsZW5hbWUsICJyIik7CglpZiAoIWluZmlsZSkgewoJCXJl
dHVybiBMQUtfRkFJTDsKCX0KICAgIAoJd2hpbGUgKGZnZXRzKGJ1Ziwgc2l6ZW9mKGJ1ZiksIGlu
ZmlsZSkpIHsKCQlsaW5lbm8rKzsKCgkJaWYgKGJ1ZltzdHJsZW4oYnVmKS0xXSA9PSAnXG4nKSAK
CQkJYnVmW3N0cmxlbihidWYpLTFdID0gJ1wwJzsKCQlmb3IgKHAgPSBidWY7ICpwICYmIGlzc3Bh
Y2UoKGludCkgKnApOyBwKyspOwoJCQlpZiAoISpwIHx8ICpwID09ICcjJykgCgkJCQljb250aW51
ZTsKCgkJa2V5ID0gcDsKCQl3aGlsZSAoKnAgJiYgKGlzYWxudW0oKGludCkgKnApIHx8ICpwID09
ICctJyB8fCAqcCA9PSAnXycpKSB7CgkJCWlmIChpc3VwcGVyKChpbnQpICpwKSkgCgkJCQkqcCA9
IHRvbG93ZXIoKnApOwoJCQlwKys7CgkJfQoJCWlmICgqcCAhPSAnOicpIHsKCQkJcmV0dXJuIExB
S19GQUlMOwoJCX0KCQkqcCsrID0gJ1wwJzsKCgkJd2hpbGUgKCpwICYmIGlzc3BhY2UoKGludCkg
KnApKSAKCQkJcCsrOwoKCQlpZiAoISpwKSB7CgkJCXJldHVybiBMQUtfRkFJTDsKCQl9CgoJCWlm
IChuY29uZmlnbGlzdCA9PSBhbGxvY2VkKSB7CgkJCWFsbG9jZWQgKz0gQ09ORklHTElTVEdST1dT
SVpFOwoJCQljb25maWdsaXN0PXJlYWxsb2MoKGNoYXIgKiljb25maWdsaXN0LCBhbGxvY2VkICog
c2l6ZW9mKHN0cnVjdCBjb25maWdsaXN0KSk7CgkJCWlmIChjb25maWdsaXN0PT1OVUxMKSAKCQkJ
CXJldHVybiBMQUtfRkFJTDsKCQl9CgoJCXJlc3VsdCA9IHN0cmR1cChrZXkpOwoJCWlmIChyZXN1
bHQ9PU5VTEwpIAoJCQlyZXR1cm4gTEFLX0ZBSUw7CgoJCWNvbmZpZ2xpc3RbbmNvbmZpZ2xpc3Rd
LmtleSA9IHJlc3VsdDsKCgkJcmVzdWx0ID0gc3RyZHVwKHApOwoJCWlmIChyZXN1bHQ9PU5VTEwp
IAoJCQlyZXR1cm4gTEFLX0ZBSUw7CgkJY29uZmlnbGlzdFtuY29uZmlnbGlzdF0udmFsdWUgPSBy
ZXN1bHQ7CgoJCW5jb25maWdsaXN0Kys7Cgl9CgoJZmNsb3NlKGluZmlsZSk7CgoJcmV0dXJuIExB
S19PSzsKfQoKc3RhdGljIGNvbnN0IGNoYXIgKmxha19jb25maWdfZ2V0c3RyaW5nKGNvbnN0IGNo
YXIgKmtleSwgY29uc3QgY2hhciAqZGVmKQp7CiAgICBpbnQgb3B0OwoKICAgIGZvciAob3B0ID0g
MDsgb3B0IDwgbmNvbmZpZ2xpc3Q7IG9wdCsrKSB7CglpZiAoKmtleSA9PSBjb25maWdsaXN0W29w
dF0ua2V5WzBdICYmCgkgICAgIXN0cmNtcChrZXksIGNvbmZpZ2xpc3Rbb3B0XS5rZXkpKQoJICBy
ZXR1cm4gY29uZmlnbGlzdFtvcHRdLnZhbHVlOwogICAgfQogICAgcmV0dXJuIGRlZjsKfQoKc3Rh
dGljIGludCBsYWtfY29uZmlnX2dldGludChjb25zdCBjaGFyICprZXksIGludCBkZWYpCnsKICAg
IGNvbnN0IGNoYXIgKnZhbCA9IGxha19jb25maWdfZ2V0c3RyaW5nKGtleSwgKGNoYXIgKikwKTsK
CiAgICBpZiAoIXZhbCkgcmV0dXJuIGRlZjsKICAgIGlmICghaXNkaWdpdCgoaW50KSAqdmFsKSAm
JiAoKnZhbCAhPSAnLScgfHwgIWlzZGlnaXQoKGludCkgdmFsWzFdKSkpIHJldHVybiBkZWY7CiAg
ICByZXR1cm4gYXRvaSh2YWwpOwp9CgpzdGF0aWMgaW50IGxha19jb25maWdfZ2V0c3dpdGNoKGNv
bnN0IGNoYXIgKmtleSwgaW50IGRlZikKewogICAgY29uc3QgY2hhciAqdmFsID0gbGFrX2NvbmZp
Z19nZXRzdHJpbmcoa2V5LCAoY2hhciAqKTApOwoKICAgIGlmICghdmFsKSByZXR1cm4gZGVmOwoK
ICAgIGlmICgqdmFsID09ICcwJyB8fCAqdmFsID09ICduJyB8fAoJKCp2YWwgPT0gJ28nICYmIHZh
bFsxXSA9PSAnZicpIHx8ICp2YWwgPT0gJ2YnKSB7CglyZXR1cm4gMDsKICAgIH0KICAgIGVsc2Ug
aWYgKCp2YWwgPT0gJzEnIHx8ICp2YWwgPT0gJ3knIHx8CgkgICAgICgqdmFsID09ICdvJyAmJiB2
YWxbMV0gPT0gJ24nKSB8fCAqdmFsID09ICd0JykgewoJcmV0dXJuIDE7CiAgICB9CiAgICByZXR1
cm4gZGVmOwp9CgpzdGF0aWMgaW50IGxha19jb25maWd1cmUoTEFLX0NPTkYgKipwY29uZiwgY29u
c3QgY2hhciAqY29uZmlnRmlsZSkKewogICAgCWNvbnN0IGNoYXIgKm15bmFtZSA9ICJsYWtfY29u
ZmlndXJlIjsKCglMQUtfQ09ORiAqY29uZjsKCWludCByYyA9IDA7CgljaGFyICpzOwoKCWNvbmYg
PSBtYWxsb2MoIHNpemVvZihMQUtfQ09ORikgKTsKCWlmIChjb25mID09IE5VTEwpIHsKCQlyZXR1
cm4gTEFLX0ZBSUw7Cgl9CgoJY29uZi0+cGF0aCA9IHN0cmR1cChjb25maWdGaWxlKTsKCWlmIChj
b25mLT5wYXRoID09IE5VTEwpIHsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmMgPSBsYWtfcmVh
ZF9jb25maWcoY29uZi0+cGF0aCk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJcmV0dXJuIExBS19G
QUlMOwoJfQoKCWNvbmYtPnNlcnZlcnMgPSAoY2hhciAqKSBsYWtfY29uZmlnX2dldHN0cmluZygi
bGRhcF9zZXJ2ZXJzIiwgImxkYXA6Ly9sb2NhbGhvc3QvIik7Cgljb25mLT5iaW5kX2RuID0gKGNo
YXIgKikgbGFrX2NvbmZpZ19nZXRzdHJpbmcoImxkYXBfYmluZF9kbiIsICIiKTsKCWNvbmYtPmJp
bmRfcHcgPSAoY2hhciAqKSBsYWtfY29uZmlnX2dldHN0cmluZygibGRhcF9iaW5kX3B3IiwgIiIp
OwoJY29uZi0+dmVyc2lvbiA9IGxha19jb25maWdfZ2V0aW50KCJsZGFwX3ZlcnNpb24iLCBMREFQ
X1ZFUlNJT04zKTsKCWNvbmYtPnNlYXJjaF9iYXNlID0gKGNoYXIgKikgbGFrX2NvbmZpZ19nZXRz
dHJpbmcoImxkYXBfc2VhcmNoX2Jhc2UiLCAiIik7Cgljb25mLT5maWx0ZXIgPSAoY2hhciAqKSBs
YWtfY29uZmlnX2dldHN0cmluZygibGRhcF9maWx0ZXIiLCAidWlkPSV1Iik7Cgljb25mLT5sb29r
dXBfYXR0cmliID0gKGNoYXIgKikgbGFrX2NvbmZpZ19nZXRzdHJpbmcoImxkYXBfbG9va3VwX2F0
dHJpYiIsIE5VTEwpOwoJY29uZi0+YXV0aF9tZXRob2QgPSBMQUtfQVVUSF9NRVRIT0RfQklORDsK
CXMgPSAoY2hhciAqKSBsYWtfY29uZmlnX2dldHN0cmluZygibGRhcF9hdXRoX21ldGhvZCIsIE5V
TEwpOwoJaWYgKHMpIHsKCQlpZiAoIXN0cmNhc2VjbXAocywgImN1c3RvbSIpKSB7CgkJCWNvbmYt
PmF1dGhfbWV0aG9kID0gTEFLX0FVVEhfTUVUSE9EX0NVU1RPTTsKCQl9Cgl9Cgljb25mLT50aW1l
b3V0LnR2X3NlYyA9IGxha19jb25maWdfZ2V0aW50KCJsZGFwX3RpbWVvdXQiLCA1KTsKCWNvbmYt
PnRpbWVvdXQudHZfdXNlYyA9IDA7Cgljb25mLT5zaXplbGltaXQgPSBsYWtfY29uZmlnX2dldGlu
dCgibGRhcF9zaXplbGltaXQiLCAxKTsKCWNvbmYtPnRpbWVsaW1pdCA9IGxha19jb25maWdfZ2V0
aW50KCJsZGFwX3RpbWVsaW1pdCIsIDUpOwoJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVGX05FVkVS
OwoJcyA9IChjaGFyICopIGxha19jb25maWdfZ2V0c3RyaW5nKCJsZGFwX2RlcmVmIiwgTlVMTCk7
CglpZiAocykgewoJCWlmICghc3RyY2FzZWNtcChzLCAic2VhcmNoIikpIHsKCQkJY29uZi0+ZGVy
ZWYgPSBMREFQX0RFUkVGX1NFQVJDSElORzsKCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKHMsICJm
aW5kIikpIHsKCQkJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVGX0ZJTkRJTkc7CgkJfSBlbHNlIGlm
ICghc3RyY2FzZWNtcChzLCAiYWx3YXlzIikpIHsKCQkJY29uZi0+ZGVyZWYgPSBMREFQX0RFUkVG
X0FMV0FZUzsKCQl9IGVsc2UgaWYgKCFzdHJjYXNlY21wKHMsICJuZXZlciIpKSB7CgkJCWNvbmYt
PmRlcmVmID0gTERBUF9ERVJFRl9ORVZFUjsKCQl9Cgl9Cgljb25mLT5yZWZlcnJhbHMgPSBsYWtf
Y29uZmlnX2dldHN3aXRjaCgibGRhcF9yZWZlcnJhbHMiLCAwKTsKCWNvbmYtPnJlc3RhcnQgPSBs
YWtfY29uZmlnX2dldHN3aXRjaCgibGRhcF9yZXN0YXJ0IiwgMSk7Cgljb25mLT5jYWNoZV9leHBp
cnkgPSBsYWtfY29uZmlnX2dldGludCgibGRhcF9jYWNoZV9leHBpcnkiLCAwKTsKCWNvbmYtPmNh
Y2hlX3NpemUgPSBsYWtfY29uZmlnX2dldGludCgibGRhcF9jYWNoZV9zaXplIiwgMCk7Cgljb25m
LT5zY29wZSA9IExEQVBfU0NPUEVfU1VCVFJFRTsKCXMgPSAoY2hhciAqKSBsYWtfY29uZmlnX2dl
dHN0cmluZygibGRhcF9zY29wZSIsIE5VTEwpOwoJaWYgKHMpIHsKCQlpZiAoIXN0cmNhc2VjbXAo
cywgIm9uZSIpKSB7CgkJCWNvbmYtPnNjb3BlID0gTERBUF9TQ09QRV9PTkVMRVZFTDsKCQl9IGVs
c2UgaWYgKCFzdHJjYXNlY21wKHMsICJiYXNlIikpIHsKCQkJY29uZi0+c2NvcGUgPSBMREFQX1ND
T1BFX0JBU0U7CgkJfQoJfQoJY29uZi0+ZGVidWcgPSBsYWtfY29uZmlnX2dldGludCgibGRhcF9k
ZWJ1ZyIsIDApOwoJY29uZi0+dmVyYm9zZSA9IGxha19jb25maWdfZ2V0c3dpdGNoKCJsZGFwX3Zl
cmJvc2UiLCAwKTsKCWNvbmYtPnNzbCA9IGxha19jb25maWdfZ2V0c3dpdGNoKCJsZGFwX3NzbCIs
IDApOwoJY29uZi0+c3RhcnRfdGxzID0gbGFrX2NvbmZpZ19nZXRzd2l0Y2goImxkYXBfc3RhcnRf
dGxzIiwgMCk7CglpZiAoY29uZi0+c3RhcnRfdGxzKSB7CgkJY29uZi0+c3NsID0gMDsKCX0KCWNv
bmYtPnRsc19jaGVja3BlZXIgPSBsYWtfY29uZmlnX2dldGludCgibGRhcF90bHNfY2hlY2twZWVy
IiwgMCk7Cgljb25mLT50bHNfY2FjZXJ0ZmlsZSA9IChjaGFyICopIGxha19jb25maWdfZ2V0c3Ry
aW5nKCJsZGFwX3Rsc19jYWNlcnRmaWxlIiwgTlVMTCk7Cgljb25mLT50bHNfY2FjZXJ0ZGlyID0g
KGNoYXIgKikgbGFrX2NvbmZpZ19nZXRzdHJpbmcoImxkYXBfdGxzX2NhY2VydGRpciIsIE5VTEwp
OwoJY29uZi0+dGxzX2NpcGhlcnMgPSAoY2hhciAqKSBsYWtfY29uZmlnX2dldHN0cmluZygibGRh
cF90bHNfY2lwaGVycyIsIE5VTEwpOwoJY29uZi0+dGxzX2NlcnQgPSAoY2hhciAqKSBsYWtfY29u
ZmlnX2dldHN0cmluZygibGRhcF90bHNfY2VydCIsIE5VTEwpOwoJY29uZi0+dGxzX2tleSA9IChj
aGFyICopIGxha19jb25maWdfZ2V0c3RyaW5nKCJsZGFwX3Rsc19rZXkiLCBOVUxMKTsKCgkqcGNv
bmYgPSBjb25mOwoJcmV0dXJuIExBS19PSzsKfQoKLyoKICogVXRpbCBmdW5jdGlvbnMKICovCiNp
ZiAwCnN0YXRpYyBpbnQgbGFrX2dldF9pbnRlZ2VyX3ZhbHVlIChMREFQICpsZCwgTERBUE1lc3Nh
Z2UgKmUsIGNvbnN0IGNoYXIgKmF0dHIsIGludCAqcHRyKQp7CgljaGFyICoqdmFsczsKCgl2YWxz
ID0gbGRhcF9nZXRfdmFsdWVzIChsZCwgZSwgKGNoYXIgKikgYXR0cik7CglpZiAodmFscyA9PSBO
VUxMKSB7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoJKnB0ciA9IGF0b2kgKHZhbHNbMF0pOwoJbGRh
cF92YWx1ZV9mcmVlICh2YWxzKTsKCglyZXR1cm4gTEFLX09LOwp9CgpzdGF0aWMgaW50IGxha19n
ZXRfbG9uZ19pbnRlZ2VyX3ZhbHVlIChMREFQICpsZCwgTERBUE1lc3NhZ2UgKmUsIGNvbnN0IGNo
YXIgKmF0dHIsIGxvbmcgaW50ICpwdHIpCnsKCWNoYXIgKip2YWxzOwoKCXZhbHMgPSBsZGFwX2dl
dF92YWx1ZXMgKGxkLCBlLCAoY2hhciAqKSBhdHRyKTsKCWlmICh2YWxzID09IE5VTEwpIHsKCQly
ZXR1cm4gTEFLX0ZBSUw7Cgl9CgkqcHRyID0gYXRvbCAodmFsc1swXSk7CglsZGFwX3ZhbHVlX2Zy
ZWUgKHZhbHMpOwoKCXJldHVybiBMQUtfT0s7Cn0KCgpzdGF0aWMgaW50IGxha19vY19jaGVjayAo
TERBUCAqbGQsIExEQVBNZXNzYWdlICplLCBjb25zdCBjaGFyICpvYykKewoJY2hhciAqKnZhbHMs
ICoqcDsKCWludCByYyA9IDA7CgoJdmFscyA9IGxkYXBfZ2V0X3ZhbHVlcyAobGQsIGUsICJvYmpl
Y3RDbGFzcyIpOwoJaWYgKHZhbHMgPT0gTlVMTCkgewoJcmV0dXJuIExBS19GQUlMOwoJfQoKCWZv
ciAocCA9IHZhbHM7ICpwICE9IE5VTEw7IHArKykgewoJCWlmICghc3RyY2FzZWNtcCAoKnAsIG9j
KSkgewoJCQlyYyA9IDE7CgkJCWJyZWFrOwoJCX0KCX0KCglsZGFwX3ZhbHVlX2ZyZWUgKHZhbHMp
OwoKCXJldHVybiByYzsKfQoKc3RhdGljIGludCBsYWtfaGFzX3ZhbHVlIChjaGFyICoqc3JjLCBj
b25zdCBjaGFyICp0Z3QpCnsKCWNoYXIgKipwOwoKCWZvciAocCA9IHNyYzsgKnAgIT0gTlVMTDsg
cCsrKSB7CgkJaWYgKCFzdHJjYXNlY21wICgqcCwgdGd0KSkgewoJCQlyZXR1cm4gMTsKCQl9Cgl9
CgoJcmV0dXJuIDA7Cn0KCnN0YXRpYyBpbnQgbGFrX2dldF9zdHJpbmdfdmFsdWVzIChMREFQICps
ZCwgTERBUE1lc3NhZ2UgKmUsIGNvbnN0IGNoYXIgKmF0dHIsIGNoYXIgKioqcHRyKQp7CgljaGFy
ICoqdmFsczsKCgl2YWxzID0gbGRhcF9nZXRfdmFsdWVzIChsZCwgZSwgKGNoYXIgKikgYXR0cik7
CglpZiAodmFscyA9PSBOVUxMKSB7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoJKnB0ciA9IHZhbHM7
CgoJcmV0dXJuIExBS19PSzsKfQojZW5kaWYgLyogMCAqLwoKc3RhdGljIGludCBsYWtfZ2V0X3N0
cmluZ192YWx1ZSAoTERBUCAqbGQsIExEQVBNZXNzYWdlICplLCBjb25zdCBjaGFyICphdHRyLCBj
aGFyICoqcHRyKQp7CgljaGFyICoqdmFsczsKCWludCByYzsKCgl2YWxzID0gbGRhcF9nZXRfdmFs
dWVzIChsZCwgZSwgKGNoYXIgKikgYXR0cik7CglpZiAodmFscyA9PSBOVUxMKSB7CgkJcmV0dXJu
IExBS19GQUlMOwoJfQoJKnB0ciA9IHN0cmR1cCAodmFsc1swXSk7CglpZiAoKnB0ciA9PSBOVUxM
KSB7CgkJcmMgPSBMQUtfRkFJTDsKCX0gZWxzZSB7CgkJcmMgPSBMQUtfT0s7Cgl9CgoJbGRhcF92
YWx1ZV9mcmVlICh2YWxzKTsKCglyZXR1cm4gcmM7Cn0KCi8qCiAqIElmIGFueSBjaGFyYWN0ZXJz
IGluIHRoZSBzdXBwbGllZCBhZGRyZXNzIHNob3VsZCBiZSBlc2NhcGVkIHBlciBSRkMKICogMjI1
NCwgZG8gc28uIFRoYW5rcyB0byBLZWl0aCBTdGV2ZW5zb24gYW5kIFdpZXRzZS4gQW5kIHRoYW5r
cyB0bwogKiBTYW11ZWwgVGFyZGlldSBmb3Igc3BvdHRpbmcgdGhhdCB3aWxkY2FyZCBzZWFyY2hl
cyB3ZXJlIGJlaW5nIGRvbmUgaW4KICogdGhlIGZpcnN0IHBsYWNlLCB3aGljaCBwcm9tcHRlZCB0
aGUgaWxsLWNvbmNlaXZlZCBsb29rdXBfd2lsZGNhcmRzCiAqIHBhcmFtZXRlciBhbmQgdGhlbiB0
aGlzIG1vcmUgY29tcHJlaGVuc2l2ZSBtZWNoYW5pc20uCiAqCiAqIE5vdGU6IGNhbGxpbmcgZnVu
Y3Rpb24gbXVzdCBmcmVlIG1lbW9yeS4KICovCnN0YXRpYyBpbnQgbGFrX2VzY2FwZShjb25zdCBj
aGFyICpzLCBjaGFyICoqcmVzdWx0KSAKewogICAgCS8qIGNoYXIgICpteW5hbWUgPSAibGFrX2Vz
Y2FwZSI7ICovCgoJY2hhciAqYnVmOwoJY2hhciAqZW5kLCAqcHRyLCAqdGVtcDsKCglidWYgPSBt
YWxsb2Moc3RybGVuKHMpICogMiArIDEpOwoJaWYgKGJ1ZiA9PSBOVUxMKSB7CgkJcmV0dXJuIExB
S19GQUlMOwoJfQoKCWJ1ZlswXSA9ICdcMCc7CglwdHIgPSAoY2hhciAqKXM7CgllbmQgPSBwdHIg
KyBzdHJsZW4ocHRyKTsKCgl3aGlsZSAoKCh0ZW1wID0gc3RycGJyayhwdHIsICIqKClcXFwwIikp
IT1OVUxMKSAmJiAodGVtcCA8IGVuZCkpIHsKCgkJaWYgKCh0ZW1wLXB0cikgPiAwKQoJCQlzdHJu
Y2F0KGJ1ZiwgcHRyLCB0ZW1wLXB0cik7CgoJCXN3aXRjaCAoKnRlbXApIHsKCQkJY2FzZSAnKic6
CgkJCQlzdHJjYXQoYnVmLCAiXFwyYSIpOwoJCQkJYnJlYWs7CgkJCWNhc2UgJygnOgoJCQkJc3Ry
Y2F0KGJ1ZiwgIlxcMjgiKTsKCQkJCWJyZWFrOwoJCQljYXNlICcpJzoKCQkJCXN0cmNhdChidWYs
ICJcXDI5Iik7CgkJCQlicmVhazsKCQkJY2FzZSAnXFwnOgoJCQkJc3RyY2F0KGJ1ZiwgIlxcNWMi
KTsKCQkJCWJyZWFrOwoJCQljYXNlICdcMCc6CgkJCQlzdHJjYXQoYnVmLCAiXFwwMCIpOwoJCQkJ
YnJlYWs7CgkJfQoJCXB0cj10ZW1wKzE7Cgl9CglpZiAodGVtcDxlbmQpCgkJc3RyY2F0KGJ1Ziwg
cHRyKTsKCgkqcmVzdWx0ID0gYnVmOwoKCXJldHVybiBMQUtfT0s7Cn0KCi8qCiAqIGxha19maWx0
ZXIKICogUGFydHMgd2l0aCB0aGUgc3RyaW5ncyBwcm92aWRlZC4KICogICAlJSA9ICUKICogICAl
dSA9IHVzZXIKICogICAlciA9IHJlYWxtCiAqIE5vdGU6IGNhbGxpbmcgZnVuY3Rpb24gbXVzdCBm
cmVlIG1lbW9yeS4KICovCnN0YXRpYyBpbnQgbGFrX2ZpbHRlcihMQUtfU0VTU0lPTiAqc2Vzc2lv
biwgY29uc3QgY2hhciAqdXNlcm5hbWUsIGNvbnN0IGNoYXIgKnJlYWxtLCBjaGFyICoqcmVzdWx0
KSAKewogICAgCWNvbnN0IGNoYXIgKm15bmFtZSA9ICJsYWtfZmlsdGVyIjsKCgljaGFyICpidWY7
IAoJY2hhciAqZW5kLCAqcHRyLCAqdGVtcDsKCWNoYXIgKmVidWY7CglpbnQgcmM7CgkKCWlmIChz
ZXNzaW9uLT5jb25mLT5maWx0ZXIgPT0gTlVMTCkgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0df
QVVUSCwgIiVzOiBmaWx0ZXIgbm90IHNldHVwIiwgbXluYW1lKTsKCQlyZXR1cm4gTEFLX0ZBSUw7
Cgl9CgoJYnVmPW1hbGxvYyhzdHJsZW4oc2Vzc2lvbi0+Y29uZi0+ZmlsdGVyKStzdHJsZW4odXNl
cm5hbWUpK3N0cmxlbihyZWFsbSkrMSk7CglpZihidWYgPT0gTlVMTCkgewoJCXN5c2xvZyhMT0df
RVJSfExPR19BVVRILCAiJXM6IENhbm5vdCBhbGxvY2F0ZSBtZW1vcnkiLCBteW5hbWUpOwoJCXJl
dHVybiBMQUtfRkFJTDsKCX0KCWJ1ZlswXSA9ICdcMCc7CgkKCXB0cj1zZXNzaW9uLT5jb25mLT5m
aWx0ZXI7CgllbmQgPSBwdHIgKyBzdHJsZW4ocHRyKTsKCgl3aGlsZSAoKHRlbXA9c3RyY2hyKHB0
ciwnJScpKSE9TlVMTCApIHsKCgkJaWYgKCh0ZW1wLXB0cikgPiAwKQoJCQlzdHJuY2F0KGJ1Ziwg
cHRyLCB0ZW1wLXB0cik7CgoJCWlmICgodGVtcCsxKSA+PSBlbmQpIHsKCQkJc3lzbG9nKExPR19X
QVJOSU5HfExPR19BVVRILCAiJXM6IEluY29tcGxldGUgbG9va3VwIHN1YnN0aXR1dGlvbiBmb3Jt
YXQiLCBteW5hbWUpOwoJCQlicmVhazsKCQl9CgoJCXN3aXRjaCAoKih0ZW1wKzEpKSB7CgkJCWNh
c2UgJyUnOgoJCQkJc3RybmNhdChidWYsdGVtcCsxLDEpOwoJCQkJYnJlYWs7CgkJCWNhc2UgJ3Un
OgoJCQkJaWYgKHVzZXJuYW1lIT1OVUxMKSB7CgkJCQkJcmM9bGFrX2VzY2FwZSh1c2VybmFtZSwg
JmVidWYpOwoJCQkJCWlmIChyYyA9PSBMQUtfT0spIHsKCQkJCQkJc3RyY2F0KGJ1ZixlYnVmKTsK
CQkJCQkJZnJlZShlYnVmKTsKCQkJCQl9CgkJCQl9IGVsc2UgewoJCQkJCXN5c2xvZyhMT0dfV0FS
TklOR3xMT0dfQVVUSCwgIiVzOiBVc2VybmFtZSBub3QgYXZhaWxhYmxlLiIsIG15bmFtZSk7CgkJ
CQl9CgkJCQlicmVhazsKCQkJY2FzZSAncic6CgkJCQlpZiAocmVhbG0hPU5VTEwpIHsKCQkJCQly
YyA9IGxha19lc2NhcGUocmVhbG0sICZlYnVmKTsKCQkJCQlpZiAocmMgPT0gTEFLX09LKSB7CgkJ
CQkJCXN0cmNhdChidWYsZWJ1Zik7CgkJCQkJCWZyZWUoZWJ1Zik7CgkJCQkJfQoJCQkJfSBlbHNl
IHsKCQkJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogUmVhbG0gbm90IGF2YWls
YWJsZS4iLCBteW5hbWUpOwoJCQkJfQoJCQkJYnJlYWs7CgkJCWRlZmF1bHQ6CgkJCQlicmVhazsK
CQl9CgkJcHRyPXRlbXArMjsKCX0KCWlmICh0ZW1wPGVuZCkKCQlzdHJjYXQoYnVmLCBwdHIpOwoK
CWlmIChzZXNzaW9uLT5jb25mLT52ZXJib3NlKQoJCXN5c2xvZyhMT0dfSU5GT3xMT0dfQVVUSCwi
JXM6IEFmdGVyIGZpbHRlciBzdWJzdGl0dXRpb24sIGl0J3MgJXMiLCBteW5hbWUsIGJ1Zik7CgoJ
KnJlc3VsdCA9IGJ1ZjsKCglyZXR1cm4gTEFLX09LOwp9CgpzdGF0aWMgaW50IGxha19nZXRfdXNl
cihMQUtfU0VTU0lPTiAqc2Vzc2lvbiwgY29uc3QgY2hhciAqdXNlciwgY29uc3QgY2hhciAqcmVh
bG0pCnsKCWNvbnN0IGNoYXIgKm15bmFtZSA9ICJsYWtfZ2V0X3VzZXIiOwoKCWNoYXIgKmZpbHRl
cjsKCWludCByYzsKCUxEQVBNZXNzYWdlICpyZXMsICplbnRyeTsKCglpZiAoc2Vzc2lvbi0+dXNl
ciAhPSBOVUxMKSB7IC8qIFNob3VsZCBub3QgaGFwcGVuLCBqdXN0IGEgc2FuaXR5IGNoZWNrICov
CgkJbGFrX3JlbGVhc2VfdXNlcigmc2Vzc2lvbi0+dXNlcik7Cgl9CgoJcmMgPSBsYWtfZmlsdGVy
KHNlc3Npb24sIHVzZXIsIHJlYWxtLCAmZmlsdGVyKTsKCWlmIChyYyAhPSBMQUtfT0spIHsKCQlz
eXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogbGFrX2ZpbHRlciBmYWlsZWQuIiwgbXlu
YW1lKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJcmMgPSBsYWtfc2VhcmNoKHNlc3Npb24sIGZp
bHRlciwgTlVMTCwgJnJlcyk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJc3lzbG9nKExPR19XQVJO
SU5HfExPR19BVVRILCAiJXM6IGxha19zZWFyY2ggZmFpbGVkLiIsIG15bmFtZSk7CgkJZnJlZShm
aWx0ZXIpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCgllbnRyeSA9IGxkYXBfZmlyc3RfZW50cnko
c2Vzc2lvbi0+bGQsIHJlcyk7IAoJaWYgKGVudHJ5ID09IE5VTEwpIHsKCQlzeXNsb2coTE9HX1dB
Uk5JTkd8TE9HX0FVVEgsICIlczogbGRhcF9maXJzdF9lbnRyeSgpIGZhaWxlZC4iLCBteW5hbWUp
OwoJCWZyZWUoZmlsdGVyKTsKCQlsZGFwX21zZ2ZyZWUocmVzKTsKCQlyZXR1cm4gTEFLX0ZBSUw7
Cgl9CgoJc2Vzc2lvbi0+dXNlciA9IChMQUtfVVNFUiAqKSBtYWxsb2Moc2l6ZW9mKExBS19VU0VS
KSk7CglpZiAoc2Vzc2lvbi0+dXNlciA9PSBOVUxMKSB7CgkJc3lzbG9nKExPR19FUlJ8TE9HX0FV
VEgsICIlczogQ2Fubm90IGFsbG9jYXRlIG1lbW9yeSIsIG15bmFtZSk7CgkJZnJlZShmaWx0ZXIp
OwoJCWxkYXBfbXNnZnJlZSAocmVzKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJc2Vzc2lvbi0+
dXNlci0+bmFtZSA9IHN0cmR1cCh1c2VyKTsKCWlmIChzZXNzaW9uLT51c2VyLT5uYW1lID09IE5V
TEwpIHsKCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgIiVzOiBDYW5ub3Qgc3RyZHVwIG9yIHVz
ZXJuYW1lIGlzIGVtcHR5IiwgbXluYW1lKTsKCQlmcmVlKGZpbHRlcik7CgkJbGRhcF9tc2dmcmVl
IChyZXMpOwoJCWxha19yZWxlYXNlX3VzZXIoJnNlc3Npb24tPnVzZXIpOwoJCXJldHVybiBMQUtf
RkFJTDsKCX0KCglpZiAocmVhbG0pIHsKCQlzZXNzaW9uLT51c2VyLT5yZWFsbSA9IHN0cmR1cChy
ZWFsbSk7CgkJaWYgKHNlc3Npb24tPnVzZXItPnJlYWxtID09IE5VTEwpIHsKCQkJc3lzbG9nKExP
R19FUlJ8TE9HX0FVVEgsICIlczogQ2Fubm90IHN0cmR1cCIsIG15bmFtZSk7CgkJCWZyZWUoZmls
dGVyKTsKCQkJbGRhcF9tc2dmcmVlIChyZXMpOwoJCQlsYWtfcmVsZWFzZV91c2VyKCZzZXNzaW9u
LT51c2VyKTsKCQkJcmV0dXJuIExBS19GQUlMOwoJCX0KCX0KCglzZXNzaW9uLT51c2VyLT5kbiA9
IGxkYXBfZ2V0X2RuKHNlc3Npb24tPmxkLCByZXMpOwoJaWYgKHNlc3Npb24tPnVzZXItPmRuID09
IE5VTEwpIHsKCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgIiVzOiBsZGFwX2dldF9kbigpIGZh
aWxlZC4iLCBteW5hbWUpOwoJCWZyZWUoZmlsdGVyKTsKCQlsZGFwX21zZ2ZyZWUgKHJlcyk7CgkJ
bGFrX3JlbGVhc2VfdXNlcigmc2Vzc2lvbi0+dXNlcik7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoK
CXNlc3Npb24tPnVzZXItPmJvdW5kX2FzX3VzZXIgPSAwOwoKCWZyZWUoZmlsdGVyKTsKCWxkYXBf
bXNnZnJlZSAocmVzKTsKCglyZXR1cm4gTEFLX09LOwp9CgoKc3RhdGljIGludCBsYWtfZ2V0X3Nl
c3Npb24oTEFLX1NFU1NJT04gKipwc2Vzc2lvbiwgY29uc3QgY2hhciAqY29uZmlnRmlsZSkgCnsK
ICAgIAljaGFyICAqbXluYW1lID0gImxha19nZXRfc2Vzc2lvbiI7CgoJTEFLX1NFU1NJT04gKnNl
c3Npb247CglpbnQgcmM7CgoJc2Vzc2lvbiA9ICpwc2Vzc2lvbjsKCglpZiAoc2Vzc2lvbiAhPSBO
VUxMKSB7CgkJaWYgKHNlc3Npb24tPmNvbmYtPnZlcmJvc2UpCgkJCXN5c2xvZyhMT0dfSU5GT3xM
T0dfQVVUSCwgIiVzOiBSZXVzZSBleGlzdGluZyBsYWsgc2Vzc2lvbi4iLCBteW5hbWUpOwoKCQlp
ZiAoc2Vzc2lvbi0+dXNlciAhPSBOVUxMKSB7IC8qIGdhcmJhZ2UgY29sbGVjdGlvbiwgc2hvdWxk
IG5vdCBoYXBwZW4gKi8KCQkJbGFrX3JlbGVhc2VfdXNlcigmc2Vzc2lvbi0+dXNlcik7CgkJfQoJ
CXJldHVybiBMQUtfT0s7Cgl9CgoJc2Vzc2lvbiA9IChMQUtfU0VTU0lPTiAqKW1hbGxvYyhzaXpl
b2YoTEFLKSk7CglpZiAoc2Vzc2lvbiA9PSBOVUxMKSB7CgkJc3lzbG9nKExPR19FUlJ8TE9HX0FV
VEgsICIlczogQ2Fubm90IGFsbG9jYXRlIG1lbW9yeSIsIG15bmFtZSk7CgkJcmV0dXJuIExBS19G
QUlMOwoJfQoKCXNlc3Npb24tPmJvdW5kPTA7CglzZXNzaW9uLT5sZD1OVUxMOwoJc2Vzc2lvbi0+
Y29uZj1OVUxMOwoJc2Vzc2lvbi0+dXNlcj1OVUxMOwoKCXJjID0gbGFrX2NvbmZpZ3VyZSgmc2Vz
c2lvbi0+Y29uZiwgY29uZmlnRmlsZSk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJc3lzbG9nKExP
R19FUlJ8TE9HX0FVVEgsICIlczogQ29uZmlndXJlIGZhaWxlZCAtIGNoZWNrIGNvbmZpZ3VyYXRp
b24gZmlsZSAlcy4iLCBteW5hbWUsIHNlc3Npb24tPmNvbmYtPnBhdGgpOwoJCWxha19yZWxlYXNl
X2NvbmZpZygmc2Vzc2lvbi0+Y29uZik7CgkJZnJlZShzZXNzaW9uKTsKCQlyZXR1cm4gcmM7Cgl9
CgoJaWYgKHNlc3Npb24tPmNvbmYtPnZlcmJvc2UpCgkJc3lzbG9nKExPR19JTkZPfExPR19BVVRI
LCAiJXM6IFN0YXJ0IGEgbmV3IGxhayBzZXNzaW9uLiIsIG15bmFtZSk7CgoJKnBzZXNzaW9uPXNl
c3Npb247CgoJcmV0dXJuIExBS19PSzsKfQoKCnN0YXRpYyBpbnQgbGFrX29wZW5fc2Vzc2lvbihM
QUtfU0VTU0lPTiAqc2Vzc2lvbikKewoJY2hhciAgICpteW5hbWUgPSAibGFrX29wZW5fc2Vzc2lv
biI7CgoJaW50ICAgICByYyA9IDA7CgoJaWYgKHNlc3Npb24tPmNvbmYtPnZlcmJvc2UpCgkJc3lz
bG9nKExPR19JTkZPfExPR19BVVRILCAiJXM6IFNldHVwIExEQVAgc3RydWN0dXJlcy4iLCBteW5h
bWUpOwoKCWlmIChzZXNzaW9uLT5jb25mLT5zc2wgfHwgc2Vzc2lvbi0+Y29uZi0+c3RhcnRfdGxz
KSB7CgkJaWYgKHNlc3Npb24tPmNvbmYtPnRsc19jYWNlcnRmaWxlICE9IE5VTEwpIHsKCQkJcmMg
PSBsZGFwX3NldF9vcHRpb24gKE5VTEwsIExEQVBfT1BUX1hfVExTX0NBQ0VSVEZJTEUsIHNlc3Np
b24tPmNvbmYtPnRsc19jYWNlcnRmaWxlKTsKCQkJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJ
CQkJc3lzbG9nIChMT0dfV0FSTklOR3xMT0dfQVVUSCwgIiVzOiBVbmFibGUgdG8gc2V0IExEQVBf
T1BUX1hfVExTX0NBQ0VSVEZJTEUgKCVzKS4iLCBteW5hbWUsIGxkYXBfZXJyMnN0cmluZyAocmMp
KTsKCQkJfQoJCX0KCgkJaWYgKHNlc3Npb24tPmNvbmYtPnRsc19jYWNlcnRkaXIgIT0gTlVMTCkg
ewoJCQlyYyA9IGxkYXBfc2V0X29wdGlvbiAoTlVMTCwgTERBUF9PUFRfWF9UTFNfQ0FDRVJURElS
LCBzZXNzaW9uLT5jb25mLT50bHNfY2FjZXJ0ZGlyKTsKCQkJaWYgKHJjICE9IExEQVBfU1VDQ0VT
UykgewoJCQkJc3lzbG9nIChMT0dfV0FSTklOR3xMT0dfQVVUSCwgIiVzOiBVbmFibGUgdG8gc2V0
IExEQVBfT1BUX1hfVExTX0NBQ0VSVERJUiAoJXMpLiIsIG15bmFtZSwgbGRhcF9lcnIyc3RyaW5n
IChyYykpOwoJCQl9CgkJfQoKCQkvKiByZXF1aXJlIGNlcnQ/ICovCgkJcmMgPSBsZGFwX3NldF9v
cHRpb24gKE5VTEwsIExEQVBfT1BUX1hfVExTX1JFUVVJUkVfQ0VSVCwgJnNlc3Npb24tPmNvbmYt
PnRsc19jaGVja3BlZXIpOwoJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJc3lzbG9nIChM
T0dfV0FSTklOR3xMT0dfQVVUSCwgIiVzOiBVbmFibGUgdG8gc2V0IExEQVBfT1BUX1hfVExTX1JF
UVVJUkVfQ0VSVCAoJXMpLiIsIG15bmFtZSwgbGRhcF9lcnIyc3RyaW5nIChyYykpOwoJCX0KCgkJ
aWYgKHNlc3Npb24tPmNvbmYtPnRsc19jaXBoZXJzICE9IE5VTEwpIHsKCQkJLyogc2V0IGNpcGhl
ciBzdWl0ZSwgY2VydGlmaWNhdGUgYW5kIHByaXZhdGUga2V5OiAqLwoJCQlyYyA9IGxkYXBfc2V0
X29wdGlvbiAoTlVMTCwgTERBUF9PUFRfWF9UTFNfQ0lQSEVSX1NVSVRFLCBzZXNzaW9uLT5jb25m
LT50bHNfY2lwaGVycyk7CgkJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJCXN5c2xvZyAo
TE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRvIHNldCBMREFQX09QVF9YX1RMU19D
SVBIRVJfU1VJVEUgKCVzKS4iLCBteW5hbWUsIGxkYXBfZXJyMnN0cmluZyAocmMpKTsKCQkJfQoJ
CX0KCgkJaWYgKHNlc3Npb24tPmNvbmYtPnRsc19jZXJ0ICE9IE5VTEwpIHsKCQkJcmMgPSBsZGFw
X3NldF9vcHRpb24gKE5VTEwsIExEQVBfT1BUX1hfVExTX0NFUlRGSUxFLCBzZXNzaW9uLT5jb25m
LT50bHNfY2VydCk7CgkJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJCXN5c2xvZyAoTE9H
X1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRvIHNldCBMREFQX09QVF9YX1RMU19DRVJU
RklMRSAoJXMpLiIsIG15bmFtZSwgbGRhcF9lcnIyc3RyaW5nIChyYykpOwoJCQl9CgkJfQoKCQlp
ZiAoc2Vzc2lvbi0+Y29uZi0+dGxzX2tleSAhPSBOVUxMKSB7CgkJCXJjID0gbGRhcF9zZXRfb3B0
aW9uIChOVUxMLCBMREFQX09QVF9YX1RMU19LRVlGSUxFLCBzZXNzaW9uLT5jb25mLT50bHNfa2V5
KTsKCQkJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJCQkJc3lzbG9nIChMT0dfV0FSTklOR3xM
T0dfQVVUSCwgIiVzOiBVbmFibGUgdG8gc2V0IExEQVBfT1BUX1hfVExTX0tFWUZJTEUgKCVzKS4i
LCBteW5hbWUsIGxkYXBfZXJyMnN0cmluZyAocmMpKTsKCQkJfQoJCX0KCX0KCglyYyA9IGxkYXBf
aW5pdGlhbGl6ZSgmc2Vzc2lvbi0+bGQsIHNlc3Npb24tPmNvbmYtPnNlcnZlcnMpOwoJaWYgKHJj
ICE9IExEQVBfU1VDQ0VTUykgewoJCXN5c2xvZyhMT0dfRVJSfExPR19BVVRILCAiJXM6IGxkYXBf
aW5pdGlhbGl6ZSBmYWlsZWQiLCBteW5hbWUsIHNlc3Npb24tPmNvbmYtPnNlcnZlcnMpOwoJCXJl
dHVybiBMQUtfRkFJTDsKCX0KCglpZiAoc2Vzc2lvbi0+Y29uZi0+ZGVidWcpIHsKCQlyYyA9IGxk
YXBfc2V0X29wdGlvbihOVUxMLCBMREFQX09QVF9ERUJVR19MRVZFTCwgJihzZXNzaW9uLT5jb25m
LT5kZWJ1ZykpOwoJCWlmIChyYyAhPSBMREFQX09QVF9TVUNDRVNTKQoJCQlzeXNsb2coTE9HX1dB
Uk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxlIHRvIHNldCBMREFQX09QVF9ERUJVR19MRVZFTCAl
eC4iLCBteW5hbWUsIHNlc3Npb24tPmNvbmYtPmRlYnVnKTsKCX0KCglpZiAoc2Vzc2lvbi0+Y29u
Zi0+c3NsIHx8IHNlc3Npb24tPmNvbmYtPnN0YXJ0X3RscykgewoJCWludCB0bHMgPSBMREFQX09Q
VF9YX1RMU19IQVJEOwoJCXJjID0gbGRhcF9zZXRfb3B0aW9uIChzZXNzaW9uLT5sZCwgTERBUF9P
UFRfWF9UTFMsICZ0bHMpOwoJCWlmIChyYyAhPSBMREFQX1NVQ0NFU1MpIHsKCQkJc3lzbG9nKExP
R19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVuYWJsZSB0byBzZXQgTERBUF9PUFRfWF9UTFNfSEFS
RCAoJXMpLiIsIG15bmFtZSwgbGRhcF9lcnIyc3RyaW5nIChyYykpOwoJCQlyZXR1cm4gTEFLX0ZB
SUw7CgkJfQoJfQoKCXJjID0gbGRhcF9zZXRfb3B0aW9uKHNlc3Npb24tPmxkLCBMREFQX09QVF9Q
Uk9UT0NPTF9WRVJTSU9OLCAmKHNlc3Npb24tPmNvbmYtPnZlcnNpb24pKTsKCWlmIChyYyAhPSBM
REFQX09QVF9TVUNDRVNTKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVu
YWJsZSB0byBzZXQgTERBUF9PUFRfUFJPVE9DT0xfVkVSU0lPTiAlZC4iLCBteW5hbWUsIHNlc3Np
b24tPmNvbmYtPnZlcnNpb24pOwoJCXNlc3Npb24tPmNvbmYtPnZlcnNpb24gPSBMREFQX1ZFUlNJ
T04yOwoJfQoKCXJjID0gbGRhcF9zZXRfb3B0aW9uKHNlc3Npb24tPmxkLCBMREFQX09QVF9ORVRX
T1JLX1RJTUVPVVQsICYoc2Vzc2lvbi0+Y29uZi0+dGltZW91dCkpOwoJaWYgKHJjICE9IExEQVBf
T1BUX1NVQ0NFU1MpIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxl
IHRvIHNldCBMREFQX09QVF9ORVRXT1JLX1RJTUVPVVQgJWQuJWQuIiwgbXluYW1lLCBzZXNzaW9u
LT5jb25mLT50aW1lb3V0LnR2X3NlYywgc2Vzc2lvbi0+Y29uZi0+dGltZW91dC50dl91c2VjKTsK
CX0KCglsZGFwX3NldF9vcHRpb24oc2Vzc2lvbi0+bGQsIExEQVBfT1BUX1RJTUVMSU1JVCwgJihz
ZXNzaW9uLT5jb25mLT50aW1lbGltaXQpKTsKCWlmIChyYyAhPSBMREFQX09QVF9TVUNDRVNTKSB7
CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVuYWJsZSB0byBzZXQgTERBUF9P
UFRfVElNRUxJTUlUICVkLiIsIG15bmFtZSwgc2Vzc2lvbi0+Y29uZi0+dGltZWxpbWl0KTsKCX0K
CglyYyA9IGxkYXBfc2V0X29wdGlvbihzZXNzaW9uLT5sZCwgTERBUF9PUFRfREVSRUYsICYoc2Vz
c2lvbi0+Y29uZi0+ZGVyZWYpKTsKCWlmIChyYyAhPSBMREFQX09QVF9TVUNDRVNTKSB7CgkJc3lz
bG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVuYWJsZSB0byBzZXQgTERBUF9PUFRfREVS
RUYgJWQuIiwgbXluYW1lLCBzZXNzaW9uLT5jb25mLT5kZXJlZik7Cgl9CgoJcmMgPSBsZGFwX3Nl
dF9vcHRpb24oc2Vzc2lvbi0+bGQsIExEQVBfT1BUX1JFRkVSUkFMUywgc2Vzc2lvbi0+Y29uZi0+
cmVmZXJyYWxzID8gTERBUF9PUFRfT04gOiBMREFQX09QVF9PRkYpOwoJaWYgKHJjICE9IExEQVBf
T1BUX1NVQ0NFU1MpIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxl
IHRvIHNldCBMREFQX09QVF9SRUZFUlJBTFMuIiwgbXluYW1lKTsKCX0KCglyYyA9IGxkYXBfc2V0
X29wdGlvbihzZXNzaW9uLT5sZCwgTERBUF9PUFRfU0laRUxJTUlULCAmKHNlc3Npb24tPmNvbmYt
PnNpemVsaW1pdCkpOwoJaWYgKHJjICE9IExEQVBfT1BUX1NVQ0NFU1MpCgkJc3lzbG9nKExPR19X
QVJOSU5HfExPR19BVVRILCAiJXM6IFVuYWJsZSB0byBzZXQgTERBUF9PUFRfU0laRUxJTUlUICVk
LiIsIG15bmFtZSwgc2Vzc2lvbi0+Y29uZi0+c2l6ZWxpbWl0KTsKCglyYyA9IGxkYXBfc2V0X29w
dGlvbihzZXNzaW9uLT5sZCwgTERBUF9PUFRfUkVTVEFSVCwgc2Vzc2lvbi0+Y29uZi0+cmVzdGFy
dCA/IExEQVBfT1BUX09OIDogTERBUF9PUFRfT0ZGKTsKCWlmIChyYyAhPSBMREFQX09QVF9TVUND
RVNTKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVuYWJsZSB0byBzZXQg
TERBUF9PUFRfUkVTVEFSVC4iLCBteW5hbWUpOwoJfQoKCS8qCgkgKiBTZXQgdXAgY2xpZW50LXNp
ZGUgY2FjaGluZwoJICovCglpZiAoc2Vzc2lvbi0+Y29uZi0+Y2FjaGVfZXhwaXJ5KSB7CgkJaWYg
KHNlc3Npb24tPmNvbmYtPnZlcmJvc2UpCgkJCXN5c2xvZyhMT0dfSU5GT3xMT0dfQVVUSCwgIiVz
OiBFbmFibGluZyAlbGQtYnl0ZSBjYWNoZSB3aXRoICVsZC1zZWNvbmQgZXhwaXJ5IiwgbXluYW1l
LCBzZXNzaW9uLT5jb25mLT5jYWNoZV9zaXplLCBzZXNzaW9uLT5jb25mLT5jYWNoZV9leHBpcnkp
OwoKCQlyYyA9IGxkYXBfZW5hYmxlX2NhY2hlKHNlc3Npb24tPmxkLCBzZXNzaW9uLT5jb25mLT5j
YWNoZV9leHBpcnksIHNlc3Npb24tPmNvbmYtPmNhY2hlX3NpemUpOwoJCWlmIChyYyAhPSBMREFQ
X1NVQ0NFU1MpIHsKCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IFVuYWJsZSB0
byBjb25maWd1cmUgY2FjaGU6ICVkICglcykgLS0gY29udGludWluZyIsIG15bmFtZSwgcmMsIGxk
YXBfZXJyMnN0cmluZyhyYykpOwoJCX0KCX0KCglyZXR1cm4gTEFLX09LOwp9CgoKc3RhdGljIGlu
dCBsYWtfcmVvcGVuX3Nlc3Npb24oTEFLX1NFU1NJT04gKnNlc3Npb24pCnsKCgkvKiBGWUk6IFYz
IGxldHMgdXMgYXZvaWQgZml2ZSB1bm5lZWRlZCBiaW5kcyBpbiBhIHBhc3N3b3JkIGNoYW5nZSAq
LwoJaWYgKHNlc3Npb24tPmNvbmYtPnZlcnNpb24gPT0gTERBUF9WRVJTSU9OMikgewoJCWlmIChz
ZXNzaW9uLT5sZCAhPSBOVUxMKSB7CgkJCWlmIChzZXNzaW9uLT5jb25mLT5jYWNoZV9leHBpcnkp
CgkJCQlsZGFwX2Rlc3Ryb3lfY2FjaGUoc2Vzc2lvbi0+bGQpOwoJCQlsZGFwX3VuYmluZF9zKHNl
c3Npb24tPmxkKTsKCgkJCXNlc3Npb24tPmxkID0gTlVMTDsKCQl9CgkJaWYgKHNlc3Npb24tPnVz
ZXIgIT0gTlVMTCkgewoJCQlzZXNzaW9uLT51c2VyLT5ib3VuZF9hc191c2VyID0gMDsKCQl9CgkJ
cmV0dXJuIGxha19vcGVuX3Nlc3Npb24oc2Vzc2lvbik7Cgl9CgoJcmV0dXJuIExBS19PSzsKfQoK
CnN0YXRpYyBpbnQgbGFrX2Nvbm5lY3RfYW5vbnltb3VzbHkoTEFLX1NFU1NJT04gKnNlc3Npb24p
CnsKCWNoYXIgICAqbXluYW1lID0gImxha19jb25uZWN0X2Fub255bW91c2x5IjsKCglpbnQgcmM7
CgoJaWYgKHNlc3Npb24tPmNvbmYtPnZlcmJvc2UpCgkJc3lzbG9nKExPR19JTkZPfExPR19BVVRI
LCAiJXM6IENvbm5lY3RpbmcgYW5vbnltb3VzbHkgdG8gJXMiLCBteW5hbWUsIHNlc3Npb24tPmNv
bmYtPnNlcnZlcnMpOwoKCWlmIChzZXNzaW9uLT5sZCA9PSBOVUxMKSB7CgkJcmMgPSBsYWtfb3Bl
bl9zZXNzaW9uIChzZXNzaW9uKTsKCQlpZiAocmMgIT0gTEFLX09LKQoJCQlyZXR1cm4gcmM7Cgl9
CgoJcmMgPSBsZGFwX3NpbXBsZV9iaW5kX3Moc2Vzc2lvbi0+bGQsIHNlc3Npb24tPmNvbmYtPmJp
bmRfZG4sIHNlc3Npb24tPmNvbmYtPmJpbmRfcHcpOwoJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykg
ewoJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIiVzOiBVbmFibGUgdG8gYmluZCBhcyAl
cyB0byAlczogJWQgKCVzKSIsIG15bmFtZSwgc2Vzc2lvbi0+Y29uZi0+YmluZF9kbiwgc2Vzc2lv
bi0+Y29uZi0+c2VydmVycywgcmMsIGxkYXBfZXJyMnN0cmluZyhyYykpOwoJCXJldHVybiBMQUtf
RkFJTDsKCX0KCglpZiAoc2Vzc2lvbi0+dXNlciAhPSBOVUxMKSB7CgkJc2Vzc2lvbi0+dXNlci0+
Ym91bmRfYXNfdXNlciA9IDA7Cgl9CgoJcmV0dXJuIExBS19PSzsKfQoKCnN0YXRpYyBpbnQgbGFr
X2Nvbm5lY3RfYXNfdXNlcihMQUtfU0VTU0lPTiAqc2Vzc2lvbiwgY29uc3QgY2hhciAqcGFzc3dv
cmQpCnsKCWNoYXIgICAqbXluYW1lID0gImxha19jb25uZWN0X2FzX3VzZXIiOwoKCWludCByYzsK
CglpZiAoc2Vzc2lvbi0+Y29uZi0+dmVyYm9zZSkKCQlzeXNsb2coTE9HX0lORk98TE9HX0FVVEgs
ICIlczogQ29ubmVjdGluZyBhcyAlcyB0byAlcyIsIG15bmFtZSwgc2Vzc2lvbi0+dXNlci0+ZG4s
IHNlc3Npb24tPmNvbmYtPnNlcnZlcnMpOwoKCS8qIHRoaXMgc2hvdWxkbid0IGV2ZXIgaGFwcGVu
ICovCglpZiAoc2Vzc2lvbi0+dXNlciA9PSBOVUxMKSB7CgkJcmV0dXJuIExBS19GQUlMOwoJfQoK
CS8qIGF2b2lkIGJpbmRpbmcgYW5vbnltb3VzbHkgd2l0aCBhIEROIGJ1dCBubyBwYXNzd29yZCAq
LwoJaWYgKHBhc3N3b3JkID09IE5VTEwgfHwgcGFzc3dvcmRbMF0gPT0gJ1wwJykgewoJCXJldHVy
biBMQUtfRkFJTDsKCX0KCglpZiAoc2Vzc2lvbi0+bGQgPT0gTlVMTCkgewoJCXJjID0gbGFrX29w
ZW5fc2Vzc2lvbiAoc2Vzc2lvbik7CgkJaWYgKHJjICE9IExBS19PSykKCQkJcmV0dXJuIHJjOwoJ
fQoKCXJjID0gbGRhcF9zaW1wbGVfYmluZF9zKHNlc3Npb24tPmxkLCBzZXNzaW9uLT51c2VyLT5k
biwgcGFzc3dvcmQpOwoJaWYgKHJjICE9IExEQVBfU1VDQ0VTUykgewoJCWlmIChzZXNzaW9uLT5j
b25mLT52ZXJib3NlKQoJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogVW5hYmxl
IHRvIGJpbmQgdG8gc2VydmVyICVzIGFzICVzOiAlZCAoJXMpIiwgbXluYW1lLCBzZXNzaW9uLT5j
b25mLT5zZXJ2ZXJzLCBzZXNzaW9uLT51c2VyLT5kbiwgcmMsIGxkYXBfZXJyMnN0cmluZyhyYykp
OwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglzZXNzaW9uLT51c2VyLT5ib3VuZF9hc191c2VyID0g
MTsKCglyZXR1cm4gTEFLX09LOwp9CgoKc3RhdGljIGludCBsYWtfc2VhcmNoKExBS19TRVNTSU9O
ICpzZXNzaW9uLCBjb25zdCBjaGFyICpmaWx0ZXIsIGNvbnN0IGNoYXIgKiphdHRycywgTERBUE1l
c3NhZ2UgKipyZXMpCnsKCWNoYXIgICAqbXluYW1lID0gImxha19zZWFyY2giOwoJaW50IHJjID0g
MDsKCgkqcmVzID0gTlVMTDsKCgkvKgoJKiBDb25uZWN0IHRvIHRoZSBMREFQIHNlcnZlciwgaWYg
bmVjZXNzYXJ5LgoJKi8KCWlmICghc2Vzc2lvbi0+Ym91bmQpIHsKCQlzeXNsb2coTE9HX1dBUk5J
Tkd8TE9HX0FVVEgsICIlczogTm8gZXhpc3RpbmcgY29ubmVjdGlvbiByZW9wZW5pbmciLCBteW5h
bWUpOwoKCQlpZiAoc2Vzc2lvbi0+bGQpIHsKCQkJaWYgKHNlc3Npb24tPmNvbmYtPnZlcmJvc2Up
CgkJCQlzeXNsb2coTE9HX0lORk98TE9HX0FVVEgsICIlczogQ2xvc2luZyBleGlzdGluZyBjb25u
ZWN0aW9uIiwgbXluYW1lKTsKCQkJaWYgKHNlc3Npb24tPmNvbmYtPmNhY2hlX2V4cGlyeSkKCQkJ
CWxkYXBfZGVzdHJveV9jYWNoZShzZXNzaW9uLT5sZCk7CgkJCQkKCQkJbGRhcF91bmJpbmRfcyhz
ZXNzaW9uLT5sZCk7CgoJCQlzZXNzaW9uLT5sZCA9IE5VTEw7CgkJfQoKCQlyYyA9IGxha19jb25u
ZWN0X2Fub255bW91c2x5KHNlc3Npb24pOwoJCWlmIChyYykgewoJCQlzeXNsb2coTE9HX1dBUk5J
Tkd8TE9HX0FVVEgsICIlczogKHJlKWNvbm5lY3QgYXR0ZW1wdCBmYWlsZWQiLCBteW5hbWUpOwoJ
CQlyZXR1cm4gTEFLX0ZBSUw7CgkJfQoKCQlzZXNzaW9uLT5ib3VuZCA9IDE7Cgl9IAoKCS8qCgkq
IE9uIHRvIHRoZSBzZWFyY2guCgkqLwoJcmMgPSBsZGFwX3NlYXJjaF9zdChzZXNzaW9uLT5sZCwg
c2Vzc2lvbi0+Y29uZi0+c2VhcmNoX2Jhc2UsIHNlc3Npb24tPmNvbmYtPnNjb3BlLCBmaWx0ZXIs
IChjaGFyICoqKSBhdHRycywgMCwgJihzZXNzaW9uLT5jb25mLT50aW1lb3V0KSwgcmVzKTsKCXN3
aXRjaCAocmMpIHsKCQljYXNlIExEQVBfU1VDQ0VTUzoKCQljYXNlIExEQVBfU0laRUxJTUlUX0VY
Q0VFREVEOgoJCQlicmVhazsKCgkJZGVmYXVsdDoKCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19B
VVRILCAiJXM6IGxkYXBfc2VhcmNoX3N0KCkgZmFpbGVkOiAlcyIsIG15bmFtZSwgbGRhcF9lcnIy
c3RyaW5nKHJjKSk7CgkJCWxkYXBfbXNnZnJlZSgqcmVzKTsKCQkJc2Vzc2lvbi0+Ym91bmQgPSAw
OwoJCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJaWYgKChsZGFwX2NvdW50X2VudHJpZXMoc2Vzc2lv
bi0+bGQsICpyZXMpKSAhPSAxKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6
IG9iamVjdCBub3QgZm91bmQgb3IgZ290IGFtYmlndW91cyBzZWFyY2ggcmVzdWx0LiIsIG15bmFt
ZSk7CgkJbGRhcF9tc2dmcmVlKCpyZXMpOwoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglyZXR1cm4g
TEFLX09LOwp9CgoKc3RhdGljIHZvaWQgbGFrX3JlbGVhc2VfdXNlcihMQUtfVVNFUiAqKnB1c2Vy
KQp7CglMQUtfVVNFUiAqdXNlcjsKCgl1c2VyID0gKnB1c2VyOwoKCWlmICh1c2VyID09IE5VTEwp
IHsKCQlyZXR1cm47Cgl9CgoJaWYgKHVzZXItPm5hbWUgIT0gTlVMTCkgewoJCWZyZWUgKHVzZXIt
Pm5hbWUpOwoJfQoKCWlmICh1c2VyLT5yZWFsbSAhPSBOVUxMKSB7CgkJZnJlZSAodXNlci0+cmVh
bG0pOwoJfQoKCWlmICh1c2VyLT5kbiAhPSBOVUxMKSB7CgkJbGRhcF9tZW1mcmVlKHVzZXItPmRu
KTsKCX0KCglmcmVlICh1c2VyKTsKCSpwdXNlciA9IE5VTEw7CgoJcmV0dXJuOwp9CgoKc3RhdGlj
IHZvaWQgbGFrX3JlbGVhc2VfY29uZmlnKExBS19DT05GICoqcGNvbmYpIAp7CglMQUtfQ09ORiAq
Y29uZjsKCgljb25mID0gKnBjb25mOwoKCWlmIChjb25mID09IE5VTEwpIHsKCQlyZXR1cm47Cgl9
CgoJaWYgKGNvbmYtPnBhdGggIT0gTlVMTCkgewoJCWZyZWUoY29uZi0+cGF0aCk7Cgl9CgojaWYg
MAoJaWYgKGNvbmYtPnNlcnZlcnMgIT0gTlVMTCkgewoJCWZyZWUoY29uZi0+c2VydmVycyk7Cgl9
CgkKCWlmIChjb25mLT5iaW5kX2RuICE9IE5VTEwpIHsKCQlmcmVlKGNvbmYtPmJpbmRfZG4pOwoJ
fQoKCWlmIChjb25mLT5iaW5kX3B3ICE9IE5VTEwpIHsKCQlmcmVlKGNvbmYtPmJpbmRfcHcpOwoJ
fQoKCWlmIChjb25mLT5zZWFyY2hfYmFzZSAhPSBOVUxMKSB7CgkJZnJlZShjb25mLT5zZWFyY2hf
YmFzZSk7Cgl9CgoJaWYgKGNvbmYtPmZpbHRlciAhPSBOVUxMKSB7CgkJZnJlZShjb25mLT5maWx0
ZXIpOwoJfQojZW5kaWYKCWZyZWUoY29uZmlnbGlzdCk7CgoJZnJlZSAoY29uZik7CgkqcGNvbmYg
PSBOVUxMOwoKCXJldHVybjsKfQoKCi8qIAogKiBsYWtfcmV0cmlldmUgLSByZXRyaWV2ZSB1c2Vy
QHJlYWxtIHZhbHVlcyBzcGVjaWZpZWQgYnkgJ2F0dHJzJwogKi8Kc3RhdGljIGludCBsYWtfcmV0
cmlldmUoTEFLX1NFU1NJT04gKnNlc3Npb24sIGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIg
KnJlYWxtLCBjb25zdCBjaGFyICoqYXR0cnMsIExBSyAqKnJlc3VsdCkKewoJY2hhciAgICpteW5h
bWUgPSAibGFrX3JldHJpZXZlIjsKCglpbnQgcmMgPSAwOwoJY2hhciAqZmlsdGVyID0gTlVMTDsK
CUxBSyAqcHRyID0gTlVMTCwgKnRlbXAgPSBOVUxMOwoJTERBUE1lc3NhZ2UgKnJlczsKCUxEQVBN
ZXNzYWdlICplbnRyeTsKCUJlckVsZW1lbnQgKmJlcjsKCWNoYXIgKmF0dHIsICp2YWw7CiAgICAK
ICAgIAkqcmVzdWx0ID0gTlVMTDsKCglyYyA9IGxha19maWx0ZXIoc2Vzc2lvbiwgdXNlciwgcmVh
bG0sICZmaWx0ZXIpOwoJaWYgKHJjICE9IExBS19PSykgewoJCXN5c2xvZyhMT0dfV0FSTklOR3xM
T0dfQVVUSCwgIiVzOiBsYWtfZmlsdGVyIGZhaWxlZC4iLCBteW5hbWUpOwoJCXJldHVybiBMQUtf
RkFJTDsKCX0KCglyYyA9IGxha19zZWFyY2goc2Vzc2lvbiwgZmlsdGVyLCBhdHRycywgJnJlcyk7
CglpZiAocmMgIT0gTEFLX09LKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6
IGxha19zZWFyY2ggZmFpbGVkLiIsIG15bmFtZSk7CgkJZnJlZShmaWx0ZXIpOwoJCXJldHVybiBM
QUtfRkFJTDsKCX0KCgllbnRyeSA9IGxkYXBfZmlyc3RfZW50cnkoc2Vzc2lvbi0+bGQsIHJlcyk7
IAoJaWYgKGVudHJ5ID09IE5VTEwpIHsKCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIl
czogbGRhcF9maXJzdF9lbnRyeSgpIGZhaWxlZC4iLCBteW5hbWUpOwoJCWZyZWUoZmlsdGVyKTsK
CQlsZGFwX21zZ2ZyZWUocmVzKTsKCQlyZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJYXR0ciA9IGxkYXBf
Zmlyc3RfYXR0cmlidXRlKHNlc3Npb24tPmxkLCBlbnRyeSwgJmJlcik7CglpZiAoYXR0ciA9PSBO
VUxMKSB7CgkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IG5vIGF0dHJpYnV0ZXMg
Zm91bmQiLCBteW5hbWUpOwoJCWZyZWUoZmlsdGVyKTsKCQlsZGFwX21zZ2ZyZWUocmVzKTsKCQly
ZXR1cm4gTEFLX0ZBSUw7Cgl9CgoJd2hpbGUgKGF0dHIgIT0gTlVMTCkgewoKCQlyYyA9IGxha19n
ZXRfc3RyaW5nX3ZhbHVlKHNlc3Npb24tPmxkLCBlbnRyeSwgYXR0ciwgJnZhbCk7CgkJaWYgKHJj
ID09IExBS19PSykgewoJCQl0ZW1wID0gKExBSyAqKSBtYWxsb2Moc2l6ZW9mKExBSykpOwoJCQlp
ZiAodGVtcCA9PSBOVUxMKSB7CgkJCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgIiVzOiBDYW5u
b3QgYWxsb2NhdGUgbWVtb3J5IiwgbXluYW1lKTsKCQkJCWxkYXBfbWVtZnJlZShhdHRyKTsKCQkJ
CWxha19mcmVlX3Jlc3VsdCgqcmVzdWx0KTsKCQkJCXJjID0gTEFLX0ZBSUw7CgkJCQlnb3RvIGRv
bmU7CgkJCX0KCgkJCWlmICgqcmVzdWx0ID09IE5VTEwpIHsKCQkJCSpyZXN1bHQgPSB0ZW1wOwoJ
CQkJcHRyID0gKnJlc3VsdDsKCQkJfQoJCQllbHNlIHsKCQkJCXB0ci0+bmV4dCA9IHRlbXA7CgkJ
CQlwdHIgPSB0ZW1wOwoJCQl9CgkJCXB0ci0+YXR0cmlidXRlID0gKGNoYXIgKilzdHJkdXAoYXR0
cik7CgkJCWlmIChwdHItPmF0dHJpYnV0ZSA9PSBOVUxMKSB7CgkJCQlzeXNsb2coTE9HX0VSUnxM
T0dfQVVUSCwgIiVzOiBzdHJkdXAoKSBmYWlsZWQiLCBteW5hbWUpOwoJCQkJbGRhcF9tZW1mcmVl
KGF0dHIpOwoJCQkJbGFrX2ZyZWVfcmVzdWx0KCpyZXN1bHQpOwoJCQkJcmMgPSBMQUtfRkFJTDsK
CQkJCWdvdG8gZG9uZTsKCQkJfQoJCQlwdHItPnZhbHVlID0gdmFsOwoJCQlwdHItPmxlbiA9IHN0
cmxlbihwdHItPnZhbHVlKTsKCQkJcHRyLT5uZXh0ID0gTlVMTDsKCgkJCWlmIChzZXNzaW9uLT5j
b25mLT52ZXJib3NlKQoJCQkJc3lzbG9nKExPR19JTkZPfExPR19BVVRILCAiJXM6IEF0dHJpYnV0
ZSAlcywgVmFsdWUgJXMiLCBteW5hbWUsIHB0ci0+YXR0cmlidXRlLCBwdHItPnZhbHVlKTsKCQl9
IGVsc2UgewoJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICIlczogRW50cnkgJXMgaGFz
IG5vIHZhbHVlLiIsIG15bmFtZSwgYXR0cik7CgkJfQoKCQlsZGFwX21lbWZyZWUoYXR0cik7CgoJ
CWF0dHIgPSBsZGFwX25leHRfYXR0cmlidXRlKHNlc3Npb24tPmxkLCBlbnRyeSwgYmVyKTsKCX0K
CXJjID0gTEFLX09LOwoKZG9uZToKCWlmIChiZXIgIT0gTlVMTCkKCQliZXJfZnJlZShiZXIsIDAp
OwoJbGRhcF9tc2dmcmVlKHJlcyk7CglmcmVlKGZpbHRlcik7CgoJaWYgKCpyZXN1bHQgPT0gTlVM
TCkKCQlyZXR1cm4gTEFLX05PRU5UOwoKCXJldHVybiByYzsKfQoKCnN0YXRpYyBpbnQgbGFrX2Jp
bmRfYXV0aGVudGljYXRlKExBS19TRVNTSU9OICpzZXNzaW9uLCBjb25zdCBjaGFyICp1c2VyLCBj
b25zdCBjaGFyICpyZWFsbSwgY29uc3QgY2hhciAqcGFzc3dvcmQpIAp7CglpbnQgcmMgPSBMQUtf
T0s7CgoJaWYgKHNlc3Npb24tPnVzZXIgPT0gTlVMTCkgewoJCXJjID0gbGFrX2dldF91c2VyKHNl
c3Npb24sIHVzZXIsIHJlYWxtKTsKCQlpZiAocmMgIT0gTEFLX09LKQoJCQlyZXR1cm4gcmM7Cgl9
CgoJcmMgPSBsYWtfcmVvcGVuX3Nlc3Npb24oc2Vzc2lvbik7CglpZiAocmMgIT0gTEFLX09LKSB7
CgkJcmV0dXJuIHJjOwoJfQoKCXJjID0gbGFrX2Nvbm5lY3RfYXNfdXNlcihzZXNzaW9uLCBwYXNz
d29yZCk7CglsYWtfcmVsZWFzZV91c2VyKCZzZXNzaW9uLT51c2VyKTsKCWxha19yZW9wZW5fc2Vz
c2lvbihzZXNzaW9uKTsKCWxha19jb25uZWN0X2Fub255bW91c2x5KHNlc3Npb24pOwoKCXJldHVy
biByYzsKfQoKCnN0YXRpYyBpbnQgbGFrX2N1c3RvbV9hdXRoZW50aWNhdGUoTEFLX1NFU1NJT04g
KnNlc3Npb24sIGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnJlYWxtLCBjb25zdCBjaGFy
ICpwYXNzd29yZCkgCnsKCWNoYXIgICAqbXluYW1lID0gImxha19jdXN0b21fYXV0aGVudGljYXRl
IjsKCglMQUsgKmxyZXM7CglpbnQgcmM7CgljaGFyICplbmQsICp0ZW1wLCAqcHRyOwoJY29uc3Qg
Y2hhciAqYXR0cnNbXSA9IHsidXNlclBhc3N3b3JkIiwgTlVMTH07CgoJcmMgPSBsYWtfcmV0cmll
dmUoc2Vzc2lvbiwgdXNlciwgcmVhbG0sIGF0dHJzLCAmbHJlcyk7CglpZiAocmMgIT0gTEFLX09L
KSB7CgkJaWYgKHNlc3Npb24tPmNvbmYtPnZlcmJvc2UpIHsKCQkJc3lzbG9nKExPR19XQVJOSU5H
fExPR19BVVRILCAiJXM6IFVzZXIgbm90IGZvdW5kICVzIiwgbXluYW1lLCB1c2VyKTsKCQl9CgkJ
cmV0dXJuIExBS19GQUlMOwoJfQoKCXJjID0gTEFLX0ZBSUw7CgoJcHRyID0gbHJlcy0+dmFsdWU7
CgllbmQgPSAoY2hhciAqKSBwdHIgKyBscmVzLT5sZW47CgoJdGVtcCA9IChjaGFyICopIHN0cmNo
cihwdHIsICd9Jyk7CgoJaWYgKCh0ZW1wICE9IE5VTEwpICYmICh0ZW1wIDwgZW5kKSkgewoJCWlm
ICghc3RybmNhc2VjbXAocHRyLCAie2NyeXB0fSIsIHRlbXAgLSBwdHIgKyAxKSkgewoJCQlpZiAo
IXN0cmNtcChwdHIrNywgKGNoYXIgKiljcnlwdChwYXNzd29yZCwgcHRyKzcpKSkKCQkJCXJjID0g
TEFLX09LOwoJCX0KCQllbHNlIGlmICghc3RybmNhc2VjbXAocHRyLCAie2NsZWFyfSIsIHRlbXAg
LSBwdHIgKyAxKSkgewoJCQlpZiAoIXN0cmNtcChwdHIrNywgcGFzc3dvcmQpKQoJCQkJcmMgPSBM
QUtfT0s7CgkJfQoJCS8qIEFkZCBNRDUsIFNIQSBhbmQgb3RoZXJzICovCgkJZWxzZSB7CgkJCXN5
c2xvZyhMT0dfV0FSTklOR3xMT0dfQVVUSCwgIiVzOiBVbmtub3duIHBhc3N3b3JkIGVuY3J5cHRp
b24gZm9yICVzIiwgbXluYW1lLCB1c2VyKTsKCQl9Cgl9CgoJbGFrX2ZyZWVfcmVzdWx0KGxyZXMp
OwoKCXJldHVybihyYyk7Cn0KCgpzdGF0aWMgdm9pZCBsYWtfY2xvc2Vfc2Vzc2lvbihMQUtfU0VT
U0lPTiAqKnBzZXNzaW9uKSAKewoKCUxBS19TRVNTSU9OICpzZXNzaW9uOwoKCXNlc3Npb24gPSAq
cHNlc3Npb247CgoJaWYgKHNlc3Npb24gPT0gTlVMTCkgewoJCXJldHVybjsKCX0KCglpZiAoc2Vz
c2lvbi0+bGQgIT0gTlVMTCkgewoJCWlmIChzZXNzaW9uLT5jb25mLT5jYWNoZV9leHBpcnkpCgkJ
CWxkYXBfZGVzdHJveV9jYWNoZShzZXNzaW9uLT5sZCk7CgkJbGRhcF91bmJpbmRfcyhzZXNzaW9u
LT5sZCk7Cgl9CgoJbGFrX3JlbGVhc2VfdXNlcigmc2Vzc2lvbi0+dXNlcik7CglsYWtfcmVsZWFz
ZV9jb25maWcoJnNlc3Npb24tPmNvbmYpOwoKCWZyZWUoc2Vzc2lvbik7CgkqcHNlc3Npb24gPSBO
VUxMOwoKCXJldHVybjsKfQoKCmludCBsYWtfYXV0aGVudGljYXRlKGNvbnN0IGNoYXIgKnVzZXIs
IGNvbnN0IGNoYXIgKnJlYWxtLCBjb25zdCBjaGFyICpwYXNzd29yZCwgY29uc3QgY2hhciAqY29u
ZmlnRmlsZSkgCnsKCWNoYXIgICAqbXluYW1lID0gImxha19hdXRoZW50aWNhdGUiOwoKCUxBS19T
RVNTSU9OICpzZXNzaW9uOwoJaW50IHJjOwoKCXNlc3Npb24gPSBwZXJzaXN0ZW50X3Nlc3Npb247
CgoJaWYgKHNlc3Npb24gPT0gTlVMTCkgewoJCXJjID0gbGFrX2dldF9zZXNzaW9uKCZzZXNzaW9u
LCBjb25maWdGaWxlKTsKCQlpZiAocmMgIT0gTEFLX09LKSB7CgkJCXN5c2xvZyhMT0dfV0FSTklO
R3xMT0dfQVVUSCwgIiVzOiBsYWtfZ2V0X3Nlc3Npb24gZmFpbGVkLiIsIG15bmFtZSk7CgkJCXJl
dHVybiBMQUtfRkFJTDsKCQl9CgkJcGVyc2lzdGVudF9zZXNzaW9uID0gc2Vzc2lvbjsKCX0KCglp
ZiAoc2Vzc2lvbi0+Y29uZi0+YXV0aF9tZXRob2QgPT0gTEFLX0FVVEhfTUVUSE9EX0JJTkQpIHsK
CQlyYyA9IGxha19iaW5kX2F1dGhlbnRpY2F0ZShzZXNzaW9uLCB1c2VyLCByZWFsbSwgcGFzc3dv
cmQpOwoJfSBlbHNlIHsKCQlyYyA9IGxha19jdXN0b21fYXV0aGVudGljYXRlKHNlc3Npb24sIHVz
ZXIsIHJlYWxtLCBwYXNzd29yZCk7Cgl9CgoJcmV0dXJuIHJjOwp9CgoKaW50IGxha19sb29rdXBf
YXR0cmliKGNvbnN0IGNoYXIgKnVzZXIsIGNvbnN0IGNoYXIgKnJlYWxtLCBjb25zdCBjaGFyICpj
b25maWdGaWxlLCBMQUsgKipyZXN1bHQpIAp7CgljaGFyICAgKm15bmFtZSA9ICJsYWtfbG9va3Vw
X2F0dHJpYiI7CgoJTEFLX1NFU1NJT04gKnNlc3Npb247CglMQUsgKmxyZXM7CgljaGFyICphdHRy
c1syXTsKCWludCByYzsKCglzZXNzaW9uID0gcGVyc2lzdGVudF9zZXNzaW9uOwoKCWlmIChzZXNz
aW9uID09IE5VTEwpIHsKCQlyYyA9IGxha19nZXRfc2Vzc2lvbigmc2Vzc2lvbiwgY29uZmlnRmls
ZSk7CgkJaWYgKHJjICE9IExBS19PSykgewoJCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgs
ICIlczogbGFrX2dldF9zZXNzaW9uIGZhaWxlZC4iLCBteW5hbWUpOwoJCQlyZXR1cm4gTEFLX0ZB
SUw7CgkJfQoJCXBlcnNpc3RlbnRfc2Vzc2lvbiA9IHNlc3Npb247Cgl9CgoJaWYgKHNlc3Npb24t
PmNvbmYtPmxvb2t1cF9hdHRyaWIgPT0gTlVMTCkgewoJCXJldHVybiBMQUtfRkFJTDsKCX0KCglh
dHRyc1swXSA9IHNlc3Npb24tPmNvbmYtPmxvb2t1cF9hdHRyaWI7CglhdHRyc1sxXSA9IE5VTEw7
CgoJcmMgPSBsYWtfcmV0cmlldmUoc2Vzc2lvbiwgdXNlciwgcmVhbG0sIChjb25zdCBjaGFyICoq
KWF0dHJzLCAmbHJlcyk7CglpZiAocmMgIT0gTEFLX09LKSB7CgkJaWYgKHNlc3Npb24tPmNvbmYt
PnZlcmJvc2UpIHsKCQkJc3lzbG9nKExPR19XQVJOSU5HfExPR19BVVRILCAiJXM6IEF0dHJpYnV0
ZSBub3QgZm91bmQuIiwgbXluYW1lKTsKCQl9CgkJcmV0dXJuIExBS19GQUlMOwoJfQoKCSpyZXN1
bHQgPSBscmVzOwoKCXJldHVybiBMQUtfT0s7Cn0KCgovKiAKICogbGFrX2ZyZWVfcmVzdWx0IC0g
ZnJlZSBtZW1vcnkgYnVmZmVycwogKi8Kdm9pZCBsYWtfZnJlZV9yZXN1bHQoTEFLICpyZXN1bHQp
IAp7CgkvKiBjaGFyICAgKm15bmFtZSA9ICJsYWtfZnJlZV9yZXN1bHQiOyAqLwoKCWlmIChyZXN1
bHQgPT0gTlVMTCkKCQlyZXR1cm47CgoJaWYgKHJlc3VsdC0+bmV4dCAhPSBOVUxMKSB7CgkJbGFr
X2ZyZWVfcmVzdWx0KHJlc3VsdC0+bmV4dCk7Cgl9CgoJZnJlZShyZXN1bHQtPmF0dHJpYnV0ZSk7
CQoJZnJlZShyZXN1bHQtPnZhbHVlKTsJCglmcmVlKHJlc3VsdCk7CgoJcmV0dXJuOwp9CgoKI2Vu
ZGlmIC8qIEFVVEhfTERBUCAqLwoAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAbGFrLmgA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAxMDA2NDQAMDAwMDAwMAAwMDAw
MDAxADAwMDAwMDA1NjQ1ADA3NDcxMDA1NjczADAxMDY1NwAgMAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB1c3RhciAgAHJvb3QAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAb3RoZXIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAvKiBDT1BZ
UklHSFQKICogQ29weXJpZ2h0IChjKSAyMDAyLTIwMDIgSWdvciBCcmV6YWMKICogQWxsIHJpZ2h0
cyByZXNlcnZlZC4KICoKICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBzb3VyY2UgYW5kIGJp
bmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0CiAqIG1vZGlmaWNhdGlvbiwgYXJlIHBlcm1pdHRl
ZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucwogKiBhcmUgbWV0OgogKiAx
LiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRhaW4gdGhlIGFib3ZlIGNv
cHlyaWdodAogKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9s
bG93aW5nIGRpc2NsYWltZXIuCiAqIDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBiaW5hcnkgZm9ybSBt
dXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0CiAqICAgIG5vdGljZSwgdGhpcyBsaXN0
IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBpbiB0aGUKICogICAg
ZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVkIHdpdGggdGhlIGRp
c3RyaWJ1dGlvbi4KICoKICogVEhJUyBTT0ZUV0FSRSBJUyBQUk9WSURFRCBCWSBJR09SIEJSRVpB
Qy4gYGBBUyBJUycnIEFORCBBTlkKICogRVhQUkVTUyBPUiBJTVBMSUVEIFdBUlJBTlRJRVMsIElO
Q0xVRElORywgQlVUIE5PVCBMSU1JVEVEIFRPLCBUSEUKICogSU1QTElFRCBXQVJSQU5USUVTIE9G
IE1FUkNIQU5UQUJJTElUWSBBTkQgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSCiAqIFBVUlBPU0Ug
QVJFIERJU0NMQUlNRUQuICBJTiBOTyBFVkVOVCBTSEFMTCBJR09SIEJSRVpBQyBPUgogKiBJVFMg
RU1QTE9ZRUVTIE9SIEFHRU5UUyBCRSBMSUFCTEUgRk9SIEFOWSBESVJFQ1QsIElORElSRUNULAog
KiBJTkNJREVOVEFMLCBTUEVDSUFMLCBFWEVNUExBUlksIE9SIENPTlNFUVVFTlRJQUwgREFNQUdF
UyAoSU5DTFVESU5HLAogKiBCVVQgTk9UIExJTUlURUQgVE8sIFBST0NVUkVNRU5UIE9GIFNVQlNU
SVRVVEUgR09PRFMgT1IgU0VSVklDRVM7IExPU1MKICogT0YgVVNFLCBEQVRBLCBPUiBQUk9GSVRT
OyBPUiBCVVNJTkVTUyBJTlRFUlJVUFRJT04pIEhPV0VWRVIgQ0FVU0VEIEFORAogKiBPTiBBTlkg
VEhFT1JZIE9GIExJQUJJTElUWSwgV0hFVEhFUiBJTiBDT05UUkFDVCwgU1RSSUNUIExJQUJJTElU
WSwgT1IKICogVE9SVCAoSU5DTFVESU5HIE5FR0xJR0VOQ0UgT1IgT1RIRVJXSVNFKSBBUklTSU5H
IElOIEFOWSBXQVkgT1VUIE9GIFRIRQogKiBVU0UgT0YgVEhJUyBTT0ZUV0FSRSwgRVZFTiBJRiBB
RFZJU0VEIE9GIFRIRSBQT1NTSUJJTElUWSBPRiBTVUNICiAqIERBTUFHRS4KICogRU5EIENPUFlS
SUdIVCAqLwoKI2lmbmRlZiBfTEFLX0gKI2RlZmluZSBfTEFLX0gKCiNpbmNsdWRlIDxsZGFwLmg+
CiNpbmNsdWRlIDxsYmVyLmg+CgojaWYgVElNRV9XSVRIX1NZU19USU1FCiMgaW5jbHVkZSA8c3lz
L3RpbWUuaD4KIyBpbmNsdWRlIDx0aW1lLmg+CiNlbHNlCiMgaWYgSEFWRV9TWVNfVElNRV9ICiMg
IGluY2x1ZGUgPHN5cy90aW1lLmg+CiMgZWxzZQojICBpbmNsdWRlIDx0aW1lLmg+CiMgZW5kaWYK
I2VuZGlmCgojZGVmaW5lIExBS19PSyAwCiNkZWZpbmUgTEFLX0ZBSUwgLTEKI2RlZmluZSBMQUtf
Tk9FTlQgLTIKCiNkZWZpbmUgTEFLX0FVVEhfTUVUSE9EX0JJTkQgMAojZGVmaW5lIExBS19BVVRI
X01FVEhPRF9DVVNUT00gMQoKdHlwZWRlZiBzdHJ1Y3QgbGFrX2NvbmYgewogICAgY2hhciAgICpw
YXRoOwogICAgY2hhciAgICpzZXJ2ZXJzOwogICAgY2hhciAgICpiaW5kX2RuOwogICAgY2hhciAg
ICpiaW5kX3B3OwogICAgaW50ICAgICB2ZXJzaW9uOwogICAgc3RydWN0ICB0aW1ldmFsIHRpbWVv
dXQ7CiAgICBpbnQgICAgIHNpemVsaW1pdDsKICAgIGludCAgICAgdGltZWxpbWl0OwogICAgaW50
ICAgICBkZXJlZjsKICAgIGludCAgICAgcmVmZXJyYWxzOwogICAgaW50ICAgICByZXN0YXJ0Owog
ICAgbG9uZyAgICBjYWNoZV9leHBpcnk7CiAgICBsb25nICAgIGNhY2hlX3NpemU7CiAgICBpbnQg
ICAgIHNjb3BlOwogICAgY2hhciAgICpzZWFyY2hfYmFzZTsKICAgIGNoYXIgICAqZmlsdGVyOwog
ICAgY2hhciAgICpsb29rdXBfYXR0cmliOwogICAgY2hhciAgICBhdXRoX21ldGhvZDsKICAgIGlu
dCAgICAgZGVidWc7CiAgICBpbnQgICAgIHZlcmJvc2U7CiAgICBpbnQgICAgIHNzbDsKICAgIGlu
dCAgICAgc3RhcnRfdGxzOwogICAgaW50ICAgICB0bHNfY2hlY2twZWVyOwogICAgY2hhciAgICp0
bHNfY2FjZXJ0ZmlsZTsKICAgIGNoYXIgICAqdGxzX2NhY2VydGRpcjsKICAgIGNoYXIgICAqdGxz
X2NpcGhlcnM7CiAgICBjaGFyICAgKnRsc19jZXJ0OwogICAgY2hhciAgICp0bHNfa2V5Owp9IExB
S19DT05GOwoKdHlwZWRlZiBzdHJ1Y3QgbGFrX3VzZXIgewogICAgY2hhciAgICAqbmFtZTsKICAg
IGNoYXIgICAgKnJlYWxtOwogICAgY2hhciAgICAqZG47CiAgICBjaGFyICAgICBib3VuZF9hc191
c2VyOwp9IExBS19VU0VSOwoKdHlwZWRlZiBzdHJ1Y3QgbGFrX3Nlc3Npb24gewogICAgTERBUCAg
ICAgKmxkOwogICAgY2hhciAgICAgIGJvdW5kOwogICAgTEFLX0NPTkYgKmNvbmY7CiAgICBMQUtf
VVNFUiAqdXNlcjsKfSBMQUtfU0VTU0lPTjsKCnR5cGVkZWYgc3RydWN0IGxhayB7CiAgICBjaGFy
ICAgICAgICphdHRyaWJ1dGU7CiAgICBjaGFyICAgICAgICp2YWx1ZTsKICAgIHNpemVfdCAgICAg
IGxlbjsKICAgIHN0cnVjdCBsYWsgKm5leHQ7Cn0gTEFLOwoKaW50IGxha19hdXRoZW50aWNhdGUo
Y29uc3QgY2hhciAqLCBjb25zdCBjaGFyICosIGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqKTsK
aW50IGxha19sb29rdXBfYXR0cmliKGNvbnN0IGNoYXIgKiwgY29uc3QgY2hhciAqLCBjb25zdCBj
aGFyICosIExBSyAqKik7CnZvaWQgbGFrX2ZyZWVfcmVzdWx0KExBSyAqKTsKCiNlbmRpZiAgLyog
X0xBS19IICovCgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABhdXRoX2xkYXAuYwAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMDEwMDY0NAAwMDAwMDAwADAwMDAwMDEAMDAw
MDAwMDUyMDEAMDc0NzA3NTY3NDYAMDEyMDQ1ACAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAHVzdGFyICAAcm9vdAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABv
dGhlcgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAC8qIE1PRFVMRTogYXV0
aF9sZGFwICovCi8qIENPUFlSSUdIVAogKiBDb3B5cmlnaHQgKGMpIDIwMDItMjAwMiBJZ29yIEJy
ZXphYwogKiBBbGwgcmlnaHRzIHJlc2VydmVkLgogKgogKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNl
IGluIHNvdXJjZSBhbmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQKICogbW9kaWZpY2F0
aW9uLCBhcmUgcGVybWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25z
CiAqIGFyZSBtZXQ6CiAqIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJl
dGFpbiB0aGUgYWJvdmUgY29weXJpZ2h0CiAqICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRp
dGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4KICogMi4gUmVkaXN0cmlidXRpb25z
IGluIGJpbmFyeSBmb3JtIG11c3QgcmVwcm9kdWNlIHRoZSBhYm92ZSBjb3B5cmlnaHQKICogICAg
bm90aWNlLCB0aGlzIGxpc3Qgb2YgY29uZGl0aW9ucyBhbmQgdGhlIGZvbGxvd2luZyBkaXNjbGFp
bWVyIGluIHRoZQogKiAgICBkb2N1bWVudGF0aW9uIGFuZC9vciBvdGhlciBtYXRlcmlhbHMgcHJv
dmlkZWQgd2l0aCB0aGUgZGlzdHJpYnV0aW9uLgogKgogKiBUSElTIFNPRlRXQVJFIElTIFBST1ZJ
REVEIEJZIElHT1IgQlJFWkFDLiBgYEFTIElTJycgQU5EIEFOWQogKiBFWFBSRVNTIE9SIElNUExJ
RUQgV0FSUkFOVElFUywgSU5DTFVESU5HLCBCVVQgTk9UIExJTUlURUQgVE8sIFRIRQogKiBJTVBM
SUVEIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZIEFORCBGSVRORVNTIEZPUiBBIFBBUlRJ
Q1VMQVIKICogUFVSUE9TRSBBUkUgRElTQ0xBSU1FRC4gIElOIE5PIEVWRU5UIFNIQUxMIElHT1Ig
QlJFWkFDIE9SCiAqIElUUyBFTVBMT1lFRVMgT1IgQUdFTlRTIEJFIExJQUJMRSBGT1IgQU5ZIERJ
UkVDVCwgSU5ESVJFQ1QsCiAqIElOQ0lERU5UQUwsIFNQRUNJQUwsIEVYRU1QTEFSWSwgT1IgQ09O
U0VRVUVOVElBTCBEQU1BR0VTIChJTkNMVURJTkcsCiAqIEJVVCBOT1QgTElNSVRFRCBUTywgUFJP
Q1VSRU1FTlQgT0YgU1VCU1RJVFVURSBHT09EUyBPUiBTRVJWSUNFUzsgTE9TUwogKiBPRiBVU0Us
IERBVEEsIE9SIFBST0ZJVFM7IE9SIEJVU0lORVNTIElOVEVSUlVQVElPTikgSE9XRVZFUiBDQVVT
RUQgQU5ECiAqIE9OIEFOWSBUSEVPUlkgT0YgTElBQklMSVRZLCBXSEVUSEVSIElOIENPTlRSQUNU
LCBTVFJJQ1QgTElBQklMSVRZLCBPUgogKiBUT1JUIChJTkNMVURJTkcgTkVHTElHRU5DRSBPUiBP
VEhFUldJU0UpIEFSSVNJTkcgSU4gQU5ZIFdBWSBPVVQgT0YgVEhFCiAqIFVTRSBPRiBUSElTIFNP
RlRXQVJFLCBFVkVOIElGIEFEVklTRUQgT0YgVEhFIFBPU1NJQklMSVRZIE9GIFNVQ0gKICogREFN
QUdFLgogKiBFTkQgQ09QWVJJR0hUICovCgovKiBTWU5PUFNJUwogKiBBdXRoZW50aWNhdGUgYWdh
aW5zdCBMREFQLgogKiBFTkQgU1lOT1BTSVMgKi8KCiNpZmRlZiBfX0dOVUNfXwojaWRlbnQgIiRJ
ZDogYXV0aF9sZGFwLmMsdiAxLjggMjAwMi8wNS8wOCAyMTo0ODoxMSByanMzIEV4cCAkIgojZW5k
aWYKCi8qIFBVQkxJQyBERVBFTkRFTkNJRVMgKi8KI2luY2x1ZGUgPHN0ZGxpYi5oPgojaW5jbHVk
ZSA8c3RyaW5nLmg+CiNpbmNsdWRlIDxzeXNsb2cuaD4KI2luY2x1ZGUgPGN0eXBlLmg+CiNpbmNs
dWRlICJtZWNoYW5pc21zLmgiCgovKiBFTkQgUFVCTElDIERFUEVOREVOQ0lFUyAqLwoKIyBkZWZp
bmUgUkVUVVJOKHgpIHtyZXR1cm4gc3RyZHVwKHgpO30KDAovKiBGVU5DVElPTjogYXV0aF9sZGFw
ICovCgojaWZkZWYgQVVUSF9MREFQCgojaW5jbHVkZSAibGFrLmgiCgojZGVmaW5lIFNBU0xBVVRI
RF9DT05GX0ZJTEUgIi91c3IvbG9jYWwvZXRjL3Nhc2xhdXRoZC5jb25mIgoKY2hhciAqCQkJCQkv
KiBSOiBhbGxvY2F0ZWQgcmVzcG9uc2Ugc3RyaW5nICovCmF1dGhfbGRhcCgKICAvKiBQQVJBTUVU
RVJTICovCiAgY29uc3QgY2hhciAqbG9naW4sCQkJLyogSTogcGxhaW50ZXh0IGF1dGhlbnRpY2F0
b3IgKi8KICBjb25zdCBjaGFyICpwYXNzd29yZCwJCQkvKiBJOiBwbGFpbnRleHQgcGFzc3dvcmQg
Ki8KICBjb25zdCBjaGFyICpzZXJ2aWNlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLAogIGNvbnN0
IGNoYXIgKnJlYWxtCiAgLyogRU5EIFBBUkFNRVRFUlMgKi8KICApCnsKCWNoYXIgICpteW5hbWUg
PSAiYXV0aF9sZGFwIjsKCglpbnQgcmMgPSAwOwoKCXJjID0gbGFrX2F1dGhlbnRpY2F0ZShsb2dp
biwgcmVhbG0sIHBhc3N3b3JkLCBTQVNMQVVUSERfQ09ORl9GSUxFKTsKICAgIAlpZiAocmMgPT0g
TEFLX09LKSB7CgkJUkVUVVJOKCJPSyIpOwoJfSBlbHNlIHsKCQlSRVRVUk4oIk5PIik7Cgl9Cn0K
CiNlbHNlIC8qICFBVVRIX0xEQVAgKi8KCmNoYXIgKgphdXRoX2xkYXAoCiAgY29uc3QgY2hhciAq
bG9naW4gX19hdHRyaWJ1dGVfXygodW51c2VkKSksCiAgY29uc3QgY2hhciAqcGFzc3dvcmQgX19h
dHRyaWJ1dGVfXygodW51c2VkKSksCiAgY29uc3QgY2hhciAqc2VydmljZSBfX2F0dHJpYnV0ZV9f
KCh1bnVzZWQpKSwKICBjb25zdCBjaGFyICpyZWFsbSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKQog
ICkKewogICAgIHJldHVybiBOVUxMOwp9CgojZW5kaWYgLyogIUFVVEhfTERBUCAqLwoKLyogRU5E
IEZVTkNUSU9OOiBhdXRoX2xkYXAgKi8KCi8qIEVORCBNT0RVTEU6IGF1dGhfbGRhcCAqLwoAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>40</attachid>
            <date>2002-05-24 13:54 EDT</date>
            <desc>ldap additions for saslauthd.8</desc>
            <filename>saslauthd_ldap.man</filename>
            <type>text/plain</type>
            <size>4002</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">KioqIGFkZCB1bmRlciBBVVRIRU5USUNBVElPTiBNRUNIQU5JU01TIHNlY3Rpb24KCmxkYXAgICAg
IChBbGwgcGxhdGZvcm1zIHRoYXQgc3VwcG9ydCBPcGVuTERBUCAyLjAgb3IgaGlnaGVyIGxpYnJh
cnkpCgpBdXRoZW50aWNhdGUgYWdhaW5zdCBhbiBsZGFwIHNlcnZlci4gIFRoZSBsZGFwIGNvbmZp
Z3VyYXRpb24gcGFyYW1ldGVycwphcmUgcmVhZCBmcm9tIC91c3IvbG9jYWwvZXRjL3Nhc2xhdXRo
ZC5jb25mLiAgVGhlIGxvY2F0aW9uIG9mIHRoaXMgZmlsZQpjYW4gYmUgY2hhbmdlZCB3aXRoIHRo
ZSAtTyBwYXJhbWV0ZXIuIFNlZSB0aGUgTERBUCBOT1RFUyBzZWN0aW9uIGZvciB0aGUKbGlzdCBv
ZiBhdmFpbGFibGUgcGFyYW1ldGVycy4KCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKioqIGFkZCB1bmRlciBGSUxFUyBzZWN0aW9uCgov
dXNyL2xvY2FsL2V0Yy9zYXNsYXV0aGQuY29uZiAgIFRoZSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24g
ZmlsZSBmb3IgbGRhcCBzdXBwb3J0CgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCioqKiBhZGQgTERBUCBOT1RFUyBzZWN0aW9uCgpUaGUg
Zm9sbG93aW5nIGFyZSBhdmFpbGFibGUgbGRhcCBwYXJhbWV0ZXJzLiAgVGhlcmUgYXJlIHF1aXRl
IGEgZmV3IG9mCnRob3NlLCBidXQgb25seSBsZGFwX3NlcnZlcnMgbWF5IG5lZWQgdG8gYmUgc3Bl
Y2lmaWVkLiBUaGUgZGVmYXVsdHMgZm9yCmFsbCBvdGhlciBwYXJhbWV0ZXJzIGFyZSBhZGVxdWF0
ZSBmb3IgbW9zdCBpbnN0YWxsYXRpb24uICBGb3IgYmVzdApwZXJmb3JtYW5jZSBlbnN1cmUgdGhh
dCB0aGUgYXR0cmlidXRlcyBzcGVjaWZpZWQgaW4gbGRhcF9maWx0ZXIgYXJlCmluZGV4ZWQuICBZ
b3UgY2FuIGFsc28gZXhwZXJpbWVudCB3aXRoIHRoZSBjbGllbnQgc2lkZSBjYWNoaW5nLiAgVGhp
cyBjYW4KYmUgYSBzaWduaWZpY2FudCBwZXJmb3JtYW5jZSBnYWluLiAgVXNlIHRoZSBjbGllbnQg
c2lkZSBjYWNoaW5nIHdpdGgKY2F1dGlvbiBiZWNhdXNlIGl0IHN0aWxsIGFuIGV4cGVyaW1lbnRh
bCBPcGVuTERBUCBjYWxsLgoKbGRhcF9zZXJ2ZXJzOiA8bGRhcDovL2xvY2FsaG9zdC8+CglTcGVj
aWZ5IExEQVAgc2VydmVycyB1c2luZyB1cmkgZm9ybWF0LiBlLmcgbGRhcDovLzEwLjEuMS4yLy4g
IFlvdQoJY2FuIHNwZWNpZnkgbXVsdGlwbGUgc2VydmVycyBzZXBhcmF0ZWQgYnkgYSBzcGFjZS4K
CmxkYXBfYmluZF9kbjogPG5vbmU+CglUaGUgZGlzdGluZ3Vpc2hlZCBuYW1lIHRvIGJpbmQgdG8g
dGhlIGxkYXAgc2VydmVyKHMpLgoKbGRhcF9iaW5kX3B3OiA8bm9uZT4KCVRoZSBwYXNzd29yZCBm
b3IgdGhlIGRpc3Rpbmd1aXNoZWQgbmFtZSBhYm92ZS4KCmxkYXBfdmVyc2lvbjogPDM+IDwyfDM+
CglUaGUgTERBUCB2ZXJzaW9uIHRvIHVzZS4KCmxkYXBfdGltZW91dDogPDU+CglUaGUgbnVtYmVy
IG9mIHNlY29uZHMgYSBzZWFyY2ggY2FuIHRha2UgYmVmb3JlIHRpbWluZyBvdXQuCgpsZGFwX3Rp
bWVsaW1pdDogPDU+CglUaGUgbnVtYmVyIG9mIHNlY29uZHMgdGhhdCBzaG91bGQgYmUgc3BlbnQg
YW5zd2VyaW5nIGEgc2VhcmNoIAoJcmVxdWVzdC4KCmxkYXBfZGVyZWY6IDxub25lPiA8c2VhcmNo
fGZpbmR8YWx3YXlzfG5ldmVyPgoJRGV0ZXJtaW5lcyBob3cgYWxpYXNlcyBhcmUgaGFuZGxlZCBk
dXJpbmcgYSBzZWFyY2guCgpsZGFwX3JlZmVyYWxzOiA8bm8+CglEZXRlcm1pbmVzIHdoZXRoZXIg
b3Igbm90IHRoZSBjbGllbnQgc2hvdWxkIGZvbGxvdyByZWZlcnJhbHMuCgpsZGFwX3Jlc3RhcnQ6
IDx5ZXM+CglEZXRlcm1pbmVzIHdoZXRoZXIgTERBUCBJL08gb3BlcmF0aW9ucyBhcmUgYXV0b21h
dGljYWxseSByZXN0YXJ0ZWQgaWYgdGhleQoJYWJvcnQgcHJlbWF0dXJlbHkuCgpsZGFwX2NhY2hl
X2V4cGlyeTogPDA+CglOb24gemVybyBlbmFibGVzIGNsaWVudCBzaWRlIGNhY2hpbmcuICBDYWNo
ZWQgcmVzdWx0cyB3aWxsIGV4cGlyZSBhZnRlciB0aGlzCgltYW55IHNlY29uZHMsIGUuZy4gMzAu
ICBVc2UgdGhpcyBvcHRpb24gd2l0aCBjYXJlLiAgT3BlbkxEQVAgZm9sa3MgY29uc2lkZXIKCXRo
aXMgZmVhdHVyZSBleHBlcmltZW50YWwuCgpsZGFwX2NhY2hlX3NpemU6IDwwPgoJSWYgdGhlIGNs
aWVudCBzaWRlIGNhY2hpbmcgaXMgZW5hYmxlZCwgdGhpcyBpcyBpdHMgc2l6ZSBpbiBieXRlcy4g
IAoJZS5nLiAzMjc2OC4KCQpsZGFwX3Njb3BlOiA8c3ViPiA8c3VifG9uZXxiYXNlPgoJVGhlIHNl
YXJjaCBzY29wZS4KCmxkYXBfc2VhcmNoX2Jhc2U6IDxub25lPgoJVGhlIGJhc2UgYXQgd2hpY2gg
dG8gY29uZHVjdCB0aGUgc2VhcmNoLiBlLmcuIG89ZXhhbXBsZS5jb20uCgpsZGFwX2F1dGhfbWV0
aG9kOiA8YmluZD4gPGJpbmR8Y3VzdG9tPgoJU3BlY2lmeSBhbiBhdXRoZW50aWNhdGlvbiBtZXRo
b2QuICBUaGUgZGVmYXVsdCBiaW5kIG1ldGhvZCB1c2VzCglMREFQIHNpbXBsZSBiaW5kIGZhY2ls
aXR5IHRvIHZlcnkgdGhlIHBhc3N3b3JkLiAgVGhlIGN1c3RvbSBtZXRob2QgCgl1c2VzIHVzZXJQ
YXNzd29yZCBhdHRyaWJ1dGUgdG8gdmVyaWZ5IHRoZSBwYXNzd29yZC4gIEN1cnJlbnRseSwKCXtD
UllQVH0gaGFzaCBpbiBzdXBwb3J0ZWQuCgpsZGFwX2ZpbHRlcjogPHVpZD0ldT4KCVNwZWNpZnkg
YSBmaWx0ZXIuICBVc2UgdGhlICV1IGFuZCAlciB0b2tlbnMgZm9yIHRoZSB1c2VybmFtZSBhbmQg
CglyZWFsbSBzdWJzdGl0dXRpb24uICBUaGUgJXUgdG9rZW4gaGFzIHRvIGJlIHVzZWQgYXQgbWlu
aW11bSBmb3IKCXRoZSBmaWx0ZXIgdG8gYmUgdXNlZnVsLiAgSWYgbGRhcF9hdXRoX21ldGhvZCBp
cyBiaW5kLCB0aGUgZmlsdGVyCgl3aWxsIHNlYXJjaCBmb3IgdGhlIGRpc3Rpbmd1c2hlZCBuYW1l
LiAgT3RoZXJ3aXNlLCB0aGUgc2VhcmNoIHdpbGwKCWxvb2sgZm9yIHRoZSB1c2VyUGFzc3dvcmQg
YXR0cmlidXRlLgoKbGRhcF9kZWJ1ZzogPDA+CglXaGF0IGxldmVsIHRvIHNldCBmb3IgZGVidWdn
aW5nIGluIHRoZSBPcGVuTERBUCBsaWJyYXJpZXMuCQoJU2VlIGxkYXBfc2V0X29wdGlvbigzKSBm
b3IgbW9yZSAoTERBUF9PUFRfREVCVUdfTEVWRUwpLgoKbGRhcF92ZXJib3NlOiA8bm8+CglMb2cg
YWRkaXRpb25hbCBpbmZvcm1hdGlvbiB0byBhdXRoLmluZm8gc3lzbG9nIGZhY2lsaXR5LiAgVGhp
cyAKCXNob3VsZCBiZSB1c2VkIGZvciBkZWJ1Z2dpbmcgcHVycG9zZXMgb25seS4KCmxkYXBfc3Ns
OiA8bm8+CglDb25uZWN0IHRvIExEQVBTIHR5cGljYWxseSB2aWEgcG9ydCA2MzYuCgpsZGFwX3N0
YXJ0X3RsczogPG5vPgoJRm9yY2Ugc3RhcnRfdGxzIG1lY2hhbmlzbSB0aHJvdWdoIHRoZSBub3Jt
YWwgTERBUCBwb3J0LiAgSWYgYm90aCAKCWxkYXBfc3NsIGFuZCBsZGFwX3N0YXJ0X3RscyBhcmUg
eWVzLCBsZGFwX3N0YXJ0X3RscyB3aWxsIGJlIHVzZWQuCgpsZGFwX3Rsc19jaGVja3BlZXI6IDxu
bz4KCVJlcXVpcmUgYW5kIHZlcmlmeSBzZXJ2ZXIgY2VydGlmaWNhdGUuICBJZiB0aGlzIG9wdGlv
biBpcyB5ZXMsCgl5b3UgbXVzdCBzcGVjaWZ5IGxkYXBfdGxzX2NhY2VydGZpbGUgb3IgbGRhcF90
bHNfY2FjZXJ0ZGlyLgoKbGRhcF90bHNfY2FjZXJ0ZmlsZTogPG5vbmU+CglDQSBjZXJ0aWZpY2F0
ZSBmb3Igc2VydmVyIGNlcnRpZmljYXRlIHZlcmlmaWNhdGlvbi4KCmxkYXBfdGxzX2NhY2VydGRp
cjogPG5vbmU+CglQYXRoIHRvIGRpcmVjdG9yeSB3aXRoIGNlcnRpZmljYXRlcyBvZiBDQXMuCgps
ZGFwX3Rsc19jaXBoZXJzOiA8REVGQVVMVD4KCVRoZSBsaXN0IG9mIFNTTC9UTFMgY2lwaGVycyB0
byBhbGxvdy4gIFRoZSBmb3JtYXQgb2YgdGhlIHN0cmluZyBpcwoJZGVzY3JpYmVkIGluIGNpcGhl
cnMoMSkuCgpsZGFwX3Rsc19jZXJ0OiA8bm9uZT4KCUZpbGUgY29udGFpbmluZyB0aGUgY2xpZW50
IGNlcnRpZmljYXRlLgoKbGRhcF90bHNfa2V5OiA8bm9uZT4KCUZpbGUgY29udGFpbmluZyB0aGUg
Y2xpZW50IGtleS4K
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>41</attachid>
            <date>2002-05-24 13:56 EDT</date>
            <desc>LDAP_SASLAUTHD document for cyrus_sasl/saslauthd package</desc>
            <filename>LDAP_SASLAUTHD</filename>
            <type>text/plain</type>
            <size>6569</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">YXV0aF9sZGFwIG1vZHVsZSBmb3Igc2FzbGF1dGhkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQoKU2FzbGF1dGhkIGNhbiB1c2UgYW4gTERBUCBkaXJlY3RvcnkgZm9yIGF1dGhlbnRpY2F0
aW9uL2F1dGhvcml6YXRpb24uCgpTZWN0aW9uczoKMS4gQnVpbGQgc2FzbGF1dGhkIHdpdGggbGRh
cCBzdXBwb3J0CjIuIFN0YXJ0IHNhc2xhdXRoZCB3aXRoIGxkYXAKMy4gVGVzdGluZwo0LiBQYXJh
bWV0ZXJzCjUuIEV4YW1wbGVzCjYuIE5vdGVzCjcuIFRvZG8KOC4gRmVlZGJhY2sKOC4gQVVUSE9S
CgoxLiBCVUlMRCBTQVNMQVVUSEQgV0lUSCBMREFQIFNVUFBPUlQKLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tCgpFbnN1cmUgdGhhdCB5b3UgaGF2ZSB0aGUgT3BlbkxEQVAgKGh0
dHA6Ly93d3cub3BlbmxkYXAub3JnKSBsaWJyYXJpZXMgMi4wIG9yCmhpZ2hlci4gIEZldGNoIHRo
ZSBsYXRlc3QgY3lydXMtc2FzbCBwYWNrYWdlLCAyLjEuMyBvciBoaWdoZXIsCmZ0cDovL2Z0cC5h
bmRyZXcuY211LmVkdS9wdWIvY3lydXMtbWFpbC8uCgpVbnBhY2sgY3lydXMtc2FzbDoKZ3ppcCAt
ZGMgY3lydXMtc2FzbC0yLjEuMy50YXIuZ3ogfCB0YXIgeGYgLQpvcgp0YXIgenRmIGN5cnVzLXNh
c2wtMi4xLjMudGFyLmd6IChpZiB5b3VyIHRhciBzdXBwb3J0eiBnemlwKQoKY2QgY3lydXMtc2Fz
bC0yLjEuMwouL2NvbmZpZ3VyZSAtLXdpdGgtbGRhcCAgKHlvdSBtYXkgbmVlZCB0byBhZGQgb3Ro
ZXIgb3B0aW9ucywgY2hlY2sgZG9jL2luZGV4Lmh0bWwgZm9yIG1vcmUpCm1ha2UKbWFrZSBpbnN0
YWxsCgoyLiBTVEFSVCBTQVNMQVVUSEQgV0lUSCBMREFQCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0KCkNyZWF0ZSAvdXNyL2xvY2FsL2V0Yy9zYXNsYXV0aGQuY29uZiBhbmQgYWRkIHRoZSBm
b2xsb3dpbmcgKG1vZGlmeSB0byBmaXQgeW91cgplbnZpcm9ubWVudCk6CmxkYXBfc2VydmVyczog
bGRhcDovLzEwLjEuMS4xNS8gbGRhcDovLzEwLjEuMS4yNS8KbGRhcF9iaW5kX2RuOiBjbj1vcGVy
YXRvcixvdT1Qcm9maWxlLG89Zm9vLmNvbQpsZGFwX2JpbmRfcHc6IHNlY3JldAoKUnVuIHNhc2xh
dXRoZDoKc2FzbGF1dGhkIC1hIGxkYXAKCklmIHlvdSB3YW50IHRvIHNwZWNpZnkgYSBkaWZmZXJl
bnQgY29uZmlndXJhdGlvbiBmaWxlLCB5b3UgY2FuIGRvIHNvbWV0aGluZwpsaWtlOgpzYXNsYXV0
aGQgLWEgbGRhcCAtTyAvZXRjL3Nhc2xhdXRoZC5jb25mCgpGb3IgbW9yZSwgY2hlY2sgJ21hbiBz
YXNsYXV0aGQnCgozLiBURVNUSU5HCi0tLS0tLS0tLS0KCkZpcnN0IGJ1aWxkIHRlc3RzYXNsYXV0
aGQ6CmNkICRzYXNsX3NyYy9zYXNsYXV0aGQKbWFrZSB0ZXN0c2FzbGF1dGhkCgpSdW4gdGVzdCB1
dGlsaXR5OgouL3Rlc3RzYXNsYXV0aGQgLXUgaWdvciAtcCBzZWNyZXQKMDogT0sgIlN1Y2Nlc3Mu
IgoKSWYgeW91IGdldCBvdXRwdXQgb3RoZXIgdGhlbiBTdWNjZXNzLCBhZGQgJ2xkYXBfdmVyYm9z
ZTogeWVzJyB0byB5b3VyCmNvbmZpZ3VyYXRpb24gZmlsZSwgcmVzdGFydCBzYWxzYXV0aGQgYW5k
IHdhdGNoIHRoZSBhdXRoIHN5c2xvZyBmYWNpbGl0eS4KVGhpcyBzaG91bGQgZ2l2ZSB5b3UgZW5v
dWdoIGNsdWVzIHRvIGNvcnJlY3QgeW91ciBwcm9ibGVtLgoKCjQuIFBBUkFNRVRFUlMKLS0tLS0t
LS0tLS0tLQoKVGhlIGZvbGxvd2luZyBhcmUgYXZhaWxhYmxlIGxkYXAgcGFyYW1ldGVycy4gIFRo
ZXJlIGFyZSBxdWl0ZSBhIGZldyBvZiB0aG9zZSwKYnV0IG9ubHkgbGRhcF9zZXJ2ZXJzIG1heSBu
ZWVkIHRvIGJlIHNwZWNpZmllZC4gVGhlIGRlZmF1bHRzIGZvciBhbGwgb3RoZXIKcGFyYW1ldGVy
cyBhcmUgYWRlcXVhdGUgZm9yIG1vc3QgaW5zdGFsbGF0aW9ucy4gIAoKRG9uJ3QgdXNlIHF1b3Rl
cyBpbiB0aGVzZSB2YXJpYWJsZXMuICBUaGUgZGVmYXVsdHMgYXJlIHNwZWNpZmllZCB3aXRoaW4g
dGhlCmZpcnN0IHNldCBvZiA8Pi4gIFRoZXJlIG1heSBiZSBhIHNlY29uZCBzZXQgb2YgPD4gd2hp
Y2ggcHJvdmlkZSBhdmFpbGFibGUKb3B0aW9ucy4KCmxkYXBfc2VydmVyczogPGxkYXA6Ly9sb2Nh
bGhvc3QvPgoJU3BlY2lmeSBMREFQIHNlcnZlcnMgdXNpbmcgdXJpIGZvcm1hdC4gZS5nIGxkYXA6
Ly8xMC4xLjEuMi8uICBZb3UKCWNhbiBzcGVjaWZ5IG11bHRpcGxlIHNlcnZlcnMgc2VwYXJhdGVk
IGJ5IGEgc3BhY2UuCgpsZGFwX2JpbmRfZG46IDxub25lPgoJVGhlIGRpc3Rpbmd1aXNoZWQgbmFt
ZSB0byBiaW5kIHRvIHRoZSBsZGFwIHNlcnZlcihzKS4KCmxkYXBfYmluZF9wdzogPG5vbmU+CglU
aGUgcGFzc3dvcmQgZm9yIHRoZSBkaXN0aW5ndWlzaGVkIG5hbWUgYWJvdmUuCgpsZGFwX3ZlcnNp
b246IDwzPiA8MnwzPgoJVGhlIExEQVAgdmVyc2lvbiB0byB1c2UuCgpsZGFwX3RpbWVvdXQ6IDw1
PgoJVGhlIG51bWJlciBvZiBzZWNvbmRzIGEgc2VhcmNoIGNhbiB0YWtlIGJlZm9yZSB0aW1pbmcg
b3V0LgoKbGRhcF90aW1lbGltaXQ6IDw1PgoJVGhlIG51bWJlciBvZiBzZWNvbmRzIHRoYXQgc2hv
dWxkIGJlIHNwZW50IGFuc3dlcmluZyBhIHNlYXJjaCAKCXJlcXVlc3QuCgpsZGFwX2RlcmVmOiA8
bm9uZT4gPHNlYXJjaHxmaW5kfGFsd2F5c3xuZXZlcj4KCURldGVybWluZXMgaG93IGFsaWFzZXMg
YXJlIGhhbmRsZWQgZHVyaW5nIGEgc2VhcmNoLgoKbGRhcF9yZWZlcmFsczogPG5vPgoJRGV0ZXJt
aW5lcyB3aGV0aGVyIG9yIG5vdCAgdGhlICBjbGllbnQgIHNob3VsZCAgZm9sbG93CiAgICAgICAg
cmVmZXJyYWxzLgoKbGRhcF9yZXN0YXJ0OiA8eWVzPgoJRGV0ZXJtaW5lcyB3aGV0aGVyIExEQVAg
SS9PIG9wZXJhdGlvbnMgIGFyZSAgYXV0b21hdGljYWxseSAKCXJlc3RhcnRlZCBpZiB0aGV5IGFi
b3J0IHByZW1hdHVyZWx5LgoKbGRhcF9jYWNoZV9leHBpcnk6IDwwPgoJTm9uIHplcm8gZW5hYmxl
cyBjbGllbnQgc2lkZSBjYWNoaW5nLiAgQ2FjaGVkIHJlc3VsdHMgd2lsbCBleHBpcmUgYWZ0ZXIg
dGhpcwoJbWFueSBzZWNvbmRzLCBlLmcuIDMwLiAgVXNlIHRoaXMgb3B0aW9uIHdpdGggY2FyZS4g
IE9wZW5MREFQIGZvbGtzIGNvbnNpZGVyCgl0aGlzIGZlYXR1cmUgZXhwZXJpbWVudGFsLgoKbGRh
cF9jYWNoZV9zaXplOiA8MD4KCUlmIHRoZSBjbGllbnQgc2lkZSBjYWNoaW5nIGlzIGVuYWJsZWQs
IHRoaXMgaXMgaXRzIHNpemUgaW4gYnl0ZXMuICAKCWUuZy4gMzI3NjguCgkKbGRhcF9zY29wZTog
PHN1Yj4gPHN1YnxvbmV8YmFzZT4KCVRoZSBzZWFyY2ggc2NvcGUuCgpsZGFwX3NlYXJjaF9iYXNl
OiA8bm9uZT4KCVRoZSBiYXNlIGF0IHdoaWNoIHRvIGNvbmR1Y3QgdGhlIHNlYXJjaC4gZS5nLiBv
PWV4YW1wbGUuY29tLgoKbGRhcF9hdXRoX21ldGhvZDogPGJpbmQ+IDxiaW5kfGN1c3RvbT4KCVNw
ZWNpZnkgYW4gYXV0aGVudGljYXRpb24gbWV0aG9kLiAgVGhlIGRlZmF1bHQgYmluZCBtZXRob2Qg
dXNlcwoJTERBUCBzaW1wbGUgYmluZCBmYWNpbGl0eSB0byB2ZXJpZnkgdGhlIHBhc3N3b3JkLiAg
VGhlIGN1c3RvbSBtZXRob2QgCgl1c2VzIHVzZXJQYXNzd29yZCBhdHRyaWJ1dGUgdG8gdmVyaWZ5
IHRoZSBwYXNzd29yZC4gIEN1cnJlbnRseSwKCXtDUllQVH0gaGFzaCBpbiBzdXBwb3J0ZWQuCgps
ZGFwX2ZpbHRlcjogPHVpZD0ldT4KCVNwZWNpZnkgYSBmaWx0ZXIuICBVc2UgdGhlICV1IGFuZCAl
ciB0b2tlbnMgZm9yIHRoZSB1c2VybmFtZSBhbmQgCglyZWFsbSBzdWJzdGl0dXRpb24uICBUaGUg
JXUgdG9rZW4gaGFzIHRvIGJlIHVzZWQgYXQgbWluaW11bSBmb3IKCXRoZSBmaWx0ZXIgdG8gYmUg
dXNlZnVsLiAgSWYgbGRhcF9hdXRoX21ldGhvZCBpcyBiaW5kLCB0aGUgZmlsdGVyCgl3aWxsIHNl
YXJjaCBmb3IgdGhlIGRpc3Rpbmd1c2hlZCBuYW1lLiAgT3RoZXJ3aXNlLCB0aGUgc2VhcmNoIHdp
bGwKCWxvb2sgZm9yIHRoZSB1c2VyUGFzc3dvcmQgYXR0cmlidXRlLgoKbGRhcF9kZWJ1ZzogPDA+
CglXaGF0IGxldmVsIHRvIHNldCBmb3IgZGVidWdnaW5nIGluIHRoZSBPcGVuTERBUCBsaWJyYXJp
ZXMuCQoJU2VlIGxkYXBfc2V0X29wdGlvbigzKSBmb3IgbW9yZSAoTERBUF9PUFRfREVCVUdfTEVW
RUwpLgoKbGRhcF92ZXJib3NlOiA8bm8+CglMb2cgYWRkaXRpb25hbCBpbmZvcm1hdGlvbiB0byBh
dXRoLmluZm8gc3lzbG9nIGZhY2lsaXR5LiAgVGhpcyAKCXNob3VsZCBiZSB1c2VkIGZvciBkZWJ1
Z2dpbmcgcHVycG9zZXMgb25seS4KCmxkYXBfc3NsOiA8bm8+CglDb25uZWN0IHRvIExEQVBTIHR5
cGljYWxseSB2aWEgcG9ydCA2MzYuCgpsZGFwX3N0YXJ0X3RsczogPG5vPgoJRm9yY2Ugc3RhcnRf
dGxzIG1lY2hhbmlzbSB0aHJvdWdoIHRoZSBub3JtYWwgTERBUCBwb3J0LiAgSWYgYm90aCAKCWxk
YXBfc3NsIGFuZCBsZGFwX3N0YXJ0X3RscyBhcmUgeWVzLCBsZGFwX3N0YXJ0X3RscyB3aWxsIGJl
IHVzZWQuCgpsZGFwX3Rsc19jaGVja3BlZXI6IDxubz4KCVJlcXVpcmUgYW5kIHZlcmlmeSBzZXJ2
ZXIgY2VydGlmaWNhdGUuICBJZiB0aGlzIG9wdGlvbiBpcyB5ZXMsCgl5b3UgbXVzdCBzcGVjaWZ5
IGxkYXBfdGxzX2NhY2VydGZpbGUgb3IgbGRhcF90bHNfY2FjZXJ0ZGlyLgoKbGRhcF90bHNfY2Fj
ZXJ0ZmlsZTogPG5vbmU+CglDQSBjZXJ0aWZpY2F0ZSBmb3Igc2VydmVyIGNlcnRpZmljYXRlIHZl
cmlmaWNhdGlvbi4KCmxkYXBfdGxzX2NhY2VydGRpcjogPG5vbmU+CglQYXRoIHRvIGRpcmVjdG9y
eSB3aXRoIGNlcnRpZmljYXRlcyBvZiBDQXMuCgpsZGFwX3Rsc19jaXBoZXJzOiA8REVGQVVMVD4K
CVRoZSBsaXN0IG9mIFNTTC9UTFMgY2lwaGVycyB0byBhbGxvdy4gIFRoZSBmb3JtYXQgb2YgdGhl
IHN0cmluZyBpcwoJZGVzY3JpYmVkIGluIGNpcGhlcnMoMSkuCgpsZGFwX3Rsc19jZXJ0OiA8bm9u
ZT4KCUZpbGUgY29udGFpbmluZyB0aGUgY2xpZW50IGNlcnRpZmljYXRlLgoKbGRhcF90bHNfa2V5
OiA8bm9uZT4KCUZpbGUgY29udGFpbmluZyB0aGUgY2xpZW50IGtleS4KCjUuIE5PVEVTCi0tLS0t
LS0tCgpGb3IgYmV0dGVyIHBlcmZvcm1hbmNlIGVuc3VyZSB0aGF0IHRoZSBhdHRyaWJ1dGVzIHNw
ZWNpZmllZCBpbiBsZGFwX2ZpbHRlciBhcmUKaW5kZXhlZC4gIFlvdSBjYW4gYWxzbyBleHBlcmlt
ZW50IHdpdGggdGhlIGNsaWVudCBzaWRlIGNhY2hpbmcuICBUaGlzIGNhbiBiZSBhCnNpZ25pZmlj
YW50IHBlcmZvcm1hbmNlIGdhaW4uICBVc2UgdGhlIGNsaWVudCBzaWRlIGNhY2hpbmcgd2l0aCBj
YXV0aW9uCmJlY2F1c2UgaXQgc3RpbGwgYW4gZXhwZXJpbWVudGFsIE9wZW5MREFQIGNhbGwuCgpU
aGUgZm9sbG93aW5nIGNvbmZpZ3VyYXRpb24gc2V0dGluZyBlbmFibGVzIGNsaWVudCBzaWRlIGNh
Y2hpbmcgYW5kIGl0CnNldHMgdGhlIGNhY2hlIHNpemUgdG8gMzJrOgoKbGRhcF9jYWNoZV9leHBp
cnk6IDMwCmxkYXBfY2FjaGVfc2l6ZTogMzI3NjgKCjYuIFRPRE8KLS0tLS0tLQoKLSBQb3J0IHRv
IG90aGVyIGxkYXAgbGlicmFyaWVzCi0gVGhlcmUgbWF5IGJlIGJpbmQgcHJvYmxlbXMgd2hlbiBm
b2xsb3dpbmcgcmVmZXJyYWxzLiAgTm9ybWFsbHkgdGhpcyBpcyBub3QgYW4KICBpc3N1ZS4gIEZp
eC4KLSBBbGxvdyB0byBzcGVjaWZ5IGFuIGF0dHJpYnV0ZSBvdGhlciB0aGFuIHVzZXJQYXNzd29y
ZCBmb3IgdXNlIGluIHRoZSBjdXN0b20KICBhdXRoZW50aWNhdGlvbiBtZXRob2QuCi0gQWRkIG1v
cmUgcGFzc3dvcmQgaGFzaGVzIHN1Y2ggYXMgbWQ1LCBzaGEgZXRjCi0gTWFrZSBhIHN1Z2dlc3Rp
b24gKHBvc3NpYmx5IGFub3RoZXIgYXV0aGVudGljYXRpb24gbWV0aG9kPykKCjcuIEZFRURCQUNL
Ci0tLS0tLS0tLS0tCgpGZWVkYmFjayBpcyBtdWNoIGFwcHJlY2lhdGVkISAgUGxlYXNlIGRyb3Ag
bWUgYSBub3RlIGlmIHlvdSBhcmUgc3VjY2Vzc2Z1bGx5CnVzaW5nIGxkYXAgZW5hYmxlZCBzYXNs
YXV0aGQuICBBbnkgY29kZSBpbXByb3ZlbWVudHMgb3Igc3VnZ2VzdGlvbiBhcmUgd2VsY29tZS4K
CklmIHlvdSBoYXZlIHF1ZXN0aW9ucywgc2VuZCB0aGVtIHRvIGN5cnVzLXNhc2xAbGlzdHMuYW5k
cmV3LmNtdS5lZHUuICBQbGVhc2UKaW5jbHVkZSByZWxldmFudCBpbmZvcm1hdGlvbiBhYm91dCB5
b3VyIHNhc2xhdXRoZCBzZXR1cDogYXQgbWluaW11bSBwcm92aWRlCnlvdXIgc2FzbGF1dGguY29u
Ziwgb3V0cHV0IGZyb20gc3lzbG9nIGFuZCB3aGljaCBkaXJlY3Rvcnkgc2VydmVyIHlvdSdyZSB1
c2luZy4KCjguIEFVVEhPUgotLS0tLS0tLS0KCklnb3IgQnJlemFjIDxpZ29yQGlwYXNzLm5ldD4g
d2l0aCBoZWxwIGFuZCBzdWdnZXN0aW9ucyBmcm9tIG51bWVyb3VzIGdyZWF0CmZvbGtzIGFyb3Vu
ZCB0aGUgTmV0LiAgSSBib3Jyb3dlZCBpZGVhcyBmcm9tIHBhZGwgcGFtX2xkYXAsIHBvc3RmaXgs
IHNlbmRtYWlsCmFuZCBmcmVlcmFkaXVzLiAgCgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tClZpc2l0IElzdHJhLCBD
cm9hdGlhLiAgT25lIG9mIHRoZSBtb3N0IGJlYXV0aWZ1bCBwYXJ0cyBvZiB0aGUgd29ybGQhISEK
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLQo=
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>45</attachid>
            <date>2002-06-17 19:26 EDT</date>
            <desc>More auth_ldap rewrite</desc>
            <filename>auth_ldap.tgz</filename>
            <type>text/plain</type>
            <size>6803</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">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
+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
AAAAAAAAAAAAzoRvSqIzegCgAAA=
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>49</attachid>
            <date>2002-06-24 18:21 EDT</date>
            <desc>LDAP_SASLAUTHD - readme for ldap-enabled saslauthd</desc>
            <filename>LDAP_SASLAUTHD</filename>
            <type>text/plain</type>
            <size>6438</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">YXV0aF9sZGFwIG1vZHVsZSBmb3Igc2FzbGF1dGhkCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLQoKU2FzbGF1dGhkIGNhbiB1c2UgYW4gTERBUCBkaXJlY3RvcnkgZm9yIGF1dGhlbnRpY2F0
aW9uL2F1dGhvcml6YXRpb24uCgpTZWN0aW9uczoKMS4gQnVpbGQgc2FzbGF1dGhkIHdpdGggbGRh
cCBzdXBwb3J0CjIuIFN0YXJ0IHNhc2xhdXRoZCB3aXRoIGxkYXAKMy4gVGVzdGluZwo0LiBQYXJh
bWV0ZXJzCjUuIEV4YW1wbGVzCjYuIE5vdGVzCjcuIFRvZG8KOC4gRmVlZGJhY2sKOC4gQXV0aG9y
CgoKMS4gQlVJTEQgU0FTTEFVVEhEIFdJVEggTERBUCBTVVBQT1JUCi0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLQoKRW5zdXJlIHRoYXQgeW91IGhhdmUgdGhlIE9wZW5MREFQICho
dHRwOi8vd3d3Lm9wZW5sZGFwLm9yZykgbGlicmFyaWVzIDIuMCBvcgpoaWdoZXIuICBGZXRjaCB0
aGUgbGF0ZXN0IGN5cnVzLXNhc2wgcGFja2FnZSwgMi4xLjYgb3IgaGlnaGVyLApmdHA6Ly9mdHAu
YW5kcmV3LmNtdS5lZHUvcHViL2N5cnVzLW1haWwvLgoKVW5wYWNrIGN5cnVzLXNhc2w6Cmd6aXAg
LWRjIGN5cnVzLXNhc2wtMi4xLjYudGFyLmd6IHwgdGFyIHhmIC0Kb3IKdGFyIHp4ZiBjeXJ1cy1z
YXNsLTIuMS42LnRhci5neiAoaWYgeW91ciB0YXIgc3VwcG9ydHogZ3ppcCkKCmNkIGN5cnVzLXNh
c2wtMi4xLjYKLi9jb25maWd1cmUgLS13aXRoLWxkYXAgICh5b3UgbWF5IG5lZWQgdG8gYWRkIG90
aGVyIG9wdGlvbnMsIGNoZWNrIGRvYy9pbmRleC5odG1sIGZvciBtb3JlKQptYWtlCm1ha2UgaW5z
dGFsbAoKCjIuIFNUQVJUIFNBU0xBVVRIRCBXSVRIIExEQVAKLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLQoKQ3JlYXRlIC91c3IvbG9jYWwvZXRjL3Nhc2xhdXRoZC5jb25mIGFuZCBhZGQgdGhl
IGZvbGxvd2luZyAobW9kaWZ5IHRvIGZpdCB5b3VyCmVudmlyb25tZW50KToKbGRhcF9zZXJ2ZXJz
OiBsZGFwOi8vMTAuMS4xLjE1LyBsZGFwOi8vMTAuMS4xLjI1LwpsZGFwX2JpbmRfZG46IGNuPW9w
ZXJhdG9yLG91PVByb2ZpbGUsbz1mb28uY29tCmxkYXBfYmluZF9wdzogc2VjcmV0CgpEbyBub3Qg
c3BlY2lmeSBsZGFwX2JpbmRfKiBpZiB5b3Ugd2FudCB0byBiaW5kIGFub255bW91c2x5IHRvIHlv
dXIgbGRhcCBzZXJ2ZXIocykuIAoKUnVuIHNhc2xhdXRoZDoKc2FzbGF1dGhkIC1hIGxkYXAKCklm
IHlvdSB3YW50IHRvIHNwZWNpZnkgYSBkaWZmZXJlbnQgY29uZmlndXJhdGlvbiBmaWxlLCB5b3Ug
Y2FuIGRvIHNvbWV0aGluZwpsaWtlOgpzYXNsYXV0aGQgLWEgbGRhcCAtTyAvZXRjL3Nhc2xhdXRo
ZC5jb25mCgpGb3IgbW9yZSwgY2hlY2sgJ21hbiBzYXNsYXV0aGQnCgoKMy4gVEVTVElORwotLS0t
LS0tLS0tCgpGaXJzdCBidWlsZCB0ZXN0c2FzbGF1dGhkOgpjZCAkc2FzbF9zcmMvc2FzbGF1dGhk
Cm1ha2UgdGVzdHNhc2xhdXRoZAoKUnVuIHRlc3QgdXRpbGl0eToKLi90ZXN0c2FzbGF1dGhkIC11
IGlnb3IgLXAgc2VjcmV0CjA6IE9LICJTdWNjZXNzLiIKCklmIHlvdSBnZXQgb3V0cHV0IG90aGVy
IHRoZW4gU3VjY2VzcywgY2hlY2sgdGhlIGF1dGguKiBzeXNsb2cgZmFjaWxpdHkuCkhvcGVmdWxs
eSB0aGlzIHdpbGwgZ2l2ZSB5b3UgZW5vdWdoIGluZm9ybWF0aW9uIHRvIG1ha2UgYWRqdXN0ZW1l
bnRzIGluIHRoZQpzdGFydHVwIGFuZC9vciBjb25maWd1cmF0aW9uIGZpbGVzLiAgCgoKNC4gUEFS
QU1FVEVSUwotLS0tLS0tLS0tLS0tCgpUaGUgZm9sbG93aW5nIGFyZSBhdmFpbGFibGUgbGRhcCBw
YXJhbWV0ZXJzLiAgVGhlcmUgYXJlIHF1aXRlIGEgZmV3IG9mIHRob3NlLApidXQgb25seSBsZGFw
X3NlcnZlcnMgbWF5IG5lZWQgdG8gYmUgc3BlY2lmaWVkLiBUaGUgZGVmYXVsdHMgZm9yIGFsbCBv
dGhlcgpwYXJhbWV0ZXJzIGFyZSBhZGVxdWF0ZSBmb3IgbW9zdCBpbnN0YWxsYXRpb25zLiAgCgpE
byBub3QgdXNlIHF1b3RlcyAoXCJcJykgaW4gdGhlIHBhcmFtZXRlciB2YWx1ZXMuICBUaGUgZGVm
YXVsdHMgYXJlIHNwZWNpZmllZAp3aXRoaW4gdGhlIGZpcnN0IHNldCBvZiA8Pi4gIFRoZXJlIG1h
eSBiZSBhIHNlY29uZCBzZXQgb2YgPD4gd2hpY2ggcHJvdmlkZQphdmFpbGFibGUgdmFsdWVzLgoK
bGRhcF9zZXJ2ZXJzOiA8bGRhcDovL2xvY2FsaG9zdC8+CglTcGVjaWZ5IFVSSShzKSByZWZlcmlu
ZyB0byBMREFQIHNlcnZlcihzKSwgZS5nLiBsZGFwczovLzEwLjEuMS4yOjk5OS8uCglZb3UgY2Fu
IHNwZWNpZnkgbXVsdGlwbGUgc2VydmVycyBzZXBhcmF0ZWQgYnkgYSBzcGFjZS4KCmxkYXBfYmlu
ZF9kbjogPG5vbmU+CglTcGVjaWZ5IEROIChkaXN0aW5ndWlzaGVkIG5hbWUpIHRvIGJpbmQgdG8g
dGhlIExEQVAgZGlyZWN0b3J5LiAgRG8gbm90CglzcGVjaWZ5IHRoaXMgcGFyYW1ldGVyIGZvciB0
aGUgYW5vbnltb3VzIGJpbmQuCgpsZGFwX2JpbmRfcHc6IDxub25lPgoJU3BlY2lmeSB0aGUgcGFz
c3dvcmQgZm9yIGxkYXBfYmluZF9kbi4gIERvIG5vdCBzcGVjaWZ5IHRoaXMgcGFyYW1ldGVyCglm
b3IgdGhlIGFub255bW91cyBiaW5kLgoKbGRhcF92ZXJzaW9uOiA8Mz4gPDJ8Mz4KCVNwZWNpZnkg
dGhlIExEQVAgcHJvdG9jb2wgdmVyc2lvbiB0byB1c2UuCgpsZGFwX3RpbWVvdXQ6IDw1PgoJU3Bl
Y2lmeSBhIG51bWJlciBvZiBzZWNvbmRzIGEgc2VhcmNoIGNhbiB0YWtlIGJlZm9yZSB0aW1pbmcg
b3V0LgoKbGRhcF90aW1lX2xpbWl0OiA8NT4KCVNwZWNpZnkgYSBudW1iZXIgb2Ygc2Vjb25kcyBm
b3IgYSBzZWFyY2ggcmVxdWVzdCB0byBjb21wbGV0ZS4KCmxkYXBfZGVyZWY6IDxub25lPiA8c2Vh
cmNofGZpbmR8YWx3YXlzfG5ldmVyPgoJU3BlY2lmeSBob3cgYWxpYXNlcyBkZXJlZmVyZW5jaW5n
IGlzIGhhbmRsZWQgZHVyaW5nIGEgc2VhcmNoLgoKbGRhcF9yZWZlcnJhbHM6IDxubz4KCVNwZWNp
Znkgd2hldGhlciBvciBub3QgdGhlIGNsaWVudCBzaG91bGQgZm9sbG93IHJlZmVycmFscy4KCmxk
YXBfcmVzdGFydDogPHllcz4KCVNwZWNpZnkgd2hldGhlciBvciBub3QgTERBUCBJL08gb3BlcmF0
aW9ucyBhcmUgYXV0b21hdGljYWxseSByZXN0YXJ0ZWQKCWlmIHRoZXkgYWJvcnQgcHJlbWF0dXJl
bHkuCgpsZGFwX2NhY2hlX3R0bDogPDA+CglOb24gemVybyBlbmFibGVzIGNsaWVudCBzaWRlIGNh
Y2hpbmcuICBDYWNoZWQgcmVzdWx0cyB3aWxsIGV4cGlyZSBhZnRlcgoJc3BlY2lmaWVkIG51bWJl
ciBzZWNvbmRzLCBlLmcuIDMwLiAgVXNlIHRoaXMgb3B0aW9uIHdpdGggY2FyZS4KCU9wZW5MREFQ
IGZvbGtzIGNvbnNpZGVyIHRoaXMgZmVhdHVyZSBleHBlcmltZW50YWwuCgpsZGFwX2NhY2hlX21l
bTogPDA+CglJZiBjbGllbnQgc2lkZSBjYWNoaW5nIGlzIGVuYWJsZWQsIHRoZSB2YWx1ZSBzcGVj
aWZpZXMgdGhlIGNhY2hlIHNpemUKCWluIGJ5dGVzLCAgZS5nLiAzMjc2OC4KCQpsZGFwX3Njb3Bl
OiA8c3ViPiA8c3VifG9uZXxiYXNlPgoJU2VhcmNoIHNjb3BlLgoKbGRhcF9zZWFyY2hfYmFzZTog
PG5vbmU+CglTcGVjaWZ5IGEgc3RhcnRpbmcgcG9pbnQgZm9yIHRoZSBzZWFyY2guICBlLmcuIGRj
PWZvbyxkYz1jb20KCmxkYXBfYXV0aF9tZXRob2Q6IDxiaW5kPiA8YmluZHxjdXN0b20+CglTcGVj
aWZ5IGFuIGF1dGhlbnRpY2F0aW9uIG1ldGhvZC4gIFRoZSBkZWZhdWx0ICdiaW5kJyBtZXRob2Qg
dXNlcyB0aGUKCUxEQVAgc2ltcGxlIGJpbmQgZmFjaWxpdHkgdG8gdmVyaWZ5IHRoZSBwYXNzd29y
ZC4gIFRoZSBjdXN0b20gbWV0aG9kCgl1c2VzIHVzZXJQYXNzd29yZCBhdHRyaWJ1dGUgdG8gdmVy
aWZ5IHRoZSBwYXNzd29yZC4gIEN1cnJlbnRseSwge0NSWVBUfQoJaGFzaCBpcyBzdXBwb3J0ZWQu
CgpsZGFwX2ZpbHRlcjogPHVpZD0ldT4KCVNwZWNpZnkgYSBmaWx0ZXIuICBVc2UgdGhlICV1IGFu
ZCAlciB0b2tlbnMgZm9yIHRoZSB1c2VybmFtZSBhbmQgcmVhbG0KCXN1YnN0aXR1dGlvbi4gIFRo
ZSAldSB0b2tlbiBoYXMgdG8gYmUgdXNlZCBhdCBtaW5pbXVtIGZvciB0aGUgZmlsdGVyIHRvCgli
ZSB1c2VmdWwuICBJZiBsZGFwX2F1dGhfbWV0aG9kIGlzICdiaW5kJywgdGhlIGZpbHRlciB3aWxs
IHNlYXJjaCBmb3IKCXRoZSBETiAoZGlzdGluZ3Vpc2hlZCBuYW1lKSBhdHRyaWJ1dGUuICBPdGhl
cndpc2UsIHRoZSBzZWFyY2ggd2lsbCBsb29rCglmb3IgdGhlIHVzZXJQYXNzd29yZCBhdHRyaWJ1
dGUuCgpsZGFwX2RlYnVnOiA8MD4KCVNwZWNpZnkgYSBkZWJ1Z2dpbmcgbGV2ZWwgaW4gdGhlIE9w
ZW5MREFQIGxpYnJhcmllcy4gIFNlZQoJbGRhcF9zZXRfb3B0aW9uKDMpIGZvciBtb3JlIChMREFQ
X09QVF9ERUJVR19MRVZFTCkuCgpsZGFwX3Rsc19jaGVja19wZWVyOiA8bm8+IDx5ZXN8bm8+CglS
ZXF1aXJlIGFuZCB2ZXJpZnkgc2VydmVyIGNlcnRpZmljYXRlLiAgSWYgdGhpcyBvcHRpb24gaXMg
eWVzLAoJeW91IG11c3Qgc3BlY2lmeSBsZGFwX3Rsc19jYWNlcnRfZmlsZSBvciBsZGFwX3Rsc19j
YWNlcnRfZGlyLgoKbGRhcF90bHNfY2FjZXJ0X2ZpbGU6IDxub25lPgoJRmlsZSBjb250YWluaW5n
IENBIChDZXJ0aWZpY2F0ZSBBdXRob3JpdHkpIGNlcnRpZmljYXRlKHMpLgoKbGRhcF90bHNfY2Fj
ZXJ0X2RpcjogPG5vbmU+CglQYXRoIHRvIGRpcmVjdG9yeSB3aXRoIENBIChDZXJ0aWZpY2F0ZSBB
dXRob3JpdHkpIGNlcnRpZmljYXRlcy4KCmxkYXBfdGxzX2NpcGhlcnM6IDxERUZBVUxUPgoJTGlz
dCBvZiBTU0wvVExTIGNpcGhlcnMgdG8gYWxsb3cuICBUaGUgZm9ybWF0IG9mIHRoZSBzdHJpbmcg
aXMKCWRlc2NyaWJlZCBpbiBjaXBoZXJzKDEpLgoKbGRhcF90bHNfY2VydDogPG5vbmU+CglGaWxl
IGNvbnRhaW5pbmcgdGhlIGNsaWVudCBjZXJ0aWZpY2F0ZS4KCmxkYXBfdGxzX2tleTogPG5vbmU+
CglGaWxlIGNvbnRhaW5pbmcgdGhlIHByaXZhdGUgY2xpZW50IGtleS4KCgo1LiBOT1RFUwotLS0t
LS0tLQoKRm9yIGJldHRlciBwZXJmb3JtYW5jZSBlbnN1cmUgdGhhdCB0aGUgYXR0cmlidXRlcyBz
cGVjaWZpZWQgaW4gbGRhcF9maWx0ZXIgYXJlCmluZGV4ZWQuICBZb3UgY2FuIGFsc28gZXhwZXJp
bWVudCB3aXRoIGNsaWVudCBzaWRlIGNhY2hpbmcuICBUaGlzIGNhbiBiZSBhCnNpZ25pZmljYW50
IHBlcmZvcm1hbmNlIGdhaW4uICBVc2UgY2xpZW50IHNpZGUgY2FjaGluZyB3aXRoIGNhdXRpb24g
YmVjYXVzZSBpdAppcyBzdGlsbCBhbiBleHBlcmltZW50YWwgT3BlbkxEQVAgY2FsbC4KClRoZSBm
b2xsb3dpbmcgY29uZmlndXJhdGlvbiBzZXR0aW5nIGVuYWJsZXMgY2xpZW50IHNpZGUgY2FjaGlu
ZyBhbmQgaXQKc2V0cyB0aGUgY2FjaGUgc2l6ZSB0byAzMms6CgpsZGFwX2NhY2hlX3R0bDogMzAK
bGRhcF9jYWNoZV9tZW06IDMyNzY4CgpNeSB0ZXN0aW5nIHNob3dzIHRoYXQgJ2N1c3RvbScgaXMg
Mi0zIHRpbWVzIGZhc3RlciB0aGFuICdiaW5kJwpsZGFwX2F1dGhfbWV0aG9kLiAgVGhpcyBpcyBj
YXVzZWQgYmVjYXVzZSBvZiB0d28gZXh0cmEgYmluZHMgcGVyZm9ybWVkIGR1cmluZwp0aGUgJ2Jp
bmQnIGF1dGhlbnRpY2F0aW9uIG1ldGhvZC4gIE9uIHRoZSBvdGhlciBoYW5kLCB0aGUgJ2JpbmQn
IGF1dGhlbnRpY2F0aW9uCm1ldGhvZCBpcyBtb3JlIHNlY3VyZSBiZWNhdXNlIGxkYXBfYmluZF9w
dyBpcyBub3QgZXhwb3NlZC4gCgo2LiBUT0RPCi0tLS0tLS0KCi0gUG9ydCB0byBvdGhlciBsZGFw
IGxpYnJhcmllcwotIFRoZXJlIG1heSBiZSBiaW5kIHByb2JsZW1zIHdoZW4gZm9sbG93aW5nIHJl
ZmVycmFscy4gIE5vcm1hbGx5IHRoaXMgaXMgbm90IGFuCiAgaXNzdWUuICBGaXguCi0gQWxsb3cg
dG8gc3BlY2lmeSBhbiBhdHRyaWJ1dGUgb3RoZXIgdGhhbiB1c2VyUGFzc3dvcmQgZm9yIHVzZSBp
biB0aGUgY3VzdG9tCiAgYXV0aGVudGljYXRpb24gbWV0aG9kLgotIEFkZCBtb3JlIHBhc3N3b3Jk
IGhhc2hlcyBzdWNoIGFzIG1kNSwgc2hhIGV0YwotIE1ha2UgYSBzdWdnZXN0aW9uIChwb3NzaWJs
eSBhbm90aGVyIGF1dGhlbnRpY2F0aW9uIG1ldGhvZD8pCgoKNy4gRkVFREJBQ0sKLS0tLS0tLS0t
LS0KCkZlZWRiYWNrIGlzIG11Y2ggYXBwcmVjaWF0ZWQhICBQbGVhc2UgZHJvcCBtZSBhIG5vdGUg
aWYgeW91IGFyZSBzdWNjZXNzZnVsbHkKdXNpbmcgbGRhcC1lbmFibGVkIHNhc2xhdXRoZC4gIEFu
eSBjb2RlIGltcHJvdmVtZW50cyBhbmQvb3Igc3VnZ2VzdGlvbiBhcmUgd2VsY29tZS4KCklmIHlv
dSBoYXZlIHF1ZXN0aW9ucywgc2VuZCBlbWFpbCB0byBjeXJ1cy1zYXNsQGxpc3RzLmFuZHJldy5j
bXUuZWR1LiAgUGxlYXNlCmluY2x1ZGUgcmVsZXZhbnQgaW5mb3JtYXRpb24gYWJvdXQgeW91ciBz
YXNsYXV0aGQgc2V0dXA6IGF0IG1pbmltdW0gcHJvdmlkZQp5b3VyIHNhc2xhdXRoLmNvbmYsIG91
dHB1dCBmcm9tIHN5c2xvZyBhbmQgd2hpY2ggZGlyZWN0b3J5IHNlcnZlciB5b3UncmUgdXNpbmcu
CgoKOC4gQVVUSE9SCi0tLS0tLS0tLQoKSWdvciBCcmV6YWMgPGlnb3JAaXBhc3MubmV0Pi4K
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>50</attachid>
            <date>2002-06-24 18:22 EDT</date>
            <desc>Changes for saslauthd.8</desc>
            <filename>saslauthd.man</filename>
            <type>text/plain</type>
            <size>3882</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">KioqIGFkZCB1bmRlciBBVVRIRU5USUNBVElPTiBNRUNIQU5JU01TIHNlY3Rpb24KCmxkYXAgICAg
IChBbGwgcGxhdGZvcm1zIHRoYXQgc3VwcG9ydCBPcGVuTERBUCAyLjAgb3IgaGlnaGVyIGxpYnJh
cnkpCgpBdXRoZW50aWNhdGUgYWdhaW5zdCBhbiBsZGFwIHNlcnZlci4gIFRoZSBsZGFwIGNvbmZp
Z3VyYXRpb24gcGFyYW1ldGVycyBhcmUKcmVhZCBmcm9tIC91c3IvbG9jYWwvZXRjL3Nhc2xhdXRo
ZC5jb25mLiAgVGhlIGxvY2F0aW9uIG9mIHRoaXMgZmlsZSBjYW4gYmUKY2hhbmdlZCB3aXRoIHRo
ZSAtTyBwYXJhbWV0ZXIuIFNlZSB0aGUgTERBUCBOT1RFUyBzZWN0aW9uIGZvciB0aGUgbGlzdCBv
ZgphdmFpbGFibGUgcGFyYW1ldGVycy4KCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0KKioqIGFkZCB1bmRlciBGSUxFUyBzZWN0aW9uCgov
dXNyL2xvY2FsL2V0Yy9zYXNsYXV0aGQuY29uZiAgIFRoZSBkZWZhdWx0IGNvbmZpZ3VyYXRpb24g
ZmlsZSBmb3IgbGRhcCBzdXBwb3J0CgotLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tCioqKiBhZGQgTERBUCBOT1RFUyBzZWN0aW9uCgpUaGUg
Zm9sbG93aW5nIGFyZSBhdmFpbGFibGUgbGRhcCBwYXJhbWV0ZXJzLiAgVGhlcmUgYXJlIHF1aXRl
IGEgZmV3IG9mIHRoZXNlLApidXQgb25seSBsZGFwX3NlcnZlcnMgbWF5IG5lZWQgdG8gYmUgc3Bl
Y2lmaWVkLiBUaGUgZGVmYXVsdHMgZm9yIGFsbCBvdGhlcgpwYXJhbWV0ZXJzIGFyZSBhZGVxdWF0
ZSBmb3IgbW9zdCBpbnN0YWxsYXRpb25zLiAgRm9yIGJlc3QgcGVyZm9ybWFuY2UgZW5zdXJlCnRo
YXQgdGhlIGF0dHJpYnV0ZXMgc3BlY2lmaWVkIGluIGxkYXBfZmlsdGVyIGFyZSBpbmRleGVkLiAg
WW91IGNhbiBhbHNvCmV4cGVyaW1lbnQgd2l0aCBjbGllbnQgc2lkZSBjYWNoaW5nLiAgVGhpcyBj
YW4gYmUgYSBzaWduaWZpY2FudCBwZXJmb3JtYW5jZQpnYWluLiAgVXNlIGNsaWVudCBzaWRlIGNh
Y2hpbmcgd2l0aCBjYXV0aW9uIGJlY2F1c2UgaXQgc3RpbGwgYW4gZXhwZXJpbWVudGFsCmZlYXR1
cmUgaW4gT3BlbkxEQVAuCgpsZGFwX3NlcnZlcnM6IDxsZGFwOi8vbG9jYWxob3N0Lz4KCVNwZWNp
ZnkgVVJJKHMpIHJlZmVyaW5nIHRvIExEQVAgc2VydmVyKHMpLCBlLmcuIGxkYXBzOi8vMTAuMS4x
LjI6OTk5Ly4KCVlvdSBjYW4gc3BlY2lmeSBtdWx0aXBsZSBzZXJ2ZXJzIHNlcGFyYXRlZCBieSBh
IHNwYWNlLgoKbGRhcF9iaW5kX2RuOiA8bm9uZT4KCVNwZWNpZnkgRE4gKGRpc3Rpbmd1aXNoZWQg
bmFtZSkgdG8gYmluZCB0byB0aGUgTERBUCBkaXJlY3RvcnkuICBEbyBub3QKCXNwZWNpZnkgdGhp
cyBwYXJhbWV0ZXIgZm9yIHRoZSBhbm9ueW1vdXMgYmluZC4KCmxkYXBfYmluZF9wdzogPG5vbmU+
CglTcGVjaWZ5IHRoZSBwYXNzd29yZCBmb3IgbGRhcF9iaW5kX2RuLiAgRG8gbm90IHNwZWNpZnkg
dGhpcyBwYXJhbWV0ZXIKCWZvciB0aGUgYW5vbnltb3VzIGJpbmQuCgpsZGFwX3ZlcnNpb246IDwz
PiA8MnwzPgoJU3BlY2lmeSB0aGUgTERBUCBwcm90b2NvbCB2ZXJzaW9uIHRvIHVzZS4KCmxkYXBf
dGltZW91dDogPDU+CglTcGVjaWZ5IGEgbnVtYmVyIG9mIHNlY29uZHMgYSBzZWFyY2ggY2FuIHRh
a2UgYmVmb3JlIHRpbWluZyBvdXQuCgpsZGFwX3RpbWVfbGltaXQ6IDw1PgoJU3BlY2lmeSBhIG51
bWJlciBvZiBzZWNvbmRzIGZvciBhIHNlYXJjaCByZXF1ZXN0IHRvIGNvbXBsZXRlLgoKbGRhcF9k
ZXJlZjogPG5vbmU+IDxzZWFyY2h8ZmluZHxhbHdheXN8bmV2ZXI+CglTcGVjaWZ5IGhvdyBhbGlh
c2VzIGRlcmVmZXJlbmNpbmcgaXMgaGFuZGxlZCBkdXJpbmcgYSBzZWFyY2guCgpsZGFwX3JlZmVy
cmFsczogPG5vPgoJU3BlY2lmeSB3aGV0aGVyIG9yIG5vdCB0aGUgY2xpZW50IHNob3VsZCBmb2xs
b3cgcmVmZXJyYWxzLgoKbGRhcF9yZXN0YXJ0OiA8eWVzPgoJU3BlY2lmeSB3aGV0aGVyIG9yIG5v
dCBMREFQIEkvTyBvcGVyYXRpb25zIGFyZSBhdXRvbWF0aWNhbGx5IHJlc3RhcnRlZAoJaWYgdGhl
eSBhYm9ydCBwcmVtYXR1cmVseS4KCmxkYXBfY2FjaGVfdHRsOiA8MD4KCU5vbiB6ZXJvIGVuYWJs
ZXMgY2xpZW50IHNpZGUgY2FjaGluZy4gIENhY2hlZCByZXN1bHRzIHdpbGwgZXhwaXJlIGFmdGVy
CglzcGVjaWZpZWQgbnVtYmVyIHNlY29uZHMsIGUuZy4gMzAuICBVc2UgdGhpcyBvcHRpb24gd2l0
aCBjYXJlLgoJT3BlbkxEQVAgZm9sa3MgY29uc2lkZXIgdGhpcyBmZWF0dXJlIGV4cGVyaW1lbnRh
bC4KCmxkYXBfY2FjaGVfbWVtOiA8MD4KCUlmIHRoZSBjbGllbnQgc2lkZSBjYWNoaW5nIGlzIGVu
YWJsZWQsIHRoZSB2YWx1ZSBzcGVjaWZpZXMgdGhlIGNhY2hlIHNpemUKCWluIGJ5dGVzLCAgZS5n
LiAzMjc2OC4KCQpsZGFwX3Njb3BlOiA8c3ViPiA8c3VifG9uZXxiYXNlPgoJU2VhcmNoIHNjb3Bl
LgoKbGRhcF9zZWFyY2hfYmFzZTogPG5vbmU+CglTcGVjaWZ5IGEgc3RhcnRpbmcgcG9pbnQgZm9y
IHRoZSBzZWFyY2guICBlLmcuIGRjPWZvbyxkYz1jb20KCmxkYXBfYXV0aF9tZXRob2Q6IDxiaW5k
PiA8YmluZHxjdXN0b20+CglTcGVjaWZ5IGFuIGF1dGhlbnRpY2F0aW9uIG1ldGhvZC4gIFRoZSBk
ZWZhdWx0ICdiaW5kJyBtZXRob2QgdXNlcyB0aGUKCUxEQVAgc2ltcGxlIGJpbmQgZmFjaWxpdHkg
dG8gdmVyaWZ5IHRoZSBwYXNzd29yZC4gIFRoZSBjdXN0b20gbWV0aG9kCgl1c2VzIHVzZXJQYXNz
d29yZCBhdHRyaWJ1dGUgdG8gdmVyaWZ5IHRoZSBwYXNzd29yZC4gIEN1cnJlbnRseSwge0NSWVBU
fQoJaGFzaCBpcyBzdXBwb3J0ZWQuCgpsZGFwX2ZpbHRlcjogPHVpZD0ldT4KCVNwZWNpZnkgYSBm
aWx0ZXIuICBVc2UgdGhlICV1IGFuZCAlciB0b2tlbnMgZm9yIHRoZSB1c2VybmFtZSBhbmQgcmVh
bG0KCXN1YnN0aXR1dGlvbi4gIFRoZSAldSB0b2tlbiBoYXMgdG8gYmUgdXNlZCBhdCBtaW5pbXVt
IGZvciB0aGUgZmlsdGVyIHRvCgliZSB1c2VmdWwuICBJZiBsZGFwX2F1dGhfbWV0aG9kIGlzICdi
aW5kJywgdGhlIGZpbHRlciB3aWxsIHNlYXJjaCBmb3IKCXRoZSBETiAoZGlzdGluZ3Vpc2hlZCBu
YW1lKSBhdHRyaWJ1dGUuICBPdGhlcndpc2UsIHRoZSBzZWFyY2ggd2lsbCBsb29rCglmb3IgdGhl
IHVzZXJQYXNzd29yZCBhdHRyaWJ1dGUuCgpsZGFwX2RlYnVnOiA8MD4KCVNwZWNpZnkgYSBkZWJ1
Z2dpbmcgbGV2ZWwgaW4gdGhlIE9wZW5MREFQIGxpYnJhcmllcy4gIFNlZQoJbGRhcF9zZXRfb3B0
aW9uKDMpIGZvciBtb3JlIChMREFQX09QVF9ERUJVR19MRVZFTCkuCgpsZGFwX3Rsc19jaGVja19w
ZWVyOiA8bm8+IDx5ZXN8bm8+CglSZXF1aXJlIGFuZCB2ZXJpZnkgc2VydmVyIGNlcnRpZmljYXRl
LiAgSWYgdGhpcyBvcHRpb24gaXMgeWVzLAoJeW91IG11c3Qgc3BlY2lmeSBsZGFwX3Rsc19jYWNl
cnRfZmlsZSBvciBsZGFwX3Rsc19jYWNlcnRfZGlyLgoKbGRhcF90bHNfY2FjZXJ0X2ZpbGU6IDxu
b25lPgoJRmlsZSBjb250YWluaW5nIENBIChDZXJ0aWZpY2F0ZSBBdXRob3JpdHkpIGNlcnRpZmlj
YXRlKHMpLgoKbGRhcF90bHNfY2FjZXJ0X2RpcjogPG5vbmU+CglQYXRoIHRvIGRpcmVjdG9yeSB3
aXRoIENBIChDZXJ0aWZpY2F0ZSBBdXRob3JpdHkpIGNlcnRpZmljYXRlcy4KCmxkYXBfdGxzX2Np
cGhlcnM6IDxERUZBVUxUPgoJTGlzdCBvZiBTU0wvVExTIGNpcGhlcnMgdG8gYWxsb3cuICBUaGUg
Zm9ybWF0IG9mIHRoZSBzdHJpbmcgaXMKCWRlc2NyaWJlZCBpbiBjaXBoZXJzKDEpLgoKbGRhcF90
bHNfY2VydDogPG5vbmU+CglGaWxlIGNvbnRhaW5pbmcgdGhlIGNsaWVudCBjZXJ0aWZpY2F0ZS4K
CmxkYXBfdGxzX2tleTogPG5vbmU+CglGaWxlIGNvbnRhaW5pbmcgdGhlIHByaXZhdGUgY2xpZW50
IGtleS4K
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>54</attachid>
            <date>2002-07-04 20:07 EDT</date>
            <desc>Improve handling of broken LDAP server connections.</desc>
            <filename>lak.c.diff</filename>
            <type>text/plain</type>
            <size>1359</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LS0tIGxhay5jLm9yaWcJMjAwMi0wNy0wNCAxNTo1NzozMS4yNzUzMTIwMDAgLTA0MDAKKysrIGxh
ay5jCTIwMDItMDctMDQgMTU6NTg6MzMuNzA1MzI1MDAwIC0wNDAwCkBAIC01OTYsOSArNTk2LDEx
IEBACiBzdGF0aWMgaW50IGxha19zZWFyY2goTEFLICpsYWssIGNvbnN0IGNoYXIgKmZpbHRlciwg
Y29uc3QgY2hhciAqKmF0dHJzLCBMREFQTWVzc2FnZSAqKnJlcykKIHsKIAlpbnQgcmMgPSAwOwor
CWludCByZXRyeSA9IDE7CiAKIAkqcmVzID0gTlVMTDsKIAorcmV0cnk6CiAJcmMgPSBsYWtfYmlu
ZChsYWssIExBS19CSU5EX0FOT05ZTU9VUywgbGFrLT5jb25mLT5iaW5kX2RuLCBsYWstPmNvbmYt
PmJpbmRfcHcpOwogCWlmIChyYykgewogCQlzeXNsb2coTE9HX1dBUk5JTkd8TE9HX0FVVEgsICJs
YWtfYmluZCgpIGZhaWxlZCIpOwpAQCAtNjEwLDE4ICs2MTIsMjMgQEAKIAkJY2FzZSBMREFQX1NV
Q0NFU1M6CiAJCWNhc2UgTERBUF9TSVpFTElNSVRfRVhDRUVERUQ6CiAJCQlicmVhazsKLQorCQlj
YXNlIExEQVBfU0VSVkVSX0RPV046CisJCQlpZiAocmV0cnkpIHsKKwkJCQlzeXNsb2coTE9HX1dB
Uk5JTkd8TE9HX0FVVEgsICJsZGFwX3NlYXJjaF9zdCgpIGZhaWxlZDogJXMuIFRyeWluZyB0byBy
ZWNvbm5lY3RpbmcuIiwgbGRhcF9lcnIyc3RyaW5nKHJjKSk7CisJCQkJbGRhcF9tc2dmcmVlKCpy
ZXMpOworCQkJCWxhay0+YmluZF9zdGF0dXMgPSBMQUtfTk9UX0JPVU5EOworCQkJCXJldHJ5ID0g
MDsKKwkJCQlnb3RvIHJldHJ5OworCQkJfQogCQlkZWZhdWx0OgotCQkJc3lzbG9nKExPR19XQVJO
SU5HfExPR19BVVRILCAibGRhcF9zZWFyY2hfc3QoKSBmYWlsZWQ6ICVzIiwgbGRhcF9lcnIyc3Ry
aW5nKHJjKSk7CisJCQlzeXNsb2coTE9HX0VSUnxMT0dfQVVUSCwgImxkYXBfc2VhcmNoX3N0KCkg
ZmFpbGVkOiAlcyIsIGxkYXBfZXJyMnN0cmluZyhyYykpOwogCQkJbGRhcF9tc2dmcmVlKCpyZXMp
OwogCQkJbGFrLT5iaW5kX3N0YXR1cyA9IExBS19OT1RfQk9VTkQ7CiAJCQlyZXR1cm4gTEFLX0ZB
SUw7CiAJfQogCiAJaWYgKChsZGFwX2NvdW50X2VudHJpZXMobGFrLT5sZCwgKnJlcykpICE9IDEp
IHsKLQkJaWYgKGxhay0+Y29uZi0+ZGVidWcpIHsKLQkJCXN5c2xvZyhMT0dfV0FSTklOR3xMT0df
QVVUSCwgIm9iamVjdCBub3QgZm91bmQgb3IgZ290IGFtYmlndW91cyBzZWFyY2ggcmVzdWx0ICgl
cykuIiwgZmlsdGVyKTsKLQkJfQorCQlzeXNsb2coTE9HX0RFQlVHfExPR19BVVRILCAiRW50cnkg
bm90IGZvdW5kIG9yIG1vcmUgdGhhbiBvbmUgZW50cmllcyBmb3VuZCAoJXMpLiIsIGZpbHRlcik7
CiAJCWxkYXBfbXNnZnJlZSgqcmVzKTsKIAkJcmV0dXJuIExBS19GQUlMOwogCX0K
</data>        

          </attachment>
      

    </bug>

</bugzilla>