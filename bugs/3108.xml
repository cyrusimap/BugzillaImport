<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>3108</bug_id>
          
          <creation_ts>2008-10-26 11:27 EDT</creation_ts>
          <short_desc>external-lists for timsieved</short_desc>
          <delta_ts>2010-10-21 09:41:08 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>Sieve</component>
          <version>2.3.x</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>NEW</bug_status>
          
          
          
          
          
          <priority>P5</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Dilyan Palauzov">dilyan.palauzov@aegee.org</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          <cc>awilliam@whitemice.org</cc>
          

      

      

      
          <long_desc isprivate="0">
            <who name="Dilyan Palauzov">dilyan.palauzov@aegee.org</who>
            <bug_when>2008-10-26 11:27:51 EDT</bug_when>
            <thetext>Created an attachment (id=1037)
apply towards cyrus-imap-2.3.13

The supplied patch makes possible the upload via timsieved of scripts containing the &quot;extlists&quot; (external lists) sieve extension (draft-melnikov-sieve-external-lists-01).

It does not touch the bytecode.  Scripts with or without :list will lead to the same bytecode.  The extension is disabled by default, to turn it on one needs to write &quot;sieve_extensions: extlists ...&quot; in imapd.conf .</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Dilyan Palauzov">dilyan.palauzov@aegee.org</who>
            <bug_when>2009-04-19 13:50:54 EDT</bug_when>
            <thetext>Corrections to the patch:
in sieve/soeve.y
 	| REDIRECT rtags STRING   { if (!verify_address($3)) {
is supposed to be
        | REDIRECT rtags STRING   { if ($2-&gt;extlists == 0 &amp;&amp; !verify_address($3))

and
        %type &lt;rtags&gt; rtags
is supposed to be
        %type &lt;rtag&gt; rtags</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Ken Murchison">murch@andrew.cmu.edu</who>
            <bug_when>2009-04-20 06:56:18 EDT</bug_when>
            <thetext>Can you attach and new patch?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Dilyan Palauzov">dilyan.palauzov@aegee.org</who>
            <bug_when>2009-04-20 18:01:05 EDT</bug_when>
            <thetext>Created an attachment (id=1066)
patch for sieve extlists support in cyrus imap 2.3.14

This patch does not touch the generated sieve bytecode, but makes possible the upload of extlists-scripts via timsieved.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Dilyan Palauzov">didopalauzov@aegee.org</who>
            <bug_when>2009-06-02 10:11:03 EDT</bug_when>
            <thetext>Created an attachment (id=1078)
The same patch, but affects the generated sieve bytecode.

This patch adds support for external lists in timsieved and encodes in sieve bytecode the external lists-parameter.  lmtp_sieve.c is supposed to ignore the extlists-information (act as if it was not present).

It is necessary to recompile the uploaded sieve scripts.  This can be done at once with something like:

#/bin/sh
for X in `find /usr/sieve/| grep &quot;\.script$&quot;`
  do
    Y=`sed &quot;s/\(.*\)\.script/\1.bc/&quot; &lt;&lt; _EOF
$X
_EOF`
    `/src/mail/cyrus/cyrus-imapd-2.3.14-patched/sieve/sievec $X $Y`
  done</thetext>
          </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1037</attachid>
            <date>2008-10-26 11:27 EDT</date>
            <desc>apply towards cyrus-imap-2.3.13</desc>
            <filename>timiseved-extlists.diff</filename>
            <type>text/plain</type>
            <size>12272</size>
            <attacher>dilyan.palauzov@aegee.org</attacher>
            
              <data encoding="base64">ZGlmZiAtY3Igb3JpZ2luYWwvbGliL2ltYXBvcHRpb25zIHBhdGNoZWQvbGliL2ltYXBvcHRpb25z
CioqKiBvcmlnaW5hbC9saWIvaW1hcG9wdGlvbnMJMjAwOC0xMC0wOCAxNzoxODoxMi4wMDAwMDAw
MDAgKzAwMDAKLS0tIHBhdGNoZWQvbGliL2ltYXBvcHRpb25zCTIwMDgtMTAtMjYgMTU6MTA6MDku
MDAwMDAwMDAwICswMDAwCioqKioqKioqKioqKioqKgoqKiogOTE5LDkyNSAqKioqCiAgICAgdXNl
cidzIHNjcmlwdHMgcmVzaWRlIG9uIGEgcmVtb3RlIHNlcnZlciAoaW4gYSBNdXJkZXIpLgogICAg
IE90aGVyd2lzZSwgdGltc2lldmVkIHdpbGwgcHJveHkgdHJhZmZpYyB0byB0aGUgcmVtb3RlIHNl
cnZlci4gKi8KICAKISB7ICJzaWV2ZV9leHRlbnNpb25zIiwgImZpbGVpbnRvIHJlamVjdCB2YWNh
dGlvbiBpbWFwZmxhZ3Mgbm90aWZ5IGVudmVsb3BlIHJlbGF0aW9uYWwgcmVnZXggc3ViYWRkcmVz
cyBjb3B5IiwgQklURklFTEQoImZpbGVpbnRvIiwgInJlamVjdCIsICJ2YWNhdGlvbiIsICJpbWFw
ZmxhZ3MiLCAibm90aWZ5IiwgImluY2x1ZGUiLCAiZW52ZWxvcGUiLCAiYm9keSIsICJyZWxhdGlv
bmFsIiwgInJlZ2V4IiwgInN1YmFkZHJlc3MiLCAiY29weSIpIH0KICAvKiBTcGFjZS1zZXBhcmF0
ZWQgbGlzdCBvZiBTaWV2ZSBleHRlbnNpb25zIGFsbG93ZWQgdG8gYmUgdXNlZCBpbgogICAgIHNp
ZXZlIHNjcmlwdHMsIGVuZm9yY2VkIGF0IHN1Ym1pc3Npb24gYnkgdGltc2lldmVkKDgpLiAgQW55
CiAgICAgcHJldmlvdXNseSBpbnN0YWxsZWQgc2NyaXB0IHdpbGwgYmUgdW5hZmZlY3RlZCBieSB0
aGlzIG9wdGlvbiBhbmQKLS0tIDkxOSw5MjUgLS0tLQogICAgIHVzZXIncyBzY3JpcHRzIHJlc2lk
ZSBvbiBhIHJlbW90ZSBzZXJ2ZXIgKGluIGEgTXVyZGVyKS4KICAgICBPdGhlcndpc2UsIHRpbXNp
ZXZlZCB3aWxsIHByb3h5IHRyYWZmaWMgdG8gdGhlIHJlbW90ZSBzZXJ2ZXIuICovCiAgCiEgeyAi
c2lldmVfZXh0ZW5zaW9ucyIsICJmaWxlaW50byByZWplY3QgdmFjYXRpb24gaW1hcGZsYWdzIG5v
dGlmeSBlbnZlbG9wZSByZWxhdGlvbmFsIHJlZ2V4IHN1YmFkZHJlc3MgY29weSIsIEJJVEZJRUxE
KCJmaWxlaW50byIsICJyZWplY3QiLCAidmFjYXRpb24iLCAiaW1hcGZsYWdzIiwgIm5vdGlmeSIs
ICJpbmNsdWRlIiwgImVudmVsb3BlIiwgImJvZHkiLCAicmVsYXRpb25hbCIsICJyZWdleCIsICJz
dWJhZGRyZXNzIiwgImNvcHkiLCAiZXh0bGlzdHMiKSB9CiAgLyogU3BhY2Utc2VwYXJhdGVkIGxp
c3Qgb2YgU2lldmUgZXh0ZW5zaW9ucyBhbGxvd2VkIHRvIGJlIHVzZWQgaW4KICAgICBzaWV2ZSBz
Y3JpcHRzLCBlbmZvcmNlZCBhdCBzdWJtaXNzaW9uIGJ5IHRpbXNpZXZlZCg4KS4gIEFueQogICAg
IHByZXZpb3VzbHkgaW5zdGFsbGVkIHNjcmlwdCB3aWxsIGJlIHVuYWZmZWN0ZWQgYnkgdGhpcyBv
cHRpb24gYW5kCmRpZmYgLWNyIG9yaWdpbmFsL3NpZXZlL2ludGVycC5jIHBhdGNoZWQvc2lldmUv
aW50ZXJwLmMKKioqIG9yaWdpbmFsL3NpZXZlL2ludGVycC5jCTIwMDgtMDMtMjQgMjA6MDg6NDYu
MDAwMDAwMDAwICswMDAwCi0tLSBwYXRjaGVkL3NpZXZlL2ludGVycC5jCTIwMDgtMTAtMjYgMTU6
MTA6MDkuMDAwMDAwMDAwICswMDAwCioqKioqKioqKioqKioqKgoqKiogMTQ1LDE1MCAqKioqCi0t
LSAxNDUsMTUzIC0tLS0KICAJICAgIHN0cmxjYXQoZXh0ZW5zaW9ucywgIiBzdWJhZGRyZXNzIiwg
c2l6ZW9mKGV4dGVuc2lvbnMpKTsKICAJaWYgKGNvbmZpZ19zaWV2ZV9leHRlbnNpb25zICYgSU1B
UF9FTlVNX1NJRVZFX0VYVEVOU0lPTlNfQ09QWSkKICAJICAgIHN0cmxjYXQoZXh0ZW5zaW9ucywg
IiBjb3B5Iiwgc2l6ZW9mKGV4dGVuc2lvbnMpKTsKKyAgICAgICAgIGlmICgvL2ktPmV4dGxpc3Rz
ICYmCisgCSAgICAoY29uZmlnX3NpZXZlX2V4dGVuc2lvbnMgJiBJTUFQX0VOVU1fU0lFVkVfRVhU
RU5TSU9OU19FWFRMSVNUUykpCisgCSAgICBzdHJsY2F0KGV4dGVuc2lvbnMsICIgZXh0bGlzdHMi
LCBzaXplb2YoZXh0ZW5zaW9ucykpOwogICAgICB9CiAgCiAgICAgIHJldHVybiBleHRlbnNpb25z
OwpkaWZmIC1jciBvcmlnaW5hbC9zaWV2ZS9zY3JpcHQuYyBwYXRjaGVkL3NpZXZlL3NjcmlwdC5j
CioqKiBvcmlnaW5hbC9zaWV2ZS9zY3JpcHQuYwkyMDA4LTAzLTI0IDIwOjA4OjQ2LjAwMDAwMDAw
MCArMDAwMAotLS0gcGF0Y2hlZC9zaWV2ZS9zY3JpcHQuYwkyMDA4LTEwLTI2IDE1OjEwOjA5LjAw
MDAwMDAwMCArMDAwMAoqKioqKioqKioqKioqKioKKioqIDE2NSwxNzAgKioqKgotLS0gMTY1LDE3
NCAtLS0tCiAgCSAgICAgICAoY29uZmlnX3NpZXZlX2V4dGVuc2lvbnMgJiBJTUFQX0VOVU1fU0lF
VkVfRVhURU5TSU9OU19DT1BZKSkgewogIAlzLT5zdXBwb3J0LmNvcHkgPSAxOwogIAlyZXR1cm4g
MTsKKyAgICAgfSBlbHNlIGlmICghc3RyY21wKCJleHRsaXN0cyIsIHJlcSkgJiYKKyAJICAgICAg
IChjb25maWdfc2lldmVfZXh0ZW5zaW9ucyAmIElNQVBfRU5VTV9TSUVWRV9FWFRFTlNJT05TX0VY
VExJU1RTKSkgeworIAlzLT5zdXBwb3J0LmV4dGxpc3RzID0gMTsKKyAJcmV0dXJuIDE7CiAgICAg
IH0KICAgICAgcmV0dXJuIDA7CiAgfQpkaWZmIC1jciBvcmlnaW5hbC9zaWV2ZS9zY3JpcHQuaCBw
YXRjaGVkL3NpZXZlL3NjcmlwdC5oCioqKiBvcmlnaW5hbC9zaWV2ZS9zY3JpcHQuaAkyMDA4LTAz
LTI0IDIwOjA4OjQ2LjAwMDAwMDAwMCArMDAwMAotLS0gcGF0Y2hlZC9zaWV2ZS9zY3JpcHQuaAky
MDA4LTEwLTI2IDE1OjEwOjA5LjAwMDAwMDAwMCArMDAwMAoqKioqKioqKioqKioqKioKKioqIDcy
LDc3ICoqKioKLS0tIDcyLDc4IC0tLS0KICAJaW50IGlfYXNjaWlfbnVtZXJpYzogMTsKICAJaW50
IGluY2x1ZGUgICAgICAgIDogMTsKICAJaW50IGNvcHkgICAgICAgICAgIDogMTsKKyAJaW50IGV4
dGxpc3RzICAgICAgIDogMTsKICAgICAgfSBzdXBwb3J0OwogIAogICAgICB2b2lkICpzY3JpcHRf
Y29udGV4dDsKZGlmZiAtY3Igb3JpZ2luYWwvc2lldmUvc2lldmUtbGV4LmMgcGF0Y2hlZC9zaWV2
ZS9zaWV2ZS1sZXguYwoqKiogb3JpZ2luYWwvc2lldmUvc2lldmUtbGV4LmMJMjAwOC0xMC0xNyAx
Mjo1NjoyMC4wMDAwMDAwMDAgKzAwMDAKLS0tIHBhdGNoZWQvc2lldmUvc2lldmUtbGV4LmMJMjAw
OC0xMC0yNiAxNToxMDowOS4wMDAwMDAwMDAgKzAwMDAKKioqKioqKioqKioqKioqCioqKiAzNzUs
MzgxICoqKioKICAJKnl5X2NwID0gJ1wwJzsgXAogIAkoeXlfY19idWZfcCkgPSB5eV9jcDsKICAK
ISAjZGVmaW5lIFlZX05VTV9SVUxFUyA3OAohICNkZWZpbmUgWVlfRU5EX09GX0JVRkZFUiA3OQog
IC8qIFRoaXMgc3RydWN0IGlzIG5vdCB1c2VkIGluIHRoaXMgc2Nhbm5lciwKICAgICBidXQgaXRz
IHByZXNlbmNlIGlzIG5lY2Vzc2FyeS4gKi8KZGlmZiAtY3Igb3JpZ2luYWwvc2lldmUvc2lldmUt
bGV4LmwgcGF0Y2hlZC9zaWV2ZS9zaWV2ZS1sZXgubAoqKiogb3JpZ2luYWwvc2lldmUvc2lldmUt
bGV4LmwJMjAwOC0wMy0yNCAyMDowODo0Ni4wMDAwMDAwMDAgKzAwMDAKLS0tIHBhdGNoZWQvc2ll
dmUvc2lldmUtbGV4LmwJMjAwOC0xMC0yNiAxNToxMDowOS4wMDAwMDAwMDAgKzAwMDAKKioqKioq
KioqKioqKioqCioqKiAxNjAsMTY1ICoqKioKLS0tIDE2MCwxNjYgLS0tLQogIDxJTklUSUFMPjpn
bG9iYWwJcmV0dXJuIEdMT0JBTDsKICA8SU5JVElBTD5yZXR1cm4JCXJldHVybiBSRVRVUk47CiAg
PElOSVRJQUw+OmNvcHkJCXJldHVybiBDT1BZOworIDxJTklUSUFMPjpsaXN0ICAgICAgICAgIHJl
dHVybiBMSVNUOwogIDxJTklUSUFMPlsgXHRcblxyXSA7CS8qIGlnbm9yZSB3aGl0ZXNwYWNlICov
CiAgPElOSVRJQUw+Iy4qIDsJCS8qIGlnbm9yZSBoYXNoIGNvbW1lbnRzICovCiAgPElOSVRJQUw+
Ii8qIihbXlwqXXxcKlteXC9dKSpcKj8iKi8iIDsJLyogaWdub3JlIGJyYWNrZXQgY29tbWVudHMg
Ki8KZGlmZiAtY3Igb3JpZ2luYWwvc2lldmUvc2lldmUueSBwYXRjaGVkL3NpZXZlL3NpZXZlLnkK
KioqIG9yaWdpbmFsL3NpZXZlL3NpZXZlLnkJMjAwOC0xMC0wMiAxMzozNjo1Ni4wMDAwMDAwMDAg
KzAwMDAKLS0tIHBhdGNoZWQvc2lldmUvc2lldmUueQkyMDA4LTEwLTI2IDE1OjEwOjA5LjAwMDAw
MDAwMCArMDAwMAoqKioqKioqKioqKioqKioKKioqIDY2LDcxICoqKioKLS0tIDY2LDc2IC0tLS0K
ICAgICAgLyogZGVmaW5pdGlvbnMgKi8KICAgICAgZXh0ZXJuIGludCBhZGRycGFyc2Uodm9pZCk7
CiAgCisgc3RydWN0IHJ0YWdzIHsKKyAgIGNoYXIgY29weTsKKyAgIGNoYXIgZXh0bGlzdHM7Cisg
fTsKKyAKICBzdHJ1Y3QgdnRhZ3MgewogICAgICBpbnQgZGF5czsKICAgICAgc3RyaW5nbGlzdF90
ICphZGRyZXNzZXM7CioqKioqKioqKioqKioqKgoqKiogNzksODQgKioqKgotLS0gODQsOTAgLS0t
LQogICAgICBjaGFyICpjb21wYXJhdG9yOwogICAgICBpbnQgY29tcHRhZzsKICAgICAgaW50IHJl
bGF0aW9uOworICAgICBjaGFyIGV4dGxpc3RzOwogIH07CiAgCiAgc3RydWN0IGFldGFncyB7Cioq
KioqKioqKioqKioqKgoqKiogODYsOTEgKioqKgotLS0gOTIsOTggLS0tLQogICAgICBjaGFyICpj
b21wYXJhdG9yOwogICAgICBpbnQgY29tcHRhZzsKICAgICAgaW50IHJlbGF0aW9uOworICAgICBj
aGFyIGV4dGxpc3RzOwogIH07CiAgCiAgc3RydWN0IGJ0YWdzIHsKKioqKioqKioqKioqKioqCioq
KiAxMjQsMTMwICoqKioKICBzdGF0aWMgY29tbWFuZGxpc3RfdCAqYnVpbGRfbm90aWZ5KGludCB0
LCBzdHJ1Y3QgbnRhZ3MgKm4pOwogIHN0YXRpYyBjb21tYW5kbGlzdF90ICpidWlsZF9kZW5vdGlm
eShpbnQgdCwgc3RydWN0IGR0YWdzICpuKTsKICBzdGF0aWMgY29tbWFuZGxpc3RfdCAqYnVpbGRf
ZmlsZWludG8oaW50IHQsIGludCBjLCBjaGFyICpmKTsKISBzdGF0aWMgY29tbWFuZGxpc3RfdCAq
YnVpbGRfcmVkaXJlY3QoaW50IHQsIGludCBjLCBjaGFyICphKTsKICBzdGF0aWMgc3RydWN0IGFl
dGFncyAqbmV3X2FldGFncyh2b2lkKTsKICBzdGF0aWMgc3RydWN0IGFldGFncyAqY2Fub25fYWV0
YWdzKHN0cnVjdCBhZXRhZ3MgKmFlKTsKICBzdGF0aWMgdm9pZCBmcmVlX2FldGFncyhzdHJ1Y3Qg
YWV0YWdzICphZSk7Ci0tLSAxMzEsMTM5IC0tLS0KICBzdGF0aWMgY29tbWFuZGxpc3RfdCAqYnVp
bGRfbm90aWZ5KGludCB0LCBzdHJ1Y3QgbnRhZ3MgKm4pOwogIHN0YXRpYyBjb21tYW5kbGlzdF90
ICpidWlsZF9kZW5vdGlmeShpbnQgdCwgc3RydWN0IGR0YWdzICpuKTsKICBzdGF0aWMgY29tbWFu
ZGxpc3RfdCAqYnVpbGRfZmlsZWludG8oaW50IHQsIGludCBjLCBjaGFyICpmKTsKISBzdGF0aWMg
Y29tbWFuZGxpc3RfdCAqYnVpbGRfcmVkaXJlY3QoaW50IHQsIHN0cnVjdCBydGFncyAqYywgY2hh
ciAqYSk7CiEgc3RhdGljIHN0cnVjdCBydGFncyAqbmV3X3J0YWdzKHZvaWQpOwohIHN0YXRpYyB2
b2lkIGZyZWVfcnRhZ3Moc3RydWN0IHJ0YWdzICpyKTsKICBzdGF0aWMgc3RydWN0IGFldGFncyAq
bmV3X2FldGFncyh2b2lkKTsKICBzdGF0aWMgc3RydWN0IGFldGFncyAqY2Fub25fYWV0YWdzKHN0
cnVjdCBhZXRhZ3MgKmFlKTsKICBzdGF0aWMgdm9pZCBmcmVlX2FldGFncyhzdHJ1Y3QgYWV0YWdz
ICphZSk7CioqKioqKioqKioqKioqKgoqKiogMTc0LDE3OSAqKioqCi0tLSAxODMsMTg5IC0tLS0K
ICAgICAgY29tbWFuZGxpc3RfdCAqY2w7CiAgICAgIHN0cnVjdCB2dGFncyAqdnRhZzsKICAgICAg
c3RydWN0IGFldGFncyAqYWV0YWc7CisgICAgIHN0cnVjdCBydGFncyAqcnRhZ3M7CiAgICAgIHN0
cnVjdCBodGFncyAqaHRhZzsKICAgICAgc3RydWN0IGJ0YWdzICpidGFnOwogICAgICBzdHJ1Y3Qg
bnRhZ3MgKm50YWc7CioqKioqKioqKioqKioqKgoqKiogMTk0LDIwMCAqKioqCiAgJXRva2VuIERB
WVMgQUREUkVTU0VTIFNVQkpFQ1QgRlJPTSBIQU5ETEUgTUlNRQogICV0b2tlbiBNRVRIT0QgSUQg
T1BUSU9OUyBMT1cgTk9STUFMIEhJR0ggQU5ZIE1FU1NBR0UKICAldG9rZW4gSU5DTFVERSBQRVJT
T05BTCBHTE9CQUwgUkVUVVJOCiEgJXRva2VuIENPUFkKICAKICAldHlwZSA8Y2w+IGNvbW1hbmRz
IGNvbW1hbmQgYWN0aW9uIGVsc2lmIGJsb2NrCiAgJXR5cGUgPHNsPiBzdHJpbmdsaXN0IHN0cmlu
Z3MKLS0tIDIwNCwyMTAgLS0tLQogICV0b2tlbiBEQVlTIEFERFJFU1NFUyBTVUJKRUNUIEZST00g
SEFORExFIE1JTUUKICAldG9rZW4gTUVUSE9EIElEIE9QVElPTlMgTE9XIE5PUk1BTCBISUdIIEFO
WSBNRVNTQUdFCiAgJXRva2VuIElOQ0xVREUgUEVSU09OQUwgR0xPQkFMIFJFVFVSTgohICV0b2tl
biBDT1BZIExJU1QKICAKICAldHlwZSA8Y2w+IGNvbW1hbmRzIGNvbW1hbmQgYWN0aW9uIGVsc2lm
IGJsb2NrCiAgJXR5cGUgPHNsPiBzdHJpbmdsaXN0IHN0cmluZ3MKKioqKioqKioqKioqKioqCioq
KiAyMDMsMjA4ICoqKioKLS0tIDIxMywyMTkgLS0tLQogICV0eXBlIDx0ZXN0bD4gdGVzdGxpc3Qg
dGVzdHMKICAldHlwZSA8aHRhZz4gaHRhZ3MKICAldHlwZSA8YWV0YWc+IGFldGFncworICV0eXBl
IDxydGFncz4gcnRhZ3MKICAldHlwZSA8YnRhZz4gYnRhZ3MKICAldHlwZSA8dnRhZz4gdnRhZ3MK
ICAldHlwZSA8bnRhZz4gbnRhZ3MKKioqKioqKioqKioqKioqCioqKiAyNTYsMjYyICoqKioKICAJ
CQkJICAgICBZWUVSUk9SOyAvKiB2bSBzaG91bGQgY2FsbCB5eWVycm9yKCkgKi8KICAJCQkJICAg
fQogIAkgICAgICAgICAgICAgICAgICAgICAgICAgICAkJCA9IGJ1aWxkX2ZpbGVpbnRvKEZJTEVJ
TlRPLCAkMiwgJDMpOyB9CiEgCXwgUkVESVJFQ1QgY29weSBTVFJJTkcgICB7IGlmICghdmVyaWZ5
X2FkZHJlc3MoJDMpKSB7CiAgCQkJCSAgICAgWVlFUlJPUjsgLyogdmEgc2hvdWxkIGNhbGwgeXll
cnJvcigpICovCiAgCQkJCSAgIH0KICAJICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQgPSBi
dWlsZF9yZWRpcmVjdChSRURJUkVDVCwgJDIsICQzKTsgfQotLS0gMjY3LDI3MyAtLS0tCiAgCQkJ
CSAgICAgWVlFUlJPUjsgLyogdm0gc2hvdWxkIGNhbGwgeXllcnJvcigpICovCiAgCQkJCSAgIH0K
ICAJICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQgPSBidWlsZF9maWxlaW50byhGSUxFSU5U
TywgJDIsICQzKTsgfQohIAl8IFJFRElSRUNUIHJ0YWdzIFNUUklORyAgIHsgaWYgKCF2ZXJpZnlf
YWRkcmVzcygkMykpIHsKICAJCQkJICAgICBZWUVSUk9SOyAvKiB2YSBzaG91bGQgY2FsbCB5eWVy
cm9yKCkgKi8KICAJCQkJICAgfQogIAkgICAgICAgICAgICAgICAgICAgICAgICAgICAkJCA9IGJ1
aWxkX3JlZGlyZWN0KFJFRElSRUNULCAkMiwgJDMpOyB9CioqKioqKioqKioqKioqKgoqKiogMzQ3
LDM1MiAqKioqCi0tLSAzNTgsMzg0IC0tLS0KICAJfCBHTE9CQUwJCSB7ICQkID0gR0xPQkFMOyB9
CiAgCTsKICAKKyBydGFnczogLyogZW1wdHkgKi8JCSB7ICQkID0gbmV3X3J0YWdzKCk7IH0KKyAJ
fCBydGFncyBDT1BZCQkgeyAkJCA9ICQxOworICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgaWYgKCFwYXJzZV9zY3JpcHQtPnN1cHBvcnQuY29weSkgeworIAkJCQkgICAgIHl5ZXJy
b3IoImNvcHkgTVVTVCBiZSBlbmFibGVkIHdpdGggXCJyZXF1aXJlXCIiKTsKKyAJCQkJICAgICBZ
WUVSUk9SOworIAkJCQkgICB9IGVsc2UKKyAJCQkJICAgaWYgKCQkLT5jb3B5ICE9IDApIHsKKyAJ
CQkJCXl5ZXJyb3IoImR1cGxpY2F0ZSA6Y29weSIpOyBZWUVSUk9SOyB9CisgCQkJCSAgIGVsc2Ug
eyQkLT5jb3B5ID0gMTt9CisgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfQorIAl8
IHJ0YWdzIExJU1QJCSB7ICQkID0gJDE7CisgCQkJCSAgIGlmICghcGFyc2Vfc2NyaXB0LT5zdXBw
b3J0LmV4dGxpc3RzKSB7CisgCQkJCSAgICAgeXllcnJvcigiZXh0bGlzdHMgTVVTVCBiZSBlbmFi
bGVkIHdpdGggXCJyZXF1aXJlXCIiKTsKKyAJCQkJICAgICBZWUVSUk9SOworIAkJCQkgICB9IGVs
c2UKKyAJCQkJICAgaWYgKCQkLT5leHRsaXN0cyAhPSAwKSB7CisgCQkJCQl5eWVycm9yKCJkdXBs
aWNhdGUgOmxpc3QiKTsgWVlFUlJPUjsgfQorIAkJCQkgICBlbHNlIHskJC0+ZXh0bGlzdHMgPSAx
O30KKyAJCQkJIH0KKyAJOworIAogIG50YWdzOiAvKiBlbXB0eSAqLwkJIHsgJCQgPSBuZXdfbnRh
Z3MoKTsgfQogIAl8IG50YWdzIElEIFNUUklORwkgeyBpZiAoJCQtPmlkICE9IE5VTEwpIHsgCiAg
CQkJCQl5eWVycm9yKCJkdXBsaWNhdGUgOm1ldGhvZCIpOyBZWUVSUk9SOyB9CioqKioqKioqKioq
KioqKgoqKiogNTY0LDU2OSAqKioqCi0tLSA1OTYsNjA4IC0tLS0KICAJCQl5eWVycm9yKCJjb21w
YXJhdG9yLWk7YXNjaWktbnVtZXJpYyBNVVNUIGJlIGVuYWJsZWQgd2l0aCBcInJlcXVpcmVcIiIp
OwogIAkJCVlZRVJST1I7IH0KICAJCQkJICAgZWxzZSB7ICQkLT5jb21wYXJhdG9yID0gJDM7IH0g
fQorIAl8IGFldGFncyBMSVNUCQl7ICQkID0gJDE7CisgICAgICAgICAgICAgICAgCSAgICAgICAg
ICAgIAkgIGlmICgkJC0+ZXh0bGlzdHMgIT0gMCkgeworIAkJCXl5ZXJyb3IoImR1cGxpY2F0ZSA6
bGlzdCIpOyBZWUVSUk9SOyB9CisgCQkJCSAgZWxzZSBpZiAoIXBhcnNlX3NjcmlwdC0+c3VwcG9y
dC5leHRsaXN0cykgeworIAkJCQkgICAgeXllcnJvcigiZXh0bGlzdHMgTVVTVCBiZSBlbmFibGVk
IHdpdGggXCJyZXF1aXJlXCIiKTsKKyAJCQkJICAgIFlZRVJST1I7IH0KKyAJCQkJICBlbHNlIHsg
JCQtPmV4dGxpc3RzID0gMTsgfSB9CiAgCTsKICAKICBodGFnczogLyogZW1wdHkgKi8JCSB7ICQk
ID0gbmV3X2h0YWdzKCk7IH0KKioqKioqKioqKioqKioqCioqKiA1ODcsNTkyICoqKioKLS0tIDYy
Niw2MzcgLS0tLQogIAkJCSB5eWVycm9yKCJjb21wYXJhdG9yLWk7YXNjaWktbnVtZXJpYyBNVVNU
IGJlIGVuYWJsZWQgd2l0aCBcInJlcXVpcmVcIiIpOyAgWVlFUlJPUjsgfQogIAkJCQkgICBlbHNl
IHsgCiAgCQkJCSAgICAgJCQtPmNvbXBhcmF0b3IgPSAkMzsgfSB9CisgCXwgaHRhZ3MgTElTVAkJ
ICB7ICQkID0gJDE7CisgCQkJCSAgIGlmICgkJC0+ZXh0bGlzdHMgIT0gMCkgeworIAkJCXl5ZXJy
b3IoImR1cGxpY2F0ZSA6bGlzdCIpOyBZWUVSUk9SOyB9CisgCQkJCSAgIGVsc2UgaWYgKCFwYXJz
ZV9zY3JpcHQtPnN1cHBvcnQuZXh0bGlzdHMpIHsKKyAJCQl5eWVycm9yKCJleHRsaXN0cyBNVVNU
IGJlIGVuYWJsZWQgd2l0aCBcInJlcXVpcmVcIiIpOyBZWUVSUk9SOyB9CisgCQkJCSAgIGVsc2Ug
eyAkJC0+ZXh0bGlzdHMgPSAxOyB9IH0KICAgICAgICAgIDsKICAKICBidGFnczogLyogZW1wdHkg
Ki8JCSB7ICQkID0gbmV3X2J0YWdzKCk7IH0KKioqKioqKioqKioqKioqCioqKiA3NDksNzU0ICoq
KioKLS0tIDc5NCw4MDAgLS0tLQogIAlyZXQtPnUuYWUuc2wgPSBzbDsKICAJcmV0LT51LmFlLnBs
ID0gcGw7CiAgCXJldC0+dS5hZS5hZGRycGFydCA9IGFlLT5hZGRydGFnOworIAlyZXQtPnUuYWUu
ZXh0bGlzdHMgPSBhZS0+ZXh0bGlzdHM7CiAgCWZyZWVfYWV0YWdzKGFlKTsKICAKICAgICAgfQoq
KioqKioqKioqKioqKioKKioqIDc2OCw3NzMgKioqKgotLS0gODE0LDgyMCAtLS0tCiAgCXJldC0+
dS5oLmNvbXBhcmF0b3I9eHN0cmR1cChoLT5jb21wYXJhdG9yKTsKICAJcmV0LT51Lmguc2wgPSBz
bDsKICAJcmV0LT51LmgucGwgPSBwbDsKKyAJcmV0LT51LmguZXh0bGlzdHMgPSBoLT5leHRsaXN0
czsKICAJZnJlZV9odGFncyhoKTsKICAgICAgfQogICAgICByZXR1cm4gcmV0OwoqKioqKioqKioq
KioqKioKKioqIDg2Myw4ODcgKioqKgogICAgICByZXR1cm4gcmV0OwogIH0KICAKISBzdGF0aWMg
Y29tbWFuZGxpc3RfdCAqYnVpbGRfcmVkaXJlY3QoaW50IHQsIGludCBjb3B5LCBjaGFyICphZGRy
ZXNzKQogIHsKICAgICAgY29tbWFuZGxpc3RfdCAqcmV0ID0gbmV3X2NvbW1hbmQodCk7CiAgCiAg
ICAgIGFzc2VydCh0ID09IFJFRElSRUNUKTsKICAKICAgICAgaWYgKHJldCkgewohIAlyZXQtPnUu
ci5jb3B5ID0gY29weTsKICAJcmV0LT51LnIuYWRkcmVzcyA9IGFkZHJlc3M7CiAgICAgIH0KICAg
ICAgcmV0dXJuIHJldDsKICB9CiAgCiAgc3RhdGljIHN0cnVjdCBhZXRhZ3MgKm5ld19hZXRhZ3Mo
dm9pZCkKICB7CiAgICAgIHN0cnVjdCBhZXRhZ3MgKnIgPSAoc3RydWN0IGFldGFncyAqKSB4bWFs
bG9jKHNpemVvZihzdHJ1Y3QgYWV0YWdzKSk7CiAgCiAgICAgIHItPmFkZHJ0YWcgPSByLT5jb21w
dGFnID0gci0+cmVsYXRpb249LTE7CiAgICAgIHItPmNvbXBhcmF0b3I9TlVMTDsKICAKICAgICAg
cmV0dXJuIHI7CiAgfQotLS0gOTEwLDk1MiAtLS0tCiAgICAgIHJldHVybiByZXQ7CiAgfQogIAoh
IHN0YXRpYyBjb21tYW5kbGlzdF90ICpidWlsZF9yZWRpcmVjdChpbnQgdCwgc3RydWN0IHJ0YWdz
KiByLCBjaGFyICphZGRyZXNzKQogIHsKICAgICAgY29tbWFuZGxpc3RfdCAqcmV0ID0gbmV3X2Nv
bW1hbmQodCk7CiAgCiAgICAgIGFzc2VydCh0ID09IFJFRElSRUNUKTsKICAKICAgICAgaWYgKHJl
dCkgewohIAlyZXQtPnUuci5jb3B5ID0gci0+Y29weTsKISAJcmV0LT51LnIuZXh0bGlzdHMgPSBy
LT5leHRsaXN0czsKICAJcmV0LT51LnIuYWRkcmVzcyA9IGFkZHJlc3M7CisgCWZyZWUocik7CiAg
ICAgIH0KICAgICAgcmV0dXJuIHJldDsKICB9CiAgCisgc3RhdGljIHN0cnVjdCBydGFncyAqbmV3
X3J0YWdzKHZvaWQpCisgeworICAgICBzdHJ1Y3QgcnRhZ3MgKnIgPSAoc3RydWN0IHJ0YWdzICop
IHhtYWxsb2Moc2l6ZW9mKHN0cnVjdCBydGFncykpOworIAorICAgICByLT5leHRsaXN0cyA9IDA7
CisgICAgIHItPmNvcHkgPSAwOworIAorICAgICByZXR1cm4gcjsKKyB9CisgCisgc3RhdGljIHZv
aWQgZnJlZV9ydGFncyhzdHJ1Y3QgcnRhZ3MgKnIpCisgeworICAgICBmcmVlKHIpOworIH0KKyAK
ICBzdGF0aWMgc3RydWN0IGFldGFncyAqbmV3X2FldGFncyh2b2lkKQogIHsKICAgICAgc3RydWN0
IGFldGFncyAqciA9IChzdHJ1Y3QgYWV0YWdzICopIHhtYWxsb2Moc2l6ZW9mKHN0cnVjdCBhZXRh
Z3MpKTsKICAKICAgICAgci0+YWRkcnRhZyA9IHItPmNvbXB0YWcgPSByLT5yZWxhdGlvbj0tMTsK
ICAgICAgci0+Y29tcGFyYXRvcj1OVUxMOworICAgICByLT5leHRsaXN0cyA9IDA7CiAgCiAgICAg
IHJldHVybiByOwogIH0KKioqKioqKioqKioqKioqCioqKiA5MDcsOTEzICoqKioKICAgICAgc3Ry
dWN0IGh0YWdzICpyID0gKHN0cnVjdCBodGFncyAqKSB4bWFsbG9jKHNpemVvZihzdHJ1Y3QgaHRh
Z3MpKTsKICAKICAgICAgci0+Y29tcHRhZyA9IHItPnJlbGF0aW9uPSAtMTsKISAgICAgCiAgICAg
IHItPmNvbXBhcmF0b3IgPSBOVUxMOwogIAogICAgICByZXR1cm4gcjsKLS0tIDk3Miw5NzggLS0t
LQogICAgICBzdHJ1Y3QgaHRhZ3MgKnIgPSAoc3RydWN0IGh0YWdzICopIHhtYWxsb2Moc2l6ZW9m
KHN0cnVjdCBodGFncykpOwogIAogICAgICByLT5jb21wdGFnID0gci0+cmVsYXRpb249IC0xOwoh
ICAgICByLT5leHRsaXN0cyA9IDA7CiAgICAgIHItPmNvbXBhcmF0b3IgPSBOVUxMOwogIAogICAg
ICByZXR1cm4gcjsKZGlmZiAtY3Igb3JpZ2luYWwvc2lldmUvdHJlZS5oIHBhdGNoZWQvc2lldmUv
dHJlZS5oCioqKiBvcmlnaW5hbC9zaWV2ZS90cmVlLmgJMjAwOC0wMy0yNCAyMDowODo0Ny4wMDAw
MDAwMDAgKzAwMDAKLS0tIHBhdGNoZWQvc2lldmUvdHJlZS5oCTIwMDgtMTAtMjYgMTU6MTA6MDku
MDAwMDAwMDAwICswMDAwCioqKioqKioqKioqKioqKgoqKiogODIsODcgKioqKgotLS0gODIsODgg
LS0tLQogIAkgICAgY2hhciAqIGNvbXBhcmF0b3I7CiAgCSAgICBpbnQgcmVsYXRpb247CiAgCSAg
ICB2b2lkICpjb21wcm9jazsKKyAJICAgIGNoYXIgZXh0bGlzdHM7CiAgCSAgICBzdHJpbmdsaXN0
X3QgKnNsOwogIAkgICAgc3RyaW5nbGlzdF90ICpwbDsKICAJfSBoOwoqKioqKioqKioqKioqKioK
KioqIDg5LDk0ICoqKioKLS0tIDkwLDk2IC0tLS0KICAJICAgIGludCBjb21wdGFnOwogIAkgICAg
Y2hhciAqIGNvbXBhcmF0b3I7CiAgCSAgICBpbnQgcmVsYXRpb247IAorIAkgICAgY2hhciBleHRs
aXN0czsKICAJICAgIHZvaWQgKmNvbXByb2NrOwogIAkgICAgc3RyaW5nbGlzdF90ICpzbDsKICAJ
ICAgIHN0cmluZ2xpc3RfdCAqcGw7CioqKioqKioqKioqKioqKgoqKiogMTM5LDE0NCAqKioqCi0t
LSAxNDEsMTQ3IC0tLS0KICAJc3RydWN0IHsgLyogaXQncyBhIHJlZGlyZWN0IGFjdGlvbiAqLwog
IAkgICAgY2hhciAqYWRkcmVzczsKICAJICAgIGludCBjb3B5OworIAkgICAgY2hhciBleHRsaXN0
czsKICAJfSByOwogIAlzdHJ1Y3QgeyAvKiBpdCdzIGEgdmFjYXRpb24gYWN0aW9uICovCiAgCSAg
ICBjaGFyICpzdWJqZWN0Owo=
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>1066</attachid>
            <date>2009-04-20 18:01 EDT</date>
            <desc>patch for sieve extlists support in cyrus imap 2.3.14</desc>
            <filename>extlists_cyrus_2.3.14.patch</filename>
            <type>text/plain</type>
            <size>12846</size>
            <attacher>dilyan.palauzov@aegee.org</attacher>
            
              <data encoding="base64">ZGlmZiAtY3IgY3lydXMtaW1hcGQtMi4zLjE0L2xpYi9pbWFwb3B0aW9ucyBjeXJ1cy1pbWFwZC0y
LjMuMTQtcGF0Y2hlZC9saWIvaW1hcG9wdGlvbnMKKioqIGN5cnVzLWltYXBkLTIuMy4xNC9saWIv
aW1hcG9wdGlvbnMJMjAwOS0wMy0wNiAwMzo1Mjo1NS4wMDAwMDAwMDAgKzAwMDAKLS0tIGN5cnVz
LWltYXBkLTIuMy4xNC1wYXRjaGVkL2xpYi9pbWFwb3B0aW9ucwkyMDA5LTA0LTE5IDE3OjE1OjE3
LjAwMDAwMDAwMCArMDAwMAoqKioqKioqKioqKioqKioKKioqIDkzMSw5MzcgKioqKgogICAgIHVz
ZXIncyBzY3JpcHRzIHJlc2lkZSBvbiBhIHJlbW90ZSBzZXJ2ZXIgKGluIGEgTXVyZGVyKS4KICAg
ICBPdGhlcndpc2UsIHRpbXNpZXZlZCB3aWxsIHByb3h5IHRyYWZmaWMgdG8gdGhlIHJlbW90ZSBz
ZXJ2ZXIuICovCiAgCiEgeyAic2lldmVfZXh0ZW5zaW9ucyIsICJmaWxlaW50byByZWplY3QgdmFj
YXRpb24gaW1hcGZsYWdzIG5vdGlmeSBlbnZlbG9wZSByZWxhdGlvbmFsIHJlZ2V4IHN1YmFkZHJl
c3MgY29weSIsIEJJVEZJRUxEKCJmaWxlaW50byIsICJyZWplY3QiLCAidmFjYXRpb24iLCAiaW1h
cGZsYWdzIiwgIm5vdGlmeSIsICJpbmNsdWRlIiwgImVudmVsb3BlIiwgImJvZHkiLCAicmVsYXRp
b25hbCIsICJyZWdleCIsICJzdWJhZGRyZXNzIiwgImNvcHkiKSB9CiAgLyogU3BhY2Utc2VwYXJh
dGVkIGxpc3Qgb2YgU2lldmUgZXh0ZW5zaW9ucyBhbGxvd2VkIHRvIGJlIHVzZWQgaW4KICAgICBz
aWV2ZSBzY3JpcHRzLCBlbmZvcmNlZCBhdCBzdWJtaXNzaW9uIGJ5IHRpbXNpZXZlZCg4KS4gIEFu
eQogICAgIHByZXZpb3VzbHkgaW5zdGFsbGVkIHNjcmlwdCB3aWxsIGJlIHVuYWZmZWN0ZWQgYnkg
dGhpcyBvcHRpb24gYW5kCi0tLSA5MzEsOTM3IC0tLS0KICAgICB1c2VyJ3Mgc2NyaXB0cyByZXNp
ZGUgb24gYSByZW1vdGUgc2VydmVyIChpbiBhIE11cmRlcikuCiAgICAgT3RoZXJ3aXNlLCB0aW1z
aWV2ZWQgd2lsbCBwcm94eSB0cmFmZmljIHRvIHRoZSByZW1vdGUgc2VydmVyLiAqLwogIAohIHsg
InNpZXZlX2V4dGVuc2lvbnMiLCAiZmlsZWludG8gcmVqZWN0IHZhY2F0aW9uIGltYXBmbGFncyBu
b3RpZnkgZW52ZWxvcGUgcmVsYXRpb25hbCByZWdleCBzdWJhZGRyZXNzIGNvcHkiLCBCSVRGSUVM
RCgiZmlsZWludG8iLCAicmVqZWN0IiwgInZhY2F0aW9uIiwgImltYXBmbGFncyIsICJub3RpZnki
LCAiaW5jbHVkZSIsICJlbnZlbG9wZSIsICJib2R5IiwgInJlbGF0aW9uYWwiLCAicmVnZXgiLCAi
c3ViYWRkcmVzcyIsICJjb3B5IiwgImV4dGxpc3RzIikgfQogIC8qIFNwYWNlLXNlcGFyYXRlZCBs
aXN0IG9mIFNpZXZlIGV4dGVuc2lvbnMgYWxsb3dlZCB0byBiZSB1c2VkIGluCiAgICAgc2lldmUg
c2NyaXB0cywgZW5mb3JjZWQgYXQgc3VibWlzc2lvbiBieSB0aW1zaWV2ZWQoOCkuICBBbnkKICAg
ICBwcmV2aW91c2x5IGluc3RhbGxlZCBzY3JpcHQgd2lsbCBiZSB1bmFmZmVjdGVkIGJ5IHRoaXMg
b3B0aW9uIGFuZApkaWZmIC1jciBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvaW50ZXJwLmMgY3ly
dXMtaW1hcGQtMi4zLjE0LXBhdGNoZWQvc2lldmUvaW50ZXJwLmMKKioqIGN5cnVzLWltYXBkLTIu
My4xNC9zaWV2ZS9pbnRlcnAuYwkyMDA4LTAzLTI0IDIwOjA4OjQ2LjAwMDAwMDAwMCArMDAwMAot
LS0gY3lydXMtaW1hcGQtMi4zLjE0LXBhdGNoZWQvc2lldmUvaW50ZXJwLmMJMjAwOS0wNC0xOSAx
NzoxNjoxNy4wMDAwMDAwMDAgKzAwMDAKKioqKioqKioqKioqKioqCioqKiAxNDUsMTUwICoqKioK
LS0tIDE0NSwxNTMgLS0tLQogIAkgICAgc3RybGNhdChleHRlbnNpb25zLCAiIHN1YmFkZHJlc3Mi
LCBzaXplb2YoZXh0ZW5zaW9ucykpOwogIAlpZiAoY29uZmlnX3NpZXZlX2V4dGVuc2lvbnMgJiBJ
TUFQX0VOVU1fU0lFVkVfRVhURU5TSU9OU19DT1BZKQogIAkgICAgc3RybGNhdChleHRlbnNpb25z
LCAiIGNvcHkiLCBzaXplb2YoZXh0ZW5zaW9ucykpOworICAgICAgICAgaWYgKC8vaS0+ZXh0bGlz
dHMgJiYKKyAgCSAgICAoY29uZmlnX3NpZXZlX2V4dGVuc2lvbnMgJiBJTUFQX0VOVU1fU0lFVkVf
RVhURU5TSU9OU19FWFRMSVNUUykpCisgCSAgICBzdHJsY2F0KGV4dGVuc2lvbnMsICIgZXh0bGlz
dHMiLCBzaXplb2YoZXh0ZW5zaW9ucykpOwogICAgICB9CiAgCiAgICAgIHJldHVybiBleHRlbnNp
b25zOwpkaWZmIC1jciBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvc2NyaXB0LmMgY3lydXMtaW1h
cGQtMi4zLjE0LXBhdGNoZWQvc2lldmUvc2NyaXB0LmMKKioqIGN5cnVzLWltYXBkLTIuMy4xNC9z
aWV2ZS9zY3JpcHQuYwkyMDA4LTAzLTI0IDIwOjA4OjQ2LjAwMDAwMDAwMCArMDAwMAotLS0gY3ly
dXMtaW1hcGQtMi4zLjE0LXBhdGNoZWQvc2lldmUvc2NyaXB0LmMJMjAwOS0wNC0xOSAxNzoxNzoy
Ny4wMDAwMDAwMDAgKzAwMDAKKioqKioqKioqKioqKioqCioqKiAxNjUsMTcwICoqKioKLS0tIDE2
NSwxNzQgLS0tLQogIAkgICAgICAgKGNvbmZpZ19zaWV2ZV9leHRlbnNpb25zICYgSU1BUF9FTlVN
X1NJRVZFX0VYVEVOU0lPTlNfQ09QWSkpIHsKICAJcy0+c3VwcG9ydC5jb3B5ID0gMTsKICAJcmV0
dXJuIDE7CisgICAgIH0gZWxzZSBpZiAoIXN0cmNtcCgiZXh0bGlzdHMiLCByZXEpICYmCisgIAkg
ICAgICAgKGNvbmZpZ19zaWV2ZV9leHRlbnNpb25zICYgSU1BUF9FTlVNX1NJRVZFX0VYVEVOU0lP
TlNfRVhUTElTVFMpKSB7CisgIAlzLT5zdXBwb3J0LmV4dGxpc3RzID0gMTsKKyAgCXJldHVybiAx
OwogICAgICB9CiAgICAgIHJldHVybiAwOwogIH0KZGlmZiAtY3IgY3lydXMtaW1hcGQtMi4zLjE0
L3NpZXZlL3NjcmlwdC5oIGN5cnVzLWltYXBkLTIuMy4xNC1wYXRjaGVkL3NpZXZlL3NjcmlwdC5o
CioqKiBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvc2NyaXB0LmgJMjAwOC0wMy0yNCAyMDowODo0
Ni4wMDAwMDAwMDAgKzAwMDAKLS0tIGN5cnVzLWltYXBkLTIuMy4xNC1wYXRjaGVkL3NpZXZlL3Nj
cmlwdC5oCTIwMDktMDQtMTkgMTc6MTg6MDUuMDAwMDAwMDAwICswMDAwCioqKioqKioqKioqKioq
KgoqKiogNzIsNzcgKioqKgotLS0gNzIsNzggLS0tLQogIAlpbnQgaV9hc2NpaV9udW1lcmljOiAx
OwogIAlpbnQgaW5jbHVkZSAgICAgICAgOiAxOwogIAlpbnQgY29weSAgICAgICAgICAgOiAxOwor
ICAgICAgICAgaW50IGV4dGxpc3RzICAgICAgIDogMTsgCiAgICAgIH0gc3VwcG9ydDsKICAKICAg
ICAgdm9pZCAqc2NyaXB0X2NvbnRleHQ7CmRpZmYgLWNyIGN5cnVzLWltYXBkLTIuMy4xNC9zaWV2
ZS9zaWV2ZS1sZXgubCBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS9zaWV2ZS1sZXgu
bAoqKiogY3lydXMtaW1hcGQtMi4zLjE0L3NpZXZlL3NpZXZlLWxleC5sCTIwMDgtMDMtMjQgMjA6
MDg6NDYuMDAwMDAwMDAwICswMDAwCi0tLSBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2
ZS9zaWV2ZS1sZXgubAkyMDA5LTA0LTE5IDE3OjE4OjQ1LjAwMDAwMDAwMCArMDAwMAoqKioqKioq
KioqKioqKioKKioqIDE2MCwxNjUgKioqKgotLS0gMTYwLDE2NiAtLS0tCiAgPElOSVRJQUw+Omds
b2JhbAlyZXR1cm4gR0xPQkFMOwogIDxJTklUSUFMPnJldHVybgkJcmV0dXJuIFJFVFVSTjsKICA8
SU5JVElBTD46Y29weQkJcmV0dXJuIENPUFk7CisgPElOSVRJQUw+Omxpc3QgICAgICAgICAgcmV0
dXJuIExJU1Q7CiAgPElOSVRJQUw+WyBcdFxuXHJdIDsJLyogaWdub3JlIHdoaXRlc3BhY2UgKi8K
ICA8SU5JVElBTD4jLiogOwkJLyogaWdub3JlIGhhc2ggY29tbWVudHMgKi8KICA8SU5JVElBTD4i
LyoiKFteXCpdfFwqW15cL10pKlwqPyIqLyIgOwkvKiBpZ25vcmUgYnJhY2tldCBjb21tZW50cyAq
LwpkaWZmIC1jciBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvc2lldmUueSBjeXJ1cy1pbWFwZC0y
LjMuMTQtcGF0Y2hlZC9zaWV2ZS9zaWV2ZS55CioqKiBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUv
c2lldmUueQkyMDA4LTEwLTAyIDEzOjM2OjU2LjAwMDAwMDAwMCArMDAwMAotLS0gY3lydXMtaW1h
cGQtMi4zLjE0LXBhdGNoZWQvc2lldmUvc2lldmUueQkyMDA5LTA0LTE5IDE3OjQyOjE5LjAwMDAw
MDAwMCArMDAwMAoqKioqKioqKioqKioqKioKKioqIDY1LDcxICoqKioKICAKICAgICAgLyogZGVm
aW5pdGlvbnMgKi8KICAgICAgZXh0ZXJuIGludCBhZGRycGFyc2Uodm9pZCk7CiEgCiAgc3RydWN0
IHZ0YWdzIHsKICAgICAgaW50IGRheXM7CiAgICAgIHN0cmluZ2xpc3RfdCAqYWRkcmVzc2VzOwot
LS0gNjUsNzUgLS0tLQogIAogICAgICAvKiBkZWZpbml0aW9ucyAqLwogICAgICBleHRlcm4gaW50
IGFkZHJwYXJzZSh2b2lkKTsKISBzdHJ1Y3QgcnRhZ3MgewohICAgIGNoYXIgY29weTsKISAgICBj
aGFyIGV4dGxpc3RzOwohIH07CiEgIAogIHN0cnVjdCB2dGFncyB7CiAgICAgIGludCBkYXlzOwog
ICAgICBzdHJpbmdsaXN0X3QgKmFkZHJlc3NlczsKKioqKioqKioqKioqKioqCioqKiA3OSw4NCAq
KioqCi0tLSA4Myw4OSAtLS0tCiAgICAgIGNoYXIgKmNvbXBhcmF0b3I7CiAgICAgIGludCBjb21w
dGFnOwogICAgICBpbnQgcmVsYXRpb247CisgICAgIGNoYXIgZXh0bGlzdHM7CiAgfTsKICAKICBz
dHJ1Y3QgYWV0YWdzIHsKKioqKioqKioqKioqKioqCioqKiA4Niw5MSAqKioqCi0tLSA5MSw5NyAt
LS0tCiAgICAgIGNoYXIgKmNvbXBhcmF0b3I7CiAgICAgIGludCBjb21wdGFnOwogICAgICBpbnQg
cmVsYXRpb247CisgICAgIGNoYXIgZXh0bGlzdHM7CiAgfTsKICAKICBzdHJ1Y3QgYnRhZ3Mgewoq
KioqKioqKioqKioqKioKKioqIDEyNCwxMzAgKioqKgogIHN0YXRpYyBjb21tYW5kbGlzdF90ICpi
dWlsZF9ub3RpZnkoaW50IHQsIHN0cnVjdCBudGFncyAqbik7CiAgc3RhdGljIGNvbW1hbmRsaXN0
X3QgKmJ1aWxkX2Rlbm90aWZ5KGludCB0LCBzdHJ1Y3QgZHRhZ3MgKm4pOwogIHN0YXRpYyBjb21t
YW5kbGlzdF90ICpidWlsZF9maWxlaW50byhpbnQgdCwgaW50IGMsIGNoYXIgKmYpOwohIHN0YXRp
YyBjb21tYW5kbGlzdF90ICpidWlsZF9yZWRpcmVjdChpbnQgdCwgaW50IGMsIGNoYXIgKmEpOwog
IHN0YXRpYyBzdHJ1Y3QgYWV0YWdzICpuZXdfYWV0YWdzKHZvaWQpOwogIHN0YXRpYyBzdHJ1Y3Qg
YWV0YWdzICpjYW5vbl9hZXRhZ3Moc3RydWN0IGFldGFncyAqYWUpOwogIHN0YXRpYyB2b2lkIGZy
ZWVfYWV0YWdzKHN0cnVjdCBhZXRhZ3MgKmFlKTsKLS0tIDEzMCwxMzggLS0tLQogIHN0YXRpYyBj
b21tYW5kbGlzdF90ICpidWlsZF9ub3RpZnkoaW50IHQsIHN0cnVjdCBudGFncyAqbik7CiAgc3Rh
dGljIGNvbW1hbmRsaXN0X3QgKmJ1aWxkX2Rlbm90aWZ5KGludCB0LCBzdHJ1Y3QgZHRhZ3MgKm4p
OwogIHN0YXRpYyBjb21tYW5kbGlzdF90ICpidWlsZF9maWxlaW50byhpbnQgdCwgaW50IGMsIGNo
YXIgKmYpOwohIHN0YXRpYyBjb21tYW5kbGlzdF90ICpidWlsZF9yZWRpcmVjdChpbnQgdCwgc3Ry
dWN0IHJ0YWdzICpjLCBjaGFyICphKTsKISBzdGF0aWMgc3RydWN0IHJ0YWdzICpuZXdfcnRhZ3Mo
dm9pZCk7CiEgc3RhdGljIHZvaWQgZnJlZV9ydGFncyhzdHJ1Y3QgcnRhZ3MgKnIpOwogIHN0YXRp
YyBzdHJ1Y3QgYWV0YWdzICpuZXdfYWV0YWdzKHZvaWQpOwogIHN0YXRpYyBzdHJ1Y3QgYWV0YWdz
ICpjYW5vbl9hZXRhZ3Moc3RydWN0IGFldGFncyAqYWUpOwogIHN0YXRpYyB2b2lkIGZyZWVfYWV0
YWdzKHN0cnVjdCBhZXRhZ3MgKmFlKTsKKioqKioqKioqKioqKioqCioqKiAxNzQsMTc5ICoqKioK
LS0tIDE4MiwxODggLS0tLQogICAgICBjb21tYW5kbGlzdF90ICpjbDsKICAgICAgc3RydWN0IHZ0
YWdzICp2dGFnOwogICAgICBzdHJ1Y3QgYWV0YWdzICphZXRhZzsKKyAgICAgc3RydWN0IHJ0YWdz
ICpydGFnOwogICAgICBzdHJ1Y3QgaHRhZ3MgKmh0YWc7CiAgICAgIHN0cnVjdCBidGFncyAqYnRh
ZzsKICAgICAgc3RydWN0IG50YWdzICpudGFnOwoqKioqKioqKioqKioqKioKKioqIDE5NCwyMDAg
KioqKgogICV0b2tlbiBEQVlTIEFERFJFU1NFUyBTVUJKRUNUIEZST00gSEFORExFIE1JTUUKICAl
dG9rZW4gTUVUSE9EIElEIE9QVElPTlMgTE9XIE5PUk1BTCBISUdIIEFOWSBNRVNTQUdFCiAgJXRv
a2VuIElOQ0xVREUgUEVSU09OQUwgR0xPQkFMIFJFVFVSTgohICV0b2tlbiBDT1BZCiAgCiAgJXR5
cGUgPGNsPiBjb21tYW5kcyBjb21tYW5kIGFjdGlvbiBlbHNpZiBibG9jawogICV0eXBlIDxzbD4g
c3RyaW5nbGlzdCBzdHJpbmdzCi0tLSAyMDMsMjA5IC0tLS0KICAldG9rZW4gREFZUyBBRERSRVNT
RVMgU1VCSkVDVCBGUk9NIEhBTkRMRSBNSU1FCiAgJXRva2VuIE1FVEhPRCBJRCBPUFRJT05TIExP
VyBOT1JNQUwgSElHSCBBTlkgTUVTU0FHRQogICV0b2tlbiBJTkNMVURFIFBFUlNPTkFMIEdMT0JB
TCBSRVRVUk4KISAldG9rZW4gQ09QWSBMSVNUCiAgCiAgJXR5cGUgPGNsPiBjb21tYW5kcyBjb21t
YW5kIGFjdGlvbiBlbHNpZiBibG9jawogICV0eXBlIDxzbD4gc3RyaW5nbGlzdCBzdHJpbmdzCioq
KioqKioqKioqKioqKgoqKiogMjAzLDIwOCAqKioqCi0tLSAyMTIsMjE4IC0tLS0KICAldHlwZSA8
dGVzdGw+IHRlc3RsaXN0IHRlc3RzCiAgJXR5cGUgPGh0YWc+IGh0YWdzCiAgJXR5cGUgPGFldGFn
PiBhZXRhZ3MKKyAldHlwZSA8cnRhZz4gcnRhZ3MKICAldHlwZSA8YnRhZz4gYnRhZ3MKICAldHlw
ZSA8dnRhZz4gdnRhZ3MKICAldHlwZSA8bnRhZz4gbnRhZ3MKKioqKioqKioqKioqKioqCioqKiAy
NTYsMjYyICoqKioKICAJCQkJICAgICBZWUVSUk9SOyAvKiB2bSBzaG91bGQgY2FsbCB5eWVycm9y
KCkgKi8KICAJCQkJICAgfQogIAkgICAgICAgICAgICAgICAgICAgICAgICAgICAkJCA9IGJ1aWxk
X2ZpbGVpbnRvKEZJTEVJTlRPLCAkMiwgJDMpOyB9CiEgCXwgUkVESVJFQ1QgY29weSBTVFJJTkcg
ICB7IGlmICghdmVyaWZ5X2FkZHJlc3MoJDMpKSB7CiAgCQkJCSAgICAgWVlFUlJPUjsgLyogdmEg
c2hvdWxkIGNhbGwgeXllcnJvcigpICovCiAgCQkJCSAgIH0KICAJICAgICAgICAgICAgICAgICAg
ICAgICAgICAgJCQgPSBidWlsZF9yZWRpcmVjdChSRURJUkVDVCwgJDIsICQzKTsgfQotLS0gMjY2
LDI3MiAtLS0tCiAgCQkJCSAgICAgWVlFUlJPUjsgLyogdm0gc2hvdWxkIGNhbGwgeXllcnJvcigp
ICovCiAgCQkJCSAgIH0KICAJICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQgPSBidWlsZF9m
aWxlaW50byhGSUxFSU5UTywgJDIsICQzKTsgfQohICAgICAgICAgfCBSRURJUkVDVCBydGFncyBT
VFJJTkcgICB7IGlmICgkMi0+ZXh0bGlzdHMgPT0gMCAmJiAhdmVyaWZ5X2FkZHJlc3MoJDMpKSB7
CiAgCQkJCSAgICAgWVlFUlJPUjsgLyogdmEgc2hvdWxkIGNhbGwgeXllcnJvcigpICovCiAgCQkJ
CSAgIH0KICAJICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQgPSBidWlsZF9yZWRpcmVjdChS
RURJUkVDVCwgJDIsICQzKTsgfQoqKioqKioqKioqKioqKioKKioqIDM0NiwzNTEgKioqKgotLS0g
MzU2LDM4MiAtLS0tCiAgCXwgUEVSU09OQUwJCSB7ICQkID0gUEVSU09OQUw7IH0KICAJfCBHTE9C
QUwJCSB7ICQkID0gR0xPQkFMOyB9CiAgCTsKKyAgcnRhZ3M6IC8qIGVtcHR5ICovCQkgeyAkJCA9
IG5ld19ydGFncygpOyB9CisgIAl8IHJ0YWdzIENPUFkJCSB7ICQkID0gJDE7CisgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFwYXJzZV9zY3JpcHQtPnN1cHBvcnQuY29w
eSkgeworICAJCQkJICAgICB5eWVycm9yKCJjb3B5IE1VU1QgYmUgZW5hYmxlZCB3aXRoIFwicmVx
dWlyZVwiIik7CisgIAkJCQkgICAgIFlZRVJST1I7CisgIAkJCQkgICB9IGVsc2UKKyAgCQkJCSAg
IGlmICgkJC0+Y29weSAhPSAwKSB7CisgIAkJCQkJeXllcnJvcigiZHVwbGljYXRlIDpjb3B5Iik7
IFlZRVJST1I7IH0KKyAgCQkJCSAgIGVsc2UgeyQkLT5jb3B5ID0gMTt9CisgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICAgIH0KKyAgCXwgcnRhZ3MgTElTVAkJIHsgJCQgPSAkMTsKKyAg
CQkJCSAgIGlmICghcGFyc2Vfc2NyaXB0LT5zdXBwb3J0LmV4dGxpc3RzKSB7CisgIAkJCQkgICAg
IHl5ZXJyb3IoImV4dGxpc3RzIE1VU1QgYmUgZW5hYmxlZCB3aXRoIFwicmVxdWlyZVwiIik7Cisg
IAkJCQkgICAgIFlZRVJST1I7CisgIAkJCQkgICB9IGVsc2UKKyAgCQkJCSAgIGlmICgkJC0+ZXh0
bGlzdHMgIT0gMCkgeworICAJCQkJCXl5ZXJyb3IoImR1cGxpY2F0ZSA6bGlzdCIpOyBZWUVSUk9S
OyB9CisgIAkJCQkgICBlbHNlIHskJC0+ZXh0bGlzdHMgPSAxO30KKyAgCQkJCSB9CisgCTsKKyAg
CiAgCiAgbnRhZ3M6IC8qIGVtcHR5ICovCQkgeyAkJCA9IG5ld19udGFncygpOyB9CiAgCXwgbnRh
Z3MgSUQgU1RSSU5HCSB7IGlmICgkJC0+aWQgIT0gTlVMTCkgeyAKKioqKioqKioqKioqKioqCioq
KiA0NDAsNDQ2ICoqKioKICAJOwogIAogIHN0cmluZ3M6IFNUUklORwkJCSB7ICQkID0gbmV3X3Ns
KCQxLCBOVUxMKTsgfQohIAl8IFNUUklORyAnLCcgc3RyaW5ncwkgeyAkJCA9IG5ld19zbCgkMSwg
JDMpOyB9CiAgCTsKICAKICBibG9jazogJ3snIGNvbW1hbmRzICd9JwkJIHsgJCQgPSAkMjsgfQot
LS0gNDcxLDQ3NyAtLS0tCiAgCTsKICAKICBzdHJpbmdzOiBTVFJJTkcJCQkgeyAkJCA9IG5ld19z
bCgkMSwgTlVMTCk7IH0KISAJfCBzdHJpbmdzICcsJyBTVFJJTkcJIHsgJCQgPSBuZXdfc2woJDMs
ICQxKTsgfQogIAk7CiAgCiAgYmxvY2s6ICd7JyBjb21tYW5kcyAnfScJCSB7ICQkID0gJDI7IH0K
KioqKioqKioqKioqKioqCioqKiA1NjQsNTY5ICoqKioKLS0tIDU5NSw2MDcgLS0tLQogIAkJCXl5
ZXJyb3IoImNvbXBhcmF0b3ItaTthc2NpaS1udW1lcmljIE1VU1QgYmUgZW5hYmxlZCB3aXRoIFwi
cmVxdWlyZVwiIik7CiAgCQkJWVlFUlJPUjsgfQogIAkJCQkgICBlbHNlIHsgJCQtPmNvbXBhcmF0
b3IgPSAkMzsgfSB9CisgIAl8IGFldGFncyBMSVNUCQl7ICQkID0gJDE7CisgICAgICAgICAgICAg
ICAgIAkgICAgICAgICAgICAJICBpZiAoJCQtPmV4dGxpc3RzICE9IDApIHsKKyAgCQkJeXllcnJv
cigiZHVwbGljYXRlIDpsaXN0Iik7IFlZRVJST1I7IH0KKyAgCQkJCSAgZWxzZSBpZiAoIXBhcnNl
X3NjcmlwdC0+c3VwcG9ydC5leHRsaXN0cykgeworICAJCQkJICAgIHl5ZXJyb3IoImV4dGxpc3Rz
IE1VU1QgYmUgZW5hYmxlZCB3aXRoIFwicmVxdWlyZVwiIik7CisgIAkJCQkgICAgWVlFUlJPUjsg
fQorICAJCQkJICBlbHNlIHsgJCQtPmV4dGxpc3RzID0gMTsgfSB9CiAgCTsKICAKICBodGFnczog
LyogZW1wdHkgKi8JCSB7ICQkID0gbmV3X2h0YWdzKCk7IH0KKioqKioqKioqKioqKioqCioqKiA1
ODcsNTkyICoqKioKLS0tIDYyNSw2MzcgLS0tLQogIAkJCSB5eWVycm9yKCJjb21wYXJhdG9yLWk7
YXNjaWktbnVtZXJpYyBNVVNUIGJlIGVuYWJsZWQgd2l0aCBcInJlcXVpcmVcIiIpOyAgWVlFUlJP
UjsgfQogIAkJCQkgICBlbHNlIHsgCiAgCQkJCSAgICAgJCQtPmNvbXBhcmF0b3IgPSAkMzsgfSB9
CisgIAl8IGh0YWdzIExJU1QJCSAgeyAkJCA9ICQxOworICAJCQkJICAgaWYgKCQkLT5leHRsaXN0
cyAhPSAwKSB7CisgIAkJCXl5ZXJyb3IoImR1cGxpY2F0ZSA6bGlzdCIpOyBZWUVSUk9SOyB9Cisg
IAkJCQkgICBlbHNlIGlmICghcGFyc2Vfc2NyaXB0LT5zdXBwb3J0LmV4dGxpc3RzKSB7CisgIAkJ
CXl5ZXJyb3IoImV4dGxpc3RzIE1VU1QgYmUgZW5hYmxlZCB3aXRoIFwicmVxdWlyZVwiIik7IFlZ
RVJST1I7IH0KKyAgCQkJCSAgIGVsc2UgeyAkJC0+ZXh0bGlzdHMgPSAxOyB9IH0KKyAKICAgICAg
ICAgIDsKICAKICBidGFnczogLyogZW1wdHkgKi8JCSB7ICQkID0gbmV3X2J0YWdzKCk7IH0KKioq
KioqKioqKioqKioqCioqKiA3NDksNzU0ICoqKioKLS0tIDc5NCw4MDAgLS0tLQogIAlyZXQtPnUu
YWUuc2wgPSBzbDsKICAJcmV0LT51LmFlLnBsID0gcGw7CiAgCXJldC0+dS5hZS5hZGRycGFydCA9
IGFlLT5hZGRydGFnOworIAlyZXQtPnUuYWUuZXh0bGlzdHMgPSBhZS0+ZXh0bGlzdHM7CiAgCWZy
ZWVfYWV0YWdzKGFlKTsKICAKICAgICAgfQoqKioqKioqKioqKioqKioKKioqIDc2OCw3NzMgKioq
KgotLS0gODE0LDgyMCAtLS0tCiAgCXJldC0+dS5oLmNvbXBhcmF0b3I9eHN0cmR1cChoLT5jb21w
YXJhdG9yKTsKICAJcmV0LT51Lmguc2wgPSBzbDsKICAJcmV0LT51LmgucGwgPSBwbDsKKyAJcmV0
LT51LmguZXh0bGlzdHMgPSBoLT5leHRsaXN0czsKICAJZnJlZV9odGFncyhoKTsKICAgICAgfQog
ICAgICByZXR1cm4gcmV0OwoqKioqKioqKioqKioqKioKKioqIDg2Myw4ODcgKioqKgogICAgICBy
ZXR1cm4gcmV0OwogIH0KICAKISBzdGF0aWMgY29tbWFuZGxpc3RfdCAqYnVpbGRfcmVkaXJlY3Qo
aW50IHQsIGludCBjb3B5LCBjaGFyICphZGRyZXNzKQogIHsKICAgICAgY29tbWFuZGxpc3RfdCAq
cmV0ID0gbmV3X2NvbW1hbmQodCk7CiAgCiAgICAgIGFzc2VydCh0ID09IFJFRElSRUNUKTsKICAK
ICAgICAgaWYgKHJldCkgewohIAlyZXQtPnUuci5jb3B5ID0gY29weTsKICAJcmV0LT51LnIuYWRk
cmVzcyA9IGFkZHJlc3M7CiAgICAgIH0KICAgICAgcmV0dXJuIHJldDsKICB9CiAgCiAgc3RhdGlj
IHN0cnVjdCBhZXRhZ3MgKm5ld19hZXRhZ3Modm9pZCkKICB7CiAgICAgIHN0cnVjdCBhZXRhZ3Mg
KnIgPSAoc3RydWN0IGFldGFncyAqKSB4bWFsbG9jKHNpemVvZihzdHJ1Y3QgYWV0YWdzKSk7CiAg
CiAgICAgIHItPmFkZHJ0YWcgPSByLT5jb21wdGFnID0gci0+cmVsYXRpb249LTE7CiAgICAgIHIt
PmNvbXBhcmF0b3I9TlVMTDsKICAKICAgICAgcmV0dXJuIHI7CiAgfQotLS0gOTEwLDk1NCAtLS0t
CiAgICAgIHJldHVybiByZXQ7CiAgfQogIAohIHN0YXRpYyBjb21tYW5kbGlzdF90ICpidWlsZF9y
ZWRpcmVjdChpbnQgdCwgc3RydWN0IHJ0YWdzKiByLCBjaGFyICphZGRyZXNzKQogIHsKICAgICAg
Y29tbWFuZGxpc3RfdCAqcmV0ID0gbmV3X2NvbW1hbmQodCk7CiAgCiAgICAgIGFzc2VydCh0ID09
IFJFRElSRUNUKTsKICAKICAgICAgaWYgKHJldCkgewohIAlyZXQtPnUuci5jb3B5ID0gci0+Y29w
eTsKISAgICAgICAgIHJldC0+dS5yLmV4dGxpc3RzID0gci0+ZXh0bGlzdHM7CiAgCXJldC0+dS5y
LmFkZHJlc3MgPSBhZGRyZXNzOworICAgICAgICAgZnJlZShyKTsKICAgICAgfQogICAgICByZXR1
cm4gcmV0OwogIH0KICAKKyBzdGF0aWMgc3RydWN0IHJ0YWdzICpuZXdfcnRhZ3Modm9pZCkKKyB7
CisgICAgICBzdHJ1Y3QgcnRhZ3MgKnIgPSAoc3RydWN0IHJ0YWdzICopIHhtYWxsb2Moc2l6ZW9m
KHN0cnVjdCBydGFncykpOworICAKKyAgICAgIHItPmV4dGxpc3RzID0gMDsKKyAgICAgIHItPmNv
cHkgPSAwOworICAKKyAgICAgIHJldHVybiByOworIH0KKyAgCisgc3RhdGljIHZvaWQgZnJlZV9y
dGFncyhzdHJ1Y3QgcnRhZ3MgKnIpCisgeworICAgICAgZnJlZShyKTsKKyB9CisgIAorIAorIAog
IHN0YXRpYyBzdHJ1Y3QgYWV0YWdzICpuZXdfYWV0YWdzKHZvaWQpCiAgewogICAgICBzdHJ1Y3Qg
YWV0YWdzICpyID0gKHN0cnVjdCBhZXRhZ3MgKikgeG1hbGxvYyhzaXplb2Yoc3RydWN0IGFldGFn
cykpOwogIAogICAgICByLT5hZGRydGFnID0gci0+Y29tcHRhZyA9IHItPnJlbGF0aW9uPS0xOwog
ICAgICByLT5jb21wYXJhdG9yPU5VTEw7CisgICAgIHItPmV4dGxpc3RzID0gMDsKICAKICAgICAg
cmV0dXJuIHI7CiAgfQoqKioqKioqKioqKioqKioKKioqIDkwNyw5MTMgKioqKgogICAgICBzdHJ1
Y3QgaHRhZ3MgKnIgPSAoc3RydWN0IGh0YWdzICopIHhtYWxsb2Moc2l6ZW9mKHN0cnVjdCBodGFn
cykpOwogIAogICAgICByLT5jb21wdGFnID0gci0+cmVsYXRpb249IC0xOwohICAgICAKICAgICAg
ci0+Y29tcGFyYXRvciA9IE5VTEw7CiAgCiAgICAgIHJldHVybiByOwotLS0gOTc0LDk4MCAtLS0t
CiAgICAgIHN0cnVjdCBodGFncyAqciA9IChzdHJ1Y3QgaHRhZ3MgKikgeG1hbGxvYyhzaXplb2Yo
c3RydWN0IGh0YWdzKSk7CiAgCiAgICAgIHItPmNvbXB0YWcgPSByLT5yZWxhdGlvbj0gLTE7CiEg
ICAgIHItPmV4dGxpc3RzID0gMDsgICAgCiAgICAgIHItPmNvbXBhcmF0b3IgPSBOVUxMOwogIAog
ICAgICByZXR1cm4gcjsKZGlmZiAtY3IgY3lydXMtaW1hcGQtMi4zLjE0L3NpZXZlL3RyZWUuaCBj
eXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS90cmVlLmgKKioqIGN5cnVzLWltYXBkLTIu
My4xNC9zaWV2ZS90cmVlLmgJMjAwOC0wMy0yNCAyMDowODo0Ny4wMDAwMDAwMDAgKzAwMDAKLS0t
IGN5cnVzLWltYXBkLTIuMy4xNC1wYXRjaGVkL3NpZXZlL3RyZWUuaAkyMDA5LTA0LTE5IDE3OjMw
OjQ1LjAwMDAwMDAwMCArMDAwMAoqKioqKioqKioqKioqKioKKioqIDgyLDg3ICoqKioKLS0tIDgy
LDg4IC0tLS0KICAJICAgIGNoYXIgKiBjb21wYXJhdG9yOwogIAkgICAgaW50IHJlbGF0aW9uOwog
IAkgICAgdm9pZCAqY29tcHJvY2s7CisgCSAgICBjaGFyIGV4dGxpc3RzOwogIAkgICAgc3RyaW5n
bGlzdF90ICpzbDsKICAJICAgIHN0cmluZ2xpc3RfdCAqcGw7CiAgCX0gaDsKKioqKioqKioqKioq
KioqCioqKiA4OSw5NCAqKioqCi0tLSA5MCw5NiAtLS0tCiAgCSAgICBpbnQgY29tcHRhZzsKICAJ
ICAgIGNoYXIgKiBjb21wYXJhdG9yOwogIAkgICAgaW50IHJlbGF0aW9uOyAKKyAJICAgIGNoYXIg
ZXh0bGlzdHM7CiAgCSAgICB2b2lkICpjb21wcm9jazsKICAJICAgIHN0cmluZ2xpc3RfdCAqc2w7
CiAgCSAgICBzdHJpbmdsaXN0X3QgKnBsOwoqKioqKioqKioqKioqKioKKioqIDEzOSwxNDQgKioq
KgotLS0gMTQxLDE0NyAtLS0tCiAgCXN0cnVjdCB7IC8qIGl0J3MgYSByZWRpcmVjdCBhY3Rpb24g
Ki8KICAJICAgIGNoYXIgKmFkZHJlc3M7CiAgCSAgICBpbnQgY29weTsKKyAJICAgIGNoYXIgZXh0
bGlzdHM7CiAgCX0gcjsKICAJc3RydWN0IHsgLyogaXQncyBhIHZhY2F0aW9uIGFjdGlvbiAqLwog
IAkgICAgY2hhciAqc3ViamVjdDsK
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>1078</attachid>
            <date>2009-06-02 10:11 EDT</date>
            <desc>The same patch, but affects the generated sieve bytecode.</desc>
            <filename>sieve_extlists.patch</filename>
            <type>application/octet-stream</type>
            <size>27067</size>
            <attacher>didopalauzov@aegee.org</attacher>
            
              <data encoding="base64">ZGlmZiAtcmMgY3lydXMtaW1hcGQtMi4zLjE0L2xpYi9pbWFwb3B0aW9ucyBjeXJ1cy1pbWFwZC0y
LjMuMTQtcGF0Y2hlZC9saWIvaW1hcG9wdGlvbnMKKioqIGN5cnVzLWltYXBkLTIuMy4xNC9saWIv
aW1hcG9wdGlvbnMJMjAwOS0wMy0wNiAwMzo1Mjo1NS4wMDAwMDAwMDAgKzAwMDAKLS0tIGN5cnVz
LWltYXBkLTIuMy4xNC1wYXRjaGVkL2xpYi9pbWFwb3B0aW9ucwkyMDA5LTA1LTI4IDE4OjMxOjE4
LjAwMDAwMDAwMCArMDAwMAoqKioqKioqKioqKioqKioKKioqIDkzMSw5MzcgKioqKgogICAgIHVz
ZXIncyBzY3JpcHRzIHJlc2lkZSBvbiBhIHJlbW90ZSBzZXJ2ZXIgKGluIGEgTXVyZGVyKS4KICAg
ICBPdGhlcndpc2UsIHRpbXNpZXZlZCB3aWxsIHByb3h5IHRyYWZmaWMgdG8gdGhlIHJlbW90ZSBz
ZXJ2ZXIuICovCiAgCiEgeyAic2lldmVfZXh0ZW5zaW9ucyIsICJmaWxlaW50byByZWplY3QgdmFj
YXRpb24gaW1hcGZsYWdzIG5vdGlmeSBlbnZlbG9wZSByZWxhdGlvbmFsIHJlZ2V4IHN1YmFkZHJl
c3MgY29weSIsIEJJVEZJRUxEKCJmaWxlaW50byIsICJyZWplY3QiLCAidmFjYXRpb24iLCAiaW1h
cGZsYWdzIiwgIm5vdGlmeSIsICJpbmNsdWRlIiwgImVudmVsb3BlIiwgImJvZHkiLCAicmVsYXRp
b25hbCIsICJyZWdleCIsICJzdWJhZGRyZXNzIiwgImNvcHkiKSB9CiAgLyogU3BhY2Utc2VwYXJh
dGVkIGxpc3Qgb2YgU2lldmUgZXh0ZW5zaW9ucyBhbGxvd2VkIHRvIGJlIHVzZWQgaW4KICAgICBz
aWV2ZSBzY3JpcHRzLCBlbmZvcmNlZCBhdCBzdWJtaXNzaW9uIGJ5IHRpbXNpZXZlZCg4KS4gIEFu
eQogICAgIHByZXZpb3VzbHkgaW5zdGFsbGVkIHNjcmlwdCB3aWxsIGJlIHVuYWZmZWN0ZWQgYnkg
dGhpcyBvcHRpb24gYW5kCi0tLSA5MzEsOTM3IC0tLS0KICAgICB1c2VyJ3Mgc2NyaXB0cyByZXNp
ZGUgb24gYSByZW1vdGUgc2VydmVyIChpbiBhIE11cmRlcikuCiAgICAgT3RoZXJ3aXNlLCB0aW1z
aWV2ZWQgd2lsbCBwcm94eSB0cmFmZmljIHRvIHRoZSByZW1vdGUgc2VydmVyLiAqLwogIAohIHsg
InNpZXZlX2V4dGVuc2lvbnMiLCAiZmlsZWludG8gcmVqZWN0IHZhY2F0aW9uIGltYXBmbGFncyBu
b3RpZnkgZW52ZWxvcGUgcmVsYXRpb25hbCByZWdleCBzdWJhZGRyZXNzIGNvcHkiLCBCSVRGSUVM
RCgiZmlsZWludG8iLCAicmVqZWN0IiwgInZhY2F0aW9uIiwgImltYXBmbGFncyIsICJub3RpZnki
LCAiaW5jbHVkZSIsICJlbnZlbG9wZSIsICJib2R5IiwgInJlbGF0aW9uYWwiLCAicmVnZXgiLCAi
c3ViYWRkcmVzcyIsICJjb3B5IiwgImV4dGxpc3RzIikgfQogIC8qIFNwYWNlLXNlcGFyYXRlZCBs
aXN0IG9mIFNpZXZlIGV4dGVuc2lvbnMgYWxsb3dlZCB0byBiZSB1c2VkIGluCiAgICAgc2lldmUg
c2NyaXB0cywgZW5mb3JjZWQgYXQgc3VibWlzc2lvbiBieSB0aW1zaWV2ZWQoOCkuICBBbnkKICAg
ICBwcmV2aW91c2x5IGluc3RhbGxlZCBzY3JpcHQgd2lsbCBiZSB1bmFmZmVjdGVkIGJ5IHRoaXMg
b3B0aW9uIGFuZApkaWZmIC1yYyBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvYmNfZHVtcC5jIGN5
cnVzLWltYXBkLTIuMy4xNC1wYXRjaGVkL3NpZXZlL2JjX2R1bXAuYwoqKiogY3lydXMtaW1hcGQt
Mi4zLjE0L3NpZXZlL2JjX2R1bXAuYwkyMDA4LTAzLTI0IDIwOjA4OjQ2LjAwMDAwMDAwMCArMDAw
MAotLS0gY3lydXMtaW1hcGQtMi4zLjE0LXBhdGNoZWQvc2lldmUvYmNfZHVtcC5jCTIwMDktMDYt
MDIgMTI6MDg6MTIuMDAwMDAwMDAwICswMDAwCioqKioqKioqKioqKioqKgoqKiogMTUzLDE2NCAq
KioqCiAgCXByaW50X3NwYWNlcyhsZXZlbCo0KTsKICAJaWYgKGQtPmRhdGFbaXBdLnZhbHVlID09
IEJfQ09VTlQgfHwgZC0+ZGF0YVtpcF0udmFsdWUgPT0gQl9WQUxVRSkKICAJewohIAkgICAgcHJp
bnRmKCIgICAgICBNQVRDSDolZCAgUkVMQVRJT046JWQgIENPTVA6JWQgSEVBREVSUzpcbiIsIAoh
IAkJICAgZC0+ZGF0YVtpcF0udmFsdWUsIGQtPmRhdGFbaXArMV0udmFsdWUsZC0+ZGF0YVtpcCsy
XS52YWx1ZSk7CiAgCX0gZWxzZSB7CiEgCSAgICBwcmludGYoIiAgICAgIE1BVENIOiVkIENPTVA6
JWQgSEVBREVSUzpcbiIsZC0+ZGF0YVtpcF0udmFsdWUsIGQtPmRhdGFbaXArMl0udmFsdWUpOwog
IAl9CiEgCWlwKz0zOwogIAlpcCA9IGR1bXBfc2woZCxpcCxsZXZlbCk7CiAgCWlwKys7CiAgCXBy
aW50X3NwYWNlcyhsZXZlbCo0KTsKLS0tIDE1MywxNjQgLS0tLQogIAlwcmludF9zcGFjZXMobGV2
ZWwqNCk7CiAgCWlmIChkLT5kYXRhW2lwXS52YWx1ZSA9PSBCX0NPVU5UIHx8IGQtPmRhdGFbaXBd
LnZhbHVlID09IEJfVkFMVUUpCiAgCXsKISAJICAgIHByaW50ZigiICAgICAgTUFUQ0g6JWQgIFJF
TEFUSU9OOiVkICBDT01QOiVkIEVYVExJU1RTOiVkIEhFQURFUlM6XG4iLCAKISAJCSAgIGQtPmRh
dGFbaXBdLnZhbHVlLCBkLT5kYXRhW2lwKzFdLnZhbHVlLGQtPmRhdGFbaXArMl0udmFsdWUsZC0+
ZGF0YVtpcCszXSk7CiAgCX0gZWxzZSB7CiEgCSAgcHJpbnRmKCIgICAgICBNQVRDSDolZCBDT01Q
OiVkIEVYVExJU1RTOiVkIEhFQURFUlM6XG4iLGQtPmRhdGFbaXBdLnZhbHVlLCBkLT5kYXRhW2lw
KzJdLnZhbHVlLGQtPmRhdGFbaXArM10pOwogIAl9CiEgCWlwKz00OwogIAlpcCA9IGR1bXBfc2wo
ZCxpcCxsZXZlbCk7CiAgCWlwKys7CiAgCXByaW50X3NwYWNlcyhsZXZlbCo0KTsKKioqKioqKioq
KioqKioqCioqKiAxNzMsMTg1ICoqKioKICAJcHJpbnRfc3BhY2VzKGxldmVsKjQpOwogIAlpZiAo
ZC0+ZGF0YVtpcF0udmFsdWUgPT0gQl9DT1VOVCB8fCBkLT5kYXRhW2lwXS52YWx1ZSA9PSBCX1ZB
TFVFKQogIAl7CiEgCSAgICBwcmludGYoIiAgICAgIE1BVENIOiVkIFJFTEFUSU9OOiAlZCBDT01Q
OiAlZCBUWVBFOiAlZCBIRUFERVJTOlxuIiwgCiEgCQkgICBkLT5kYXRhW2lwXS52YWx1ZSwgZC0+
ZGF0YVtpcCsxXS52YWx1ZSwgZC0+ZGF0YVtpcCsyXS52YWx1ZSwgZC0+ZGF0YVtpcCszXS52YWx1
ZSk7CiAgCX0gZWxzZSB7CiEgCSAgICBwcmludGYoIiAgICAgIE1BVENIOiVkIENPTVA6JWQgVFlQ
RTolZCBIRUFERVJTOlxuIiwKISAJCSAgIGQtPmRhdGFbaXBdLnZhbHVlLGQtPmRhdGFbaXArMV0u
dmFsdWUsZC0+ZGF0YVtpcCszXS52YWx1ZSk7CiAgCX0KISAJaXArPTQ7CiAgCWlwID0gZHVtcF9z
bChkLGlwLGxldmVsKTsgaXArKzsKICAJcHJpbnRfc3BhY2VzKGxldmVsKjQpOwogIAlwcmludGYo
IiAgICAgIERBVEE6XG4iKTsKLS0tIDE3MywxODUgLS0tLQogIAlwcmludF9zcGFjZXMobGV2ZWwq
NCk7CiAgCWlmIChkLT5kYXRhW2lwXS52YWx1ZSA9PSBCX0NPVU5UIHx8IGQtPmRhdGFbaXBdLnZh
bHVlID09IEJfVkFMVUUpCiAgCXsKISAJICAgIHByaW50ZigiICAgICAgTUFUQ0g6JWQgUkVMQVRJ
T046ICVkIENPTVA6ICVkIEVYVExJU1RTOiAlZCBUWVBFOiAlZCBIRUFERVJTOlxuIiwgCiEgCQkg
ICBkLT5kYXRhW2lwXS52YWx1ZSwgZC0+ZGF0YVtpcCsxXS52YWx1ZSwgZC0+ZGF0YVtpcCsyXS52
YWx1ZSwgZC0+ZGF0YVtpcCszXS52YWx1ZSwgZC0+ZGF0YVtpcCs0XS52YWx1ZSk7CiAgCX0gZWxz
ZSB7CiEgCSAgICBwcmludGYoIiAgICAgIE1BVENIOiVkIENPTVA6JWQgRVhUSVNUUzolZCBUWVBF
OiVkIEhFQURFUlM6XG4iLAohIAkJICAgZC0+ZGF0YVtpcF0udmFsdWUsZC0+ZGF0YVtpcCsxXS52
YWx1ZSwgZC0+ZGF0YVtpcCszXSwgZC0+ZGF0YVtpcCs0XS52YWx1ZSk7CiAgCX0KISAJaXArPTU7
CiAgCWlwID0gZHVtcF9zbChkLGlwLGxldmVsKTsgaXArKzsKICAJcHJpbnRfc3BhY2VzKGxldmVs
KjQpOwogIAlwcmludGYoIiAgICAgIERBVEE6XG4iKTsKKioqKioqKioqKioqKioqCioqKiAyNzIs
MjgwICoqKioKICAJICAgIGJyZWFrOwogIAogIAljYXNlIEJfUkVESVJFQ1Q6CiEgCSAgICBwcmlu
dGYoIiVkOiBSRURJUkVDVCBDT1BZKCVkKSBBRERSRVNTKHslZH0lcylcbiIsaSwKISAJCSAgIGQt
PmRhdGFbaSsxXS52YWx1ZSxkLT5kYXRhW2krMl0ubGVuLGQtPmRhdGFbaSszXS5zdHIpOwohIAkg
ICAgaSs9MzsKICAJICAgIGJyZWFrOwogIAogIAljYXNlIEJfU0VURkxBRzoKLS0tIDI3NywyODUg
LS0tLQogIAkgICAgYnJlYWs7CiAgCiAgCWNhc2UgQl9SRURJUkVDVDoKISAJICAgIHByaW50Zigi
JWQ6IFJFRElSRUNUIENPUFkoJWQpIEVYVExJU1RTKCVkKSBBRERSRVNTKHslZH0lcylcbiIsaSwK
ISAJCSAgIGQtPmRhdGFbaSsxXS52YWx1ZSxkLT5kYXRhW2krMl0sIGQtPmRhdGFbaSszXS5sZW4s
ZC0+ZGF0YVtpKzRdLnN0cik7CiEgCSAgICBpKz00OwogIAkgICAgYnJlYWs7CiAgCiAgCWNhc2Ug
Ql9TRVRGTEFHOgpkaWZmIC1yYyBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvYmNfZW1pdC5jIGN5
cnVzLWltYXBkLTIuMy4xNC1wYXRjaGVkL3NpZXZlL2JjX2VtaXQuYwoqKiogY3lydXMtaW1hcGQt
Mi4zLjE0L3NpZXZlL2JjX2VtaXQuYwkyMDA4LTAzLTI0IDIwOjA4OjQ2LjAwMDAwMDAwMCArMDAw
MAotLS0gY3lydXMtaW1hcGQtMi4zLjE0LXBhdGNoZWQvc2lldmUvYmNfZW1pdC5jCTIwMDktMDYt
MDIgMTI6Mjc6NTcuMDAwMDAwMDAwICswMDAwCioqKioqKioqKioqKioqKgoqKiogMjY2LDI3MiAq
KioqCiAgCSAgICByZXR1cm4gLTE7CiAgCXdyb3RlICs9IHNpemVvZihpbnQpOwogIAkoKmNvZGVw
KSsrOyAgICAKISAJLypub3cgZHJvcCByZWxhdGlvbiovCiAgCWlmKHdyaXRlX2ludChmZCwgYmMt
PmRhdGFbKCpjb2RlcCldLnZhbHVlKSA9PSAtMSkKICAJICAgIHJldHVybiAtMTsKICAJd3JvdGUg
Kz0gc2l6ZW9mKGludCk7Ci0tLSAyNjYsMjc3IC0tLS0KICAJICAgIHJldHVybiAtMTsKICAJd3Jv
dGUgKz0gc2l6ZW9mKGludCk7CiAgCSgqY29kZXApKys7ICAgIAohIAkvKiBOb3cgZHJvcCByZWxh
dGlvbiAqLwohIAlpZih3cml0ZV9pbnQoZmQsIGJjLT5kYXRhWygqY29kZXApXS52YWx1ZSkgPT0g
LTEpCiEgCSAgICByZXR1cm4gLTE7CiEgCXdyb3RlICs9IHNpemVvZihpbnQpOwohIAkoKmNvZGVw
KSsrOwohIAkvKiBOb3cgZHJvcCBleHRsaXN0cyAqLwogIAlpZih3cml0ZV9pbnQoZmQsIGJjLT5k
YXRhWygqY29kZXApXS52YWx1ZSkgPT0gLTEpCiAgCSAgICByZXR1cm4gLTE7CiAgCXdyb3RlICs9
IHNpemVvZihpbnQpOwoqKioqKioqKioqKioqKioKKioqIDMwMSwzMDYgKioqKgotLS0gMzA2LDMx
NiAtLS0tCiAgCSAgICByZXR1cm4gLTE7CiAgCXdyb3RlICs9IHNpemVvZihpbnQpOwogIAkoKmNv
ZGVwKSsrOworIAkvKiBOb3cgZHJvcCBleHRsaXN0cyAqLworIAlpZih3cml0ZV9pbnQoZmQsIGJj
LT5kYXRhWygqY29kZXApXS52YWx1ZSkgPT0gLTEpCisgCSAgICByZXR1cm4gLTE7CisgCXdyb3Rl
ICs9IHNpemVvZihpbnQpOworIAkoKmNvZGVwKSsrOwogIAkvKm5vdyBkcm9wIGFkZHJlc3MgcGFy
dCovCiAgCWlmKHdyaXRlX2ludChmZCwgYmMtPmRhdGFbKCpjb2RlcCldLnZhbHVlKSA9PSAtMSkK
ICAJICAgIHJldHVybiAtMTsKKioqKioqKioqKioqKioqCioqKiA1MTEsNTE3ICoqKioKICAJfQog
IAkKICAJY2FzZSBCX0ZJTEVJTlRPOgotIAljYXNlIEJfUkVESVJFQ1Q6CiAgCSAgICAvKiBDb3B5
ICh3b3JkKSwgRm9sZGVyL0FkZHJlc3MgU3RyaW5nICovCiAgCiAgCSAgICBpZih3cml0ZV9pbnQo
ZmQsYmMtPmRhdGFbY29kZXArK10udmFsdWUpID09IC0xKQotLS0gNTIxLDUyNiAtLS0tCioqKioq
KioqKioqKioqKgoqKiogNTM2LDU0MSAqKioqCi0tLSA1NDUsNTgwIC0tLS0KICAKICAJICAgIGJy
ZWFrOwogIAorIAljYXNlIEJfUkVESVJFQ1Q6CisgCSAgICAvKiBDb3B5ICh3b3JkKSwgRXh0bGlz
dHMgKHdvcmQpIEZvbGRlci9BZGRyZXNzIFN0cmluZyAqLworICAgICAgICAgICAgIAorICAgICAg
ICAgICAgIC8qIGNvcHkgKi8KKyAJICAgIGlmKHdyaXRlX2ludChmZCxiYy0+ZGF0YVtjb2RlcCsr
XS52YWx1ZSkgPT0gLTEpCisgCQlyZXR1cm4gLTE7CisgCisgICAgICAgICAgICAgLyogZXh0bGlz
dHMgKi8KKyAJICAgIGlmKHdyaXRlX2ludChmZCxiYy0+ZGF0YVtjb2RlcCsrXS52YWx1ZSkgPT0g
LTEpCisgCQlyZXR1cm4gLTE7CisgCisgCSAgICBmaWxlbGVuICs9IDIgKiBzaXplb2YoaW50KTsK
KyAKKyAJICAgIGxlbiA9IGJjLT5kYXRhW2NvZGVwKytdLmxlbjsKKyAJICAgIGlmKHdyaXRlX2lu
dChmZCxsZW4pID09IC0xKQorIAkJcmV0dXJuIC0xOworIAorIAkgICAgZmlsZWxlbis9c2l6ZW9m
KGludCk7CisgCSAgICAKKyAJICAgIGlmKHdyaXRlKGZkLGJjLT5kYXRhW2NvZGVwKytdLnN0cixs
ZW4pID09IC0xKQorIAkJcmV0dXJuIC0xOworIAkgICAgCisgCSAgICByZXQgPSBhbGlnbl9zdHJp
bmcoZmQsIGxlbik7CisgCSAgICBpZihyZXQgPT0gLTEpCisgCQlyZXR1cm4gLTE7CisgCisgCSAg
ICBmaWxlbGVuICs9IGxlbiArIHJldDsKKyAKKyAJICAgIGJyZWFrOworIAogIAljYXNlIEJfUkVK
RUNUOgogIAkgICAgLypqdXN0IGEgc3RyaW5nKi8KICAJICAgIGxlbiA9IGJjLT5kYXRhW2NvZGVw
KytdLmxlbjsKZGlmZiAtcmMgY3lydXMtaW1hcGQtMi4zLjE0L3NpZXZlL2JjX2V2YWwuYyBjeXJ1
cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS9iY19ldmFsLmMKKioqIGN5cnVzLWltYXBkLTIu
My4xNC9zaWV2ZS9iY19ldmFsLmMJMjAwOC0wMy0yNCAyMDowODo0Ni4wMDAwMDAwMDAgKzAwMDAK
LS0tIGN5cnVzLWltYXBkLTIuMy4xNC1wYXRjaGVkL3NpZXZlL2JjX2V2YWwuYwkyMDA5LTA2LTAy
IDEyOjM5OjA3LjAwMDAwMDAwMCArMDAwMAoqKioqKioqKioqKioqKioKKioqIDQ4Niw0OTIgKioq
KgogIAljaGFyICogYWRkcjsKICAJaW50IGFkZHJwYXJ0PUFERFJFU1NfQUxMOy8qIFhYWCBjb3Jy
ZWN0IGRlZmF1bHQgYmVoYXZpb3I/Ki8KICAKISAgCWludCBoZWFkZXJzaT1pKzU7LyogdGhlIGkg
dmFsdWUgZm9yIHRoZSBiZWdpbmluZyBvZiB0aGUgaGVhZGVycyAqLwogIAlpbnQgZGF0YWk9KG50
b2hsKGJjW2hlYWRlcnNpKzFdLnZhbHVlKS80KTsKICAKICAJaW50IG51bWhlYWRlcnM9bnRvaGwo
YmNbaGVhZGVyc2ldLmxlbik7Ci0tLSA0ODYsNDkyIC0tLS0KICAJY2hhciAqIGFkZHI7CiAgCWlu
dCBhZGRycGFydD1BRERSRVNTX0FMTDsvKiBYWFggY29ycmVjdCBkZWZhdWx0IGJlaGF2aW9yPyov
CiAgCiEgIAlpbnQgaGVhZGVyc2k9aSs2Oy8qIHRoZSBpIHZhbHVlIGZvciB0aGUgYmVnaW5pbmcg
b2YgdGhlIGhlYWRlcnMgKi8KICAJaW50IGRhdGFpPShudG9obChiY1toZWFkZXJzaSsxXS52YWx1
ZSkvNCk7CiAgCiAgCWludCBudW1oZWFkZXJzPW50b2hsKGJjW2hlYWRlcnNpXS5sZW4pOwoqKioq
KioqKioqKioqKioKKioqIDQ5Nyw1MDMgKioqKgogIAlpbnQgbWF0Y2g9bnRvaGwoYmNbaSsxXS52
YWx1ZSk7CiAgCWludCByZWxhdGlvbj1udG9obChiY1tpKzJdLnZhbHVlKTsKICAJaW50IGNvbXBh
cmF0b3I9bnRvaGwoYmNbaSszXS52YWx1ZSk7CiEgCWludCBhcGFydD1udG9obChiY1tpKzRdLnZh
bHVlKTsKICAJaW50IGNvdW50PTA7CiAgCWNoYXIgc2NvdW50WzNdOwogIAlpbnQgaXNSZWcgPSAo
bWF0Y2g9PUJfUkVHRVgpOwotLS0gNDk3LDUwNCAtLS0tCiAgCWludCBtYXRjaD1udG9obChiY1tp
KzFdLnZhbHVlKTsKICAJaW50IHJlbGF0aW9uPW50b2hsKGJjW2krMl0udmFsdWUpOwogIAlpbnQg
Y29tcGFyYXRvcj1udG9obChiY1tpKzNdLnZhbHVlKTsKISAJaW50IGV4dGxpc3RzID0gbnRvaGwo
YmNbaSs0XS52YWx1ZSk7Ly91bnVzZWQgeWV0CiEgCWludCBhcGFydD1udG9obChiY1tpKzVdLnZh
bHVlKTsKICAJaW50IGNvdW50PTA7CiAgCWNoYXIgc2NvdW50WzNdOwogIAlpbnQgaXNSZWcgPSAo
bWF0Y2g9PUJfUkVHRVgpOwoqKioqKioqKioqKioqKioKKioqIDY1Niw2NjIgKioqKgogICAgICB7
CiAgCWNvbnN0IGNoYXIqKiB2YWw7CiAgCiEgCWludCBoZWFkZXJzaT1pKzQ7Lyp0aGUgaSB2YWx1
ZSBmb3IgdGhlIGJlZ2luaW5nIG9mIGh0ZSBoZWFkZXJzKi8KICAJaW50IGRhdGFpPShudG9obChi
Y1toZWFkZXJzaSsxXS52YWx1ZSkvNCk7CiAgCiAgCWludCBudW1oZWFkZXJzPW50b2hsKGJjW2hl
YWRlcnNpXS5sZW4pOwotLS0gNjU3LDY2MyAtLS0tCiAgICAgIHsKICAJY29uc3QgY2hhcioqIHZh
bDsKICAKISAJaW50IGhlYWRlcnNpPWkrNTsvKnRoZSBpIHZhbHVlIGZvciB0aGUgYmVnaW5pbmcg
b2YgdGhlIGhlYWRlcnMqLwogIAlpbnQgZGF0YWk9KG50b2hsKGJjW2hlYWRlcnNpKzFdLnZhbHVl
KS80KTsKICAKICAJaW50IG51bWhlYWRlcnM9bnRvaGwoYmNbaGVhZGVyc2ldLmxlbik7CioqKioq
KioqKioqKioqKgoqKiogNjY3LDY3MiAqKioqCi0tLSA2NjgsNjc0IC0tLS0KICAJaW50IG1hdGNo
PW50b2hsKGJjW2krMV0udmFsdWUpOwogIAlpbnQgcmVsYXRpb249bnRvaGwoYmNbaSsyXS52YWx1
ZSk7CiAgCWludCBjb21wYXJhdG9yPW50b2hsKGJjW2krM10udmFsdWUpOworIAlpbnQgZXh0bGlz
dHMgPW50b2hsKGJjW2krNF0udmFsdWUpOwogIAlpbnQgY291bnQ9MDsJCiAgCWNoYXIgc2NvdW50
WzNdOwogIAlpbnQgaXNSZWcgPSAobWF0Y2g9PUJfUkVHRVgpOwoqKioqKioqKioqKioqKioKKioq
IDEwMjAsMTAyNSAqKioqCi0tLSAxMDIyLDEwMjggLS0tLQogIAkgICAgaXArKzsKICAJICAgIGJy
ZWFrOwogIAorICAgICAgICAgY2FzZSBCX0VSRUpFQ1Q6IC8qIDIxICovCiAgCWNhc2UgQl9SRUpF
Q1Q6LyozKi8KICAJICAgIGlwID0gdW53cmFwX3N0cmluZyhiYywgaXArMSwgJmRhdGEsIE5VTEwp
OwogIAkgICAgCioqKioqKioqKioqKioqKgoqKiogMTA1MSwxMDU3ICoqKioKICAJICAgIGlwKz0x
OwogIAogIAljYXNlIEJfUkVESVJFQ1RfT1JJRzovKjUqLwohIAl7CiAgCSAgICBpcCA9IHVud3Jh
cF9zdHJpbmcoYmMsIGlwKzEsICZkYXRhLCBOVUxMKTsKICAKICAJICAgIHJlcyA9IGRvX3JlZGly
ZWN0KGFjdGlvbnMsIGRhdGEsICFjb3B5KTsKLS0tIDEwNTQsMTA2MiAtLS0tCiAgCSAgICBpcCs9
MTsKICAKICAJY2FzZSBCX1JFRElSRUNUX09SSUc6Lyo1Ki8KISAJeyAKISAJICA7IGludCBleHRs
aXN0cyA9IG50b2hsKGJjW2lwKzFdLnZhbHVlKTsKISAJICAgIGlwKz0gMTsKICAJICAgIGlwID0g
dW53cmFwX3N0cmluZyhiYywgaXArMSwgJmRhdGEsIE5VTEwpOwogIAogIAkgICAgcmVzID0gZG9f
cmVkaXJlY3QoYWN0aW9ucywgZGF0YSwgIWNvcHkpOwpkaWZmIC1yYyBjeXJ1cy1pbWFwZC0yLjMu
MTQvc2lldmUvYmNfZ2VuZXJhdGUuYyBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS9i
Y19nZW5lcmF0ZS5jCioqKiBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvYmNfZ2VuZXJhdGUuYwky
MDA4LTAzLTI0IDIwOjA4OjQ2LjAwMDAwMDAwMCArMDAwMAotLS0gY3lydXMtaW1hcGQtMi4zLjE0
LXBhdGNoZWQvc2lldmUvYmNfZ2VuZXJhdGUuYwkyMDA5LTA2LTAyIDEyOjI3OjI5LjAwMDAwMDAw
MCArMDAwMAoqKioqKioqKioqKioqKioKKioqIDMwMywzMTAgKioqKgogIAlpZiAoY29kZXAgPT0g
LTEpIHJldHVybiAtMTsKICAJYnJlYWs7CiAgICAgIGNhc2UgSEVBREVSOgohIAkvKiBCQ19IRUFE
RVIgeyBjOiBjb21wYXJhdG9yIH0geyBoZWFkZXJzIDogc3RyaW5nIGxpc3QgfQohIAkgICB7IHBh
dHRlcm5zIDogc3RyaW5nIGxpc3QgfSAKICAJKi8KICAgICAgICAKICAJaWYoIWF0bGVhc3QocmV0
dmFsLGNvZGVwICsgMSkpIHJldHVybiAtMTsKLS0tIDMwMywzMTAgLS0tLQogIAlpZiAoY29kZXAg
PT0gLTEpIHJldHVybiAtMTsKICAJYnJlYWs7CiAgICAgIGNhc2UgSEVBREVSOgohIAkvKiBCQ19I
RUFERVIgeyBjOiBjb21wYXJhdG9yIH0geyBiOiBleHRsaXN0cyAwLzF9CiEgICAgICAgICAgICB7
IGhlYWRlcnMgOiBzdHJpbmcgbGlzdCB9ICB7IHBhdHRlcm5zIDogc3RyaW5nIGxpc3QgfSAKICAJ
Ki8KICAgICAgICAKICAJaWYoIWF0bGVhc3QocmV0dmFsLGNvZGVwICsgMSkpIHJldHVybiAtMTsK
KioqKioqKioqKioqKioqCioqKiAzMTcsMzIyICoqKioKLS0tIDMxNywzMjUgLS0tLQogIAkJCQkg
ICAgICAgdC0+dS5oLmNvbXBhcmF0b3IpOwogIAlpZiAoY29kZXAgPT0gLTEpIHJldHVybiAtMTsK
ICAgICAgICAKKyAJLyogZXh0bGlzdHMgKi8KKyAJcmV0dmFsLT5kYXRhW2NvZGVwKytdLnZhbHVl
ID0gdC0+dS5oLmV4dGxpc3RzOworIAogIAkvKiBoZWFkZXJzICovCiAgCWNvZGVwID0gYmNfc3Ry
aW5nbGlzdF9nZW5lcmF0ZShjb2RlcCwgcmV0dmFsLCB0LT51Lmguc2wpOwogIAlpZiAoY29kZXAg
PT0gLTEpIHJldHVybiAtMTsKKioqKioqKioqKioqKioqCioqKiAzMjcsMzMzICoqKioKICAJYnJl
YWs7CiAgICAgIGNhc2UgQUREUkVTUzoKICAgICAgY2FzZSBFTlZFTE9QRToKISAJLyogKEJDX0FE
RFJFU1MgfCBCQ19FTlZFTE9QRSkge2MgOiBjb21wYXJhdG9yfSAKICAJICAgKEJfQUxMIHwgQl9M
T0NBTFBBUlQgfCAuLi4pIHsgaGVhZGVyIDogc3RyaW5nIGxpc3QgfQogIAkgICB7IHBhdHRlcm4g
OiBzdHJpbmcgbGlzdCB9ICovCiAgICAgICAgCi0tLSAzMzAsMzM2IC0tLS0KICAJYnJlYWs7CiAg
ICAgIGNhc2UgQUREUkVTUzoKICAgICAgY2FzZSBFTlZFTE9QRToKISAJLyogKEJDX0FERFJFU1Mg
fCBCQ19FTlZFTE9QRSkge2MgOiBjb21wYXJhdG9yfSB7YiA6IGV4dGxpc3RzfQogIAkgICAoQl9B
TEwgfCBCX0xPQ0FMUEFSVCB8IC4uLikgeyBoZWFkZXIgOiBzdHJpbmcgbGlzdCB9CiAgCSAgIHsg
cGF0dGVybiA6IHN0cmluZyBsaXN0IH0gKi8KICAgICAgICAKKioqKioqKioqKioqKioqCioqKiAz
MzUsMzQ2ICoqKioKICAgICAgICAKICAJcmV0dmFsLT5kYXRhW2NvZGVwKytdLm9wID0gKHQtPnR5
cGUgPT0gQUREUkVTUykKICAJICAgID8gQkNfQUREUkVTUyA6IEJDX0VOVkVMT1BFOwohICAgICAg
ICAgICAgIAogIAljb2RlcCA9IGJjX2NvbXBhcmF0b3JfZ2VuZXJhdGUoY29kZXAsIHJldHZhbCx0
LT51LmFlLmNvbXB0YWcsCiAgCQkJCSAgICAgICB0LT51LmFlLnJlbGF0aW9uLCAKICAJCQkJICAg
ICAgIHQtPnUuYWUuY29tcGFyYXRvcik7CiAgCWlmIChjb2RlcCA9PSAtMSkgcmV0dXJuIC0xOwog
IAogIAlpZighYXRsZWFzdChyZXR2YWwsY29kZXArMSkpIHJldHVybiAtMTsKICAKICAJLyphZGRy
ZXNzIHBhcnQqLwotLS0gMzM4LDM1MiAtLS0tCiAgICAgICAgCiAgCXJldHZhbC0+ZGF0YVtjb2Rl
cCsrXS5vcCA9ICh0LT50eXBlID09IEFERFJFU1MpCiAgCSAgICA/IEJDX0FERFJFU1MgOiBCQ19F
TlZFTE9QRTsKISAgICAgICAgIC8qIGNvbXBhcmF0b3IgKi8KICAJY29kZXAgPSBiY19jb21wYXJh
dG9yX2dlbmVyYXRlKGNvZGVwLCByZXR2YWwsdC0+dS5hZS5jb21wdGFnLAogIAkJCQkgICAgICAg
dC0+dS5hZS5yZWxhdGlvbiwgCiAgCQkJCSAgICAgICB0LT51LmFlLmNvbXBhcmF0b3IpOwogIAlp
ZiAoY29kZXAgPT0gLTEpIHJldHVybiAtMTsKICAKKyAJLyogZXh0bGlzdHMgKi8KKyAgICAgICAg
CXJldHZhbC0+ZGF0YVtjb2RlcCsrXS52YWx1ZSA9IHQtPnUuYWUuZXh0bGlzdHM7CisgCiAgCWlm
KCFhdGxlYXN0KHJldHZhbCxjb2RlcCsxKSkgcmV0dXJuIC0xOwogIAogIAkvKmFkZHJlc3MgcGFy
dCovCioqKioqKioqKioqKioqKgoqKiogNTUwLDU2MCAqKioqCiAgCSAgICBjYXNlIFJFRElSRUNU
OgogIAkJLyogUkVESVJFQ1QKICAJCSAgIFZBTFVFIGNvcHkKICAJCSAgIFNUUklORyBhZGRyZXNz
CiAgCQkqLwohIAkJaWYoIWF0bGVhc3QocmV0dmFsLGNvZGVwKzQpKSByZXR1cm4gLTE7CiAgCQly
ZXR2YWwtPmRhdGFbY29kZXArK10ub3AgPSBCX1JFRElSRUNUOwogIAkJcmV0dmFsLT5kYXRhW2Nv
ZGVwKytdLnZhbHVlID0gYy0+dS5yLmNvcHk7CiAgCQlyZXR2YWwtPmRhdGFbY29kZXArK10ubGVu
ID0gc3RybGVuKGMtPnUuci5hZGRyZXNzKTsKICAJCXJldHZhbC0+ZGF0YVtjb2RlcCsrXS5zdHIg
PSBjLT51LnIuYWRkcmVzczsKICAJCWJyZWFrOwotLS0gNTYzLDU3NSAtLS0tCiAgCSAgICBjYXNl
IFJFRElSRUNUOgogIAkJLyogUkVESVJFQ1QKICAJCSAgIFZBTFVFIGNvcHkKKyAgICAgICAgICAg
ICAgICAgICAgVkFMVUUgZXh0bGlzdHMKICAJCSAgIFNUUklORyBhZGRyZXNzCiAgCQkqLwohIAkJ
aWYoIWF0bGVhc3QocmV0dmFsLGNvZGVwKzUpKSByZXR1cm4gLTE7CiAgCQlyZXR2YWwtPmRhdGFb
Y29kZXArK10ub3AgPSBCX1JFRElSRUNUOwogIAkJcmV0dmFsLT5kYXRhW2NvZGVwKytdLnZhbHVl
ID0gYy0+dS5yLmNvcHk7CisgCQlyZXR2YWwtPmRhdGFbY29kZXArK10udmFsdWUgPSBjLT51LnIu
ZXh0bGlzdHM7CiAgCQlyZXR2YWwtPmRhdGFbY29kZXArK10ubGVuID0gc3RybGVuKGMtPnUuci5h
ZGRyZXNzKTsKICAJCXJldHZhbC0+ZGF0YVtjb2RlcCsrXS5zdHIgPSBjLT51LnIuYWRkcmVzczsK
ICAJCWJyZWFrOwpkaWZmIC1yYyBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvYnl0ZWNvZGUuaCBj
eXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS9ieXRlY29kZS5oCioqKiBjeXJ1cy1pbWFw
ZC0yLjMuMTQvc2lldmUvYnl0ZWNvZGUuaAkyMDA4LTAzLTI0IDIwOjA4OjQ2LjAwMDAwMDAwMCAr
MDAwMAotLS0gY3lydXMtaW1hcGQtMi4zLjE0LXBhdGNoZWQvc2lldmUvYnl0ZWNvZGUuaAkyMDA5
LTA2LTAyIDEyOjAzOjU0LjAwMDAwMDAwMCArMDAwMAoqKioqKioqKioqKioqKioKKioqIDk2LDEw
MyAqKioqCiAgICogdmVyc2lvbiAweDAzIHNjcmlwdHMgaW1wbGVtZW50ZWQgc2hvcnQtY2lyY3Vp
dGluZyBvZiB0ZXN0bGlzdHMgKHJlY29tcGlsZSkKICAgKiB2ZXJzaW9uIDB4MDQgc2NyaXB0cyBp
bXBsZW1lbnRlZCBCT0RZLCBJTkNMVURFIGFuZCBDT1BZIGV4dGVuc2lvbnMKICAgKiB2ZXJzaW9u
IDB4MDUgc2NyaXB0cyBpbXBsZW1lbnRlZCB1cGRhdGVkIFZBQ0FUSU9OICg6ZnJvbSBhbmQgOmhh
bmRsZSkKICAgKi8KISAjZGVmaW5lIEJZVEVDT0RFX1ZFUlNJT04gMHgwNQogICNkZWZpbmUgQllU
RUNPREVfTUlOX1ZFUlNJT04gMHgwMyAvKiBtaW5pbXVtIHN1cHBvcnRlZCB2ZXJzaW9uICovCiAg
I2RlZmluZSBCWVRFQ09ERV9NQUdJQyAiQ3lyU0J5dGVjb2RlIgogICNkZWZpbmUgQllURUNPREVf
TUFHSUNfTEVOIDEyIC8qIFNob3VsZCBiZSBtdWx0aXBsZSBvZiA0ICovCi0tLSA5NiwxMDQgLS0t
LQogICAqIHZlcnNpb24gMHgwMyBzY3JpcHRzIGltcGxlbWVudGVkIHNob3J0LWNpcmN1aXRpbmcg
b2YgdGVzdGxpc3RzIChyZWNvbXBpbGUpCiAgICogdmVyc2lvbiAweDA0IHNjcmlwdHMgaW1wbGVt
ZW50ZWQgQk9EWSwgSU5DTFVERSBhbmQgQ09QWSBleHRlbnNpb25zCiAgICogdmVyc2lvbiAweDA1
IHNjcmlwdHMgaW1wbGVtZW50ZWQgdXBkYXRlZCBWQUNBVElPTiAoOmZyb20gYW5kIDpoYW5kbGUp
CisgICogdmVyc2lvbiAweDA2IHNjcmlwdHMgaW1wbGVtZW50ZWQgZXh0ZXJuYWwtbGlzdHMKICAg
Ki8KISAjZGVmaW5lIEJZVEVDT0RFX1ZFUlNJT04gMHgwNgogICNkZWZpbmUgQllURUNPREVfTUlO
X1ZFUlNJT04gMHgwMyAvKiBtaW5pbXVtIHN1cHBvcnRlZCB2ZXJzaW9uICovCiAgI2RlZmluZSBC
WVRFQ09ERV9NQUdJQyAiQ3lyU0J5dGVjb2RlIgogICNkZWZpbmUgQllURUNPREVfTUFHSUNfTEVO
IDEyIC8qIFNob3VsZCBiZSBtdWx0aXBsZSBvZiA0ICovCmRpZmYgLXJjIGN5cnVzLWltYXBkLTIu
My4xNC9zaWV2ZS9pbnRlcnAuYyBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS9pbnRl
cnAuYwoqKiogY3lydXMtaW1hcGQtMi4zLjE0L3NpZXZlL2ludGVycC5jCTIwMDgtMDMtMjQgMjA6
MDg6NDYuMDAwMDAwMDAwICswMDAwCi0tLSBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2
ZS9pbnRlcnAuYwkyMDA5LTA1LTI4IDE4OjAyOjU3LjAwMDAwMDAwMCArMDAwMAoqKioqKioqKioq
KioqKioKKioqIDE0NSwxNTAgKioqKgotLS0gMTQ4LDE1NiAtLS0tCiAgCSAgICBzdHJsY2F0KGV4
dGVuc2lvbnMsICIgc3ViYWRkcmVzcyIsIHNpemVvZihleHRlbnNpb25zKSk7CiAgCWlmIChjb25m
aWdfc2lldmVfZXh0ZW5zaW9ucyAmIElNQVBfRU5VTV9TSUVWRV9FWFRFTlNJT05TX0NPUFkpCiAg
CSAgICBzdHJsY2F0KGV4dGVuc2lvbnMsICIgY29weSIsIHNpemVvZihleHRlbnNpb25zKSk7Cisg
ICAgICAgICBpZiAoLy9pLT5leHRsaXN0cyAmJgorICAJICAgIChjb25maWdfc2lldmVfZXh0ZW5z
aW9ucyAmIElNQVBfRU5VTV9TSUVWRV9FWFRFTlNJT05TX0VYVExJU1RTKSkKKyAJICAgIHN0cmxj
YXQoZXh0ZW5zaW9ucywgIiBleHRsaXN0cyIsIHNpemVvZihleHRlbnNpb25zKSk7CiAgICAgIH0K
ICAKICAgICAgcmV0dXJuIGV4dGVuc2lvbnM7CmRpZmYgLXJjIGN5cnVzLWltYXBkLTIuMy4xNC9z
aWV2ZS9zY3JpcHQuYyBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS9zY3JpcHQuYwoq
KiogY3lydXMtaW1hcGQtMi4zLjE0L3NpZXZlL3NjcmlwdC5jCTIwMDgtMDMtMjQgMjA6MDg6NDYu
MDAwMDAwMDAwICswMDAwCi0tLSBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS9zY3Jp
cHQuYwkyMDA5LTA1LTI4IDE4OjE3OjI3LjAwMDAwMDAwMCArMDAwMAoqKioqKioqKioqKioqKioK
KioqIDE2NSwxNzAgKioqKgotLS0gMTczLDE4MiAtLS0tCiAgCSAgICAgICAoY29uZmlnX3NpZXZl
X2V4dGVuc2lvbnMgJiBJTUFQX0VOVU1fU0lFVkVfRVhURU5TSU9OU19DT1BZKSkgewogIAlzLT5z
dXBwb3J0LmNvcHkgPSAxOwogIAlyZXR1cm4gMTsKKyAgICAgfSBlbHNlIGlmICghc3RyY21wKCJl
eHRsaXN0cyIsIHJlcSkgJiYKKyAgCSAgICAgICAoY29uZmlnX3NpZXZlX2V4dGVuc2lvbnMgJiBJ
TUFQX0VOVU1fU0lFVkVfRVhURU5TSU9OU19FWFRMSVNUUykpIHsKKyAgCXMtPnN1cHBvcnQuZXh0
bGlzdHMgPSAxOworICAJcmV0dXJuIDE7CiAgICAgIH0KICAgICAgcmV0dXJuIDA7CiAgfQpkaWZm
IC1yYyBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvc2NyaXB0LmggY3lydXMtaW1hcGQtMi4zLjE0
LXBhdGNoZWQvc2lldmUvc2NyaXB0LmgKKioqIGN5cnVzLWltYXBkLTIuMy4xNC9zaWV2ZS9zY3Jp
cHQuaAkyMDA4LTAzLTI0IDIwOjA4OjQ2LjAwMDAwMDAwMCArMDAwMAotLS0gY3lydXMtaW1hcGQt
Mi4zLjE0LXBhdGNoZWQvc2lldmUvc2NyaXB0LmgJMjAwOS0wNS0yOCAxNzo1OTozNC4wMDAwMDAw
MDAgKzAwMDAKKioqKioqKioqKioqKioqCioqKiA3Miw3NyAqKioqCi0tLSA3Miw3OCAtLS0tCiAg
CWludCBpX2FzY2lpX251bWVyaWM6IDE7CiAgCWludCBpbmNsdWRlICAgICAgICA6IDE7CiAgCWlu
dCBjb3B5ICAgICAgICAgICA6IDE7CisgICAgICAgICBpbnQgZXh0bGlzdHMgICAgICAgOiAxOyAK
ICAgICAgfSBzdXBwb3J0OwogIAogICAgICB2b2lkICpzY3JpcHRfY29udGV4dDsKZGlmZiAtcmMg
Y3lydXMtaW1hcGQtMi4zLjE0L3NpZXZlL3NpZXZlYy5jIGN5cnVzLWltYXBkLTIuMy4xNC1wYXRj
aGVkL3NpZXZlL3NpZXZlYy5jCmRpZmYgLXJjIGN5cnVzLWltYXBkLTIuMy4xNC9zaWV2ZS9zaWV2
ZWQuYyBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS9zaWV2ZWQuYwoqKiogY3lydXMt
aW1hcGQtMi4zLjE0L3NpZXZlL3NpZXZlZC5jCTIwMDgtMDMtMjQgMjA6MDg6NDYuMDAwMDAwMDAw
ICswMDAwCi0tLSBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS9zaWV2ZWQuYwkyMDA5
LTA2LTAyIDEyOjM1OjUxLjAwMDAwMDAwMCArMDAwMAoqKioqKioqKioqKioqKioKKioqIDI3MCwy
NzUgKioqKgotLS0gMjcwLDI3NyAtLS0tCiAgICAgIGNhc2UgQkNfQUREUkVTUzovKjcqLwogIAlw
cmludGYoIkFkZHJlc3MgWyIpOwogIAlpPXByaW50Q29tcGFyaXNvbihkLCBpKzEpOworICAgICAg
ICAgaWYgKG50b2hsKGRbaSsrXS52YWx1ZSkpCisgCSAgcHJpbnRmKCIgICAgICAgICAgICAgICBl
eHRsaXN0c1xuIik7CiAgCXByaW50ZigiICAgICAgICAgICAgICAgdHlwZTogIik7CiAgCXN3aXRj
aChudG9obChkW2krK10udmFsdWUpKQogIAl7CioqKioqKioqKioqKioqKgoqKiogMjg4LDI5MyAq
KioqCi0tLSAyOTAsMjk3IC0tLS0KICAgICAgY2FzZSBCQ19FTlZFTE9QRTovKjgqLwogIAlwcmlu
dGYoIkVudmVsb3BlIFsiKTsKICAJaT1wcmludENvbXBhcmlzb24oZCwgaSsxKTsKKyAgICAgICAg
IGlmIChudG9obChkW2krK10udmFsdWUpKQorIAkgIHByaW50ZigiICAgICAgICAgICAgICAgZXh0
bGlzdHNcbiIpOwogIAlwcmludGYoIiAgICAgICAgICAgICAgICB0eXBlOiAiKTsKICAJc3dpdGNo
KG50b2hsKGRbaSsrXS52YWx1ZSkpCiAgCXsKKioqKioqKioqKioqKioqCioqKiAzMDYsMzExICoq
KioKLS0tIDMxMCwzMTcgLS0tLQogICAgICBjYXNlIEJDX0hFQURFUjovKjkqLwogIAlwcmludGYo
IkhlYWRlciBbIik7CiAgCWk9IHByaW50Q29tcGFyaXNvbihkLCBpKzEpOworICAgICAgICAgaWYg
KG50b2hsKGRbaSsrXS52YWx1ZSkpCisgCSAgcHJpbnRmKCIgICAgICAgICAgICAgICBleHRsaXN0
c1xuIik7CiAgCXByaW50ZigiICAgICAgICAgICAgICBIZWFkZXJzOiAiKTsKICAJaT13cml0ZV9s
aXN0KG50b2hsKGRbaV0ubGVuKSwgaSsxLCBkKTsKICAJcHJpbnRmKCIgICAgICAgICAgICAgIERh
dGE6ICIpOwoqKioqKioqKioqKioqKioKKioqIDM3NywzODIgKioqKgotLS0gMzgyLDM5MSAtLS0t
CiAgCSAgICBpID0gdW53cmFwX3N0cmluZyhkLCBpLCAmZGF0YSwgJmxlbik7CiAgCSAgICBwcmlu
dGYoIlJFSkVDVCB7JWR9JXNcbiIsIGxlbiwgZGF0YSk7CiAgCSAgICBicmVhazsKKyAJY2FzZSBC
X0VSRUpFQ1Q6IC8qMjEqLworIAkgICAgaSA9IHVud3JhcF9zdHJpbmcoZCwgaSwgJmRhdGEsICZs
ZW4pOworIAkgICAgcHJpbnRmKCJFUkVKRUNUIHslZH0lc1xuIiwgbGVuLCBkYXRhKTsKKyAJICAg
IGJyZWFrOwogIAogIAljYXNlIEJfRklMRUlOVE86IC8qMTkqLwogIAkgICAgY29weSA9IG50b2hs
KGRbaSsrXS52YWx1ZSk7CioqKioqKioqKioqKioqKgoqKiogMzg3LDM5NSAqKioqCiAgCiAgCWNh
c2UgQl9SRURJUkVDVDogLyoyMCovCiAgCSAgICBjb3B5ID0gbnRvaGwoZFtpKytdLnZhbHVlKTsK
ISAJY2FzZSBCX1JFRElSRUNUX09SSUc6IC8qNSovCiAgCSAgICBpID0gdW53cmFwX3N0cmluZyhk
LCBpLCAmZGF0YSwgJmxlbik7CiEgCSAgICBwcmludGYoIlJFRElSRUNUIENPUFkoJWQpIEFERFJF
U1MoeyVkfSVzKVxuIixjb3B5LGxlbixkYXRhKTsKICAJICAgIGJyZWFrOwogIAkgICAgIAogIAlj
YXNlIEJfSUY6Lyo2Ki8KLS0tIDM5Niw0MDUgLS0tLQogIAogIAljYXNlIEJfUkVESVJFQ1Q6IC8q
MjAqLwogIAkgICAgY29weSA9IG50b2hsKGRbaSsrXS52YWx1ZSk7CiEgCWNhc2UgQl9SRURJUkVD
VF9PUklHOiAvKjUqLyA7CiEgCSAgICBpbnQgZXh0bGlzdHMgPSBudG9obChkW2krK10udmFsdWUp
OwogIAkgICAgaSA9IHVud3JhcF9zdHJpbmcoZCwgaSwgJmRhdGEsICZsZW4pOwohIAkgICAgcHJp
bnRmKCJSRURJUkVDVCBDT1BZKCVkKSBFWFRMSVNUUyglZCkgQUREUkVTUyh7JWR9JXMpXG4iLGNv
cHksIGV4dGxpc3RzLCBsZW4sZGF0YSk7CiAgCSAgICBicmVhazsKICAJICAgICAKICAJY2FzZSBC
X0lGOi8qNiovCmRpZmYgLXJjIGN5cnVzLWltYXBkLTIuMy4xNC9zaWV2ZS9zaWV2ZV9pbnRlcmZh
Y2UuaCBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS9zaWV2ZV9pbnRlcmZhY2UuaAoq
KiogY3lydXMtaW1hcGQtMi4zLjE0L3NpZXZlL3NpZXZlX2ludGVyZmFjZS5oCTIwMDgtMDMtMjQg
MjA6MDg6NDYuMDAwMDAwMDAwICswMDAwCi0tLSBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9z
aWV2ZS9zaWV2ZV9pbnRlcmZhY2UuaAkyMDA5LTA1LTMxIDIyOjMyOjE5LjAwMDAwMDAwMCArMDAw
MAoqKioqKioqKioqKioqKioKKioqIDEwNCwxMDkgKioqKgotLS0gMTA0LDExMCAtLS0tCiAgCiAg
dHlwZWRlZiBzdHJ1Y3Qgc2lldmVfcmVkaXJlY3RfY29udGV4dCB7CiAgICAgIGNvbnN0IGNoYXIg
KmFkZHI7CisgICAgIGNvbnN0IGNoYXIgZXh0bGlzdHM7CiAgfSBzaWV2ZV9yZWRpcmVjdF9jb250
ZXh0X3Q7CiAgCiAgdHlwZWRlZiBzdHJ1Y3Qgc2lldmVfcmVqZWN0X2NvbnRleHQgewoqKiogY3ly
dXMtaW1hcGQtMi4zLjE0L3NpZXZlL3NpZXZlLWxleC5sCTIwMDgtMDMtMjQgMjA6MDg6NDYuMDAw
MDAwMDAwICswMDAwCi0tLSBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hlZC9zaWV2ZS9zaWV2ZS1s
ZXgubAkyMDA5LTA1LTI4IDE3OjUwOjMyLjAwMDAwMDAwMCArMDAwMAoqKioqKioqKioqKioqKioK
KioqIDE2MCwxNjUgKioqKgotLS0gMTYxLDE2NyAtLS0tCiAgPElOSVRJQUw+Omdsb2JhbAlyZXR1
cm4gR0xPQkFMOwogIDxJTklUSUFMPnJldHVybgkJcmV0dXJuIFJFVFVSTjsKICA8SU5JVElBTD46
Y29weQkJcmV0dXJuIENPUFk7CisgPElOSVRJQUw+Omxpc3QgICAgICAgICAgcmV0dXJuIExJU1Q7
CiAgPElOSVRJQUw+WyBcdFxuXHJdIDsJLyogaWdub3JlIHdoaXRlc3BhY2UgKi8KICA8SU5JVElB
TD4jLiogOwkJLyogaWdub3JlIGhhc2ggY29tbWVudHMgKi8KICA8SU5JVElBTD4iLyoiKFteXCpd
fFwqW15cL10pKlwqPyIqLyIgOwkvKiBpZ25vcmUgYnJhY2tldCBjb21tZW50cyAqLwpkaWZmIC1y
YyBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvc2lldmUueSBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0
Y2hlZC9zaWV2ZS9zaWV2ZS55CioqKiBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvc2lldmUueQky
MDA4LTEwLTAyIDEzOjM2OjU2LjAwMDAwMDAwMCArMDAwMAotLS0gY3lydXMtaW1hcGQtMi4zLjE0
LXBhdGNoZWQvc2lldmUvc2lldmUueQkyMDA5LTA1LTI4IDIzOjEzOjQzLjAwMDAwMDAwMCArMDAw
MAoqKioqKioqKioqKioqKioKKioqIDY1LDcxICoqKioKICAKICAgICAgLyogZGVmaW5pdGlvbnMg
Ki8KICAgICAgZXh0ZXJuIGludCBhZGRycGFyc2Uodm9pZCk7CiEgCiAgc3RydWN0IHZ0YWdzIHsK
ICAgICAgaW50IGRheXM7CiAgICAgIHN0cmluZ2xpc3RfdCAqYWRkcmVzc2VzOwotLS0gNjUsNzUg
LS0tLQogIAogICAgICAvKiBkZWZpbml0aW9ucyAqLwogICAgICBleHRlcm4gaW50IGFkZHJwYXJz
ZSh2b2lkKTsKISBzdHJ1Y3QgcnRhZ3MgewohICAgIGNoYXIgY29weTsKISAgICBjaGFyIGV4dGxp
c3RzOwohIH07CiEgIAogIHN0cnVjdCB2dGFncyB7CiAgICAgIGludCBkYXlzOwogICAgICBzdHJp
bmdsaXN0X3QgKmFkZHJlc3NlczsKKioqKioqKioqKioqKioqCioqKiA3OSw4NCAqKioqCi0tLSA4
Myw4OSAtLS0tCiAgICAgIGNoYXIgKmNvbXBhcmF0b3I7CiAgICAgIGludCBjb21wdGFnOwogICAg
ICBpbnQgcmVsYXRpb247CisgICAgIGNoYXIgZXh0bGlzdHM7CiAgfTsKICAKICBzdHJ1Y3QgYWV0
YWdzIHsKKioqKioqKioqKioqKioqCioqKiA4Niw5MSAqKioqCi0tLSA5MSw5NyAtLS0tCiAgICAg
IGNoYXIgKmNvbXBhcmF0b3I7CiAgICAgIGludCBjb21wdGFnOwogICAgICBpbnQgcmVsYXRpb247
CisgICAgIGNoYXIgZXh0bGlzdHM7CiAgfTsKICAKICBzdHJ1Y3QgYnRhZ3MgewoqKioqKioqKioq
KioqKioKKioqIDEyNCwxMzAgKioqKgogIHN0YXRpYyBjb21tYW5kbGlzdF90ICpidWlsZF9ub3Rp
ZnkoaW50IHQsIHN0cnVjdCBudGFncyAqbik7CiAgc3RhdGljIGNvbW1hbmRsaXN0X3QgKmJ1aWxk
X2Rlbm90aWZ5KGludCB0LCBzdHJ1Y3QgZHRhZ3MgKm4pOwogIHN0YXRpYyBjb21tYW5kbGlzdF90
ICpidWlsZF9maWxlaW50byhpbnQgdCwgaW50IGMsIGNoYXIgKmYpOwohIHN0YXRpYyBjb21tYW5k
bGlzdF90ICpidWlsZF9yZWRpcmVjdChpbnQgdCwgaW50IGMsIGNoYXIgKmEpOwogIHN0YXRpYyBz
dHJ1Y3QgYWV0YWdzICpuZXdfYWV0YWdzKHZvaWQpOwogIHN0YXRpYyBzdHJ1Y3QgYWV0YWdzICpj
YW5vbl9hZXRhZ3Moc3RydWN0IGFldGFncyAqYWUpOwogIHN0YXRpYyB2b2lkIGZyZWVfYWV0YWdz
KHN0cnVjdCBhZXRhZ3MgKmFlKTsKLS0tIDEzMCwxMzggLS0tLQogIHN0YXRpYyBjb21tYW5kbGlz
dF90ICpidWlsZF9ub3RpZnkoaW50IHQsIHN0cnVjdCBudGFncyAqbik7CiAgc3RhdGljIGNvbW1h
bmRsaXN0X3QgKmJ1aWxkX2Rlbm90aWZ5KGludCB0LCBzdHJ1Y3QgZHRhZ3MgKm4pOwogIHN0YXRp
YyBjb21tYW5kbGlzdF90ICpidWlsZF9maWxlaW50byhpbnQgdCwgaW50IGMsIGNoYXIgKmYpOwoh
IHN0YXRpYyBjb21tYW5kbGlzdF90ICpidWlsZF9yZWRpcmVjdChpbnQgdCwgc3RydWN0IHJ0YWdz
ICpjLCBjaGFyICphKTsKISBzdGF0aWMgc3RydWN0IHJ0YWdzICpuZXdfcnRhZ3Modm9pZCk7CiEg
c3RhdGljIHZvaWQgZnJlZV9ydGFncyhzdHJ1Y3QgcnRhZ3MgKnIpOwogIHN0YXRpYyBzdHJ1Y3Qg
YWV0YWdzICpuZXdfYWV0YWdzKHZvaWQpOwogIHN0YXRpYyBzdHJ1Y3QgYWV0YWdzICpjYW5vbl9h
ZXRhZ3Moc3RydWN0IGFldGFncyAqYWUpOwogIHN0YXRpYyB2b2lkIGZyZWVfYWV0YWdzKHN0cnVj
dCBhZXRhZ3MgKmFlKTsKKioqKioqKioqKioqKioqCioqKiAxNzQsMTc5ICoqKioKLS0tIDE4Miwx
ODggLS0tLQogICAgICBjb21tYW5kbGlzdF90ICpjbDsKICAgICAgc3RydWN0IHZ0YWdzICp2dGFn
OwogICAgICBzdHJ1Y3QgYWV0YWdzICphZXRhZzsKKyAgICAgc3RydWN0IHJ0YWdzICpydGFnOwog
ICAgICBzdHJ1Y3QgaHRhZ3MgKmh0YWc7CiAgICAgIHN0cnVjdCBidGFncyAqYnRhZzsKICAgICAg
c3RydWN0IG50YWdzICpudGFnOwoqKioqKioqKioqKioqKioKKioqIDE5NCwyMDAgKioqKgogICV0
b2tlbiBEQVlTIEFERFJFU1NFUyBTVUJKRUNUIEZST00gSEFORExFIE1JTUUKICAldG9rZW4gTUVU
SE9EIElEIE9QVElPTlMgTE9XIE5PUk1BTCBISUdIIEFOWSBNRVNTQUdFCiAgJXRva2VuIElOQ0xV
REUgUEVSU09OQUwgR0xPQkFMIFJFVFVSTgohICV0b2tlbiBDT1BZCiAgCiAgJXR5cGUgPGNsPiBj
b21tYW5kcyBjb21tYW5kIGFjdGlvbiBlbHNpZiBibG9jawogICV0eXBlIDxzbD4gc3RyaW5nbGlz
dCBzdHJpbmdzCi0tLSAyMDMsMjA5IC0tLS0KICAldG9rZW4gREFZUyBBRERSRVNTRVMgU1VCSkVD
VCBGUk9NIEhBTkRMRSBNSU1FCiAgJXRva2VuIE1FVEhPRCBJRCBPUFRJT05TIExPVyBOT1JNQUwg
SElHSCBBTlkgTUVTU0FHRQogICV0b2tlbiBJTkNMVURFIFBFUlNPTkFMIEdMT0JBTCBSRVRVUk4K
ISAldG9rZW4gQ09QWSBMSVNUCiAgCiAgJXR5cGUgPGNsPiBjb21tYW5kcyBjb21tYW5kIGFjdGlv
biBlbHNpZiBibG9jawogICV0eXBlIDxzbD4gc3RyaW5nbGlzdCBzdHJpbmdzCioqKioqKioqKioq
KioqKgoqKiogMjAzLDIwOCAqKioqCi0tLSAyMTIsMjE4IC0tLS0KICAldHlwZSA8dGVzdGw+IHRl
c3RsaXN0IHRlc3RzCiAgJXR5cGUgPGh0YWc+IGh0YWdzCiAgJXR5cGUgPGFldGFnPiBhZXRhZ3MK
KyAldHlwZSA8cnRhZz4gcnRhZ3MKICAldHlwZSA8YnRhZz4gYnRhZ3MKICAldHlwZSA8dnRhZz4g
dnRhZ3MKICAldHlwZSA8bnRhZz4gbnRhZ3MKKioqKioqKioqKioqKioqCioqKiAyNTYsMjYyICoq
KioKICAJCQkJICAgICBZWUVSUk9SOyAvKiB2bSBzaG91bGQgY2FsbCB5eWVycm9yKCkgKi8KICAJ
CQkJICAgfQogIAkgICAgICAgICAgICAgICAgICAgICAgICAgICAkJCA9IGJ1aWxkX2ZpbGVpbnRv
KEZJTEVJTlRPLCAkMiwgJDMpOyB9CiEgCXwgUkVESVJFQ1QgY29weSBTVFJJTkcgICB7IGlmICgh
dmVyaWZ5X2FkZHJlc3MoJDMpKSB7CiAgCQkJCSAgICAgWVlFUlJPUjsgLyogdmEgc2hvdWxkIGNh
bGwgeXllcnJvcigpICovCiAgCQkJCSAgIH0KICAJICAgICAgICAgICAgICAgICAgICAgICAgICAg
JCQgPSBidWlsZF9yZWRpcmVjdChSRURJUkVDVCwgJDIsICQzKTsgfQotLS0gMjgzLDI4OSAtLS0t
CiAgCQkJCSAgICAgWVlFUlJPUjsgLyogdm0gc2hvdWxkIGNhbGwgeXllcnJvcigpICovCiAgCQkJ
CSAgIH0KICAJICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQgPSBidWlsZF9maWxlaW50byhG
SUxFSU5UTywgJDIsICQzKTsgfQohICAgICAgICAgfCBSRURJUkVDVCBydGFncyBTVFJJTkcgICB7
IGlmICgkMi0+ZXh0bGlzdHMgPT0gMCAmJiAhdmVyaWZ5X2FkZHJlc3MoJDMpKSB7CiAgCQkJCSAg
ICAgWVlFUlJPUjsgLyogdmEgc2hvdWxkIGNhbGwgeXllcnJvcigpICovCiAgCQkJCSAgIH0KICAJ
ICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQgPSBidWlsZF9yZWRpcmVjdChSRURJUkVDVCwg
JDIsICQzKTsgfQoqKioqKioqKioqKioqKioKKioqIDM0NiwzNTEgKioqKgotLS0gMzczLDM5OSAt
LS0tCiAgCXwgUEVSU09OQUwJCSB7ICQkID0gUEVSU09OQUw7IH0KICAJfCBHTE9CQUwJCSB7ICQk
ID0gR0xPQkFMOyB9CiAgCTsKKyAgcnRhZ3M6IC8qIGVtcHR5ICovCQkgeyAkJCA9IG5ld19ydGFn
cygpOyB9CisgIAl8IHJ0YWdzIENPUFkJCSB7ICQkID0gJDE7CisgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgaWYgKCFwYXJzZV9zY3JpcHQtPnN1cHBvcnQuY29weSkgeworICAJ
CQkJICAgICB5eWVycm9yKCJjb3B5IE1VU1QgYmUgZW5hYmxlZCB3aXRoIFwicmVxdWlyZVwiIik7
CisgIAkJCQkgICAgIFlZRVJST1I7CisgIAkJCQkgICB9IGVsc2UKKyAgCQkJCSAgIGlmICgkJC0+
Y29weSAhPSAwKSB7CisgIAkJCQkJeXllcnJvcigiZHVwbGljYXRlIDpjb3B5Iik7IFlZRVJST1I7
IH0KKyAgCQkJCSAgIGVsc2UgeyQkLT5jb3B5ID0gMTt9CisgICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgICAgIH0KKyAgCXwgcnRhZ3MgTElTVAkJIHsgJCQgPSAkMTsKKyAgCQkJCSAgIGlm
ICghcGFyc2Vfc2NyaXB0LT5zdXBwb3J0LmV4dGxpc3RzKSB7CisgIAkJCQkgICAgIHl5ZXJyb3Io
ImV4dGxpc3RzIE1VU1QgYmUgZW5hYmxlZCB3aXRoIFwicmVxdWlyZVwiIik7CisgIAkJCQkgICAg
IFlZRVJST1I7CisgIAkJCQkgICB9IGVsc2UKKyAgCQkJCSAgIGlmICgkJC0+ZXh0bGlzdHMgIT0g
MCkgeworICAJCQkJCXl5ZXJyb3IoImR1cGxpY2F0ZSA6bGlzdCIpOyBZWUVSUk9SOyB9CisgIAkJ
CQkgICBlbHNlIHskJC0+ZXh0bGlzdHMgPSAxO30KKyAgCQkJCSB9CisgCTsKKyAgCiAgCiAgbnRh
Z3M6IC8qIGVtcHR5ICovCQkgeyAkJCA9IG5ld19udGFncygpOyB9CiAgCXwgbnRhZ3MgSUQgU1RS
SU5HCSB7IGlmICgkJC0+aWQgIT0gTlVMTCkgeyAKKioqKioqKioqKioqKioqCioqKiA1NjQsNTY5
ICoqKioKLS0tIDYxMiw2MjQgLS0tLQogIAkJCXl5ZXJyb3IoImNvbXBhcmF0b3ItaTthc2NpaS1u
dW1lcmljIE1VU1QgYmUgZW5hYmxlZCB3aXRoIFwicmVxdWlyZVwiIik7CiAgCQkJWVlFUlJPUjsg
fQogIAkJCQkgICBlbHNlIHsgJCQtPmNvbXBhcmF0b3IgPSAkMzsgfSB9CisgIAl8IGFldGFncyBM
SVNUCQl7ICQkID0gJDE7CisgICAgICAgICAgICAgICAgIAkgICAgICAgICAgICAJICBpZiAoJCQt
PmV4dGxpc3RzICE9IDApIHsKKyAgCQkJeXllcnJvcigiZHVwbGljYXRlIDpsaXN0Iik7IFlZRVJS
T1I7IH0KKyAgCQkJCSAgZWxzZSBpZiAoIXBhcnNlX3NjcmlwdC0+c3VwcG9ydC5leHRsaXN0cykg
eworICAJCQkJICAgIHl5ZXJyb3IoImV4dGxpc3RzIE1VU1QgYmUgZW5hYmxlZCB3aXRoIFwicmVx
dWlyZVwiIik7CisgIAkJCQkgICAgWVlFUlJPUjsgfQorICAJCQkJICBlbHNlIHsgJCQtPmV4dGxp
c3RzID0gMTsgfSB9CiAgCTsKICAKICBodGFnczogLyogZW1wdHkgKi8JCSB7ICQkID0gbmV3X2h0
YWdzKCk7IH0KKioqKioqKioqKioqKioqCioqKiA1ODcsNTkyICoqKioKLS0tIDY0Miw2NTQgLS0t
LQogIAkJCSB5eWVycm9yKCJjb21wYXJhdG9yLWk7YXNjaWktbnVtZXJpYyBNVVNUIGJlIGVuYWJs
ZWQgd2l0aCBcInJlcXVpcmVcIiIpOyAgWVlFUlJPUjsgfQogIAkJCQkgICBlbHNlIHsgCiAgCQkJ
CSAgICAgJCQtPmNvbXBhcmF0b3IgPSAkMzsgfSB9CisgIAl8IGh0YWdzIExJU1QJCSAgeyAkJCA9
ICQxOworICAJCQkJICAgaWYgKCQkLT5leHRsaXN0cyAhPSAwKSB7CisgIAkJCXl5ZXJyb3IoImR1
cGxpY2F0ZSA6bGlzdCIpOyBZWUVSUk9SOyB9CisgIAkJCQkgICBlbHNlIGlmICghcGFyc2Vfc2Ny
aXB0LT5zdXBwb3J0LmV4dGxpc3RzKSB7CisgIAkJCXl5ZXJyb3IoImV4dGxpc3RzIE1VU1QgYmUg
ZW5hYmxlZCB3aXRoIFwicmVxdWlyZVwiIik7IFlZRVJST1I7IH0KKyAgCQkJCSAgIGVsc2UgeyAk
JC0+ZXh0bGlzdHMgPSAxOyB9IH0KKyAKICAgICAgICAgIDsKICAKICBidGFnczogLyogZW1wdHkg
Ki8JCSB7ICQkID0gbmV3X2J0YWdzKCk7IH0KKioqKioqKioqKioqKioqCioqKiA3NDksNzU0ICoq
KioKLS0tIDgxNiw4MjIgLS0tLQogIAlyZXQtPnUuYWUuc2wgPSBzbDsKICAJcmV0LT51LmFlLnBs
ID0gcGw7CiAgCXJldC0+dS5hZS5hZGRycGFydCA9IGFlLT5hZGRydGFnOworIAlyZXQtPnUuYWUu
ZXh0bGlzdHMgPSBhZS0+ZXh0bGlzdHM7CiAgCWZyZWVfYWV0YWdzKGFlKTsKICAKICAgICAgfQoq
KioqKioqKioqKioqKioKKioqIDc2OCw3NzMgKioqKgotLS0gODM2LDg0MiAtLS0tCiAgCXJldC0+
dS5oLmNvbXBhcmF0b3I9eHN0cmR1cChoLT5jb21wYXJhdG9yKTsKICAJcmV0LT51Lmguc2wgPSBz
bDsKICAJcmV0LT51LmgucGwgPSBwbDsKKyAJcmV0LT51LmguZXh0bGlzdHMgPSBoLT5leHRsaXN0
czsKICAJZnJlZV9odGFncyhoKTsKICAgICAgfQogICAgICByZXR1cm4gcmV0OwoqKioqKioqKioq
KioqKioKKioqIDg2Myw4ODcgKioqKgogICAgICByZXR1cm4gcmV0OwogIH0KICAKISBzdGF0aWMg
Y29tbWFuZGxpc3RfdCAqYnVpbGRfcmVkaXJlY3QoaW50IHQsIGludCBjb3B5LCBjaGFyICphZGRy
ZXNzKQogIHsKICAgICAgY29tbWFuZGxpc3RfdCAqcmV0ID0gbmV3X2NvbW1hbmQodCk7CiAgCiAg
ICAgIGFzc2VydCh0ID09IFJFRElSRUNUKTsKICAKICAgICAgaWYgKHJldCkgewohIAlyZXQtPnUu
ci5jb3B5ID0gY29weTsKICAJcmV0LT51LnIuYWRkcmVzcyA9IGFkZHJlc3M7CiAgICAgIH0KICAg
ICAgcmV0dXJuIHJldDsKICB9CiAgCiAgc3RhdGljIHN0cnVjdCBhZXRhZ3MgKm5ld19hZXRhZ3Mo
dm9pZCkKICB7CiAgICAgIHN0cnVjdCBhZXRhZ3MgKnIgPSAoc3RydWN0IGFldGFncyAqKSB4bWFs
bG9jKHNpemVvZihzdHJ1Y3QgYWV0YWdzKSk7CiAgCiAgICAgIHItPmFkZHJ0YWcgPSByLT5jb21w
dGFnID0gci0+cmVsYXRpb249LTE7CiAgICAgIHItPmNvbXBhcmF0b3I9TlVMTDsKICAKICAgICAg
cmV0dXJuIHI7CiAgfQotLS0gOTMyLDk3NiAtLS0tCiAgICAgIHJldHVybiByZXQ7CiAgfQogIAoh
IHN0YXRpYyBjb21tYW5kbGlzdF90ICpidWlsZF9yZWRpcmVjdChpbnQgdCwgc3RydWN0IHJ0YWdz
KiByLCBjaGFyICphZGRyZXNzKQogIHsKICAgICAgY29tbWFuZGxpc3RfdCAqcmV0ID0gbmV3X2Nv
bW1hbmQodCk7CiAgCiAgICAgIGFzc2VydCh0ID09IFJFRElSRUNUKTsKICAKICAgICAgaWYgKHJl
dCkgewohIAlyZXQtPnUuci5jb3B5ID0gci0+Y29weTsKISAgICAgICAgIHJldC0+dS5yLmV4dGxp
c3RzID0gci0+ZXh0bGlzdHM7CiAgCXJldC0+dS5yLmFkZHJlc3MgPSBhZGRyZXNzOworICAgICAg
ICAgZnJlZShyKTsKICAgICAgfQogICAgICByZXR1cm4gcmV0OwogIH0KICAKKyBzdGF0aWMgc3Ry
dWN0IHJ0YWdzICpuZXdfcnRhZ3Modm9pZCkKKyB7CisgICAgICBzdHJ1Y3QgcnRhZ3MgKnIgPSAo
c3RydWN0IHJ0YWdzICopIHhtYWxsb2Moc2l6ZW9mKHN0cnVjdCBydGFncykpOworICAKKyAgICAg
IHItPmV4dGxpc3RzID0gMDsKKyAgICAgIHItPmNvcHkgPSAwOworICAKKyAgICAgIHJldHVybiBy
OworIH0KKyAgCisgc3RhdGljIHZvaWQgZnJlZV9ydGFncyhzdHJ1Y3QgcnRhZ3MgKnIpCisgewor
ICAgICAgZnJlZShyKTsKKyB9CisgIAorIAorIAogIHN0YXRpYyBzdHJ1Y3QgYWV0YWdzICpuZXdf
YWV0YWdzKHZvaWQpCiAgewogICAgICBzdHJ1Y3QgYWV0YWdzICpyID0gKHN0cnVjdCBhZXRhZ3Mg
KikgeG1hbGxvYyhzaXplb2Yoc3RydWN0IGFldGFncykpOwogIAogICAgICByLT5hZGRydGFnID0g
ci0+Y29tcHRhZyA9IHItPnJlbGF0aW9uPS0xOwogICAgICByLT5jb21wYXJhdG9yPU5VTEw7Cisg
ICAgIHItPmV4dGxpc3RzID0gMDsKICAKICAgICAgcmV0dXJuIHI7CiAgfQoqKioqKioqKioqKioq
KioKKioqIDkwNyw5MTMgKioqKgogICAgICBzdHJ1Y3QgaHRhZ3MgKnIgPSAoc3RydWN0IGh0YWdz
ICopIHhtYWxsb2Moc2l6ZW9mKHN0cnVjdCBodGFncykpOwogIAogICAgICByLT5jb21wdGFnID0g
ci0+cmVsYXRpb249IC0xOwohICAgICAKICAgICAgci0+Y29tcGFyYXRvciA9IE5VTEw7CiAgCiAg
ICAgIHJldHVybiByOwotLS0gOTk2LDEwMDIgLS0tLQogICAgICBzdHJ1Y3QgaHRhZ3MgKnIgPSAo
c3RydWN0IGh0YWdzICopIHhtYWxsb2Moc2l6ZW9mKHN0cnVjdCBodGFncykpOwogIAogICAgICBy
LT5jb21wdGFnID0gci0+cmVsYXRpb249IC0xOwohICAgICByLT5leHRsaXN0cyA9IDA7ICAgIAog
ICAgICByLT5jb21wYXJhdG9yID0gTlVMTDsKICAKICAgICAgcmV0dXJuIHI7CmRpZmYgLXJjIGN5
cnVzLWltYXBkLTIuMy4xNC9zaWV2ZS90cmVlLmggY3lydXMtaW1hcGQtMi4zLjE0LXBhdGNoZWQv
c2lldmUvdHJlZS5jCioqKiBjeXJ1cy1pbWFwZC0yLjMuMTQvc2lldmUvdHJlZS5oCTIwMDgtMDMt
MjQgMjA6MDg6NDcuMDAwMDAwMDAwICswMDAwCi0tLSBjeXJ1cy1pbWFwZC0yLjMuMTQtcGF0Y2hl
ZC9zaWV2ZS90cmVlLmgJMjAwOS0wNi0wMiAxMjoyMjo0OS4wMDAwMDAwMDAgKzAwMDAKKioqKioq
KioqKioqKioqCioqKiA4Miw4NyAqKioqCi0tLSA4Miw4OCAtLS0tCiAgCSAgICBjaGFyICogY29t
cGFyYXRvcjsKICAJICAgIGludCByZWxhdGlvbjsKICAJICAgIHZvaWQgKmNvbXByb2NrOworIAkg
ICAgaW50IGV4dGxpc3RzOwogIAkgICAgc3RyaW5nbGlzdF90ICpzbDsKICAJICAgIHN0cmluZ2xp
c3RfdCAqcGw7CiAgCX0gaDsKKioqKioqKioqKioqKioqCioqKiA4OSw5NCAqKioqCi0tLSA5MCw5
NiAtLS0tCiAgCSAgICBpbnQgY29tcHRhZzsKICAJICAgIGNoYXIgKiBjb21wYXJhdG9yOwogIAkg
ICAgaW50IHJlbGF0aW9uOyAKKyAJICAgIGludCBleHRsaXN0czsKICAJICAgIHZvaWQgKmNvbXBy
b2NrOwogIAkgICAgc3RyaW5nbGlzdF90ICpzbDsKICAJICAgIHN0cmluZ2xpc3RfdCAqcGw7Cioq
KioqKioqKioqKioqKgoqKiogMTM5LDE0NCAqKioqCi0tLSAxNDEsMTQ3IC0tLS0KICAJc3RydWN0
IHsgLyogaXQncyBhIHJlZGlyZWN0IGFjdGlvbiAqLwogIAkgICAgY2hhciAqYWRkcmVzczsKICAJ
ICAgIGludCBjb3B5OworIAkgICAgaW50IGV4dGxpc3RzOwogIAl9IHI7CiAgCXN0cnVjdCB7IC8q
IGl0J3MgYSB2YWNhdGlvbiBhY3Rpb24gKi8KICAJICAgIGNoYXIgKnN1YmplY3Q7Cg==
</data>        

          </attachment>
      

    </bug>

</bugzilla>