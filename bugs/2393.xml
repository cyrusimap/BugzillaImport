<?xml version="1.0" standalone="yes" ?>
<!DOCTYPE bugzilla SYSTEM "https://bugzilla.cyrusimap.org/bugzilla.dtd">

<bugzilla version="3.2.5.1-2"
          urlbase="https://bugzilla.cyrusimap.org/"
          maintainer="Dave McMurtrie &lt;dave64@andrew.cmu.edu&gt;"
>

    <bug>
          <bug_id>2393</bug_id>
          
          <creation_ts>2004-03-01 14:18 EDT</creation_ts>
          <short_desc>runtime config for auth mech and pts module</short_desc>
          <delta_ts>2010-10-18 12:43:04 EDT</delta_ts>
          <reporter_accessible>1</reporter_accessible>
          <cclist_accessible>1</cclist_accessible>
          <classification_id>1</classification_id>
          <classification>Unclassified</classification>
          <product>Cyrus IMAP</product>
          <component>IMAP</component>
          <version>2.2.x</version>
          <rep_platform>All</rep_platform>
          <op_sys>All</op_sys>
          <bug_status>CLOSED</bug_status>
          <resolution>FIXED</resolution>
          
          
          
          
          <priority>P2</priority>
          <bug_severity>enhancement</bug_severity>
          <target_milestone>Future</target_milestone>
          
          
          
          <everconfirmed>1</everconfirmed>
          <reporter name="Igor Brezac">igor@ipass.net</reporter>
          <assigned_to name="Ken Murchison">murch@andrew.cmu.edu</assigned_to>
          
          <qa_contact name="The Cyrus Bugzilla List">cyrus-bugzilla@lists.andrew.cmu.edu</qa_contact>

      

      

      
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2004-03-01 14:18:57 EDT</bug_when>
            <thetext>The patch implements runtime options (auth_mech and pts_module
are new options in imapd.conf) for authorization mechs and pts modules.
The configure script is simplified a little because it does not check
for auth mech, pts modules and its dependencies. 
I tested the patch with unix and pts mechs and pts ldap module.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2004-03-01 14:19:25 EDT</bug_when>
            <thetext>Created an attachment (id=265)
auth.c
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2004-03-01 14:19:45 EDT</bug_when>
            <thetext>Created an attachment (id=266)
ptloader.h
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2004-03-01 14:20:32 EDT</bug_when>
            <thetext>Created an attachment (id=267)
auth.patch
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Derrick">shadow@andrew.cmu.edu</who>
            <bug_when>2005-02-15 23:19:59 EDT</bug_when>
            <thetext>Can you send a current version of this?</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2005-02-16 10:02:43 EDT</bug_when>
            <thetext>Created an attachment (id=330)
patch
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2005-02-16 10:03:34 EDT</bug_when>
            <thetext>Created an attachment (id=331)
lib/auth.c - new file
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2005-02-16 10:04:16 EDT</bug_when>
            <thetext>Created an attachment (id=332)
ptclient/ptloader.h- new file
</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Igor Brezac">igor@ipass.net</who>
            <bug_when>2005-02-16 10:07:35 EDT</bug_when>
            <thetext>There are quite a few changes in the configure.in script.  Please double check
things.  The script works for me on Solaris 9, but it should work on other OSs.</thetext>
          </long_desc>
          <long_desc isprivate="0">
            <who name="Derrick">shadow@andrew.cmu.edu</who>
            <bug_when>2005-02-16 15:42:54 EDT</bug_when>
            <thetext>Committed. Going to push it and see what problems fall out, but it looks fine.</thetext>
          </long_desc>
      
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>265</attachid>
            <date>2004-03-01 14:19 EDT</date>
            <desc>auth.c</desc>
            <filename>auth.c</filename>
            <type>text/plain</type>
            <size>3303</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogCiAqIENvcHlyaWdodCAoYykgMTk5OC0yMDAzIENhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5
LiAgQWxsIHJpZ2h0cyByZXNlcnZlZC4KICoKICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBz
b3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0CiAqIG1vZGlmaWNhdGlvbiwg
YXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucwogKiBh
cmUgbWV0OgogKgogKiAxLiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRh
aW4gdGhlIGFib3ZlIGNvcHlyaWdodAogKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRp
b25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuIAogKgogKiAyLiBSZWRpc3RyaWJ1dGlv
bnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAogKiAg
ICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2Ns
YWltZXIgaW4KICogICAgdGhlIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBw
cm92aWRlZCB3aXRoIHRoZQogKiAgICBkaXN0cmlidXRpb24uCiAqCiAqIDMuIFRoZSBuYW1lICJD
YXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eSIgbXVzdCBub3QgYmUgdXNlZCB0bwogKiAgICBlbmRv
cnNlIG9yIHByb21vdGUgcHJvZHVjdHMgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91
dAogKiAgICBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uIEZvciBwZXJtaXNzaW9uIG9yIGFueSBv
dGhlciBsZWdhbAogKiAgICBkZXRhaWxzLCBwbGVhc2UgY29udGFjdCAgCiAqICAgICAgT2ZmaWNl
IG9mIFRlY2hub2xvZ3kgVHJhbnNmZXIKICogICAgICBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0
eQogKiAgICAgIDUwMDAgRm9yYmVzIEF2ZW51ZQogKiAgICAgIFBpdHRzYnVyZ2gsIFBBICAxNTIx
My0zODkwCiAqICAgICAgKDQxMikgMjY4LTQzODcsIGZheDogKDQxMikgMjY4LTczOTUKICogICAg
ICB0ZWNoLXRyYW5zZmVyQGFuZHJldy5jbXUuZWR1CiAqCiAqIDQuIFJlZGlzdHJpYnV0aW9ucyBv
ZiBhbnkgZm9ybSB3aGF0c29ldmVyIG11c3QgcmV0YWluIHRoZSBmb2xsb3dpbmcKICogICAgYWNr
bm93bGVkZ21lbnQ6CiAqICAgICJUaGlzIHByb2R1Y3QgaW5jbHVkZXMgc29mdHdhcmUgZGV2ZWxv
cGVkIGJ5IENvbXB1dGluZyBTZXJ2aWNlcwogKiAgICAgYXQgQ2FybmVnaWUgTWVsbG9uIFVuaXZl
cnNpdHkgKGh0dHA6Ly93d3cuY211LmVkdS9jb21wdXRpbmcvKS4iCiAqCiAqIENBUk5FR0lFIE1F
TExPTiBVTklWRVJTSVRZIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIIFJFR0FSRCBUTwog
KiBUSElTIFNPRlRXQVJFLCBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJD
SEFOVEFCSUxJVFkKICogQU5EIEZJVE5FU1MsIElOIE5PIEVWRU5UIFNIQUxMIENBUk5FR0lFIE1F
TExPTiBVTklWRVJTSVRZIEJFIExJQUJMRQogKiBGT1IgQU5ZIFNQRUNJQUwsIElORElSRUNUIE9S
IENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUwogKiBXSEFUU09FVkVSIFJFU1VM
VElORyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4KICogQU4g
QUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SIE9USEVSIFRPUlRJT1VTIEFDVElPTiwg
QVJJU0lORwogKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1IgUEVSRk9S
TUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KICovCgovKiAkSWQkICovCgojaW5jbHVkZSA8Y29uZmln
Lmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN0cmluZy5oPgoKI2luY2x1ZGUgImF1
dGguaCIKI2luY2x1ZGUgImV4aXRjb2Rlcy5oIgojaW5jbHVkZSAibGliY3lyX2NmZy5oIgojaW5j
bHVkZSAieG1hbGxvYy5oIgoKc3RydWN0IGF1dGhfbWVjaCAqYXV0aF9tZWNoc1tdID0gewogICAg
JmF1dGhfdW5peCwKICAgICZhdXRoX3B0cywKI2lmZGVmIEhBVkVfS1JCCiAgICAmYXV0aF9rcmIs
CiNlbmRpZgojaWZkZWYgSEFWRV9HU1NBUElfSAogICAgJmF1dGhfa3JiNSwKI2VuZGlmCiAgICBO
VUxMIH07CgpzdGF0aWMgc3RydWN0IGF1dGhfbWVjaCAqYXV0aF9mcm9tbmFtZSgpCnsKICAgIGlu
dCBpOwogICAgY29uc3QgY2hhciAqbmFtZSA9IGxpYmN5cnVzX2NvbmZpZ19nZXRzdHJpbmcoQ1lS
VVNPUFRfQVVUSF9NRUNIKTsKICAgIHN0YXRpYyBzdHJ1Y3QgYXV0aF9tZWNoICphdXRoID0gTlVM
TDsKCiAgICBpZiAoYXV0aCkKICAgICAgICByZXR1cm4gYXV0aDsKCiAgICBmb3IgKGkgPSAwOyBh
dXRoX21lY2hzW2ldOyBpKyspIHsKCWlmICghc3RyY21wKGF1dGhfbWVjaHNbaV0tPm5hbWUsIG5h
bWUpKSB7CgkgICAgYXV0aCA9IGF1dGhfbWVjaHNbaV07IGJyZWFrOwoJfQogICAgfQogICAgaWYg
KCFhdXRoKSB7CgljaGFyIGVycmJ1ZlsxMDI0XTsKCXNucHJpbnRmKGVycmJ1Ziwgc2l6ZW9mKGVy
cmJ1ZiksCgkJICJBdXRob3JpemF0aW9uIG1lY2hhbmlzbSAlcyBub3Qgc3VwcG9ydGVkIiwgbmFt
ZSk7CglmYXRhbChlcnJidWYsIEVDX0NPTkZJRyk7CiAgICB9CgogICAgcmV0dXJuIGF1dGg7Cn0K
CmludCBhdXRoX21lbWJlcm9mKGF1dGhfc3RhdGUsIGlkZW50aWZpZXIpCnN0cnVjdCBhdXRoX3N0
YXRlICphdXRoX3N0YXRlOwpjb25zdCBjaGFyICppZGVudGlmaWVyOwp7CiAgICBzdHJ1Y3QgYXV0
aF9tZWNoICphdXRoID0gYXV0aF9mcm9tbmFtZSgpOwoKICAgIHJldHVybiBhdXRoLT5tZW1iZXJv
ZihhdXRoX3N0YXRlLCBpZGVudGlmaWVyKTsKfQoKY2hhciAqYXV0aF9jYW5vbmlmeWlkKGlkZW50
aWZpZXIsIGxlbikKY29uc3QgY2hhciAqaWRlbnRpZmllcjsKc2l6ZV90IGxlbjsKewogICAgc3Ry
dWN0IGF1dGhfbWVjaCAqYXV0aCA9IGF1dGhfZnJvbW5hbWUoKTsKCiAgICByZXR1cm4gYXV0aC0+
Y2Fub25pZnlpZChpZGVudGlmaWVyLCBsZW4pOwp9CgpzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9u
ZXdzdGF0ZShpZGVudGlmaWVyKQpjb25zdCBjaGFyICppZGVudGlmaWVyOwp7CiAgICBzdHJ1Y3Qg
YXV0aF9tZWNoICphdXRoID0gYXV0aF9mcm9tbmFtZSgpOwoKICAgIHJldHVybiBhdXRoLT5uZXdz
dGF0ZShpZGVudGlmaWVyKTsKfQoKdm9pZCBhdXRoX2ZyZWVzdGF0ZShhdXRoX3N0YXRlKQpzdHJ1
Y3QgYXV0aF9zdGF0ZSAqYXV0aF9zdGF0ZTsKewogICAgc3RydWN0IGF1dGhfbWVjaCAqYXV0aCA9
IGF1dGhfZnJvbW5hbWUoKTsKCiAgICBhdXRoLT5mcmVlc3RhdGUoYXV0aF9zdGF0ZSk7Cn0K
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="0"
              isprivate="0"
          >
            <attachid>266</attachid>
            <date>2004-03-01 14:19 EDT</date>
            <desc>ptloader.h</desc>
            <filename>ptloader.h</filename>
            <type>text/plain</type>
            <size>2554</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogcHRsb2FkZXIuaCAtLSBTaXRlIGF1dGhvcml6YXRpb24gbW9kdWxlCiAqICRJZCQKICoKICog
Q29weXJpZ2h0IChjKSAxOTk4LTIwMDMgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkuICBBbGwg
cmlnaHRzIHJlc2VydmVkLgogKgogKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBh
bmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQKICogbW9kaWZpY2F0aW9uLCBhcmUgcGVy
bWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zCiAqIGFyZSBtZXQ6
CiAqCiAqIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUg
YWJvdmUgY29weXJpZ2h0CiAqICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5k
IHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4gCiAqCiAqIDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBi
aW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0CiAqICAgIG5vdGlj
ZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBp
bgogKiAgICB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVk
IHdpdGggdGhlCiAqICAgIGRpc3RyaWJ1dGlvbi4KICoKICogMy4gVGhlIG5hbWUgIkNhcm5lZ2ll
IE1lbGxvbiBVbml2ZXJzaXR5IiBtdXN0IG5vdCBiZSB1c2VkIHRvCiAqICAgIGVuZG9yc2Ugb3Ig
cHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0CiAqICAg
IHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi4gRm9yIHBlcm1pc3Npb24gb3IgYW55IG90aGVyIGxl
Z2FsCiAqICAgIGRldGFpbHMsIHBsZWFzZSBjb250YWN0ICAKICogICAgICBPZmZpY2Ugb2YgVGVj
aG5vbG9neSBUcmFuc2ZlcgogKiAgICAgIENhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5CiAqICAg
ICAgNTAwMCBGb3JiZXMgQXZlbnVlCiAqICAgICAgUGl0dHNidXJnaCwgUEEgIDE1MjEzLTM4OTAK
ICogICAgICAoNDEyKSAyNjgtNDM4NywgZmF4OiAoNDEyKSAyNjgtNzM5NQogKiAgICAgIHRlY2gt
dHJhbnNmZXJAYW5kcmV3LmNtdS5lZHUKICoKICogNC4gUmVkaXN0cmlidXRpb25zIG9mIGFueSBm
b3JtIHdoYXRzb2V2ZXIgbXVzdCByZXRhaW4gdGhlIGZvbGxvd2luZwogKiAgICBhY2tub3dsZWRn
bWVudDoKICogICAgIlRoaXMgcHJvZHVjdCBpbmNsdWRlcyBzb2Z0d2FyZSBkZXZlbG9wZWQgYnkg
Q29tcHV0aW5nIFNlcnZpY2VzCiAqICAgICBhdCBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eSAo
aHR0cDovL3d3dy5jbXUuZWR1L2NvbXB1dGluZy8pLiIKICoKICogQ0FSTkVHSUUgTUVMTE9OIFVO
SVZFUlNJVFkgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEggUkVHQVJEIFRPCiAqIFRISVMg
U09GVFdBUkUsIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJ
TElUWQogKiBBTkQgRklUTkVTUywgSU4gTk8gRVZFTlQgU0hBTEwgQ0FSTkVHSUUgTUVMTE9OIFVO
SVZFUlNJVFkgQkUgTElBQkxFCiAqIEZPUiBBTlkgU1BFQ0lBTCwgSU5ESVJFQ1QgT1IgQ09OU0VR
VUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTCiAqIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZS
T00gTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTgogKiBBTiBBQ1RJT04g
T0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1IgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5H
CiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUiBQRVJGT1JNQU5DRSBP
RiBUSElTIFNPRlRXQVJFLgogKgogKi8KCiNpZm5kZWYgSU5DTFVERURfUFRMT0FERVJfSAojZGVm
aW5lIElOQ0xVREVEX1BUTE9BREVSX0gKCnN0cnVjdCBhdXRoX3N0YXRlOwoKc3RydWN0IHB0c19t
b2R1bGUgewogICAgY29uc3QgY2hhciAqbmFtZTsKCiAgICB2b2lkICgqaW5pdCkodm9pZCk7CiAg
ICBzdHJ1Y3QgYXV0aF9zdGF0ZSAqKCptYWtlX2F1dGhzdGF0ZSkoY29uc3QgY2hhciAqaWRlbnRp
ZmllciwKICAgICAgICAgICAgICAgIHNpemVfdCBzaXplLAogICAgICAgICAgICAgICAgY29uc3Qg
Y2hhciAqKnJlcGx5LCBpbnQgKmRzaXplKTsKfTsKCmV4dGVybiBzdHJ1Y3QgcHRzX21vZHVsZSAq
cHRzX21vZHVsZXNbXTsKCi8qIE5vdGUgdGhhdCBzb21lIG9mIHRoZXNlIG1heSBiZSB1bmRlZmlu
ZWQgc3ltYm9scwogKiBpZiBsaWJjeXJ1cyB3YXMgbm90IGJ1aWx0IHdpdGggc3VwcG9ydCBmb3Ig
dGhlbSAqLwpleHRlcm4gc3RydWN0IHB0c19tb2R1bGUgcHRzX2xkYXA7CmV4dGVybiBzdHJ1Y3Qg
cHRzX21vZHVsZSBwdHNfYWZza3JiOwoKc3RydWN0IGF1dGhfc3RhdGUgKnB0c21vZHVsZV9tYWtl
X2F1dGhzdGF0ZShjb25zdCBjaGFyICppZGVudGlmaWVyLAoJCQkJCSAgICBzaXplX3Qgc2l6ZSwK
CQkJCQkgICAgY29uc3QgY2hhciAqKnJlcGx5LCBpbnQgKmRzaXplKTsKdm9pZCBwdHNtb2R1bGVf
aW5pdCh2b2lkKTsKCiNlbmRpZiAvKiBJTkNMVURFRF9QVExPQURFUl9IICovCg==
</data>        

          </attachment>
          <attachment
              isobsolete="1"
              ispatch="1"
              isprivate="0"
          >
            <attachid>267</attachid>
            <date>2004-03-01 14:20 EDT</date>
            <desc>auth.patch</desc>
            <filename>auth.patch</filename>
            <type>text/plain</type>
            <size>36949</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">SW5kZXg6IGltYXAvY3RsX2N5cnVzZGIuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9j
eXJ1cy9pbWFwL2N0bF9jeXJ1c2RiLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjIKZGlmZiAt
dSAtcjEuMjIgY3RsX2N5cnVzZGIuYwotLS0gaW1hcC9jdGxfY3lydXNkYi5jCTI2IEphbiAyMDA0
IDE3OjQ2OjU0IC0wMDAwCTEuMjIKKysrIGltYXAvY3RsX2N5cnVzZGIuYwkyOCBGZWIgMjAwNCAw
NDo0MToyNCAtMDAwMApAQCAtMTAwLDkgKzEwMCw3IEBACiAgICAgeyBGTkFNRV9BTk5PVEFUSU9O
UywJJmNvbmZpZ19hbm5vdGF0aW9uX2RiLAkxIH0sCiAgICAgeyBGTkFNRV9ERUxJVkVSREIsCQkm
Y29uZmlnX2R1cGxpY2F0ZV9kYiwJMCB9LAogICAgIHsgRk5BTUVfVExTU0VTU0lPTlMsCSZjb25m
aWdfdGxzY2FjaGVfZGIsCTAgfSwKLSNpZmRlZiBXSVRIX1BUUwogICAgIHsgRk5BTUVfUFRTREIs
ICAgICAgICAgICAgICAmY29uZmlnX3B0c2NhY2hlX2RiLCAgICAwIH0sCi0jZW5kaWYKICAgICB7
IE5VTEwsCQkJTlVMTCwJCQkwIH0KIH07CiAKSW5kZXg6IGltYXAvZ2xvYmFsLmMKPT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PQpSQ1MgZmlsZTogL2N2cy9zcmMvY3lydXMvaW1hcC9nbG9iYWwuYyx2CnJldHJpZXZpbmcgcmV2
aXNpb24gMS4xMQpkaWZmIC11IC1yMS4xMSBnbG9iYWwuYwotLS0gaW1hcC9nbG9iYWwuYwkyNiBG
ZWIgMjAwNCAxODowMzowNiAtMDAwMAkxLjExCisrKyBpbWFwL2dsb2JhbC5jCTI4IEZlYiAyMDA0
IDA0OjQxOjI0IC0wMDAwCkBAIC05MCw5ICs5MCw3IEBACiBzdHJ1Y3QgY3lydXNkYl9iYWNrZW5k
ICpjb25maWdfc2VlbnN0YXRlX2RiOwogc3RydWN0IGN5cnVzZGJfYmFja2VuZCAqY29uZmlnX2R1
cGxpY2F0ZV9kYjsKIHN0cnVjdCBjeXJ1c2RiX2JhY2tlbmQgKmNvbmZpZ190bHNjYWNoZV9kYjsK
LSNpZmRlZiBXSVRIX1BUUwogc3RydWN0IGN5cnVzZGJfYmFja2VuZCAqY29uZmlnX3B0c2NhY2hl
X2RiOwotI2VuZGlmCiAKIC8qIENhbGxlZCBiZWZvcmUgYSBjeXJ1cyBhcHBsaWNhdGlvbiBzdGFy
dHMgKGJ1dCBhZnRlciBjb21tYW5kIGxpbmUgcGFyYW1ldGVycwogICogYXJlIHJlYWQpICovCkBA
IC0xODAsMTAgKzE3OCw4IEBACiAJICAgIGN5cnVzZGJfZnJvbW5hbWUoY29uZmlnX2dldHN0cmlu
ZyhJTUFQT1BUX0RVUExJQ0FURV9EQikpOwogCWNvbmZpZ190bHNjYWNoZV9kYiA9CiAJICAgIGN5
cnVzZGJfZnJvbW5hbWUoY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1RMU0NBQ0hFX0RCKSk7Ci0j
aWZkZWYgV0lUSF9QVFMKIAljb25maWdfcHRzY2FjaGVfZGIgPQogCSAgICBjeXJ1c2RiX2Zyb21u
YW1lKGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9QVFNDQUNIRV9EQikpOwotI2VuZGlmCiAKIAkv
KiBjb25maWd1cmUgbGliY3lydXMgYXMgbmVlZGVkICovCiAJbGliY3lydXNfY29uZmlnX3NldHN0
cmluZyhDWVJVU09QVF9DT05GSUdfRElSLCBjb25maWdfZGlyKTsKQEAgLTIwNyw2ICsyMDMsOCBA
QAogCQkJCSAgY29uZmlnX2dldGVudW0oSU1BUE9QVF9WSVJURE9NQUlOUykpOwogCWxpYmN5cnVz
X2NvbmZpZ19zZXRpbnQoQ1lSVVNPUFRfQkVSS0VMRVlfQ0FDSEVTSVpFLAogCQkJICAgICAgIGNv
bmZpZ19nZXRpbnQoSU1BUE9QVF9CRVJLRUxFWV9DQUNIRVNJWkUpKTsKKwlsaWJjeXJ1c19jb25m
aWdfc2V0c3RyaW5nKENZUlVTT1BUX0FVVEhfTUVDSCwKKwkJCQkgIGNvbmZpZ19nZXRzdHJpbmco
SU1BUE9QVF9BVVRIX01FQ0gpKTsKIAogCS8qIE5vdCB1bnRpbCBhbGwgY29uZmlndXJhdGlvbiBw
YXJhbWV0ZXJzIGFyZSBzZXQhICovCiAJbGliY3lydXNfaW5pdCgpOwpJbmRleDogaW1hcC9nbG9i
YWwuaAo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9jeXJ1cy9pbWFwL2dsb2JhbC5oLHYK
cmV0cmlldmluZyByZXZpc2lvbiAxLjUKZGlmZiAtdSAtcjEuNSBnbG9iYWwuaAotLS0gaW1hcC9n
bG9iYWwuaAkyNiBKYW4gMjAwNCAxNzo0Njo1NiAtMDAwMAkxLjUKKysrIGltYXAvZ2xvYmFsLmgJ
MjggRmViIDIwMDQgMDQ6NDE6MjQgLTAwMDAKQEAgLTE1Niw4ICsxNTYsNiBAQAogZXh0ZXJuIHN0
cnVjdCBjeXJ1c2RiX2JhY2tlbmQgKmNvbmZpZ19zZWVuc3RhdGVfZGI7CiBleHRlcm4gc3RydWN0
IGN5cnVzZGJfYmFja2VuZCAqY29uZmlnX2R1cGxpY2F0ZV9kYjsKIGV4dGVybiBzdHJ1Y3QgY3ly
dXNkYl9iYWNrZW5kICpjb25maWdfdGxzY2FjaGVfZGI7Ci0jaWZkZWYgV0lUSF9QVFMKIGV4dGVy
biBzdHJ1Y3QgY3lydXNkYl9iYWNrZW5kICpjb25maWdfcHRzY2FjaGVfZGI7Ci0jZW5kaWYKIAog
I2VuZGlmIC8qIElOQ0xVREVEX0dMT0JBTF9IICovCkluZGV4OiBpbWFwL3ZlcnNpb24uYwo9PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9jeXJ1cy9pbWFwL3ZlcnNpb24uYyx2CnJldHJpZXZp
bmcgcmV2aXNpb24gMS4xNwpkaWZmIC11IC1yMS4xNyB2ZXJzaW9uLmMKLS0tIGltYXAvdmVyc2lv
bi5jCTMgSmFuIDIwMDQgMjA6MTI6MzIgLTAwMDAJMS4xNworKysgaW1hcC92ZXJzaW9uLmMJMjgg
RmViIDIwMDQgMDQ6NDE6MjQgLTAwMDAKQEAgLTE2Myw4ICsxNjMsNiBAQAogCSAgICAgIjsgbG9j
ayA9ICVzIiwgbG9ja19tZXRob2RfZGVzYyk7CiAgICAgc25wcmludGYoZW52X2J1ZiArIHN0cmxl
bihlbnZfYnVmKSwgTUFYSURWQUxVRUxFTiAtIHN0cmxlbihlbnZfYnVmKSwKIAkgICAgICI7IG5v
bmJsb2NrID0gJXMiLCBub25ibG9ja19tZXRob2RfZGVzYyk7Ci0gICAgc25wcmludGYoZW52X2J1
ZiArIHN0cmxlbihlbnZfYnVmKSwgTUFYSURWQUxVRUxFTiAtIHN0cmxlbihlbnZfYnVmKSwKLQkg
ICAgICI7IGF1dGggPSAlcyIsIGF1dGhfbWV0aG9kX2Rlc2MpOwogI2lmZGVmIEhBVkVfS1JCCiAg
ICAgc25wcmludGYoZW52X2J1ZiArIHN0cmxlbihlbnZfYnVmKSwgTUFYSURWQUxVRUxFTiAtIHN0
cmxlbihlbnZfYnVmKSwKIAkgICAgICIgKCVzKSIsIGtyYjRfdmVyc2lvbik7CkluZGV4OiBsaWIv
TWFrZWZpbGUuaW4KPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvY3lydXMvbGliL01ha2Vm
aWxlLmluLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjU4CmRpZmYgLXUgLXIxLjU4IE1ha2VmaWxl
LmluCi0tLSBsaWIvTWFrZWZpbGUuaW4JMTggRmViIDIwMDQgMTg6NDQ6MjIgLTAwMDAJMS41OAor
KysgbGliL01ha2VmaWxlLmluCTI4IEZlYiAyMDA0IDA0OjQxOjI0IC0wMDAwCkBAIC00Myw3ICs0
Myw3IEBACiAjICRJZDogTWFrZWZpbGUuaW4sdiAxLjU4IDIwMDQvMDIvMTggMTg6NDQ6MjIgcmpz
MyBFeHAgJAogCiAjIEF1dGhvcml6YXRpb24gbmFtZXNwYWNlLgotQVVUSD1hdXRoX0BXSVRIX0FV
VEhALm8KK0FVVEg9YXV0aC5vIGF1dGhfa3JiLm8gYXV0aF91bml4Lm8gYXV0aF9rcmI1Lm8gYXV0
aF9wdHMubwogCiAjIEFDTCBpbnRlcnByZXRhdGlvbi4gIE9ubHkgb25lIGNob2ljZSBmb3Igbm93
OgogQUNMPWFjbF9hZnMubwpJbmRleDogbGliL2F1dGguaAo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAv
Y3ZzL3NyYy9jeXJ1cy9saWIvYXV0aC5oLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjE1CmRpZmYg
LXUgLXIxLjE1IGF1dGguaAotLS0gbGliL2F1dGguaAkyMiBPY3QgMjAwMyAxODo1MDoxMiAtMDAw
MAkxLjE1CisrKyBsaWIvYXV0aC5oCTI4IEZlYiAyMDA0IDA0OjQxOjI0IC0wMDAwCkBAIC00NCwy
MCArNDQsMzcgQEAKICNpZm5kZWYgSU5DTFVERURfQVVUSF9ICiAjZGVmaW5lIElOQ0xVREVEX0FV
VEhfSAogCi1leHRlcm4gY29uc3QgY2hhciAqYXV0aF9tZXRob2RfZGVzYzsKLQogc3RydWN0IGF1
dGhfc3RhdGU7CiAKK3N0cnVjdCBhdXRoX21lY2ggeworICAgIGNvbnN0IGNoYXIgKm5hbWU7CisK
KyAgICBjaGFyICooKmNhbm9uaWZ5aWQpKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIsIHNpemVfdCBs
ZW4pOworICAgIGludCAoKm1lbWJlcm9mKShzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9zdGF0ZSwg
CisgICAgICAgICAgICAgY29uc3QgY2hhciAqaWRlbnRpZmllcik7CisgICAgc3RydWN0IGF1dGhf
c3RhdGUgKigqbmV3c3RhdGUpKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIpOworICAgIHZvaWQgKCpm
cmVlc3RhdGUpKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0YXRlKTsKK307CisKK2V4dGVybiBz
dHJ1Y3QgYXV0aF9tZWNoICphdXRoX21lY2hzW107CisKKy8qIE5vdGUgdGhhdCBzb21lIG9mIHRo
ZXNlIG1heSBiZSB1bmRlZmluZWQgc3ltYm9scworICogaWYgbGliY3lydXMgd2FzIG5vdCBidWls
dCB3aXRoIHN1cHBvcnQgZm9yIHRoZW0gKi8KK2V4dGVybiBzdHJ1Y3QgYXV0aF9tZWNoIGF1dGhf
dW5peDsKK2V4dGVybiBzdHJ1Y3QgYXV0aF9tZWNoIGF1dGhfcHRzOworZXh0ZXJuIHN0cnVjdCBh
dXRoX21lY2ggYXV0aF9rcmI7CitleHRlcm4gc3RydWN0IGF1dGhfbWVjaCBhdXRoX2tyYjU7CisK
IC8qIGF1dGhfY2Fub25pZnlpZDogY2Fub25pZnkgdGhlIGdpdmVuIGlkZW50aWZpZXIgYW5kIHJl
dHVybiBhIHBvaW50ZXIKICAqICAgICAgICAgICAgICAgICAgdG8gYSBzdGF0aWMgYnVmZmVyIHdp
dGggdGhlIGNhbm9uaWZpZWQgSUQsIG9yIE5VTEwgb24KICAqICAgICAgICAgICAgICAgICAgZmFp
bHVyZSAqLwogLyogaWRlbnRpZmllcjogaWQgdG8gY2Fub25pZnkgKi8KIC8qIGxlbjogbGVuZ3Ro
IG9mIGlkLCBvciAwIHRvIGRvIHN0cmxlbihpZGVudGlmaWVyKSAqLwotZXh0ZXJuIGNoYXIgKmF1
dGhfY2Fub25pZnlpZChjb25zdCBjaGFyICppZGVudGlmaWVyLCBzaXplX3QgbGVuKTsKK2NoYXIg
KmF1dGhfY2Fub25pZnlpZChjb25zdCBjaGFyICppZGVudGlmaWVyLCBzaXplX3QgbGVuKTsKIAot
ZXh0ZXJuIGludCBhdXRoX21lbWJlcm9mKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0YXRlLCAK
LQkJCSBjb25zdCBjaGFyICppZGVudGlmaWVyKTsKLWV4dGVybiBzdHJ1Y3QgYXV0aF9zdGF0ZSAq
YXV0aF9uZXdzdGF0ZShjb25zdCBjaGFyICppZGVudGlmaWVyKTsKLWV4dGVybiB2b2lkIGF1dGhf
ZnJlZXN0YXRlKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0YXRlKTsKK2ludCBhdXRoX21lbWJl
cm9mKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0YXRlLCAKKyAJIGNvbnN0IGNoYXIgKmlkZW50
aWZpZXIpOworc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhfbmV3c3RhdGUoY29uc3QgY2hhciAqaWRl
bnRpZmllcik7Cit2b2lkIGF1dGhfZnJlZXN0YXRlKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0
YXRlKTsKIAogI2VuZGlmIC8qIElOQ0xVREVEX0FVVEhfSCAqLwpJbmRleDogbGliL2F1dGhfa3Ji
LmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvY3lydXMvbGliL2F1dGhfa3JiLmMsdgpy
ZXRyaWV2aW5nIHJldmlzaW9uIDEuNDAKZGlmZiAtdSAtcjEuNDAgYXV0aF9rcmIuYwotLS0gbGli
L2F1dGhfa3JiLmMJMTEgTm92IDIwMDMgMDM6MjY6MDAgLTAwMDAJMS40MAorKysgbGliL2F1dGhf
a3JiLmMJMjggRmViIDIwMDQgMDQ6NDE6MjQgLTAwMDAKQEAgLTQyLDYgKzQyLDEyIEBACiAKICNp
bmNsdWRlIDxjb25maWcuaD4KICNpbmNsdWRlIDxzdGRsaWIuaD4KKworI2luY2x1ZGUgImF1dGgu
aCIKKyNpbmNsdWRlICJleGl0Y29kZXMuaCIKKworI2lmZGVmIEhBVkVfS1JCCisKICNpbmNsdWRl
IDxsaW1pdHMuaD4KICNpbmNsdWRlIDxzdGRpby5oPgogI2luY2x1ZGUgPGN0eXBlLmg+CkBAIC02
MSw5ICs2Nyw2IEBACiAjaW5jbHVkZSA8a3JiLmg+CiAKICNpbmNsdWRlICJ4bWFsbG9jLmgiCi0j
aW5jbHVkZSAiYXV0aC5oIgotCi1jb25zdCBjaGFyICphdXRoX21ldGhvZF9kZXNjID0gImtyYiI7
CiAKICNpZm5kZWYgS1JCX01BUE5BTUUKICNkZWZpbmUgS1JCX01BUE5BTUUgKFNZU0NPTkZESVIg
Ii9rcmIuZXF1aXYiKQpAQCAtOTUsOCArOTgsNyBAQAogICoJMglVc2VyIGlzIGluIHRoZSBncm91
cCB0aGF0IGlzIGlkZW50aWZpZXIKICAqCTMJVXNlciBpcyBpZGVudGlmZXIKICAqLwotaW50Ci1h
dXRoX21lbWJlcm9mKGF1dGhfc3RhdGUsIGlkZW50aWZpZXIpCitzdGF0aWMgaW50IG15bWVtYmVy
b2YoYXV0aF9zdGF0ZSwgaWRlbnRpZmllcikKIHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0YXRl
OwogY29uc3QgY2hhciAqaWRlbnRpZmllcjsKIHsKQEAgLTE3Miw3ICsxNzQsNyBAQAogICogYSBO
VUxMIHBvaW50ZXIgaXMgcmV0dXJuZWQuCiAgKiBFdmVudHVhbGx5LCB0aGlzIG1heSBiZSBtb3Jl
IHNvcGhpc3RpY2F0ZWQgdGhhbiBhIHNpbXBsZSBmaWxlIHNjYW4uCiAgKi8KLWNoYXIgKmF1dGhf
bWFwX2tyYmlkKHJlYWxfYW5hbWUsIHJlYWxfaW5zdCwgcmVhbF9yZWFsbSkKK3N0YXRpYyBjaGFy
ICphdXRoX21hcF9rcmJpZChyZWFsX2FuYW1lLCByZWFsX2luc3QsIHJlYWxfcmVhbG0pCiBjb25z
dCBjaGFyICpyZWFsX2FuYW1lOwogY29uc3QgY2hhciAqcmVhbF9pbnN0OwogY29uc3QgY2hhciAq
cmVhbF9yZWFsbTsKQEAgLTI0Nyw3ICsyNDksNyBAQAogICogUmV0dXJucyBhIHBvaW50ZXIgdG8g
YSBzdGF0aWMgYnVmZmVyIGNvbnRhaW5pbmcgdGhlIGNhbm9uaWNhbCBmb3JtCiAgKiBvciBOVUxM
IGlmICdpZGVudGlmaWVyJyBpcyBpbnZhbGlkLgogICovCi1jaGFyICphdXRoX2Nhbm9uaWZ5aWQo
aWRlbnRpZmllciwgbGVuKQorc3RhdGljIGNoYXIgKm15Y2Fub25pZnlpZChpZGVudGlmaWVyLCBs
ZW4pCiBjb25zdCBjaGFyICppZGVudGlmaWVyOwogc2l6ZV90IGxlbjsKIHsKQEAgLTMxNCw4ICsz
MTYsOCBAQAogICogcG9pbnRzIHRvIGEgMTYtYnl0ZSBiaW5hcnkga2V5IHRvIGNhY2hlIGlkZW50
aWZpZXIncyBpbmZvcm1hdGlvbgogICogd2l0aC4KICAqLwotc3RydWN0IGF1dGhfc3RhdGUgKgot
YXV0aF9uZXdzdGF0ZShjb25zdCBjaGFyICppZGVudGlmaWVyKQorc3RhdGljIHN0cnVjdCBhdXRo
X3N0YXRlICpteW5ld3N0YXRlKGlkZW50aWZpZXIpCitjb25zdCBjaGFyICppZGVudGlmaWVyOwog
ewogICAgIHN0cnVjdCBhdXRoX3N0YXRlICpuZXdzdGF0ZTsKIApAQCAtMzMxLDEwICszMzMsNDgg
QEAKICAgICByZXR1cm4gbmV3c3RhdGU7CiB9CiAKLXZvaWQKLWF1dGhfZnJlZXN0YXRlKGF1dGhf
c3RhdGUpCitzdGF0aWMgdm9pZCBteWZyZWVzdGF0ZShhdXRoX3N0YXRlKQogc3RydWN0IGF1dGhf
c3RhdGUgKmF1dGhfc3RhdGU7CiB7CiAgICAgZnJlZSgoY2hhciAqKWF1dGhfc3RhdGUpOwogfQog
CisjZWxzZSAvKiBIQVZFX0tSQiAqLworCitzdGF0aWMgaW50IG15bWVtYmVyb2YoCisgICAgc3Ry
dWN0IGF1dGhfc3RhdGUgKmF1dGhfc3RhdGUgX19hdHRyaWJ1dGVfXygodW51c2VkKSksIAorICAg
IGNvbnN0IGNoYXIgKmlkZW50aWZpZXIgX19hdHRyaWJ1dGVfXygodW51c2VkKSkpCit7CisJZmF0
YWwoIkF1dGhlbnRpY2F0aW9uIG1lY2hhbmlzbSAoa3JiKSBub3QgY29tcGlsZWQgaW4iLCBFQ19D
T05GSUcpOworfQorCitzdGF0aWMgY2hhciAqbXljYW5vbmlmeWlkKAorICAgIGNvbnN0IGNoYXIg
KmlkZW50aWZpZXIgX19hdHRyaWJ1dGVfXygodW51c2VkKSksIAorICAgIHNpemVfdCBsZW4gX19h
dHRyaWJ1dGVfXygodW51c2VkKSkpCit7CisJZmF0YWwoIkF1dGhlbnRpY2F0aW9uIG1lY2hhbmlz
bSAoa3JiKSBub3QgY29tcGlsZWQgaW4iLCBFQ19DT05GSUcpOworfQorCitzdGF0aWMgc3RydWN0
IGF1dGhfc3RhdGUgKm15bmV3c3RhdGUoCisgICAgY29uc3QgY2hhciAqaWRlbnRpZmllciBfX2F0
dHJpYnV0ZV9fKCh1bnVzZWQpKSkKK3sKKwlmYXRhbCgiQXV0aGVudGljYXRpb24gbWVjaGFuaXNt
IChrcmIpIG5vdCBjb21waWxlZCBpbiIsIEVDX0NPTkZJRyk7Cit9CisKK3N0YXRpYyB2b2lkIG15
ZnJlZXN0YXRlKAorICAgIHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0YXRlIF9fYXR0cmlidXRl
X18oKHVudXNlZCkpKQoreworCWZhdGFsKCJBdXRoZW50aWNhdGlvbiBtZWNoYW5pc20gKGtyYikg
bm90IGNvbXBpbGVkIGluIiwgRUNfQ09ORklHKTsKK30KKworI2VuZGlmCisKK3N0cnVjdCBhdXRo
X21lY2ggYXV0aF9rcmIgPSAKK3sKKyAgICAia3JiIiwJCS8qIG5hbWUgKi8KKworICAgICZteWNh
bm9uaWZ5aWQsCisgICAgJm15bWVtYmVyb2YsCisgICAgJm15bmV3c3RhdGUsCisgICAgJm15ZnJl
ZXN0YXRlLAorfTsKSW5kZXg6IGxpYi9hdXRoX2tyYjUuYwo9PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAv
Y3ZzL3NyYy9jeXJ1cy9saWIvYXV0aF9rcmI1LmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMwpk
aWZmIC11IC1yMS4zIGF1dGhfa3JiNS5jCi0tLSBsaWIvYXV0aF9rcmI1LmMJMTYgSmFuIDIwMDQg
MTU6Mjg6NTggLTAwMDAJMS4zCisrKyBsaWIvYXV0aF9rcmI1LmMJMjggRmViIDIwMDQgMDQ6NDE6
MjQgLTAwMDAKQEAgLTQyLDYgKzQyLDEyIEBACiAKICNpbmNsdWRlIDxjb25maWcuaD4KICNpbmNs
dWRlIDxzdGRsaWIuaD4KKworI2luY2x1ZGUgImF1dGguaCIKKyNpbmNsdWRlICJleGl0Y29kZXMu
aCIKKworI2lmZGVmIEhBVkVfR1NTQVBJX0gKKwogI2luY2x1ZGUgPGxpbWl0cy5oPgogI2luY2x1
ZGUgPHN0ZGlvLmg+CiAjaW5jbHVkZSA8Y3R5cGUuaD4KQEAgLTUzLDggKzU5LDYgQEAKICNpbmNs
dWRlICJhdXRoLmgiCiAjaW5jbHVkZSAieG1hbGxvYy5oIgogCi1jb25zdCBjaGFyICphdXRoX21l
dGhvZF9kZXNjID0gImtyYjUiOwotCiBzdHJ1Y3QgYXV0aF9zdGF0ZSB7CiAgICAgY2hhciAqdXNl
cmlkOyAvKiBDYW5vbmlmaWVkIFVzZXJpZCAqLwogfTsKQEAgLTY3LDcgKzcxLDcgQEAKICAqCTIJ
VXNlciBpcyBpbiB0aGUgZ3JvdXAgdGhhdCBpcyBpZGVudGlmaWVyCiAgKgkzCVVzZXIgaXMgaWRl
bnRpZmVyCiAgKi8KLWludCBhdXRoX21lbWJlcm9mKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0
YXRlLCBjb25zdCBjaGFyICppZGVudGlmaWVyKQorc3RhdGljIGludCBteW1lbWJlcm9mKHN0cnVj
dCBhdXRoX3N0YXRlICphdXRoX3N0YXRlLCBjb25zdCBjaGFyICppZGVudGlmaWVyKQogewogICAg
IGNoYXIgKmlkZW50OwogICAgIGludCByZXQ9MDsKQEAgLTkyLDcgKzk2LDcgQEAKICAqIFJldHVy
bnMgYSBwb2ludGVyIHRvIGEgc3RhdGljIGJ1ZmZlciBjb250YWluaW5nIHRoZSBjYW5vbmljYWwg
Zm9ybQogICogb3IgTlVMTCBpZiAnaWRlbnRpZmllcicgaXMgaW52YWxpZC4KICAqLwotY2hhciAq
YXV0aF9jYW5vbmlmeWlkKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIsIHNpemVfdCBsZW4pCitzdGF0
aWMgY2hhciAqbXljYW5vbmlmeWlkKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIsIHNpemVfdCBsZW4p
CiB7CiAgICAgc3RhdGljIGNoYXIgKnJldGJ1ZiA9IE5VTEw7CiAgICAga3JiNV9jb250ZXh0IGNv
bnRleHQ7CkBAIC0xNzIsNyArMTc2LDcgQEAKIC8qCiAgKiBTZXQgdGhlIGN1cnJlbnQgdXNlciB0
byAnaWRlbnRpZmllcicuCiAgKi8KLXN0cnVjdCBhdXRoX3N0YXRlICphdXRoX25ld3N0YXRlKGNv
bnN0IGNoYXIgKmlkZW50aWZpZXIpCitzdGF0aWMgc3RydWN0IGF1dGhfc3RhdGUgKm15bmV3c3Rh
dGUoY29uc3QgY2hhciAqaWRlbnRpZmllcikKIHsKICAgICBzdHJ1Y3QgYXV0aF9zdGF0ZSAqbmV3
c3RhdGU7CiAgICAgY2hhciAqaWRlbnQ7CkBAIC0xODUsNyArMTg5LDcgQEAKICAgICByZXR1cm4g
bmV3c3RhdGU7CiB9CiAKLXZvaWQgYXV0aF9mcmVlc3RhdGUoc3RydWN0IGF1dGhfc3RhdGUgKmF1
dGhfc3RhdGUpCitzdGF0aWMgdm9pZCBteWZyZWVzdGF0ZShzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0
aF9zdGF0ZSkKIHsKICAgICBpZighYXV0aF9zdGF0ZSkgcmV0dXJuOwogICAgIApAQCAtMTkzLDQg
KzE5Nyw0MiBAQAogICAgIGZyZWUoYXV0aF9zdGF0ZSk7CiB9CiAKKyNlbHNlIC8qIEhBVkVfR1NT
QVBJX0ggKi8KKworc3RhdGljIGludCBteW1lbWJlcm9mKAorICAgIHN0cnVjdCBhdXRoX3N0YXRl
ICphdXRoX3N0YXRlIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLCAKKyAgICBjb25zdCBjaGFyICpp
ZGVudGlmaWVyIF9fYXR0cmlidXRlX18oKHVudXNlZCkpKQoreworCWZhdGFsKCJBdXRoZW50aWNh
dGlvbiBtZWNoYW5pc20gKGtyYikgbm90IGNvbXBpbGVkIGluIiwgRUNfQ09ORklHKTsKK30KKwor
c3RhdGljIGNoYXIgKm15Y2Fub25pZnlpZCgKKyAgICBjb25zdCBjaGFyICppZGVudGlmaWVyIF9f
YXR0cmlidXRlX18oKHVudXNlZCkpLCAKKyAgICBzaXplX3QgbGVuIF9fYXR0cmlidXRlX18oKHVu
dXNlZCkpKQoreworCWZhdGFsKCJBdXRoZW50aWNhdGlvbiBtZWNoYW5pc20gKGtyYikgbm90IGNv
bXBpbGVkIGluIiwgRUNfQ09ORklHKTsKK30KIAorc3RhdGljIHN0cnVjdCBhdXRoX3N0YXRlICpt
eW5ld3N0YXRlKAorICAgIGNvbnN0IGNoYXIgKmlkZW50aWZpZXIgX19hdHRyaWJ1dGVfXygodW51
c2VkKSkpCit7CisJZmF0YWwoIkF1dGhlbnRpY2F0aW9uIG1lY2hhbmlzbSAoa3JiKSBub3QgY29t
cGlsZWQgaW4iLCBFQ19DT05GSUcpOworfQorCitzdGF0aWMgdm9pZCBteWZyZWVzdGF0ZSgKKyAg
ICBzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9zdGF0ZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSkK
K3sKKwlmYXRhbCgiQXV0aGVudGljYXRpb24gbWVjaGFuaXNtIChrcmIpIG5vdCBjb21waWxlZCBp
biIsIEVDX0NPTkZJRyk7Cit9CisKKyNlbmRpZgorCitzdHJ1Y3QgYXV0aF9tZWNoIGF1dGhfa3Ji
NSA9IAoreworICAgICJrcmI1IiwJCS8qIG5hbWUgKi8KKworICAgICZteWNhbm9uaWZ5aWQsCisg
ICAgJm15bWVtYmVyb2YsCisgICAgJm15bmV3c3RhdGUsCisgICAgJm15ZnJlZXN0YXRlLAorfTsK
SW5kZXg6IGxpYi9hdXRoX3B0cy5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL2N5cnVz
L2xpYi9hdXRoX3B0cy5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjcKZGlmZiAtdSAtcjEuNyBh
dXRoX3B0cy5jCi0tLSBsaWIvYXV0aF9wdHMuYwkyNCBGZWIgMjAwNCAyMzoxMTozNyAtMDAwMAkx
LjcKKysrIGxpYi9hdXRoX3B0cy5jCTI4IEZlYiAyMDA0IDA0OjQxOjI0IC0wMDAwCkBAIC02Mywx
NiArNjMsMTUgQEAKICNpbmNsdWRlICJzdHJoYXNoLmgiCiAjaW5jbHVkZSAieG1hbGxvYy5oIgog
Ci1jb25zdCBjaGFyICphdXRoX21ldGhvZF9kZXNjID0gInB0cyI7Ci0KLWNoYXIgKmNhbm9udXNl
cl9pZCA9IE5VTEw7Ci1zdHJ1Y3QgYXV0aF9zdGF0ZSAqY2Fub251c2VyX2NhY2hlID0gTlVMTDsK
K3N0YXRpYyBjaGFyICpjYW5vbnVzZXJfaWQgPSBOVUxMOworc3RhdGljIHN0cnVjdCBhdXRoX3N0
YXRlICpjYW5vbnVzZXJfY2FjaGUgPSBOVUxMOwogCiAvKiBSZXR1cm5zIDAgb24gc3VjY2Vzc2Z1
bCBjb25uZWN0aW9uIHRvIHB0bG9hZGVyL3ZhbGlkIGNhY2hlIGVudHJ5LAogICogY29tcGxldGUg
d2l0aCBhbGxvY2F0ZWQgJiBmaWxsZWQgaW4gc3RydWN0IGF1dGhfc3RhdGUuCiAgKgogICogc3Rh
dGUgbXVzdCBiZSBhIE5VTEwgcG9pbnRlciB3aGVuIHBhc3NlZCBpbiAqLwotaW50IHB0bG9hZChj
b25zdCBjaGFyICppZGVudGlmaWVyLHN0cnVjdCBhdXRoX3N0YXRlICoqc3RhdGUpOworc3RhdGlj
IGludCBwdGxvYWQoY29uc3QgY2hhciAqaWRlbnRpZmllcixzdHJ1Y3QgYXV0aF9zdGF0ZSAqKnN0
YXRlKTsKK3N0YXRpYyB2b2lkIG15ZnJlZXN0YXRlKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0
YXRlKTsKIAogLyoKICAqIERldGVybWluZSBpZiB0aGUgdXNlciBpcyBhIG1lbWJlciBvZiAnaWRl
bnRpZmllcicKQEAgLTgyLDcgKzgxLDcgQEAKICAqICAgICAgMiAgICAgICBVc2VyIGlzIGluIHRo
ZSBncm91cCB0aGF0IGlzIGlkZW50aWZpZXIKICAqICAgICAgMyAgICAgICBVc2VyIGlzIGlkZW50
aWZlcgogICovCi1pbnQgYXV0aF9tZW1iZXJvZihzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9zdGF0
ZSwKK3N0YXRpYyBpbnQgbXltZW1iZXJvZihzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9zdGF0ZSwK
IAkJICBjb25zdCBjaGFyICppZGVudGlmaWVyKQogewogICAgIGludCBpOwpAQCAtMTEwLDEwICsx
MDksOCBAQAogICAgIAogICAgIC8qIGlzIGl0IGEgZ3JvdXAgaSdtIGEgbWVtYmVyIG9mID8gKi8K
ICAgICBmb3IgKGk9MDsgaSA8IGF1dGhfc3RhdGUtPm5ncm91cHM7IGkrKykKLSAgICAgICAgaWYg
KCBpZGhhc2ggPT0gYXV0aF9zdGF0ZS0+Z3JvdXBzW2ldLmhhc2ggJiYKLQkgICAgICAgICgoICFz
dHJuY21wKGlkZW50aWZpZXIsICJncm91cDoiLCA2KSAmJiAKLSAgICAgICAgICAgICAgICAhc3Ry
Y21wKGlkZW50aWZpZXIrNiwgYXV0aF9zdGF0ZS0+Z3JvdXBzW2ldLmlkKSApIHx8Ci0gICAgICAg
ICAgICAgIXN0cmNtcChpZGVudGlmaWVyLCBhdXRoX3N0YXRlLT5ncm91cHNbaV0uaWQpKSApCisg
ICAgICAgIGlmIChpZGhhc2ggPT0gYXV0aF9zdGF0ZS0+Z3JvdXBzW2ldLmhhc2ggJiYKKyAgICAg
ICAgICAgICFzdHJjbXAoaWRlbnRpZmllciwgYXV0aF9zdGF0ZS0+Z3JvdXBzW2ldLmlkKSkKICAg
ICAgICAgICAgIHJldHVybiAyOwogICAKICAgICByZXR1cm4gMDsKQEAgLTEyNCw3ICsxMjEsNyBA
QAogICogUmV0dXJucyBhIHBvaW50ZXIgdG8gYSBzdGF0aWMgYnVmZmVyIGNvbnRhaW5pbmcgdGhl
IGNhbm9uaWNhbCBmb3JtCiAgKiBvciBOVUxMIGlmICdpZGVudGlmaWVyJyBpcyBpbnZhbGlkLgog
ICovCi1jaGFyICphdXRoX2Nhbm9uaWZ5aWQoY29uc3QgY2hhciAqaWRlbnRpZmllciwKK3N0YXRp
YyBjaGFyICpteWNhbm9uaWZ5aWQoY29uc3QgY2hhciAqaWRlbnRpZmllciwKIAkJICAgICAgc2l6
ZV90IGxlbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSkKIHsKICAgICBzdGF0aWMgY2hhciByZXRi
dWZbUFRTX0RCX0tFWVNJWkVdOwpAQCAtMTM2LDcgKzEzMyw3IEBACiAgICAgfSBlbHNlIGlmKGNh
bm9udXNlcl9pZCkgewogCS8qIFdlJ3ZlIGdvdCBhIG5ldyBvbmUsIGludmFsaWRhdGUgb3VyIGNh
Y2hlICovCiAJZnJlZShjYW5vbnVzZXJfaWQpOwotCWF1dGhfZnJlZXN0YXRlKGNhbm9udXNlcl9j
YWNoZSk7CisJbXlmcmVlc3RhdGUoY2Fub251c2VyX2NhY2hlKTsKIAogCWNhbm9udXNlcl9pZCA9
IE5VTEw7CiAJY2Fub251c2VyX2NhY2hlID0gTlVMTDsKQEAgLTE2MCw3ICsxNTcsNyBAQAogLyog
CiAgKiBQcm9kdWNlIGFuIGF1dGhfc3RhdGUgc3RydWN0dXJlIGZvciB0aGUgZ2l2ZW4gaWRlbnRp
ZmllcgogICovCi1zdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9uZXdzdGF0ZShjb25zdCBjaGFyICpp
ZGVudGlmaWVyKSAKK3N0YXRpYyBzdHJ1Y3QgYXV0aF9zdGF0ZSAqbXluZXdzdGF0ZShjb25zdCBj
aGFyICppZGVudGlmaWVyKSAKIHsKICAgICBzdHJ1Y3QgYXV0aF9zdGF0ZSAqb3V0cHV0ID0gTlVM
TDsKIApAQCAtMTg5LDEwICsxODYsMTAgQEAKICAgICByZXR1cm4gb3V0cHV0OwogfQogCi1zdHJ1
Y3QgY3lydXNkYl9iYWNrZW5kICp0aGVfcHRzY2FjaGVfZGIgPSBOVUxMOworc3RhdGljIHN0cnVj
dCBjeXJ1c2RiX2JhY2tlbmQgKnRoZV9wdHNjYWNoZV9kYiA9IE5VTEw7CiAKIC8qIFJldHVybnMg
MCBvbiBzdWNjZXNzICovCi1pbnQgcHRsb2FkKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIsIHN0cnVj
dCBhdXRoX3N0YXRlICoqc3RhdGUpIAorc3RhdGljIGludCBwdGxvYWQoY29uc3QgY2hhciAqaWRl
bnRpZmllciwgc3RydWN0IGF1dGhfc3RhdGUgKipzdGF0ZSkgCiB7CiAgICAgc3RydWN0IGF1dGhf
c3RhdGUgKmZldGNoZWQgPSBOVUxMOwogICAgIHNpemVfdCBpZF9sZW47CkBAIC0zNDUsNyArMzQy
LDE3IEBACiAgICAgcmV0dXJuICgqc3RhdGUpID8gMCA6IC0xOwogfQogCi12b2lkIGF1dGhfZnJl
ZXN0YXRlKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0YXRlKQorc3RhdGljIHZvaWQgbXlmcmVl
c3RhdGUoc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhfc3RhdGUpCiB7CiAgICAgZnJlZShhdXRoX3N0
YXRlKTsKIH0KKworc3RydWN0IGF1dGhfbWVjaCBhdXRoX3B0cyA9IAoreworICAgICJwdHMiLAkJ
LyogbmFtZSAqLworCisgICAgJm15Y2Fub25pZnlpZCwKKyAgICAmbXltZW1iZXJvZiwKKyAgICAm
bXluZXdzdGF0ZSwKKyAgICAmbXlmcmVlc3RhdGUsCit9OwpJbmRleDogbGliL2F1dGhfdW5peC5j
Cj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL2N5cnVzL2xpYi9hdXRoX3VuaXguYyx2CnJl
dHJpZXZpbmcgcmV2aXNpb24gMS4zNwpkaWZmIC11IC1yMS4zNyBhdXRoX3VuaXguYwotLS0gbGli
L2F1dGhfdW5peC5jCTIyIE9jdCAyMDAzIDE4OjUwOjEyIC0wMDAwCTEuMzcKKysrIGxpYi9hdXRo
X3VuaXguYwkyOCBGZWIgMjAwNCAwNDo0MToyNCAtMDAwMApAQCAtNTUsOCArNTUsNiBAQAogI2lu
Y2x1ZGUgImxpYmN5cl9jZmcuaCIKICNpbmNsdWRlICJ4bWFsbG9jLmgiCiAKLWNvbnN0IGNoYXIg
KmF1dGhfbWV0aG9kX2Rlc2MgPSAidW5peCI7Ci0KIHN0cnVjdCBhdXRoX3N0YXRlIHsKICAgICBj
aGFyIHVzZXJpZFs4MV07CiAgICAgY2hhciAqKmdyb3VwOwpAQCAtNzUsNyArNzMsNyBAQAogICoJ
MglVc2VyIGlzIGluIHRoZSBncm91cCB0aGF0IGlzIGlkZW50aWZpZXIKICAqCTMJVXNlciBpcyBp
ZGVudGlmZXIKICAqLwotaW50IGF1dGhfbWVtYmVyb2YoYXV0aF9zdGF0ZSwgaWRlbnRpZmllcikK
K3N0YXRpYyBpbnQgbXltZW1iZXJvZihhdXRoX3N0YXRlLCBpZGVudGlmaWVyKQogc3RydWN0IGF1
dGhfc3RhdGUgKmF1dGhfc3RhdGU7CiBjb25zdCBjaGFyICppZGVudGlmaWVyOwogewpAQCAtMTU0
LDcgKzE1Miw3IEBACiAgKiByZXByZXNlbnRhdGlvbnM6IG9uZSBmb3IgZ2V0cHdlbnQgY2FsbHMg
YW5kIG9uZSBmb3IgZm9sZGVyIG5hbWVzLiAgVGhlCiAgKiBsYXR0ZXIgY2Fub25pY2FsaXplcyB0
byBhIE1VVEY3IHJlcHJlc2VudGF0aW9uLgogICovCi1jaGFyICphdXRoX2Nhbm9uaWZ5aWQoaWRl
bnRpZmllciwgbGVuKQorc3RhdGljIGNoYXIgKm15Y2Fub25pZnlpZChpZGVudGlmaWVyLCBsZW4p
CiBjb25zdCBjaGFyICppZGVudGlmaWVyOwogc2l6ZV90IGxlbjsKIHsKQEAgLTIxOCwxNCArMjE2
LDE0IEBACiAgKiBwb2ludHMgdG8gYSAxNi1ieXRlIGJpbmFyeSBrZXkgdG8gY2FjaGUgaWRlbnRp
ZmllcidzIGluZm9ybWF0aW9uCiAgKiB3aXRoLgogICovCi1zdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0
aF9uZXdzdGF0ZShjb25zdCBjaGFyICppZGVudGlmaWVyKQorc3RhdGljIHN0cnVjdCBhdXRoX3N0
YXRlICpteW5ld3N0YXRlKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIpCiB7CiAgICAgc3RydWN0IGF1
dGhfc3RhdGUgKm5ld3N0YXRlOwogICAgIHN0cnVjdCBwYXNzd2QgKnB3ZDsKICAgICBzdHJ1Y3Qg
Z3JvdXAgKmdycDsKICAgICBjaGFyICoqbWVtOwogCi0gICAgaWRlbnRpZmllciA9IGF1dGhfY2Fu
b25pZnlpZChpZGVudGlmaWVyLCAwKTsKKyAgICBpZGVudGlmaWVyID0gbXljYW5vbmlmeWlkKGlk
ZW50aWZpZXIsIDApOwogICAgIGlmICghaWRlbnRpZmllcikgcmV0dXJuIDA7CiAgICAgaWYgKCFz
dHJuY21wKGlkZW50aWZpZXIsICJncm91cDoiLCA2KSkgcmV0dXJuIDA7CiAgICAgCkBAIC0yNTcs
OCArMjU1LDcgQEAKICAgICByZXR1cm4gbmV3c3RhdGU7CiB9CiAKLXZvaWQKLWF1dGhfZnJlZXN0
YXRlKGF1dGhfc3RhdGUpCitzdGF0aWMgdm9pZCBteWZyZWVzdGF0ZShhdXRoX3N0YXRlKQogc3Ry
dWN0IGF1dGhfc3RhdGUgKmF1dGhfc3RhdGU7CiB7CiAgICAgaWYgKGF1dGhfc3RhdGUtPmdyb3Vw
KSBmcmVlKChjaGFyICopYXV0aF9zdGF0ZS0+Z3JvdXApOwpAQCAtMjY2LDMgKzI2MywxMiBAQAog
fQogCiAKK3N0cnVjdCBhdXRoX21lY2ggYXV0aF91bml4ID0gCit7CisgICAgInVuaXgiLAkJLyog
bmFtZSAqLworCisgICAgJm15Y2Fub25pZnlpZCwKKyAgICAmbXltZW1iZXJvZiwKKyAgICAmbXlu
ZXdzdGF0ZSwKKyAgICAmbXlmcmVlc3RhdGUsCit9OwpJbmRleDogbGliL2ltYXBvcHRpb25zCj09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL2N5cnVzL2xpYi9pbWFwb3B0aW9ucyx2CnJldHJp
ZXZpbmcgcmV2aXNpb24gMS4xNgpkaWZmIC11IC1yMS4xNiBpbWFwb3B0aW9ucwotLS0gbGliL2lt
YXBvcHRpb25zCTI2IEZlYiAyMDA0IDIyOjQxOjMyIC0wMDAwCTEuMTYKKysrIGxpYi9pbWFwb3B0
aW9ucwkyOCBGZWIgMjAwNCAwNDo0MToyNCAtMDAwMApAQCAtMTM4LDYgKzEzOCw5IEBACiB7ICJh
bm5vdGF0aW9uX2RiIiwgInNraXBsaXN0IiwgU1RSSU5HTElTVCgiYmVya2VsZXkiLCAic2tpcGxp
c3QiKX0KIC8qIFRoZSBjeXJ1c2RiIGJhY2tlbmQgdG8gdXNlIGZvciBtYWlsYm94IGFubm90YXRp
b25zLiAqLwogCit7ICJhdXRoX21lY2giLCAidW5peCIsIFNUUklOR0xJU1QoInVuaXgiLCAicHRz
IiwgImtyYiIsICJrcmI1Iil9CisvKiBUaGUgYXV0aG9yaXphdGlvbiBtZWNoYW5pc20gdG8gdXNl
LiAqLworCiB7ICJhdXRvY3JlYXRlcXVvdGEiLCAwLCBJTlQgfQogLyogSWYgbm9uemVybywgbm9y
bWFsIHVzZXJzIG1heSBjcmVhdGUgdGhlaXIgb3duIElNQVAgYWNjb3VudHMgYnkKICAgIGNyZWF0
aW5nIHRoZSBtYWlsYm94IElOQk9YLiAgVGhlIHVzZXIncyBxdW90YSBpcyBzZXQgdG8gdGhlIHZh
bHVlCkBAIC01ODUsNiArNTg4LDkgQEAKIC8qIEEgbGlzdCBvZiB1c2VycyBhbmQgZ3JvdXBzIHRo
YXQgYXJlIGFsbG93ZWQgdG8gcHJveHkgZm9yIG90aGVyCiAgICB1c2Vycywgc2VwZXJhdGVkIGJ5
IHNwYWNlcy4gIEFueSB1c2VyIGxpc3RlZCBpbiB0aGlzIHdpbGwgYmUKICAgIGFsbG93ZWQgdG8g
bG9naW4gZm9yIGFueSBvdGhlciB1c2VyOiB1c2Ugd2l0aCBjYXV0aW9uLiAqLyAKKworeyAicHRz
X21vZHVsZSIsICJhZnNrcmIiLCBTVFJJTkdMSVNUKCJhZnNrcmIiLCAibGRhcCIpIH0KKy8qIFRo
ZSBQVFMgbW9kdWxlLiAqLwogCiB7ICJwdGxvYWRlcl9zb2NrIiwgTlVMTCwgU1RSSU5HIH0KIC8q
IFVuaXggZG9tYWluIHNvY2tldCB0aGF0IHB0bG9hZGVyIGxpc3RlbnMgb24uCkluZGV4OiBsaWIv
bGliY3lyX2NmZy5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL2N5cnVzL2xpYi9saWJj
eXJfY2ZnLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuOQpkaWZmIC11IC1yMS45IGxpYmN5cl9j
ZmcuYwotLS0gbGliL2xpYmN5cl9jZmcuYwkyNiBGZWIgMjAwNCAyMjo0MTozMiAtMDAwMAkxLjkK
KysrIGxpYi9saWJjeXJfY2ZnLmMJMjggRmViIDIwMDQgMDQ6NDE6MjQgLTAwMDAKQEAgLTExMCw2
ICsxMTAsMTAgQEAKICAgICAgIENGR1ZBTChpbnQsIDUxMiAqIDEwMjQpLCAvKiA1MTJLQiAqLwog
ICAgICAgQ1lSVVNfT1BUX0lOVCB9LAogCisgICAgeyBDWVJVU09QVF9BVVRIX01FQ0gsCisgICAg
ICBDRkdWQUwoY29uc3QgY2hhciAqLCAidW5peCIpLAorICAgICAgQ1lSVVNfT1BUX1NUUklORyB9
LAorCiAgICAgeyBDWVJVU09QVF9MQVNULCB7IE5VTEwgfSwgQ1lSVVNfT1BUX05PVE9QVCB9CiB9
OwogCkluZGV4OiBsaWIvbGliY3lyX2NmZy5oCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3Jj
L2N5cnVzL2xpYi9saWJjeXJfY2ZnLmgsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNgpkaWZmIC11
IC1yMS42IGxpYmN5cl9jZmcuaAotLS0gbGliL2xpYmN5cl9jZmcuaAkyNiBGZWIgMjAwNCAxODow
MzowNyAtMDAwMAkxLjYKKysrIGxpYi9saWJjeXJfY2ZnLmgJMjggRmViIDIwMDQgMDQ6NDE6MjUg
LTAwMDAKQEAgLTkzLDYgKzkzLDggQEAKICAgICBDWVJVU09QVF9WSVJURE9NQUlOUywKICAgICAv
KiBCREIgY2FjaGUgc2l6ZSAoNTEyS0IpICovCiAgICAgQ1lSVVNPUFRfQkVSS0VMRVlfQ0FDSEVT
SVpFLAorICAgIC8qIGF1dGhvcml6YXRpb24gbWVjaGFuaXNtICh1bml4KSAqLworICAgIENZUlVT
T1BUX0FVVEhfTUVDSCwKIAogICAgIENZUlVTT1BUX0xBU1QKICAgICAKSW5kZXg6IHB0Y2xpZW50
L01ha2VmaWxlLmluCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL2N5cnVzL3B0Y2xpZW50
L01ha2VmaWxlLmluLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjI2CmRpZmYgLXUgLXIxLjI2IE1h
a2VmaWxlLmluCi0tLSBwdGNsaWVudC9NYWtlZmlsZS5pbgkyMyBKYW4gMjAwNCAxNjozNToyOCAt
MDAwMAkxLjI2CisrKyBwdGNsaWVudC9NYWtlZmlsZS5pbgkyOCBGZWIgMjAwNCAwNDo0MToyNSAt
MDAwMApAQCAtOTUsMTEgKzk1LDExIEBACiAuYy5vOgogCSQoQ0MpIC1jICQoQ1BQRkxBR1MpICQo
TERBUF9DUFBGTEFHUykgJChERUZTKSAkKENGTEFHUykgJDwKIAotcHRsb2FkZXI6IHB0bG9hZGVy
Lm8gQFdJVEhfUFRTQC5vIC4uL2ltYXAvbXV0ZXhfZmFrZS5vICQoREVQTElCUykKLQkkKENDKSAk
KExERkxBR1MpIC1vICRAIHB0bG9hZGVyLm8gQFdJVEhfUFRTQC5vIC4uL2ltYXAvbXV0ZXhfZmFr
ZS5vICQoU0VSVklDRVRIUkVBRCkgJHtBRlNfTERGTEFHU30gJHtMREFQX0xERkxBR1N9ICQoQUZT
X0xJQlMpICR7TERBUF9MSUJTfSAkKERFUExJQlMpICQoTElCX1NBU0wpICQoTElCUykgJChMSUJf
V1JBUCkgJChMSUJfUlQpCitwdGxvYWRlcjogcHRsb2FkZXIubyBhZnNrcmIubyBsZGFwLm8gLi4v
aW1hcC9tdXRleF9mYWtlLm8gJChERVBMSUJTKQorCSQoQ0MpICQoTERGTEFHUykgLW8gJEAgcHRs
b2FkZXIubyBhZnNrcmIubyBsZGFwLm8gLi4vaW1hcC9tdXRleF9mYWtlLm8gJChTRVJWSUNFVEhS
RUFEKSAke0FGU19MREZMQUdTfSAke0xEQVBfTERGTEFHU30gJChBRlNfTElCUykgJHtMREFQX0xJ
QlN9ICQoREVQTElCUykgJChMSUJfU0FTTCkgJChMSUJTKSAkKExJQl9XUkFQKSAkKExJQl9SVCkK
IAotcHRsb2FkZXIucHVyZTogcHRsb2FkZXIubyBAV0lUSF9QVFNALm8gLi4vaW1hcC9tdXRleF9m
YWtlLm8gJChERVBMSUJTKQotCSQoUFVSSUZZKSAkKFBVUkVBUkdTKSAkKENDKSAkKExERkxBR1Mp
IC1vICRAIHB0bG9hZGVyLm8gQFdJVEhfUFRTQC5vIC4uL2ltYXAvbXV0ZXhfZmFrZS5vICQoU0VS
VklDRVRIUkVBRCkgJHtBRlNfTERGTEFHU30gJHtMREFQX0xERkxBR1N9ICQoQUZTX0xJQlMpICR7
TERBUF9MSUJTfSAkKERFUExJQlMpICQoTElCX1NBU0wpICQoTElCUykgJChMSUJfV1JBUCkgJChM
SUJfUlQpCitwdGxvYWRlci5wdXJlOiBwdGxvYWRlci5vIGFmc2tyYi5vIGxkYXAubyAuLi9pbWFw
L211dGV4X2Zha2UubyAkKERFUExJQlMpCisJJChQVVJJRlkpICQoUFVSRUFSR1MpICQoQ0MpICQo
TERGTEFHUykgLW8gJEAgcHRsb2FkZXIubyBhZnNrcmIubyBsZGFwLm8gLi4vaW1hcC9tdXRleF9m
YWtlLm8gJChTRVJWSUNFVEhSRUFEKSAke0FGU19MREZMQUdTfSAke0xEQVBfTERGTEFHU30gJChB
RlNfTElCUykgJHtMREFQX0xJQlN9ICQoREVQTElCUykgJChMSUJfU0FTTCkgJChMSUJTKSAkKExJ
Ql9XUkFQKSAkKExJQl9SVCkKIAogcHRleHBpcmU6IHB0ZXhwaXJlLm8gJChERVBMSUJTKSAkKFVU
SUxfTElCUykKIAkkKENDKSAkKExERkxBR1MpIC1vICRAIHB0ZXhwaXJlLm8gJChVVElMX0xJQlMp
ICQoREVQTElCUykgJChMSUJfU0FTTCkgJChMSUJTKSAkKExJQl9SVCkKSW5kZXg6IHB0Y2xpZW50
L2Fmc2tyYi5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL2N5cnVzL3B0Y2xpZW50L2Fm
c2tyYi5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjMKZGlmZiAtdSAtcjEuMyBhZnNrcmIuYwot
LS0gcHRjbGllbnQvYWZza3JiLmMJMTEgTm92IDIwMDMgMDM6MjY6MDAgLTAwMDAJMS4zCisrKyBw
dGNsaWVudC9hZnNrcmIuYwkyOCBGZWIgMjAwNCAwNDo0MToyNSAtMDAwMApAQCAtNDQsNiArNDQs
MTAgQEAKICAgICAgICIkSWQ6IGFmc2tyYi5jLHYgMS4zIDIwMDMvMTEvMTEgMDM6MjY6MDAgcmpz
MyBFeHAgJCI7CiAKICNpbmNsdWRlIDxjb25maWcuaD4KKyNpbmNsdWRlICJwdGxvYWRlci5oIgor
I2luY2x1ZGUgImV4aXRjb2Rlcy5oIgorCisjaWZkZWYgSEFWRV9BRlNLUkIKIAogI2luY2x1ZGUg
PHN0cmluZy5oPgogI2luY2x1ZGUgPHN0ZGlvLmg+CkBAIC02NSw3ICs2OSw2IEBACiAjZW5kaWYK
IAogI2luY2x1ZGUgImF1dGhfcHRzLmgiCi0jaW5jbHVkZSAiZXhpdGNvZGVzLmgiCiAjaW5jbHVk
ZSAibGliY29uZmlnLmgiCiAjaW5jbHVkZSAic3RyaGFzaC5oIgogI2luY2x1ZGUgInhtYWxsb2Mu
aCIKQEAgLTM2OSw5ICszNzIsOCBAQAogI2VuZGlmIC8qIEFGU1BUU19VU0VfS1JCNSAqLwogCiAv
KiBBUEkgKi8KLWNvbnN0IGNoYXIgKnB0c21vZHVsZV9uYW1lID0gImFmc2tyYiI7CiAKLXZvaWQg
cHRzbW9kdWxlX2luaXQodm9pZCkgCitzdGF0aWMgdm9pZCBteWluaXQodm9pZCkgCiB7CiAgICAg
aW50IHIgPSBwcl9Jbml0aWFsaXplICgxTCwgQUZTQ09ORl9DTElFTlROQU1FLCAwKTsKICAgICBp
ZiAocikgewpAQCAtMzgxLDcgKzM4Myw3IEBACiAgICAgcmV0dXJuOwogfQogCi1zdHJ1Y3QgYXV0
aF9zdGF0ZSAqcHRzbW9kdWxlX21ha2VfYXV0aHN0YXRlKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIs
CitzdGF0aWMgc3RydWN0IGF1dGhfc3RhdGUgKm15YXV0aHN0YXRlKGNvbnN0IGNoYXIgKmlkZW50
aWZpZXIsCiAJCQkJCSAgICBzaXplX3Qgc2l6ZSwKIAkJCQkJICAgIGNvbnN0IGNoYXIgKipyZXBs
eSwgaW50ICpkc2l6ZSkgCiB7CkBAIC00NDQsMyArNDQ2LDI5IEBACiAKICAgICByZXR1cm4gbmV3
c3RhdGU7CiB9CisKKyNlbHNlIC8qIEhBVkVfQUZTS1JCICovCisKK3N0YXRpYyB2b2lkIG15aW5p
dCh2b2lkKQoreworCWZhdGFsKCJQVFMgbW9kdWxlIChhZnNrcmIpIG5vdCBjb21waWxlZCBpbiIs
IEVDX0NPTkZJRyk7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgYXV0aF9zdGF0ZSAqbXlhdXRoc3RhdGUo
CisgICAgY29uc3QgY2hhciAqaWRlbnRpZmllciBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAg
ICBzaXplX3Qgc2l6ZSBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgICBjb25zdCBjaGFyICoq
cmVwbHkgX19hdHRyaWJ1dGVfXygodW51c2VkKSksIAorICAgIGludCAqZHNpemUgX19hdHRyaWJ1
dGVfXygodW51c2VkKSkpIAoreworCWZhdGFsKCJQVFMgbW9kdWxlIChhZnNrcmIpIG5vdCBjb21w
aWxlZCBpbiIsIEVDX0NPTkZJRyk7Cit9CisKKyNlbmRpZiAvKiBIQVZFX0FGU0tSQiAqLworCitz
dHJ1Y3QgcHRzX21vZHVsZSBwdHNfYWZza3JiID0gCit7CisgICAgImFmc2tyYiIsCQkvKiBuYW1l
ICovCisKKyAgICAmbXlpbml0LAorICAgICZteWF1dGhzdGF0ZSwKK307CkluZGV4OiBwdGNsaWVu
dC9sZGFwLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvY3lydXMvcHRjbGllbnQvbGRh
cC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjUKZGlmZiAtdSAtcjEuNSBsZGFwLmMKLS0tIHB0
Y2xpZW50L2xkYXAuYwkyNSBGZWIgMjAwNCAxNjozNjozMSAtMDAwMAkxLjUKKysrIHB0Y2xpZW50
L2xkYXAuYwkyOCBGZWIgMjAwNCAwNDo0MToyNSAtMDAwMApAQCAtNDQsNiArNDQsMTAgQEAKICAg
ICAgICIkSWQ6IGxkYXAuYyx2IDEuNSAyMDA0LzAyLzI1IDE2OjM2OjMxIHJqczMgRXhwICQiOwog
CiAjaW5jbHVkZSA8Y29uZmlnLmg+CisjaW5jbHVkZSAicHRsb2FkZXIuaCIKKyNpbmNsdWRlICJl
eGl0Y29kZXMuaCIKKworI2lmZGVmIEhBVkVfTERBUAogCiAjaW5jbHVkZSA8c3RyaW5nLmg+CiAj
aW5jbHVkZSA8c3RkaW8uaD4KQEAgLTY5LDcgKzczLDYgQEAKIAogLyogbGliY3lydXMgKi8KICNp
bmNsdWRlICJhdXRoX3B0cy5oIgotI2luY2x1ZGUgImV4aXRjb2Rlcy5oIgogI2luY2x1ZGUgInN0
cmhhc2guaCIKICNpbmNsdWRlICJ4bWFsbG9jLmgiCiAKQEAgLTQyNiw5ICs0MjksOCBAQAogfQog
CiAvKiBBUEkgKi8KLWNvbnN0IGNoYXIgKnB0c21vZHVsZV9uYW1lID0gImxkYXAiOwogCi12b2lk
IHB0c21vZHVsZV9pbml0KHZvaWQpIAorc3RhdGljIHZvaWQgbXlpbml0KHZvaWQpIAogewogICAg
IGNvbnN0IGNoYXIgKnAgPSBOVUxMOwogCkBAIC05MjEsNyArOTIzLDggQEAKICAgICAgICAgICAg
ICgqbmV3c3RhdGUpLT5uZ3JvdXBzID0gbnVtdmFsczsKIAogICAgICAgICAgICAgZm9yIChpID0g
MDsgdmFsc1tpXSAhPSBOVUxMOyBpKyspIHsKLSAgICAgICAgICAgICAgICBzdHJsY3B5KCgqbmV3
c3RhdGUpLT5ncm91cHNbaV0uaWQsIHZhbHNbaV0sIAorICAgICAgICAgICAgICAgIHN0cmNweSgo
Km5ld3N0YXRlKS0+Z3JvdXBzW2ldLmlkLCAiZ3JvdXA6Iik7CisgICAgICAgICAgICAgICAgc3Ry
bGNhdCgoKm5ld3N0YXRlKS0+Z3JvdXBzW2ldLmlkLCB2YWxzW2ldLCAKICAgICAgICAgICAgICAg
ICAgICAgc2l6ZW9mKCgqbmV3c3RhdGUpLT5ncm91cHNbaV0uaWQpKTsKICAgICAgICAgICAgICAg
ICAoKm5ld3N0YXRlKS0+Z3JvdXBzW2ldLmhhc2ggPSBzdHJoYXNoKCgqbmV3c3RhdGUpLT5ncm91
cHNbaV0uaWQpOwogICAgICAgICAgICAgfQpAQCAtMTA0OSw3ICsxMDUyLDggQEAKICAgICAgICAg
ICAgIGlmICh2YWxzID09IE5VTEwpCiAgICAgICAgICAgICAgICAgY29udGludWU7CiAKLSAgICAg
ICAgICAgIHN0cmxjcHkoKCpuZXdzdGF0ZSktPmdyb3Vwc1tpXS5pZCwgdmFsc1swXSwgCisgICAg
ICAgICAgICBzdHJjcHkoKCpuZXdzdGF0ZSktPmdyb3Vwc1tpXS5pZCwgImdyb3VwOiIpOworICAg
ICAgICAgICAgc3RybGNhdCgoKm5ld3N0YXRlKS0+Z3JvdXBzW2ldLmlkLCB2YWxzWzBdLCAKICAg
ICAgICAgICAgICAgICBzaXplb2YoKCpuZXdzdGF0ZSktPmdyb3Vwc1tpXS5pZCkpOwogICAgICAg
ICAgICAgKCpuZXdzdGF0ZSktPmdyb3Vwc1tpXS5oYXNoID0gc3RyaGFzaCgoKm5ld3N0YXRlKS0+
Z3JvdXBzW2ldLmlkKTsKIApAQCAtMTE2Myw3ICsxMTY3LDcgQEAKICAgICByZXR1cm4gcmM7CiB9
CiAKLXN0cnVjdCBhdXRoX3N0YXRlICpwdHNtb2R1bGVfbWFrZV9hdXRoc3RhdGUoCitzdGF0aWMg
c3RydWN0IGF1dGhfc3RhdGUgKm15YXV0aHN0YXRlKAogICAgIGNvbnN0IGNoYXIgKmlkZW50aWZp
ZXIsCiAgICAgc2l6ZV90IHNpemUsCiAgICAgY29uc3QgY2hhciAqKnJlcGx5LCAKQEAgLTEyMDEs
MyArMTIwNSwyOSBAQAogCiAgICAgcmV0dXJuIG5ld3N0YXRlOwogfQorCisjZWxzZSAvKiBIQVZF
X0xEQVAgKi8KKworc3RhdGljIHZvaWQgbXlpbml0KHZvaWQpCit7CisJZmF0YWwoIlBUUyBtb2R1
bGUgKGxkYXApIG5vdCBjb21waWxlZCBpbiIsIEVDX0NPTkZJRyk7Cit9CisKK3N0YXRpYyBzdHJ1
Y3QgYXV0aF9zdGF0ZSAqbXlhdXRoc3RhdGUoCisgICAgY29uc3QgY2hhciAqaWRlbnRpZmllciBf
X2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgICBzaXplX3Qgc2l6ZSBfX2F0dHJpYnV0ZV9fKCh1
bnVzZWQpKSwKKyAgICBjb25zdCBjaGFyICoqcmVwbHkgX19hdHRyaWJ1dGVfXygodW51c2VkKSks
IAorICAgIGludCAqZHNpemUgX19hdHRyaWJ1dGVfXygodW51c2VkKSkpIAoreworCWZhdGFsKCJQ
VFMgbW9kdWxlIChsZGFwKSBub3QgY29tcGlsZWQgaW4iLCBFQ19DT05GSUcpOworfQorCisjZW5k
aWYgLyogSEFWRV9MREFQICovCisKK3N0cnVjdCBwdHNfbW9kdWxlIHB0c19sZGFwID0gCit7Cisg
ICAgImxkYXAiLAkJLyogbmFtZSAqLworCisgICAgJm15aW5pdCwKKyAgICAmbXlhdXRoc3RhdGUs
Cit9OwpJbmRleDogcHRjbGllbnQvcHRsb2FkZXIuYwo9PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3Zz
L3NyYy9jeXJ1cy9wdGNsaWVudC9wdGxvYWRlci5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjM3
CmRpZmYgLXUgLXIxLjM3IHB0bG9hZGVyLmMKLS0tIHB0Y2xpZW50L3B0bG9hZGVyLmMJMjUgRmVi
IDIwMDQgMTY6MDU6MDggLTAwMDAJMS4zNworKysgcHRjbGllbnQvcHRsb2FkZXIuYwkyOCBGZWIg
MjAwNCAwNDo0MToyNSAtMDAwMApAQCAtNjUsMTcgKzY1LDYxIEBACiAjaW5jbHVkZSAibG9jay5o
IgogI2luY2x1ZGUgInJldHJ5LmgiCiAjaW5jbHVkZSAieG1hbGxvYy5oIgorI2luY2x1ZGUgInB0
bG9hZGVyLmgiCiAKIHN0YXRpYyBjaGFyIHJjc2lkW10gX19hdHRyaWJ1dGVfXygodW51c2VkKSkg
PSAKICAgICAgICIkSWQ6IHB0bG9hZGVyLmMsdiAxLjM3IDIwMDQvMDIvMjUgMTY6MDU6MDggcmpz
MyBFeHAgJCI7CiAKLWV4dGVybiBjb25zdCBjaGFyICpwdHNtb2R1bGVfbmFtZTsKLWV4dGVybiB2
b2lkIHB0c21vZHVsZV9pbml0KHZvaWQpOworc3RydWN0IHB0c19tb2R1bGUgKnB0c19tb2R1bGVz
W10gPSB7CisjaWZkZWYgSEFWRV9MREFQCisgICAgJnB0c19sZGFwLAorI2VuZGlmCisjaWZkZWYg
SEFWRV9BRlNLUkIKKyAgICAmcHRzX2Fmc2tyYiwKKyNlbmRpZgorICAgIE5VTEwgfTsKKwogZXh0
ZXJuIHZvaWQgc2V0cHJvY3RpdGxlX2luaXQoaW50IGFyZ2MsIGNoYXIgKiphcmd2LCBjaGFyICoq
ZW52cCk7Ci1leHRlcm4gc3RydWN0IGF1dGhfc3RhdGUgKnB0c21vZHVsZV9tYWtlX2F1dGhzdGF0
ZShjb25zdCBjaGFyICppZGVudGlmaWVyLAotCQkJCQkJICAgc2l6ZV90IHNpemUsCi0JCQkJCQkg
ICBjb25zdCBjaGFyICoqcmVwbHksCi0JCQkJCQkgICBpbnQgKmRzaXplKTsKKworc3RhdGljIHN0
cnVjdCBwdHNfbW9kdWxlICpwdHNfZnJvbW5hbWUoKQoreworICAgIGludCBpOworICAgIGNvbnN0
IGNoYXIgKm5hbWUgPSBjb25maWdfZ2V0c3RyaW5nKElNQVBPUFRfUFRTX01PRFVMRSk7CisgICAg
c3RhdGljIHN0cnVjdCBwdHNfbW9kdWxlICpwdHMgPSBOVUxMOworCisgICAgaWYgKHB0cykKKyAg
ICAgICAgcmV0dXJuIHB0czsKKworICAgIGZvciAoaSA9IDA7IHB0c19tb2R1bGVzW2ldOyBpKysp
IHsKKwlpZiAoIXN0cmNtcChwdHNfbW9kdWxlc1tpXS0+bmFtZSwgbmFtZSkpIHsKKwkgICAgcHRz
ID0gcHRzX21vZHVsZXNbaV07IGJyZWFrOworCX0KKyAgICB9CisgICAgaWYgKCFwdHMpIHsKKwlj
aGFyIGVycmJ1ZlsxMDI0XTsKKwlzbnByaW50ZihlcnJidWYsIHNpemVvZihlcnJidWYpLAorCQkg
IlBUUyBtb2R1bGUgJXMgbm90IHN1cHBvcnRlZCIsIG5hbWUpOworCWZhdGFsKGVycmJ1ZiwgRUNf
Q09ORklHKTsKKyAgICB9CisKKyAgICByZXR1cm4gcHRzOworfQorCit2b2lkIHB0c21vZHVsZV9p
bml0KHZvaWQpCit7CisgICAgc3RydWN0IHB0c19tb2R1bGUgKnB0cyA9IHB0c19mcm9tbmFtZSgp
OworCisgICAgcHRzLT5pbml0KCk7Cit9CisKK3N0cnVjdCBhdXRoX3N0YXRlICpwdHNtb2R1bGVf
bWFrZV9hdXRoc3RhdGUoY29uc3QgY2hhciAqaWRlbnRpZmllciwKKwkJCQkJICAgIHNpemVfdCBz
aXplLAorCQkJCQkgICAgY29uc3QgY2hhciAqKnJlcGx5LCBpbnQgKmRzaXplKQoreworICAgIHN0
cnVjdCBwdHNfbW9kdWxlICpwdHMgPSBwdHNfZnJvbW5hbWUoKTsKKworICAgIHJldHVybiBwdHMt
Pm1ha2VfYXV0aHN0YXRlKGlkZW50aWZpZXIsIHNpemUsIHJlcGx5LCBkc2l6ZSk7Cit9CiAKIC8q
IGNvbmZpZy5jIGluZm8gKGxpYmltYXApICovCiBjb25zdCBpbnQgY29uZmlnX25lZWRfZGF0YSA9
IDA7CkBAIC0xMDEsOCArMTQ1LDcgQEAKICAgICBzaWduYWwoU0lHUElQRSwgU0lHX0lHTik7CiAK
ICAgICBzeXNsb2coTE9HX05PVElDRSwKLQkgICAic3RhcnRpbmc6ICRJZDogcHRsb2FkZXIuYyx2
IDEuMzcgMjAwNC8wMi8yNSAxNjowNTowOCByanMzIEV4cCAkICglcykiLAotCSAgIHB0c21vZHVs
ZV9uYW1lKTsKKwkgICAic3RhcnRpbmc6ICRJZDogcHRsb2FkZXIuYyx2IDEuMzcgMjAwNC8wMi8y
NSAxNjowNTowOCByanMzIEV4cCAkIik7CiAKICAgICB3aGlsZSAoKG9wdCA9IGdldG9wdChhcmdj
LCBhcmd2LCAiZDoiKSkgIT0gRU9GKSB7CiAJc3dpdGNoIChvcHQpIHsKSW5kZXg6IGNvbmZpZ3Vy
ZS5pbgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9jeXJ1cy9jb25maWd1cmUuaW4sdgpy
ZXRyaWV2aW5nIHJldmlzaW9uIDEuMjgwCmRpZmYgLXUgLXIxLjI4MCBjb25maWd1cmUuaW4KLS0t
IGNvbmZpZ3VyZS5pbgk4IEZlYiAyMDA0IDE4OjMxOjEyIC0wMDAwCTEuMjgwCisrKyBjb25maWd1
cmUuaW4JMjggRmViIDIwMDQgMDQ6NDE6MjUgLTAwMDAKQEAgLTE1MywxNiArMTUzLDYgQEAKIEFD
X1NVQlNUKExPQ0FMREVGUykKIEFDX0ZVTkNfVlBSSU5URgogCi1kbmwgY2hlY2sgYXV0aG9yaXph
dGlvbiBtZXRob2QgYmVmb3JlIGRhdGFiYXNlcywgdG8gZmluZCBvdXQKLWRubCBpZiB3ZSBuZWVk
IGEgUFRTIGRhdGFiYXNlIG9yIG5vdAotQUNfQVJHX1dJVEgoYXV0aCxbICAtLXdpdGgtYXV0aD1N
RVRIT0QgICAgICB1c2UgYXV0aG9yaXphdGlvbiBtb2R1bGUgTUVUSE9ECi0gICAgICAgICAgICAg
ICAgICAgICAgICAgIE1FVEhPRCBpcyAndW5peCcgKGRlZmF1bHQpLCAna3JiJywgJ2tyYjUnLCBv
ciAncHRzJ10sCi0JV0lUSF9BVVRIPSIkd2l0aHZhbCIsIFdJVEhfQVVUSD0idW5peCIpCi1BQ19T
VUJTVChXSVRIX0FVVEgpCi0KLUFDX01TR19DSEVDS0lORyhhdXRob3JpemF0aW9uIG1ldGhvZCkK
LUFDX01TR19SRVNVTFQoJFdJVEhfQVVUSCkKLQogZG5sIGZ1bmN0aW9uIGZvciBkb2luZyBlYWNo
IG9mIHRoZSBkYXRhYmFzZSBiYWNrZW5kcwogZG5sIHBhcmFtZXRlcnM6IGJhY2tlbmQgbmFtZSwg
dmFyaWFibGUgdG8gc2V0LCB3aXRodmFsCiAKQEAgLTQ2NSw5NyArNDU1LDg2IEBACiAKIEFDX0FS
R19XSVRIKGFmcyxbICAtLXdpdGgtYWZzPVBBVEggICAgICAgICB1c2UgQUZTIGxpYnJhcmllcyBm
cm9tIFBBVEhdLAogCVt3aXRoX2Fmcz0iJHt3aXRodmFsfSIKLQlDRkxBR1M9IiR7Q0ZMQUdTfSAt
SSR7d2l0aHZhbH0vaW5jbHVkZSJdLHdpdGhfYWZzPSIvdXNyL2xvY2FsIikKKwlDRkxBR1M9IiR7
Q0ZMQUdTfSAtSSR7d2l0aHZhbH0vaW5jbHVkZSJdLHdpdGhfYWZzPSJubyIpCiAKLUFDX0FSR19X
SVRIKGxkYXAsIFsgIC0td2l0aC1sZGFwPURJUiAgICAgICAgIHVzZSBMREFQIChpbiBESVIpIChl
eHBlcmltZW50YWwpIFsvdXNyL2xvY2FsXSBdLAorQUNfQVJHX1dJVEgobGRhcCwgWyAgLS13aXRo
LWxkYXA9RElSICAgICAgICAgdXNlIExEQVAgKGluIERJUikgKGV4cGVyaW1lbnRhbCkgXSwKIAl3
aXRoX2xkYXA9JHdpdGh2YWwsIHdpdGhfbGRhcD0iL3Vzci9sb2NhbCIpCiAKLWRubCBzZWxlY3Qg
bW9kdWxlIGZvciBwdGxvYWRlcgotQUNfQVJHX1dJVEgocHRzLFsgIC0td2l0aC1wdHM9TU9EVUxF
ICAgICAgIHVzZSBQVFMgbW9kdWxlIE1PRFVMRQotICAgICAgICAgICAgICAgICAgICAgICAgICBN
T0RVTEUgaXMgJ2Fmc2tyYicgKGRlZmF1bHQpIG9yICdsZGFwJyAoZXhwZXJpbWVudGFsKV0sCi0J
ICAgIFdJVEhfUFRTPSIkd2l0aHZhbCIsIFdJVEhfUFRTPSJhZnNrcmIiKQotQUNfU1VCU1QoV0lU
SF9QVFMpCi0KIGRubCBzZWxlY3QgbW9kZSBvZiBhZnNwdHMKIEFDX0FSR19FTkFCTEUoa3JiNWFm
c3B0cyxbICAtLWVuYWJsZS1rcmI1YWZzcHRzICAgICBjb21waWxlIGFmc2tyYiBQVFMgbW9kdWxl
IHdpdGgga3JiNSBzdXBwb3J0XSwKIAlbU0FTTF9TRVRfR1NTQVBJX0xJQlMKICAgICAgICAgIEFD
X0RFRklORShBRlNQVFNfVVNFX0tSQjUsW10sW1Nob3VsZCB0aGUgQUZTIFBUUyBwbHVnaW4gdXNl
IGtyYjU/XSldKQogCi1pZiB0ZXN0ICIkV0lUSF9BVVRIIiA9ICJwdHMiOyB0aGVuCi0JQUNfTVNH
X0NIRUNLSU5HKHdoaWNoIHB0cyBtb2R1bGUgdG8gdXNlKQotCUFDX01TR19SRVNVTFQoJFdJVEhf
UFRTKQotCi0JRVhUUkFfU1VCRElSUz0iJHtFWFRSQV9TVUJESVJTfSBwdGNsaWVudCIKLQlFWFRS
QV9PVVRQVVQ9IiR7RVhUUkFfT1VUUFVUfSBwdGNsaWVudC9NYWtlZmlsZSIKLQotCUxEQVBfQ1BQ
RkxBR1M9IiIKLQlMREFQX0xERkxBR1M9IiIKLQlMREFQX0xJQlM9IiIKLQotICAJaWYgdGVzdCAi
JFdJVEhfUFRTIiA9ICJhZnNrcmIiOyB0aGVuCi0JICAgIEFGU19MSUJTPSIke3dpdGhfYWZzfS9s
aWIvYWZzL2xpYmthdXRoLmEgJHt3aXRoX2Fmc30vbGliL2Fmcy9saWJwcm90LmEgICR7d2l0aF9h
ZnN9L2xpYi9hZnMvbGliYXV0aC5hICR7d2l0aF9hZnN9L2xpYi9hZnMvbGlic3lzLmEgJHt3aXRo
X2Fmc30vbGliL2xpYnJ4a2FkLmEgJHt3aXRoX2Fmc30vbGliL2xpYnJ4LmEgJHt3aXRoX2Fmc30v
bGliL2Fmcy9saWJzeXMuYSAke3dpdGhfYWZzfS9saWIvbGlidWJpay5hICAke3dpdGhfYWZzfS9s
aWIvbGlibHdwLmEgJHt3aXRoX2Fmc30vbGliL2Fmcy91dGlsLmEiCi0JICAgIGlmIHRlc3QgLWYg
JHt3aXRoX2Fmc30vbGliL2Fmcy9saWJhdWRpdC5hOyB0aGVuCi0JCUFGU19MSUJTPSIkQUZTX0xJ
QlMgJHt3aXRoX2Fmc30vbGliL2Fmcy9saWJhdWRpdC5hIgotCSAgICBmaQotCSAgICBpZiB0ZXN0
IC1mIC91c3IvdWNibGliL2xpYnVjYi5hOyB0aGVuCi0JCUNNVV9BRERfTElCUEFUSF9UTygvdXNy
L3VjYmxpYiwgQUZTX0xERkxBR1MpCi0JCUFGU19MSUJTPSIkQUZTX0xJQlMgLWxjIC1sdWNiIgot
CSAgICBmaQotCi0JICAgIEFDX0NBQ0hFX1ZBTChjeXJ1c19hZnNfc2lndmVjLFsKLQkJU0FWRV9M
SUJTPSIkTElCUyIKLQkJTElCUz0iJHt3aXRoX2Fmc30vbGliL2xpYmx3cC5hIgotCQlBQ19NU0df
Q0hFQ0tJTkcoaWYgQUZTIGxpYnJhcmllcyBuZWVkIHNpZ3ZlYykKLQkJZG5sIERvZXMgQUZTIG5l
ZWQgc2lndmVjPyAgV2UgaGF2ZSB0byBsaW5rIGFnYWluc3QgbHdwIGFuZCBzZWUKLQkJZG5sIGlm
IElPTUdSX0luaXRpYWxpemUgd2FudHMgaXQKLQkJQUNfVFJZX0xJTksoW0lPTUdSX0luaXRpYWxp
emUoKTtdLAotCQkJW0lPTUdSX0luaXRpYWxpemUoKV0sCi0JCQlbCi0JCQkJZG5sIGl0IGxpbmtl
ZDsgZG9uJ3QgbmVlZCBpdAotCQkJCUFDX01TR19SRVNVTFQobm8pCi0JCQkJY3lydXNfYWZzX3Np
Z3ZlYz0ibm8iCi0JCQldLCBbCi0JCQkJZG5sIGRpZG4ndCBsaW5rOyBwaWNrIHVwIHNpZ3ZlYwot
CQkJCUFDX01TR19SRVNVTFQoeWVzKQotCQkJCWN5cnVzX2Fmc19zaWd2ZWM9InllcyIKLQkJCV0p
Ci0JCV0pCi0JICAgIGlmIHRlc3QgIiRjeXJ1c19hZnNfc2lndmVjIiA9IHllczsgdGhlbgotCSAg
ICAgIGlmIHRlc3QgIiRjYW50X2ZpbmRfc2lndmVjIiA9IHllczsgdGhlbgotICAgICAgICAgICAg
ICAgIEFDX01TR19XQVJOKFtDYW4ndCBmaW5kIGEgc2lndmVjIGZvciBBRlMgbGlicmFyaWVzIHdo
aWNoIHNlZW1dKQotCSAgICAgICAgQUNfTVNHX1dBUk4oW3RvIG5lZWQgb25lOyBwdGxvYWRlciBt
YXkgbm90IGJ1aWxkLl0pCi0gICAgICAgICAgICAgIGVsc2UKLQkgICAgICAgIEFGU19MSUJTPSIk
e0FGU19MSUJTfSAkY3lydXNfc2lndmVjbGliIgotCSAgICAgIGZpCi0JICAgIGZpCi0JICAgIExJ
QlM9IiRTQVZFX0xJQlMiCi0JICAgIEFDX1NVQlNUKEFGU19MSUJTKQotCSAgICBBQ19TVUJTVChB
RlNfTERGTEFHUykKLQllbGlmIHRlc3QgIiRXSVRIX1BUUyIgPSAibGRhcCI7IHRoZW4KLQkgICAg
QUNfTVNHX1dBUk4oWyoqKiBXQVJOSU5HOiBDT01QSUxJTkcgV0lUSCBFWFBFUklNRU5UQUwgTERB
UCBQVExPQURFUiBNT0RVTEUgKioqXSkKLQkgICAgaWYgdGVzdCAtZCAkd2l0aF9sZGFwOyB0aGVu
Ci0JICAgICAgICBMREFQX0NQUEZMQUdTPSIkQ1BQRkxBR1MgLUkke3dpdGhfbGRhcH0vaW5jbHVk
ZSIKLQkgICAgICAgIExEQVBfTERGTEFHUz0iJExERkxBR1MgLUwke3dpdGhfbGRhcH0vbGliIgot
CSAgICBlbHNlCi0JIAlBQ19FUlJPUihMREFQIHBhdGggaXNuJ3QgYSBkaXJlY3RvcnkpCi0JICAg
IGZpCQotCi0JICAgIExEQVBfTElCUz0iIgotCSAgICBBQ19DSEVDS19MSUIobGRhcCwgbGRhcF9p
bml0aWFsaXplLCBbCi0gICAgICAgICAgICAgICAgICAgICAgICAgTERBUF9MSUJTPSItbGxkYXAg
LWxsYmVyIiBdLCwtbGxiZXIpCi0JZWxzZQotCSAgICBBQ19FUlJPUih1bmtub3duIHdpdGgtcHRz
IHZhbHVlKQotCWZpCitFWFRSQV9TVUJESVJTPSIke0VYVFJBX1NVQkRJUlN9IHB0Y2xpZW50Igor
RVhUUkFfT1VUUFVUPSIke0VYVFJBX09VVFBVVH0gcHRjbGllbnQvTWFrZWZpbGUiCiAKLSAgIAlB
Q19TVUJTVChMREFQX0NQUEZMQUdTKQotCUFDX1NVQlNUKExEQVBfTERGTEFHUykKLQlBQ19TVUJT
VChMREFQX0xJQlMpCQoraWYgdGVzdCAieCR3aXRoX2FmcyIgIT0gInhubyI7IHRoZW4KKyAgICBp
ZiB0ZXN0ICEgLWQgJHdpdGhfYWZzOyB0aGVuCisgICAgICAgICR3aXRoX2Fmcz0vdXNyL2xvY2Fs
CisgICAgZmkKKyAgICBBRlNfTElCUz0iJHt3aXRoX2Fmc30vbGliL2Fmcy9saWJrYXV0aC5hICR7
d2l0aF9hZnN9L2xpYi9hZnMvbGlicHJvdC5hICAke3dpdGhfYWZzfS9saWIvYWZzL2xpYmF1dGgu
YSAke3dpdGhfYWZzfS9saWIvYWZzL2xpYnN5cy5hICR7d2l0aF9hZnN9L2xpYi9saWJyeGthZC5h
ICR7d2l0aF9hZnN9L2xpYi9saWJyeC5hICR7d2l0aF9hZnN9L2xpYi9hZnMvbGlic3lzLmEgJHt3
aXRoX2Fmc30vbGliL2xpYnViaWsuYSAgJHt3aXRoX2Fmc30vbGliL2xpYmx3cC5hICR7d2l0aF9h
ZnN9L2xpYi9hZnMvdXRpbC5hIgorICAgIGlmIHRlc3QgLWYgJHt3aXRoX2Fmc30vbGliL2Fmcy9s
aWJhdWRpdC5hOyB0aGVuCisgICAgQUZTX0xJQlM9IiRBRlNfTElCUyAke3dpdGhfYWZzfS9saWIv
YWZzL2xpYmF1ZGl0LmEiCisgICAgZmkKKyAgICBpZiB0ZXN0IC1mIC91c3IvdWNibGliL2xpYnVj
Yi5hOyB0aGVuCisgICAgQ01VX0FERF9MSUJQQVRIX1RPKC91c3IvdWNibGliLCBBRlNfTERGTEFH
UykKKyAgICBBRlNfTElCUz0iJEFGU19MSUJTIC1sYyAtbHVjYiIKKyAgICBmaQorCisgICAgQUNf
Q0FDSEVfVkFMKGN5cnVzX2Fmc19zaWd2ZWMsWworICAgIFNBVkVfTElCUz0iJExJQlMiCisgICAg
TElCUz0iJHt3aXRoX2Fmc30vbGliL2xpYmx3cC5hIgorICAgIEFDX01TR19DSEVDS0lORyhpZiBB
RlMgbGlicmFyaWVzIG5lZWQgc2lndmVjKQorICAgIGRubCBEb2VzIEFGUyBuZWVkIHNpZ3ZlYz8g
IFdlIGhhdmUgdG8gbGluayBhZ2FpbnN0IGx3cCBhbmQgc2VlCisgICAgZG5sIGlmIElPTUdSX0lu
aXRpYWxpemUgd2FudHMgaXQKKyAgICBBQ19UUllfTElOSyhbSU9NR1JfSW5pdGlhbGl6ZSgpO10s
CisgICAgICAgIFtJT01HUl9Jbml0aWFsaXplKCldLAorICAgICAgICBbCisgICAgICAgICAgICBk
bmwgaXQgbGlua2VkOyBkb24ndCBuZWVkIGl0CisgICAgICAgICAgICBBQ19NU0dfUkVTVUxUKG5v
KQorICAgICAgICAgICAgY3lydXNfYWZzX3NpZ3ZlYz0ibm8iCisgICAgICAgIF0sIFsKKyAgICAg
ICAgICAgIGRubCBkaWRuJ3QgbGluazsgcGljayB1cCBzaWd2ZWMKKyAgICAgICAgICAgIEFDX01T
R19SRVNVTFQoeWVzKQorICAgICAgICAgICAgY3lydXNfYWZzX3NpZ3ZlYz0ieWVzIgorICAgICAg
ICBdKQorICAgIF0pCisgICAgaWYgdGVzdCAiJGN5cnVzX2Fmc19zaWd2ZWMiID0geWVzOyB0aGVu
CisgICAgICBpZiB0ZXN0ICIkY2FudF9maW5kX3NpZ3ZlYyIgPSB5ZXM7IHRoZW4KKyAgICAgICAg
ICAgIEFDX01TR19XQVJOKFtDYW4ndCBmaW5kIGEgc2lndmVjIGZvciBBRlMgbGlicmFyaWVzIHdo
aWNoIHNlZW1dKQorICAgICAgICBBQ19NU0dfV0FSTihbdG8gbmVlZCBvbmU7IHB0bG9hZGVyIG1h
eSBub3QgYnVpbGQuXSkKKyAgICAgICAgICBlbHNlCisgICAgICAgIEFGU19MSUJTPSIke0FGU19M
SUJTfSAkY3lydXNfc2lndmVjbGliIgorICAgICAgZmkKKyAgICBmaQorICAgIExJQlM9IiRTQVZF
X0xJQlMiCisgICAgQUNfU1VCU1QoQUZTX0xJQlMpCisgICAgQUNfU1VCU1QoQUZTX0xERkxBR1Mp
CisgICAgQUNfREVGSU5FKEhBVkVfQUZTS1JCLFtdLFtTaG91bGQgd2UgYnVpbGQgYWZza3JiIHB0
cyBtb2R1bGU/XSkKK2ZpCisKK0xEQVBfQ1BQRkxBR1M9IiIKK0xEQVBfTERGTEFHUz0iIgorTERB
UF9MSUJTPSIiCisKK2lmIHRlc3QgIngkd2l0aF9sZGFwIiAhPSAieG5vIjsgdGhlbgorICAgIGlm
IHRlc3QgISAtZCAkd2l0aF9sZGFwOyB0aGVuCisgICAgICAgICR3aXRoX2xkYXA9L3Vzci9sb2Nh
bAorICAgIGZpCisKKyAgICBMREFQX0NQUEZMQUdTPSIkQ1BQRkxBR1MgLUkke3dpdGhfbGRhcH0v
aW5jbHVkZSIKKyAgICBMREFQX0xERkxBR1M9IiRMREZMQUdTIC1MJHt3aXRoX2xkYXB9L2xpYiIK
KyAgICBMREFQX0xJQlM9IiIKKyAgICBBQ19DSEVDS19MSUIobGRhcCwgbGRhcF9pbml0aWFsaXpl
LCAKKyAgICAgICAgWyBBQ19ERUZJTkUoSEFWRV9MREFQLFtdLFtTaG91bGQgd2UgYnVpbGQgbGRh
cCBwdHMgbW9kdWxlP10pCisgICAgICAgICAgQUNfU1VCU1QoTERBUF9DUFBGTEFHUykKKyAgICAg
ICAgICBBQ19TVUJTVChMREFQX0xERkxBR1MpCisgICAgICAgICAgQUNfU1VCU1QoTERBUF9MSUJT
KQkKKyAgICAgICAgICBMREFQX0xJQlM9Ii1sbGRhcCAtbGxiZXIiIF0sLC1sbGJlcikKIAotCUFD
X0RFRklORShXSVRIX1BUUyxbXSxbQnVpbGQgaW4gUFRTIHN1cHBvcnQ/XSkKIGZpCiAKIAotCiBT
RVJWRVJfU1VCRElSUz0ibWFzdGVyIGltYXAiCiBBQ19BUkdfRU5BQkxFKHNlcnZlciwKIAlbICAt
LWRpc2FibGUtc2VydmVyICAgICAgICBkaXNhYmxlIGNvbXBpbGluZyBzZXJ2ZXJzXSwKQEAgLTU3
NCw3NiArNTUzLDY3IEBACiAJCVsgIC0tZW5hYmxlLXN0YXRpY2tyYiAgICAgIGxpbmsgS2VyYmVy
b3Mgc3RhdGljYWxseV0sCiAJd2l0aF9zdGF0aWNrcmI9InllcyIsIHdpdGhfc3RhdGlja3JiPSJu
byIpCiAKLWlmIHRlc3QgIiRXSVRIX0FVVEgiID0gImtyYiIgLW8gIiRXSVRIX0FVVEgiID0gImty
Yl9wdHMiIC1vICIkd2l0aF9rcmIiICE9ICJubyI7IHRoZW4KLSAgZG5sIEluIG9yZGVyIHRvIGNv
bXBpbGUga2VyYmVyb3M0LCB3ZSBuZWVkIGxpYmtyYiBhbmQgbGliZGVzLgotCi0gIGRubCB3ZSBt
aWdodCBuZWVkIC1scmVzb2x2IGZvciBrZXJiZXJvcwotICBBQ19DSEVDS19MSUIocmVzb2x2LHJl
c19zZWFyY2gpCitkbmwgSW4gb3JkZXIgdG8gY29tcGlsZSBrZXJiZXJvczQsIHdlIG5lZWQgbGli
a3JiIGFuZCBsaWJkZXMuCiAKLSAgaWYgdGVzdCAiJHdpdGhfc3RhdGlja3JiIiA9ICJ5ZXMiIC1h
ICEgLWQgIiR3aXRoX2tyYiI7IHRoZW4KLQlBQ19NU0dfRVJST1IoWy0tZW5hYmxlLXN0YXRpY2ty
YiBzcGVjaWZpZWQgYnV0IC0td2l0aC1rcmIgZGlkIG5vdCBzcGVjaWZ5IGEgdmFsaWQgZGlyZWN0
b3J5XSkKLSAgZmkgCi0KLSAgZG5sIERvIHdlIG5lZWQgREVTIGZvciBrZXJiZXJvcz8KLSAgQUNf
QVJHX1dJVEgoa3JiZGVzLFsgIC0td2l0aC1rcmJkZXMgICAgICAgICAgIHVzZSBLZXJiZXJvcyBE
RVMgaW1wbGVtZW50YXRpb24gW1t5ZXNdXV0sCi0Jd2l0aF9rcmJkZXM9IiR3aXRodmFsIiwgd2l0
aF9rcmJkZXM9InllcyIpCi0gIGlmIHRlc3QgIiR3aXRoX2tyYmRlcyIgPSAieWVzIjsgdGhlbgot
ICAgIEFDX0NIRUNLX0xJQihkZXMsZGVzX2VjYl9lbmNyeXB0LAotCWlmIHRlc3QgIiR3aXRoX3N0
YXRpY2tyYiIgPSAieWVzIjsgdGhlbgotCSAgICBLUkJfTElCUz0iJHdpdGhfa3JiL2xpYi9saWJk
ZXMuYSIKLQllbHNlCi0JICAgIEtSQl9MSUJTPSItbGRlcyIKLQlmaSwKLSAgICBBQ19NU0dfRVJS
T1IoW1RoZSBLZXJiZXJvcyBERVMgbGlicmFyeSBpcyByZXF1aXJlZCBmb3IgS2VyYmVyb3Mgc3Vw
cG9ydC4gIFlvdSBtaWdodCB3YW50IC0td2l0aC1hdXRoPXVuaXguXSkpCi0gIGZpCitkbmwgd2Ug
bWlnaHQgbmVlZCAtbHJlc29sdiBmb3Iga2VyYmVyb3MKK0FDX0NIRUNLX0xJQihyZXNvbHYscmVz
X3NlYXJjaCkKIAotICBkbmwgaWYgd2Ugd2VyZSBhbWJpdGlvdXMsIHdlJ2QgbG9vayBtb3JlIGFn
Z3Jlc3NpdmVseSBmb3IgdGhlCi0gIGRubCBrcmI0IGluc3RhbGwKLSAgaWYgdGVzdCAtZCAke3dp
dGhfa3JifTsgdGhlbgotICAgICBBQ19DQUNIRV9DSEVDSyhmb3IgS2VyYmVyb3MgaW5jbHVkZXMs
IGN5cnVzX2tyYmluY2x1ZGUsIFsKLSAgICAgICBmb3Iga3JiaGxvYyBpbiBpbmNsdWRlL2tlcmJl
cm9zSVYgaW5jbHVkZQotICAgICAgIGRvCi0gICAgICAgICBpZiB0ZXN0IC1mICR7d2l0aF9rcmJ9
LyR7a3JiaGxvY30va3JiLmggOyB0aGVuCi0gICAgICAgICAgIGN5cnVzX2tyYmluY2x1ZGU9JHt3
aXRoX2tyYn0vJHtrcmJobG9jfQotICAgICAgICAgICBicmVhawotICAgICAgICAgZmkKLSAgICAg
ICBkb25lCi0gICAgICAgXSkKK2lmIHRlc3QgIiR3aXRoX3N0YXRpY2tyYiIgPSAieWVzIiAtYSAh
IC1kICIkd2l0aF9rcmIiOyB0aGVuCitBQ19NU0dfRVJST1IoWy0tZW5hYmxlLXN0YXRpY2tyYiBz
cGVjaWZpZWQgYnV0IC0td2l0aC1rcmIgZGlkIG5vdCBzcGVjaWZ5IGEgdmFsaWQgZGlyZWN0b3J5
XSkKK2ZpIAorCitkbmwgRG8gd2UgbmVlZCBERVMgZm9yIGtlcmJlcm9zPworQUNfQVJHX1dJVEgo
a3JiZGVzLFsgIC0td2l0aC1rcmJkZXMgICAgICAgICAgIHVzZSBLZXJiZXJvcyBERVMgaW1wbGVt
ZW50YXRpb24gW1t5ZXNdXV0sCit3aXRoX2tyYmRlcz0iJHdpdGh2YWwiLCB3aXRoX2tyYmRlcz0i
eWVzIikKK2lmIHRlc3QgIiR3aXRoX2tyYmRlcyIgPSAieWVzIjsgdGhlbgorQUNfQ0hFQ0tfTElC
KGRlcyxkZXNfZWNiX2VuY3J5cHQsCitpZiB0ZXN0ICIkd2l0aF9zdGF0aWNrcmIiID0gInllcyI7
IHRoZW4KKyAgICBLUkJfTElCUz0iJHdpdGhfa3JiL2xpYi9saWJkZXMuYSIKK2Vsc2UKKyAgICBL
UkJfTElCUz0iLWxkZXMiCitmaSkKK2ZpCiAKLSAgICAgaWYgdGVzdCAtbiAiJHtjeXJ1c19rcmJp
bmNsdWRlfSI7IHRoZW4KLSAgICAgICBDUFBGTEFHUz0iJENQUEZMQUdTIC1JJHtjeXJ1c19rcmJp
bmNsdWRlfSIKK2RubCBpZiB3ZSB3ZXJlIGFtYml0aW91cywgd2UnZCBsb29rIG1vcmUgYWdncmVz
c2l2ZWx5IGZvciB0aGUKK2RubCBrcmI0IGluc3RhbGwKK2lmIHRlc3QgLWQgJHt3aXRoX2tyYn07
IHRoZW4KKyBBQ19DQUNIRV9DSEVDSyhmb3IgS2VyYmVyb3MgaW5jbHVkZXMsIGN5cnVzX2tyYmlu
Y2x1ZGUsIFsKKyAgIGZvciBrcmJobG9jIGluIGluY2x1ZGUva2VyYmVyb3NJViBpbmNsdWRlCisg
ICBkbworICAgICBpZiB0ZXN0IC1mICR7d2l0aF9rcmJ9LyR7a3JiaGxvY30va3JiLmggOyB0aGVu
CisgICAgICAgY3lydXNfa3JiaW5jbHVkZT0ke3dpdGhfa3JifS8ke2tyYmhsb2N9CisgICAgICAg
YnJlYWsKICAgICAgZmkKLSAgICAgQ01VX0FERF9MSUJQQVRIKCR7d2l0aF9rcmJ9L2xpYikKLSAg
ZmkKKyAgIGRvbmUKKyAgIF0pCiAKLSAgaWYgdGVzdCAiJHdpdGhfZGVzIiAhPSBubzsgdGhlbgot
ICAgIEFDX0NIRUNLX0hFQURFUihrcmIuaCwKLSAgICAgIEFDX0NIRUNLX0xJQihrcmIsIGtyYl9t
a19wcml2LAotCWlmIHRlc3QgIiR3aXRoX3N0YXRpY2tyYiIgPSAieWVzIjsgdGhlbgotCSAgICBL
UkJfTElCUz0iJEtSQl9MSUJTICR3aXRoX2tyYi9saWIvbGlia3JiLmEiCi0JZWxzZQotCSAgICBL
UkJfTElCUz0iJEtSQl9MSUJTIC1sa3JiIgotCWZpLAotICAgICAgICAgICAgICAgICAgIEFDX1dB
Uk4oTm8gS2VyYmVyb3MgVjQgZm91bmQpOyBrcmI0PW5vLAotCQkgICAkS1JCX0xJQlMpLAotICAg
ICAgQUNfV0FSTihObyBLZXJiZXJvcyBWNCBmb3VuZCk7IGtyYjQ9bm8pCi0gIGVsc2UKLSAgICBB
Q19XQVJOKE5vIERFUyBsaWJyYXJ5IGZvdW5kIGZvciBLZXJiZXJvcyBWNCBzdXBwb3J0KQotICAg
IGtyYjQ9bm8KLSAgZmkKKyBpZiB0ZXN0IC1uICIke2N5cnVzX2tyYmluY2x1ZGV9IjsgdGhlbgor
ICAgQ1BQRkxBR1M9IiRDUFBGTEFHUyAtSSR7Y3lydXNfa3JiaW5jbHVkZX0iCisgZmkKKyBDTVVf
QUREX0xJQlBBVEgoJHt3aXRoX2tyYn0vbGliKQorZmkKIAotICBpZiB0ZXN0ICIke2tyYjR9IiAh
PSBubzsgdGhlbgotICAgIEFDX0RFRklORShIQVZFX0tSQixbXSxbU3VwcG9ydCBmb3IgS2VyYmVy
b3M/XSkKLSAgZWxzZQotICAgIEFDX0VSUk9SKFtLZXJiZXJvcyBub3QgZm91bmQgZm9yIGF1dGhv
cml6YXRpb24gbW9kdWxlXSkKLSAgZmkKK2lmIHRlc3QgIiR3aXRoX2RlcyIgIT0gbm87IHRoZW4K
K0FDX0NIRUNLX0hFQURFUihrcmIuaCwKKyAgQUNfQ0hFQ0tfTElCKGtyYiwga3JiX21rX3ByaXYs
CitpZiB0ZXN0ICIkd2l0aF9zdGF0aWNrcmIiID0gInllcyI7IHRoZW4KKyAgICBLUkJfTElCUz0i
JEtSQl9MSUJTICR3aXRoX2tyYi9saWIvbGlia3JiLmEiCitlbHNlCisgICAgS1JCX0xJQlM9IiRL
UkJfTElCUyAtbGtyYiIKK2ZpLAorICAgICAgICAgICAgICAgQUNfV0FSTihObyBLZXJiZXJvcyBW
NCBmb3VuZCk7IGtyYjQ9bm8sCisgICAgICAgJEtSQl9MSUJTKSwga3JiND1ubykKK2Vsc2UKK2ty
YjQ9bm8KK2ZpCisKK2lmIHRlc3QgIiR7a3JiNH0iICE9IG5vOyB0aGVuCitBQ19ERUZJTkUoSEFW
RV9LUkIsW10sW1N1cHBvcnQgZm9yIEtlcmJlcm9zP10pCiBmaQogCiBMSUJTPSIkS1JCX0xJQlMg
JExJQlMiCiAKLWlmIHRlc3QgIiRXSVRIX0FVVEgiID0gImtyYjUiOyB0aGVuCi0gICAgU0FTTF9T
RVRfR1NTQVBJX0xJQlMKLWZpCitTQVNMX1NFVF9HU1NBUElfTElCUwogCiBkbmwKIGRubCBUZXN0
IGZvciBPcGVuU1NMCg==
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="1"
              isprivate="0"
          >
            <attachid>330</attachid>
            <date>2005-02-16 10:02 EDT</date>
            <desc>patch</desc>
            <filename>patch</filename>
            <type>text/plain</type>
            <size>43362</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">SW5kZXg6IGNvbmZpZ3VyZS5pbgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9jeXJ1cy9j
b25maWd1cmUuaW4sdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMjkwCmRpZmYgLXUgLXIxLjI5MCBj
b25maWd1cmUuaW4KLS0tIGNvbmZpZ3VyZS5pbgkxOCBKYW4gMjAwNSAyMzo0NjowMCAtMDAwMAkx
LjI5MAorKysgY29uZmlndXJlLmluCTE2IEZlYiAyMDA1IDE0OjM2OjE4IC0wMDAwCkBAIC0xNTIs
MTYgKzE1Miw2IEBACiBBQ19TVUJTVChMT0NBTERFRlMpCiBBQ19GVU5DX1ZQUklOVEYKIAotZG5s
IGNoZWNrIGF1dGhvcml6YXRpb24gbWV0aG9kIGJlZm9yZSBkYXRhYmFzZXMsIHRvIGZpbmQgb3V0
Ci1kbmwgaWYgd2UgbmVlZCBhIFBUUyBkYXRhYmFzZSBvciBub3QKLUFDX0FSR19XSVRIKGF1dGgs
WyAgLS13aXRoLWF1dGg9TUVUSE9EICAgICAgdXNlIGF1dGhvcml6YXRpb24gbW9kdWxlIE1FVEhP
RAotICAgICAgICAgICAgICAgICAgICAgICAgICBNRVRIT0QgaXMgJ3VuaXgnIChkZWZhdWx0KSwg
J2tyYicsICdrcmI1Jywgb3IgJ3B0cyddLAotCVdJVEhfQVVUSD0iJHdpdGh2YWwiLCBXSVRIX0FV
VEg9InVuaXgiKQotQUNfU1VCU1QoV0lUSF9BVVRIKQotCi1BQ19NU0dfQ0hFQ0tJTkcoYXV0aG9y
aXphdGlvbiBtZXRob2QpCi1BQ19NU0dfUkVTVUxUKCRXSVRIX0FVVEgpCi0KIGRubCBmdW5jdGlv
biBmb3IgZG9pbmcgZWFjaCBvZiB0aGUgZGF0YWJhc2UgYmFja2VuZHMKIGRubCBwYXJhbWV0ZXJz
OiBiYWNrZW5kIG5hbWUsIHZhcmlhYmxlIHRvIHNldCwgd2l0aHZhbAogCkBAIC00NjMsMTA3ICs0
NTMsOTYgQEAKICMgYWxsIGF1dGhlbnRpY2F0aW9uIGdvZXMgdGhyb3VnaCBTQVNMCiAKIEFDX0FS
R19XSVRIKGFmcyxbICAtLXdpdGgtYWZzPVBBVEggICAgICAgICB1c2UgQUZTIGxpYnJhcmllcyBm
cm9tIFBBVEhdLAotCVt3aXRoX2Fmcz0iJHt3aXRodmFsfSIKLQlDRkxBR1M9IiR7Q0ZMQUdTfSAt
SSR7d2l0aHZhbH0vaW5jbHVkZSJdLHdpdGhfYWZzPSIvdXNyL2xvY2FsIikKKwl3aXRoX2Fmcz0i
JHt3aXRodmFsfSIsIHdpdGhfYWZzPSJubyIpCiAKIEFDX0FSR19XSVRIKGxkYXAsIFsgIC0td2l0
aC1sZGFwPURJUiAgICAgICAgIHVzZSBMREFQIChpbiBESVIpIChleHBlcmltZW50YWwpIFsvdXNy
L2xvY2FsXSBdLAotCXdpdGhfbGRhcD0kd2l0aHZhbCwgd2l0aF9sZGFwPSIvdXNyL2xvY2FsIikK
LQotZG5sIHNlbGVjdCBtb2R1bGUgZm9yIHB0bG9hZGVyCi1BQ19BUkdfV0lUSChwdHMsWyAgLS13
aXRoLXB0cz1NT0RVTEUgICAgICAgdXNlIFBUUyBtb2R1bGUgTU9EVUxFCi0gICAgICAgICAgICAg
ICAgICAgICAgICAgIE1PRFVMRSBpcyAnYWZza3JiJyAoZGVmYXVsdCkgb3IgJ2xkYXAnIChleHBl
cmltZW50YWwpXSwKLQkgICAgV0lUSF9QVFM9IiR3aXRodmFsIiwgV0lUSF9QVFM9ImFmc2tyYiIp
Ci1BQ19TVUJTVChXSVRIX1BUUykKKwl3aXRoX2xkYXA9IiR7d2l0aHZhbH0iLCB3aXRoX2xkYXA9
Im5vIikKIAogZG5sIHNlbGVjdCBtb2RlIG9mIGFmc3B0cwogQUNfQVJHX0VOQUJMRShrcmI1YWZz
cHRzLFsgIC0tZW5hYmxlLWtyYjVhZnNwdHMgICAgIGNvbXBpbGUgYWZza3JiIFBUUyBtb2R1bGUg
d2l0aCBrcmI1IHN1cHBvcnRdLAogCVtTQVNMX1NFVF9HU1NBUElfTElCUwogICAgICAgICAgQUNf
REVGSU5FKEFGU1BUU19VU0VfS1JCNSxbXSxbU2hvdWxkIHRoZSBBRlMgUFRTIHBsdWdpbiB1c2Ug
a3JiNT9dKV0pCiAKLWlmIHRlc3QgIiRXSVRIX0FVVEgiID0gInB0cyI7IHRoZW4KLQlBQ19NU0df
Q0hFQ0tJTkcod2hpY2ggcHRzIG1vZHVsZSB0byB1c2UpCi0JQUNfTVNHX1JFU1VMVCgkV0lUSF9Q
VFMpCitpZiB0ZXN0ICJ4JHdpdGhfYWZzIiAhPSAieG5vIjsgdGhlbgorICAgIGlmIHRlc3QgISAt
ZCAkd2l0aF9hZnM7IHRoZW4KKyAgICAgICAgJHdpdGhfYWZzPS91c3IvbG9jYWwKKyAgICBmaQor
ICAgIENGTEFHUz0iJHtDRkxBR1N9IC1JJHt3aXRoX2Fmc30vaW5jbHVkZSIKKyAgICBBRlNfTElC
Uz0iJHt3aXRoX2Fmc30vbGliL2Fmcy9saWJrYXV0aC5hICR7d2l0aF9hZnN9L2xpYi9hZnMvbGli
cHJvdC5hICAke3dpdGhfYWZzfS9saWIvYWZzL2xpYmF1dGguYSAke3dpdGhfYWZzfS9saWIvYWZz
L2xpYnN5cy5hICR7d2l0aF9hZnN9L2xpYi9saWJyeGthZC5hICR7d2l0aF9hZnN9L2xpYi9saWJy
eC5hICR7d2l0aF9hZnN9L2xpYi9hZnMvbGlic3lzLmEgJHt3aXRoX2Fmc30vbGliL2xpYnViaWsu
YSAgJHt3aXRoX2Fmc30vbGliL2xpYmx3cC5hICR7d2l0aF9hZnN9L2xpYi9hZnMvdXRpbC5hIgor
ICAgIGlmIHRlc3QgLWYgJHt3aXRoX2Fmc30vbGliL2Fmcy9saWJhdWRpdC5hOyB0aGVuCisgICAg
QUZTX0xJQlM9IiRBRlNfTElCUyAke3dpdGhfYWZzfS9saWIvYWZzL2xpYmF1ZGl0LmEiCisgICAg
ZmkKKyAgICBpZiB0ZXN0IC1mIC91c3IvdWNibGliL2xpYnVjYi5hOyB0aGVuCisgICAgQ01VX0FE
RF9MSUJQQVRIX1RPKC91c3IvdWNibGliLCBBRlNfTERGTEFHUykKKyAgICBBRlNfTElCUz0iJEFG
U19MSUJTIC1sYyAtbHVjYiIKKyAgICBmaQorCisgICAgQUNfQ0FDSEVfVkFMKGN5cnVzX2Fmc19z
aWd2ZWMsWworICAgICAgICBTQVZFX0xJQlM9IiRMSUJTIgorICAgICAgICBMSUJTPSIke3dpdGhf
YWZzfS9saWIvbGlibHdwLmEiCisgICAgICAgIEFDX01TR19DSEVDS0lORyhpZiBBRlMgbGlicmFy
aWVzIG5lZWQgc2lndmVjKQorICAgICAgICBkbmwgRG9lcyBBRlMgbmVlZCBzaWd2ZWM/ICBXZSBo
YXZlIHRvIGxpbmsgYWdhaW5zdCBsd3AgYW5kIHNlZQorICAgICAgICBkbmwgaWYgSU9NR1JfSW5p
dGlhbGl6ZSB3YW50cyBpdAorICAgICAgICBBQ19UUllfTElOSyhbSU9NR1JfSW5pdGlhbGl6ZSgp
O10sCisgICAgICAgICAgICAgICAgW0lPTUdSX0luaXRpYWxpemUoKV0sCisgICAgICAgICAgICAg
ICAgWworICAgICAgICAgICAgICAgICAgICAgICAgZG5sIGl0IGxpbmtlZDsgZG9uJ3QgbmVlZCBp
dAorICAgICAgICAgICAgICAgICAgICAgICAgQUNfTVNHX1JFU1VMVChubykKKyAgICAgICAgICAg
ICAgICAgICAgICAgIGN5cnVzX2Fmc19zaWd2ZWM9Im5vIgorICAgICAgICAgICAgICAgIF0sIFsK
KyAgICAgICAgICAgICAgICAgICAgICAgIGRubCBkaWRuJ3QgbGluazsgcGljayB1cCBzaWd2ZWMK
KyAgICAgICAgICAgICAgICAgICAgICAgIEFDX01TR19SRVNVTFQoeWVzKQorICAgICAgICAgICAg
ICAgICAgICAgICAgY3lydXNfYWZzX3NpZ3ZlYz0ieWVzIgorICAgICAgICAgICAgICAgIF0pCisg
ICAgICAgIF0pCisgICAgaWYgdGVzdCAiJGN5cnVzX2Fmc19zaWd2ZWMiID0geWVzOyB0aGVuCisg
ICAgICBpZiB0ZXN0ICIkY2FudF9maW5kX3NpZ3ZlYyIgPSB5ZXM7IHRoZW4KKyAgICAgICAgQUNf
TVNHX1dBUk4oW0Nhbid0IGZpbmQgYSBzaWd2ZWMgZm9yIEFGUyBsaWJyYXJpZXMgd2hpY2ggc2Vl
bSB0byBuZWVkIG9uZS5dKQorICAgICAgZWxzZQorICAgICAgICBBRlNfTElCUz0iJHtBRlNfTElC
U30gJGN5cnVzX3NpZ3ZlY2xpYiIKKyAgICAgICAgQUNfU1VCU1QoQUZTX0xJQlMpCisgICAgICAg
IEFDX1NVQlNUKEFGU19MREZMQUdTKQorICAgICAgICBBQ19ERUZJTkUoSEFWRV9BRlNLUkIsW10s
W1Nob3VsZCB3ZSBidWlsZCBhZnNrcmIgcHRzIG1vZHVsZT9dKQorICAgICAgZmkKKyAgICBmaQor
ICAgIExJQlM9IiRTQVZFX0xJQlMiCitmaQorCitMREFQX0NQUEZMQUdTPSIiCitMREFQX0xERkxB
R1M9IiIKK0xEQVBfTElCUz0iIgorCitpZiB0ZXN0ICJ4JHdpdGhfbGRhcCIgIT0gInhubyI7IHRo
ZW4KKyAgICBpZiB0ZXN0ICEgLWQgJHdpdGhfbGRhcDsgdGhlbgorICAgICAgICAkd2l0aF9sZGFw
PS91c3IvbG9jYWwKKyAgICBmaQorCisgICAgTERBUF9DUFBGTEFHUz0iJENQUEZMQUdTIC1JJHt3
aXRoX2xkYXB9L2luY2x1ZGUiCisgICAgTERBUF9MREZMQUdTPSIkTERGTEFHUyAtTCR7d2l0aF9s
ZGFwfS9saWIiCisgICAgTERBUF9MSUJTPSIiCisKKyAgICBzYXZlX0NQUEZMQUdTPSRDUFBGTEFH
UworICAgIHNhdmVfTERGTEFHUz0kTERGTEFHUworICAgIENQUEZMQUdTPSRMREFQX0NQUEZMQUdT
CisgICAgTERGTEFHUz0kTERBUF9MREZMQUdTCisKKyAgICBBQ19DSEVDS19MSUIobGRhcCwgbGRh
cF9pbml0aWFsaXplLCAKKyAgICAgICAgWyBBQ19ERUZJTkUoSEFWRV9MREFQLFtdLFtTaG91bGQg
d2UgYnVpbGQgbGRhcCBwdHMgbW9kdWxlP10pCisgICAgICAgICAgQUNfU1VCU1QoTERBUF9DUFBG
TEFHUykKKyAgICAgICAgICBBQ19TVUJTVChMREFQX0xERkxBR1MpCisgICAgICAgICAgQUNfU1VC
U1QoTERBUF9MSUJTKQkKKyAgICAgICAgICBMREFQX0xJQlM9Ii1sbGRhcCAtbGxiZXIiIF0sLC1s
bGJlcikKIAorICAgIENQUEZMQUdTPSRzYXZlX0NQUEZMQUdTCisgICAgTERGTEFHUz0kc2F2ZV9M
REZMQUdTCitmaQorCitpZiB0ZXN0ICJ4JHdpdGhfYWZzIiAhPSAieG5vIiAtbyAieCR3aXRoX2xk
YXAiICE9ICJ4bm8iOyB0aGVuCiAJRVhUUkFfU1VCRElSUz0iJHtFWFRSQV9TVUJESVJTfSBwdGNs
aWVudCIKIAlFWFRSQV9PVVRQVVQ9IiR7RVhUUkFfT1VUUFVUfSBwdGNsaWVudC9NYWtlZmlsZSIK
LQotCUxEQVBfQ1BQRkxBR1M9IiIKLQlMREFQX0xERkxBR1M9IiIKLQlMREFQX0xJQlM9IiIKLQot
ICAJaWYgdGVzdCAiJFdJVEhfUFRTIiA9ICJhZnNrcmIiOyB0aGVuCi0JICAgIEFGU19MSUJTPSIk
e3dpdGhfYWZzfS9saWIvYWZzL2xpYmthdXRoLmEgJHt3aXRoX2Fmc30vbGliL2Fmcy9saWJwcm90
LmEgICR7d2l0aF9hZnN9L2xpYi9hZnMvbGliYXV0aC5hICR7d2l0aF9hZnN9L2xpYi9hZnMvbGli
c3lzLmEgJHt3aXRoX2Fmc30vbGliL2xpYnJ4a2FkLmEgJHt3aXRoX2Fmc30vbGliL2xpYnJ4LmEg
JHt3aXRoX2Fmc30vbGliL2Fmcy9saWJzeXMuYSAke3dpdGhfYWZzfS9saWIvbGlidWJpay5hICAk
e3dpdGhfYWZzfS9saWIvbGlibHdwLmEgJHt3aXRoX2Fmc30vbGliL2Fmcy91dGlsLmEiCi0JICAg
IGlmIHRlc3QgLWYgJHt3aXRoX2Fmc30vbGliL2Fmcy9saWJhdWRpdC5hOyB0aGVuCi0JCUFGU19M
SUJTPSIkQUZTX0xJQlMgJHt3aXRoX2Fmc30vbGliL2Fmcy9saWJhdWRpdC5hIgotCSAgICBmaQot
CSAgICBpZiB0ZXN0IC1mIC91c3IvdWNibGliL2xpYnVjYi5hOyB0aGVuCi0JCUNNVV9BRERfTElC
UEFUSF9UTygvdXNyL3VjYmxpYiwgQUZTX0xERkxBR1MpCi0JCUFGU19MSUJTPSIkQUZTX0xJQlMg
LWxjIC1sdWNiIgotCSAgICBmaQotCi0JICAgIEFDX0NBQ0hFX1ZBTChjeXJ1c19hZnNfc2lndmVj
LFsKLQkJU0FWRV9MSUJTPSIkTElCUyIKLQkJTElCUz0iJHt3aXRoX2Fmc30vbGliL2xpYmx3cC5h
IgotCQlBQ19NU0dfQ0hFQ0tJTkcoaWYgQUZTIGxpYnJhcmllcyBuZWVkIHNpZ3ZlYykKLQkJZG5s
IERvZXMgQUZTIG5lZWQgc2lndmVjPyAgV2UgaGF2ZSB0byBsaW5rIGFnYWluc3QgbHdwIGFuZCBz
ZWUKLQkJZG5sIGlmIElPTUdSX0luaXRpYWxpemUgd2FudHMgaXQKLQkJQUNfVFJZX0xJTksoW0lP
TUdSX0luaXRpYWxpemUoKTtdLAotCQkJW0lPTUdSX0luaXRpYWxpemUoKV0sCi0JCQlbCi0JCQkJ
ZG5sIGl0IGxpbmtlZDsgZG9uJ3QgbmVlZCBpdAotCQkJCUFDX01TR19SRVNVTFQobm8pCi0JCQkJ
Y3lydXNfYWZzX3NpZ3ZlYz0ibm8iCi0JCQldLCBbCi0JCQkJZG5sIGRpZG4ndCBsaW5rOyBwaWNr
IHVwIHNpZ3ZlYwotCQkJCUFDX01TR19SRVNVTFQoeWVzKQotCQkJCWN5cnVzX2Fmc19zaWd2ZWM9
InllcyIKLQkJCV0pCi0JCV0pCi0JICAgIGlmIHRlc3QgIiRjeXJ1c19hZnNfc2lndmVjIiA9IHll
czsgdGhlbgotCSAgICAgIGlmIHRlc3QgIiRjYW50X2ZpbmRfc2lndmVjIiA9IHllczsgdGhlbgot
ICAgICAgICAgICAgICAgIEFDX01TR19XQVJOKFtDYW4ndCBmaW5kIGEgc2lndmVjIGZvciBBRlMg
bGlicmFyaWVzIHdoaWNoIHNlZW1dKQotCSAgICAgICAgQUNfTVNHX1dBUk4oW3RvIG5lZWQgb25l
OyBwdGxvYWRlciBtYXkgbm90IGJ1aWxkLl0pCi0gICAgICAgICAgICAgIGVsc2UKLQkgICAgICAg
IEFGU19MSUJTPSIke0FGU19MSUJTfSAkY3lydXNfc2lndmVjbGliIgotCSAgICAgIGZpCi0JICAg
IGZpCi0JICAgIExJQlM9IiRTQVZFX0xJQlMiCi0JICAgIEFDX1NVQlNUKEFGU19MSUJTKQotCSAg
ICBBQ19TVUJTVChBRlNfTERGTEFHUykKLQllbGlmIHRlc3QgIiRXSVRIX1BUUyIgPSAibGRhcCI7
IHRoZW4KLQkgICAgQUNfTVNHX1dBUk4oWyoqKiBXQVJOSU5HOiBDT01QSUxJTkcgV0lUSCBFWFBF
UklNRU5UQUwgTERBUCBQVExPQURFUiBNT0RVTEUgKioqXSkKLQkgICAgaWYgdGVzdCAtZCAkd2l0
aF9sZGFwOyB0aGVuCi0JICAgICAgICBMREFQX0NQUEZMQUdTPSIkQ1BQRkxBR1MgLUkke3dpdGhf
bGRhcH0vaW5jbHVkZSIKLQkgICAgICAgIExEQVBfTERGTEFHUz0iJExERkxBR1MgLUwke3dpdGhf
bGRhcH0vbGliIgotCSAgICBlbHNlCi0JIAlBQ19FUlJPUihMREFQIHBhdGggaXNuJ3QgYSBkaXJl
Y3RvcnkpCi0JICAgIGZpCQotCi0JICAgIExEQVBfTElCUz0iIgotCi0gICAgICAgICAgIHNhdmVf
Q1BQRkxBR1M9JENQUEZMQUdTCi0gICAgICAgICAgIHNhdmVfTERGTEFHUz0kTERGTEFHUwotICAg
ICAgICAgICBDUFBGTEFHUz0kTERBUF9DUFBGTEFHUwotICAgICAgICAgICBMREZMQUdTPSRMREFQ
X0xERkxBR1MKLQotCSAgICBBQ19DSEVDS19MSUIobGRhcCwgbGRhcF9pbml0aWFsaXplLCBbCi0g
ICAgICAgICAgICAgICAgICAgICAgICAgTERBUF9MSUJTPSItbGxkYXAgLWxsYmVyIiBdLCwtbGxi
ZXIpCi0KLSAgICAgICAgICAgQ1BQRkxBR1M9JHNhdmVfQ1BQRkxBR1MKLSAgICAgICAgICAgTERG
TEFHUz0kc2F2ZV9MREZMQUdTCi0JZWxzZQotCSAgICBBQ19FUlJPUih1bmtub3duIHdpdGgtcHRz
IHZhbHVlKQotCWZpCi0KLSAgIAlBQ19TVUJTVChMREFQX0NQUEZMQUdTKQotCUFDX1NVQlNUKExE
QVBfTERGTEFHUykKLQlBQ19TVUJTVChMREFQX0xJQlMpCQotCiAJQUNfREVGSU5FKFdJVEhfUFRT
LFtdLFtCdWlsZCBpbiBQVFMgc3VwcG9ydD9dKQogZmkKIAotCi0KIFNFUlZFUl9TVUJESVJTPSJt
YXN0ZXIgaW1hcCIKIEFDX0FSR19FTkFCTEUoc2VydmVyLAogCVsgIC0tZGlzYWJsZS1zZXJ2ZXIg
ICAgICAgIGRpc2FibGUgY29tcGlsaW5nIHNlcnZlcnNdLApAQCAtNTg1LDgyICs1NjQsNzYgQEAK
IAkJWyAgLS1lbmFibGUtc3RhdGlja3JiICAgICAgbGluayBLZXJiZXJvcyBzdGF0aWNhbGx5XSwK
IAl3aXRoX3N0YXRpY2tyYj0ieWVzIiwgd2l0aF9zdGF0aWNrcmI9Im5vIikKIAotaWYgdGVzdCAi
JFdJVEhfQVVUSCIgPSAia3JiIiAtbyAiJFdJVEhfQVVUSCIgPSAia3JiX3B0cyIgLW8gIiR3aXRo
X2tyYiIgIT0gIm5vIjsgdGhlbgotICBkbmwgSW4gb3JkZXIgdG8gY29tcGlsZSBrZXJiZXJvczQs
IHdlIG5lZWQgbGlia3JiIGFuZCBsaWJkZXMuCitkbmwgSW4gb3JkZXIgdG8gY29tcGlsZSBrZXJi
ZXJvczQsIHdlIG5lZWQgbGlia3JiIGFuZCBsaWJkZXMuCiAKLSAgZG5sIHdlIG1pZ2h0IG5lZWQg
LWxyZXNvbHYgZm9yIGtlcmJlcm9zCi0gIEFDX0NIRUNLX0xJQihyZXNvbHYscmVzX3NlYXJjaCkK
K2RubCB3ZSBtaWdodCBuZWVkIC1scmVzb2x2IGZvciBrZXJiZXJvcworQUNfQ0hFQ0tfTElCKHJl
c29sdixyZXNfc2VhcmNoKQogCi0gIGlmIHRlc3QgIiR3aXRoX3N0YXRpY2tyYiIgPSAieWVzIiAt
YSAhIC1kICIkd2l0aF9rcmIiOyB0aGVuCi0JQUNfTVNHX0VSUk9SKFstLWVuYWJsZS1zdGF0aWNr
cmIgc3BlY2lmaWVkIGJ1dCAtLXdpdGgta3JiIGRpZCBub3Qgc3BlY2lmeSBhIHZhbGlkIGRpcmVj
dG9yeV0pCi0gIGZpIAotCi0gIGRubCBEbyB3ZSBuZWVkIERFUyBmb3Iga2VyYmVyb3M/Ci0gIEFD
X0FSR19XSVRIKGtyYmRlcyxbICAtLXdpdGgta3JiZGVzICAgICAgICAgICB1c2UgS2VyYmVyb3Mg
REVTIGltcGxlbWVudGF0aW9uIFtbeWVzXV1dLAotCXdpdGhfa3JiZGVzPSIkd2l0aHZhbCIsIHdp
dGhfa3JiZGVzPSJ5ZXMiKQotICBpZiB0ZXN0ICIkd2l0aF9rcmJkZXMiID0gInllcyI7IHRoZW4K
LSAgICBBQ19DSEVDS19MSUIoZGVzLGRlc19lY2JfZW5jcnlwdCwKLQlpZiB0ZXN0ICIkd2l0aF9z
dGF0aWNrcmIiID0gInllcyI7IHRoZW4KLQkgICAgS1JCX0xJQlM9IiR3aXRoX2tyYi9saWIvbGli
ZGVzLmEiCi0JZWxzZQotCSAgICBLUkJfTElCUz0iLWxkZXMiCi0JZmksCi0gICAgQUNfTVNHX0VS
Uk9SKFtUaGUgS2VyYmVyb3MgREVTIGxpYnJhcnkgaXMgcmVxdWlyZWQgZm9yIEtlcmJlcm9zIHN1
cHBvcnQuICBZb3UgbWlnaHQgd2FudCAtLXdpdGgtYXV0aD11bml4Ll0pKQotICBmaQotCi0gIGRu
bCBpZiB3ZSB3ZXJlIGFtYml0aW91cywgd2UnZCBsb29rIG1vcmUgYWdncmVzc2l2ZWx5IGZvciB0
aGUKLSAgZG5sIGtyYjQgaW5zdGFsbAotICBpZiB0ZXN0IC1kICR7d2l0aF9rcmJ9OyB0aGVuCi0g
ICAgIEFDX0NBQ0hFX0NIRUNLKGZvciBLZXJiZXJvcyBpbmNsdWRlcywgY3lydXNfa3JiaW5jbHVk
ZSwgWwotICAgICAgIGZvciBrcmJobG9jIGluIGluY2x1ZGUva2VyYmVyb3NJViBpbmNsdWRlCi0g
ICAgICAgZG8KLSAgICAgICAgIGlmIHRlc3QgLWYgJHt3aXRoX2tyYn0vJHtrcmJobG9jfS9rcmIu
aCA7IHRoZW4KLSAgICAgICAgICAgY3lydXNfa3JiaW5jbHVkZT0ke3dpdGhfa3JifS8ke2tyYmhs
b2N9Ci0gICAgICAgICAgIGJyZWFrCi0gICAgICAgICBmaQotICAgICAgIGRvbmUKLSAgICAgICBd
KQotCi0gICAgIGlmIHRlc3QgLW4gIiR7Y3lydXNfa3JiaW5jbHVkZX0iOyB0aGVuCi0gICAgICAg
Q1BQRkxBR1M9IiRDUFBGTEFHUyAtSSR7Y3lydXNfa3JiaW5jbHVkZX0iCi0gICAgIGZpCi0gICAg
IENNVV9BRERfTElCUEFUSCgke3dpdGhfa3JifS9saWIpCi0gIGZpCitpZiB0ZXN0ICIkd2l0aF9z
dGF0aWNrcmIiID0gInllcyIgLWEgISAtZCAiJHdpdGhfa3JiIjsgdGhlbgorICAgICAgQUNfTVNH
X0VSUk9SKFstLWVuYWJsZS1zdGF0aWNrcmIgc3BlY2lmaWVkIGJ1dCAtLXdpdGgta3JiIGRpZCBu
b3Qgc3BlY2lmeSBhIHZhbGlkIGRpcmVjdG9yeV0pCitmaSAKKworZG5sIERvIHdlIG5lZWQgREVT
IGZvciBrZXJiZXJvcz8KK0FDX0FSR19XSVRIKGtyYmRlcyxbICAtLXdpdGgta3JiZGVzICAgICAg
ICAgICB1c2UgS2VyYmVyb3MgREVTIGltcGxlbWVudGF0aW9uIFtbeWVzXV1dLAorICAgICAgd2l0
aF9rcmJkZXM9IiR3aXRodmFsIiwgd2l0aF9rcmJkZXM9InllcyIpCitpZiB0ZXN0ICIkd2l0aF9r
cmJkZXMiID0gInllcyI7IHRoZW4KKyAgQUNfQ0hFQ0tfTElCKGRlcyxkZXNfZWNiX2VuY3J5cHQs
CisgICAgICBpZiB0ZXN0ICIkd2l0aF9zdGF0aWNrcmIiID0gInllcyI7IHRoZW4KKyAgICAgICAg
ICBLUkJfTElCUz0iJHdpdGhfa3JiL2xpYi9saWJkZXMuYSIKKyAgICAgIGVsc2UKKyAgICAgICAg
ICBLUkJfTElCUz0iLWxkZXMiCisgICAgICBmaSwKKyAgQUNfTVNHX0VSUk9SKFtUaGUgS2VyYmVy
b3MgREVTIGxpYnJhcnkgaXMgcmVxdWlyZWQgZm9yIEtlcmJlcm9zIHN1cHBvcnQuICBZb3UgbWln
aHQgd2FudCAtLXdpdGgtYXV0aD11bml4Ll0pKQorZmkKKworZG5sIGlmIHdlIHdlcmUgYW1iaXRp
b3VzLCB3ZSdkIGxvb2sgbW9yZSBhZ2dyZXNzaXZlbHkgZm9yIHRoZQorZG5sIGtyYjQgaW5zdGFs
bAoraWYgdGVzdCAtZCAke3dpdGhfa3JifTsgdGhlbgorICAgQUNfQ0FDSEVfQ0hFQ0soZm9yIEtl
cmJlcm9zIGluY2x1ZGVzLCBjeXJ1c19rcmJpbmNsdWRlLCBbCisgICAgIGZvciBrcmJobG9jIGlu
IGluY2x1ZGUva2VyYmVyb3NJViBpbmNsdWRlCisgICAgIGRvCisgICAgICAgaWYgdGVzdCAtZiAk
e3dpdGhfa3JifS8ke2tyYmhsb2N9L2tyYi5oIDsgdGhlbgorICAgICAgICAgY3lydXNfa3JiaW5j
bHVkZT0ke3dpdGhfa3JifS8ke2tyYmhsb2N9CisgICAgICAgICBicmVhaworICAgICAgIGZpCisg
ICAgIGRvbmUKKyAgICAgXSkKKworICAgaWYgdGVzdCAtbiAiJHtjeXJ1c19rcmJpbmNsdWRlfSI7
IHRoZW4KKyAgICAgQ1BQRkxBR1M9IiRDUFBGTEFHUyAtSSR7Y3lydXNfa3JiaW5jbHVkZX0iCisg
ICBmaQorICAgQ01VX0FERF9MSUJQQVRIKCR7d2l0aF9rcmJ9L2xpYikKK2ZpCiAKLSAgaWYgdGVz
dCAiJHdpdGhfa3JiaW1wbCIgIT0gImt0aCI7IHRoZW4KLSAgICBLUkJMSUI9ImtyYjQiCi0gIGVs
c2UKLSAgICBLUkJMSUI9ImtyYiIKLSAgZmkKK2lmIHRlc3QgIiR3aXRoX2tyYmltcGwiICE9ICJr
dGgiOyB0aGVuCisgIEtSQkxJQj0ia3JiNCIKK2Vsc2UKKyAgS1JCTElCPSJrcmIiCitmaQogCi0g
IGlmIHRlc3QgIiR3aXRoX2RlcyIgIT0gbm87IHRoZW4KLSAgICBBQ19DSEVDS19IRUFERVIoa3Ji
LmgsCi0gICAgICBBQ19DSEVDS19MSUIoJHtLUkJMSUJ9LCBrcmJfbWtfcHJpdiwKLQlpZiB0ZXN0
ICIkd2l0aF9zdGF0aWNrcmIiID0gInllcyI7IHRoZW4KLQkgICAgS1JCX0xJQlM9IiRLUkJfTElC
UyAkd2l0aF9rcmIvbGliL2xpYiR7S1JCTElCfS5hIgotCWVsc2UKLQkgICAgS1JCX0xJQlM9IiRL
UkJfTElCUyAtbCR7S1JCTElCfSIKLQlmaSwKLSAgICAgICAgICAgICAgICAgICBBQ19XQVJOKE5v
IEtlcmJlcm9zIFY0IGZvdW5kKTsga3JiND1ubywKLQkJICAgJEtSQl9MSUJTKSwKLSAgICAgIEFD
X1dBUk4oTm8gS2VyYmVyb3MgVjQgZm91bmQpOyBrcmI0PW5vKQotICBlbHNlCi0gICAgQUNfV0FS
TihObyBERVMgbGlicmFyeSBmb3VuZCBmb3IgS2VyYmVyb3MgVjQgc3VwcG9ydCkKLSAgICBrcmI0
PW5vCi0gIGZpCitpZiB0ZXN0ICIkd2l0aF9kZXMiICE9IG5vOyB0aGVuCisgIEFDX0NIRUNLX0hF
QURFUihrcmIuaCwKKyAgICBBQ19DSEVDS19MSUIoJHtLUkJMSUJ9LCBrcmJfbWtfcHJpdiwKKyAg
ICAgIGlmIHRlc3QgIiR3aXRoX3N0YXRpY2tyYiIgPSAieWVzIjsgdGhlbgorICAgICAgICAgIEtS
Ql9MSUJTPSIkS1JCX0xJQlMgJHdpdGhfa3JiL2xpYi9saWIke0tSQkxJQn0uYSIKKyAgICAgIGVs
c2UKKyAgICAgICAgICBLUkJfTElCUz0iJEtSQl9MSUJTIC1sJHtLUkJMSUJ9IgorICAgICAgZmks
CisgICAgICAgICAgICAgICAgIEFDX1dBUk4oTm8gS2VyYmVyb3MgVjQgZm91bmQpOyBrcmI0PW5v
LAorICAgICAgCSAgICRLUkJfTElCUyksCisgICAgQUNfV0FSTihObyBLZXJiZXJvcyBWNCBmb3Vu
ZCk7IGtyYjQ9bm8pCitlbHNlCisgIEFDX1dBUk4oTm8gREVTIGxpYnJhcnkgZm91bmQgZm9yIEtl
cmJlcm9zIFY0IHN1cHBvcnQpCisgIGtyYjQ9bm8KK2ZpCiAKLSAgaWYgdGVzdCAiJHtrcmI0fSIg
IT0gbm87IHRoZW4KLSAgICBBQ19ERUZJTkUoSEFWRV9LUkIsW10sW1N1cHBvcnQgZm9yIEtlcmJl
cm9zP10pCi0gIGVsc2UKLSAgICBBQ19FUlJPUihbS2VyYmVyb3Mgbm90IGZvdW5kIGZvciBhdXRo
b3JpemF0aW9uIG1vZHVsZV0pCi0gIGZpCitpZiB0ZXN0ICIke2tyYjR9IiAhPSBubzsgdGhlbgor
ICBBQ19ERUZJTkUoSEFWRV9LUkIsW10sW1N1cHBvcnQgZm9yIEtlcmJlcm9zP10pCiBmaQogCiBM
SUJTPSIkS1JCX0xJQlMgJExJQlMiCiAKLWlmIHRlc3QgIiRXSVRIX0FVVEgiID0gImtyYjUiOyB0
aGVuCi0gICAgU0FTTF9TRVRfR1NTQVBJX0xJQlMKLWZpCitTQVNMX1NFVF9HU1NBUElfTElCUwog
CiBkbmwKIGRubCBUZXN0IGZvciBPcGVuU1NMCkluZGV4OiBNYWtlZmlsZS5pbgo9PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
ClJDUyBmaWxlOiAvY3ZzL3NyYy9jeXJ1cy9wdGNsaWVudC9NYWtlZmlsZS5pbix2CnJldHJpZXZp
bmcgcmV2aXNpb24gMS4yNwpkaWZmIC11IC1yMS4yNyBNYWtlZmlsZS5pbgotLS0gTWFrZWZpbGUu
aW4JMjggTWF5IDIwMDQgMTg6MDM6MDggLTAwMDAJMS4yNworKysgTWFrZWZpbGUuaW4JMTYgRmVi
IDIwMDUgMTQ6Mzc6NDYgLTAwMDAKQEAgLTk2LDExICs5NiwxMSBAQAogLmMubzoKIAkkKENDKSAt
YyAkKENQUEZMQUdTKSAkKExEQVBfQ1BQRkxBR1MpICQoREVGUykgJChDRkxBR1MpICQ8CiAKLXB0
bG9hZGVyOiBwdGxvYWRlci5vIEBXSVRIX1BUU0AubyAuLi9pbWFwL211dGV4X2Zha2UubyAkKERF
UExJQlMpCi0JJChDQykgJChMREZMQUdTKSAtbyAkQCBwdGxvYWRlci5vIEBXSVRIX1BUU0AubyAu
Li9pbWFwL211dGV4X2Zha2UubyAkKFNFUlZJQ0VUSFJFQUQpICR7QUZTX0xERkxBR1N9ICR7TERB
UF9MREZMQUdTfSAkKEFGU19MSUJTKSAke0xEQVBfTElCU30gJChERVBMSUJTKSAkKExJQl9TQVNM
KSAkKExJQlMpICQoTElCX1dSQVApICQoTElCX1JUKQorcHRsb2FkZXI6IHB0bG9hZGVyLm8gYWZz
a3JiLm8gbGRhcC5vIC4uL2ltYXAvbXV0ZXhfZmFrZS5vICQoREVQTElCUykKKwkkKENDKSAkKExE
RkxBR1MpIC1vICRAIHB0bG9hZGVyLm8gYWZza3JiLm8gbGRhcC5vIC4uL2ltYXAvbXV0ZXhfZmFr
ZS5vICQoU0VSVklDRVRIUkVBRCkgJHtBRlNfTERGTEFHU30gJHtMREFQX0xERkxBR1N9ICQoQUZT
X0xJQlMpICR7TERBUF9MSUJTfSAkKERFUExJQlMpICQoTElCX1NBU0wpICQoTElCUykgJChMSUJf
V1JBUCkgJChMSUJfUlQpCiAKLXB0bG9hZGVyLnB1cmU6IHB0bG9hZGVyLm8gQFdJVEhfUFRTQC5v
IC4uL2ltYXAvbXV0ZXhfZmFrZS5vICQoREVQTElCUykKLQkkKFBVUklGWSkgJChQVVJFQVJHUykg
JChDQykgJChMREZMQUdTKSAtbyAkQCBwdGxvYWRlci5vIEBXSVRIX1BUU0AubyAuLi9pbWFwL211
dGV4X2Zha2UubyAkKFNFUlZJQ0VUSFJFQUQpICR7QUZTX0xERkxBR1N9ICR7TERBUF9MREZMQUdT
fSAkKEFGU19MSUJTKSAke0xEQVBfTElCU30gJChERVBMSUJTKSAkKExJQl9TQVNMKSAkKExJQlMp
ICQoTElCX1dSQVApICQoTElCX1JUKQorcHRsb2FkZXIucHVyZTogcHRsb2FkZXIubyBhZnNrcmIu
byBsZGFwLm8gLi4vaW1hcC9tdXRleF9mYWtlLm8gJChERVBMSUJTKQorCSQoUFVSSUZZKSAkKFBV
UkVBUkdTKSAkKENDKSAkKExERkxBR1MpIC1vICRAIHB0bG9hZGVyLm8gYWZza3JiLm8gbGRhcC5v
IC4uL2ltYXAvbXV0ZXhfZmFrZS5vICQoU0VSVklDRVRIUkVBRCkgJHtBRlNfTERGTEFHU30gJHtM
REFQX0xERkxBR1N9ICQoQUZTX0xJQlMpICR7TERBUF9MSUJTfSAkKERFUExJQlMpICQoTElCX1NB
U0wpICQoTElCUykgJChMSUJfV1JBUCkgJChMSUJfUlQpCiAKIHB0ZXhwaXJlOiBwdGV4cGlyZS5v
ICQoREVQTElCUykgJChVVElMX0xJQlMpCiAJJChDQykgJChMREZMQUdTKSAtbyAkQCBwdGV4cGly
ZS5vICQoVVRJTF9MSUJTKSAkKERFUExJQlMpICQoTElCX1NBU0wpICQoTElCUykgJChMSUJfUlQp
CkluZGV4OiBhZnNrcmIuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9jeXJ1cy9wdGNs
aWVudC9hZnNrcmIuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xMApkaWZmIC11IC1yMS4xMCBh
ZnNrcmIuYwotLS0gYWZza3JiLmMJMTkgSmFuIDIwMDUgMDc6MzU6NDUgLTAwMDAJMS4xMAorKysg
YWZza3JiLmMJMTYgRmViIDIwMDUgMTQ6Mzg6MTEgLTAwMDAKQEAgLTQ0LDYgKzQ0LDEwIEBACiAg
ICAgICAiJElkOiBhZnNrcmIuYyx2IDEuMTAgMjAwNS8wMS8xOSAwNzozNTo0NSBzaGFkb3cgRXhw
ICQiOwogCiAjaW5jbHVkZSA8Y29uZmlnLmg+CisjaW5jbHVkZSAicHRsb2FkZXIuaCIKKyNpbmNs
dWRlICJleGl0Y29kZXMuaCIKKworI2lmZGVmIEhBVkVfQUZTS1JCCiAKICNpbmNsdWRlIDxzdHJp
bmcuaD4KICNpbmNsdWRlIDxzdGRpby5oPgpAQCAtNjQsNyArNjgsNiBAQAogI2VuZGlmCiAKICNp
bmNsdWRlICJhdXRoX3B0cy5oIgotI2luY2x1ZGUgImV4aXRjb2Rlcy5oIgogI2luY2x1ZGUgImxp
YmNvbmZpZy5oIgogI2luY2x1ZGUgInN0cmhhc2guaCIKICNpbmNsdWRlICJ4bWFsbG9jLmgiCkBA
IC00MjEsOSArNDI0LDggQEAKICNlbmRpZiAvKiBBRlNQVFNfVVNFX0tSQjUgKi8KIAogLyogQVBJ
ICovCi1jb25zdCBjaGFyICpwdHNtb2R1bGVfbmFtZSA9ICJhZnNrcmIiOwogCi12b2lkIHB0c21v
ZHVsZV9pbml0KHZvaWQpIAorc3RhdGljIHZvaWQgbXlpbml0KHZvaWQpIAogewogICAgIGludCBy
ID0gcHJfSW5pdGlhbGl6ZSAoMUwsIEFGU0NPTkZfQ0xJRU5UTkFNRSwgY29uZmlnX2dldHN0cmlu
ZyhJTUFQT1BUX0FGU1BUU19NWUNFTEwpKTsKICAgICBpZiAocikgewpAQCAtNDM2LDcgKzQzOCw3
IEBACiAgICAgcmV0dXJuOwogfQogCi1zdHJ1Y3QgYXV0aF9zdGF0ZSAqcHRzbW9kdWxlX21ha2Vf
YXV0aHN0YXRlKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIsCitzdGF0aWMgc3RydWN0IGF1dGhfc3Rh
dGUgKm15YXV0aHN0YXRlKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIsCiAJCQkJCSAgICBzaXplX3Qg
c2l6ZSwKIAkJCQkJICAgIGNvbnN0IGNoYXIgKipyZXBseSwgaW50ICpkc2l6ZSkgCiB7CkBAIC01
MDgsMyArNTEwLDI5IEBACiAKICAgICByZXR1cm4gbmV3c3RhdGU7CiB9CisKKyNlbHNlIC8qIEhB
VkVfQUZTS1JCICovCisKK3N0YXRpYyB2b2lkIG15aW5pdCh2b2lkKQoreworCWZhdGFsKCJQVFMg
bW9kdWxlIChhZnNrcmIpIG5vdCBjb21waWxlZCBpbiIsIEVDX0NPTkZJRyk7Cit9CisKK3N0YXRp
YyBzdHJ1Y3QgYXV0aF9zdGF0ZSAqbXlhdXRoc3RhdGUoCisgICAgY29uc3QgY2hhciAqaWRlbnRp
ZmllciBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwKKyAgICBzaXplX3Qgc2l6ZSBfX2F0dHJpYnV0
ZV9fKCh1bnVzZWQpKSwKKyAgICBjb25zdCBjaGFyICoqcmVwbHkgX19hdHRyaWJ1dGVfXygodW51
c2VkKSksIAorICAgIGludCAqZHNpemUgX19hdHRyaWJ1dGVfXygodW51c2VkKSkpIAoreworCWZh
dGFsKCJQVFMgbW9kdWxlIChhZnNrcmIpIG5vdCBjb21waWxlZCBpbiIsIEVDX0NPTkZJRyk7Cit9
CisKKyNlbmRpZiAvKiBIQVZFX0FGU0tSQiAqLworCitzdHJ1Y3QgcHRzX21vZHVsZSBwdHNfYWZz
a3JiID0gCit7CisgICAgImFmc2tyYiIsCQkvKiBuYW1lICovCisKKyAgICAmbXlpbml0LAorICAg
ICZteWF1dGhzdGF0ZSwKK307CkluZGV4OiBsZGFwLmMKPT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2
cy9zcmMvY3lydXMvcHRjbGllbnQvbGRhcC5jLHYKcmV0cmlldmluZyByZXZpc2lvbiAxLjcKZGlm
ZiAtdSAtcjEuNyBsZGFwLmMKLS0tIGxkYXAuYwkyNCBKdW4gMjAwNCAxOToyODozOSAtMDAwMAkx
LjcKKysrIGxkYXAuYwkxNiBGZWIgMjAwNSAxNDozODoxNiAtMDAwMApAQCAtNDQsNiArNDQsMTAg
QEAKICAgICAgICIkSWQ6IGxkYXAuYyx2IDEuNyAyMDA0LzA2LzI0IDE5OjI4OjM5IHJqczMgRXhw
ICQiOwogCiAjaW5jbHVkZSA8Y29uZmlnLmg+CisjaW5jbHVkZSAicHRsb2FkZXIuaCIKKyNpbmNs
dWRlICJleGl0Y29kZXMuaCIKKworI2lmZGVmIEhBVkVfTERBUAogCiAjaW5jbHVkZSA8c3RyaW5n
Lmg+CiAjaW5jbHVkZSA8c3RkaW8uaD4KQEAgLTY4LDcgKzcyLDYgQEAKIAogLyogbGliY3lydXMg
Ki8KICNpbmNsdWRlICJhdXRoX3B0cy5oIgotI2luY2x1ZGUgImV4aXRjb2Rlcy5oIgogI2luY2x1
ZGUgInN0cmhhc2guaCIKICNpbmNsdWRlICJ4bWFsbG9jLmgiCiAKQEAgLTQyNSw5ICs0MjgsOCBA
QAogfQogCiAvKiBBUEkgKi8KLWNvbnN0IGNoYXIgKnB0c21vZHVsZV9uYW1lID0gImxkYXAiOwog
Ci12b2lkIHB0c21vZHVsZV9pbml0KHZvaWQpIAorc3RhdGljIHZvaWQgbXlpbml0KHZvaWQpIAog
ewogICAgIGNvbnN0IGNoYXIgKnAgPSBOVUxMOwogCkBAIC01ODYsNyArNTg4LDcgQEAKIHsKIAlj
aGFyICpzLCAqczE7CiAJY2hhciAqbGFzdHM7Ci0JaW50IG50LCBpOworCWludCBudCwgaSwgcmM7
CiAKIAkqcmVzdWx0ID0gTlVMTDsKIApAQCAtNjExLDggKzYxMywxMiBAQAogCXdoaWxlKHMxKSB7
CiAJCWlmIChpID09IDApIHsKIAkJCSpyZXN1bHQgPSBzdHJkdXAoczEpOworCQkJaWYgKCpyZXN1
bHQgIT0gTlVMTCkKKwkJCQlyYyA9IHB0c21vZHVsZV9lc2NhcGUoczEsIHN0cmxlbihzMSksIHJl
c3VsdCk7CisJCQllbHNlCisJCQkJcmMgPSBQVFNNX05PTUVNOwogCQkJZnJlZShzKTsKLQkJCXJl
dHVybiAoKnJlc3VsdCA9PSBOVUxMID8gUFRTTV9OT01FTSA6IFBUU01fT0spOworCQkJcmV0dXJu
IHJjOwogCQl9CiAJCXMxID0gKGNoYXIgKilzdHJ0b2tfcihOVUxMLCAiLiIsICZsYXN0cyk7CiAJ
CWktLTsKQEAgLTc4MywxNCArNzg5LDEzIEBACiAgICAgTERBUENvbnRyb2wgYzsKICAgICBMREFQ
Q29udHJvbCAqY3RybFsyXTsKICAgICBjaGFyICphdXRoemlkOwotI2Vsc2UKKyNlbmRpZgogICAg
IGNoYXIgKmJhc2UgPSBOVUxMLCAqZmlsdGVyID0gTlVMTDsKICAgICBjaGFyICphdHRyc1tdID0g
e05VTEx9OwogICAgIExEQVBNZXNzYWdlICpyZXM7CiAgICAgTERBUE1lc3NhZ2UgKmVudHJ5Owog
ICAgIGNoYXIgKmF0dHIsICoqdmFsczsKICAgICBCZXJFbGVtZW50ICpiZXI7Ci0jZW5kaWYKIAog
ICAgICpyZXQgPSBOVUxMOwogCkBAIC03OTksNjQgKzgwNCw2OCBAQAogCiAjaWYgTERBUF9WRU5E
T1JfVkVSU0lPTiA+PSAyMDEyNQogCi0gICAgYXV0aHppZCA9IHhtYWxsb2Moc2l6ZSArIHNpemVv
ZigidToiKSk7Ci0gICAgaWYgKGF1dGh6aWQgPT0gTlVMTCkKLSAgICAgICAgcmV0dXJuIFBUU01f
Tk9NRU07Ci0KLSAgICBzdHJjcHkoYXV0aHppZCwgInU6Iik7Ci0gICAgc3RyY3B5KGF1dGh6aWQr
MiwgY2Fub25faWQpOwotICAgIGMubGRjdGxfb2lkID0gTERBUF9DT05UUk9MX1BST1hZX0FVVEha
OwotICAgIGMubGRjdGxfdmFsdWUuYnZfdmFsID0gYXV0aHppZDsKLSAgICBjLmxkY3RsX3ZhbHVl
LmJ2X2xlbiA9IHNpemUgKyAyOwotICAgIGMubGRjdGxfaXNjcml0aWNhbCA9IDE7Ci0KLSAgICBj
dHJsWzBdID0gJmM7Ci0gICAgY3RybFsxXSA9IE5VTEw7Ci0gICAgcmMgPSBsZGFwX3dob2FtaV9z
KHB0c20tPmxkLCAmZG4sIGN0cmwsIE5VTEwpOwotICAgIGZyZWUoYXV0aHppZCk7Ci0gICAgaWYg
KCByYyAhPSBMREFQX1NVQ0NFU1MgfHwgIWRuICkgewotICAgICAgICBpZiAocmMgPT0gTERBUF9T
RVJWRVJfRE9XTikgewotICAgICAgICAgICAgbGRhcF91bmJpbmQocHRzbS0+bGQpOwotICAgICAg
ICAgICAgcHRzbS0+bGQgPSBOVUxMOwotICAgICAgICAgICAgcmV0dXJuIFBUU01fUkVUUlk7Cisg
ICAgaWYgKHB0c20tPnNhc2wpIHsKKworICAgICAgICBhdXRoemlkID0geG1hbGxvYyhzaXplICsg
c2l6ZW9mKCJ1OiIpKTsKKyAgICAgICAgaWYgKGF1dGh6aWQgPT0gTlVMTCkKKyAgICAgICAgICAg
IHJldHVybiBQVFNNX05PTUVNOworCisgICAgICAgIHN0cmNweShhdXRoemlkLCAidToiKTsKKyAg
ICAgICAgc3RyY3B5KGF1dGh6aWQrMiwgY2Fub25faWQpOworICAgICAgICBjLmxkY3RsX29pZCA9
IExEQVBfQ09OVFJPTF9QUk9YWV9BVVRIWjsKKyAgICAgICAgYy5sZGN0bF92YWx1ZS5idl92YWwg
PSBhdXRoemlkOworICAgICAgICBjLmxkY3RsX3ZhbHVlLmJ2X2xlbiA9IHNpemUgKyAyOworICAg
ICAgICBjLmxkY3RsX2lzY3JpdGljYWwgPSAxOworCisgICAgICAgIGN0cmxbMF0gPSAmYzsKKyAg
ICAgICAgY3RybFsxXSA9IE5VTEw7CisgICAgICAgIHJjID0gbGRhcF93aG9hbWlfcyhwdHNtLT5s
ZCwgJmRuLCBjdHJsLCBOVUxMKTsKKyAgICAgICAgZnJlZShhdXRoemlkKTsKKyAgICAgICAgaWYg
KCByYyAhPSBMREFQX1NVQ0NFU1MgfHwgIWRuICkgeworICAgICAgICAgICAgaWYgKHJjID09IExE
QVBfU0VSVkVSX0RPV04pIHsKKyAgICAgICAgICAgICAgICBsZGFwX3VuYmluZChwdHNtLT5sZCk7
CisgICAgICAgICAgICAgICAgcHRzbS0+bGQgPSBOVUxMOworICAgICAgICAgICAgICAgIHJldHVy
biBQVFNNX1JFVFJZOworICAgICAgICAgICAgfQorICAgICAgICAgICAgcmV0dXJuIFBUU01fRkFJ
TDsKICAgICAgICAgfQotICAgICAgICByZXR1cm4gUFRTTV9GQUlMOwotICAgIH0KIAotICAgIGlm
ICggZG4tPmJ2X3ZhbCAmJgotICAgICAgICAhc3RybmNtcChkbi0+YnZfdmFsLCAiZG46IiwgMykg
KQotICAgICAgICAqcmV0ID0gc3RyZHVwKGRuLT5idl92YWwrMyk7Ci0gICAgYmVyX2J2ZnJlZShk
bik7CisgICAgICAgIGlmICggZG4tPmJ2X3ZhbCAmJgorICAgICAgICAgICAgIXN0cm5jbXAoZG4t
PmJ2X3ZhbCwgImRuOiIsIDMpICkKKyAgICAgICAgICAgICpyZXQgPSBzdHJkdXAoZG4tPmJ2X3Zh
bCszKTsKKyAgICAgICAgYmVyX2J2ZnJlZShkbik7CiAKLSNlbHNlCisgICAgfSBlbHNlCiAKLSAg
ICByYyA9IHB0c21vZHVsZV9leHBhbmRfdG9rZW5zKHB0c20tPmZpbHRlciwgY2Fub25faWQsIE5V
TEwsICZmaWx0ZXIpOwotICAgIGlmIChyYyAhPSBQVFNNX09LKQotICAgICAgICByZXR1cm4gcmM7
CisjZW5kaWYKIAotICAgIHJjID0gcHRzbW9kdWxlX2V4cGFuZF90b2tlbnMocHRzbS0+YmFzZSwg
Y2Fub25faWQsIE5VTEwsICZiYXNlKTsKLSAgICBpZiAocmMgIT0gUFRTTV9PSykKLSAgICAgICAg
cmV0dXJuIHJjOworICAgIHsKKyAgICAgICAgcmMgPSBwdHNtb2R1bGVfZXhwYW5kX3Rva2Vucyhw
dHNtLT5maWx0ZXIsIGNhbm9uX2lkLCBOVUxMLCAmZmlsdGVyKTsKKyAgICAgICAgaWYgKHJjICE9
IFBUU01fT0spCisgICAgICAgICAgICByZXR1cm4gcmM7CisKKyAgICAgICAgcmMgPSBwdHNtb2R1
bGVfZXhwYW5kX3Rva2VucyhwdHNtLT5iYXNlLCBjYW5vbl9pZCwgTlVMTCwgJmJhc2UpOworICAg
ICAgICBpZiAocmMgIT0gUFRTTV9PSykKKyAgICAgICAgICAgIHJldHVybiByYzsKIAotICAgIHJj
ID0gbGRhcF9zZWFyY2hfc3QocHRzbS0+bGQsIGJhc2UsIHB0c20tPnNjb3BlLCBmaWx0ZXIsIGF0
dHJzLCAwLCAmKHB0c20tPnRpbWVvdXQpLCAmcmVzKTsKLSAgICBmcmVlKGZpbHRlcik7Ci0gICAg
ZnJlZShiYXNlKTsKLSAgICBpZiAocmMgIT0gTERBUF9TVUNDRVNTKSB7Ci0gICAgICAgIGlmIChy
YyA9PSBMREFQX1NFUlZFUl9ET1dOKSB7Ci0gICAgICAgICAgICBsZGFwX3VuYmluZChwdHNtLT5s
ZCk7Ci0gICAgICAgICAgICBwdHNtLT5sZCA9IE5VTEw7Ci0gICAgICAgICAgICByZXR1cm4gUFRT
TV9SRVRSWTsKKyAgICAgICAgcmMgPSBsZGFwX3NlYXJjaF9zdChwdHNtLT5sZCwgYmFzZSwgcHRz
bS0+c2NvcGUsIGZpbHRlciwgYXR0cnMsIDAsICYocHRzbS0+dGltZW91dCksICZyZXMpOworICAg
ICAgICBmcmVlKGZpbHRlcik7CisgICAgICAgIGZyZWUoYmFzZSk7CisgICAgICAgIGlmIChyYyAh
PSBMREFQX1NVQ0NFU1MpIHsKKyAgICAgICAgICAgIGlmIChyYyA9PSBMREFQX1NFUlZFUl9ET1dO
KSB7CisgICAgICAgICAgICAgICAgbGRhcF91bmJpbmQocHRzbS0+bGQpOworICAgICAgICAgICAg
ICAgIHB0c20tPmxkID0gTlVMTDsKKyAgICAgICAgICAgICAgICByZXR1cm4gUFRTTV9SRVRSWTsK
KyAgICAgICAgICAgIH0KKyAgICAgICAgICAgIHJldHVybiBQVFNNX0ZBSUw7CiAgICAgICAgIH0K
LSAgICAgICAgcmV0dXJuIFBUU01fRkFJTDsKLSAgICB9Ci0KLSAgICBpZiAoIChlbnRyeSA9IGxk
YXBfZmlyc3RfZW50cnkocHRzbS0+bGQsIHJlcykpICE9IE5VTEwgKQotICAgICAgICAqcmV0ID0g
bGRhcF9nZXRfZG4ocHRzbS0+bGQsIGVudHJ5KTsKIAotICAgIGxkYXBfbXNnZnJlZShyZXMpOwot
ICAgIHJlcyA9IE5VTEw7CisgICAgICAgIGlmICggKGVudHJ5ID0gbGRhcF9maXJzdF9lbnRyeShw
dHNtLT5sZCwgcmVzKSkgIT0gTlVMTCApCisgICAgICAgICAgICAqcmV0ID0gbGRhcF9nZXRfZG4o
cHRzbS0+bGQsIGVudHJ5KTsKIAotI2VuZGlmCisgICAgICAgIGxkYXBfbXNnZnJlZShyZXMpOwor
ICAgICAgICByZXMgPSBOVUxMOworICAgIH0KIAogICAgIHJldHVybiAoKnJldCA/IFBUU01fT0sg
OiBQVFNNX0ZBSUwpOwogfQpAQCAtOTI1LDcgKzkzNCw4IEBACiAgICAgICAgICAgICAoKm5ld3N0
YXRlKS0+bmdyb3VwcyA9IG51bXZhbHM7CiAKICAgICAgICAgICAgIGZvciAoaSA9IDA7IHZhbHNb
aV0gIT0gTlVMTDsgaSsrKSB7Ci0gICAgICAgICAgICAgICAgc3RybGNweSgoKm5ld3N0YXRlKS0+
Z3JvdXBzW2ldLmlkLCB2YWxzW2ldLCAKKyAgICAgICAgICAgICAgICBzdHJjcHkoKCpuZXdzdGF0
ZSktPmdyb3Vwc1tpXS5pZCwgImdyb3VwOiIpOworICAgICAgICAgICAgICAgIHN0cmxjYXQoKCpu
ZXdzdGF0ZSktPmdyb3Vwc1tpXS5pZCwgdmFsc1tpXSwgCiAgICAgICAgICAgICAgICAgICAgIHNp
emVvZigoKm5ld3N0YXRlKS0+Z3JvdXBzW2ldLmlkKSk7CiAgICAgICAgICAgICAgICAgKCpuZXdz
dGF0ZSktPmdyb3Vwc1tpXS5oYXNoID0gc3RyaGFzaCgoKm5ld3N0YXRlKS0+Z3JvdXBzW2ldLmlk
KTsKICAgICAgICAgICAgIH0KQEAgLTEwNTMsNyArMTA2Myw4IEBACiAgICAgICAgICAgICBpZiAo
dmFscyA9PSBOVUxMKQogICAgICAgICAgICAgICAgIGNvbnRpbnVlOwogCi0gICAgICAgICAgICBz
dHJsY3B5KCgqbmV3c3RhdGUpLT5ncm91cHNbaV0uaWQsIHZhbHNbMF0sIAorICAgICAgICAgICAg
c3RyY3B5KCgqbmV3c3RhdGUpLT5ncm91cHNbaV0uaWQsICJncm91cDoiKTsKKyAgICAgICAgICAg
IHN0cmxjYXQoKCpuZXdzdGF0ZSktPmdyb3Vwc1tpXS5pZCwgdmFsc1swXSwgCiAgICAgICAgICAg
ICAgICAgc2l6ZW9mKCgqbmV3c3RhdGUpLT5ncm91cHNbaV0uaWQpKTsKICAgICAgICAgICAgICgq
bmV3c3RhdGUpLT5ncm91cHNbaV0uaGFzaCA9IHN0cmhhc2goKCpuZXdzdGF0ZSktPmdyb3Vwc1tp
XS5pZCk7CiAKQEAgLTExNjcsNyArMTE3OCw3IEBACiAgICAgcmV0dXJuIHJjOwogfQogCi1zdHJ1
Y3QgYXV0aF9zdGF0ZSAqcHRzbW9kdWxlX21ha2VfYXV0aHN0YXRlKAorc3RhdGljIHN0cnVjdCBh
dXRoX3N0YXRlICpteWF1dGhzdGF0ZSgKICAgICBjb25zdCBjaGFyICppZGVudGlmaWVyLAogICAg
IHNpemVfdCBzaXplLAogICAgIGNvbnN0IGNoYXIgKipyZXBseSwgCkBAIC0xMjA1LDMgKzEyMTYs
MjkgQEAKIAogICAgIHJldHVybiBuZXdzdGF0ZTsKIH0KKworI2Vsc2UgLyogSEFWRV9MREFQICov
CisKK3N0YXRpYyB2b2lkIG15aW5pdCh2b2lkKQoreworCWZhdGFsKCJQVFMgbW9kdWxlIChsZGFw
KSBub3QgY29tcGlsZWQgaW4iLCBFQ19DT05GSUcpOworfQorCitzdGF0aWMgc3RydWN0IGF1dGhf
c3RhdGUgKm15YXV0aHN0YXRlKAorICAgIGNvbnN0IGNoYXIgKmlkZW50aWZpZXIgX19hdHRyaWJ1
dGVfXygodW51c2VkKSksCisgICAgc2l6ZV90IHNpemUgX19hdHRyaWJ1dGVfXygodW51c2VkKSks
CisgICAgY29uc3QgY2hhciAqKnJlcGx5IF9fYXR0cmlidXRlX18oKHVudXNlZCkpLCAKKyAgICBp
bnQgKmRzaXplIF9fYXR0cmlidXRlX18oKHVudXNlZCkpKSAKK3sKKwlmYXRhbCgiUFRTIG1vZHVs
ZSAobGRhcCkgbm90IGNvbXBpbGVkIGluIiwgRUNfQ09ORklHKTsKK30KKworI2VuZGlmIC8qIEhB
VkVfTERBUCAqLworCitzdHJ1Y3QgcHRzX21vZHVsZSBwdHNfbGRhcCA9IAoreworICAgICJsZGFw
IiwJCS8qIG5hbWUgKi8KKworICAgICZteWluaXQsCisgICAgJm15YXV0aHN0YXRlLAorfTsKSW5k
ZXg6IHB0bG9hZGVyLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvY3lydXMvcHRjbGll
bnQvcHRsb2FkZXIuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zOQpkaWZmIC11IC1yMS4zOSBw
dGxvYWRlci5jCi0tLSBwdGxvYWRlci5jCTE3IERlYyAyMDA0IDE2OjMyOjI2IC0wMDAwCTEuMzkK
KysrIHB0bG9hZGVyLmMJMTYgRmViIDIwMDUgMTQ6Mzg6MjEgLTAwMDAKQEAgLTY0LDE3ICs2NCw2
MSBAQAogI2luY2x1ZGUgImxvY2suaCIKICNpbmNsdWRlICJyZXRyeS5oIgogI2luY2x1ZGUgInht
YWxsb2MuaCIKKyNpbmNsdWRlICJwdGxvYWRlci5oIgogCiBzdGF0aWMgY2hhciByY3NpZFtdIF9f
YXR0cmlidXRlX18oKHVudXNlZCkpID0gCiAgICAgICAiJElkOiBwdGxvYWRlci5jLHYgMS4zOSAy
MDA0LzEyLzE3IDE2OjMyOjI2IGtlbjMgRXhwICQiOwogCi1leHRlcm4gY29uc3QgY2hhciAqcHRz
bW9kdWxlX25hbWU7Ci1leHRlcm4gdm9pZCBwdHNtb2R1bGVfaW5pdCh2b2lkKTsKK3N0cnVjdCBw
dHNfbW9kdWxlICpwdHNfbW9kdWxlc1tdID0geworI2lmZGVmIEhBVkVfTERBUAorICAgICZwdHNf
bGRhcCwKKyNlbmRpZgorI2lmZGVmIEhBVkVfQUZTS1JCCisgICAgJnB0c19hZnNrcmIsCisjZW5k
aWYKKyAgICBOVUxMIH07CisKIGV4dGVybiB2b2lkIHNldHByb2N0aXRsZV9pbml0KGludCBhcmdj
LCBjaGFyICoqYXJndiwgY2hhciAqKmVudnApOwotZXh0ZXJuIHN0cnVjdCBhdXRoX3N0YXRlICpw
dHNtb2R1bGVfbWFrZV9hdXRoc3RhdGUoY29uc3QgY2hhciAqaWRlbnRpZmllciwKLQkJCQkJCSAg
IHNpemVfdCBzaXplLAotCQkJCQkJICAgY29uc3QgY2hhciAqKnJlcGx5LAotCQkJCQkJICAgaW50
ICpkc2l6ZSk7CisKK3N0YXRpYyBzdHJ1Y3QgcHRzX21vZHVsZSAqcHRzX2Zyb21uYW1lKCkKK3sK
KyAgICBpbnQgaTsKKyAgICBjb25zdCBjaGFyICpuYW1lID0gY29uZmlnX2dldHN0cmluZyhJTUFQ
T1BUX1BUU19NT0RVTEUpOworICAgIHN0YXRpYyBzdHJ1Y3QgcHRzX21vZHVsZSAqcHRzID0gTlVM
TDsKKworICAgIGlmIChwdHMpCisgICAgICAgIHJldHVybiBwdHM7CisKKyAgICBmb3IgKGkgPSAw
OyBwdHNfbW9kdWxlc1tpXTsgaSsrKSB7CisJaWYgKCFzdHJjbXAocHRzX21vZHVsZXNbaV0tPm5h
bWUsIG5hbWUpKSB7CisJICAgIHB0cyA9IHB0c19tb2R1bGVzW2ldOyBicmVhazsKKwl9CisgICAg
fQorICAgIGlmICghcHRzKSB7CisJY2hhciBlcnJidWZbMTAyNF07CisJc25wcmludGYoZXJyYnVm
LCBzaXplb2YoZXJyYnVmKSwKKwkJICJQVFMgbW9kdWxlICVzIG5vdCBzdXBwb3J0ZWQiLCBuYW1l
KTsKKwlmYXRhbChlcnJidWYsIEVDX0NPTkZJRyk7CisgICAgfQorCisgICAgcmV0dXJuIHB0czsK
K30KKwordm9pZCBwdHNtb2R1bGVfaW5pdCh2b2lkKQoreworICAgIHN0cnVjdCBwdHNfbW9kdWxl
ICpwdHMgPSBwdHNfZnJvbW5hbWUoKTsKKworICAgIHB0cy0+aW5pdCgpOworfQorCitzdHJ1Y3Qg
YXV0aF9zdGF0ZSAqcHRzbW9kdWxlX21ha2VfYXV0aHN0YXRlKGNvbnN0IGNoYXIgKmlkZW50aWZp
ZXIsCisJCQkJCSAgICBzaXplX3Qgc2l6ZSwKKwkJCQkJICAgIGNvbnN0IGNoYXIgKipyZXBseSwg
aW50ICpkc2l6ZSkKK3sKKyAgICBzdHJ1Y3QgcHRzX21vZHVsZSAqcHRzID0gcHRzX2Zyb21uYW1l
KCk7CisKKyAgICByZXR1cm4gcHRzLT5tYWtlX2F1dGhzdGF0ZShpZGVudGlmaWVyLCBzaXplLCBy
ZXBseSwgZHNpemUpOworfQogCiAvKiBjb25maWcuYyBpbmZvIChsaWJpbWFwKSAqLwogY29uc3Qg
aW50IGNvbmZpZ19uZWVkX2RhdGEgPSAwOwpAQCAtOTksOCArMTQzLDcgQEAKICAgICBzaWduYWwo
U0lHUElQRSwgU0lHX0lHTik7CiAKICAgICBzeXNsb2coTE9HX05PVElDRSwKLQkgICAic3RhcnRp
bmc6ICRJZDogcHRsb2FkZXIuYyx2IDEuMzkgMjAwNC8xMi8xNyAxNjozMjoyNiBrZW4zIEV4cCAk
ICglcykiLAotCSAgIHB0c21vZHVsZV9uYW1lKTsKKwkgICAic3RhcnRpbmc6ICRJZDogcHRsb2Fk
ZXIuYyx2IDEuMzkgMjAwNC8xMi8xNyAxNjozMjoyNiBrZW4zIEV4cCAkIik7CiAKICAgICB3aGls
ZSAoKG9wdCA9IGdldG9wdChhcmdjLCBhcmd2LCAiZDoiKSkgIT0gRU9GKSB7CiAJc3dpdGNoIChv
cHQpIHsKSW5kZXg6IGxpYi9NYWtlZmlsZS5pbgo9PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3Ny
Yy9jeXJ1cy9saWIvTWFrZWZpbGUuaW4sdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuNjIKZGlmZiAt
dSAtcjEuNjIgTWFrZWZpbGUuaW4KLS0tIGxpYi9NYWtlZmlsZS5pbgkyOCBNYXkgMjAwNCAxODow
MzowNCAtMDAwMAkxLjYyCisrKyBsaWIvTWFrZWZpbGUuaW4JMTYgRmViIDIwMDUgMTQ6NDQ6NTAg
LTAwMDAKQEAgLTQzLDcgKzQzLDcgQEAKICMgJElkOiBNYWtlZmlsZS5pbix2IDEuNjIgMjAwNC8w
NS8yOCAxODowMzowNCByanMzIEV4cCAkCiAKICMgQXV0aG9yaXphdGlvbiBuYW1lc3BhY2UuCi1B
VVRIPWF1dGhfQFdJVEhfQVVUSEAubworQVVUSD1hdXRoLm8gYXV0aF9rcmIubyBhdXRoX3VuaXgu
byBhdXRoX2tyYjUubyBhdXRoX3B0cy5vCiAKICMgQUNMIGludGVycHJldGF0aW9uLiAgT25seSBv
bmUgY2hvaWNlIGZvciBub3c6CiBBQ0w9YWNsX2Fmcy5vCkluZGV4OiBsaWIvYXV0aC5oCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL2N5cnVzL2xpYi9hdXRoLmgsdgpyZXRyaWV2aW5nIHJl
dmlzaW9uIDEuMTUKZGlmZiAtdSAtcjEuMTUgYXV0aC5oCi0tLSBsaWIvYXV0aC5oCTIyIE9jdCAy
MDAzIDE4OjUwOjEyIC0wMDAwCTEuMTUKKysrIGxpYi9hdXRoLmgJMTYgRmViIDIwMDUgMTQ6NDQ6
NTggLTAwMDAKQEAgLTQ0LDIwICs0NCwzNyBAQAogI2lmbmRlZiBJTkNMVURFRF9BVVRIX0gKICNk
ZWZpbmUgSU5DTFVERURfQVVUSF9ICiAKLWV4dGVybiBjb25zdCBjaGFyICphdXRoX21ldGhvZF9k
ZXNjOwotCiBzdHJ1Y3QgYXV0aF9zdGF0ZTsKIAorc3RydWN0IGF1dGhfbWVjaCB7CisgICAgY29u
c3QgY2hhciAqbmFtZTsKKworICAgIGNoYXIgKigqY2Fub25pZnlpZCkoY29uc3QgY2hhciAqaWRl
bnRpZmllciwgc2l6ZV90IGxlbik7CisgICAgaW50ICgqbWVtYmVyb2YpKHN0cnVjdCBhdXRoX3N0
YXRlICphdXRoX3N0YXRlLCAKKyAgICAgICAgICAgICBjb25zdCBjaGFyICppZGVudGlmaWVyKTsK
KyAgICBzdHJ1Y3QgYXV0aF9zdGF0ZSAqKCpuZXdzdGF0ZSkoY29uc3QgY2hhciAqaWRlbnRpZmll
cik7CisgICAgdm9pZCAoKmZyZWVzdGF0ZSkoc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhfc3RhdGUp
OworfTsKKworZXh0ZXJuIHN0cnVjdCBhdXRoX21lY2ggKmF1dGhfbWVjaHNbXTsKKworLyogTm90
ZSB0aGF0IHNvbWUgb2YgdGhlc2UgbWF5IGJlIHVuZGVmaW5lZCBzeW1ib2xzCisgKiBpZiBsaWJj
eXJ1cyB3YXMgbm90IGJ1aWx0IHdpdGggc3VwcG9ydCBmb3IgdGhlbSAqLworZXh0ZXJuIHN0cnVj
dCBhdXRoX21lY2ggYXV0aF91bml4OworZXh0ZXJuIHN0cnVjdCBhdXRoX21lY2ggYXV0aF9wdHM7
CitleHRlcm4gc3RydWN0IGF1dGhfbWVjaCBhdXRoX2tyYjsKK2V4dGVybiBzdHJ1Y3QgYXV0aF9t
ZWNoIGF1dGhfa3JiNTsKKwogLyogYXV0aF9jYW5vbmlmeWlkOiBjYW5vbmlmeSB0aGUgZ2l2ZW4g
aWRlbnRpZmllciBhbmQgcmV0dXJuIGEgcG9pbnRlcgogICogICAgICAgICAgICAgICAgICB0byBh
IHN0YXRpYyBidWZmZXIgd2l0aCB0aGUgY2Fub25pZmllZCBJRCwgb3IgTlVMTCBvbgogICogICAg
ICAgICAgICAgICAgICBmYWlsdXJlICovCiAvKiBpZGVudGlmaWVyOiBpZCB0byBjYW5vbmlmeSAq
LwogLyogbGVuOiBsZW5ndGggb2YgaWQsIG9yIDAgdG8gZG8gc3RybGVuKGlkZW50aWZpZXIpICov
Ci1leHRlcm4gY2hhciAqYXV0aF9jYW5vbmlmeWlkKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIsIHNp
emVfdCBsZW4pOworY2hhciAqYXV0aF9jYW5vbmlmeWlkKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIs
IHNpemVfdCBsZW4pOwogCi1leHRlcm4gaW50IGF1dGhfbWVtYmVyb2Yoc3RydWN0IGF1dGhfc3Rh
dGUgKmF1dGhfc3RhdGUsIAotCQkJIGNvbnN0IGNoYXIgKmlkZW50aWZpZXIpOwotZXh0ZXJuIHN0
cnVjdCBhdXRoX3N0YXRlICphdXRoX25ld3N0YXRlKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIpOwot
ZXh0ZXJuIHZvaWQgYXV0aF9mcmVlc3RhdGUoc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhfc3RhdGUp
OworaW50IGF1dGhfbWVtYmVyb2Yoc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhfc3RhdGUsIAorIAkg
Y29uc3QgY2hhciAqaWRlbnRpZmllcik7CitzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9uZXdzdGF0
ZShjb25zdCBjaGFyICppZGVudGlmaWVyKTsKK3ZvaWQgYXV0aF9mcmVlc3RhdGUoc3RydWN0IGF1
dGhfc3RhdGUgKmF1dGhfc3RhdGUpOwogCiAjZW5kaWYgLyogSU5DTFVERURfQVVUSF9IICovCklu
ZGV4OiBsaWIvYXV0aF9rcmIuYwo9PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09ClJDUyBmaWxlOiAvY3ZzL3NyYy9jeXJ1cy9s
aWIvYXV0aF9rcmIuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS40MApkaWZmIC11IC1yMS40MCBh
dXRoX2tyYi5jCi0tLSBsaWIvYXV0aF9rcmIuYwkxMSBOb3YgMjAwMyAwMzoyNjowMCAtMDAwMAkx
LjQwCisrKyBsaWIvYXV0aF9rcmIuYwkxNiBGZWIgMjAwNSAxNDo0NTo0MyAtMDAwMApAQCAtNDIs
NiArNDIsMTIgQEAKIAogI2luY2x1ZGUgPGNvbmZpZy5oPgogI2luY2x1ZGUgPHN0ZGxpYi5oPgor
CisjaW5jbHVkZSAiYXV0aC5oIgorI2luY2x1ZGUgImV4aXRjb2Rlcy5oIgorCisjaWZkZWYgSEFW
RV9LUkIKKwogI2luY2x1ZGUgPGxpbWl0cy5oPgogI2luY2x1ZGUgPHN0ZGlvLmg+CiAjaW5jbHVk
ZSA8Y3R5cGUuaD4KQEAgLTYxLDkgKzY3LDYgQEAKICNpbmNsdWRlIDxrcmIuaD4KIAogI2luY2x1
ZGUgInhtYWxsb2MuaCIKLSNpbmNsdWRlICJhdXRoLmgiCi0KLWNvbnN0IGNoYXIgKmF1dGhfbWV0
aG9kX2Rlc2MgPSAia3JiIjsKIAogI2lmbmRlZiBLUkJfTUFQTkFNRQogI2RlZmluZSBLUkJfTUFQ
TkFNRSAoU1lTQ09ORkRJUiAiL2tyYi5lcXVpdiIpCkBAIC05NSw4ICs5OCw3IEBACiAgKgkyCVVz
ZXIgaXMgaW4gdGhlIGdyb3VwIHRoYXQgaXMgaWRlbnRpZmllcgogICoJMwlVc2VyIGlzIGlkZW50
aWZlcgogICovCi1pbnQKLWF1dGhfbWVtYmVyb2YoYXV0aF9zdGF0ZSwgaWRlbnRpZmllcikKK3N0
YXRpYyBpbnQgbXltZW1iZXJvZihhdXRoX3N0YXRlLCBpZGVudGlmaWVyKQogc3RydWN0IGF1dGhf
c3RhdGUgKmF1dGhfc3RhdGU7CiBjb25zdCBjaGFyICppZGVudGlmaWVyOwogewpAQCAtMTcyLDcg
KzE3NCw3IEBACiAgKiBhIE5VTEwgcG9pbnRlciBpcyByZXR1cm5lZC4KICAqIEV2ZW50dWFsbHks
IHRoaXMgbWF5IGJlIG1vcmUgc29waGlzdGljYXRlZCB0aGFuIGEgc2ltcGxlIGZpbGUgc2Nhbi4K
ICAqLwotY2hhciAqYXV0aF9tYXBfa3JiaWQocmVhbF9hbmFtZSwgcmVhbF9pbnN0LCByZWFsX3Jl
YWxtKQorc3RhdGljIGNoYXIgKmF1dGhfbWFwX2tyYmlkKHJlYWxfYW5hbWUsIHJlYWxfaW5zdCwg
cmVhbF9yZWFsbSkKIGNvbnN0IGNoYXIgKnJlYWxfYW5hbWU7CiBjb25zdCBjaGFyICpyZWFsX2lu
c3Q7CiBjb25zdCBjaGFyICpyZWFsX3JlYWxtOwpAQCAtMjQ3LDcgKzI0OSw3IEBACiAgKiBSZXR1
cm5zIGEgcG9pbnRlciB0byBhIHN0YXRpYyBidWZmZXIgY29udGFpbmluZyB0aGUgY2Fub25pY2Fs
IGZvcm0KICAqIG9yIE5VTEwgaWYgJ2lkZW50aWZpZXInIGlzIGludmFsaWQuCiAgKi8KLWNoYXIg
KmF1dGhfY2Fub25pZnlpZChpZGVudGlmaWVyLCBsZW4pCitzdGF0aWMgY2hhciAqbXljYW5vbmlm
eWlkKGlkZW50aWZpZXIsIGxlbikKIGNvbnN0IGNoYXIgKmlkZW50aWZpZXI7CiBzaXplX3QgbGVu
OwogewpAQCAtMzE0LDggKzMxNiw4IEBACiAgKiBwb2ludHMgdG8gYSAxNi1ieXRlIGJpbmFyeSBr
ZXkgdG8gY2FjaGUgaWRlbnRpZmllcidzIGluZm9ybWF0aW9uCiAgKiB3aXRoLgogICovCi1zdHJ1
Y3QgYXV0aF9zdGF0ZSAqCi1hdXRoX25ld3N0YXRlKGNvbnN0IGNoYXIgKmlkZW50aWZpZXIpCitz
dGF0aWMgc3RydWN0IGF1dGhfc3RhdGUgKm15bmV3c3RhdGUoaWRlbnRpZmllcikKK2NvbnN0IGNo
YXIgKmlkZW50aWZpZXI7CiB7CiAgICAgc3RydWN0IGF1dGhfc3RhdGUgKm5ld3N0YXRlOwogCkBA
IC0zMzEsMTAgKzMzMyw0OCBAQAogICAgIHJldHVybiBuZXdzdGF0ZTsKIH0KIAotdm9pZAotYXV0
aF9mcmVlc3RhdGUoYXV0aF9zdGF0ZSkKK3N0YXRpYyB2b2lkIG15ZnJlZXN0YXRlKGF1dGhfc3Rh
dGUpCiBzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9zdGF0ZTsKIHsKICAgICBmcmVlKChjaGFyICop
YXV0aF9zdGF0ZSk7CiB9CiAKKyNlbHNlIC8qIEhBVkVfS1JCICovCisKK3N0YXRpYyBpbnQgbXlt
ZW1iZXJvZigKKyAgICBzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9zdGF0ZSBfX2F0dHJpYnV0ZV9f
KCh1bnVzZWQpKSwgCisgICAgY29uc3QgY2hhciAqaWRlbnRpZmllciBfX2F0dHJpYnV0ZV9fKCh1
bnVzZWQpKSkKK3sKKwlmYXRhbCgiQXV0aGVudGljYXRpb24gbWVjaGFuaXNtIChrcmIpIG5vdCBj
b21waWxlZCBpbiIsIEVDX0NPTkZJRyk7Cit9CisKK3N0YXRpYyBjaGFyICpteWNhbm9uaWZ5aWQo
CisgICAgY29uc3QgY2hhciAqaWRlbnRpZmllciBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSwgCisg
ICAgc2l6ZV90IGxlbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSkKK3sKKwlmYXRhbCgiQXV0aGVu
dGljYXRpb24gbWVjaGFuaXNtIChrcmIpIG5vdCBjb21waWxlZCBpbiIsIEVDX0NPTkZJRyk7Cit9
CisKK3N0YXRpYyBzdHJ1Y3QgYXV0aF9zdGF0ZSAqbXluZXdzdGF0ZSgKKyAgICBjb25zdCBjaGFy
ICppZGVudGlmaWVyIF9fYXR0cmlidXRlX18oKHVudXNlZCkpKQoreworCWZhdGFsKCJBdXRoZW50
aWNhdGlvbiBtZWNoYW5pc20gKGtyYikgbm90IGNvbXBpbGVkIGluIiwgRUNfQ09ORklHKTsKK30K
Kworc3RhdGljIHZvaWQgbXlmcmVlc3RhdGUoCisgICAgc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhf
c3RhdGUgX19hdHRyaWJ1dGVfXygodW51c2VkKSkpCit7CisJZmF0YWwoIkF1dGhlbnRpY2F0aW9u
IG1lY2hhbmlzbSAoa3JiKSBub3QgY29tcGlsZWQgaW4iLCBFQ19DT05GSUcpOworfQorCisjZW5k
aWYKKworc3RydWN0IGF1dGhfbWVjaCBhdXRoX2tyYiA9IAoreworICAgICJrcmIiLAkJLyogbmFt
ZSAqLworCisgICAgJm15Y2Fub25pZnlpZCwKKyAgICAmbXltZW1iZXJvZiwKKyAgICAmbXluZXdz
dGF0ZSwKKyAgICAmbXlmcmVlc3RhdGUsCit9OwpJbmRleDogbGliL2F1dGhfa3JiNS5jCj09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL2N5cnVzL2xpYi9hdXRoX2tyYjUuYyx2CnJldHJpZXZp
bmcgcmV2aXNpb24gMS4zCmRpZmYgLXUgLXIxLjMgYXV0aF9rcmI1LmMKLS0tIGxpYi9hdXRoX2ty
YjUuYwkxNiBKYW4gMjAwNCAxNToyODo1OCAtMDAwMAkxLjMKKysrIGxpYi9hdXRoX2tyYjUuYwkx
NiBGZWIgMjAwNSAxNDo0NTo1MCAtMDAwMApAQCAtNDIsNiArNDIsMTIgQEAKIAogI2luY2x1ZGUg
PGNvbmZpZy5oPgogI2luY2x1ZGUgPHN0ZGxpYi5oPgorCisjaW5jbHVkZSAiYXV0aC5oIgorI2lu
Y2x1ZGUgImV4aXRjb2Rlcy5oIgorCisjaWZkZWYgSEFWRV9HU1NBUElfSAorCiAjaW5jbHVkZSA8
bGltaXRzLmg+CiAjaW5jbHVkZSA8c3RkaW8uaD4KICNpbmNsdWRlIDxjdHlwZS5oPgpAQCAtNTMs
OCArNTksNiBAQAogI2luY2x1ZGUgImF1dGguaCIKICNpbmNsdWRlICJ4bWFsbG9jLmgiCiAKLWNv
bnN0IGNoYXIgKmF1dGhfbWV0aG9kX2Rlc2MgPSAia3JiNSI7Ci0KIHN0cnVjdCBhdXRoX3N0YXRl
IHsKICAgICBjaGFyICp1c2VyaWQ7IC8qIENhbm9uaWZpZWQgVXNlcmlkICovCiB9OwpAQCAtNjcs
NyArNzEsNyBAQAogICoJMglVc2VyIGlzIGluIHRoZSBncm91cCB0aGF0IGlzIGlkZW50aWZpZXIK
ICAqCTMJVXNlciBpcyBpZGVudGlmZXIKICAqLwotaW50IGF1dGhfbWVtYmVyb2Yoc3RydWN0IGF1
dGhfc3RhdGUgKmF1dGhfc3RhdGUsIGNvbnN0IGNoYXIgKmlkZW50aWZpZXIpCitzdGF0aWMgaW50
IG15bWVtYmVyb2Yoc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhfc3RhdGUsIGNvbnN0IGNoYXIgKmlk
ZW50aWZpZXIpCiB7CiAgICAgY2hhciAqaWRlbnQ7CiAgICAgaW50IHJldD0wOwpAQCAtOTIsNyAr
OTYsNyBAQAogICogUmV0dXJucyBhIHBvaW50ZXIgdG8gYSBzdGF0aWMgYnVmZmVyIGNvbnRhaW5p
bmcgdGhlIGNhbm9uaWNhbCBmb3JtCiAgKiBvciBOVUxMIGlmICdpZGVudGlmaWVyJyBpcyBpbnZh
bGlkLgogICovCi1jaGFyICphdXRoX2Nhbm9uaWZ5aWQoY29uc3QgY2hhciAqaWRlbnRpZmllciwg
c2l6ZV90IGxlbikKK3N0YXRpYyBjaGFyICpteWNhbm9uaWZ5aWQoY29uc3QgY2hhciAqaWRlbnRp
Zmllciwgc2l6ZV90IGxlbikKIHsKICAgICBzdGF0aWMgY2hhciAqcmV0YnVmID0gTlVMTDsKICAg
ICBrcmI1X2NvbnRleHQgY29udGV4dDsKQEAgLTE3Miw3ICsxNzYsNyBAQAogLyoKICAqIFNldCB0
aGUgY3VycmVudCB1c2VyIHRvICdpZGVudGlmaWVyJy4KICAqLwotc3RydWN0IGF1dGhfc3RhdGUg
KmF1dGhfbmV3c3RhdGUoY29uc3QgY2hhciAqaWRlbnRpZmllcikKK3N0YXRpYyBzdHJ1Y3QgYXV0
aF9zdGF0ZSAqbXluZXdzdGF0ZShjb25zdCBjaGFyICppZGVudGlmaWVyKQogewogICAgIHN0cnVj
dCBhdXRoX3N0YXRlICpuZXdzdGF0ZTsKICAgICBjaGFyICppZGVudDsKQEAgLTE4NSw3ICsxODks
NyBAQAogICAgIHJldHVybiBuZXdzdGF0ZTsKIH0KIAotdm9pZCBhdXRoX2ZyZWVzdGF0ZShzdHJ1
Y3QgYXV0aF9zdGF0ZSAqYXV0aF9zdGF0ZSkKK3N0YXRpYyB2b2lkIG15ZnJlZXN0YXRlKHN0cnVj
dCBhdXRoX3N0YXRlICphdXRoX3N0YXRlKQogewogICAgIGlmKCFhdXRoX3N0YXRlKSByZXR1cm47
CiAgICAgCkBAIC0xOTMsNCArMTk3LDQyIEBACiAgICAgZnJlZShhdXRoX3N0YXRlKTsKIH0KIAor
I2Vsc2UgLyogSEFWRV9HU1NBUElfSCAqLworCitzdGF0aWMgaW50IG15bWVtYmVyb2YoCisgICAg
c3RydWN0IGF1dGhfc3RhdGUgKmF1dGhfc3RhdGUgX19hdHRyaWJ1dGVfXygodW51c2VkKSksIAor
ICAgIGNvbnN0IGNoYXIgKmlkZW50aWZpZXIgX19hdHRyaWJ1dGVfXygodW51c2VkKSkpCit7CisJ
ZmF0YWwoIkF1dGhlbnRpY2F0aW9uIG1lY2hhbmlzbSAoa3JiNSkgbm90IGNvbXBpbGVkIGluIiwg
RUNfQ09ORklHKTsKK30KKworc3RhdGljIGNoYXIgKm15Y2Fub25pZnlpZCgKKyAgICBjb25zdCBj
aGFyICppZGVudGlmaWVyIF9fYXR0cmlidXRlX18oKHVudXNlZCkpLCAKKyAgICBzaXplX3QgbGVu
IF9fYXR0cmlidXRlX18oKHVudXNlZCkpKQoreworCWZhdGFsKCJBdXRoZW50aWNhdGlvbiBtZWNo
YW5pc20gKGtyYjUpIG5vdCBjb21waWxlZCBpbiIsIEVDX0NPTkZJRyk7Cit9CiAKK3N0YXRpYyBz
dHJ1Y3QgYXV0aF9zdGF0ZSAqbXluZXdzdGF0ZSgKKyAgICBjb25zdCBjaGFyICppZGVudGlmaWVy
IF9fYXR0cmlidXRlX18oKHVudXNlZCkpKQoreworCWZhdGFsKCJBdXRoZW50aWNhdGlvbiBtZWNo
YW5pc20gKGtyYjUpIG5vdCBjb21waWxlZCBpbiIsIEVDX0NPTkZJRyk7Cit9CisKK3N0YXRpYyB2
b2lkIG15ZnJlZXN0YXRlKAorICAgIHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0YXRlIF9fYXR0
cmlidXRlX18oKHVudXNlZCkpKQoreworCWZhdGFsKCJBdXRoZW50aWNhdGlvbiBtZWNoYW5pc20g
KGtyYjUpIG5vdCBjb21waWxlZCBpbiIsIEVDX0NPTkZJRyk7Cit9CisKKyNlbmRpZgorCitzdHJ1
Y3QgYXV0aF9tZWNoIGF1dGhfa3JiNSA9IAoreworICAgICJrcmI1IiwJCS8qIG5hbWUgKi8KKwor
ICAgICZteWNhbm9uaWZ5aWQsCisgICAgJm15bWVtYmVyb2YsCisgICAgJm15bmV3c3RhdGUsCisg
ICAgJm15ZnJlZXN0YXRlLAorfTsKSW5kZXg6IGxpYi9hdXRoX3B0cy5jCj09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNT
IGZpbGU6IC9jdnMvc3JjL2N5cnVzL2xpYi9hdXRoX3B0cy5jLHYKcmV0cmlldmluZyByZXZpc2lv
biAxLjcKZGlmZiAtdSAtcjEuNyBhdXRoX3B0cy5jCi0tLSBsaWIvYXV0aF9wdHMuYwkyNCBGZWIg
MjAwNCAyMzoxMTozNyAtMDAwMAkxLjcKKysrIGxpYi9hdXRoX3B0cy5jCTE2IEZlYiAyMDA1IDE0
OjQ1OjU4IC0wMDAwCkBAIC02MywxNiArNjMsMTUgQEAKICNpbmNsdWRlICJzdHJoYXNoLmgiCiAj
aW5jbHVkZSAieG1hbGxvYy5oIgogCi1jb25zdCBjaGFyICphdXRoX21ldGhvZF9kZXNjID0gInB0
cyI7Ci0KLWNoYXIgKmNhbm9udXNlcl9pZCA9IE5VTEw7Ci1zdHJ1Y3QgYXV0aF9zdGF0ZSAqY2Fu
b251c2VyX2NhY2hlID0gTlVMTDsKK3N0YXRpYyBjaGFyICpjYW5vbnVzZXJfaWQgPSBOVUxMOwor
c3RhdGljIHN0cnVjdCBhdXRoX3N0YXRlICpjYW5vbnVzZXJfY2FjaGUgPSBOVUxMOwogCiAvKiBS
ZXR1cm5zIDAgb24gc3VjY2Vzc2Z1bCBjb25uZWN0aW9uIHRvIHB0bG9hZGVyL3ZhbGlkIGNhY2hl
IGVudHJ5LAogICogY29tcGxldGUgd2l0aCBhbGxvY2F0ZWQgJiBmaWxsZWQgaW4gc3RydWN0IGF1
dGhfc3RhdGUuCiAgKgogICogc3RhdGUgbXVzdCBiZSBhIE5VTEwgcG9pbnRlciB3aGVuIHBhc3Nl
ZCBpbiAqLwotaW50IHB0bG9hZChjb25zdCBjaGFyICppZGVudGlmaWVyLHN0cnVjdCBhdXRoX3N0
YXRlICoqc3RhdGUpOworc3RhdGljIGludCBwdGxvYWQoY29uc3QgY2hhciAqaWRlbnRpZmllcixz
dHJ1Y3QgYXV0aF9zdGF0ZSAqKnN0YXRlKTsKK3N0YXRpYyB2b2lkIG15ZnJlZXN0YXRlKHN0cnVj
dCBhdXRoX3N0YXRlICphdXRoX3N0YXRlKTsKIAogLyoKICAqIERldGVybWluZSBpZiB0aGUgdXNl
ciBpcyBhIG1lbWJlciBvZiAnaWRlbnRpZmllcicKQEAgLTgyLDcgKzgxLDcgQEAKICAqICAgICAg
MiAgICAgICBVc2VyIGlzIGluIHRoZSBncm91cCB0aGF0IGlzIGlkZW50aWZpZXIKICAqICAgICAg
MyAgICAgICBVc2VyIGlzIGlkZW50aWZlcgogICovCi1pbnQgYXV0aF9tZW1iZXJvZihzdHJ1Y3Qg
YXV0aF9zdGF0ZSAqYXV0aF9zdGF0ZSwKK3N0YXRpYyBpbnQgbXltZW1iZXJvZihzdHJ1Y3QgYXV0
aF9zdGF0ZSAqYXV0aF9zdGF0ZSwKIAkJICBjb25zdCBjaGFyICppZGVudGlmaWVyKQogewogICAg
IGludCBpOwpAQCAtMTEwLDEwICsxMDksOCBAQAogICAgIAogICAgIC8qIGlzIGl0IGEgZ3JvdXAg
aSdtIGEgbWVtYmVyIG9mID8gKi8KICAgICBmb3IgKGk9MDsgaSA8IGF1dGhfc3RhdGUtPm5ncm91
cHM7IGkrKykKLSAgICAgICAgaWYgKCBpZGhhc2ggPT0gYXV0aF9zdGF0ZS0+Z3JvdXBzW2ldLmhh
c2ggJiYKLQkgICAgICAgICgoICFzdHJuY21wKGlkZW50aWZpZXIsICJncm91cDoiLCA2KSAmJiAK
LSAgICAgICAgICAgICAgICAhc3RyY21wKGlkZW50aWZpZXIrNiwgYXV0aF9zdGF0ZS0+Z3JvdXBz
W2ldLmlkKSApIHx8Ci0gICAgICAgICAgICAgIXN0cmNtcChpZGVudGlmaWVyLCBhdXRoX3N0YXRl
LT5ncm91cHNbaV0uaWQpKSApCisgICAgICAgIGlmIChpZGhhc2ggPT0gYXV0aF9zdGF0ZS0+Z3Jv
dXBzW2ldLmhhc2ggJiYKKyAgICAgICAgICAgICFzdHJjbXAoaWRlbnRpZmllciwgYXV0aF9zdGF0
ZS0+Z3JvdXBzW2ldLmlkKSkKICAgICAgICAgICAgIHJldHVybiAyOwogICAKICAgICByZXR1cm4g
MDsKQEAgLTEyNCw3ICsxMjEsNyBAQAogICogUmV0dXJucyBhIHBvaW50ZXIgdG8gYSBzdGF0aWMg
YnVmZmVyIGNvbnRhaW5pbmcgdGhlIGNhbm9uaWNhbCBmb3JtCiAgKiBvciBOVUxMIGlmICdpZGVu
dGlmaWVyJyBpcyBpbnZhbGlkLgogICovCi1jaGFyICphdXRoX2Nhbm9uaWZ5aWQoY29uc3QgY2hh
ciAqaWRlbnRpZmllciwKK3N0YXRpYyBjaGFyICpteWNhbm9uaWZ5aWQoY29uc3QgY2hhciAqaWRl
bnRpZmllciwKIAkJICAgICAgc2l6ZV90IGxlbiBfX2F0dHJpYnV0ZV9fKCh1bnVzZWQpKSkKIHsK
ICAgICBzdGF0aWMgY2hhciByZXRidWZbUFRTX0RCX0tFWVNJWkVdOwpAQCAtMTM2LDcgKzEzMyw3
IEBACiAgICAgfSBlbHNlIGlmKGNhbm9udXNlcl9pZCkgewogCS8qIFdlJ3ZlIGdvdCBhIG5ldyBv
bmUsIGludmFsaWRhdGUgb3VyIGNhY2hlICovCiAJZnJlZShjYW5vbnVzZXJfaWQpOwotCWF1dGhf
ZnJlZXN0YXRlKGNhbm9udXNlcl9jYWNoZSk7CisJbXlmcmVlc3RhdGUoY2Fub251c2VyX2NhY2hl
KTsKIAogCWNhbm9udXNlcl9pZCA9IE5VTEw7CiAJY2Fub251c2VyX2NhY2hlID0gTlVMTDsKQEAg
LTE2MCw3ICsxNTcsNyBAQAogLyogCiAgKiBQcm9kdWNlIGFuIGF1dGhfc3RhdGUgc3RydWN0dXJl
IGZvciB0aGUgZ2l2ZW4gaWRlbnRpZmllcgogICovCi1zdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9u
ZXdzdGF0ZShjb25zdCBjaGFyICppZGVudGlmaWVyKSAKK3N0YXRpYyBzdHJ1Y3QgYXV0aF9zdGF0
ZSAqbXluZXdzdGF0ZShjb25zdCBjaGFyICppZGVudGlmaWVyKSAKIHsKICAgICBzdHJ1Y3QgYXV0
aF9zdGF0ZSAqb3V0cHV0ID0gTlVMTDsKIApAQCAtMTg5LDEwICsxODYsMTAgQEAKICAgICByZXR1
cm4gb3V0cHV0OwogfQogCi1zdHJ1Y3QgY3lydXNkYl9iYWNrZW5kICp0aGVfcHRzY2FjaGVfZGIg
PSBOVUxMOworc3RhdGljIHN0cnVjdCBjeXJ1c2RiX2JhY2tlbmQgKnRoZV9wdHNjYWNoZV9kYiA9
IE5VTEw7CiAKIC8qIFJldHVybnMgMCBvbiBzdWNjZXNzICovCi1pbnQgcHRsb2FkKGNvbnN0IGNo
YXIgKmlkZW50aWZpZXIsIHN0cnVjdCBhdXRoX3N0YXRlICoqc3RhdGUpIAorc3RhdGljIGludCBw
dGxvYWQoY29uc3QgY2hhciAqaWRlbnRpZmllciwgc3RydWN0IGF1dGhfc3RhdGUgKipzdGF0ZSkg
CiB7CiAgICAgc3RydWN0IGF1dGhfc3RhdGUgKmZldGNoZWQgPSBOVUxMOwogICAgIHNpemVfdCBp
ZF9sZW47CkBAIC0zNDUsNyArMzQyLDE3IEBACiAgICAgcmV0dXJuICgqc3RhdGUpID8gMCA6IC0x
OwogfQogCi12b2lkIGF1dGhfZnJlZXN0YXRlKHN0cnVjdCBhdXRoX3N0YXRlICphdXRoX3N0YXRl
KQorc3RhdGljIHZvaWQgbXlmcmVlc3RhdGUoc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhfc3RhdGUp
CiB7CiAgICAgZnJlZShhdXRoX3N0YXRlKTsKIH0KKworc3RydWN0IGF1dGhfbWVjaCBhdXRoX3B0
cyA9IAoreworICAgICJwdHMiLAkJLyogbmFtZSAqLworCisgICAgJm15Y2Fub25pZnlpZCwKKyAg
ICAmbXltZW1iZXJvZiwKKyAgICAmbXluZXdzdGF0ZSwKKyAgICAmbXlmcmVlc3RhdGUsCit9OwpJ
bmRleDogbGliL2F1dGhfdW5peC5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL2N5cnVz
L2xpYi9hdXRoX3VuaXguYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zOApkaWZmIC11IC1yMS4z
OCBhdXRoX3VuaXguYwotLS0gbGliL2F1dGhfdW5peC5jCTEzIFNlcCAyMDA0IDIyOjQ5OjI5IC0w
MDAwCTEuMzgKKysrIGxpYi9hdXRoX3VuaXguYwkxNiBGZWIgMjAwNSAxNDo0NjowNSAtMDAwMApA
QCAtNTUsOCArNTUsNiBAQAogI2luY2x1ZGUgImxpYmN5cl9jZmcuaCIKICNpbmNsdWRlICJ4bWFs
bG9jLmgiCiAKLWNvbnN0IGNoYXIgKmF1dGhfbWV0aG9kX2Rlc2MgPSAidW5peCI7Ci0KIHN0cnVj
dCBhdXRoX3N0YXRlIHsKICAgICBjaGFyIHVzZXJpZFs4MV07CiAgICAgY2hhciAqKmdyb3VwOwpA
QCAtNzUsNyArNzMsNyBAQAogICoJMglVc2VyIGlzIGluIHRoZSBncm91cCB0aGF0IGlzIGlkZW50
aWZpZXIKICAqCTMJVXNlciBpcyBpZGVudGlmZXIKICAqLwotaW50IGF1dGhfbWVtYmVyb2YoYXV0
aF9zdGF0ZSwgaWRlbnRpZmllcikKK3N0YXRpYyBpbnQgbXltZW1iZXJvZihhdXRoX3N0YXRlLCBp
ZGVudGlmaWVyKQogc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhfc3RhdGU7CiBjb25zdCBjaGFyICpp
ZGVudGlmaWVyOwogewpAQCAtMTU0LDcgKzE1Miw3IEBACiAgKiByZXByZXNlbnRhdGlvbnM6IG9u
ZSBmb3IgZ2V0cHdlbnQgY2FsbHMgYW5kIG9uZSBmb3IgZm9sZGVyIG5hbWVzLiAgVGhlCiAgKiBs
YXR0ZXIgY2Fub25pY2FsaXplcyB0byBhIE1VVEY3IHJlcHJlc2VudGF0aW9uLgogICovCi1jaGFy
ICphdXRoX2Nhbm9uaWZ5aWQoaWRlbnRpZmllciwgbGVuKQorc3RhdGljIGNoYXIgKm15Y2Fub25p
ZnlpZChpZGVudGlmaWVyLCBsZW4pCiBjb25zdCBjaGFyICppZGVudGlmaWVyOwogc2l6ZV90IGxl
bjsKIHsKQEAgLTIyMCwxNCArMjE4LDE0IEBACiAgKiBwb2ludHMgdG8gYSAxNi1ieXRlIGJpbmFy
eSBrZXkgdG8gY2FjaGUgaWRlbnRpZmllcidzIGluZm9ybWF0aW9uCiAgKiB3aXRoLgogICovCi1z
dHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9uZXdzdGF0ZShjb25zdCBjaGFyICppZGVudGlmaWVyKQor
c3RhdGljIHN0cnVjdCBhdXRoX3N0YXRlICpteW5ld3N0YXRlKGNvbnN0IGNoYXIgKmlkZW50aWZp
ZXIpCiB7CiAgICAgc3RydWN0IGF1dGhfc3RhdGUgKm5ld3N0YXRlOwogICAgIHN0cnVjdCBwYXNz
d2QgKnB3ZDsKICAgICBzdHJ1Y3QgZ3JvdXAgKmdycDsKICAgICBjaGFyICoqbWVtOwogCi0gICAg
aWRlbnRpZmllciA9IGF1dGhfY2Fub25pZnlpZChpZGVudGlmaWVyLCAwKTsKKyAgICBpZGVudGlm
aWVyID0gbXljYW5vbmlmeWlkKGlkZW50aWZpZXIsIDApOwogICAgIGlmICghaWRlbnRpZmllcikg
cmV0dXJuIDA7CiAgICAgaWYgKCFzdHJuY21wKGlkZW50aWZpZXIsICJncm91cDoiLCA2KSkgcmV0
dXJuIDA7CiAgICAgCkBAIC0yNTksOCArMjU3LDcgQEAKICAgICByZXR1cm4gbmV3c3RhdGU7CiB9
CiAKLXZvaWQKLWF1dGhfZnJlZXN0YXRlKGF1dGhfc3RhdGUpCitzdGF0aWMgdm9pZCBteWZyZWVz
dGF0ZShhdXRoX3N0YXRlKQogc3RydWN0IGF1dGhfc3RhdGUgKmF1dGhfc3RhdGU7CiB7CiAgICAg
aWYgKGF1dGhfc3RhdGUtPmdyb3VwKSBmcmVlKChjaGFyICopYXV0aF9zdGF0ZS0+Z3JvdXApOwpA
QCAtMjY4LDMgKzI2NSwxMiBAQAogfQogCiAKK3N0cnVjdCBhdXRoX21lY2ggYXV0aF91bml4ID0g
Cit7CisgICAgInVuaXgiLAkJLyogbmFtZSAqLworCisgICAgJm15Y2Fub25pZnlpZCwKKyAgICAm
bXltZW1iZXJvZiwKKyAgICAmbXluZXdzdGF0ZSwKKyAgICAmbXlmcmVlc3RhdGUsCit9OwpJbmRl
eDogbGliL2ltYXBvcHRpb25zCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL2N5cnVzL2xp
Yi9pbWFwb3B0aW9ucyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4zMApkaWZmIC11IC1yMS4zMCBp
bWFwb3B0aW9ucwotLS0gbGliL2ltYXBvcHRpb25zCTIxIEp1bCAyMDA0IDE5OjA3OjQ1IC0wMDAw
CTEuMzAKKysrIGxpYi9pbWFwb3B0aW9ucwkxNiBGZWIgMjAwNSAxNDo1MjozNiAtMDAwMApAQCAt
MTQ3LDYgKzE0Nyw5IEBACiB7ICJhbm5vdGF0aW9uX2RiIiwgInNraXBsaXN0IiwgU1RSSU5HTElT
VCgiYmVya2VsZXkiLCAic2tpcGxpc3QiKX0KIC8qIFRoZSBjeXJ1c2RiIGJhY2tlbmQgdG8gdXNl
IGZvciBtYWlsYm94IGFubm90YXRpb25zLiAqLwogCit7ICJhdXRoX21lY2giLCAidW5peCIsIFNU
UklOR0xJU1QoInVuaXgiLCAicHRzIiwgImtyYiIsICJrcmI1Iil9CisvKiBUaGUgYXV0aG9yaXph
dGlvbiBtZWNoYW5pc20gdG8gdXNlLiAqLworCiB7ICJhdXRvY3JlYXRlcXVvdGEiLCAwLCBJTlQg
fQogLyogSWYgbm9uemVybywgbm9ybWFsIHVzZXJzIG1heSBjcmVhdGUgdGhlaXIgb3duIElNQVAg
YWNjb3VudHMgYnkKICAgIGNyZWF0aW5nIHRoZSBtYWlsYm94IElOQk9YLiAgVGhlIHVzZXIncyBx
dW90YSBpcyBzZXQgdG8gdGhlIHZhbHVlCkBAIC0zMzEsOSArMzM0LDEwIEBACiAKIHsgImxkYXBf
bWVtYmVyX21ldGhvZCIsICJhdHRyaWJ1dGUiLCBTVFJJTkdMSVNUKCJhdHRyaWJ1dGUiLCAiZmls
dGVyIikgfQogLyogU3BlY2lmeSBhIGdyb3VwIG1ldGhvZC4gIFRoZSAiYXR0cmlidXRlIiBtZXRo
b2QgcmV0cmlldmVzIGdyb3VwcyBmcm9tIAotICAgYSBtdWx0aS12YWx1ZWQgYXR0cmlidXRlZCBz
cGVjaWZpZWQgaW4gbGRhcF9tZW1iZXJfYXR0cmlidXRlLiAgCi0gICBUaGUgImZpbHRlciIgbWV0
aG9kIHVzZXMgYSBmaWx0ZXIsIGxkYXBfbWVtYmVyX2ZpbHRlciwgdG8gZmluZCBncm91cHM7IAot
ICAgbGRhcF9tZW1iZXJfYXR0cmlidXRlIGlzIGEgc2luZ2xlLXZhbHVlIGF0dHJpYnV0ZSBncm91
cCBuYW1lLiAqLworICAgYSBtdWx0aS12YWx1ZWQgYXR0cmlidXRlIHNwZWNpZmllZCBpbiBsZGFw
X21lbWJlcl9hdHRyaWJ1dGUuICAKKworICAgVGhlICJmaWx0ZXIiIG1ldGhvZCB1c2VzIGEgZmls
dGVyLCBzcGVjaWZpZWQgYnkgbGRhcF9tZW1iZXJfZmlsdGVyLCB0byBmaW5kCisgICBncm91cHM7
IGxkYXBfbWVtYmVyX2F0dHJpYnV0ZSBpcyBhIHNpbmdsZS12YWx1ZSBhdHRyaWJ1dGUgZ3JvdXAg
bmFtZS4gKi8KIAogeyAibGRhcF9tZW1iZXJfc2NvcGUiLCAic3ViIiwgU1RSSU5HTElTVCgic3Vi
IiwgIm9uZSIsICJiYXNlIikgfQogLyogU3BlY2lmeSBzZWFyY2ggc2NvcGUgZm9yIGxkYXBfbWVt
YmVyX2ZpbHRlci4gKi8KQEAgLTYzNCw2ICs2MzgsOSBAQAogLyogQSBsaXN0IG9mIHVzZXJzIGFu
ZCBncm91cHMgdGhhdCBhcmUgYWxsb3dlZCB0byBwcm94eSBmb3Igb3RoZXIKICAgIHVzZXJzLCBz
ZXBlcmF0ZWQgYnkgc3BhY2VzLiAgQW55IHVzZXIgbGlzdGVkIGluIHRoaXMgd2lsbCBiZQogICAg
YWxsb3dlZCB0byBsb2dpbiBmb3IgYW55IG90aGVyIHVzZXI6IHVzZSB3aXRoIGNhdXRpb24uICov
IAorCit7ICJwdHNfbW9kdWxlIiwgImFmc2tyYiIsIFNUUklOR0xJU1QoImFmc2tyYiIsICJsZGFw
IikgfQorLyogVGhlIFBUUyBtb2R1bGUgdG8gdXNlLiAqLwogCiB7ICJwdGxvYWRlcl9zb2NrIiwg
TlVMTCwgU1RSSU5HIH0KIC8qIFVuaXggZG9tYWluIHNvY2tldCB0aGF0IHB0bG9hZGVyIGxpc3Rl
bnMgb24uCkluZGV4OiBsaWIvbGliY3lyX2NmZy5jCj09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMv
c3JjL2N5cnVzL2xpYi9saWJjeXJfY2ZnLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTAKZGlm
ZiAtdSAtcjEuMTAgbGliY3lyX2NmZy5jCi0tLSBsaWIvbGliY3lyX2NmZy5jCTkgTWFyIDIwMDQg
MTU6MDU6NTggLTAwMDAJMS4xMAorKysgbGliL2xpYmN5cl9jZmcuYwkxNiBGZWIgMjAwNSAxNDo1
Mzo0NSAtMDAwMApAQCAtMTEwLDYgKzExMCwxMCBAQAogICAgICAgQ0ZHVkFMKGludCwgNTEyICog
MTAyNCksIC8qIDUxMktCICovCiAgICAgICBDWVJVU19PUFRfSU5UIH0sCiAKKyAgICB7IENZUlVT
T1BUX0FVVEhfTUVDSCwKKyAgICAgIENGR1ZBTChjb25zdCBjaGFyICosICJ1bml4IiksCisgICAg
ICBDWVJVU19PUFRfU1RSSU5HIH0sCisKICAgICB7IENZUlVTT1BUX0JFUktFTEVZX0xPQ0tTX01B
WCwKICAgICAgIENGR1ZBTChpbnQsIDUwMDAwKSwKICAgICAgIENZUlVTX09QVF9JTlQgfSwKSW5k
ZXg6IGxpYi9saWJjeXJfY2ZnLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvY3lydXMv
bGliL2xpYmN5cl9jZmcuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS43CmRpZmYgLXUgLXIxLjcg
bGliY3lyX2NmZy5oCi0tLSBsaWIvbGliY3lyX2NmZy5oCTkgTWFyIDIwMDQgMTU6MDU6NTggLTAw
MDAJMS43CisrKyBsaWIvbGliY3lyX2NmZy5oCTE2IEZlYiAyMDA1IDE0OjUzOjQ5IC0wMDAwCkBA
IC05Myw2ICs5Myw4IEBACiAgICAgQ1lSVVNPUFRfVklSVERPTUFJTlMsCiAgICAgLyogQkRCIGNh
Y2hlIHNpemUgKDUxMktCKSAqLwogICAgIENZUlVTT1BUX0JFUktFTEVZX0NBQ0hFU0laRSwKKyAg
ICAvKiBhdXRob3JpemF0aW9uIG1lY2hhbmlzbSAodW5peCkgKi8KKyAgICBDWVJVU09QVF9BVVRI
X01FQ0gsCiAgICAgLyogQkRCIG1heCBsb2NrcyAoNTAwMDApICovCiAgICAgQ1lSVVNPUFRfQkVS
S0VMRVlfTE9DS1NfTUFYLAogICAgIC8qIEJEQiBtYXggdHhucyAoMTAwKSAqLwpJbmRleDogaW1h
cC9jdGxfY3lydXNkYi5jCj09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT0KUkNTIGZpbGU6IC9jdnMvc3JjL2N5cnVzL2ltYXAv
Y3RsX2N5cnVzZGIuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4yNgpkaWZmIC11IC1yMS4yNiBj
dGxfY3lydXNkYi5jCi0tLSBpbWFwL2N0bF9jeXJ1c2RiLmMJMTMgSnVsIDIwMDQgMDI6MzQ6MjAg
LTAwMDAJMS4yNgorKysgaW1hcC9jdGxfY3lydXNkYi5jCTE2IEZlYiAyMDA1IDE0OjU3OjQxIC0w
MDAwCkBAIC05OSw5ICs5OSw3IEBACiAgICAgeyBGTkFNRV9BTk5PVEFUSU9OUywJJmNvbmZpZ19h
bm5vdGF0aW9uX2RiLAkxIH0sCiAgICAgeyBGTkFNRV9ERUxJVkVSREIsCQkmY29uZmlnX2R1cGxp
Y2F0ZV9kYiwJMCB9LAogICAgIHsgRk5BTUVfVExTU0VTU0lPTlMsCSZjb25maWdfdGxzY2FjaGVf
ZGIsCTAgfSwKLSNpZmRlZiBXSVRIX1BUUwogICAgIHsgRk5BTUVfUFRTREIsICAgICAgICAgICAg
ICAmY29uZmlnX3B0c2NhY2hlX2RiLCAgICAwIH0sCi0jZW5kaWYKICAgICB7IE5VTEwsCQkJTlVM
TCwJCQkwIH0KIH07CiAKSW5kZXg6IGltYXAvZ2xvYmFsLmMKPT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTog
L2N2cy9zcmMvY3lydXMvaW1hcC9nbG9iYWwuYyx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS4xNwpk
aWZmIC11IC1yMS4xNyBnbG9iYWwuYwotLS0gaW1hcC9nbG9iYWwuYwkyMyBOb3YgMjAwNCAxNzo0
MDoxNSAtMDAwMAkxLjE3CisrKyBpbWFwL2dsb2JhbC5jCTE2IEZlYiAyMDA1IDE0OjU4OjA1IC0w
MDAwCkBAIC04OSw5ICs4OSw3IEBACiBzdHJ1Y3QgY3lydXNkYl9iYWNrZW5kICpjb25maWdfc2Vl
bnN0YXRlX2RiOwogc3RydWN0IGN5cnVzZGJfYmFja2VuZCAqY29uZmlnX2R1cGxpY2F0ZV9kYjsK
IHN0cnVjdCBjeXJ1c2RiX2JhY2tlbmQgKmNvbmZpZ190bHNjYWNoZV9kYjsKLSNpZmRlZiBXSVRI
X1BUUwogc3RydWN0IGN5cnVzZGJfYmFja2VuZCAqY29uZmlnX3B0c2NhY2hlX2RiOwotI2VuZGlm
CiAKIC8qIENhbGxlZCBiZWZvcmUgYSBjeXJ1cyBhcHBsaWNhdGlvbiBzdGFydHMgKGJ1dCBhZnRl
ciBjb21tYW5kIGxpbmUgcGFyYW1ldGVycwogICogYXJlIHJlYWQpICovCkBAIC0xNzksMTAgKzE3
Nyw4IEBACiAJICAgIGN5cnVzZGJfZnJvbW5hbWUoY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX0RV
UExJQ0FURV9EQikpOwogCWNvbmZpZ190bHNjYWNoZV9kYiA9CiAJICAgIGN5cnVzZGJfZnJvbW5h
bWUoY29uZmlnX2dldHN0cmluZyhJTUFQT1BUX1RMU0NBQ0hFX0RCKSk7Ci0jaWZkZWYgV0lUSF9Q
VFMKIAljb25maWdfcHRzY2FjaGVfZGIgPQogCSAgICBjeXJ1c2RiX2Zyb21uYW1lKGNvbmZpZ19n
ZXRzdHJpbmcoSU1BUE9QVF9QVFNDQUNIRV9EQikpOwotI2VuZGlmCiAKIAkvKiBjb25maWd1cmUg
bGliY3lydXMgYXMgbmVlZGVkICovCiAJbGliY3lydXNfY29uZmlnX3NldHN0cmluZyhDWVJVU09Q
VF9DT05GSUdfRElSLCBjb25maWdfZGlyKTsKQEAgLTIwNiw2ICsyMDIsOCBAQAogCQkJCSAgY29u
ZmlnX2dldGVudW0oSU1BUE9QVF9WSVJURE9NQUlOUykpOwogCWxpYmN5cnVzX2NvbmZpZ19zZXRp
bnQoQ1lSVVNPUFRfQkVSS0VMRVlfQ0FDSEVTSVpFLAogCQkJICAgICAgIGNvbmZpZ19nZXRpbnQo
SU1BUE9QVF9CRVJLRUxFWV9DQUNIRVNJWkUpKTsKKwlsaWJjeXJ1c19jb25maWdfc2V0c3RyaW5n
KENZUlVTT1BUX0FVVEhfTUVDSCwKKwkJCQkgIGNvbmZpZ19nZXRzdHJpbmcoSU1BUE9QVF9BVVRI
X01FQ0gpKTsKIAlsaWJjeXJ1c19jb25maWdfc2V0aW50KENZUlVTT1BUX0JFUktFTEVZX0xPQ0tT
X01BWCwKIAkJCSAgICAgICBjb25maWdfZ2V0aW50KElNQVBPUFRfQkVSS0VMRVlfTE9DS1NfTUFY
KSk7CiAJbGliY3lydXNfY29uZmlnX3NldGludChDWVJVU09QVF9CRVJLRUxFWV9UWE5TX01BWCwK
SW5kZXg6IGltYXAvZ2xvYmFsLmgKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvY3lydXMv
aW1hcC9nbG9iYWwuaCx2CnJldHJpZXZpbmcgcmV2aXNpb24gMS42CmRpZmYgLXUgLXIxLjYgZ2xv
YmFsLmgKLS0tIGltYXAvZ2xvYmFsLmgJMTcgRGVjIDIwMDQgMTY6MzI6MDggLTAwMDAJMS42Cisr
KyBpbWFwL2dsb2JhbC5oCTE2IEZlYiAyMDA1IDE0OjU4OjI0IC0wMDAwCkBAIC0xNTAsOCArMTUw
LDYgQEAKIGV4dGVybiBzdHJ1Y3QgY3lydXNkYl9iYWNrZW5kICpjb25maWdfc2VlbnN0YXRlX2Ri
OwogZXh0ZXJuIHN0cnVjdCBjeXJ1c2RiX2JhY2tlbmQgKmNvbmZpZ19kdXBsaWNhdGVfZGI7CiBl
eHRlcm4gc3RydWN0IGN5cnVzZGJfYmFja2VuZCAqY29uZmlnX3Rsc2NhY2hlX2RiOwotI2lmZGVm
IFdJVEhfUFRTCiBleHRlcm4gc3RydWN0IGN5cnVzZGJfYmFja2VuZCAqY29uZmlnX3B0c2NhY2hl
X2RiOwotI2VuZGlmCiAKICNlbmRpZiAvKiBJTkNMVURFRF9HTE9CQUxfSCAqLwpJbmRleDogaW1h
cC92ZXJzaW9uLmMKPT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09PT09
PT09PT09PT09PT09PT09PT09PT09PQpSQ1MgZmlsZTogL2N2cy9zcmMvY3lydXMvaW1hcC92ZXJz
aW9uLmMsdgpyZXRyaWV2aW5nIHJldmlzaW9uIDEuMTgKZGlmZiAtdSAtcjEuMTggdmVyc2lvbi5j
Ci0tLSBpbWFwL3ZlcnNpb24uYwkyMSBKdW4gMjAwNCAxNTozMToxMyAtMDAwMAkxLjE4CisrKyBp
bWFwL3ZlcnNpb24uYwkxNiBGZWIgMjAwNSAxNDo1ODozMCAtMDAwMApAQCAtMTU5LDE0ICsxNTks
MTYgQEAKICAgICBzbnByaW50ZihlbnZfYnVmICsgc3RybGVuKGVudl9idWYpLCBNQVhJRFZBTFVF
TEVOIC0gc3RybGVuKGVudl9idWYpLAogCSAgICAgIjsgVUNELVNOTVAgJXMiLCBWZXJzaW9uSW5m
byk7CiAjZW5kaWYKKyNpZmRlZiBIQVZFX05FVFNOTVAKKyAgICBzbnByaW50ZihlbnZfYnVmICsg
c3RybGVuKGVudl9idWYpLCBNQVhJRFZBTFVFTEVOIC0gc3RybGVuKGVudl9idWYpLAorCSAgICAg
IjsgTkVULVNOTVAiKTsKKyNlbmRpZgogICAgIHNucHJpbnRmKGVudl9idWYgKyBzdHJsZW4oZW52
X2J1ZiksIE1BWElEVkFMVUVMRU4gLSBzdHJsZW4oZW52X2J1ZiksCiAJICAgICAiOyBtbWFwID0g
JXMiLCBtYXBfbWV0aG9kX2Rlc2MpOwogICAgIHNucHJpbnRmKGVudl9idWYgKyBzdHJsZW4oZW52
X2J1ZiksIE1BWElEVkFMVUVMRU4gLSBzdHJsZW4oZW52X2J1ZiksCiAJICAgICAiOyBsb2NrID0g
JXMiLCBsb2NrX21ldGhvZF9kZXNjKTsKICAgICBzbnByaW50ZihlbnZfYnVmICsgc3RybGVuKGVu
dl9idWYpLCBNQVhJRFZBTFVFTEVOIC0gc3RybGVuKGVudl9idWYpLAogCSAgICAgIjsgbm9uYmxv
Y2sgPSAlcyIsIG5vbmJsb2NrX21ldGhvZF9kZXNjKTsKLSAgICBzbnByaW50ZihlbnZfYnVmICsg
c3RybGVuKGVudl9idWYpLCBNQVhJRFZBTFVFTEVOIC0gc3RybGVuKGVudl9idWYpLAotCSAgICAg
IjsgYXV0aCA9ICVzIiwgYXV0aF9tZXRob2RfZGVzYyk7CiAjaWZkZWYgSEFWRV9LUkIKICAgICBz
bnByaW50ZihlbnZfYnVmICsgc3RybGVuKGVudl9idWYpLCBNQVhJRFZBTFVFTEVOIC0gc3RybGVu
KGVudl9idWYpLAogCSAgICAgIiAoJXMpIiwga3JiNF92ZXJzaW9uKTsK
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>331</attachid>
            <date>2005-02-16 10:03 EDT</date>
            <desc>lib/auth.c - new file</desc>
            <filename>auth.c</filename>
            <type>text/plain</type>
            <size>3303</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogCiAqIENvcHlyaWdodCAoYykgMTk5OC0yMDAzIENhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5
LiAgQWxsIHJpZ2h0cyByZXNlcnZlZC4KICoKICogUmVkaXN0cmlidXRpb24gYW5kIHVzZSBpbiBz
b3VyY2UgYW5kIGJpbmFyeSBmb3Jtcywgd2l0aCBvciB3aXRob3V0CiAqIG1vZGlmaWNhdGlvbiwg
YXJlIHBlcm1pdHRlZCBwcm92aWRlZCB0aGF0IHRoZSBmb2xsb3dpbmcgY29uZGl0aW9ucwogKiBh
cmUgbWV0OgogKgogKiAxLiBSZWRpc3RyaWJ1dGlvbnMgb2Ygc291cmNlIGNvZGUgbXVzdCByZXRh
aW4gdGhlIGFib3ZlIGNvcHlyaWdodAogKiAgICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRp
b25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2NsYWltZXIuIAogKgogKiAyLiBSZWRpc3RyaWJ1dGlv
bnMgaW4gYmluYXJ5IGZvcm0gbXVzdCByZXByb2R1Y2UgdGhlIGFib3ZlIGNvcHlyaWdodAogKiAg
ICBub3RpY2UsIHRoaXMgbGlzdCBvZiBjb25kaXRpb25zIGFuZCB0aGUgZm9sbG93aW5nIGRpc2Ns
YWltZXIgaW4KICogICAgdGhlIGRvY3VtZW50YXRpb24gYW5kL29yIG90aGVyIG1hdGVyaWFscyBw
cm92aWRlZCB3aXRoIHRoZQogKiAgICBkaXN0cmlidXRpb24uCiAqCiAqIDMuIFRoZSBuYW1lICJD
YXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eSIgbXVzdCBub3QgYmUgdXNlZCB0bwogKiAgICBlbmRv
cnNlIG9yIHByb21vdGUgcHJvZHVjdHMgZGVyaXZlZCBmcm9tIHRoaXMgc29mdHdhcmUgd2l0aG91
dAogKiAgICBwcmlvciB3cml0dGVuIHBlcm1pc3Npb24uIEZvciBwZXJtaXNzaW9uIG9yIGFueSBv
dGhlciBsZWdhbAogKiAgICBkZXRhaWxzLCBwbGVhc2UgY29udGFjdCAgCiAqICAgICAgT2ZmaWNl
IG9mIFRlY2hub2xvZ3kgVHJhbnNmZXIKICogICAgICBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0
eQogKiAgICAgIDUwMDAgRm9yYmVzIEF2ZW51ZQogKiAgICAgIFBpdHRzYnVyZ2gsIFBBICAxNTIx
My0zODkwCiAqICAgICAgKDQxMikgMjY4LTQzODcsIGZheDogKDQxMikgMjY4LTczOTUKICogICAg
ICB0ZWNoLXRyYW5zZmVyQGFuZHJldy5jbXUuZWR1CiAqCiAqIDQuIFJlZGlzdHJpYnV0aW9ucyBv
ZiBhbnkgZm9ybSB3aGF0c29ldmVyIG11c3QgcmV0YWluIHRoZSBmb2xsb3dpbmcKICogICAgYWNr
bm93bGVkZ21lbnQ6CiAqICAgICJUaGlzIHByb2R1Y3QgaW5jbHVkZXMgc29mdHdhcmUgZGV2ZWxv
cGVkIGJ5IENvbXB1dGluZyBTZXJ2aWNlcwogKiAgICAgYXQgQ2FybmVnaWUgTWVsbG9uIFVuaXZl
cnNpdHkgKGh0dHA6Ly93d3cuY211LmVkdS9jb21wdXRpbmcvKS4iCiAqCiAqIENBUk5FR0lFIE1F
TExPTiBVTklWRVJTSVRZIERJU0NMQUlNUyBBTEwgV0FSUkFOVElFUyBXSVRIIFJFR0FSRCBUTwog
KiBUSElTIFNPRlRXQVJFLCBJTkNMVURJTkcgQUxMIElNUExJRUQgV0FSUkFOVElFUyBPRiBNRVJD
SEFOVEFCSUxJVFkKICogQU5EIEZJVE5FU1MsIElOIE5PIEVWRU5UIFNIQUxMIENBUk5FR0lFIE1F
TExPTiBVTklWRVJTSVRZIEJFIExJQUJMRQogKiBGT1IgQU5ZIFNQRUNJQUwsIElORElSRUNUIE9S
IENPTlNFUVVFTlRJQUwgREFNQUdFUyBPUiBBTlkgREFNQUdFUwogKiBXSEFUU09FVkVSIFJFU1VM
VElORyBGUk9NIExPU1MgT0YgVVNFLCBEQVRBIE9SIFBST0ZJVFMsIFdIRVRIRVIgSU4KICogQU4g
QUNUSU9OIE9GIENPTlRSQUNULCBORUdMSUdFTkNFIE9SIE9USEVSIFRPUlRJT1VTIEFDVElPTiwg
QVJJU0lORwogKiBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBVU0UgT1IgUEVSRk9S
TUFOQ0UgT0YgVEhJUyBTT0ZUV0FSRS4KICovCgovKiAkSWQkICovCgojaW5jbHVkZSA8Y29uZmln
Lmg+CiNpbmNsdWRlIDxzdGRsaWIuaD4KI2luY2x1ZGUgPHN0cmluZy5oPgoKI2luY2x1ZGUgImF1
dGguaCIKI2luY2x1ZGUgImV4aXRjb2Rlcy5oIgojaW5jbHVkZSAibGliY3lyX2NmZy5oIgojaW5j
bHVkZSAieG1hbGxvYy5oIgoKc3RydWN0IGF1dGhfbWVjaCAqYXV0aF9tZWNoc1tdID0gewogICAg
JmF1dGhfdW5peCwKICAgICZhdXRoX3B0cywKI2lmZGVmIEhBVkVfS1JCCiAgICAmYXV0aF9rcmIs
CiNlbmRpZgojaWZkZWYgSEFWRV9HU1NBUElfSAogICAgJmF1dGhfa3JiNSwKI2VuZGlmCiAgICBO
VUxMIH07CgpzdGF0aWMgc3RydWN0IGF1dGhfbWVjaCAqYXV0aF9mcm9tbmFtZSgpCnsKICAgIGlu
dCBpOwogICAgY29uc3QgY2hhciAqbmFtZSA9IGxpYmN5cnVzX2NvbmZpZ19nZXRzdHJpbmcoQ1lS
VVNPUFRfQVVUSF9NRUNIKTsKICAgIHN0YXRpYyBzdHJ1Y3QgYXV0aF9tZWNoICphdXRoID0gTlVM
TDsKCiAgICBpZiAoYXV0aCkKICAgICAgICByZXR1cm4gYXV0aDsKCiAgICBmb3IgKGkgPSAwOyBh
dXRoX21lY2hzW2ldOyBpKyspIHsKCWlmICghc3RyY21wKGF1dGhfbWVjaHNbaV0tPm5hbWUsIG5h
bWUpKSB7CgkgICAgYXV0aCA9IGF1dGhfbWVjaHNbaV07IGJyZWFrOwoJfQogICAgfQogICAgaWYg
KCFhdXRoKSB7CgljaGFyIGVycmJ1ZlsxMDI0XTsKCXNucHJpbnRmKGVycmJ1Ziwgc2l6ZW9mKGVy
cmJ1ZiksCgkJICJBdXRob3JpemF0aW9uIG1lY2hhbmlzbSAlcyBub3Qgc3VwcG9ydGVkIiwgbmFt
ZSk7CglmYXRhbChlcnJidWYsIEVDX0NPTkZJRyk7CiAgICB9CgogICAgcmV0dXJuIGF1dGg7Cn0K
CmludCBhdXRoX21lbWJlcm9mKGF1dGhfc3RhdGUsIGlkZW50aWZpZXIpCnN0cnVjdCBhdXRoX3N0
YXRlICphdXRoX3N0YXRlOwpjb25zdCBjaGFyICppZGVudGlmaWVyOwp7CiAgICBzdHJ1Y3QgYXV0
aF9tZWNoICphdXRoID0gYXV0aF9mcm9tbmFtZSgpOwoKICAgIHJldHVybiBhdXRoLT5tZW1iZXJv
ZihhdXRoX3N0YXRlLCBpZGVudGlmaWVyKTsKfQoKY2hhciAqYXV0aF9jYW5vbmlmeWlkKGlkZW50
aWZpZXIsIGxlbikKY29uc3QgY2hhciAqaWRlbnRpZmllcjsKc2l6ZV90IGxlbjsKewogICAgc3Ry
dWN0IGF1dGhfbWVjaCAqYXV0aCA9IGF1dGhfZnJvbW5hbWUoKTsKCiAgICByZXR1cm4gYXV0aC0+
Y2Fub25pZnlpZChpZGVudGlmaWVyLCBsZW4pOwp9CgpzdHJ1Y3QgYXV0aF9zdGF0ZSAqYXV0aF9u
ZXdzdGF0ZShpZGVudGlmaWVyKQpjb25zdCBjaGFyICppZGVudGlmaWVyOwp7CiAgICBzdHJ1Y3Qg
YXV0aF9tZWNoICphdXRoID0gYXV0aF9mcm9tbmFtZSgpOwoKICAgIHJldHVybiBhdXRoLT5uZXdz
dGF0ZShpZGVudGlmaWVyKTsKfQoKdm9pZCBhdXRoX2ZyZWVzdGF0ZShhdXRoX3N0YXRlKQpzdHJ1
Y3QgYXV0aF9zdGF0ZSAqYXV0aF9zdGF0ZTsKewogICAgc3RydWN0IGF1dGhfbWVjaCAqYXV0aCA9
IGF1dGhfZnJvbW5hbWUoKTsKCiAgICBhdXRoLT5mcmVlc3RhdGUoYXV0aF9zdGF0ZSk7Cn0K
</data>        

          </attachment>
          <attachment
              isobsolete="0"
              ispatch="0"
              isprivate="0"
          >
            <attachid>332</attachid>
            <date>2005-02-16 10:04 EDT</date>
            <desc>ptclient/ptloader.h- new file</desc>
            <filename>ptloader.h</filename>
            <type>text/plain</type>
            <size>2554</size>
            <attacher>igor@ipass.net</attacher>
            
              <data encoding="base64">LyogcHRsb2FkZXIuaCAtLSBTaXRlIGF1dGhvcml6YXRpb24gbW9kdWxlCiAqICRJZCQKICoKICog
Q29weXJpZ2h0IChjKSAxOTk4LTIwMDMgQ2FybmVnaWUgTWVsbG9uIFVuaXZlcnNpdHkuICBBbGwg
cmlnaHRzIHJlc2VydmVkLgogKgogKiBSZWRpc3RyaWJ1dGlvbiBhbmQgdXNlIGluIHNvdXJjZSBh
bmQgYmluYXJ5IGZvcm1zLCB3aXRoIG9yIHdpdGhvdXQKICogbW9kaWZpY2F0aW9uLCBhcmUgcGVy
bWl0dGVkIHByb3ZpZGVkIHRoYXQgdGhlIGZvbGxvd2luZyBjb25kaXRpb25zCiAqIGFyZSBtZXQ6
CiAqCiAqIDEuIFJlZGlzdHJpYnV0aW9ucyBvZiBzb3VyY2UgY29kZSBtdXN0IHJldGFpbiB0aGUg
YWJvdmUgY29weXJpZ2h0CiAqICAgIG5vdGljZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5k
IHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lci4gCiAqCiAqIDIuIFJlZGlzdHJpYnV0aW9ucyBpbiBi
aW5hcnkgZm9ybSBtdXN0IHJlcHJvZHVjZSB0aGUgYWJvdmUgY29weXJpZ2h0CiAqICAgIG5vdGlj
ZSwgdGhpcyBsaXN0IG9mIGNvbmRpdGlvbnMgYW5kIHRoZSBmb2xsb3dpbmcgZGlzY2xhaW1lciBp
bgogKiAgICB0aGUgZG9jdW1lbnRhdGlvbiBhbmQvb3Igb3RoZXIgbWF0ZXJpYWxzIHByb3ZpZGVk
IHdpdGggdGhlCiAqICAgIGRpc3RyaWJ1dGlvbi4KICoKICogMy4gVGhlIG5hbWUgIkNhcm5lZ2ll
IE1lbGxvbiBVbml2ZXJzaXR5IiBtdXN0IG5vdCBiZSB1c2VkIHRvCiAqICAgIGVuZG9yc2Ugb3Ig
cHJvbW90ZSBwcm9kdWN0cyBkZXJpdmVkIGZyb20gdGhpcyBzb2Z0d2FyZSB3aXRob3V0CiAqICAg
IHByaW9yIHdyaXR0ZW4gcGVybWlzc2lvbi4gRm9yIHBlcm1pc3Npb24gb3IgYW55IG90aGVyIGxl
Z2FsCiAqICAgIGRldGFpbHMsIHBsZWFzZSBjb250YWN0ICAKICogICAgICBPZmZpY2Ugb2YgVGVj
aG5vbG9neSBUcmFuc2ZlcgogKiAgICAgIENhcm5lZ2llIE1lbGxvbiBVbml2ZXJzaXR5CiAqICAg
ICAgNTAwMCBGb3JiZXMgQXZlbnVlCiAqICAgICAgUGl0dHNidXJnaCwgUEEgIDE1MjEzLTM4OTAK
ICogICAgICAoNDEyKSAyNjgtNDM4NywgZmF4OiAoNDEyKSAyNjgtNzM5NQogKiAgICAgIHRlY2gt
dHJhbnNmZXJAYW5kcmV3LmNtdS5lZHUKICoKICogNC4gUmVkaXN0cmlidXRpb25zIG9mIGFueSBm
b3JtIHdoYXRzb2V2ZXIgbXVzdCByZXRhaW4gdGhlIGZvbGxvd2luZwogKiAgICBhY2tub3dsZWRn
bWVudDoKICogICAgIlRoaXMgcHJvZHVjdCBpbmNsdWRlcyBzb2Z0d2FyZSBkZXZlbG9wZWQgYnkg
Q29tcHV0aW5nIFNlcnZpY2VzCiAqICAgICBhdCBDYXJuZWdpZSBNZWxsb24gVW5pdmVyc2l0eSAo
aHR0cDovL3d3dy5jbXUuZWR1L2NvbXB1dGluZy8pLiIKICoKICogQ0FSTkVHSUUgTUVMTE9OIFVO
SVZFUlNJVFkgRElTQ0xBSU1TIEFMTCBXQVJSQU5USUVTIFdJVEggUkVHQVJEIFRPCiAqIFRISVMg
U09GVFdBUkUsIElOQ0xVRElORyBBTEwgSU1QTElFRCBXQVJSQU5USUVTIE9GIE1FUkNIQU5UQUJJ
TElUWQogKiBBTkQgRklUTkVTUywgSU4gTk8gRVZFTlQgU0hBTEwgQ0FSTkVHSUUgTUVMTE9OIFVO
SVZFUlNJVFkgQkUgTElBQkxFCiAqIEZPUiBBTlkgU1BFQ0lBTCwgSU5ESVJFQ1QgT1IgQ09OU0VR
VUVOVElBTCBEQU1BR0VTIE9SIEFOWSBEQU1BR0VTCiAqIFdIQVRTT0VWRVIgUkVTVUxUSU5HIEZS
T00gTE9TUyBPRiBVU0UsIERBVEEgT1IgUFJPRklUUywgV0hFVEhFUiBJTgogKiBBTiBBQ1RJT04g
T0YgQ09OVFJBQ1QsIE5FR0xJR0VOQ0UgT1IgT1RIRVIgVE9SVElPVVMgQUNUSU9OLCBBUklTSU5H
CiAqIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFIFVTRSBPUiBQRVJGT1JNQU5DRSBP
RiBUSElTIFNPRlRXQVJFLgogKgogKi8KCiNpZm5kZWYgSU5DTFVERURfUFRMT0FERVJfSAojZGVm
aW5lIElOQ0xVREVEX1BUTE9BREVSX0gKCnN0cnVjdCBhdXRoX3N0YXRlOwoKc3RydWN0IHB0c19t
b2R1bGUgewogICAgY29uc3QgY2hhciAqbmFtZTsKCiAgICB2b2lkICgqaW5pdCkodm9pZCk7CiAg
ICBzdHJ1Y3QgYXV0aF9zdGF0ZSAqKCptYWtlX2F1dGhzdGF0ZSkoY29uc3QgY2hhciAqaWRlbnRp
ZmllciwKICAgICAgICAgICAgICAgIHNpemVfdCBzaXplLAogICAgICAgICAgICAgICAgY29uc3Qg
Y2hhciAqKnJlcGx5LCBpbnQgKmRzaXplKTsKfTsKCmV4dGVybiBzdHJ1Y3QgcHRzX21vZHVsZSAq
cHRzX21vZHVsZXNbXTsKCi8qIE5vdGUgdGhhdCBzb21lIG9mIHRoZXNlIG1heSBiZSB1bmRlZmlu
ZWQgc3ltYm9scwogKiBpZiBsaWJjeXJ1cyB3YXMgbm90IGJ1aWx0IHdpdGggc3VwcG9ydCBmb3Ig
dGhlbSAqLwpleHRlcm4gc3RydWN0IHB0c19tb2R1bGUgcHRzX2xkYXA7CmV4dGVybiBzdHJ1Y3Qg
cHRzX21vZHVsZSBwdHNfYWZza3JiOwoKc3RydWN0IGF1dGhfc3RhdGUgKnB0c21vZHVsZV9tYWtl
X2F1dGhzdGF0ZShjb25zdCBjaGFyICppZGVudGlmaWVyLAoJCQkJCSAgICBzaXplX3Qgc2l6ZSwK
CQkJCQkgICAgY29uc3QgY2hhciAqKnJlcGx5LCBpbnQgKmRzaXplKTsKdm9pZCBwdHNtb2R1bGVf
aW5pdCh2b2lkKTsKCiNlbmRpZiAvKiBJTkNMVURFRF9QVExPQURFUl9IICovCg==
</data>        

          </attachment>
      

    </bug>

</bugzilla>