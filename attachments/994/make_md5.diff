--- cyrus-imapd-2.3.8/imap/make_md5.c   2006-11-30 12:11:19.000000000 -0500
+++ cyrus-imapd-2.3.8p8/imap/make_md5.c 2008-03-03 15:54:41.000000000 -0500
@@ -334,7 +334,7 @@
 {
     struct md5_mailbox *current = NULL;
     FILE *file;
-    char buf[MAX_MAILBOX_NAME+2];
+    char buf[MAX_MAILBOX_NAME+18];
     unsigned char md5_msg[16];
     unsigned char md5_cache[16];
     int len;
