From woods@weird.com Mon Sep  1 18:07:56 2003
Date: Sun, 31 Aug 2003 15:28:39 -0400 (EDT)
From: Greg A. Woods <woods@weird.com>
To: cyrus-bugs+@andrew.cmu.edu
Subject: problems with header generated by snmpgen (real fix!)

Updated patch for snmpgen that _really_ fixes the problem!  ;-)

Index: snmp/snmpgen
===================================================================
RCS file: /cvs/src/cyrus/snmp/snmpgen,v
retrieving revision 1.15
diff -c -r1.15 snmpgen
*** snmp/snmpgen	23 Apr 2003 20:38:21 -0000	1.15
--- snmp/snmpgen	31 Aug 2003 19:27:44 -0000
***************
*** 1,4 ****
! #!/bin/sh
  # 
  # Copyright (c) 2000 Carnegie Mellon University.  All rights reserved.
  #
--- 1,4 ----
! #! /bin/sh
  # 
  # Copyright (c) 2000 Carnegie Mellon University.  All rights reserved.
  #
***************
*** 222,245 ****
  
  print OUTPUT_H <<EOF
  
- #ifndef USING_SNMPGEN
- 
- #define snmp_connect()
- #define snmp_close()
- #define snmp_increment(a, b)
- #define snmp_increment_args(...)
- #define snmp_set(a, b)
- #define snmp_set_str(a, b)
- #define snmp_set_oid(a, b)
- #define snmp_set_time(a, b)
- #define snmp_getdescription(a)
- #define snmp_getoid(a, b, c, d)
- #define snmp_setvariable(a, b)
- 
- typedef void ${basename}_t;
- 
- #else
- 
  typedef enum {
  EOF
  ;
--- 222,227 ----
***************
*** 271,276 ****
--- 253,278 ----
  print OUTPUT_H <<EOF
  
  } ${basename}_variable_t;
+ 
+ #ifndef USING_SNMPGEN
+ 
+ #define snmp_connect()
+ #define snmp_close()
+ #define snmp_increment(a, b)
+ static int snmp_increment_args(${basename}_t cmd, int incr, ...)
+ {
+     return 0;
+ }
+ #define hash_simple(a) (a)
+ #define snmp_set(a, b)
+ #define snmp_set_str(a, b)
+ #define snmp_set_oid(a, b)
+ #define snmp_set_time(a, b)
+ #define snmp_getdescription(a)
+ #define snmp_getoid(a, b, c, d)
+ #define snmp_setvariable(a, b)
+ 
+ #else
  
  int snmp_connect(void);
  

-- 
						Greg A. Woods

+1 416 218-0098                  VE3TCP            RoboHack <woods@robohack.ca>
Planix, Inc. <woods@planix.com>          Secrets of the Weird <woods@weird.com>

